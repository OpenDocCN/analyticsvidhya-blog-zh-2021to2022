<html>
<head>
<title>Using Neural networks to solve Customer Churn Problem.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用神经网络解决客户流失问题。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/using-neural-networks-to-solve-customer-churn-problem-3527f1a5a38?source=collection_archive---------12-----------------------#2021-03-15">https://medium.com/analytics-vidhya/using-neural-networks-to-solve-customer-churn-problem-3527f1a5a38?source=collection_archive---------12-----------------------#2021-03-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/9bbd2bb08925adf713e06455df3334a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*isWZ7u3YIaFyWMa2"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">艾莉娜·格鲁布尼亚克在<a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="ea26" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">数据集:【https://www.kaggle.com/radmirzosimov/telecom-users-dataset T4】</p><p id="a46a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">笔记本:<a class="ae it" href="https://www.kaggle.com/tanishsawant2002/customer-churn-keras-and-sklearn" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/tanishsawant 2002/customer-churn-keras-and-sk learn</a></p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="e0cf" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">关于数据集和任务:</p><p id="370d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">任何企业都希望最大限度地增加客户数量。要实现这一目标，不仅要努力吸引新客户，还要留住现有客户。留住一个客户比吸引一个新客户花费更少。此外，新客户可能对业务服务不太感兴趣，很难与他合作，而老客户已经有了与服务交互的必要数据。</p><p id="fa4c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">相应地，预测客户流失，我们可以及时做出反应，努力留住想要离开的客户。根据客户使用的服务数据，我们可以为他提供特殊优惠，试图改变他离开运营商的决定。这将使留住用户的任务比吸引新用户的任务更容易实现，因为我们对此还一无所知。</p><p id="3ae7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">一家电信公司为您提供了一个数据集。该数据包含大约6000名用户的信息、他们的人口统计特征、他们使用的服务、使用运营商服务的持续时间、支付方式和支付金额。</p><p id="f790" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">任务是分析数据，预测用户流失(识别愿意和不愿意续约的人)。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="8df1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这是一个非常普通的分类问题，通常通过使用像K最近邻或RandomForestClassifier或支持向量机这样的算法来解决。</p><p id="1d08" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这次，我们将使用神经网络来预测客户的行为</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="e714" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">导入数据:</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="3083" class="ki kj hh ke b fi kk kl l km kn">df = pd.read_csv("../input/telecom-users-dataset/telecom_users.csv")<br/>df.head()</span></pre><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ko"><img src="../Images/14d1090ba461b8d48566619e758c5d31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sdIKwFM95qF4wUrQCyGXnw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">输出的一部分</figcaption></figure><p id="680f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们检查列的数据类型</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="f60e" class="ki kj hh ke b fi kk kl l km kn">df.info()</span></pre><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kp"><img src="../Images/15da6373aca2d1978da4ea607981cf5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oWo0Q_gJbD3YmJ-ByV06zQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">输出</figcaption></figure><p id="3e4d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">描述数据框架</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="452e" class="ki kj hh ke b fi kk kl l km kn">df.describe().T</span></pre><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kq"><img src="../Images/3ae5f8cab009815c823f7f48c9f59b5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jMlrKxIEPkMp0sI8AjTwUg.png"/></div></div></figure><p id="1436" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最好总是存储列的列表:</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="894b" class="ki kj hh ke b fi kk kl l km kn">cols = df.columns<br/>cols = list(cols)</span></pre><p id="bfe7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">数据预处理:</p><p id="8351" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">从前面的输出可以看出，有许多“Object”类型的列，它们需要被更改为numeric。</p><p id="f653" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这个过程被称为热编码。</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="8348" class="ki kj hh ke b fi kk kl l km kn"><em class="kr">#object type columns</em><br/>obj_cols = [column for column <strong class="ke hi">in</strong> cols if df[column].dtypes=='object']</span></pre><p id="cc83" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">以下是所有对象类型列</p><p id="16d1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在进行热编码之前，建议检查对象类型列的唯一值的计数。</p><p id="7942" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果任何一列包含许多不同的值，那么对该列进行一次热编码可能会导致太多的列特性。</p><p id="3124" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这可能会导致过度拟合，并大大降低模型的效率。</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="6805" class="ki kj hh ke b fi kk kl l km kn"><em class="kr">#Unique values in object columns</em><br/>for col <strong class="ke hi">in</strong> obj_cols:<br/>    print("---------------------------")<br/>    print(col)<br/>    print(df[f"<strong class="ke hi">{</strong>col<strong class="ke hi">}</strong>"].value_counts())</span></pre><p id="add2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">输出:</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="12ba" class="ki kj hh ke b fi kk kl l km kn">---------------------------<br/>customerID<br/>1705-GUHPV    1<br/>5215-LNLDJ    1<br/>4529-CKBCL    1<br/>7133-VBDCG    1<br/>2332-EFBJY    1<br/>             ..<br/>7801-CEDNV    1<br/>4565-EVZMJ    1<br/>8690-ZVLCL    1<br/>8100-HZZLJ    1<br/>5474-LAMUQ    1<br/>Name: customerID, Length: 5986, dtype: int64<br/>---------------------------<br/>gender<br/>Male      3050<br/>Female    2936<br/>Name: gender, dtype: int64<br/>---------------------------<br/>Partner<br/>No     3082<br/>Yes    2904<br/>Name: Partner, dtype: int64<br/>---------------------------<br/>Dependents<br/>No     4195<br/>Yes    1791<br/>Name: Dependents, dtype: int64<br/>---------------------------<br/>PhoneService<br/>Yes    5396<br/>No      590<br/>Name: PhoneService, dtype: int64<br/>---------------------------<br/>MultipleLines<br/>No                  2848<br/>Yes                 2548<br/>No phone service     590<br/>Name: MultipleLines, dtype: int64<br/>---------------------------<br/>InternetService<br/>Fiber optic    2627<br/>DSL            2068<br/>No             1291<br/>Name: InternetService, dtype: int64<br/>---------------------------<br/>OnlineSecurity<br/>No                     2982<br/>Yes                    1713<br/>No internet service    1291<br/>Name: OnlineSecurity, dtype: int64<br/>---------------------------<br/>OnlineBackup<br/>No                     2605<br/>Yes                    2090<br/>No internet service    1291<br/>Name: OnlineBackup, dtype: int64<br/>---------------------------<br/>DeviceProtection<br/>No                     2640<br/>Yes                    2055<br/>No internet service    1291<br/>Name: DeviceProtection, dtype: int64<br/>---------------------------<br/>TechSupport<br/>No                     2960<br/>Yes                    1735<br/>No internet service    1291<br/>Name: TechSupport, dtype: int64<br/>---------------------------<br/>StreamingTV<br/>No                     2389<br/>Yes                    2306<br/>No internet service    1291<br/>Name: StreamingTV, dtype: int64<br/>---------------------------<br/>StreamingMovies<br/>No                     2356<br/>Yes                    2339<br/>No internet service    1291<br/>Name: StreamingMovies, dtype: int64<br/>---------------------------<br/>Contract<br/>Month-to-month    3269<br/>Two year          1441<br/>One year          1276<br/>Name: Contract, dtype: int64<br/>---------------------------<br/>PaperlessBilling<br/>Yes    3528<br/>No     2458<br/>Name: PaperlessBilling, dtype: int64<br/>---------------------------<br/>PaymentMethod<br/>Electronic check             2006<br/>Mailed check                 1369<br/>Bank transfer (automatic)    1308<br/>Credit card (automatic)      1303<br/>Name: PaymentMethod, dtype: int64<br/>---------------------------<br/>TotalCharges<br/>20.2       10<br/>           10<br/>19.75       8<br/>19.55       7<br/>19.9        6<br/>           ..<br/>4414.3      1<br/>1261.35     1<br/>6885.75     1<br/>716.4       1<br/>2998        1<br/>Name: TotalCharges, Length: 5611, dtype: int64<br/>---------------------------<br/>Churn<br/>No     4399<br/>Yes    1587<br/>Name: Churn, dtype: int64</span></pre><p id="96db" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">客户ID肯定应该被删除，否则模型会把它弄得一团糟。</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="439b" class="ki kj hh ke b fi kk kl l km kn"><em class="kr">#Customer ID must be dropped, else the data is fine to be one hot encoded.</em><br/>df = df.drop('customerID', axis=1)<br/>obj_cols.remove('customerID')</span></pre><p id="ecbb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">开始了…..</p><p id="71d0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这一点上，我们可以热编码出特性。</p><p id="cf31" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为此，可以使用名为pd.get_dummies()的方法。</p><p id="02d9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这是一个非常强大的方法！只需两行代码，就可以对整个表进行热编码。！</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="fa57" class="ki kj hh ke b fi kk kl l km kn"><em class="kr">#One hot encoding</em><br/>for col <strong class="ke hi">in</strong> obj_cols:<br/>    df[col] = pd.get_dummies(df[col])</span><span id="5ea5" class="ki kj hh ke b fi ks kl l km kn">df.head()</span></pre><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es kt"><img src="../Images/f0b8563a8605ae165dd7ba0c53984c55.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*yZmzxfs4kEaQy0AUbJiYNw.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">如你所见，这些列是分开的。</figcaption></figure><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="b955" class="ki kj hh ke b fi kk kl l km kn">cols = list(df.columns)<br/></span></pre></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="b312" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">将数据分为训练和测试:</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="08aa" class="ki kj hh ke b fi kk kl l km kn"><em class="kr">#Split data</em><br/>X = df[set(cols)-set(["Churn"])]<br/>y = df["Churn"]</span><span id="5491" class="ki kj hh ke b fi ks kl l km kn">from sklearn.pipeline import make_pipeline<br/>from sklearn.preprocessing import StandardScaler<br/>from sklearn.ensemble import RandomForestClassifier<br/><br/><br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)</span></pre><p id="ac70" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">此时，我们可以将数据标准化。</p><p id="1ace" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">通过归一化，数据被调整，使得数据的平均值为0，标准偏差和方差被设置为1。</p><p id="b3a0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">对于规范化，StandardScaler()是sklearn.preprocessing提供的方法。</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="f2b2" class="ki kj hh ke b fi kk kl l km kn">sc = StandardScaler()<br/>sc.fit(X_train)<br/>X_train = sc.transform(X_train)<br/>X_test = sc.transform(X_test)<br/>X_train = pd.DataFrame(X_train)<br/>X_test = pd.DataFrame(X_test)</span><span id="2ebf" class="ki kj hh ke b fi ks kl l km kn">X_train.head()</span></pre><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ku"><img src="../Images/ec75632d2291371b3da7afdbb781a643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EW4DbQcev6TkD1iiSZK2NQ.png"/></div></div></figure><p id="e34f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如你所见，数据肯定和以前一样。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="da7d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">定义模型:</p><p id="72c8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">导入必要的库:</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="8b8c" class="ki kj hh ke b fi kk kl l km kn">from tensorflow import keras<br/>from keras.models import Sequential<br/>from keras.layers import Dense, Dropout</span></pre><p id="e8df" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">定义模型</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="95f3" class="ki kj hh ke b fi kk kl l km kn">model = Sequential([<br/>    Dense(32, activation='relu', input_dim=20),<br/>    Dropout(0.5),<br/>    Dense(16, activation='relu'),<br/>    Dense(1, activation='sigmoid')<br/>])</span></pre><p id="8c97" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">需要注意的非常重要的一点是，input_dim设置为20。</p><p id="6784" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为什么是20？</p><p id="622b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因为……数据集中有20个特征。如果这个值与特征的数量不一致，那么它会引起一些问题。</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="43d8" class="ki kj hh ke b fi kk kl l km kn">X_train.shape</span></pre><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es kv"><img src="../Images/b956a6e7e182bbe09c89d45754ef761c.png" data-original-src="https://miro.medium.com/v2/resize:fit:424/format:webp/1*93IT0VQsrj4XBY4jJMxlzg.png"/></div></figure><p id="4598" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du kw kx ky ke b">Also note the size of the output</code></p><p id="c628" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">编译模型，看一下总结。</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="fe5c" class="ki kj hh ke b fi kk kl l km kn">model.compile(optimizer='adam', loss='mean_squared_error', metrics=['accuracy'])<br/>model.summary()</span></pre><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kz"><img src="../Images/af3399febd5cd46515805a26248cde58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*maFZfLt-gc4St0c8X9i2Sw.png"/></div></div></figure><p id="95be" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">将数据放入模型:</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="1348" class="ki kj hh ke b fi kk kl l km kn">history = model.fit(X_train, y_train, batch_size=10, validation_split=0.2 ,epochs=100 ,callbacks=[keras.callbacks.EarlyStopping(monitor='val_loss',patience=3, restore_best_weights=True)])</span></pre><p id="958a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">历史对象具有属性“History ”,它是包含训练步骤日志的python字典。</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="23fc" class="ki kj hh ke b fi kk kl l km kn">history.history</span></pre><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es la"><img src="../Images/1820bfa8e104c0c18bd17edc7e136c2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*1DFrCo0YnIDAENsZ7Nm2CA.png"/></div></figure><p id="aff6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为了检查我们的模型的准确性，可以使用history.history的准确性键。</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="7bc2" class="ki kj hh ke b fi kk kl l km kn">plt.plot(history.history['accuracy'])<br/>plt.plot(history.history['val_accuracy'])<br/>plt.title('model accuracy')<br/>plt.ylabel('accuracy')<br/>plt.xlabel('epoch')<br/>plt.legend(['train', 'val'], loc='upper left')<br/>plt.show()</span></pre><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es lb"><img src="../Images/8e5666ba157a0dc5645c60fa597a6621.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*PHYLtkBnpTVqt6Rf6Zjbww.png"/></div></figure><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="4b70" class="ki kj hh ke b fi kk kl l km kn">plt.plot(history.history['loss'])<br/>plt.plot(history.history['val_loss'])<br/>plt.title('Loss')<br/>plt.ylabel('loss')<br/>plt.xlabel('epoch')<br/>plt.legend(['train', 'val'], loc='upper left')<br/>plt.show()</span></pre><figure class="jz ka kb kc fd ii er es paragraph-image"><div class="er es lc"><img src="../Images/5a4639d475c633d8c536da63840e9951.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*SUkRyVXx4gE-2IAMbAaeRg.png"/></div></figure><p id="10d9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">就是这样！！</p><p id="f9be" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们已经成功地实现了预测客户流失的神经网络。</p><p id="d496" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">你也可以尝试改变神经网络的领域。你可以调整网络，通过添加或删除一些层，改变激活…..等等。</p><p id="f56c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">PS:一定要看看我的笔记本，在那里我用不同的算法解决了同一个问题。</p></div></div>    
</body>
</html>