<html>
<head>
<title>Flipkart Data Analysis and NLP ML model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Flipkart数据分析和NLP ML模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/flipkart-data-analysis-and-nlp-ml-model-88f63ea39900?source=collection_archive---------1-----------------------#2021-11-24">https://medium.com/analytics-vidhya/flipkart-data-analysis-and-nlp-ml-model-88f63ea39900?source=collection_archive---------1-----------------------#2021-11-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/7b42f660c9bf93c6fcdea3f9befee127.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JagkhjJvVNgAiEBvnFDgqA.jpeg"/></div></div></figure><p id="7a69" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里我们将讨论Flipkart数据集上的一个<strong class="ir hi">端到端机器学习案例研究</strong>。描述性分析和NLP模型，通过产品的描述来预测类别。</p><p id="e053" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你可以从<a class="ae jn" href="https://www.kaggle.com/vaishnavsrivastava/flipkart-category-prediction-and-eda/data" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">下载数据从</strong> </a>下载笔记本从<a class="ae jn" href="https://www.kaggle.com/vaishnavsrivastava/flipkart-category-prediction-and-eda/notebook" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">这里</strong> </a>。</p><h2 id="5895" class="jo jp hh bd jq jr js jt ju jv jw jx jy ja jz ka kb je kc kd ke ji kf kg kh ki bi translated">关于数据</h2><ul class=""><li id="4f1a" class="kj kk hh ir b is kl iw km ja kn je ko ji kp jm kq kr ks kt bi translated">这是一个预先抓取的数据集，作为一个更大的数据集(超过580万件产品)的子集，该数据集是通过从印度领先的电子商务商店<a class="ae jn" href="http://flipkart.com/" rel="noopener ugc nofollow" target="_blank">Flipkart.com</a>提取数据而创建的。</li></ul><h2 id="fa43" class="jo jp hh bd jq jr js jt ju jv jw jx jy ja jz ka kb je kc kd ke ji kf kg kh ki bi translated">使用的工具</h2><ul class=""><li id="6ccc" class="kj kk hh ir b is kl iw km ja kn je ko ji kp jm kq kr ks kt bi translated">Python 3.6</li><li id="2aab" class="kj kk hh ir b is ku iw kv ja kw je kx ji ky jm kq kr ks kt bi translated">Numpy</li><li id="d1b1" class="kj kk hh ir b is ku iw kv ja kw je kx ji ky jm kq kr ks kt bi translated">熊猫</li><li id="a069" class="kj kk hh ir b is ku iw kv ja kw je kx ji ky jm kq kr ks kt bi translated">Matplotlib</li><li id="2574" class="kj kk hh ir b is ku iw kv ja kw je kx ji ky jm kq kr ks kt bi translated">海生的</li><li id="53ab" class="kj kk hh ir b is ku iw kv ja kw je kx ji ky jm kq kr ks kt bi translated">数据科学</li><li id="b837" class="kj kk hh ir b is ku iw kv ja kw je kx ji ky jm kq kr ks kt bi translated">机器学习</li><li id="35b8" class="kj kk hh ir b is ku iw kv ja kw je kx ji ky jm kq kr ks kt bi translated">Sklearn</li></ul><h2 id="29ae" class="jo jp hh bd jq jr js jt ju jv jw jx jy ja jz ka kb je kc kd ke ji kf kg kh ki bi translated">有数据的目标</h2><ul class=""><li id="ed5c" class="kj kk hh ir b is kl iw km ja kn je ko ji kp jm kq kr ks kt bi translated">电子设计自动化(Electronic Design Automation)</li><li id="3061" class="kj kk hh ir b is ku iw kv ja kw je kx ji ky jm kq kr ks kt bi translated">使用NLP制作一个ML模型来预测带有产品描述的产品类别</li></ul><h2 id="1af4" class="jo jp hh bd jq jr js jt ju jv jw jx jy ja jz ka kb je kc kd ke ji kf kg kh ki bi translated">数据有问题</h2><p id="c668" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kz jc jd je la jg jh ji lb jk jl jm ha bi translated">清理这些数据，在产品类别树中分离所有类别，找出主要类别，然后使用模型对此进行预测。</p><h1 id="bc68" class="lc jp hh bd jq ld le lf ju lg lh li jy lj lk ll kb lm ln lo ke lp lq lr kh ls bi translated">电子设计自动化(Electronic Design Automation)</h1><p id="e322" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kz jc jd je la jg jh ji lb jk jl jm ha bi translated">目的:<br/>从Flipkart数据中检索以下隐藏的见解。</p><p id="576b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">1.哪一年的销售额最高？</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div class="er es lt"><img src="../Images/4788921ca94b43968e512d55dde9321e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*BDrm9270iwd0NY1o5HqKPQ.png"/></div></figure><p id="f1fd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">2.一年中哪个月的销售额最高？</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div class="er es lt"><img src="../Images/27ba379ead3439c00a7b7f6bc411a153.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*eQOLG50xAQE924zznfpObw.png"/></div></figure><p id="de44" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">3.哪个类别的销售额最高？</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ly"><img src="../Images/ded14b1c96b75f919f6a5de3233b3988.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ph1zqcelC1Euhv-5Ofi2xQ.png"/></div></div></figure><p id="cde5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">4.女性在Flipkart上购买什么？</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ly"><img src="../Images/53d0f52eead05be21594236de3c42655.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bIjJBYJruIvfBNxxSUQRmg.png"/></div></div></figure><p id="3409" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">5.哪个类别有最大折扣？</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lz"><img src="../Images/95e2a5351703f5632d8b748f5f91a4b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PrAm5Ee2TW0Nqhvk45JFlQ.png"/></div></div></figure></div><div class="ab cl ma mb go mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ha hb hc hd he"><p id="63e1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi mh translated"><span class="l mi mj mk bm ml mm mn mo mp di">M</span>T15】使用NLP的机器学习模型</p><p id="76e7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">首先通过使用值计数来移除不需要的类别，由于数据非常不合适，该值计数小于10，在类别名称中包含产品名称。</p><pre class="lu lv lw lx fd mq mr ms mt aw mu bi"><span id="4297" class="jo jp hh mr b fi mv mw l mx my">value_count=df['main_category'].value_counts()<br/>to_remove=value_count[value_count&lt;=10].index<br/>df=df[df.main_category.isin(to_remove)==False]<br/>df.main_category.value_counts()</span></pre><p id="07c0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后通过创建一个函数从产品描述中删除符号、停用词来清理文本。<br/>通过转换为字符串将函数应用于描述列。</p><pre class="lu lv lw lx fd mq mr ms mt aw mu bi"><span id="ea05" class="jo jp hh mr b fi mv mw l mx my">REPLACE_BY_SPACE_RE = re.compile('[/()<strong class="mr hi">{}</strong>\[\]\|@,;]')<br/>BAD_SYMBOLS_RE = re.compile('[^0-9a-z #+_]')<br/>STOPWORDS = set(stopwords.words('english'))<br/><br/>def clean_text(text):<br/>    <em class="mz">"""</em><br/><em class="mz">        text: a string</em><br/><em class="mz">        </em><br/><em class="mz">        return: modified initial string</em><br/><em class="mz">    """</em><br/>    text = text.lower() <em class="mz"># lowercase text</em><br/>    text = REPLACE_BY_SPACE_RE.sub(' ', text) <em class="mz"># replace REPLACE_BY_SPACE_RE symbols by space in text</em><br/>    text = BAD_SYMBOLS_RE.sub('', text) <em class="mz"># delete symbols which are in BAD_SYMBOLS_RE from text</em><br/>    text = ' '.join(word for word <strong class="mr hi">in</strong> text.split() if word <strong class="mr hi">not</strong> <strong class="mr hi">in</strong> STOPWORDS) <em class="mz"># delete stopwors from text</em><br/>    return text<br/>   <br/><em class="mz">#applying function to description column by converting to string</em><br/>df['description'] = df['description'].astype(str)<br/>df['description'] = df['description'].apply(clean_text)</span></pre><blockquote class="na nb nc"><p id="d13b" class="ip iq mz ir b is it iu iv iw ix iy iz nd jb jc jd ne jf jg jh nf jj jk jl jm ha bi translated">模特培训</p></blockquote><p id="5e4d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">创建X(预测值)、y(目标值)变量并设置训练、测试分割。<br/>我们正在创建两个管道<br/>第一个——使用<strong class="ir hi">计数矢量器:</strong>将文本文档的集合转换为令牌计数的矩阵，以及<strong class="ir hi">多项式分类器:</strong>用于多项式模型的朴素贝叶斯分类器。</p><p id="0b3f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">第二，使用<strong class="ir hi">TF IDF矢量器:</strong>将原始文档集合转换为TF-IDF特征矩阵和<strong class="ir hi">多项式。</strong></p><p id="791a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">调整超参数以获得更好的精度，然后设置两个管道。</p><pre class="lu lv lw lx fd mq mr ms mt aw mu bi"><span id="8903" class="jo jp hh mr b fi mv mw l mx my"><em class="mz">Hyperparameter Tuning</em><br/>tuned_parameters = {<br/>    'vect__ngram_range': [(1, 1), (1, 2), (2, 2)],<br/>    'clf__alpha': [1, 1e-1, 1e-2]}<br/><br/>tf_params = {<br/> 'tvec__ngram_range': [(1, 1), (1, 2), (2, 2)],<br/> 'tvec__stop_words': [None, 'english'],<br/> 'clf1__alpha': [1, 1e-1, 1e-2]<br/> <br/>}</span><span id="5832" class="jo jp hh mr b fi ng mw l mx my"><em class="mz"># Setting up GridSearch for CountVectorizer</em><br/>clf = GridSearchCV(text_clf, tuned_parameters, cv=5, verbose =1, n_jobs = -1)<br/>clf.fit(X_train, y_train)<br/><em class="mz"># Setting up GridSearch for TfidVectorizer</em><br/>clf2 = GridSearchCV(tvc_pipe, tf_params, cv=5, verbose =1, n_jobs = -1)<br/>clf2.fit(X_train, y_train)<br/><br/><br/><em class="mz"># In[34]:</em><br/><br/><br/>print(clf.score(X_test, y_test))<em class="mz"># Scoring Training data on CountVectorizer</em><br/>print(clf.score(X_train, y_train))<em class="mz"># Scoring Testing data on CountVectorizer</em><br/>print(clf2.score(X_test, y_test))<em class="mz"># Scoring Training data on TFIDFVectorizer</em><br/>print(clf2.score(X_train, y_train))<em class="mz"># Scoring Testing data on TFIDFVectorizer</em><br/><br/><br/><em class="mz"># In[35]:</em><br/><br/><br/><em class="mz">#Classification report of CountVEctorizer</em><br/>predicted_clf=clf.predict(X_test)<br/>print(classification_report(y_test,predicted_clf))<br/><br/><br/><em class="mz"># In[36]:</em><br/><br/><br/><em class="mz">#Classification report of TfidVectorizer</em><br/>predicted_clf2=clf2.predict(X_test)<br/>print(classification_report(y_test,predicted_clf2))</span></pre><p id="558c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">模型训练后，我们得到预测</p><pre class="lu lv lw lx fd mq mr ms mt aw mu bi"><span id="79b8" class="jo jp hh mr b fi mv mw l mx my">0.9627594627594628<br/>0.9949114593934459<br/>0.9717134717134717<br/>0.9979645837573784<br/>                                    precision    recall  f1-score   support<br/><br/>                       Automotive        0.96      0.97      0.97       240<br/>                        Baby Care        0.85      0.81      0.83       128<br/>            Bags, Wallets &amp; Belts        0.92      0.85      0.88        78<br/>         Beauty and Personal Care        0.91      0.97      0.94       159<br/>            Cameras &amp; Accessories        0.83      1.00      0.90        19<br/>                         Clothing        0.99      0.98      0.99      1510<br/>                        Computers        0.96      0.89      0.92       151<br/>                         Footwear        0.97      1.00      0.98       322<br/>                        Furniture        1.00      0.96      0.98        55<br/>                           Gaming        0.70      0.88      0.78         8<br/>Health &amp; Personal Care Appliances        1.00      0.80      0.89        10<br/>                   Home &amp; Kitchen        0.67      0.86      0.75         7<br/>       Home Decor &amp; Festive Needs        0.97      1.00      0.99       234<br/>               Home Entertainment        0.20      0.50      0.29         2<br/>                  Home Furnishing        0.95      0.99      0.97       158<br/>                 Home Improvement        0.90      0.96      0.93        27<br/>                        Jewellery        1.00      1.00      1.00       846<br/>                 Kitchen &amp; Dining        0.96      0.90      0.93       166<br/>            Mobiles &amp; Accessories        0.99      0.93      0.96       283<br/>                Pens &amp; Stationery        0.90      0.73      0.81        78<br/>                     Pet Supplies        0.75      1.00      0.86         6<br/>                 Sports &amp; Fitness        0.83      0.93      0.88        43<br/>                       Sunglasses        1.00      1.00      1.00        10<br/>                 Tools &amp; Hardware        0.89      0.96      0.92       114<br/>           Toys &amp; School Supplies        0.78      0.94      0.85       107<br/>                          Watches        0.99      0.97      0.98       149<br/>                           eBooks        0.50      0.50      0.50         4<br/><br/>                          accuracy                           0.96      4914<br/>                         macro avg       0.87      0.90      0.88      4914<br/>                      weighted avg       0.96      0.96      0.96      4914<br/><br/>                                    precision    recall  f1-score   support<br/><br/>                       Automotive        0.96      0.98      0.97       240<br/>                        Baby Care        0.93      0.78      0.85       128<br/>            Bags, Wallets &amp; Belts        0.91      0.92      0.92        78<br/>         Beauty and Personal Care        0.98      0.97      0.97       159<br/>            Cameras &amp; Accessories        1.00      0.89      0.94        19<br/>                         Clothing        0.99      0.99      0.99      1510<br/>                        Computers        0.94      0.96      0.95       151<br/>                         Footwear        0.98      1.00      0.99       322<br/>                        Furniture        1.00      0.98      0.99        55<br/>                           Gaming        1.00      0.75      0.86         8<br/>Health &amp; Personal Care Appliances        1.00      0.80      0.89        10<br/>                   Home &amp; Kitchen        1.00      0.86      0.92         7<br/>       Home Decor &amp; Festive Needs        0.94      1.00      0.97       234<br/>               Home Entertainment        0.50      0.50      0.50         2<br/>                  Home Furnishing        0.95      0.99      0.97       158<br/>                 Home Improvement        1.00      0.93      0.96        27<br/>                        Jewellery        0.99      1.00      1.00       846<br/>                 Kitchen &amp; Dining        0.94      0.94      0.94       166<br/>            Mobiles &amp; Accessories        0.99      0.98      0.98       283<br/>                Pens &amp; Stationery        0.88      0.76      0.81        78<br/>                     Pet Supplies        1.00      0.83      0.91         6<br/>                 Sports &amp; Fitness        0.94      0.79      0.86        43<br/>                       Sunglasses        1.00      1.00      1.00        10<br/>                 Tools &amp; Hardware        0.96      0.96      0.96       114<br/>           Toys &amp; School Supplies        0.82      0.88      0.85       107<br/>                          Watches        1.00      0.99      0.99       149<br/>                           eBooks        1.00      0.25      0.40         4<br/><br/>                          accuracy                           0.97      4914<br/>                         macro avg       0.95      0.88      0.90      4914<br/>                      weighted avg       0.97      0.97      0.97      4914</span></pre><h1 id="9ee8" class="lc jp hh bd jq ld le lf ju lg lh li jy lj lk ll kb lm ln lo ke lp lq lr kh ls bi translated">总结:</h1><p id="1500" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kz jc jd je la jg jh ji lb jk jl jm ha bi translated">我们从csv文件中收集数据，并清理不使用的数据删除列。主要问题是如何使用简单的字符串替换方法将不同列中的列树列分开，并使用函数成功地将产品类别分开，并通过EDA了解2015年和2016年flipkart数据的许多见解。你可以查看我的<a class="ae jn" href="http://www.linkedin.com/in/vaishnav-srivastava-88a030119" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>账户。</p><p id="92e0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">带着快乐的字条谢谢。</p></div></div>    
</body>
</html>