<html>
<head>
<title>Introduction to Exploratory Data Analysis for Image &amp; Text-Based Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于图像和文本数据的探索性数据分析简介</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/introduction-to-exploratory-data-analysis-for-image-text-based-data-1179e194df3f?source=collection_archive---------0-----------------------#2021-04-09">https://medium.com/analytics-vidhya/introduction-to-exploratory-data-analysis-for-image-text-based-data-1179e194df3f?source=collection_archive---------0-----------------------#2021-04-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2224" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">今天，在本帖中，我们将为Kaggle上正在进行的比赛之一<a class="ae jd" href="https://www.kaggle.com/c/shopee-product-matching" rel="noopener ugc nofollow" target="_blank">Shopee-Price Match Guarantee</a>做一个简单而全面的EDA。探索性数据分析是解决任何数据科学或机器学习问题的第一步。这是熟悉您可以使用的数据的最简单的方法。你对数据了解得越多，你就离解决问题越近。</p><p id="691d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以，让我们把手弄脏，进入探索性数据分析的世界。这个问题是文本数据和图像数据的混合，因此探索它会很有趣。</p><h1 id="f1b6" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">第一步:理解问题陈述- </strong></h1><p id="089f" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">在你开始解题之前，首先你需要很好的理解问题陈述。所以，让我们先从这个开始。您可以在此处获得完整的问题陈述和数据描述:</p><div class="kh ki ez fb kj kk"><a href="https://www.kaggle.com/c/shopee-product-matching" rel="noopener  ugc nofollow" target="_blank"><div class="kl ab dw"><div class="km ab kn cl cj ko"><h2 class="bd hj fi z dy kp ea eb kq ed ef hh bi translated">专柜价格匹配保证</h2><div class="kr l"><h3 class="bd b fi z dy kp ea eb kq ed ef dx translated">通过图像确定两个产品是否相同</h3></div><div class="ks l"><p class="bd b fp z dy kp ea eb kq ed ef dx translated">www.kaggle.com</p></div></div><div class="kt l"><div class="ku l kv kw kx kt ky kz kk"/></div></div></a></div><p id="8703" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有一组图像和它们的产品类别。基于这些可用的信息，我们需要找到与给定产品相似的产品。</p><p id="e470" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">比如:</strong></p><p id="1d44" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于给定的产品A，我们需要找到与A最相似的其他50张图片。为此，我们需要关于每种产品的一些信息。我们将在这篇文章的后半部分研究这些可用的信息。</p><h1 id="b47a" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">第二步:分析数据帧:</strong></h1><h1 id="8451" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">列车数据:</strong></h1><p id="40bc" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">首先，我们将读取可用的数据帧，分析它们的形状和大小以及可用的数据类型。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es la"><img src="../Images/5b88b6cc9a00291ce28d807d43302a7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*BDldo1P31Xjwo6goH-O9Cg.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">将数据读入熊猫数据框</figcaption></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es ll"><img src="../Images/71697702e3ca59b00b3e6cda52b314e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*jRKTrhTxET78fp_gNTOoTg.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">数据帧的打印形状</figcaption></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es lm"><img src="../Images/acb744cea6d256ce2c5e8ee5e1875a31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qLzD2EYo3fjQRT1tu_LUcw.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">打印前几行</figcaption></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es lr"><img src="../Images/85b4533d207ffd7643982b7345ec1988.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*tOrTGTmdSnEnfNI-AiteDg.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">关于数据帧中每一列的信息</figcaption></figure><p id="026a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">发现数据见解很重要，在每一步写下观察结果也很重要。</p><h1 id="7e59" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">观察:</strong></h1><ol class=""><li id="d6d3" class="ls lt hi ih b ii kc im kd iq lu iu lv iy lw jc lx ly lz ma bi translated">我们有34250张训练图像。在我们的数据框架中，我们将图像标题作为文本特征。</li><li id="d87d" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">我们还有image_phash和label_group作为其他功能。相似的posting_id是我们需要为每张图片预测的。</li></ol><h1 id="76fb" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">测试数据:</h1><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es mg"><img src="../Images/1b83e8c85510d0ef09b99400685e1315.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*FAHOJ289F4KA8ZNnkiyQ5A.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">读取测试数据帧</figcaption></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es mh"><img src="../Images/7150961cfc04c064d718eb73706806d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*zELbo5dHKB1L8XkquQ0I4Q.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">分析测试数据的形状</figcaption></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es mi"><img src="../Images/ef4827b755a83c42e71d4335db6b5cc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*otu7tEVeNYgukiNb_4hsiw.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">分析前几行测试数据</figcaption></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es mj"><img src="../Images/ef2e8e7f3abdc84de0c17bcd271054bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*yVsWoK8T78jxfgEjLkVI7g.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">分析关于每列的信息</figcaption></figure><p id="5bbe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在已经看到了我们的测试和训练数据帧。现在，我们需要从数据集中找到一些见解，看看列之间是否存在任何类型的隐藏模式或关系。因为我们只有5列，所以分析每一列并不困难。因此，我们将从相同的开始。</p><h1 id="e677" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">步骤3:浏览数据列:</strong></h1><h1 id="9167" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">标签_组:</strong></h1><p id="a2e5" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">我们将从label_group开始。该列不是为测试数据集提供的。并且，给定同一label_group中的图像最相似。因此，在某种程度上，这就像我们的目标标签。因此，让我们在这一领域进行更多探索:</p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es mk"><img src="../Images/97720c90924f26a59ec2ea9d3dc1c488.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J0UWRyq4XYLITJpgwTtxGg.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">按Label_group分组以查看每个标签的数量</figcaption></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es ml"><img src="../Images/939af0b20b9a5c8262a41e85a19934d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*sKLq0UmSDSSrubDP6xU2MA.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">检查重复的标签组</figcaption></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es mm"><img src="../Images/2e5052dd4f21c125f3e9bb008599fe1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*B8ufY-PzaawUzhCskis-dg.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">唯一标签组的数量</figcaption></figure><h2 id="5c8c" class="mn jf hi bd jg mo mp mq jk mr ms mt jo iq mu mv js iu mw mx jw iy my mz ka na bi translated"><strong class="ak">绘制每个标签组中的图像数量:</strong></h2><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es nb"><img src="../Images/975dab20a2dd3801d18d8270374f66d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qFJybP3bC103XyFqXOdCYg.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">条形图前50个标签组的每个标签中的图像数量</figcaption></figure><h1 id="5d24" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">观察:</strong></h1><ol class=""><li id="7868" class="ls lt hi ih b ii kc im kd iq lu iu lv iy lw jc lx ly lz ma bi translated">从以上信息中，我们可以看到，对于任何label_group，属于类似label_group的产品的最大数量是51。</li><li id="6585" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">在我们的训练数据集中有23236个重复的标签组，因为许多产品共享相同的label_group。</li><li id="49e7" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">总共有11014个独特的标签。由于标签的数量非常大，这不能被视为简单的分类问题。</li></ol><h1 id="c0df" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">标题:</strong></h1><p id="61c1" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">现在，我们也给出了每张图片的标题。我们将探索这一领域，并找出类似产品/图片的这些图片有多相似。标题相同或相似的图像很可能也是相似的，应该属于同一类别。让我们找出这种可能性的机会，看看它是否真的成立:</p><p id="1432" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了分析标题，我们首先从分析标题的长度开始。因此，我们找出每个标题的字数。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es nc"><img src="../Images/38fc1123c66198cc3a8b15bab3f5ffef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lynEf0hJfovfqOtTEWi_ZQ.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">添加新列标题_长度</figcaption></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es nd"><img src="../Images/4436c4890e83ad411daec0a4810551d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DRP4HjMvY6yAM8SN1gMqag.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">检查最小标题长度</figcaption></figure><p id="0aeb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们看到任何标题的最大字数是61(不是很大的数字)，最小是1。</p><p id="f1d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">为了更清楚，让我们在标签组的标题上画一个单词云(通过随机选择),看看我们是否能找到什么。由于标题的长度不是很大，我们可以从wordcloud中获得一个很好的视图。</strong></p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es ne"><img src="../Images/a4159ade389d0143a890713c35f5f7b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*lE0kPb5E3AjFpXrpscdVrw.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">文字云图片来自group_label: 1163569239</figcaption></figure><p id="72f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，4个单词的出现次数比题目中出现的其他单词要多得多。另外，SCARLETT这个词还有另一种变体，我们也看到了。美白也是一样。因此，为了分析标题，重要的是所有的单词都要用相同的大小写。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es nf"><img src="../Images/dc5f9b8014db44c2358c8b9ddb433a24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*tsVe7iJQJAjjs9UKXVbfyA.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">分析特定标签组的标题长度</figcaption></figure><p id="c874" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们看到在标题长度和标签组之间没有这样的关系。</p><p id="192d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们对一个label_group执行的一系列title_length操作，与我们对更多label _ group执行的操作相同。</p><p id="42dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">不同标签组的标题分析:</strong></p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es ng"><img src="../Images/25e89e60b2e652c396c0cb54bb8165eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*k-qoNyqC2S2h9a2LJT8C8Q.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">文字云图片来自group_label: 2357508171</figcaption></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es nh"><img src="../Images/e092536b770d4811c31d49638c2ce2cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*lpHNcB7LS0eTeZTq4MFAgQ.png"/></div></figure><h1 id="9c68" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">观察:</strong></h1><ol class=""><li id="8dbf" class="ls lt hi ih b ii kc im kd iq lu iu lv iy lw jc lx ly lz ma bi translated">属于不同标签组的产品有完全不同的词。因此，可以得出结论，所有权在这个问题上起着重要作用。</li><li id="c992" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">此外，对于属于同一label_group的产品，很少有词出现得更频繁，这再次支持了上述说法。</li><li id="a8b5" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">对于属于同一label_group的图像，标题中的字数没有关系。</li><li id="1d2e" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">对于同一标签组中的图像，散列值分布很广。</li></ol><h1 id="6508" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">图像_相位分析:</strong></h1><p id="d4d4" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">Image_phash给出了每张图片对应的hash_vale。让我们首先分析几个例子，如果属于相同label_group的图像具有相同或不同散列值的图像。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es ni"><img src="../Images/cc1a6f7ad9731564476a7cebee6aef14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*LgA2S-eFCaT8SsH0uFYJ_Q.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">image _ phash for label _ groip 235708171</figcaption></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es nj"><img src="../Images/4c0449632728715fe440771ec59b0283.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*kQ4bzlRrsRitC1oW5OJzVA.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">image _ phash for label _ groip 1163569239</figcaption></figure><p id="ed79" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经检查了属于同一个label_group的图像可能具有不同的hash _ values。让我们检查具有相同散列值的图像是否具有不同的标签组。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es nk"><img src="../Images/08fe9d5b853bd6e50a9672268ad57210.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NXwYHY71RDDu-k-aPOPwBg.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">根据hash_value检查图像的分布</figcaption></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es nl"><img src="../Images/2f97594d2d84ceafb83586dbd066f269.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ipTNZfMqhzoCHMyDgR0Psw.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">检查来自不同标签组的图像是否具有相同的散列值</figcaption></figure><h1 id="f91c" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">观察:</strong></h1><ol class=""><li id="7c3b" class="ls lt hi ih b ii kc im kd iq lu iu lv iy lw jc lx ly lz ma bi translated">存在相同的hash_value图像属于不同组的情况。但是可以说，大多数只属于同一个label_group。</li><li id="7a36" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">我们被给定一个感知散列值，因此为了计算两幅图像之间的相似性，我们将考虑汉明距离。</li><li id="c6dd" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">Hash_value也是给定图像的一个重要特征。我们需要小心地使用它和其他可用的特征来找出最相似的图像</li></ol><p id="10e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">图像哈希分析辅助函数:</strong></p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es nm"><img src="../Images/534ca6c73b01df6d829710d0ca532871.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e8i8F3VcD5-nYH2ZZmbf-w.png"/></div></div></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es nn"><img src="../Images/06d9dc5ec8d43c7e0c4719a353117269.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vQxbnI1xhPltfyJygJ5hew.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">基于前1000个图像的Hash_Value构建图像矩阵</figcaption></figure><p id="5bf6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们正在寻找类似的产品图像。首先，我们可以根据这里计算的价值，为每种产品选择50种最相似的产品。</p><p id="63e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这可以使用以下代码来完成:</p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es no"><img src="../Images/35ec09a51b5d2fc856f12ec925a7ba4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vHc1aygAVBk448xyFfk2Ug.png"/></div></div></figure><p id="0cb5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在为了清晰直观，我们从这本字典中为每种产品绘制了排名前50位的产品。这里的信息可能不太准确，因为我们不是考虑38k行的整个数据集，而是只考虑前1000行。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es np"><img src="../Images/7f641330912b7da01615f412e940e30e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RofAHzoZ7ZRTIFoLhVjMZg.png"/></div></div></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es nq"><img src="../Images/c58a247f840c53604727d68e24a4048b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*C1tHE0pOH85VQe0wfQIOGg.png"/></div></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es nr"><img src="../Images/ef02ef4c281f440ad3f6393c43b2225a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AMHvG5S3wMK7-8Pk_I02TA.png"/></div></div></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es ns"><img src="../Images/6f3c574df8b94ee2a269016b8ab46368.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*Sx0HNh66QSx9M9Gspq7jRg.png"/></div></figure><h1 id="fb62" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">观察:</strong></h1><p id="e016" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">基于这些，结果并不乐观。这也可能是因为我们只是拍摄了图像样本。让我们尝试使用前10个图像，将它们的匹配hash_value与数据集中的所有图像进行比较。</p><p id="c8ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">现在，如果我们对随机选取的图像进行分析，并将hash_value与数据集中所有可用的图像进行比较，让我们看看这是如何工作的。</strong></p><h2 id="79b2" class="mn jf hi bd jg mo mp mq jk mr ms mt jo iq mu mv js iu mw mx jw iy my mz ka na bi translated">对于索引2937:</h2><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es nt"><img src="../Images/39b9e409ef3919aef7996fe8d4124082.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*HGdNK0hIHtz7CdUuE1U1Zg.png"/></div></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es nu"><img src="../Images/7c0c689851d02fbbf92697bf529b6b9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*238i12ULPXY8ZjcAF88FRQ.png"/></div></div></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es nv"><img src="../Images/7b935dbb4cd82b72a2d8b8c8edfaefdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*U4Xh2PWgrW8Baag9ZKlxAw.png"/></div></figure><p id="a48d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">哇！这一次的结果要好得多。因此，我们必须明智地利用完整的数据。与子集进行比较没有帮助。</p><p id="be7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为进一步的分析，您还可以检查基于hash_value发现相似的图像是否具有相同的标签。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es nw"><img src="../Images/cf5b83e5a31a0cd717b1781d8102a77f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UADJmFO_rZAB--nSXzBeZA.png"/></div></div></figure><h1 id="65e5" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">观察:</strong></h1><ol class=""><li id="1a22" class="ls lt hi ih b ii kc im kd iq lu iu lv iy lw jc lx ly lz ma bi translated">我们得到了很好的结果，但只是在有相同hash_value的图像的情况下。因此，人们可以在某种程度上依赖这种技术。这也清楚地表明hash_value是这里要考虑的一个重要参数。</li><li id="0747" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">我们看到，基于hash_difference的前50个相似图像中没有一个是带有相同标签的图像。我们将使用海明距离重复这些步骤，看看是否有所发现。</li></ol><p id="cfbd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">图像分析:</strong></p><h1 id="6da2" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">绘制具有相同标签_组的图像:</strong></h1><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es nx"><img src="../Images/7f6c7ada78f6fd7fefeea943e2a0e928.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vmz8zeCJhN_p_RVYap9T9Q.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated">具有相同标签组的图像样本</figcaption></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es np"><img src="../Images/559e64e6f841926ae90f6ea76237176c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lr_q7yc1D754JxsEHZMcJg.png"/></div></div></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es ny"><img src="../Images/97dd66c5e1a7b3aa82829ec4731b67a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IIcrb0WqTy0FI-0QI1Vuyg.png"/></div></div></figure><h1 id="aab0" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">使用相同的散列值绘制图像:</h1><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es nz"><img src="../Images/8241fc3eb7e6e0d58786fb4d8c3e38c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UVs2F2zIxfgfNeneqRbD2g.png"/></div></div></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es oa"><img src="../Images/39048e69d9afbdfe4ac33a03f4e53299.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ua91YUBvKHjWNP4gKlw7g.png"/></div></div></figure><h1 id="680c" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">观察:</strong></h1><ol class=""><li id="1dc2" class="ls lt hi ih b ii kc im kd iq lu iu lv iy lw jc lx ly lz ma bi translated">每个图像的Hash_value是任何给定图像的重要特征，它有助于将相似的图像分组在一起。</li><li id="5010" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">对于感知哈希，汉明距离是计算两个给定图像之间相似性的主要度量。</li><li id="b7ba" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">汉明距离值越短(值越小)，图像越相似。</li></ol><h1 id="e8e4" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak">基于标题分析图像相似度:</strong></h1><p id="1eee" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">正如我们前面看到的，标题是一个重要的特性。让我们看看基于标题比较的结果有多好。在根据标题计算相似度之前，我们将执行一些简单的文本转换技术。</p><p id="5119" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们之前看到的，所有的标题都应该是相同的大小写，我们将会相应地做。为了计算基于标题的相似性，我们使用了<a class="ae jd" href="https://pypi.org/project/fuzzywuzzy/" rel="noopener ugc nofollow" target="_blank"> fuzzywuzzy </a>库。</p><p id="93af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">助手功能:</strong></p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es ob"><img src="../Images/78ce3d85eae0d2289bd7920010da27a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*7RfDfsirNqoiWaxE26Eo9A.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">计算模糊率的函数</figcaption></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es oc"><img src="../Images/739ed4768ee3fecc70b2fe817c800e38.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*JOmygHVnZ6NCal2EDNyOVw.png"/></div></figure><p id="f676" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">对于索引0: </strong></p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es od"><img src="../Images/5e93dcb3b26346c75017e5083af74710.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*tmq8y4qrDdwZOJvYRpx8ew.png"/></div></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es oe"><img src="../Images/5fe36695e64722bd5df16b177aaab99c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*HpDqV8NJ0G25Uv3UrCQedg.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">根据模糊率，将相似图像排在索引为0的图像的前面</figcaption></figure><p id="7d83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">对于指数10: </strong></p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es of"><img src="../Images/837fc2cea987adc3aa68b1bcff9ae6bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*Cscf6tEXincZLKHjvwiBGg.png"/></div></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es og"><img src="../Images/f09e4713c03ebde945c39023e81e9343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*etrFcLYjxOeD1_gK-klMzQ.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">根据模糊率，将相似图像排在索引为10的图像的前面</figcaption></figure><p id="20e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">对于指数30: </strong></p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es oh"><img src="../Images/5070a2181d966d08fb58c4ceaddfbfff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*jsRoj5f7a5B7kasi9O98vQ.png"/></div></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es ob"><img src="../Images/9cd0039e611d260629cb1d4676f174d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*HS09xjabN4M0GnooEu-WVA.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">根据模糊率排列与索引为30的图像最相似的图像</figcaption></figure><h2 id="e4be" class="mn jf hi bd jg mo mp mq jk mr ms mt jo iq mu mv js iu mw mx jw iy my mz ka na bi translated"><strong class="ak">一个重要的观察结果:</strong></h2><p id="e77c" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">基于标题的index_30产品的相似图片看起来不合适。因此，我们使用label_group运行检查。我们观察到的是一个很大的错误:</p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es oi"><img src="../Images/6242d574cdbf724dd3ad2d843615f6c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1cOFi1Cglhv6qjZRknjKYQ.png"/></div></div></figure><p id="76c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们看到，根据标题，与索引30处的图像相似的所有图像属于不同的label_group。为了找出发生了什么，我们进一步查看与索引30处的图像具有相同label_group的所有图像。</p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es oj"><img src="../Images/d8ab8b26f039277853135f12c20c0be5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JdYncl0tF34X9smKYJRBcw.png"/></div></div></figure><p id="9272" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="ok">而且，这给了我们错误。我们看到术语</em> <strong class="ih hj"> <em class="ok">莫伊纳·卡夫坦</em> </strong> <em class="ok">在两个标题中都存在，但是因为完整的字符串不相同，所以我们得到较低的模糊率。为了解决这个问题，我们需要识别分隔符并查找最大比率。为了实现这一点，我们编写了计算模糊率的函数的改进版本，如下所示:</em></p><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es ny"><img src="../Images/222989e17b1359970e382330faa44355.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a5rhH8KKPVPsAwjNXFwa_g.png"/></div></div></figure><p id="337d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">现在我们用这个新函数再次计算指数30:</strong></p><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es ol"><img src="../Images/fdf5c41f2fb7bc8451274f9954ad9264.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*NxT9BalafOvXqhNSXTX9Cg.png"/></div></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="er es od"><img src="../Images/c6c3e42fb21efae98accee649ccadaf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*6KH_NvE_InXi0W28rqkFcA.png"/></div></div></figure><figure class="lb lc ld le fd lf er es paragraph-image"><div class="er es om"><img src="../Images/9755fdc60d354e482e5dcfddcfd35147.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*d9O_WfykI6orDxyZeXj6lg.png"/></div></figure><p id="8623" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们看到，所有根据标题与索引30处的图像相似的图像都属于不同的label_group。为了找出发生了什么，我们进一步查看与索引30处的图像具有相同label_group的所有图像。</p><p id="18c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并且，这给了我们错误。我们看到术语 <strong class="ih hj"> <em class="ok">【莫伊纳·卡福坦</em> </strong> <em class="ok">在两个标题中都存在，但是因为完整的字符串不相同，所以我们得到了较低的模糊率。为了解决这个问题，我们需要识别分隔符并查找最大比率。为了实现这一点，我们编写了计算模糊比率的函数的改进版本，如下所示:</em></p><p id="80dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">现在我们用这个新函数再次计算指数30:</strong></p><p id="e483" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在有类似的产品了。因此，添加分隔符逻辑解决了我们的问题。</p><p id="b0c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">观察:</strong></p><ol class=""><li id="1a58" class="ls lt hi ih b ii ij im in iq on iu oo iy op jc lx ly lz ma bi translated">标题是一个重要的特征。我们不应该忽略标题中的单词。模糊率越高，图像越相似。</li><li id="7cae" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">不仅仅是标题我们发现image_hash_value也是一个重要的特性。</li><li id="3132" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">我们没有考虑图像本身来计算相似性，因此，我们也可以这样做。</li><li id="fe93" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated">我们需要想出一种方法，将这些参数结合起来，以最佳的方式给我们带来最相似的图像。</li></ol><p id="6fdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">遗言..</strong></p><p id="de62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嗯，这很简单，但我们得到了一些惊人的见解。这显示了执行探索性数据分析的力量和魔力。我希望你喜欢这篇文章。</p><p id="4ffe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完整的代码请参考:<a class="ae jd" href="https://www.kaggle.com/mansichoudhary3296/shopee-1" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/mansichoudhary3296/shopee-1</a></p><p id="a990" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">参考文献:</strong></p><ol class=""><li id="16f8" class="ls lt hi ih b ii ij im in iq on iu oo iy op jc lx ly lz ma bi translated"><a class="ae jd" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">https://www.appliedaicourse.com/</a></li><li id="72ca" class="ls lt hi ih b ii mb im mc iq md iu me iy mf jc lx ly lz ma bi translated"><a class="ae jd" href="https://www.kaggle.com/c/shopee-product-matching/code" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/c/shopee-product-matching/code</a></li></ol></div></div>    
</body>
</html>