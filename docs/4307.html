<html>
<head>
<title>What is Bootstrapping in Machine learning ?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是机器学习中的自举？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/what-is-bootstrapping-in-machine-learning-777fc44e222a?source=collection_archive---------1-----------------------#2021-09-21">https://medium.com/analytics-vidhya/what-is-bootstrapping-in-machine-learning-777fc44e222a?source=collection_archive---------1-----------------------#2021-09-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d687" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大多数统计学处理的是比较两个事物，并确定它们在现实中是否不同，或者只是我们随机观察到我们收集的样本有差异，但实际上没有差异。这就是统计学如此令人兴奋的原因。比如iphone13的性能真的比iphone10好吗？或者我建立的机器学习模型真的比现有的系统更好吗？</p><p id="74b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以iphone为例，你会怎么做？假设您根据打开优步应用程序所需的毫秒数来衡量性能。所以你会打开应用程序很多次，并注意每一次两部手机所用的时间。</p><p id="d382" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">iphone13 = [120，100，110，90，115，123，114，103，111，107，103，118，113，112，121，110，117，115，119，108，124，111，112，113，113，11，112，110，109，109]</p><p id="dcb1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">iphone10 = [123，119，115，112，100，121，125，122，125，123，128，122，119，118，112，112，126，122，123，127，122，123，119，129，122]</p><p id="81ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设这是您观察到的情况，并且现在想要找出性能之间是否存在实际差异。</p><h1 id="97f2" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">天真的方法</h1><p id="c4ff" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">一种天真的方法是采取手段进行比较</p><p id="2fb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">iphone13_mean =108.43</p><p id="d632" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">iphone10_mean =120.63</p><p id="9e7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在你可以得出结论，iphone13表现更好。</p><p id="d7f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，如果你进行另一组测量，你能确定这种差异会再次被观察到吗？你能放心地去告诉你的经理，是的，他们的表现有所不同吗？如果他们进行自己的实验，发现两个模型实际上非常相似，该怎么办？</p><p id="9d43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你怎么能确定？</p><h1 id="15f4" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">传统方法</h1><p id="9ade" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">第二种方法是传统的统计测试</p><p id="0078" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这种方法中，您</p><ol class=""><li id="097d" class="kg kh hi ih b ii ij im in iq ki iu kj iy kk jc kl km kn ko bi translated">计算t统计量</li><li id="e2a5" class="kg kh hi ih b ii kp im kq iq kr iu ks iy kt jc kl km kn ko bi translated">在t表中查找理论分布</li><li id="04e8" class="kg kh hi ih b ii kp im kq iq kr iu ks iy kt jc kl km kn ko bi translated">如果你发现T的观察值的概率在理论分布的上5%(相当任意的阈值)，那么你得出结论，观察到的差异不是因为随机的机会</li></ol><p id="2414" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于刚刚接触统计测试的人来说，这些测试感觉很武断，因为它们通常像黑盒一样，使用解释不清的阈值，比如5%</p><p id="cd22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">问题来了:我们能做得更好吗？</p><h1 id="7332" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">拔靴带</h1><p id="cf02" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">Bootstrapping是由Bradley Efron(我猜和扎克·埃夫隆没有关系)在1979年提出的[EFRON_1979]。他指出，传统的方法是参数化的，依赖于正态分布理论</p><p id="fcd3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种[传统]方法最明显的缺陷是使用正态分布理论来确定观察值变得“显著”的临界值。主要自1950年发展起来的非参数统计给出了一个不依赖于正常理论的答案</p><p id="62d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">他提出了什么建议？</p><p id="3bed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">他说如果我们真的想确定iphone13比iphone10更好。那么，让我们先假设它们不是，我们所做的所有测量都是针对一款名为iphone_base的基础iphone型号，苹果公司巧妙地将它重新命名，并作为iphone10和iphone13销售。</p><p id="9974" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以现在我们有了</p><p id="4590" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">iphone_base= [120，100，110，90，115，123，114，103，111，107，103，118，113，112，121，110，117，115，119，108，124，111，112，113，113，11，112，110，109，109，122</p><p id="a66a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，如果我们考虑这个iphone_base的所有可能的等分(因为我们对每部手机进行了相同数量的测量),那么只有一个</p><p id="ff5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">N = 60！/ (30!30!)将符合我们观察到的。其余所有组合将混合iphone13和iphone10的尺寸。</p><p id="fd38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这N个组合的每一个中，我们计算(分割A的平均值)和(分割B的平均值)之间的差。因为我们已经混合了测量值，所以我们应该期望差异接近于零，除了我们实际观察到的情况。如果观察到的差异在计算的所有N个差异的5%之内，那么我们可以说观察到的差异在统计上是显著的。</p><p id="3aa3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在问题是60！/ (30!30!)是超过万亿个组合，这对于仅仅60个值来说也是如此！</p><p id="f650" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如埃夫龙所说，“非参数方法为摆脱正态分布理论付出了高昂的计算代价。”是啊，让我们称之为僵硬。</p><p id="79a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是他确实强调了这一点，如果我们试图确定我们的结论，我们可以直接进行计算，而不是对其进行参数假设。</p><p id="d305" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好了，我们明白了，这是一个很酷的方法，实际上并不实用，所以基本上是无用的，我们必须回到那些黑盒t测试，对吗？</p><p id="2cc4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不，这是事情变得有趣的地方，随机性来拯救。</p><p id="f10c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">想法是，如果我们不评估所有可能的组合，而是评估随机选择的组合中选定的数量(N ),其中n &lt;&lt;&lt;&lt; N？那能行吗？</p><p id="e2e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">太好了。</p><p id="8c5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的关键是随机选择替换。</p><p id="617e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于我们拥有的数据，假设我们决定n= 10，000。</p><p id="ef26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后我们用替换从我们的观察中取样。将其分成2等份，计算并记录两个样本平均值之间的差异。</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div class="er es ku"><img src="../Images/d809dd6e958ccd6403a9c04ccb2cf2ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*9MLJMMU4WlflTfwXlRGLjg.png"/></div></figure><p id="1669" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种自举差异看起来像什么？</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div class="er es lc"><img src="../Images/6126fb7878d886e1a66e6962dabd6f37.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*nCDsWSZaZxdXfrnbKmmaeg.png"/></div></figure><p id="5901" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我们所期望的，对吗？因为我们结合了两部iphones的测量结果，我们预计平均而言，随机样本将包括两部手机的测量结果，平均值的差异应该接近于零。</p><p id="bd67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们之前观察到的是</p><p id="8d54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">iphone13_mean =108.43</p><p id="b38e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">iphone10_mean =120.63</p><p id="3d49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的差异是12毫秒。在上图中，我们观察到这种差异的可能性有多大？不太可能，意味着表演确实不同。另一件要注意的事情是，如果观察到的差异是2毫秒，那么看上面的图，我们将无法得出这些实际上是不同的结论，因为根据上面的图/分布，观察到2毫秒的差异是非常可能的。</p><p id="3b6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以假设数据正态分布，均值为0，标准差为4.04(根据自举差异数据计算)，而不是目测图表。现在使用正态分布的累积分布函数我们可以找到获得+- 12毫秒的精确概率。</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div class="er es ld"><img src="../Images/cd6a57cf1f91ba59b7e347550053bf1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*l6gaig34_w6nI4Nxsz4Pdw.png"/></div></figure><p id="5b9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，这个值大约为0.0025，因此，如果这些观察真的是针对真实的iphone_base模型，那么只有0.25%的机会观察到12毫秒的差异。</p><h1 id="abbd" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">自举为什么有效？</h1><p id="ce48" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">哦，孩子，你真的很好奇，不是吗？</p><p id="5a9f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我尝试失败。</p><p id="cdfa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">想象一下，你可以接触到所有生产过的iphone13和iphone10，并且在这些手机生产出来并准备发货后，你已经对它们进行了测量。所以基本上你可以接触到所有可能的性能测量。</p><p id="d271" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，既然您已经有了所有可能的度量，即使上面讨论的简单方法也可以。就把所有可能的差异(如果你能收集所有的iphones，我打赌你也能做到这一点。一起玩)并接受他们意思，然后结束它。</p><p id="ba11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在假设你从所有可能的差异计算中随机抽取样本。那么对于每个随机样本，你会得到一个与原始方法相比略有不同的估计值(平均值)。这种差异称为抽样误差，这种估计值的分布称为估计值的抽样分布(见下图左侧)。其中θ是iphone13和iphone10的性能差异。theta、theta…等是从人群的每个随机样本中观察到的iphone13和iphone10的性能差异)</p><p id="cfa7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，为了真正确定iphone13和iphone10的性能存在差异，我们可以查看采样分布，并计算在此采样分布中观察到差异的可能性有多大。</p><p id="275d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但问题是，不，我们不能收集所有可能的iphone13s和iphone10s，不，我们不能计算所有可能的差异，不，我们不能从真实人群中抽取样本。</p><p id="8b05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是自举的用武之地。</p><p id="66b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Boostrapping帮助我们估计标准误差，方法是从现实生活中我们通常拥有的唯一样本中抽取随机样本进行替换(见下图右侧)。</p><p id="8b3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个的理论证明超出了我的解释，因为它变得太数学太快，但可以在这里找到一个愉快的阅读；)【SWANEPOEL】</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es le"><img src="../Images/51454632976fb67f7507f834791f412a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0h_YbGF_uVenmw33pbwTOQ.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">自举如何工作</figcaption></figure><p id="4b33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">还有什么问题吗？请随时通过LinkedIn 联系我</p><h1 id="197e" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">来源</h1><p id="75a8" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">[EFRON _ 1979](【https://sci-hub.se/https://doi.org/10.1137/1021092】T2</p><p id="4b59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">【SWANEPOEL】(<a class="ae ln" href="https://sci-hub.se/https://doi.org/10.1080/03610928608829303" rel="noopener ugc nofollow" target="_blank">https://sci-hub . se/https://doi . org/10.1080/03610928608829303</a>)</p></div></div>    
</body>
</html>