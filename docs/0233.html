<html>
<head>
<title>Overfitting vs Underfitting: The Guiding Philosophy of Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">过度适应vs欠适应:机器学习的指导哲学</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/overfitting-vs-underfitting-the-guiding-philosophy-of-machine-learning-c6ce5fe9f9bb?source=collection_archive---------8-----------------------#2021-01-09">https://medium.com/analytics-vidhya/overfitting-vs-underfitting-the-guiding-philosophy-of-machine-learning-c6ce5fe9f9bb?source=collection_archive---------8-----------------------#2021-01-09</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/719fd32caac9a98e69bb69b72a5d122e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0gceucQTxCChDpuIPyaJRg.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">照片由来自<a class="ae it" href="https://www.pexels.com/photo/white-puzzle-piece-on-blue-textile-5505122/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">佩克斯</a>的<a class="ae it" href="https://www.pexels.com/@mike-van-schoonderwalt-1884800?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">迈克·范·肖特沃特</a>拍摄</figcaption></figure><p id="1c71" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们面对现实吧，甚至在我们真正接触数据科学之前，我们可能已经听说过这两个术语:过度适应和欠适应。这两个术语应该被视为机器学习的指导原则的原因是，现有的每个机器学习模型都符合这两者之间的权衡，这反过来决定了它们的性能，因此每个机器学习算法都试图创建在它们之间提供最佳权衡的模型。</p><h1 id="2ffc" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">但是我们为什么关心它呢？</h1><p id="ea61" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">每当我们使用机器学习对任何数据进行建模时，最终目标是当向训练好的模型提供一组以前看不到的输入时，该模型应该能够正确地预测输出标签。那么这个模型是如何实现的呢？这是通过在训练过程中学习从输入到输出标签的一组决策映射或简单函数来实现的。</p><p id="1a6a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因此，我们的模型的有效性和性能只有在使用以前未见过的数据进行评估时才能实现。那么，我们怎么能说一个模型是否会对以前看不到的数据做出好的预测呢？这取决于模型的“可推广性”,即，如果模型在训练期间学习的决策映射对以前未见过的数据仍然有效，从而为它们产生正确的预测，则该模型可被视为可推广的。</p><p id="61ba" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">正如我们将了解到的，过度拟合和欠拟合都是模型推广的障碍；一个完美的一般化模型不会有任何过拟合或欠拟合。尽管在现实中，不可能实现一个完美的没有过度拟合和欠拟合的通用模型。相反，我们依赖于它们之间的权衡，我们努力将它们都减少到我们实现“最佳拟合”的点，即模型的最大可能概化。</p><h1 id="2075" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">什么是模型？</h1><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kv"><img src="../Images/061c01ff5fd6d246d5a5863648d084fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UmBDx3YcEVE8XjDSSg3Udw.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">统计模型的表示[ <a class="ae it" href="https://people.smp.uq.edu.au/DirkKroese/statbook/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="fdbe" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在了解过度拟合和欠拟合之前，我们必须了解什么是模型。在统计学和数据科学领域，</p><blockquote class="la"><p id="41aa" class="lb lc hh bd ld le lf lg lh li lj jr dx translated">模型可以被理解为现实世界的抽象表示，它是仅使用提供给我们的数据创建的，也称为“样本”。</p></blockquote><p id="0adb" class="pw-post-body-paragraph iu iv hh iw b ix lk iz ja jb ll jd je jf lm jh ji jj ln jl jm jn lo jp jq jr ha bi translated">打个比方，如果我们想制作一个有形的物理教室的通用模型，那么教室的每个物理方面，比如长凳的数量、桌子的数量、白板的尺寸等等。是我们可以用来建模的相关信息或数据。</p><p id="1c6f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">模型也可以被认为是将一组输入映射到一个输出的数学函数。这组输入和输出是我们模型的不同“方面”,通过机器学习，我们试图在这组输入和输出之间建立关系。例如，给定教室中的长凳和书桌的数量，我们可以很容易地建立一个关系来计算可以同时上课的学生数量。</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lp"><img src="../Images/7dd67d7211cea395f304454866bc2501.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2wUJjZMPCNaNjBXvvkxxHQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">过度适应、良好适应和不适应的概念</figcaption></figure><p id="28ad" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">那么这个概念是如何延伸到过度适应和欠适应的呢？让我们考虑一个场景，一个学生需要一套定制的校服。为此，裁缝首先需要一些关于学生体格的信息，这样制服才会合适学生。但有一个问题，尽管裁缝非常熟练，可以非常准确地测量学生的体型，并根据这些数据完美地定制服装，但裁缝使用的面料在洗涤时会有一定程度的缩水。由于这个原因，衣服的合身程度总是有一定程度的不确定性，因为缩水的量无法预先确定。</p><p id="f53f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">那么，裁缝如何在裁剪校服的同时适应这种不确定性，使它仍然适合学生呢？如果裁缝决定把校服做得比测量值宽松，那么即使缩水后，校服也会宽松或者“不合身”。如果裁缝决定完全按照尺寸来做校服，那么校服在缩水后肯定会很紧或者“过紧”。那么解决办法是什么呢？裁缝在缝制校服时，只留有适当的缩水余量，这样即使在洗涤后，它也能为学生提供完美合身或“最合身”的衣服。</p><h1 id="8ad1" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">用回归模型理解过度拟合和欠拟合</h1><p id="be75" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">让我们做一个简单的实验。为了理解欠拟合和过拟合的概念，我们将尝试用一些回归模型来拟合一组数据点。我们的第一步将是导入几个Python库，使我们能够拟合回归模型并绘制它们:</p><figure class="kw kx ky kz fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="b192" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们获取一些样本数据点来拟合模型:</p><figure class="kw kx ky kz fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="0226" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">以下是它们在散点图中的显示方式:</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ls"><img src="../Images/a853ccbc98a0ff4fd44081ce34a4238e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6b8-vkblBNneFPrOfRlRWA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">2D平面中10个数据点的散点图</figcaption></figure><p id="f5f2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">首先，我们将对这些数据点拟合一条基本线性回归线，并使用拟合模型的系数和y截距计算回归公式，此处用“a”表示。此后，我们沿着数据点绘制回归线:</p><figure class="kw kx ky kz fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="a632" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">执行上述代码后，我们获得了以下结果:</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ls"><img src="../Images/550371cdbd09552e5d14d03735e4ca53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tGFxHAQ4Eota8uTbh1qY4g.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">拟合10个数据点的线性回归模型</figcaption></figure><p id="5f9e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如上所示的基本线性回归线似乎可以很好地模拟我们的数据点，但我们可以看到它并没有很好地捕捉整体趋势；我们得到0.85 的r平方分数<strong class="iw hi">。但是我们能做得更好吗？让我们试着拟合一条2次多项式回归直线，并绘制它:</strong></p><figure class="kw kx ky kz fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="0f28" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">上面这段代码生成了以下图形:</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lt"><img src="../Images/877860370ad16ef87807ea7dc8092e20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vJD2lKNyUaGZ9TJfE6AgBA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">拟合10个数据点的二次多项式回归模型</figcaption></figure><p id="257c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这一次我们获得了0.87的<strong class="iw hi"> r平方值。</strong>虽然我们的得分没有显著提高，但现在看来，随着多项式次数的增加，r平方得分也在增加，数据的总体趋势也变得更加准确。因此，有人可能会说，我们应该不断增加多项式的次数，因为它可以提高分数。我们会尽力找出接下来会发生什么。让我们尝试拟合一条9次多项式回归线，并绘制它:</p><figure class="kw kx ky kz fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="bbdc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">执行上面的代码后，我们得到了下面的图:</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ls"><img src="../Images/14bed3702a1fa5497ba3b1171a2dbba9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3uNGRN_tUPCbf0V_nSnV1A.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">拟合10个数据点的9次多项式回归模型</figcaption></figure><p id="2b3e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们的模型这次产生了0.99 的<strong class="iw hi"> r平方分数！这似乎是一个非常好的回归模型，有着如此令人印象深刻的分数。还是事实如此？</strong></p><p id="61ed" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">正如我们之前读到的，任何模型的好坏都是由其可推广性决定的。因此，为了确定这个模型有多一般化，让我们向我们的合成数据集添加五个额外的观察值，它们应该与原始数据样本属于相同的分布。值得注意的是，该模型尚未在这些数据点上进行训练。下面是新添加的数据点的模型行为:</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ls"><img src="../Images/0cf6430b637a8b65b6af1b8b7f0478be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RgXB3aKmPWK8O2UrcawE_w.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">对5个额外数据点进行测试的9次多项式回归模型</figcaption></figure><p id="811a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">刚刚发生了什么？我们之前已经获得了9次多项式回归线的最佳r平方分数，但它未能对这些新点中的任何一个进行建模，这次我们收到了负r平方分数<strong class="iw hi">，这表明它是一个极其低效的模型。由此可以得出结论，它不是一个一般化的模型；尽管它在尝试对训练数据进行建模时表现出色，但它无法对任何未经训练的新数据点进行建模。因此，该模型可以被视为过拟合模型或高方差模型。</strong></p><h1 id="b3f5" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">过度拟合</h1><p id="5b29" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">根据维基百科，过度拟合是指</p><blockquote class="lu lv lw"><p id="40af" class="iu iv lx iw b ix iy iz ja jb jc jd je ly jg jh ji lz jk jl jm ma jo jp jq jr ha bi translated">分析结果与特定的一组数据过于接近或精确，因此可能无法拟合额外的数据或可靠地预测未来的观察结果</p></blockquote><p id="7468" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在我们的实验中很明显，9次多项式回归模型符合训练数据到这样的程度，以至于它失去了概括的能力，或者换句话说，该模型拾取了总体趋势中的随机波动，即数据中的噪声。因此，该模型无法正确预测之前未发现的点，因为它没有从数据中了解总体趋势，而只是拾取了噪声。这种特殊情况被认为是过度拟合。</p><p id="8f30" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这种特殊情况下，模型不断提出复杂甚至复杂的决策规则，目标是对所有训练数据点进行完美建模。但是在这个过程中，它完全忽略了一般化的概念，因此，那些决策规则无法对看不见的数据点进行建模。</p><p id="fe64" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，人们可能会凭直觉认为复杂的决策规则总是会导致过度拟合，因此人们应该坚持尽可能简单的决策规则，希望这将有助于模型很好地泛化。但事实是这样吗？让我们找出答案。</p><p id="0378" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这一次，我们将尝试使用线性回归模型对相同的五个额外观察值进行建模，从逻辑上来说，它们应该映射得非常好，因为这一次模型应该更加一般化。但是，这种情况发生了:</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ls"><img src="../Images/ca3b81a9d477bfe07e571ee6c5e23629.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qS45Gwi03EPlY3Zx4ss3Og.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">正在测试5个额外数据点的线性回归模型</figcaption></figure><p id="049a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们这次获得了0.65 的r平方分数<strong class="iw hi">，很明显，线性回归模型仍然没有对新数据点进行正确建模，性能不但没有提高，反而有所下降。因此，该模型可被视为欠拟合模型或高度偏差模型。</strong></p><h1 id="310a" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">欠拟合</h1><p id="76a3" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">根据维基百科，</p><blockquote class="lu lv lw"><p id="6c80" class="iu iv lx iw b ix iy iz ja jb jc jd je ly jg jh ji lz jk jl jm ma jo jp jq jr ha bi translated">当统计模型或机器学习算法无法充分捕捉数据的底层结构时，就会出现欠拟合。</p></blockquote><p id="bf8f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在我们的实验中也很明显，线性回归从未能够正确地对数据建模，它不能很好地拟合训练数据，也不能对看不见的数据建模。</p><p id="3df6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">通常，当没有足够的训练数据供模型学习时，或者当模型本身由于其潜在的性质而无法从数据中捕捉趋势时，会发现模型不适合。</p><p id="2a58" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">那么解决办法是什么呢？解决这个难题的唯一可能的方法是，我们在两者之间的某个地方相遇，在那里模型既不过拟合也不欠拟合，我们有一个“非常拟合”的模型。如果我们尝试使用二次多项式回归模型对我们的五个看不见的数据点建模，我们将获得以下结果:</p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ls"><img src="../Images/f22aa81d9168e57159512af84d05ad1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ycYyMyPygYCgSWFJFCct5g.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">对5个额外数据点进行测试的二次多项式回归模型</figcaption></figure><p id="da53" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们得到了0.90的r平方分数！这一次，模型能够正确地预测和模拟数据的总体趋势，这一点通过添加五个看不见的数据点后r平方得分的增加得到了证实。</p><p id="a1ab" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这个特定模型学习的决策映射足够一般化，因此它也可以映射它尚未训练过的数据点。</p><h1 id="4dc4" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">结论</h1><figure class="kw kx ky kz fd ii er es paragraph-image"><div class="er es mb"><img src="../Images/365a75e4aeb761fb6783a275daa22848.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*BX3U2ggbmKwp4gj-8nmuLg.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">偏差-方差权衡曲线</figcaption></figure><p id="43a9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">过度拟合和欠拟合是支配机器学习模型每个方面的两种支配力量。尽管没有逃避它们并直接实现良好的偏差-方差权衡的灵丹妙药，但我们仍在不断发展并在数据级别和算法级别适应我们的机器学习技术，以便我们可以开发不容易过度拟合和欠拟合的模型。</p></div></div>    
</body>
</html>