<html>
<head>
<title>Human Face, emotion and race detection with python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用python实现人脸、情感和种族检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/human-face-emotion-and-race-detection-with-python-86ca573e0c45?source=collection_archive---------0-----------------------#2021-05-26">https://medium.com/analytics-vidhya/human-face-emotion-and-race-detection-with-python-86ca573e0c45?source=collection_archive---------0-----------------------#2021-05-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="b4c6" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">一个迷你OpenCV机器学习项目。</h2></div><p id="8485" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们使用OpenCV、deepface库和Haar cascode _ frontal face _ default . XML文件来检测图像中人的人脸、面部情绪和种族。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es jt"><img src="../Images/9b9cb82ae507ff0d0d4c11b56b98e457.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*TOgiwDA7G9hI_7P8wZTUwQ.jpeg"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">检测前</figcaption></figure><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es kf"><img src="../Images/73782f426b6712c1683a6fb05ac33757.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*ujF8GxfoBqPA8BS9ylwe-w.jpeg"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">检测后</figcaption></figure><blockquote class="kg kh ki"><p id="ea81" class="ix iy kj iz b ja jb ij jc jd je im jf kk jh ji jj kl jl jm jn km jp jq jr js hb bi translated"><em class="hi">从</em><a class="ae kn" href="https://unsplash.com/photos/vtwjyEelY08" rel="noopener ugc nofollow" target="_blank"><em class="hi">【https://unsplash.com/photos/vtwjyEelY08】</em>T5】下载此图片</a></p></blockquote></div><div class="ab cl ko kp gp kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="hb hc hd he hf"><p id="e4f4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在开始之前，我假设您了解python基础知识，并且已经安装了python</p><p id="1206" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">其他需要安装的设备有:</p><blockquote class="kg kh ki"><p id="1c25" class="ix iy kj iz b ja jb ij jc jd je im jf kk jh ji jj kl jl jm jn km jp jq jr js hb bi translated"><em class="hi"> Opencv —使用&lt;pip install Opencv-python&gt;</em>安装</p><p id="70af" class="ix iy kj iz b ja jb ij jc jd je im jf kk jh ji jj kl jl jm jn km jp jq jr js hb bi translated"><em class="hi"> deepface —使用&lt; pip安装deepface &gt; </em>进行安装</p><p id="8238" class="ix iy kj iz b ja jb ij jc jd je im jf kk jh ji jj kl jl jm jn km jp jq jr js hb bi translated"><em class="hi"> matplotlib—使用&lt; pip安装matplotlib&gt;T11】进行安装</em></p><p id="03ed" class="ix iy kj iz b ja jb ij jc jd je im jf kk jh ji jj kl jl jm jn km jp jq jr js hb bi translated"><em class="hi">从</em><a class="ae kn" href="https://raw.githubusercontent.com/opencv/opencv/master/data/haarcascades/haarcascade_frontalface_default.xml" rel="noopener ugc nofollow" target="_blank">https://raw . githubusercontent . com/opencv/opencv/master/data/haarcascades/haarcascade _ frontalface _ default . XML</a><em class="hi">下载haarcascade _ frontalface _ default . XML，并将其保存在与您的项目相同的文件夹中。</em></p></blockquote><h2 id="c865" class="kv kw hi bd kx ky kz la lb lc ld le lf jg lg lh li jk lj lk ll jo lm ln lo lp bi translated">Haar cascode _ frontal face _ default . XML文件是什么？</h2><p id="cda9" class="pw-post-body-paragraph ix iy hi iz b ja lq ij jc jd lr im jf jg ls ji jj jk lt jm jn jo lu jq jr js hb bi translated">这是一个预先训练好的文件，用于检测人脸并给出一些点，这些点用于在人脸上绘制矩形、正方形或任何形状。</p></div><div class="ab cl ko kp gp kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="hb hc hd he hf"><p id="745d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们进入编码部分(我在jupyter笔记本上做这个)。</p><p id="2f9d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">首先，让我们导入所需的库并加载happy_boy.jpg(我们之前下载的图像),并显示该图像。</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="6bfb" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输出:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es lx"><img src="../Images/3d8280daf2ac602c1ee958b063c9c6dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*DBKoXrrqOfIxr-iOXb2xYQ.jpeg"/></div></figure><p id="bb74" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">每次当我们显示图像时，它将在BGR，在显示之前，我们需要将它转换成彩色照片，以显示它的颜色。为此，我们使用cv2中的cvtColor()函数。</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="1dbf" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输出:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es ly"><img src="../Images/24e83a601f22c83521ff30d856f82d43.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*ZTWcasTtQEmx1B_cwy_wwg.jpeg"/></div></figure><h1 id="0f31" class="lz kw hi bd kx ma mb mc lb md me mf lf io mg ip li ir mh is ll iu mi iv lo mj bi translated">使用Deepface预测图片中的人/孩子的情绪和种族</h1><p id="9062" class="pw-post-body-paragraph ix iy hi iz b ja lq ij jc jd lr im jf jg ls ji jj jk lt jm jn jo lu jq jr js hb bi translated">导入DeepFace，分析我们的color_img。</p><p id="d2ed" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它将分析图像，并将检测到的情绪和比赛保存到“预测”变量中。</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="9a6d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看看它预测了什么</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="1587" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输出:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="er es mk"><img src="../Images/98c174145cc76b350d3a3c2cf50c8c6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9l0aA-yOJETArBZZG5bbtQ.jpeg"/></div></div></figure><p id="0259" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在输出中，预测值是dominant_emotion和dominant_race。剩下所有用来预测情绪和种族的点。我们必须只看到主导情绪和主导种族，这是我们的预测。</p><p id="e5d5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以像访问任何其他字典数据类型一样访问dominant_emotion和dominant_race的键值。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es mp"><img src="../Images/fb7f5e13e5f342d935f5e168adc1eee3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*mHt1tJYnZVYtqNe7k-ccsg.jpeg"/></div></figure><p id="7f82" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以DeepFace.analyze()预测了孩子的情绪— <em class="kj">快乐</em>和种族— <em class="kj">亚洲人。</em></p><h1 id="4805" class="lz kw hi bd kx ma mb mc lb md me mf lf io mg ip li ir mh is ll iu mi iv lo mj bi translated">检测人脸</h1><p id="a31d" class="pw-post-body-paragraph ix iy hi iz b ja lq ij jc jd lr im jf jg ls ji jj jk lt jm jn jo lu jq jr js hb bi translated">使用OpenCV检测人脸非常简单。</p><p id="603c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们只需要<em class="kj">Haar cascade _ frontal face _ default . XML</em>文件和OpenCV库来检测图像中的人脸。这是代码。</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="5228" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输出:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="er es mq"><img src="../Images/70ed0f94a2f76d6d4cc0db63681220c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*NF0aFBG5VAiZM4lQFuTF3Q.jpeg"/></div></div></figure><h1 id="b5b0" class="lz kw hi bd kx ma mb mc lb md me mf lf io mg ip li ir mh is ll iu mi iv lo mj bi translated">聚在一起</h1><p id="ea56" class="pw-post-body-paragraph ix iy hi iz b ja lq ij jc jd lr im jf jg ls ji jj jk lt jm jn jo lu jq jr js hb bi translated">正如你所看到的，我们检测了图像中孩子的情绪、种族和面部，现在是最后一部分，把所有的都整合在一起。这意味着现在我们要在图像上显示情感和种族。</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="7cf6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输出:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es mr"><img src="../Images/17fad9ddd402881aa083b5f2da61b6cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*m6ufuI4rPOVy22XK0U-c_w.jpeg"/></div></figure><p id="19a6" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你不知道/不理解我们在cv.putText()中写的所有东西的功能，这里的语法如下</p><blockquote class="kg kh ki"><p id="8b1b" class="ix iy kj iz b ja jb ij jc jd je im jf kk jh ji jj kl jl jm jn km jp jq jr js hb bi translated"><em class="hi"> cv.putText(img，'</em>我们要放在<em class="hi">上的文字，'</em>我们要放文字<em class="hi">的位置，字体，文字大小，颜色，文字粗细，文字纹理)</em></p></blockquote></div><div class="ab cl ko kp gp kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="hb hc hd he hf"><p id="f1be" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是我们如何发现一张脸，人类情感和种族。</p><p id="a943" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在去为其他图像和你的图像也尝试这样做。</p><p id="3190" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们也可以使用网络摄像头或前置摄像头，但它非常慢。您可以访问该代码的存储库(下面给出了链接)(文件名:deep_face.py)。</p><p id="1f9d" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你想看这个项目，请访问这个链接<a class="ae kn" href="https://github.com/raj26kumar/human_emotion_race_detection/blob/main/face_emotion.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/Raj 26 Kumar/human _ emotion _ race _ detection/blob/main/face _ emotion . ipynb</a></p></div><div class="ab cl ko kp gp kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="hb hc hd he hf"><p id="5d46" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢阅读。</p></div></div>    
</body>
</html>