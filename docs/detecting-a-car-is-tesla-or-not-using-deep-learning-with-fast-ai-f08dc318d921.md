# æ£€æµ‹ä¸€è¾†è½¦æ˜¯ç‰¹æ–¯æ‹‰è¿˜æ˜¯æ²¡æœ‰ç”¨ Fast çš„æ·±åº¦å­¦ä¹ ã€‚äººå·¥æ™ºèƒ½

> åŸæ–‡ï¼š<https://medium.com/analytics-vidhya/detecting-a-car-is-tesla-or-not-using-deep-learning-with-fast-ai-f08dc318d921?source=collection_archive---------35----------------------->

![](img/69308577ab111374d6ecdbf538992174.png)

å˜¿ï¼Œå¸Œæœ›ä½ è¿‡å¾—å¾ˆå¥½ã€‚æ‰€ä»¥ï¼Œæœ€è¿‘æˆ‘å¼€å§‹è¿‡æ–‹æˆ’ã€‚äººå·¥æ™ºèƒ½æ·±åº¦å­¦ä¹ è¯¾ç¨‹ï¼Œç”±ä¸¤ä½æ°å‡ºäººå£«â€”â€”æ°ç‘ç±³Â·éœåå¾·å’Œé›·åˆ‡å°”Â·æ‰˜é©¬æ–¯æ•™æˆæ·±åº¦å­¦ä¹ ã€‚ä¸€ä¸ªæ˜¯ç»éªŒä¸°å¯Œçš„ç¨‹åºå‘˜ï¼Œå¦ä¸€ä¸ªæ˜¯æ•°å­¦å®¶ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯æ›´å¥½çš„ç»„åˆå‘¢ï¼Ÿ

# å¿«é€Ÿå­¦ä¹ ã€‚äººå·¥æ™ºèƒ½

è¯¥è¯¾ç¨‹æœ‰è¶£çš„åœ°æ–¹åœ¨äºï¼Œå®ƒé‡‡ç”¨è‡ªä¸Šè€Œä¸‹çš„æ•™å­¦æ–¹æ³•ï¼Œè¿™æ„å‘³ç€é¦–å…ˆä½ è¦ç¼–ç å’Œè®­ç»ƒæ¨¡å‹ï¼Œç„¶åä½ è¦ç†è§£æ•°å­¦æˆ–å…¶èƒŒåçš„åŸºæœ¬æ¦‚å¿µã€‚æ ¹æ®å„ç§ç»éªŒï¼Œè¿™ç§æ–¹æ³•æ¯”å´æ©è¾¾çš„æ•™å­¦æ–¹æ³•æ›´æœ‰æ•ˆï¼Œå³è‡ªä¸‹è€Œä¸Šï¼Œè¿™ä¹Ÿå¾ˆå¥½ã€‚ä½ è§‰å¾—æ€æ ·éƒ½è¡Œã€‚æˆ‘æ›´å–œæ¬¢äº²è‡ªåŠ¨æ‰‹ï¼Œæ‰€ä»¥è¿™å¯¹æˆ‘å¾ˆå¥½ã€‚

# ä¸ç®¡æ˜¯ä¸æ˜¯ç‰¹æ–¯æ‹‰ï¼

å¥½äº†ç°åœ¨è®©æˆ‘ä»¬è¿›å…¥ä¸»é¢˜ã€‚å› æ­¤ï¼Œåœ¨ç¬¬äºŒè¯¾ä¸­ï¼Œä½ å°†å­¦ä¹ å¦‚ä½•è¿›è¡Œå›¾åƒè¯†åˆ«æˆ–ç‰©ä½“è¯†åˆ«ä»¥åŠå¿«é€Ÿè¯†åˆ«ã€‚äººå·¥æ™ºèƒ½å›¾ä¹¦é¦†ä½¿å®ƒéå¸¸å®¹æ˜“åšåˆ°è¿™ä¸€ç‚¹ï¼Œåªè¦ä¸€äº›è¡Œã€‚

æ­£å¦‚æˆ‘åœ¨æˆ‘çš„ YouTube è§†é¢‘ä¸­ä¸€ç›´è¯´çš„é‚£æ ·ï¼Œè¦ç»å¸¸æŠŠæ‰‹å¼„è„ï¼Œå› ä¸ºè¿™æ˜¯ä½ çœŸæ­£å­¦ä¹ çš„æ–¹å¼ï¼Œæ‰€ä»¥æˆ‘å†³å®šåšä¸€ä¸ªæ¨¡å‹æ¥æ£€æµ‹ä¸€è¾†è½¦æ˜¯ä¸æ˜¯ç‰¹æ–¯æ‹‰ã€‚æ˜¾ç„¶ï¼Œä½ èƒ½ä»ä¸€ä¸ªåŸƒéš†å´‡æ‹œè€…é‚£é‡ŒæœŸå¾…ä»€ä¹ˆã€‚

# æ€ä¹ˆåšï¼Ÿ

ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä½¿å®ƒå‘ç”Ÿçš„ä»£ç è¡Œï¼Œæˆ‘å°†å‘ä½ è§£é‡Šé‚£é‡Œå®é™…å‘ç”Ÿäº†ä»€ä¹ˆã€‚

å¯¹äºæ›´å¤šçš„ä¸Šä¸‹æ–‡ï¼Œæˆ‘åœ¨ä¸€ä¸ªå¸¦æœ‰ GPU å®ä¾‹çš„ Google Colab ç¬”è®°æœ¬ä¸Šå†™äº†è¿™ç¯‡æ–‡ç« ï¼Œä»¥ä¾¿æ›´å¿«åœ°è®­ç»ƒæ¨¡å‹ã€‚

# 1.è®©æˆ‘ä»¬å®‰è£…ä¸€äº›æˆ‘ä»¬éœ€è¦åœ¨ç¨‹åºä¸­ä½¿ç”¨çš„å¿…è¦çš„è½¯ä»¶åŒ…ã€‚

```
!pip install fastai !pip install -Uqq fastbook
!pip install -Uqq fastbook
!pip install jmd_imagescraper
```

ç°åœ¨ï¼Œå½“æ‚¨è¿è¡Œè¿™ä¸ªç¨‹åºå¹¶ä¸”å…¶ä¸­ä¸€äº›å·²ç»å®‰è£…åœ¨ colab ä¸­æ—¶ï¼Œæ‚¨å¯èƒ½ä¼šå¾—åˆ°å¦‚ä¸‹ç»“æœ:

![](img/72c0f878f5238546be863a1394637f76.png)![](img/864ae570390f2fc9cc848e274d09be03.png)

è¿™åªæ˜¯è¯´ï¼Œä¸€äº›è½¯ä»¶åŒ…å·²ç»å®‰è£…ï¼Œæˆ‘ä»¬æ˜¯å®‰å…¨çš„ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ç»§ç»­å‰è¿›ã€‚

# 2.è®©æˆ‘ä»¬å¯¼å…¥æ‰€éœ€çš„åŒ…ã€‚

```
import fastbook
fastbook.setup_book()
from fastbook import *
from fastai.vision.widgets import *
from pathlib import Path
from jmd_imagescraper.core import *
```

# 3.åˆ›å»ºåˆ†ç±»ç±»åˆ«

```
classify_car = 'cars', 'tesla car'
tesla_models= 'tesla model x','tesla model y','tesla model s','tesla model 3', 'tesla roadster','tesla cybertruck'
path= Path('images')
path.mkdir(exist_ok= True)
```

*   **ç¬¬ 1 è¡Œ**:åœ¨è¿™é‡Œæˆ‘è®¾ç½®äº†ä¸¤ä¸ªä¸»è¦çš„çˆ¶ç±»åˆ«ï¼Œæˆ‘ä»¬å°†å¯¹å›¾åƒè¿›è¡Œåˆ†ç±»ã€‚
*   **ç¬¬ 2 è¡Œ**:å®é™…ä¸Šï¼Œåœ¨é€šè¿‡â€œç‰¹æ–¯æ‹‰æ±½è½¦â€æŠ“å–å›¾åƒåï¼Œæˆ‘æ„è¯†åˆ°å®ƒå¤ªæ¨¡ç³Šäº†ï¼Œæ‰€ä»¥æˆ‘åˆ—å‡ºäº†è¿™ä¸ªåˆ—è¡¨ï¼Œå¹¶åœ¨ Telsa æ‰€æœ‰ç‰¹å®šæ¨¡å‹çš„åŸºç¡€ä¸Šè®­ç»ƒæ¨¡å‹ï¼Œä»¥æé«˜æ¨¡å‹çš„å‡†ç¡®æ€§ï¼Œå®ƒåšåˆ°äº†ã€‚
*   ç¬¬ 3 è¡Œ:è¿™é‡Œæˆ‘åªæ˜¯ç”¨å¦ä¸€ä¸ªåä¸ºâ€˜imagesâ€™çš„æ–‡ä»¶å¤¹æ¥è®¾ç½®è·¯å¾„ã€‚
*   ç¬¬ 4 è¡Œ:è¿™é‡Œæˆ‘ä½¿ç”¨ã€‚mkdir å‡½æ•°å’Œâ€œexist_okâ€æ ‡è®°ï¼Œè¯¥æ ‡è®°åœ¨æˆ‘ä»¬å¤šæ¬¡è¿è¡Œå•å…ƒæ ¼æ—¶æ£€æŸ¥æ–‡ä»¶å¤¹æ˜¯å¦å·²ç»åˆ›å»ºã€‚

# 4.è®©æˆ‘ä»¬åˆ®ï¼Œå¹¶è·å¾—å›¾åƒæ•°æ®ã€‚

ä¸ºäº†æ›´å¥½çš„ä¸Šä¸‹æ–‡ï¼Œæˆ‘ä»¬çš„â€œè·¯å¾„â€å˜é‡ä½äºâ€œå›¾åƒâ€æ–‡ä»¶å¤¹ä¸­ï¼Œè¯¥æ–‡ä»¶å¤¹ç›®å‰ä¸ºç©ºã€‚

```
for model  in classify_car:
  mpath =  (path/model)
  mpath.mkdir(exist_ok= True)
  img = duckduckgo_search(mpath,'',f"{model}",max_results=150)for models in tesla_models :  
  tpath=(path/'tesla car')
  img = duckduckgo_search(tpath,'',f"{model}",max_results=150)
```

*   **ç¬¬ 1 è¡Œ**:æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘æ­£åœ¨æµè§ˆâ€˜classify _ carâ€™æ•°ç»„ä¸­çš„ä¸¤ä¸ªç±»åˆ«ã€‚
*   **ç¬¬äºŒè¡Œ**:è¿™é‡Œæˆ‘ç”¨ç±»åˆ«è®¾ç½®æ–°è·¯å¾„ã€‚
*   **ç¬¬ä¸‰è¡Œ**:æˆ‘åœ¨è¿™é‡Œåˆ›å»ºæ–°æ–‡ä»¶å¤¹ã€‚
*   **ç¬¬ 4 è¡Œ**:è¿™é‡Œæˆ‘ä½¿ç”¨ duckduckgo_search()å‡½æ•°ä¸‹è½½å›¾ç‰‡ã€‚

**å…³äº duckduckgo_search()å‡½æ•°çš„æ›´å¤šä¿¡æ¯:**

1.  ç¬¬ä¸€ä¸ªå‚æ•°:ä¸‹è½½å›¾åƒçš„è·¯å¾„ã€‚
2.  ç¬¬äºŒä¸ªå‚æ•°:å®ƒå°†ä¸‹è½½å›¾åƒçš„æ–°æ–‡ä»¶å¤¹ï¼Œä½†æˆ‘ä»¬ä¸éœ€è¦å®ƒï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»åˆ›å»ºäº†è¯¥æ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å…¶ç•™ç©ºã€‚
3.  ç¬¬ä¸‰ä¸ªè®ºç‚¹:å®ƒæ˜¯å°†åœ¨ DuckDuckGo æœç´¢å¼•æ“ä¸­è¢«æœç´¢çš„æœç´¢è¯
4.  ç¬¬å››ä¸ªå‚æ•°:è¿™æ˜¯å®ƒå¯ä»¥ä¸‹è½½çš„æœ€å¤§å›¾ç‰‡æ•°é‡ã€‚

å› æ­¤ï¼Œåœ¨å®ƒæ‰§è¡Œåï¼Œä½ å¿…é¡»åœ¨â€œå›¾åƒâ€ä¸­æœ‰ä¸¤ä¸ªæ–°æ–‡ä»¶å¤¹ï¼Œå³â€œæ±½è½¦â€å’Œâ€œç‰¹æ–¯æ‹‰æ±½è½¦â€ï¼Œæ¯ä¸ªæ–‡ä»¶å¤¹ä¸­æœ‰ 150 å¼ å›¾åƒã€‚

ç°åœ¨ï¼Œåœ¨ä¸‹ä¸€ä¸ª for å¾ªç¯ä¸­ï¼Œå‘ç”Ÿäº†åŒæ ·çš„äº‹æƒ…ï¼Œæˆ‘åˆšåˆšè®¾ç½®äº†â€œtesla carsâ€çš„è·¯å¾„ï¼Œå¹¶ä»â€œtesla_modelsâ€æ•°ç»„ä¸­ä¼ å…¥ç‰¹å®šçš„æ¨¡å‹ï¼Œä»¥ä¾¿å°†å®ƒä»¬çš„å›¾åƒä¸‹è½½åˆ°æ–‡ä»¶å¤¹ä¸­ã€‚

# 5.æ£€æŸ¥å›¾åƒ

```
files = get_image_files(path)
len(files)
```

*   **ç¬¬ 1 è¡Œ**:è·å–â€œå›¾åƒâ€æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰å›¾åƒã€‚
*   **ç¬¬ 2 è¡Œ**:æ‰“å°æ‚¨æ‹¥æœ‰çš„æ–‡ä»¶æˆ–å›¾åƒæ€»æ•°ã€‚

```
corrupted= verify_images(files)  
corrupted
```

*   è¿™å°†æ£€æŸ¥ä»»ä½•æŸåçš„å›¾åƒï¼Œå¦‚æœå‘ç°ä»»ä½•æŸåçš„å›¾åƒï¼Œå°±ä¼šæ˜¾ç¤ºå‡ºæ¥ã€‚

```
corrupted.map( Path.unlink) #Remove corrupted files
```

*   è¿™å°†åˆ é™¤æ‰€æœ‰è¢«å‘ç°æŸåçš„å›¾åƒï¼Œæˆ‘ä»¬åªå‰©ä¸‹å‡†å¤‡å¥½æ¥å—è®­ç»ƒçš„å¥½å›¾åƒã€‚

# 6.å‡†å¤‡åŠ è½½æ•°æ®

```
data= DataBlock(blocks=(ImageBlock,CategoryBlock),
                  get_items=get_image_files,
                get_y= parent_label,
                splitter = RandomSplitter(valid_pct=0.2,seed=42 ),
                item_tfms = Resize(128))
```

è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨[æ•°æ®å—](https://docs.fast.ai/data.block.html)ï¼Œå®ƒæ˜¯ä¸€ä¸ªé«˜çº§ apiï¼Œåœ¨æ•°æ®åŠ è½½åˆ°æ•°æ®åŠ è½½å™¨ä¹‹å‰å‡†å¤‡æ•°æ®çš„æœ€ç»ˆå½¢å¼ã€‚

**è®©æˆ‘ä»¬çœ‹çœ‹è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆ:**

*   **ç¬¬ 1 è¡Œ**:å› ä¸ºæˆ‘ä»¬çš„æ¨¡å‹æ˜¯åŸºäºå›¾åƒä½œä¸ºè¾“å…¥ï¼Œç±»åˆ«ä½œä¸ºè¾“å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨`blocks=(ImageBlock,CategoryBlock)` ã€‚
*   **ç¬¬äºŒè¡Œ**:æˆ‘ä»¬å¾—åˆ°æ‰€æœ‰çš„å›¾åƒæ–‡ä»¶ã€‚
*   **ç¬¬ 3 è¡Œ**:è¿™é‡Œ y è¢«è®¤ä¸ºæ˜¯è¾“å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠå®ƒè®¾ç½®ä¸ºâ€˜parent _ label â€™,å®ƒå¾—åˆ°
*   å›¾åƒæ‰€åœ¨æ–‡ä»¶å¤¹çš„åç§°ï¼Œè¿™æ˜¯æˆ‘ä»¬å¯¹æ–°å›¾åƒè¿›è¡Œåˆ†ç±»æ—¶çš„è¾“å‡ºã€‚
*   **ç¬¬ 4 è¡Œ**:è¿™é‡Œæˆ‘ä»¬å°†æ•°æ®é›†çš„ 20 %åˆ†å‰²æˆéªŒè¯é›†ã€‚
*   ç¬¬ 5 è¡Œ:è¿™é‡Œæˆ‘ä»¬æŠŠæ‰€æœ‰çš„å›¾åƒè°ƒæ•´æˆ 128 x 128 çš„æ­£æ–¹å½¢ï¼Œä»¥ä¿æŒæ•°æ®é›†ä¸­çš„ä¸€è‡´æ€§ã€‚

# 7.åŠ è½½æ•°æ®

```
data_load = data.dataloaders(path)
```

*   åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æœ€ç»ˆå°†æ•°æ®åŠ è½½åˆ°æ•°æ®åŠ è½½å™¨ä¸­ã€‚

```
data_load.valid.show_batch(max_n=10 , nrows=2)
```

*   è¿™å‘ä½ å±•ç¤ºäº†æ•°æ®ä¸­çš„ä¸€äº›å›¾åƒã€‚

```
data = data.new(item_tfms=Resize(128), batch_tfms=aug_transforms())
data_load = data.dataloaders(path)
```

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡ä½¿ç”¨ [aug_transformer](https://docs.fast.ai/vision.augment.html#aug_transforms) è¿›ä¸€æ­¥ä¼˜åŒ–æ•°æ®é›†ï¼Œè¿™æ˜¯ä¸€ä¸ªå®ç”¨å‡½æ•°ï¼Œå¯ä»¥è½»æ¾åˆ›å»ºç¿»è½¬ã€æ—‹è½¬ã€ç¼©æ”¾ã€æ‰­æ›²ã€å…‰ç…§å˜æ¢çš„åˆ—è¡¨ã€‚

# 8.è®©æˆ‘ä»¬è®­ç»ƒæ¨¡å‹

```
model = cnn_learner(data_load, resnet18 , metrics=error_rate)
model.fine_tune(10)
```

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ [cnn_learner](https://docs.fast.ai/vision.learner.html#cnn_learner) å·¥å‚æ–¹æ³•è®­ç»ƒæ¨¡å‹ï¼Œå¸®åŠ©æ‚¨ä»ç»™å®šçš„æ¶æ„ä¸­è‡ªåŠ¨è·å¾—é¢„è®­ç»ƒçš„æ¨¡å‹ï¼Œè¯¥æ¨¡å‹å…·æœ‰é€‚åˆæ‚¨çš„æ•°æ®çš„è‡ªå®šä¹‰å¤´ã€‚

åœ¨æ‚¨çš„æ¨¡å‹å®Œæˆè®­ç»ƒåï¼Œæ‚¨ä¸€å®šä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹:

![](img/d195a469134623ebf91a431d63042d7a.png)![](img/43732dbb58999255e374e2c910f2fd37.png)

**ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹æ··æ·†çŸ©é˜µï¼Œçœ‹çœ‹æˆ‘ä»¬çš„æ¨¡å‹è¡¨ç°å¦‚ä½•:**

```
interp= ClassificationInterpretation.from_learner(model)
interp.plot_confusion_matrix( )
```

![](img/503f166a1cee965394540468dd1b0f2e.png)![](img/55efee8888e951722922eb497532209e.png)

**é‚£çœ‹èµ·æ¥ä¸é”™ï¼æ­å–œä½ æˆåŠŸè®­ç»ƒäº†æ¨¡å‹ï¼**

# ç°åœ¨è®©æˆ‘ä»¬æ¥é¢„æµ‹â€”â€”å…³é”®æ—¶åˆ»åˆ°äº†

```
tst= (path/'test')
tst.mkdir(exist_ok=True)
img = download_images(tst,urls=['https://www.businessinsider.in/photo/52674243/with-model-3-demand-surging-tesla-is-bringing-back-a-66000-version-of-its-model-s.jpg'])
image = PILImage.create('/content/images/test/00000000.jpg')pred, predId, prob = model.predict('/content/images/test/00000000.jpg')
if pred=='cars':
     print(f'Hey I am {prob[predId]*100:.04f} % sure that this image is a NOT a Tesla  ')
else :
     print(f'Hey I am {prob[predId]*100:.04f}% sure that this image is a Tesla !')
image
```

ä½ å¯ä»¥æŠŠâ€œurls=[â€¦]â€ä¸­çš„ url æ”¹æˆä½ æƒ³æµ‹è¯•çš„ä»»ä½•å›¾ç‰‡çš„ urlã€‚

å®ƒåº”è¯¥æ˜¯è¿™æ ·çš„:

![](img/62988edd2160c5d0772272a516a279c1.png)![](img/1614b5b4d6fa11c43bd344b8a7dfe6e1.png)

æˆ‘ç°åœ¨å°±å¼€å§‹éƒ¨ç½²å®ƒï¼

**ä½ å¯ä»¥åœ¨è¿™é‡Œ** **æ‰¾åˆ°æˆ‘çš„ GitHub** [**ä¸­çš„æ‰€æœ‰ä»£ç ã€‚å¦‚æœä½ å–œæ¬¢ï¼Œå°±å¼€å§‹å§ğŸŒŸï¼ï¼**](https://github.com/saumya66/Machine-and-Deep-Learning-/tree/main/Fast.AI/TESLAorNOT.ipynb)

**æˆ‘è¿˜åœ¨ Youtube ä¸Šåˆ›å»ºè®¡ç®—æœºç§‘å­¦ç›¸å…³å†…å®¹ï¼Œåœ¨** [**æœªæ¥é©±åŠ¨**](https://www.youtube.com/channel/UCx-HdHfKu1rXgNIfNaKMsAA) **åœ¨æˆ‘çš„** [**ä¸ªäººç½‘ç«™**](https://www.thecsengineer.com/#blog) **ä¸Šå†™åšå®¢ã€‚ğŸ§¡âœ”**

# æˆ‘ä»¬æ¥è¿çº¿:

**ğŸ“¹Youtube é¢‘é“** : [æœªæ¥é©±åŠ¨](https://www.youtube.com/channel/UCx-HdHfKu1rXgNIfNaKMsAA)

Thecsengineer.com**ä¸ªäººç½‘ç«™**:

ğŸ¦**æ¨ç‰¹** : [saumya4real](https://twitter.com/saumya4real)

ğŸ‘¨â€ğŸ’»**LinkedIn**:[saumya 66](https://www.linkedin.com/in/saumya66)

ğŸ”¥**GitHub**:[saumya 66](https://github.com/saumya66)

æˆ‘å¸Œæœ›ä½ å–œæ¬¢å¹¶å­¦åˆ°äº†ä¸€äº›ä¸œè¥¿ã€‚ğŸ¤ğŸ˜ƒ