<html>
<head>
<title>How to use scopes in Ruby on Rails</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Ruby on Rails中使用作用域</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-use-scopes-in-ruby-on-rails-b4c9867b3499?source=collection_archive---------5-----------------------#2021-01-22">https://medium.com/analytics-vidhya/how-to-use-scopes-in-ruby-on-rails-b4c9867b3499?source=collection_archive---------5-----------------------#2021-01-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7750" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么是范围？</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/18fd7135848d351525335391257ffd8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*UM-W-WUezikM-hoRMOY_XQ.jpeg"/></div></figure><p id="2f59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，这张图片与我们的主题无关。只想要一个华而不实的入口:)</p><p id="e789" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好吧，让我们回到我们的主题:</p><blockquote class="jl jm jn"><p id="7f0d" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated"><strong class="ih hj">范围</strong>是您用<strong class="ih hj">范围</strong>方法在<strong class="ih hj"> Rails </strong>模型中定义的定制查询。</p></blockquote><p id="0bd5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">每个作用域都有两个参数:</strong></p><p id="b08b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个名称，您用它在代码中调用这个<strong class="ih hj">范围</strong>。</p><p id="3f75" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">实现查询的lambda。</p><p id="5ca9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jo">示例:作用域:active_users，-&gt;{ where(active:true)}</em></strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es js"><img src="../Images/e4ddacbee9fe9b64570c20cf8071cef1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*754LHOi7tvXBcjB7hdW2LA.jpeg"/></div></div></figure><p id="985c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您将获得一个<code class="du jx jy jz ka b">ActiveRecord::Relation</code>对象作为每个作用域的输出。</p><p id="af61" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">组合多个范围:</strong></p><p id="39b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jo">例:user . active _ users . with _ account . first(3)</em></strong></p><p id="d3a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么时候使用？</strong></p><p id="1c28" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您想在其他地方使用相同的查询，您将有重复的代码。</p><p id="2b7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个场景非常适合使用范围。</p><h1 id="6783" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">如何使用带有参数的Rails作用域</h1><p id="3c69" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">您可能希望在作用域中引入一个变量，这样可以使它更加灵活。</p><blockquote class="jl jm jn"><p id="b13d" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated"><strong class="ih hj">类用户</strong></p><p id="356b" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated"><strong class="ih hj">范围:冗长_用户，- &gt;(长度){ where("长度(标题)&gt;？"，长度)} </strong></p><p id="f74d" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated"><strong class="ih hj">结束</strong></p></blockquote><h1 id="ae1b" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">范围与类方法</h1><p id="3064" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">范围与类方法相同。事实上，它们可以实现相同的功能。</p><blockquote class="jl jm jn"><p id="b623" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">类别用户</p><p id="e20e" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">定义自我活动_用户</p><p id="48d7" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">其中(活动:真)</p><p id="fee7" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">结束</p><p id="5883" class="if ig jo ih b ii ij ik il im in io ip jp ir is it jq iv iw ix jr iz ja jb jc hb bi translated">结束</p></blockquote><p id="563f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">唯一的区别是作用域保证一个<code class="du jx jy jz ka b">ActiveRecord::Relation</code>，而类方法不保证，这有助于你在作用域不返回任何东西时避免错误。</p><h1 id="2a4d" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">不要使用默认范围</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jt ju di jv bf jw"><div class="er es le"><img src="../Images/b2e4aafe7aeb281c4f70832b431fddad.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*WKXDue8Vzn3wCRZtmiXg4A.png"/></div></div></figure><p id="7c15" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是啊！</p><p id="8000" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">默认范围是如此吸引人。</p><p id="def2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是它们通常是错误的选择，因为您可能会忘记已经定义了它们，遇到奇怪的错误，浪费宝贵的调试时间。</p><p id="4367" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你必须使用默认的作用域，你可能需要使用<code class="du jx jy jz ka b"><strong class="ih hj">unscoped</strong></code>方法来禁用所有当前应用的作用域。</p><p id="2909" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读……祝你有一个伟大的编码。</p></div></div>    
</body>
</html>