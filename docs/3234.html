<html>
<head>
<title>Manage Your Workflows With Apache Airflow.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Apache Airflow管理您的工作流程。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/manage-your-workflows-with-apache-airflow-7d39e12b302b?source=collection_archive---------7-----------------------#2021-06-20">https://medium.com/analytics-vidhya/manage-your-workflows-with-apache-airflow-7d39e12b302b?source=collection_archive---------7-----------------------#2021-06-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="b2fd" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">用Python写你的第一个实时DAG。</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/9990080b4411f17fbae5bdb299255eca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WvTO9j5QvLnQG0DLfnlsiw.jpeg"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">照片由<a class="ae jm" href="https://www.pexels.com/@chaitaastic" rel="noopener ugc nofollow" target="_blank"> Chait Goli </a>在<a class="ae jm" href="https://www.pexels.com/" rel="noopener ugc nofollow" target="_blank">像素</a>上拍摄</figcaption></figure><blockquote class="jn jo jp"><p id="992a" class="jq jr js jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated"><strong class="jt hi"> <em class="hh">注意:</em> </strong>这篇文章是名为“<strong class="jt hi">使用Apache Airflow </strong>管理您的工作流”系列文章的一部分。这是两部分系列的第二部分。你应该先看<a class="ae jm" href="https://shritam.medium.com/manage-your-workflows-with-apache-airflow-e7b0e45544a8" rel="noopener">第一部分</a>。</p><p id="2a5c" class="jq jr js jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated"><em class="hh">part 1:</em><a class="ae jm" href="https://shritam.medium.com/manage-your-workflows-with-apache-airflow-e7b0e45544a8" rel="noopener"><em class="hh">Python中Apache Airflow的介绍、安装和设置</em> </a></p><p id="d5ea" class="jq jr js jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">第二部分:用Python编写你的第一个实时DAG。</p></blockquote><p id="ea97" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">在上一篇文章中，我们已经安装并设置了环境来运行我们在Airflow中的第一个DAG。作为一种期望，本文假设您已经配置了Airflow环境，并且已经准备好编写和管理工作流。</p><p id="b3ba" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">在这篇后续文章中，我想用下面的议程来解释一下，</p><ol class=""><li id="e8c6" class="kq kr hh jt b ju jv jx jy kn ks ko kt kp ku km kv kw kx ky bi translated">真实世界问题陈述</li><li id="e063" class="kq kr hh jt b ju kz jx la kn lb ko lc kp ld km kv kw kx ky bi translated">数据源解释</li><li id="93e4" class="kq kr hh jt b ju kz jx la kn lb ko lc kp ld km kv kw kx ky bi translated">数据概述</li><li id="6868" class="kq kr hh jt b ju kz jx la kn lb ko lc kp ld km kv kw kx ky bi translated">编写ETL管道</li><li id="9a0a" class="kq kr hh jt b ju kz jx la kn lb ko lc kp ld km kv kw kx ky bi translated">编写DAG来管理ETL工作流</li><li id="6ccd" class="kq kr hh jt b ju kz jx la kn lb ko lc kp ld km kv kw kx ky bi translated">节目质量监视</li><li id="6150" class="kq kr hh jt b ju kz jx la kn lb ko lc kp ld km kv kw kx ky bi translated">结论</li></ol></div><div class="ab cl le lf go lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ha hb hc hd he"><h1 id="6eae" class="ll lm hh bd ln lo lp lq lr ls lt lu lv in lw io lx iq ly ir lz it ma iu mb mc bi translated">真实世界问题陈述:</h1><p id="4992" class="pw-post-body-paragraph jq jr hh jt b ju md ii jw jx me il jz kn mf kc kd ko mg kg kh kp mh kk kl km ha bi translated">我们将执行一个简单的任务，寻找一个真实世界的API，在那里我们可以获得JSON格式的数据，接下来我们将数据转换为必需的字段，最后将转换后的数据保存为CSV格式。</p><h1 id="c69a" class="ll lm hh bd ln lo mi lq lr ls mj lu lv in mk io lx iq ml ir lz it mm iu mb mc bi translated">数据源解释</h1><p id="8547" class="pw-post-body-paragraph jq jr hh jt b ju md ii jw jx me il jz kn mf kc kd ko mg kg kh kp mh kk kl km ha bi translated">随着React和Vue.js等现代web应用框架的兴起，越来越多的网站使用REST API来发送和接收数据，然后在客户端呈现最终的布局。</p><p id="15d7" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">在整个过程中，我们将从男包类别<a class="ae jm" href="https://www.zalando.co.uk/" rel="noopener ugc nofollow" target="_blank"> Zalando-UK </a>中提取数据。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mn"><img src="../Images/18d49b59a94469958227bc7725cce87d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*GPgr61chHWvjoNyrUMzucw.gif"/></div></div></figure><blockquote class="jn jo jp"><p id="5f51" class="jq jr js jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">但是等等！我们如何捕捉包含产品数据的API？</p></blockquote><ol class=""><li id="d886" class="kq kr hh jt b ju jv jx jy kn ks ko kt kp ku km kv kw kx ky bi translated">许多网站和Zalando一起使用“一页显示”的概念。打开网页并检查它。转到网络XHR，重新加载页面。您可以看到XHR类型的所有请求的列表(特定于数据)。分析所有网络请求并点击“下一页”按钮，将发出API请求。</li><li id="59dd" class="kq kr hh jt b ju kz jx la kn lb ko lc kp ld km kv kw kx ky bi translated">一旦获得API，复制Curl并将其转换为来自<a class="ae jm" href="https://curl.trillworks.com/" rel="noopener ugc nofollow" target="_blank"> CrulTrillwork </a>的Python请求。</li></ol><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mn"><img src="../Images/3ad11345e706fb77cf7452ac6e564706.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Hu4gcfbOyBr64ryuT8aZcQ.gif"/></div></div></figure><p id="3706" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">让我们来看看，当您向API发出GET请求时，数据是什么样子的:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mo"><img src="../Images/a1dfb4897e4126126ff16d747d4d726a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XTqkIK9VAE4g9xYqhI9L9g.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">API JSON数据</figcaption></figure><h1 id="4438" class="ll lm hh bd ln lo mi lq lr ls mj lu lv in mk io lx iq ml ir lz it mm iu mb mc bi translated">数据概述</h1><p id="5d6b" class="pw-post-body-paragraph jq jr hh jt b ju md ii jw jx me il jz kn mf kc kd ko mg kg kh kp mh kk kl km ha bi translated">我们已经成功提取了API，现在是成为<em class="js">福尔摩斯的时候了。</em>让我们分析数据，找到存储所有产品详细信息的字段。为了简单起见，我只考虑API的第一页。</p><p id="cda9" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">如果仔细观察"<em class="js"> API JSON数据</em>"图像，所有产品都存储在名为<strong class="jt hi"> <em class="js">文章</em> </strong>的字段中。看起来，这是一个字典列表。</p><p id="a80f" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">是的，我们答对了。</p><p id="f406" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">让我们探索一些有用的字段来制作最终的CSV文件，</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mp"><img src="../Images/5bd737b0dae7feadade2b8e6c00609ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*HLDO06m1-O8rnu-rNVaPiw.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">用于ETL过程的文件</figcaption></figure><h1 id="7adb" class="ll lm hh bd ln lo mi lq lr ls mj lu lv in mk io lx iq ml ir lz it mm iu mb mc bi translated">编写ETL管道</h1><p id="9702" class="pw-post-body-paragraph jq jr hh jt b ju md ii jw jx me il jz kn mf kc kd ko mg kg kh kp mh kk kl km ha bi translated">在ETL之前，我们需要了解一些事情，</p><h2 id="9aa4" class="mq lm hh bd ln mr ms mt lr mu mv mw lv kn mx my lx ko mz na lz kp nb nc mb nd bi translated"><strong class="ak">什么是DAG？</strong></h2><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ne"><img src="../Images/9dca1809356420bc81418e768d2e1011.png" data-original-src="https://miro.medium.com/v2/resize:fit:446/format:webp/0*51XJchsJBdD7OFBB.png"/></div></figure><p id="9527" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">一个<em class="js"> DAG </em>(有向无环图)是气流的核心概念，将每个任务收集在一起，用依赖和关系组织起来，以说明它们应该如何运行。例如，这里它定义了四个任务——A、B、C和D——并规定了它们必须运行的顺序，以及哪些任务依赖于哪些任务。</p><blockquote class="jn jo jp"><p id="bffb" class="jq jr js jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">Dag文件应该有<code class="du nf ng nh ni b"><em class="hh">.py</em></code>扩展名，并存储在一个名为<code class="du nf ng nh ni b">dags</code>的文件夹中，在这里您已经启动了db。</p></blockquote><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es nj"><img src="../Images/25b215521e93aaf879c4c67a6df76f60.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*BFdSbGj8Yqm2ZEPQi8WrOw.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">目录树</figcaption></figure><ol class=""><li id="c012" class="kq kr hh jt b ju jv jx jy kn ks ko kt kp ku km kv kw kx ky bi translated">让我们创建一个文件夹，创建一个python文件，命名为<code class="du nf ng nh ni b">zalando_etl.py</code></li><li id="0c8f" class="kq kr hh jt b ju kz jx la kn lb ko lc kp ld km kv kw kx ky bi translated">创建一个目录<code class="du nf ng nh ni b">Data/csv</code>来存储您的最终输出。</li></ol><h2 id="ea39" class="mq lm hh bd ln mr ms mt lr mu mv mw lv kn mx my lx ko mz na lz kp nb nc mb nd bi translated"><strong class="ak">X-com是什么？</strong></h2><p id="01b2" class="pw-post-body-paragraph jq jr hh jt b ju md ii jw jx me il jz kn mf kc kd ko mg kg kh kp mh kk kl km ha bi translated">XComs(“cross-communication”的缩写)是一种让<em class="js">任务</em>互相对话的机制。airflow中有一个名为“<em class="js"> xcom_push </em>的方法，可以发送Apache Airflow后端数据库中xcom表中的一些值。这可以用<code class="du nf ng nh ni b">ti</code> ( <em class="js">任务实例)</em>来定义，用来标识任务。</p><p id="6118" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">既然我们已经准备好编写ETL管道，就不多说了，让我们定义几个Python函数来提取、转换和加载这些数据。</p><h2 id="5fbe" class="mq lm hh bd ln mr ms mt lr mu mv mw lv kn mx my lx ko mz na lz kp nb nc mb nd bi translated">提取:</h2><p id="6d25" class="pw-post-body-paragraph jq jr hh jt b ju md ii jw jx me il jz kn mf kc kd ko mg kg kh kp mh kk kl km ha bi translated">该函数将向API URL以及我们从<a class="ae jm" href="https://curl.trillworks.com/" rel="noopener ugc nofollow" target="_blank"> CrulTrillwork </a>收集的给定头发出GET请求。Xcom-push会将结果作为函数值推送。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="nk nl l"/></div></figure><h2 id="9bb0" class="mq lm hh bd ln mr ms mt lr mu mv mw lv kn mx my lx ko mz na lz kp nb nc mb nd bi translated">转换:</h2><p id="496f" class="pw-post-body-paragraph jq jr hh jt b ju md ii jw jx me il jz kn mf kc kd ko mg kg kh kp mh kk kl km ha bi translated">这一步我们需要一些预处理。如果您看到产品URL字段和缩略图字段，则它们的URL格式不正确。我们需要把它转换成一个合适的URL。</p><pre class="ix iy iz ja fd nm ni nn no aw np bi"><span id="8b17" class="mq lm hh ni b fi nq nr l ns nt"><strong class="ni hi">1. url_key</strong>: “under-armour-weekend-bag-black-un244e055-q11” <strong class="ni hi"><em class="js">to </em></strong>“<a class="ae jm" href="https://www.zalando.co.uk/under-armour-weekend-bag-black-un244e055-q11.html" rel="noopener ugc nofollow" target="_blank">https://www.zalando.co.uk/under-armour-weekend-bag-black-un244e055-q11.html</a>”</span><span id="84cd" class="mq lm hh ni b fi nu nr l ns nt"><strong class="ni hi">2. path</strong>: “spp-media-p1/506932a1e2c740acb95444b7d9c84994/36e1a4ed9c5c4d9d884dd5297011595f.jpg”<strong class="ni hi"> to</strong> "<a class="ae jm" href="https://img01.ztat.net/article/spp-media-p1/506932a1e2c740acb95444b7d9c84994/36e1a4ed9c5c4d9d884dd5297011595f.jpg" rel="noopener ugc nofollow" target="_blank">https://img01.ztat.net/article/spp-media-p1/506932a1e2c740acb95444b7d9c84994/36e1a4ed9c5c4d9d884dd5297011595f.jpg</a>"</span></pre><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="nk nl l"/></div></figure><h2 id="a064" class="mq lm hh bd ln mr ms mt lr mu mv mw lv kn mx my lx ko mz na lz kp nb nc mb nd bi translated">负载:</h2><p id="28b4" class="pw-post-body-paragraph jq jr hh jt b ju md ii jw jx me il jz kn mf kc kd ko mg kg kh kp mh kk kl km ha bi translated">最后，我们需要定义一个函数，将转换后的数据加载到CSV文件中。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="nk nl l"/></div></figure><h1 id="9a09" class="ll lm hh bd ln lo mi lq lr ls mj lu lv in mk io lx iq ml ir lz it mm iu mb mc bi translated">编写DAG来管理ETL作业</h1><p id="e20d" class="pw-post-body-paragraph jq jr hh jt b ju md ii jw jx me il jz kn mf kc kd ko mg kg kh kp mh kk kl km ha bi translated">耶！现在，我们可以在Airflow中编写DAG来依次运行3个不同的作业。下面的脚本是我们创建DAG文件以执行工作流所需的全部内容。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="nk nl l"/></div></figure><h2 id="ef27" class="mq lm hh bd ln mr ms mt lr mu mv mw lv kn mx my lx ko mz na lz kp nb nc mb nd bi translated">以上代码的详细信息:</h2><ol class=""><li id="0c5a" class="kq kr hh jt b ju md jx me kn nv ko nw kp nx km kv kw kx ky bi translated">在定义了所有3个ETL功能之后，我们已经按顺序定义了任务。</li><li id="5dce" class="kq kr hh jt b ju kz jx la kn lb ko lc kp ld km kv kw kx ky bi translated"><code class="du nf ng nh ni b"><em class="js">dag_id</em></code> <em class="js"> </em>应该对您将来创建的所有Dag都是唯一的。</li><li id="ac90" class="kq kr hh jt b ju kz jx la kn lb ko lc kp ld km kv kw kx ky bi translated">要执行Python调用，请始终使用PythonOperator方法。</li><li id="96b2" class="kq kr hh jt b ju kz jx la kn lb ko lc kp ld km kv kw kx ky bi translated">任务用<code class="du nf ng nh ni b"><em class="js">&gt;&gt;</em></code>符号顺序定义。</li></ol><p id="14a4" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">让我们检查DAG是否已按气流列出。为airflow激活您的虚拟环境，并运行以下命令来检查所有Dag。</p><pre class="ix iy iz ja fd nm ni nn no aw np bi"><span id="4dce" class="mq lm hh ni b fi nq nr l ns nt"><strong class="ni hi">$ airflow dags list</strong></span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ny"><img src="../Images/315ec95c90217e8411fff07ecd86e275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XDmxUm8EiDiNfpAILldEGA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">DAGs列表</figcaption></figure><p id="6cce" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">你可能会在你的列表中看到一些其他的例子。但是不用担心，这些只是为了演示的目的。它不会对您的<code class="du nf ng nh ni b"><em class="js">zalando_workflow</em></code> DAG做任何更改。</p><p id="7a8e" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">酷！让我们打开两个单独的shell选项卡来运行Scheduler和Webservice。</p><h2 id="0a91" class="mq lm hh bd ln mr ms mt lr mu mv mw lv kn mx my lx ko mz na lz kp nb nc mb nd bi translated">启动调度程序:</h2><pre class="ix iy iz ja fd nm ni nn no aw np bi"><span id="10c4" class="mq lm hh ni b fi nq nr l ns nt"><strong class="ni hi">$ airflow scheduler</strong></span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nz"><img src="../Images/55d3913aa5b0c71eed597fc7fe7dc777.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nW2f4QVvxuZxlFBm.png"/></div></div></figure><h2 id="6a14" class="mq lm hh bd ln mr ms mt lr mu mv mw lv kn mx my lx ko mz na lz kp nb nc mb nd bi translated">启动web服务器</h2><pre class="ix iy iz ja fd nm ni nn no aw np bi"><span id="ba9c" class="mq lm hh ni b fi nq nr l ns nt"><strong class="ni hi">$ airflow webserver — port 8080     </strong>#default port is 8080</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es oa"><img src="../Images/07c0090c2bf33760323c2a650582de22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VHsHk0lAo01nR7QY.png"/></div></div></figure><p id="333b" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">现在让我们在浏览器中访问<a class="ae jm" href="http://0.0.0.0:8080/" rel="noopener ugc nofollow" target="_blank"> <em class="js"> localhost:8080 </em> </a>，您会看到Airflow Webserver UI:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ob"><img src="../Images/f2154c88fef129b7156f77169c8b049f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uGFkeNjCev2tPGJYA5hsHg.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">Airflow服务器主页</figcaption></figure><p id="814a" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">我们已经完成了DAG配置。让我们启动工作流，取消暂停DAG并触发DAG。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mn"><img src="../Images/ac9a45746ccf2869df96b5bdc03bde4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*uY5SdyPI1kmYWg7VQmotCw.gif"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">DAG工作流</figcaption></figure><p id="423b" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">触发后，勾选<strong class="jt hi"> <em class="js">图形视图</em> </strong>跟踪工作流程。您可以通过将鼠标悬停在任务上来检查每个任务的状态。一旦工作流完成，所有任务的边界将以绿色<em class="js">显示，状态为“<em class="js">成功</em>”。</em></p><h1 id="9656" class="ll lm hh bd ln lo mi lq lr ls mj lu lv in mk io lx iq ml ir lz it mm iu mb mc bi translated">节目质量监视</h1><p id="081a" class="pw-post-body-paragraph jq jr hh jt b ju md ii jw jx me il jz kn mf kc kd ko mg kg kh kp mh kk kl km ha bi translated">今天的DAG运行成功完成后，您可以看到CSV文件将在<code class="du nf ng nh ni b">Data/csv</code>目录下生成。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es oc"><img src="../Images/820629947b3b43d962ff2a5846cdd2bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3WLULPqghl6jkDeKfXEAxw.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">Zalando最终csv文件</figcaption></figure><p id="5482" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">让我们读取熊猫数据框中的CSV，</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es od"><img src="../Images/ca73c1b1fd03f0f30038f87cd854010a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AB5DxGgtdn6iDyQOcKeoYw.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">csv到熊猫数据帧</figcaption></figure><p id="87cc" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">太好了！</p><h1 id="671c" class="ll lm hh bd ln lo mi lq lr ls mj lu lv in mk io lx iq ml ir lz it mm iu mb mc bi translated">结论:</h1><p id="393f" class="pw-post-body-paragraph jq jr hh jt b ju md ii jw jx me il jz kn mf kc kd ko mg kg kh kp mh kk kl km ha bi translated">恭喜你，你的第一个真实世界的DAG与气流是活的。我希望它是容易的和有帮助的。请随意将这个气流系列作为参考，并尝试使用其他一些新的来源。</p><p id="ddc5" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">我希望这篇文章能够激励你使用Apache Airflow 2.1.0来编写和管理工作流。</p><p id="9df9" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz kn kb kc kd ko kf kg kh kp kj kk kl km ha bi translated">报名参加<a class="ae jm" href="https://www.crowdcast.io/e/airflowsummit2021/register?utm_campaign=AstronomerMarketing&amp;utm_source=Website&amp;utm_medium=Bar" rel="noopener ugc nofollow" target="_blank">2021年气流峰会</a>。</p><h1 id="393b" class="ll lm hh bd ln lo mi lq lr ls mj lu lv in mk io lx iq ml ir lz it mm iu mb mc bi translated">感谢您的阅读！</h1><p id="1b0c" class="pw-post-body-paragraph jq jr hh jt b ju md ii jw jx me il jz kn mf kc kd ko mg kg kh kp mh kk kl km ha bi translated">请在媒体上关注我的最新消息。😃</p><h1 id="861d" class="ll lm hh bd ln lo mi lq lr ls mj lu lv in mk io lx iq ml ir lz it mm iu mb mc bi translated">参考</h1><div class="oe of ez fb og oh"><a href="https://airflow.apache.org/docs/" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab dw"><div class="oj ab ok cl cj ol"><h2 class="bd hi fi z dy om ea eb on ed ef hg bi translated">证明文件</h2><div class="oo l"><h3 class="bd b fi z dy om ea eb on ed ef dx translated">Apache Airflow Core，它包括web服务器、调度程序、CLI和最小气流所需的其他组件…</h3></div><div class="op l"><p class="bd b fp z dy om ea eb on ed ef dx translated">airflow.apache.org</p></div></div><div class="oq l"><div class="or l os ot ou oq ov jg oh"/></div></div></a></div><div class="oe of ez fb og oh"><a href="https://www.astronomer.io/" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab dw"><div class="oj ab ok cl cj ol"><h2 class="bd hi fi z dy om ea eb on ed ef hg bi translated">天文学家|阿帕奇气流的企业框架</h2><div class="oo l"><h3 class="bd b fi z dy om ea eb on ed ef dx translated">在我们或您的云中轻松运行、管理和扩展Apache气流。</h3></div><div class="op l"><p class="bd b fp z dy om ea eb on ed ef dx translated">www .天文学家. io</p></div></div><div class="oq l"><div class="ow l os ot ou oq ov jg oh"/></div></div></a></div></div></div>    
</body>
</html>