<html>
<head>
<title>PostgreSQL Streaming Replication</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PostgreSQLæµå¤åˆ¶</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/postgresql-streaming-replication-4b4679b352f3?source=collection_archive---------0-----------------------#2021-12-23">https://medium.com/analytics-vidhya/postgresql-streaming-replication-4b4679b352f3?source=collection_archive---------0-----------------------#2021-12-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="5233" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨æœ¬ä¸»é¢˜ä¸­ï¼Œæˆ‘å°†ç®€è¦ä»‹ç»PostgreSQLæµå¤åˆ¶ã€‚</p><p id="1d01" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘å°†PotgreSQLç‰ˆæœ¬14ç”¨äºä¸»ç³»ç»Ÿå’Œå¤‡ç”¨ç³»ç»Ÿã€‚</p><p id="3d41" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¯¹äºæºç³»ç»Ÿï¼Œæˆ‘ä½¿ç”¨PostgreSQLæœ€æ–°çš„dockeræ˜ åƒã€‚å¯¹äºç›®æ ‡ç³»ç»Ÿï¼Œæˆ‘ä½¿ç”¨äº†Debianæœ€æ–°çš„dockeræ˜ åƒã€‚</p><p id="82e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä»¥ä¾¿å‡†å¤‡æºç³»ç»Ÿï¼›</p><blockquote class="jd je jf"><p id="2aa8" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">postgres=# <strong class="ih hj">æ˜¾ç¤ºæ•°æ®_ç›®å½•ï¼›</strong></p><p id="e63a" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">æ•°æ®ç›®å½•</p><p id="5d86" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi">â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€”</p><p id="1dad" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">/var/lib/postgresql/data</p><p id="41f0" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">(1è¡Œ)</p></blockquote><p id="8cb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬éœ€è¦åœ¨â€œpostgresql.confâ€æ–‡ä»¶çš„æœ«å°¾æ·»åŠ ä»¥ä¸‹è¡Œ:</p><blockquote class="jd je jf"><p id="ba63" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">æ²ƒå°”_level =å‰¯æœ¬</strong></p><p id="dc2d" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj"> wal_log_hints = on </strong></p><p id="ce93" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj"> archive_mode = on #(æ›´æ”¹éœ€è¦é‡å¯)</strong></p><p id="0254" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj"> archive_command = 'testï¼-f/var/lib/PostgreSQL/pg _ log _ archive/main/% f&amp;&amp;CP % p/var/lib/PostgreSQL/pg _ log _ archive/main/% f '</strong></p><p id="0ba3" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj"> max_wal_senders = 10 </strong></p><p id="78f7" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">çƒ­å¤‡ç”¨=å¼€å¯</strong></p></blockquote><p id="a50f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç„¶åï¼Œ</p><blockquote class="jd je jf"><p id="8341" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">mkdir-p/var/lib/PostgreSQL/pg _ log _ archive/main/</strong></p><p id="d4aa" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">create user-e-replication repl-W</strong># as postgres</p></blockquote><p id="b2a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ­¤å¤–ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä»¥ä¸‹è¡Œæ¥å…è®¸å¤åˆ¶ç”¨æˆ·â€œreplâ€è¿æ¥æºæ•°æ®åº“:</p><blockquote class="jd je jf"><p id="ee62" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">ä¸»æœºå¤åˆ¶repl 172.17.0.5/32 md5 </strong></p></blockquote><p id="2b1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç„¶åé‡æ–°å¯åŠ¨PostgreSQLé›†ç¾¤:</p><blockquote class="jd je jf"><p id="1abe" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">é€‰æ‹©pg _ create _ physical _ replication _ slot(' air ')ï¼›</strong></p><p id="bef4" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">pg _åˆ›å»º_ç‰©ç†_å¤åˆ¶_æ’æ§½</p><p id="a796" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi">â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” â€” -</p><p id="3197" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">(ç©ºæ°”)</p><p id="fafa" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">(1è¡Œ)</p><p id="e5da" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">select * from pg _ replication _ slotsï¼›</strong></p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/63cae05c8aaed6d1ddd769799abd870f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KJ5bVVZY0gqtDDYvKRajfg.png"/></div></div></figure><p id="ede3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç”±äºwalæ–‡ä»¶çš„ç®¡ç†ï¼Œæˆ‘ä»¬ä½¿ç”¨â€œpg_replication_slotsâ€ã€‚åœ¨PostgreSQLç‰ˆæœ¬ä¹‹å‰ï¼Œæˆ‘ä»¬é€šè¿‡â€œwal_keep_segmentsâ€å‚æ•°æ¥ç®¡ç†walæ–‡ä»¶ã€‚å½“ä¸»èŠ‚ç‚¹å’Œå¤‡ç”¨èŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡å‡ºç°é—®é¢˜æ—¶ï¼Œå¦‚æœæˆ‘ä»¬çš„ç³»ç»Ÿè¶…å‡ºé™åˆ¶â€œwal _ keep _ segments â€, PostgreSQLå°†åˆ é™¤æ–‡ä»¶ï¼Œé™¤éæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¤åˆ¶æ§½ã€‚è¿™å°±æ˜¯æˆ‘ä»¬åœ¨é…ç½®ä¸­ä½¿ç”¨å¤åˆ¶æ’æ§½çš„åŸå› ã€‚å½“ç„¶ï¼Œä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ï¼Œæ¯”å¦‚æˆ‘ä»¬éœ€è¦è¶³å¤Ÿçš„(å¾ˆå¤š/å–å†³äºç³»ç»Ÿ)æ•°æ®å­˜å‚¨ï¼Œä»¥ä¾¿åœ¨ä»»ä½•é€šä¿¡æ•…éšœçš„æƒ…å†µä¸‹ä¸åœæ­¢ç”Ÿäº§ç³»ç»Ÿã€‚</p><p id="a795" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jw" href="https://www.postgresql.org/docs/9.4/catalog-pg-replication-slots.html" rel="noopener ugc nofollow" target="_blank">https://www . PostgreSQL . org/docs/9.4/catalog-pg-replication-slots . html</a></p><p id="193e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jw" href="https://hevodata.com/learn/postgresql-replication-slots/" rel="noopener ugc nofollow" target="_blank">https://hevodata.com/learn/postgresql-replication-slots/</a></p><p id="f5f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨ç›®æ ‡ç«¯é…ç½®ï¼›</p><p id="ba8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…PostgreSQLäºŒè¿›åˆ¶æ–‡ä»¶:</p><div class="jx jy ez fb jz ka"><a href="https://www.postgresql.org/download/linux/ubuntu/" rel="noopener  ugc nofollow" target="_blank"><div class="kb ab dw"><div class="kc ab kd cl cj ke"><h2 class="bd hj fi z dy kf ea eb kg ed ef hh bi translated">Linuxä¸‹è½½(Ubuntu)</h2><div class="kh l"><h3 class="bd b fi z dy kf ea eb kg ed ef dx translated">é»˜è®¤æƒ…å†µä¸‹ï¼ŒPostgreSQLåœ¨æ‰€æœ‰Ubuntuç‰ˆæœ¬ä¸­éƒ½å¯ç”¨ã€‚ç„¶è€Œï¼ŒUbuntuâ€œå¿«ç…§â€äº†PostgreSQLçš„ä¸€ä¸ªç‰¹å®šç‰ˆæœ¬â€¦</h3></div><div class="ki l"><p class="bd b fp z dy kf ea eb kg ed ef dx translated">www.postgresql.org</p></div></div><div class="kj l"><div class="kk l kl km kn kj ko ju ka"/></div></div></a></div><blockquote class="jd je jf"><p id="0388" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">#åˆ›å»ºæ–‡ä»¶å­˜å‚¨åº“é…ç½®:</p><p id="bf0d" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">sudo sh-c ' echo " deb<a class="ae jw" href="http://apt.postgresql.org/pub/repos/apt" rel="noopener ugc nofollow" target="_blank">http://apt.postgresql.org/pub/repos/apt</a>$(LSB _ release-cs)-pgdg main "&gt;/etc/apt/sources . list . d/pgdg . list '</p><p id="284a" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">#å¯¼å…¥å­˜å‚¨åº“ç­¾åå¯†é’¥:</p><p id="b075" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">https://www.postgresql.org/media/keys/ACCC4CF8.asc|é¡»è—¤apt-key add -</p><p id="91ce" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">#æ›´æ–°åŒ…åˆ—è¡¨:</p><p id="a604" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">sudo apt-getæ›´æ–°</p><p id="0ee5" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">#å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„PostgreSQLã€‚</p><p id="ffd3" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">#å¦‚æœæ‚¨éœ€è¦ç‰¹å®šçš„ç‰ˆæœ¬ï¼Œè¯·ä½¿ç”¨â€œpostgresql-12â€æˆ–ç±»ä¼¼çš„è¯­è¨€ï¼Œè€Œä¸æ˜¯â€œpostgresqlâ€:</p><p id="2b2b" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">sudo apt-get -yå®‰è£…postgresql</p></blockquote><p id="b5b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç„¶åï¼Œæˆ‘æ£€æŸ¥å¤åˆ¶ç”¨æˆ·æ˜¯å¦å¯ä»¥è¿æ¥åˆ°æºæ•°æ®åº“:</p><blockquote class="jd je jf"><p id="2199" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">psql-h 172 . 17 . 0 . 4-U repl postgres</strong></p><p id="5681" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">ç”¨æˆ·å›å¤çš„å¯†ç :</strong></p><p id="c08d" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">psql(14.1(Debian 14.1â€“1 . pgdg 110+1)ï¼Œserver 14.0(Debian 14.0â€“1 . pgdg 110+1))</strong></p><p id="d5a0" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">é”®å…¥â€œhelpâ€å¯»æ±‚å¸®åŠ©ã€‚</strong></p><p id="0def" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj"> postgres= &gt; </strong></p><p id="9b70" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj"> \q </strong></p></blockquote><p id="365c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬åˆ›å»ºæ•°æ®ç›®å½•:</p><blockquote class="jd je jf"><p id="bdde" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">mkdir-p/var/lib/PostgreSQL/data/</strong></p><p id="29d1" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">chmod 700/var/lib/PostgreSQL/data</strong></p></blockquote><p id="eaa6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å¼€å§‹å¯¹åˆå§‹è´Ÿè½½è¿›è¡ŒåŸºæœ¬å¤‡ä»½:</p><blockquote class="jd je jf"><p id="b7cb" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">pg _ base backup-h 172 . 17 . 0 . 4-D ./-U repl-W-P-R-Sèˆªç©º-X stream -W </strong></p></blockquote><p id="b51d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥é…ç½®æ¢å¤å‚æ•°ï¼Œä½†PostgreSQLç‰ˆæœ¬12ä¹‹åæ²¡æœ‰â€œrecovery.confâ€æ–‡ä»¶ã€‚å®ƒæ˜¯åˆå¹¶çš„â€œpostgresql.confâ€æ–‡ä»¶ã€‚ä¸ºäº†å°†é›†ç¾¤ç½®äºå¾…æœºæ¨¡å¼ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªåä¸ºâ€œstandby.signalâ€çš„ç©ºæ–‡ä»¶ã€‚</p><p id="ba98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä»…æ›´æ”¹äº†â€œè§¦å‘å™¨æ–‡ä»¶â€å‚æ•°çš„åç§°ï¼Œç°åœ¨ç§°ä¸ºâ€œå‡çº§è§¦å‘å™¨æ–‡ä»¶â€ï¼Œå¹¶åˆ é™¤äº†â€œå¾…æœºæ¨¡å¼â€ã€‚å…¶ä½™çš„ä¿æŒåŸæ ·ã€‚</p><p id="670c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">PostgreSQLç‰ˆæœ¬12ä¹‹å‰(recovery.conf):</p><blockquote class="jd je jf"><p id="d700" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">restore _ command = ' CP/var/lib/PostgreSQL/pg _ log _ archive/replica 1/% f % p '</strong></p><p id="5658" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">æ¢å¤ç›®æ ‡æ—¶é—´çº¿= 'æœ€æ–°'</strong></p><p id="f36f" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">primary _ conn info = ' user = repl host = 172 . 17 . 0 . 2 port = 5432 SSL mode = prefer SSL compression = 1 krbsrvname = postgres target _ session _ attrs = any '</strong></p><p id="164d" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">archive _ clean up _ command = ' pg _ archive clean up/var/lib/PostgreSQL/pg _ log _ archive/replica 1% r '</strong></p><p id="aaa7" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">trigger _ file =/tmp/trigger</strong></p></blockquote><p id="d50f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨PostgreSQLç‰ˆæœ¬12(postgresql.conf)ä¹‹å:</p><blockquote class="jd je jf"><p id="add6" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">restore _ command = ' CP/var/lib/PostgreSQL/pg _ log _ archive/replica 1/% f % p '</strong></p><p id="3072" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">æ¢å¤ç›®æ ‡æ—¶é—´çº¿= 'æœ€æ–°'</strong></p><p id="b7f1" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">primary _ conn info = ' user = repl host = 172 . 17 . 0 . 4 port = 5432 password = 123123 SSL mode = prefere SSL compression = 1 krbsrvname = postgres target _ session _ attrs = any '</strong></p><p id="d654" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">archive _ clean up _ command = ' pg _ archive clean up/var/lib/PostgreSQL/pg _ log _ archive/replica 1% r '</strong></p><p id="654c" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">promote _ trigger _ file = '/tmp/promote '</strong></p><p id="8140" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">ä¸»æ’æ§½åç§°= 'ç©ºæ°”'</strong></p></blockquote><p id="4b59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¸ºå¤‡ç”¨èŠ‚ç‚¹å’Œå°†æ•°æ®åº“ç½®äºå¤‡ç”¨æ¨¡å¼çš„æ–‡ä»¶åˆ›å»ºå½’æ¡£ç›®å½•ã€‚</p><blockquote class="jd je jf"><p id="8e62" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">mkdir-p/var/lib/PostgreSQL/pg _ log _ archive/replica 1</strong></p><p id="4ee0" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">touch/var/lib/PostgreSQL/data/stand by . signal</strong></p></blockquote><p id="684e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æœ€åï¼Œæˆ‘ä»¬å¯ä»¥å¯åŠ¨stanbyé›†ç¾¤:</p><blockquote class="jd je jf"><p id="054c" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">/usr/lib/PostgreSQL/14/bin/pg _ CTL-D/var/lib/PostgreSQL/data/start</strong></p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kp"><img src="../Images/9a0ccedc17ed3d92ea96f9f869af3582.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n-Od7gfth8qhuNauS3XxwA.png"/></div></div></figure><p id="1d19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨æºç³»ç»Ÿä¸Š:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kq"><img src="../Images/d9cd0b7725a3888b14aa27695e40669f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a9XRXvkJt5-9DD2B-B4w1g.png"/></div></div></figure><p id="3327" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨ç›®æ ‡ç³»ç»Ÿç³»ç»Ÿä¸Š:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kr"><img src="../Images/490b8a03b3bbbcfef29d919892844734.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XvRSoxl1pWHCTsWWtaFDwQ.png"/></div></div></figure><p id="bd2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘ä»¬å¯ä»¥éšæ—¶åœ¨ç›®æ ‡ç³»ç»Ÿä¸Šåˆ›å»ºâ€œ/tmp/promoteâ€æ–‡ä»¶ï¼Œå°†å…¶æå‡ä¸ºä¸»ç³»ç»Ÿ:</p><blockquote class="jd je jf"><p id="f03d" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">è§¦æ‘¸/tmp/æå‡</strong></p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ks"><img src="../Images/8bf7da13a6bc41895c19bdbbd5ce4478.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O6ZYB5ijNEt5aYejxusfwQ.png"/></div></div></figure><p id="f23a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç°åœ¨ï¼Œæˆ‘èƒ½å¤Ÿåœ¨â€œæ—§çš„â€å¤‡ç”¨ç³»ç»Ÿä¸Šåˆ›å»ºæ–°çš„æ•°æ®åº“:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kt"><img src="../Images/715607328eeb565a11fa5602c18176e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8aAZJHKhdx86XkvD95XRQQ.png"/></div></div></figure><p id="d3f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åŒæ—¶ï¼Œæˆ‘åœ¨ä¸»ç³»ç»Ÿä¸Šåˆ›å»ºäº†å¦ä¸€ä¸ªæ•°æ®åº“:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ku"><img src="../Images/58a5882b5b7751401217328e342a905a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O6vle9J3lmAXSVd4CyJZpQ.png"/></div></div></figure><p id="925c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å“¦ä¸ï¼æˆ‘ä»¬ç ´åäº†æˆ‘ä»¬çš„å¤åˆ¶ğŸ˜Šã€‚æ˜¯å¦å¯ä»¥ä»ä¸Šä¸€ä¸ªæˆåŠŸçš„æ£€æŸ¥ç‚¹ç»§ç»­å¤åˆ¶ï¼Œå¹¶ä¸ä¸»ç³»ç»Ÿä¿æŒåŒæ­¥ï¼Ÿæ˜¯çš„ï¼Œæˆ‘ä»¬æœ‰åƒå‘å¯¼ä¸€æ ·çš„â€œpg_rewindâ€ğŸ˜Šã€‚</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kv"><img src="../Images/f794232e2a47d03450a2e836d1eb240a.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*ivAWCQjAWxlvpBXObLYsrA.png"/></div></figure><p id="51d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">é¦–å…ˆï¼Œåœ¨ç›®æ ‡ç³»ç»Ÿä¸Šï¼Œæˆ‘ä»¬éœ€è¦åœæ­¢PostgreSQLé›†ç¾¤:</p><blockquote class="jd je jf"><p id="bf79" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">/usr/lib/PostgreSQL/14/bin/pg _ CTL-D/var/lib/PostgreSQL/data/stop</strong></p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kw"><img src="../Images/3dee87c72236981011f8d8e3fb4e5eb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vm29PdUDRkFPBb45Y-EGmA.png"/></div></div></figure><p id="c56b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥ç»§ç»­å‡è¡¡æºå’Œç›®æ ‡æ•°æ®ç›®å½•:</p><blockquote class="jd je jf"><p id="bb13" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">/usr/lib/PostgreSQL/14/bin/pg _ rewindâ€”target-pg data =/var/lib/PostgreSQL/data/â€”source-server = " host = 172 . 17 . 0 . 4 port = 5432 user = postgres password = my secret password dbname = postgres "</strong></p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kx"><img src="../Images/0b6a7f591b54f50a330b5854bf93052c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OYi7UgEPJv_7uAWhgHlHzA.png"/></div></div></figure><p id="852f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç„¶è€Œï¼Œç›®æ ‡ç³»ç»Ÿä¸Šçš„é…ç½®ä¸ä¸»ç³»ç»Ÿç›¸åŒã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®æˆ‘ä»¬çš„â€œpostgresql.confâ€æ–‡ä»¶ï¼Œå¹¶åˆ›å»ºå’Œæ¸…ç©ºâ€œstandby.signalâ€ã€‚æˆ‘ä»¬éœ€è¦åœ¨â€œpostgresql.confâ€æ–‡ä»¶çš„æœ«å°¾æ·»åŠ ä»¥ä¸‹è¡Œ:</p><blockquote class="jd je jf"><p id="8676" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">restore _ command = ' CP/var/lib/PostgreSQL/pg _ log _ archive/replica 1/% f % p '</strong></p><p id="892e" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">æ¢å¤ç›®æ ‡æ—¶é—´çº¿= 'æœ€æ–°'</strong></p><p id="81a8" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">primary _ conn info = ' user = repl host = 172 . 17 . 0 . 4 port = 5432 password = 123123 SSL mode = prefere SSL compression = 1 krbsrvname = postgres target _ session _ attrs = any '</strong></p><p id="8ff5" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">archive _ clean up _ command = ' pg _ archive clean up/var/lib/PostgreSQL/pg _ log _ archive/replica 1% r '</strong></p><p id="08a2" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">promote _ trigger _ file = '/tmp/promote '</strong></p><p id="ed10" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">ä¸»æ’æ§½åç§°= 'ç©ºæ°”'</strong></p></blockquote><p id="7046" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å’Œ</p><blockquote class="jd je jf"><p id="5c17" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">CD/var/lib/PostgreSQL/data/</strong></p><p id="5831" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">è§¦æ‘¸å¾…æœºä¿¡å·</strong></p></blockquote><p id="9f35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è®©æˆ‘ä»¬å†æ¬¡å¯åŠ¨standy systemï¼Œå¹¶å°è¯•åœ¨å…¶ä¸Šåˆ›å»ºæ•°æ®åº“:</p><blockquote class="jd je jf"><p id="b9d4" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">/usr/lib/PostgreSQL/14/bin/pg _ CTL-D/var/lib/PostgreSQL/data/start</strong></p><p id="9590" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated"><strong class="ih hj">åˆ›å»ºæ•°æ®åº“eï¼›</strong></p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ky"><img src="../Images/23d274647ce3746d9391ec7992940d42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QMzcxmyU6Jf_XQzTi2YAMw.png"/></div></div></figure><p id="6745" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æœ€åï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥å¤åˆ¶çš„çŠ¶æ€ã€‚</p><p id="7ee9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨ä¸»ç³»ç»Ÿä¸Š:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kz"><img src="../Images/6eee45375fbe39ca9777f65399d4e0ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0QfMnTxoIebnm2x43PXUKQ.png"/></div></div></figure><p id="27ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨å¤‡ç”¨ç³»ç»Ÿä¸Š:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es la"><img src="../Images/52e9b7e64bc46d0a6df6bbaebb05679a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yeZ16zrySC5Rf6VVM7Nebw.png"/></div></div></figure><p id="c1d1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¦‚æœæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œè¯·è®©æˆ‘çŸ¥é“ï¼</p><p id="dcc7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è°¢è°¢ï¼</p></div></div>    
</body>
</html>