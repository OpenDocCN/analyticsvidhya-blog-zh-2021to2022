<html>
<head>
<title>Time Series Tutorial using NeuralProphet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用NeuralProphet的时间序列教程</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/time-series-tutorial-using-neuralprophet-e918a1b437ed?source=collection_archive---------0-----------------------#2022-02-21">https://medium.com/analytics-vidhya/time-series-tutorial-using-neuralprophet-e918a1b437ed?source=collection_archive---------0-----------------------#2022-02-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/e33a34ce486c62c8d7750e2a5fad18ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W9JXFMEKgW9Aqxt5CkCXjg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">神经原植物。图片来源:NeuralProphet官方知识库</figcaption></figure><p id="3bd8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在本文中，我们将使用NeuralProphet建立一个时间序列预测模型。NeuralProphet是一个基于神经网络的时间序列模型，受<a class="ae js" href="https://github.com/facebook/prophet" rel="noopener ugc nofollow" target="_blank">脸书先知</a>和<a class="ae js" href="https://github.com/ourownstory/AR-Net" rel="noopener ugc nofollow" target="_blank"> AR-Net </a>的启发，建立在PyTorch之上。在本文中，我们将使用AirPassengers数据集，该数据集提供了1949年至1960年美国航空公司乘客的月度总数。</p><h1 id="3c5f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">本文教程:</h1><ol class=""><li id="994d" class="kr ks hi iw b ix kt jb ku jf kv jj kw jn kx jr ky kz la lb bi translated"><strong class="iw hj">神经营养学家简介</strong></li><li id="e401" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr ky kz la lb bi translated"><strong class="iw hj">神经营养蛋白的优势</strong></li><li id="83a4" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr ky kz la lb bi translated"><strong class="iw hj">先知的变化</strong></li><li id="15be" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr ky kz la lb bi translated"><strong class="iw hj">安装神经营养器</strong></li><li id="b258" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr ky kz la lb bi translated"><strong class="iw hj">导入库</strong></li><li id="dcf5" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr ky kz la lb bi translated"><strong class="iw hj">导入输入数据</strong></li><li id="6cb8" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr ky kz la lb bi translated"><strong class="iw hj">数据集的预处理</strong></li></ol><ul class=""><li id="877c" class="kr ks hi iw b ix iy jb jc jf lh jj li jn lj jr lk kz la lb bi translated">重命名列。</li><li id="3f33" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated">更改数据类型。</li></ul><p id="9540" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj"> 8。可视化数据集</strong></p><p id="967e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">9。训练神经营养模型</p><ul class=""><li id="52c6" class="kr ks hi iw b ix iy jb jc jf lh jj li jn lj jr lk kz la lb bi translated">通过模型可视化预测</li><li id="2d2d" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated">可视化组件</li><li id="2197" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated">可视化参数</li><li id="dba1" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated">可视化培训和验证损失</li></ul><p id="fc3e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">10。结论</p><p id="4d93" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">11。参考文献</p><h1 id="d72a" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">神经营养简介</h1><p id="d90d" class="pw-post-body-paragraph iu iv hi iw b ix kt iz ja jb ku jd je jf ll jh ji jj lm jl jm jn ln jp jq jr hb bi translated">NeuralProphet是PyTorch的一个实现，它是一个基于神经网络的用户友好的时间序列预测工具。这在很大程度上受到了脸书开发的流行预测工具Prophet的影响。NeuralProphet建立在完全模块化的架构上，这使得它可以在未来随着新组件的添加而增长。这是一个用户友好的预测工具，保持了Prophet的原始目标，如可解释性和可配置性，同时还通过使用PyTorch作为后端添加了新的功能，如自动差异功能。</p><h1 id="0034" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">NeuralProphet的优势</h1><p id="ac25" class="pw-post-body-paragraph iu iv hi iw b ix kt iz ja jb ku jd je jf ll jh ji jj lm jl jm jn ln jp jq jr hb bi translated">NeuralProphet革新了时间序列建模和预测:</p><ul class=""><li id="12b6" class="kr ks hi iw b ix iy jb jc jf lh jj li jn lj jr lk kz la lb bi translated">支持自动回归和协变量。</li><li id="c493" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated">自动选择与训练相关的超参数。</li><li id="3c90" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated">傅立叶术语不同时间尺度的季节性，包括每年、每天、每周和每小时。</li><li id="d098" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated">分段线性趋势，可选择自动变点检测。</li><li id="3c84" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated">预测成分绘图、模型系数绘图和最终预测绘图。</li><li id="65bd" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated">全球建模协助。</li><li id="7933" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated">未来和滞后回归量</li><li id="78ac" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated">正则化降低了系数稀疏性。</li><li id="e594" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated">Python包，用户友好且功能强大。</li></ul><h1 id="778c" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">神经营养的变化</h1><p id="b50e" class="pw-post-body-paragraph iu iv hi iw b ix kt iz ja jb ku jd je jf ll jh ji jj lm jl jm jn ln jp jq jr hb bi translated">与最初的Prophet相比，NeuralProphet有许多额外的特性。以下是详细内容。</p><ul class=""><li id="35c4" class="kr ks hi iw b ix iy jb jc jf lh jj li jn lj jr lk kz la lb bi translated">使用PyTorch作为后端的梯度下降进行优化。</li><li id="40fb" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated">用AR-Net建立时间序列自相关模型。</li><li id="3082" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated">使用单独的前馈神经网络来模拟滞后回归量。</li><li id="9713" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated">具有可配置非线性深层的FFNNs。</li><li id="b678" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated">适应不同的预测范围(大于1)。</li><li id="10eb" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated">你独有的损失和指标。</li></ul><h1 id="6a74" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">神经营养细胞的安装</h1><p id="2f5c" class="pw-post-body-paragraph iu iv hi iw b ix kt iz ja jb ku jd je jf ll jh ji jj lm jl jm jn ln jp jq jr hb bi translated">我们可以使用pip直接安装neuralprophet:</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="ls lt l"/></div></figure><h2 id="45ac" class="lu ju hi bd jv lv lw lx jz ly lz ma kd jf mb mc kh jj md me kl jn mf mg kp mh bi translated">导入库</h2><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="ls lt l"/></div></figure><h2 id="6714" class="lu ju hi bd jv lv lw lx jz ly lz ma kd jf mb mc kh jj md me kl jn mf mg kp mh bi translated">导入输入数据</h2><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="ls lt l"/></div></figure><p id="0020" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">数据集摘要</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mi"><img src="../Images/705e4f6e197cb71d9a571353d9563065.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WzT5byfxpSVxC_iHL2xWtg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">数据集摘要</figcaption></figure><h1 id="0ee6" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">数据集的预处理</h1><p id="f8ef" class="pw-post-body-paragraph iu iv hi iw b ix kt iz ja jb ku jd je jf ll jh ji jj lm jl jm jn ln jp jq jr hb bi translated">默认情况下，NeuralProphet只需要两列——一列称为“ds ”,代表日期，另一列称为“y ”,代表我们试图预测的值。</p><h2 id="cc74" class="lu ju hi bd jv lv lw lx jz ly lz ma kd jf mb mc kh jj md me kl jn mf mg kp mh bi translated">重命名列</h2><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="ls lt l"/></div></figure><h2 id="7eb9" class="lu ju hi bd jv lv lw lx jz ly lz ma kd jf mb mc kh jj md me kl jn mf mg kp mh bi translated">更改数据类型</h2><p id="fca4" class="pw-post-body-paragraph iu iv hi iw b ix kt iz ja jb ku jd je jf ll jh ji jj lm jl jm jn ln jp jq jr hb bi translated">这里需要注意的重要一点是，ds列必须是datetime类型。但是，我们可以看到它是对象数据类型。现在，因为ds列不是datetime类型。因此，我们需要将它转换成日期时间类型。</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="ls lt l"/></div></figure><h2 id="5b86" class="lu ju hi bd jv lv lw lx jz ly lz ma kd jf mb mc kh jj md me kl jn mf mg kp mh bi translated">可视化数据集</h2><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mj"><img src="../Images/85f755fcea3b5bd1ea1210498f9b0c48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7ye4Ms5j1j-Ew5r4fOaR1g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">可视化数据集</figcaption></figure><h1 id="6474" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">训练神经营养模型</h1><p id="c14d" class="pw-post-body-paragraph iu iv hi iw b ix kt iz ja jb ku jd je jf ll jh ji jj lm jl jm jn ln jp jq jr hb bi translated">我们将用neural_prophet为这个数据集制作一个简单的模型，可以通过创建一个NeuralProphet类的对象来拟合它。这里，数据集的频率是“月”。因此，我们将使用相应的改变频率参数。所有参数默认由NeuralProphet设置。NeuralProphet的模型验证可以通过两种方式完成。用户可以通过在参数valid_p中指定用于验证的数据部分，手动分割数据集以在模型拟合后进行验证，如下所示。在本文中，我们将使用第一种方法。</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="ls lt l"/></div></figure><p id="fae1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">一旦模型被拟合，我们就可以使用拟合模型进行预测。</p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="ls lt l"/></div></figure><h2 id="b883" class="lu ju hi bd jv lv lw lx jz ly lz ma kd jf mb mc kh jj md me kl jn mf mg kp mh bi translated">通过模型可视化预测</h2><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/1532e76c60083a82af669fa9935bc5e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fQt5G0XPKH46Y26788QjGQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">神经营养预测图。图片由作者提供。</figcaption></figure><h2 id="464b" class="lu ju hi bd jv lv lw lx jz ly lz ma kd jf mb mc kh jj md me kl jn mf mg kp mh bi translated">可视化组件</h2><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/79e0f7d778b1ee44ec53bef411e1ff4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rAc3Jd4JEXbfBZ5efFkq4g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">神经营养模型成分图。图片由作者提供。</figcaption></figure><h2 id="97ec" class="lu ju hi bd jv lv lw lx jz ly lz ma kd jf mb mc kh jj md me kl jn mf mg kp mh bi translated">可视化模型参数</h2><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/66a81b78663abc813d18446964349ecf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*byXyDn9B2f4n_Kgw6L7L9A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">神经营养模型参数预测图。图片由作者提供。</figcaption></figure><h2 id="0cf5" class="lu ju hi bd jv lv lw lx jz ly lz ma kd jf mb mc kh jj md me kl jn mf mg kp mh bi translated">可视化培训和验证损失</h2><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/fbb1f99ae0a6996cb01e0a5d2bc29f5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W_TfKTZ-nvBsRPWuMhsThQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">使用平均绝对误差的模型损失</figcaption></figure><h1 id="0213" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">摘要</h1><p id="65cf" class="pw-post-body-paragraph iu iv hi iw b ix kt iz ja jb ku jd je jf ll jh ji jj lm jl jm jn ln jp jq jr hb bi translated">在本文中，我们讨论了NeuralProphet，这是一个使用神经网络对时间序列建模的Python包。图书馆的后台是PyTorch。在这篇文章中，我们开发了一个预测模型使用时间序列数据的航空旅客。NeuralProphet建立在基于AR-Net的完全模块化架构上，使其可扩展以在未来纳入新功能。</p><p id="c8e1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">你可以在这个GitHub资源库中访问全部代码:<a class="ae js" href="https://github.com/chiragsamal/NeuralProphet-Tutorial" rel="noopener ugc nofollow" target="_blank"> NeuralProphet教程</a></p><h1 id="4e14" class="jt ju hi bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">参考资料:</h1><ul class=""><li id="a464" class="kr ks hi iw b ix kt jb ku jf kv jj kw jn kx jr lk kz la lb bi translated"><a class="ae js" href="https://github.com/ourownstory/neural_prophet" rel="noopener ugc nofollow" target="_blank"> NeuralProphet GitHub知识库</a></li><li id="63ff" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated"><a class="ae js" href="https://facebook.github.io/prophet/" rel="noopener ugc nofollow" target="_blank">先知文献</a></li><li id="3b29" class="kr ks hi iw b ix lc jb ld jf le jj lf jn lg jr lk kz la lb bi translated"><a class="ae js" href="https://arxiv.org/pdf/1911.12436.pdf" rel="noopener ugc nofollow" target="_blank"> AR -Net纸</a></li></ul><p id="1c2e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">感谢阅读；我很快会写更多类似的帖子。大家一起参与讨论，随时欢迎建议。</p></div></div>    
</body>
</html>