<html>
<head>
<title>Using RNN Model For Text Generation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用RNN模型生成文本</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/using-rnn-model-for-text-generation-c5a37017d142?source=collection_archive---------2-----------------------#2021-08-23">https://medium.com/analytics-vidhya/using-rnn-model-for-text-generation-c5a37017d142?source=collection_archive---------2-----------------------#2021-08-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="f349" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">什么是RNN模式？</h1><p id="8073" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">RNN的“递归神经网络”是人工智能中的一种神经网络。该网络有两个主要实现:</p><p id="7079" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">时间序列预测- </strong></p><p id="0c3c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">用于预测天气预报、股市预测等。</p><p id="8caf" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">自然语言处理- </strong></p><p id="d91c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><a class="ae kg" href="https://pianalytix.com/recurrent-neural-network-rnn/" rel="noopener ugc nofollow" target="_blank"> RNN </a>在自然语言处理中广泛使用，作为RNN模型的构建层，帮助实现各种自然语言处理应用。尽管其中之一是文本生成。然而，它处理的是创建一个基于以前使用的单词及其语法预测下一个单词的模型。</p><h1 id="e46f" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">如何建立一个RNN模型？</h1><p id="05eb" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">RNN模型类似于CNN模型，只需改变几层就可以在文本语料库(词汇/单词集/句子)上工作。RNN模型由以下几层组成。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/ca22d947d9d808704fcf0d65ee13cccc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HTvaC946gtebBwuq"/></div></div></figure><p id="06f7" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">正如所看到的，只有2个新的层是嵌入和GRU，还有一个层在使用中互换，即LSTM层。</p><h1 id="9e20" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">RNN的层</h1><p id="73b7" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">RNN模型中的每一层都有不同的用途，但是一层的输出是另一层的输入。</p><h2 id="e2e9" class="kt ig hi bd ih ku kv kw il kx ky kz ip jo la lb it js lc ld ix jw le lf jb lg bi translated">首先是嵌入层-</h2><p id="8bc9" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">嵌入层可以看作一个查找表，它将每个单词创建为一个整数，将其映射到一个嵌入。嵌入的大小是一个超参数，你可以通过实验来改变它，看看什么对你的问题有效。</p><p id="0677" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">第二GRU或LSTM(结合双向层)【可选】</strong></p><h2 id="e8a9" class="kt ig hi bd ih ku kv kw il kx ky kz ip jo la lb it js lc ld ix jw le lf jb lg bi translated">LSTM:“长短期记忆”</h2><p id="02a7" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">LSTM循环单元试图“记住”网络已经经历过的所有过去的知识，并且还丢弃“忘记”不需要进一步处理的无关数据。这是通过服务于不同目的的不同激活功能“门”来完成的。</p><p id="66f4" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">每个LSTM循环单元保持一个矢量呼叫作为“内部单元状态”，它描述了由前一个LSTM循环单元传递的要保留的信息。</p><p id="285c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">使用的门如下:</p><ul class=""><li id="e39b" class="lh li hi jf b jg kb jk kc jo lj js lk jw ll ka lm ln lo lp bi translated">忘记大门——忘记什么</li><li id="5393" class="lh li hi jf b jg lq jk lr jo ls js lt jw lu ka lm ln lo lp bi translated">输入门-添加什么</li><li id="b1c8" class="lh li hi jf b jg lq jk lr jo ls js lt jw lu ka lm ln lo lp bi translated">输出门-下一个隐藏状态是什么</li></ul><p id="c53c" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">注:</strong>内部单元状态被认为是输入门的一个子部分，但在许多LSTM文献中它并不被认为是门。</p><h2 id="dfeb" class="kt ig hi bd ih ku kv kw il kx ky kz ip jo la lb it js lc ld ix jw le lf jb lg bi translated">GRU:“门控循环单元”</h2><p id="f9d0" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">与LSTM不同，GRUs由两个门组成，不保持“内部细胞状态”。存储在LSTM循环单元的内部单元状态中的信息被合并到GRU的隐藏状态中。该集合信息传递到下一个门控循环单元。</p><p id="a9d3" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">使用的门如下:</p><ul class=""><li id="ff63" class="lh li hi jf b jg kb jk kc jo lj js lk jw ll ka lm ln lo lp bi translated">更新门-向前传递多少数据</li><li id="5e0c" class="lh li hi jf b jg lq jk lr jo ls js lt jw lu ka lm ln lo lp bi translated">重置门-要忘记多少数据</li></ul><p id="12e3" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">注意:</strong>当前存储器门被认为是复位门的子部分，因为该门的唯一目的是减少过去信息对当前信息的影响。</p><p id="7f2f" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">来到双向，这是一个可选的前缀层使用了LSTM或GRU的组合</p><p id="c6cc" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">举例:</strong></p><p id="2b12" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj"> <em class="lv"> Tf。双向(Tf。</em> </strong></p><p id="4b14" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这一层用于维护两个方向的数据流，即前向和后向，在正常的LSTM中，数据只在前向传播。</p><h1 id="4265" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">RNN的实施</h1><p id="04db" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">与CNN模型类似，RNN模型也需要一些数据预处理。</p><p id="4267" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">在这里，数据是以文本和音频的形式出现的，使用RNN来生成文本。文本生成的预处理非常简单，我们需要将句子分解成单个单词，并创建一个存储所有这些单词的向量。使用函数调用作为记号赋予器就可以了，记号化是将句子分解成记号(单词、字符或子单词)的过程。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lw"><img src="../Images/af2c872a31ccb6b1f378ffc3a1acbff8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*p-Fv83bBU-H1kIe8"/></div></div></figure><p id="b808" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这里的数据保存了故事中的句子3。Txt文件。这些句子然后被转换成小写，然后使用代码中显示的函数进行标记化。Total_words包含训练样本的数量，也称为“M”。</p><p id="478d" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">下一步是通过适当地填充它们以匹配Max_length来创建Input_sequence。</p><h2 id="72c3" class="kt ig hi bd ih ku kv kw il kx ky kz ip jo la lb it js lc ld ix jw le lf jb lg bi translated">例子</h2><p id="673b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">如果Max_length=32并且第一行的长度为25，那么将填充7个空格以保持整批完整。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lx"><img src="../Images/408d0614a1fd20d52d1ec34b92c9b6a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Xhtlc36yoAZJp0YH"/></div></div></figure><p id="0a10" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">然后是标签创建和设置X和Y值，这里切片用于获得X的标签和可训练值，而对于Y值，只有标签与Total_words映射。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ly"><img src="../Images/3a94fed09de5fd2ecbfa2bf089f6f3ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SzUpLVzYhbHVvuCk"/></div></div></figure><h2 id="9c1e" class="kt ig hi bd ih ku kv kw il kx ky kz ip jo la lb it js lc ld ix jw le lf jb lg bi translated">最后训练RNN模型</h2><p id="d82b" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">注意:这个代码只是为故事3创建。Txt文件。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lx"><img src="../Images/0943b6b8a9a007ab7873660e99055265.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*latfrxz4lQ8ksO60"/></div></div></figure><p id="79be" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">您需要了解用于文本生成的每个文件的字数，这将有助于根据需要修改模型。</p><p id="0aa1" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">注意:</strong>对模型进行100-200个时期的训练可能不会产生好的结果，并且由于模型使用了更多的节点和神经元，因此非常繁重。因此，它影响模型的训练时间。</p><h2 id="3744" class="kt ig hi bd ih ku kv kw il kx ky kz ip jo la lb it js lc ld ix jw le lf jb lg bi translated">测试模型</h2><p id="a38c" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">实现后，只需测试模型，您可以使用以下代码块来完成:</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lx"><img src="../Images/7deb90be2d80b8b842c309ffc4ec6f31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*B8H2H4n99GLpwgJq"/></div></div></figure><p id="1319" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated">这里使用一个句子来测试模型，这个句子需要为模型提供生成文本的基础。</p><h1 id="b2c1" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">结论:</h1><p id="7e0a" class="pw-post-body-paragraph jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka hb bi translated">使用RNN文本生成使我们对超参数和其他值进行实验，包括字数和层数，以获得更好的结果。</p><p id="0cf2" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><strong class="jf hj">参考:</strong></p><p id="cafa" class="pw-post-body-paragraph jd je hi jf b jg kb ji jj jk kc jm jn jo kd jq jr js ke ju jv jw kf jy jz ka hb bi translated"><a class="ae kg" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank">https://www.tensorflow.org/</a></p></div></div>    
</body>
</html>