<html>
<head>
<title>Sentiment Analysis, model learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">情感分析，模型学习</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sentiment-analysis-model-learning-5f10d7eda584?source=collection_archive---------2-----------------------#2021-04-06">https://medium.com/analytics-vidhya/sentiment-analysis-model-learning-5f10d7eda584?source=collection_archive---------2-----------------------#2021-04-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="5ada" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你曾经认为机器学习很难，看看这篇文章。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/0b1a2f8f152202c105e18420b9dc82ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a3wJLh0C9jFFfHUWljrOUA.jpeg"/></div></div></figure><h2 id="ea32" class="jo jp hh bd jq jr js jt ju jv jw jx jy ip jz ka kb it kc kd ke ix kf kg kh ki bi translated">介绍</h2><p id="fffb" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">情感分析用于预测文本的喜怒无常的态度。今天，我们将讨论构建神经网络架构，并找到我们目标中的最佳架构。你可能知道，有几类人工神经网络，例如RNN和CNN。这里，我们将关注递归神经网络，它最适合文本操作。</p><p id="2264" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我假设你大概知道，如何加快学习过程。为了实现这个场景，我们使用了GPU计算。不幸的是，在我的电脑中，我没有如此强大的GPU，只有1660 Ti。还好，但是有一些限制，所以我决定用<a class="ae ko" href="https://colab.research.google.com/signup" rel="noopener ugc nofollow" target="_blank"><em class="kp">colab</em></a><em class="kp"/>service<em class="kp">。</em>为此，我想用全部数据来训练我们的模型。遗憾的是，普通可乐有连续使用12小时的限制。考虑到这一点，我决定投资colab pro。至少只花了9.99美元/月。</p><h2 id="cfad" class="jo jp hh bd jq jr js jt ju jv jw jx jy ip jz ka kb it kc kd ke ix kf kg kh ki bi translated">库和设置</h2><p id="f925" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">学习我将使用的模型的库是TensorFlow。使用起来非常简单，当然也很有效。从上一篇文章中，你应该熟悉我的矢量化类，如果没有，请仔细阅读。有几个重要的步骤，我们将如何把文本转换成向量。</p><h2 id="fe2a" class="jo jp hh bd jq jr js jt ju jv jw jx jy ip jz ka kb it kc kd ke ix kf kg kh ki bi translated">装置</h2><p id="0a73" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">如果您决定在培训中使用自己的GPU，有几个要求。我已经完成了这个设置，没有发现任何问题(不像CUDA的新版本)。</p><ul class=""><li id="4311" class="kq kr hh ig b ih ii il im ip ks it kt ix ku jb kv kw kx ky bi translated">实际GPU驱动(GPU: GTX 1660ti): <a class="ae ko" href="https://www.nvidia.com/Download/index.aspx" rel="noopener ugc nofollow" target="_blank">链接</a></li><li id="14e5" class="kq kr hh ig b ih kz il la ip lb it lc ix ld jb kv kw kx ky bi translated">CUDA 10.1 ver 2: <a class="ae ko" href="https://developer.nvidia.com/cuda-10.1-download-archive-update2?target_os=Windows&amp;target_arch=x86_64&amp;target_version=10&amp;target_type=exelocal" rel="noopener ugc nofollow" target="_blank">链接</a></li><li id="c0e6" class="kq kr hh ig b ih kz il la ip lb it lc ix ld jb kv kw kx ky bi translated">Cudnn: <a class="ae ko" href="https://developer.nvidia.com/rdp/cudnn-archive : Download cuDNN v7.6.5 (November 5th, 2019), for CUDA 10.1" rel="noopener ugc nofollow" target="_blank">链接</a></li><li id="d423" class="kq kr hh ig b ih kz il la ip lb it lc ix ld jb kv kw kx ky bi translated">Tensorflow 2.3.0: <a class="ae ko" href="https://www.tensorflow.org/install" rel="noopener ugc nofollow" target="_blank">链接</a></li></ul><p id="bcb7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">不过，如果你想要一步一步的安装说明教程(我个人推荐)。请检查此<a class="ae ko" rel="noopener" href="/analytics-vidhya/install-tensorflow-gpu-cuda-in-windows-10-with-easy-to-follow-instructions-614d79782d26">条</a>。</p><h2 id="73af" class="jo jp hh bd jq jr js jt ju jv jw jx jy ip jz ka kb it kc kd ke ix kf kg kh ki bi translated">最佳建筑</h2><p id="eb33" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">首先，我们应该找到最准确的模型来预测情绪。遗憾的是，这种反复试验的方法花费了一些时间。幸运的是，我已经为你做到了。我测试了十几种架构，选择了最好的一种。下面你可以找到很多准确度和损耗图。在你看我的结论之前，请你自己下结论。用你自己的方式理解这一点非常重要。</p><h2 id="a53f" class="jo jp hh bd jq jr js jt ju jv jw jx jy ip jz ka kb it kc kd ke ix kf kg kh ki bi translated">简单的建筑</h2><p id="1738" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">如果你以前没有用TensorFlow建立过自己的模型，你可能会惊讶于它是多么的简单。TensorFlow是作为高级API构建，它允许我们只使用几行代码就可以准备好模型。这里你有这样一个简单的模型(也是这样一个无效的，由于它的简单性)。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="f3ef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如你所见，我们的第一层是<code class="du lg lh li lj b">Embedding</code>。这一层将我们的手套整数转换成手套向量。</p><p id="7a0f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">之后，我们有一些基本的<em class="kp">密集</em>层和<code class="du lg lh li lj b">tanh</code>激活功能来增加架构的深度。在模型的最后，我们有一个单一的致密层，它负责给我们一个预测的分数。从0为负到1为正。</p><h2 id="1510" class="jo jp hh bd jq jr js jt ju jv jw jx jy ip jz ka kb it kc kd ke ix kf kg kh ki bi translated">架构比较</h2><p id="6578" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">下面是一些精确的示例模型图。在本次培训中，我决定统一超参数:</p><pre class="jd je jf jg fd lk lj ll lm aw ln bi"><span id="0a1c" class="jo jp hh lj b fi lo lp l lq lr">- batch size = 64<br/>- epochs = 30<br/>- learning rate = 0.0002<br/>- loss function = mean absolute error<br/>- optimizer = adam</span></pre><div class="jd je jf jg fd ab cb"><figure class="ls jh lt lu lv lw lx paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/7c7c5fa06bb6043ec0c5ae3ebbc1cb11.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*ewnMUHiFjy2zL0C1YqkT5A.jpeg"/></div></figure><figure class="ls jh lt lu lv lw lx paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/26c71f0d40b5ceca02770be2326a32a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*cP_lytVLEx8xJhzuhLz1pg.jpeg"/></div></figure><figure class="ls jh lt lu lv lw lx paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/038937491d8c1ecd7b9e71a851bf4d50.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*YbUkj6eYH8Bg27TP9Um16g.jpeg"/></div><figcaption class="ly lz et er es ma mb bd b be z dx mc di md me translated">图表1/2/3</figcaption></figure></div><div class="ab cb"><figure class="ls jh lt lu lv lw lx paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/64f5de2bcfcc8b7eeb6707cc42907caf.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*R-5H2Pglox0ZtDIv92bFcA.jpeg"/></div></figure><figure class="ls jh lt lu lv lw lx paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/49146c2db9a143be47f9a46d527b4445.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*TMOf8UYxEJ9F0dusuPQPlQ.jpeg"/></div></figure><figure class="ls jh lt lu lv lw lx paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/f6430e1d4e9f4f7a4c6dde8d44eff77c.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*6bT9IzTQ7JA9K1B2kp_eaA.jpeg"/></div><figcaption class="ly lz et er es ma mb bd b be z dx mc di md me translated">图表4/5/6</figcaption></figure></div><div class="ab cb"><figure class="ls jh lt lu lv lw lx paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/ad5b028194055756d907e974e2750283.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*35LzR-NpHNoI-i1jwClmdg.jpeg"/></div></figure><figure class="ls jh lt lu lv lw lx paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/6d845b0c7dacf200e80c7752e2610e97.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*yeYEh9JZnhRlbJqGYnM-hg.jpeg"/></div></figure><figure class="ls jh lt lu lv lw lx paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/38064c1058c49613748d8580b474a6fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*2JWaPoJbwcNJyCyS5sJGNg.jpeg"/></div><figcaption class="ly lz et er es ma mb bd b be z dx mc di md me translated">图表7/8/9</figcaption></figure></div><div class="ab cb"><figure class="ls jh lt lu lv lw lx paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/bd8ca846aa32a7151dc544eb5bcb91dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*iSsCjz-XnglsWgIG_fWqUQ.jpeg"/></div></figure><figure class="ls jh lt lu lv lw lx paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/eef7970b9c1aa987e98b7b50d6e046da.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*ccjMeNc2cBF-BHWWm4vc4Q.jpeg"/></div></figure><figure class="ls jh lt lu lv lw lx paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/b4f5e09c09d071bd57fdf55d48dba94f.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*LlXdAmkaFrN08_0XN-hzEQ.jpeg"/></div><figcaption class="ly lz et er es ma mb bd b be z dx mc di md me translated">2012年10月11日图表</figcaption></figure></div><p id="1335" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可以在GitHub项目<strong class="ig hi">上找到的所有模型都添加了链接</strong>。这里我们有一些有希望的图表，例如:<code class="du lg lh li lj b">Charts 3/7/9/10</code>。为了在我们的学习项目中选择最佳模型，我决定在整个单个文件中训练它们，该文件包含200万行。在一次训练中，我将使用75个时期来有可能做出一个好的模型选择。</p><div class="jd je jf jg fd ab cb"><figure class="ls jh mf lu lv lw lx paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/f7b674f242f010b5d740f1d35ac740b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*uJvYDNtfu1jj6e1CQWlZ2Q.png"/></div></figure><figure class="ls jh mf lu lv lw lx paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/f472e5c78ae02b9ffa78cc8aa206a85d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*zyXJZOJ0EoCkE5uL7tr5lA.png"/></div><figcaption class="ly lz et er es ma mb bd b be z dx mg di mh me translated">图表3/7</figcaption></figure></div><div class="ab cb"><figure class="ls jh mf lu lv lw lx paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/454d9907f694c45733b23a9c3512517b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*iCp-eYSom0dsAdGSgYe9lA.png"/></div></figure><figure class="ls jh mf lu lv lw lx paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/60354fbf07376ceb4aa99c48875c98ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*JFEWu-CUvq2QLAFgdXyBWA.png"/></div><figcaption class="ly lz et er es ma mb bd b be z dx mg di mh me translated">图表9/10</figcaption></figure></div><p id="4c50" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">正如我们所见，这些模型很有前途。不幸的是，我们不得不拒绝模型3，它降低了我们的准确性。7/9/10型号非常相似，但也有一些细微差别。在图表7和10中，我们可以看到学习过程的一些不稳定性。然而，为了确定，让我们看一下表中20个时期附近的值，因为在这个时期之后，模型开始温和地过度拟合，并降低学习曲线。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="549f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从这些数据中，我们可以很容易地看出不同型号之间的差异。这不是很大的细微差别，但仍然存在。请查看型号9的代码。如果你想看到所有的模型，检查我的GitHub项目。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="le lf l"/></div></figure><h2 id="6c9c" class="jo jp hh bd jq jr js jt ju jv jw jx jy ip jz ka kb it kc kd ke ix kf kg kh ki bi translated"><strong class="ak">数据预测</strong></h2><p id="49bb" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">一旦我们准备好模型。我们应该试着做我们自己的预测。为了简单起见，我决定使用我们之前创建的函数。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="2014" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如我们所见，这里使用的函数与模型学习部分的预处理中的函数相同。第一步是标记我们的文本，然后从手套创建一个向量。有了这些数据，我们可以做出预测。</p><p id="c151" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">很快，我将在我的网站上推出这一模型，如果你想自己测试，请保持关注或发电子邮件给我<strong class="ig hi"><em class="kp">wiktorowski.dev@gmail.com</em></strong>一旦我将这一模型添加到我的网站上，我会给你发送一个链接:)。</p><p id="cca9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，现在让我们看看模型产生的一些预测。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mi"><img src="../Images/a22aec26f03f36ceaad2816f42c989e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A0lJQVrKmUwnyAg2GcuV9A.png"/></div></div><figcaption class="ly lz et er es ma mb bd b be z dx translated">否定句</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mj"><img src="../Images/9488829fcea732e764cbadf27df7b80d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*re4kqMRmd0jtHLoFC_dtGA.png"/></div></div><figcaption class="ly lz et er es ma mb bd b be z dx translated">肯定句</figcaption></figure><p id="cdec" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这些预测的数据来自一个数据集，该数据集不是输入学习数据的一部分。</p><h2 id="b9f3" class="jo jp hh bd jq jr js jt ju jv jw jx jy ip jz ka kb it kc kd ke ix kf kg kh ki bi translated">结论</h2><p id="6124" class="pw-post-body-paragraph ie if hh ig b ih kj ij ik il kk in io ip kl ir is it km iv iw ix kn iz ja jb ha bi translated">在这篇文章中，我们了解了情感分析。我很确定这不会回答你所有的问题，但是我希望，这将帮助你进入主题并创建你自己的第一个模型。即使和我的一样，也没关系。第一步是最重要的:)。</p><p id="b8c7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这一点上，我假设我们的模型的预测分数对于情感分析的基本项目是足够的。我知道这是一个需要改进的地方，但是谁知道呢，也许这个系列的第四部分就要来了。</p><p id="aedb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一如既往，我会很高兴你的反馈和意见。敬请关注，等待后续文章:)</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mk"><img src="../Images/8c5cea259d592078743ec884102bcfaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:64/format:webp/1*VMIj2WuDpUkUbbe_h58XbA.png"/></div><figcaption class="ly lz et er es ma mb bd b be z dx translated"><a class="ae ko" href="https://github.com/wiktorowski-dev?tab=repositories" rel="noopener ugc nofollow" target="_blank"> Github </a></figcaption></figure><p id="7acc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae ko" href="https://wiktorowski.dev" rel="noopener ugc nofollow" target="_blank"> <em class="kp">我的网站</em> </a> <br/> <a class="ae ko" href="https://github.com/wiktorowski-dev/Sentiment-Analysis-project" rel="noopener ugc nofollow" target="_blank"> <em class="kp">本项目在Github上</em> </a></p></div></div>    
</body>
</html>