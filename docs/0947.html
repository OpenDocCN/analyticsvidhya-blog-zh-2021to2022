<html>
<head>
<title>Multi-Label Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多标签分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/multi-label-classification-a9643d221954?source=collection_archive---------17-----------------------#2021-02-07">https://medium.com/analytics-vidhya/multi-label-classification-a9643d221954?source=collection_archive---------17-----------------------#2021-02-07</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="fe24" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi jc translated">多标签分类听起来与多标签分类相似，但完全不同。这些是少数几个术语之一，当你阅读时，你完全明白了这个概念，但是当你试图实现时，你的大脑就像多…什么？那是什么？嗯，我可以向你保证，感到困惑是很正常的，因为在机器学习中有很多奇特的术语，而本博客的目的是澄清其中之一。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/fcd16085095f62a577299e69394d4f8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TKNrfW1b1hb-JeSLy_Zy3w.png"/></div></div></figure><h1 id="4fd3" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">分类</h1><p id="3b05" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">从一组对象中识别出一个对象的过程。例如，当一个婴儿被他/她的母亲抱起时停止了哭泣，他/她的大脑已经从一组其他人中识别出了他的母亲。就是这样。那就是分类。为什么ML要把什么都炒作起来？在我们的日常生活中，我们对数以千计的物体进行分类。我们把成熟的香蕉和未成熟的分类。我们把跑车和普通轿车区分开来。这些事情对我们来说是自然而然的。多年来，我们的大脑已经进化到对它非常精通。这是包括我们在内的所有生物最原始的行为。为了生存，我们需要对周围的事物进行分类。我希望我已经解决了房间里的大象，现在每当你在任何研究论文、帖子等中看到<strong class="ig hi"><em class="la"/></strong>分类这个词。你不会抓狂的。</p><p id="0234" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在你会说我明白了，这对人类来说没什么大不了的，但是机器呢？对此，我的回答是，没什么不同，也没什么复杂的。在机器中，它遵循同样的原理。你从头开始教机器，这个物体是香蕉，另一个物体是苹果，就像你小时候学的一样。你的大脑非常强大，可以在不使用任何编程语言或框架的情况下从演示中学习，:D，然后有人说机器将接管世界。这不会很快发生。我们太聪明了，不会被取代。回到正题，要教所谓的<strong class="ig hi"> <em class="la">【机器】</em> </strong>如何对物体进行分类我们需要给它们数据。</p><p id="acf9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们举下面的例子:</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es lb"><img src="../Images/caa8b0eaef63373730f80514cf58bc4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*8MngJB6XY46cCaecGw4Hsw.png"/></div><figcaption class="lc ld et er es le lf bd b be z dx translated">示例数据集</figcaption></figure><p id="93e8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以看到前两个文件各有一个标签，但第三个文件名有两个标签。这可能吗？是的，下面的图片告诉你为什么？</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lg"><img src="../Images/c533e65f335484b12ab2fbc92b388255.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YEkQv3Ye4e7RfiOL2smcSA.jpeg"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">一个骑马的人</figcaption></figure><p id="ccc9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在此图中，您可以清楚地看到标签是正确的。确实有一个人和一匹马。你会说没关系，高塔姆，但是你要怎么训练它呢？</p><p id="ce2a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">训练它实际上是相当容易的！首先，你需要理解这些标签。暂时忘记我们有多重标签。假设我们有三张图片。</p><ol class=""><li id="a13a" class="lh li hh ig b ih ii il im ip lj it lk ix ll jb lm ln lo lp bi translated">一只猫</li><li id="fa1b" class="lh li hh ig b ih lq il lr ip ls it lt ix lu jb lm ln lo lp bi translated">cog之一</li><li id="a53d" class="lh li hh ig b ih lq il lr ip ls it lt ix lu jb lm ln lo lp bi translated">一个人类</li></ol><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lv"><img src="../Images/c43f8a349975cd8e719321efb4b8eb1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oRmOhY_vIxYlxeAfmOYU_w.jpeg"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">图1:猫</figcaption></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lw"><img src="../Images/13e8879747a5cb54168d3589c71da96e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eYn0M5bgv_g_iiF1qw0Flg.jpeg"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">图2:狗</figcaption></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lx"><img src="../Images/b81aeabaed2655b0858f296f14b87803.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o5gQN3Zcs4GUSrLDn264bw.jpeg"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">图3:人类</figcaption></figure><p id="196c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在假设我准备了一个机器学习模型。它接收一幅图像，然后给出三种概率[p1，p2，p3]</p><p id="acbd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">p1:图像是猫的概率</p><p id="7b2a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">p2:图像可能是狗</p><p id="3f6c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">p3:图像是人类的概率</p><p id="f980" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在有趣的部分来了。你如何比较这些值和你的标签来做反向传播？请注意，你的标签是字符串，如“狗”、“猫”等。你要如何在上面进行反向传播？</p><blockquote class="ly lz ma"><p id="439b" class="ie if la ig b ih ii ij ik il im in io mb iq ir is mc iu iv iw md iy iz ja jb ha bi translated">答案是你需要把这些标签转换成机器能理解的东西。</p></blockquote><h1 id="d077" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">输入一个热编码</h1><p id="0f4b" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">一种热编码是将这些标签转换成机器能够理解的东西，即数字。转换将如下所示:</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es me"><img src="../Images/a3704cf6bd22930a40a3591faff68401.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nemtk4xCHfwp5I-LFazmag.jpeg"/></div></div></figure><ol class=""><li id="f141" class="lh li hh ig b ih ii il im ip lj it lk ix ll jb lm ln lo lp bi translated">找出你有多少独特的对象/类。这个问题我们有3个。就叫<strong class="ig hi">大小</strong>吧。</li><li id="1623" class="lh li hh ig b ih lq il lr ip ls it lt ix lu jb lm ln lo lp bi translated">制作一个大小为<strong class="ig hi">大小为</strong>的数组/向量，并将所有条目分配为0。</li><li id="e6b0" class="lh li hh ig b ih lq il lr ip ls it lt ix lu jb lm ln lo lp bi translated">对于数组中的每个索引，决定你想把它分配给哪个类。例如，假设我给猫指数1，狗指数2和人类指数3(基于一个指数)。</li><li id="59d6" class="lh li hh ig b ih lq il lr ip ls it lt ix lu jb lm ln lo lp bi translated">对于每个图像，在该类表示的索引处用1替换0。例如，在下图中</li></ol><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lx"><img src="../Images/b81aeabaed2655b0858f296f14b87803.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o5gQN3Zcs4GUSrLDn264bw.jpeg"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">图3:人类</figcaption></figure><p id="aba7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我已将索引3分配给人类。所以现在我将用[0 0 1]代替[0 0 0]。</p><p id="b309" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Tada！您已经成功地将图像标签从字符串转换为数值。</p></div><div class="ab cl mf mg go mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ha hb hc hd he"><p id="262a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们回到马和人的例子。我们将如何表现这样的形象？</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es me"><img src="../Images/62c022f94f29244b90f8e9e9bb2a913e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O3gTgnNQb-t7iYkr2x9e_w.jpeg"/></div></div><figcaption class="lc ld et er es le lf bd b be z dx translated">马与人的标签表示</figcaption></figure><p id="c586" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">真的是这样。那就是<strong class="ig hi">多标签分类。</strong>这就是如何将多个标签编码成数字形式。</p><p id="0a7f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以使用强大的库来执行这样的操作，而不是手工操作。FastAI就是其中之一。</p><p id="b9c2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">PyTorch和fastai有两个主要的类来表示和访问训练集或验证集:</p><ol class=""><li id="5743" class="lh li hh ig b ih ii il im ip lj it lk ix ll jb lm ln lo lp bi translated"><strong class="ig hi"> Dataset </strong>:返回单个项目的自变量和因变量元组的集合</li></ol><p id="2b90" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.<strong class="ig hi"> DataLoader </strong>:一个迭代器，提供一个小批量流，其中每个小批量是一批自变量和一批因变量的元组</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="bcd3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们得到以下结果:</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es mo"><img src="../Images/0798948aabd78944ae140dd1cb75a566.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*3a0np7lmeXOG59ebUxGkpA.png"/></div></figure><p id="f494" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">95%的准确率！一点也不差。完整的笔记本可以在(<a class="ae mp" href="https://github.com/fastai/fastbook/blob/master/06_multicat.ipynb" rel="noopener ugc nofollow" target="_blank">链接</a>)找到</p><blockquote class="ly lz ma"><p id="d239" class="ie if la ig b ih ii ij ik il im in io mb iq ir is mc iu iv iw md iy iz ja jb ha bi translated">这里需要注意的另一件重要事情是<strong class="ig hi"> binary_cross_entropy() </strong>函数。我不会去了解它的工作细节，但它大致测量了我们的输出与目标标签的偏差。</p></blockquote><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es mq"><img src="../Images/c2f62bb48c5ace388000cf930dbee81c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8jOp0wMmAz-Mg21_eU1alA.png"/></div></div></figure><p id="93af" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们的损失函数将比较这些值并进行反向传播。</p><p id="c72e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我希望这篇文章能帮助你理解多标签分类。我希望它能激励你把手弄脏并钻研它。如果有帮助，请按拍手按钮。很有帮助:)。</p></div></div>    
</body>
</html>