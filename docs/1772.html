<html>
<head>
<title>Plant Disease Detection Using Convolutional Neural Networks with PyTorch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åŸºäºPyTorchå·ç§¯ç¥ç»ç½‘ç»œçš„æ¤ç‰©ç—…å®³æ£€æµ‹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/plant-disease-detection-using-convolutional-neural-networks-and-pytorch-87c00c54c88f?source=collection_archive---------2-----------------------#2021-03-17">https://medium.com/analytics-vidhya/plant-disease-detection-using-convolutional-neural-networks-and-pytorch-87c00c54c88f?source=collection_archive---------2-----------------------#2021-03-17</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="a26e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ã€äººå·¥æ™ºèƒ½æ˜¯æœªæ¥ã€‚æˆ‘ä»¬å‡ ä¹åœ¨æ¯ä¸ªé¢†åŸŸéƒ½ä½¿ç”¨è¿™äº›æŠ€æœ¯ã€‚åœ¨å†œä¸šé¢†åŸŸï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å°†è¿™é¡¹æŠ€æœ¯ç”¨äºæ•´åœ°ã€æ·»åŠ è‚¥æ–™ã€æ’­ç§ã€çŒæº‰ã€æ‚è‰ä¿æŠ¤ã€æ”¶è·ã€ç–¾ç—…é¢„æµ‹ç­‰ã€‚</p><p id="6ef7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">é˜…è¯»å…¨æ–‡åšå®¢<a class="ae jc" href="http://analyticsvidhya.com/blog/2020/11/artificial-intelligence-in-agriculture-using-modern-day-ai-to-solve-traditional-farming-problems/#:~:text=Precision%20Farming%20and%20Predictive%20Analytics,be%20grown%2C%20optimum%20planting%2C%20pest" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">è‰¾åœ¨å†œã€‚</strong>T3ã€‘</a></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/80a5749b8a73fee22f47cfe37414131a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eFa8Fg7n_JYX7fiHGS2lUg.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">å­¦åˆ†:Unsplash</figcaption></figure><blockquote class="jt ju jv"><p id="3d74" class="ie if jw ig b ih ii ij ik il im in io jx iq ir is jy iu iv iw jz iy iz ja jb ha bi translated"><strong class="ig hi">æ¦‚è¿°:</strong></p></blockquote><p id="64a2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¥åŸºäºæ¤ç‰©å¶å­çš„å›¾åƒè¿›è¡Œæ¤ç‰©ç–¾ç—…æ£€æµ‹ã€‚æˆ‘ä»¬ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¥å®Œæˆè¿™é¡¹ä»»åŠ¡ï¼Œå› ä¸ºæˆ‘ä»¬æ­£åœ¨å¤„ç†å›¾åƒæ•°æ®ã€‚æ·±åº¦å­¦ä¹ æœ‰ä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œï¼Œç”¨äºä»æ¤ç‰©çš„å¶å­ä¸­å¯»æ‰¾ç‰¹å¾ã€‚</p><blockquote class="jt ju jv"><p id="5a90" class="ie if jw ig b ih ii ij ik il im in io jx iq ir is jy iu iv iw jz iy iz ja jb ha bi translated"><strong class="ig hi">å…ˆå†³æ¡ä»¶:</strong></p></blockquote><p id="1ed5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">PyTorch</p><p id="a13d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">å·ç§¯ç¥ç»ç½‘ç»œ</p><p id="df05" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">ä»è¿™é‡Œå­¦ä¹ py torch:</strong></p><p id="15b5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">(1)é˜¿æ‹‰ä¸äººYoutubeæ’­æ”¾åˆ—è¡¨</p><p id="0c02" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">(2) <a class="ae jc" href="https://www.youtube.com/watch?v=EMXfZB8FVUA&amp;list=PLqnslRFeH2UrcDBWF5mfPGpqQDSta6VK4" rel="noopener ugc nofollow" target="_blank"> Pythonå·¥ç¨‹å¸ˆYoutubeæ’­æ”¾åˆ—è¡¨</a></p><p id="e4a9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">ä»è¿™é‡Œå­¦ä¹ CNN:</strong></p><p id="080f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">(1) <a class="ae jc" href="https://www.youtube.com/watch?v=YRhxdVk_sIs" rel="noopener ugc nofollow" target="_blank">ç”±Deeplizardè§£é‡Šçš„å·ç§¯ç¥ç»ç½‘ç»œ</a></p><p id="0a44" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">(2) <a class="ae jc" href="https://www.youtube.com/watch?v=zfiSAzpy9NM" rel="noopener ugc nofollow" target="_blank">ç”¨CodeBasicsç®€å•è§£é‡Šå·ç§¯ç¥ç»ç½‘ç»œ</a></p><blockquote class="jt ju jv"><p id="5771" class="ie if jw ig b ih ii ij ik il im in io jx iq ir is jy iu iv iw jz iy iz ja jb ha bi translated"><strong class="ig hi">æ•°æ®é›†:</strong></p></blockquote><p id="2450" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">åœ¨è¿™ä¸ªæ•°æ®é›†ä¸­ï¼Œæœ‰39ç§ä¸åŒç§ç±»çš„æ¤ç‰©å¶ç‰‡å’ŒèƒŒæ™¯å›¾åƒã€‚è¯¥æ•°æ®é›†åŒ…å«61ï¼Œ486å¹…å›¾åƒã€‚æˆ‘ä»¬ä½¿ç”¨äº†å…­ç§ä¸åŒçš„æ‰©å……æŠ€æœ¯æ¥å¢åŠ æ•°æ®é›†çš„å¤§å°ã€‚è¿™äº›æŠ€æœ¯æ˜¯å›¾åƒç¿»è½¬ã€ä¼½é©¬æ ¡æ­£ã€å™ªå£°æ³¨å…¥ã€PCAé¢œè‰²å¢å¼ºã€æ—‹è½¬å’Œç¼©æ”¾ã€‚</p><p id="fb92" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">æˆ‘ä»¬å¿…é¡»ä½¿ç”¨CNNæ¨¡å‹æ¥é¢„æµ‹æ€»å…±39ä¸ªç±»åˆ«ã€‚</p><p id="ff58" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" href="https://data.mendeley.com/datasets/tywbtsjrjv/1" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">ä¸‹è½½æ•°æ®é›†ã€‚</strong> </a> <strong class="ig hi"> </strong> ( <em class="jw">æ¤ç‰©æ‘æ•°æ®é›†</em>)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ka"><img src="../Images/7971fd4735ffd54167e2b54c981bd8ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*imREJgan5SXx30gZ_gEm5Q.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated"><strong class="bd kb">æ¼”èŒå‘˜è¡¨:</strong>T30ã€‘https://www.crowdai.org/challenges/1</figcaption></figure><blockquote class="jt ju jv"><p id="5d2c" class="ie if jw ig b ih ii ij ik il im in io jx iq ir is jy iu iv iw jz iy iz ja jb ha bi translated"><strong class="ig hi">ä»£ç å®ç°:</strong></p></blockquote><p id="6d9a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">å¯¼å…¥ä¾èµ–å…³ç³»:</strong></p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="2673" class="kh ki hh kd b fi kj kk l kl km"># General<br/>import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt</span><span id="6011" class="kh ki hh kd b fi kn kk l kl km"># Torch<br/>import torch<br/>from torchvision import datasets, transforms # datsets  , transforms<br/>from torch.utils.data.sampler import SubsetRandomSampler<br/>import torch.nn as nn<br/>import torch.nn.functional as F<br/>from datetime import datetime</span></pre><p id="a336" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">å˜æ¢ç”¨äºæ•°æ®æ‰©å……ï¼Œå¦‚è£å‰ªå›¾åƒã€è°ƒæ•´å›¾åƒå¤§å°ã€å°†å›¾åƒè½¬æ¢ä¸ºå¼ é‡ã€æ—‹è½¬å›¾åƒç­‰ç­‰ã€‚å˜æ¢å……å½“æ‰€æœ‰å›¾åƒçš„è¿‡æ»¤å™¨ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢çš„ä»£ç æ¥è½¬æ¢å›¾åƒã€‚</p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="307d" class="kh ki hh kd b fi kj kk l kl km">transform = transforms.Compose(<br/>    [transforms.Resize(255), transforms.CenterCrop(224), transforms.ToTensor()]<br/>)</span></pre><p id="2637" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">datasetsç±»ç”¨äºåˆ›å»ºæˆ–å¯¼å…¥æ•°æ®é›†ã€‚åœ¨æ•°æ®é›†æ–¹é¢ï¼Œå®ƒæœ‰è®¸å¤šè‘—åçš„æ•°æ®é›†ï¼Œå¦‚MNISTï¼ŒCIFAR-10ï¼ŒCIFAR-100ï¼ŒKMNISTç­‰ã€‚</p><p id="ba18" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ç‚¹å‡»æŸ¥çœ‹æ‰€æœ‰æ•°æ®é›†åˆ—è¡¨<a class="ae jc" href="https://pytorch.org/vision/stable/datasets.html" rel="noopener ugc nofollow" target="_blank">ã€‚</a></p><p id="4192" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">æˆ‘ä»¬ä½¿ç”¨æ•°æ®é›†ä»å›¾åƒä¸­åˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„æ•°æ®é›†ï¼Œä¸ºæ­¤æˆ‘ä»¬ä»æ•°æ®é›†ä½¿ç”¨ImageFolderæ–¹æ³•ã€‚</p><p id="099e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">æˆ‘å­˜å‚¨æ‰€æœ‰å›¾åƒçš„æ–‡ä»¶å¤¹åä¸ºâ€œæ•°æ®é›†â€ã€‚æˆ‘ä»¬è¿˜å°†å˜æ¢åº”ç”¨äºæ‰€æœ‰å›¾åƒã€‚</p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="56d6" class="kh ki hh kd b fi kj kk l kl km">dataset = datasets.ImageFolder("Dataset", transform=transform)</span></pre><p id="266e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">åˆ—è½¦è¯•è¿è¡Œ:</strong></p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="d71d" class="kh ki hh kd b fi kj kk l kl km">indices = list(range(len(dataset)))</span><span id="0a15" class="kh ki hh kd b fi kn kk l kl km">split = int(np.floor(0.85 * len(dataset)))  # train_size</span><span id="a929" class="kh ki hh kd b fi kn kk l kl km">validation = int(np.floor(0.70 * split))  # validation</span><span id="cb29" class="kh ki hh kd b fi kn kk l kl km">np.random.shuffle(indices)</span><span id="8a4a" class="kh ki hh kd b fi kn kk l kl km">train_indices, validation_indices, test_indices = (<br/>    indices[:validation],<br/>    indices[validation:split],<br/>    indices[split:],<br/>)</span></pre><p id="f258" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆè·å–ç´¢å¼•ï¼Œç„¶åå°†æ•°æ®åˆ†ä¸ºè®­ç»ƒã€æµ‹è¯•å’ŒéªŒè¯æ•°æ®ã€‚æ€»å…±36584ä¸ªç”¨äºè®­ç»ƒï¼Œ15679ä¸ªç”¨äºéªŒè¯ï¼Œå…¶ä½™å›¾åƒç”¨äºæµ‹è¯•ã€‚</p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="151f" class="kh ki hh kd b fi kj kk l kl km">train_sampler = SubsetRandomSampler(train_indices)<br/>validation_sampler = SubsetRandomSampler(validation_indices)<br/>test_sampler = SubsetRandomSampler(test_indices)</span></pre><p id="d07e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">SubsetRandomSamplerç”¨äºå¯¹æˆ‘ä»¬çš„æ•°æ®è¿›è¡Œé‡‡æ ·ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªSubsetRandomSamplerå¯¹è±¡ï¼Œç¨åæˆ‘ä»¬å°†åœ¨è®­ç»ƒæ•°æ®åŠ è½½å™¨å’Œæµ‹è¯•æ•°æ®åŠ è½½å™¨ä¸­ä½¿ç”¨æ­¤é‡‡æ ·å™¨ã€‚</p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="77c6" class="kh ki hh kd b fi kj kk l kl km">batch_size = 64</span><span id="662d" class="kh ki hh kd b fi kn kk l kl km">train_loader = torch.utils.data.DataLoader(<br/>    dataset, batch_size=batch_size, sampler=train_sampler<br/>)</span><span id="397a" class="kh ki hh kd b fi kn kk l kl km">test_loader = torch.utils.data.DataLoader(<br/>    dataset, batch_size=batch_size, sampler=test_sampler<br/>)</span><span id="3c2e" class="kh ki hh kd b fi kn kk l kl km">validation_loader = torch.utils.data.DataLoader(<br/>    dataset, batch_size=batch_size, sampler=validation_sampler<br/>)</span></pre><p id="633e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">æ­£å¦‚æˆ‘ä»¬æ‰€è®¨è®ºçš„ï¼Œæˆ‘ä»¬å°†train_samplerç”¨äºtrain-loaderï¼Œåä¹‹äº¦ç„¶ã€‚</p><p id="b4d4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ç°åœ¨æˆ‘ä»¬çš„æ•°æ®é›†å·²ç»å‡†å¤‡å¥½è¿›è¡Œè®­ç»ƒå’Œæµ‹è¯•äº†ï¼ï¼</p><p id="a906" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">æ¨¡å‹åˆ›å»º:</strong></p><p id="c3a8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">æˆ‘ä»¬ä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œæ¥åˆ›å»ºæ¨¡å‹ã€‚æˆ‘ä»¬åˆ›å»ºæ¨¡å‹å±‚ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚æˆ‘ä»¬è¿˜æŒ‡å®šäº†Convå±‚å’Œæ¸¸æ³³æ± å±‚çš„è¿‡æ»¤å™¨å¤§å°å’Œæ¯ä¸ªå±‚çš„å½¢çŠ¶ã€‚</p><p id="5e1d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">å½¢çŠ¶=(é€šé“ï¼Œé«˜åº¦ï¼Œå®½åº¦)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ko"><img src="../Images/28f0cd3f231f9bc12ff0c03d68e4f367.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*8e5ZigPh3MlVz-JDMNB6Zw.jpeg"/></div></figure><p id="a392" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">åœ¨PyTorchä¸­ï¼Œå½¢çŠ¶ä¸æ˜¯è‡ªåŠ¨è®¡ç®—çš„ï¼Œæˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨å¤„ç†æ¯ä¸€å±‚çš„å½¢çŠ¶ã€‚åœ¨ç¬¬ä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œæˆ‘ä»¬å¿…é¡»æ ¹æ®å·ç§¯å±‚çš„å½¢çŠ¶æåˆ°è¾“å‡ºå¤§å°ã€‚è¿™ç§è®¡ç®—ä¹Ÿè¢«ç§°ä¸º<strong class="ig hi">å·ç§¯è¿ç®—ã€‚</strong></p><p id="48b0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">å·ç§¯è¿ç®—çš„ç­‰å¼å¦‚ä¸‹:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kp"><img src="../Images/65a6ee14e56f624ee648888b3d0389a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2O18xyA5g-8UPrRP8Y94eA.jpeg"/></div></div></figure><p id="ef12" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œè†¨èƒ€= 0ã€‚</p><p id="1141" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">å…³äºå‹å·ä»£ç ï¼Œè¯·æŸ¥çœ‹æˆ‘çš„Github repo <a class="ae jc" href="https://github.com/manthan89-py/Plant-Disease-Detection" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a></p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="1cc2" class="kh ki hh kd b fi kj kk l kl km">model = CNN(targets_size) # targets_size = 39</span></pre><p id="8918" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¿…é¡»å°†å›¾åƒåˆ†ä¸º39ä¸ªç±»åˆ«ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä½¿ç”¨<strong class="ig hi">åˆ†ç±»äº¤å‰ç†µ</strong>ä½œä¸ºæŸå¤±å’Œadamä¼˜åŒ–å™¨ã€‚åœ¨æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ReLUä½œä¸ºæ¿€æ´»ï¼Œä½†å¯¹äºæœ€åä¸€å±‚ï¼Œæˆ‘ä»¬å¿…é¡»ä½¿ç”¨<strong class="ig hi"> Softmax </strong>æ¿€æ´»ã€‚åœ¨PyTorchä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªäº¤å‰ç†µæŸå¤±ï¼Œå®ƒæ˜¯softmaxå’Œç±»åˆ«äº¤å‰ç†µæŸå¤±çš„æ··åˆã€‚</p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="eab1" class="kh ki hh kd b fi kj kk l kl km">criterion = nn.CrossEntropyLoss()  <br/>optimizer = torch.optim.Adam(model.parameters())</span></pre><p id="cbc4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">æ‰¹é‡æ¢¯åº¦ä¸‹é™:</strong></p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="03c2" class="kh ki hh kd b fi kj kk l kl km">def batch_gd(model, criterion, train_loader, test_laoder, epochs):<br/>    train_losses = np.zeros(epochs)<br/>    test_losses = np.zeros(epochs)</span><span id="8091" class="kh ki hh kd b fi kn kk l kl km">for e in range(epochs):<br/>        t0 = datetime.now()<br/>        train_loss = []<br/>        for inputs, targets in train_loader:<br/>            inputs, targets = inputs.to(device), targets.to(device)</span><span id="a737" class="kh ki hh kd b fi kn kk l kl km">optimizer.zero_grad()</span><span id="3cb5" class="kh ki hh kd b fi kn kk l kl km">output = model(inputs)</span><span id="8179" class="kh ki hh kd b fi kn kk l kl km">loss = criterion(output, targets)</span><span id="d792" class="kh ki hh kd b fi kn kk l kl km">train_loss.append(loss.item())  # torch to numpy world</span><span id="5d87" class="kh ki hh kd b fi kn kk l kl km">loss.backward()<br/>            optimizer.step()</span><span id="885c" class="kh ki hh kd b fi kn kk l kl km">train_loss = np.mean(train_loss)</span><span id="4ad5" class="kh ki hh kd b fi kn kk l kl km">validation_loss = []</span><span id="ebeb" class="kh ki hh kd b fi kn kk l kl km">for inputs, targets in validation_loader:</span><span id="3171" class="kh ki hh kd b fi kn kk l kl km">inputs, targets = inputs.to(device), targets.to(device)</span><span id="23a4" class="kh ki hh kd b fi kn kk l kl km">output = model(inputs)</span><span id="9f68" class="kh ki hh kd b fi kn kk l kl km">loss = criterion(output, targets)</span><span id="7fc9" class="kh ki hh kd b fi kn kk l kl km">validation_loss.append(loss.item())  # torch to numpy world</span><span id="1830" class="kh ki hh kd b fi kn kk l kl km">validation_loss = np.mean(validation_loss)</span><span id="f690" class="kh ki hh kd b fi kn kk l kl km">train_losses[e] = train_loss<br/>        validation_losses[e] = validation_loss</span><span id="78cc" class="kh ki hh kd b fi kn kk l kl km">dt = datetime.now() - t0</span><span id="d68f" class="kh ki hh kd b fi kn kk l kl km">print(<br/>            f"Epoch : {e+1}/{epochs} Train_loss:{train_loss:.3f} Test_loss:{validation_loss:.3f} Duration:{dt}"<br/>        )</span><span id="897d" class="kh ki hh kd b fi kn kk l kl km">return train_losses, validation_losses</span></pre><p id="5eaa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">å¦‚ä½ æ‰€è§ï¼Œä¸Šé¢çš„å‡½æ•°ç”¨äºæ‰¹é‡æ¢¯åº¦ä¸‹é™ã€‚batch_gd()æ˜¯æ‰€æœ‰å­¦ä¹ å‘ç”Ÿçš„å‡½æ•°ã€‚</p><pre class="je jf jg jh fd kc kd ke kf aw kg bi"><span id="6971" class="kh ki hh kd b fi kj kk l kl km">def accuracy(loader):<br/>    n_correct = 0<br/>    n_total = 0</span><span id="cb24" class="kh ki hh kd b fi kn kk l kl km">for inputs, targets in loader:<br/>        inputs, targets = inputs.to(device), targets.to(device)</span><span id="b332" class="kh ki hh kd b fi kn kk l kl km">outputs = model(inputs)</span><span id="5e09" class="kh ki hh kd b fi kn kk l kl km">_, predictions = torch.max(outputs, 1)</span><span id="d185" class="kh ki hh kd b fi kn kk l kl km">n_correct += (predictions == targets).sum().item()<br/>        n_total += targets.shape[0]</span><span id="675c" class="kh ki hh kd b fi kn kk l kl km">acc = n_correct / n_total<br/>    return acc</span><span id="bc74" class="kh ki hh kd b fi kn kk l kl km">train_acc = accuracy(train_loader)<br/>test_acc = accuracy(test_loader)<br/>validation_acc = accuracy(validation_loader)</span></pre><p id="a691" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ä¸Šè¿°å‡½æ•°ç”¨äºç¡®å®šæ¨¡å‹çš„å‡†ç¡®æ€§ã€‚ç†è§£ä»£ç éå¸¸ç®€å•ã€‚ä½ å¯ä»¥åœ¨æˆ‘çš„<a class="ae jc" href="https://github.com/manthan89-py/Plant-Disease-Detection" rel="noopener ugc nofollow" target="_blank"> Github </a>æŸ¥çœ‹å®Œæ•´ä»£ç ã€‚</p><p id="24cd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">é€šè¿‡ä½¿ç”¨å½“å‰çš„æ¨¡å‹ï¼Œæˆ‘ä»¬è·å¾—äº†å‡†ç¡®æ€§</p><p id="1c49" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">åˆ—è½¦æ•°æ®ä¸Š<strong class="ig hi"> 87 % </strong>ï¼ŒéªŒè¯æ•°æ®ä¸Š<strong class="ig hi"> 84 </strong> <strong class="ig hi"> % </strong>ï¼Œæµ‹è¯•æ•°æ®ä¸Š<strong class="ig hi"> 83 </strong> %ã€‚</p><p id="6bc2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨æµ‹è¯•æ•°æ®ä½œä¸ºå…¨æ–°çš„æ•°æ®ã€‚æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨ä»»ä½•é˜¶æ®µçš„æµ‹è¯•æ•°æ®ï¼Œè¿™äº›æ•°æ®ä»…ç”¨äºæœ€ç»ˆæµ‹è¯•ã€‚</p><blockquote class="jt ju jv"><p id="2454" class="ie if jw ig b ih ii ij ik il im in io jx iq ir is jy iu iv iw jz iy iz ja jb ha bi translated"><strong class="ig hi">æ¨¡å‹å·¥ä½œ:</strong></p></blockquote><p id="dd05" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">å¦‚æœä½ çŸ¥é“CNNçš„å·¥ä½œï¼Œé‚£ä¹ˆä½ å°±ä¼šæ˜ç™½æˆ‘åœ¨è¿™ä¸ªé¡¹ç›®ä¸­æ‰€åšçš„äº‹æƒ…ã€‚è¿™ä¸€èŠ‚æ˜¯ç»™é‚£äº›ä¸æ˜ç™½çš„äººçœ‹çš„ã€‚åŸºæœ¬ä¸Šï¼Œé¦–å…ˆæˆ‘ä»¬å°†æ¯å¼ å›¾ç‰‡çš„å¤§å°è°ƒæ•´ä¸º224 x 224ã€‚ä¹‹åï¼Œè¿™ä¸ªå›¾åƒè¾“å…¥åˆ°å·ç§¯ç¥ç»ç½‘ç»œã€‚æˆ‘ä»¬é¥²æ–™å½©è‰²å›¾åƒï¼Œæ‰€ä»¥å®ƒæœ‰3ä¸ªé€šé“RGBã€‚ç¬¬ä¸€convå±‚ï¼Œæˆ‘ä»¬åº”ç”¨32ä¸ªæ»¤æ³¢å™¨å¤§å°æˆ–è¾“å‡ºé€šé“ã€‚è¿™æ„å‘³ç€32ä¸ªä¸åŒçš„è¿‡æ»¤å™¨åº”ç”¨äºå›¾åƒï¼Œå¹¶è¯•å›¾æ‰¾åˆ°ç‰¹å¾ï¼Œç„¶åä½¿ç”¨32ä¸ªç‰¹å¾ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå…·æœ‰é€šé“32çš„ç‰¹å¾å›¾ã€‚æ‰€ä»¥ä»3 x 224 x 224ä¼šå˜æˆ32 x 222 x 222ã€‚ä¹‹åï¼Œæˆ‘ä»¬åº”ç”¨<strong class="ig hi"> ReLU </strong>æ¿€æ´»å‡½æ•°æ¥æ¶ˆé™¤éçº¿æ€§ï¼Œä¹‹åæˆ‘ä»¬åº”ç”¨<strong class="ig hi">æ‰¹é‡æ ‡å‡†åŒ–</strong>æ¥æ ‡å‡†åŒ–ç¥ç»å…ƒçš„æƒé‡ã€‚åœ¨æ­¤ä¹‹åï¼Œæˆ‘ä»¬å°†è¯¥å›¾åƒé¦ˆé€åˆ°æœ€å¤§æ± å±‚ï¼Œè¯¥å±‚ä»…è·å–æœ€ç›¸å…³çš„ç‰¹å¾ï¼Œå› æ­¤æˆ‘ä»¬å¾—åˆ°å½¢çŠ¶ä¸º32 x 112 x 112çš„è¾“å‡ºå›¾åƒã€‚ä¹‹åï¼Œæˆ‘ä»¬å°†æ­¤å›¾åƒé¦ˆé€åˆ°ä¸‹ä¸€ä¸ª<strong class="ig hi">å·ç§¯å±‚</strong>ï¼Œå…¶è¿‡ç¨‹ä¸ä¸Šé¢æåˆ°çš„ç›¸åŒã€‚æœ€åï¼Œæˆ‘ä»¬å±•å¹³æœ€ç»ˆçš„æœ€å¤§æ± å±‚è¾“å‡ºï¼Œå¹¶é¦ˆé€åˆ°ä¸‹ä¸€ä¸ªçº¿æ€§å±‚ï¼Œè¯¥çº¿æ€§å±‚ä¹Ÿè¢«ç§°ä¸º<strong class="ig hi">å…¨è¿æ¥å±‚</strong>ï¼Œæœ€åï¼Œä½œä¸ºæœ€ç»ˆå±‚ï¼Œæˆ‘ä»¬é¢„æµ‹39ä¸ªç±»åˆ«ã€‚å› æ­¤ï¼Œä½œä¸ºæ¨¡å‹è¾“å‡ºï¼Œæˆ‘ä»¬å¾—åˆ°å¼ é‡1x39å¤§å°ã€‚ä»å¼ é‡ä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°å¼ é‡ä¸­æœ€å¤§å€¼çš„ç´¢å¼•ã€‚é‚£ä¸ªç‰¹å®šçš„æŒ‡æ•°æ˜¯æˆ‘ä»¬çš„ä¸»è¦é¢„æµ‹ã€‚è¿™å°±æ˜¯ä¸€åˆ‡è¿ä½œçš„æ–¹å¼...ï¼ï¼</p><p id="aee6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">å¸Œæœ›ä½ èƒ½ç†è§£â€¦ğŸ‘ğŸ»ğŸ˜Š</p><blockquote class="jt ju jv"><p id="e984" class="ie if jw ig b ih ii ij ik il im in io jx iq ir is jy iu iv iw jz iy iz ja jb ha bi translated"><strong class="ig hi">çƒ§ç“¶ç½‘ç»œApp : </strong></p></blockquote><p id="93f9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">åœ¨åˆ›å»ºäº†è¿™ä¸ªæ¨¡å‹ä¹‹åï¼Œæˆ‘ä»¬åœ¨flaskä¸Šåˆ›å»ºäº†ä¸€ä¸ªwebåº”ç”¨ç¨‹åºï¼Œå¹¶å°†å…¶éƒ¨ç½²åœ¨herokuäº‘æœåŠ¡å™¨ä¸Šã€‚</p><p id="2a89" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">flaskæ¡†æ¶çš„ç¼–ç ä¹Ÿå¯ä»¥åœ¨æˆ‘çš„github repo <a class="ae jc" href="https://github.com/manthan89-py/Plant-Disease-Detection" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>æ‰¾åˆ°ã€‚</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="kq kr l"/></div></figure><p id="a742" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" href="https://plant-disease-detection-ai.herokuapp.com" rel="noopener ugc nofollow" target="_blank">Plant-Disease-Detection-AI.Herokuapp.com</a></p><blockquote class="jt ju jv"><p id="48f9" class="ie if jw ig b ih ii ij ik il im in io jx iq ir is jy iu iv iw jz iy iz ja jb ha bi translated"><strong class="ig hi">ä»£ç :</strong></p></blockquote><div class="ks kt ez fb ku kv"><a href="https://github.com/manthan89-py/Plant-Disease-Detection" rel="noopener  ugc nofollow" target="_blank"><div class="kw ab dw"><div class="kx ab ky cl cj kz"><h2 class="bd hi fi z dy la ea eb lb ed ef hg bi translated">man than 89-py/æ¤ç‰©ç—…å®³æ£€æµ‹</h2><div class="lc l"><h3 class="bd b fi z dy la ea eb lb ed ef dx translated">åŸºäºå¶ç‰‡å›¾åƒï¼Œæˆ‘ä»¬è¯•å›¾ä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œæ¥é¢„æµ‹æ¤ç‰©ç–¾ç—…ã€‚PyTorchå®ç°â€¦</h3></div><div class="ld l"><p class="bd b fp z dy la ea eb lb ed ef dx translated">github.com</p></div></div><div class="le l"><div class="lf l lg lh li le lj jn kv"/></div></div></a></div><blockquote class="jt ju jv"><p id="c320" class="ie if jw ig b ih ii ij ik il im in io jx iq ir is jy iu iv iw jz iy iz ja jb ha bi translated"><strong class="ig hi">é¢†è‹±:</strong></p></blockquote><div class="ks kt ez fb ku kv"><a href="https://www.linkedin.com/in/manthanbhikadiya" rel="noopener  ugc nofollow" target="_blank"><div class="kw ab dw"><div class="kx ab ky cl cj kz"><h2 class="bd hi fi z dy la ea eb lb ed ef hg bi translated">å°åº¦å¤å‰æ‹‰ç‰¹é‚¦è‹æ‹‰ç‰¹æ›¼ä¸¹Â·æ¯”å¡ç¬¬äºš-æŸ¥ç½—ç‰¹ç§‘æŠ€å¤§å­¦|â€¦</h2><div class="lc l"><h3 class="bd b fi z dy la ea eb lb ed ef dx translated">æŸ¥çœ‹Manthan Bhikadiyaåœ¨ä¸–ç•Œä¸Šæœ€å¤§çš„èŒä¸šç¤¾åŒºLinkedInä¸Šçš„ä¸ªäººèµ„æ–™ã€‚Manthanæœ‰ä¸€ä»½å·¥ä½œåˆ—åœ¨â€¦</h3></div><div class="ld l"><p class="bd b fp z dy la ea eb lb ed ef dx translated">www.linkedin.com</p></div></div></div></a></div><blockquote class="jt ju jv"><p id="8f24" class="ie if jw ig b ih ii ij ik il im in io jx iq ir is jy iu iv iw jz iy iz ja jb ha bi translated"><strong class="ig hi">ç»“è®º:</strong></p></blockquote><p id="6472" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">è¿™ç§æ¨¡å¼åœ¨æ²¡æœ‰è¿ç§»å­¦ä¹ çš„æƒ…å†µä¸‹éå¸¸æœ‰æ•ˆã€‚ä½†æ˜¯æˆ‘ä¼šç”¨è¿ç§»å­¦ä¹ ç­‰å¾ˆå¤šæ–¹æ³•æ¥æé«˜æ¨¡å‹çš„å‡†ç¡®æ€§ã€‚</p><p id="984e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">æˆ‘å¸Œæœ›ä½ å–œæ¬¢è¿™ä¸ªé¡¹ç›®ğŸ™ã€‚</p><blockquote class="jt ju jv"><p id="428a" class="ie if jw ig b ih ii ij ik il im in io jx iq ir is jy iu iv iw jz iy iz ja jb ha bi translated"><strong class="ig hi">æ›´å¤šåšå®¢å’Œé¡¹ç›®:</strong></p></blockquote><p id="b019" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jw">é¡¹ç›®:</em> </strong></p><div class="ks kt ez fb ku kv"><a href="https://github.com/manthan89-py" rel="noopener  ugc nofollow" target="_blank"><div class="kw ab dw"><div class="kx ab ky cl cj kz"><h2 class="bd hi fi z dy la ea eb lb ed ef hg bi translated">manthan89-py -æ¦‚è¿°</h2><div class="lc l"><h3 class="bd b fi z dy la ea eb lb ed ef dx translated">å¯¹AIã€æ·±åº¦å­¦ä¹ ã€æœºå™¨å­¦ä¹ ã€è®¡ç®—æœºè§†è§‰ã€åŒºå—é“¾ã€Flutteræ„Ÿå…´è¶£ğŸ˜‡ã€‚åšä¸€äº›ç«äº‰æ€§çš„â€¦</h3></div><div class="ld l"><p class="bd b fp z dy la ea eb lb ed ef dx translated">github.com</p></div></div><div class="le l"><div class="lk l lg lh li le lj jn kv"/></div></div></a></div><p id="b871" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jw">åšå®¢:</em> </strong></p><div class="ks kt ez fb ku kv"><a href="https://manthan-bhikadiya.medium.com/" rel="noopener follow" target="_blank"><div class="kw ab dw"><div class="kx ab ky cl cj kz"><h2 class="bd hi fi z dy la ea eb lb ed ef hg bi translated">æ›¼ä¸¹Â·æ¯”å¡ç¬¬äºšÂ·ğŸ–‹-ä¸­ç­‰</h2><div class="lc l"><h3 class="bd b fi z dy la ea eb lb ed ef dx translated">æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ã€äººå·¥æ™ºèƒ½æ˜¯æœªæ¥ã€‚æˆ‘ä»¬å‡ ä¹åœ¨æ¯ä¸ªé¢†åŸŸéƒ½ä½¿ç”¨è¿™äº›æŠ€æœ¯â€¦</h3></div><div class="ld l"><p class="bd b fp z dy la ea eb lb ed ef dx translated">manthan-bhikadiya.medium.com</p></div></div><div class="le l"><div class="ll l lg lh li le lj jn kv"/></div></div></a></div><blockquote class="jt ju jv"><p id="84b8" class="ie if jw ig b ih ii ij ik il im in io jx iq ir is jy iu iv iw jz iy iz ja jb ha bi translated"><strong class="ig hi">æœ€ç»ˆæ³¨é‡Š:</strong></p></blockquote><p id="dcc2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">æ„Ÿè°¢é˜…è¯»ï¼å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·ç‚¹å‡»</strong>ğŸ‘<strong class="ig hi">å°½å¯èƒ½å¤šæ¬¡æŒ‰ä¸‹æŒ‰é’®ã€‚è¿™å°†æ„å‘³ç€å¾ˆå¤šï¼Œå¹¶é¼“åŠ±æˆ‘ç»§ç»­åˆ†äº«æˆ‘çš„çŸ¥è¯†ã€‚å¦‚æœä½ å–œæ¬¢æˆ‘çš„å†…å®¹ï¼Œè¯·åœ¨mediumä¸Šå…³æ³¨æˆ‘ï¼Œæˆ‘ä¼šå°½å¯èƒ½å¤šåœ°å‘å¸ƒåšå®¢ã€‚</strong></p></div></div>    
</body>
</html>