<html>
<head>
<title>Plotting Bitcoin Candlestick Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python绘制比特币烛台</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/plotting-bitcoin-candlestick-using-python-5a307e02d30?source=collection_archive---------8-----------------------#2021-02-23">https://medium.com/analytics-vidhya/plotting-bitcoin-candlestick-using-python-5a307e02d30?source=collection_archive---------8-----------------------#2021-02-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="59ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如何获取比特币历史价格并使用Python绘制烛台？</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/8f8b4137d18264e58b9e6fad4866c84b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yrvwpjBVUFFsY9vd1RwFnQ.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated"><a class="ae jt" href="http://www.freepik.com" rel="noopener ugc nofollow" target="_blank">由vectorjuice / Freepik设计</a></figcaption></figure><p id="5eff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">过去几个月，比特币价格大幅上涨，从10.000美元左右涨到50.000美元左右的历史高点。随着价格的上涨，人们对这种加密货币的兴趣也增加了，正如我们在下图中从<a class="ae jt" href="https://trends.google.com/trends" rel="noopener ugc nofollow" target="_blank">谷歌趋势</a>(过去12个月)的数据中看到的。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ju jv l"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">数据来源:<a class="ae jt" href="https://www.google.com/trends" rel="noopener ugc nofollow" target="_blank">谷歌趋势</a></figcaption></figure><p id="c984" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你是这些人中的一员，并且对操作比特币(或其他加密货币)感兴趣，你应该使用的一个重要图形是烛台，主要是如果你对交易(买卖以获利)感兴趣。</p><blockquote class="jw jx jy"><p id="4d8b" class="if ig jz ih b ii ij ik il im in io ip ka ir is it kb iv iw ix kc iz ja jb jc hb bi translated">蜡烛图是技术分析中使用的一种价格图表，显示特定时期内证券的最高价、最低价、开盘价和收盘价。它起源于日本米商和贸易商跟踪市场价格和每日势头。它反映了投资者情绪对价格的影响，并被技术分析师用来决定何时进入和退出交易。</p></blockquote><p id="6e70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个项目的目标是展示如何使用Python轻松绘制比特币价格的蜡烛图。我们将使用Pandas DataReader库获得历史价格数据，并使用Plotly库绘制图表。您还可以使用这里介绍的方法来绘制任何加密货币、股票或ETF的图表。</p><p id="4d10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">本项目并不意味着推荐买卖比特币。</strong></p><p id="bffb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你对这个项目的全部代码感兴趣，请查看我的<a class="ae jt" href="https://github.com/hugoplm/bitcoin-candlestick/blob/main/Bitcoin_Candlestick.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>。</p></div><div class="ab cl kd ke gp kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hb hc hd he hf"><h2 id="b2a8" class="kk kl hi bd km kn ko kp kq kr ks kt ku iq kv kw kx iu ky kz la iy lb lc ld le bi translated">1.使用Pandas DataReader获取比特币历史数据</h2><p id="4217" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lh is it iu li iw ix iy lj ja jb jc hb bi translated">为了获得比特币的历史数据，我们将使用Pandas DataReader库。</p><p id="21ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了使本文更简单，我不会在这里详细介绍这个库，但是如果你想了解更多关于Pandas-DataReader的信息，我建议你看一下<a class="ae jt" href="https://pandas-datareader.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank">文档</a>。此外，由于我们正在处理数据框，我建议你看一下熊猫<a class="ae jt" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html" rel="noopener ugc nofollow" target="_blank">文档</a>，以防你不知道。</p><p id="d342" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一步是导入库。</p><pre class="je jf jg jh fd lk ll lm ln aw lo bi"><span id="e670" class="kk kl hi ll b fi lp lq l lr ls">import pandas as pd<br/>import pandas_datareader.data as pdr<br/>import datetime as dt</span></pre><p id="d2f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们可以运行下面的代码来获取数据。我们需要提供以下参数:</p><ul class=""><li id="82fa" class="lt lu hi ih b ii ij im in iq lv iu lw iy lx jc ly lz ma mb bi translated">开始日期和结束日期:获取数据的期间。在这种情况下，我们将使用库<a class="ae jt" href="https://docs.python.org/3/library/datetime.html" rel="noopener ugc nofollow" target="_blank"> datetime </a>并提供日、月和年。我们会得到过去12个月的数据，从2020年2月19日到2021年2月18日。</li><li id="51a9" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated">数据来源:我们将使用“雅虎”作为我们的数据来源。</li><li id="bcb5" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated">股票代码:由于我们想要绘制比特币价格，我们的股票代码是“BTC-美元”(以美元计算的比特币价格)。</li></ul><pre class="je jf jg jh fd lk ll lm ln aw lo bi"><span id="cf20" class="kk kl hi ll b fi lp lq l lr ls">start = datetime.datetime(2020,2,19)<br/>end = datetime.datetime(2021,2,18)<br/>df = pdr.DataReader('BTC-USD','yahoo',start,end)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mh"><img src="../Images/21459bd0c1c3c4878913a2c873770d25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WXkN0HcM5ITewRGxvzt4RA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">包含过去12个月比特币历史数据的数据框。</figcaption></figure><p id="1d94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据框包含以下各列:</p><ul class=""><li id="7fdf" class="lt lu hi ih b ii ij im in iq lv iu lw iy lx jc ly lz ma mb bi translated"><em class="jz">日期:</em>参考的日子。每行代表一天。</li><li id="d412" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated"><em class="jz">高点:</em>参考日比特币的最高价格。</li><li id="9bbc" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated"><em class="jz">低:</em>参考日比特币的最低价格。</li><li id="3230" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated"><em class="jz">开盘价:</em>比特币在基准日的开盘价。</li><li id="4a8a" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated"><em class="jz">收盘:</em>比特币在基准日的收盘价。</li><li id="cf1f" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated"><em class="jz">成交量:</em>参考日比特币成交的成交量。</li><li id="0390" class="lt lu hi ih b ii mc im md iq me iu mf iy mg jc ly lz ma mb bi translated"><em class="jz">调整收盘:</em>参考日比特币调整后的收盘价格。</li></ul><p id="430e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们有了数据，让我们进入下一部分，绘制我们的蜡烛图。</p></div><div class="ab cl kd ke gp kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hb hc hd he hf"><h2 id="5b17" class="kk kl hi bd km kn ko kp kq kr ks kt ku iq kv kw kx iu ky kz la iy lb lc ld le bi translated">2.使用Plotly绘制比特币烛台</h2><p id="cb4b" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lh is it iu li iw ix iy lj ja jb jc hb bi translated">Plotly是一个用于数据可视化的开源库，允许轻松绘制不同类型的图表并在线发布。在这个项目中，我们将看到如何在Jupyter笔记本中绘制离线图形。如果你想在网上发布你的图表并分享它们，或者如果你想了解更多关于这个库的信息，我推荐你看一下<a class="ae jt" href="http://plotly documentation python pdf" rel="noopener ugc nofollow" target="_blank">文档</a>。你还可以看到所有可以绘制的图表类型。</p><p id="0884" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一步是导入库。我们需要导入<em class="jz"> graph_objs </em>方法，它负责创建图形本身。此外，由于我们想在笔记本中绘制图表，我们需要导入<em class="jz">离线</em>方法。</p><pre class="je jf jg jh fd lk ll lm ln aw lo bi"><span id="f492" class="kk kl hi ll b fi lp lq l lr ls">import plotly.offline as py<br/>import plotly.graph_objs as go</span></pre><p id="3d2e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一步是运行下面的代码来显示笔记本中的绘图。</p><pre class="je jf jg jh fd lk ll lm ln aw lo bi"><span id="239d" class="kk kl hi ll b fi lp lq l lr ls">py.init_notebook_mode(connected=True)</span></pre><p id="bcf4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了创建图表，我们需要使用来自<em class="jz"> graph_objs </em>的方法<em class="jz">烛台</em>和我们的数据<em class="jz">。</em>需要提供x轴数据即我们的<em class="jz">日期</em>栏，y轴数据即开盘价、最高价、最低价和收盘价，分别是我们的<em class="jz">开盘价</em>、<em class="jz">高</em>、<em class="jz">低</em>和<em class="jz">收盘</em>栏。我们需要将所有这些信息放入一个列表中，并将其赋给一个变量，在本例中为“data”。</p><pre class="je jf jg jh fd lk ll lm ln aw lo bi"><span id="0158" class="kk kl hi ll b fi lp lq l lr ls">data = [go.Candlestick(x=df.index,<br/>                       open=df.Open,<br/>                       high=df.High,<br/>                       low=df.Low,<br/>                       close=df.Close)]</span></pre><p id="f84d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们可以定义我们的布局，这将允许我们定制情节和插入一些功能。在这种情况下，我们将为图表设置一个标题，并在x轴上插入一个日期范围滑块。</p><pre class="je jf jg jh fd lk ll lm ln aw lo bi"><span id="0c82" class="kk kl hi ll b fi lp lq l lr ls">layout = go.Layout(title='Bitcoin Candlestick with Range Slider',<br/>                   xaxis={'rangeslider':{'visible':True}})</span></pre><p id="452e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我们可以最终创建我们的数字，并绘制我们的图表。</p><pre class="je jf jg jh fd lk ll lm ln aw lo bi"><span id="34b6" class="kk kl hi ll b fi lp lq l lr ls">fig = go.Figure(data=data,layout=layout)</span><span id="8075" class="kk kl hi ll b fi mi lq l lr ls">py.iplot(fig,filename='bitcoin_candlestick')</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mj"><img src="../Images/119ae64d5558097f77431bd337d118a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kXKA4Hw1MQ3X8dup0t06Ww.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">比特币烛台，带范围滑块。</figcaption></figure><h2 id="e62d" class="kk kl hi bd km kn ko kp kq kr ks kt ku iq kv kw kx iu ky kz la iy lb lc ld le bi translated">3.向烛台图添加选择器</h2><p id="3c65" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lh is it iu li iw ix iy lj ja jb jc hb bi translated">除了范围滑块之外，我们还可以向绘图添加另一个特性:范围选择器，它提供了在图表中选择已定义范围的按钮。在这个例子中，创建了一些按钮来显示过去一周(1w)、过去一个月(1m)、过去三个月(3m)、过去六个月(6m)和过去一年(1y)的值。</p><p id="7a8f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以在下图中看到选择按钮“1m”后的结果:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mj"><img src="../Images/0f394ee2dd1508289789acc0f4d129ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z-fSpWJRU_IIf_72qKGNtg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">带有范围滑块和选择器的比特币烛台，显示过去1个月(1m)。</figcaption></figure><p id="56b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要添加选择器，我们需要为布局中的参数<em class="jz"> xaxis </em>在字典中添加一个新值。下面你可以看到过去1个月来添加按钮的代码。如果你对整个代码感兴趣，请在我的<a class="ae jt" href="https://github.com/hugoplm/bitcoin-candlestick/blob/main/Bitcoin_Candlestick.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上查看这个项目的笔记本。</p><pre class="je jf jg jh fd lk ll lm ln aw lo bi"><span id="cb02" class="kk kl hi ll b fi lp lq l lr ls">xaxis = {'rangeselector':{'buttons':[{'count':1,<br/>                                      'label':'1m',<br/>                                      'step':'month',<br/>                                      'stepmode':backward'}]}}</span></pre></div><div class="ab cl kd ke gp kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hb hc hd he hf"><h1 id="8a06" class="mk kl hi bd km ml mm mn kq mo mp mq ku mr ms mt kx mu mv mw la mx my mz ld na bi translated">结论</h1><p id="deb5" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lh is it iu li iw ix iy lj ja jb jc hb bi translated">在这个项目中，我介绍了如何获得比特币历史价格数据，并使用Plotly库绘制烛台。您可以使用这里提供的相同代码来绘制其他加密货币和股票的烛台图，您只需要在下载数据时设置所需的跑马灯。此外，如果您需要更新的数据，您可以实现一个例程来每天(甚至一天中的某些时间，这取决于您的数据源)获取数据并绘制烛台。</p><p id="dbe0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您花时间阅读本文。我希望你喜欢学习如何轻松地使用Plotly绘制烛台。如果您对此有任何问题或反馈，请随时通过<a class="ae jt" href="https://www.linkedin.com/in/hugoplm/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p></div><div class="ab cl kd ke gp kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hb hc hd he hf"><h2 id="6ebf" class="kk kl hi bd km kn ko kp kq kr ks kt ku iq kv kw kx iu ky kz la iy lb lc ld le bi translated">参考资料:</h2><p id="ed46" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lh is it iu li iw ix iy lj ja jb jc hb bi translated">[1]:海耶斯，亚当。(2020年7月29日)。烛台定义。从https://www.investopedia.com/terms/c/candlestick.asp<a class="ae jt" href="https://www.investopedia.com/terms/c/candlestick.asp" rel="noopener ugc nofollow" target="_blank">取回</a></p></div></div>    
</body>
</html>