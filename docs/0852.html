<html>
<head>
<title>Google Analytics Customer Revenue Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谷歌分析客户收入预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/google-analytics-customer-revenue-prediction-416066fa91cf?source=collection_archive---------5-----------------------#2021-02-03">https://medium.com/analytics-vidhya/google-analytics-customer-revenue-prediction-416066fa91cf?source=collection_archive---------5-----------------------#2021-02-03</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="4708" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi jc translated">oogle商品商店(也称为<a class="ae jl" href="https://googlemerchandisestore.com/" rel="noopener ugc nofollow" target="_blank"> GStore </a>)出售谷歌的赠品，如t恤、帽子、钱包等。在线。<a class="ae jl" href="https://analytics.google.com/analytics/web/" rel="noopener ugc nofollow" target="_blank">谷歌分析</a> (GA)是谷歌提供的一款网络分析工具，用于分析网站流量和用户的各种统计数据，可以与任何网站集成。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jm"><img src="../Images/bc0c0c24104af1582c8c9efbc6460e88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WpbOa49IhdW7cMA6vlLiQQ.png"/></div></div></figure><p id="e673" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">作为本案例研究的一部分，任务是预测用户使用GStore的Google Analytics数据所产生的总收入。</p><h1 id="a10b" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">概述</h1><ol class=""><li id="a92e" class="kw kx hh ig b ih ky il kz ip la it lb ix lc jb ld le lf lg bi translated"><em class="lh">商业问题</em></li><li id="6489" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated"><em class="lh"> ML问题公式化</em></li><li id="dd7e" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated"><em class="lh">数据来源</em></li><li id="693e" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated"><em class="lh">数据概述</em></li><li id="ab22" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated"><em class="lh">探索性数据分析(EDA) </em></li><li id="40db" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated"><em class="lh">数据清理和特征工程</em></li><li id="8b8a" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated"><em class="lh">验证策略</em></li><li id="87a3" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated"><em class="lh">造型</em></li><li id="01d3" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated"><em class="lh">部署</em></li><li id="fd7e" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated"><em class="lh">结论</em></li><li id="d5c9" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated"><em class="lh">未来工作</em></li><li id="be58" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated"><em class="lh">参考文献</em></li></ol><h1 id="1a2f" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">1.商业问题</h1><p id="fb55" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">GStore为其网站收集了谷歌分析数据，包括用户的设备、位置、日期时间、访问频率、每次访问花费的时间、页面浏览量、产生的收入等。大约100万用户访问和大约2年的时间范围。使用该数据，如果每个客户产生的总收入是预先已知的，则组织/营销团队知道用户在特定时间范围内对特定产品的行为，并且在广告/营销上的投资可以更加有效和以客户为中心。因此，任务是预测2个月时间窗口内访客产生的总收入。</p><p id="98e7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这种分析主要对营销团队有用，以便对促销策略进行适当的投资。以下是该分析的一些其他可能的使用案例:特定于客户/地区的广告、营销预算、不同地区的用户偏好等。</p><h1 id="ea44" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">2.ML问题公式化</h1><p id="289a" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">这个问题可以公式化为一个时间序列预测问题来预测每个客户的总收入。训练数据集包含有关不同用户的信息，我们应该预测这些客户在未来2个月的时间窗内产生的总收入。因此，这个问题可以被视为一个双向分类(用户是否会在2个月内返回GStore回归(如果用户返回，他/她产生的收入)。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es lq"><img src="../Images/a613eb6f0f0fb17cea64e12dba6de866.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*rLTmIBepexu5yguSNtynDQ.jpeg"/></div></figure><p id="59af" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">均方根误差(RMSE)和决定系数(R)将用作评估性能的指标。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es lr"><img src="../Images/c7017f521f909240da757be2fc3ecb6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*LVPKZjE_3J7fb46z93Sm5g.png"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">决定系数</figcaption></figure><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es lw"><img src="../Images/97f877f582d6e0ae0c308b35d0e26bc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*Pp_j25_aridYujyjTcbfUw.png"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">均方根误差/除法</figcaption></figure><h1 id="6e8c" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">3.数据来源</h1><p id="4e82" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">这些数据由RStudio在Kaggle平台上提供，用于竞赛和研究目的。</p><div class="lx ly ez fb lz ma"><a href="https://www.kaggle.com/c/ga-customer-revenue-prediction/data" rel="noopener  ugc nofollow" target="_blank"><div class="mb ab dw"><div class="mc ab md cl cj me"><h2 class="bd hi fi z dy mf ea eb mg ed ef hg bi translated">谷歌分析客户收入预测</h2><div class="mh l"><h3 class="bd b fi z dy mf ea eb mg ed ef dx translated">预测GStore客户的消费金额</h3></div><div class="mi l"><p class="bd b fp z dy mf ea eb mg ed ef dx translated">www.kaggle.com</p></div></div><div class="mj l"><div class="mk l ml mm mn mj mo jw ma"/></div></div></a></div><h1 id="5691" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">4.数据概述</h1><p id="0d4b" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">数据集包含两个CSV文件:train和test。训练数据包含大约2年时间范围内的用户访问。列车数据范围为2016年1月8日至2018年4月30日。测试集从2018年1月5日到2018年10月15日，这是162天的窗口。Kaggle将对2018年1月12日至2019年1月31日(62天)范围内的车型进行评分。因此，实际预测窗口和测试窗口之间有46天的差距。以下是数据集中给出的一些主要特征。</p><ol class=""><li id="1ef3" class="kw kx hh ig b ih ii il im ip mp it mq ix mr jb ld le lf lg bi translated">用户设备相关功能:操作系统、浏览器、类别(台式机、平板电脑、移动设备)</li><li id="9b9a" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated">地理特征:国家，大陆，州，城市，纬度，经度，地区，次大陆</li><li id="2e15" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated">网络流量特征:来源、媒介、关键词</li><li id="9bdb" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated">访问日期</li><li id="0d5d" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated">其他统计数据，如页面浏览量，点击率，访问量，在GStore网站上花费的时间等。</li></ol><p id="56cb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们应该预测所有客户产生的总收入的自然对数。</p><h1 id="0157" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">5.探索性数据分析</h1><p id="54c1" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">这里是详细的EDA的关键，这样做是为了理解给定的数据。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es ms"><img src="../Images/815e73c58a261eff55dcdcc5fb8efddc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ds2ZX0_WNHZqkMw53K79rw.png"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">目标分布</figcaption></figure><p id="2e92" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上图将目标分布显示为PDF曲线。大部分收益目标集中在~ 0 ~ 8之间(数字为对数刻度)。</p><p id="d911" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下是各种设备相关功能的分布。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es mt"><img src="../Images/48f09a4afaf2a6046c5dd93f389ca354.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ioqp02fLhpjoDNbcyOi4Pg.png"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">设备功能</figcaption></figure><p id="292d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是按国家划分的地理收入。收入最高的国家是美国。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es mu"><img src="../Images/7c9ddc8996d1ead6e322a39735805cec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BRmQxwnxfsaueMf2mR0ZkA.png"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">每个国家产生的收入</figcaption></figure><p id="a53b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下图显示了整个培训期间产生的收入。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es mv"><img src="../Images/b6bb05ac454122bdd81a79dc73ba0391.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jk-NnJn6u5d3NP4YWlGhrw.png"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">每日收入</figcaption></figure><p id="2ca8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下图显示了每个页面浏览量产生的收入。大量的页面浏览量产生大量的收入。22次页面浏览量创造了约5万美元的收入。这意味着，用户在花钱之前会多次浏览同一个产品页面。这是一个预期的行为，也是我们模型的一个有希望的特性。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es mw"><img src="../Images/ada7c63e731b04122e00b6ff513c35d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*09PLiUjZqT6b0roVjYynNw.png"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">每页收入视图</figcaption></figure><h1 id="b5eb" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">6.数据清理和特征工程</h1><p id="92a8" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">这是机器学习最重要的部分。在清理数据之后，需要从给定的数据中仔细地提取特征/进行工程设计，以使任何模型表现良好。</p><p id="9bfa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在给定的数据集中，有许多没有用的单值特征，因此我放弃了这些特征。我还删除了丢失值超过90%的特性。删除这些要素后，有几个要素有少量缺失值。我用中值(如果特征是连续的)或众数(分类特征)来填充。这里我使用了中位数来克服异常值问题。</p><p id="fa8f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个案例研究中，我提取了许多不同的特征(通过自己和参考Kaggle讨论线程和其他博客)。在这里，我将解释在我的模型中提取并具有显著特征重要性的主要特征。</p><ol class=""><li id="2567" class="kw kx hh ig b ih ii il im ip mp it mq ix mr jb ld le lf lg bi translated">页面浏览量和页面点击率及其聚合特征，如每个用户的总和、平均值和标准差(STD)。</li><li id="4f15" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated">用户的商店访问时间相关特征，如用户的首次/最后一次访问时间，它们之间的差异。第一次/最后一次就诊时间和当前就诊时间之间的差异。</li><li id="7615" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated">在现场花费的时间及其总和，如总和、平均值和标准差。</li><li id="b9e6" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated">用户访问GStore的国家的GDP。</li><li id="a998" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated">引荐路径和关键词中是否有一些类似“Google”、“Youtube”的特定词语。</li><li id="cda2" class="kw kx hh ig b ih li il lj ip lk it ll ix lm jb ld le lf lg bi translated">与日期时间相关的特征，如月、日、周、季度、年、周末、星期等。</li></ol><p id="d94b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">除了上面列出的特征之外，默认特征也是有希望的，并且对预测有贡献。</p><p id="74a3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">作为数据准备的一部分，我使用标签编码对分类值进行了编码，因为一些要素具有大量的类别，使用一种热编码并不可取，尤其是在处理基于树的模型时，因为它会创建稀疏的要素。</p><h1 id="eb32" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">7.验证策略</h1><p id="53bc" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">为了评估模型的泛化性能和超参数调整，需要一个可靠的验证策略。由于这个问题是典型的时间序列预测问题，我最初尝试用Sklearn的TimeSeriesSplit进行交叉验证。它以<a class="ae jl" href="https://stats.stackexchange.com/a/14109/176418" rel="noopener ugc nofollow" target="_blank">正向链接</a>的方式分割数据，使得验证集始终是相应训练集的未来数据。</p><p id="3d82" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但这种分割并不代表数据集的实际分布，在这个特定问题中，模型是在数据集上进行测试的。因此，它在本地验证集上提高了模型性能，但在Kaggle上，当使用实际测试集(与模型的训练集明显不同)进行测试时，性能非常低。在仔细阅读了许多Kaggle讨论线程和数据描述后，我知道在训练集日期和测试集日期之间有46天的差距。因此，我需要在培训时也考虑到这个差距。</p><p id="b499" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">基于这个观察，我改变了验证策略。我将整个训练数据集分成4个168天的非重叠窗口。对于每个窗口，目标是同一客户在46天间隔后的62天未来窗口中产生的总收入。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es mx"><img src="../Images/e1f2e44d977d59dba68f0e44038c2865.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*x02inq-stOTj2VL9uAIX1w.jpeg"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">1个培训窗口的表示</figcaption></figure><p id="8ab1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在将数据分割成这样的分割后，3个窗口用于模型训练，1个窗口用于验证和超参数调整。这种队形显著地改进了模型，并且在Kaggle测试集上也取得了很好的成绩。</p><h1 id="da4f" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">8.建模</h1><p id="5847" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">如前所述，我用了3个168天的窗口来训练模型，用了1个窗口来验证。在特征提取之后，训练数据集包含13，31，148个数据点，验证数据包含4，71，114个数据点，具有67个特征。</p><p id="37d2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在训练了基线模型(均值和中值)之后，我训练了LGBM和TabNet模型。在这个问题中，因为几乎所有的访问者都没有产生任何收入(总收入为0)，所以平均值和中值基线非常强劲，很难超越。使用Optuna对LGBM模型进行超参数调整后，其性能优于最佳基线。TabNet的结果与基线模型相似。</p><p id="9f81" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下是我用来获得最佳性能的最佳超参数和LGBM模型配置。</p><h2 id="408b" class="my jz hh bd ka mz na nb ke nc nd ne ki ip nf ng km it nh ni kq ix nj nk ku nl bi translated">分类模型</h2><pre class="jn jo jp jq fd nm nn no np aw nq bi"><span id="0287" class="my jz hh nn b fi nr ns l nt nu">clf_params = {<br/>    "objective": "binary",<br/>    "max_bin": 256,<br/>    "learning_rate": 0.01,<br/>    "num_leaves": 31,<br/>    "bagging_fraction": 0.9,<br/>    "feature_fraction": 0.8,<br/>    "feature_fraction_seed": 28,<br/>    "bagging_seed": 28,<br/>    "min_child_samples": 1,<br/>    "bagging_freq": 1,<br/>    "metric": "binary_logloss"<br/>}</span><span id="da5a" class="my jz hh nn b fi nv ns l nt nu">clf_model = lgb.train(<br/>    params=clf_params,<br/>    train_set=train_data,<br/>    num_boost_round=200,<br/>    valid_sets=[val_data],<br/>    early_stopping_rounds=200,<br/>    verbose_eval=200<br/>)</span></pre><h2 id="30a8" class="my jz hh bd ka mz na nb ke nc nd ne ki ip nf ng km it nh ni kq ix nj nk ku nl bi translated">回归模型</h2><pre class="jn jo jp jq fd nm nn no np aw nq bi"><span id="f7d5" class="my jz hh nn b fi nr ns l nt nu">reg_params = {<br/>    "objective": "binary",<br/>    "max_bin": 256,<br/>    "learning_rate": 0.01,<br/>    "num_leaves": 9,<br/>    "bagging_fraction": 0.9,<br/>    "feature_fraction": 0.8,<br/>    "feature_fraction_seed": 28,<br/>    "bagging_seed": 28,<br/>    "min_child_samples": 1,<br/>    "bagging_freq": 1,<br/>    "metric": "rmse"<br/>}</span><span id="b277" class="my jz hh nn b fi nv ns l nt nu">reg_model = lgb.train(<br/>    params=reg_params,<br/>    train_set=train_data,<br/>    num_boost_round=200,<br/>    valid_sets=[val_data],<br/>    early_stopping_rounds=200,<br/>    verbose_eval=200<br/>)</span></pre><p id="5d6a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我将两个模型的预测汇总如下:</p><pre class="jn jo jp jq fd nm nn no np aw nq bi"><span id="148c" class="my jz hh nn b fi nr ns l nt nu">will_return_preds = clf_model.predict(...)<br/>revenue_preds = reg_model.predict(...)<br/>revenue = will_return_preds * revenue_preds</span></pre><p id="3162" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">结合这两个模型得到的验证RMSE为0.6042，R系数为0.12。在Kaggle上，它获得了0.8844的RMSE。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es nw"><img src="../Images/4d9a27fea47284b86f33943b4d9ad69d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KVUGZBRLW_tCyM5NbQfdJg.png"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">Kaggle分数</figcaption></figure><p id="6019" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在1084名竞争者中排名第19位(前2%)。。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es nx"><img src="../Images/c1d0b3cdbfe3f5e92770780a80ac932f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZfR-JhHpaH-o7BvaNvviQw.png"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">Kaggle排行榜</figcaption></figure><p id="abca" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我还训练了TabNet(基于深度学习的表格数据集模型)。以下是用于训练回归和分类模型的代码片段。</p><pre class="jn jo jp jq fd nm nn no np aw nq bi"><span id="f6d2" class="my jz hh nn b fi nr ns l nt nu">from pytorch_tabnet.tab_model import TabNetClassifier, TabNetRegressor</span><span id="228e" class="my jz hh nn b fi nv ns l nt nu"># Classifier<br/>clf_tabnet = TabNetClassifier()<br/>clf_tabnet.fit(<br/>    x_train.values,<br/>    y_train.values,<br/>    eval_set=[(x_val.values, y_val.values)],<br/>    max_epochs=3<br/>)</span><span id="d54d" class="my jz hh nn b fi nv ns l nt nu"># Regressor<br/>reg_tabnet = TabNetRegressor()</span><span id="a7f5" class="my jz hh nn b fi nv ns l nt nu">reg_tabnet.fit(<br/>    x_train.values, y_train.values.reshape(-1, 1),<br/>    eval_set=[(x_val.values, y_val.values.reshape(-1, 1))],<br/>    eval_metric=['rmse'],<br/>    max_epochs=15<br/>)</span></pre><p id="cd54" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">具有默认超参数的TabNet在验证数据集上实现了0.6343 RMSE。在Kaggle上，它得到了0.8866，比强基线略好。</p><p id="e8db" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下是分类和回归LGBM模型的特征重要性图。</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es ny"><img src="../Images/67e800dbe9e27face0c7aea13ff53db2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*dBJnYngRkh87S9mCRodlkQ.png"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">回归特征重要性</figcaption></figure><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es nz"><img src="../Images/75b3566a2d229d520ef3cd58464202ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*eGu9s4cPoUpRXKHwhjm0wg.png"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">分类特征重要性</figcaption></figure><p id="2282" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下是我的模型的汇总结果:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es oa"><img src="../Images/7bfb3e4a7ce9762fba0f71235cf74fe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dToKT0gblZhJ3xrEOeV9oQ.png"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">模型分数</figcaption></figure><h1 id="1974" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">9.部署</h1><p id="9fd0" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">我使用Flask(用于后端API)和Jinja2(用于模板)来部署我的模型。以下是一个简短视频的链接，展示了预测的演示:</p><figure class="jn jo jp jq fd jr"><div class="bz dy l di"><div class="ob oc l"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">部署</figcaption></figure><h1 id="7e6e" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">10.结论</h1><p id="6e93" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">完成这个案例研究后，我了解了验证策略的重要性以及它如何影响模型的泛化性能。</p><p id="bd88" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在时间序列预测问题中，如果适当地调整超参数，像LGBM这样的三个基本模型工作得非常好。还有基于深度学习的模型，如TabNets，它在没有超参数调整的情况下提供了与LGBM相当的性能。</p><h1 id="b8b1" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">11.未来的工作</h1><p id="db35" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">如前所述，我对这个数据集尝试了TabNets，但是没有执行超参数调优。因此，我计划调整TabNet的超参数，并将它的性能与LGBM模型进行比较。除此之外，目前，我保持LGMB模型的几个超参数不变(如学习率)，并从调整中排除它们，以减少搜索空间。如果我获得了足够的处理能力，我还计划将它们全部包含进来，并运行更长时间的超参数搜索，以检查性能是否进一步提高。</p><h1 id="54af" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">12.参考</h1><div class="lx ly ez fb lz ma"><a href="https://support.google.com/analytics/answer/3437719?hl=en" rel="noopener  ugc nofollow" target="_blank"><div class="mb ab dw"><div class="mc ab md cl cj me"><h2 class="bd hi fi z dy mf ea eb mg ed ef hg bi translated">BigQuery导出架构</h2><div class="mh l"><h3 class="bd b fi z dy mf ea eb mg ed ef dx translated">此功能不受服务级别协议(SLA)的控制。本文解释了…的格式和模式</h3></div><div class="mi l"><p class="bd b fp z dy mf ea eb mg ed ef dx translated">support.google.com</p></div></div></div></a></div><div class="lx ly ez fb lz ma"><a href="https://www.kaggle.com/c/ga-customer-revenue-prediction/discussion/82746" rel="noopener  ugc nofollow" target="_blank"><div class="mb ab dw"><div class="mc ab md cl cj me"><h2 class="bd hi fi z dy mf ea eb mg ed ef hg bi translated">谷歌分析客户收入预测</h2><div class="mh l"><h3 class="bd b fi z dy mf ea eb mg ed ef dx translated">预测GStore客户的消费金额</h3></div><div class="mi l"><p class="bd b fp z dy mf ea eb mg ed ef dx translated">www.kaggle.com</p></div></div><div class="mj l"><div class="od l ml mm mn mj mo jw ma"/></div></div></a></div><div class="lx ly ez fb lz ma"><a href="https://www.kaggle.com/c/ga-customer-revenue-prediction/discussion/82614" rel="noopener  ugc nofollow" target="_blank"><div class="mb ab dw"><div class="mc ab md cl cj me"><h2 class="bd hi fi z dy mf ea eb mg ed ef hg bi translated">谷歌分析客户收入预测</h2><div class="mh l"><h3 class="bd b fi z dy mf ea eb mg ed ef dx translated">预测GStore客户的消费金额</h3></div><div class="mi l"><p class="bd b fp z dy mf ea eb mg ed ef dx translated">www.kaggle.com</p></div></div><div class="mj l"><div class="oe l ml mm mn mj mo jw ma"/></div></div></a></div><div class="lx ly ez fb lz ma"><a href="https://github.com/optuna/optuna/blob/master/examples/lightgbm_simple.py" rel="noopener  ugc nofollow" target="_blank"><div class="mb ab dw"><div class="mc ab md cl cj me"><h2 class="bd hi fi z dy mf ea eb mg ed ef hg bi translated">optuna/optuna</h2><div class="mh l"><h3 class="bd b fi z dy mf ea eb mg ed ef dx translated">超参数优化框架。在GitHub上创建一个帐户，为optuna/optuna的发展做出贡献。</h3></div><div class="mi l"><p class="bd b fp z dy mf ea eb mg ed ef dx translated">github.com</p></div></div><div class="mj l"><div class="of l ml mm mn mj mo jw ma"/></div></div></a></div><div class="lx ly ez fb lz ma"><a href="https://github.com/dreamquark-ai/tabnet" rel="noopener  ugc nofollow" target="_blank"><div class="mb ab dw"><div class="mc ab md cl cj me"><h2 class="bd hi fi z dy mf ea eb mg ed ef hg bi translated">dreamquark-ai/tabnet</h2><div class="mh l"><h3 class="bd b fi z dy mf ea eb mg ed ef dx translated">这是Tabnet的pyTorch实现(Arik，S. O .，&amp; Pfister，T. (2019)。TabNet:专注的可解释表格…</h3></div><div class="mi l"><p class="bd b fp z dy mf ea eb mg ed ef dx translated">github.com</p></div></div><div class="mj l"><div class="og l ml mm mn mj mo jw ma"/></div></div></a></div><div class="lx ly ez fb lz ma"><a href="https://arxiv.org/abs/1908.07442" rel="noopener  ugc nofollow" target="_blank"><div class="mb ab dw"><div class="mc ab md cl cj me"><h2 class="bd hi fi z dy mf ea eb mg ed ef hg bi translated">TabNet:专注的可解释表格学习</h2><div class="mh l"><h3 class="bd b fi z dy mf ea eb mg ed ef dx translated">我们提出了一种新的高性能和可解释的规范深度表格数据学习架构TabNet。TabNet…</h3></div><div class="mi l"><p class="bd b fp z dy mf ea eb mg ed ef dx translated">arxiv.org</p></div></div></div></a></div><div class="lx ly ez fb lz ma"><a href="https://lightgbm.readthedocs.io/en/latest/" rel="noopener  ugc nofollow" target="_blank"><div class="mb ab dw"><div class="mc ab md cl cj me"><h2 class="bd hi fi z dy mf ea eb mg ed ef hg bi translated">欢迎阅读LightGBM的文档！-light GBM 3.1.1.99文档</h2><div class="mh l"><h3 class="bd b fi z dy mf ea eb mg ed ef dx translated">LightGBM是一个梯度推进框架，使用基于树的学习算法。它被设计成分布式的…</h3></div><div class="mi l"><p class="bd b fp z dy mf ea eb mg ed ef dx translated">lightgbm.readthedocs.io</p></div></div></div></a></div><p id="3bf6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你喜欢这篇文章，请为这个故事鼓掌，并在LinkedIn上与我联系:<a class="ae jl" href="https://www.linkedin.com/in/kaushal-shah-466587110/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/kaushal-shah-466587110/</a></p></div></div>    
</body>
</html>