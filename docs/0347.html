<html>
<head>
<title>Multiple choice QA using Transformers.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用变压器的多项选择问答。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/multiple-choice-qa-using-deep-learning-44689618a253?source=collection_archive---------4-----------------------#2021-01-13">https://medium.com/analytics-vidhya/multiple-choice-qa-using-deep-learning-44689618a253?source=collection_archive---------4-----------------------#2021-01-13</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="a318" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">AI2弧数据集。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/7764b6a9c52613434ad444fefd8f1692.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RZOWzgJlUI-tqRNO"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">Nguyen Dang Hoang Nhu 在<a class="ae js" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h2 id="8f04" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated">目录</h2><ol class=""><li id="2cee" class="kv kw hh ig b ih kx il ky ip kz it la ix lb jb lc ld le lf bi translated"><a class="ae js" href="#9e97" rel="noopener ugc nofollow">简介</a>。</li><li id="4e43" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lc ld le lf bi translated"><a class="ae js" href="#30c8" rel="noopener ugc nofollow">问题陈述</a>。</li><li id="f134" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lc ld le lf bi translated"><a class="ae js" href="#dbb0" rel="noopener ugc nofollow">目标</a>。</li><li id="15f3" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lc ld le lf bi translated"><a class="ae js" href="#e8f8" rel="noopener ugc nofollow">探索性数据分析</a>。</li><li id="26fc" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lc ld le lf bi translated"><a class="ae js" href="#51df" rel="noopener ugc nofollow">分度</a>。</li><li id="2c3d" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lc ld le lf bi translated"><a class="ae js" href="#610a" rel="noopener ugc nofollow">上下文检索</a>。</li><li id="cd5c" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lc ld le lf bi translated"><a class="ae js" href="#520e" rel="noopener ugc nofollow">造型</a>。</li></ol></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h2 id="9e97" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated"><strong class="ak">简介</strong></h2><p id="de20" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">数据集越来越多地推动着人工智能的进步，为一些问答任务带来了令人印象深刻的解决方案。然而，这些数据集中在检索式的任务上，仅表层线索通常就足以识别答案。这并没有鼓励在需要推理、使用常识或其他高级方法来加深文本理解的问题上取得进展。这里提出的挑战称为ARC (AI2推理挑战)，旨在通过提出难以用简单基线回答的问题来解决这一限制。</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h2 id="30c8" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated"><strong class="ak">问题陈述</strong></h2><p id="ef69" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">认为你已经解决了问题回答？试试AI2推理挑战(ARC)！</p><p id="0a13" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一个由7，787个真正的小学水平的多项选择科学问题组成的新数据集，旨在鼓励对高级问答的研究。数据集被划分为挑战集和简单集，其中前者仅包含由基于检索的算法和单词共现算法错误回答的问题。</p><h2 id="fde5" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated">公制的</h2><p id="9ba7" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">精确度用作度量标准。</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h2 id="dbb0" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated">目标</h2><ol class=""><li id="1f17" class="kv kw hh ig b ih kx il ky ip kz it la ix lb jb lc ld le lf bi translated">给定一个多项选择问题，我们必须预测正确的答案。</li><li id="c2bf" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lc ld le lf bi translated">尽可能提高精确度。</li></ol><h2 id="d710" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated">数据</h2><p id="f048" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">数据可以从<a class="ae js" href="https://allenai.org/data/arc" rel="noopener ugc nofollow" target="_blank">这里</a>下载。</p><p id="dab2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">提供的文件有:</p><ul class=""><li id="7631" class="kv kw hh ig b ih ii il im ip lo it lp ix lq jb lr ld le lf bi translated">挑战列车:1119</li><li id="0482" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">挑战开发者:299</li><li id="6b08" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">挑战测试:1，172</li><li id="89bc" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">简易列车:2251</li><li id="eb6f" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">简单开发:570</li><li id="dd87" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">简单测试:2376</li></ul><p id="b67b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">每组都有两种格式，CSV和JSON。CSV文件在一个单元格中包含问题的完整文本及其答案选项。JSON文件包含问题的一个分割版本，其中问题文本已经通过编程与答案选项分开。</p><h2 id="eef6" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated">数据字段</h2><ul class=""><li id="7207" class="kv kw hh ig b ih kx il ky ip kz it la ix lb jb lr ld le lf bi translated">questionID —问题的唯一标识符(我们自己的编号)。</li><li id="1431" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">原始问题ID —测试中的问题编号。</li><li id="26e7" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">totalPossiblePoint —评分时问题值多少分。</li><li id="0c15" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">AnswerKey —正确答案选项。</li><li id="6b18" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">isMultipleChoiceQuestion — 1 =多项选择，0 =其他。</li><li id="dbdd" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">includes diagram-1 =包含图表，0 =其他。</li><li id="7558" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">考试名称-考试的来源。</li><li id="8edf" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">学校等级——年级水平。</li><li id="b973" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">年份—考试的出版年份。</li><li id="e38f" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">问题—问题本身的文本。</li><li id="adc0" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">主题—一般问题主题。</li><li id="c208" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">类别—测试、培训或开发。</li></ul></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="e8f8" class="ls kb hh bd kc lt lu lv kg lw lx ly kk lz ma mb kn mc md me kq mf mg mh kt mi bi translated">探索性数据分析</h1><p id="7b07" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">让我们执行EDA来深入了解给定的数据。</p><p id="3af1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">关于简易训练数据的信息如下:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mj"><img src="../Images/535a0123d4310a90065a62585ab9757b.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*N1ep_PxlB-ykCVQRA82Q8A.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">train.info()</figcaption></figure><p id="ed20" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里我们可以看到简单训练数据集有2251个条目。所有条目都不为空。要使用的重要列有questionID、AnswerKey、question。</p><p id="f239" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们检查一下重要的列。</p><h2 id="3b70" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated">问题:</h2><p id="41f1" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">一个问题的例子如下:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mk"><img src="../Images/e4c05e40b5b304228b180c7626a9ed3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gO4AuwpSg6Etfe4twXdsnA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">问题示例。</figcaption></figure><p id="5860" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，我们可以看到问题列中的一个条目包含有多个选项的问题。</p><p id="b8dc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在观察了许多问题样本后，我发现了以下情况:</p><p id="29bf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">(1)一个问题既包含大写字母，也包含小写字母。</p><p id="00c1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">(2)问题和答案选项仅由空格分隔。</p><p id="19bf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">(3)答案选项以ABCD和1234两种格式呈现。我们需要解决这个问题。</p><h2 id="96f5" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated">接听键:</h2><p id="4008" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">简单训练和测试集中所有唯一值的列表如下:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ml"><img src="../Images/3d5326b31ccabc8fe18a6c618791854e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*V_ibbs1MMFdB9ewgGb4sVA.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">AnswerKey中的唯一值。</figcaption></figure><p id="c7d0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们看看值的分布:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mm"><img src="../Images/805de997d333ce0fe1fe48456dd538cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9nm51x8FdEfVYRSs8idDEA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">列车组。</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mn"><img src="../Images/c55cac3b80ee69493f28de680a6d5a03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KaGVabTHvcNiw6PphcDRFQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">测试集。</figcaption></figure><p id="74eb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从上面的图表我们可以推断:</p><p id="eee0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">1.在easy set中有一些包含E选项的问题。</p><p id="c10b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.与ABCD格式的问题相比，以1234格式回答的问题非常少。</p><h1 id="b6aa" class="ls kb hh bd kc lt mo lv kg lw mp ly kk lz mq mb kn mc mr me kq mf ms mh kt mi bi translated">探索给定的语料库。</h1><p id="4849" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">语料库中存在的数据示例如下:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mt"><img src="../Images/d5e67273be0e5ec8f02920cd38d7c063.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cfkWeQHj3ecyJzG3juVGhg.png"/></div></div></figure><p id="b14d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">观察:</strong></p><ul class=""><li id="9b05" class="kv kw hh ig b ih ii il im ip lo it lp ix lq jb lr ld le lf bi translated">语料库中的许多句子只包含数字。</li><li id="f714" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">有些句子中有http链接。</li><li id="0ee9" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">语料库中有许多长度为2-3个单词的短句。</li><li id="e794" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">有些句子有没有意义的特殊字符。</li><li id="5445" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">括号里有很多没用的东西。</li><li id="ae45" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">有许多1-2个字母的单词，它们不是停用词。因此，它们必须在提取后被去除。</li><li id="06d9" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">有些句子只包含日期、地点等。</li><li id="17ff" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lr ld le lf bi translated">有些单词既包含数字又包含字母。例如，4月，第0434–455页；100等。</li></ul><p id="09f5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在为一个给定的问题提取它们之后，我们必须注意上面的事情。</p><p id="8717" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们从问题列中只提取问题。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mu mv l"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">摘录问题。</figcaption></figure><p id="0721" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们来看一些使用上述代码提取的问题示例:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mw"><img src="../Images/bc079a7dcd6643624ff2fd0337fff094.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EEt1qfvSxzbC5riN98wfMA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">问题样本。</figcaption></figure></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><p id="5500" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于在ARC数据集中没有给定问题的上下文，我们需要从给定的语料库中提取上下文。我们将使用两个语料库，ARC语料库和Aristo Mini语料库。</p><p id="6713" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们将使用ElasticSearch API索引ARC语料库和Aristo Mini语料库。索引后，我们可以提取文档，在我们的案例句子中，与给定的问题和答案对相关。</p><h2 id="51df" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated">索引:</h2><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mu mv l"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">索引。</figcaption></figure><p id="f8cc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在上面的代码中，我们首先打开了包含语料库的文件。然后我们为两个不同的语料库创建了index，它相当于SQL中的一个表。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mu mv l"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">将数据加载到弹性搜索中。</figcaption></figure><p id="b5f7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用上面的代码，我们可以将语料库数据加载到我们创建的索引中。“parallel_bulk”有助于更快地将数据装入索引。</p><p id="e87a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们的索引已经可以使用了。但是在继续之前，我们需要创建一个只包含答案选项的列表。这将有助于我们从索引中提取文档。</p><p id="1c27" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是获取给定问题的选项列表的代码:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mu mv l"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">提取选项。</figcaption></figure><p id="d6c6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用上面的代码，我们可以得到数据集中所有问题的选项列表。</p><h2 id="d123" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated">提取文档:</h2><p id="2167" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">现在，我们将提取每个问题和选项对的文档，并将它们存储在一个字典中，其中，关键字将是提取的文档，值将是其TF-IDF得分。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="2718" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里我们从两个语料库中提取了50篇文档。因此，对于每个问题和选项对，我们总共有100个文档。</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="610a" class="ls kb hh bd kc lt lu lv kg lw lx ly kk lz ma mb kn mc md me kq mf mg mh kt mi bi translated">上下文检索</h1><p id="47c7" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">现在，从所有给定的文档中，我们将为每个问题选择前20个文档，并使用它们作为回答问题的上下文。</p><p id="9b3b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是这里有一个重要的问题。如何评选前20名文档？我们不能仅仅基于TF-IDF分数来选择上下文，因为已经发现，仅仅TF-IDF分数不能返回最佳文档。</p><p id="8d4f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这方面的参考可以在细心的Ranker论文<a class="ae js" href="https://arxiv.org/abs/1909.00596" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">这里</strong> </a>中读到。</p><p id="8e1e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我将使用这篇<a class="ae js" href="https://drive.google.com/file/d/15K3lgiYLHvUb1zKf8x_F8LwY9o5pQhQ6/view" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">论文</strong> </a>中提到的方法来选择可用于创建适当上下文的相关文档。</p><h2 id="c93b" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated">文档相关性鉴别器(DRD)</h2><p id="101b" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">DRD将学会判断给定的问题和上下文，上下文是否包含问题所需的答案。为此，SQUAD 2.0是一个很好的数据集，因为它包含两种类型的数据点。</p><p id="b9e8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，我们将在SQUAD 2.0数据集上训练BERT，但是做了一些调整。小队数据集被转换成二进制形式，这样，如果在给定的上下文中有答案，则它被标记为1否则为0。因此，BERT将被微调以对给定的(问题、上下文)对进行分类。</p><p id="80cb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">之后，我使用BertTokenizer创建了输入id。tokenizer的输入形式如下:</p><p id="5cef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">[CLS]问题[SEP]上下文[SEP]</p><p id="9409" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">获得输入标识、令牌类型标识和注意掩码后，我使用PyTorch数据集和数据加载器创建了数据集。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mu mv l"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">创建PyTorch数据集的代码。</figcaption></figure><p id="71a6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用于训练BERT模型的参数如下:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mu mv l"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">DRD参数。</figcaption></figure><p id="f8ff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我使用了变形金刚库中的伯特基础模型来微调模型。</p><p id="0450" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在微调BERT模型后，我在SQUAD 2.0的验证数据集上实现了75%的准确率。</p><h2 id="b1c9" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated">应答验证鉴别器</h2><p id="5b00" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">在这里，我们创建一个模型，试图确定一个上下文是否可能包含给定问题和答案选择的信息。因此，我们向模型输入(问题、答案选择、上下文),它返回一个介于0和1之间的置信度得分。接近1意味着上下文是有用的。</p><p id="07dd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于这项任务，我已经采取了种族数据集，并转换成二进制分类问题。我们将这个数据集转换为元组(问题、候选答案、段落)，这些元组要么被标记为0，这意味着答案不能使用段落来验证(对于不正确的答案)，要么被标记为1，这加强了段落可以用来推断答案是正确的事实。</p><p id="baf9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是我用来完成上述任务的函数:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="9290" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">获得数据集后，我使用BertTokenizer对数据集进行了标记化。tokenizer的输入格式如下:</p><p id="a36a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">【CLS】问题【九月】答案选择【九月】语境【九月】</p><p id="920f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在得到模型的输入后，我像为DRD做的那样对模型进行了微调。</p><p id="d179" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于这个任务，我实现了75%的验证准确率。</p><h2 id="8e8b" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated">正在检索上下文</h2><p id="d280" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">在我们训练了两个鉴别器之后，我们可以使用它们来获取数据集中每个问题的上下文。</p><p id="7886" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我使用了以下两个函数来完成这项任务:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="dd69" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该函数将返回两个分数，分别来自每个鉴别器。</p><p id="9ead" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第二个功能是:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="07f4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个函数中，我们只需传递我们的数据集，它将返回每个数据点的上下文。</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="520e" class="ls kb hh bd kc lt lu lv kg lw lx ly kk lz ma mb kn mc md me kq mf mg mh kt mi bi translated">系统模型化</h1><p id="47bf" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">对于建模，我的方法是首先在RACE数据集上微调模型，然后在ARC数据集上微调模型。除了UnifiedQA模型，我对所有模型都使用了这个过程。</p><h2 id="8146" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated">基线模型</h2><p id="b760" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">在这个模型中，我们从所有给定的选项中随机选择一个答案。</p><p id="20eb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于这个模型，测试精度为25%。</p><h2 id="ff9d" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated">伯特模型</h2><p id="e108" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">准备的输入如下:</p><p id="37dd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">[CLS]语境[SEP]问题+答案_选择[SEP]</p><h2 id="9924" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated">罗伯塔模型</h2><p id="98f0" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">输入按以下格式准备:</p><p id="b78b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><s>语境</s> 问题 选择</p><h2 id="3b3c" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated">XLNET模型</h2><p id="9f31" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">输入按以下格式准备:</p><p id="5f1b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">语境<sep>问题+选择<sep> <cls/></sep></sep></p><h2 id="06ce" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated">统一QA模型</h2><p id="77c9" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">该模型是T5模型的扩展。更多关于这个的可以从<a class="ae js" href="https://arxiv.org/pdf/2005.00700.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">这里</strong> </a>了解。</p><p id="e96c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">输入按以下格式准备:</p><p id="8f24" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">问题+ \\n +所有选项+ \\n +上下文+ </p><h2 id="c7ea" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated">建模概要:</h2><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mx"><img src="../Images/ea8e73b038fb71ddb4b08ceba222cc41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*awLxjMGo36jIMVk9CkA1aQ.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">建模总结</figcaption></figure></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="30dc" class="ls kb hh bd kc lt lu lv kg lw lx ly kk lz ma mb kn mc md me kq mf mg mh kt mi bi translated">结论</h1><p id="7bdc" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">通过开展这个项目，我发现了以下几点:</p><ol class=""><li id="05ef" class="kv kw hh ig b ih ii il im ip lo it lp ix lq jb lc ld le lf bi translated">模型大小对最终性能有影响。</li><li id="090a" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lc ld le lf bi translated">背景对回答问题非常重要。因此，应该使用更好的上下文检索技术。</li><li id="dc4d" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lc ld le lf bi translated">通过增加鉴别器，我们在计算速度的代价上得到了更好的性能。</li><li id="164e" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lc ld le lf bi translated">NLP中的迁移学习使许多事情变得容易完成。</li></ol><h1 id="f273" class="ls kb hh bd kc lt mo lv kg lw mp ly kk lz mq mb kn mc mr me kq mf ms mh kt mi bi translated">未来的工作</h1><p id="b92c" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip ll ir is it lm iv iw ix ln iz ja jb ha bi translated">有很多方法可以提高性能。其中一些如下:</p><ol class=""><li id="b5e5" class="kv kw hh ig b ih ii il im ip lo it lp ix lq jb lc ld le lf bi translated">使用更大的模型。由于计算资源较少，我只使用了基本模型。</li><li id="0ea3" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lc ld le lf bi translated">对于使用ARD和DRD的评分环境，我们可以使用多个DRD或ARD，并将他们的平均分数作为最终分数。</li><li id="fff5" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lc ld le lf bi translated">我们可以使用KV注意力来获得更好的上下文，而不是取ARD和DRD分数的平均值(如attention Ranker<a class="ae js" href="https://arxiv.org/ftp/arxiv/papers/1909/1909.00596.pdf" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">论文</strong> </a>中所述)。</li><li id="d415" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lc ld le lf bi translated">尝试使用基于解码器的模型，如GPT、GPT-2等。</li></ol><h2 id="8387" class="ka kb hh bd kc kd ke kf kg kh ki kj kk ip kl km kn it ko kp kq ix kr ks kt ku bi translated"><strong class="ak">参考文献:</strong></h2><ol class=""><li id="5fc8" class="kv kw hh ig b ih kx il ky ip kz it la ix lb jb lc ld le lf bi translated"><a class="ae js" href="https://github.com/sobamchan/race-bert/blob/master/race.py" rel="noopener ugc nofollow" target="_blank">https://github.com/sobamchan/race-bert/blob/master/race.py</a></li><li id="04ea" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lc ld le lf bi translated"><a class="ae js" href="https://arxiv.org/ftp/arxiv/papers/1909/1909.00596.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/ftp/arxiv/papers/1909/1909.00596.pdf</a></li><li id="4aa3" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lc ld le lf bi translated"><a class="ae js" href="https://arxiv.org/pdf/2005.00700.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/2005.00700.pdf</a></li><li id="6e48" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lc ld le lf bi translated"><a class="ae js" href="https://drive.google.com/file/d/15K3lgiYLHvUb1zKf8x_F8LwY9o5pQhQ6/view" rel="noopener ugc nofollow" target="_blank">https://drive . Google . com/file/d/15k 3 lgiylhvub 1 zkf 8 x _ f 8 lwy 9 o 5 pqhq 6/view</a></li><li id="8880" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lc ld le lf bi translated"><a class="ae js" href="https://allenai.org/data/arc" rel="noopener ugc nofollow" target="_blank">https://allenai.org/data/arc</a></li><li id="ded9" class="kv kw hh ig b ih lg il lh ip li it lj ix lk jb lc ld le lf bi translated"><a class="ae js" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">应用人工智能课程</a>。</li></ol><p id="2c94" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可以在这里联系我<a class="ae js" href="http://www.linkedin.com/in/keshav-rawat" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae js" href="https://github.com/keshav5196" rel="noopener ugc nofollow" target="_blank"> Github </a>。</p></div></div>    
</body>
</html>