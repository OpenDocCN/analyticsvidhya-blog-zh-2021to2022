<html>
<head>
<title>ETL- Data Processing using Talend</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Talend的ETL-数据处理</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/etl-data-processing-using-talend-4cda9d5891e9?source=collection_archive---------0-----------------------#2021-10-23">https://medium.com/analytics-vidhya/etl-data-processing-using-talend-4cda9d5891e9?source=collection_archive---------0-----------------------#2021-10-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/85a7b627400c5bfcea9fe5158e63c2c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SKBKFOI2NKI7Nl15"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">马库斯·斯皮斯克在Unsplash上拍摄的照片</figcaption></figure><p id="f192" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">随着数据量的增加，处理变得单调乏味。ETL工具有助于轻松转换大量数据。一旦数据被处理，它进一步使分析和解释数据更容易和更快。</p><p id="9117" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><em class="jr">在Talend上实现一些处理之前，我们先来了解一下什么是ETL..</em></p><p id="6070" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi">什么是ETL？<br/> </strong> → 3步数据集成流程——提取转换和加载。将原始数据从数据源移动到数据库或数据仓库需要这个过程。</p><ul class=""><li id="41c5" class="js jt hh iv b iw ix ja jb je ju ji jv jm jw jq jx jy jz ka bi translated"><strong class="iv hi">提取<br/> </strong>在ETL的第一步，从多个来源提取/收集结构化和非结构化形式的数据，并整合到一个集中的存储库中。</li><li id="6248" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq jx jy jz ka bi translated"><strong class="iv hi">转换<br/> </strong>接下来，对整个数据进行转换，以保证数据质量。应用各种规则和函数将数据转换成符合要求的格式。一些常用的转换包括标准化、排序、过滤、替换空值、替换单个值的不一致条目、删除重复项。</li><li id="a4d8" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq jx jy jz ka bi translated"><strong class="iv hi">加载<br/> </strong>最后，将提取和转换后的数据加载到目标数据仓库或数据库中。在此步骤中，应确保使用有限的资源准确加载数据，并且数据一致性没有损失。</li></ul><p id="87df" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">让我们了解一下塔伦德..</p><p id="9d70" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi">什么是Talend？<br/> </strong> → Talend是数据集成中使用最广泛、最强大的ETL工具之一。它使得ETL的过程更加容易和经济有效。<strong class="iv hi"><em class="jr">Talend Open Studio for Data Integration</em></strong>允许您使用预定义的组件构建Java ETL作业。它为您提供了一个图形化的工作区，您可以简单地从面板中拖放组件，并将它们连接起来，以映射源和目标之间的数据。</p></div><div class="ab cl kg kh go ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="ha hb hc hd he"><p id="f549" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">最后，让我们尝试一些Talend组件..</p><p id="9314" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我们将使用以下Talend组件查看5个处理步骤:<br/> tFileInputDelimiter、tFileOutputDelimiter、tLogRow、tMap、tFilterRow、tAggregateRow、tReplace、tReplaceList。</p><p id="0212" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">为了便于说明，我们将使用与之前一篇关于<a class="ae kn" rel="noopener" href="/swlh/keep-your-data-clean-8450e35f4895">数据处理</a>的博客中相同的<a class="ae kn" href="https://www.kaggle.com/utkarshakathayat/insurance-dataset" rel="noopener ugc nofollow" target="_blank"><em class="jr">Insurance _ dataset</em></a>，但是在一个文本文件中，用逗号分隔。</p><figure class="kp kq kr ks fd ii er es paragraph-image"><div class="er es ko"><img src="../Images/3804125de42dc39afdc5947756bc694d.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*MPq6nA9sVmfOvYh-QGCnGQ.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">这是文本文件的样子。</figcaption></figure><p id="8629" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在TOS中创建一个作业，如果您以前从未这样做过，请遵循<a class="ae kn" href="https://help.talend.com/r/XqDwjCNcR28p0QBYSfToSA/uRvdIWL9yOIWOEWn_oK9ng" rel="noopener ugc nofollow" target="_blank">说明</a>。然后，为分隔文件创建元数据，并在<em class="jr"> input </em>家族的<strong class="iv hi"><em class="jr">tfileinutdelimitted</em></strong>组件中使用它，以便进一步使用。如果你不知道怎么做，可以参考这个<a class="ae kn" href="https://www.talend.com/resources/creating-using-metadata/" rel="noopener ugc nofollow" target="_blank">链接</a>上的视频。</p><figure class="kp kq kr ks fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kt"><img src="../Images/83d1ca64bcca01c0cd2955b87b3ca8d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2r_gVO7-3OkGV7iKRmXGmA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">设置元数据。</figcaption></figure><figure class="kp kq kr ks fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ku"><img src="../Images/37a1b9ed5124df7af0ac1cbaae8144e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5kz3u8gpXuM0hhHChwLT8w.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated"><em class="kv"> tFileInputDelimited </em>组件的设置。</figcaption></figure><p id="967a" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">要查看数据，请使用<em class="jr">日志&amp;错误</em>系列中的<strong class="iv hi"> <em class="jr"> tLogRow </em> </strong>组件，它允许您将作业中的数据流写入控制台。在组件设置中选择“表格”模式，以结构化表格格式查看数据。</p><figure class="kp kq kr ks fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kw"><img src="../Images/635b151696f10f3d9efe88c2f2b95b05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P6kIn-S90NPr14DctiYbsA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">tLogRow组件的设置。</figcaption></figure><p id="f941" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">下图是我们桌子的样子。</p><figure class="kp kq kr ks fd ii er es paragraph-image"><div class="er es kx"><img src="../Images/3aba81a93ca4d6a3eefa4a51f4226b4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*3v26JdQDzYPzI0A9Baa_hQ.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">输出曲线描绘台</figcaption></figure><h2 id="dacf" class="ky kz hh bd la lb lc ld le lf lg lh li je lj lk ll ji lm ln lo jm lp lq lr ls bi translated">替换缺失值或空值</h2><p id="8711" class="pw-post-body-paragraph it iu hh iv b iw lt iy iz ja lu jc jd je lv jg jh ji lw jk jl jm lx jo jp jq ha bi translated">在上面的输出图像中，我突出显示了缺失值或空值。让我们尝试使用来自<em class="jr">处理</em>家族的<strong class="iv hi"> <em class="jr"> tMap </em> </strong>组件来处理这些值。<strong class="iv hi"> <em class="jr"> </em> </strong>我们将在tMap组件窗口中使用可用的函数形成<strong class="iv hi"> <em class="jr"> </em> </strong>表达式，根据需要转换数据。之后，我们将保存处理过的数据。</p><figure class="kp kq kr ks fd ii er es paragraph-image"><div class="er es ly"><img src="../Images/d22fa61cf4bde6284d72e21615b1a952.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*a0SkPCZF4txzuRKEjWokDA.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">用于替换缺失值的作业。</figcaption></figure><figure class="kp kq kr ks fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lz"><img src="../Images/67d353dea348ae94cbf8a8cae82ca71a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UXUnETnpxNCtjPdqLv49wg.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">替换缺失值的tMap组件。</figcaption></figure><p id="271c" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">让我们来理解形成的表达.. <br/> Java的条件或三元运算符(？:)用于编写替换缺失值或空值的表达式。</p><pre class="kp kq kr ks fd ma mb mc md aw me bi"><span id="c29e" class="ky kz hh mb b fi mf mg l mh mi"><strong class="mb hi">Expression 1 ? Expression 2 : Expression 3 </strong></span></pre><p id="b740" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">表达式1是要检查的条件。如果为真，则执行表达式2，否则，执行表达式3。</p><pre class="kp kq kr ks fd ma mb mc md aw me bi"><span id="66c0" class="ky kz hh mb b fi mf mg l mh mi"><strong class="mb hi">row1.smoker.equals("NAN") ? "no" : row1.smoker<br/>row1.region.isEmpty() ? "northeast" : row1.region</strong></span><span id="cff3" class="ky kz hh mb b fi mj mg l mh mi"><strong class="mb hi">Relational.ISNULL(row1.bmi) ? 20.00 : row1.bmi   </strong></span></pre><p id="5ccb" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">ISNULL()是由Talend的关系类别提供的函数，它返回一个布尔值</p><p id="7ec3" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><em class="jr">输出</em>系列的<strong class="iv hi"><em class="jr">tOutputDelimited</em></strong>组件帮助我们将转换后的数据保存到另一个具有合适分隔符的文件中。</p><p id="c0c4" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">为了进一步处理，像前面一样，将这个新文件添加到元数据，然后添加到tFileInputDelimited组件。<br/>当我们再次使用tLogRow检查输出表时，您可以注意到变化(与之前的输出图像进行比较)。</p><figure class="kp kq kr ks fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mk"><img src="../Images/8f3929ef75eb4a3e8690c71d67907320.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UygfY20XYLtPNZynttQ_uA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">处理缺失值后的输出。</figcaption></figure><h2 id="dccc" class="ky kz hh bd la lb lc ld le lf lg lh li je lj lk ll ji lm ln lo jm lp lq lr ls bi translated">创建列—出生年份</h2><figure class="kp kq kr ks fd ii er es paragraph-image"><div class="er es ml"><img src="../Images/c55a18f8c955d50b2137dffe2230d9fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*LmtrN3cPfQuCrtY8B7qJMg.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">创建出生年份列的作业。</figcaption></figure><figure class="kp kq kr ks fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mm"><img src="../Images/9fb9433a47ae69f4b1910f2ca0ead38f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6hmDA0mzX2v0L7hxcJt_pw.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">用于计算和创建出生年份列的tMap组件。</figcaption></figure><p id="cc3e" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><em class="jr">理解表达..</em></p><pre class="kp kq kr ks fd ma mb mc md aw me bi"><span id="fbc3" class="ky kz hh mb b fi mf mg l mh mi"><strong class="mb hi">TalendDate.addDate(TalendDate.getCurrentDate(),-row1.age, "yyyy")</strong></span></pre><p id="5435" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><em class="jr"> addDate(Date date，int n，Date dateType) </em>是tMap表达式生成器中TalendDate类别提供的函数。第一个参数是要添加日、月、年的日期；第二个参数是要添加的值，第三个参数是日期模式。该函数返回一个Talend日期。<br/>在我们的例子中，我们需要从当前日期中减去年龄来得到出生年份。这也是为什么addDate函数传入的第一个参数是Talend date category提供的另一个内置函数- <em class="jr"> getCurrentDate() </em>，顾名思义返回当前日期。我们需要减去年龄，所以传递的第二个参数是减去年龄，第三个是yyyy，因为需要年份。</p><figure class="kp kq kr ks fd ii er es paragraph-image"><div class="er es mn"><img src="../Images/7a18951b554471e9c1da018d7aea48ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*uaOx2P8IjDTv8-uL8pm3cw.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">包含出生年份列的输出表。</figcaption></figure><h2 id="7f93" class="ky kz hh bd la lb lc ld le lf lg lh li je lj lk ll ji lm ln lo jm lp lq lr ls bi translated">分类编码</h2><p id="282d" class="pw-post-body-paragraph it iu hh iv b iw lt iy iz ja lu jc jd je lv jg jh ji lw jk jl jm lx jo jp jq ha bi translated"><a class="ae kn" rel="noopener" href="/swlh/categorical-encoding-label-encoding-one-hot-encoding-115832c01b99">分类编码</a>是数据分析中广泛使用的技术。让我们看看如何对两个分类列——性别和吸烟者——执行标签编码。这种技术通常可用于替换不一致的数据条目。比方说，有一个国家列，其中有US、U.S.A、USA、America，它们都表示相同的值“USA ”,因此也可以使用相同的方法替换数据中不一致的值。我们将使用来自<em class="jr">处理</em>系列的<strong class="iv hi"><em class="jr">t替换</em> </strong>组件，它在定义的输入列中进行搜索和替换，并在进一步处理之前帮助清理文件。</p><figure class="kp kq kr ks fd ii er es paragraph-image"><div class="er es mo"><img src="../Images/9f19932daaa22e71803e3de8c4e16bbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*Z4AvbByltbSrgOZPQHPQ_w.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">标签编码的作业。</figcaption></figure><figure class="kp kq kr ks fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mp"><img src="../Images/912276568b1f4e54ca2efe2b28dec8d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q9TrQd1l-Bfw3lGqsfgslA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">t替换用于对“性别和吸烟者”列的值进行编码的组件。</figcaption></figure><p id="d5cc" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">将在选定的输入列中搜索提到的字符串，并用提供的另一个字符串替换。</p><figure class="kp kq kr ks fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mq"><img src="../Images/279fd09796300963d138e9c6e0273e22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J5NlbBz51ca3WKlpbSMwQg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">标签编码后的输出。</figcaption></figure><h2 id="a372" class="ky kz hh bd la lb lc ld le lf lg lh li je lj lk ll ji lm ln lo jm lp lq lr ls bi translated">用区域代码替换区域值</h2><p id="3e9f" class="pw-post-body-paragraph it iu hh iv b iw lt iy iz ja lu jc jd je lv jg jh ji lw jk jl jm lx jo jp jq ha bi translated">如果您有一个包含国家的列，并且您想用另一个文件中的国家代码或包含语言代码的语言或包含邮政编码的地区来替换它们，您可以使用来自<em class="jr">数据质量</em>系列的<strong class="iv hi"> <em class="jr"> tReplaceList </em> </strong>组件。在我们的例子中，我们将使用这个组件用它们的代码替换区域值。下面是带区域及其代码的分隔文件的图像。将该文件添加到元数据中，并像前面一样在tFileInputDelimited组件中进一步使用它。</p><figure class="kp kq kr ks fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mr"><img src="../Images/2c67196a9c293dc22833201c90f615e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*8QzmSz07Hw9MiIRBV_ul0A.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">包含区域及其各自代码的文件。</figcaption></figure><figure class="kp kq kr ks fd ii er es paragraph-image"><div class="er es ms"><img src="../Images/a2c0d62d619dea27176d3c3db2c26a71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*fN1C4suq3Vr1y8ptHSL4FA.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">用代码替换区域值的作业。</figcaption></figure><p id="0df7" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">tReplaceList将接受2个输入文件。这里，tFileInputDelimited_2是我们的保险数据文件，tFileInputDelimited_3是region_code文件。</p><figure class="kp kq kr ks fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mt"><img src="../Images/681a312b37bd8adc33a2a57710720c64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uetwrdHM2OgYTdK8Wgzvqg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">t用各自的代码替换区域值的替换列表。</figcaption></figure><p id="f4ef" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">查找搜索列是搜索代码的列，即tFileInputDelimited_3的区域，查找替换列是具有新值的列，即代码tFileInputDelimited_3。然后选择主文件中需要替换的列，即tFileInputDelimited_2的region列。</p><figure class="kp kq kr ks fd ii er es paragraph-image"><div class="er es mu"><img src="../Images/cbfadbbfd2c54a2ecb94940e2dfd40b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*NuEqQoP66xk98Rend5dZvg.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">用代码替换区域值后的输出。</figcaption></figure><h2 id="bd41" class="ky kz hh bd la lb lc ld le lf lg lh li je lj lk ll ji lm ln lo jm lp lq lr ls bi translated">过滤和汇总数据</h2><p id="9153" class="pw-post-body-paragraph it iu hh iv b iw lt iy iz ja lu jc jd je lv jg jh ji lw jk jl jm lx jo jp jq ha bi translated">tFilterRow和tAggregateRow是两个<em class="jr">处理</em>系列组件，当您想要分别过滤数据和分组数据以聚合值时，这两个组件使您的工作变得简单。</p><p id="042c" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">比方说，你想比较吸烟和不吸烟的男性和有孩子的女性的平均保险费用。</p><figure class="kp kq kr ks fd ii er es paragraph-image"><div class="er es mv"><img src="../Images/f6f9cff59e0f87126f6beebb51b4bc0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*jizAwgBpLMFPTSkIVi4TRA.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">过滤和汇总数据的作业。</figcaption></figure><figure class="kp kq kr ks fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mw"><img src="../Images/aa47f4a147b83d85d82f847cdce37a02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jscXUDnavgCEzqQMrCbHGA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">用于筛选有孩子的人的tFilterRow组件。</figcaption></figure><p id="ed2c" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">首先，要获得有孩子的人的条目，您需要在children列上应用一个过滤器，使用大于运算符来表示值0，即children &gt; 0。</p><figure class="kp kq kr ks fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mx"><img src="../Images/28d9fbe630bb91ef5d21e7f3588af0f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vNrxmhBZ7pCBagEgJHJQBA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">用于合计费用的tAggregateRow组件。</figcaption></figure><p id="2fbd" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">然后将过滤后的输出作为输入提供给tag aggregate row组件。现在，将数据按性别和吸烟者分组，并将average函数应用于“费用”列。</p><figure class="kp kq kr ks fd ii er es paragraph-image"><div class="er es my"><img src="../Images/7f6f09043a671b2180c3ed421c4096a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*XEBCainPuz-1pg3NEoh0VA.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">过滤和聚合数据后的输出。</figcaption></figure><p id="4d81" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在上面的输出中，我们接收到4个观察值——不吸烟的女性、吸烟的男性、不吸烟的男性和吸烟的女性。比较这四个值，我们可以说，有孩子的不吸烟者的保险费比有孩子的吸烟者的保险费要少。</p></div><div class="ab cl kg kh go ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="ha hb hc hd he"><p id="9319" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi"> <em class="jr">感谢阅读！</em>T5】</strong></p><p id="a01c" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">如果您想使用python执行一些数据处理，请阅读以下博客:</p><ul class=""><li id="c152" class="js jt hh iv b iw ix ja jb je ju ji jv jm jw jq jx jy jz ka bi translated"><a class="ae kn" rel="noopener" href="/analytics-vidhya/getting-started-with-pandas-45c7639cd5ae">https://medium . com/analytics-vid hya/getting-started-with-pandas-45c 7639 cd5ae</a></li><li id="41d9" class="js jt hh iv b iw kb ja kc je kd ji ke jm kf jq jx jy jz ka bi translated"><a class="ae kn" rel="noopener" href="/swlh/keep-your-data-clean-8450e35f4895">https://medium.com/swlh/keep-your-data-clean-8450e35f4895</a></li></ul><p id="5251" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">连接:<a class="ae kn" href="https://www.linkedin.com/in/akshada-gaonkar-9b8886189/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/akshada-gaonkar-9b8886189/</a></p></div></div>    
</body>
</html>