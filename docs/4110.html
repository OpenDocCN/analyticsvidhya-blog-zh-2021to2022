<html>
<head>
<title>Clustering Analysis of Mall Customer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">商场顾客的聚类分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/clustering-analysis-of-mall-customer-bd785577f1b0?source=collection_archive---------0-----------------------#2021-08-28">https://medium.com/analytics-vidhya/clustering-analysis-of-mall-customer-bd785577f1b0?source=collection_archive---------0-----------------------#2021-08-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/fd11ece38a9f0cb05fd982fb33ddec85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ynd0IXIeSwtMCbIYveu5Mw.jpeg"/></div></div></figure><div class=""/><p id="11b8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用<a class="ae jo" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank"> python </a>，<a class="ae jo" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> Numpy </a>，<a class="ae jo" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a>，<a class="ae jo" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> Matplotlib </a>，<a class="ae jo" href="https://seaborn.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Seaborn </a>，<a class="ae jo" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a></p><p id="e267" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">聚类</strong>是将群体或数据点分成若干组的任务，使得同一组中的数据点与同一组中的其他数据点更相似，而与其他组中的数据点不相似。它基本上是基于对象之间的相似性和不相似性的对象集合。</p><p id="432d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">基本上是<a class="ae jo" href="https://www.geeksforgeeks.org/supervised-unsupervised-learning/" rel="noopener ugc nofollow" target="_blank"> <em class="jp">无监督学习方法</em> </a>的一种类型。无监督学习方法是这样一种方法，其中我们从由没有标记响应的输入数据组成的数据集提取参考。一般来说，它是一个寻找有意义的结构、解释性的基本过程、生成性特征和一组实例中固有的分组的过程。</p><p id="e25b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">例子</strong>:我们以Mall这个真实世界的例子来理解聚类技术:当我们访问任何一个购物中心时，我们都可以观察到用法相似的东西被分组在一起。比如t恤分在一个区，裤子分在其他区，类似的还有蔬菜区，苹果，香蕉，芒果等。，被分成不同的部分，这样我们可以很容易地找到东西。聚类技术也以同样的方式工作。聚类的其他例子是根据主题对文档进行分组。</p><p id="a3c9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">聚类技术可以广泛应用于各种任务中。这种技术的一些最常见的用途是:</p><ul class=""><li id="93bd" class="jq jr ht is b it iu ix iy jb js jf jt jj ju jn jv jw jx jy bi translated">市场细分</li><li id="acf6" class="jq jr ht is b it jz ix ka jb kb jf kc jj kd jn jv jw jx jy bi translated">统计数据分析</li><li id="3a27" class="jq jr ht is b it jz ix ka jb kb jf kc jj kd jn jv jw jx jy bi translated">社会网络分析</li><li id="bcfb" class="jq jr ht is b it jz ix ka jb kb jf kc jj kd jn jv jw jx jy bi translated">图象分割法</li><li id="e221" class="jq jr ht is b it jz ix ka jb kb jf kc jj kd jn jv jw jx jy bi translated">异常检测等。</li></ul><h1 id="7e3e" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">数据集:</h1><p id="d3af" class="pw-post-body-paragraph iq ir ht is b it lc iv iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn hb bi translated">这个数据集基于购物中心的顾客。这个数据集中总共有200行和5列。通过使用这个数据集，创建了这个数据分析和机器学习项目。</p><p id="46c9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里我们使用google COLAB来运行这些代码并分析数据集，但是您也可以使用其他平台来运行代码。</p><p id="9ad5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们开始这个项目包含什么。</p><h1 id="3b34" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">导入库:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="9195" class="lq kf ht lm b fi lr ls l lt lu">import numpy as np</span><span id="72d1" class="lq kf ht lm b fi lv ls l lt lu">import pandas as pd</span><span id="d47a" class="lq kf ht lm b fi lv ls l lt lu">import matplotlib.pyplot as plt</span><span id="1946" class="lq kf ht lm b fi lv ls l lt lu">import seaborn as sns</span></pre><h1 id="3fb9" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">加载文件:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="a260" class="lq kf ht lm b fi lr ls l lt lu">import io</span><span id="b252" class="lq kf ht lm b fi lv ls l lt lu">df2 = pd.read_csv('Mall_Customers.csv')</span></pre><h1 id="0a16" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">显示数据:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="683b" class="lq kf ht lm b fi lr ls l lt lu">df2.head()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lw"><img src="../Images/c973749d593c5e81574e001e277bd687.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e-yNqAYg_kfHNa8376fJhw.png"/></div></div></figure><h1 id="3ca0" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">数据集的形状:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="51cf" class="lq kf ht lm b fi lr ls l lt lu">df2.shape</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div class="er es lx"><img src="../Images/f2d3c308c1f00822af62cb89c3e61c38.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*iYV2chY2q9dpqylQ2PIP5w.png"/></div></figure><h1 id="ed36" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">关于数据集中所有列的信息:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="a0c8" class="lq kf ht lm b fi lr ls l lt lu">df2.info()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div class="er es ly"><img src="../Images/1989ce229ef476a439048b92a08f4f9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*OtZIT3YS-E_ZAVgey3Ipbg.png"/></div></figure><h1 id="4101" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">数据集的描述:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="7912" class="lq kf ht lm b fi lr ls l lt lu">df2.describe()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lz"><img src="../Images/9037d973654a0d50c0d0c5927055de78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oTXUXJ7zyo7xjxTn8rLfog.png"/></div></div></figure><h1 id="1d43" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">检查数据集中的空值:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="7ac7" class="lq kf ht lm b fi lr ls l lt lu">df2.isnull().values.any()</span></pre><h1 id="6482" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">男女比例:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="c43d" class="lq kf ht lm b fi lr ls l lt lu">labels = ['Female', 'Male']</span><span id="3aa1" class="lq kf ht lm b fi lv ls l lt lu">size = df2['Gender'].value_counts()</span><span id="3079" class="lq kf ht lm b fi lv ls l lt lu">colors = ['lightgreen', 'orange']</span><span id="7783" class="lq kf ht lm b fi lv ls l lt lu">explode = [0, 0.1]</span><span id="3cae" class="lq kf ht lm b fi lv ls l lt lu">plt.rcParams['figure.figsize'] = (9, 9)</span><span id="015e" class="lq kf ht lm b fi lv ls l lt lu">plt.pie(size, colors = colors, explode = explode, labels = labels, shadow = True, autopct = '%.2f%%')</span><span id="7e6b" class="lq kf ht lm b fi lv ls l lt lu">plt.title('Gender', fontsize = 20)</span><span id="346b" class="lq kf ht lm b fi lv ls l lt lu">plt.axis('off')</span><span id="a2d1" class="lq kf ht lm b fi lv ls l lt lu">plt.legend()</span><span id="d228" class="lq kf ht lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div class="er es ma"><img src="../Images/4e9b9ca4ce01cf64bc9252e2eafaf6b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*c4NHhTHt-EwpMj3xm2-gZg.png"/></div></figure><p id="fd72" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">看上面的饼状图，它解释了商场中的性别分布</p><p id="28da" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">有趣的是，女性以56%的份额领先，而男性的份额为44%，这是一个巨大的差距，特别是当男性人口相对高于女性时。</p><h1 id="1b2b" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">年龄与年收入:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="7bab" class="lq kf ht lm b fi lr ls l lt lu">plt.figure(figsize=(25,10))</span><span id="0592" class="lq kf ht lm b fi lv ls l lt lu"># Passing X axis and Y axis along with subplot position</span><span id="2211" class="lq kf ht lm b fi lv ls l lt lu">plt.title('Age vs Annual Income', fontsize = 20)</span><span id="e53f" class="lq kf ht lm b fi lv ls l lt lu">plt.xticks(rotation=90)</span><span id="a93a" class="lq kf ht lm b fi lv ls l lt lu">sns.barplot(x = df2['Age'] , y = df2['Annual Income (k$)'] , palette='icefire');</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mb"><img src="../Images/37e08fc520d10b41ec36eea4e0309d7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vmBMUN8fKDZuAL0mJjyg9w.png"/></div></div></figure><p id="40c2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">33岁和42岁时年收入最大。</p><h1 id="6257" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">年龄分布:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="51f9" class="lq kf ht lm b fi lr ls l lt lu">plt.rcParams['figure.figsize'] = (25, 8)</span><span id="e006" class="lq kf ht lm b fi lv ls l lt lu">sns.countplot(df2['Age'], palette = 'hsv')</span><span id="6364" class="lq kf ht lm b fi lv ls l lt lu">plt.title('Distribution of Age', fontsize = 20)</span><span id="2710" class="lq kf ht lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mc"><img src="../Images/2e5124caa0ecde02f33db1c948cfbda1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6yOo4KzcUoSsbf0g8oDfpw.png"/></div></div></figure><p id="2247" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该图展示了一个更具互动性的图表，展示了商场中各个年龄组的分布情况，以便更清楚地了解商场中游客的年龄组。</p><p id="a42b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从上图中可以看出，27岁到39岁的人群出现的频率非常高，但是没有明确的模式，我们只能发现一些群体模式，比如年龄较大的人群出现的频率相对较低。有趣的事实是，商场里18岁和67岁的游客数量相等。55岁、56岁、69岁和64岁的人很少去商场。32岁的人是商场里最常光顾的人。</p><h1 id="7f02" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">数据配对图:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="a556" class="lq kf ht lm b fi lr ls l lt lu">sns.pairplot(df2)</span><span id="f6a6" class="lq kf ht lm b fi lv ls l lt lu">plt.rcParams['figure.figsize'] = (25, 8)</span><span id="2c65" class="lq kf ht lm b fi lv ls l lt lu">plt.title('Pairplot for the Data', fontsize = 20)</span><span id="cd3e" class="lq kf ht lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div class="er es md"><img src="../Images/b9df8aafe48d324ae5940bc450a1c045.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*szTZnEFFyFas3Low2YawSg.png"/></div></figure><h1 id="5325" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">数据热图:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="5beb" class="lq kf ht lm b fi lr ls l lt lu">plt.rcParams['figure.figsize'] = (15, 8)</span><span id="d1e0" class="lq kf ht lm b fi lv ls l lt lu">sns.heatmap(df2.corr(), cmap = 'Wistia', annot = True)</span><span id="86f7" class="lq kf ht lm b fi lv ls l lt lu">plt.title('Heatmap for the Data', fontsize = 20)</span><span id="d5f1" class="lq kf ht lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es me"><img src="../Images/8d95b8a4a755a8484661e311d2c6d10f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GZnkW67yvwWv7k9-wgcp_g.png"/></div></div></figure><p id="0b6c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上图显示了商场客户细分数据集的不同属性之间的相关性，该热图用橙色反映了最相关的要素，用黄色反映了最不相关的要素。</p><p id="d2a6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以清楚地看到，这些属性之间没有很好的相关性，这就是为什么我们将继续所有的功能。</p><h1 id="e404" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">年龄与支出得分:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="b1a4" class="lq kf ht lm b fi lr ls l lt lu">ax = sns.barplot(y= "Spending Score (1-100)", x = "Age", data = df2, palette=("Blues_d"))</span><span id="c987" class="lq kf ht lm b fi lv ls l lt lu">sns.set(rc={'figure.figsize':(27.7,6.30)})</span><span id="e371" class="lq kf ht lm b fi lv ls l lt lu">sns.set_context("poster")</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mf"><img src="../Images/68f3226b9b3d119665064c221dcda3b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vFShEDqlI54apA1YB125cg.png"/></div></div></figure><p id="d389" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以看到，年龄在28至39岁之间的人获得了最高的消费分数，其背后的原因是他们的年收入非常高。</p><h1 id="0dc7" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">支出分数分布:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="3e5b" class="lq kf ht lm b fi lr ls l lt lu">plt.rcParams['figure.figsize'] = (35, 14)</span><span id="ce40" class="lq kf ht lm b fi lv ls l lt lu">sns.countplot(df2['Spending Score (1-100)'], palette = 'magma')</span><span id="9e33" class="lq kf ht lm b fi lv ls l lt lu">plt.title('Distribution of Spending Score', fontsize = 20)</span><span id="6b1e" class="lq kf ht lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mg"><img src="../Images/066a9ade408c17e913961bc9aa49370c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hynxuize49Bq15snEs-mSw.png"/></div></div></figure><p id="e629" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从购物中心的角度来看，这是最重要的图表，因为对逛购物中心的顾客的消费分数有一些直觉和想法是非常重要的。</p><p id="2536" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">总的来说，我们可以得出结论，大多数顾客的消费得分在35-60分之间。有趣的是，有些顾客的消费分数也是I，消费分数也是99，这表明该购物中心迎合了购物中心中具有不同需求和要求的各种顾客。</p><h1 id="2064" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">性别与支出得分:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="dddf" class="lq kf ht lm b fi lr ls l lt lu">plt.rcParams['figure.figsize'] = (18, 7)</span><span id="a317" class="lq kf ht lm b fi lv ls l lt lu">sns.boxenplot(df2['Gender'], df2['Spending Score (1-100)'], palette = 'Accent_r')</span><span id="02f3" class="lq kf ht lm b fi lv ls l lt lu">plt.title('Gender vs Spending Score', fontsize = 20)</span><span id="2162" class="lq kf ht lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mh"><img src="../Images/a9a1ada9b866e0f11ca2fa39d7753439.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1EC-h1zjQoa4O53y3bW88g.png"/></div></div></figure><p id="7be4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">可以清楚地看到，大多数男性的花费分数在25k美元到70k美元之间，而女性的花费分数在35k美元到75k美元之间。这再次表明女性是购物的领导者。</p><h1 id="e07c" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">性别与年收入:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="36f6" class="lq kf ht lm b fi lr ls l lt lu">plt.rcParams['figure.figsize'] = (18, 7)</span><span id="88d1" class="lq kf ht lm b fi lv ls l lt lu">sns.violinplot(df2['Gender'], df2['Annual Income (k$)'], palette = 'gnuplot')</span><span id="5469" class="lq kf ht lm b fi lv ls l lt lu">plt.title('Gender vs Spending Score', fontsize = 20)</span><span id="79df" class="lq kf ht lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mh"><img src="../Images/fef3f88e9b6c53260db1b6c4bb0270a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*exKS-b-qni9mN7MHnzu0SA.png"/></div></div></figure><p id="253b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从上面的图表中，我们可以看到男性的工资比女性高。但是，当谈到低年收入时，男性和女性的数量是相等的。</p><h1 id="7ebc" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated"><strong class="ak">支出分数分布:</strong></h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="72b2" class="lq kf ht lm b fi lr ls l lt lu">plt.rcParams['figure.figsize'] = (35, 14)</span><span id="0294" class="lq kf ht lm b fi lv ls l lt lu">sns.countplot(df2['Spending Score (1-100)'], palette = 'gist_rainbow')</span><span id="2170" class="lq kf ht lm b fi lv ls l lt lu">plt.title('Distribution of Spending Score', fontsize = 20)</span><span id="ac17" class="lq kf ht lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mg"><img src="../Images/910888bdc1eafd9ababadf5757fb9cb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-yaADmHcyEHFStCdonLnjA.png"/></div></div></figure><p id="e490" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从上面的图表中，我们可以看到，一个人的总支出分数是99，最多的人得到42作为总支出分数。</p><h1 id="b9ba" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">年收入与支出得分:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="935a" class="lq kf ht lm b fi lr ls l lt lu">ax = sns.barplot(y= "Spending Score (1-100)", x = "Annual Income (k$)", data = df2, palette=("Blues_d"))</span><span id="40a7" class="lq kf ht lm b fi lv ls l lt lu">sns.set(rc={'figure.figsize':(11.7,8.27)})</span><span id="73fe" class="lq kf ht lm b fi lv ls l lt lu">sns.set_context("poster")</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mi"><img src="../Images/f3a35d08e57107007f648aa34bc6cca6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_EjRrgIcEqDpHRhIOYsMdQ.png"/></div></div></figure><h1 id="8323" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">年收入与年龄和支出得分:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="5302" class="lq kf ht lm b fi lr ls l lt lu">x = df2['Annual Income (k$)']</span><span id="a93b" class="lq kf ht lm b fi lv ls l lt lu">y = df2['Age']</span><span id="43c3" class="lq kf ht lm b fi lv ls l lt lu">z = df2['Spending Score (1-100)']</span><span id="4f18" class="lq kf ht lm b fi lv ls l lt lu">sns.lineplot(x, y, color = 'blue', palette = 'Accent_r')</span><span id="9c4c" class="lq kf ht lm b fi lv ls l lt lu">sns.lineplot(x, z, color = 'pink', palette = 'Accent_r')</span><span id="7000" class="lq kf ht lm b fi lv ls l lt lu">plt.title('Annual Income vs Age and Spending Score', fontsize = 20)</span><span id="8035" class="lq kf ht lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mj"><img src="../Images/26fd56fc50e157eca4b3753caf809c4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PycY8fDS9lrqZRoY3_Rs_w.png"/></div></div></figure><p id="5a0b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上面的年收入和年龄之间的图用蓝色线表示，年收入和支出分数之间的图用粉色表示。它显示了年龄和支出如何随着年收入而变化。</p><h1 id="7484" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">k表示聚类:</h1><p id="c97e" class="pw-post-body-paragraph iq ir ht is b it lc iv iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn hb bi translated">k均值聚类是一种矢量量化方法，最初来自信号处理，旨在将n个观测值划分为k个聚类，其中每个观测值属于具有最近均值(聚类中心或聚类质心)的聚类，作为聚类的原型。这导致将数据空间划分成Voronoi单元。k-means聚类最小化类内方差(平方欧几里得距离)，但不是常规欧几里得距离，这将是更困难的韦伯问题:平均值优化平方误差，而只有几何中值最小化欧几里得距离。例如，使用k-中值和k-中值可以找到更好的欧几里得解。</p><p id="abfa" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">无监督的k-means算法与k-nearest neighborhood分类器有松散的关系，k-nearest neighborhood分类器是一种流行的监督机器学习分类技术，由于名称的原因，它经常与k-means混淆。将1-最近邻分类器应用于通过k-means获得的聚类中心，将新数据分类到现有聚类中。这被称为最近质心分类器或罗基奥算法。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="69ee" class="lq kf ht lm b fi lr ls l lt lu">x = df2.iloc[:, [3, 4]].values</span></pre><p id="4752" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里我们选取了第4列和第5列进行聚类分析。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="ff7c" class="lq kf ht lm b fi lr ls l lt lu">print(x.shape)</span></pre><h1 id="e861" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">求最优聚类数的肘方法:</h1><p id="4e4a" class="pw-post-body-paragraph iq ir ht is b it lc iv iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn hb bi translated">在聚类分析中，肘方法是一种启发式方法，用于确定数据集中的聚类数。该方法包括将解释的变化绘制为聚类数的函数，并选取曲线的弯头作为要使用的聚类数。同样的方法可以用于选择其他数据驱动模型中的参数数量，例如描述数据集的主成分数量。</p><p id="92c0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个方法可以追溯到罗伯特·l·桑代克1953年的推测。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="a20d" class="lq kf ht lm b fi lr ls l lt lu">from sklearn.cluster import KMeans</span><span id="534c" class="lq kf ht lm b fi lv ls l lt lu">wcss = []</span><span id="ac75" class="lq kf ht lm b fi lv ls l lt lu">for i in range(1, 11):</span><span id="fc09" class="lq kf ht lm b fi lv ls l lt lu">km = KMeans(n_clusters = i, init = 'k-means++', max_iter = 300, n_init = 10, random_state = 0)</span><span id="c93b" class="lq kf ht lm b fi lv ls l lt lu">km.fit(x)</span><span id="a3fb" class="lq kf ht lm b fi lv ls l lt lu">wcss.append(km.inertia_)</span><span id="513a" class="lq kf ht lm b fi lv ls l lt lu">plt.plot(range(1, 11), wcss)</span><span id="e968" class="lq kf ht lm b fi lv ls l lt lu">plt.title('The Elbow Method', fontsize = 20)</span><span id="eeec" class="lq kf ht lm b fi lv ls l lt lu">plt.xlabel('No. of Clusters')</span><span id="9b1d" class="lq kf ht lm b fi lv ls l lt lu">plt.ylabel('wcss')</span><span id="1bbd" class="lq kf ht lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mk"><img src="../Images/c8f63eb785f2bada8f97551319a5ffbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cGKBqjunEvo-AKQXt1AX-w.png"/></div></div></figure><p id="aac2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在上图中，斜率减小的点称为拐点。</p><h1 id="512e" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">k表示在训练集上的模型训练:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="3802" class="lq kf ht lm b fi lr ls l lt lu">km = KMeans(n_clusters = 5, init = 'k-means++', max_iter = 300, n_init = 10, random_state = 0)</span><span id="da46" class="lq kf ht lm b fi lv ls l lt lu">y_means = km.fit_predict(x)</span></pre><p id="4918" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从上面的训练中，我们在数据集上总共获得了5个聚类。</p><h1 id="0a40" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">可视化集群:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="604f" class="lq kf ht lm b fi lr ls l lt lu">plt.scatter(x[y_means == 0, 0], x[y_means == 0, 1], s = 100, c = 'pink', label = 'miser')</span><span id="686a" class="lq kf ht lm b fi lv ls l lt lu">plt.scatter(x[y_means == 1, 0], x[y_means == 1, 1], s = 100, c = 'yellow', label = 'general')</span><span id="19cc" class="lq kf ht lm b fi lv ls l lt lu">plt.scatter(x[y_means == 2, 0], x[y_means == 2, 1], s = 100, c = 'cyan', label = 'target')</span><span id="4409" class="lq kf ht lm b fi lv ls l lt lu">plt.scatter(x[y_means == 3, 0], x[y_means == 3, 1], s = 100, c = 'magenta', label = 'spendthrift')</span><span id="5c93" class="lq kf ht lm b fi lv ls l lt lu">plt.scatter(x[y_means == 4, 0], x[y_means == 4, 1], s = 100, c = 'orange', label = 'careful')</span><span id="9d9a" class="lq kf ht lm b fi lv ls l lt lu">plt.scatter(km.cluster_centers_[:,0], km.cluster_centers_[:, 1], s = 50, c = 'black' , label = 'centeroid')</span><span id="76a6" class="lq kf ht lm b fi lv ls l lt lu">plt.style.use('fivethirtyeight')</span><span id="b77f" class="lq kf ht lm b fi lv ls l lt lu">plt.title('K Means Clustering', fontsize = 20)</span><span id="2540" class="lq kf ht lm b fi lv ls l lt lu">plt.xlabel('Annual Income')</span><span id="f233" class="lq kf ht lm b fi lv ls l lt lu">plt.ylabel('Spending Score')</span><span id="a028" class="lq kf ht lm b fi lv ls l lt lu">plt.legend()</span><span id="0d9f" class="lq kf ht lm b fi lv ls l lt lu">plt.grid()</span><span id="2e9d" class="lq kf ht lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mj"><img src="../Images/52c21305073f25e5a94386ed92923149.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V_TjmqhcuCfR85hehFHpGw.png"/></div></div></figure><p id="b079" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从上面的散点图中，我们可以看到年收入和总支出得分之间的不同聚类。在此散点图中共创建了5个聚类，黑点是这5个聚类的质心。</p><h1 id="226a" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">分层聚类</h1><p id="68cc" class="pw-post-body-paragraph iq ir ht is b it lc iv iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn hb bi translated">层次聚类，也称为层次聚类分析，是一种将相似对象分组到称为聚类的组中的算法。端点是一组群集，其中每个群集都不同于另一个群集，并且每个群集内的对象大体上彼此相似。在数据挖掘和统计中，层次聚类(也称为层次聚类分析或HCA)是一种聚类分析方法，旨在构建聚类的层次结构。分层聚类的策略通常分为两种类型:</p><h1 id="1a3c" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">凝聚的:</h1><p id="bc14" class="pw-post-body-paragraph iq ir ht is b it lc iv iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn hb bi translated">这是一种“自下而上”的方法:每个观察从它自己的聚类开始，随着一个观察在层次结构中向上移动，聚类对被合并。</p><h1 id="6a76" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">分裂的:</h1><p id="bf16" class="pw-post-body-paragraph iq ir ht is b it lc iv iw ix ld iz ja jb le jd je jf lf jh ji jj lg jl jm jn hb bi translated">这是一种“自上而下”的方法:所有的观察都从一个集群开始，当一个集群向下移动时，就会递归地执行分割。</p><p id="148d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">层次凝聚聚类(HAC)的标准算法具有O(n)的时间复杂度，并且需要O(n)的内存，这使得它对于甚至中等数据集来说都太慢。</p><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="7bba" class="lq kf ht lm b fi lr ls l lt lu">import scipy.cluster.hierarchy as sch</span><span id="8c92" class="lq kf ht lm b fi lv ls l lt lu">dendrogram = sch.dendrogram(sch.linkage(x, method = 'ward'))</span><span id="c8a9" class="lq kf ht lm b fi lv ls l lt lu">plt.title('Dendrogam', fontsize = 20)</span><span id="0b2e" class="lq kf ht lm b fi lv ls l lt lu">plt.xlabel('Customers')</span><span id="a953" class="lq kf ht lm b fi lv ls l lt lu">plt.ylabel('Ecuclidean Distance')</span><span id="27d8" class="lq kf ht lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ml"><img src="../Images/1a3986ba03e7f936ddd02d6eb82de05d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2BdQWivPmAGM4g9zNZ44sA.png"/></div></div></figure><p id="e8e6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">树状图是显示对象之间层次关系的图表。它通常是作为层次聚类的输出而创建的。树状图的主要用途是找出将对象分配到集群的最佳方式。上面的树状图显示了散点图中不同观察值的等级聚类。</p><h1 id="f95d" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">训练集上的层次聚类模型训练；</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="4246" class="lq kf ht lm b fi lr ls l lt lu">from sklearn.cluster import AgglomerativeClustering</span><span id="577d" class="lq kf ht lm b fi lv ls l lt lu">hc = AgglomerativeClustering(n_clusters = 5, affinity = 'euclidean', linkage = 'ward')</span><span id="ccf5" class="lq kf ht lm b fi lv ls l lt lu">y_hc = hc.fit_predict(x)</span></pre><h1 id="396e" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">可视化集群:</h1><pre class="lh li lj lk fd ll lm ln lo aw lp bi"><span id="70ae" class="lq kf ht lm b fi lr ls l lt lu">plt.scatter(x[y_hc == 0, 0], x[y_hc == 0, 1], s = 100, c = 'pink', label = 'miser')</span><span id="7ebb" class="lq kf ht lm b fi lv ls l lt lu">plt.scatter(x[y_hc == 1, 0], x[y_hc == 1, 1], s = 100, c = 'yellow', label = 'general')</span><span id="cf0c" class="lq kf ht lm b fi lv ls l lt lu">plt.scatter(x[y_hc == 2, 0], x[y_hc == 2, 1], s = 100, c = 'cyan', label = 'target')</span><span id="5f1d" class="lq kf ht lm b fi lv ls l lt lu">plt.scatter(x[y_hc == 3, 0], x[y_hc == 3, 1], s = 100, c = 'magenta', label = 'spendthrift')</span><span id="2b6b" class="lq kf ht lm b fi lv ls l lt lu">plt.scatter(x[y_hc == 4, 0], x[y_hc == 4, 1], s = 100, c = 'orange', label = 'careful')</span><span id="444c" class="lq kf ht lm b fi lv ls l lt lu">plt.scatter(km.cluster_centers_[:,0], km.cluster_centers_[:, 1], s = 50, c = 'blue' , label = 'centeroid')</span><span id="023f" class="lq kf ht lm b fi lv ls l lt lu">plt.style.use('fivethirtyeight')</span><span id="08b2" class="lq kf ht lm b fi lv ls l lt lu">plt.title('Hierarchial Clustering', fontsize = 20)</span><span id="981c" class="lq kf ht lm b fi lv ls l lt lu">plt.xlabel('Annual Income')</span><span id="632d" class="lq kf ht lm b fi lv ls l lt lu">plt.ylabel('Spending Score')</span><span id="f403" class="lq kf ht lm b fi lv ls l lt lu">plt.legend()</span><span id="8813" class="lq kf ht lm b fi lv ls l lt lu">plt.grid()</span><span id="2279" class="lq kf ht lm b fi lv ls l lt lu">plt.show()</span></pre><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mm"><img src="../Images/d6a98fd12b8af8bcca6edb9ca14a22b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AX3GAdW04lcRFdgX53ZPJw.png"/></div></div></figure><p id="93cd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">从上面的散点图中，我们可以看到年收入和总支出得分之间的不同聚类。在此散点图中共创建了5个聚类，蓝色点是这5个聚类的质心。</p><h1 id="64f3" class="ke kf ht bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">项目简介:</h1><ol class=""><li id="b50d" class="jq jr ht is b it lc ix ld jb mn jf mo jj mp jn mq jw jx jy bi translated">这是一个对购物中心客户数据集进行聚类的项目。</li><li id="af83" class="jq jr ht is b it jz ix ka jb kb jf kc jj kd jn mq jw jx jy bi translated">首先我实现了K均值聚类，然后我实现了层次聚类。</li><li id="ec06" class="jq jr ht is b it jz ix ka jb kb jf kc jj kd jn mq jw jx jy bi translated">我最终从散点图中得到5个集群。</li><li id="427c" class="jq jr ht is b it jz ix ka jb kb jf kc jj kd jn mq jw jx jy bi translated">在等级聚类中，我绘制了一个树状图。</li></ol><p id="baa0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.在每一次聚类中，我们都有一个等距离的质心。</p><figure class="lh li lj lk fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mr"><img src="../Images/17992e4f74d77875a446f06112353895.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3WCyu8tkqOliLts9Lnrq6Q.jpeg"/></div></div></figure></div></div>    
</body>
</html>