<html>
<head>
<title>Monty Hall Done Right</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">蒙蒂·霍尔做得对</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/monty-hall-done-right-15732a201fc3?source=collection_archive---------2-----------------------#2021-12-08">https://medium.com/analytics-vidhya/monty-hall-done-right-15732a201fc3?source=collection_archive---------2-----------------------#2021-12-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="65dc" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">蒙蒂霍尔问题是用条件概率用任意数量的汽车和山羊解决的。作为奖励，我包括一个colab笔记本，它通过多臂土匪策略解决了这个问题。</h2></div><h1 id="242b" class="iw ix hh bd iy iz ja jb jc jd je jf jg in jh io ji iq jj ir jk it jl iu jm jn bi translated">理论推导</h1><p id="ac96" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">不缺乏蒙蒂霍尔问题的描述。然而，我认为<strong class="jq hi">反复看1辆汽车和2只山羊这个问题会被这个特殊例子的细节所困扰</strong>,这让我想起李小龙在《龙争虎斗》中引用的一个禅宗寓言</p><blockquote class="kk kl km"><p id="f6d0" class="jo jp kn jq b jr ko ii jt ju kp il jw kq kr jz ka ks kt kd ke ku kv kh ki kj ha bi translated">这就像一个手指指向月亮，不要专注在手指上，否则你会错过所有天上的荣耀</p></blockquote><p id="287c" class="pw-post-body-paragraph jo jp hh jq b jr ko ii jt ju kp il jw jx kr jz ka kb kt kd ke kf kv kh ki kj ha bi translated">所以在这里<strong class="jq hi">我用任意数量的汽车和山羊</strong>解决了蒙蒂霍尔问题，并使用了条件概率数学。此外，<strong class="jq hi">我把最一般的宿主行为留到最后一步，以便突出无知的宿主和全知的宿主之间的区别。</strong></p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/d3966562c044cd2b5bb38836c7d7ccf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-zGqnPnxEcMtuGUxM7_2Lw.jpeg"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated"><a class="ae lm" href="https://unsplash.com/photos/3c_EjT6uAFo" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/3c_EjT6uAFo</a></figcaption></figure><p id="34ba" class="pw-post-body-paragraph jo jp hh jq b jr ko ii jt ju kp il jw jx kr jz ka kb kt kd ke kf kv kh ki kj ha bi translated">如果你知道条件概率，这并不难做到，否则可能会导致不必要的溃疡。你已经被警告了！</p><p id="f71b" class="pw-post-body-paragraph jo jp hh jq b jr ko ii jt ju kp il jw jx kr jz ka kb kt kd ke kf kv kh ki kj ha bi translated">现在让我们来看一个情况，有nc汽车和ng山羊，设置是你随机选择一个门。主人打开另一扇门，露出里面的东西。该不该换？</p><p id="58f4" class="pw-post-body-paragraph jo jp hh jq b jr ko ii jt ju kp il jw jx kr jz ka kb kt kd ke kf kv kh ki kj ha bi translated">所以我们想知道</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es ln"><img src="../Images/680c7c37e6a24b90f633c6040abab41f.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/1*gpanjrrj-96Yjbw_n-jTQw.png"/></div></figure><p id="873e" class="pw-post-body-paragraph jo jp hh jq b jr ko ii jt ju kp il jw jx kr jz ka kb kt kd ke kf kv kh ki kj ha bi translated">如果我们交换，赢得一辆汽车的概率。</p><p id="79fa" class="pw-post-body-paragraph jo jp hh jq b jr ko ii jt ju kp il jw jx kr jz ka kb kt kd ke kf kv kh ki kj ha bi translated">使用条件概率，这是</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lo"><img src="../Images/6b0d24efec433c4ec28953b76b5b93a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9oSfpLMeIqqQo4Hrkv8qZg.png"/></div></div></figure><p id="610e" class="pw-post-body-paragraph jo jp hh jq b jr ko ii jt ju kp il jw jx kr jz ka kb kt kd ke kf kv kh ki kj ha bi translated">举例来说，其中的符号P(C|S，C，G)表示得到一辆汽车的概率(C ),如果你在开始时碰巧选择了一扇有山羊的门(G ),然后主人打开了一扇有汽车的门(C ),然后你换了(S)。<strong class="jq hi">概率的条件部分应由右至左阅读符号</strong>(实际年表与计算无关)。另一个概率P(C，G)是你选择了一扇门，门后有一只山羊(G)，主人打开了一扇门，门后有一辆汽车(C)。</p><p id="f4ba" class="pw-post-body-paragraph jo jp hh jq b jr ko ii jt ju kp il jw jx kr jz ka kb kt kd ke kf kv kh ki kj ha bi translated">上述表达式可以通过使用如下关系式来进一步简化</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lp"><img src="../Images/d5ad375ec0c2b4c1a59cdf5d05a5c168.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s2hpXphn3BtR658m-LhSaA.png"/></div></div></figure><p id="9eec" class="pw-post-body-paragraph jo jp hh jq b jr ko ii jt ju kp il jw jx kr jz ka kb kt kd ke kf kv kh ki kj ha bi translated">也就是说，你选择一只山羊(G)而主持人打开一扇门，门后有一辆车(C)的概率是你选择一只山羊的概率P(G)和主持人选择一辆车(C)的概率的乘积<em class="kn">事后</em>你选择一只山羊。我用符号π(C|G)来表示它，因为它是宿主的一个动作，但是数学并不关心这个。</p><p id="4e63" class="pw-post-body-paragraph jo jp hh jq b jr ko ii jt ju kp il jw jx kr jz ka kb kt kd ke kf kv kh ki kj ha bi translated">有了这个我们得到了</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lq"><img src="../Images/d1138e0d677faec6f6b9333891007b7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5UO53oV8aD1ryg2Sm0ajLw.png"/></div></div></figure><p id="2b3c" class="pw-post-body-paragraph jo jp hh jq b jr ko ii jt ju kp il jw jx kr jz ka kb kt kd ke kf kv kh ki kj ha bi translated">最后利用我们有nc汽车和ng山羊的事实</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lr"><img src="../Images/409d330c1e3fdde02b8a38d105a841bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QRegkyTJUn3dvvWDD6FF-g.png"/></div></div></figure><p id="b4a6" class="pw-post-body-paragraph jo jp hh jq b jr ko ii jt ju kp il jw jx kr jz ka kb kt kd ke kf kv kh ki kj ha bi translated">这里我们定义了n = nc+ng。</p><p id="d396" class="pw-post-body-paragraph jo jp hh jq b jr ko ii jt ju kp il jw jx kr jz ka kb kt kd ke kf kv kh ki kj ha bi translated">到目前为止，我们有最普遍的情况，唯一的限制是主机只打开一扇门。这就是蒙蒂霍尔问题的由来。<strong class="jq hi">如果主人不知道任何一扇门后有什么</strong>那么打开任何一扇你没有选中的门的概率是相等的，给出π(G|G) = (ng-1)/(n-1)，π(C|G) = nc/(n-1)，π(G|C) = ng/(n-1)和π(C|C) =(nc-1)/(n-1)和<strong class="jq hi">如果你算一下，你会得到P(C|S) = n_c/n</strong></p><p id="c61b" class="pw-post-body-paragraph jo jp hh jq b jr ko ii jt ju kp il jw jx kr jz ka kb kt kd ke kf kv kh ki kj ha bi translated">但是，<strong class="jq hi">如果主人知道每扇门后面是什么，有目的地打开一扇门，门后面有一只山羊</strong>那么我们就有π(C|C) = π(C|G) =0，π(G|G)= π(G|C) =1。有了这些，我们得到了</p><figure class="kx ky kz la fd lb er es paragraph-image"><div class="er es ls"><img src="../Images/71da6089cffca569e736d6725d9844b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*m89PLJ2qvVkPBL2QGsmOEQ.png"/></div></figure><p id="f31a" class="pw-post-body-paragraph jo jp hh jq b jr ko ii jt ju kp il jw jx kr jz ka kb kt kd ke kf kv kh ki kj ha bi translated">这对于nc=1和n=3给出了著名的结果2/3。注意，n≥3和nc≤n-1(因为主人必然选择一只山羊)和上面的表达式P(C|S) &lt;1 as should be. In fact we can write</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lt"><img src="../Images/fd111008c0f69f1298c6e958eb90f006.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FtUST8ks0Oz3LqaMVYKUWA.png"/></div></div></figure><p id="e6c7" class="pw-post-body-paragraph jo jp hh jq b jr ko ii jt ju kp il jw jx kr jz ka kb kt kd ke kf kv kh ki kj ha bi translated">where the first part on the right hand side is the probability of P(C|S) when the host doesn’t know what’s behind each door. Since n-1 &gt; n-2，我们看到，如果主人故意选择一扇后面有一只山羊的门，切换总是有利可图的。</p><h1 id="32a3" class="iw ix hh bd iy iz ja jb jc jd je jf jg in jh io ji iq jj ir jk it jl iu jm jn bi translated">多股武装匪徒</h1><p id="3fdf" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">如果我们有一个不理解条件概率或者只是不喜欢数学，只是想在探索和利用的基础上学习转换或不转换的代理人，她可以在探索的同时重复玩这个游戏，有时转换，有时不理解奖励分配。与此同时，她不仅对经销的学术知识感兴趣，还想利用这些知识获得更多宝马、法拉利和劳斯莱斯。她必须在探索(切换或不切换)和利用(执行为她赢得更多汽车的行动)之间取得平衡。这是<a class="ae lm" href="https://en.wikipedia.org/wiki/Multi-armed_bandit" rel="noopener ugc nofollow" target="_blank">多臂土匪</a>的经典问题。</p><p id="c128" class="pw-post-body-paragraph jo jp hh jq b jr ko ii jt ju kp il jw jx kr jz ka kb kt kd ke kf kv kh ki kj ha bi translated">用于分析的笔记本可以在<a class="ae lm" href="https://github.com/borundev/DNN_Lectures/blob/master/Monty_Hall.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="5000" class="pw-post-body-paragraph jo jp hh jq b jr ko ii jt ju kp il jw jx kr jz ka kb kt kd ke kf kv kh ki kj ha bi translated">下面是代理人使用ε贪婪方法切换或不切换的平均报酬(山羊=0，汽车=1)图。虚线是我上面推导的理论值。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lu"><img src="../Images/8967c4d689e1ee2dbe684e4d4f362a30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nOpNwR1dMbD1-VPQrSoD7g.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">Monty Hall问题的多臂强盗解决方案</figcaption></figure><h1 id="5b6e" class="iw ix hh bd iy iz ja jb jc jd je jf jg in jh io ji iq jj ir jk it jl iu jm jn bi translated">结论</h1><p id="0908" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">为了突出Monty Hall问题的实际症结，我对任意数量的汽车和山羊进行了求解。当汽车和山羊的数量分别为1和2时，结果减少到著名的值2/3。此外，通过编写显式宿主角色的表达式，我展示了无知的宿主如何导致大多数人天真地期待的答案，以及真实的答案如何与天真无知的Monty解决方案相关联。最后，我提供了一个到colab笔记本的链接，它使用多臂强盗策略解决了这个问题，并确认了理论结果与模拟结果相匹配。</p></div></div>    
</body>
</html>