<html>
<head>
<title>Get Eurex Trading Holidays — and more — in 5 mins using Python and GraphQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和GraphQL在5分钟内获得Eurex交易假期等更多信息</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/get-eurex-trading-holidays-and-more-in-5-mins-using-python-and-graphql-c4fdec4f4417?source=collection_archive---------11-----------------------#2021-03-14">https://medium.com/analytics-vidhya/get-eurex-trading-holidays-and-more-in-5-mins-using-python-and-graphql-c4fdec4f4417?source=collection_archive---------11-----------------------#2021-03-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/045d201f90936ad11c5b501e4be3c6c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*k4FrDcZZnbJoZcQ0"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">克里斯·利维拉尼在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="c8b4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">作为一个在金融交易所密切工作的人，交易时间表是需要处理的许多重要信息之一。大多数交易所在其网站上提供交易日历，有些显示的格式不够理想。例如，我是一个对原始数据和数字感兴趣的人，像PDF或前端用户界面(如下所示)这样的格式可能不太有用，因为它们不能为我提供编写脚本和自动化警报的灵活性。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/ef01468ac506aff0071fbb9f40228e73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dQTwoG0dJXF9TgV3_VsUkA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">一个基于用户界面的交易日历的例子:漂亮，但不是我喜欢的。</figcaption></figure><p id="d4bb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以当我第一次从我的同事那里听说Eurex正在把它的T7参考数据放到一个API上时，我非常激动！在本文中，我将向您介绍这个API和您可以从中获取的一些信息，以及如何使用GraphQL和Python利用这个API来获得无缝体验。系好安全带。</p></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><p id="db5b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">那么，GraphQL是什么？</strong></p><p id="a7cf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">根据<a class="ae iu" href="https://graphql.org/learn/" rel="noopener ugc nofollow" target="_blank">正式的</a>定义，“GraphQL是一种用于API的查询语言，是一种服务器端运行时，通过使用您为数据定义的类型系统来执行查询……(而且它)不依赖于任何特定的数据库或存储引擎，而是由您现有的代码和数据支持”。使用基于GraphQL的API是一个好主意，因为它有几个好处</p><ol class=""><li id="350f" class="kf kg hi ix b iy iz jc jd jg kh jk ki jo kj js kk kl km kn bi translated">GraphQL是一种相对容易掌握的语言，网上有写得很好的文档，可以平滑学习曲线</li><li id="19dd" class="kf kg hi ix b iy ko jc kp jg kq jk kr jo ks js kk kl km kn bi translated">它可以通过Chrome扩展“GraphQL Playground for Chrome”轻松访问，任何人都可以轻松下载并访问该API，没有任何技术困难</li><li id="125c" class="kf kg hi ix b iy ko jc kp jg kq jk kr jo ks js kk kl km kn bi translated">它有一个“<a class="ae iu" href="https://graphql.org/learn/introspection/" rel="noopener ugc nofollow" target="_blank">自省</a>”功能，供最终用户导航API的模式；它很直观，没有麻烦，人们不需要挖掘文档来了解可用的内容</li></ol><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kt"><img src="../Images/9c1cdeba04e941407fce6e8e7acd8e52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h4-pPS6awQOcYnK81RA4pA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Chrome的GraphQL游乐场</figcaption></figure></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><p id="6bed" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">那么如何访问Eurex的参考数据API呢？</strong></p><p id="43aa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">轻松点。首先，你可以在<a class="ae iu" href="https://console.developer.deutsche-boerse.com/apis" rel="noopener ugc nofollow" target="_blank"> DBG开发者门户</a>上找到公开可用的API列表。从那里，转到“AccessToT7-ReferenceData”并注册一个API密钥。虽然网页提供了演示密钥，但建议用户申请一个，以便对数据的访问限制更少。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ku"><img src="../Images/d73044dae75e7c0e3ca2225c808b37dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JbLzLvt0p0z0Njdh4wuaFA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">API密钥和主机URL可在网页上找到</figcaption></figure><p id="bf00" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，使用API键和主机URL，转到GraphQL Playground，在顶栏的URL字段中插入主机URL(见下文),并在“HTTP Header”下插入API键。此时，您的环境应该已经设置好了，您可以开始在左边的控制台上编写脚本了。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kv"><img src="../Images/fa925223c3a5d8ec298faa62903d7a91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_iSsvj3qoi8hxgxVa8JWDQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">一旦建立了环境，就从自省开始理解API的模式。</figcaption></figure><p id="cef8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在处理API时，首先要做的一件事是了解哪些数据对您可用。因此，我们应该从反省开始。通过编写上面的脚本，您能够探索可用的数据。</p><p id="307b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦你确定了你感兴趣的数据，你就需要进一步了解细节。对于这个例子，我正在查找“Holidays ”,我编写了查询来显示数据和可用字段的描述。通过内省，我了解到数据“假期”由未来2年所有产品的所有交易假期和交换假期(当产品的清算和交易不可用时)组成。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kw"><img src="../Images/a63f1ff7332d42f3fe3e1f683cd29f9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tq59gEYGYe0VtVzKj5b58g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">内省还允许我们查看感兴趣的数据的细节。</figcaption></figure><p id="5817" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有了这些信息，我现在可以开始做我的查询！作为一个例子，我将从查询EURO STOXX 50指数期货(交易所代码FESX，彭博代码VGA Index)的交易假期开始，如下所示。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kx"><img src="../Images/3706168b27ac99558dca34e3ad2e009d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*darkichxsgNQd3ncGvPr4Q.png"/></div></div></figure></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><p id="1db9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> GraphQL和Python的完美结合</strong></p><p id="c475" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">虽然看起来很简单，但是使用GraphQL Playground本身可能还不够，因为它是一个非常基于接口的解决方案。对于像我这样的一些用户来说，当插入另一个程序时，必须立即检索产品列表的交易假期，以便于处理。理想的情况是以我们需要的格式在GraphQL和后端之间建立一个连接。</p><p id="c483" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以Python来了！通过使用“请求”包，我们能够通过POST请求在GraphQL API和Python之间建立连接。只需定义URL头、API键和查询，您就可以在几秒钟内检索到信息。如果您正在寻找多个产品，您可以应用循环并将它们合并到一个数据框架中，以便进一步操作。在下面的例子中，我编写了一个简单的查询，查询Eurex的3个产品的交易假期，即</p><ul class=""><li id="eecc" class="kf kg hi ix b iy iz jc jd jg kh jk ki jo kj js ky kl km kn bi translated">KOSPI 200期权的每日到期期货(OKS2)，</li><li id="3368" class="kf kg hi ix b iy ko jc kp jg kq jk kr jo ks js ky kl km kn bi translated">迷你KOSPI 200期货(FMK2)的每日到期期货，以及</li><li id="e477" class="kf kg hi ix b iy ko jc kp jg kq jk kr jo ks js ky kl km kn bi translated">KOSPI 200期货的每日到期期货(FBK2)</li></ul><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kz"><img src="../Images/861f1dcf2286b3d9ec03d2343d6b45bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w6Zrgk7ejQn9TBMqqVWMqw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">通过Python对GraphQL API的POST请求的简单实现</figcaption></figure></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><p id="6cc9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">一个实际例子——为产品列表提取交易假期</strong></p><p id="eb07" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">欧洲期货交易所上市的商品超过1，900种，要记住所有商品的交易代码是很困难的，如果不是不可能的话。实际上，如果我在交易MSCI产品套件和一些基准产品，我会希望快速提取代码，以便我可以进行下一步工作，比如检索交易假期。这可以通过使用GraphQL API轻松完成，查询如下:</p><pre class="ju jv jw jx fd la lb lc ld aw le bi"><span id="0dbf" class="lf lg hi lb b fi lh li l lj lk">query {<br/>ProductInfos(filter: { Name: { contains: "MSCI" } }) {<br/>date<br/>data {<br/> Product,<br/> Name,<br/> ProductISIN,<br/> ProductLine,<br/>  ProductType<br/>}}}</span></pre><p id="b918" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我的例子中，我提取了基准产品、MSCI套件和KOSPI套件的交易假期。为了可视化交易假期，我选择使用Seaborn软件包提供的热图。为了便于演示，我挑选了18种产品的样本来构建热图，如下所示。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/a1db5739448f90d6096e7358a700e3ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*IG7HQvEILeOkNygVj-95dQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">交易假期矩阵——深蓝色区域表示交易假期。</figcaption></figure><p id="8807" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">根据上面的热图，我们可以很容易地判断出哪些产品将无法交易。值得注意的一个有趣现象是，KOSPI产品套件比其他产品套件有更多的交易假期。这是因为欧洲期货交易所KOSPI套件是欧洲期货交易所和KRX的合作产品(<a class="ae iu" href="https://www.eurex.com/ec-en/clear/eurex-krx-link" rel="noopener ugc nofollow" target="_blank">欧洲期货交易所-KRX交易所</a>)，因此交易会受到两个交易所节假日的影响。</p></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><p id="67b6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">超越交易假期……</strong></p><p id="24dd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">T7参考数据API提供了大量的参考数据来满足客户的需求。除了交易假期外，人们还可以了解交易所上市的每种产品的合约规格。另一个特别有用的信息是产品的交易时间。</p><p id="b656" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用下面的查询，可以提取连续交易的开始和结束时间。将查询与Python配对，您还可以根据您选择的时区调整时间，甚至可以将数据连接到前端程序，根据您的喜好可视化时间表。</p><pre class="ju jv jw jx fd la lb lc ld aw le bi"><span id="758d" class="lf lg hi lb b fi lh li l lj lk">query {<br/>TradingHours(filter: { Product: { eq: "OKS2" } }) {<br/>date<br/>data {<br/> Product,<br/> StartContinuosTrading,<br/>  EndOpeningAuction,<br/> EndContinuosTrading,<br/> EndClosingAuction,<br/>  StartTES,<br/>  EndTES<br/>}}}</span></pre><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/a36b13450cc3bff6aeb639423d07f05b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hGdyRKLNOXNuuAT7F_Vwdw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">提取选定产品的交易时间，转换为新加坡时间(GMT +8)</figcaption></figure><p id="49c8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从上面我们可以看到，基准产品的交易时间是新加坡/香港时间上午8:15T+0到上午5:00T+1。Eurex KOSPI产品的交易时间要晚得多，在KRX的收盘时间之后，从T+0的下午4:50到T+1的凌晨4:00。</p></div><div class="ab cl jy jz gp ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="hb hc hd he hf"><p id="29aa" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">结论——欧洲期货交易所T7参考数据API </strong></p><p id="b851" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通过这个简单的演练，我们可以将使用API的方法总结如下:</p><ol class=""><li id="9aaa" class="kf kg hi ix b iy iz jc jd jg kh jk ki jo kj js kk kl km kn bi translated">下载Chrome的GraphQL Playground扩展</li><li id="aead" class="kf kg hi ix b iy ko jc kp jg kq jk kr jo ks js kk kl km kn bi translated">转到DBG开发者门户并检索API密钥和主机URL</li><li id="b8ec" class="kf kg hi ix b iy ko jc kp jg kq jk kr jo ks js kk kl km kn bi translated">在操场上设置API键和主机URL</li><li id="03d6" class="kf kg hi ix b iy ko jc kp jg kq jk kr jo ks js kk kl km kn bi translated">应用内省来探索可用的数据，并查看感兴趣的数据的更多细节，包括可用的字段</li><li id="2d04" class="kf kg hi ix b iy ko jc kp jg kq jk kr jo ks js kk kl km kn bi translated">在操场上编写测试查询脚本，以确保查询脚本能够工作</li><li id="8871" class="kf kg hi ix b iy ko jc kp jg kq jk kr jo ks js kk kl km kn bi translated">使用POST请求连接到Python上的GraphQL API，以提取您需要的数据</li></ol><p id="3e4d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Eurex在其参考数据上提供的API确实有助于轻松提取其产品的关键信息，这确实为用户带来了价值。我希望这个演练有助于您理解它是如何工作的，以及如何利用它来为自己谋利。</p><p id="57bd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你想了解更多关于我在这个项目上写的代码，你可以在我的GitHub上找到，如下所示:</p><div class="ln lo ez fb lp lq"><a href="https://github.com/Finsinyur/EurexT7ReferenceData" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hj fi z dy lv ea eb lw ed ef hh bi translated">Finsinyur/EurexT7ReferenceData</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">这是一个关于如何使用Python访问Eurex T7参考数据的文档。欧洲期货交易所T7参考数据可通过…</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">github.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me io lq"/></div></div></a></div><p id="1172" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">编码快乐！:)</p><p id="e1ee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="mf">免责声明:作者是一名商业分析师，在德意志交易所集团旗下的金融衍生品交易所Eurex工作。这篇文章完全是以个人身份写的，唯一的目的是为了教育。</em></p></div></div>    
</body>
</html>