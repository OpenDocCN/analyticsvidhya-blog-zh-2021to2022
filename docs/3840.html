<html>
<head>
<title>Clustering and profiling customers using k-Means</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用k-Means对客户进行聚类和分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/clustering-and-profiling-customers-using-k-means-9afa4277427?source=collection_archive---------0-----------------------#2021-07-31">https://medium.com/analytics-vidhya/clustering-and-profiling-customers-using-k-means-9afa4277427?source=collection_archive---------0-----------------------#2021-07-31</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/282c95725153f06ab2ba91aeb4aaaea2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FFKufkty9PWxg2gj"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">Anthony Intraversato 在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="5e2b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面的文章介绍了使用客户销售数据进行聚类分析的流程。</p><p id="8138" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它包括以下步骤:</p><ul class=""><li id="3f8a" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">将输入销售数据转换为可用于聚类的要素数据集</li><li id="2d8a" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">执行聚类练习</li><li id="da09" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">分析集群，以及</li><li id="b277" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">建立常规评分流程，根据新数据分配聚类标签。</li></ul><p id="2b4f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我还用这个过程制作了一个Jupyter笔记本，并把它贴在了GitHub上。下面的文章中提到了这个笔记本。</p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><h1 id="35dc" class="ko kp hi bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">什么是集群？</h1><p id="1f5a" class="pw-post-body-paragraph iv iw hi ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated"><strong class="ix hj">聚类分析</strong>或<strong class="ix hj">聚类</strong>的任务是对一组对象进行分组，使同一组中的对象彼此之间比其他组中的对象更加相似。这些组被称为<strong class="ix hj">群集</strong>，并且可以以多种方式确定对象的<strong class="ix hj">相似性</strong>度量。</p><p id="b908" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这是一种<strong class="ix hj">无监督的</strong>学习方法，它试图在没有<strong class="ix hj">任何标签</strong>的帮助下确定数据<strong class="ix hj">中的底层结构。</strong></p><p id="5d99" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">它也可以被认为是一个探索性的T21过程，帮助我们发现数据中隐藏的感兴趣的模式或结构。</p><p id="1153" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">聚类广泛用于行业应用，如客户细分。客户细分有各种业务应用，因此对于数据科学家/分析师来说是一项非常重要的技能。</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/35e4dee52105dc3502ea7fbcb3abbdc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kzCm201r3OqwEcKp"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://unsplash.com/@jeremy0?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">杰里米·零</a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="5b63" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有各种可用的算法来执行聚类，这些算法可以分为以下几组:</p><ul class=""><li id="b07d" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated">基于分区，例如k-means</li><li id="5c99" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">等级体系的</li><li id="8926" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">基于密度的，例如DBScan，光学</li><li id="e85d" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">基于网格，例如波簇</li><li id="eb4c" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">基于模型，例如SOM</li></ul><p id="830e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以在<a class="ae iu" href="https://scikit-learn.org/stable/modules/clustering.html#clustering" rel="noopener ugc nofollow" target="_blank"> Scikit-learn </a>和<a class="ae iu" href="https://spark.apache.org/docs/2.4.4/api/python/pyspark.ml.html#module-pyspark.ml.clustering" rel="noopener ugc nofollow" target="_blank"> Spark ML Lib </a>中找到上述部分或全部算法的各种实现。</p><p id="bb7a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将使用来自<em class="lr"> scikit-learn 0.24.2 </em>在<em class="lr"> Python 3.7.9 </em>上的k-Means实现进行下面的演练。</p><blockquote class="lx ly lz"><p id="674d" class="iv iw lr ix b iy iz ja jb jc jd je jf ma jh ji jj mb jl jm jn mc jp jq jr js hb bi translated">在我的git repo <a class="ae iu" href="https://github.com/patilvijay23/MLinPython/tree/main/pyspark" rel="noopener ugc nofollow" target="_blank">这里</a>也可以找到使用PySpark 的<strong class="ix hj"> kMeans的演练。</strong></p></blockquote></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><p id="fbb9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们以一家在其网站上销售时尚商品的电子商务企业为例。</p><p id="44c2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了简单起见，我们只看销售数据，尽管在实际的电子商务业务中，你也会从他们的网站和应用程序平台获得大量的点击流数据。点击流数据对于了解你的网站和应用的性能，以及确定是什么驱使你的客户访问你的平台并购买非常有用。</p><h1 id="e2f9" class="ko kp hi bd kq kr md kt ku kv me kx ky kz mf lb lc ld mg lf lg lh mh lj lk ll bi translated">销售数据</h1><p id="36e0" class="pw-post-body-paragraph iv iw hi ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">我们的销售数据在<em class="lr">订单</em> x <em class="lr">项目</em>级别捕获<em class="lr">日期</em>、<em class="lr">客户id </em>、<em class="lr">产品</em>、<em class="lr">数量</em>、<em class="lr">美元金额</em>、&amp; <em class="lr">付款类型</em>。</p><ul class=""><li id="f5f8" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js jy jz ka kb bi translated"><em class="lr"> order_item_id </em>是指每个订单中的每个独特产品</li><li id="0614" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js jy jz ka kb bi translated">对于客户信息(<em class="lr"> customer_id </em>)、产品信息(<em class="lr"> product_id </em>)和付款投标信息(<em class="lr"> payment_type_id </em>)，我们都有相应的维度表</li></ul><p id="7a62" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是每个表中的示例行。</p><p id="4ef8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">交易表</strong>:</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/7885609e5622dcb994e7d41a5e8d988b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*f_Yy1Q_CVG9S_g6zAWWAhg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">df_sales.head()</figcaption></figure><p id="5ee2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">客户信息</strong>:</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/38fa40279c941860206ba285a1ad9554.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*_maNjD8xV2zvTZGPk5mfDg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">df_cutsomer.head()</figcaption></figure><p id="015f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">产品信息</strong>:</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div class="er es mk"><img src="../Images/2228946247340a7a6e13804659456968.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/1*7GliMJQbgwtmJt75xqf3sw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">df_product.head()</figcaption></figure><p id="013b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">付款信息</strong>:</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div class="er es ml"><img src="../Images/6909779481ba19d3a5b118bde9be69bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*5xsngIfmucQSiLFo7cjVPg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">df_payment.head()</figcaption></figure><p id="47ad" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请注意，使用的数据是合成的，是在excel中创建的。这些文件被保存为csv格式，以熊猫数据帧的形式导入python。</p><h1 id="26a6" class="ko kp hi bd kq kr md kt ku kv me kx ky kz mf lb lc ld mg lf lg lh mh lj lk ll bi translated">聚类练习</h1><p id="2574" class="pw-post-body-paragraph iv iw hi ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">为了对客户的交易数据进行聚类，我们需要以聚类练习所需的正确格式获取数据。</p><h2 id="186c" class="mm kp hi bd kq mn mo mp ku mq mr ms ky jg mt mu lc jk mv mw lg jo mx my lk mz bi translated">特征数据集</h2><p id="f533" class="pw-post-body-paragraph iv iw hi ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">我们将需要一个数据集，该数据集将随着时间的推移将客户活动汇总到一个<em class="lr"> customer_id </em>级别的数据集，即<strong class="ix hj">我们需要使用1行数据来描述每个客户，这些数据涵盖了我们对客户</strong>的所有了解。</p><p id="b9d2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所需的输出表应为每个客户一行，相关信息作为特征列。您可以在这里创建许多可能的功能，有些简单如1年的<em class="lr">销售额</em>，有些复杂或衍生如<em class="lr">特定产品类别的客户季度销售额变化</em>。</p><p id="b1a9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">流程的这一步将包括与业务涉众的对话，以确定哪些功能对业务至关重要。</p><p id="ab63" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以下是输出数据的示例:</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/67b30e44483a3f89b153be3c4d154ce9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xHDc85tDLvxVVeCtlmUVzA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">df_features.head()</figcaption></figure><p id="6d12" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">功能列表</strong></p><p id="e119" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们拥有的综合数据是2020日历年的，我们将采用整个时间段。在您的情况下，您可能需要添加相关的过滤器，并将销售数据集与其他一些数据集连接起来，以获得所需的数据，然后可以对这些数据进行聚合以获得以下功能。</p><p id="5c11" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">总体水平:</p><ol class=""><li id="c143" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js nb jz ka kb bi translated">销售</li><li id="b809" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js nb jz ka kb bi translated">量</li><li id="ede5" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js nb jz ka kb bi translated">订单数量</li><li id="cf57" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js nb jz ka kb bi translated">平均值。订单价值</li><li id="96f8" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js nb jz ka kb bi translated">每笔交易的单位</li><li id="64a8" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js nb jz ka kb bi translated">平均值。单位收入</li><li id="b7ef" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js nb jz ka kb bi translated">购买不同产品的数量</li><li id="1eea" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js nb jz ka kb bi translated">购买的不同产品类别的数量</li><li id="75cf" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js nb jz ka kb bi translated">使用的不同付款类型的数量</li></ol><p id="bd54" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">类别级别:</p><ol class=""><li id="ebd6" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js nb jz ka kb bi translated">类别级销售额占总销售额的百分比</li><li id="9985" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js nb jz ka kb bi translated">类别级别单位的拆分占总单位的百分比</li></ol><p id="0545" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">投标类型级别:</p><ol class=""><li id="af72" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js nb jz ka kb bi translated">投标类型级别销售额占总销售额的百分比</li></ol><p id="8401" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">客户信息:</p><ol class=""><li id="040b" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js nb jz ka kb bi translated">Omni购物者标志</li><li id="86e7" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js nb jz ka kb bi translated">电子邮件订阅标志</li></ol><p id="054b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">其他人口统计数据将仅用于分析。</p><p id="9e68" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面是从销售数据集中生成所需功能的一些代码片段。完整的代码流可以在<a class="ae iu" href="https://github.com/patilvijay23/MLinPython/blob/main/3_Clustering_kmeans.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub这里</a>找到。</p><figure class="lt lu lv lw fd ij"><div class="bz dy l di"><div class="nc nd l"/></div></figure></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><h2 id="a5ac" class="mm kp hi bd kq mn mo mp ku mq mr ms ky jg mt mu lc jk mv mw lg jo mx my lk mz bi translated">k均值聚类</h2><p id="89d1" class="pw-post-body-paragraph iv iw hi ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">准备好要素数据集后，我们将按照以下步骤从该数据中获取聚类。</p><ol class=""><li id="0c01" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js nb jz ka kb bi translated">无效处理</li><li id="4c72" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js nb jz ka kb bi translated">特征缩放</li><li id="56b2" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js nb jz ka kb bi translated">使用不同的k运行k均值的多次迭代</li><li id="ce26" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js nb jz ka kb bi translated">用肘图确定k的最佳值</li><li id="695c" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js nb jz ka kb bi translated">获取k个集群</li></ol><p id="41f1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">无效治疗</strong></p><p id="1cab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们需要对所有的特征应用适当的空值处理，因为k-means算法不能处理特征中的空值。</p><p id="4e5d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">各种不同的特征可能需要不同的零处理，这可以从特征为空时的含义来确定。例如，在我们的要素数据集中，类别和支付百分比分割要素中存在空值。这里的空值仅仅意味着客户没有购买该特定的类别或者没有使用该特定的支付方式。因此，我们将用0填充它们。</p><figure class="lt lu lv lw fd ij"><div class="bz dy l di"><div class="nc nd l"/></div></figure><p id="14f2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">特征缩放</strong></p><p id="f4eb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们所有的特征都存在于不同的尺度上。例如，销售功能可以从几百美元到几千美元，而单位将从几十美元到几百美元。百分比分割特征将位于[0，1]内。</p><p id="a36a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了确保在距离计算中没有一个要素会覆盖所有其他要素，我们需要在相同的比例下获取所有要素。</p><p id="b621" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将直接获取百分比特征而不进行缩放，因为它们已经位于[0，1]中，但是我们将使用<em class="lr"> MinMaxScaler() </em>将其他特征缩放到[0，1]。</p><figure class="lt lu lv lw fd ij"><div class="bz dy l di"><div class="nc nd l"/></div></figure><p id="ad1c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们还将scaler对象保存为pickle转储，以便在以后对新数据进行评分时使用。</p><figure class="lt lu lv lw fd ij"><div class="bz dy l di"><div class="nc nd l"/></div></figure><p id="cc7b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> k均值迭代</strong></p><p id="30ae" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">k-means算法需要用户输入要生成多少个聚类，由k参数表示。除非对特定数量的集群有特定的业务需求，否则很难确定集群的数量。</p><p id="1b66" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">肘形图是根据数据确定最佳聚类数的一种方法。为此，我们遍历数据并为从2开始的不同数量的k生成聚类。k-means算法给出了每个数据点距离其所分配聚类的质心的平方距离的总和，称为<em class="lr">惯性得分</em>。然后，我们绘制每次迭代的惯性分数与k值的关系图。生成的图形一般有一个<em class="lr">弯头</em>形状，因此得名<em class="lr">弯头图</em>。</p><blockquote class="lx ly lz"><p id="867e" class="iv iw lr ix b iy iz ja jb jc jd je jf ma jh ji jj mb jl jm jn mc jp jq jr js hb bi translated">肘点代表k值，超过该值，通过增加k值实现的惯性减小可以忽略不计，因此在该点停止是最佳的。</p></blockquote><p id="df13" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将遍历我们的特征数据集，并在[2，20]中获得k的惯性分数。</p><figure class="lt lu lv lw fd ij"><div class="bz dy l di"><div class="nc nd l"/></div></figure><p id="e42b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">弯头图</strong>:</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ne"><img src="../Images/6e2042309344e18bed179dcd0caf8d6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ppOqM7QPsBHmmqtR-_-YSA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">肘图</figcaption></figure><p id="6ab0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们在这里没有非常明显的肘点，并且<strong class="ix hj">通常明显的肘很少出现在实际数据中</strong>。从上图可以看出，k的最佳值可以在4-6左右，因为惯性持续急剧下降，至少直到k=4。</p><p id="6f9d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以使用<a class="ae iu" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.silhouette_score.html" rel="noopener ugc nofollow" target="_blank">剪影分数</a>，这是另一个聚类质量度量，在4–6中选择最佳k。我们也可以在这里获取业务输入，以确定k的实际值是多少。</p><p id="d4e4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一旦我们确定了k的值，我们就生成最终的聚类对象，并保存它用于评分过程。我们还将获得所有记录的分类标签并保存它。</p><figure class="lt lu lv lw fd ij"><div class="bz dy l di"><div class="nc nd l"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">最终聚类迭代</figcaption></figure></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><h1 id="f3ff" class="ko kp hi bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">压型</h1><p id="7889" class="pw-post-body-paragraph iv iw hi ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">剖析是聚类练习中最重要的部分，因为它帮助我们理解客户行为方面的聚类实际上是什么，并以业务可用的方式定义它们。</p><h2 id="2517" class="mm kp hi bd kq mn mo mp ku mq mr ms ky jg mt mu lc jk mv mw lg jo mx my lk mz bi translated">集群级数据摘要</h2><p id="9d98" class="pw-post-body-paragraph iv iw hi ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">为了帮助进行集群分析，我们将使用pandas <em class="lr"> describe() </em>方法。您还可以使用其他方法来帮助总结所有集群的所有特性，并确定每个集群的配置文件。可视化工具(如Tableau)也可以用于此目的，方法是加载带标签的聚类输出。</p><p id="912e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="lr"> describe() </em>方法可直接用于获取数据集所有特征的总体级别摘要。然后，它可以与<em class="lr"> groupby() </em>一起使用，以获得每个聚类的所有特征的摘要。</p><figure class="lt lu lv lw fd ij"><div class="bz dy l di"><div class="nc nd l"/></div></figure><p id="31d2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将这两者结合在一起，我们可以了解每个特性在集群中是如何变化的，以及它在总体级别上是如何表现的。这将有助于我们得出集群之间以及集群与普通客户之间有何不同的结论。</p><p id="df7e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">请注意，<em class="lr">平均值</em> / <em class="lr">中位数</em>是集中趋势的良好衡量标准，有助于轻松比较多个组，但它们并不是完整的情况。<em class="lr"> describe() </em>方法给出了所有特性的所有主要分布点，我们可以调整上面的代码，不仅可以比较<em class="lr">平均值</em> / <em class="lr">中值</em>，还可以比较特性在集群中的整体分布。通过绘制按聚类划分的每个特征的直方图，也可以更好地分析这些特征。</p><p id="24e3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们已经有了包含所有集群的所有特性的数据框架，我们可以将其导出到Excel并进行分析。下面是使用色标测量特征可变性的Excel分析的快照。</p><figure class="lt lu lv lw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nf"><img src="../Images/b1d80549dd944171e19f0fbdf6d9fc1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5zapjVuOVCbpkZPu_wBA8Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">使用Excel中的色标来分析聚类之间的可变性</figcaption></figure><p id="6a9c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">聚类1/3/5都是高销售额，聚类0/2/4都是低销售额。尽管通常认为大量客户只会购买一两个类别的产品，但在各个类别中看到的产品份额并没有太大变化。</p><p id="73f8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">上面使用的数据除了电子邮件订阅和omni购物者标志以及1/3/5和0/2/4之间的高低分割之外，没有任何强有力的区分标志。</p><p id="6240" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在真实数据中，您可以拥有诸如<em class="lr">高价值购物者</em>、<em class="lr">低频率购物者</em>之类的集群，或者显示出对单一产品类别的亲和力的集群:<em class="lr">B类购物者</em>等。</p><p id="aa2d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">注意:如果概要文件不令人满意，您也可以返回并更改集群的数量。</p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><h1 id="7690" class="ko kp hi bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">得分</h1><p id="d858" class="pw-post-body-paragraph iv iw hi ix b iy lm ja jb jc ln je jf jg lo ji jj jk lp jm jn jo lq jq jr js hb bi translated">现在我们已经完成了这个练习，并且已经描述和了解了客户的样子，我们可能想要了解我们的新客户的样子，或者现有客户在继续与我们一起购物的过程中会发生怎样的变化。</p><p id="ddc5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为此，我们将设置一个评分流程，该流程将获取最新的交易数据，并根据上述分析为客户分配聚类id。</p><p id="26d2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我将评分部分分为两步:<strong class="ix hj">特征生成</strong>和<strong class="ix hj">聚类分配</strong>。已经生成了两个python脚本，<a class="ae iu" href="https://github.com/patilvijay23/MLinPython/tree/main/scripts" rel="noopener ugc nofollow" target="_blank">上传到git这里</a>可以作为参考。</p><p id="0011" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">总体而言，该流程应:</p><ol class=""><li id="d79a" class="jt ju hi ix b iy iz jc jd jg jv jk jw jo jx js nb jz ka kb bi translated">获取最新交易数据</li><li id="b7c7" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js nb jz ka kb bi translated">生成我们在本练习前面生成的聚类功能</li><li id="430b" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js nb jz ka kb bi translated">使用保存的模型对象缩放要素数据集，然后为其分配聚类标签，以及</li><li id="9a59" class="jt ju hi ix b iy kc jc kd jg ke jk kf jo kg js nb jz ka kb bi translated">将集群标签保存回数据库，以用于报告和监控目的。</li></ol><p id="c506" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">评分代码是python脚本，而不是Jupyter笔记本，因为使用脚本来设置生产流程(如对交易数据评分以分配聚类)会更容易、更好。</p><p id="e9b5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">随着时间的推移，客户群的行为可能会发生变化，新的客户活动子群体可能会出现</strong>。这可能是由于产品供应的变化、经营方式的变化(如应用程序或网站的重新设计)、业务目标受众的变化，或者是由于市场格局的总体变化。此时，我们可能需要重新进行聚类分析，以了解新的客户子群体及其概况。</p></div><div class="ab cl kh ki gp kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="hb hc hd he hf"><p id="9f5a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢您阅读这篇文章。如果您有任何问题或任何意见，请通过评论联系我。</p><p id="c2ce" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以在<a class="ae iu" href="https://github.com/patilvijay23/MLinPython" rel="noopener ugc nofollow" target="_blank">我的git repo这里</a>找到更多python相关的参考资料。</p></div></div>    
</body>
</html>