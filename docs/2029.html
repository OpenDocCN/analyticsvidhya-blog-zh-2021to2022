<html>
<head>
<title>Discussing a novel approach for the loss of Super-Resolution</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">讨论了一种新的超分辨率损失方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/discussing-a-novel-approach-for-the-loss-of-super-resolution-b76b77311093?source=collection_archive---------12-----------------------#2021-04-01">https://medium.com/analytics-vidhya/discussing-a-novel-approach-for-the-loss-of-super-resolution-b76b77311093?source=collection_archive---------12-----------------------#2021-04-01</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="1ba7" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">当前SR的问题</h1><p id="42af" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">正如我在<a class="ae ka" rel="noopener" href="/analytics-vidhya/possible-issues-of-the-loss-for-deep-learning-based-super-resolution-649c5bd79635">上一篇文章</a>中所讨论的，测量SR的当前损失函数:HR和SR之间的MSE损失，对抗性训练，感知损失存在一些问题，并且不是该模型必须实现的最佳感知质量的基本目标。我们将简要总结目前在测量SR质量中使用的损失的问题，并提出我对如何改进这些方法的想法。</p><p id="4b94" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">我想指出的是，这些是我个人的观察和看法，<em class="kg">不是研究者的共识</em>。有些论点，尤其是第三点可能会有争议。问题如下。</p><ol class=""><li id="1803" class="kh ki hh je b jf kb jj kc jn kj jr kk jv kl jz km kn ko kp bi translated">因为LR-&gt;SR映射不是一对一的函数，所以模型必须能够输出具有随机变化的多个图像。换句话说，SR问题有多个答案。</li><li id="42c8" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">与第一个问题相关，基于MSE的内容损失不接受图像纹理中的随机变化，并且仅仅因为它具有像素方面的变化就惩罚高质量图像。因此，基于MSE的解决方案经常导致过度平滑的图像。</li><li id="cff5" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">为解决第二个问题(如VGG损失和对抗性损失)而提出的感知度量不是SR的基本度量。VGG损失似乎是一种杂项技术，对抗性训练继承了许多问题，并且非常不稳定和不收敛。这两种方法都不能单独发挥作用，只能通过混合损失来发挥作用。</li></ol><p id="ae3e" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">尽管最近的随机共振模型表现很好，而且某些点在实际应用中可能不太重要，但我认为目前的随机共振损失公式是不完整的“把戏”。</p><h1 id="5fe1" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">什么是超分辨率？</h1><p id="0f9c" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我问了自己一个最基本的问题“什么是SR？”。如多篇文章所述，SR旨在学习下采样的反函数。然后，我画了下面的图表，并考虑了我们如何奖励模型预测HR图像流形上存在的每一个天蓝色预测。MSE度量的问题是，该模型并不关心SR图像是否看起来是HR，而是只考虑像素方向的距离(见第二张图)。</p><p id="1d10" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">基于对抗学习的方法旨在通过用鉴别器学习空间并基于鉴别器的测量惩罚生成器来学习绿色HR流形。如果鉴别器成功地学习了HR空间，那么生成器一定成功地生成了似是而非的图像，但我相信这是通过权重混合来干扰的，鉴别器在学习HR流形上完全失败。很难做出一个完整的结论，但我会诊断ESPCN的鉴别者是否了解了真实的HR空间，并且没有过度适应另一篇帖子中的训练数据。</p><div class="kv kw kx ky fd ab cb"><figure class="kz la lb lc ld le lf paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><img src="../Images/799a0e7ad6e32dc046e428321e02c9dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*VrZpXMYz6ufMw5t8kC7Luw.png"/></div></figure><figure class="kz la lm lc ld le lf paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><img src="../Images/5bd13878465c9d5956ffdd1d6d8119e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*xa7D6T0N_6U3CDkgL_V_ag.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx lr di ls lt translated">基于解决方案的SR问题和MSE问题</figcaption></figure></div><h1 id="193a" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">在下采样空间比较图像</h1><p id="c97f" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我想到了在下采样空间中比较HR和SR的想法，而不是直接测量距离。所以，我们用MSE(LR，双三次(G(LR))代替MSE(HR，G(LR))作为损失。下图对此进行了说明。</p><figure class="kv kw kx ky fd la er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lu"><img src="../Images/a6e25e5d7615a5f45801f48ee5eac6d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b49iGvekOE31SWEQtWHoJw.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">方法的说明。上图是正规的SR管道，下面是我的想法。</figcaption></figure><p id="48af" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">这样，只有当图像不在给定LR图像的HR对应物的真实流形上时，损失才会惩罚模型。这样，我们可以在没有对抗性训练的情况下学习HR空间，至少在理论上是这样。通过额外的修改，我相信我们可以直接学习感知愉悦的图像。</p><figure class="kv kw kx ky fd la er es paragraph-image"><div class="er es lv"><img src="../Images/4b1e88d64690e81992fdc856ed44769c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*zmaBnDfEiGAnJzXFKPBqaA.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">我失去方法的例证</figcaption></figure><h1 id="4cc9" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">履行</h1><p id="4034" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我根据这个损失建议训练了4x ESRGAN模型。可悲的是，结果非常人为和怪异。结果如下。每列代表HR、SR、双三次插值图像。</p><figure class="kv kw kx ky fd la er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lw"><img src="../Images/eba9e77a1c0a5f6113071216e2604d86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gyZUm7QIqFQmqOVEdGQ9EQ.png"/></div></div></figure><figure class="kv kw kx ky fd la er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lw"><img src="../Images/16c5ac3d3198ee47ec7bdef0c0924d9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FFIpKsHngfm1-THk9KhB-g.png"/></div></div></figure><figure class="kv kw kx ky fd la er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lw"><img src="../Images/2d39b677be588f14d220005b3da19d5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uRgsMY3HOgnM6HoHd-o-Kg.png"/></div></div></figure><div class="kv kw kx ky fd ab cb"><figure class="kz la lx lc ld le lf paragraph-image"><img src="../Images/b4c1dfdbc26d78cf8e02fed33250a98a.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*iVfgfm04Im4GUqPyFC_jdQ.png"/></figure><figure class="kz la lx lc ld le lf paragraph-image"><img src="../Images/c4f6fb8b233898cd71c990077fc0b492.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*0w_5WCjPeAqxeOGoEv9uNA.png"/><figcaption class="ln lo et er es lp lq bd b be z dx ly di lz lt translated">来自重建的“婴儿”图像的图像补片。</figcaption></figure></div><p id="50da" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">一开始我以为是因为LR高或者其他问题导致训练崩溃。但是该模型实际上学会了利用这种损失，并且学会了在不输出预期的SR图像的同时最小化损失。这可能是显而易见的，我也预料到这个问题，但结果非常极端。我认为来自一个LR图像的可能的HR图像的潜在空间非常大，并且必须实施一些额外的机制来加强来自可能的HR流形的“真实的”HR补丁。</p><p id="c304" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">下图显示了以4倍缩减采样的噪声图像。它们非常精确，我们可以发现该模型在输出不令人满意的超分辨率图像的同时使损失最小化。</p><figure class="kv kw kx ky fd la er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lw"><img src="../Images/8876cf471f18bb1544d71a587513e92d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ut2zwsOKVzyc__GHxcm0XA.png"/></div></div></figure><figure class="kv kw kx ky fd la er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lw"><img src="../Images/a5608c9a7ac834fdbd99aa570ffc2b6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nSpeV38nQCtUYLny1XWoLw.png"/></div></div></figure><figure class="kv kw kx ky fd la er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lw"><img src="../Images/374c9b2cdb657b59fea0609094caaeae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oZJ5iaaX6TccKzLTqyDNKg.png"/></div></div></figure><h1 id="7129" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">改进的方法</h1><p id="8867" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">改进这种方法的一个方法似乎是增加对抗性训练。在之前的内容损失+对抗性损失的混合中，内容损失与对抗性损失是对立的，我们必须在两种损失之间做出权衡。将我们的损失与对抗损失混合可以将两种损失一起最小化，因为我们的损失不会惩罚模型，除非重建图像在HR流形之外，这对于对抗损失是可承受的，并且可以限制GAN伪影。</p><p id="ef15" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">此外，我们可以使用其他上采样方法来代替ESPCN，例如预上采样和去卷积(转置卷积)。ESPCN平铺分离通道，这对于常规MSE损耗来说不是问题，但在我们的情况下可能是一个严重的问题，因为模型更容易利用损耗并分离通道的输出，因为我们的损耗仅在组合尺度中测量。</p><p id="862a" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">我感谢对我的方法和论点的批评，因为我想听听你的意见，并通过你的意见改进我的想法。</p></div></div>    
</body>
</html>