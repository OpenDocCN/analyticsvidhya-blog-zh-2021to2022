<html>
<head>
<title>CNNs for Image Classification, pt. 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图像分类的细胞神经网络。2</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/cnns-for-image-classification-pt-2-cb44b5f19708?source=collection_archive---------6-----------------------#2021-07-02">https://medium.com/analytics-vidhya/cnns-for-image-classification-pt-2-cb44b5f19708?source=collection_archive---------6-----------------------#2021-07-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="2bb7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">卷积神经网络是使用机器学习自动进行图像分类的伟大工具。在这个项目中，我使用CNN试图根据游戏图像来确定一个视频游戏的ESRB等级。为了开始训练模型，我需要大量的图像。这个过程在<a class="ae jc" href="https://carlbcook.medium.com/cnns-for-image-classification-pt-1-fea2ed56a720" rel="noopener">第一部分</a>中有详细描述，所以如果你想快速浏览一下这个过程，就去读一读吧。</p><p id="5661" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦图像被保存并分成训练集、验证集和测试集，就该为建模准备数据了。为此，我使用了Keras的ImageDataGenerator。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div></figure><p id="b236" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如您所见，训练数据的生成器对随机图像进行了一些细微的修改，以帮助提高泛化能力。默认的批量大小是32，这对我很有效，但是如果您遇到内存不足的问题，您可以降低批量大小，使您的机器更易于管理培训。这将增加每个纪元中的步数，但是因为每个步包含的例子较少，所以不会对你的训练时间有很大的影响。</p><p id="1a79" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可以使用matplotlib来窥视一批训练数据。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jk"><img src="../Images/da96a53ffb59ca9d18e0a78ec676d5b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*crMceBiMkc7LjirjLuz6Pg.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated">来自训练集的一批图像</figcaption></figure><p id="c1a6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">看着这一批图像，我很难找到可靠的一目了然的方法来确定游戏的评级。下一步是组建一个CNN，看看它能否找到对我来说不太明显的模式。</p><p id="0ca1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有几个预先训练好的CNN架构可供使用，但如果你想从头开始组装一个，并不太难。我建立的模型如下所示。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div></figure><p id="2a6b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因为这是一个4级分类，模型的最后一个密集层有4个节点和“softmax”激活。我将学习率调了回来，因为我发现模型通常只预测一个具有默认学习率的班级。<code class="du jv jw jx jy b">model.summary()</code>方法显示了模型的架构。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jz"><img src="../Images/6edbe965427f936f304dfc74f88941a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*AZ2oPnhF9rjrToKpp7I_3A.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">模型架构</figcaption></figure><p id="ff43" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我已经定义了我的卷积神经网络并对其进行了编译，是时候传入图像数据来训练它了。使用返回历史对象的<code class="du jv jw jx jy b">model.fit()</code>方法训练模型。<code class="du jv jw jx jy b">History.history</code>属性详述了模型在每个训练时期的进展，每个时期是训练数据的一次完整传递。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div></figure><p id="b01e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦模型完成了训练(这可能需要相当长的时间)，您可以使用<code class="du jv jw jx jy b">model.evaluate()</code>方法来查看模型在您的测试数据上表现如何。只需传入测试数据生成器，模型就会运行所有的测试图像，并向您显示您选择的指标。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ka"><img src="../Images/6fbe28f2878d704046f6bb3f29fa754b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BzLb4ra6WetnuimJW5eU6w.png"/></div></div></figure><p id="d3a4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该模型在训练集上达到了47%的总体准确率。虽然这肯定不是一个令人印象深刻的数字，但这比随机猜测要好。然而，对于这个问题，我真正关注的是M级游戏的召回率。如果目标是标记成熟的内容，我想要一个能有效发现M级游戏的模型。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kb"><img src="../Images/8799dfe97886e7463f0f33d8ea27db23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*9DVJLKV8fWdU4uXrTaAJ6A.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">sklearn分类报告</figcaption></figure><p id="c30c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用来自sklearn的分类报告，我可以看到这个模型在M级游戏上达到了59%的召回率。这意味着该模型能够正确标记大多数M级游戏。它并不完美，肯定需要一些实验和调整，但是我们必须把它留到以后。</p><p id="f3d7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在“用于图像分类的CNN”的下一次迭代中，我们将尝试不同的方法来解决这个问题，看看我们是否可以提高召回率。</p></div></div>    
</body>
</html>