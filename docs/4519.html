<html>
<head>
<title>Data Augmentation for Tabular Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">表格数据的数据扩充</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-augmentation-for-tabular-data-f75c94398c3e?source=collection_archive---------0-----------------------#2021-11-07">https://medium.com/analytics-vidhya/data-augmentation-for-tabular-data-f75c94398c3e?source=collection_archive---------0-----------------------#2021-11-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/5c40f4f75a7f93e4bbf9e0bcc22f51bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dcbdcCTbExjKNg_g"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">JOSHUA COLEMAN 在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="9d6c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为什么以及如何使用深度学习在表格数据上创建数据增强的主要思想在<a class="ae iu" rel="noopener" href="/analytics-vidhya/tabular-data-augmentation-with-deep-learning-7270584e7ff">我之前关于这个主题的博客</a>中有所描述。从那以后过了相当一段时间，我决定重写代码，以便更容易使用。在这篇博文中，我想向你展示如何使用这种新方法，它对于你想要使用的模型有多灵活，以及你如何使用你自己的定制回调来更好地了解模型在后台做了什么。其中一些功能我已经内置了，下面是如何使用它们。</p><p id="a761" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">同样，我们使用来自kaggle的信用卡欺诈数据集。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jz"><img src="../Images/e8a03541ed5cd6b044dbc4a554b3e9de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UYHyuRmcCG_rd4ts_1-YJA.png"/></div></div></figure><p id="7141" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">deep_tabular_augmentation的工作原理很简单，即我们希望将数据与模型一起保存在一个专用的类中(我们称之为学习者)。数据必须以dataloader对象的形式出现，我将它存储在DataBunch类中。其中有用于训练和测试数据的数据加载器。然后，runner类定义流。</p><p id="1a9a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们首先扩展数据，只保留我们想要扩充的类的数据:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ka"><img src="../Images/d685a443be134f8b3cb21edcfb2626c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qVtokLjVSODVa5JO0J0QNw.png"/></div></div></figure><p id="60b7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如前所述，然后我将train和testloader放入一个名为DataBunch的类中，它只是一个数据容器。您可以轻松地创建自己的数据加载器，并将它们放在数据集中。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="b551" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了使用deep_data_augmentation，我们需要指定输入形状(基本上就是数据集中有多少变量)、我们想要扩充的目标类的列名和相应的数字，最后是输入变量的列名。</p><p id="98a7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，文可以定义我们想要的任何模型架构。我们只是将它作为一个列表传递给模型。我们还可以定义多少潜在维度，我们想添加到我们的自动编码器。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="5ccb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，runner类为我们提供数据流，并让我们添加回调。其中一个内置的Classbacks是一个学习率查找器，您可以这样使用它:</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kb"><img src="../Images/23817fa0bbd85ca636afde20df36ed3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cGAyJ_ZvJKWIxJ6I2Mwvfw.png"/></div></div></figure><p id="aff1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们也可以使用回调来创建一个学习率调度器。这里有一个例子:使用30%的预算从0.01到0.1，遵循余弦，然后最后70%的预算从0.1到0.01，仍然遵循余弦。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="523c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们可以训练我们的自动编码器。我们希望跟踪损失，我们希望能够绘制一些损失图，我们希望添加我们的学习率计划:</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es kc"><img src="../Images/549d729d775a9527e7ff0373aa0a9ac3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*WXZD-ElveXI-5TKt1mJ41A.png"/></div></figure><p id="541a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以看看训练损失:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ka"><img src="../Images/dc874bddb211fabc01d546dcc1e83d7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y1yDU-kf16QkRGGrMTg_rQ.png"/></div></div></figure><p id="0219" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以及各个时期的学习率:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kb"><img src="../Images/c1b34ce0cd2290077e1bbe58908417a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*medi2MgEFWrVD_5aH5b0bA.png"/></div></div></figure><p id="1aee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">您可以创建您想要的任何类型的回调，并将其传递给培训。在runner中，我创建了一些钩子，在这些钩子之后你可以直接链接你的回调函数，例如<em class="kd"> begin_batch </em>，<em class="kd"> begin_epoch </em>，<em class="kd"> after_pred </em>，<em class="kd"> after_fit </em>等等。当您创建回调函数时，您可以直接引用这些函数来确定回调函数应该在哪里执行特定的任务。这是LossTracker的样子:</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="9348" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当开始训练时，我从一个空单开始，在每一批之后，我加上损失。在每个时期之后，我打印损失。</p><p id="1685" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此外，跑步者还为您提供了通过训练模型创建增强数据的可能性。您可以指定想要多少指定类的样本，还可以添加一些噪声，我发现这可以为以后的使用创建更好的输入。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ke"><img src="../Images/0b42304131497724679c9ef571975d7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1QWYc08uINJsOsgRk2umsA.png"/></div></div></figure><p id="1b8b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们看看我们的模型在复制欺诈案例时表现如何。首先，我们在非欺诈案例中绘制V1与V2的对比图，然后我们在欺诈案例中绘制同样的图:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kf"><img src="../Images/68e8458dd3f64825b232f8af4dabd7e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m1WkHQDhlhvk5lK67WLfQQ.png"/></div></div></figure><p id="2a7a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">他们看起来很不一样。让我们看看我们的假数据是如何做到的:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ka"><img src="../Images/ee8dcaf70b1cb2c721d94dc34709986f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0wqMRURM-Z8hsimcRylt6Q.png"/></div></div></figure><p id="48f1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这看起来真的很神奇。如果你有任何问题或者想在包裹里添加什么，就问我。</p><p id="4bd1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">拉塞</p></div><div class="ab cl kg kh gp ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="hb hc hd he hf"><p id="3153" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="kd">原载于2021年11月07日</em><a class="ae iu" href="https://lschmiddey.github.io/fastpages_/2021/04/10/DeepLearning_TabularDataAugmentation.html" rel="noopener ugc nofollow" target="_blank"><em class="kd">https://lschmiddey . github . io</em></a><em class="kd">。</em></p></div></div>    
</body>
</html>