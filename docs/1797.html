<html>
<head>
<title>Let’s clear the confusion</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让我们消除困惑</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/lets-clear-the-confusion-9b049e2562df?source=collection_archive---------13-----------------------#2021-03-18">https://medium.com/analytics-vidhya/lets-clear-the-confusion-9b049e2562df?source=collection_archive---------13-----------------------#2021-03-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="dd6d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">评估模型的性能在最终确定模型或决定它是否适合在生产环境中部署时起着至关重要的作用。我们有很多方法来评估绩效，但其中混淆矩阵和ROC曲线是广泛选择的指标。</p><p id="960c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这可能是因为它的名字或者初学者对它的理解方式，不知何故混淆矩阵看起来很混乱，不容易记在心里。在本文中，让我们通过一个简单的例子来理解混淆矩阵。</p><p id="00a1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们考虑一下，我们手头有一个分类任务，在这个任务中，我们必须从既有圆又有正方形的组中找出正方形。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/dce41a9061e30f94ef0920f9ca734d61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6q37xosWGANVCTSN6FhwKg.png"/></div></div></figure><p id="196d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面的例子中，我们总共有十五个物体，其中九个是正方形，六个是圆形。如果我们必须手动识别方块，或多或少我们会达到百分之百的准确率。但是如果我们想让机器来完成这项任务，除非训练有素，否则很难达到百分之百的准确率。我们可以假设机器是一个刚刚开始识别物体的稚嫩婴儿，我们对这个婴儿训练得越多，它识别得就越好。</p><p id="da3d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，当我们让机器挑选所有的方块并把它们放入一个新的容器中时，假设它给出了下面的结果。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jo"><img src="../Images/91d6e95fe46c2366f0a54f5f8b65d958.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gBTNUaa_SrrBBtKDGgktDw.jpeg"/></div></div></figure><p id="0390" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，我们可以看到，在九个方块中，机器只选择了六个方块，其他三个是圆。如果有人问，我们的机器做得怎么样，这将很难决定是在挑选出的商品中集中精力挑选不想要的商品，还是在被排除的商品集中精力挑选想要的商品。混乱矩阵的作用来了。</p><p id="bba9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">混淆矩阵只是一个帮助我们描述模型性能的表格。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jp"><img src="../Images/7086b67318e3e9d3e2e761d595d9d951.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vbfuOkRGdcNkUXp8uEi4BA.png"/></div></div></figure><p id="1465" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一般来说，我们在基于X_test数据预测目标标签后绘制混淆矩阵。因为我们知道实际的Y_Test，所以我们可以比较实际的Y_test和预测的Y _ Test。</p><p id="f573" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们试着用上面的正方形和圆形数据集来理解这个术语。</p><p id="3b4e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">真阳性(TP):挑选的方块中有多少是真正的方块？</p><p id="27ab" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">误报(FP):被拾取的方块中有多少不是方块？</p><p id="9fc4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">假阴性(FN):有多少实际的方块没有被选取？</p><p id="5af0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">真底片(TN):有多少非正方形(圆形)没有被挑中？</p><p id="425b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我们回答以上问题，我们的混淆矩阵看起来如下。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jq"><img src="../Images/eaec449f0b22cc8830d2521191c4532a.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*6uVmcyd3v0frY7N4WRQjMQ.jpeg"/></div></figure><p id="1598" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，让我们看看什么是灵敏度和精度。</p><p id="1259" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">敏感度也称为回忆，它表示正确分类的阳性结果在所有阳性结果中所占的比例。在我们的例子中，它将是从可用方块总数中挑选的方块总数。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jr"><img src="../Images/d91cfc3776cbe311d0a203ef2b57b640.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*1BGUiZYG3O_LLR5AX73zZA.jpeg"/></div></figure><p id="6644" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，如果我们将我们的值代入这个公式，我们会看到灵敏度为6/9，也就是2/3。</p><p id="4cc0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">精确度是关于所有预测中真正肯定的比例。在我们的例子中，它是在所有被选择的物品中被选择的方块总数。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es js"><img src="../Images/ce7ab8cbe0942bea5db10642dd7171e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*9n10K6FBv8F8YOoDyhDsjg.png"/></div></figure><p id="e580" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，如果我们插入这些值，我们会看到值6/9也是2/3。</p><p id="77a6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们总是希望敏感度和召回值更高，并且这些值在0和1之间。如果我们观察上面的等式，两者的分子都是真正值。唯一不同的是分母的第二部分，第一种情况下是假阴性，第二种情况下是假阳性。这些值越小，我们模型的性能越好。一旦我们绘制了混淆矩阵，我们的下一个工作将是看看是否有一种方法来减少假阳性和假阴性值，也称为类型1和类型2错误。</p><p id="699a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我们考虑癌症患者的分类任务。</p><p id="33e6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">类型1错误:将癌症患者预测为非癌症患者。</p><p id="a48f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第二类错误:将非癌症患者预测为癌症患者。</p><p id="9037" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这种情况下，直觉上感觉与癌症患者一样危险的1型错误被宣布为非癌症，这是一种生命风险。另一方面，2型错误没有那么有害，因为非癌症患者可以接受进一步的诊断，并有机会通过人工检查被宣布为非癌症。因此，我们的议程将是在处理与诊断相关的病例时减少1型错误。</p><p id="f0ea" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">到目前为止，我们已经讨论了混淆矩阵，现在让我们跳到ROC曲线上。<strong class="ig hi">受试者操作者特征(ROC) </strong>曲线是二元分类问题的评价尺度。让我们知道分类问题中的理想阈值是它的核心优势。</p><p id="34e2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们考虑逻辑回归，我们知道在逻辑回归中，我们基于选择的阈值进行预测。阈值可以是0到1之间的任何值。因此，对于选择的每个阈值，我们必须绘制出许多混淆矩阵，并选择更好的阈值。这个过程看起来很繁琐。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jt"><img src="../Images/385f5bbd25eecf8fb623a4178a83257a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bCCcQhMjHGaI89i-7i3xFw.png"/></div></div></figure><p id="2fa4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，ROC图提供了一种简单的方法来可视化多个阈值的所有信息，而不是被混乱矩阵淹没。</p><p id="f9a2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在ROC图中，我们选择灵敏度(TPR)作为Y轴，假阳性率(FPR)作为X轴。在每个阈值，我们需要通过插入TP、FP、TN、FN的值来计算TPR和FPR的值</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ju"><img src="../Images/e5725de410808131596d490ad56e4b0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*gNlV2TQ70-FkpdcslpXsFA.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">假阳性率</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jz"><img src="../Images/b6352500be2d02a89d793c0a57e07275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*hVHPEPtFMvjVCVlEs3Ib2Q.png"/></div></figure><p id="08e7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于我们知道FPR和TPR值介于0和1之间，在ROC图中，我们将有1个X轴单位和1个Y轴单位。这条绿线上的任何一点都表明，错误分类的比例与正确分类的比例相同，这意味着我们的模型只有50%的机会做出正确的预测。</p><p id="a50e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如上所述，我们的目标应该是减少1型和2型误差，这意味着我们必须选择比TPR值更小的FPR值。一旦我们绘制了多个阈值(如T1、T2、T3、T4、T5、T6)下的ROC图，该图如下所示。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ka"><img src="../Images/c5edc5198bf1bf25e620134568663e85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QIKmYew0C6Ij3vu-qghM-A.png"/></div></div></figure><p id="bc67" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里我们可以看到，对于阈值T1，与FPR相比，我们有更大的TPR值[接近1]。但对T2来说，TPR与T1相当，而T2的FPR比T1的FPR小。因此，如果我们必须在T1和T2之间选择一个阈值，我们会选择T2。</p><p id="cd52" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">类似地，对于阈值T3，我们看到，与T2的FPR相比，FPR显著降低，但是对于阈值T3，TPR值也降低了。同样，在T4，我们有FPR为零，这意味着假阳性值绝对为零，但是假阴性可能已经存在，因为它的TPR值小于1。</p><p id="6236" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，基于问题陈述，我们必须决定一个解决方案可以接受多少误报，基于此我们需要选择阈值。</p><p id="8852" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">既然知道了ROC，那就让我们来了解一下AUC(曲线下面积)。AUC帮助我们比较ROC曲线。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kb"><img src="../Images/6164b4e42faf9241b3adcfc515cea48b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*0saPw8Z-2fiHtqM68qKPdA.png"/></div></figure><p id="03d2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">比方说，我们使用两种不同的算法训练我们的模型，比如逻辑回归，用红色ROC表示，另一种算法是支持向量机(SVM ),用蓝色ROC表示。</p><p id="21ec" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我们必须决定哪种算法执行得好，我们必须选择AUC更大的ROC。在上面的例子中，红色ROC下面的面积大于蓝色ROC。因此，我们可以说逻辑回归非常适合这个特殊的案例研究。</p><p id="c5a1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">到此结束，希望这篇文章对你有所帮助。</p><p id="0452" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">来源:<a class="ae kc" href="https://statquest.org/roc-and-auc-in-r/" rel="noopener ugc nofollow" target="_blank">https://statquest.org/roc-and-auc-in-r/</a></p></div></div>    
</body>
</html>