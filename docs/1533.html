<html>
<head>
<title>Data Representation Techniques to Supercharge your ML model — Part I</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">增强ML模型的数据表示技术——第一部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-representation-techniques-to-supercharge-your-ml-model-part-i-9971138b4b4?source=collection_archive---------16-----------------------#2021-03-06">https://medium.com/analytics-vidhya/data-representation-techniques-to-supercharge-your-ml-model-part-i-9971138b4b4?source=collection_archive---------16-----------------------#2021-03-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="91a1" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">除了缩放和一键编码，如何进行功能工程</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/a97fe1e52426a72370be59f298ec91b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MxiwhSRCM65KLn4K"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">安妮·斯普拉特在<a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="ebeb" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">介绍</h1><p id="1b09" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">做一名数据科学家就像做一名工匠。你配备了一套工具，需要用简单的材料创造出既美观又实用的东西。你的一些工作可能由自动机械完成，但你知道你真正的力量是创造力和手工工作的复杂技能。</p><p id="89ba" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">在本系列中，我们将通过探索几种将数据表示为特性的方法来磨练您的技能。这些方法可以提高你的模型的可学性，尤其是当你手头有大量数据的时候。</p><h1 id="e729" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">特征交叉</h1><p id="7c75" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">假设您有以下模式的数据，其中横轴表示一个要素X₁，纵轴表示另一个要素X₂，每个实例(图中的点)只能属于-1或1组(由红色和绿色表示)。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es lg"><img src="../Images/0b011c79c6833c197dfaab5ccb5df9e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*UaUU0MdZHFMViEwUAWFQ7g.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">来源:jp.mathwork.com<a class="ae jm" href="https://jp.mathworks.com/help/stats/support-vector-machines-for-binary-classification.html" rel="noopener ugc nofollow" target="_blank"/></figcaption></figure><p id="d750" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">现在让我来挑战你，画一个线性边界来区分数据的不同类别。我敢打赌你不能，事实上这是一个非线性可分数据的例子。</p><p id="f2be" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">有几种方法可以处理这种数据，如使用固有的非线性分类模型，如决策树或复杂的神经网络。然而，我们可以使用一种简单的技术来使简单的线性分类器在这种数据上工作得非常好。</p><p id="98d5" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">诀窍是，首先，让我们根据图上显示的颜色将连续特征离散化为两个桶。对于X₁，让a表示它的正值，b表示它的负值。同样，设c表示X₂的正值，d表示X₂.的负值</p><p id="fcd2" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">然后，我们可以通过组合新创建的桶的所有可能组合来创建一个新的分类特征。</p><ul class=""><li id="a74c" class="lh li hh kh b ki lb kl lc ko lj ks lk kw ll la lm ln lo lp bi translated">AD = {X₁ &gt; 0，X₂ &lt; 0}</li><li id="c1e2" class="lh li hh kh b ki lq kl lr ko ls ks lt kw lu la lm ln lo lp bi translated">AC = {X₁ &gt; 0，X₂ &gt; 0</li><li id="641e" class="lh li hh kh b ki lq kl lr ko ls ks lt kw lu la lm ln lo lp bi translated">公元前={X₁ &lt; 0 and X₂ &gt; 0}</li><li id="b42c" class="lh li hh kh b ki lq kl lr ko ls ks lt kw lu la lm ln lo lp bi translated">BD ={X₁ &lt; 0 and X₂ &lt; 0}</li></ul><p id="1a88" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">With this brand new feature, we can now easily classify the class of an instance by only using simple binary classification.</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es lv"><img src="../Images/235baa361cd2c70290e66855e1153f8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/0*d5Y_hRW79U_ctBaA"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">the variables here are <a class="ae jm" href="https://en.wikipedia.org/wiki/Indicator_function" rel="noopener ugc nofollow" target="_blank">指示器功能</a>，其值为0或1</figcaption></figure><p id="202a" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">如果你足够仔细，你可以立即看到合适的权重集是标签本身(w₀ = -1，w₁ = 1，w₂ = 1，w₃ = -1)。</p><blockquote class="lw lx ly"><p id="4323" class="kf kg lz kh b ki lb ii kk kl lc il kn ma ld kq kr mb le ku kv mc lf ky kz la ha bi translated">我们刚刚做的转换是一个<strong class="kh hi">特征交叉的例子，其中我们将多个特征连接成一个新的</strong>，以帮助我们的模型更好地学习。</p></blockquote></div><div class="ab cl md me go mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ha hb hc hd he"><p id="570f" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated"><strong class="kh hi"> <em class="lz">“嗯，这是一个巧妙的诡计。但是，当我可以直接将数据输入到神经网络“</em>T5”时，为什么还要费心去做这种转换呢</strong></p><p id="3e67" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">是的，你完全正确。神经网络被广泛称为<a class="ae jm" href="https://en.wikipedia.org/wiki/Universal_approximation_theorem" rel="noopener ugc nofollow" target="_blank">通用函数逼近器</a>，因此它可以自动计算出在训练过程中需要执行哪种转换。</p><p id="968b" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">但是有一个原因可以解释为什么即使在使用神经网络时也应该考虑应用特征交叉。原因是它可以帮助模型学习得更快，有更好的表现。为了帮助你理解，让我给你看一个小实验。这里，我们将看到有和没有特征交叉的训练神经网络的比较。我会使用TensorFlow游乐场，你可以在这里<a class="ae jm" href="https://playground.tensorflow.org/#activation=tanh&amp;batchSize=10&amp;dataset=xor&amp;regDataset=reg-plane&amp;learningRate=0.03&amp;regularizationRate=0&amp;noise=0&amp;networkShape=4,2&amp;seed=0.55759&amp;showTestData=false&amp;discretize=false&amp;percTrainData=50&amp;x=true&amp;y=true&amp;xTimesY=false&amp;xSquared=false&amp;ySquared=false&amp;cosX=false&amp;sinX=false&amp;cosY=false&amp;sinY=false&amp;collectStats=false&amp;problem=classification&amp;initZero=false&amp;hideText=false" rel="noopener ugc nofollow" target="_blank">自己探索</a>。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mk"><img src="../Images/663a1a5956da0d058572c51530e0a0a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0FoBQC5zMRwEcj2m"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">神经网络的默认配置</figcaption></figure><p id="fa12" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">在这个实验中，我们有一个与之前使用的相似的数据集。通过将所有配置保留为默认，我们开始学习过程，并查看需要多少个历元来获得相当好的决策边界。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mk"><img src="../Images/377375904ce24d3ca4d872c069b734ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7XD0N-TTKPqI4ypA"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">建立决策边界需要大约350个历元</figcaption></figure><p id="bfad" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">正如你所看到的，我们需要超过300个历元来达到上面显示的决策边界。注意，由于神经网络的随机性质，历元的数量可能略有不同。</p><p id="5877" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">现在让我们用特征交叉进行训练。在此设置中，我们可以通过单击特性部分的X X特性来激活特性十字。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mk"><img src="../Images/67c888d7332cf2cdd685c01c9479fb74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qKnVLceOUcZY286M"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">它只需要14个历元来实现具有特征交叉的几乎完美的边界</figcaption></figure><p id="1912" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">在这里，不到15个历元就能让网络找到一个近乎完美的边界。比之前没有特征交叉的训练大约快<strong class="kh hi"> 20倍</strong>。同样，如果你足够注意，你可以看到之前训练的边界就像一个对角放置的沙漏。这种形式会导致在边界的某些角落对看不见的数据进行错误分类。与类似边界真实形式的第二次训练相反，它对分类看不见的数据没有问题。因此，具有特征交叉也可以产生具有更好性能的模型。</p></div><div class="ab cl md me go mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ha hb hc hd he"><p id="7a8e" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated"><strong class="kh hi"> <em class="lz">“好吧，我明白了，但我正在处理一个比你的棋盘二维数据集更复杂的现实世界的问题！”</em> </strong></p><p id="f438" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">嗯，交叉特征不仅适用于我之前展示的简单数据集。一般来说，当数据中的要素之间存在交互或依赖关系时，它会起作用。</p><p id="4dde" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">考虑一个任务，比如在给定一组特征(比如位置(纬度和经度)、房间数、楼层数等)的情况下预测房价。直觉上，我们知道位置在决定房子的价值时起着重要的作用。位于富人区附近的房子通常比位于贫民区附近的房子估价高。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ml"><img src="../Images/31a6b289a1dd28b99e13d54c6f8dddbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jWOc5iylKbWACfMQ"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">邻居插图(照片由<a class="ae jm" href="https://unsplash.com/@kaleamorgan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Kalea Morgan </a>在<a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄)</figcaption></figure><p id="8760" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">在这种情况下，经度和纬度以这样一种方式相互作用，即由经度和纬度的组合表示的不同的邻域可以具有影响房价的不同特征。</p><p id="8634" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">仅仅使用纬度和经度作为独立特征，我们会错过捕捉这种信号的机会。这是因为富人区和穷人区的分布不太可能是线性的。没有一个简单的模式像纬度或经度越高，社区就越富裕。</p><p id="40d8" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">使用特征交叉，我们可以通过将经度和纬度离散化为更小的块来创建虚拟网格，并将其所有可能的组合组合为一个新的特征。然后，如果我们幸运地有一个足够有代表性的数据集，我们可以通过这一新功能捕捉不同类别的社区景观。</p><p id="cc71" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">同样的逻辑也适用于很多情况。从在不同的时间和日期组合下具有不同模式的贩运，到可能随年龄和种族群体而变化的药物功效。只要有迹象表明不同的特性值组合会出现不同的行为，那么就值得在您的模型上尝试特性交叉。</p></div><div class="ab cl md me go mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ha hb hc hd he"><p id="9e02" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated"><strong class="kh hi"> <em class="lz">“看来很有前途，从现在开始我会试着在我所有的ML建模过程中使用这种技术”</em> </strong></p><p id="2cef" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">嗯，你可以，但正如一句老话所说，“没有免费的午餐！”，有一个警告你必须知道。</p><p id="13cf" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">如果您不够小心，拥有由特征交叉产生的特征可能会导致过度拟合。当我们的模型看到实际上不存在的模式时，这是一种现象。例如，在房价案例中，假设有一栋房子位于当地人都知道闹鬼的精英社区。有这样的声誉，房子的价格明显低于该地区的标准。如果这是您的数据所拥有的邻近区域中的唯一一所房屋，那么您的模型很有可能会选择该房屋作为邻近区域中其他房屋的参考。然后，你最终会得到一个低估该地区其他华丽豪华住宅价值的模型。</p><p id="d28f" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated"><strong class="kh hi"> <em class="lz">“嗯，那我该怎么做才能避免这个潜在的陷阱呢？”</em> </strong></p><p id="f4f2" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">首先，你必须非常确定你组合的特征有一种交互作用，就像我们讨论过的经度和纬度。正如我所说的，你可以从现实世界的观察中获得这种直觉，在现实世界中，你会看到两个特征的不同值组合会产生不同的行为或现象。或者，如果您正在处理的问题不是那么直观，您也可以通过<a class="ae jm" href="https://en.wikipedia.org/wiki/Exploratory_data_analysis" rel="noopener ugc nofollow" target="_blank"> EDA </a>获得信号。在这种情况下，针对目标变量绘制一对特征通常有助于检测特征之间的潜在交互形式。在统计学中，这种情节通常被称为<strong class="kh hi"> <em class="lz">交互情节</em>。</strong></p><p id="6694" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">确定铲斗的大小也很重要。你不希望有一个太好的铲斗，它只有几个我们已经看到的可能导致过度装配的实例。您也不希望有一个大的存储桶，将可能具有不同模式或行为的实例混合到目标值中。</p><p id="3662" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">为了找到合适的存储桶大小，我们可以将存储桶大小视为一个超参数，通过它可以使用验证数据进行调整。我们还可以应用某种类型的<a class="ae jm" href="https://en.wikipedia.org/wiki/Regularization_%28mathematics%29" rel="noopener ugc nofollow" target="_blank">正则化</a>来帮助我们的模型忽略由于我们的桶中实例不足而引入的噪声。</p></div><div class="ab cl md me go mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ha hb hc hd he"><h1 id="1252" class="jn jo hh bd jp jq mm js jt ju mn jw jx in mo io jz iq mp ir kb it mq iu kd ke bi translated"><strong class="ak">包装</strong></h1><p id="7a4f" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">在本文中，我们看到了特征交叉是提取数据中非线性关系的一种方法。我们还了解到，在建模过程中引入特征交叉之前，需要考虑一些因素。</p><p id="b947" class="pw-post-body-paragraph kf kg hh kh b ki lb ii kk kl lc il kn ko ld kq kr ks le ku kv kw lf ky kz la ha bi translated">在本系列的第二部分中，我们将探索如何使用<strong class="kh hi">嵌入</strong>在较低维度中表示高基数数据，如文本和图像。所以，敬请期待！</p></div></div>    
</body>
</html>