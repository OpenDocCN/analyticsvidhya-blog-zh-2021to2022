<html>
<head>
<title>CaseStudy-TGS Salt Identification Challenge</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">案例研究-TGS盐鉴定挑战</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/casestudy-tgs-salt-identification-challenge-352435842c5c?source=collection_archive---------9-----------------------#2021-01-07">https://medium.com/analytics-vidhya/casestudy-tgs-salt-identification-challenge-352435842c5c?source=collection_archive---------9-----------------------#2021-01-07</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/615f476f1701a23516ebdb4fedfebe72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tIxuHDTKpsuTdpNAkoPk8w.jpeg"/></div></div></figure><p id="6465" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">目录:</strong></p><ol class=""><li id="f733" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated"><em class="jw">简介</em></li><li id="4a4b" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm js jt ju jv bi translated"><em class="jw">商业问题</em></li><li id="f002" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm js jt ju jv bi translated"><em class="jw"> ML问题映射&amp;指标</em></li><li id="71ad" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm js jt ju jv bi translated"><em class="jw">数据描述</em></li><li id="936b" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm js jt ju jv bi translated"><em class="jw">现有方法</em></li><li id="bd1e" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm js jt ju jv bi translated"><em class="jw">第一次切割解决方案</em></li><li id="154b" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm js jt ju jv bi translated"><em class="jw">探索性数据分析</em></li><li id="e446" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm js jt ju jv bi translated"><em class="jw">先决条件</em></li><li id="fa42" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm js jt ju jv bi translated"><em class="jw">型号说明</em></li><li id="2c93" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm js jt ju jv bi translated"><em class="jw">结果&amp;部署</em></li><li id="08a6" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm js jt ju jv bi translated"><em class="jw">未来工作</em></li><li id="f3bc" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm js jt ju jv bi translated"><em class="jw">简介</em></li><li id="1781" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm js jt ju jv bi translated"><em class="jw">参考文献</em></li></ol><blockquote class="kc kd ke"><p id="57c5" class="ip iq jw ir b is it iu iv iw ix iy iz kf jb jc jd kg jf jg jh kh jj jk jl jm ha bi translated"><strong class="ir hi"> 1。简介</strong></p></blockquote><p id="5e59" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下面是一个<a class="ae ki" href="https://www.kaggle.com/c/tgs-salt-identification-challenge" rel="noopener ugc nofollow" target="_blank"> kaggle问题</a>的案例分析。该解决方案将在5小时内提供排行榜前6%的免费colab gpu，代码是用Pytorch编写的。引用代码的Colab笔记本。</p><blockquote class="kc kd ke"><p id="7735" class="ip iq jw ir b is it iu iv iw ix iy iz kf jb jc jd kg jf jg jh kh jj jk jl jm ha bi translated"><strong class="ir hi"> 2。商业问题</strong></p></blockquote><p id="554e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">建立一个模型，在给定地震图像输入的情况下，该模型预测每个像素为盐或无盐。</p><blockquote class="kj"><p id="5dd5" class="kk kl hh bd km kn ko kp kq kr ks jm dx translated">对自动化的需求？</p></blockquote><p id="1cb0" class="pw-post-body-paragraph ip iq hh ir b is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji kx jk jl jm ha bi translated">地球上有大量石油和天然气聚集的几个地区，在地表下也有大量的盐沉积。但不幸的是，知道大型盐矿床的确切位置非常困难。专业地震成像仍然需要专业人员对盐体进行解释。这导致非常主观的、高度可变的渲染。更令人担忧的是，它会给石油和天然气公司的钻探人员带来潜在的危险。</p><blockquote class="kc kd ke"><p id="817f" class="ip iq jw ir b is it iu iv iw ix iy iz kf jb jc jd kg jf jg jh kh jj jk jl jm ha bi translated"><strong class="ir hi"> 3。ML问题映射&amp;指标:</strong></p></blockquote><p id="6b27" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这可以看作是一个<strong class="ir hi">分割</strong>类型的问题。在这种情况下，没有延迟限制。</p><p id="c2c3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里使用的性能指标是多个IOU阈值的平均精度，IOU代表交集/并集。该指标在IOU阈值范围内扫描，在每个点计算平均精度值。阈值范围从0.5到0.95，步长为0.05: (0.5，0.55，0.6，0.65，0.7，0.75，0.8，0.85，0.9，0.95)。换句话说，在阈值为0.5时，如果预测对象与基础真值对象的交集大于0.5，则该预测对象被视为“命中”。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="6230" class="lh li hh ld b fi lj lk l ll lm">iou=.669<br/>iou=[iou]*10<br/>thresholds= np.arange(.5,1,.05)<br/>metric= np.mean(iou&gt;thresholds)</span></pre><p id="bd5e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jw">提交格式</em>:使用<strong class="ir hi">游程编码</strong>格式，而不是直接提交掩码进行评估。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="34d4" class="lh li hh ld b fi lj lk l ll lm">mask= np.random.randint(2, size=(101, 101))<br/>def rle_encoding(mask):<br/>    dots = np.where(mask.T.flatten() == 1)[0]<br/>    run_lengths = []<br/>    prev = -2#pixels are 1-indexed so correction required<br/>    for b in dots:<br/>        if (b &gt; prev+1): run_lengths.extend((b + 1, 0))<br/>        run_lengths[-1] += 1<br/>        prev = b<br/>    rle=' '.join(map(str, run_lengths))<br/>    return rle</span></pre><blockquote class="kc kd ke"><p id="0b00" class="ip iq jw ir b is it iu iv iw ix iy iz kf jb jc jd kg jf jg jh kh jj jk jl jm ha bi translated"><strong class="ir hi"> 4。数据描述:</strong></p></blockquote><p id="902d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">中的数据集图像和掩膜。png文件，下面的数据链接</p><div class="ln lo ez fb lp lq"><a href="https://www.kaggle.com/c/tgs-salt-identification-challenge/data" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hi fi z dy lv ea eb lw ed ef hg bi translated">TGS盐鉴定挑战</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">地球表面下的盐沉积</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">www.kaggle.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me in lq"/></div></div></a></div><blockquote class="kc kd ke"><p id="b328" class="ip iq jw ir b is it iu iv iw ix iy iz kf jb jc jd kg jf jg jh kh jj jk jl jm ha bi translated"><strong class="ir hi"> 5。现有方法:</strong></p></blockquote><ul class=""><li id="e159" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm mf jt ju jv bi translated">这个<a class="ae ki" href="https://www.kaggle.com/c/tgs-salt-identification-challenge/discussion/65226" rel="noopener ugc nofollow" target="_blank">内核</a>讲的是先用焦损再用Lovasz损的训练，BCE可以代替焦损。</li><li id="ab47" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm mf jt ju jv bi translated"><a class="ae ki" href="https://www.kaggle.com/c/tgs-salt-identification-challenge/discussion/69052" rel="noopener ugc nofollow" target="_blank">这个内核</a>使用深度监督将训练加速到60个历元，而正常情况下需要200个历元。</li><li id="b624" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm mf jt ju jv bi translated"><a class="ae ki" href="https://www.kaggle.com/c/tgs-salt-identification-challenge/discussion/69274" rel="noopener ugc nofollow" target="_blank">这里</a>快照集成和坐标Conv已经被用来获得一个很好的分数。</li></ul><blockquote class="kc kd ke"><p id="4d37" class="ip iq jw ir b is it iu iv iw ix iy iz kf jb jc jd kg jf jg jh kh jj jk jl jm ha bi translated"><strong class="ir hi"> 6。第一次切割解决方案:</strong></p></blockquote><p id="31fd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">首先，采用了一个简单的基线(UNet-Resnet34)。这里只应用了必要的扩充(Normalize，Totensor())。损失是二进制交叉熵，优化器Adam以3e-4的学习率被选择。</p><blockquote class="kc kd ke"><p id="568c" class="ip iq jw ir b is it iu iv iw ix iy iz kf jb jc jd kg jf jg jh kh jj jk jl jm ha bi translated"><strong class="ir hi"> 7。探索性数据分析</strong></p></blockquote><p id="a968" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">训练数据集由4000幅图像组成，测试数据集由18000幅图像组成。竞争对手训练数据非常少。整个比赛中可能的过度配合。迁移学习和数据扩充的需要。</p><p id="9cc1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">3x101x101是所有训练和测试图像的大小101x101训练和测试集遮罩的大小。数据集中出现的一些异常是带有空遮罩的黑色图像，垂直遮罩如下所示。下面的黄色部分显示盐。</p><div class="ky kz la lb fd ab cb"><figure class="mg ii mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/a1866f2efc89c87d8a122782263e9f54.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*vvKzMWWxVrY3NjDNOJxksQ.png"/></div></figure><figure class="mg ii mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/bddbdc272e83a05d23401fdc87627442.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*Orex6x3C5-_iZ83GAwuKgQ.png"/></div></figure></div><div class="ab cb"><figure class="mg ii mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/0ddbdaee2e6b101794ee57c5448c897e.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*poZFRNqwv5NMSNRsxHhozQ.png"/></div></figure><figure class="mg ii mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/3c61a433dceb32b12eeea25e64ba948e.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*LuT708MiXSw2_rUe1oDYyQ.png"/></div><figcaption class="mm mn et er es mo mp bd b be z dx mq di mr ms translated">数据集一瞥</figcaption></figure></div><figure class="ky kz la lb fd ii er es paragraph-image"><div class="er es mt"><img src="../Images/49517882249f6d4740a59936a15c209c.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*JlWyqCJRo1dmyOfKyy2M6Q.png"/></div><figcaption class="mm mn et er es mo mp bd b be z dx translated">增强图像后</figcaption></figure><p id="631e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">测试图像预处理包括获取图像并将其复制填充为128x128，然后将图像按通道归一化为((0，0，0)，(1，1，1))。128大小很重要，因为解决方案包括采用UNet，UNet易于在2次方维上工作。</p><p id="b597" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jw">盐覆盖计算</em>:盐覆盖似乎是一个需要关注的非常重要的变量，因此训练数据集中的每个掩膜都已针对其中的盐覆盖进行了计算。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="9c5a" class="lh li hh ld b fi lj lk l ll lm">mask<br/>salt_coverage= np.mean(mask)*10<br/>#rounding this value to int for easy validation<br/>np.rint(salt_coverage)<br/>#values in salt Coverage= [0,1,2,3,4,5,6,7,8,9,10]</span></pre><blockquote class="kc kd ke"><p id="6652" class="ip iq jw ir b is it iu iv iw ix iy iz kf jb jc jd kg jf jg jh kh jj jk jl jm ha bi translated"><strong class="ir hi"> 8。先决条件:</strong></p></blockquote><p id="81e5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae ki" href="https://www.programmersought.com/article/2032749860/" rel="noopener ugc nofollow" target="_blank"> SCSE块</a>被认为是给卷积网络增加了注意机制。广义的注意力只是集中在一些事情上，而不是全部。这是通过添加参数来判断哪个空间像素和哪个通道将被聚焦来实现的。</p><p id="43c5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在Conv网络中，当我们深入时，我们将剩下高级特征，在早期层中，我们将发现低级特征。<a class="ae ki" href="https://towardsdatascience.com/review-hypercolumn-instance-segmentation-367180495979" rel="noopener" target="_blank">另一方面，超列</a>通过使网络能够访问Conv网络中所有较低层以及较高层的细节，应该给予网络更多的预测能力。他们通过获取每一级的输出，将其上采样到目标大小，连接所有内容并传递到最后一个卷积来实现这一点。</p><blockquote class="kc kd ke"><p id="e40e" class="ip iq jw ir b is it iu iv iw ix iy iz kf jb jc jd kg jf jg jh kh jj jk jl jm ha bi translated"><strong class="ir hi"> 9。型号说明:</strong></p></blockquote><p id="f6be" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jw">交叉验证:分层分割已使用10倍，分层已使用图像的盐覆盖完成。</em></p><p id="0e3c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jw"> 9.1基线</em></p><p id="c148" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">基线表现很好，但很快过度拟合。使用Resnet34的UNet包括使用Resnet34作为编码器，并在resnet 34中的每次下采样之前获取输出，并在解码器中的相应上采样步骤之前将它们连接到解码器。解码器始终保持相当简单的64个通道。</p><figure class="ky kz la lb fd ii"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mw"><img src="../Images/a0383b59ece80450b8a87a205f14d5ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rgbKL1es1GXd0pPwunDpMQ.png"/></div></div><figcaption class="mm mn et er es mo mp bd b be z dx translated">蓝-青色用于训练，基线模型</figcaption></figure><p id="b3b9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因此不同的增强被用于训练和赋值。这使得在训练的每一个环节，训练损失都比val损失更严重。在这之后，训练很容易，因为启发式方法是训练足够长的时间，使得训练损失比val损失好。这似乎在一定程度上纠正了过度拟合的问题。辍学似乎是过度适应的一个非常自然的解决方案，但我避免辍学，因为它大大延迟了训练过程，与这些增强相比没有提供很大的结果。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="8d0d" class="lh li hh ld b fi lj lk l ll lm">transform_train = Compose([<br/>  HorizontalFlip(p=.5),<br/>  Compose([RandomCrop(90,90),<br/>  Resize(101,101)],p=.2),<br/>  OneOf([RandomBrightness(.1),<br/>  RandomContrast(.1),RandomGamma()],p=.2),<br/>  PadIfNeeded(128,128,cv2.BORDER_REPLICATE),<br/>  Normalize(mean=(0,0,0),std=(1,1,1,))])</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mx"><img src="../Images/347fc107a6f9a8418cf378107a036c17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9FJefIkg5lR78DWxrdhI6A.png"/></div></div><figcaption class="mm mn et er es mo mp bd b be z dx translated">蓝-青色系列基线_已修正</figcaption></figure><p id="89b7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后，Lovasz损耗(IOU的替代损耗函数)已经过优化。但是关于这种损失的训练非常缓慢，因此为了加速训练过程，我预先训练了基线校正的重量，这确实证明有助于加速训练过程至少80个周期。这里使用了具有1e-4学习率的Adam。Lr调度程序也一直在帮助训练过程，它有1e-3的max_lr和1e-4的min_lr，每个周期有10个时期和“三角形2”lr模式。</p><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es my"><img src="../Images/239affbdf7c4723072366485ed5bf0c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PDAb2z_iHSBkjlhzwP90oA.png"/></div></div><figcaption class="mm mn et er es mo mp bd b be z dx translated">基线_lovasz</figcaption></figure><p id="ae0c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jw"> 9.2: SCSE_hypercol </em></p><p id="b2d0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下一个模型是具有空间和通道挤压和激发(SCSE)块和超圆柱的基线。SCSE块仅放置在解码器中，上采样用于具有双线性模式的超列中。SCSE区块的折减系数保持默认值16。这里的解码器也使用了上采样，而不是ConvTranspose2d。</p><figure class="ky kz la lb fd ii"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="982a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这个网络只有很小的改进。然后对网络进行误差分析。分析表明，相当大的误差是由于预测盐是否存在的网络不准确造成的。在0.0 IOU预测中存在大约11个假阳性和24个假阴性。</p><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mz"><img src="../Images/861d77dbf39feef729bbe053297af43e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pyyRufMPBsJ6wJuJXw-DGA.png"/></div></div><figcaption class="mm mn et er es mo mp bd b be z dx translated">Scse_hypercol</figcaption></figure><p id="140a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jw"> 9.3二进制_判断</em></p><p id="1796" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下一个模型在相同的架构上尝试了一个简单的解决方案，即在中心块判断图像中是否有盐，即从编码器中取出输出并检查其中是否有盐，然后只有那些具有非空掩码的才会被训练用于语义分割。这是一种很难的关注，因为我们的目标是1，0倍。训练进行了200个时期，30个时期有BCE损失，然后有Lovasz损失。Adam 3e-4用于BCE，然后Adam 1e-4用于90个时期，然后循环学习率(1e-3，1e-4)用于80个时期。中心块上的二元分类器在val集上的准确率为92%,而度量在val集上的准确率为0 . 87。</p><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es na"><img src="../Images/b5f31e59ecc0eebd5549473925e34b41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ck9DVJ_HTGZ4VMXxxh3JUA.png"/></div></div></figure><p id="582f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">该模型的损失计算是，如果图像没有盐，则取输出并乘以0，如果有盐，则乘以1。然后，该输出将用于计算lovasz损失，并且对于分类损失(BCE ),将使用每个图像。</p><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nb"><img src="../Images/2737f3c1596daf57190a054b8478abe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TlU5RshPdirAEg9WMrybBg.png"/></div></div></figure><figure class="ky kz la lb fd ii"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="9dae" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这个解决方案极大地改进了整个培训过程。这里收敛非常快，这样做有助于假阳性从11到6，也有助于非空图像的训练。</p><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nc"><img src="../Images/edd5275f2ac68648ef8116ace8923141.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AFQ1vNK3ftGewjHJa7vFjg.png"/></div></div><figcaption class="mm mn et er es mo mp bd b be z dx translated">蓝青训练二元评判模型</figcaption></figure><blockquote class="kc kd ke"><p id="3ca0" class="ip iq jw ir b is it iu iv iw ix iy iz kf jb jc jd kg jf jg jh kh jj jk jl jm ha bi translated">10。结果&amp;部署:</p></blockquote><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nd"><img src="../Images/b42c7429b88f4af3fe8ad1903d269574.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1FobrifChQCec_KfR6Ccfw.png"/></div></div><figcaption class="mm mn et er es mo mp bd b be z dx translated">Kaggle最佳分数提交</figcaption></figure><figure class="ky kz la lb fd ii er es paragraph-image"><div class="er es ne"><img src="../Images/c5bba41bd34cfabdfec96aa0e242b009.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*lOTNMMc6q8TmkpByBCRR-g.png"/></div><figcaption class="mm mn et er es mo mp bd b be z dx translated">模型比较</figcaption></figure><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nf"><img src="../Images/c16b2cbb550d23be3289471b1b8002e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q660i-Ynz80RWANlXhjplQ.png"/></div></div><figcaption class="mm mn et er es mo mp bd b be z dx translated">图1</figcaption></figure><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nf"><img src="../Images/7107362023bdb8b51cb746d62c7dfe53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JFTxZDHJBFRHRzmfc3UdvA.png"/></div></div><figcaption class="mm mn et er es mo mp bd b be z dx translated">图2:二元判断</figcaption></figure><p id="eea5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在上图中，图例是最后一张图片，橙色-&gt;真阳性，灰色-&gt;假阴性，红色-&gt;假阳性，蓝色-&gt;真阴性。这些图像是通过在真实遮罩上重叠预测而得到的，该过程仅在val (fold0)集合中的遮罩上进行，其中metric ==0.0</p><p id="7fdb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jw">观察:</em></p><ul class=""><li id="e03d" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm mf jt ju jv bi translated">与图1相比，图2清楚地显示了更少的错误，这是显而易见的，因为图2来自最佳模型。</li><li id="4ad1" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm mf jt ju jv bi translated">大量的错误伴随着蓝色和灰色(真阴性、假阴性)。</li><li id="9163" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm mf jt ju jv bi translated">此外，许多错误是在角落和边缘。对目标作物(90，90)进行度量计算比实际度量好得多。</li><li id="63c9" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm mf jt ju jv bi translated">模特们似乎也分不清完整的面具和没有面具。</li><li id="3b8e" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm mf jt ju jv bi translated">不出所料，垂直屏蔽引起了一些问题。</li></ul><figure class="ky kz la lb fd ii er es paragraph-image"><div class="er es ng"><img src="../Images/295cd7f9044c625c0b55ebde4df6ec50.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*85-Gb9J54_EU2iWDbWqzoA.png"/></div></figure><p id="00b3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在此表中，iou列表示指标组，第2列是该指标组中整个数据集的计数。</p><p id="4a0c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jw">观察:</em></p><ul class=""><li id="dbe4" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm mf jt ju jv bi translated">表1来自最佳模型，它清楚地显示了与表2相比的总体改进。</li><li id="d36f" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm mf jt ju jv bi translated">这很有意思，因为向模型中添加二进制判断的变化意味着只影响0.0 iou范围(减少)，但这里1.0 iou范围也变得更好(增加)。</li></ul><p id="227c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="jw">部署:</em> </strong></p><p id="74cb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最好的模型已经部署在google cloud上，部署过程相当简单，使用flask完成。</p><figure class="ky kz la lb fd ii"><div class="bz dy l di"><div class="nh mv l"/></div><figcaption class="mm mn et er es mo mp bd b be z dx translated">部署模型工作</figcaption></figure><blockquote class="kc kd ke"><p id="d316" class="ip iq jw ir b is it iu iv iw ix iy iz kf jb jc jd kg jf jg jh kh jj jk jl jm ha bi translated"><strong class="ir hi"> 11。未来工作:</strong></p></blockquote><ol class=""><li id="d804" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">由于如此小的训练集，伪标记在这种情况下看起来非常有前途。</li><li id="30d0" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm js jt ju jv bi translated">KFold合奏肯定会提高至少01 IOU。</li><li id="aedf" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm js jt ju jv bi translated">快照集合或随机加权平均也肯定会提高分数。</li><li id="ec8f" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm js jt ju jv bi translated">在这个网络中可以进行深度监督，以具有更好的收敛性。</li><li id="fd08" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm js jt ju jv bi translated">众所周知，CoordConv解决方案可以稍微提高分数。</li></ol><blockquote class="kc kd ke"><p id="8ee4" class="ip iq jw ir b is it iu iv iw ix iy iz kf jb jc jd kg jf jg jh kh jj jk jl jm ha bi translated"><strong class="ir hi"> 12。简介:</strong></p></blockquote><ul class=""><li id="5bfb" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm mf jt ju jv bi translated"><a class="ae ki" href="https://www.linkedin.com/in/manoj-guthikonda-5405b4112/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/manoj-guthikonda-5405b4112/</a></li><li id="6e94" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm mf jt ju jv bi translated"><a class="ae ki" href="https://github.com/level14taken" rel="noopener ugc nofollow" target="_blank">https://github.com/level14taken</a></li></ul><blockquote class="kc kd ke"><p id="74be" class="ip iq jw ir b is it iu iv iw ix iy iz kf jb jc jd kg jf jg jh kh jj jk jl jm ha bi translated"><strong class="ir hi"> 13。参考文献:</strong></p></blockquote><ul class=""><li id="2874" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm mf jt ju jv bi translated"><a class="ae ki" href="https://colab.research.google.com/drive/1uA6b3NXVBGwfK4KBxtetq61YTbZcwSA6?usp=sharing" rel="noopener ugc nofollow" target="_blank">https://colab . research . Google . com/drive/1 ua 6b 3 nxvbgwfk 4 kbxtetq 61 ytbzcwsa 6？usp =共享</a></li><li id="a938" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm mf jt ju jv bi translated"><a class="ae ki" href="https://www.kaggle.com/c/tgs-salt-identification-challenge/discussion/67693" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/TGS-salt-identificati on-challenge/discussion/67693</a></li><li id="eda0" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm mf jt ju jv bi translated"><a class="ae ki" href="https://heartbeat.fritz.ai/brilliant-beginners-guide-to-model-deployment-133e158f6717" rel="noopener ugc nofollow" target="_blank">https://heart beat . fritz . ai/brilliant-初学者-模型部署指南-133e158f6717 </a></li><li id="cc92" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm mf jt ju jv bi translated"><a class="ae ki" href="https://www.kaggle.com/c/tgs-salt-identification-challenge/discussion/65933" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/TGS-salt-identificati on-challenge/discussion/65933</a></li><li id="2015" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm mf jt ju jv bi translated"><a class="ae ki" href="https://www.appliedaicourse.com" rel="noopener ugc nofollow" target="_blank">https://www.appliedaicourse.com</a></li></ul></div></div>    
</body>
</html>