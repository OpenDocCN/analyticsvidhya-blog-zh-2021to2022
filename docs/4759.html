<html>
<head>
<title>Sequence to Sequence models (with implementation — make a translator) Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">序列到序列模型(包括实现—制作翻译器)第1部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sequence-to-sequence-models-with-implementation-part-1-73cd012520eb?source=collection_archive---------0-----------------------#2022-02-05">https://medium.com/analytics-vidhya/sequence-to-sequence-models-with-implementation-part-1-73cd012520eb?source=collection_archive---------0-----------------------#2022-02-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="736b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我将向您概述序列到序列模型。我将涵盖序列到序列模型的需求，使用RNNs(第1部分)建模，并注意改进结果(<a class="ae jc" href="https://amaygada.medium.com/sequence-to-sequence-models-with-implementation-make-a-translator-part-2-49dbccd3d7d6" rel="noopener"> <strong class="ig hi">第2部分</strong> </a>)。</p><p id="e89d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意，本文有一些代码片段。<strong class="ig hi">完整代码库</strong> <a class="ae jc" href="https://colab.research.google.com/drive/1Fy5nYokwJR3TDek-yS8QC75WDpV_fDxa" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">点击这里</strong> </a> <strong class="ig hi">。</strong></p><h1 id="7d93" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">序列模型序列的需求</h1><p id="ed97" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">序列对序列模型是编码器-解码器网络，其架构可用于复杂的机器学习任务，如机器翻译、文本<a class="ae jc" href="https://www.vocabulary.com/dictionary/summarization#:~:text=summarization%20Add%20to%20list%20Share,court%20is%20called%20a%20summation." rel="noopener ugc nofollow" target="_blank">摘要</a>和聊天机器人。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es kg"><img src="../Images/8d04bf4d31f3dbf5c908d393fd35c598.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*RiRBLweuqK7_t8wROBluXQ.jpeg"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">Seq2Seq型号概述</figcaption></figure></div><div class="ab cl ks kt go ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ha hb hc hd he"><h1 id="bbb1" class="jd je hh bd jf jg kz ji jj jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka bi translated">预处理</h1><h2 id="3495" class="le je hh bd jf lf lg lh jj li lj lk jn ip ll lm jr it ln lo jv ix lp lq jz lr bi translated">指导方针</h2><ol class=""><li id="460b" class="ls lt hh ig b ih kb il kc ip lu it lv ix lw jb lx ly lz ma bi translated">删除特殊字符(@、%、#、…)</li><li id="13e8" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">在标点符号和单词之间添加空格。(早上好！—&gt;早上好！)</li><li id="b986" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">给每个句子添加<start>和<end>标记</end></start></li><li id="022c" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">创建单词索引和倒排单词索引(使用keras tokenizer)</li><li id="d526" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">将每个句子填充到最大长度</li></ol><h2 id="c4e1" class="le je hh bd jf lf lg lh jj li lj lk jn ip ll lm jr it ln lo jv ix lp lq jz lr bi translated">样本值输入</h2><blockquote class="mg mh mi"><p id="7031" class="ie if mj ig b ih ii ij ik il im in io mk iq ir is ml iu iv iw mm iy iz ja jb ha bi translated">这是我的生活。</p></blockquote><h2 id="7992" class="le je hh bd jf lf lg lh jj li lj lk jn ip ll lm jr it ln lo jv ix lp lq jz lr bi translated">抽样输出</h2><blockquote class="mg mh mi"><p id="5f9c" class="ie if mj ig b ih ii ij ik il im in io mk iq ir is ml iu iv iw mm iy iz ja jb ha bi translated">这是我的生活。<end/></p></blockquote><h2 id="2836" class="le je hh bd jf lf lg lh jj li lj lk jn ip ll lm jr it ln lo jv ix lp lq jz lr bi translated">密码</h2><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="mn mo l"/></div></figure></div><div class="ab cl ks kt go ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ha hb hc hd he"><h1 id="b604" class="jd je hh bd jf jg kz ji jj jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka bi translated">网络建模</h1><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="er es mp"><img src="../Images/b62a7c819e58922479643a836bd4c13f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w9HuOm0pp-KKJxIYukSuPg.jpeg"/></div></div></figure><h2 id="968f" class="le je hh bd jf lf lg lh jj li lj lk jn ip ll lm jr it ln lo jv ix lp lq jz lr bi translated">讨论正向传播</h2><ol class=""><li id="d48c" class="ls lt hh ig b ih kb il kc ip lu it lv ix lw jb lx ly lz ma bi translated">根据词汇大小，将源句子中的所有单词转换为一个热向量</li><li id="580b" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">将一个热点向量通过一个可训练的256维嵌入层(<a class="ae jc" rel="noopener" href="/analytics-vidhya/a-mathematical-dive-into-word-embeddings-5c06f2fd9bbe"> <strong class="ig hi">点击此处</strong> </a> <strong class="ig hi"> </strong>了解更多关于嵌入层和词向量的信息)</li><li id="fb34" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">嵌入的向量通过RNN层(1024个单元)。</li><li id="c714" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">生成源句子的编码。</li><li id="5a54" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">编码被传递给解码器，它充当解码器RNN的隐藏状态。</li><li id="ad79" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">通过一次传递一个单词来训练解码器。</li><li id="a519" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">该模型被期望预测下一个字，该字被传递到RNN层。(实际单词在训练期间传递，而预测单词在预测期间传递)</li><li id="8e15" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated">一旦遇到<end>标记或者达到数据集确定的目标句子的最大长度，模型就停止。</end></li></ol><h2 id="1a6c" class="le je hh bd jf lf lg lh jj li lj lk jn ip ll lm jr it ln lo jv ix lp lq jz lr bi translated">讨论矩阵形状</h2><p id="e2ef" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">有趣的是，没有很多人在讨论建模时讨论矩阵形状，我觉得这是理解ML中网络的一个非常重要的部分。</p><p id="aa3f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">方括号()中的字母表示层。利用这些字母符号，我们将研究矩阵的形状。</p><p id="bac6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们还将考虑批量大小(64 ),以避免在浏览代码时产生混淆</p><p id="2e65" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">假设源句子的最大长度= 16(填充后)</p><p id="b962" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">RNN的单位数= 1024</p><pre class="kh ki kj kk fd mu mv mw mx aw my bi"><span id="a21c" class="le je hh mv b fi mz na l nb nc">{we will consider all 16 together because we have the entire source sentence}<br/>A -&gt; (64, 16, Vocab_size)<br/>B -&gt; (64, 16, 256)<br/>C -&gt; (64,1,1024)<br/>Hi -&gt; (64, 1, 1024)</span><span id="374a" class="le je hh mv b fi nd na l nb nc">{we will consider each word one by one in the decoder as we use the previous word to form the next word. Hence we will not use the max length here.}<br/>D -&gt; (64, 1, Vocab_size)<br/>E -&gt; (64, 1, 256)<br/>F -&gt; (64,1,1024)<br/>G -&gt; (64, 1, Vocab_size)  {apply softmax here to get output word}</span></pre><h2 id="24fa" class="le je hh bd jf lf lg lh jj li lj lk jn ip ll lm jr it ln lo jv ix lp lq jz lr bi translated">样本值输入</h2><blockquote class="mg mh mi"><p id="da46" class="ie if mj ig b ih ii ij ik il im in io mk iq ir is ml iu iv iw mm iy iz ja jb ha bi translated">这是我的生活。<end/></p></blockquote><h2 id="6b7c" class="le je hh bd jf lf lg lh jj li lj lk jn ip ll lm jr it ln lo jv ix lp lq jz lr bi translated">抽样输出</h2><blockquote class="mg mh mi"><p id="6279" class="ie if mj ig b ih ii ij ik il im in io mk iq ir is ml iu iv iw mm iy iz ja jb ha bi translated"><start>这就是我的生活。<end/></start></p></blockquote><h2 id="b775" class="le je hh bd jf lf lg lh jj li lj lk jn ip ll lm jr it ln lo jv ix lp lq jz lr bi translated">编码编码器网络</h2><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="mn mo l"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">编码器张量流代码</figcaption></figure><h2 id="62be" class="le je hh bd jf lf lg lh jj li lj lk jn ip ll lm jr it ln lo jv ix lp lq jz lr bi translated">解码器网络编码</h2><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="mn mo l"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">解码器张量流代码</figcaption></figure></div><div class="ab cl ks kt go ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ha hb hc hd he"><h1 id="dc6b" class="jd je hh bd jf jg kz ji jj jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka bi translated">损失函数</h1><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="mn mo l"/></div></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ne"><img src="../Images/f1c86d2b2a635ec095e8a4d9729d1008.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/1*lis_IOBk0EBGFnk3whr4aw.gif"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">损失函数</figcaption></figure></div><div class="ab cl ks kt go ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ha hb hc hd he"><h1 id="eb87" class="jd je hh bd jf jg kz ji jj jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka bi translated">培养</h1><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="mn mo l"/></div></figure></div><div class="ab cl ks kt go ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ha hb hc hd he"><h1 id="d957" class="jd je hh bd jf jg kz ji jj jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka bi translated">结果</h1><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es nf"><img src="../Images/e5287362707ea36ae6da2df69d0eb7aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*8rhlslqvANoK-0of3BnV0w.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">结果部分</figcaption></figure></div><div class="ab cl ks kt go ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ha hb hc hd he"><h1 id="e3d2" class="jd je hh bd jf jg kz ji jj jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka bi translated">翻译</h1><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="mn mo l"/></div></figure><pre class="kh ki kj kk fd mu mv mw mx aw my bi"><span id="380c" class="le je hh mv b fi mz na l nb nc">Input:                     &lt;start&gt; ¿ todavia estan en casa ? &lt;end&gt; <br/>Predicted translation:     are you at home ? &lt;end&gt;</span></pre></div><div class="ab cl ks kt go ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ha hb hc hd he"><h1 id="e086" class="jd je hh bd jf jg kz ji jj jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka bi translated">当前编码器/解码器网络的问题</h1><p id="ab65" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">当编码器对输入句子中的最后一个单词进行编码时，由于<strong class="ig hi"> <em class="mj">消失梯度</em> </strong>，许多与前面单词相关的信息都丢失了</p><p id="486f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这通常会影响较长的输入句子。</p><h2 id="4c31" class="le je hh bd jf lf lg lh jj li lj lk jn ip ll lm jr it ln lo jv ix lp lq jz lr bi translated">解决办法</h2><p id="c526" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">我们希望编码器记住输入句子中的重要单词，这些单词会影响解码器解码编码的方式。为此我们使用<strong class="ig hi">注意机制。</strong></p><p id="fce5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" href="https://amaygada.medium.com/sequence-to-sequence-models-with-implementation-make-a-translator-part-2-49dbccd3d7d6" rel="noopener"> <strong class="ig hi">第二部分</strong> </a>关于注意事项的详细说明</p></div><div class="ab cl ks kt go ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ha hb hc hd he"><h1 id="50d3" class="jd je hh bd jf jg kz ji jj jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka bi translated">有关整个代码库，请访问:</h1><div class="ng nh ez fb ni nj"><a href="https://colab.research.google.com/drive/1Fy5nYokwJR3TDek-yS8QC75WDpV_fDxa" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab dw"><div class="nl ab nm cl cj nn"><h2 class="bd hi fi z dy no ea eb np ed ef hg bi translated">Seq2Seq注意</h2></div><div class="nq l"><div class="nr l ns nt nu nq nv km nj"/></div></div></a></div></div><div class="ab cl ks kt go ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ha hb hc hd he"><h1 id="4fd2" class="jd je hh bd jf jg kz ji jj jk la jm jn jo lb jq jr js lc ju jv jw ld jy jz ka bi translated">参考</h1><ol class=""><li id="8a46" class="ls lt hh ig b ih kb il kc ip lu it lv ix lw jb lx ly lz ma bi translated"><a class="ae jc" href="https://www.youtube.com/watch?v=pLpzU-xGi2E&amp;t=3028s" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=pLpzU-xGi2E&amp;t = 3028s</a></li><li id="8dc2" class="ls lt hh ig b ih mb il mc ip md it me ix mf jb lx ly lz ma bi translated"><a class="ae jc" href="https://github.com/YanXuHappygela/NLP-study/blob/master/seq2seq_with_attention.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/yanxuhapygela/NLP-study/blob/master/seq 2 seq _ with _ attention . ipynb</a></li></ol></div></div>    
</body>
</html>