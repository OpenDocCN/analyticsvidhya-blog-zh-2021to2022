<html>
<head>
<title>A review on Deep Reinforcement Learning for Fluid Mechanics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">流体力学深度强化学习综述</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-review-on-deep-reinforcement-learning-for-fluid-mechanics-76211fc304e3?source=collection_archive---------15-----------------------#2021-04-18">https://medium.com/analytics-vidhya/a-review-on-deep-reinforcement-learning-for-fluid-mechanics-76211fc304e3?source=collection_archive---------15-----------------------#2021-04-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="aaf0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从之前的<a class="ae jc" href="https://donsetpg.github.io/blog/2019/08/06/DRL-FM-review/" rel="noopener ugc nofollow" target="_blank">博客文章</a>中复制，写于2019年8月。该论文现已发表。</p></div><div class="ab cl jd je go jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="ha hb hc hd he"><p id="6843" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当我开始在<a class="ae jc" href="http://www.cemef.mines-paristech.fr/" rel="noopener ugc nofollow" target="_blank"> CEMEF </a>实习时，我已经接触过深度强化学习(DRL)和流体力学，但从未将其中一种与另一种结合使用。我知道已经有几个人走上了这条路，当我到达时，有些人甚至正在T4 CEMEF T5工作。然而，我(和我的导师<a class="ae jc" href="http://www.cemef.mines-paristech.fr/staff/elie-hachem" rel="noopener ugc nofollow" target="_blank"> Elie Hachem </a>仍然有几个问题/目标在我的脑海里:</p><ul class=""><li id="6669" class="jk jl hh ig b ih ii il im ip jm it jn ix jo jb jp jq jr js bi translated">DRL是如何应用于流体力学的？</li><li id="69f7" class="jk jl hh ig b ih jt il ju ip jv it jw ix jx jb jp jq jr js bi translated">为了提高这两个科目，我想自己尝试一个测试用例；</li><li id="fe03" class="jk jl hh ig b ih jt il ju ip jv it jw ix jx jb jp jq jr js bi translated">我们如何尽可能通用地编码呢？</li></ul><p id="ed32" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在一个优秀团队的帮助下，这些问题的结果可以在这里<a class="ae jc" href="https://arxiv.org/abs/1908.04127" rel="noopener ugc nofollow" target="_blank">找到</a>。</p><h1 id="8c2d" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">DRL在流体力学中的应用</h1><p id="8db2" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">在DRL的帮助下，已经解决了几个流体力学问题。他们总是(大部分)遵循相同的模式，一方面使用DRL工具(如<a class="ae jc" href="https://gym.openai.com/" rel="noopener ugc nofollow" target="_blank"> Gym </a>、<a class="ae jc" href="https://github.com/tensorforce/tensorforce" rel="noopener ugc nofollow" target="_blank"> Tensorforce </a>或<a class="ae jc" href="https://stable-baselines.readthedocs.io/" rel="noopener ugc nofollow" target="_blank"> stables-baselines </a>等)，另一方面使用计算流体动力学(CFD)(<a class="ae jc" href="https://fenicsproject.org/" rel="noopener ugc nofollow" target="_blank">Fenics</a>、<a class="ae jc" href="https://www.openfoam.com/" rel="noopener ugc nofollow" target="_blank"> Openfoam </a>等)。</p><p id="3342" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">目前，大多数案例总是考虑物体(圆柱、正方形、鱼等)。)在2D/3D流体中。然后，DRL代理将能够执行几项任务:</p><ul class=""><li id="0f04" class="jk jl hh ig b ih ii il im ip jm it jn ix jo jb jp jq jr js bi translated">移动对象</li><li id="2031" class="jk jl hh ig b ih jt il ju ip jv it jw ix jx jb jp jq jr js bi translated">更改对象的几何图形或大小</li><li id="132a" class="jk jl hh ig b ih jt il ju ip jv it jw ix jx jb jp jq jr js bi translated">直接更换液体</li></ul><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="f32e" class="lk jz hh lg b fi ll lm l ln lo"><strong class="lg hi">A small step into the world of fluid mechanics</strong></span><span id="9e41" class="lk jz hh lg b fi lp lm l ln lo">The Navier-Stokes equation looks pretty (and complicated) but is in fact traduction of Newton's equation for a fluid. Rather than describing the movement of an object, it is representing the movement of a fluid (more precisely, of a field (of points, vectors, etc).).</span></pre><figure class="lb lc ld le fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es lq"><img src="../Images/2c289671b38e6a45ffe1fb09bbc45e67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3AnsFNXpihaGw9LI.png"/></div></div></figure><pre class="lb lc ld le fd lf lg lh li aw lj bi"><span id="0f6b" class="lk jz hh lg b fi ll lm l ln lo">This equation is quite a paradox itself. Its application are enormous, but we still don't know if solutions always exists (it is even one of the seven <a class="ae jc" href="https://en.wikipedia.org/wiki/Millennium_Prize_Problems" rel="noopener ugc nofollow" target="_blank">Millenium Prize Problems</a>).</span><span id="698c" class="lk jz hh lg b fi lp lm l ln lo">Solving the Navier-Stokes now doesn't mean we are trying to solve it. We use the finite element method to 'slice' our domain into small parts, and starting from initial conditions, we run our simulation, making sure our equations are 'approximatively verified' every (little) timestep.</span></pre><p id="530b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该代理可以在两个关键时刻执行这些任务:(I)当实验完成，并且您想要开始新的实验时，(ii)在实验期间(即，在CFD时间期间)。一个是关于直接优化；另一个是关于持续控制。下面是几个例子:</p><figure class="lb lc ld le fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es ly"><img src="../Images/223aa69f3be750337636223b9291f148.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*j4tNMIEo7GFjJ53b.png"/></div></div><figcaption class="lz ma et er es mb mc bd b be z dx translated"><em class="md">领袖与跟随者游泳者转载自</em> <a class="ae jc" href="https://iopscience.iop.org/article/10.1088/1748-3190/aa6311/pdf" rel="noopener ugc nofollow" target="_blank"> <em class="md">诺瓦蒂等(2017) </em> </a> <em class="md">，以领袖与跟随者之间的位移与朝向。</em></figcaption></figure><figure class="lb lc ld le fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es me"><img src="../Images/46b8be090ffa790186423a41b8c27f0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yaKZf9jyIBFjy-r2.png"/></div></div><figcaption class="lz ma et er es mb mc bd b be z dx translated"><em class="md">无(上)和有(下)主动流量控制的速度大小对比，转载自</em> <a class="ae jc" href="https://arxiv.org/abs/1808.07664" rel="noopener ugc nofollow" target="_blank"> <em class="md"> Rabault等人(2019) </em> </a> <em class="md">。该主动流控制被链接到DRL代理。</em></figcaption></figure><figure class="lb lc ld le fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mf"><img src="../Images/1733955d95fbe75985214e6e7b89ac16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JHGU4nFTwMUlyObK.png"/></div></div><figcaption class="lz ma et er es mb mc bd b be z dx translated"><em class="md">流体射流控制刚体转载自</em> <a class="ae jc" href="https://dl.acm.org/citation.cfm?id=3201334" rel="noopener ugc nofollow" target="_blank"> <em class="md">马等(2018) </em> </a> <em class="md">。射流的位置和方向由DRL控制。</em></figcaption></figure><p id="e22c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">甚至<a class="ae jc" href="https://www.youtube.com/watch?v=O8QtAi2cHBI" rel="noopener ugc nofollow" target="_blank">这个视频</a>。(这非常令人惊讶)</p><h1 id="6dd8" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">我自己的测试案例</h1><p id="68df" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">为了更深入地研究这个主题，我想自己尝试一个测试案例(尽管开始时得到了Jonathan Viquerat的帮助)。我们从这篇论文中得到启发，考虑了一个简单的情况:层流流过正方形。现在，计算这个正方形的阻力是很方便的(在这个装置中)。</p><p id="7999" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，<a class="ae jc" href="https://hal.archives-ouvertes.fr/hal-01082600v2" rel="noopener ugc nofollow" target="_blank">论文</a>提出的问题是:如果我们在接近正方形的某个地方增加一个小圆柱体，我们是否能够同时减小正方形和小圆柱体的总阻力？</p><p id="9e75" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">答案是肯定的，结果如下图:</p><figure class="lb lc ld le fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mg"><img src="../Images/21a61eba079070d6fe4e7413fd1353e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RpKU7yttfAuRCtUS.png"/></div></div><figcaption class="lz ma et er es mb mc bd b be z dx translated"><em class="md">雷诺数= 100时小控制圆柱诱导阻力的变化，转载自</em> <a class="ae jc" href="https://hal.archives-ouvertes.fr/hal-01082600v2" rel="noopener ugc nofollow" target="_blank"> <em class="md">梅利加等(2014) </em> </a> <em class="md">。</em></figcaption></figure><p id="3f00" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，与DRL一起解决这个案件当然很有趣，但我想看看是否有更多的可能性(因为这个案件在技术上已经解决了)。有几个想法是可行的(得益于与来自CEMEF的人的讨论和我之前做的回顾) :</p><ol class=""><li id="9a1b" class="jk jl hh ig b ih ii il im ip jm it jn ix jo jb mh jq jr js bi translated">直接优化和连续控制有什么区别吗？</li><li id="2f0f" class="jk jl hh ig b ih jt il ju ip jv it jw ix jx jb mh jq jr js bi translated">使用自动编码器容易吗？</li><li id="a0d4" class="jk jl hh ig b ih jt il ju ip jv it jw ix jx jb mh jq jr js bi translated">迁移学习是可能的吗？</li><li id="8baf" class="jk jl hh ig b ih jt il ju ip jv it jw ix jx jb mh jq jr js bi translated">我们能制定一个尽可能清晰的代码吗？</li></ol><p id="6164" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">关于第一点，我发现直接优化和连续控制之间没有什么特别的区别。两个代理收敛并找到几乎相同的最佳最终位置。</p><figure class="lb lc ld le fd lr er es paragraph-image"><div class="er es mi"><img src="../Images/c5a3b8188b7bb944c5216b52d518fa96.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/0*WVNT9ULam72mUKhA.gif"/></div></figure><figure class="lb lc ld le fd lr er es paragraph-image"><div class="er es mi"><img src="../Images/1b377f88459761df946bc9994ae2c2f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/0*VSRDj1Sq6MxpKhvG.gif"/></div><figcaption class="lz ma et er es mb mc bd b be z dx translated"><em class="md">在雷诺= 40和100时，从两个随机位置连续控制17个时间步长。</em></figcaption></figure><p id="1503" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我使用了自动编码器，但是没有时间比较使用和不使用它的结果。我必须解释一下为什么自动编码器会有所帮助。代理需要观察，当处理流体力学时，流体特性是重要的观察。</p><p id="50e7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，它们可以具有非常高的维度(超过10，000)。我们要处理的神经网络将会非常庞大。为了克服这个问题，可以使用自动编码器从高维流体场中提取简单的特征。似乎使用尽可能多的流体特征(使用自动编码器是可能的)是最好的办法:</p><figure class="lb lc ld le fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mj"><img src="../Images/ccec51815f075e9e0297b780f9e558ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dZuq4YcSF_UFRGqh.png"/></div></div><figcaption class="lz ma et er es mb mc bd b be z dx translated"><em class="md">带主动流动控制的阻力系数值转载自</em> <a class="ae jc" href="https://arxiv.org/abs/1808.07664" rel="noopener ugc nofollow" target="_blank"> <em class="md">拉博特等人(2019) </em> </a> <em class="md">。重要的是，我们给出的关于流体的信息越多(即，我们给代理的探针越多)，它的性能就越好。因此，能够在不扩大神经网络规模的情况下提供一切是非常有价值的。</em></figcaption></figure><h1 id="beee" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">DRL流体力学图书馆？</h1><p id="f715" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">开始时，我的目标是找出这样一个库是否可以建立(在合理的时间内)。在我创建测试用例的过程中，我意识到这样一个库的最大问题来自CFD求解器:不仅没有人使用相同的库，而且它们都非常不同。</p><p id="9fca" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于我的测试用例，我的代码基于<a class="ae jc" href="https://fenicsproject.org/" rel="noopener ugc nofollow" target="_blank"> Fenics </a>，这是一个易于使用的解算器(非常方便，因为您可以直接在Python中使用它)。代码可在<a class="ae jc" href="https://github.com/DonsetPG/fenics-DRL" rel="noopener ugc nofollow" target="_blank">这里</a>获得。它应该尽可能的清晰和可重用。它基于<a class="ae jc" href="https://gym.openai.com/" rel="noopener ugc nofollow" target="_blank">健身房</a>和<a class="ae jc" href="https://stable-baselines.readthedocs.io/" rel="noopener ugc nofollow" target="_blank">稳定基线</a>。</p><p id="87e4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我使用Gym构建定制环境，总是遵循相同的模式:</p><figure class="lb lc ld le fd lr"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="8528" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于稳定基线，我使用了他们的DRL算法实现，最后，正如我前面所说的，我使用Fenics来构建我的测试用例，使用自定义类，我希望它将被其他测试用例重用。他们使用三个主要类别:通道、障碍和问题:</p><h1 id="f1ed" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">频道:</h1><p id="cc33" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">基本上，这就是你想要进行实验的盒子。你只需给出盒子的下角和上角来定义它。</p><figure class="lb lc ld le fd lr"><div class="bz dy l di"><div class="mk ml l"/></div></figure><h1 id="e95f" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">障碍:</h1><p id="e95e" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">这是您要添加到先前看到的框中的对象。如果您只想使用Fenics，您只能轻松地添加正方形、圆形或多边形。然而，如果你想添加更复杂的形状和网格，你可以使用Fenics的<em class="mm">网格</em>功能。</p><figure class="lb lc ld le fd lr"><div class="bz dy l di"><div class="mk ml l"/></div></figure><h1 id="b348" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">问题:</h1><p id="18f6" class="pw-post-body-paragraph ie if hh ig b ih kw ij ik il kx in io ip ky ir is it kz iv iw ix la iz ja jb ha bi translated">这是一切发生的地方:设置盒子，放置几个物体，定义边界条件，等等。</p><figure class="lb lc ld le fd lr"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="942a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，这还没有接近真正的DRL流体力学库，问题是Fenics。虽然非常容易使用，但它求解速度很慢，用它来解决一个具有挑战性的问题是不切实际的。这就是为什么在CEMEF工作的其他人的目标是建立这个库，将DRL与其他CFD库连接起来，其中大多数是基于C++的。</p><p id="bf42" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，我们现在对如何使用DRL来帮助解决流体力学问题有了更好的了解。此外，几个重要的特点可以记住:迁移学习，自动编码器，LSTM，等等。如果建立一个真正的DRL-计算流体动力学库的目标没有实现，那么它的可能实现方式现在就更加清晰了。</p><h1 id="212c" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><a class="ae jc" href="https://github.com/DonsetPG/fenics-DRL" rel="noopener ugc nofollow" target="_blank"> Github资源库</a></h1><h1 id="a4eb" class="jy jz hh bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">参考</h1><ol class=""><li id="29ac" class="jk jl hh ig b ih kw il kx ip mn it mo ix mp jb mh jq jr js bi translated"><a class="ae jc" href="https://iopscience.iop.org/article/10.1088/1748-3190/aa6311/pdf" rel="noopener ugc nofollow" target="_blank">两个自走式游泳运动员通过学习实现同步——诺瓦蒂等人(2017) </a></li><li id="394c" class="jk jl hh ig b ih jt il ju ip jv it jw ix jx jb mh jq jr js bi translated"><a class="ae jc" href="https://arxiv.org/abs/1808.07664" rel="noopener ugc nofollow" target="_blank">通过深度强化学习训练的人工神经网络发现主动流量控制的控制策略— Rabault et al. (2019) </a></li><li id="ad4a" class="jk jl hh ig b ih jt il ju ip jv it jw ix jx jb mh jq jr js bi translated"><a class="ae jc" href="https://dl.acm.org/citation.cfm?id=3201334" rel="noopener ugc nofollow" target="_blank">采用深度强化学习的流体导向刚体控制——马等(2018) </a></li><li id="65c3" class="jk jl hh ig b ih jt il ju ip jv it jw ix jx jb mh jq jr js bi translated"><a class="ae jc" href="https://hal.archives-ouvertes.fr/hal-01082600v2" rel="noopener ugc nofollow" target="_blank">流过方形柱体的层流和湍流中空气动力的敏感性——me liga等人(2014年)</a></li><li id="adca" class="jk jl hh ig b ih jt il ju ip jv it jw ix jx jb mh jq jr js bi translated"><a class="ae jc" href="https://arxiv.org/abs/1908.04127" rel="noopener ugc nofollow" target="_blank">流体力学深度强化学习综述— Garnier et al. (2019) </a></li></ol></div></div>    
</body>
</html>