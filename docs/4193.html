<html>
<head>
<title>PREDICTIVE WEB ANALYTICS: A CASE STUDY</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测性网络分析:案例研究</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predictive-web-analytics-a-case-study-f30feda45002?source=collection_archive---------2-----------------------#2021-09-07">https://medium.com/analytics-vidhya/predictive-web-analytics-a-case-study-f30feda45002?source=collection_archive---------2-----------------------#2021-09-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="3b1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">日复一日，互联网上的数据和信息量呈指数级增长，每秒钟都有新网站、新图片出现。那么，一个电子商务组织如何才能充分利用这些海量数据呢？在这里，网络分析开始发挥作用。</p><p id="0d1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个博客中，我们将学习以下内容:</p><ul class=""><li id="b406" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">什么是网络分析？</li><li id="e273" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">用于网络分析的指标。</li><li id="2729" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">什么是预测性网络分析</li><li id="a337" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">执行预测性网络分析的步骤</li><li id="3bb9" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">案例研究:使用Web数据构建预测模型</li><li id="02c7" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">结论</li></ul><p id="6599" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么，让我们开始…</p><h1 id="e95e" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">什么是网络分析</h1><p id="9b7f" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">Web analytics是对网站数据的收集、报告和分析，根据您的组织和用户目标来确定衡量标准，并使用网站数据来确定这些目标的成功或失败，并得出实现目标和改善用户体验的策略。</p><h1 id="0d79" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">用于网络分析的指标:</h1><p id="3a7c" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">网络分析专家跟踪的一些常见网络指标包括:</p><ul class=""><li id="c77b" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">网站接收的访问者数量。</li><li id="e084" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">网络流量的来源。</li><li id="1a7a" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">用户在每页上花费的时间</li><li id="0a08" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">哪些链接被点击，哪些没有被点击</li><li id="a9a3" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">网站在搜索引擎结果中的表现如何</li></ul><p id="6423" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更多详情，请访问:</p><p id="2ade" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae ku" href="https://www.cooladata.com/wiki/display/webanalyticsbi/Web+Analytics+Metrics" rel="noopener ugc nofollow" target="_blank">https://www . cooladata . com/wiki/display/webanalyticsbi/Web+Analytics+Metrics</a></p><h1 id="52eb" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">什么是预测性网络分析</h1><p id="e39f" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">基于这些收集到的指标，我们可以使用预测模型来预测特定的客户行为，以便采取纠正措施来实现我们的目标。</p><p id="fd55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，预测分析是一套帮助我们预测客户行为的方法。您应该选择预测分析策略的一些原因如下:</p><ul class=""><li id="ca5d" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">传统的网络分析工具产生大量的点击流数据，预测分析有助于过滤噪音并超越聚合级指标。</li><li id="527d" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">分析模型有助于您理解各种数据点之间的复杂模式，这可以成为您决策过程的基础。</li><li id="40d5" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">它帮助你准备一个数据驱动的营销计划，分配适当的投资。</li></ul><p id="abdb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">预测性网络分析的几个例子如下:</p><p id="4ff9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该公司使用预测模型进行预测，通过向目标受众发送个性化消息来最大限度地提高其内容的参与率，这有助于提高其内容营销工作的投资回报率。</p><p id="f15c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样的原则也适用于更严格的电子邮件活动。你可以让机器学习算法根据人口统计、一天中的时间和其他因素来个性化主题行。</p><h1 id="ecd6" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">执行预测性网络分析的步骤</h1><p id="89da" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">现在，为了执行预测分析，您将需要以下内容:</p><p id="0f87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">目标</strong>:我们想要解决的业务问题。</p><p id="95a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据</strong>:拥有解决业务问题所需的正确数据。如果你有一个以用户为中心的商业模式，你可以获得关于你的客户行为的丰富数据。</p><p id="12ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">方法论</strong>:一旦你有了数据和明确的目标，你就可以开始考虑你将用来建立预测模型的统计方法。例如:通过聚类分析，我们可以将具有相似行为的用户分组，并可以制定营销策略来获得这些客户，或者通过逻辑分析，我们可以预测哪个客户可以购买某个计划。</p><p id="a4a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">工具</strong>:有多种预测分析工具可用。KNIME、RStudio、Alteryx Platform、MATLAB、IBM SPSS、Python和SAP Analytics Cloud就是其中的几个例子。我们必须牢记在心，选择最适合我们内部分析人才库和分配预算的正确工具。</p><p id="2879" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们将使用UCI机器学习发表的数据集建立一个预测模型。</p><h1 id="b199" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">个案研究</h1><p id="44ed" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">我们将使用网站上的客户访问数据建立一个预测模型。</p><p id="4736" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请参考<a class="ae ku" href="https://archive.ics.uci.edu/ml/datasets/Online+Shoppers+Purchasing+Intention+Dataset" rel="noopener ugc nofollow" target="_blank">这里的</a>以获取数据集及其详细信息。</p><p id="6a34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集信息:</p><p id="c279" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该数据集由12，330次客户访问网站的数据点组成。数据集的形成使得每个会话在一年的时间内属于不同的用户，以避免任何倾向于特定的活动、特殊的日子、用户简档或时期。</p><p id="5b84" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">属性信息:</strong></p><p id="c0b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该数据集由10个数值属性和8个类别属性组成。<br/>‘收益’:类级别。可能值:False和True。</p><p id="62a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“管理”、“管理持续时间”:表示访问者在该会话中访问的管理页面以及在每个页面类别中花费的总时间。</p><p id="117a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“信息”、“信息持续时间”:表示访问者在该会话中访问的信息相关页面以及在每个页面类别中花费的总时间。</p><p id="8e82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“产品相关”和“产品相关持续时间”:表示访问者在该会话中访问的产品相关页面以及在每个页面类别中花费的总时间。</p><p id="e8cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“跳出率”是指从该页面进入网站的访问者的百分比，然后在该会话期间离开，而不会触发对分析服务器的任何其他请求。</p><p id="1f5b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“退出率”描述了页面上退出的百分比。</p><p id="ea3b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“页面价值”特征表示用户在完成电子商务交易之前访问的网页的平均值。</p><p id="474e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“特殊日”功能表示网站访问时间与特定特殊日的接近程度。</p><p id="9c8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该数据集还包括一些其他特征，例如操作系统、浏览器、区域、流量类型、访问者类型(回头客或新访问者)、指示访问日期是否为周末的布尔值以及一年中的月份。</p><p id="06ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">目标:</strong>建立一个预测模型，决定客户是否购买，是指变量:收入是反应变量，其他是预测变量。</p><p id="9ec2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤1:导入所有需要的库</p><p id="9df6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大蟒</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="c988" class="le js hi la b fi lf lg l lh li">import numpy as np</span><span id="1426" class="le js hi la b fi lj lg l lh li">import matplotlib.pyplot as plt</span><span id="943f" class="le js hi la b fi lj lg l lh li">import pandas as pd</span></pre><p id="5dd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤2:上传所需的数据集</p><p id="9696" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大蟒</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="082e" class="le js hi la b fi lf lg l lh li">from google.colab import files</span><span id="7499" class="le js hi la b fi lj lg l lh li">uploaded=files.upload()</span><span id="7eba" class="le js hi la b fi lj lg l lh li">import io</span><span id="e63e" class="le js hi la b fi lj lg l lh li">df2=pd.read_csv(io.BytesIO(uploaded['online_shoppers_intention.csv']))</span></pre><p id="e32a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤3:获取数据集的大小</p><p id="54eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大蟒</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="6c3b" class="le js hi la b fi lf lg l lh li">df2.shape</span></pre><p id="3b48" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤4:从数据集中获取前10条记录</p><p id="bf5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大蟒</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="e898" class="le js hi la b fi lf lg l lh li">df2.head(10)</span></pre><p id="0a76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤5:获取数据集的描述性统计数据</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="7d6f" class="le js hi la b fi lf lg l lh li">df2.describe()</span></pre><p id="a0c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤6:缺失值的计数</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="8ddf" class="le js hi la b fi lf lg l lh li">mv=df2.isnull().sum()</span><span id="8ceb" class="le js hi la b fi lj lg l lh li">mv</span></pre><p id="c40e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第七步:画出带来收入的客户的百分比。“真”表示客户已经购买了产品，“假”表示客户没有购买产品。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="868f" class="le js hi la b fi lf lg l lh li">import seaborn as sns</span><span id="a528" class="le js hi la b fi lj lg l lh li">sns.set(style="whitegrid")</span><span id="2581" class="le js hi la b fi lj lg l lh li">plt.figure(figsize=(8,5))</span><span id="c283" class="le js hi la b fi lj lg l lh li">total = float(len(df2))</span><span id="83ae" class="le js hi la b fi lj lg l lh li">ax = sns.countplot(x="Revenue", data=df2)</span><span id="1386" class="le js hi la b fi lj lg l lh li">for p in ax.patches:</span><span id="c143" class="le js hi la b fi lj lg l lh li">percentage = '{:.1f}%'.format(100 * p.get_height()/total)</span><span id="5371" class="le js hi la b fi lj lg l lh li">x = p.get_x() + p.get_width()</span><span id="0a6e" class="le js hi la b fi lj lg l lh li">y = p.get_height()</span><span id="87f5" class="le js hi la b fi lj lg l lh li">ax.annotate(percentage, (x, y),ha='center')</span><span id="4b8b" class="le js hi la b fi lj lg l lh li">plt.show()</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es lk"><img src="../Images/0ed8989cf5b42f4debc623c2597e15b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/0*8IRGRoCUPGbOes9E"/></div></div></figure><p id="955d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤VisitorType的分发</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="abf1" class="le js hi la b fi lf lg l lh li">df2['VisitorType'].value_counts()</span><span id="b51b" class="le js hi la b fi lj lg l lh li">sns.set(style="whitegrid")</span><span id="e41a" class="le js hi la b fi lj lg l lh li">plt.figure(figsize=(8,5))</span><span id="b59f" class="le js hi la b fi lj lg l lh li">total = float(len(df2))</span><span id="6941" class="le js hi la b fi lj lg l lh li">ax = sns.countplot(x="VisitorType", data=df2)</span><span id="12fd" class="le js hi la b fi lj lg l lh li">for p in ax.patches:</span><span id="a639" class="le js hi la b fi lj lg l lh li">percentage = '{:.1f}%'.format(100 * p.get_height()/total)</span><span id="0ffa" class="le js hi la b fi lj lg l lh li">x = p.get_x() + p.get_width()</span><span id="e942" class="le js hi la b fi lj lg l lh li">y = p.get_height()</span><span id="a678" class="le js hi la b fi lj lg l lh li">ax.annotate(percentage, (x, y),ha='center')</span><span id="ba5d" class="le js hi la b fi lj lg l lh li">plt.show()</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es ls"><img src="../Images/1194ba959b7c2d68bc2733ac649c727e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8FpaXs_QLOO9jEHk"/></div></div></figure><p id="0dbe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤9:在“周末”期间“访问者类型”的百分比分布</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="f6e6" class="le js hi la b fi lf lg l lh li">x,y = 'VisitorType', 'Weekend'</span><span id="184f" class="le js hi la b fi lj lg l lh li">df1 = df2.groupby(x)[y].value_counts(normalize=True)</span><span id="7cb2" class="le js hi la b fi lj lg l lh li">df1 = df1.mul(100)</span><span id="c07c" class="le js hi la b fi lj lg l lh li">df1 = df1.rename('percent').reset_index()</span><span id="ae26" class="le js hi la b fi lj lg l lh li">g = sns.catplot(x=x,y='percent',hue=y,kind='bar',data=df1)</span><span id="13eb" class="le js hi la b fi lj lg l lh li">g.ax.set_ylim(0,100)</span><span id="7a83" class="le js hi la b fi lj lg l lh li">for p in g.ax.patches:</span><span id="df23" class="le js hi la b fi lj lg l lh li">txt = str(p.get_height().round(2)) + '%'</span><span id="0435" class="le js hi la b fi lj lg l lh li">txt_x = p.get_x()</span><span id="630d" class="le js hi la b fi lj lg l lh li">txt_y = p.get_height()</span><span id="b2d8" class="le js hi la b fi lj lg l lh li">g.ax.text(txt_x,txt_y,txt)</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div class="er es lt"><img src="../Images/fcadbcd88867f276a905a6caef9c395b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*UryDQWzYqOSiBCHE"/></div></figure><p id="d179" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤10:不同流量类型的收入分配(购买或不购买)</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="8249" class="le js hi la b fi lf lg l lh li">x='TrafficType'</span><span id="f540" class="le js hi la b fi lj lg l lh li">y= 'Revenue'</span><span id="a42a" class="le js hi la b fi lj lg l lh li">df1 = df2.groupby(x)[y].value_counts(normalize=True)</span><span id="477e" class="le js hi la b fi lj lg l lh li">df1 = df1.mul(100)</span><span id="178f" class="le js hi la b fi lj lg l lh li">df1 = df1.rename('percent').reset_index()</span><span id="6553" class="le js hi la b fi lj lg l lh li">g = sns.catplot(x=x,y='percent',hue=y,kind='bar',data=df1)</span><span id="8b84" class="le js hi la b fi lj lg l lh li">g.ax.set_ylim(0,100)</span><span id="4461" class="le js hi la b fi lj lg l lh li">for p in g.ax.patches:</span><span id="d9c9" class="le js hi la b fi lj lg l lh li">txt = str(p.get_height().round(2)) + '%'</span><span id="75b0" class="le js hi la b fi lj lg l lh li">txt_x = p.get_x()</span><span id="d696" class="le js hi la b fi lj lg l lh li">txt_y = p.get_height()</span><span id="0baa" class="le js hi la b fi lj lg l lh li">g.ax.text(txt_x,txt_y,txt)</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div class="er es lt"><img src="../Images/43574eba0a2d1277e177be46e7516c11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*eno4q1iWaSTK1Uno"/></div></figure><p id="a0a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤11:基于不同业务类型代码的客户分布</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="3cb9" class="le js hi la b fi lf lg l lh li">plt.hist(df2['TrafficType'])</span><span id="44bf" class="le js hi la b fi lj lg l lh li">plt.title('Distribution of diff Traffic',fontsize = 30)</span><span id="8f32" class="le js hi la b fi lj lg l lh li">plt.xlabel('TrafficType Codes', fontsize = 15)</span><span id="5c93" class="le js hi la b fi lj lg l lh li">plt.ylabel('Count', fontsize = 15)</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div class="er es lt"><img src="../Images/6d489c848317c220ca4bb4e0674e60fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*rHPgSDjkij7ZFK1A"/></div></figure><p id="bdeb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤12:基于区域代码的客户分布</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="9f26" class="le js hi la b fi lf lg l lh li">plt.hist(df2['Region'])</span><span id="64c9" class="le js hi la b fi lj lg l lh li">plt.title('Distribution of Customers',fontsize = 30)</span><span id="fe1a" class="le js hi la b fi lj lg l lh li">plt.xlabel('Region Codes', fontsize = 15)</span><span id="4740" class="le js hi la b fi lj lg l lh li">plt.ylabel('Count', fontsize = 15)</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div class="er es lt"><img src="../Images/6d1b2b13c1b79531477936708576b056.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*mE9RfyuxP3e9Hran"/></div></figure><p id="5ec8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤13:操作系统上的客户分布</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="926d" class="le js hi la b fi lf lg l lh li">plt.hist(df2['OperatingSystems'])</span><span id="63ae" class="le js hi la b fi lj lg l lh li">plt.title('Distribution of Customers',fontsize = 30)</span><span id="4f4e" class="le js hi la b fi lj lg l lh li">plt.xlabel('OperatingSystems', fontsize = 15)</span><span id="19f3" class="le js hi la b fi lj lg l lh li">plt.ylabel('Count', fontsize = 15)</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div class="er es lt"><img src="../Images/1ccffb79156e2ca2584aa52b614c198f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*xl3wLYqWbQoERrPo"/></div></figure><p id="c48c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤14:客户在几个月内的分布</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="2467" class="le js hi la b fi lf lg l lh li">plt.hist(df2['Month'])</span><span id="8634" class="le js hi la b fi lj lg l lh li">plt.title('Distribution of Customers',fontsize = 30)</span><span id="9c52" class="le js hi la b fi lj lg l lh li">plt.xlabel('Month', fontsize = 15)</span><span id="6792" class="le js hi la b fi lj lg l lh li">plt.ylabel('Count', fontsize = 15)</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div class="er es lt"><img src="../Images/2effbcb1bf7130892245fbcf93a2ae7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*F5fB3upqCuhfz2IC"/></div></figure><p id="0532" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第15步:页面价值在收入中的分布。seaborn.stripplot绘制一个散点图，其中一个变量是分类变量。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="3dcc" class="le js hi la b fi lf lg l lh li">sns.stripplot(df2['Revenue'], df2['PageValues'])</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div class="er es lt"><img src="../Images/1255dc42d5fa425c6c0b84478684253f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*3sgS7d42fGEvoUYn"/></div></figure><p id="2f88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤16:收入在反弹率上的分配</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="7c30" class="le js hi la b fi lf lg l lh li">sns.stripplot(df2['Revenue'], df2['BounceRates'])</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div class="er es lt"><img src="../Images/2b75c2bdd46b45f96ae93a8060a3e5a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*c7hCaUMJVtjgabPA"/></div></figure><p id="3cf2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤17:流量类型在收入中的分布</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="0218" class="le js hi la b fi lf lg l lh li">df = pd.crosstab(df2['TrafficType'], df2['Revenue'])</span><span id="e338" class="le js hi la b fi lj lg l lh li">df.div(df.sum(1).astype(float), axis = 0).plot(kind = 'bar', stacked = True)</span><span id="d75f" class="le js hi la b fi lj lg l lh li">plt.title('Traffic Type vs Revenue', fontsize = 30)</span><span id="6c2a" class="le js hi la b fi lj lg l lh li">plt.show()</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div class="er es lt"><img src="../Images/a4055d56f572eba133478fe44299fa4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*8LP3NECXmxJedq3X"/></div></figure><p id="d491" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤18:收入的地区分配</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="0568" class="le js hi la b fi lf lg l lh li">ax4=sns.countplot(df2['Region'],hue='Revenue', data=df2)</span><span id="897c" class="le js hi la b fi lj lg l lh li">with_hue(ax3,df2.Region,2,2)</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div class="er es lt"><img src="../Images/9ed50d10ef4be78d557c668c080a989c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*IrgqB1hfmBfIdCgj"/></div></figure><p id="3d58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤19:管理和信息之间的线性回归图</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="841b" class="le js hi la b fi lf lg l lh li">sns.lmplot(x = 'Administrative', y = 'Informational', data = df2, x_jitter = 0.05)</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div class="er es lt"><img src="../Images/d2c4aa89419b5e2333d0c10e17caf0dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*U9kzgunmdo3iDR7N"/></div></figure><p id="e069" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤20:多变量分析。</p><p id="0d87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">月收入与页面价值之比</p><p id="7b94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">sns.boxplot(x = df2['Month']，y = df2['PageValues']，hue = df2['Revenue']，palette = 'inferno ')</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="3694" class="le js hi la b fi lf lg l lh li">plt.title('Mon. vs PageValues w.r.t. Rev.', fontsize = 30)</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div class="er es lt"><img src="../Images/2ede425ec184786af3c107ec1ac01be8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*kA8HPn_3slLRBWwT"/></div></figure><p id="69d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第22步:月收入与营业收入的对比</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="b056" class="le js hi la b fi lf lg l lh li"># month vs bouncerates wrt revenue</span><span id="c611" class="le js hi la b fi lj lg l lh li">sns.boxplot(x = df2['Month'], y = df2['BounceRates'], hue = df2['Revenue'], palette = 'Oranges')</span><span id="57a5" class="le js hi la b fi lj lg l lh li">plt.title('Mon. vs BounceRates w.r.t. Rev.', fontsize = 30)</span></pre><p id="6341" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第23步:游客类型与退场率和收入</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="3a11" class="le js hi la b fi lf lg l lh li"># visitor type vs BounceRates w.r.t revenue</span><span id="38d8" class="le js hi la b fi lj lg l lh li">sns.boxplot(x = df2['VisitorType'], y = df2['BounceRates'], hue = df2['Revenue'], palette = 'Purples')</span><span id="4e85" class="le js hi la b fi lj lg l lh li">plt.title('Visitors vs BounceRates w.r.t. Rev.', fontsize = 30)</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es lu"><img src="../Images/e3b2fe4e230b371fb4ea18ec8429e0d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/0*fDeH9vBIZKIvLlL0"/></div></div></figure><figure class="kv kw kx ky fd ll er es paragraph-image"><div class="er es lt"><img src="../Images/dc880f68ce81448a11783929c5a94874.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*EjKJqP3Knx9yy914"/></div></figure><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="dd95" class="le js hi la b fi lf lg l lh li">df2.fillna(0, inplace = True)</span><span id="757b" class="le js hi la b fi lj lg l lh li"># checking the no. of null values in data after imputing the missing value</span><span id="c8c4" class="le js hi la b fi lj lg l lh li">df2.isnull().sum().sum()</span></pre><p id="f379" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第24步:营销中聚类分析的目标是准确细分客户，以便通过个性化实现更有效的客户营销。一种常见的聚类分析方法是一种数学算法，称为k-means聚类分析，有时也称为科学分割。</p><p id="097c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">客户群管理持续时间与跳出率。我们认为第1列是管理持续时间，第6列是跳出率。我们总共建立了11个集群。</p><p id="728e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">WCSS:一种测量方法是聚类平方和(WCSS)，它测量聚类内所有点到聚类质心的平均距离的平方。要计算WCSS，首先要找到一个给定点和它的质心之间的欧几里德距离(见下图)。</p><p id="7100" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，肘形法是WCSS和簇数之间的关系图。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="14cd" class="le js hi la b fi lf lg l lh li"># preparing the dataset</span><span id="5dbf" class="le js hi la b fi lj lg l lh li">x = df2.iloc[:, [1, 6]].values</span><span id="d685" class="le js hi la b fi lj lg l lh li"># checking the shape of the dataset</span><span id="9849" class="le js hi la b fi lj lg l lh li">x.shape</span><span id="d089" class="le js hi la b fi lj lg l lh li">from sklearn.cluster import KMeans</span><span id="440b" class="le js hi la b fi lj lg l lh li">wcss = []</span><span id="5ecb" class="le js hi la b fi lj lg l lh li">for i in range(1, 11):</span><span id="ed39" class="le js hi la b fi lj lg l lh li">km = KMeans(n_clusters = i,</span><span id="f154" class="le js hi la b fi lj lg l lh li">init = 'k-means++',</span><span id="3bbd" class="le js hi la b fi lj lg l lh li">max_iter = 300,</span><span id="c92f" class="le js hi la b fi lj lg l lh li">n_init = 10,</span><span id="3db1" class="le js hi la b fi lj lg l lh li">random_state = 0,</span><span id="bf6f" class="le js hi la b fi lj lg l lh li">algorithm = 'elkan',</span><span id="98e8" class="le js hi la b fi lj lg l lh li">tol = 0.001)</span><span id="d564" class="le js hi la b fi lj lg l lh li">km.fit(x)</span><span id="0328" class="le js hi la b fi lj lg l lh li">labels = km.labels</span><span id="3d00" class="le js hi la b fi lj lg l lh li">wcss.append(km.inertia_)</span><span id="b466" class="le js hi la b fi lj lg l lh li">plt.rcParams['figure.figsize'] = (15, 7)</span><span id="1033" class="le js hi la b fi lj lg l lh li">plt.plot(range(1, 11), wcss)</span><span id="9180" class="le js hi la b fi lj lg l lh li">plt.grid()</span><span id="c9b1" class="le js hi la b fi lj lg l lh li">plt.tight_layout()</span><span id="a478" class="le js hi la b fi lj lg l lh li">plt.title('The Elbow Method', fontsize = 20)</span><span id="c557" class="le js hi la b fi lj lg l lh li">plt.xlabel('No. of Clusters')</span><span id="1e0a" class="le js hi la b fi lj lg l lh li">plt.ylabel('wcss')</span><span id="e6de" class="le js hi la b fi lj lg l lh li">plt.show()</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es lv"><img src="../Images/0e8c18cca26f02231630295f5a13cf16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tJbfZ3drcLSVVWGn"/></div></div></figure><p id="965e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第25步:最大弯曲出现在第三个指标上，即管理持续时间和收益的最优聚类数为3。绘制聚类图</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="2fb9" class="le js hi la b fi lf lg l lh li">km = KMeans(n_clusters = 3, init = 'k-means++', max_iter = 300, n_init = 10, random_state = 0</span><span id="2914" class="le js hi la b fi lj lg l lh li">y_means = km.fit_predict(x)</span><span id="50eb" class="le js hi la b fi lj lg l lh li">plt.scatter(x[y_means == 0, 0], x[y_means == 0, 1], s = 100, c = 'red', label = 'Un-interested Customers')</span><span id="6565" class="le js hi la b fi lj lg l lh li">plt.scatter(x[y_means == 1, 0], x[y_means == 1, 1], s = 100, c = 'yellow', label = 'General Customers')</span><span id="0dfc" class="le js hi la b fi lj lg l lh li">plt.scatter(x[y_means == 2, 0], x[y_means == 2, 1], s = 100, c = 'green', label = 'Target Customers')</span><span id="9d89" class="le js hi la b fi lj lg l lh li">plt.scatter(km.cluster_centers_[:,0], km.cluster_centers_[:, 1], s = 50, c = 'blue' , label = 'centeroid')</span><span id="5bcc" class="le js hi la b fi lj lg l lh li">plt.title('Administrative Duration vs Duration', fontsize = 20)</span><span id="51cd" class="le js hi la b fi lj lg l lh li">plt.grid()</span><span id="6e29" class="le js hi la b fi lj lg l lh li">plt.xlabel('Administrative Duration')</span><span id="75ca" class="le js hi la b fi lj lg l lh li">plt.ylabel('Bounce Rates')</span><span id="060f" class="le js hi la b fi lj lg l lh li">plt.legend()</span><span id="60c1" class="le js hi la b fi lj lg l lh li">plt.show()</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es lv"><img src="../Images/892e70731f21526bb2cb61fd1d379275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*S9q4KaErDm9CEBjR"/></div></div></figure><p id="cdb3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第26步:我们认为第3列是信息持续时间，第6列是跳出率。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="6f45" class="le js hi la b fi lf lg l lh li"># informational duration vs Bounce Rates</span><span id="651f" class="le js hi la b fi lj lg l lh li">x = df2.iloc[:, [3, 6]].values</span><span id="6a84" class="le js hi la b fi lj lg l lh li">wcss = []</span><span id="9d61" class="le js hi la b fi lj lg l lh li">for i in range(1, 11):</span><span id="88f4" class="le js hi la b fi lj lg l lh li">km = KMeans(n_clusters = i,</span><span id="0bf3" class="le js hi la b fi lj lg l lh li">init = 'k-means++',</span><span id="d374" class="le js hi la b fi lj lg l lh li">max_iter = 300,</span><span id="055f" class="le js hi la b fi lj lg l lh li">n_init = 10,</span><span id="519e" class="le js hi la b fi lj lg l lh li">random_state = 0,</span><span id="8a06" class="le js hi la b fi lj lg l lh li">algorithm = 'elkan',</span><span id="20d2" class="le js hi la b fi lj lg l lh li">tol = 0.001)</span><span id="0bdd" class="le js hi la b fi lj lg l lh li">km.fit(x)</span><span id="edd2" class="le js hi la b fi lj lg l lh li">labels = km.labels_</span><span id="b6c1" class="le js hi la b fi lj lg l lh li">wcss.append(km.inertia_)</span><span id="71ec" class="le js hi la b fi lj lg l lh li">plt.rcParams['figure.figsize'] = (15, 7)</span><span id="6dc2" class="le js hi la b fi lj lg l lh li">plt.plot(range(1, 11), wcss)</span><span id="b56e" class="le js hi la b fi lj lg l lh li">plt.grid()</span><span id="d25d" class="le js hi la b fi lj lg l lh li">plt.tight_layout()</span><span id="87c4" class="le js hi la b fi lj lg l lh li">plt.title('The Elbow Method', fontsize = 20)</span><span id="026d" class="le js hi la b fi lj lg l lh li">plt.xlabel('No. of Clusters')</span><span id="0949" class="le js hi la b fi lj lg l lh li">plt.ylabel('wcss')</span><span id="23d6" class="le js hi la b fi lj lg l lh li">plt.show()</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es lv"><img src="../Images/8658fc9a0c710baf66cae45fe76a7cab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UxhFns3WulL2RMtD"/></div></div></figure><p id="2eec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤27:这里，我们有两个集群</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="b99c" class="le js hi la b fi lf lg l lh li">km = KMeans(n_clusters = 2, init = 'k-means++', max_iter = 300, n_init = 10, random_state = 0)</span><span id="be19" class="le js hi la b fi lj lg l lh li">y_means = km.fit_predict(x)</span><span id="900e" class="le js hi la b fi lj lg l lh li">plt.scatter(x[y_means == 0, 0], x[y_means == 0, 1], s = 100, c = 'red', label = 'Un-interested Customers')</span><span id="80e2" class="le js hi la b fi lj lg l lh li">plt.scatter(x[y_means == 1, 0], x[y_means == 1, 1], s = 100, c = 'yellow', label = 'Target Customers')</span><span id="9b3d" class="le js hi la b fi lj lg l lh li">plt.scatter(km.cluster_centers_[:,0], km.cluster_centers_[:, 1], s = 50, c = 'blue' , label = 'centeroid')</span><span id="0b0c" class="le js hi la b fi lj lg l lh li">plt.title('Informational Duration vs Bounce Rates', fontsize = 20)</span><span id="73be" class="le js hi la b fi lj lg l lh li">plt.grid()</span><span id="57c2" class="le js hi la b fi lj lg l lh li">plt.xlabel('Informational Duration')</span><span id="719c" class="le js hi la b fi lj lg l lh li">plt.ylabel('Bounce Rates')</span><span id="740c" class="le js hi la b fi lj lg l lh li">plt.legend()</span><span id="1d69" class="le js hi la b fi lj lg l lh li">plt.show()</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es lv"><img src="../Images/ab19a270826db3160ecdb3aa7b0571a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8u1rH0J-JgyxyYq1"/></div></div></figure><p id="b252" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第28步:客户来自哪里:地区与交通类型</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="27c5" class="le js hi la b fi lf lg l lh li"># Region vs Traffic Type</span><span id="d5ab" class="le js hi la b fi lj lg l lh li">x = df2.iloc[:, [13, 14]].values</span><span id="f1c9" class="le js hi la b fi lj lg l lh li">wcss = []</span><span id="f795" class="le js hi la b fi lj lg l lh li">for i in range(1, 11):</span><span id="67d9" class="le js hi la b fi lj lg l lh li">km = KMeans(n_clusters = i,</span><span id="8535" class="le js hi la b fi lj lg l lh li">init = 'k-means++',</span><span id="7e22" class="le js hi la b fi lj lg l lh li">max_iter = 300,</span><span id="2444" class="le js hi la b fi lj lg l lh li">n_init = 10,</span><span id="e271" class="le js hi la b fi lj lg l lh li">random_state = 0,</span><span id="f25b" class="le js hi la b fi lj lg l lh li">algorithm = 'elkan',</span><span id="57b5" class="le js hi la b fi lj lg l lh li">tol = 0.001)</span><span id="7996" class="le js hi la b fi lj lg l lh li">km.fit(x)</span><span id="2dec" class="le js hi la b fi lj lg l lh li">labels = km.labels_</span><span id="4d74" class="le js hi la b fi lj lg l lh li">wcss.append(km.inertia_)</span><span id="7a31" class="le js hi la b fi lj lg l lh li">plt.rcParams['figure.figsize'] = (15, 7)</span><span id="914a" class="le js hi la b fi lj lg l lh li">plt.plot(range(1, 11), wcss)</span><span id="5027" class="le js hi la b fi lj lg l lh li">plt.grid()</span><span id="bab5" class="le js hi la b fi lj lg l lh li">plt.tight_layout()</span><span id="2260" class="le js hi la b fi lj lg l lh li">plt.title('The Elbow Method', fontsize = 20)</span><span id="6d35" class="le js hi la b fi lj lg l lh li">plt.xlabel('No. of Clusters')</span><span id="acde" class="le js hi la b fi lj lg l lh li">plt.ylabel('wcss')</span><span id="aed4" class="le js hi la b fi lj lg l lh li">plt.show()</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es lv"><img src="../Images/eec21248b6c2965effd730c14d34bedb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*58kaj7ubwJp_jv2R"/></div></div></figure><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="f47d" class="le js hi la b fi lf lg l lh li">km = KMeans(n_clusters = 2, init = 'k-means++', max_iter = 300, n_init = 10, random_state = 0)</span><span id="98f9" class="le js hi la b fi lj lg l lh li">y_means = km.fit_predict(x)</span><span id="2ffd" class="le js hi la b fi lj lg l lh li">plt.scatter(x[y_means == 0, 0], x[y_means == 0, 1], s = 100, c = 'red', label = 'Un-interested Customers')</span><span id="f738" class="le js hi la b fi lj lg l lh li">plt.scatter(x[y_means == 1, 0], x[y_means == 1, 1], s = 100, c = 'yellow', label = 'Target Customers')</span><span id="31e6" class="le js hi la b fi lj lg l lh li">plt.scatter(km.cluster_centers_[:,0], km.cluster_centers_[:, 1], s = 50, c = 'blue' , label = 'centeroid')</span><span id="3b4e" class="le js hi la b fi lj lg l lh li">plt.title('Region vs Traffic Type', fontsize = 20)</span><span id="e13a" class="le js hi la b fi lj lg l lh li">plt.grid()</span><span id="ad95" class="le js hi la b fi lj lg l lh li">plt.xlabel('Region')</span><span id="d7f9" class="le js hi la b fi lj lg l lh li">plt.ylabel('Traffic')</span><span id="6faa" class="le js hi la b fi lj lg l lh li">plt.legend()</span><span id="b94c" class="le js hi la b fi lj lg l lh li">plt.show()</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es lv"><img src="../Images/d1a858c2bd15994f12d3163367d909f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T7hiqik4h6a0LCA_"/></div></div></figure><p id="23a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤29:数据预处理以建立随机森林分类器和逻辑回归。这里，我们希望预测客户是否会购买。所以，我们使用了二元分类器。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="1544" class="le js hi la b fi lf lg l lh li"># one hot encoding</span><span id="181f" class="le js hi la b fi lj lg l lh li">data1 = pd.get_dummies(df2)</span><span id="50f8" class="le js hi la b fi lj lg l lh li">data1.columns</span><span id="2f93" class="le js hi la b fi lj lg l lh li">from sklearn.preprocessing import LabelEncoder</span><span id="2cae" class="le js hi la b fi lj lg l lh li">le = LabelEncoder()</span><span id="b623" class="le js hi la b fi lj lg l lh li">df2['Revenue'] = le.fit_transform(df2['Revenue'])</span><span id="9dd4" class="le js hi la b fi lj lg l lh li">df2['Revenue'].value_counts()</span><span id="26e2" class="le js hi la b fi lj lg l lh li"># getting dependent and independent variables</span><span id="96da" class="le js hi la b fi lj lg l lh li">x=data1</span><span id="c32a" class="le js hi la b fi lj lg l lh li"># removing the target column revenue from </span><span id="0123" class="le js hi la b fi lj lg l lh li">x = x.drop(['Revenue'], axis = 1)</span><span id="35d5" class="le js hi la b fi lj lg l lh li">y = data1['Revenue']</span><span id="987f" class="le js hi la b fi lj lg l lh li"># checking the shapes</span><span id="9cb2" class="le js hi la b fi lj lg l lh li">print("Shape of x:", x.shape)</span><span id="4328" class="le js hi la b fi lj lg l lh li">print("Shape of y:", y.shape)</span></pre><p id="0302" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤30:在训练集和测试集之间分割数据</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="c750" class="le js hi la b fi lf lg l lh li"># splitting the data</span><span id="b4d3" class="le js hi la b fi lj lg l lh li">from sklearn.model_selection import train_test_spli</span><span id="fe27" class="le js hi la b fi lj lg l lh li">x_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.3, random_state = 0)</span><span id="107f" class="le js hi la b fi lj lg l lh li"># checking the shape</span><span id="3689" class="le js hi la b fi lj lg l lh li">print("Shape of x_train :", x_train.shape)</span><span id="5ea5" class="le js hi la b fi lj lg l lh li">print("Shape of y_train :", y_train.shape)</span><span id="cf65" class="le js hi la b fi lj lg l lh li">print("Shape of x_test :", x_test.shape)</span><span id="4c04" class="le js hi la b fi lj lg l lh li">print("Shape of y_test :", y_test.shape)</span></pre><p id="e319" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤31:随机森林分类器模型构建</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="07f5" class="le js hi la b fi lf lg l lh li"># MODELLING</span><span id="424f" class="le js hi la b fi lj lg l lh li">from sklearn.ensemble import RandomForestClassifier</span><span id="1abd" class="le js hi la b fi lj lg l lh li">from sklearn.metrics import confusion_matrix</span><span id="01ef" class="le js hi la b fi lj lg l lh li">from sklearn.metrics import classification_report</span><span id="5a51" class="le js hi la b fi lj lg l lh li">model = RandomForestClassifier()</span><span id="a2f0" class="le js hi la b fi lj lg l lh li">model.fit(x_train, y_train)</span><span id="3adc" class="le js hi la b fi lj lg l lh li">y_pred = model.predict(x_test)</span><span id="9f9e" class="le js hi la b fi lj lg l lh li"># evaluating the model</span><span id="ba45" class="le js hi la b fi lj lg l lh li">print("Training Accuracy :", model.score(x_train, y_train))</span><span id="f274" class="le js hi la b fi lj lg l lh li">print("Testing Accuracy :", model.score(x_test, y_test))</span></pre><p id="b6e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第32步:混淆矩阵。模型准确率为89%。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="402d" class="le js hi la b fi lf lg l lh li"># confusion matrix</span><span id="72e3" class="le js hi la b fi lj lg l lh li">cm = confusion_matrix(y_test, y_pred)</span><span id="e438" class="le js hi la b fi lj lg l lh li">plt.rcParams['figure.figsize'] = (6, 6)</span><span id="2e80" class="le js hi la b fi lj lg l lh li">sns.heatmap(cm ,annot = True)</span><span id="d4c7" class="le js hi la b fi lj lg l lh li"># classification report</span><span id="5d78" class="le js hi la b fi lj lg l lh li">cr = classification_report(y_test, y_pred)<br/>print(cr)</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div class="er es lt"><img src="../Images/edef4e48ef35d2611a3473938bac3a86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*Uz0gS8DybRmIxRh4"/></div></figure><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="b1c0" class="le js hi la b fi lf lg l lh li">cm = confusion_matrix(y, model.predict(x))</span><span id="94f4" class="le js hi la b fi lj lg l lh li">fig, ax = plt.subplots(figsize=(8, 8))</span><span id="43fe" class="le js hi la b fi lj lg l lh li">ax.imshow(cm)</span><span id="73ae" class="le js hi la b fi lj lg l lh li">ax.grid(False)</span><span id="abe2" class="le js hi la b fi lj lg l lh li">ax.xaxis.set(ticks=(0, 1), ticklabels=('Predicted 0s', 'Predicted 1s'))</span><span id="892f" class="le js hi la b fi lj lg l lh li">ax.yaxis.set(ticks=(0, 1), ticklabels=('Actual 0s', 'Actual 1s'))</span><span id="a091" class="le js hi la b fi lj lg l lh li">ax.set_ylim(1.5, -0.5)</span><span id="afdf" class="le js hi la b fi lj lg l lh li">for i in range(2):</span><span id="6b7e" class="le js hi la b fi lj lg l lh li">for j in range(2):</span><span id="e5bb" class="le js hi la b fi lj lg l lh li">ax.text(j, i, cm[i, j], ha='center', va='center', color='red')</span><span id="d9e0" class="le js hi la b fi lj lg l lh li">plt.show()</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div class="er es lw"><img src="../Images/d7c228296541cba08ab9f92039e3f06c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/0*WHdUCbR2A_3lsumf"/></div></figure><p id="d1d0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤33:绘制随机森林的ROC曲线</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="eeb6" class="le js hi la b fi lf lg l lh li">from sklearn.metrics import plot_roc_curve</span><span id="c343" class="le js hi la b fi lj lg l lh li">rf_disp = plot_roc_curve(model, x_test, y_test)</span><span id="e396" class="le js hi la b fi lj lg l lh li">plt.show()</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div class="er es lt"><img src="../Images/6dcbbba4476006272debf43c2b916078.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*zjagCMBtiO8N-yB1"/></div></figure><p id="7849" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤34:将随机森林模型的预测保存到一个数据帧中，这个数据帧以后可以写入一个. csv文件中，这样我们就可以知道我们将从哪个客户那里获得收益。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="2dbc" class="le js hi la b fi lf lg l lh li">df=pd.DataFrame(y_pred,columns=["Revenue"])</span><span id="b8c2" class="le js hi la b fi lj lg l lh li">df</span></pre><p id="5d94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤35:建立逻辑回归模型</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="2026" class="le js hi la b fi lf lg l lh li">from sklearn.linear_model import LogisticRegression</span><span id="7ec8" class="le js hi la b fi lj lg l lh li">model1 = LogisticRegression(solver='liblinear', random_state=0)</span><span id="6b0b" class="le js hi la b fi lj lg l lh li">model1.fit(x_train, y_train</span><span id="1a3a" class="le js hi la b fi lj lg l lh li">y_pred1 = model1.predict(x_test)</span></pre><p id="6860" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第36步:打印混淆矩阵</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="3c8d" class="le js hi la b fi lf lg l lh li">from sklearn.metrics import confusion_matrix</span><span id="1778" class="le js hi la b fi lj lg l lh li">cm = confusion_matrix(y_test, y_pred)</span><span id="e6ab" class="le js hi la b fi lj lg l lh li">print ("Confusion Matrix : \n", cm)</span></pre><p id="bfac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤37:绘制混淆矩阵</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="ab1e" class="le js hi la b fi lf lg l lh li">cm = confusion_matrix(y, model.predict(x))</span><span id="c2eb" class="le js hi la b fi lj lg l lh li">fig, ax = plt.subplots(figsize=(8, 8))</span><span id="e7e7" class="le js hi la b fi lj lg l lh li">ax.imshow(cm)</span><span id="04fd" class="le js hi la b fi lj lg l lh li">ax.grid(False)</span><span id="ea80" class="le js hi la b fi lj lg l lh li">ax.xaxis.set(ticks=(0, 1), ticklabels=('Predicted 0s', 'Predicted 1s'))</span><span id="d1aa" class="le js hi la b fi lj lg l lh li">ax.yaxis.set(ticks=(0, 1), ticklabels=('Actual 0s', 'Actual 1s'))</span><span id="9371" class="le js hi la b fi lj lg l lh li">ax.set_ylim(1.5, -0.5)</span><span id="c860" class="le js hi la b fi lj lg l lh li">for i in range(2):</span><span id="b734" class="le js hi la b fi lj lg l lh li">for j in range(2):</span><span id="e152" class="le js hi la b fi lj lg l lh li">ax.text(j, i, cm[i, j], ha='center', va='center', color='red')</span><span id="36a2" class="le js hi la b fi lj lg l lh li">plt.show()</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div class="er es lx"><img src="../Images/dec54660600cd54229b4c55f4a6e413e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/0*8DsQpjP6eUJkTJ3j"/></div></figure><p id="c77f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤38:打印逻辑回归分类报告准确率为87%</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="7df5" class="le js hi la b fi lf lg l lh li"># classification report</span><span id="ab94" class="le js hi la b fi lj lg l lh li">cr1 = classification_report(y_test, y_pred1)</span><span id="abef" class="le js hi la b fi lj lg l lh li">print(cr1)</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div class="er es ly"><img src="../Images/78973c7f126d0f3401655495d8e03739.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/0*1bJbnd4JIx6-UZxa"/></div></figure><p id="102e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤39:绘制逻辑回归的ROC曲线</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="4afd" class="le js hi la b fi lf lg l lh li">from sklearn.metrics import plot_roc_curve</span><span id="a816" class="le js hi la b fi lj lg l lh li">lr_disp = plot_roc_curve(model1, x_test, y_test)</span><span id="5410" class="le js hi la b fi lj lg l lh li">plt.show()</span></pre><p id="4310" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤40:将逻辑回归模型的预测保存到数据框架中</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="f2fc" class="le js hi la b fi lf lg l lh li">df1 = pd.DataFrame(y_pred1, columns=["Revenue"])</span><span id="ce2b" class="le js hi la b fi lj lg l lh li">df1</span></pre><p id="6f6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">步骤41:绘制随机森林和逻辑回归的ROC曲线</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="f688" class="le js hi la b fi lf lg l lh li">ax = plt.gca()</span><span id="ac79" class="le js hi la b fi lj lg l lh li">rf_disp = plot_roc_curve(model, x_test, y_test, ax=ax, alpha=0.8</span><span id="4397" class="le js hi la b fi lj lg l lh li">lr_disp.plot(ax=ax, alpha=0.8)</span><span id="d8bd" class="le js hi la b fi lj lg l lh li">plt.show()</span></pre><figure class="kv kw kx ky fd ll er es paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="er es lt"><img src="../Images/cb37c1ca2793fe1e310f90e1dc329b36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*Ebq7G7lu3SeOUUpx"/></div></div></figure><h1 id="ddd8" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">结论</h1><p id="a613" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">在这篇博客中，我们了解了预测性网络分析、用于预测性网络分析的各种指标，进行了案例研究，执行了数据可视化，根据客户行为进行了聚类，建立了两个预测模型:随机森林分类器和逻辑分类器，使用混淆矩阵和ROC曲线比较了两个模型的性能，还将两个模型的预测写入了各自的数据框架，以便业务决策者可以通过将这些预测输出写入csv文件来了解将产生收入和不会产生收入的确切客户。</p><p id="c7ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望，你喜欢这篇文章。</p><p id="04ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">那么，对你来说…请给出这两个模型的性能调整，并让我知道评论框中的指标…</p><p id="26b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的下一个博客里再见…直到那时，快乐学习…敬请期待！</p></div></div>    
</body>
</html>