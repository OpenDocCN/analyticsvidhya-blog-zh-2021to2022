<html>
<head>
<title>COVID-19 World Immunization Race with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">新冠肺炎世界Python免疫比赛</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/covid-19-world-immunization-race-with-python-22c574e630cc?source=collection_archive---------15-----------------------#2021-02-24">https://medium.com/analytics-vidhya/covid-19-world-immunization-race-with-python-22c574e630cc?source=collection_archive---------15-----------------------#2021-02-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="52ba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">预测领奖台，在一张GIF中可视化疫苗接种演变，考察其黑马！</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/2b15189bcba2c7be10cd357df3d2618a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*qEj8h0IWDkobdKfq3l7pNQ.jpeg"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">戴安娜·波莱希娜在<a class="ae jo" href="https://unsplash.com/s/photos/coronavirus-vaccine?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure></div><div class="ab cl jp jq go jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="ha hb hc hd he"><p id="3236" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi jw translated">最近，我发现自己非常好奇，要多久才能最终看到我们的世界摆脱我们所处的这种非常历史性的局面。为此，我决定看看关于疫苗接种的最新数据，在这个过程中，我发现在GIF中看到一场完全免疫的比赛可能是一件很酷的事情——特别是如果它是用python编写的，结合了matplotlib和地理绘图！结果就是这种美。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es kf"><img src="../Images/f90262788c765ac796379d087e1812ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Uy5cxuCOUGhB8-TtFuSyLA.gif"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">很高兴知道新冠肺炎的群体免疫率可能达到70%。</figcaption></figure><h2 id="ca32" class="kk kl hh bd km kn ko kp kq kr ks kt ku ip kv kw kx it ky kz la ix lb lc ld le bi translated">酷！现在让我们来了解塞舌尔和智利。</h2><p id="c51e" class="pw-post-body-paragraph ie if hh ig b ih lf ij ik il lg in io ip lh ir is it li iv iw ix lj iz ja jb ha bi translated"><em class="lk">好吧，那么塞舌尔是什么</em>？我也是这么问自己的。根据维基百科:</p><blockquote class="ll lm ln"><p id="1bf3" class="ie if lk ig b ih ii ij ik il im in io lo iq ir is lp iu iv iw lq iy iz ja jb ha bi translated">塞舌尔是一个由115个岛屿组成的群岛国家，位于索马里海的东部边缘。</p></blockquote><p id="043a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">经过一些研究，可以理解为什么他们在我们的比赛中击败了世界其他国家——这是一个依靠旅游业生存的高经济(世界银行分类)国家。此外，他们的人口只有10万左右。</p><p id="550b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，以色列和阿拉伯联合酋长国获得第二和第三名并不奇怪，但是智利呢？是什么让它成为可能？</p><p id="fd10" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">智利毫不犹豫地尽早购买尽可能多的疫苗。事实上，他们现在已经订购了足够的剂量来对其人口进行两次免疫。智利采取的另一个好举措是为中国农场和阿斯利康主持疫苗试验，这给了他们很大的优势。</p></div><div class="ab cl jp jq go jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="ha hb hc hd he"><h1 id="de49" class="lr kl hh bd km ls lt lu kq lv lw lx ku ly lz ma kx mb mc md la me mf mg ld mh bi translated">获取代码！</h1><p id="b9c2" class="pw-post-body-paragraph ie if hh ig b ih lf ij ik il lg in io ip lh ir is it li iv iw ix lj iz ja jb ha bi translated">首先，这里的<a class="ae jo" href="https://github.com/ga-tardochisalles/covid-world-vaccination-progress" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">一应俱全</strong> </a> <strong class="ig hi"> </strong>上的<a class="ae jo" href="https://github.com/ga-tardochisalles" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">我的GitHub </strong> </a>。为了得到想要的结果，我将python 3.8与pandas、geopandas、matplotlib和numpy一起使用。</p><p id="6a9f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">项目目录结构(python代码在“src”文件夹中):</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mi"><img src="../Images/26b6dec9ad72dd49f64f5a9f6b7a4902.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*P591y2RrpqZN2ZezIrAxQA.png"/></div></figure><ol class=""><li id="5478" class="mj mk hh ig b ih ii il im ip ml it mm ix mn jb mo mp mq mr bi translated">让我们首先导入必要的库:</li></ol><pre class="jd je jf jg fd ms mt mu mv aw mw bi"><span id="fb77" class="kk kl hh mt b fi mx my l mz na">import os<br/>from datetime import datetime<br/>import matplotlib.pyplot as plt<br/>import pandas as pd<br/>pd.set_option('display.max_columns', 10)<br/>pd.set_option('display.max_rows', 50)<br/>import geopandas as gpd<br/>import numpy as np<br/>import math</span></pre><p id="fa24" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.下载并读取用于绘图的数据集/shape file:</p><pre class="jd je jf jg fd ms mt mu mv aw mw bi"><span id="d924" class="kk kl hh mt b fi mx my l mz na"># data gathered on 19th of Feb, 2021<br/>INFO_PATH = "../data/country_info.csv"  # <a class="ae jo" href="https://www.kaggle.com/koryto/countryinfo?select=covid19countryinfo.csv" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/koryto/countryinfo?select=covid19countryinfo.csv</a><br/>VACCINATION_PATH = "../data/country_vaccinations.csv"  # <a class="ae jo" href="https://www.kaggle.com/gpreda/covid-world-vaccination-progress" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/gpreda/covid-world-vaccination-progress</a><br/>SHAPEFILE_PATH = "../shapefiles/ne_10m_admin_0_countries_lakes/ne_10m_admin_0_countries_lakes.shp"  # <a class="ae jo" href="https://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/cultural/ne_10m_admin_0_countries_lakes.zip" rel="noopener ugc nofollow" target="_blank">https://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/cultural/ne_10m_admin_0_countries_lakes.zip</a></span><span id="3044" class="kk kl hh mt b fi nb my l mz na">info_df = pd.read_csv(INFO_PATH, usecols=["country", "alpha3code", "pop"])<br/>vac_df = pd.read_csv(VACCINATION_PATH, usecols=["country", "iso_code", "date", "total_vaccinations","daily_vaccinations"], parse_dates=["date"])<br/>geo_df = gpd.read_file(SHAPEFILE_PATH)[['ADM0_A3', 'geometry']].to_crs('+proj=robin')</span></pre><p id="0eb6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.创建一个我们拥有其每日疫苗接种信息的国家列表，并创建一个空列表来存储拥有足够“可信”数据的国家。此外，初始化字典以存储每个国家的“最早”和“最晚”数据点以及用于未来预测的期望每日疫苗接种值:</p><pre class="jd je jf jg fd ms mt mu mv aw mw bi"><span id="2299" class="kk kl hh mt b fi mx my l mz na">all_countries = vac_df[vac_df['daily_vaccinations'].isna() == False].country.unique().tolist()<br/>good_confidence_countries = []<br/>countries_daily_fforward = {}<br/>countries_first_update = {}<br/>countries_latest_update = {}</span></pre><p id="0a64" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4.循环选择将出现在分析中的国家(在这种情况下，至少有15天疫苗接种数据的国家),并填充字典:</p><pre class="jd je jf jg fd ms mt mu mv aw mw bi"><span id="e4a3" class="kk kl hh mt b fi mx my l mz na">for c in all_countries:<br/>    first_non_na_i = vac_df[(vac_df['daily_vaccinations'].isna() == False) &amp; (vac_df['country'] == c)].head(1).index.item()<br/>    this_c_df = vac_df[(vac_df.index &gt;= first_non_na_i) &amp; (vac_df.country == c)]<br/>    nans_after_first_nan = this_c_df.daily_vaccinations.isna().sum()<br/>    days_with_info = this_c_df.daily_vaccinations.notna().sum()<br/>    first_non_nan_update = this_c_df[this_c_df.daily_vaccinations.notna()]['date'].head(1).item()<br/>    latest_non_nan_update = this_c_df[this_c_df.daily_vaccinations.notna()]['date'].tail(1).item()<br/>    lastest_date = this_c_df['date'].tail(1).item()<br/>    if days_with_info &lt; 15:<br/>        continue<br/>    else:<br/>        good_confidence_countries.append(c)<br/>        all_time_mean = this_c_df[this_c_df.daily_vaccinations.notna()]['daily_vaccinations'].mean()<br/>        recent_mean = this_c_df[this_c_df.daily_vaccinations.notna()]['daily_vaccinations'].tail(5).mean()<br/>        selected_forward_daily_vac = math.floor(0.15 * all_time_mean + recent_mean * 0.85)<br/>        countries_daily_fforward[c] = selected_forward_daily_vac<br/>        countries_first_update[c] = first_non_nan_update<br/>        countries_latest_update[c] = latest_non_nan_update</span></pre><p id="e2fe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于这一步，我选择使用15%的历史平均值+ 85%的五个最新数据点平均值来预测未来的平均每日疫苗接种量。我决定这样做，因为看到下面两种情况中的一种是非常常见的，一个国家的每日疫苗接种数量可能会缓慢增长，然后停滞不前，或者可能会在一个高音符中开始(当他们接受一堆疫苗剂量时，突然下降，停滞不前)。为此，最好不要太关注他们早期接种疫苗的几周或几天，因为它不能对未来说太多:</p><pre class="jd je jf jg fd ms mt mu mv aw mw bi"><span id="4f1d" class="kk kl hh mt b fi mx my l mz na">plt.style.use('seaborn')<br/>fig, axes = plt.subplots(nrows=1, ncols=2, figsize=(10, 4))<br/>ax23 = fig.add_subplot(111, frameon = False)<br/>ax23.set_xlabel('Time (Sequencial Calendar Days)', fontsize=14)<br/>ax23.set_xticks([])<br/>ax23.set_yticks([])<br/>ax23.set_title("Brazil Curve x Sri Lanka Curve", fontsize=20)<br/>axes[0].plot(vac_df[vac_df['country'] == "Brazil"].dropna().date, vac_df[vac_df['country'] == "Brazil"].dropna().daily_vaccinations)<br/>axes[0].set_ylabel('Daily Vaccinations', fontsize=14)<br/>axes[1].plot(vac_df[vac_df['country'] == "Sri Lanka"].dropna().date, vac_df[vac_df['country'] == "Sri Lanka"].dropna().daily_vaccinations)<br/>for ax in axes:<br/>    ax.set_xticklabels([])<br/>    ax.set_xticks([])</span><span id="b884" class="kk kl hh mt b fi nb my l mz na">plt.show()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es nc"><img src="../Images/bcd565e2344bfed99d9d705d3720e770.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*UiU5ux9-dJDN9XSjABieGg.png"/></div></figure><p id="d1eb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们只保留我们想要的国家:</p><pre class="jd je jf jg fd ms mt mu mv aw mw bi"><span id="6a4b" class="kk kl hh mt b fi mx my l mz na">vac_df = vac_df[vac_df['country'].isin(good_confidence_countries)]</span></pre><p id="cfe9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">5.对于这一步，我将创建一个数据帧，其中每行代表一个{日期，国家}对，日期范围从我们第一次输入每日疫苗接种到2023年。首先我们应该知道起始日期:</p><pre class="jd je jf jg fd ms mt mu mv aw mw bi"><span id="2b79" class="kk kl hh mt b fi mx my l mz na">vac_df[vac_df['date'] == vac_df[vac_df.daily_vaccinations.notna()]['date'].min()]</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es nd"><img src="../Images/5da698fac3d34d87d6ed850ca9430caf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*rHqXJWxtTezNxC6wLNqkeQ.png"/></div></figure><p id="62f2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在用正确的日期和国家名称范围创建数据框架，我们称之为“clean_df”:</p><pre class="jd je jf jg fd ms mt mu mv aw mw bi"><span id="cce3" class="kk kl hh mt b fi mx my l mz na">def create_country_date_df(countries, start, end):<br/>    all_dfs = []<br/>    for country in countries:<br/>        df = pd.DataFrame({"date": pd.date_range(start, end), "country": country})<br/>        all_dfs.append(df)<br/>    concat_df = pd.concat(all_dfs, ignore_index=True)<br/>    return concat_df<br/>clean_df = create_country_date_df(good_confidence_countries, '2020-12-14', '2022-12-31')</span></pre><p id="cb6f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">6.将其与“vac_df”和“info_df”合并，以获得每日疫苗接种值(当其为NaN时，固定iso_code列)和各国所需的疫苗总数(2 *人口，因为每个人需要两剂疫苗):</p><pre class="jd je jf jg fd ms mt mu mv aw mw bi"><span id="afeb" class="kk kl hh mt b fi mx my l mz na">clean_df = pd.merge(left=clean_df, right=vac_df, how='left', on=['date','country'])<br/>clean_df["iso_code"] = clean_df.groupby("country").transform(lambda x: x.fillna(method="bfill"))["iso_code"]<br/>clean_df["iso_code"] = clean_df.groupby("country").transform(lambda x: x.fillna(method="ffill"))["iso_code"]<br/>clean_df = clean_df.merge(info_df[["alpha3code", "pop"]], how="left", left_on="iso_code", right_on="alpha3code").drop(['alpha3code'], axis=1).rename({"pop":"needed_vaccines"}, axis=1)<br/>clean_df['needed_vaccines'] = clean_df['needed_vaccines'].astype(np.int64) * 2 # converting from numpy.int32 to numpy.int64 to prevent overflow</span></pre><p id="cec6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">7.现在需要填写“每日接种疫苗”列NaNs，当NaNs在未来出现时(在一个国家的最后一个数据点之后)使用已经定义的每日平均值，当它在第一个数据点之前出现时为零，或者当它在这些日期之间出现时简单地向前填充:</p><pre class="jd je jf jg fd ms mt mu mv aw mw bi"><span id="2c3b" class="kk kl hh mt b fi mx my l mz na">def correct_daily_vac_col(x):<br/>    dt = x['date']<br/>    country = x['country']<br/>    before_first_info = dt &lt; countries_first_update[country]<br/>    after_last_info = dt &gt; countries_latest_update[country]<br/>    if before_first_info:<br/>        return 0<br/>    elif after_last_info:<br/>        return countries_daily_fforward[country]<br/>    elif pd.isnull(x['daily_vaccinations']):<br/>        return x['daily_vaccinations']<br/>    else:<br/>        return math.floor(x['daily_vaccinations'])<br/>clean_df['daily_vaccinations'] = clean_df.apply(lambda x: correct_daily_vac_col(x), axis=1)<br/>clean_df['daily_vaccinations'] = clean_df['daily_vaccinations'].fillna(method="ffill")</span></pre><p id="cfb8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">8.找出每个国家在每个日期接受免疫的总人口的百分比:</p><pre class="jd je jf jg fd ms mt mu mv aw mw bi"><span id="837d" class="kk kl hh mt b fi mx my l mz na">clean_df["total_vaccinations"] = clean_df.groupby(['country'])['daily_vaccinations'].cumsum(axis=0)<br/>clean_df["immunization_coverage"] = np.where((clean_df.total_vaccinations / clean_df.needed_vaccines) &lt; 1, (clean_df.total_vaccinations / clean_df.needed_vaccines), 1)<br/>clean_df['immunization_coverage'] = clean_df['immunization_coverage'] * 100  # transforming it to [0, 100] range</span></pre><p id="2e3b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">9.将其合并到geopandas数据框架中(缺少数据的国家/地区行将有nan):</p><pre class="jd je jf jg fd ms mt mu mv aw mw bi"><span id="3899" class="kk kl hh mt b fi mx my l mz na">merged = pd.merge(geo_df, clean_df, how='left', left_on='ADM0_A3', right_on='iso_code').drop(["iso_code"], axis=1)</span></pre><p id="1f89" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">10.<strong class="ig hi">最后</strong>，让我们迭代每个连续的日期，建立排行榜并绘制/保存图表(在这种情况下，每月只有三个图表！):</p><pre class="jd je jf jg fd ms mt mu mv aw mw bi"><span id="909e" class="kk kl hh mt b fi mx my l mz na">title = "      COVID-19 World Immunization Progress Until 2023"<br/>description = "If vaccination across various countries remain in the same pace(as on February 19th, 2021), thats how the race goes.\n"\<br/>"                   Data: Our World in Data - ourworldindata.org • Author: Gabriel Tardochi Salles".strip()<br/># set a variable that will call whatever column we want to visualise on the map<br/>variable = 'immunization_coverage'<br/># set the range for the choropleth<br/>vmin, vmax = 0, 100</span><span id="5902" class="kk kl hh mt b fi nb my l mz na">completely_immunized = []<br/>ranking = ''<br/># building and saving the ranking while creating the img files<br/>for date in clean_df.date.unique():<br/>    this_plot = merged[(merged['date'] == date) | (merged['date'].isna())]<br/>    date_time = pd.to_datetime(str(date)) <br/>    date_string_to_plot = date_time.strftime("%b, %Y")<br/>    date_string_to_save = date_time.strftime("%Y%m%d")<br/>    month_year_only = date_time.strftime("%b/%Y")<br/>    saving_path = f"../out/images/img_{date_string_to_save}.jpg"<br/>    <br/>    # checking if someone got 100%<br/>    now_completed_countries = this_plot[(this_plot['immunization_coverage'] == 100) &amp; ~(this_plot['country'].isin(completely_immunized))]['country'].tolist()<br/>    for country in now_completed_countries:<br/>        completely_immunized.append(country)<br/>        podium_len = len(completely_immunized)<br/>        suf = lambda n: "%d%s"%(n,{1:"st",2:"nd",3:"rd"}.get(n if n&lt;20 else n%10,"th"))<br/>        ranking += f"{suf(podium_len)} - {country} ({month_year_only})\n"<br/>    if date_string_to_save == "20221231":<br/>        ranking += "                . . ."<br/>    if (not (date_string_to_save.endswith("05") or date_string_to_save.endswith("15") or date_string_to_save.endswith("25"))) or date_string_to_save == "20221231":<br/>        continue<br/>    # create figure and axes for Matplotlib<br/>    fig, ax = plt.subplots(1, figsize=(14, 7))<br/>    # plotting only countries that are "competing" on the race<br/>    print(len(this_plot))<br/>    this_plot.dropna().plot(column=variable, cmap='Purples', linewidth=0.8, ax=ax, edgecolor='.9', vmin=vmin, vmax=vmax, legend=False, norm=plt.Normalize(vmin=vmin, vmax=vmax))<br/>    # remove the axis<br/>    ax.axis('off')<br/>    # add a title<br/>    ax.set_title(title, fontdict={'fontsize': '24', 'fontweight' : '2'}, color='#0A0122')<br/>    # create an annotation for the data source and author<br/>    ax.annotate(description, xy=(0.1, .065), xycoords='figure fraction', horizontalalignment='left', verticalalignment='top', fontsize=12, color='#555555')<br/>    # Create colorbar as a legend<br/>    sm = plt.cm.ScalarMappable(cmap='Purples', norm=plt.Normalize(vmin=vmin, vmax=vmax))<br/>    # empty array for the data range<br/>    sm._A = []<br/>    # add the colorbar to the figure<br/>    cbar = fig.colorbar(sm, label="% of the Population Fully Immunized", pad=0, shrink=0.7)<br/>    # position the annotation of the date string to the bottom left<br/>    ax.annotate(date_string_to_plot,<br/>            xy=(0.14, .265), xycoords='figure fraction',<br/>            horizontalalignment='center', verticalalignment='top',<br/>            color='#3C4052', fontsize=20)<br/>    <br/>    # position the annotation of the ranking to the bottom left, above our date string<br/>    ax.annotate(ranking,<br/>            xy=(0.032, .57), xycoords='figure fraction', color='#717171',<br/>            horizontalalignment='left', verticalalignment='top',<br/>            fontsize=11)<br/>    # plotting the rest of the countries differently<br/>    this_plot[this_plot.isna().any(axis=1)].plot(ax=ax, color='#fafafa', hatch='///')<br/>    fig.tight_layout(pad=0.05)<br/>    # saving to our images directory<br/>    plt.savefig(saving_path, dpi=300)<br/>    # if its the last date available, save it many times to make the gif "pause" a little bit on the last image<br/>    if date_string_to_save == "20221231":<br/>        for i in range(10):<br/>            plt.savefig(f"../out/images/img_{date_string_to_save + str(i)}.jpg", dpi=300)<br/>    plt.close('all')</span></pre><h2 id="a8a6" class="kk kl hh bd km kn ko kp kq kr ks kt ku ip kv kw kx it ky kz la ix lb lc ld le bi translated">根据情节创建GIF！</h2><p id="513b" class="pw-post-body-paragraph ie if hh ig b ih lf ij ik il lg in io ip lh ir is it li iv iw ix lj iz ja jb ha bi translated">为了实现这一目标:</p><ol class=""><li id="287d" class="mj mk hh ig b ih ii il im ip ml it mm ix mn jb mo mp mq mr bi translated">安装<a class="ae jo" href="https://imagemagick.org/index.php" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi"><em class="lk">ImageMagick</em></strong></a><strong class="ig hi"><em class="lk">；</em>T11】</strong></li><li id="971e" class="mj mk hh ig b ih ne il nf ip ng it nh ix ni jb mo mp mq mr bi translated">打开终端，导航到保存文件的目录；</li><li id="584a" class="mj mk hh ig b ih ne il nf ip ng it nh ix ni jb mo mp mq mr bi translated">只需运行以下命令:</li></ol><pre class="jd je jf jg fd ms mt mu mv aw mw bi"><span id="1e76" class="kk kl hh mt b fi mx my l mz na">magick -delay 20 -loop 0 *.jpg immunization_race.gif</span></pre><p id="b969" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">就是这样！</p><p id="3086" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">随时在<a class="ae jo" href="https://www.linkedin.com/in/gabriel-tardochi-salles-a1653a193/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> LinkedIn </strong> </a>上联系我。</p><p id="8ce0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这本书给了我一些灵感:</p><div class="nj nk ez fb nl nm"><a href="https://towardsdatascience.com/how-to-make-a-gif-map-using-python-geopandas-and-matplotlib-cd8827cefbc8" rel="noopener follow" target="_blank"><div class="nn ab dw"><div class="no ab np cl cj nq"><h2 class="bd hi fi z dy nr ea eb ns ed ef hg bi translated">如何使用Python、Geopandas和Matplotlib制作gif地图</h2><div class="nt l"><h3 class="bd b fi z dy nr ea eb ns ed ef dx translated">不需要Photoshop:只使用Python和命令行制作动画图表。</h3></div><div class="nu l"><p class="bd b fp z dy nr ea eb ns ed ef dx translated">towardsdatascience.com</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa ji nm"/></div></div></a></div></div></div>    
</body>
</html>