<html>
<head>
<title>Automation testing, scraping and more with Selenium and Python.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Selenium和Python的自动化测试、抓取等功能。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/automation-testing-scraping-and-more-with-selenium-and-python-9247278b00d2?source=collection_archive---------12-----------------------#2021-03-31">https://medium.com/analytics-vidhya/automation-testing-scraping-and-more-with-selenium-and-python-9247278b00d2?source=collection_archive---------12-----------------------#2021-03-31</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/3b01fe266b3e9e18d719498cc42b2ce0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0JURFS_NOjP-6Pzl"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">凯文·巴加特在<a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="e6c9" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">selenium——曾经是一个浏览器扩展，现在是测试基于web的应用程序的最流行的框架之一。在本文中，您将了解什么是Selenium，如何使用它，以及如何开始您的第一步。</h1></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="03ac" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated"><strong class="kb hi"> Selenium基础知识<br/> </strong> Selenium是一个开源框架，由以下组件组成:</p><p id="67ae" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">1.Selenium Webdriver:在浏览器中自动执行用户动作的主要组件。</p><p id="0545" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">2.Selenium Grid:允许多个实例在多个设备、操作系统和浏览器上同时运行的组件。这使得在尽可能多的平台上运行测试结果成为可能，这是自动化测试成功的先决条件。</p><p id="4ef4" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">3.Selenium IDE:记录并重复用户在浏览器中的动作。</p><p id="932b" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">Webdriver通过特定于浏览器的驱动程序与浏览器进行通信，该驱动程序也以相反的方向向Webdriver发送HTTP响应。这种简单的结构，加上开放的体系结构以及跨平台和跨语言工作的可能性，吸引了许多用户和开发人员，并使扩展成为可能。</p><p id="7910" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated"><strong class="kb hi">我们开始吧！<br/> </strong>首先是设置:我们需要Selenium——我们可以用“-m pip install selenium”下载安装在终端中。接下来，我们需要已经提到的webdriver。我在这个项目中使用谷歌Chrome浏览器，你可以在这里找到Chrome浏览器的驱动程序。我们开始一个新的Python项目——用第一行代码导入Selenium，选择webdriver。Chrome并给出chromedriver所在的路径。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="9b96" class="lg iv hh lc b fi lh li l lj lk">from selenium import webdriver<br/>driver = webdriver.Chrome(‘/Users/NAME/Desktop/chromedriver’)<br/></span></pre><p id="a2f2" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">在这里，您已经可以测试所有内容是否都被正确导入:运行代码应该会打开一个新的Chrome窗口，并显示消息:“Chrome正在由自动化测试软件控制”。</p><p id="e36b" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">为了初步了解Selenium的工作原理并开始学习语法，让我们从一个非常简单的例子开始。要调用一个页面，我们在刚刚定义的“驱动程序”上使用“<em class="ll"> get </em>来打开所需的URL:</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="dd5f" class="lg iv hh lc b fi lh li l lj lk">driver.get(‘<a class="ae it" href="https://www.google.com/xhtml'" rel="noopener ugc nofollow" target="_blank">https://www.google.com/xhtml'</a>)</span></pre><p id="6242" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">要进行自动谷歌搜索，我们必须找到执行搜索所需的元素。为了找到我们需要的元素，我们必须在网站上点击右键(使用Chrome浏览器)进入“查看页面源代码”来查看HTML代码。HTML代码是如何构建的以及如何在这里导航，我在以前的一篇文章中使用BeautifulSoup的一个抓取示例进行了描述。</p><p id="26a3" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated"><a class="ae it" rel="noopener" href="/analytics-vidhya/how-to-find-a-car-under-market-value-with-python-beautifulsoup-and-your-own-telegram-bot-c9d91e23c0d1">https://medium . com/analytics-vid hya/how-to-find-a-car-under-market-value-with-python-beautiful-soup-and-your-own-telegram-bot-c 9d 91 e 23 c 0d 1</a></p><p id="2d8b" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">为了在代码中实现我们需要的元素，我们将使用函数:"<em class="ll"> find_element_by_name </em>"按名称使用页面上的元素。补充信息:我们使用“google.com/xhtml ”,这样我们可以更好地阅读谷歌的html代码。一个简短的搜索向我们展示了搜索栏元素的名字仅仅是“q”。</p><figure class="kx ky kz la fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lm"><img src="../Images/65ce6f4bee6e8448e5d28c0267a5e4ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*25oFiHLyoP-x_51R36bvQg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">搜索栏HTML</figcaption></figure><p id="a250" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">现在，我们通过“<em class="ll"> find_element_by_name </em>转到元素，并使用“<em class="ll"> send_keys </em>输入所需的文本。</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="e13e" class="lg iv hh lc b fi lh li l lj lk">search=driver.find_element_by_name(‘q’)<br/>search.send_keys(‘Our First Google Search’)</span></pre><p id="99e6" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">为了使我们的自动化更加“人性化”,我们在命令之间增加了等待时间。为此，我们首先必须输入“时间”,并在调用网页后通过输入以下内容设置暂停时间，例如4秒钟:</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="58ac" class="lg iv hh lc b fi lh li l lj lk">time.sleep(4)</span></pre><figure class="kx ky kz la fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lm"><img src="../Images/3b28700e93e5c0307d2f45cb88c4b08c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iWyVmlu_sC89fqWHCK72aA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">我们的第一次谷歌搜索开始了</figcaption></figure><p id="d843" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">我们必须添加到代码中的最后一部分是提交搜索:</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="5a43" class="lg iv hh lc b fi lh li l lj lk">search.submit()</span></pre><p id="a13d" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">这一行模拟了按下回车键后的搜索结果:</p><figure class="kx ky kz la fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ln"><img src="../Images/7c9714ee1bdf34f066a785a7224e7787.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tnv31pfITcVLv0T1VfGoeA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">首次成功的自动谷歌搜索</figcaption></figure><p id="476a" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">要结束一个会话(注意:窗口会立即关闭，所以在窗口消失之前要有一个睡眠时间来查看结果)，我们使用quit函数:</p><pre class="kx ky kz la fd lb lc ld le aw lf bi"><span id="825a" class="lg iv hh lc b fi lh li l lj lk">driver.quit()</span></pre></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="962c" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">当然，我们还可以通过其他多种方式在代码中选择所需的元素—<em class="ll">“find _ element _ by _ name”</em>只是其中一个选项。其他常见的可能有:<em class="ll">“find _ element _ by _ id”</em>、<em class="ll">“find _ element _ by _ XPath”</em>、<em class="ll">“find _ element _ by _ class _ name”</em>等。详细的selenium文档可以在<a class="ae it" href="https://selenium-python.readthedocs.io/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="abf4" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">有了这些工具，所有元素都可以在HTML代码中找到，作为一个元素合并到Python代码中，并以不同的方式用于创建自动化流程。类似地，用户可以通过选择和填写单个元素来自动登录到网页。例如，使用脸书网站。</p><figure class="kx ky kz la fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lm"><img src="../Images/bef92c660a7cecf972bb41dab15b16ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GnVz7BbURbC2CAZqhcGBvQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">脸书HTML —我的电子邮件放在哪里？</figcaption></figure><p id="bd49" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">在首页快速搜索发现，邮件藏在id="email "下，密码藏在" pass "下。你所要做的就是“<em class="ll"> send_keys </em>”给那些人，并通过提交再次执行“输入”。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="f35b" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">我想用更多有用的函数来结束这篇文章，这些函数可以创造性地用于定制您的个人自动化过程:</p><ul class=""><li id="23fb" class="lo lp hh kb b kc kd kg kh kk lq ko lr ks ls kw lt lu lv lw bi translated">"<em class="ll"> getCurrentUrl() </em> " —以字符串形式获取当前Url，这在您浏览网站并想要抓取它们时会很有用</li><li id="515f" class="lo lp hh kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw bi translated">"<em class="ll"> getText() </em> " —获取您选择的web元素的内部文本—非常适合字符串和字符的自动抓取</li><li id="f8db" class="lo lp hh kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw bi translated">"<em class="ll"> implicitlyWait() </em> " —有时网页需要一些时间来加载，而您的驱动程序试图找到一个尚未加载的元素。implicitlyWait将按您输入的秒数暂停操作。</li><li id="40c3" class="lo lp hh kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw bi translated">"<em class="ll">visibilityOfElementLocated()</em>"与" untill()"成对出现-几乎做同样的事情，但不会等待X秒，而是等待某个元素变得可见。例如:wait . until(something wearewaitingfor . sivibilityofelementlocated)。当加载时间很长，并且您不知道要设置多少等待时间时，这就变得很方便了。</li><li id="c76c" class="lo lp hh kb b kc lx kg ly kk lz ko ma ks mb kw lt lu lv lw bi translated">“getScreenshotAs()”—此时将截取一个屏幕截图，可用于以后的控制。不要忘记在括号中设置文件名和格式。</li></ul><p id="fe6a" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">有了所有这些功能，您可以构建一个程序，它可以:自动浏览网页，检查web应用程序功能，提取并保存信息，以检测错误并提高性能。</p><p id="71bd" class="pw-post-body-paragraph jz ka hh kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ha bi translated">一如既往:感谢阅读！</p></div></div>    
</body>
</html>