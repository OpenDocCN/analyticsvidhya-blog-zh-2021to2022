<html>
<head>
<title>9 lines of code away from COVID-19 Vaccine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">距离新冠肺炎疫苗只有9行代码</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/9-lines-of-code-away-from-covid-19-vaccine-f0bfddf5b8b8?source=collection_archive---------18-----------------------#2021-05-19">https://medium.com/analytics-vidhya/9-lines-of-code-away-from-covid-19-vaccine-f0bfddf5b8b8?source=collection_archive---------18-----------------------#2021-05-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="110d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">只有旗舰手机或电影票在闪购的日子已经一去不复返了。现在是疫苗快速预订的时候了。</p><p id="d632" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在疫情袭击后，情况是相似的，但它不仅仅是一部电话或一张票，它是一个救命的“疫苗”。在印度这样拥有超过13亿人口的国家大规模生产疫苗并不容易。因此，需求远远高于供给。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/26a1d789e0cab9fafbc57307aba854fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XnW9NjoV8fvLSjM1DDzSOg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">来源:图片来自政府的COWIN应用程序。印度的</figcaption></figure><p id="9923" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最近，印度政府宣布18-45岁的人也将接种疫苗。因此，一个门户网站被创建，人们可以在那里注册和预订他们的位置。但是考虑到一个地区有200-300个位置，预订的人数成千上万，预订一个位置是一个挑战。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es js"><img src="../Images/c58383ff01bdd2fd6823be654d2e5f60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1wTqgpdb9m8BrLH5ZBZj9Q.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">来源:图片来自政府的COWIN应用程序。印度的。这是特定密码可用或预订的插槽图像</figcaption></figure><p id="cf66" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">作为一名程序员，我必须让我的生活变得简单。我希望有人帮我检查是否有空位，然后通知我，这样我就可以轻松地预订空位。因此，我写了这个脚本，它将为我完成工作，而我可以专注于其他事情。</p><p id="1673" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最容易做到的:Chrome扩展</p><p id="088e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你不想编码任何东西，那么有一个简单的方法。可以下载的chrome扩展:<a class="ae jt" href="https://chrome.google.com/webstore/detail/covid-vaccine-slot-checke/hmmahfccoaoebmjhmcnbbomomkimomhi" rel="noopener ugc nofollow" target="_blank">https://chrome . Google . com/web store/detail/covid-vaccine-slot-check e/hmmahfccoaoebmjhmcnbbomomkimomhi</a></p><p id="11ef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，您只需提供您希望它轮询的密码或您所在的地区，它就会以您选择的时间间隔为您进行轮询。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ju"><img src="../Images/7be62f61bd953c659c423b7c255085bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gbzX28t9ii9Vilmkk-ittA.png"/></div></div></figure><p id="7fd2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以，如果你不想做任何设置，我会强烈推荐给你。但是我想要额外的东西。如果我不在笔记本电脑旁，该怎么办？在另一个房间还是外面？所以，我想通过短信得到通知。这是构建这个脚本背后的动机。这是一个简单的设置；可能需要5-10分钟来设置，一旦完成，你可以自由移动(显然，没有面具:)。</p><p id="7536" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">剧本是做什么的？</strong></p><p id="a82c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以使用一个公共API来查询我们的结果。</p><p id="2581" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该脚本每分钟轮询一次COWIN服务器，并检查是否有可用的插槽。如果是，它会给我发短信。我每分钟都在这么做，因为我不想因为更高的频率doing服务器而使服务器不堪重负。</p><p id="ccba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">设置此功能有三个步骤:</p><ol class=""><li id="bab1" class="jv jw hh ig b ih ii il im ip jx it jy ix jz jb ka kb kc kd bi translated"><strong class="ig hi">获得一个Twilio账户:</strong>这里的第一步是获得一个Twilio账户。它非常简单，不需要你提供信用卡的详细信息，也是免费的。只需访问https://www.twilio.com/<a class="ae jt" href="https://www.twilio.com/" rel="noopener ugc nofollow" target="_blank">并注册免费试用。你将获得15美元的免费试用，这对你的脚本来说绰绰有余。在此之后，您只需获得一个免费电话号码，您的仪表板将类似于以下内容:</a></li></ol><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ke"><img src="../Images/97e1c5361f934ee1cf32750f950e86bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IvWsGQntmw2gA011vpLe4Q.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">来源:我的个人Twilio账户(一些信息被模糊了)</figcaption></figure><p id="3507" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.<strong class="ig hi">第9行</strong> <strong class="ig hi">为2剂疫苗的代码</strong></p><p id="9cc5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，我使用Twilio python API来发送SMS，只要有任何中心可供预订。</p><p id="5ee4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以，没有进一步的讨论，让我给你看这9行，它们为我做了重复的工作。但在此之前，让我们写一些配置，如个人识别码，网址等。</p><pre class="jd je jf jg fd kf kg kh ki aw kj bi"><span id="4998" class="kk kl hh kg b fi km kn l ko kp">import requests<br/>import json<br/>from twilio.rest import Client<br/>import datetime</span><span id="3747" class="kk kl hh kg b fi kq kn l ko kp"><strong class="kg hi">############################################################## Twilio SID, Auth Token, pincodes, TO_NUMBER, FROM_NUMBER, MIN_AGE_LIMIT to be configured as per your Twilio Account and requirements <br/>##############################################################</strong><br/><em class="kr">client = Client("AC4a****************************94",<br/>          "a8f**********************18") #Twilio SID and Auth Token<br/>pincodes = ["133001", "134003"] # Pincodes as per your requirements<br/>TO_NUMBER = "+91*******596" # To_Number on which SMS will be sent<br/>FROM_NUMBER = "+16*******65" # Phone number provided by Twilio<br/>MIN_AGE_LIMIT = "18" # Either 18 or 45<br/></em><strong class="kg hi"><em class="kr">##############################################################</em></strong></span><span id="5b95" class="kk kl hh kg b fi kq kn l ko kp">next_date = (datetime.datetime.today().date() + <br/>                     datetime.timedelta(1)).strftime("%d-%m-%y")<br/>cowin_base_url = "<a class="ae jt" href="https://www.cowin.gov.in/api/v2/appointment/sessions/public/calendarByPin?pincode=" rel="noopener ugc nofollow" target="_blank">https://www.cowin.gov.in/api/v2/appointment/sessions/public/calendarByPin?pincode=</a>"</span><span id="5928" class="kk kl hh kg b fi kq kn l ko kp"><strong class="kg hi">1.</strong> <strong class="kg hi">for each_pincode in pincodes:<br/>2.     cowin_url = cowin_base_url + \<br/>                    each_pincode + \<br/>                    "&amp;date=" + <br/>                     next_date<br/>3.     cowin_response = requests.get(cowin_url)<br/>4.     cowin_json = <br/>5.     json.loads(cowin_response. \<br/>                content.decode('utf8'). \<br/>                replace("'", ‘"’))<br/>6.    for each_center in cowin_json.get('centers'):<br/>7.        for each_session in each_center.get('sessions'):<br/>8.            if int(each_session.get('available_capacity')) &gt; 0 \<br/>                and int(each_session.get('min_age_limit')) == \                               <br/>                                            int(<em class="kr">MIN_AGE_LIMIT)</em>:<br/>9.                client.messages.create(to=TO_NUMBER,<br/>                                       from_=FROM_NUMBER,                                             <br/>                                       body= script_name +                    <br/>                             each_session.get('vaccine').upper() +<br/>                                     " Vaccine is available at " +<br/>                                         each_center.get('name') + <br/>                                                          " on " +<br/>                                        each_session.get('date') + <br/>                                               " for age above " +<br/>                          str(each_session.get('min_age_limit')) +<br/>                                           ". Slots available: " +    <br/>                                  str(each_session.get('slots')) +<br/>                                                       ". Only " + <br/>                     str(each_session.get('available_capacity')) +                      <br/>                 " bookings left. Book now and get Vaccinated !!")</strong></span></pre><p id="897e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">只需复制上述代码并将其放入任何文本文件中，然后保存为. py文件。从您的twilio帐户更新SSID和Auth令牌，并提供您感兴趣的pin码。我们把它命名为cowin_scrape.py，或者你可以直接从下面我的github库获取代码:</p><div class="ks kt ez fb ku kv"><a href="https://github.com/tseth92/vaccine_booking" rel="noopener  ugc nofollow" target="_blank"><div class="kw ab dw"><div class="kx ab ky cl cj kz"><h2 class="bd hi fi z dy la ea eb lb ed ef hg bi translated">t Seth 92/疫苗_预订</h2><div class="lc l"><h3 class="bd b fi z dy la ea eb lb ed ef dx translated">此储存库通过向您发送以下信息，帮助您从COWIN portal预订在印度接种新冠肺炎疫苗的位置</h3></div><div class="ld l"><p class="bd b fp z dy la ea eb lb ed ef dx translated">github.com</p></div></div><div class="le l"><div class="lf l lg lh li le lj jm kv"/></div></div></a></div><p id="0c19" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.<strong class="ig hi">安排脚本:</strong></p><p id="67c7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Windows:如果您拥有windows系统，您可以使用内置调度程序来调度任务:</p><p id="51bd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> i)创建任务调度程序:</strong>进入windows任务调度程序- &gt;点击右侧面板上的创建任务- &gt;为任务提供一个名称- &gt;点击更改用户或组，输入系统，然后点击确定。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lk"><img src="../Images/4aca61b2d63a603e43420943653d8c66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uu0_PxbTY9AHJRObmX76Fw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">用户/组中需要SYSTEM，以便每次运行作业时不会显示黑屏</figcaption></figure><p id="09d4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> ii)设置动作:</strong>转到动作，并添加新动作。浏览到脚本，然后单击确定。然后转到“条件”并取消选中“仅当计算机使用交流电源时才启动任务”。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ll"><img src="../Images/b52d009f9aa0bb7600ddc194e6829e08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FHJmhsXbWq_VPVCgB6UxbQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">取消选中此选项，这样即使您没有接通电源，您的脚本也会运行。</figcaption></figure><p id="c42a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> iii)设置触发器:</strong>转到触发器，选择开始任务的时间，并在“重复任务间隔”中添加1分钟:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lm"><img src="../Images/675c664e16051adc931004225be06881.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XsjoYILVHJJ-dTKbs0pcqg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">添加1分钟，或您希望它检查的任何持续时间</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ln"><img src="../Images/c54edb26a1fee34ed5f2334d1a999cff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J-JGXH64-eKnDkipEK0kHQ.png"/></div></div></figure><p id="d137" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">点击确定，你就完成了。如图验证一次即可。它应该显示您的下一次运行时间在接下来的1分钟，它应该每分钟更新一次。</p><p id="0edd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">恭喜你！！现在你可以高枕无忧了。只要您感兴趣的密码中有疫苗，您就会收到通知。只要它可用，您就会通过短信收到类似以下内容的通知:</p><p id="b472" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这些看起来是大量的准备工作，但实际上只是5-10分钟的工作。在Twilio上创建一个帐户，将代码复制到某个位置并更新凭证和密码，然后设置调度程序。</p><p id="4a97" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">如果是MAC或者Ubuntu？</strong></p><p id="f771" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你在MAC或Ubuntu上，这种调度技术将不起作用。我们古老而强大的工具CRONtab出现了。为此，玉米工作将按照您的计划进行。</p><p id="21b4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">转到终端，键入如下内容:</p><pre class="jd je jf jg fd kf kg kh ki aw kj bi"><span id="f37e" class="kk kl hh kg b fi km kn l ko kp">crontab -e<br/>In the vim editor, type i for insert, then write the following:</span><span id="bb42" class="kk kl hh kg b fi kq kn l ko kp">*/1 * * * * <!-- -->C:\Users\tseth\Documents\cowin_scripts\cowin_script.py <!-- -->&gt;&gt; <!-- -->C:\Users\tseth\Documents\cowin_scripts\cowin_script_log.txt<!-- --> 2&gt;&amp;1</span><span id="fe82" class="kk kl hh kg b fi kq kn l ko kp">## Path to your log file can be the absolute path of your </span></pre><p id="5e0b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">结束了。坦白说，比起调度程序，我更喜欢cron。但是调度程序在某些情况下给你更多的灵活性，比如你想只用交流电源运行，等等。</p></div><div class="ab cl lo lp go lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ha hb hc hd he"><p id="e9a0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">代码详情:</strong></p><p id="f1d1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">代码非常简单，但是如果有人感兴趣的话，我想给出一些代码的细节。</p><p id="5c11" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我声明了导入和一些我们将在代码中使用的变量，它们非常简单。</p><p id="7e3d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">1到5行，我们只迭代用户指定的所有pin码。接下来的6到9行，我们只是对每个会话和每个中心进行迭代，并为每次迭代发送消息。</p></div><div class="ab cl lo lp go lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ha hb hc hd he"><p id="489b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我希望这能帮助你建立你的疫苗通知系统，让你更快地接种疫苗。</p><p id="d6fd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你在设置过程中遇到任何问题，请在<a class="ae jt" href="http://linkedin.com/in/tusharseth92" rel="noopener ugc nofollow" target="_blank"> linkedIn </a>上发表评论或与我联系。</p><p id="9327" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">暂时结束，下一篇文章再见。在那之前，注意安全，呆在家里，戴上口罩，接种疫苗！！</p></div></div>    
</body>
</html>