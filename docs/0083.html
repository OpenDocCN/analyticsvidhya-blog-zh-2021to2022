<html>
<head>
<title>Scraping News from Google</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从谷歌抓取新闻</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/google-scraping-using-beautifulsoup-d53746ef5a32?source=collection_archive---------4-----------------------#2021-01-04">https://medium.com/analytics-vidhya/google-scraping-using-beautifulsoup-d53746ef5a32?source=collection_archive---------4-----------------------#2021-01-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2547" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基本上，我们可以使用几个网页抓取工具(如BeautifulSoup、Scrapy、Selenium等。)从谷歌上提取信息。对于本文，作者使用BeautifulSoup，因为它易于实现。其实要看你能做什么或者你适应什么。</p><p id="24a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">此外，本文还解释了如何从google中抓取以及如何处理Google查询和请求限制。有谷歌抓取的python代码示例，包括<strong class="ih hj">谷歌新闻</strong>和常见的<strong class="ih hj">谷歌搜索</strong></p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/78d625dc6d5cebf58fbe99543c11b1b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7i-xqteipam40Y1TgRkj5Q.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">谷歌新闻</figcaption></figure><h2 id="09fd" class="ka kb hi bd kc kd ke kf kg kh ki kj kk iq kl km kn iu ko kp kq iy kr ks kt ku bi translated">从谷歌新闻获取股票新闻</h2><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="kv kw l"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">谷歌新闻抓取代码</figcaption></figure><p id="a6d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谷歌新闻用于搜索几家出版商的新闻。对于这个例子，我们正在搜索与股票相关的公司新闻。</p><p id="b91e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面的代码中，我们有一个函数，用于获取我们注册的所有tickers的新闻。</p><p id="a0ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">谷歌抓取的一个重要内容是谷歌查询设置，你可以在<a class="ae kx" href="https://developers.google.com/custom-search/docs/xml_results" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> <em class="ky">这里</em> </strong> </a>设置和探索更多的谷歌查询，但在这段代码中，查询包括搜索关键字、语言、按日期和新闻数量排序。</p><pre class="jl jm jn jo fd kz la lb lc aw ld bi"><span id="2e30" class="ka kb hi la b fi le lf l lg lh">keyword = '{} stock news'.format(t)        <br/>url = f"https://www.google.com/search?q={keyword}&amp;tbm=nws&amp;lr=lang_en&amp;hl=en&amp;sort=date&amp;num=5"</span></pre><h2 id="cabc" class="ka kb hi bd kc kd ke kf kg kh ki kj kk iq kl km kn iu ko kp kq iy kr ks kt ku bi translated">从谷歌搜索中获取公司描述</h2><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="kv kw l"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">维基百科抓取代码</figcaption></figure><p id="757f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与此同时，在普通的谷歌搜索中，我们试图从维基百科中抓取公司描述。我们使用“维基百科”和股票名称作为关键字来获得关于股票的描述，例如“<em class="ky">维基百科苹果公司</em>”。</p><pre class="jl jm jn jo fd kz la lb lc aw ld bi"><span id="ae5c" class="ka kb hi la b fi le lf l lg lh">url = f"https://www.google.com/search?q=wikipedia {ticker_name.lower()} company&amp;lr=lang_en&amp;hl=en"</span></pre><p id="735e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">实际上代码可以和google新闻抓取一样，但是不同的是在查询中，没有代表google新闻的<strong class="ih hj"> <em class="ky"> tbm = nws </em> </strong></p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h2 id="b49e" class="ka kb hi bd kc kd ke kf kg kh ki kj kk iq kl km kn iu ko kp kq iy kr ks kt ku bi translated">处理请求限制</h2><pre class="jl jm jn jo fd kz la lb lc aw ld bi"><span id="b69e" class="ka kb hi la b fi le lf l lg lh">res = request.get(url, headers=random_header)</span></pre><p id="aeca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要为谷歌抓取标题，因为谷歌需要有关您的请求信息。标题设置对防止请求限制很重要(有时当你超过一定数量的请求时，谷歌会阻止你的IP)。</p><p id="f924" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用几种方法来处理google scraping上的请求限制，比如图书馆使用或用户代理轮换。</p><pre class="jl jm jn jo fd kz la lb lc aw ld bi"><span id="e7ea" class="ka kb hi la b fi le lf l lg lh"># random header library<br/>from fake_useragent import UserAgent<br/>from user_agent import random_header</span></pre><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="kv kw l"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">用户代理轮换代码</figcaption></figure><p id="5956" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您可以创建和设置标题列表以轮换您的用户代理，有关用户代理轮换的更多信息，请查看此<a class="ae kx" href="https://www.scrapehero.com/how-to-fake-and-rotate-user-agents-using-python-3/" rel="noopener ugc nofollow" target="_blank">源</a></p><blockquote class="li lj lk"><p id="28ce" class="if ig ky ih b ii ij ik il im in io ip ll ir is it lm iv iw ix ln iz ja jb jc hb bi translated">谷歌抓取最重要的事情是如何在你的代码上设置查询url和标题</p></blockquote><p id="8274" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦你可以处理查询和请求限制，你就可以根据你想要的抓取新闻</p></div></div>    
</body>
</html>