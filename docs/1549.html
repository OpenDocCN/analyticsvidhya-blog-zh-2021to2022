<html>
<head>
<title>Simple Linear Regression Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python进行简单的线性回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/simple-linear-regression-using-python-98ddd7e6b391?source=collection_archive---------13-----------------------#2021-03-07">https://medium.com/analytics-vidhya/simple-linear-regression-using-python-98ddd7e6b391?source=collection_archive---------13-----------------------#2021-03-07</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="9b2c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在发布了我的第一个关于简单的网络报废的媒体故事后，今天我将写一个简单的监督学习算法，线性回归。我相信你们大多数人已经在学校上过线性回归课了。在这篇文章中，我将再次使用python编程和google collab来构建线性回归模型。</p><p id="b5cc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我们开始编码环境之前，我将简单解释一下监督学习和线性回归。监督学习是一种机器学习方法，其中数据已经有标签作为目标，所以当我们使用新数据进行预测时，我们已经知道数据将被分配到的类/组/标签的名称。在监督学习中，将有一个训练或学习过程来建立模型。监督学习方法之一是线性回归。线性回归是一种统计模型，用于计算两个变量之间的关系，变量通常表示为X和y。X表示自变量，y表示因变量。线性回归的公式解释如下:</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="55e3" class="jl jm hh jh b fi jn jo l jp jq">y = ax + b, where :<br/>a = slope/gradient/coefficient<br/>x = independent variable<br/>y = dependent variable</span></pre><p id="f9af" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇文章中，我假设你已经理解了线性回归的概念，因为我不会在这里解释更多的细节。</p></div><div class="ab cl jr js go jt" role="separator"><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw"/></div><div class="ha hb hc hd he"><p id="6fc5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以，让我们从代码开始…</p><h1 id="2d08" class="jy jm hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">阅读并理解数据</strong></h1><p id="83dd" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">在创建模型之前，我们需要做的第一个强制性步骤是理解数据并确定因变量和自变量。将使用的数据来自这个链接:"http://bit.ly/w-data"。</p><p id="5f6d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在读取数据之前，我将导入将在整个过程中使用的库。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="9626" class="jl jm hh jh b fi jn jo l jp jq">import pandas as pd<br/>import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>import numpy as np</span></pre><p id="852b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后编写以下代码从URL读取数据:</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="e937" class="jl jm hh jh b fi jn jo l jp jq">#read data<br/>url = "http://bit.ly/w-data"<br/>data = pd.read_csv(url)<br/>data.head()</span></pre><figure class="jc jd je jf fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es la"><img src="../Images/47b39cf2971c6811a476a7755ed282d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:398/format:webp/1*hNVzo7fU1A3mdYcBiWd-ig.jpeg"/></div></div></figure><p id="353b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们可以从url中看到前5名的数据。我们可以看到数据框中有两个变量，小时和分数。小时将被用作x或自变量，而分数将被用作因变量。</p><p id="d232" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们还可以可视化或绘制数据，以了解可变小时数和分数之间的相关性。在这里，我将使用seaborn来可视化数据。我写了下面的代码。如前所述，小时将位于X轴上，分数将位于y轴上。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="5136" class="jl jm hh jh b fi jn jo l jp jq">sns.regplot(x = "Hours", y = "Scores", data=data)</span></pre><figure class="jc jd je jf fd lb er es paragraph-image"><div class="er es li"><img src="../Images/7483b31049372d0c0f1174e8c4c86c1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*4G2xuC_L4o1qDGt58f2lhA.png"/></div></figure><p id="dcad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从图中可以看出，时间越长，学生得到的分数越高。根据该图，我们可以得出结论，这是一个正相关关系，这意味着如果x值增加，y值也会随之增加。接下来，我们还需要评估这两个变量之间的相关性有多强。在python中，为了计算系数相关性，我们可以使用函数。corr()就像下面这样。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="9fc5" class="jl jm hh jh b fi jn jo l jp jq"><strong class="jh hi">#calculating coeeficient correlation</strong><br/>data.corr()</span></pre><figure class="jc jd je jf fd lb er es paragraph-image"><div class="er es lj"><img src="../Images/065c3c311bc0694bc4216b7c90f3f02f.png" data-original-src="https://miro.medium.com/v2/resize:fit:494/format:webp/1*W4jRNFHHCRpux2UAdrUQvA.jpeg"/></div></figure><p id="1f9c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从上表中我们可以看到，小时和分数之间的相关性是0.976，这意味着这两个变量有很强的相关性，因为相关系数值接近1。</p><h1 id="5e67" class="jy jm hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">创建线性回归模型</strong></h1><p id="a6e7" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">下一步是创建线性回归模型。首先，我们需要将x和y变量分离到不同的数据框架中。要获得预测变量或x，我们只需从数据帧中删除y列。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="6212" class="jl jm hh jh b fi jn jo l jp jq">X = data.drop('Scores', axis=1)<br/>X.head()</span></pre><figure class="jc jd je jf fd lb er es paragraph-image"><div class="er es lk"><img src="../Images/e6f278fa9ab67094d234728dd9e1c758.png" data-original-src="https://miro.medium.com/v2/resize:fit:234/format:webp/1*rM9eu8Ve9n9WetGiGeflUg.jpeg"/></div></figure><p id="953e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">而要从数据帧中获得唯一的y变量，我们只需要获取列名。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="5db5" class="jl jm hh jh b fi jn jo l jp jq">y = data["Scores"]<br/>y.head()</span></pre><figure class="jc jd je jf fd lb er es paragraph-image"><div class="er es ll"><img src="../Images/2b16661eeccbb063f9bca026cfbf624d.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/format:webp/1*TzV-0vvvCasazMAP4OpvRQ.jpeg"/></div></figure><p id="9bd4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因为它是监督学习，所以在创建模型之前，我会将数据分成两个不同的部分，训练数据和测试数据。训练数据是将用于创建和训练模型的数据，而测试数据将用于验证模型。在python中，我们可以使用函数“train_test_split”来拆分数据。在这里，我将使用25%的数据作为训练数据，75%作为测试数据，这些数据是随机选择的，所以如果每次重新运行代码时结果总是不同，这并不奇怪。要拆分数据，我们可以编写如下代码:</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="3dea" class="jl jm hh jh b fi jn jo l jp jq"><strong class="jh hi">#split data into data training and data testing</strong><br/>from sklearn.model_selection import train_test_split<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25)</span></pre><p id="9592" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，我们将最终使用python库linear regression创建线性回归模型，只需编写以下代码。最后一段代码用于使用已创建的线性回归模型基于X_test数据预测y值。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="5c0f" class="jl jm hh jh b fi jn jo l jp jq"><strong class="jh hi">#create linear regression model</strong><br/>from sklearn.linear_model import LinearRegression<br/>lineg_model = LinearRegression()</span><span id="1af5" class="jl jm hh jh b fi lm jo l jp jq"><strong class="jh hi">#fit linear regression to the training data</strong><br/>lineg_model.fit(X_train, y_train)</span><span id="c7bc" class="jl jm hh jh b fi lm jo l jp jq"><strong class="jh hi">#predict y-value based on testing data</strong><br/>y_pred = lineg_model.predict(X_test)</span></pre><p id="dff6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，我们成功地创建了线性回归模型，并使用预测模型来预测y值。然后，我们可以比较来自模型的y预测结果和来自数据的实际y值。我们最终也可以用这个模型来预测新的数据。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="9143" class="jl jm hh jh b fi jn jo l jp jq"><strong class="jh hi">#comparing y-value actual and prediction of testing data</strong></span><span id="a31d" class="jl jm hh jh b fi lm jo l jp jq">df_compare = pd.DataFrame({'Actual' : y_test, 'Prediction': y_pred})<br/>df_compare</span></pre><figure class="jc jd je jf fd lb er es paragraph-image"><div class="er es ln"><img src="../Images/4f34e216b9dad5021d4015a943787373.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*LxJjf6X9mttFwqAi3Uce6Q.jpeg"/></div></figure><p id="7d8c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们还可以找到截距和线性回归模型的系数值。拦截_和。python中的系数_函数。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="cad2" class="jl jm hh jh b fi jn jo l jp jq"><strong class="jh hi">#intercept and coefficient</strong></span><span id="4396" class="jl jm hh jh b fi lm jo l jp jq">intercept = lineg_model.intercept_<br/>koefisien = lineg_model.coef_</span><span id="cd5f" class="jl jm hh jh b fi lm jo l jp jq">print(intercept)<br/>print(koefisien)</span></pre><figure class="jc jd je jf fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lo"><img src="../Images/b902c2b8b6aaf43253adfb329c6d2b23.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*RrJb98CfHNuFcArawx7vAQ.jpeg"/></div></div></figure><p id="97d8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从上面的结果，我们得到截距4.13…和系数9.57…根据这些值，我们最终可以将线性回归方程写成<strong class="ig hi"> Y = 9.57x + 4.13。</strong></p><h1 id="578c" class="jy jm hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">评估模型</h1><p id="350c" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">最后，我们需要评估我们的回归线性模型，这里我将简单地使用平均绝对误差(MAE)。实际上，有很多其他的评估方法可以使用，我将只使用MAE来进行这个练习。MAE将计算数据中的实际值和模型产生的预测值之间的平均误差值。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="bdc3" class="jl jm hh jh b fi jn jo l jp jq">from sklearn.metrics import mean_squared_error, r2_score</span><span id="5e8e" class="jl jm hh jh b fi lm jo l jp jq">#calculate MAE<br/>MAE = mean_absolute_error(y_test,y_pred)<br/>print(MAE)</span></pre><figure class="jc jd je jf fd lb er es paragraph-image"><div class="er es lp"><img src="../Images/8642841956b83e2ef00518a255661fc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:328/format:webp/1*OASt1tWSQJqbUe4h--meHQ.jpeg"/></div></figure><p id="a760" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过计算，我们得到MAE值为5.55。</p><h1 id="f787" class="jy jm hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">使用新数据预测</strong></h1><p id="46ef" class="pw-post-body-paragraph ie if hh ig b ih kv ij ik il kw in io ip kx ir is it ky iv iw ix kz iz ja jb ha bi translated">这里我将尝试使用线性回归模型来预测新的得分数据。我将输入学习小时数9.75。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="3f8e" class="jl jm hh jh b fi jn jo l jp jq">#predict using new data =&gt; Hours = 9.25</span><span id="f395" class="jl jm hh jh b fi lm jo l jp jq">X_new = np.array([9.75]).reshape(-1,1)<br/>y_pred_new = lineg_model.predict(X_new)<br/>y_pred_new</span></pre><figure class="jc jd je jf fd lb er es paragraph-image"><div class="er es lq"><img src="../Images/dc98cae70c6bca4bbff5053cebe4ec2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:424/format:webp/1*PlJ3acOhatxDiiaKZcRorw.jpeg"/></div></figure><p id="0139" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当学习小时数为9.75时，预计学生将获得97.51分。我们也可以用方程Y = ax+b来计算分数。</p><figure class="jc jd je jf fd lb er es paragraph-image"><div class="er es lr"><img src="../Images/cea0b1b16d9c19410a92afc79557de81.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*brYeI7rgF9J5QJvbZS3Z0w.jpeg"/></div></figure><p id="2806" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这与用线性回归模型预测的结果一致。</p></div><div class="ab cl jr js go jt" role="separator"><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw jx"/><span class="ju bw bk jv jw"/></div><div class="ha hb hc hd he"><p id="178b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">好了，以上就是关于如何使用python创建线性回归模型，并使用模型预测新数据的全部内容。希望这篇帖子对刚开始学习使用python编程的数据科学的你有所帮助。这个帖子实际上离完美还很远，我真的欢迎你的任何意见。</p></div></div>    
</body>
</html>