<html>
<head>
<title>Machine Learning | Sports Predictions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习|体育预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/machine-learning-sports-predictions-f01c1736ef73?source=collection_archive---------4-----------------------#2021-02-03">https://medium.com/analytics-vidhya/machine-learning-sports-predictions-f01c1736ef73?source=collection_archive---------4-----------------------#2021-02-03</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/1f0f486d56e2f197d610171a516e59ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Bcom42WC2GdwdGrk5HQNg.jpeg"/></div></div></figure><p id="5eb5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">先说一个重要的问题:什么是机器学习？</strong></p><blockquote class="jn jo jp"><p id="81cb" class="ip iq jq ir b is it iu iv iw ix iy iz jr jb jc jd js jf jg jh jt jj jk jl jm ha bi translated">机器学习是人工智能的一个子集，它使用算法来检测数据中的模式和趋势。</p></blockquote><p id="1492" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">机器学习可以很容易的分解成以下几种方法；有人监督和无人监督。本文将讨论前者，并由此引出两种类型的任务；回归和分类。这篇文章是一个分类任务，我们想预测一个NCAA篮球队是否会赢得或输掉他们的下一场比赛。</p><p id="06c4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在计算机科学中，算法是计算机被编程来遵循的一系列命令。在机器学习中，我们根据历史数据“训练”这些算法，以做出决策和预测——因此当收到新数据时，算法可以提供对未来的准确洞察。算法越好，决策和预测就越准确。</p><p id="1a40" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当今世界，机器学习的例子在我们身边比比皆是。数字人工智能机器人根据我们在线观看、收听或搜索的内容，向我们推荐电影、歌曲，甚至度假目的地。</p></div><div class="ab cl ju jv go jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="ha hb hc hd he"><p id="ccf0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">机器学习是如何工作的？</strong></p><blockquote class="jn jo jp"><p id="1ca0" class="ip iq jq ir b is it iu iv iw ix iy iz jr jb jc jd js jf jg jh jt jj jk jl jm ha bi translated"><strong class="ir hi"> I. </strong>选择&amp;准备数据集</p><p id="5f2d" class="ip iq jq ir b is it iu iv iw ix iy iz jr jb jc jd js jf jg jh jt jj jk jl jm ha bi translated"><strong class="ir hi">二。</strong>实现期望的算法(建立AI模型)，并在准备好的数据上对其进行训练</p><p id="298e" class="ip iq jq ir b is it iu iv iw ix iy iz jr jb jc jd js jf jg jh jt jj jk jl jm ha bi translated"><strong class="ir hi">三世。</strong>确定模型指标</p></blockquote></div><div class="ab cl ju jv go jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="ha hb hc hd he"><p id="c749" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">选择&amp;准备数据集</strong></p><blockquote class="jn jo jp"><p id="09d5" class="ip iq jq ir b is it iu iv iw ix iy iz jr jb jc jd js jf jg jh jt jj jk jl jm ha bi translated">步骤1:安装/导入</p></blockquote><p id="4bf6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在运行这段代码之前，您可能需要安装的模块:</p><p id="9348" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae kb" href="https://pypi.org/project/category-encoders/" rel="noopener ugc nofollow" target="_blank">类别编码器PyPI </a></p><p id="4a8a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae kb" href="https://pypi.org/project/sportsreference/" rel="noopener ugc nofollow" target="_blank">体育参考PyPI </a></p><p id="8eb2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae kb" href="https://sportsreference.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank"> Sportsipy:为python编写的免费运动API—sports ipy 0 . 1 . 0文档(sports reference . readthedocs . io)</a></p><figure class="kc kd ke kf fd ii"><div class="bz dy l di"><div class="kg kh l"/></div></figure><blockquote class="jn jo jp"><p id="baf3" class="ip iq jq ir b is it iu iv iw ix iy iz jr jb jc jd js jf jg jh jt jj jk jl jm ha bi translated">步骤2:获取并处理模型输入的数据</p></blockquote><figure class="kc kd ke kf fd ii"><div class="bz dy l di"><div class="kg kh l"/></div></figure><figure class="kc kd ke kf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ki"><img src="../Images/9454c4a19810113282dd804e9b234ae4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qBxEfFfdeOhiu4wIwrktoQ.jpeg"/></div></div></figure><p id="3a1b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我们有了所有NCAAB球队的列表，我们可以获取每个球队的数据，并开始为机器学习模型建立数据集。</p><figure class="kc kd ke kf fd ii"><div class="bz dy l di"><div class="kg kh l"/></div></figure><p id="781f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="jq">细目:</em> </strong></p><ul class=""><li id="9827" class="kj kk hh ir b is it iw ix ja kl je km ji kn jm ko kp kq kr bi translated">上面的函数获取所有NCAAB队的数据。接下来，我将数据分为“特征”(X)和“目标”(y)。</li><li id="3ce0" class="kj kk hh ir b is ks iw kt ja ku je kv ji kw jm ko kp kq kr bi translated">特征数据包含将用于预测输赢的游戏统计数据。见下文:</li></ul><figure class="kc kd ke kf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kx"><img src="../Images/3cdec309b90398d32a0b41ba8035177d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_1dLG7ip8KHja9qOOl2S_g.jpeg"/></div></div></figure><ul class=""><li id="e353" class="kj kk hh ir b is it iw ix ja kl je km ji kn jm ko kp kq kr bi translated">目标数据包含我们试图预测的内容，在这种情况下，它是游戏的结果。注意API返回游戏的结果(赢或输)，因为我们希望模型是可预测的，所以我们将结果移回一场游戏。因此，<strong class="ir hi"> <em class="jq">模型正在被训练，以最近一场比赛发生的事情为基础，预测下一场比赛会发生什么。</em>T3】</strong></li></ul><figure class="kc kd ke kf fd ii er es paragraph-image"><div class="er es ky"><img src="../Images/56ff2caf655a1c03b0e2f4a3bb26d793.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*zjM5yDbSoxRh2htf5x-33A.jpeg"/></div></figure><p id="38aa" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">迄今为止，最好的概念化过程的方法是这样的:</p><ul class=""><li id="25d3" class="kj kk hh ir b is it iw ix ja kl je km ji kn jm ko kp kq kr bi translated">记住——目标是下一局的结果。例子:杨百翰，城堡和杜克大学都赢得了第二场比赛。<strong class="ir hi"> <em class="jq">我们将它设置为第一场比赛，所以我们的模型被训练来预测下一场比赛。</em> </strong></li><li id="02a5" class="kj kk hh ir b is ks iw kt ja ku je kv ji kw jm ko kp kq kr bi translated">想象一下目标，作为上面大数据框的最后一列。然后，根据这些特征(游戏统计数据)对算法进行训练，对输赢进行分类。</li></ul><p id="8cbb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">机器学习分类任务的好处之一是，我们实际上可以可视化我们的模型训练过程，以了解它是如何学习和做出决策的。在接下来的部分中，我将用信息图展示一个例子。</p></div><div class="ab cl ju jv go jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="ha hb hc hd he"><p id="19b8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">建立和训练机器学习模型</strong></p><blockquote class="jn jo jp"><p id="558c" class="ip iq jq ir b is it iu iv iw ix iy iz jr jb jc jd js jf jg jh jt jj jk jl jm ha bi translated">步骤1:分割数据用于训练/测试</p></blockquote><figure class="kc kd ke kf fd ii"><div class="bz dy l di"><div class="kg kh l"/></div></figure><p id="211d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这将把我们的特征矩阵(X)和目标向量(y)分成训练和测试数据集。这样做的目的是训练一个模型并测量初始精度。</p><blockquote class="jn jo jp"><p id="efa8" class="ip iq jq ir b is it iu iv iw ix iy iz jr jb jc jd js jf jg jh jt jj jk jl jm ha bi translated">步骤2:定义基线精度</p></blockquote><figure class="kc kd ke kf fd ii"><div class="bz dy l di"><div class="kg kh l"/></div></figure><figure class="kc kd ke kf fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/a862991d8842b830752243b017c86400.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*uYw2CG4ld_JfARXFOGWPew.jpeg"/></div></figure><p id="489d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="jq">基线精度</em> </strong>可以定义为:模型每次预测多数类(赢或输)时的精度得分。</p><p id="ea4c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">评估这一指标的原因是为了看看我们的目标类有多平衡，在这种情况下，我们可以看到它们平衡得相当均匀。一个发生的概率是56%，另一个是44%。</p><blockquote class="jn jo jp"><p id="aa94" class="ip iq jq ir b is it iu iv iw ix iy iz jr jb jc jd js jf jg jh jt jj jk jl jm ha bi translated">第三步:建立模型并训练它</p></blockquote><figure class="kc kd ke kf fd ii"><div class="bz dy l di"><div class="kg kh l"/></div></figure><p id="2063" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="jq">细分:</em> </strong></p><ul class=""><li id="56a6" class="kj kk hh ir b is it iw ix ja kl je km ji kn jm ko kp kq kr bi translated">使用sklearn.pipeline模块定义模型。这只是更健壮的代码——模型不必在管道中定义。</li><li id="9f3d" class="kj kk hh ir b is ks iw kt ja ku je kv ji kw jm ko kp kq kr bi translated">使用category_encoder模块对分类特征进行普通编码。</li><li id="a673" class="kj kk hh ir b is ks iw kt ja ku je kv ji kw jm ko kp kq kr bi translated">实例化机器学习模型:RandomForestClassifier。</li><li id="825e" class="kj kk hh ir b is ks iw kt ja ku je kv ji kw jm ko kp kq kr bi translated">根据训练数据拟合模型。</li></ul></div><div class="ab cl ju jv go jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="ha hb hc hd he"><p id="98a9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">这不是上面概述的步骤之一，因为它不是构建模型所必需的，但对于理解机器学习如何工作是重要的。</strong></p><blockquote class="jn jo jp"><p id="c3b6" class="ip iq jq ir b is it iu iv iw ix iy iz jr jb jc jd js jf jg jh jt jj jk jl jm ha bi translated">将模型可视化</p></blockquote><figure class="kc kd ke kf fd ii"><div class="bz dy l di"><div class="kg kh l"/></div></figure><p id="57b5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这段代码与模型构建过程无关，也不是本节的重点(见下文)，因此我不打算进行分解——如果您感兴趣，请阅读单元格中的注释。</p><figure class="kc kd ke kf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es la"><img src="../Images/1ccd56038a0365e45ab07aad9c5af702.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uoEUSSdhNA8RsTV0pljnDg.jpeg"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">这是我上面提到的信息图</figcaption></figure><p id="e2ae" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">前面我提到过，机器学习模型使用特征(游戏统计)，来预测目标(赢或输)。</p><p id="d4f5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">上面的信息图是这种特定机器学习模型的可视化，但是，这对于所有基于树的模型都是一样的。你在上面看到的是训练，这是我们模型的决策过程。这个模型所要做的是，准确地对输赢进行分类。用专业术语来说；根据分离情况，尽量减少杂质(下面将详细讨论)。</p><p id="6ff5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="jq">什么是拆分？</em>T3】</strong></p><p id="12cd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">很棒的问题！分割或“节点”只是我们数据集的特征。如上图所示，根节点是season_losses &lt; 5.5 — and the resulting classification is 293 wins, and 379 losses. This yields an entropy or “impurity” of 0.988 (we expect high entropy at the root node! ). The model above is very simple, and was only created for the purpose of this visual, there are only 3 layers in 1 tree. Therefore, as expected, this model never successfully minimizes entropy (model is not learning).</p><p id="1323" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="jq">什么是熵？</em> </strong></p><p id="e0a2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">熵是机器学习模型的杂质的度量。</p><p id="c729" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="jq">模型如何最小化熵？</em>T11】</strong></p><p id="e18a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当您调用“fit”函数时，模型将在训练集的每个特征(列)上分裂，您在上面的信息图中看到的节点是导致最低熵的分裂。</p><p id="18d4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">模型通过最小化熵来学习。公式如下所示:</p><figure class="kc kd ke kf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lf"><img src="../Images/2ad9efd290b60b6e61a5b81dc186d7a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pbE5FH1v3GWLhCtKRR8_TA.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">香农熵公式</figcaption></figure><p id="ff0f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> <em class="jq">细分:</em> </strong></p><ul class=""><li id="9e5c" class="kj kk hh ir b is it iw ix ja kl je km ji kn jm ko kp kq kr bi translated">i/n代表类…对1到n个类重复上面的计算。</li><li id="23f3" class="kj kk hh ir b is ks iw kt ja ku je kv ji kw jm ko kp kq kr bi translated">这个模型只有两个类(赢或输)，在下面的实现中也可以看到(每个log2函数代表一个类)。</li></ul><figure class="kc kd ke kf fd ii er es paragraph-image"><div class="er es lg"><img src="../Images/fde0f26d5e4bad079fad0b0ae8fdf093.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*50w_1LUgNr2rYsc89XKj4Q.jpeg"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">根节点的熵</figcaption></figure><figure class="kc kd ke kf fd ii er es paragraph-image"><div class="er es lh"><img src="../Images/72f6c221fd7356ace939d9cfbc8d088c.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*5QsiDuUAcf6BxZOlJi0H1Q.jpeg"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">根节点</figcaption></figure><p id="8d95" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">该模型继续分裂，并行运行数以千计的这些计算，最小化熵，因此“学习”。当出现新数据时，模型将使用上面看到的相同分割来准确地分类成功或失败！</p></div><div class="ab cl ju jv go jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="ha hb hc hd he"><p id="3a7f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">确定模型指标</strong></p><blockquote class="jn jo jp"><p id="67a7" class="ip iq jq ir b is it iu iv iw ix iy iz jr jb jc jd js jf jg jh jt jj jk jl jm ha bi translated">步骤1:计算准确度分数</p></blockquote><figure class="kc kd ke kf fd ii"><div class="bz dy l di"><div class="kg kh l"/></div></figure><figure class="kc kd ke kf fd ii er es paragraph-image"><div class="er es li"><img src="../Images/f7745a145fcf17d776ab6c4b1dd85b49.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*RUwn_s6NhGLula_OmFGN6A.jpeg"/></div></figure><p id="7aa9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们使用sklearn.metrics accuracy_score对模型进行评分。参数是模型预测和实际结果。</p><blockquote class="jn jo jp"><p id="f54c" class="ip iq jq ir b is it iu iv iw ix iy iz jr jb jc jd js jf jg jh jt jj jk jl jm ha bi translated">步骤2:确定特性的重要性</p></blockquote><figure class="kc kd ke kf fd ii"><div class="bz dy l di"><div class="kg kh l"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">注意——“特征”变量已在第一节“准备数据”中定义。</figcaption></figure><figure class="kc kd ke kf fd ii er es paragraph-image"><div class="er es lj"><img src="../Images/b5deaf6f6bfa60c617ee00dc86b01a5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*WRrdZfdZ4N1EMmvxq-7X9g.jpeg"/></div></figure><p id="7892" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">非常酷！我们可以想象每个特征(游戏统计)对预测有多重要。</p><p id="2e90" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这个模型已经可以使用了！虽然——你可以调整超参数，选择不同的分类器，设计新的特性，等等……但是，在这一点上，我希望这篇文章的信息已经被接受了！你应该知道如何为NCAAB预测建立ML模型，如果你不是程序员；我希望你能够了解一点人工智能！</p><p id="aa6d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">感谢阅读！</strong></p></div></div>    
</body>
</html>