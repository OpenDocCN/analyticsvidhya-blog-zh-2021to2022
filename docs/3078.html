<html>
<head>
<title>Extracting Features from Videos using C3D v1.1 in Ubuntu 16.04</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Ubuntu 16.04中使用C3D 1.1版从视频中提取特征</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/extracting-features-from-videos-using-c3d-v1-1-in-ubuntu-16-04-16f2b2990e3b?source=collection_archive---------0-----------------------#2021-06-04">https://medium.com/analytics-vidhya/extracting-features-from-videos-using-c3d-v1-1-in-ubuntu-16-04-16f2b2990e3b?source=collection_archive---------0-----------------------#2021-06-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="f546" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇文章中，我将提供一个关于如何用<strong class="ig hi"> C3D v1.1 </strong>模型安装和提取特性的指南，这个项目的网站可以在<a class="ae jc" href="https://vlg.cs.dartmouth.edu/c3d/" rel="noopener ugc nofollow" target="_blank">这里</a>访问。我写这篇文章的动机是因为我找不到任何关于如何从C3D 1.1版中提取特性的详细指南，因此现在我试图自己写这篇文章，以防有人需要。</p><p id="e1de" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于C3D 1.0版，可以在这里访问官方文档<a class="ae jc" href="https://docs.google.com/document/d/1-QqZ3JHd76JfimY4QKqOojcEaf5g3JS0lNh-FHTxLag/edit" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="fa7f" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">初始设置(先决条件)</h1><p id="b8aa" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">首先，在一个新安装的Ubuntu 16.04上，右击-&gt;打开终端，输入:</p><blockquote class="kg kh ki"><p id="2171" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">sudo升级<br/> sudo升级<br/> sudo安装git <br/> sudo安装ffmpeg</p></blockquote><p id="d38a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">(可选)如果您将VMWare用作虚拟机，请在终端命令行中键入以下内容:</p><blockquote class="kg kh ki"><p id="72f3" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">sudo apt-get安装open-虚拟机工具<br/> sudo apt-get安装open-虚拟机工具桌面</p></blockquote><p id="9a7d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，我们需要从Github克隆C3D文件夹:</p><blockquote class="kg kh ki"><p id="1d4c" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">cd ~/Desktop/ <br/> git克隆<a class="ae jc" href="https://github.com/facebookarchive/C3D'" rel="noopener ugc nofollow" target="_blank">https://github.com/facebookarchive/C3D</a></p></blockquote><p id="afab" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，我们需要安装一些依赖项:</p><blockquote class="kg kh ki"><p id="c1d8" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">sudo apt-get install python-opencv<br/>sudo apt-get install build-essential cmake pkg-config<br/>sudo apt-get install libprotobuf-dev libleveldb-dev libsnappy-dev libopencv-dev<br/>sudo apt-get install liblapack-dev libhdf 5-serial-dev protobuf-compiler<br/>sudo apt-get install lib-base-dev<br/>sudo apt-get install—no-install—建议使用libboost-all-dev【T15</p></blockquote><h1 id="14dd" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">Caffe安装(CPU版本)</h1><p id="c3e5" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">安装完所有依赖项后，现在让我们开始安装Caffe，以便使用C3D模型。我将使用Caffe的CPU版本，因为我没有设法让我的虚拟机利用GPU。</p><h2 id="223a" class="kn je hh bd jf ko kp kq jj kr ks kt jn ip ku kv jr it kw kx jv ix ky kz jz la bi translated">1.复制Makefile.config.example文件</h2><p id="655f" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">要安装Caffe CPU，打开C3D文件夹，然后进入C3D 1.1版文件夹。右键单击并打开文件夹中的终端，然后键入:</p><blockquote class="kg kh ki"><p id="54e9" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">cp Makefile.config .示例Makefile.config</p></blockquote><h2 id="70da" class="kn je hh bd jf ko kp kq jj kr ks kt jn ip ku kv jr it kw kx jv ix ky kz jz la bi translated">2.编辑“Makefile.config”文件</h2><p id="1e8a" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">打开您刚才复制的“Makefile.config”文件，并更改这些行(对于Caffe CPU版本):</p><blockquote class="kg kh ki"><p id="30d0" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">1)取消第8行中“<strong class="ig hi"> #CPU_ONLY := 1”到“CPU_ONLY := 1 </strong>”的注释</p><p id="2ec0" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">2)将第83行中的'<strong class="ig hi"> PYTHON_LIB := /usr/lib </strong>'改为'<strong class="ig hi">PYTHON _ LIB:=/usr/LIB/usr/LIB/x86 _ 64-Linux-GNU/</strong>'</p><p id="088c" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">3)取消第91行中'<strong class="ig hi"> # WITH_PYTHON_LAYER := 1 </strong>'到'<strong class="ig hi"> WITH_PYTHON_LAYER := 1 </strong>'的注释</p></blockquote><p id="3c5f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于94号线和95号线:</p><blockquote class="kg kh ki"><p id="8ca6" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">你需要的任何东西都在这里。<br/>INCLUDE _ DIRS:= $(PYTHON _ INCLUDE)/usr/local/INCLUDE<br/>库_ DIRS:= $(PYTHON _ LIB)/usr/local/LIB/usr/LIB</p><p id="61f4" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">更改为:</p><p id="8d20" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated"><strong class="ig hi"> #你需要的任何东西都在这里。<br/>INCLUDE _ DIRS:= $(PYTHON _ INCLUDE)/usr/local/INCLUDE/usr/INCLUDE/HD F5/serial<br/>库_ DIRS:= $(PYTHON _ LIB)/usr/local/LIB/usr/LIB/usr/LIB/x86 _ 64-Linux-GNU/usr/LIB/x86 _ 64-Linux-GNU/HD F5/serial</strong></p></blockquote><h2 id="4fc1" class="kn je hh bd jf ko kp kq jj kr ks kt jn ip ku kv jr it kw kx jv ix ky kz jz la bi translated">3.编辑“Makefile”文件</h2><p id="f93a" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">然后，关闭“Makefile.config”编辑器并打开“Makefile”文件(不配置)。有两行需要更改:</p><blockquote class="kg kh ki"><p id="006f" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">1)第415行:</p><p id="ddf3" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated"><strong class="ig hi">nvcc FLAGS+=-ccbin = $(CXX)-Xcompiler-fPIC $(COMMON _ FLAGS)</strong></p><p id="7425" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">换成</p><p id="a90e" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated"><strong class="ig hi">NVCCFLAGS+=-D _ FORCE _ INLINES-ccbin = $(CXX)-Xcompiler-fPIC $(COMMON _ FLAGS)</strong></p><p id="35d2" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">2)第181行:<br/> <strong class="ig hi">库+= glog gflags proto buf boost _ system boost _ file system m HD F5 _ HL HD F5</strong></p><p id="efc3" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">更改为:</p><p id="012d" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated"><strong class="ig hi">LIBRARIES+= glog gflags protobuf boost _ system boost _ file system m HD F5 _ serial _ HL HD F5 _ serial opencv _ core opencv _ imgproc opencv _ high GUI</strong></p></blockquote><h2 id="6cf6" class="kn je hh bd jf ko kp kq jj kr ks kt jn ip ku kv jr it kw kx jv ix ky kz jz la bi translated">4.运行生成文件</h2><p id="fcbb" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">保存并关闭文件。然后，在C3D/C3D-v1.1文件夹中打开终端，并在终端中键入:</p><blockquote class="kg kh ki"><p id="d62c" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">制作所有<br/>制作测试<br/>制作运行测试<br/>制作咖啡</p></blockquote><p id="8ab7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你的电脑有更好的规格，你可以输入类似'<strong class="ig hi"> <em class="kj"> make all -j4 </em> ' </strong>的代码，这代表使用4个CPU内核来运行Makefile。如果出现错误，那么很可能会使用不带'<em class="kj"> -j4 </em>'参数的默认命令。</p><p id="cde9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="kj">旁注:如果你在make过程中遇到任何错误，不要忘记在重复任何“Make”命令之前通过键入“make clean”来清理构建。</em></p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es lb"><img src="../Images/b428c3fb5741f9e87e45d0eb89b2d5a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pBSA8ri4WqCFgf_X5f288A.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">通过“生成运行测试”中的所有测试</figcaption></figure><h1 id="1648" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">将视频转换为帧</h1><p id="40d1" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">因为我想从视频中提取特征，C3D允许视频输入由帧序列表示。在我的例子中，我将使用ffmpeg库把我的视频提取到帧中。C3D将假设每个视频是一个具有帧的文件夹，这些帧从000001开始编号到N(帧的数量为六位数)。帧名称的格式为“[视频文件夹名称]/%06.jpg”。</p><p id="d050" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通常，这些步骤是:</p><ol class=""><li id="ea8c" class="lr ls hh ig b ih ii il im ip lt it lu ix lv jb lw lx ly lz bi translated">导航到“/C3D-主/C3D-v 1.1/数据/”并创建新文件夹“视频/”(为了不与其他文件夹混淆)。</li><li id="7126" class="lr ls hh ig b ih ma il mb ip mc it md ix me jb lw lx ly lz bi translated">然后，在“videos/”文件夹中为每个视频创建一个新文件夹。</li><li id="f33f" class="lr ls hh ig b ih ma il mb ip mc it md ix me jb lw lx ly lz bi translated">在每个文件夹中，打开终端，输入:'<em class="kj">ffmpeg-I "[video name]. MP4 " % 06 . jpg '</em>提取帧。</li><li id="11c1" class="lr ls hh ig b ih ma il mb ip mc it md ix me jb lw lx ly lz bi translated">提取完所有帧后，我们可以进入下一阶段进行特征提取。</li></ol><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mf"><img src="../Images/427236e0dc66b5fa95466a9b2d6a134e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u-p24JoAefz89mSKvkQOOg.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">记住为每个你想要提取的视频创建不同的文件夹</figcaption></figure><h1 id="2090" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">基于C3D的特征提取</h1><p id="05d7" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">C3D提取16帧长的剪辑的特征，因此当从视频中提取特征时，需要将视频分成帧。此外，为了保留时间信息，在提取后续剪辑时，8个帧将被重叠。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div class="er es mg"><img src="../Images/8df3e38da75f344b6869ad6315cdc5e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*FhyMX2oVxKn1vtB5MW1NEg.png"/></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">视频中C3D特征提取过程的图示</figcaption></figure><h2 id="a8b5" class="kn je hh bd jf ko kp kq jj kr ks kt jn ip ku kv jr it kw kx jv ix ky kz jz la bi translated">1.在'中更改采样率。“prototxt”文件(可选)</h2><p id="0a87" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">导航到“<em class="kj">/C3D/C3D-v 1.1/examples/c3d _ ucf 101 _ feature _ extraction/</em>”文件夹。</p><p id="d39c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于C3D特征提取，默认采样率被设置为2，因此例如第一次提取将提取帧1、3、5…直到帧31。</p><p id="b010" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你想使用1的采样率，你可以只编辑。并将第16行中的“sampling_rate”从2改为1。</p><h2 id="e016" class="kn je hh bd jf ko kp kq jj kr ks kt jn ip ku kv jr it kw kx jv ix ky kz jz la bi translated">2.编辑“Feature_Extraction.sh”文件</h2><p id="0d42" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">打开'<strong class="ig hi"> feature_extraction.sh </strong>文件。第5行中特征提取的格式是:</p><blockquote class="kg kh ki"><p id="a9e0" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">extract _ image _ features . bin<feature_extractor_prototxt_file><c3d_pre_trained_model><gpu_id><mini_batch_size><number_of_mini_batches><output_prefix_file><feature_name1>T11】…</feature_name1></output_prefix_file></number_of_mini_batches></mini_batch_size></gpu_id></c3d_pre_trained_model></feature_extractor_prototxt_file></p></blockquote><p id="f2a1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于这个例子，有3件事需要改变:</p><blockquote class="kg kh ki"><p id="74b2" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">1.<gpu_id> : -1表示CPU，0表示GPU</gpu_id></p><p id="8c6b" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">2.<mini_batch_size>:如果你的CPU支持的话，批量可以更大，对我来说，我将使用10的批量。</mini_batch_size></p><p id="d73a" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated"><strong class="ig hi">* *如果您的批量发生变化，您需要编辑。并将第22行中的批处理大小更改为与该值相同。</strong></p><p id="30c8" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">3.<number_of_mini_batches>:此小批量数量基于所需的总提取量。</number_of_mini_batches></p><p id="9a5e" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">例如，如果您需要执行31个特征提取，并且您的“mini_batch_size”是10，您将需要4个mini_batch。而如果你总共有30个特征提取和10个小批量，你只需要3个小批量。</p></blockquote><h2 id="080b" class="kn je hh bd jf ko kp kq jj kr ks kt jn ip ku kv jr it kw kx jv ix ky kz jz la bi translated">“feature_extraction.sh”文件的第5行示例:</h2><p id="9c72" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">下面是一个例子，如果我需要执行18627次提取，并且我使用的批量大小为10，那么我的'<em class="kj"> feature_extraction.sh </em>'文件的第5行将是:</p><blockquote class="kg kh ki"><p id="2a89" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">LOG_logtostderr=1../../build/tools/extract _ image _ features . bin c3d _ resnet 18 _ ucf 101 _ feature _ extraction . proto txt c3d _ resnet 18 _ sports 1m _ R2 _ ITER _ 2800000 . caffemodel-1 10 1863 ucf 101 _ video _ frame . prefix fc8 pool 5 res5b</p></blockquote><h2 id="8a07" class="kn je hh bd jf ko kp kq jj kr ks kt jn ip ku kv jr it kw kx jv ix ky kz jz la bi translated">Prob，pool5，res5b？</h2><p id="0e5d" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">注意到“fc8”、“pool5”和“res5b”了吗？这些参数是什么？</p><p id="e029" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">基本上，这些是prototxt文件中定义的C3D体系结构的层。我发现C3D 1.1版的架构与下面显示的C3D架构图略有不同，因此要找到您想要的正确特性，您可以在prototxt文件中导航各层并自己更改特性。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mh"><img src="../Images/97f9a2c21b71641ad2bbe83c4fea49c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CRo0Zp8fkYfhcaRUzBcJAg.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">C3D建筑原文出自本文<a class="ae jc" href="https://vlg.cs.dartmouth.edu/c3d/c3d_video.pdf" rel="noopener ugc nofollow" target="_blank">此处</a></figcaption></figure><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mi"><img src="../Images/de14be2e32d6025de5537fa09cd7912c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CLIPC7WRJdgL6vVcF26Q7g.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">prototxt文件中的C3D架构层。请注意图层名称“fc8”、“pool5”、“res5b”。</figcaption></figure><h2 id="10aa" class="kn je hh bd jf ko kp kq jj kr ks kt jn ip ku kv jr it kw kx jv ix ky kz jz la bi translated">3.“编辑输入”。“列表”文件</h2><p id="d046" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">的’。前缀“和”。“列表”文件需要相应地更改为与原始文件类似的格式。</p><p id="2998" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用于输入。“列表”文件，它包含您输入到C3D用于提取特征的剪辑的信息。每行的格式如下:</p><blockquote class="kg kh ki"><p id="d9c3" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated"><string_path><starting_frame>T2】</starting_frame></string_path></p></blockquote><p id="2ee5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于特征提取，<label>将被忽略并用0填充。<br/> &lt; string_path &gt;是包含视频帧的文件夹的完整路径。<br/> &lt; starting_frame &gt;用于指定视频的起始帧。</label></p><p id="7987" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">举例:</strong></p><p id="6e7b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于我的示例视频，它有369帧。所以，我需要列出每次提取的所有开始帧。随后的<starting_frame>将总是前一次提取的第8帧。</starting_frame></p><p id="9e76" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于我使用的采样率为2，下一次提取的起始帧将是初始帧之后的16帧。</p><p id="7891" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">简单来说，1，3，5，7，…，27，29，31的第9帧就是<strong class="ig hi"> 17。</strong>这是因为C3D在连续提取之间重叠8帧，以保留时间信息，如前所述。</p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mj"><img src="../Images/f0365f7444891573f822914aee184202.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O0zb2n11Cj60oy71iNC5Dw.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">ucf101_video_frame.list文件示例</figcaption></figure><h2 id="559e" class="kn je hh bd jf ko kp kq jj kr ks kt jn ip ku kv jr it kw kx jv ix ky kz jz la bi translated">4.“编辑输出”。“前缀”文件</h2><p id="aa84" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">输出前缀文件用于指定保存提取要素的路径。<br/>对于文件，每一行的格式为:</p><blockquote class="kg kh ki"><p id="51cd" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated"><output_prefix/></p></blockquote><p id="7ddd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">其中每一行对应于输入中的行。“列表”文件的顺序相同。根据C3D 1.0版用户指南，建议创建一个输出文件夹，并格式化为起始帧(如下图所示)。这是为了在提取特征后更容易识别。<br/> <em class="kj"> Sidenote:提醒为每个视频创建不同的文件夹(video1，video2，...)</em></p><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mi"><img src="../Images/34b46c2de733679a21c21e2c1d8758fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8hU4PpCFNq90Kt8GNh7E2Q.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">ucf101_video_frame.prefix文件示例</figcaption></figure><h2 id="87f9" class="kn je hh bd jf ko kp kq jj kr ks kt jn ip ku kv jr it kw kx jv ix ky kz jz la bi translated">5.运行外壳脚本“feature_extraction.sh”</h2><p id="0534" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">所有文件相应更改后，打开“<em class="kj">c3d _ ucf 101 _ feature _ extraction/</em>”文件夹中的终端并运行:</p><blockquote class="kg kh ki"><p id="6e0b" class="ie if kj ig b ih ii ij ik il im in io kk iq ir is kl iu iv iw km iy iz ja jb ha bi translated">sh特征_提取. sh</p></blockquote><p id="9bdd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="kj">侧注:如果&lt; mini_batch_size &gt;对您的PC来说太高，它将显示一些错误，如:“检查失败:*大小为192675840的ptr主机分配失败”。如果发生这种情况，只需尝试在shell脚本和prototxt文件中调小您的批处理大小！</em></p><h1 id="c314" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">特征提取完成！</h1><figure class="lc ld le lf fd lg er es paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="er es mk"><img src="../Images/fb1fc5a44253d48249ee3d18a0f3d2ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2X5kx3q8EW2WxbWgHxLDxQ.png"/></div></div><figcaption class="ln lo et er es lp lq bd b be z dx translated">成功提取特征</figcaption></figure><p id="8f5d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">恭喜你，特征提取出来了！可以在每个视频的输出文件夹中找到这些功能。本例中提供的提取特征为‘prob’、‘pool 5’和‘res5b’。各层的整体架构可以在'<em class="kj">中找到。prototxt </em>文件。</p><p id="4449" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请让我知道你是否面临任何问题，或者任何我遗漏的东西，因为我花了很长时间配置和试验C3D 1.1版。谢谢！</p></div></div>    
</body>
</html>