<html>
<head>
<title>Launch Python apps locally from Excel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从Excel本地启动Python应用程序</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/launch-python-apps-locally-from-excel-754edb0fb50e?source=collection_archive---------5-----------------------#2021-04-08">https://medium.com/analytics-vidhya/launch-python-apps-locally-from-excel-754edb0fb50e?source=collection_archive---------5-----------------------#2021-04-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="f0e7" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">想想这个…你刚刚用Python开发了一个很棒的web应用程序，你想和你的同事分享它。你应该怎么做呢？你有什么选择？</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/545c7bdaadd2aa9baa7b12d220155070.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KTgOi6dScqsrKOz4dXubbg.jpeg"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">菲利贝托·桑蒂兰在<a class="ae jm" href="https://unsplash.com/s/photos/data-analytics?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="63ba" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">理想情况下，你应该在云服务(AWS、Google Cloud、Heroku等)上部署你的应用。)并简单地将潜在用户导向一个url。没有大惊小怪，没有混乱。但是你并不总是希望你的珍贵项目公开。或者你不想为托管服务付费。不管是什么原因，你仍然可以免费分享你的应用程序供本地使用。</p><blockquote class="kj"><p id="6335" class="kk kl hh bd km kn ko kp kq kr ks ki dx translated">"把你的工具放在一个工具箱里."</p></blockquote><p id="611a" class="pw-post-body-paragraph jn jo hh jp b jq kt ii js jt ku il jv jw kv jy jz ka kw kc kd ke kx kg kh ki ha bi translated">说没有人…从来没有…我完全编造了这句话，但它是真的。作为一名开发人员，你不断地构建工具，可能使用不同的语言和不同的程序。你的玩具散落在商店各处。在可能的情况下，试着把事情集中起来，让生活变得简单，不仅仅是为了你，也是为了你的潜在最终用户。</p><p id="34ab" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">考虑你的目标受众的经验水平。他们是否都能够与命令行交互、激活虚拟环境并使用正确的端口号打开浏览器访问本地主机？他们真的想再打开一个应用程序吗？不太可能。</p><p id="a242" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">Excel呢？大家能打开Excel点一下这些坏小子中的一个吗？现在我们正在谈论…</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ky"><img src="../Images/d5afc5dac09a1bbaaefdacbd4a8b34f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:378/format:webp/1*Lf-_38QitDtl2ulhkwF4Xg.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">坏男孩。图片作者。</figcaption></figure><p id="0d0d" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">MS Excel是一个绝对的机构。当你读到这些话的时候，如果你的电脑上没有打开电子表格，我会很惊讶的！诚然，与目前可用的令人兴奋的新编程语言相比，Excel有点过时，但它无疑是最丰富的分析工具。</p><p id="aceb" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这是你可以利用舒适和熟悉的老式excel宏按钮的地方，就像给用户一个温暖的拥抱。它所需要的只是幕后的一行VBA代码。</p><pre class="ix iy iz ja fd kz la lb lc aw ld bi"><span id="7027" class="le lf hh la b fi lg lh l li lj">Sub LaunchDashboard()</span><span id="6a60" class="le lf hh la b fi lk lh l li lj">command = Shell("C:\Users\" &amp; LCase(Environ$("Username")) &amp; "\Documents\Dasboard.bat", vbNormalFocus)</span><span id="0fca" class="le lf hh la b fi lk lh l li lj">End Sub</span></pre><p id="6569" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">上面的VBA代码检索Windows用户名，以动态地找到批处理文件的正确路径，并在命令提示符下运行它。“vbNormalFocus”保持命令提示符打开(而不是隐藏)以获得视觉反馈。</p><p id="00c6" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">现在让我们来看看实际的批次。bat)文件，用于打开命令提示符，激活虚拟环境，然后在Chrome中启动您的仪表板。</p><pre class="ix iy iz ja fd kz la lb lc aw ld bi"><span id="312e" class="le lf hh la b fi lg lh l li lj">start <a class="ae jm" href="http://127.0.0.1:8050/" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:8050/</a><br/>call C:\Users\%USERNAME%\anaconda3\Scripts\activate<br/>call conda activate dashboards<br/>python "C:\Users\%USERNAME%\Documents\dashboard.py"<br/>cmd /k</span></pre><ul class=""><li id="5237" class="ll lm hh jp b jq jr jt ju jw ln ka lo ke lp ki lq lr ls lt bi translated"><strong class="jp hi"> <em class="lu">启动http://127 . 0 . 0 . 1:8050</em></strong><em class="lu">—</em>在本地主机地址和正确端口(本例中为8050)启动默认网络浏览器，查看应用。</li><li id="4b89" class="ll lm hh jp b jq lv jt lw jw lx ka ly ke lz ki lq lr ls lt bi translated"><strong class="jp hi"> <em class="lu">调用C:\ Users \ % USERNAME % \ anaconda 3 \ Scripts \ activate</em></strong>—有效地将命令提示符变成Anaconda提示符，以便能够识别“conda”命令。注意使用<em class="lu"> %USERNAME% </em>来动态获取Windows用户名。</li><li id="217c" class="ll lm hh jp b jq lv jt lw jw lx ka ly ke lz ki lq lr ls lt bi translated"><strong class="jp hi"> <em class="lu">调用conda激活仪表盘</em> </strong> —激活虚拟环境。</li><li id="6491" class="ll lm hh jp b jq lv jt lw jw lx ka ly ke lz ki lq lr ls lt bi translated"><strong class="jp hi"><em class="lu">python " C:\ Users \ % USERNAME % \ Documents \ dashboard . py "</em></strong>—使用动态文件路径运行应用程序。</li><li id="3b69" class="ll lm hh jp b jq lv jt lw jw lx ka ly ke lz ki lq lr ls lt bi translated"><strong class="jp hi"> <em class="lu"> cmd /k </em> </strong> —保持命令提示窗口打开以获得视觉反馈。</li></ul><p id="2583" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">下面是一个由VBA代码执行的批处理文件的示例，它成功地在本地主机上启动了一个仪表板。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ma"><img src="../Images/939335e04650d30c7ba44145ec7601e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jSU6labeapXG3UCJK9E_Sw.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">成功执行批处理文件和仪表板启动。想象作者。</figcaption></figure><p id="ca2c" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这个例子需要注意的是，与您共享项目的每个人都需要在同一个相对目录中维护它——所以保持文件路径简单。用户还需要建立一个和你一样的虚拟环境。为了简洁起见，我在这里就不赘述了，如果需要的话，有很多文章可以指导你，但是请相信我——这很容易。在我看来，这些小细节被<em class="lu">“把你的工具放在一个工具箱里”</em>的实用性和每个人的可访问性所弥补。</p><p id="dbe3" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">试一试，让我知道你的想法！</p></div></div>    
</body>
</html>