<html>
<head>
<title>Convolutional Neural Networks for Image Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于图像分类的卷积神经网络</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/convolutional-neural-networks-for-image-classification-c403159e81af?source=collection_archive---------21-----------------------#2021-02-21">https://medium.com/analytics-vidhya/convolutional-neural-networks-for-image-classification-c403159e81af?source=collection_archive---------21-----------------------#2021-02-21</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/a0cdd26531524f17d14210ffa09c974e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VN6bGHQnYkd-l2eJlDA_yA.jpeg"/></div></div></figure><div class=""/><p id="ea3d" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在<a class="ae jn" rel="noopener" href="/analytics-vidhya/a-brief-introduction-to-deep-learning-ccfd901d4611">深度学习</a>中，卷积神经网络，也称为ConvNets或CNN，是一种深度神经网络，已被证明在计算机视觉领域非常强大。它们被用于各种领域，如面部识别、医学成像、无人驾驶汽车等。</p><p id="61bb" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">本文解释了卷积神经网络的工作原理，并举例说明了如何使用TensorFlow和Keras将其应用于图像分类。文章分为以下两个主要部分:</p><ul class=""><li id="fe6a" class="jo jp hs ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">卷积神经网络的体系结构</li><li id="0149" class="jo jp hs ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">使用<a class="ae jn" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> TensorFlow </a>和<a class="ae jn" href="https://keras.io/api/" rel="noopener ugc nofollow" target="_blank"> Keras </a>建立一个基本的CNN模型</li></ul></div><div class="ab cl kc kd go ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="ha hb hc hd he"><h1 id="9fe5" class="kj kk hs bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">卷积神经网络的体系结构</h1><p id="83be" class="pw-post-body-paragraph ip iq hs ir b is lh iu iv iw li iy iz ja lj jc jd je lk jg jh ji ll jk jl jm ha bi translated">卷积神经网络是一种特殊的深度神经网络，能够捕捉图像中的空间相关性。在常规的前馈神经网络中，二维图像(像素值的矩阵)被折叠(即展平)成一维向量，并被馈入密集网络。这导致丢失二维图像的结构，从而丢失图像中的空间结构。此外，这需要密集的计算，因为图像中的每个像素都连接到网络中的每个神经元，导致大量的参数。</p><figure class="ln lo lp lq fd hj er es paragraph-image"><div class="er es lm"><img src="../Images/1d808e6624528db8f91d759a33536071.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*alwKQxfv08hPksxaktLzNA.png"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">图1:展平为9x1矢量的3x3x1图像</figcaption></figure><p id="4a53" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">卷积神经网络的架构通过应用下面描述的<strong class="ir ht">卷积</strong>和<strong class="ir ht">池</strong>层来解决上述问题。</p><figure class="ln lo lp lq fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es lv"><img src="../Images/b5db46bf339822228d8561da5e1b99eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_r8lTECbVCq6saa586AlXg.jpeg"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">图2:卷积神经网络的基本层</figcaption></figure><h2 id="311b" class="lw kk hs bd kl lx ly lz kp ma mb mc kt ja md me kx je mf mg lb ji mh mi lf mj bi translated">卷积层</h2><p id="ae52" class="pw-post-body-paragraph ip iq hs ir b is lh iu iv iw li iy iz ja lj jc jd je lk jg jh ji ll jk jl jm ha bi translated">卷积层是卷积神经网络的第一层，也是最重要的一层。它应用一种称为“卷积”的操作来执行特征提取，而无需手动提取这些特征。卷积运算应用于特定的过滤器(也称为内核)和图像的特定补片之间，以产生特征图。滤波器由一组图像卷积的权重表示。过滤器负责检测图像的特定模式，如边缘，它可以有几种大小；最常用的过滤器尺寸为3x3、5x5和7x7。</p><figure class="ln lo lp lq fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mk"><img src="../Images/86a4102d5c4e23c6cc0556138cd7c094.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YFQk7p1qn4fPsx6J3RVI6A.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">图3:9x9x 1图像与3x3滤镜的卷积</figcaption></figure><p id="9bee" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">可以应用下面的公式来确定最终的特征图大小:<strong class="ir ht">[(W-K+2P/秒] + 1 </strong>，其中W是输入音量，K是内核大小，P是添加的填充量，S是步幅。<em class="ml">填充</em>是在边框周围用零填充输入图像的过程；这有助于控制输出的大小。一个<em class="ml">步距</em>代表过滤器在特定图像上卷积的像素数。在上面图3的例子中，W是9，K是3，S是1，P是0，这产生了7x7x1的特征图。</p><figure class="ln lo lp lq fd hj er es paragraph-image"><div class="er es mm"><img src="../Images/8d0c8d79ca7ffa7b613f2c4923420c69.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/1*1VJDP6qDY9-ExTuQVEOlVg.gif"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">图4:填充和步幅= 2的卷积— <a class="ae jn" href="https://github.com/vdumoulin/conv_arithmetic" rel="noopener ugc nofollow" target="_blank">图源</a></figcaption></figure><p id="353d" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">值得注意的是，实际上卷积层有多个滤波器，因此每个滤波器输出一个特征图。此外，输入图像由多个子图层组成(每个颜色图层一个)。例如，RGB图像由三个通道组成，每个通道对应一种颜色(红色、绿色和蓝色)，而在灰度图像中只能找到一个通道。在图3所示的例子中，图像是9x9x1，这意味着它是9x9像素的灰度图像。</p><p id="1d9b" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">卷积运算后，应用<a class="ae jn" href="https://machinelearningmastery.com/rectified-linear-activation-function-for-deep-learning-neural-networks/#:~:text=The%20rectified%20linear%20activation%20function,otherwise%2C%20it%20will%20output%20zero.&amp;text=The%20rectified%20linear%20activation%20function%20overcomes%20the%20vanishing%20gradient%20problem,learn%20faster%20and%20perform%20better." rel="noopener ugc nofollow" target="_blank"> ReLU </a>激活函数引入非线性，并用零替换所有非负值。</p><h2 id="8092" class="lw kk hs bd kl lx ly lz kp ma mb mc kt ja md me kx je mf mg lb ji mh mi lf mj bi translated">汇集层</h2><p id="6547" class="pw-post-body-paragraph ip iq hs ir b is lh iu iv iw li iy iz ja lj jc jd je lk jg jh ji ll jk jl jm ha bi translated">汇集层位于卷积层之后。它的作用是减少卷积图像的空间大小并提取主要特征。两种常见的池类型是:</p><ul class=""><li id="31f7" class="jo jp hs ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">Max pooling:返回内核覆盖的补丁的最大值</li><li id="a70d" class="jo jp hs ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">平均池:返回内核覆盖的补丁的平均值</li></ul><figure class="ln lo lp lq fd hj er es paragraph-image"><div class="er es mn"><img src="../Images/04a8bca858d033b7171b9c9d2f6400ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*bUbTNh1MQLP02mBQ6Rx8Gw.png"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">图5:最大池与平均池</figcaption></figure><h2 id="3b08" class="lw kk hs bd kl lx ly lz kp ma mb mc kt ja md me kx je mf mg lb ji mh mi lf mj bi translated">全连接层</h2><p id="6785" class="pw-post-body-paragraph ip iq hs ir b is lh iu iv iw li iy iz ja lj jc jd je lk jg jh ji ll jk jl jm ha bi translated">在卷积和池层之后，应用完全连接的层。简单地说，全连接层是一个负责分类任务的前馈神经网络。完全连接层的输入是合并或卷积层展平成1D数组的最终输出(即向量)。</p><h1 id="05fb" class="kj kk hs bd kl km mo ko kp kq mp ks kt ku mq kw kx ky mr la lb lc ms le lf lg bi translated">使用TensorFlow和Keras的CNN模型</h1><p id="98b8" class="pw-post-body-paragraph ip iq hs ir b is lh iu iv iw li iy iz ja lj jc jd je lk jg jh ji ll jk jl jm ha bi translated">上一节强调了卷积神经网络的主要层并解释了它们的功能。本节描述如何使用<a class="ae jn" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> TensorFlow </a>和<a class="ae jn" href="https://keras.io/api/" rel="noopener ugc nofollow" target="_blank"> Keras </a>构建CNN模型。</p><p id="fe5e" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">构建模型有三种方式(顺序、功能和模型子类化)。图6显示了使用顺序方法创建的模型。该模型是一个基本的CNN模型，用于对<a class="ae jn" href="https://www.kaggle.com/tongpython/cat-and-dog" rel="noopener ugc nofollow" target="_blank">狗和</a>猫的图像进行分类，100个时期的准确率约为90%。</p><figure class="ln lo lp lq fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mt"><img src="../Images/17d97708fda54d0d97a5892c79edb7a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3jI262ZuqTJT8SIEO4nJOQ.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">图6:一个基本的CNN模型— <a class="ae jn" href="https://github.com/kheirie/cats-vs-dogs/blob/main/cats_vs_dog.ipynb" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="7c64" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们一层一层地研究这个模型:</p><ul class=""><li id="3bdf" class="jo jp hs ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">第一层使用64个3×3滤波器。使用步幅和填充的默认值，步幅为(1，1)，填充为“有效”(意味着不应用填充)。如果要应用填充，则应使用“相同的”填充。输入形状是(150，150，3)，因为图像是150x150像素，并且具有3个通道(即RGB)。</li><li id="9f1a" class="jo jp hs ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">接下来，使用2x2的池大小应用最大池层。</li><li id="350a" class="jo jp hs ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">相同的结构重复两次:一个卷积层后面跟着一个最大池层。层数是一个可以调整的超参数。随着我们向卷积层的更深处移动，滤波器的数量增加；这有助于从低级特征(例如，垂直线、小圆圈等)中捕捉尽可能多的组合。)以便创建高级特征抽象。通常的做法是将过滤器的数量增加一倍。</li><li id="fc1f" class="jo jp hs ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">然后是由两个密集层组成的全连接网络。由于密集网络需要1D要素阵列，因此输入会被展平。第一密集层具有1024个单元，并使用“relu”作为激活函数。由于所解决的问题是二进制分类问题，第二和最后的密集层由1单元(即输出)组成，并且“sigmoid”被用作激活函数。</li></ul></div><div class="ab cl kc kd go ke" role="separator"><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh ki"/><span class="kf bw bk kg kh"/></div><div class="ha hb hc hd he"><p id="1436" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">卷积神经网络已经被用于各种领域，例如自然语言处理、语音识别和计算机视觉。他们最出名的是在图像分类任务上的成功。本文介绍了卷积神经网络架构的基础知识，重点是图像分类任务，并给出了一个如何使用TensorFlow和Keras构建CNN模型的示例。</p><p id="22f5" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir ht">参考文献:</strong></p><ul class=""><li id="cae8" class="jo jp hs ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated"><a class="ae jn" href="https://www.youtube.com/watch?v=iaSUYvmCekI&amp;list=PLtBw6njQRU-rwp5__7C0oIVt26ZgjG9NI&amp;index=5" rel="noopener ugc nofollow" target="_blank"> MIT 6。S191 (2020):卷积神经网络</a></li><li id="bda6" class="jo jp hs ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated"><a class="ae jn" href="https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53" rel="noopener" target="_blank">卷积神经网络综合指南ELI5方式</a></li></ul></div></div>    
</body>
</html>