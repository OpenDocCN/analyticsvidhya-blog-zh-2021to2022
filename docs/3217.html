<html>
<head>
<title>Manage Your Workflows With Apache Airflow.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Apache Airflow管理您的工作流程。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/manage-your-workflows-with-apache-airflow-e7b0e45544a8?source=collection_archive---------7-----------------------#2021-06-19">https://medium.com/analytics-vidhya/manage-your-workflows-with-apache-airflow-e7b0e45544a8?source=collection_archive---------7-----------------------#2021-06-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="0b57" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">介绍、安装和设置<strong class="ak">阿帕奇气流</strong>在<strong class="ak"> Python </strong>中。</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/0d69c3059fe4dfcf83bd181e179e027b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KE5l4k92GSvNymPVx4H-cw.jpeg"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">照片由<a class="ae jm" href="https://www.pexels.com/@pixabay" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>在<a class="ae jm" href="https://www.pexels.com/" rel="noopener ugc nofollow" target="_blank">像素</a>上拍摄</figcaption></figure><blockquote class="jn"><p id="5e4f" class="jo jp hh bd jq jr js jt ju jv jw jx dx translated">管理就是把事情做对；</p><p id="7bd0" class="jo jp hh bd jq jr jy jz ka kb kc jx dx translated">领导力就是做正确的事情。</p><p id="7926" class="jo jp hh bd jq jr jy jz ka kb kc jx dx translated">—彼得·德鲁克</p></blockquote><blockquote class="kd ke kf"><p id="765e" class="kg kh ki kj b kk kl ii km kn ko il kp kq kr ks kt ku kv kw kx ky kz la lb jx ha bi translated">第1部分:Python中Apache Airflow的介绍、安装和设置</p><p id="d5ea" class="kg kh ki kj b kk lc ii km kn ld il kp kq le ks kt ku lf kw kx ky lg la lb jx ha bi translated">用Python编写你的第一个实时DAG。</p></blockquote><p id="7c33" class="pw-post-body-paragraph kg kh hh kj b kk lc ii km kn ld il kp lh le ks kt li lf kw kx lj lg la lb jx ha bi translated">数据是当今所有业务的核心。随着公司越来越依赖数据，数据工程的重要性也在不断增长。数据工程有助于使数据对数据消费者更有用和更容易获得。数据工程师作为“数据管道”在端到端流程中扮演着重要角色每个管道都有一个或多个源和一个或多个目的地。在管道中，数据可能经历几个步骤的转换、验证、丰富、汇总或其他步骤。数据工程师创建这些管道，并使用一些高效的工程工具管理工作流。当数据技术频繁出现时，当我们考虑工作流管理时，<strong class="kj hi"> Apache Airflow </strong>站在首位。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lk"><img src="../Images/1747ff0b00a6670b2a157c81a05cd91e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kpbqN0GZTDTA7t4fA9L1Eg.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated"><a class="ae jm" href="https://airflow.apache.org/" rel="noopener ugc nofollow" target="_blank">https://airflow.apache.org/</a></figcaption></figure><h1 id="af49" class="ll lm hh bd ln lo lp lq lr ls lt lu lv in lw io lx iq ly ir lz it ma iu mb mc bi translated">什么是气流？</h1><p id="f0b8" class="pw-post-body-paragraph kg kh hh kj b kk md ii km kn me il kp lh mf ks kt li mg kw kx lj mh la lb jx ha bi translated">作为一名数据工程师，总有一天你会想到如何编排你的工作流程，而Apache Airflows的出现填补了这个空白。Apache Airflow最初创建于2014年的Airbnb，是一款用于编排复杂工作流程和数据处理管道的开源工具。它是一个以编程方式创作、调度和监控工作流的平台。</p><p id="c08a" class="pw-post-body-paragraph kg kh hh kj b kk lc ii km kn ld il kp lh le ks kt li lf kw kx lj lg la lb jx ha bi translated"><strong class="kj hi">创作:</strong>air flow中的工作流用Python编程语言写成<strong class="kj hi"> </strong>有向无环图(Dag)。它允许用户用python编写他们的自定义工作流。</p><p id="c288" class="pw-post-body-paragraph kg kh hh kj b kk lc ii km kn ld il kp lh le ks kt li lf kw kx lj lg la lb jx ha bi translated"><strong class="kj hi">调度:</strong>用户可以指定一个工作流应该什么时候开始，什么时候结束，以及它应该在什么时间间隔后再次运行。</p><p id="d5fd" class="pw-post-body-paragraph kg kh hh kj b kk lc ii km kn ld il kp lh le ks kt li lf kw kx lj lg la lb jx ha bi translated"><strong class="kj hi">监控:</strong>air flow用户界面可以轻松监控数据管道并对其进行故障排除。它有很多工具可以实时跟踪你的工作流程。</p><h1 id="9a56" class="ll lm hh bd ln lo lp lq lr ls lt lu lv in lw io lx iq ly ir lz it ma iu mb mc bi translated">安装和设置</h1><h2 id="e173" class="mi lm hh bd ln mj mk ml lr mm mn mo lv lh mp mq lx li mr ms lz lj mt mu mb mv bi translated">第一步</h2><p id="7288" class="pw-post-body-paragraph kg kh hh kj b kk md ii km kn me il kp lh mf ks kt li mg kw kx lj mh la lb jx ha bi translated">现在我们已经了解了Airflow的不同组件，让我们从在我们的工作站上设置Airflow开始，这样我们就可以在本地测试和运行我们构建的管道。我们要做的第一件事是创建一个新文件夹，用Python 3创建一个虚拟环境并激活它，我们将在其中安装并运行Airflow。让我们速战速决，</p><pre class="ix iy iz ja fd mw mx my mz aw na bi"><span id="4737" class="mi lm hh mx b fi nb nc l nd ne"><strong class="mx hi">$ mkdir Airflow</strong>                   # make a folder<br/><strong class="mx hi">$ cd Airflow                      </strong># directed to the directory<br/><strong class="mx hi">$ python3 -m venv airflowenv</strong>      # create a vertual environment<br/><strong class="mx hi">$ source airflowenv/bin/activate  </strong># activate the environment</span></pre><h2 id="26fd" class="mi lm hh bd ln mj mk ml lr mm mn mo lv lh mp mq lx li mr ms lz lj mt mu mb mv bi translated">第二步</h2><p id="d857" class="pw-post-body-paragraph kg kh hh kj b kk md ii km kn me il kp lh mf ks kt li mg kw kx lj mh la lb jx ha bi translated">安装Airflow最新稳定版本的最简单方法是使用pip，但在升级之前，pip版本和安装airflow:</p><pre class="ix iy iz ja fd mw mx my mz aw na bi"><span id="fe30" class="mi lm hh mx b fi nb nc l nd ne"><strong class="mx hi">$ pip install --upgrade pip         </strong># pip upgrade<strong class="mx hi"><br/>$ pip install apache-airflow        </strong># installing airflow</span></pre><h2 id="8e51" class="mi lm hh bd ln mj mk ml lr mm mn mo lv lh mp mq lx li mr ms lz lj mt mu mb mv bi translated">第三步</h2><p id="e361" class="pw-post-body-paragraph kg kh hh kj b kk md ii km kn me il kp lh mf ks kt li mg kw kx lj mh la lb jx ha bi translated">安装后，检查您在系统上安装的气流版本，</p><pre class="ix iy iz ja fd mw mx my mz aw na bi"><span id="fae6" class="mi lm hh mx b fi nb nc l nd ne"><strong class="mx hi">$ airflow version<br/></strong>&gt;&gt; 2.1.0</span></pre><h2 id="1d46" class="mi lm hh bd ln mj mk ml lr mm mn mo lv lh mp mq lx li mr ms lz lj mt mu mb mv bi translated">第四步</h2><p id="1352" class="pw-post-body-paragraph kg kh hh kj b kk md ii km kn me il kp lh mf ks kt li mg kw kx lj mh la lb jx ha bi translated">Airflow需要在本地系统上运行一个位置，称为<em class="ki"> AIRFLOW_HOME </em>。如果我们不指定它，它将默认为您的路由目录。我建议你将<em class="ki"> AIRFLOW_HOME </em>设置在你当前所在的目录下，也就是你创建虚拟环境的目录下。</p><pre class="ix iy iz ja fd mw mx my mz aw na bi"><span id="90b3" class="mi lm hh mx b fi nb nc l nd ne"><strong class="mx hi">$ export AIRFLOW_HOME=.</strong></span></pre><h2 id="a906" class="mi lm hh bd ln mj mk ml lr mm mn mo lv lh mp mq lx li mr ms lz lj mt mu mb mv bi translated">第五步</h2><p id="60ce" class="pw-post-body-paragraph kg kh hh kj b kk md ii km kn me il kp lh mf ks kt li mg kw kx lj mh la lb jx ha bi translated">配置完成后，您需要初始化数据库，然后才能运行任务:</p><pre class="ix iy iz ja fd mw mx my mz aw na bi"><span id="b73a" class="mi lm hh mx b fi nb nc l nd ne"><strong class="mx hi">$ airflow db init</strong></span></pre><p id="9a2e" class="pw-post-body-paragraph kg kh hh kj b kk lc ii km kn ld il kp lh le ks kt li lf kw kx lj lg la lb jx ha bi translated">这将启动运行气流任务的先决条件。如果你仔细观察，会发现在你的气流目录下创建了一些文件夹。改天我会仔细调查的。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nf"><img src="../Images/110b50010d5477d1d8d429d5ffb6c85c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pDxifz5xA0AQcO7bRsocUQ.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">初始化元数据数据库后创建的文件</figcaption></figure><h2 id="dcd2" class="mi lm hh bd ln mj mk ml lr mm mn mo lv lh mp mq lx li mr ms lz lj mt mu mb mv bi translated">第六步</h2><p id="34f9" class="pw-post-body-paragraph kg kh hh kj b kk md ii km kn me il kp lh mf ks kt li mg kw kx lj mh la lb jx ha bi translated">当您第一次开始使用airflow时，它可能会要求您登录。要设置您的用户id和密码，请运行以下命令。这将设置你的用户名为“<em class="ki">管理员</em>”，密码也为“<em class="ki">管理员</em>”。</p><pre class="ix iy iz ja fd mw mx my mz aw na bi"><span id="705c" class="mi lm hh mx b fi nb nc l nd ne"><strong class="mx hi">$ airflow users  create --role Admin --username admin --email admin --firstname admin --lastname admin --password admin</strong></span></pre><h2 id="5d6e" class="mi lm hh bd ln mj mk ml lr mm mn mo lv lh mp mq lx li mr ms lz lj mt mu mb mv bi translated">第七步</h2><p id="3cf6" class="pw-post-body-paragraph kg kh hh kj b kk md ii km kn me il kp lh mf ks kt li mg kw kx lj mh la lb jx ha bi translated">现在，我们已经准备好在本地运行Airflow Web服务器和调度程序。使用两个单独的shell选项卡来运行这两个进程，并且不要忘记在新选项卡中激活虚拟环境。</p><p id="faa6" class="pw-post-body-paragraph kg kh hh kj b kk lc ii km kn ld il kp lh le ks kt li lf kw kx lj lg la lb jx ha bi translated">为了更好的实践，我建议你先运行Scheduler，然后再运行Web服务器。</p><h2 id="4556" class="mi lm hh bd ln mj mk ml lr mm mn mo lv lh mp mq lx li mr ms lz lj mt mu mb mv bi translated">启动调度程序:</h2><pre class="ix iy iz ja fd mw mx my mz aw na bi"><span id="da36" class="mi lm hh mx b fi nb nc l nd ne"><strong class="mx hi">$ airflow scheduler</strong></span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ng"><img src="../Images/7bcfb5fb9c0b772e305dc2d1dc2c2900.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DyPe991Ukfpcz0DMSjwHHw.png"/></div></div></figure><h2 id="b326" class="mi lm hh bd ln mj mk ml lr mm mn mo lv lh mp mq lx li mr ms lz lj mt mu mb mv bi translated">启动web服务器</h2><pre class="ix iy iz ja fd mw mx my mz aw na bi"><span id="41f8" class="mi lm hh mx b fi nb nc l nd ne"><strong class="mx hi">$ airflow webserver — port 8080     </strong>#default port is 8080</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nh"><img src="../Images/ff5d89d1d29bdc50f4d2a33924f59ce1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EZHBxq5sBdDdLoLvs3-5fQ.png"/></div></div></figure><p id="05e7" class="pw-post-body-paragraph kg kh hh kj b kk lc ii km kn ld il kp lh le ks kt li lf kw kx lj lg la lb jx ha bi translated">要访问Web服务器UI，请在浏览器中访问<em class="ki"> localhost:8080 </em>，并使用您刚刚创建的管理员帐户登录。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ni"><img src="../Images/0e8e767477167c5dadebdc7f08956a1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*v9QLAz6e4jSwkzCn9eXh9g.gif"/></div></div></figure><h1 id="cdf9" class="ll lm hh bd ln lo lp lq lr ls lt lu lv in lw io lx iq ly ir lz it ma iu mb mc bi translated">结论:</h1><p id="e260" class="pw-post-body-paragraph kg kh hh kj b kk md ii km kn me il kp lh mf ks kt li mg kw kx lj mh la lb jx ha bi translated">祝贺您，您已经成功设置了您的气流环境。在下一篇博文中，我将向您展示如何使用Airflow运行实时工作流。在那之前，做好准备，保持动力。</p><h1 id="42f4" class="ll lm hh bd ln lo lp lq lr ls lt lu lv in lw io lx iq ly ir lz it ma iu mb mc bi translated">+1 <strong class="ak">公告:</strong></h1><p id="3f96" class="pw-post-body-paragraph kg kh hh kj b kk md ii km kn me il kp lh mf ks kt li mg kw kx lj mh la lb jx ha bi translated">预计将有超过10K软件工程师、数据科学家、商业智能分析师和DevOps工程师将参加2021年气流峰会(7月8日至16日)。Airflow Summit是一个面向Apache Airflow全球开发者和用户社区的免费在线会议。该活动将包括主题演讲、社区讲座和深入研讨会。</p><p id="929e" class="pw-post-body-paragraph kg kh hh kj b kk lc ii km kn ld il kp lh le ks kt li lf kw kx lj lg la lb jx ha bi translated">报名参加<a class="ae jm" href="https://www.crowdcast.io/e/airflowsummit2021/register?utm_campaign=AstronomerMarketing&amp;utm_source=Website&amp;utm_medium=Bar" rel="noopener ugc nofollow" target="_blank">2021年气流峰会</a>。</p><h1 id="183f" class="ll lm hh bd ln lo lp lq lr ls lt lu lv in lw io lx iq ly ir lz it ma iu mb mc bi translated">感谢您的阅读！</h1><p id="df8a" class="pw-post-body-paragraph kg kh hh kj b kk md ii km kn me il kp lh mf ks kt li mg kw kx lj mh la lb jx ha bi translated"><a class="ae jm" rel="noopener" href="/@shritam">通过Medium </a>关注我的最新更新。😃</p><h1 id="eeef" class="ll lm hh bd ln lo lp lq lr ls lt lu lv in lw io lx iq ly ir lz it ma iu mb mc bi translated">参考:</h1><div class="nj nk ez fb nl nm"><a href="https://airflow.apache.org/docs/" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab dw"><div class="no ab np cl cj nq"><h2 class="bd hi fi z dy nr ea eb ns ed ef hg bi translated">证明文件</h2><div class="nt l"><h3 class="bd b fi z dy nr ea eb ns ed ef dx translated">Apache Airflow Core，它包括web服务器、调度程序、CLI和最小气流所需的其他组件…</h3></div><div class="nu l"><p class="bd b fp z dy nr ea eb ns ed ef dx translated">airflow.apache.org</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa jg nm"/></div></div></a></div><div class="nj nk ez fb nl nm"><a href="https://www.astronomer.io/" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab dw"><div class="no ab np cl cj nq"><h2 class="bd hi fi z dy nr ea eb ns ed ef hg bi translated">天文学家|阿帕奇气流的企业框架</h2><div class="nt l"><h3 class="bd b fi z dy nr ea eb ns ed ef dx translated">在我们或您的云中轻松运行、管理和扩展Apache气流。</h3></div><div class="nu l"><p class="bd b fp z dy nr ea eb ns ed ef dx translated">www .天文学家. io</p></div></div><div class="nv l"><div class="ob l nx ny nz nv oa jg nm"/></div></div></a></div></div></div>    
</body>
</html>