<html>
<head>
<title>Intro to Machine Learning in Python: Part III</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的机器学习简介:第三部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/intro-to-machine-learning-part-iii-2bf5757d0219?source=collection_archive---------33-----------------------#2021-01-17">https://medium.com/analytics-vidhya/intro-to-machine-learning-part-iii-2bf5757d0219?source=collection_archive---------33-----------------------#2021-01-17</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/448316c3a0ba7bda0c3e6e1cd8b6a1bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QUeI2qgWSpHqER4FFAWF-g.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">(图片由作者提供)</figcaption></figure><div class=""/></div><div class="ab cl it iu go iv" role="separator"><span class="iw bw bk ix iy iz"/><span class="iw bw bk ix iy iz"/><span class="iw bw bk ix iy"/></div><div class="ha hb hc hd he"><h1 id="a20b" class="ja jb hw bd jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx bi translated">目录</h1><ol class=""><li id="857a" class="jy jz hw ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">模型评估</li><li id="bb87" class="jy jz hw ka b kb kq kd kr kf ks kh kt kj ku kl km kn ko kp bi translated">模型的预测</li><li id="933e" class="jy jz hw ka b kb kq kd kr kf ks kh kt kj ku kl km kn ko kp bi translated">回归评估指标</li><li id="af73" class="jy jz hw ka b kb kq kd kr kf ks kh kt kj ku kl km kn ko kp bi translated">结束思考</li></ol><p id="426b" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">这是我的Python机器学习入门系列的3部分中的最后一部分，写起来很刺激，希望你们中的一些人能从阅读中有所收获。在<a class="ae lm" rel="noopener" href="/analytics-vidhya/intro-to-machine-learning-in-python-part-ii-d91adb274324f">机器学习简介:第二部分</a>的上一篇文章中，我们谈到了如何分割、训练、测试和拟合我们的线性回归模型。在这一篇中，我们将在构建并测试我们的模型之后，深入研究这个过程。为此，我们需要通过打印截距和系数来评估模型，查看来自我们模型的预测，然后从定量方法评估它。这是我们的总结，让我们通过例子和一些代码来看看这是如何完成的！</p><h1 id="24f2" class="ja jb hw bd jc jd ln jf jg jh lo jj jk jl lp jn jo jp lq jr js jt lr jv jw jx bi translated">模型评估</h1><p id="38d2" class="pw-post-body-paragraph kv kw hw ka b kb kc ky kz kd ke lb lc kf ls le lf kh lt lh li kj lu lk ll kl ha bi translated">为了开始评估我们的线性回归模型，我们将打印模型的截距和系数。我们需要做的第一件事是打印我们的截距，代码如下所示。</p><pre class="lv lw lx ly fd lz ma mb mc aw md bi"><span id="1895" class="me jb hw ma b fi mf mg l mh mi">print(lm.intercept_)</span></pre><p id="80f2" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">这应该会给你下面的截距。完成这些后，你可以继续打印系数。系数与X_train中的列相关。因此，通过这样做，我们将从系数中创建一个数据框架，使它们更具可读性，更易于解释。Python中的代码可能如下所示。</p><pre class="lv lw lx ly fd lz ma mb mc aw md bi"><span id="a919" class="me jb hw ma b fi mf mg l mh mi">coeff_df = pd.DataFrame(lm.coef_,X.columns,columns=['Coefficient'])<br/>coeff_df</span></pre><p id="0ba8" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">这将创建一个数据框，其中包含您的相关行，以及它们旁边的相应系数。从这里开始，我们转移到如何解释这些系数。</p><p id="8bae" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">解释一下你那一栏右边的数字，意思是在所有东西都不变的情况下，增加1个单位将导致系数增加多少个单位。因此，根据数据和你试图回答的问题，解释这些将取决于具体情况。</p><p id="4936" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">现在，我们已经从系数中获得了一些见解，我们可以开始查看我们的模型的预测数据。</p><h1 id="9753" class="ja jb hw bd jc jd ln jf jg jh lo jj jk jl lp jn jo jp lq jr js jt lr jv jw jx bi translated">模型的预测</h1><p id="36b5" class="pw-post-body-paragraph kv kw hw ka b kb kc ky kz kd ke lb lc kf ls le lf kh lt lh li kj lu lk ll kl ha bi translated">为了从我们的模型中分析我们的预测，我们需要:</p><ul class=""><li id="50a6" class="jy jz hw ka b kb kx kd la kf mj kh mk kj ml kl mm kn ko kp bi translated">将我们从测试数据中得到的预测存储在一个变量中</li><li id="36c8" class="jy jz hw ka b kb kq kd kr kf ks kh kt kj ku kl mm kn ko kp bi translated">使用matplotlib制作散点图</li><li id="c2c2" class="jy jz hw ka b kb kq kd kr kf ks kh kt kj ku kl mm kn ko kp bi translated">使用seaborn制作一个distplot</li></ul><p id="b289" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">要将我们的预测数据存储在一个变量中，这将是一行简单的代码和scikit-learn包的帮助，看起来像这样:</p><pre class="lv lw lx ly fd lz ma mb mc aw md bi"><span id="7dc0" class="me jb hw ma b fi mf mg l mh mi">predictions = lm.predict(X_test)</span></pre><p id="2018" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">现在我们已经得到了一个变量的预测，我们可以通过观察线性模型和它的分布来定性地分析我们的模型。</p><p id="ce10" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">为此，我们将使用matplotlib创建测试值与预测值的散点图，方法是:</p><pre class="lv lw lx ly fd lz ma mb mc aw md bi"><span id="0170" class="me jb hw ma b fi mf mg l mh mi">plt.scatter(y_test,predictions)</span></pre><p id="04d0" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">您的散点图结果应该看起来有点像这样</p><figure class="lv lw lx ly fd hj er es paragraph-image"><div class="er es mn"><img src="../Images/e31117ffd17159af648def0583677b34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*i8AusSCL-xz5X1I4c8ftMg.png"/></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">作者图片</figcaption></figure><p id="af39" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">你想要一条紧密的直线，这意味着你的预测和测试模型非常接近。</p><p id="3e3e" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">我们定性分析模型的另一种方法是通过观察它的分布。为此，我们将使用seaborn包并通过编码使用distplot:</p><pre class="lv lw lx ly fd lz ma mb mc aw md bi"><span id="9158" class="me jb hw ma b fi mf mg l mh mi">sns.distplot((y_test-predictions),bins=50);</span></pre><p id="7cb8" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">运行此命令后，它应该会生成类似如下的图:</p><figure class="lv lw lx ly fd hj er es paragraph-image"><div class="er es mo"><img src="../Images/a7ebda34f25fffc77890e55eccc32228.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*z8nluO-ul9m2VO_xMXbmXA.png"/></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">作者图片</figcaption></figure><p id="e16d" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">我们希望这个图的残差是均匀分布的钟形曲线，就像我们在第二部分中讨论的那样，以确保我们很好地拟合了我们的模型。</p><p id="d844" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">既然我们已经定性地分析了我们的模型，我们可以更进一步，通过使用回归评估度量进行定量分析。</p><h1 id="c6d7" class="ja jb hw bd jc jd ln jf jg jh lo jj jk jl lp jn jo jp lq jr js jt lr jv jw jx bi translated">回归评估指标</h1><p id="64e7" class="pw-post-body-paragraph kv kw hw ka b kb kc ky kz kd ke lb lc kf ls le lf kh lt lh li kj lu lk ll kl ha bi translated">在分析我们的线性回归模型时，我们不仅希望直观地看到，还希望看到数字。幸运的是scikit-learn可以为我们做这道数学题。这并不意味着知道我们是如何到达那里的不好。</p><figure class="lv lw lx ly fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mp"><img src="../Images/6685c5997c31a2f9eec9abaaa9e0b07d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NYSxcCBRGNpnFYeBS6fj-Q.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">3个最常见的回归评估指标的备忘单(图片由作者提供)</figcaption></figure><p id="a648" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">以下是3个最常见的回归评估指标，比较这些指标的最佳方法是:</p><ul class=""><li id="e365" class="jy jz hw ka b kb kx kd la kf mj kh mk kj ml kl mm kn ko kp bi translated">MAE是基本的，因为它只是平均误差</li><li id="31f4" class="jy jz hw ka b kb kq kd kr kf ks kh kt kj ku kl mm kn ko kp bi translated">MSE往往比MAE更好，因为它惩罚更常见的较大错误</li><li id="04f5" class="jy jz hw ka b kb kq kd kr kf ks kh kt kj ku kl mm kn ko kp bi translated">RMSE是三者中最受欢迎的，因为它以“y”为单位，可读性更强</li></ul><p id="cca7" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">值得注意的是，这些都是<strong class="ka hx">损失</strong>函数，因此我们正试图在模型中尽可能减少这些损失。当您运行代码来展示这些时，这些将变得更加清楚。</p><p id="2811" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">这段代码看起来会像这样:</p><pre class="lv lw lx ly fd lz ma mb mc aw md bi"><span id="c4a7" class="me jb hw ma b fi mf mg l mh mi">from sklearn import metrics</span><span id="7051" class="me jb hw ma b fi mq mg l mh mi">print('MAE:', metrics.mean_absolute_error(y_test, predictions))<br/>print('MSE:', metrics.mean_squared_error(y_test, predictions))<br/>print('RMSE:', np.sqrt(metrics.mean_squared_error(y_test, predictions)))</span></pre><p id="cdaf" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">这将为您提供所有三个回归评估指标，并列出它们的错误。请记住，我们希望模型中的<strong class="ka hx">错误少于</strong>，因此三个模型中数量最少的将是最佳模型。</p><p id="6919" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated">现在我们终于学会了如何定性和定量地分析我们的线性回归模型。这是最后一步，我们已经完成了机器学习的系列介绍！</p><h1 id="4a01" class="ja jb hw bd jc jd ln jf jg jh lo jj jk jl lp jn jo jp lq jr js jt lr jv jw jx bi translated">结束思考</h1><p id="665b" class="pw-post-body-paragraph kv kw hw ka b kb kc ky kz kd ke lb lc kf ls le lf kh lt lh li kj lu lk ll kl ha bi translated">这是我的三部分系列的结论，我希望你们喜欢其中的一部分，或者至少能从中找到一些收获。我绝不是这方面的专家，我写这篇文章是为了尽可能地帮助像我这样的人，他们可能正在开始他们的旅程，并在途中寻找一些帮助。我知道我真的很享受当我找到好的文章来加速我的学习过程，所以我相信这些文章中的一些可能会帮助阅读这篇文章的人。感谢你花时间阅读，如果你没有抓住我过去的文章，我会在下面链接它们，如果有人想看的话。如果你喜欢这篇文章，请留下赞或评论，告诉我我可以做得更好的地方，以及一些你希望我接下来写的东西。再次感谢你，无论你在旅途中的任何地方，都值得期待。</p><p id="4146" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated"><a class="ae lm" rel="noopener" href="/analytics-vidhya/intro-to-machine-learning-in-python-part-i-ae109dcd4eb0">Python中的机器学习简介:第一部分</a></p><p id="de71" class="pw-post-body-paragraph kv kw hw ka b kb kx ky kz kd la lb lc kf ld le lf kh lg lh li kj lj lk ll kl ha bi translated"><a class="ae lm" rel="noopener" href="/analytics-vidhya/intro-to-machine-learning-in-python-part-ii-d91adb74324f">Python中的机器学习简介:第二部分</a></p></div></div>    
</body>
</html>