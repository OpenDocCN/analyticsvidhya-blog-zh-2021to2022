<html>
<head>
<title>Risk Prediction of Diabetes at an Early Stage using Machine Learning Approach</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于机器学习方法的早期糖尿病风险预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/risk-prediction-of-diabetes-at-an-early-stage-using-machine-learning-approach-fe8eb256b6f8?source=collection_archive---------14-----------------------#2021-01-12">https://medium.com/analytics-vidhya/risk-prediction-of-diabetes-at-an-early-stage-using-machine-learning-approach-fe8eb256b6f8?source=collection_archive---------14-----------------------#2021-01-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="23d9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">糖尿病是增长最快的慢性威胁生命的疾病，影响着全球超过4.22亿人。2型糖尿病主要由环境因素和生活方式选择引起。这是一种发展缓慢的疾病，在发展成疾病之前就开始出现代谢指标，通常通过空腹血糖测试进行诊断。这里使用的数据集包含520名患者的糖尿病相关症状的报告。它包括关于人们的数据，例如他们的年龄、性别和可能导致糖尿病的症状。该数据集是由孟加拉国Sylhet的Sylhet糖尿病医院的一份直接问卷创建的，并在一名医生的监督下填写。</p><p id="76d1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这份报告中，考虑了其他代谢指标来诊断糖尿病前期人群。糖尿病医学数据集(早期糖尿病数据集)是从加州大学欧文分校<a class="ae jc" href="https://archive.ics.uci.edu/ml/datasets/Early+stage+diabetes+risk+prediction+dataset." rel="noopener ugc nofollow" target="_blank"> (UCI)机器学习库中收集的。</a></p></div><div class="ab cl jd je go jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="ha hb hc hd he"><p id="6703" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">本项目的研究问题是:</strong>常见和不太常见的糖尿病症状能否用于早期预测？</p></div><div class="ab cl jd je go jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="ha hb hc hd he"><p id="7581" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">数据描述:</strong></p><p id="0629" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据集没有任何缺失值。此数据集的数据形状有16个属性，将用于预测结果，类变量为正(表示个人有糖尿病)，类变量为负(表示个人没有糖尿病)。我们有16个用于预测糖尿病类别的属性。除年龄之外的所有属性都有两个唯一结果的分类数据。患者的年龄在16到90岁之间。数据集中没有缺失值。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/8898aff5be5e95119a4db2bf57acf01f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B7uYnB3MYXfw7ygn6fge4A.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">数据集描述</figcaption></figure><p id="70db" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">df.head(5)</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/5f25bcae822c69d7efaa3dde5124067f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hoesz57ibJepZsbGwdfryw.png"/></div></div></figure><p id="5a70" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">61.5%的患者患有糖尿病，38.5%的患者没有糖尿病。37%的患者为女性，67%的患者为男性。90%的女性和45%的男性分别患有糖尿病。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es ka"><img src="../Images/44e1039a17a6f24ee4465a179c54b016.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*S7kFalNMRjAj_AoUhdXtEg.png"/></div></figure><h1 id="2064" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak">数据操作:</strong></h1><p id="2131" class="pw-post-body-paragraph ie if hh ig b ih kz ij ik il la in io ip lb ir is it lc iv iw ix ld iz ja jb ha bi translated">数据集从非数字标签转换为数字标签，为机器学习和关联功能准备数据。</p><p id="c32a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从sklearn导入预处理</p><p id="200a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">进口熊猫作为pd</p><p id="898a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从sklearn导入预处理</p><p id="f1d3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">进口熊猫作为pd</p><p id="2fe3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">标签=预处理。标签编码器()</p><p id="f315" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">定义分类标签(列):</p><p id="26b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">返回label.fit(col)。转换(列)</p><p id="e5cd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">df= df.apply(分类标签)</p><p id="8bd8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">df.head()</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/72fb2bcd66134d3882cd0bb18f379c6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HXHFP_zF1ivthZOd5-h9aQ.png"/></div></div></figure><p id="3755" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">#关联矩阵热图</p><p id="4ee9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">f，ax = plt.subplots(figsize=(28，10))</p><p id="d078" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">corr = df.corr()</p><p id="8281" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">hm = sns.heatmap(round(corr，2)，annot=True，ax=ax，cmap="coolwarm "，fmt = ' .2f '，</p><p id="fd6a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">线宽=.05)</p><p id="6032" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">f .支线剧情_调整(top=0.93)</p><p id="f712" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">t= f.suptitle(“早期糖尿病预测数据集的相关矩阵热图”，fontsize=14)</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es le"><img src="../Images/ec82d2dc28eb6759836e53bee7804ecf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u28EYfHc0-CzMV0AZI2vNg.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">来自肖恩伯恩</figcaption></figure><p id="773d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">多尿和多饮与糖尿病的相关性最高(相关系数分别为0.67和0.65)。年龄与糖尿病的相关性较低(相关系数为0.11)。年龄被分类(1.15-25，2。26–35，3.36–45，4.46–55，5.56–65，6.65以上)，以进一步研究其与糖尿病的关系。</p><p id="5489" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Category= pd.cut (df['Age']，bin =[15，25，35，45，55，65，90]，labels=['1 '，' 2 '，' 3 '，' 4 '，' 5 '，' 6'])</p><p id="3743" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">df。插入(7，“年龄组”，类别)</p><p id="dd57" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">患者年龄分布中，年龄组4(46-55岁)的人较多。年龄组和糖尿病之间没有统计学上的显著关系，因为糖尿病在所有年龄组中的分布相似。进行卡方检验，得出p值为0.076。p值&gt; 0.05，因此我们无法拒绝年龄组和糖尿病之间没有关系的无效假设。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es lf"><img src="../Images/1402604807534aacc9211bb1148b8e46.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*0HmXSMd5UXvD4OB6UoJZPQ.png"/></div></figure><p id="1ff2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在进行卡方检验以研究多尿症和糖尿病之间的关系后，获得的p值小于0.05。因此，我们拒绝零假设，并得出结论，多尿症和糖尿病之间有显著的关系。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es lf"><img src="../Images/96fabfc49f25718d91d45d649f13b43c.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*T-OxodniTg9YRfoNxAQDaQ.png"/></div></figure></div><div class="ab cl jd je go jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="ha hb hc hd he"><h2 id="d5da" class="lg kc hh bd kd lh li lj kh lk ll lm kl ip ln lo kp it lp lq kt ix lr ls kx lt bi translated">用多层感知器预测糖尿病</h2><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es lu"><img src="../Images/21c06ad0b86b55dc89c122c5950cff86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*__VohxXH6aT7NwOdHDw9CQ.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">来源:使用软计算技术预测每月电力需求(<a class="ae jc" href="https://www.researchgate.net/profile/Isaac_Kofi_Nti" rel="noopener ugc nofollow" target="_blank"> <strong class="bd kd">艾萨克·科菲·恩蒂</strong> </a> <strong class="bd kd">，</strong> <a class="ae jc" href="https://www.researchgate.net/scientific-contributions/Asafo-Adjei-Samuel-2158785917" rel="noopener ugc nofollow" target="_blank">阿萨福-阿杰·塞缪尔</a>)</figcaption></figure><p id="5dfe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">多层感知器是首选的神经网络，因为它在医学领域广泛用于预测复杂的疾病过程。数据被分成训练和测试部分，以训练和评估神经网络的性能。隐藏层大小调整为3层，每层11个节点，并使用默认的最大迭代次数1000。</p><p id="e735" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">MLP = MLP classifier(hidden _ layer _ size =(11，11，11)，max_iter=1000)</p><p id="26d5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">mlp.fit(X_train，y_train.values.ravel())</p><p id="4882" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对数据进行训练后，对测试数据进行预测，最后对算法的性能进行评估。根据混淆矩阵，104名患者中有6名被错误分类，导致95%的准确率和94.5%的F值，这是良好的预测指标。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/13f07f6c60c7b767b5c5218e73df165a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SeSW3bcSXOxXjT3tTdYbTg.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">MLP机器学习模型结果</figcaption></figure></div><div class="ab cl jd je go jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="ha hb hc hd he"><p id="0eb2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">结论:从混淆矩阵来看，104例患者中有6例被错误分类，其准确率为94%，F值为94.5%。这些都是很好的预测指标。使用机器学习方法，常见和不太常见的糖尿病症状都可以用于糖尿病的早期预测。MLP机器学习模型是一个很好的拟合，因为它的准确性。</p><p id="d026" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" href="https://github.com/Fellylove/Buildweek-projects/blob/main/Early_Diabetes_prediction_portifolio_project.ipynb" rel="noopener ugc nofollow" target="_blank">点击获取Github笔记本:</a></p></div></div>    
</body>
</html>