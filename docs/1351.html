<html>
<head>
<title>Tackling Class Imbalance for Object Classification Using YOLOv5 with a 2 Model Approach</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用YOLOv5和2模型方法解决对象分类的类别不平衡</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/tackling-class-imbalance-for-object-classification-using-yolov5-with-a-2-model-approach-4b77f0ffe298?source=collection_archive---------3-----------------------#2021-02-25">https://medium.com/analytics-vidhya/tackling-class-imbalance-for-object-classification-using-yolov5-with-a-2-model-approach-4b77f0ffe298?source=collection_archive---------3-----------------------#2021-02-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="79e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是人工智能的时代，它由专门用于图像分类任务的深度学习来管理，在图像分类任务中，图像可以包含我们感兴趣的大量信息。为了提取和识别这些信息，使用了基于深度学习的技术。这些技术中的一些包括使用RCNN的分割或使用深度学习模型的YOLO系列的快速对象检测等。</p><p id="7bdd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些模型在从图像中寻找粒度级信息并给出期望的结果方面做得非常好。然而，训练这些模型需要:</p><ol class=""><li id="944e" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">许许多多不同的数据。</li><li id="7f47" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">维护我们在图像中要分类的不同数据类别之间的类别平衡。</li><li id="4e91" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">出色的硬件，即用于训练数据的高性能GPU</li><li id="d528" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">最后但同样重要的是，训练深度学习模型可能需要几天时间。</li></ol><p id="532a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，在这些步骤之后，如果您想要向数据中添加另一个类，那么这可能意味着更改模型最后一层的输出以适应新的类，并且只重新训练最后几层，或者在更糟糕的情况下，也用新类的所有数据重新训练模型。对每个你想添加到以前训练过的模型中的新的类做同样的事情，这将是非常忙碌的。</p><p id="a418" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了补救这一点，在本文中，我建议使用YOLOv5的两个对象分类模型。第一个模型将是YOLO，他的责任将只是识别超级类。第二个模型将是一个图像分类器，将采取我们想要的超类，并进一步将其分类为子类。</p><h1 id="1b05" class="jr js hi bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated">程序:</h1><p id="ee86" class="pw-post-body-paragraph if ig hi ih b ii kp ik il im kq io ip iq kr is it iu ks iw ix iy kt ja jb jc hb bi translated">可以遵循以下简单步骤:</p><ol class=""><li id="c87f" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">仅使用您预期要预测的超类的图像来训练YOLO模型。因此，训练数据图像将仅用超类来注释。YOLO会告诉我们超级班级在哪里。例如，如果我们要标识人员和产品，那么超类可以是人员类和对象类，如下所示:</li></ol><figure class="kv kw kx ky fd kz er es paragraph-image"><div class="er es ku"><img src="../Images/f177daa593c1f89e28558ab13b11dff3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*0HgfOPx_yawW280JXO4LFg.png"/></div></figure><p id="2547" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.现在，对象就是我们要分类的东西，不管它是百事可乐还是可口可乐或者其他什么。因此，从YOLO模型的输出中，我们将得到图像中标记为“对象”的所有对象，并将它们发送到图像分类器以获得该对象的名称。</p><p id="bfcc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.为此，选择一个图像分类器(Resnext等。)并用你想要预测的子类的图像来训练它。例如，如果我们想要识别百事可乐，那么我们可以用百事可乐的图像来训练图像分类器，等等..和我们预期看到的一样多的产品。</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div class="er es lc"><img src="../Images/002f61545a2c4c49fbde4cbdc8e21efb.png" data-original-src="https://miro.medium.com/v2/resize:fit:134/format:webp/1*1BjMv9dwIal6mYwILxTO7A.png"/></div></figure><p id="0b21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.最后，YOLO会告诉我们图像中的超类是什么，图像分类器会告诉我们子类实际上是什么。</p><p id="dada" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是工作流的本质:</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="er es ld"><img src="../Images/d895295333aead4983e8a0e64452dd33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t7IwdhXCvuyaM8wGxZu7rw.png"/></div></div></figure><p id="a504" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">优点:</strong></p><ol class=""><li id="2543" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">这种方法让我们可以自由地收集数据，甚至从分类的Google Images中收集数据，因为我们不必在固定的环境中收集所需产品的样本，也不必处理分类不平衡的问题。我们可以简单地从谷歌获取子类的图片，并对其进行扩充。例如，如果在零售环境中，我们的目标是对正在销售的产品进行分类，那么如果我们只使用YOLO，那么我们将不得不拥有一个特定产品的数百次样本，以便模型可以学习它，并对所有产品采用相同的过程。因此，单一模型方法将变得不切实际，因为我们的目标是观察更多的产品。</li><li id="1967" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">如果YOLO模型在超类上做得很好，没有必要持续几天重新训练它。</li><li id="3fc8" class="jd je hi ih b ii jm im jn iq jo iu jp iy jq jc ji jj jk jl bi translated">子类中的任何加法将仅需要图像分类器的训练，这不像重新训练YOLO模型那样广泛。</li></ol><p id="2c06" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">链接到代码:</strong></p><p id="d829" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用了Ultralytics中的默认YOLOv5代码，这是Glenn Jocher先生的一项了不起的工作，并将存储库转换为对ResNext模型的两阶段检测支持。目前，代码适用于两种情况，即相同的超类和子类以及一个超类和子类，但可以编辑以提供更多的超类支持。</p><p id="c690" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里是我的Github代码的链接，你可以用它将一个默认的YOLOv5转换成我上面解释过的2阶段检测器。</p><div class="li lj ez fb lk ll"><a href="https://github.com/necla-ml/yolov5" rel="noopener  ugc nofollow" target="_blank"><div class="lm ab dw"><div class="ln ab lo cl cj lp"><h2 class="bd hj fi z dy lq ea eb lr ed ef hh bi translated">necla-ml/yolov5</h2><div class="ls l"><h3 class="bd b fi z dy lq ea eb lr ed ef dx translated">这个库代表了Ultralytics对未来对象检测方法的开源研究，并结合了…</h3></div><div class="lt l"><p class="bd b fp z dy lq ea eb lr ed ef dx translated">github.com</p></div></div><div class="lu l"><div class="lv l lw lx ly lu lz la ll"/></div></div></a></div><p id="d022" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">结论:</strong></p><p id="8884" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">深度学习模型对于对象检测来说是惊人的，但是，伴随着资源的广泛性，并且需要大量时间的训练。但是使用智能技术可以减少训练时间。如果技术和代码有所帮助，那么请提及我的名字和个人资料。</p><p id="74f9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">特别感谢:</strong></p><p id="b1dd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我要感谢信任我完成这项任务的人们，感谢Glenn Jocher和YOLOv5背后的开发人员。</p></div></div>    
</body>
</html>