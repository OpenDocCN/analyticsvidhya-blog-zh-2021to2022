<html>
<head>
<title>Promises 101: Javascript Promises Explained [with code snippets]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">承诺101: Javascript承诺解释[代码片段]</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/promises-in-javascript-explained-examples-b15882a5714a?source=collection_archive---------2-----------------------#2021-02-18">https://medium.com/analytics-vidhya/promises-in-javascript-explained-examples-b15882a5714a?source=collection_archive---------2-----------------------#2021-02-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/441fbf9e4110a98cef927b0b7b92c1c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1eRhpO0DD0vEWMrh-neO0A.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">照片由<a class="ae hv" href="https://unsplash.com/@jeshoots?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">JESHOOTS.COM</a>在<a class="ae hv" href="https://unsplash.com/s/photos/woman-computer?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><div class=""/><p id="431c" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">…用实际例子解释Javascript承诺</p><h1 id="98f1" class="jt ju hy bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">先决条件</h1><p id="e896" class="pw-post-body-paragraph iv iw hy ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">在开始本教程之前，您需要具备以下条件:</p><ul class=""><li id="8b09" class="kw kx hy ix b iy iz jc jd jg ky jk kz jo la js lb lc ld le bi translated">IDE(本教程使用VS代码)</li><li id="2a8d" class="kw kx hy ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">对Javascript ES6的基本理解</li><li id="e32c" class="kw kx hy ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated">Nodejs已安装，您可以在这里获得最新版本<a class="ae hv" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank">。</a></li></ul><h1 id="aec0" class="jt ju hy bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">介绍</h1><p id="4bae" class="pw-post-body-paragraph iv iw hy ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">使用来自其他资源的数据带来了处理异步操作的需求，即不按顺序运行的操作。在这篇文章中，我用简单的术语解释了Javascript中处理异步操作的一种方式，<strong class="ix hz">承诺</strong>。在这篇文章结束时，你将会理解Javascript在代码和简单英语方面的承诺。</p><h1 id="a944" class="jt ju hy bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">Javascript承诺是什么？</h1><p id="f659" class="pw-post-body-paragraph iv iw hy ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">根据官方文件:</p><blockquote class="lk ll lm"><p id="b915" class="iv iw ln ix b iy iz ja jb jc jd je jf lo jh ji jj lp jl jm jn lq jp jq jr js hb bi translated"><em class="hy">Promise对象表示异步操作的最终完成(或失败)及其结果值。</em></p></blockquote><p id="bb54" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz"> <em class="ln">语法:</em> </strong></p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="7530" class="ma ju hy lw b fi mb mc l md me">new Promise((resolve, reject)=&gt;{})</span></pre><p id="cb39" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">更简单地说，承诺是一个对象，它将根据承诺的状态返回特定的值。承诺可以有三种状态之一</p><ul class=""><li id="a29b" class="kw kx hy ix b iy iz jc jd jg ky jk kz jo la js lb lc ld le bi translated"><code class="du mf mg mh lw b">fulfilled</code></li><li id="4b0c" class="kw kx hy ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated"><code class="du mf mg mh lw b">rejected</code></li><li id="823c" class="kw kx hy ix b iy lf jc lg jg lh jk li jo lj js lb lc ld le bi translated"><code class="du mf mg mh lw b">pending</code></li></ul><p id="bbf9" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">状态1:承诺兑现</strong></p><p id="9dda" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当承诺被解决时，它有一个状态<code class="du mf mg mh lw b">fulfilled</code>，这意味着承诺中没有出错，也没有错误。下面的代码片段将返回一个已履行的状态，因为承诺已被解决:</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="a539" class="ma ju hy lw b fi mb mc l md me">new Promise((resolve, reject)=&gt;{<br/>    resolve(console.log("Hello"))<br/>})</span><span id="3c25" class="ma ju hy lw b fi mi mc l md me">RESULT:<br/>"Hello"<br/>[[PromiseState]]: "fulfilled"<br/>[[PromiseResult]]: undefined</span></pre><p id="fb85" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">状态2:承诺被拒绝</strong></p><p id="67e2" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当错误发生时，承诺有一个<code class="du mf mg mh lw b">rejected</code>状态。在这种情况下，承诺被拒绝。下面的代码片段将返回拒绝状态，因为承诺被拒绝:</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="a236" class="ma ju hy lw b fi mb mc l md me">new Promise((resolve, reject)=&gt;{<br/>    reject(console.log("Oh no, an error"))<br/>})</span><span id="7b80" class="ma ju hy lw b fi mi mc l md me">RESULT:<br/>"Oh no, an error"<br/>[[PromiseState]]: "rejected"<br/>[[PromiseResult]]: undefined</span></pre><p id="dc1d" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">状态3:承诺待定</strong></p><p id="f43b" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当承诺本身既没有被解决也没有被拒绝时，承诺具有状态<code class="du mf mg mh lw b">pending</code>。下面的代码片段将返回状态<code class="du mf mg mh lw b">pending</code>,因为承诺既没有被解决也没有被拒绝:</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="1dc0" class="ma ju hy lw b fi mb mc l md me">new Promise((resolve, reject)=&gt;{})</span><span id="108a" class="ma ju hy lw b fi mi mc l md me">RESULT:<br/>[[PromiseState]]: "pending"<br/>[[PromiseResult]]: undefined</span></pre></div><div class="ab cl mj mk gp ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="hb hc hd he hf"><p id="d09b" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">🛑 <strong class="ix hz">休息时间:</strong></p><p id="6bad" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz"> <em class="ln"> PS: </em> </strong>如果你想在今年开始你的科技职业生涯，你可以下载<a class="ae hv" href="https://t.co/QhrUnNLVY0?amp=1" rel="noopener ugc nofollow" target="_blank">这份科技领域14种职业的清单</a>以及每种职业你应该首先学习的编程语言。</p><p id="8055" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi">🛑</p></div><div class="ab cl mj mk gp ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="hb hc hd he hf"><h1 id="6dc6" class="jt ju hy bd jv jw mq jy jz ka mr kc kd ke ms kg kh ki mt kk kl km mu ko kp kq bi translated">履行承诺</h1><p id="7536" class="pw-post-body-paragraph iv iw hy ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">在处理承诺时，您可能会遇到如下的一些方法和函数</p><ul class=""><li id="997e" class="kw kx hy ix b iy iz jc jd jg ky jk kz jo la js lb lc ld le bi translated"><code class="du mf mg mh lw b">then</code>方法:该方法从解析的承诺中获取返回值，并对它们执行一些操作。<code class="du mf mg mh lw b">then</code>方法通常与承诺联系在一起。请参见下面的示例:</li></ul><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="c196" class="ma ju hy lw b fi mb mc l md me">function getDataFromDatabase(){<br/>    return new Promise((resolve, reject)=&gt;{<br/>        // promise resolves with no errors<br/>    })<br/>}</span><span id="0b84" class="ma ju hy lw b fi mi mc l md me">getDataFromDatabase().then((data)=&gt;{<br/>    // data is the returned value from the getFromDatabase function<br/>    console.log(data)<br/>})</span></pre><p id="ce60" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当使用<code class="du mf mg mh lw b">then</code>关键词时，用简单的英语像这样想会很有帮助:</p><p id="1d93" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du mf mg mh lw b">First of all, get data from the database with the getDataFromDatabase() function, and then console.log all the data gotten from the database</code></p><ul class=""><li id="983a" class="kw kx hy ix b iy iz jc jd jg ky jk kz jo la js lb lc ld le bi translated"><code class="du mf mg mh lw b">trycatch</code>处理程序:trycatch处理程序非常常用于处理承诺。因为您的承诺可能有一个<code class="du mf mg mh lw b">rejected</code>状态，所以添加一个捕获该错误的方法会很有帮助，这正是trycatch处理程序的工作方式。请参见下面的示例:</li></ul><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="f726" class="ma ju hy lw b fi mb mc l md me">function getDataFromDatabase(){<br/>    return new Promise((resolve, reject)=&gt;{<br/>       try {<br/>           // if Promise resolves, return data from the resolve method<br/>           resolve()<br/>       } catch (error) {<br/>           // if the promise rejects, return error data from the reject method<br/>           reject(console.log(error.message))<br/>       }<br/>    })<br/>}</span><span id="87df" class="ma ju hy lw b fi mi mc l md me">getDataFromDatabase().then((data)=&gt;{<br/>    // data is the returned value from the getFromDatabase function<br/>    console.log(data)<br/>})</span></pre><p id="e0d8" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当使用<code class="du mf mg mh lw b">trycatch</code>处理程序时，用简单的英语像这样想象会很有帮助</p><p id="512b" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du mf mg mh lw b">In getting data from the database with the getDataFromDatabase() function, try this code inside this block first, if I successfully get the data, return data from the resolve() function. If I run into some error, return data from the reject function. Then run the function inside the THEN method</code></p><h1 id="0057" class="jt ju hy bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">代码示例</h1><p id="ab74" class="pw-post-body-paragraph iv iw hy ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">在本例中，我们将尝试并模拟对外部端点进行API调用。这个想法是模拟在进行API调用时获取数据的延迟。以下是我们需要考虑的步骤:</p><ol class=""><li id="b491" class="kw kx hy ix b iy iz jc jd jg ky jk kz jo la js mv lc ld le bi translated">创建数据存储</li><li id="51bc" class="kw kx hy ix b iy lf jc lg jg lh jk li jo lj js mv lc ld le bi translated">创建一个函数来获取数据(想象一下Javascript中的fetch函数)</li><li id="eeb4" class="kw kx hy ix b iy lf jc lg jg lh jk li jo lj js mv lc ld le bi translated">当我们最终获得新数据时，向数据存储中添加新数据</li><li id="f287" class="kw kx hy ix b iy lf jc lg jg lh jk li jo lj js mv lc ld le bi translated">将结果记录到控制台</li></ol><h1 id="f2d4" class="jt ju hy bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">步骤1:创建数据存储</h1><p id="6a07" class="pw-post-body-paragraph iv iw hy ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">在这个例子中，我们将使用一个简单的数组来存储项目，我们在这里模拟数据库。</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="43ff" class="ma ju hy lw b fi mb mc l md me">let names = ['Kim Seon Ho', 'Park Seo Joon', 'Park Shin Hye', 'Shin Hye Sun']</span></pre><h1 id="a872" class="jt ju hy bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">步骤2:创建一个函数来获取数据</h1><p id="13f7" class="pw-post-body-paragraph iv iw hy ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">这里，我们将模拟使用setTimeout()函数从数据库中获取数据时的延迟。这就是我们将使用Promise的地方，因为我们希望它在我们的理论项目中作为异步函数运行。</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="5844" class="ma ju hy lw b fi mb mc l md me">function getData(dataItems) {<br/>    return new Promise((resolve, reject) =&gt; {<br/>        try {<br/>            setTimeout(() =&gt; {<br/>                resolve(dataItems)<br/>            }, 3000);<br/>        }<br/>        catch (error) {<br/>            reject(console.log(error))<br/>        }<br/>    })<br/>}</span></pre><p id="e4d2" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">发生了什么:</strong>在这段代码中，我们确保<code class="du mf mg mh lw b">getData()</code>函数返回一个Promise，这样我们就可以使用Promise提供的链接方法来更改/编辑从数据存储中返回的数据。</p><h1 id="4cdb" class="jt ju hy bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">第3步:当我们得到数据时转换它</h1><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="a665" class="ma ju hy lw b fi mb mc l md me">getData(names).then(data=&gt;{<br/>    let newName = 'Han Yoo Joo'<br/>    data.push(newName)<br/>    return data<br/>}).then(finalData=&gt;{<br/>    console.log(finalData)<br/>})</span></pre><p id="0103" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hz">发生了什么:</strong>这里，我们使用<code class="du mf mg mh lw b">getData()</code>函数获取数据。<code class="du mf mg mh lw b">getData()</code>函数返回我们存储在<code class="du mf mg mh lw b">then</code>方法的<code class="du mf mg mh lw b">data</code>参数中的信息。记住，<code class="du mf mg mh lw b">then</code>方法从Promise中解析的方法获取返回的数据，并能够在其上执行任务。正是这个<code class="du mf mg mh lw b">data</code>，我们随后使用<code class="du mf mg mh lw b">Array.push()</code>方法推送一个新名称。</p><h1 id="4727" class="jt ju hy bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">步骤4:将结果记录到控制台</h1><p id="5ae7" class="pw-post-body-paragraph iv iw hy ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">最后一个<code class="du mf mg mh lw b">then</code>方法是不必要的，因为我们可以将<code class="du mf mg mh lw b">console.log()</code>方法添加到第一个<code class="du mf mg mh lw b">then</code>方法中，但是，我添加它是为了向您展示在Javascript中处理承诺时可以使用多少链接。在最后一个<code class="du mf mg mh lw b">then</code>方法中，我们获取从第一个<code class="du mf mg mh lw b">then</code>方法返回的数据，并将其记录到控制台。</p><h1 id="e789" class="jt ju hy bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结果</h1><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="4f23" class="ma ju hy lw b fi mb mc l md me">[<br/>  'Kim Seon Ho',<br/>  'Park Seo Joon',<br/>  'Park Shin Hye',<br/>  'Shin Hye Sun',<br/>  'Han Yoo Joo'<br/>]</span></pre><h1 id="f14f" class="jt ju hy bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结论</h1><p id="1caf" class="pw-post-body-paragraph iv iw hy ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js hb bi translated">Javascript承诺是在代码中执行异步功能的好方法。比起面对每个Javascript程序员的噩梦，回调地狱，这是一个更好的选择。您可以在这个Github资源库中找到完整的代码示例:<a class="ae hv" href="https://github.com/Vanneka/asynchronous-javascript-examples" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hz">代码示例</strong> </a></p><p id="3f78" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">感谢阅读，再见。</p><p id="5483" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">💜💜再见！瓦妮莎·奥</p></div><div class="ab cl mj mk gp ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="hb hc hd he hf"><p id="93e9" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">💜如果你觉得这篇文章有用，记得分享并帮助我发展我的社区。💜</p><p id="6d3c" class="pw-post-body-paragraph iv iw hy ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你想在今年开始你的科技职业生涯，你可以下载科技行业的14个职业清单，看看你应该首先学习的编程语言。</p></div></div>    
</body>
</html>