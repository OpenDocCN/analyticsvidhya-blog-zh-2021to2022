<html>
<head>
<title>1- Introduction to Time Series</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">1-时间序列简介</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/1-introduction-to-time-series-5ae663c468f4?source=collection_archive---------3-----------------------#2021-04-29">https://medium.com/analytics-vidhya/1-introduction-to-time-series-5ae663c468f4?source=collection_archive---------3-----------------------#2021-04-29</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/c0fe61b75d57e160f72e577adc52db2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QzUtlhkZwkcFf-ZO"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated"><a class="ae it" href="https://unsplash.com/@m_b_m?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> M. B. M. </a>在<a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="56f2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果我用最简单的方式解释时间序列；时间序列用于基于当前序列的预测，也用于假设检验。</p><p id="41db" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> <em class="js">更新</em> </strong> <em class="js">:本文是我探索时间序列的系列文章的一部分。查看完整系列:</em> <a class="ae it" rel="noopener" href="/analytics-vidhya/1-introduction-to-time-series-5ae663c468f4"> <em class="js">第1部分</em> </a> <em class="js">，</em> <a class="ae it" href="https://ertuncogulcan.medium.com/2-econometric-statistical-models-in-time-series-7b69ae3ab1d8" rel="noopener"> <em class="js">第2部分</em> </a>，<a class="ae it" href="https://ertuncogulcan.medium.com/3-time-series-forecasting-using-lstm-e14b93f4ec7c" rel="noopener">第3部分</a>。</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="1f81" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">别跟我解释，出示代码</h1><p id="3a0b" class="pw-post-body-paragraph iu iv hh iw b ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn lc jp jq jr ha bi translated">你可以在这里访问GitHub repo。</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h2 id="a3b8" class="ld kb hh bd kc le lf lg kg lh li lj kk jf lk ll ko jj lm ln ks jn lo lp kw lq bi translated"><strong class="ak">时间序列中的基本概念:</strong></h2><figure class="ls lt lu lv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lr"><img src="../Images/00053124bea40d2d20b106d51c0a3e7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*M11wy5avTWMjjsC0"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">斯蒂芬·道森在<a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><blockquote class="lw lx ly"><p id="54ea" class="iu iv js iw b ix iy iz ja jb jc jd je lz jg jh ji ma jk jl jm mb jo jp jq jr ha bi translated"><strong class="iw hi">平稳</strong>:序列的统计属性不随时间变化。如果时间序列的均值、方差和协方差在一段时间内保持不变，则称该序列为平稳序列。</p><p id="8fe1" class="iu iv js iw b ix iy iz ja jb jc jd je lz jg jh ji ma jk jl jm mb jo jp jq jr ha bi translated"><strong class="iw hi">趋势(一般趋势)</strong>:是时间序列经过较长时间的下降和上升周期后出现的稳定状态。从长期来看，时间序列往往会稳步上升或下降。</p><p id="e0f1" class="iu iv js iw b ix iy iz ja jb jc jd je lz jg jh ji ma jk jl jm mb jo jp jq jr ha bi translated"><strong class="iw hi">季节性</strong>:指时间序列随季节的变化。时间序列中使用的数据的某些时段不同于其他时段。</p><p id="12f0" class="iu iv js iw b ix iy iz ja jb jc jd je lz jg jh ji ma jk jl jm mb jo jp jq jr ha bi translated"><strong class="iw hi">周期</strong>:与季节变化无关的经济周期性变化。例如，经济的短期扩张或收缩，独立于总体趋势，描述了周期过程。</p><p id="1eb2" class="iu iv js iw b ix iy iz ja jb jc jd je lz jg jh ji ma jk jl jm mb jo jp jq jr ha bi translated"><strong class="iw hi">不规则成分</strong>:与其他元素一样不确定的变化，可以用误差一词来表示。</p></blockquote><p id="8400" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">了解时间序列模型的本质需要知道的事情:</p><ol class=""><li id="581b" class="mc md hh iw b ix iy jb jc jf me jj mf jn mg jr mh mi mj mk bi translated"><em class="js">移动平均</em>:时间序列的未来值是其k个以前值的平均值。</li><li id="c38c" class="mc md hh iw b ix ml jb mm jf mn jj mo jn mp jr mh mi mj mk bi translated"><em class="js">加权平均</em>:类似于移动平均，其主要思想是给予最近的观察更多的权重。</li><li id="b53d" class="mc md hh iw b ix ml jb mm jf mn jj mo jn mp jr mh mi mj mk bi translated"><em class="js">平滑方法:</em></li></ol><blockquote class="lw lx ly"><p id="ed2c" class="iu iv js iw b ix iy iz ja jb jc jd je lz jg jh ji ma jk jl jm mb jo jp jq jr ha bi translated"><strong class="iw hi">单指数平滑(SES) : </strong>仅用于平稳序列，无趋势性或季节性。它通过指数修正进行预测，用未来与最近的过去更相关的假设来衡量过去的影响。通过指数加权过去的真实值和过去的预测值来进行估计。它适用于没有趋势性或季节性的单变量时间序列。</p></blockquote><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es mq"><img src="../Images/0e9d94214a240d22b4595f34e09e2d0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/0*051V9K0SaBJnkR_q"/></div></figure><blockquote class="lw lx ly"><p id="1c2f" class="iu iv js iw b ix iy iz ja jb jc jd je lz jg jh ji ma jk jl jm mb jo jp jq jr ha bi translated"><strong class="iw hi">双指数平滑:</strong>与水平和趋势数列使用，应该没有季节性。考虑到趋势效应，进行指数修正。<br/> DES =水平(SES) +趋势<br/>基本方法与SES相同，但趋势也被考虑在内<br/>它适用于趋势和季节性单变量时间序列。</p></blockquote><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es mr"><img src="../Images/c532c96eef0c9ed5f7b4564e65943eb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/0*6SK4_sPc0jL1iuqK"/></div></figure><blockquote class="lw lx ly"><p id="cbca" class="iu iv js iw b ix iy iz ja jb jc jd je lz jg jh ji ma jk jl jm mb jo jp jq jr ha bi translated"><strong class="iw hi">三重指数平滑:</strong>又名<strong class="iw hi">霍尔特-温特斯</strong>方法与水平、趋势和季节性串联使用。<br/>水平(SES) +趋势+季节性<br/>三重指数平滑是最先进的平滑方法<br/>该方法动态估计水平、趋势和季节性的影响，可用于包含趋势和/或季节性的单变量序列。</p></blockquote><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es ms"><img src="../Images/27d5cc1aeee2d91a2dd7c54ee7e05ff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/0*yF7N6PShu4-IRvI3"/></div></figure><p id="493e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在时间序列被分解成所有这些组成成分后，时间序列y可以通过<em class="js">乘</em>方法在一定时间内表示为这些成分的<em class="js">相加</em>。</p><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es mt"><img src="../Images/eea16cd8834b1f3eb8118f0e51ec98db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*GMlqIXlEKXqlQoYrL-RKYA.png"/></div></figure></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h2 id="59a7" class="ld kb hh bd kc le lf lg kg lh li lj kk jf lk ll ko jj lm ln ks jn lo lp kw lq bi translated">0.有了这些信息，让我们考虑一个简单的数据集:</h2><p id="446b" class="pw-post-body-paragraph iu iv hh iw b ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn lc jp jq jr ha bi translated">在这个项目中，我使用了全球陆地和海洋陆地温度(GlobalTemperatures.csv)数据集。</p><p id="e151" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们的主要数据集给出了各州的月平均气温。</p><figure class="ls lt lu lv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mu"><img src="../Images/780517db9fe454a5f55b974fe91d0873.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2HBnl8bVhI2tI8apdL5n9Q.png"/></div></div></figure><p id="d87d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为了获得关于数据集的更详细的信息，我使用groupby操作查看了各个国家的一般平均值。</p><pre class="ls lt lu lv fd mv mw mx my aw mz bi"><span id="e128" class="ld kb hh mw b fi na nb l nc nd">y.rename(columns={"dt": "Date", "AverageTemperature": "Avg_Temp", "AverageTemperatureUncertainty": "confidence_interval_temp"}, inplace=True)</span><span id="6e75" class="ld kb hh mw b fi ne nb l nc nd">y[['Country', "Avg_Temp"]].groupby(["Country"]).mean().sort_values("Avg_Temp")</span></pre><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es nf"><img src="../Images/c91c799110b1f45e5add6ca8ef84a541.png" data-original-src="https://miro.medium.com/v2/resize:fit:584/format:webp/1*IlEBc37CeGIEAtSgBjN8gg.png"/></div></figure><p id="b7b6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">后来我在数据集中获得了佛罗里达的数据。所以我就专注一个小点的重点，按顺序做操作。我想先看看佛罗里达的图表。</p><pre class="ls lt lu lv fd mv mw mx my aw mz bi"><span id="6d78" class="ld kb hh mw b fi na nb l nc nd">florida.head()<br/>florida.tail(5)<br/>florida["Date"] = pd.to_datetime(florida["Date"])<br/>florida.set_index('Date', inplace = True)<br/><br/>plt.figure(figsize = (6,4))<br/>sns.lineplot(x = 'Year', y = 'Avg_Temp', data = florida)<br/>plt.show()</span></pre><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es ng"><img src="../Images/33649d6f98a3d102f30be56a5d408ccc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*tLWFhg5gueP0tPpmhxmCVw.png"/></div></figure><p id="e1bc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">后来，我确定了直到1994年底的部分为教育数据。我会把后面的几个月作为测试数据。在这种情况下，我们的测试数据有225个月。</p><pre class="ls lt lu lv fd mv mw mx my aw mz bi"><span id="a449" class="ld kb hh mw b fi na nb l nc nd">train = florida[:"1994-12-01"]<br/>len(train)<br/>test = florida["1995-01-01":]<br/>len(test)</span></pre><h2 id="33e0" class="ld kb hh bd kc le lf lg kg lh li lj kk jf lk ll ko jj lm ln ks jn lo lp kw lq bi translated">1.单指数平滑预测</h2><p id="ad80" class="pw-post-body-paragraph iu iv hh iw b ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn lc jp jq jr ha bi translated">可以固定系列使用。首先，我应用了迪基-富勒检验，因为我们知道，如果有趋势和季节性，它是不可用的。</p><pre class="ls lt lu lv fd mv mw mx my aw mz bi"><span id="7aac" class="ld kb hh mw b fi na nb l nc nd">def is_stationary(y):<br/>    print('H0: Series Is Not Stationary')<br/>    print("H1: Series Is Stationary")<br/>    p_value = sm.tsa.stattools.adfuller(y)[1]<br/>    if p_value &lt; 0.05:<br/>        print("Result is stationary",p_value)<br/>    else:<br/>        print("Series is not stationary", p_value)<br/>is_stationary(florida)</span></pre><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es nh"><img src="../Images/41150c65c51de8c946ba875eedd90b99.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*X_z5LGZo54mXJWlG-tOmRA.png"/></div></figure><pre class="ls lt lu lv fd mv mw mx my aw mz bi"><span id="2498" class="ld kb hh mw b fi na nb l nc nd">ses_model = SimpleExpSmoothing(train).fit(smoothing_level = 0.5)<br/>y_pred = ses_model.forecast(225)<br/>train.plot(title="Single Exponential Smoothing")<br/>test.plot()<br/>y_pred.plot()<br/>plt.show()<br/>mean_absolute_error(test, y_pred)</span></pre><figure class="ls lt lu lv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ni"><img src="../Images/579fb7bac533e2aea5b0709ce16dec5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K8ZOjtqGColE71ZtfUjA6Q.png"/></div></div></figure><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es nj"><img src="../Images/64013cf17e988df47411457ed17ebe7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*VjYIfi1YVOngGiOsn5Cm8Q.png"/></div></figure><p id="e5f9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">图中显示的绿线是我们模型的估计值，而橙线是实际值。在这个阶段，我们无法预测趋势或季节性。</p><p id="832a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这些函数使用最大对数似然法寻找参数。</p><p id="dc2b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> <em class="js"> 1.1优化我们的SES模型</em> </strong></p><p id="c197" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在让我们创建网格，并使其阿尔法少，用boothforce方法优化它。</p><pre class="ls lt lu lv fd mv mw mx my aw mz bi"><span id="fb71" class="ld kb hh mw b fi na nb l nc nd">def optimize_ses(train,alphas, step=225):<br/>    for alpha in alphas:<br/>        ses_model = SimpleExpSmoothing(train).fit(smoothing_level=alpha)<br/>        y_pred = ses_model.forecast(step)<br/>        mae = mean_absolute_error(test, y_pred)<br/>        print("alpha", round(alpha,2), "mae:", round(mae,4))<br/>alphas = np.arange(0.01, 1,0.01)<br/>optimize_ses(train, alphas)</span></pre><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es nk"><img src="../Images/52a42d01701acde8eaf040d2fb4efe60.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*9--xtuWJYNXccBQCbqnBmg.png"/></div></figure><pre class="ls lt lu lv fd mv mw mx my aw mz bi"><span id="48ee" class="ld kb hh mw b fi na nb l nc nd">### Final Ses Model ###<br/>ses_model = SimpleExpSmoothing(train).fit(smoothing_level=0.14)<br/>y_pred = ses_model.forecast(225)<br/>train["1985":].plot(title='Single Exponential Smoothing')<br/>test.plot()<br/>y_pred.plot()<br/>plt.show()<br/>mean_absolute_error(test, y_pred)</span></pre><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es nj"><img src="../Images/f4401b5e9c5ba35f6bebd0ff61151c14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*GtHuiZm1UOrFIYr2GbrRHQ.png"/></div></figure><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es nl"><img src="../Images/b5884224dd2015ec5a84fee3e5ec30e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*u8QVVEdzkqGBjKng-AvDnQ.png"/></div></figure><p id="5d77" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们不能接受这种模式，因为我们不能抓住趋势和季节性。尽管我们降低了MAE值，但我们的模型并不像我们希望的那样成功。所以我们进入下一阶段。</p><h2 id="67f7" class="ld kb hh bd kc le lf lg kg lh li lj kk jf lk ll ko jj lm ln ks jn lo lp kw lq bi translated">2.双指数平滑预测</h2><pre class="ls lt lu lv fd mv mw mx my aw mz bi"><span id="94ee" class="ld kb hh mw b fi na nb l nc nd"># DES = Level + Trend<br/>des_model = ExponentialSmoothing(train, trend="add").fit(smoothing_level=0.5,<br/>                                                         smoothing_slope=0.5)<br/>y_pred = des_model.forecast(225)<br/>train["1985":].plot(title="Double Exponential Smoothing")<br/>test.plot()<br/>y_pred.plot()<br/>plt.show()</span></pre><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es nj"><img src="../Images/b170c353c0fdc95df414d7c4e6e85014.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*LiY31DdrBINS6SwKRyDJRA.png"/></div></figure><figure class="ls lt lu lv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nm"><img src="../Images/96b5491470f501fb414fba065005aa44.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*l1z4emRgA1apJIqHMiy2mg.png"/></div></div></figure><p id="9439" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们抓住了趋势，但我们无法预测趋势会持续多久，而且趋势一直在持续。这就是为什么我们的MAE值变得相当高。从图中可以看出，绿线在所有225个步骤中持续下降。</p><p id="9cce" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> <em class="js"> 2.1优化我们的DES模型</em> </strong></p><pre class="ls lt lu lv fd mv mw mx my aw mz bi"><span id="c3b6" class="ld kb hh mw b fi na nb l nc nd">alphas = np.arange(0.01, 1, 0.05)<br/>betas = np.arange(0.01, 1, 0.05)<br/><br/>optimize_des(train, alphas, betas)<br/><br/>def optimize_des(train, alphas, betas, step=225):<br/>    print("Optimizing parameters...")<br/>    results = []<br/>    for alpha in alphas:<br/>        for beta in betas:<br/>            des_model = ExponentialSmoothing(train, trend="add").fit(smoothing_level=alpha,<br/>                                                                     smoothing_slope=beta)<br/>            y_pred = des_model.forecast(step)<br/>            mae = mean_absolute_error(test, y_pred)<br/>            results.append([round(alpha, 2), round(beta, 2), round(mae, 6)])<br/>    results = pd.DataFrame(results, columns=["alpha", "beta", "mae"]).sort_values("mae")<br/>    print(results)<br/><br/>optimize_des(train, alphas, betas)</span></pre><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es ms"><img src="../Images/615293f81efb2831e6a4f2fc2f10a4b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*XPbQsj5cki2H_43GJK5m9A.png"/></div></figure><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es nn"><img src="../Images/6d2bcc6e136790a49a487eb7eda004fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*v2d2vAt_dlEgLaymKlGO1g.png"/></div></figure><p id="dab9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们添加了<em class="js"> alpha </em>(平滑级别)和<em class="js"> beta </em>(平滑斜率)值，它们在优化中给出了最低的MAE值，作为我们模型的参数。</p><pre class="ls lt lu lv fd mv mw mx my aw mz bi"><span id="c3b2" class="ld kb hh mw b fi na nb l nc nd">final_des_model = ExponentialSmoothing(train, trend="add").fit(smoothing_level=0.06,<br/>                                                               smoothing_slope=0.01)<br/>y_pred = final_des_model.forecast(225)<br/>train["1985":].plot(title="Double Exponential Smoothing")<br/>test.plot()<br/>y_pred.plot()<br/>plt.show()</span></pre><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es nj"><img src="../Images/6c5ec14b34977bab23abd23fa661f348.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*_Rs50r9_c5_LVxOtttVxHA.png"/></div></figure><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es no"><img src="../Images/818b0b5c179d38355ddd2f79b96072f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*hmtMeG1XfYdOISfOgDe4uA.png"/></div></figure><p id="78eb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">即使我们降低了我们的MAE值很多，我们的模型仍然不像我们希望的那样成功。所以我们继续下一步，霍尔特-温特斯法。</p><h2 id="9184" class="ld kb hh bd kc le lf lg kg lh li lj kk jf lk ll ko jj lm ln ks jn lo lp kw lq bi translated">3.用三重指数平滑法进行预测(霍尔特温特斯)</h2><p id="d516" class="pw-post-body-paragraph iu iv hh iw b ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn lc jp jq jr ha bi translated">首先，我们通过将所有值指定为0.5作为基础模型来设置我们的模型。</p><pre class="ls lt lu lv fd mv mw mx my aw mz bi"><span id="aadc" class="ld kb hh mw b fi na nb l nc nd">tes_model = ExponentialSmoothing(train,<br/>                                 trend='add',<br/>                                 seasonal="add",<br/>                                 seasonal_periods=12).fit(smoothing_level=0.5,<br/>                                                          smoothing_slope=0.5,<br/>                                                          smoothing_seasonal=0.5)<br/>y_pred = tes_model.forecast(225)<br/>train["1985":].plot(title = "Triple Exponential Smoothing")<br/>test.plot()<br/>y_pred.plot()<br/>plt.show()</span></pre><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es nj"><img src="../Images/656deefd72bef4e9d82787371bee4208.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*0teLpajcZkzsTLtNBOd75Q.png"/></div></figure><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es np"><img src="../Images/f17d30c80b9a5f281deb4559efe185a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*uiz6XYnYpfO18SYtNXzZUQ.png"/></div></figure><p id="1639" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">可以看出，我们的模型非常不成功，我们的MAE值比以往任何时候都高。现在我们将优化这个模型以获得更好的结果。</p><p id="413a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> <em class="js"> 3.1优化出霍尔特-温特斯模型</em> </strong></p><pre class="ls lt lu lv fd mv mw mx my aw mz bi"><span id="1778" class="ld kb hh mw b fi na nb l nc nd">import itertools<br/>alphas = betas = gammas = np.arange(0.01, 1, 0.05)<br/>abg = list(itertools.product(alphas, betas, gammas))<br/>abg[0][2]<br/><br/>def optimize_tes(train, abg, step=225):<br/>    print("Optimizing parameters...")<br/>    results = []<br/>    for comb in abg:<br/>        tes_model = ExponentialSmoothing(train, trend="add",<br/>                                         seasonal="add",<br/>                                         seasonal_periods=12).\<br/>            fit(smoothing_level=comb[0],<br/>                smoothing_slope=comb[1],<br/>                smoothing_seasonal=comb[2])<br/><br/>        y_pred = tes_model.forecast(step)<br/>        mae = mean_absolute_error(test, y_pred)<br/><br/>        print([round(comb[0], 2), round(comb[1], 2), round(comb[2], 2), round(mae, 2)])<br/><br/>        results.append([round(comb[0], 2), round(comb[1], 2), round(comb[2], 2), round(mae, 2)])<br/>    results = pd.DataFrame(results, columns=["alpha", "beta", "gamma", "mae"]).sort_values("mae")<br/>    print(results)<br/><br/>alphas = betas = gammas = np.arange(0.01, 1, 0.05)<br/>abg = list(itertools.product(alphas, betas, gammas))<br/><br/>optimize_tes(train, abg)</span></pre><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es nq"><img src="../Images/e48e06052609f403bee7977109f171f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*xnNj-S_tNX1DZ0ZYq1UCFA.png"/></div></figure><p id="1068" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">作为优化的结果，我们在模型中输入最佳的alpha、beta和gamma值作为参数。</p><pre class="ls lt lu lv fd mv mw mx my aw mz bi"><span id="880a" class="ld kb hh mw b fi na nb l nc nd"># Final TES Model<br/>#################################<br/>final_tes_model = ExponentialSmoothing(train, trend="add", seasonal="add", seasonal_periods=12).\<br/>            fit(smoothing_level=0.06, smoothing_slope=0.06, smoothing_seasonal=0.06)<br/>y_pred = final_tes_model.forecast(225)<br/>train["1985":].plot(title="Triple Exponential Smoothing")<br/>test.plot()<br/>y_pred.plot()<br/>plt.show()</span></pre><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es nj"><img src="../Images/fc73a89f850ef92b6c68ff721822a3e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*Jsd3-1slbFe_IdCiMNfLKw.png"/></div></figure><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es nr"><img src="../Images/d53e932f935eed3b613c1f542c9b0362.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*tuVZJwMbTkmY3SaPHh2HPQ.png"/></div></figure><p id="9dd2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">可以看出，我们的MAE值已经达到了最低值。</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="336f" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">结论</h1><p id="a010" class="pw-post-body-paragraph iu iv hh iw b ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn lc jp jq jr ha bi translated">如果我们着眼于我们的最终模型，在诸如天气这样的可变但季节性的数据中建立TES (HOLT Winters)模型是非常重要的。季节性与过去相关，趋势与过去相关，水平同样与过去相关，这表明季节和温度对我们来说以相似的模式进行。</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><blockquote class="lw lx ly"><p id="498a" class="iu iv js iw b ix iy iz ja jb jc jd je lz jg jh ji ma jk jl jm mb jo jp jq jr ha bi translated"><em class="hh">下一步:</em></p><p id="c4f0" class="iu iv js iw b ix iy iz ja jb jc jd je lz jg jh ji ma jk jl jm mb jo jp jq jr ha bi translated">在这篇文章的几天后，我将讨论AR模型，MA (q)，ARMA，ARIMA，SARIMA模型，它们与时间序列中的计量经济学和统计模型，第2部分的数据集相同。</p></blockquote><h2 id="c5e4" class="ld kb hh bd kc le lf lg kg lh li lj kk jf lk ll ko jj lm ln ks jn lo lp kw lq bi translated">参考</h2><p id="6a46" class="pw-post-body-paragraph iu iv hh iw b ix ky iz ja jb kz jd je jf la jh ji jj lb jl jm jn lc jp jq jr ha bi translated">[1]<a class="ae it" href="https://www.veribilimiokulu.com/bootcamp-programlari/veri-bilimci-yetistirme-programi/" rel="noopener ugc nofollow" target="_blank">https://www.veribilimiokulu.com</a></p><p id="bc5e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">[2]<a class="ae it" href="https://www.itl.nist.gov/div898/handbook/pmc/section4/pmc4.htm" rel="noopener ugc nofollow" target="_blank">https://www . ITL . NIST . gov/div 898/handbook/PMC/section 4/pm C4 . htm</a></p><p id="3453" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae it" href="https://www.statisticssolutions.com/time-series-analysis/" rel="noopener ugc nofollow" target="_blank">https://www.statisticssolutions.com/time-series-analysis/</a></p></div></div>    
</body>
</html>