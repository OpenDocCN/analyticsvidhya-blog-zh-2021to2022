<html>
<head>
<title>Pneumonia Detection with Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度学习的肺炎检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pneumonia-detection-with-deep-learning-1b3dffbfd81e?source=collection_archive---------18-----------------------#2021-02-23">https://medium.com/analytics-vidhya/pneumonia-detection-with-deep-learning-1b3dffbfd81e?source=collection_archive---------18-----------------------#2021-02-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/03c4f5af2ff7afd1260c37402563464d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cx8P2_tLOhWPvXjIc2xP9A.jpeg"/></div></div></figure><h2 id="95e8" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">医疗保健中的深度学习</h2><p id="a2d8" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">随着人工智能领域的进步，它越来越多地应用于最多样化的知识领域，在健康领域也是如此。</p><p id="a02c" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">目前，人工智能在medicina的几种情况下得到应用，其中包括:</p><ul class=""><li id="a02e" class="kn ko hh jp b jq ki ju kj ja kp je kq ji kr kh ks kt ku kv bi translated">提高诊断准确性</li><li id="5e3b" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">对患者临床状况的警告</li><li id="3dc8" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">疾病治疗</li><li id="4b49" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">确定特定主题的相关研究</li><li id="1802" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">症状的识别和吸收</li></ul></div><div class="ab cl lb lc go ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ha hb hc hd he"><h2 id="0fe4" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated"><strong class="ak">深度学习</strong></h2><p id="a363" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">被称为<strong class="jp hi">深度学习</strong>的技术无疑是该领域应用最广泛的技术之一，其操作基于<strong class="jp hi">人工神经网络</strong>，旨在复制人脑的行为以吸收捕获的信息。</p><p id="4718" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">人工神经网络的行为基于神经元的行为，其层以分层的方式排列，因此信息从一层到另一层，将信息引导到输出层。下图说明了这一过程</p><figure class="lj lk ll lm fd ii er es paragraph-image"><div class="er es li"><img src="../Images/7ab0377e284a684eda5cc389c5b2cb25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*DG7IEZSovkNOQWIumVIHLw.png"/></div></figure></div><div class="ab cl lb lc go ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ha hb hc hd he"><h2 id="fa8d" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated"><strong class="ak">肺炎:是什么？</strong></h2><p id="4d6e" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">肺炎的特征是肺部炎症，主要影响肺泡。导致肺炎的主要因素有:</p><ul class=""><li id="b2ca" class="kn ko hh jp b jq ki ju kj ja kp je kq ji kr kh ks kt ku kv bi translated">吸入有毒产品</li><li id="80e1" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">病毒或细菌感染</li></ul><p id="75df" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">它们可以被归类为风险因素，即可以增加患病几率的因素，吸烟、使用空调、患有哮喘、慢性阻塞性肺病(COPD)、糖尿病、纤维化的人也可以被包括在内。</p><p id="8c9e" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">任何人都有可能患上这种疾病，但在老年人和5岁以下儿童中发病率较高。值得一提的是，根据世卫组织(世界卫生组织)的说法，肺炎是5岁以下儿童死亡的主要原因之一。<a class="ae ln" href="https://www.who.int/news-room/fact-sheets/detail/children-reducing-mortality#:~:text=Leading%20causes%20of%20death%20in,safe%20water%20and%20food%20and" rel="noopener ugc nofollow" target="_blank"> <strong class="jp hi">此处阅读</strong> </a> <strong class="jp hi">。</strong></p><p id="d84b" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">症状可能因病因而异，但通常常见的是高烧(37.5°C以上)、胸痛、有分泌物的咳嗽和气短。</p><p id="dfa9" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">诊断基于临床检查，例如:</p><ul class=""><li id="6726" class="kn ko hh jp b jq ki ju kj ja kp je kq ji kr kh ks kt ku kv bi translated">胸部x光</li><li id="6533" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">血细胞计数</li><li id="e63a" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">血培养</li></ul><p id="13fd" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">值得注意的是，胸部x光检查除了有助于诊断外，还有助于评估疾病的严重程度和患者对治疗的反应。</p><p id="d1df" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><strong class="jp hi">治疗</strong>可能因病原体而异。在<strong class="jp hi">细菌性肺炎</strong>中，通常使用抗生素进行治疗，而对于<strong class="jp hi">病毒性肺炎</strong>，使用药物治疗以缓解症状，也可以使用抗病毒药物。</p><figure class="lj lk ll lm fd ii er es paragraph-image"><div class="er es lo"><img src="../Images/c43f36617c2b49ce3dd46f2002a5aeb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*0RhhHzC8KufmUPnwRgF7-A.png"/></div></figure></div><div class="ab cl lb lc go ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ha hb hc hd he"><h2 id="6b31" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">获取数据</h2><p id="e1d0" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">我们将要处理的<em class="lp">数据集</em>由三个文件夹(训练、测试、有效)组成，这三个文件夹又细分为<em class="lp">正常</em>和<em class="lp">肺炎，</em>总共有5863张JPEG格式的图像。</p><p id="3632" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><em class="lp">数据集</em>最初发布在门德利数据链接网站上，并在<a class="ae ln" href="https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia" rel="noopener ugc nofollow" target="_blank"> kaggle </a>上重新发布。然而，为了方便起见，我在这里放了一个<a class="ae ln" href="https://drive.google.com/file/d/1jOgztRukLrc-kzMkkTa6T2fK4jTIsBnj/view" rel="noopener ugc nofollow" target="_blank">下载</a>的直接链接。</p><h2 id="fb91" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">导入库并进行初始设置</h2><p id="2366" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">第一步，我们将导入开发过程中使用的所有库。</p><p id="266c" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">在这一步中，我们还将添加一个小配置来改善项目中图像和图形的可视化。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="3c15" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">下载完图像<em class="lp">数据集</em>后，你会注意到它会被压缩，添加到驱动器后，我们会将<em class="lp"> colab </em>连接到Google drive并解压缩<em class="lp">数据集。</em></p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><h2 id="e488" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">组织目录</h2><p id="5a2c" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">在导入和解压文件后，你会有3个文件夹，如前所述，有训练、测试和验证的图像，但是现在我们已经在<code class="du ls lt lu lv b">dataset_train</code>、<code class="du ls lt lu lv b">dataset_test</code>、<code class="du ls lt lu lv b">dataset_valid</code>中组织了我们的目录，还添加了图像标签。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="a834" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">您可以看到，在<code class="du ls lt lu lv b">cv2.imread()</code>函数的图像尺寸中，我们放置了150x150像素，这样做的原因是我们将配置我们的神经网络来接收这些尺寸的图像。</p><h2 id="248e" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">分离数据集</h2><p id="f4fe" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">众所周知，我们必须在X和Y方向上分离数据集，在X方向上，我们将加载图像，在Y方向上，我们将加载各个图像的标签。</p><p id="e54a" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><strong class="jp hi">注意:</strong>你必须为训练、测试和验证这3个数据集做这件事。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><h2 id="d5e8" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">数据探索和图像预处理</h2><p id="395e" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">将数据分为X和Y后，我们可以开始数据探索和图像预处理，在这些步骤中，我们将逐一解释子步骤。</p><ol class=""><li id="9ffa" class="kn ko hh jp b jq ki ju kj ja kp je kq ji kr kh lw kt ku kv bi translated"><strong class="jp hi">检查数据集是否平衡</strong></li></ol><p id="789c" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">当我们处理深度学习时，我们必须始终意识到数据集是平衡的。</p><p id="37bf" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">显而易见，未患肺炎的人数少于患肺炎的人数，以这种方式处理数据会对我们模型的性能产生重大影响。</p><p id="ef25" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">因此，让我们看看我们将用于训练神经网络的dataset_train是如何分布的。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><figure class="lj lk ll lm fd ii er es paragraph-image"><div class="er es lx"><img src="../Images/5c8379d35c26013ea7b13c5c4dde7a86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*G47UrDcYf60dVCrv3SamSQ.png"/></div></figure><p id="e689" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">我们绘制的图表显示，<em class="lp">数据集</em>不平衡，因此我们必须执行<strong class="jp hi">数据扩充</strong>过程，这将在后面解释。</p><p id="f98c" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">2.<strong class="jp hi">查看样本图像</strong></p><p id="55fd" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">让我们看一个健康肺的图像和一个肺炎肺的图像。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><figure class="lj lk ll lm fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ly"><img src="../Images/9cd950ca9d77c18dc756e8c042c628dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R_TzyqRl79gJKIVTgjQX1w.png"/></div></div></figure><p id="bfb4" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">如你所见，它们之间的差别非常微妙。</p><p id="ceda" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">3.<strong class="jp hi">归一化像素</strong></p><p id="505d" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">在这一步中，我们将使每个像素的值，正如已经提到的在范围[0，255]内，停留在范围[0，1]内，本质上我们希望将像素的值转换为浮点类型。为此，只需将所有像素除以最大可能值，在本例中为255。</p><p id="fad2" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">为了执行该步骤，创建了一个<strong class="jp hi">λ函数</strong>，即<code class="du ls lt lu lv b">f_norm</code>，以简化该过程，因为必须对3个数据集进行归一化。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="b8c2" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">电池获得的输出为:</p><p id="5da2" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><em class="lp">形状x_train: (5216，150，150) <br/>形状x_valid: (16，150，150) <br/>形状x_test: (624，150，150) </em></p><p id="493f" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">我们将在下一步中使用这些信息。</p><p id="1324" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">4.<strong class="jp hi">调整图像大小</strong></p><p id="77b4" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">TensorFlow需要一个具有4维的列表，根据我们的输出，可以注意到训练、验证和测试数据集正在返回一个具有3维的列表。</p><p id="bb87" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">TensorFlow期望的列表具有(m，h，w，c)的形式，其中:</p><ul class=""><li id="7b22" class="kn ko hh jp b jq ki ju kj ja kp je kq ji kr kh ks kt ku kv bi translated">m =图像数量</li><li id="ea5e" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">h =图像的高度</li><li id="6961" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">w =图像的宽度</li><li id="20ee" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">c =通道数量</li></ul><p id="c64d" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">为了将其转换成所需的格式，我们将使用reshape函数并添加剩余的值，从前面获得的输出可以看出，该值是<strong class="jp hi"> c </strong>(通道数)的值。</p><p id="90ef" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">由于图像是灰度级的，通道数为1。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="0fa7" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">输出:</p><p id="fd62" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><em class="lp">形状x_train: (5216，150，150，1) <br/>形状x_valid: (16，150，150，1) <br/>形状x_test: (624，150，150，1) </em></p><p id="9830" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">我们现在有了一个4个预期维度的列表。</p><p id="3812" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">5.<strong class="jp hi">将X和Y转换成数组</strong></p><p id="c740" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">这一步对于稍后训练我们的<em class="lp">数据集</em>是必要的。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="f875" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">6.<strong class="jp hi">数据扩充</strong></p><p id="0968" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">这个阶段很重要，因为正如已经解释过的，我们的<em class="lp">数据集</em>在有肺炎和没有肺炎的图像之间有很大的差异。</p><p id="9fdc" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">这个过程使我们从现有的图像中获得更多的数据，因为它应用了<strong class="jp hi">平移</strong>、<strong class="jp hi">旋转</strong>和<strong class="jp hi">反转</strong>变换，并且现有图像中的这些微小变化，我们的神经网络将它们视为新图像。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="cbb6" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">现在，我们将使用训练图像来训练我们的<em class="lp"> data_gen </em>。为此，我们将使用<code class="du ls lt lu lv b">fit</code>方法，并将我们的训练<em class="lp">数据集</em>作为参数传递。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="81aa" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">至此，我们结束了数据探索和图像预处理阶段。下一步是开发我们的模型。</p><h2 id="c250" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">创建模型</h2><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><h2 id="7586" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">模型的解释</h2><p id="e171" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated"><code class="du ls lt lu lv b">Conv2d()</code>层是一个<strong class="jp hi">卷积层</strong>，<strong class="jp hi"> </strong>，其目的是在图像中搜索图案，例如形状和边界，也就是说，它在整个图像中应用过滤器，以获得下一层的重要信息。</p></div><div class="ab cl lb lc go ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ha hb hc hd he"><p id="2ed7" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><code class="du ls lt lu lv b">MaxPool2D()</code>层的目的是通过图像的像素内核，在我们的例子中<strong class="jp hi"><em class="lp">2x 2</em></strong><em class="lp"/>在这个区域内，它将返回最高的像素值，所以这个层简化了它获得的信息。观察图像</p><figure class="lj lk ll lm fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lz"><img src="../Images/c33fc788f8846061e57f24bf284aabcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gaD6SJ6kQNVOclE_WkwLNQ.png"/></div></div></figure></div><div class="ab cl lb lc go ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ha hb hc hd he"><p id="73f2" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><code class="du ls lt lu lv b">BatchNormalization()</code>层旨在标准化前一层的输出，为此，它在其整个输入中应用变换，以便输出接近0。</p></div><div class="ab cl lb lc go ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ha hb hc hd he"><p id="0cfb" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">使用<code class="du ls lt lu lv b">Dropout()</code>层，我们寻求减少<em class="lp">过度拟合</em>。<code class="du ls lt lu lv b">Flatten()</code>层对前一层的输出进行分级，以在单列中显示信息。最后，我们有<code class="du ls lt lu lv b">Dense()</code>层，它负责使所有通过前面层的信息通过一个激活函数。</p><h2 id="70ac" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated"><strong class="ak">编译模型</strong></h2><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="47a4" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><code class="du ls lt lu lv b">model.summary()</code>行为我们提供了模型的概要，显示了所有的层，以及各自的参数。</p><h2 id="7d4f" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">应用ReduceLROnPlateau</h2><p id="ec67" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">有时，模型学习停滞，当我们使用这个函数时，它监控一个量，在这种情况下，我们要求她监控我们的模型的准确性，当这个值停滞超过2个周期(耐心=2)时，它通过降低它的学习率来惩罚模型，避免模型的平稳期。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><h2 id="532c" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">训练神经网络</h2><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="c9cb" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">在这个过程中，我意识到，通过10个赛季的训练，我们将会取得一个好的结果，但也可以尝试其他的价值观。</p></div><div class="ab cl lb lc go ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ha hb hc hd he"><p id="304f" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">最后，让我们来评估我们的模型，让我们先画一张图，显示模型在季节中的演变。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><figure class="lj lk ll lm fd ii er es paragraph-image"><div class="er es ma"><img src="../Images/998c9ee98f2b3354fc2851bc235102e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*ZZp_JR5q4H8DwuyomjfHZg.png"/></div></figure><h2 id="37b7" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">检查准确性</h2><p id="6012" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">最初，我们将让模型预测x_test的值。在<em class="lp"> </em>第二，我们要求返回健康肺和肺炎肺图像的正确答案的准确性，我们注意到我们的模型实现了检测肺炎的93%准确性和检测健康肺图像的89%准确性。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="fb70" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">它将返回给我们:</p><figure class="lj lk ll lm fd ii er es paragraph-image"><div class="er es mb"><img src="../Images/bd673b87627bff4c2aa86e2d68ada9b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*zHEaWDh8ZaKT8I1IdtLC3g.png"/></div></figure></div><div class="ab cl lb lc go ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ha hb hc hd he"><h2 id="2661" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">将模型应用于单个图像</h2><p id="bf5a" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">我们也可以用单个图像来测试我们的模型，只需从测试目录中选取任何图像，用存在疾病的图像和不存在疾病的图像进行测试。</p><p id="6e16" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><strong class="jp hi">注意</strong>:要做到这一点，请注意我们必须应用图像预处理的所有变换。</p><figure class="lj lk ll lm fd ii"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="dce4" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">在<em class="lp"> img </em>变量中，我们放入一幅显示肺炎的图像，在应用必要的变换后我们得到我们的输出，如果它接近1，就意味着我们的模型识别出它为肺部感染了疾病，如果它是一个接近0的数字，则模型识别出它为肺部没有存在疾病。用上面的电池获得的输出是:</p><p id="c35b" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi">[[0.9930381]]</p><p id="1341" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">所以，我们的模型是正确的！</p></div><div class="ab cl lb lc go ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ha hb hc hd he"><p id="ff9c" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">最后我们到达文章的结尾，如果你想访问完整的代码，它在我的github上，只需点击<a class="ae ln" href="https://github.com/rafaelgrecco/Data-Science/blob/main/Detec%C3%A7%C3%A3o_de_Pneumonia_com_Deep_Learning.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>。</p></div></div>    
</body>
</html>