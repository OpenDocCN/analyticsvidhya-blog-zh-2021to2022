<html>
<head>
<title>Python local app to Flask web app- Automating boring tasks with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python本地应用程序到Flask web应用程序——用Python自动化枯燥的任务</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/python-local-app-to-flask-web-app-automating-boring-tasks-with-python-a0632e76f107?source=collection_archive---------0-----------------------#2021-05-13">https://medium.com/analytics-vidhya/python-local-app-to-flask-web-app-automating-boring-tasks-with-python-a0632e76f107?source=collection_archive---------0-----------------------#2021-05-13</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="4780" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">作为我工作的一部分，我要处理大量的文档，有时需要手工操作，比如将信息从一个特定格式的文档转换到另一个文档，只需改变布局。例如，我将这个包含不同行和列信息的excel表转换成不同的Word文档表。这听起来确实很少，但是当您有数千行时，一个简单的复制粘贴任务可能会花费您几个小时，甚至几天。</p><p id="eae3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这就是我如何创建一个简单的Python应用程序，它接受一个excel文件，并将其行转换为不同的Word表格。起初，它是一个本地应用程序，用于处理我的本地桌面文件，但我把它变成了一个web应用程序，作为一个学习的机会，这就是我想写的——把一个处理本地文件的Python应用程序带到Heroku上部署的Flask web应用程序，用户可以在那里上传他们想要的文件。在这个过程中，在前端文件、Python库的使用、文件夹结构和Heroku部署任务中有许多编辑。</p><p id="1341" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可以这么说，这是我的一些心得-</p><ol class=""><li id="1a0f" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated"><strong class="ig hi"> Python Docx库</strong></li></ol><p id="bf3f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我用Python-docx库来处理Word文件。python-docx是一个python库，用于创建和更新Microsoft Word(。docx)文件。你可以在这里找到完整的文档:【https://python-docx.readthedocs.io/en/latest/<a class="ae jl" href="https://python-docx.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"/></p><p id="f64b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我从Python-docx库中学到的一些东西是:</p><p id="71f5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">I)如果你想将一个特定样式的文档转换成除了默认样式之外的任何其他样式，那么使用一个具有所述样式的模板。然后使用“Document.style”从模板文件中提取样式，并将其传输到所需的文件中。您还可以提取特定段落或表格的样式。下面是从存储在变量doc2中的文档中提取表格样式的代码片段:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es jm"><img src="../Images/e4a8f2879d2262d0e85a7f24afb18822.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/0*Afgf0Q7euU4Z8aWT"/></div></figure><p id="f99d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ii)为了清除文档，您获取文档的元素，例如段落、表格等。并将它们从for循环中移除。下面是从存储在文档对象doc2中的文档中删除段落的一段代码:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es ju"><img src="../Images/896b9c57af69ebdcdd5f8cb1e3e1dcdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/0*5-7v8mzCWTmAmP8d"/></div></figure><p id="7753" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 2。烧瓶</strong></p><p id="6877" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了使本地Python文件成为web应用程序，对其最重要的补充之一是Flask库的使用。Flask是一个python库，用于web应用程序的轻量级Web服务器网关接口。Flask实际上将您的Python代码与前端html文件连接起来，您可以在前端显示后端Python代码操作的数据。</p><p id="c9fe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是它看起来的样子:</p><p id="fccc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">I)您可以在html文件中定义端点:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es jv"><img src="../Images/9020e7ff8a6434b8d2038106a32cdf22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*S6w8SAtPomss56Mo"/></div></figure><p id="6dc1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ii)然后在您的Python后端文件中，您可以借助Flask库来定义函数:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es jw"><img src="../Images/d93bf61d00c955040e5e043a0f905ab8.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/0*wbj95aY7kd5jAsRj"/></div></figure><p id="f26c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">开发Flask webapp的另一个主要方面也是维护文件结构和设置相关文件。以下是这方面的一些注意事项:</p><p id="5433" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">I)设置uwsgi文件，在其中指定哪个主python文件，在我的例子中，我的主python文件是appa.py，因此:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es jx"><img src="../Images/52b7ad49301aabc46b90ebc9507ce45d.png" data-original-src="https://miro.medium.com/v2/resize:fit:300/0*hFxqMrMfUiyd5W0Z"/></div></div></figure><p id="5b94" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里阅读更多关于uwsgi的信息:<a class="ae jl" href="https://www.digitalocean.com/community/tutorials/how-to-serve-flask-applications-with-uswgi-and-nginx-on-ubuntu-18-04" rel="noopener ugc nofollow" target="_blank">https://www . digital ocean . com/community/tutorials/how-to-serve-flask-applications-with-uswgi-and-nginx-on-Ubuntu-18-04</a></p><p id="4eac" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ii)如果你维护文件夹结构也更容易，例如:单独的文件夹来存储上传的文件，这通常是很方便的。</p><p id="0d01" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从使用本地存储的文件到让你的用户通过前端上传文件，你必须使用Flask上传文件到上传文件夹。下面是它的一个片段:</p><p id="2a40" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">I)在输入类型为“文件”的所需html文件中创建一个表单:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es kc"><img src="../Images/54eac70c899868f27c2cfde1de0221ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/0*QbQMyFnPCKH9Gran"/></div></figure><p id="5d66" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ii)使用python函数中的files.save代码上传文件，表单提交的端点将使用Flask调用该函数:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es kd"><img src="../Images/7c9d3a305be40b33bb773ba3c158aed8.png" data-original-src="https://miro.medium.com/v2/resize:fit:452/0*PTsTxXq5H790fqR3"/></div></figure><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es ke"><img src="../Images/3503dd495402a52e27caf9a9bedc79ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/0*Ur16ji47wLmCE5xn"/></div></figure><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es jv"><img src="../Images/11f6bf19b7399a840c27f4c168bd5417.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/0*p4hGAt6XNLQ2osB4"/></div></figure><p id="2a45" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我的文件存储在“static1”文件夹中，我可以从那里访问和操作它。</p><p id="24ab" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可以在这里找到合适的通过flask上传文件的学习资源:<a class="ae jl" href="https://pythonbasics.org/flask-upload-file/#:~:text=It%20is%20very%20simple%20to,it%20to%20the%20required%20location" rel="noopener ugc nofollow" target="_blank">https://python basics . org/flask-upload-file/#:~:text = It % 20 is % 20 very % 20 simple % 20 to % 20 It % 20 to % 20 required % 20 location</a>。</p><p id="2399" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">帮助我开始使用Flask的更多资源有:</p><p id="c0c1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">I)蒂姆的技术指导:【https://www.youtube.com/watch?v=mqhxxeeTbu0 T4】</p><p id="4afc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ii)烧瓶网的开发-O ' Reilly</p><p id="8c42" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 3。在Heroku部署web应用程序</strong></p><p id="254f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Heroku是一个基于容器的云平台即服务(PaaS)。开发人员使用Heroku来部署、管理和扩展现代应用。对于学习将Python应用程序部署为web服务的学生来说，这是非常棒的，因为A)它非常容易使用，b)如果它是免费的，它会非常有用。</p><p id="0a0c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下是我入门Heroku的一些经验分享:</p><p id="a8a7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">I)一个很棒的视频，帮助我开始在Heroku部署Python应用:<a class="ae jl" href="https://www.youtube.com/watch?v=Li0Abz-KT78" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=Li0Abz-KT78</a></p><p id="57ab" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ii)另一件要注意的事情是，你必须将所有的HTML文件保存在一个名为“templates”的文件夹中，你的主页名为“index.html”。</p><p id="e5bf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">iii)如果您正在使用免费的HTML模板，并且它的JavaScript和CSS文件夹和文件与您的HTML文件相关联，那么您必须执行以下步骤才能使它与您的HTML文件一起工作:</p><p id="178f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">a.把你的js，css，img文件夹放在名为“static”的文件夹里。</p><p id="5fa9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">b.将所有链接从HTML更改为css、js文件，如下所示:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kf"><img src="../Images/a87d9070a51ee407c69b3b2fc0e03048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Tlj6y3JVo53_Pp66"/></div></div></figure><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es kg"><img src="../Images/4ad8ca88ec0a3d223735b9cbb8a32c0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/0*i28UmlJqcCKsGa8o"/></div></figure><p id="a17a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">iv)另一件要知道的事情是，你需要有一个“requirements.txt”文件，在这个文件中，你使用的所有包和库及其版本都需要被指定。为此，有一个名为“pipreqs”的好库，它允许您选择文件夹，并为所选文件夹的python文件生成需求列表。点击此处了解更多信息—<a class="ae jl" href="https://pypi.org/project/pipreqs/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/pipreqs/</a></p><p id="b0f9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 4。其他试错:</strong></p><p id="e7c9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">嗯，我最长时间犯的一个错误是我的熊猫图书馆没有工作。这显然是因为requirements.txt文件中缺少用于从Excel文件中读取数据和格式化信息的名为xlrd的包，必须对其进行特别指定。在我的“requirements.txt”文件中包含以下代码为我解决了这个问题:</p><figure class="jn jo jp jq fd jr er es paragraph-image"><div class="er es kh"><img src="../Images/04de4fc17cbdc89fbc025830a6732fa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:218/0*r9oQFtwVrxYAl0Vw"/></div></figure><p id="6cd9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">总而言之，这是一次很棒的学习经历。以下是一些本可以做得更好的反思:</p><p id="2ef1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我应该学习日志库，而不是到处使用try catch来调试。</p><p id="fac1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">ii)我的编码惯例本可以做得更好，接下来会看到更多！</p><p id="a791" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">iii)我的评论和git提交本可以更有远见。</p><p id="31cb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但这是一个过程和旅程，慢慢地到达目的地，在那之前我会偶尔写点东西，发些帖子。感谢阅读！</p></div></div>    
</body>
</html>