<html>
<head>
<title>M5 Forecasting — Accuracy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">M5预测—准确性</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/m5-forecasting-accuracy-9fbbb28e0e6f?source=collection_archive---------2-----------------------#2021-04-09">https://medium.com/analytics-vidhya/m5-forecasting-accuracy-9fbbb28e0e6f?source=collection_archive---------2-----------------------#2021-04-09</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="3ca6" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">估计沃尔玛零售商品的单位销售额</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/0a9b2d98ce4a5322b36ca0ac1bcf22ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3zniUD4nSJpDMwxO"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated"><a class="ae jm" href="https://mofc.unic.ac.cy/launch-m5-forecasting-competition/" rel="noopener ugc nofollow" target="_blank">https://mofc.unic.ac.cy/launch-m5-forecasting-competition/</a></figcaption></figure><h1 id="0fc6" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated"><strong class="ak">目录:</strong></h1><ol class=""><li id="60cb" class="kf kg hh kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">商业问题</li><li id="ac26" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">数据来源</li><li id="08f7" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">为什么是最大似然法，为什么不是正常的统计方法</li><li id="99fc" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">性能指标</li><li id="1393" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">解决问题的现有方法</li><li id="54e5" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">探索性数据分析</li><li id="9991" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">第一次切割溶液</li><li id="9ed7" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">模型解释</li><li id="a674" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">模型比较</li><li id="108e" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">未来的工作</li><li id="eaff" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">参考</li></ol><h1 id="b6e5" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated"><strong class="ak">商业问题</strong></h1><p id="bdf3" class="pw-post-body-paragraph lc ld hh kh b ki kj ii le kk kl il lf km lg lh li ko lj lk ll kq lm ln lo ks ha bi translated">在网上商店的时代，了解任何产品在不久的将来的需求变得必不可少。这将有助于商店储存在不久的将来需求量会很高的产品。如果我们能够这样做，将直接提高公司的收入。</p><p id="d00c" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">也就是说<em class="lu">如果我们下周有活动，根据活动</em>，某些产品的销量肯定会增加。</p><h1 id="f780" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">数据来源</h1><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lv"><img src="../Images/a561ed043d97de3d58566c69e331e679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6XDwRWjD4ilMvO7H.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated"><a class="ae jm" href="https://www.bestdesigns.co/uploads/inspiration_images/4350/990__1511457498_404_walmart.png" rel="noopener ugc nofollow" target="_blank">https://www . best designs . co/uploads/inspiration _ images/4350/990 _ _ 1511457498 _ 404 _ Walmart . png</a></figcaption></figure><p id="a051" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">为了解决这个问题，我们将使用来自Kaggle的<a class="ae jm" href="https://www.kaggle.com/c/m5-forecasting-accuracy" rel="noopener ugc nofollow" target="_blank"> M5预测-精确度</a>数据。这是一项由沃尔玛在Kaggle上举办的比赛，旨在预测未来28天的产品销售情况。</p><h2 id="c62b" class="lw jo hh bd jp lx ly lz jt ma mb mc jx km md me jz ko mf mg kb kq mh mi kd mj bi translated">数据集概述</h2><p id="7354" class="pw-post-body-paragraph lc ld hh kh b ki kj ii le kk kl il lf km lg lh li ko lj lk ll kq lm ln lo ks ha bi translated">这是<a class="ae jm" href="https://otexts.com/fpp2/hts.html" rel="noopener ugc nofollow" target="_blank"> <em class="lu">层次时间序列预测</em> </a>，我们需要预测给定商品未来28天的每日销售额。数据集由沃尔玛提供，<em class="lu">涵盖美国三个州(加利福尼亚州、德克萨斯州和威斯康星州)</em>的商店，包括<em class="lu">商品级别、部门、产品类别和商店详情</em>。此外，它还有解释变量，如价格、促销、星期几和特殊事件。数据集包括<em class="lu">3049种产品的单位销售额，分为3个产品类别(爱好、食品和家庭)和7个产品部门</em>，其中上述类别被细分。这些产品在位于三个州(加利福尼亚州、德克萨斯州和威斯康星州)的十家商店销售</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mk"><img src="../Images/e1d38b957a2d88f63f00280eb5da14ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ghR6ojoph0d4w2JwkgrkSA.png"/></div></div></figure><p id="7d3f" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">我们给出了CSV格式的3个数据框架日历、销售培训评估和销售价格。我们还在sample_submission.csv中给出了Kaggle提交的格式</p><p id="f6e2" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated"><strong class="kh hi"> calendar.csv </strong> —包含产品销售日期的信息。</p><p id="3281" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">● <strong class="kh hi"> sell_prices.csv </strong> —包含关于每个商店和日期销售的产品价格的信息。</p><p id="d092" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">●<strong class="kh hi">sales _ train _ evaluation . CSV</strong>—包含每个产品和商店的历史每日单位销售数据[d_1 — d_1941]</p><p id="0f2f" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">●<strong class="kh hi">sample _ submission . CSV</strong>—提交的正确格式。</p><h1 id="f0c9" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">为什么是最大似然法，为什么不是正常的统计方法</h1><p id="e7bd" class="pw-post-body-paragraph lc ld hh kh b ki kj ii le kk kl il lf km lg lh li ko lj lk ll kq lm ln lo ks ha bi translated">当我们有一个单变量数据集或一步预测时，统计方法可以很好地执行。已经看到，对于多步预测，ML方法工作良好。</p><h1 id="7497" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated"><strong class="ak">性能指标</strong></h1><p id="f615" class="pw-post-body-paragraph lc ld hh kh b ki kj ii le kk kl il lf km lg lh li ko lj lk ll kq lm ln lo ks ha bi translated">我们将使用<strong class="kh hi"> RMSE(均方根误差)</strong>来评估我们的模型。当我们更关心预测时，RMSE是一个很好的度量。它是平均平方误差的平方根。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ml"><img src="../Images/71cf05bd10d08238630b9c3b6172578b.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/0*s57PsIaomnWSmemt.jpg"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated"><a class="ae jm" href="https://media.geeksforgeeks.org/wp-content/uploads/20200622171741/RMSE1.jpg" rel="noopener ugc nofollow" target="_blank">https://media . geeks forgeeks . org/WP-content/uploads/20200622171741/RMSE 1 . jpg</a></figcaption></figure><p id="9a00" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">RMSE更重视最显著的错误。如果在需求上有一点小小的误差，我们的RMSE就会显著增加。</p><h1 id="9dd2" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">解决这个问题的现有方法</h1><p id="4a71" class="pw-post-body-paragraph lc ld hh kh b ki kj ii le kk kl il lf km lg lh li ko lj lk ll kq lm ln lo ks ha bi translated">我们将看到前两个解决方案讨论不<a class="ae jm" href="https://www.researchgate.net/profile/Evangelos-Spiliotis/publication/344487258_The_M5_Accuracy_competition_Results_findings_and_conclusions/links/5f7c0258458515b7cf6a25e2/The-M5-Accuracy-competition-Results-findings-and-conclusions.pdf" rel="noopener ugc nofollow" target="_blank"><em class="lu">M5准确性竞赛:结果、发现和结论</em> </a></p><h2 id="9156" class="lw jo hh bd jp lx ly lz jt ma mb mc jx km md me jz ko mf mg kb kq mh mi kd mj bi translated"><strong class="ak">第一个放置的解决方案:</strong></h2><p id="3cd6" class="pw-post-body-paragraph lc ld hh kh b ki kj ii le kk kl il lf km lg lh li ko lj lk ll kq lm ln lo ks ha bi translated">a.他使用各种LightGBM模型的同等加权组合。</p><p id="5a4a" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">b.训练模型使用每个商店(10个模型)、商店类别(30个模型)和商店部门(70个模型)的数据来生成产品商店系列的预测。</p><p id="7623" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">c.建立了220个模型，每个系列平均用6个模型进行预测，其中包括每种类型模型的两个变体，递归和非递归。</p><p id="8ce1" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">d.这些模型考虑了各种标识符、日历相关信息、特殊事件、促销、价格和单位销售数据，包括递归和非递归格式。</p><p id="46a6" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">e.使用CV可用数据的最后四个28天窗口，并通过测量单个模型及其组合产生的误差的平均值和标准偏差，对该方法进行了微调。</p><p id="318c" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">f.之所以选择最终解决方案，是因为它提供了准确而稳健的预测。</p><h2 id="b3db" class="lw jo hh bd jp lx ly lz jt ma mb mc jx km md me jz ko mf mg kb kq mh mi kd mj bi translated">第二名解决方案:</h2><p id="5bdc" class="pw-post-body-paragraph lc ld hh kh b ki kj ii le kk kl il lf km lg lh li ko lj lk ll kq lm ln lo ks ha bi translated">a.这种方法也使用等权重LightGBM模型，但是，根据N-BEATS产生的预测，通过乘数进行外部调整。</p><p id="98be" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">b.共训练了50个模型，首先训练每个商店的10个模型，然后使用五个不同的乘数来调整他们的预测。</p><p id="c242" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">c.LightGBM模型仅使用关于日历效果和价格的一些基本特征进行训练(不考虑过去的单位销售)，而N-BEATS模型仅基于历史单位销售。</p><h2 id="ff3b" class="lw jo hh bd jp lx ly lz jt ma mb mc jx km md me jz ko mf mg kb kq mh mi kd mj bi translated">改进:</h2><p id="7f71" class="pw-post-body-paragraph lc ld hh kh b ki kj ii le kk kl il lf km lg lh li ko lj lk ll kq lm ln lo ks ha bi translated">第一名和第二名获奖者使用了论文中讨论的解决方案。他们的解决方案非常好，但主要问题是当您使用非常低端的设备时，理解和实施起来太复杂了。正如我们已经讨论过的，数据集非常庞大。我们将尝试实现一个简单的解决方案，并取得一些好成绩。</p><h2 id="9232" class="lw jo hh bd jp lx ly lz jt ma mb mc jx km md me jz ko mf mg kb kq mh mi kd mj bi translated">向下投射数据</h2><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="071b" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">在向下转换函数中，我们检查数据框对象类型，并将其更改为低内存需求类型。也就是说，熊猫创建64位整数值，所以我们的向下转换将把它变成8位。</p><h2 id="f776" class="lw jo hh bd jp lx ly lz jt ma mb mc jx km md me jz ko mf mg kb kq mh mi kd mj bi translated">合并数据</h2><p id="98b5" class="pw-post-body-paragraph lc ld hh kh b ki kj ii le kk kl il lf km lg lh li ko lj lk ll kq lm ln lo ks ha bi translated">我们给出了3个数据帧日历、销售培训评估和销售价格，它们没有唯一的 <em class="lu">列</em>，以将销售培训评估合并到日历和销售价格中。首先，让我们看看每个数据框:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mo"><img src="../Images/658a560067ca49c3059c1e90c2b39eee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n6_lX0b34i3phidwe_W5Xg.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">日历的前5个值</figcaption></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mp"><img src="../Images/7c6de3ebfc0de46f2d37ca97b9cb4673.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YhfzRjO35MdMflvGFUoVBA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">销售_培训_评估的五大价值</figcaption></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mq"><img src="../Images/360707efb94390a7c70754c163471021.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*vtiPU54rfVf9kDyN7tPejw.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">sell_price的前5个值</figcaption></figure><p id="c061" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">我们可以合并item_id上的sell_price和sale_train_evaluation，但是如果我们看到日历，就没有我们添加的列。因此，我们将在 sale_train_evaluation中创建两个新列'<em class="lu"> d' </em>和'<em class="lu"> demand '。其中“<em class="lu"> d </em>”将是从<em class="lu"> d_1到d_1941 </em>的天数，在熊猫融化功能的帮助下，将帮助将列变为行。<em class="lu">和需求</em>会给出当天某个特定物品的需求。</em></p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="f16c" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">合并数据后，我们的数据框将如下所示</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mr"><img src="../Images/fcdd0420b0b087133683c79c0a93fcfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cquKXpeaXxfOaw8Pr9gZXA.png"/></div></div></figure><h1 id="f1dd" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">探索性数据分析</h1><ul class=""><li id="b35c" class="kf kg hh kh b ki kj kk kl km kn ko kp kq kr ks ms ku kv kw bi translated"><strong class="kh hi">每个州有多少家商店？(州有更多的卖家，哪个州有更多的商店)</strong></li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mt"><img src="../Images/0b3765fe81b3052b7f9263e5bea096a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*Z-RqFN3JLq94lWHjfQqmJw.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">我们在加利福尼亚州、德克萨斯州和威斯康星州有23672436、17754327、17754327家商店的数据</figcaption></figure><ul class=""><li id="d7ec" class="kf kg hh kh b ki lp kk lq km mu ko mv kq mw ks ms ku kv kw bi translated"><strong class="kh hi">每个类别的产品数量？</strong></li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mx"><img src="../Images/9673a223d9beaa27d4428b05fba53a78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P46TQ7qeWfxbv0CX0UKkKA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">我们有27892170，10966650，2032270来自食品、爱好和家居的产品</figcaption></figure><ul class=""><li id="6a5d" class="kf kg hh kh b ki lp kk lq km mu ko mv kq mw ks ms ku kv kw bi translated"><strong class="kh hi">工作日需求</strong></li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es my"><img src="../Images/4e53b0483f026af33371e1392981530f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rzXO7S3Qbg_hFgEdaUs0wQ.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">与其他日子相比，我们在星期六和星期天有更多的需求。</figcaption></figure><ul class=""><li id="cd28" class="kf kg hh kh b ki lp kk lq km mu ko mv kq mw ks ms ku kv kw bi translated"><strong class="kh hi">各门店需求</strong></li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mz"><img src="../Images/aa809c405da2faa0cf190d3dfce67c7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*hQ-n_XdRB8b3apzHLbBUqA.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">与WI相比，位于加州和德克萨斯州的商店有更多需求</figcaption></figure><ul class=""><li id="cf84" class="kf kg hh kh b ki lp kk lq km mu ko mv kq mw ks ms ku kv kw bi translated"><strong class="kh hi">销售价格和需求的相互关系</strong></li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es na"><img src="../Images/ea8988f815b7c103e1ca885834f1c9d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*lPAdc5Dy47g-0LrF5l304g.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">1 .需求和销售价格之间存在负相关关系。2.我们可以说，如果价格高，需求就会低，反之亦然</figcaption></figure><ul class=""><li id="1f10" class="kf kg hh kh b ki lp kk lq km mu ko mv kq mw ks ms ku kv kw bi translated"><strong class="kh hi">在工作日和有事件时出售类型1 </strong></li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nb"><img src="../Images/f0705f762e3c42e441848e6427d861cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QY01bFqLDALjPPtPtt0SzQ.png"/></div></div></figure><ul class=""><li id="e5a1" class="kf kg hh kh b ki lp kk lq km mu ko mv kq mw ks ms ku kv kw bi translated"><strong class="kh hi">2011-2016年各年需求</strong></li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nc"><img src="../Images/c95efe80e3cb820aa66c9c20b6d81fd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mp13XN3I9Zw8CDllDrxkLw.png"/></div></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nd"><img src="../Images/df924779383378d046ff3b02a59f09e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X4Ja5sJqV7NPuwBlinntXg.png"/></div></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ne"><img src="../Images/4f39033b527653a33b4be4c603ada4c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MSax4nTEjTUoNiVy7z2lYA.png"/></div></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nf"><img src="../Images/710811a7fa40164f91ed8ec0f48f1bdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KrHxbJa0Xr4KNehWTzBZug.png"/></div></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ng"><img src="../Images/f87f2291c0d43329734edada33ee739e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pHc7f61L_BCFqYly6QCnhQ.png"/></div></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nh"><img src="../Images/bd90d6dff2ebb9d7418f28cb0da98a91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ma9XBrDfUsDc68wWTEH3aw.png"/></div></div></figure><p id="608f" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated"><em class="lu">观察:</em></p><ol class=""><li id="f902" class="kf kg hh kh b ki lp kk lq km mu ko mv kq mw ks kt ku kv kw bi translated">每年圣诞节都没有或者很少。</li><li id="60e8" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">我们的数据有季节性。每年都会重复。</li></ol><h2 id="cc99" class="lw jo hh bd jp lx ly lz jt ma mb mc jx km md me jz ko mf mg kb kq mh mi kd mj bi translated">最终观察</h2><ul class=""><li id="0559" class="kf kg hh kh b ki kj kk kl km kn ko kp kq kr ks ms ku kv kw bi translated">与WI相比，CA和TX对产品有更多需求。</li><li id="d1fe" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated">我们一年中允许抢购的日子很少。</li><li id="0615" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated">需求和销售价格都呈下降趋势。</li><li id="016e" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated">我们对国家和宗教事件有更高的要求。</li><li id="5d95" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated">我们食品部的产品多，爱好部的产品少。</li><li id="08e2" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated">周六周日需求高。</li><li id="a2af" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated">文化事件和国家事件有更多的需求。</li><li id="077f" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated">Snap_purchasing不会产生任何重大影响。</li><li id="fd0c" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated">如果有什么大事发生，需求肯定会增加。</li><li id="2ac1" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated">每年圣诞节都没有或很少出售。</li><li id="0875" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated">我们的数据有季节性。每年都会重复。</li></ul><h1 id="6b85" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">第一次切割溶液</h1><p id="81a4" class="pw-post-body-paragraph lc ld hh kh b ki kj ii le kk kl il lf km lg lh li ko lj lk ll kq lm ln lo ks ha bi translated"><strong class="kh hi">处理缺失值:</strong></p><ol class=""><li id="6bea" class="kf kg hh kh b ki lp kk lq km mu ko mv kq mw ks kt ku kv kw bi translated">事件类型1和事件类型2事件名称1和事件名称2缺少91%和99%的值。我们将创建一个新的类别作为new_event，并将填充所有的空值。</li></ol><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="6525" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">2.销售价格缺少值，我们可以使用pandas的插值方法来填充nan值</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="1053" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated"><strong class="kh hi">数据准备</strong></p><p id="b14a" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">为了准备数据，我们将遵循以下步骤:</p><ul class=""><li id="5097" class="kf kg hh kh b ki lp kk lq km mu ko mv kq mw ks ms ku kv kw bi translated">融化sale_train_eval并将其降级</li><li id="c1bb" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated">使用sample_submission创建在Kaggle上提交预测的格式</li><li id="eed4" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated">按天拆分数据</li><li id="2dfb" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated">创建一个新列作为包含我们的train、test1和test2的部分</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><ul class=""><li id="854b" class="kf kg hh kh b ki lp kk lq km mu ko mv kq mw ks ms ku kv kw bi translated">从日历中删除“工作日”、“星期”、“月”、“年”</li><li id="7e4c" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated">将数据与日历和销售价格合并</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="8b30" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">如果一切顺利，我们将在最终文件中获得60034810行。</p><h1 id="06cd" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">特征工程</h1><p id="56f7" class="pw-post-body-paragraph lc ld hh kh b ki kj ii le kk kl il lf km lg lh li ko lj lk ll kq lm ln lo ks ha bi translated">1.对于“事件_名称_1”，“事件_类型_1”，“事件_名称_2”和“事件_类型_2”将检查空值并填充no_event，然后标记编码<br/> 2。对于状态标识、商店标识、分类标识、部门标识、项目标识，将直接标记编码</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="24b7" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">3.更改数据框中的日期列类型</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="6f19" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">4.<strong class="kh hi">滞后特性:</strong>从28天到30天3天轮班。</p><ul class=""><li id="5fda" class="kf kg hh kh b ki lp kk lq km mu ko mv kq mw ks ms ku kv kw bi translated">这里，我们将创建3个新特性lag_28、lag_29和lag_30，它们分别是第28、29和30天的班次。</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="4109" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">5.<strong class="kh hi">滚动:</strong>取一组n(此处为7天)，取其平均值。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="f1d0" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">6.填充由滚动和滞后特征创建的所有nan值</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="c1ef" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">7.分割数据</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><h1 id="387e" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">模型</h1><ol class=""><li id="d9bd" class="kf kg hh kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated"><strong class="kh hi"> XGBoost : </strong> XGBoost代表“极限梯度提升”。这是梯度推进的有效实现，可用于回归预测建模。</li></ol><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="db18" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">→我们的val rmse分数是13。59860 . 68888886861</p><p id="a0bf" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">2.<strong class="kh hi"> XGboost无额外功能</strong></p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="eec6" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">→我们的val rmse分数是13。59860 . 68888888861</p><p id="9fea" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">3.<strong class="kh hi"> LightGBM : </strong> Light GBM是基于树的梯度推进算法。它垂直生长树。因为它的速度很快，所以被冠以“光”的前缀。它可以处理大规模的数据，空值，并采取较低的内存运行。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="4803" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">→我们的rmse分数是5.1。58580.88888888861</p><p id="8ccb" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">4.<strong class="kh hi">堆叠:</strong>堆叠是一种集成学习技术，通过元分类器组合多个分类模型。基于完整的训练集训练个体分类模型；然后，基于集成中各个分类模型的输出(元特征)来拟合元分类器。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="802b" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">→我们的rmse分数是5 . 8550 . 858888886886</p><p id="7a66" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">5.<strong class="kh hi"> Adaboost: </strong> AdaBoost也是一种元算法，它帮助我们将多个“弱分类器”组合成单个“强分类器”。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="805c" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">→ rmse得分为8.1126887 . 48687868881</p><h1 id="1b03" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">模型比较</h1><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mm mn l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ni"><img src="../Images/c34812af348475ac9b425ed472a8fa99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bc_Gs2eAt1d0R5vF81akuw.png"/></div></div></figure><h1 id="ffaa" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">未来的工作</h1><ol class=""><li id="b0d8" class="kf kg hh kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">添加更多的功能可以带来好的结果。</li><li id="2ceb" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">像LSTM或FB prophet这样的深度学习方法。</li></ol><h1 id="b1dc" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">参考</h1><ul class=""><li id="f649" class="kf kg hh kh b ki kj kk kl km kn ko kp kq kr ks ms ku kv kw bi translated"><a class="ae jm" href="https://www.kaggle.com/anshuls235/time-series-forecasting-eda-fe-modelling/notebook" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/anshuls 235/time-series-forecasting-EDA-Fe-modeling/notebook</a></li><li id="91d4" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated"><a class="ae jm" href="https://www.kaggle.com/c/m5-forecasting-accuracy/discussion/143070" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/M5-预测-准确性/讨论/143070 </a></li><li id="ea94" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated"><a class="ae jm" href="https://www.kaggle.com/c/m5-forecasting-accuracy/discussion/133468" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/M5-预测-准确性/讨论/133468 </a></li><li id="e086" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated"><a class="ae jm" href="https://www.kaggle.com/c/m5-forecasting-accuracy/discussion/133834" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/M5-预测-准确性/讨论/133834 </a></li><li id="e4db" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated"><a class="ae jm" href="https://lightgbm.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank">https://lightgbm.readthedocs.io/en/latest/index.html</a></li><li id="a5b9" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated"><a class="ae jm" href="https://otexts.com/fpp2/intro.html" rel="noopener ugc nofollow" target="_blank">https://otexts.com/fpp2/intro.html</a></li><li id="79cb" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated"><a class="ae jm" href="http://rasbt.github.io/mlxtend/user_guide/classifier/StackingClassifier/" rel="noopener ugc nofollow" target="_blank">http://rasbt . github . io/mlx tend/user _ guide/classifier/stacking classifier/</a></li><li id="90bd" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated"><a class="ae jm" href="https://towardsdatascience.com/what-makes-lightgbm-lightning-fast-a27cf0d9785e" rel="noopener" target="_blank">https://towards data science . com/what-makes-light GBM-lightning-fast-a 27 cf0 d 9785 e</a></li><li id="35bb" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated"><a class="ae jm" href="https://machinelearningmastery.com/xgboost-for-regression/" rel="noopener ugc nofollow" target="_blank">https://machinelearningmastery.com/xgboost-for-regression/</a></li><li id="edc8" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ms ku kv kw bi translated">https://www.appliedaicourse.com/</li></ul><h2 id="3b37" class="lw jo hh bd jp lx ly lz jt ma mb mc jx km md me jz ko mf mg kb kq mh mi kd mj bi translated"><strong class="ak">笔记本链接:</strong></h2><ul class=""><li id="967e" class="kf kg hh kh b ki kj kk kl km kn ko kp kq kr ks ms ku kv kw bi translated"><a class="ae jm" href="https://github.com/namratesh/M5-forecasting/" rel="noopener ugc nofollow" target="_blank">https://github.com/namratesh/M5-forecasting/</a></li></ul><p id="a383" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated">Linkedin个人资料:</p><p id="df43" class="pw-post-body-paragraph lc ld hh kh b ki lp ii le kk lq il lf km lr lh li ko ls lk ll kq lt ln lo ks ha bi translated"><a class="ae jm" href="http://www.linkedin.com/in/namratesh" rel="noopener ugc nofollow" target="_blank">www.linkedin.com/in/namratesh</a></p></div></div>    
</body>
</html>