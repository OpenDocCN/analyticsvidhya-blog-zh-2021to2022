<html>
<head>
<title>M5 Forecasting - Accuracy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">M5预测-准确性</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/m5-forecasting-accuracy-ad0d01a79b8e?source=collection_archive---------5-----------------------#2021-01-26">https://medium.com/analytics-vidhya/m5-forecasting-accuracy-ad0d01a79b8e?source=collection_archive---------5-----------------------#2021-01-26</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="bda7" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">估计沃尔玛零售商品的单位销售额</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/dd7b1025ea4f5133c6bb848a8cf3617b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FElL6_KV4KQ8PUzb7WEmvQ.jpeg"/></div></div></figure><h2 id="c8c0" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak">目录:</strong></h2><ol class=""><li id="7845" class="kg kh hh ki b kj kk kl km jt kn jx ko kb kp kq kr ks kt ku bi translated">商业/现实世界的问题</li><li id="ebd7" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">问题陈述</li><li id="1955" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">数据来源和数据概述</li><li id="3164" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">最大似然法在问题中的应用</li><li id="bc79" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">性能指标</li><li id="560e" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">探索性数据分析</li><li id="69b1" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">现有方法</li><li id="5fda" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">第一次切割溶液</li><li id="26fd" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">特征工程和数据预处理</li><li id="2d0c" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">模型解释</li><li id="feef" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">模型比较</li><li id="201e" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">Kaggle提交</li><li id="4082" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">部署</li><li id="9da5" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">未来的工作</li><li id="b8d9" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">参考</li></ol><h1 id="7ca5" class="la jj hh bd jk lb lc ld jo le lf lg js in lh io jw iq li ir ka it lj iu ke lk bi translated"><strong class="ak"> 1。业务问题:</strong></h1><p id="ee40" class="pw-post-body-paragraph ll lm hh ki b kj kk ii ln kl km il lo jt lp lq lr jx ls lt lu kb lv lw lx kq ha bi translated">销售预测是通过使用历史销售数字来估计未来短期或长期销售的过程。预测销售对于公司来说是至关重要的，例如，投资新的方法来增加他们产品的收入，这可能会导致未来通过促销/折扣等方式的低销售额。因此，对于已建立的企业来说，准确预测未来的销售变得非常重要。</p><h1 id="b6a8" class="la jj hh bd jk lb lc ld jo le lf lg js in lh io jw iq li ir ka it lj iu ke lk bi translated"><strong class="ak"> 2。问题陈述:</strong></h1><p id="611e" class="pw-post-body-paragraph ll lm hh ki b kj kk ii ln kl km il lo jt lp lq lr jx ls lt lu kb lv lw lx kq ha bi translated">使用世界上收入最大的公司沃尔玛的历史销售数据，我们需要预测未来28天的日销售额。</p><p id="0b99" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated">这个问题由尼科西亚大学的Makridakis开放预测中心(MOFC)在Kaggle上主持，该中心进行前沿预测研究。商务部因其Makridakis竞赛而闻名，第一次竞赛于20世纪80年代举行。(M5预测)是第五次迭代，我们使用沃尔玛的分层销售数据来预测未来28天的日销售额。</p><h1 id="28a5" class="la jj hh bd jk lb lc ld jo le lf lg js in lh io jw iq li ir ka it lj iu ke lk bi translated"><strong class="ak"> 3。数据来源及数据概述:</strong></h1><p id="d41d" class="pw-post-body-paragraph ll lm hh ki b kj kk ii ln kl km il lo jt lp lq lr jx ls lt lu kb lv lw lx kq ha bi translated">数据是从Kaggle下载的。<a class="ae md" href="https://www.kaggle.com/c/m5-forecasting-accuracy/data" rel="noopener ugc nofollow" target="_blank">来源</a></p><h2 id="2502" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 3.1数据概述:</strong></h2><p id="cc0a" class="pw-post-body-paragraph ll lm hh ki b kj kk ii ln kl km il lo jt lp lq lr jx ls lt lu kb lv lw lx kq ha bi translated">沃尔玛提供的销售数据涵盖了美国三个州(加利福尼亚州、德克萨斯州和威斯康星州)的商店，包括商品级别、部门、产品类别和商店详细信息。此外，它还有解释变量，如价格、促销、星期几和特殊事件。</p><p id="57b9" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated">下面流程图中的高级M5系列组织概述。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es me"><img src="../Images/4637ad88fb5b9182e44b3560a5bfe934.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*WmxnWWrPPJt8A8QrkX04oA.png"/></div></div><figcaption class="mf mg et er es mh mi bd b be z dx translated">M5系列组织概述</figcaption></figure><p id="3023" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated">数据主要分为3个文件:</p><ol class=""><li id="1ec9" class="kg kh hh ki b kj ly kl lz jt mj jx mk kb ml kq kr ks kt ku bi translated">calender . CSV——包含产品销售日期以及日期行为的信息(例如:月、年、星期、该日期的任何特殊事件)。</li><li id="f5e0" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">sales_train_evaluation.csv —包含历史每日单位销售额([包括从d_1到d_1941]，即从<strong class="ki hi">2011–01–29</strong>到<strong class="ki hi">2016–05–22</strong>)。)每个产品和商店的数据</li><li id="ffcb" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">sell _ prices.csv包含每个商店和日期销售的产品的价格信息。</li></ol><h1 id="77d4" class="la jj hh bd jk lb lc ld jo le lf lg js in lh io jw iq li ir ka it lj iu ke lk bi translated"><strong class="ak"> 4。在问题上使用ML:</strong></h1><p id="2e50" class="pw-post-body-paragraph ll lm hh ki b kj kk ii ln kl km il lo jt lp lq lr jx ls lt lu kb lv lw lx kq ha bi translated">我们正在解决的问题是一个时间序列问题，我们可以通过对原始时间序列数据执行特征工程来将其转化为监督学习问题。然后，我们可以将这些特征用作输入变量，将“商品销售额”用作输出变量(实数)，并使用机器学习回归模型解决预测问题。</p><h1 id="5842" class="la jj hh bd jk lb lc ld jo le lf lg js in lh io jw iq li ir ka it lj iu ke lk bi translated"><strong class="ak"> 5。性能指标:</strong></h1><p id="501e" class="pw-post-body-paragraph ll lm hh ki b kj kk ii ln kl km il lo jt lp lq lr jx ls lt lu kb lv lw lx kq ha bi translated">在基于回归的问题中，一个常用的度量是RMSE。这里，我们使用自定义指标WRMSSE作为这个问题的评估指标。它被定义为:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mm"><img src="../Images/3bba8dde43266d7a6ce7888e0a38a222.png" data-original-src="https://miro.medium.com/v2/resize:fit:366/format:webp/1*I1UyjK87lOzWPFNN4dtGXw.png"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mn"><img src="../Images/c616e4ae13433a4f3b137572acab7f55.png" data-original-src="https://miro.medium.com/v2/resize:fit:424/format:webp/1*09RLKpuvbN8Q5gWiyohgGA.png"/></div></figure><p id="1e1f" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated">其中，Y_t是所检查的时间序列在t点的实际未来销售额，(Y_t )^是从模型生成的预测销售额，n是训练样本的长度(历史观察值的数量)，h是预测范围(28天)。</p><h1 id="b4fe" class="la jj hh bd jk lb lc ld jo le lf lg js in lh io jw iq li ir ka it lj iu ke lk bi translated"><strong class="ak"> 6。探索性数据分析:</strong></h1><p id="4b35" class="pw-post-body-paragraph ll lm hh ki b kj kk ii ln kl km il lo jt lp lq lr jx ls lt lu kb lv lw lx kq ha bi translated">解决机器学习问题的第一步是从数据中获得洞察力。让我们从分析数据开始，如果有任何需要预处理的缺失值，得出关于特定功能如何影响我们的目标销售的有意义的结论。</p><h2 id="b9e7" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 6.1。数据概述:</strong></h2><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mo mp l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mq"><img src="../Images/a3af4a967a658daf1ff6a00d042da7f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dIKMclfIAdqseAg2hwe2oQ.png"/></div></div><figcaption class="mf mg et er es mh mi bd b be z dx translated">每个文件的样本数据点</figcaption></figure><h2 id="0d72" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 6.2。所有商店的总销售额每日和每年模式:</strong></h2><div class="ix iy iz ja fd ab cb"><figure class="mr jb ms mt mu mv mw paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><img src="../Images/f8244eaaf219dfbc2019e3ff2fc7a1f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1546/format:webp/1*8CyjepuS_bjnaUk1k2wYgg.png"/></div></figure><figure class="mr jb mx mt mu mv mw paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><img src="../Images/6f5fb0ee3b09558088e4289fef647d2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/1*Ox--GbKJ-SRDM3XOCdj6WQ.png"/></div></figure></div><p id="aa93" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated"><strong class="ki hi">观察:</strong></p><ol class=""><li id="453b" class="kg kh hh ki b kj ly kl lz jt mj jx mk kb ml kq kr ks kt ku bi translated">从2011年到2016年，总销售额略有上升趋势，每年的1月1日，我们观察到零销售额(我们可以观察到商店在除夕关门)。</li><li id="c33e" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">不同年份的总销售额有相似的模式，并且有年度季节性。</li><li id="eb26" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">从2012年到2015年的总销售额，我们观察到每个2个月的销售额都有相似的模式，由此我们可以假设2012年到2015年每年的时间序列是平稳的时间序列。</li></ol><h2 id="9f91" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 6.3。销售比例:</strong></h2><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es my"><img src="../Images/fd8805b461505eebf76b8afd412536cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tr2wYUf8dE9P7W9JygkeYQ.png"/></div></div></figure><p id="ceef" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated"><strong class="ki hi">观察:</strong></p><ol class=""><li id="0b20" class="kg kh hh ki b kj ly kl lz jt mj jx mk kb ml kq kr ks kt ku bi translated">在这三个州中，加利福尼亚州占总销售额的比例很高，得克萨斯州和威斯康星州的总销售额几乎相等。</li><li id="ddf8" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">尽管加利福尼亚州占总销售额的43.6%，但有趣的是，其2家商店的总销售额位于倒数第四，CA_3商店的销售额最高，CA_4商店的销售额最低。</li><li id="976d" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">食品类销售占比最高，爱好类最低。可以得出结论，人们购物更多的是出于家庭需要，而不是他们的爱好，食品是必需品，因此销售额也很高。</li><li id="6347" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">销售额最高的是“食品_3”部门，最低的是“爱好_2”部门。仅'食品_3 '部门就占了50%销售比例，其他6个部门占了剩余50%销售。尽管“爱好”类别的总销售额非常少(9.3%)，但有趣的是，与食品类别的“食品_1”部门相比，其部门“爱好_1”的销售额很高。</li></ol><h2 id="c2b5" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 6.4。状态和产品类别与销售比例:</strong></h2><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mz"><img src="../Images/4aeceb92276fb861d1716e7394354948.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S-_4xyHjJNVRqvVC5-OWeg.png"/></div></div></figure><p id="5679" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated"><strong class="ki hi">观察:</strong></p><ol class=""><li id="a117" class="kg kh hh ki b kj ly kl lz jt mj jx mk kb ml kq kr ks kt ku bi translated">所有三个州的三种产品类别的销售比例相似。德克萨斯州和威斯康星州的食品类销售比例相同。</li><li id="a3e3" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">在所有3个州中，食品类别的销售额较高，而爱好的销售额最低。德克萨斯和威斯康星两个州的业余爱好产品类别的销售比例相似。</li></ol><h2 id="779f" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 6.5。年份和产品类别与销售比例:</strong></h2><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es na"><img src="../Images/6cb43a1276474a7577e1dae0f0bdfb13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*p2xOuVAPevISLg1PqZ8G4w.png"/></div></figure><p id="5ce5" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated"><strong class="ki hi">观察:</strong></p><ol class=""><li id="e55c" class="kg kh hh ki b kj ly kl lz jt mj jx mk kb ml kq kr ks kt ku bi translated">2015年销量最高，2016年销量最低(仅提供4个月销量)。</li><li id="de87" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">在这三个类别中，食品类别的销售额在所有年份都较高。2013年和2014年，食品、家居和业余爱好销售额相同。</li><li id="fdc7" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">从2012年到2015年，食品类的销售额没有太大差异。</li></ol><h2 id="b8d0" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 6.6。单品类日总销售额:</strong></h2><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nb"><img src="../Images/023596c85a24ae15402eafbc778b41b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ShQDXsvuilyAeL3hfXkGlQ.png"/></div></div></figure><p id="d648" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated"><strong class="ki hi">观察:</strong></p><ol class=""><li id="9df1" class="kg kh hh ki b kj ly kl lz jt mj jx mk kb ml kq kr ks kt ku bi translated">食品类的日总销售额最高，并呈上升趋势(销售额逐年增加)</li><li id="fdd0" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">家庭类的每日总销售额也呈上升趋势，而爱好类的销售额最少，并且多年来几乎保持不变。</li></ol><h2 id="e44d" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 6.7。销量最高的10大产品:</strong></h2><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mo mp l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mq"><img src="../Images/338b061c3b99a38708144dec8601f019.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BY42PifH61caB8Qiu3c7Og.png"/></div></div></figure><p id="3732" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated"><strong class="ki hi">观察:</strong></p><ol class=""><li id="9084" class="kg kh hh ki b kj ly kl lz jt mj jx mk kb ml kq kr ks kt ku bi translated">我们观察到销售额最高的前10个产品是食品(因为食品是必不可少的)。</li><li id="07c4" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">首先，最高销售额是来自'加利福尼亚'州' CA_3 '商店产品'食品_3_090_CA_3 ',第二高销售额是来自'得克萨斯'州' TX_2 '商店产品'食品_3_586_TX_2 ',第三高销售额是来自'得克萨斯'州' TX_3 '商店产品'食品_3_586_TX_3'。</li><li id="b672" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">威斯康星州“WI_3”商店的“FOODS_3_090_WI_3”产品销售额排名第六。</li><li id="b859" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">有趣的是，尽管加州在沃尔玛的销售比例更高，但德克萨斯州有6种产品的销售额在前10名。</li></ol><h2 id="75e9" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 6.8。缺失值分析:</strong></h2><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nc"><img src="../Images/456b1764d34a430425f1b1ee0c7b196b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L4YzgPR1rXlzmm1llbbutg.png"/></div></div></figure><p id="5452" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated"><strong class="ki hi">观察:</strong></p><ol class=""><li id="6695" class="kg kh hh ki b kj ly kl lz jt mj jx mk kb ml kq kr ks kt ku bi translated">prices_data中没有缺失值。</li><li id="3124" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">但是这里的sell_price是每周提供的给定周/商店的产品价格(七天的平均值)。如果这是不可用的，这意味着该产品没有在检查的一周内售出。我们需要检查这些价格缺失的产品。</li><li id="54b1" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">CA_2商店的物品丢失价格较高。TX_1和TX_2商店的商品缺失价格百分比相等。</li><li id="ae87" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">在所有商店中，超过17%的商品价格丢失。</li><li id="7a84" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">除了“事件”和“事件类型”列之外，所有列都没有缺失值。应当理解，如果事件_名称_ 1/事件_名称_2是NAN，即那天是非事件日。</li></ol><h2 id="0368" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 6.9。每个产品类别和每个州的抢购与非抢购日销售比例:</strong></h2><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nd"><img src="../Images/cf0940c223a77c8696ec118a5e520093.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K4XnpRH-CNqAtRhTdw-Z3w.png"/></div></div></figure><p id="1d93" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated"><strong class="ki hi">观察:</strong></p><ol class=""><li id="5416" class="kg kh hh ki b kj ly kl lz jt mj jx mk kb ml kq kr ks kt ku bi translated">就食品类别而言，抢购日的销售额超过了非抢购日的销售额。爱好和家用产品类别在抢购日或非抢购日的类似销售数量。</li><li id="d9e5" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">SNAP在威斯康星州的销量较高，在加利福尼亚州的销量较低。威斯康辛州的SNAP销量明显高于非SNAP销量。</li></ol><h2 id="5108" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 6.10。事件对销售的影响:</strong></h2><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mo mp l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ne"><img src="../Images/5359af94e6e54d613c98c7f011bcc1fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kE-Bt9f2dKHABCA7QZu5GQ.png"/></div></div></figure><p id="cb5c" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated"><strong class="ki hi">观察:</strong></p><ol class=""><li id="bd73" class="kg kh hh ki b kj ly kl lz jt mj jx mk kb ml kq kr ks kt ku bi translated">与销售额下降的全国性赛事相比，体育赛事的销售额有所增加。</li><li id="19b2" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">体育赛事日的销售额增幅最高，文化赛事日和宗教赛事日的销售额增幅第二高。销售额保持稳定(即，平均赛事日销售额不增加或减少)。</li><li id="a1ef" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">体育赛事的销售额是赛事日平均销售额的110%，即赛事日平均销售额增长10%。</li><li id="110b" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">文化活动的销售额是活动日平均销售额的108%，即活动日平均销售额增长8%。</li><li id="579c" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">全国性活动的销售额是活动日平均销售额的89%，即活动日平均销售额下降了11%。</li><li id="f94a" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">与活动日相比，非活动日的销售额更高，总的来说，销售额随着活动日的增加而下降(人们在假日购物更少)，但降幅不大。</li></ol><h2 id="1a5a" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 6.11。一个月内从开始到结束的销售趋势:</strong></h2><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mo mp l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es nf"><img src="../Images/6ba1d51bbe8b8015040b2c56a182c903.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*E83VjA4Cv2Bu0HdnCPfKbw.png"/></div></figure><p id="bf08" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated"><strong class="ki hi">观察:</strong></p><ol class=""><li id="aacd" class="kg kh hh ki b kj ly kl lz jt mj jx mk kb ml kq kr ks kt ku bi translated">显然，我们观察到月初的销售额很高，并且在这个月的前15天保持稳定。</li><li id="9aba" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">一个月的15天后，销售额逐渐下降，为月初销售额的75%。</li></ol><h2 id="0871" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 6.12。2016年各月周末与工作日的销售额:</strong></h2><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mo mp l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ng"><img src="../Images/058f6b9deea685dd5cdce14fc0c5d4cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dq3pjxh0r4J9ns31WtelIQ.png"/></div></div></figure><p id="bc63" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated"><strong class="ki hi">观察:</strong></p><ol class=""><li id="1029" class="kg kh hh ki b kj ly kl lz jt mj jx mk kb ml kq kr ks kt ku bi translated">每月开始的几天销售额会更高。</li><li id="cd5b" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">周末销售额在月初和月末都很高。</li><li id="6f9c" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">临近月底，工作日的销售额有所下降。</li><li id="d5cb" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">但是周末的销售额是一致的(在月初和月末都很高)。</li><li id="f553" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">由此，我们可以说，销售受到周末和工作日的影响。</li></ol><h2 id="2ece" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 6.13。从之前的非抢购日到抢购日的相对销售额变化:</strong></h2><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mo mp l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nh"><img src="../Images/015566d1d057c0784cc97d17d09a87cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6WxUUiC5k7Fy1uYYKu1b_g.png"/></div></div></figure><p id="c36a" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated"><strong class="ki hi">观察:</strong></p><ol class=""><li id="0f63" class="kg kh hh ki b kj ly kl lz jt mj jx mk kb ml kq kr ks kt ku bi translated">每个快照活动持续“15天”，因此我们检查了从第一个快照日到15个快照活动日的最后15天的销售额变化。</li><li id="6f0b" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">我们观察到，沃尔玛的快照活动(跨三个州的快照活动)总会带来销售额的增长。</li><li id="5093" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">在这里，我们绘制了2011年至2016年期间发生的60次快照活动中每一次活动的相对销售变化/增长。</li><li id="0738" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">从“2014-05-01”开始到“2014-05-15”(持续15天)结束的第37次抢购活动的销售额增幅高达30.55%，从“2015-03-01”开始到“2015-03-15”(持续15天)结束的第49次抢购活动的销售额增幅高达29.96%。</li><li id="43a8" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">从“2015年11月1日”开始到“2015年11月15日”结束的第57届snap活动的销售额增幅最小，为3.31%。</li><li id="d374" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">我们观察到的另一个有趣的现象是，快照事件发生在月初。</li></ol><h2 id="daae" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 6.14。每个产品类别、每个州、每个商店每年产生的收入:</strong></h2><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mo mp l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ni"><img src="../Images/881201724520e24cea547059cc216301.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XSFQh6Po9yniwR-fJK8AaQ.png"/></div></div></figure><p id="2d96" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated"><strong class="ki hi">观察:</strong></p><ol class=""><li id="762d" class="kg kh hh ki b kj ly kl lz jt mj jx mk kb ml kq kr ks kt ku bi translated">食品产品产生的收入最高，其次是家用产品，最后是业余爱好产品。88%的收入仅来自食品和家用产品。类似于各产品品类的销售占比。</li><li id="0614" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">来自加州的收入是最高的，德克萨斯州和威斯康星州的收入份额相似。尽管威斯康星州的销售比例为27.6%，但产生的收入为26.3%，相反，加利福尼亚州的销售比例为43.6%，但产生的收入增加到45%。德克萨斯州的收入和销售比例也是28.8%。</li><li id="648f" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">ca3商店产生的收入最高，ca4商店产生的收入最低，与销售比例相同。有趣的TX_3商店，销售比例排名第六，但收入排名第四。相反，WI_3商店的销售额排名第五，比例收入排名第七。</li><li id="8c23" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">德克萨斯州和加利福尼亚州，尽管一些商店的销售额较少，但收入却很高(也许这些州销售的是高价产品)。相反，在威斯康辛州，尽管销售额很高，但产生的收入相对较少(可能这里卖的食物更多，价格更低)。</li><li id="7809" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">2015年的收入很高。我们观察到产生的收入逐年增加。2016年的收入较少，因为只有4个月的数据可用。</li></ol><h2 id="1256" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 6.15。州、商店、一年的周末与工作日销售额:</strong></h2><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mo mp l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nj"><img src="../Images/b8c2b305455ed1d5380ad065b19aa52d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JJHLbnlKErDMdVsb6YcjpA.png"/></div></div></figure><p id="55cb" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated"><strong class="ki hi">观察:</strong></p><ol class=""><li id="edd3" class="kg kh hh ki b kj ly kl lz jt mj jx mk kb ml kq kr ks kt ku bi translated">与工作日相比，这三个州周末的销售额都很高。</li><li id="fb30" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">在加州和德克萨斯州，周日的销售额高于周六，但在威斯康星州，周日的销售额低于周六。</li><li id="8858" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">在加利福尼亚和得克萨斯的所有商店里，周末的销售额很高，星期天的销售额比星期六高。CA_3商店有很高的周末销售额，因为我们看到CA_3也有很高的收入和最高的销售比例。</li><li id="2aca" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">在威斯康辛州的所有商店，周末的销售额很高，周日的销售额比周六少。</li><li id="4e87" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">这些年来，周末销售额比工作日销售额高。2011年和2013年，周六的销售额高于周日。</li></ol><h1 id="375f" class="la jj hh bd jk lb lc ld jo le lf lg js in lh io jw iq li ir ka it lj iu ke lk bi translated"><strong class="ak"> 7。现有方法:</strong></h1><h2 id="3e75" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 7.1。获胜者的解决方案:</strong></h2><p id="e8bd" class="pw-post-body-paragraph ll lm hh ki b kj kk ii ln kl km il lo jt lp lq lr jx ls lt lu kb lv lw lx kq ha bi translated"><a class="ae md" href="https://www.kaggle.com/c/m5-forecasting-accuracy/discussion/163216" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/M5-预测-准确性/讨论/163216 </a></p><p id="27ea" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated">在该解决方案中，用于训练的模型是具有Tweedie目标的LightGBM。验证分割是基于时间的5个折叠分割，其中每个折叠28天的销售是使用先前的历史销售数据预测的。即，第一次折叠—列车d1-d1577，预测d 1578-d 1605；第二次折叠—列车d1-d1829，预测d 1830-d 1857；第三次折叠—列车d1-d1857，预测d 1858-d 1885；第四次折叠—D1-d 1885列车，预计d 1886-d 1913；第5次折叠-训练d1-d1913，预测d1914-d1941，然后计算每次折叠的平均值，得出误差。然后从d1-d1941训练最终模型，并对d1942-d1969的28天进行预测。模型分割中使用的策略适用于10家商店中的每一家；每周训练一个模型来预测销售额，例如:模型m1 —预测前7天(F1-F7)，模型m2 —预测后7天(F8-F14)，模型m3 —预测后7天(F15-F21)，模型m4 —预测后7天(F22-28)，即，我们总共训练40个模型(10 * 4) [10对应于10家商店，4表示28天预测范围的4周]。提取的特征是具有不同窗口大小的滞后特征、滚动平均值/标准差，这里用于模型m1的滞后特征是{lag_7，lag_8…lag_21}，m2具有滞后特征{lag_14，lag_15，…lag_28}，m3具有滞后特征{lag_21，lag_22，…lag_35}，m4具有滞后特征{lag_28，lag_29，…lag_42}。</p><h2 id="95b7" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated">7.2。改进:</h2><p id="0e2b" class="pw-post-body-paragraph ll lm hh ki b kj kk ii ln kl km il lo jt lp lq lr jx ls lt lu kb lv lw lx kq ha bi translated">正如我们在EDA的分析中看到的，每周(七天的平均值)提供的sell_price值(给定周/商店的产品价格)丢失了。对于所有缺少sell_price值的产品，使用该产品id的sell_price平均值估算所有这些值。销售数据上的一组新要素，即沿滚动平均值要素的滚动中值要素，是由于中值不容易出现异常值而创建的。</p><h1 id="d312" class="la jj hh bd jk lb lc ld jo le lf lg js in lh io jw iq li ir ka it lj iu ke lk bi translated"><strong class="ak"> 8。首切解决方案:</strong></h1><h2 id="27b0" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 8.1。该工作日过去4周平均销售额的预测销售额</strong></h2><p id="6e1a" class="pw-post-body-paragraph ll lm hh ki b kj kk ii ln kl km il lo jt lp lq lr jx ls lt lu kb lv lw lx kq ha bi translated">从EDA中，我们观察到有一种每周销售模式，即一周中每个工作日的销售都有一种趋势，因为周末的销售高于工作日的销售。使用最近4周的火车销售数据，我们尝试计算每个工作日的平均销售额。然后根据工作日的平均销售额预测接下来4周的销售额。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mo mp l"/></div></figure><h2 id="0c55" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 8.2。移动平均线</strong></h2><p id="e286" class="pw-post-body-paragraph ll lm hh ki b kj kk ii ln kl km il lo jt lp lq lr jx ls lt lu kb lv lw lx kq ha bi translated">顾名思义，销售额是基于最近N天销售额的平均值进行预测的，其中“N”是超参数。在使用不同的“N”值执行超参数调整后，得出的结论是N=35(即，以过去35天的平均销售额来预测给定日期的销售额)提供了更好的性能。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mo mp l"/></div></figure><h1 id="9169" class="la jj hh bd jk lb lc ld jo le lf lg js in lh io jw iq li ir ka it lj iu ke lk bi translated"><strong class="ak"> 9。特征工程&amp;数据预处理:</strong></h1><ol class=""><li id="66bf" class="kg kh hh ki b kj kk kl km jt kn jx ko kb kp kq kr ks kt ku bi translated">首先，我们通过组合销售数据、日历数据、价格数据创建一个单一的数据框架。然后通过用id <em class="nk">的平均价格进行转换来预处理价格的缺失值。</em></li><li id="cf9b" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">从原始时间序列数据中提取特征对于模型预测销售的好坏起着重要作用。在这里，我们创建了历史销售的一些重要特征，如滞后特征、滚动特征。</li><li id="17ed" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">创建滞后功能的目的是，对于当天的产品，它可以获得前3个月的销售额，并有一个转移期，以便考虑28天的预测。<em class="nk"> </em>常量移位滚动agg均值和中值特征也被创建。</li><li id="ee4d" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">提取的日历数据的一些其他特征是每月的<em class="nk">日，2011年的年值为0，2012年的年值为1。5对于2016年，一个月中某一天的周数例如:1月29日对应于1月的第5周。如果那天不是周末。</em></li><li id="51e9" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">使用LabelEncoder将分类特征转换为标签编码特征。还拆分“d”列的值，只取日数。这样，在对最终数据集应用回归模型之前，我们可以将所有要素转换为数字或标注编码的要素。</li></ol><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mo mp l"/></div></figure><h1 id="2d0d" class="la jj hh bd jk lb lc ld jo le lf lg js in lh io jw iq li ir ka it lj iu ke lk bi translated">10。车型说明:</h1><h2 id="ea75" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 10.1。线性和基于树的模型:</strong></h2><ol class=""><li id="3e2d" class="kg kh hh ki b kj kk kl km jt kn jx ko kb kp kq kr ks kt ku bi translated">在特征工程和数据预处理之后，我们剩下5800万个数据点，这是一个巨大的数据量。我们没有试图在如此庞大的数据规模上建立ML模型，而是使用过去两年的数据，即从2014年1月1日开始。然后，我们将数据分为基于时间的训练-CV-测试分割，如下所示:</li></ol><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mo mp l"/></div></figure><p id="91c6" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated">2.对训练数据拟合具有平方损失的线性模型的SGDRegressor，并对CV数据执行具有不同α(正则化项的乘数)的交叉验证，发现α= 0.1给出较低的WRMSSE分数。然后根据alpha = 0.1的测试数据预测销售额，本地WRMSSE得分为0.8931。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mo mp l"/></div></figure><p id="3c91" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated">3.应用其他基于树的模型，如RandomForest、LGBMRegressor、AdaBoost regressor模型。RandomForest致力于bootstrap aggregation技术，该技术涉及在不同的数据样本上训练每个base_models(决策树),其中采样是通过替换完成的，这种方式将多个决策树结合起来确定最终输出，而不是依赖于单个决策树。LGBMRegressor是一种梯度推进技术，因其速度快和运行时占用内存少而被冠以“Light”的前缀。AdaBoost也是boosting算法，有助于将多个弱学习者合并成一个强学习者。</p><p id="7ae9" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated">4.在所有这些模型的超参数调整中，观察到具有最佳超参数n_estimators = 50，max_depth = 10的RandomForestRegressor给出的局部WRMSSE得分为0.7487。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mo mp l"/></div></figure><p id="18de" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated">具有最佳超参数num_leaves = 125，learning_rate= 0.075的LGBMRegressor本地WRMSSE得分为0.6087。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mo mp l"/></div></figure><p id="ba70" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated">具有最佳超参数的AdaBoostRegressor n _ estimators = 50，learning_rate = 0.05局部WRMSSE得分为0.7944。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mo mp l"/></div></figure><h2 id="5243" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated"><strong class="ak"> 10.2。自定义合奏:</strong></h2><ol class=""><li id="afb2" class="kg kh hh ki b kj kk kl km jt kn jx ko kb kp kq kr ks kt ku bi translated">当我们观察到基于集成树的模型比线性模型表现得更好时，我们尝试构建如下定制集成模型:</li><li id="22dc" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">首先将整个数据集分成两个数据集，基于基于时间的分割进行训练和测试。然后，基于基于时间的分割，将训练数据集分割成另外两个半数据集D1、D2。</li><li id="4097" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">从数据集D1，我们用替换进行采样，以获得N个数据集，并训练N个模型作为基础学习器。这里N →基础学习者的数量是一个超参数。对于每个经过训练的基础学习者，我们获得D2预测和测试数据，并将其用作特征。</li><li id="267d" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">我们用X_i作为N个特征来训练元模型，其中我们得到的每个单个特征都来自D2对每个训练好的基础学习者的预测，Y_i是D2的真实值。</li><li id="29f0" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">在元模型训练之后，利用从N个训练过的基础学习者中提取的测试数据的N个特征，我们从训练过的元模型中预测销售。</li><li id="71de" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">对不同的基础学习器、元模型和“N”→数量的基础学习器进行超参数调整，发现XGBRegressor作为基础学习器，LGBMRegressor作为元模型，N = 18，给出较低的局部WRMSSE为0.6995。</li></ol><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mo mp l"/></div><figcaption class="mf mg et er es mh mi bd b be z dx translated">定制集成模型</figcaption></figure><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mo mp l"/></div><figcaption class="mf mg et er es mh mi bd b be z dx translated">自定义集合预测</figcaption></figure><h1 id="bdb7" class="la jj hh bd jk lb lc ld jo le lf lg js in lh io jw iq li ir ka it lj iu ke lk bi translated"><strong class="ak"> 11。车型对比:</strong></h1><p id="2300" class="pw-post-body-paragraph ll lm hh ki b kj kk ii ln kl km il lo jt lp lq lr jx ls lt lu kb lv lw lx kq ha bi translated">在我们的问题上尝试的模型的性能:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es nl"><img src="../Images/4d0d1c43f22e767edb63ca872ff10a6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*iksiqM-Y93JP1G06fUkfFw.png"/></div></figure><p id="75f2" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated">据观察，移动平均和线性模型的性能比天真的模型差。表现最好的模型是集合模型。</p><h1 id="2ab3" class="la jj hh bd jk lb lc ld jo le lf lg js in lh io jw iq li ir ka it lj iu ke lk bi translated"><strong class="ak"> 12。Kaggle投稿:</strong></h1><p id="0107" class="pw-post-body-paragraph ll lm hh ki b kj kk ii ln kl km il lo jt lp lq lr jx ls lt lu kb lv lw lx kq ha bi translated">Kaggle对每个模型的评分:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nm"><img src="../Images/49891454805b91278b01bd6fc0bd9fd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ksH2EyqYeY6M5-TfAqL5vA.png"/></div></div></figure><ol class=""><li id="e9ae" class="kg kh hh ki b kj ly kl lz jt mj jx mk kb ml kq kr ks kt ku bi translated">从上面的私人排行榜得分，我们观察到，在所有模型中，Custom ensemble模型表现良好，因为它能够以较低的得分(WRMSSE)=0.66282的私人得分预测销售。</li><li id="efb3" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">一旦我们从最终的最佳定制套装模型中获得验证日(1914-1941)销售额和评估日(1942-1969)销售额，并以给定的格式提交，我们将获得排行榜分数<strong class="ki hi"> 0.66282 </strong>，在<strong class="ki hi"> 5558 </strong>名参与者中排名<strong class="ki hi"> 352 </strong>，位列<strong class="ki hi">前7% </strong>。</li></ol><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nn"><img src="../Images/ba0b29ccb1030eeef6a5387868ed45d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FSTA4pTurV-KCgh-bJXQLw.png"/></div></div><figcaption class="mf mg et er es mh mi bd b be z dx translated">Kaggle排行榜最佳表现车型排名</figcaption></figure><h1 id="4a92" class="la jj hh bd jk lb lc ld jo le lf lg js in lh io jw iq li ir ka it lj iu ke lk bi translated"><strong class="ak"> 13。部署:</strong></h1><ol class=""><li id="3fb8" class="kg kh hh ki b kj kk kl km jt kn jx ko kb kp kq kr ks kt ku bi translated">在使用最佳超参数训练定制集合模型后，我们将基础模型和元模型存储在pickle文件中，并将其与围绕最终渠道构建的flask API一起部署到AWS中，最终渠道将返回预测销售额。</li><li id="a205" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">创建网页，以csv或txt文件作为输入，并提供未来28天(即2016年5月23日至2016年6月19日)的预测销售额。</li><li id="a588" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">来自商店的示例产品的预测销售额及其在csv文件中的历史销售额如下。</li></ol><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es no"><img src="../Images/347ff3e3274881795faf85e1e06ecf97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FeXQPxV71rcJ-71JLVGm9g.png"/></div></div><figcaption class="mf mg et er es mh mi bd b be z dx translated">以csv文件为输入的html页面</figcaption></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es no"><img src="../Images/590df2a10d346026c3811b6fe4bb7602.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c_YFHMdzsuYX5toZ37ZU3Q.png"/></div></div><figcaption class="mf mg et er es mh mi bd b be z dx translated">预测销售额</figcaption></figure><p id="a44c" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated"><strong class="ki hi">解释结果的演示视频</strong></p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="np mp l"/></div></figure><h1 id="e48a" class="la jj hh bd jk lb lc ld jo le lf lg js in lh io jw iq li ir ka it lj iu ke lk bi translated"><strong class="ak"> 14。未来工作:</strong></h1><ol class=""><li id="40c9" class="kg kh hh ki b kj kk kl km jt kn jx ko kb kp kq kr ks kt ku bi translated">尝试使用神经网络方法，因为它提供了各种损失函数的灵活性。</li><li id="e53c" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated">用LSTM模型进行时间序列预测的尝试。</li></ol><h1 id="b0b4" class="la jj hh bd jk lb lc ld jo le lf lg js in lh io jw iq li ir ka it lj iu ke lk bi translated"><strong class="ak"> 15。参考文献:</strong></h1><ol class=""><li id="e106" class="kg kh hh ki b kj kk kl km jt kn jx ko kb kp kq kr ks kt ku bi translated"><a class="ae md" href="https://www.analyticsvidhya.com/blog/2019/12/6-powerful-feature-engineering-techniques-time-series/" rel="noopener ugc nofollow" target="_blank">https://www . analyticsvidhya . com/blog/2019/12/6-强力-特征-工程-技术-时间系列/ </a></li><li id="793f" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated"><a class="ae md" href="https://www.kaggle.com/c/m5-forecasting-accuracy/discussion/144067" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/M5-预测-准确性/讨论/144067 </a></li><li id="6d58" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated"><a class="ae md" href="https://www.kaggle.com/dhananjay3/wrmsse-evaluator-with-extra-features" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/dhananjay 3/wrmsse-evaluator-with-extra-features</a></li><li id="b714" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated"><a class="ae md" href="https://www.kaggle.com/headsortails/back-to-predict-the-future-interactive-m5-eda" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/head sortails/back-to-predict-the-future-interactive-M5-EDA</a></li><li id="b7b3" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated"><a class="ae md" href="https://www.kaggle.com/c/m5-forecasting-accuracy/discussion/163216" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/M5-预测-准确性/讨论/163216 </a></li><li id="c583" class="kg kh hh ki b kj kv kl kw jt kx jx ky kb kz kq kr ks kt ku bi translated"><a class="ae md" href="https://www.appliedaicourse.com/lecture/11/applied-machine-learning-online-course/3194/mapping-to-ml-problem-time-series-forecastingregression/7/module-6-machine-learning-real-world-case-studies" rel="noopener ugc nofollow" target="_blank">https://www . applied ai course . com/lecture/11/applied-machine-learning-online-course/3194/mapping-to-ml-problem-time-series-forecasting regression/7/module-6-machine-learning-real-world-case-studies</a></li></ol><p id="1efc" class="pw-post-body-paragraph ll lm hh ki b kj ly ii ln kl lz il lo jt ma lq lr jx mb lt lu kb mc lw lx kq ha bi translated">完整的项目可以在这里找到<a class="ae md" href="https://github.com/Bharanish/M5" rel="noopener ugc nofollow" target="_blank"> github </a>。关于这个项目的任何疑问，你可以通过<a class="ae md" href="https://www.linkedin.com/in/bharanish-kumar-7469ba121/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>联系我。</p></div></div>    
</body>
</html>