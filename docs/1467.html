<html>
<head>
<title>Exploring Stock Data with a Yahoo Finance Python Module</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Yahoo Finance Python模块探索股票数据</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/exploring-stock-data-with-a-yahoo-finance-python-module-319c6b3815ae?source=collection_archive---------4-----------------------#2021-03-03">https://medium.com/analytics-vidhya/exploring-stock-data-with-a-yahoo-finance-python-module-319c6b3815ae?source=collection_archive---------4-----------------------#2021-03-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="fbbc" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">热衷于研究股票的散户投资者入门指南</h2></div><p id="f51b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你是一个对股票市场感兴趣的散户投资者，自己研究股票是必不可少的。雅虎财经和许多其他网站一样，提供股票数据供用户互动。对于那些精通编码技术的人来说，有一些API(应用程序接口)可以编程访问Yahoo Finance数据。<a class="ae jt" href="https://pypi.org/project/yfinance/" rel="noopener ugc nofollow" target="_blank"> yfinance </a>，由<a class="ju jv ge" href="https://medium.com/u/68179100a7a3?source=post_page-----319c6b3815ae--------------------------------" rel="noopener" target="_blank">Ran aroun si</a>维护，是一个Python模块，提供对多个数据集的访问。</p><p id="419c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这篇文章将展示yfinance模块的一些方面，并希望为其他人的参与和探索打开大门。</p><h1 id="037f" class="jw jx hi bd jy jz ka kb kc kd ke kf kg io kh ip ki ir kj is kk iu kl iv km kn bi translated">装置</h1><p id="ccf9" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">我用<code class="du kt ku kv kw b">pip</code>安装的。在<code class="du kt ku kv kw b">Terminal</code>中，运行以下程序:</p><pre class="kx ky kz la fd lb kw lc ld aw le bi"><span id="ec2c" class="lf jx hi kw b fi lg lh l li lj">pip install yfinance</span></pre><h1 id="27f6" class="jw jx hi bd jy jz ka kb kc kd ke kf kg io kh ip ki ir kj is kk iu kl iv km kn bi translated">跑马灯模块</h1><p id="f5de" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">要访问一只股票的数据，只需使用<code class="du kt ku kv kw b">Ticker</code>模块。首先，导入<code class="du kt ku kv kw b">yfinance</code>，然后通过定义您感兴趣的股票代码来启动(例如，Amazon，by sybmol AMZN)。</p><pre class="kx ky kz la fd lb kw lc ld aw le bi"><span id="0dd3" class="lf jx hi kw b fi lg lh l li lj">import yfinance as yf<br/>stock = yf.Ticker('AMZN')</span></pre><p id="c692" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du kt ku kv kw b">stock</code>实例包含大量信息，您可以通过调用不同的方法来访问这些信息。我们将在接下来的章节中详细介绍它们，但是首先让我们通过打印出<code class="du kt ku kv kw b">stock.info</code>来看看<code class="du kt ku kv kw b">info</code>对象。这在一个字典中包含了关于Amazon业务和AMZN股票的基本信息，包括价格、数量、短期利息和beta系数风险。</p><pre class="kx ky kz la fd lb kw lc ld aw le bi"><span id="ecf3" class="lf jx hi kw b fi lg lh l li lj">{'zip': '98109-5210',<br/> 'sector': 'Consumer Cyclical',<br/> 'fullTimeEmployees': 1298000,<br/> 'longBusinessSummary': 'Amazon.com, Inc. engages in the retail sale of consumer products and subscriptions in North America and internationally. The company operates through three segments...,<br/> 'city': 'Seattle',<br/> 'phone': '206-266-1000',<br/> 'state': 'WA',<br/> 'country': 'United States',<br/> 'companyOfficers': [],<br/> 'website': 'http://www.amazon.com',<br/> 'maxAge': 1,<br/> 'address1': '410 Terry Avenue North',<br/> 'industry': 'Internet Retail',<br/> 'previousClose': 3146.14,<br/> 'regularMarketOpen': 3143.47,<br/> 'twoHundredDayAverage': 3209.0454,<br/> 'trailingAnnualDividendYield': None,<br/> 'payoutRatio': 0,<br/> 'volume24Hr': None,<br/> 'regularMarketDayHigh': 3163.52,<br/> 'navPrice': None,<br/> 'averageDailyVolume10Day': 3790100,<br/> 'totalAssets': None,<br/> 'regularMarketPreviousClose': 3146.14,<br/> 'fiftyDayAverage': 3237.417,<br/> 'trailingAnnualDividendRate': None,<br/> 'open': 3143.47,<br/> 'toCurrency': None,<br/> 'averageVolume10days': 3790100,<br/> 'expireDate': None,<br/> 'yield': None,<br/> 'algorithm': None,<br/> 'dividendRate': None,<br/> 'exDividendDate': None,<br/> 'beta': 1.143009,<br/> 'circulatingSupply': None,<br/> 'startDate': None,<br/> 'regularMarketDayLow': 3087.12,<br/> 'priceHint': 2,<br/> 'currency': 'USD',<br/> 'trailingPE': 73.97872,<br/> 'regularMarketVolume': 2506444,<br/> 'lastMarket': None,<br/> 'maxSupply': None,<br/> 'openInterest': None,<br/> 'marketCap': 1558297051136,<br/> 'volumeAllCurrencies': None,<br/> 'strikePrice': None,<br/> 'averageVolume': 3656136,<br/> 'priceToSalesTrailing12Months': 4.03637,<br/> ...<br/> 'shortPercentOfFloat': 0.0089,<br/> 'sharesShortPriorMonth': 3141707,<br/> 'impliedSharesOutstanding': None,<br/> 'category': None,<br/> 'fiveYearAverageReturn': None,<br/> 'regularMarketPrice': 3143.47,<br/> 'logo_url': 'https://logo.clearbit.com/amazon.com'}</span></pre><h1 id="97c3" class="jw jx hi bd jy jz ka kb kc kd ke kf kg io kh ip ki ir kj is kk iu kl iv km kn bi translated">价格历史</h1><p id="a696" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated"><code class="du kt ku kv kw b">history</code>方法提供了对某种股票价格历史的访问。下面是调用该方法的输入参数，来自模块的文档。</p><pre class="kx ky kz la fd lb kw lc ld aw le bi"><span id="4766" class="lf jx hi kw b fi lg lh l li lj">history(period='1mo', interval='1d', start=None, end=None, prepost=False, actions=True, auto_adjust=True, back_adjust=False, proxy=None, rounding=False, tz=None, **kwargs)</span></pre><p id="e3ff" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们使用1个月的默认时间段来获取数据，并进行检查。</p><pre class="kx ky kz la fd lb kw lc ld aw le bi"><span id="23d5" class="lf jx hi kw b fi lg lh l li lj">prices = stock.history(period='1mo')<br/>prices.head()</span></pre><p id="dce4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这向我们展示了数据帧的前5行</p><figure class="kx ky kz la fd ll er es paragraph-image"><div class="er es lk"><img src="../Images/790679641bbe46380c12cd6c9ccd4b9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*dJCOF9_1Ca64t304ZQIDDQ.png"/></div><figcaption class="lo lp et er es lq lr bd b be z dx translated">价格历史记录的前5行</figcaption></figure><p id="3371" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了计算股票的每日收益，我们可以使用<code class="du kt ku kv kw b">pct_change</code>方法对<code class="du kt ku kv kw b">Close</code>列熊猫如下</p><pre class="kx ky kz la fd lb kw lc ld aw le bi"><span id="4032" class="lf jx hi kw b fi lg lh l li lj">prices['Returns'] = prices['Close'].pct_change()<br/>prices.head()</span></pre><p id="cdac" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，dataframe有了一个returns列，可用于不同的目的，例如计算特定时间段内的滚动回报。</p><figure class="kx ky kz la fd ll er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es ls"><img src="../Images/384e70b330db0165f4a29cda70364f6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*xQfOSU0RzK1Gq0ZRgE9EPg.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx translated">带有退货栏的价格历史记录的前5行</figcaption></figure><p id="c5b5" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">此外，<code class="du kt ku kv kw b">history</code>方法提供实时价格数据。对于那些感兴趣的人来说，这可以用来监控甚至交易当天的股票。为了展示数据是如何实时的，我们访问1天的数据，暂停1分钟，然后再次访问1天的数据。价格数据将在<code class="du kt ku kv kw b">Close</code>列中。下面的代码</p><pre class="kx ky kz la fd lb kw lc ld aw le bi"><span id="2a45" class="lf jx hi kw b fi lg lh l li lj">print(datetime.now())<br/>display(stock.history(period='1d'))<br/>time.sleep(60)<br/>print(datetime.now())<br/>display(stock.history(period='1d'))</span></pre><p id="1cdc" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数据打印出来如下</p><figure class="kx ky kz la fd ll er es paragraph-image"><div class="er es lx"><img src="../Images/8e081eb4d2c40f3a6b9aca76f8c70ac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*inS5yliFyz3kkzqQIdaYtA.png"/></div><figcaption class="lo lp et er es lq lr bd b be z dx translated">亚马逊(AMZN)的实时数据</figcaption></figure><h1 id="d695" class="jw jx hi bd jy jz ka kb kc kd ke kf kg io kh ip ki ir kj is kk iu kl iv km kn bi translated">股息历史</h1><p id="f339" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">对于对股息投资感兴趣的投资者来说，<code class="du kt ku kv kw b">dividends</code>方法提供了历史股息支付数据。下面是Visa过去8个季度的股息示例。人们可以将其与价格历史相结合，计算股息收益率，比较不同的收益率，并选择高收益投资。</p><pre class="kx ky kz la fd lb kw lc ld aw le bi"><span id="c769" class="lf jx hi kw b fi lg lh l li lj">stock = yf.Ticker('V')<br/>stock.dividends.tail(8)</span></pre><figure class="kx ky kz la fd ll er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es ly"><img src="../Images/ad5781293774575f21ff63155b46bb16.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*-ubATkGU0eoA5YqufkmZ-A.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx translated">过去8个季度的Visa (V)股息历史</figcaption></figure><h1 id="ade7" class="jw jx hi bd jy jz ka kb kc kd ke kf kg io kh ip ki ir kj is kk iu kl iv km kn bi translated">主要股东</h1><p id="6d82" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">对于对股票所有权感兴趣的投资者来说，<code class="du kt ku kv kw b">Ticker</code>下的两个对象可以提供所有权数据。这可能有助于设计策略，跟踪有洞察力的大型投资者的投资，并获得一些回报。</p><p id="265a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面，我们显示了Palantir的最大投资者(持有人列)以及他们拥有Palantir多少流通股(股份和百分比列)。您还可以找到最后一次报告持股的时间(报告日期栏)，我相信这是公司提交SEC 13F表格的日期。</p><pre class="kx ky kz la fd lb kw lc ld aw le bi"><span id="3bc6" class="lf jx hi kw b fi lg lh l li lj">stock = yf.Ticker('PLTR')<br/>stock.institutional_holders</span></pre><figure class="kx ky kz la fd ll er es paragraph-image"><div class="er es lz"><img src="../Images/9eaf82d29e20658a98360589f8e22cfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*zLZZ0zmCLNo_KfTSMsaqHQ.png"/></div><figcaption class="lo lp et er es lq lr bd b be z dx translated">Palantir (PLTR)的机构持有人</figcaption></figure><pre class="kx ky kz la fd lb kw lc ld aw le bi"><span id="5f3a" class="lf jx hi kw b fi lg lh l li lj">stock.mutualfund_holders</span></pre><figure class="kx ky kz la fd ll er es paragraph-image"><div class="er es ma"><img src="../Images/1ae4ab39047623082fb829c67cd55781.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*l6TyQwBMvK55rBAocp_LVw.png"/></div><figcaption class="lo lp et er es lq lr bd b be z dx translated">Palantir的共同基金持有人</figcaption></figure><h1 id="8670" class="jw jx hi bd jy jz ka kb kc kd ke kf kg io kh ip ki ir kj is kk iu kl iv km kn bi translated">分析师建议</h1><p id="ef97" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">华尔街分析师提供他们对股票的建议，有时是买入、持有和卖出，从看涨到看跌；也可能是超重、等重和欠重(UW)。这有助于检查对股票是否有共识，并监控股票的升级或降级行为，这些行为有时会影响股价。</p><pre class="kx ky kz la fd lb kw lc ld aw le bi"><span id="deae" class="lf jx hi kw b fi lg lh l li lj">stock = yf.Ticker('ZM')<br/>stock.recommendations</span></pre><p id="4a1e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在下面的数据框架中，我们可以在日期索引中找到建议的发布时间；分析师所属的公司或经纪人；“升级”和“升级”栏中的建议和先前的建议；以及“动作”，即从和到之间的增量，其可以是</p><ul class=""><li id="e899" class="mb mc hi iz b ja jb jd je jg md jk me jo mf js mg mh mi mj bi translated">Init:初始化</li><li id="fdaa" class="mb mc hi iz b ja mk jd ml jg mm jk mn jo mo js mg mh mi mj bi translated">降级还是升级:降级还是升级</li><li id="2d17" class="mb mc hi iz b ja mk jd ml jg mm jk mn jo mo js mg mh mi mj bi translated">主要:维持先前的建议</li></ul><figure class="kx ky kz la fd ll er es paragraph-image"><div class="er es mp"><img src="../Images/f53d9244c3b4d5722604767c32329d8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*0ID92quAZuFCpbe-RO2Gow.png"/></div><figcaption class="lo lp et er es lq lr bd b be z dx translated">分析师对Zoom (ZM)的建议</figcaption></figure><h1 id="bbf1" class="jw jx hi bd jy jz ka kb kc kd ke kf kg io kh ip ki ir kj is kk iu kl iv km kn bi translated">日历</h1><p id="88dd" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">对于关注某些股票即将盈利的投资者来说，<code class="du kt ku kv kw b">calender</code>方法提供了下一次盈利日期和华尔街预测的信息。在下面的例子中，我们找到了特斯拉即将到来的收益日期。由于日期尚未确定，数据框包含两列两个估计日期。它包含每股收益(EPS)和收入的平均值、最小值和最大值，这是两个重要的估值指标。</p><pre class="kx ky kz la fd lb kw lc ld aw le bi"><span id="0f1f" class="lf jx hi kw b fi lg lh l li lj">stock = yf.Ticker('TSLA')<br/>stock.calendar</span></pre><figure class="kx ky kz la fd ll er es paragraph-image"><div class="er es mq"><img src="../Images/b72c88efa424dbf4b32d83db0a259468.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*OCl-q0kj5ru2BSPfxU12qA.png"/></div><figcaption class="lo lp et er es lq lr bd b be z dx translated">特斯拉(TSLA)即将到来的盈利日期和估计</figcaption></figure><h1 id="df02" class="jw jx hi bd jy jz ka kb kc kd ke kf kg io kh ip ki ir kj is kk iu kl iv km kn bi translated">选择</h1><p id="3e04" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">最后但同样重要的是，<code class="du kt ku kv kw b">Ticker</code>模块为感兴趣的人提供期权定价数据。您可以首先使用<code class="du kt ku kv kw b">options</code>对象来查找存储在元组中的到期日期。</p><pre class="kx ky kz la fd lb kw lc ld aw le bi"><span id="489b" class="lf jx hi kw b fi lg lh l li lj">stock = yf.Ticker('AMZN')<br/>stock.options</span></pre><figure class="kx ky kz la fd ll er es paragraph-image"><div class="er es mr"><img src="../Images/3bf274b6550e100bead42151355cb7f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:248/format:webp/1*Uq4RPNX8MVf7vQBKEeszhw.png"/></div><figcaption class="lo lp et er es lq lr bd b be z dx translated">AMZN期权到期日</figcaption></figure><p id="9336" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，通过定义到期日，使用<code class="du kt ku kv kw b">option_chain</code>方法访问期权数据。然后，按如下方式分别访问看涨和看跌期权。你会发现交易日期、执行价格、合同的第三位要价、交易量、隐含波动率(IV)以及其他信息。</p><pre class="kx ky kz la fd lb kw lc ld aw le bi"><span id="0aae" class="lf jx hi kw b fi lg lh l li lj">option_chain = stock.option_chain(date='2021-03-05')<br/>option_chain.calls.sort_values('lastTradeDate')</span></pre><figure class="kx ky kz la fd ll er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es ms"><img src="../Images/2f5cf8fb422864ff6081c334bc19f0fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LFFSoZhzGYgcqjVE9PnoDA.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx translated">AMZN的买入期权历史</figcaption></figure><pre class="kx ky kz la fd lb kw lc ld aw le bi"><span id="4bb3" class="lf jx hi kw b fi lg lh l li lj">option_chain.puts.sort_values('lastTradeDate')</span></pre><figure class="kx ky kz la fd ll er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es mt"><img src="../Images/37ca3641fb7f71afbfaa229cdc12d54b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D-aHwIEudfEaMSK2pQ7PGA.png"/></div></div><figcaption class="lo lp et er es lq lr bd b be z dx translated">AMZN的看跌期权历史</figcaption></figure><h1 id="d6ef" class="jw jx hi bd jy jz ka kb kc kd ke kf kg io kh ip ki ir kj is kk iu kl iv km kn bi translated">结论</h1><p id="4ab1" class="pw-post-body-paragraph ix iy hi iz b ja ko ij jc jd kp im jf jg kq ji jj jk kr jm jn jo ks jq jr js hb bi translated">希望这对那些有兴趣将编码应用于股票研究和投资的人有用。祝大家好运！</p></div></div>    
</body>
</html>