<html>
<head>
<title>Azure Synapse analytics Data Flow data processing lineage in Azure Purview for delta CRUD</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于delta CRUD的Azure权限中的Azure Synapse analytics数据流数据处理沿袭</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/azure-synapse-analytics-data-flow-data-processing-lineage-in-azure-purview-for-delta-crud-231fe1681453?source=collection_archive---------2-----------------------#2021-09-04">https://medium.com/analytics-vidhya/azure-synapse-analytics-data-flow-data-processing-lineage-in-azure-purview-for-delta-crud-231fe1681453?source=collection_archive---------2-----------------------#2021-09-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="68ac" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">使用delta CRUD操作的Azure权限中的数据流数据处理沿袭</h1><h1 id="68a7" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">注意</h1><h1 id="9078" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">先决条件</h1><ul class=""><li id="5712" class="jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">Azure帐户</li><li id="09f3" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">Azure synapse分析工作区</li><li id="3698" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">蔚蓝视界</li><li id="ab4b" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">把这两者联系起来</li><li id="bc26" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">为synapse analytics托管身份提供权限贡献者</li><li id="ea23" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">Azure存储</li><li id="ffe9" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">将此报告中的movidedb1.csv从数据文件夹上传到名为movidedincoming的文件夹</li><li id="c173" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">创建一个名为moviesoutput的新文件夹</li></ul><h1 id="8d25" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">数据流活动</h1><ul class=""><li id="b2f8" class="jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">登录Azure synapse analytics工作区或工作室</li><li id="b326" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">首先上传数据</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ka"><img src="../Images/5f7911bd739e257779a4ad2cee9446af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qEU2Vm9FW_d8EA6T.jpg"/></div></div></figure><ul class=""><li id="6fbd" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">转到开发和创建数据流</li><li id="b1ed" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">创建新的数据流</li><li id="eaee" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">这是整个流程</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es kr"><img src="../Images/d411b1ebed803951a2b0af082d651cb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nuR0iCPvizPF69_j.jpg"/></div></div></figure><ul class=""><li id="ba1a" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">将源文件作为csv文件</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ks"><img src="../Images/61224f8bf4cc0155fe4512af88b4e493.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0PwmLB8oYySVZsMg.jpg"/></div></div></figure><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es kt"><img src="../Images/3ae51d309ebfe15c89d124ad720cc188.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZpUjkZQe8MlnI1iz.jpg"/></div></div></figure><ul class=""><li id="5ebe" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">现在，我们将选择所需的列</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ku"><img src="../Images/04b7eb23569c064f1d43b3e4ef330a81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MV4t-m1rn5O9e7HB.jpg"/></div></div></figure><ul class=""><li id="e5ba" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">接下来，我们将使用delta进行CRUD操作</li><li id="abfa" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">因此，我们将从数据集中筛选出几年</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es kv"><img src="../Images/780c53fe031afa81adcf65770df654a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EE9U_ylIddaILPGn.jpg"/></div></div></figure><pre class="kb kc kd ke fd kw kx ky kz aw la bi"><span id="d0ca" class="lb ig hi kx b fi lc ld l le lf">YEAR==1960 || YEAR==1988 || YEAR==1950</span></pre><ul class=""><li id="00f6" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">现在我们将应用一些条件并导出列</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lg"><img src="../Images/3384296b245384a2a2798eda1e91544d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uS7LUkTe6k7yPPSj.jpg"/></div></div></figure><ul class=""><li id="6767" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">用于评级</li></ul><pre class="kb kc kd ke fd kw kx ky kz aw la bi"><span id="6cb5" class="lb ig hi kx b fi lc ld l le lf">iif(YEAR==1998,1, toInteger(Rating))</span></pre><ul class=""><li id="3f40" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">多年来</li></ul><pre class="kb kc kd ke fd kw kx ky kz aw la bi"><span id="b9c7" class="lb ig hi kx b fi lc ld l le lf">iif(YEAR==1960, 2021, toInteger(YEAR))</span></pre><ul class=""><li id="e5a1" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">对于电影</li></ul><pre class="kb kc kd ke fd kw kx ky kz aw la bi"><span id="f9a4" class="lb ig hi kx b fi lc ld l le lf">iif(YEAR==1998,toInteger(movies)+1000, toInteger(movies))</span></pre><ul class=""><li id="469b" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">现在将Alter row用于delta的CRUD操作</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lh"><img src="../Images/480116d6cc0c6d97a88924a69c6bc0fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*i3r85GRb-qf7ApK8.jpg"/></div></div></figure><ul class=""><li id="4f98" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">应用如上图所示的公式</li></ul><pre class="kb kc kd ke fd kw kx ky kz aw la bi"><span id="eecb" class="lb ig hi kx b fi lc ld l le lf">YEAR==2021<br/>YEAR==1998<br/>YEAR==1950</span></pre><ul class=""><li id="0dee" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">现在通过插入、更新和删除下沉到增量位置</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lh"><img src="../Images/248b541c1fbfa32d7bdf16df7fbc3e6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*t7Q9uUrTfA4dsK6f.jpg"/></div></div></figure><ul class=""><li id="891d" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">配置设置</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es li"><img src="../Images/b8dfa8a585b703931606418c1a02cbb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UGF8rGmqsbiDaaXu.jpg"/></div></div></figure><ul class=""><li id="0270" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">选择YEAR和movies作为执行CRUD操作的关键字</li><li id="5b54" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">现在创建一个新集成管道</li><li id="5af5" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">拖放数据流活动，并选择上面创建的数据流</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lj"><img src="../Images/94723a0361a2d78ed89c9f2d2e8ccda6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rRl9znHXohQUwBiI.jpg"/></div></div></figure><ul class=""><li id="ed53" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">现在在调试模式下运行管道</li><li id="eb8c" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">给几分钟时间启动调试集群并运行上面的数据处理</li><li id="e4e5" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">查看输出</li><li id="dadb" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">在发展中</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lk"><img src="../Images/e04e50ecd630d8ea02addb858abaa01b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1ZYsL0yzq9A6Uk2m.jpg"/></div></div></figure><ul class=""><li id="9df4" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">等到它完成</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ll"><img src="../Images/3eb1c233f6b1f705b22dbb8feca810ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*s7ReQTOakYzYCQ34.jpg"/></div></div></figure><ul class=""><li id="aa7b" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">检查输出</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lm"><img src="../Images/9d6c3215b7a266bc61e8b792ad9798fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WO3gr5m4Q68AAAOX.jpg"/></div></div></figure><ul class=""><li id="b842" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">检查接收器活动</li><li id="559f" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">检查接收器活动</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ln"><img src="../Images/5cd1c7c403038ecb173a0ef7c9d21e8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pytKfOmAwQUfnkgw.jpg"/></div></div></figure><ul class=""><li id="138f" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">现在检查delta输出</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lo"><img src="../Images/bf830738060febbe56e442040f31f7ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UGoiTWlxFUgIuJE3.jpg"/></div></div></figure><ul class=""><li id="f701" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">现在转到无服务器sql查询和增量表，查看输出并进行验证</li><li id="61e3" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">我将检查2021年，因为它在实际数据中不存在</li></ul><pre class="kb kc kd ke fd kw kx ky kz aw la bi"><span id="a428" class="lb ig hi kx b fi lc ld l le lf">SELECT TOP 10 *<br/>FROM OPENROWSET(<br/>    BULK 'https://storagename.dfs.core.windows.net/synapseroot/moviesoutgoing1/',<br/>    FORMAT = 'delta') as rows Where YEAR = 2021;</span></pre><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lp"><img src="../Images/4dcbcad5debde307ebaafe1d7ed784ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NVHNzXwf9zB11mqN.jpg"/></div></div></figure><ul class=""><li id="e45a" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">在工作区内，如果您有链接的权限，则转到搜索栏</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lq"><img src="../Images/e0a77bb963ae113538526abd3b23abae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5iHbjrGboGUTxxZf.jpg"/></div></div></figure><ul class=""><li id="d826" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">选择数据流活动</li><li id="9bbf" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">点击血统</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lr"><img src="../Images/b88e304db7c7ceedbeab131dc06c40e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*StryxE-V96ncvUSr.jpg"/></div></div></figure><h1 id="cf90" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">蔚蓝视界</h1><ul class=""><li id="6219" class="jd je hi jf b jg jh ji jj jk jl jm jn jo jp jq jr js jt ju bi translated">登录权限</li><li id="4b6d" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">转到浏览资产</li><li id="d242" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">选择Azure synapse分析</li><li id="fcd2" class="jd je hi jf b jg jv ji jw jk jx jm jy jo jz jq jr js jt ju bi translated">选择您的实例名称</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ls"><img src="../Images/a6cfd608759d1ed5d4332cc8ffab67c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mFjxzXP7vgso_uuM.jpg"/></div></div></figure><ul class=""><li id="3b98" class="jd je hi jf b jg km ji kn jk ko jm kp jo kq jq jr js jt ju bi translated">现在选择带有数据流的管道</li></ul><figure class="kb kc kd ke fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es lt"><img src="../Images/709234f4da94a0bf1d4f7dd1da871d10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MbCtL5-vGzK6zaAj.jpg"/></div></div></figure></div><div class="ab cl lu lv gp lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="hb hc hd he hf"><p id="bb83" class="pw-post-body-paragraph mb mc hi jf b jg km md me ji kn mf mg jk mh mi mj jm mk ml mm jo mn mo mp jq hb bi translated"><em class="mq">最初发表于</em><a class="ae mr" href="https://github.com/balakreshnan/Samples2021/blob/main/Synapseworkspace/dataflowlineage.md" rel="noopener ugc nofollow" target="_blank"><em class="mq">【https://github.com】</em></a><em class="mq">。</em></p></div></div>    
</body>
</html>