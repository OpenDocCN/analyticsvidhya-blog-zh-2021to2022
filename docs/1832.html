<html>
<head>
<title>The Decorators in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的装饰者</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/decorators-in-python-eb05dbf9949b?source=collection_archive---------13-----------------------#2021-03-21">https://medium.com/analytics-vidhya/decorators-in-python-eb05dbf9949b?source=collection_archive---------13-----------------------#2021-03-21</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="5c49" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">提升您的Python技能——了解装饰者是什么，为什么，以及怎么样</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/75131b3f49111e2adcd1b5780ae3b3ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dp4EKoKzwSILTH8yEDmz2A.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">作者图片</figcaption></figure><p id="2548" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi ki translated">从字面上理解，装饰者是美化或增加现有物品价值的人或物。它可以是一个室内设计师，他的工作是使室内空间变得富有美感，或者仅仅是彩灯、金属箔片、装饰品等。用来装饰圣诞树的。</p><p id="a018" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">Python装饰者也差不了太多！！以…的方式</p><blockquote class="kr ks kt"><p id="9124" class="jm jn ku jo b jp jq ii jr js jt il ju kv jw jx jy kw ka kb kc kx ke kf kg kh ha bi translated">Python decorators向现有的Python函数添加新功能，修改其行为，而不改变原始函数。</p></blockquote><p id="649d" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">装饰器本质上是一个接受另一个函数作为输入的函数。就在定义您想要装饰的函数之前，使用@ symbol调用装饰器。在不改变原始代码的情况下添加新功能的能力使得Python decorators非常有用。本文作为教程来演示装饰器的应用。</p><p id="3819" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">我们将首先创建一个函数来计算一个数的阶乘。然后我们将定义两个decorators来分配-1的功能。检查参数和2的有效性。代码执行时间。最后，我们将学习如何链接装饰者。</p></div><div class="ab cl ky kz go la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ha hb hc hd he"><p id="7aa4" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><strong class="jo hi">让我们定义一个函数Factorial </strong>，它将计算一个数(N)的阶乘。我们知道阶乘可以计算为:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es lf"><img src="../Images/358dd907d79e20372a5032d03aab43b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*aEIvXZDSIbDTpwTw1NoULw.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图1</figcaption></figure><p id="f2cb" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">在图2中，定义了阶乘函数。阶乘的值初始化为1，即当参数N= 0时的输出。对于N的其他值，阶乘通过实现上述公式来计算。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图2</figcaption></figure><p id="be1b" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">既然我们已经编写了阶乘函数。让我们测试参数(N)的不同值。在图3中，可以看到对于负数返回了一个不正确的阶乘值，并且当我们试图计算一个非整数的阶乘时抛出了一个错误。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图3</figcaption></figure><p id="d9c3" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><strong class="jo hi"> Decorator Example #1 </strong> —检查传递给阶乘函数的参数的有效性，并在发现负的或非整数的参数值时引发错误。</p><p id="33a4" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">在图4中，装饰器<em class="ku"> check_parameters是</em>定义的，它接受一个函数作为输入。一个<em class="ku">内部</em>函数是在装饰器中定义的，它通过使用Python中的*args功能接受可变数量的参数。关于*args的更多细节，请参考我的文章—</p><p id="cb74" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><a class="ae li" rel="noopener" href="/analytics-vidhya/args-kwargs-in-python-b74295f3cd0">https://medium . com/analytics-vid hya/args-kwargs-in-python-b 74295 F3 CD 0</a></p><p id="3c38" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">想法是通过使用*args功能和for循环遍历参数列表，测试参数值是否为负数和非整数。如果发现参数是负数或非整数，就会抛出相关的错误消息。否则，如果参数是整数，则返回原始函数。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图4</figcaption></figure><p id="23cb" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">注意，装饰器是通过使用第13行中的@符号调用的，需要装饰的原始函数就定义在装饰器调用的下面。</p><p id="833e" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">有一种替代的方式来称呼装饰者。众所周知，在Python中，函数可以作为参数传递，可以从另一个函数返回，也可以赋给一个变量。一旦定义了装饰器和要装饰的函数，我们就可以调用装饰器，如图5所示</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图5</figcaption></figure><p id="e36c" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><strong class="jo hi">装饰器示例#2 — </strong>计算函数的执行时间。</p><p id="12be" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">在图4中，装饰器<em class="ku">计时器</em>被定义为接受一个函数作为输入。就像前面的例子一样，内部函数被定义为具有可变数量的参数，因为阶乘函数(正在被修饰)有一个参数。</p><p id="ea40" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">内部函数是一个包装器，在其中调用要修饰的函数(第11行)。返回内部函数，该函数将输出运行被修饰的函数所用的执行时间。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图6</figcaption></figure><p id="20c1" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">对于较小的数字，阶乘计算非常快。这就是为什么，为了描述执行时间的差异，阶乘是为一个小数字和一个大数字计算的。此外，两种情况下的阶乘数值都很大。如果我们按原样打印输出，那么它将占用很大的空间。因此，我们使用科学记数法来返回阶乘值。</p><p id="902e" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><strong class="jo hi">连锁多个装饰者</strong></p><p id="45d7" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">多个装饰器可以链接在一起，为一个现有的功能增加多种功能。在图7中，<em class="ku">我们之前创建的两个decorators通过使用@ symbol </em>(第1行和第2行)<em class="ku">顺序调用而链接在一起。一旦装饰者被调用，我们将继续定义我们的原始函数。</em></p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图7</figcaption></figure></div><div class="ab cl ky kz go la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ha hb hc hd he"><p id="149b" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">我希望读者会发现这篇文章对编写更复杂的装饰者有所帮助。</p><p id="40e7" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">非常感谢您的反馈。</p><p id="7f25" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">谢谢大家！！</p></div></div>    
</body>
</html>