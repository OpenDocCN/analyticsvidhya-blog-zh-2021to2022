<html>
<head>
<title>How to get into Top 2% in “Loan Approval Prediction” Machine Learning Hackathon</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在“贷款批准预测”机器学习黑客马拉松中进入前2%</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-get-into-top-2-in-loan-approval-prediction-machine-learning-hackathon-83d8c6cfde39?source=collection_archive---------0-----------------------#2021-02-26">https://medium.com/analytics-vidhya/how-to-get-into-top-2-in-loan-approval-prediction-machine-learning-hackathon-83d8c6cfde39?source=collection_archive---------0-----------------------#2021-02-26</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="fb4a" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">由AnalyticsVidhya主办的“贷款审批预测”机器学习黑客马拉松的完整解决方案</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/a0741e2f8b800da25b5f854fbcd1d34b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w_QduaSe5Pe_mgRYzl-IrQ.jpeg"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated"><a class="ae jm" href="https://unsplash.com/photos/7vSlK_9gHWA" rel="noopener ugc nofollow" target="_blank">儿童马戏团</a>在<a class="ae jm" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="4d69" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi kj translated"><span class="l kk kl km bm kn ko kp kq kr di"> H </span>这是我第一次体验由AnalyticsVidhya主办的关于“贷款预测实践问题”(<a class="ae jm" href="https://datahack.analyticsvidhya.com/contest/practice-problem-loan-prediction-iii/#ProblemStatement" rel="noopener ugc nofollow" target="_blank">点击此处</a>了解问题详情)的机器学习黑客马拉松的故事。</p><p id="9bee" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">完整的Python代码可以在我的<a class="ae jm" href="https://github.com/rahul-pednekar/Loan-Prediction-Analyticsvidhya-Hackathon/blob/main/Loan-Prediction-AV.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="jp hi"> GitHub </strong> </a>资源库中找到。</p><h2 id="f768" class="ks kt hh bd ku kv kw kx ky kz la lb lc jw ld le lf ka lg lh li ke lj lk ll lm bi translated">外卖:</h2><blockquote class="ln lo lp"><p id="a026" class="jn jo lq jp b jq jr ii js jt ju il jv lr jx jy jz ls kb kc kd lt kf kg kh ki ha bi translated">截止到2011年2月20日，最终提交为我赢得了<strong class="jp hi"> 80.55%的准确率</strong>&amp;<strong class="jp hi">在<strong class="jp hi"> 5250 </strong>名参与者中排名第122位(前2%) </strong></p><p id="b33b" class="jn jo lq jp b jq jr ii js jt ju il jv lr jx jy jz ls kb kc kd lt kf kg kh ki ha bi translated">在附加功能的帮助下，功能工程帮助将精确度从<strong class="jp hi"> 77%提高到80.55% </strong></p><p id="0300" class="jn jo lq jp b jq jr ii js jt ju il jv lr jx jy jz ls kb kc kd lt kf kg kh ki ha bi translated">有时添加新功能可能会降低准确性，因此需要谨慎选择新功能。</p></blockquote><p id="40d3" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi"> <em class="lq">于是让我们直入黑客马拉松竞技场</em> </strong>😃</p></div><div class="ab cl lu lv go lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ha hb hc hd he"><blockquote class="mb"><p id="b471" class="mc md hh bd me mf mg mh mi mj mk ki dx translated">信息是21世纪的石油，而分析是内燃机</p></blockquote><h1 id="4cdd" class="ml kt hh bd ku mm mn mo ky mp mq mr lc in ms io lf iq mt ir li it mu iu ll mv bi translated">我们要解决什么？</h1><h2 id="faa0" class="ks kt hh bd ku kv kw kx ky kz la lb lc jw ld le lf ka lg lh li ke lj lk ll lm bi translated"><strong class="ak"> <em class="mw">预测梦想房屋金融公司的贷款资格</em> </strong></h2><ol class=""><li id="472a" class="mx my hh jp b jq mz jt na jw nb ka nc ke nd ki ne nf ng nh bi translated">梦想住房金融公司经营各种房屋贷款。他们遍布所有城市、半城市和农村地区。客户首先申请住房贷款，然后该公司验证客户的贷款资格。</li><li id="42dd" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">公司希望根据填写在线申请表时提供的客户详细信息自动执行贷款资格流程(实时)。这些详细信息包括性别、婚姻状况、教育程度、受抚养人人数、收入、贷款金额、信用记录等。</li><li id="fa8a" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">为了实现这一过程的自动化，他们提供了一个数据集来识别有资格获得贷款金额的客户群，以便他们可以专门针对这些客户。</li></ol><p id="0ab5" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">你可以在这里  <strong class="jp hi"> </strong>找到练习题<a class="ae jm" href="https://datahack.analyticsvidhya.com/contest/practice-problem-loan-prediction-iii/#ProblemStatement" rel="noopener ugc nofollow" target="_blank"> <strong class="jp hi">的完整细节，训练和测试数据集可以从<strong class="jp hi"> </strong>相同链接下载。</strong></a></p><blockquote class="ln lo lp"><p id="182d" class="jn jo lq jp b jq jr ii js jt ju il jv lr jx jy jz ls kb kc kd lt kf kg kh ki ha bi translated"><strong class="jp hi">总结:</strong>用数据科学的术语来说，这个问题属于“<strong class="jp hi">二元分类”</strong>问题的范畴，其中目标变量(贷款状态)(我们应该预测的)可以有两个值(<strong class="jp hi">【是】</strong>或<strong class="jp hi">【否】</strong>)</p><p id="3acf" class="jn jo lq jp b jq jr ii js jt ju il jv lr jx jy jz ls kb kc kd lt kf kg kh ki ha bi translated"><strong class="jp hi">训练数据集</strong>:包含客户的详细信息(如性别、婚姻状况、教育程度、受抚养人人数、收入、贷款金额、信用记录等。)以及目标列Loan_Status，其值为:</p><p id="bad8" class="jn jo lq jp b jq jr ii js jt ju il jv lr jx jy jz ls kb kc kd lt kf kg kh ki ha bi translated">1.<strong class="jp hi">“是”:</strong>如果贷款被批准</p><p id="d96f" class="jn jo lq jp b jq jr ii js jt ju il jv lr jx jy jz ls kb kc kd lt kf kg kh ki ha bi translated">2.<strong class="jp hi">【否】:</strong>如果贷款未获批准</p><p id="a43a" class="jn jo lq jp b jq jr ii js jt ju il jv lr jx jy jz ls kb kc kd lt kf kg kh ki ha bi translated"><strong class="jp hi">测试数据集:</strong>它包含新客户的类似详细信息(如性别、婚姻状况、教育程度、受抚养人人数、收入、贷款额、信用记录等。)，但是没有目标列(即Loan_Status)</p><p id="4637" class="jn jo lq jp b jq jr ii js jt ju il jv lr jx jy jz ls kb kc kd lt kf kg kh ki ha bi translated">使用<strong class="jp hi">训练</strong>数据集，我们需要准备一个<strong class="jp hi">机器学习模型</strong>，它将为<strong class="jp hi"><em class="hh"/></strong><strong class="jp hi">测试</strong>数据集中的客户预测<strong class="jp hi"> <em class="hh">贷款_状态</em> </strong> <em class="hh"/></p><p id="a19d" class="jn jo lq jp b jq jr ii js jt ju il jv lr jx jy jz ls kb kc kd lt kf kg kh ki ha bi translated">(例如，对于测试数据集中的每个客户，预测贷款申请是否会获得批准)</p></blockquote><ul class=""><li id="846f" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated">让我们看看数据字典</li></ul><blockquote class="mb"><p id="1cce" class="mc md hh bd me mf nr ns nt nu nv ki dx translated">我们相信上帝。所有其他人必须带来数据</p><p id="d51f" class="mc md hh bd me mf mg mh mi mj mk ki dx translated">-爱德华兹·戴明</p></blockquote><figure class="nx ny nz oa ob jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nw"><img src="../Images/336f43772fb1b09776bf624ea12de735.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8wgAKfRS6c62V14PhVKxKA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">定型数据集中列的详细信息。测试数据集包含与上面相同的列，除了贷款状态列(我们将要预测)</figcaption></figure><p id="614a" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">现在我们已经熟悉了问题陈述，让我们看看解决这个问题需要什么</p></div><div class="ab cl lu lv go lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ha hb hc hd he"><h1 id="6b23" class="ml kt hh bd ku mm oc mo ky mp od mr lc in oe io lf iq of ir li it og iu ll mv bi translated">我们需要哪些工具？</h1><ul class=""><li id="5786" class="mx my hh jp b jq mz jt na jw nb ka nc ke nd ki nq nf ng nh bi translated">“Python 3.0或更高版本”或“R”:任何一种你熟悉的编程语言</li><li id="f68a" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki nq nf ng nh bi translated">面向Python程序员的Jupyter Notebook或Spyder或面向R程序员的R-Studio</li></ul><p id="eb72" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">是的。</strong> <strong class="jp hi">这就是我们所需要的😃</strong></p><p id="0a32" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我的首选组合是<strong class="jp hi"> Python 3.8 </strong>搭配<strong class="jp hi"> Jupyter笔记本</strong>来解决这个问题。</p><p id="a501" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">你可以在我的<a class="ae jm" href="https://github.com/rahul-pednekar/Loan-Prediction-Analyticsvidhya-Hackathon/blob/main/Loan-Prediction-AV.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="jp hi"> GitHub </strong> </a>资源库找到完整的代码。</p></div><div class="ab cl lu lv go lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ha hb hc hd he"><h1 id="46e7" class="ml kt hh bd ku mm oc mo ky mp od mr lc in oe io lf iq of ir li it og iu ll mv bi translated"><strong class="ak">会有什么策略？</strong></h1><h2 id="6c9d" class="ks kt hh bd ku kv kw kx ky kz la lb lc jw ld le lf ka lg lh li ke lj lk ll lm bi translated">将解决方法分成简单的<strong class="ak"> 9步</strong>并依次执行</h2><ol class=""><li id="becb" class="mx my hh jp b jq mz jt na jw nb ka nc ke nd ki ne nf ng nh bi translated">加载基本Python库</li><li id="cc9e" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">在Python环境中加载训练/测试数据集。</li><li id="8815" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">准备提交文件并删除不需要的列。</li><li id="dfd1" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">探索性数据分析(EDA)。</li><li id="00fd" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">估算缺失值。</li><li id="9361" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">特征工程。</li><li id="a17e" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">建立机器学习模型并对测试数据集进行预测</li><li id="582f" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">准备带有最终预测的提交文件</li><li id="d657" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">结论和要点</li></ol><p id="eb9d" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">所以，让我们把手弄脏，投入到代码中😃</p></div><div class="ab cl lu lv go lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ha hb hc hd he"><h2 id="5eb6" class="ks kt hh bd ku kv kw kx ky kz la lb lc jw ld le lf ka lg lh li ke lj lk ll lm bi translated"><strong class="ak">第一步:</strong> <strong class="ak">加载必要的Python库</strong></h2><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">Numpy(线性代数)，pandas(数据帧)，matplotlib和seaborn(绘图)</figcaption></figure></div><div class="ab cl lu lv go lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ha hb hc hd he"><h2 id="3912" class="ks kt hh bd ku kv kw kx ky kz la lb lc jw ld le lf ka lg lh li ke lj lk ll lm bi translated"><strong class="ak">第二步:</strong> <strong class="ak">在Python环境中加载训练/测试数据集</strong></h2><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><p id="11b8" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">当我们在Python环境中加载训练和测试数据集时，我们得到了下面的输出。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">训练集有614行13列，测试集有367行12列(当然少了一列，即我们需要预测的目标变量(<strong class="ak"> Loan_Status </strong>)</figcaption></figure></div><div class="ab cl lu lv go lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ha hb hc hd he"><h2 id="74ee" class="ks kt hh bd ku kv kw kx ky kz la lb lc jw ld le lf ka lg lh li ke lj lk ll lm bi translated"><strong class="ak">步骤3:准备提交文件并删除不需要的列</strong></h2><ul class=""><li id="502f" class="mx my hh jp b jq mz jt na jw nb ka nc ke nd ki nq nf ng nh bi translated">准备提交文件</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">让我们从测试文件中为最终提交创建一个提交数据框架，并使用Loan_ID:</figcaption></figure><ul class=""><li id="06f3" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated">先看数据:</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">让我们从训练数据集中查看任意5个样本行</figcaption></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es oj"><img src="../Images/2f13902f1caa678c3912dc85d47907e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Hn6RxbT-mis2mJesx5Jyg.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">训练数据集-样本行</figcaption></figure><blockquote class="ln lo lp"><p id="883d" class="jn jo lq jp b jq jr ii js jt ju il jv lr jx jy jz ls kb kc kd lt kf kg kh ki ha bi translated">训练数据集列可以分为以下几类:</p><p id="5d23" class="jn jo lq jp b jq jr ii js jt ju il jv lr jx jy jz ls kb kc kd lt kf kg kh ki ha bi translated"><strong class="jp hi">分类栏</strong>:性别(男性/女性)、已婚(是/否)、受抚养人人数(可能值:0、1、2、3+)、教育程度(已毕业/未毕业)、自营职业(否/是)、信用记录(是/否)、财产面积(农村/半城市/城市)和贷款状况(是/否)(即目标变量)</p><p id="008f" class="jn jo lq jp b jq jr ii js jt ju il jv lr jx jy jz ls kb kc kd lt kf kg kh ki ha bi translated"><strong class="jp hi">数字栏:</strong>贷款ID、申请人收入、共同申请人收入、贷款金额、贷款金额期限</p></blockquote><ul class=""><li id="ba77" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated">删除不需要的列</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">“Loan_ID”只是一个数字标识符，并没有增加任何价值。因此，让我们将其从训练和测试数据集中删除。</figcaption></figure></div><div class="ab cl lu lv go lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ha hb hc hd he"><h2 id="a83c" class="ks kt hh bd ku kv kw kx ky kz la lb lc jw ld le lf ka lg lh li ke lj lk ll lm bi translated"><strong class="ak">第四步:</strong> <strong class="ak">探索性数据分析【EDA】</strong></h2><blockquote class="mb"><p id="17f5" class="mc md hh bd me mf mg mh mi mj mk ki dx translated">数字有一个重要的故事要讲。他们依赖你给他们一个声音-斯蒂芬几</p></blockquote><ul class=""><li id="bcec" class="mx my hh jp b jq ok jt ol jw om ka on ke oo ki nq nf ng nh bi translated">让我们从单变量分析开始</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">使用计数图的单变量分析</figcaption></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es op"><img src="../Images/5f8a8a1d2714b06499099c4882bafb96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C6M1IfPCC_7-_rghACzvWg.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">单变量分析—使用计数图的条形图</figcaption></figure><p id="5a59" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">单变量分析观察值:</strong></p><ol class=""><li id="0081" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki ne nf ng nh bi translated">批准的贷款比拒绝的贷款多</li><li id="aa1e" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">男性申请者人数多于女性</li><li id="aff6" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">已婚申请人多于未婚申请人</li><li id="7a8f" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">毕业生比非毕业生多</li><li id="7b66" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">自营职业者少于非自营职业者</li><li id="2b5e" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">大多数房产位于半城市化地区</li><li id="0d02" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">许多申请者都有信用记录</li><li id="7e47" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">受抚养人人数=0的申请人数是最大值。</li></ol><ul class=""><li id="be88" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated">使用Catplot进行双变量分析</li></ul><ol class=""><li id="6d5a" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki ne nf ng nh bi translated">可变已婚与贷款状态</li></ol><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es oq"><img src="../Images/d0be5ba4df6b75db7011fa773123dd0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*lAyNF5ywkvCf6zBhn4ihvA.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">如果你已婚，那么获得贷款批准的机会(71.8%)比你未婚(62.9%)要多。</figcaption></figure><p id="fa87" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">2.教育与贷款_状态</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es or"><img src="../Images/7df0ac49fc518cf414690cc059211e1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0hWyBHoMvTXWjUBOvtPP1w.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">如果你在市区+未毕业+未结婚那么贷款获批的概率就比较小</figcaption></figure><p id="0293" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">3.性别与共同申请人收入</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es os"><img src="../Images/1a0bdb8ede1987f661a810dde8b58757.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*lIBsCS3FHue23IcfelfoFg.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">男性共同申请人的平均收入略高于女性。</figcaption></figure><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ot"><img src="../Images/0dc9e2eabba5ebfa23b88da939ac25e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fXkmvNEeZZnb0JRUGbbsVg.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">在这三个领域，男性的共同申请人收入都高于女性</figcaption></figure><p id="a298" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">4.信用记录与贷款状况</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ou"><img src="../Images/539447f92e21e8d141a2eeb0487f3ba8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*xxvGFbu5apzIYNp-XAqHeA.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">如果信用记录为1，则获得贷款批准的几率(79.6%)比信用记录为0的几率(7.9%)高</figcaption></figure><p id="ba79" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">5.性别与贷款金额</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ov"><img src="../Images/07c33b90aa07e271acb1ef1bd1eea733.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*gPewloZ3J-iUeKDWbYyaKg.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">男性申请贷款金额的平均值略高于女性。</figcaption></figure><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ow"><img src="../Images/5755234a9be65cf50869af3921094ade.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CumPJOcZUgXoLTcYGhMTMw.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">如果你是已婚人士，那么申请贷款的金额会比未婚人士略高</figcaption></figure><p id="8cb8" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">6.贷款状态与贷款金额期限</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ox"><img src="../Images/74f1d5b7c987b13368a342f0504ea049.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*QMtZfoz4e6HqhZNsA_d4Hw.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">最多客户要求360个月的租期</figcaption></figure></div><div class="ab cl lu lv go lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ha hb hc hd he"><h2 id="30f5" class="ks kt hh bd ku kv kw kx ky kz la lb lc jw ld le lf ka lg lh li ke lj lk ll lm bi translated"><strong class="ak">步骤5:估算缺失值</strong></h2><ol class=""><li id="179b" class="mx my hh jp b jq mz jt na jw nb ka nc ke nd ki ne nf ng nh bi translated">识别训练和测试数据集中缺失的值</li></ol><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">按列名查找缺失值的总和</figcaption></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es oy"><img src="../Images/eda974b6251af22ae3bb2015f73b0db8.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*OyccZs8fitkbveKYx151KQ.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">共有7列在训练数据中具有空值</figcaption></figure><p id="0384" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">2.让我们开始在训练和测试中输入缺失值</p><ul class=""><li id="46a7" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated"><strong class="jp hi">栏:已婚</strong></li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">用已婚列的模式填充空值</figcaption></figure><ul class=""><li id="5ae7" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated"><strong class="jp hi">栏:家眷</strong></li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">对于训练数据集:如果贷款状态为1，则dependent = 2，否则dependent=1，对于测试数据集:如果Credit_History为1，则dependent = 2，否则dependent=1</figcaption></figure><ul class=""><li id="3bcb" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated"><strong class="jp hi">栏:信用记录</strong></li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">对于训练数据集:如果贷款状态为1，则Credit_History = 1，否则Credit_History=0，对于测试数据集，使用测试的Credit_History列的模式填充空值</figcaption></figure><ul class=""><li id="81d6" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated"><strong class="jp hi">栏:性别</strong></li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">用性别列的模式填充空值</figcaption></figure><ul class=""><li id="5c5b" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated"><strong class="jp hi">栏:个体户</strong></li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">如果Credit_History为1，则估算自雇=否，否则为是</figcaption></figure><ul class=""><li id="4747" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated"><strong class="jp hi">列:Loan _ Amount _ Term:</strong>Loan _ Amount _ Term取决于性别、已婚、教育、自雇和受抚养人列。因此，我们将按照上面的列对它们进行分组，并估算中值。如果中值为空，那么我们将估算整个Loan_Amount_Term列的中值。</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><ul class=""><li id="ed53" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated"><strong class="jp hi">列:贷款金额:</strong>贷款金额取决于房产_面积、性别、已婚、教育、自雇和家属列。因此，我们将按照上面的列对它们进行分组，并输入中值。如果中位数为空，那么我们将估算整个LoanAmount列的中位数。</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><p id="8aa5" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">检查是否有丢失的值</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es oz"><img src="../Images/64126b2a8a0e995315348d588c9d1b89.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*_zPvNDNigqBxxKyPjF0eTg.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">所有缺失值都是估算的</figcaption></figure></div><div class="ab cl lu lv go lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ha hb hc hd he"><h2 id="442e" class="ks kt hh bd ku kv kw kx ky kz la lb lc jw ld le lf ka lg lh li ke lj lk ll lm bi translated"><strong class="ak">第六步:特征工程</strong></h2><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es pa"><img src="../Images/9d08cbd9de47939e0fa99acf07efabe9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*NMl-zam4p9l9CU-oH5LUiw.jpeg"/></div></figure><p id="f00d" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">特征工程是我最喜欢的话题之一，它是机器世界中的一种人情味😃</p><ul class=""><li id="454a" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated">标签编码分类变量</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">机器学习算法理解数字而不是文本，因此让我们使用标签编码将分类数据转换成数字。</figcaption></figure><ul class=""><li id="b905" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated">根据问题描述，所有客户申请的贷款金额都是以千为单位的，所以让LoanAmount列乘以1000</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><ul class=""><li id="818c" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated">让我们结合训练和测试数据集</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><ul class=""><li id="b6fc" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated">让我们向数据集添加8个新要素:</li></ul><ol class=""><li id="7c3e" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki ne nf ng nh bi translated">总收入:</li></ol><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><p id="eefb" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">2.电磁干扰:</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><p id="54ab" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">3.附加功能:</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><p id="32bc" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">4.数字列的Bin格式</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">让我们为这三个连续的变量建立箱</figcaption></figure><p id="0c97" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">5.删除不需要的列</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><p id="2535" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">让我们看看新创建的要素的组合数据集的形状</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><p id="99ba" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我们增加了8个新功能，我们的列数从12个增加到20个</p></div><div class="ab cl lu lv go lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ha hb hc hd he"><h2 id="c454" class="ks kt hh bd ku kv kw kx ky kz la lb lc jw ld le lf ka lg lh li ke lj lk ll lm bi translated"><strong class="ak">第七步:</strong>建立机器学习模型&amp;对测试数据集进行预测</h2><ul class=""><li id="aa7c" class="mx my hh jp b jq mz jt na jw nb ka nc ke nd ki nq nf ng nh bi translated">在接下来的步骤中，我们将从组合数据集中分离训练和测试数据集，使用get_dummies( ) &amp; drop目标变量(Loan_Status)对分类变量进行标签编码，并将其从训练数据集中复制到变量“y”</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><ul class=""><li id="0b65" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated">让我们使用ExtraTreesClassifier检查数据集中所有20个要素的要素重要性</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es pb"><img src="../Images/4474b5f580df56192835d101b3c28995.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LZ29pcf1iWhtVVgcCAuOrA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">信用历史和信贷历史收入总和是两个最重要的特征</figcaption></figure><ul class=""><li id="fdb2" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated">训练-测试分割:让我们对训练数据集进行(80:20)分割</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><ul class=""><li id="fc8a" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated">数据的标准缩放:我将使用StandardScaler在(-1到1)之间缩放数据(您也可以尝试RobustScalar或MinMaxScalar)</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><ul class=""><li id="0418" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated">机器学习算法:我已经尝试了多种机器学习算法，包括XGBOOST、CATBOOST和LGBM，但是我用“逻辑回归”获得了最好的准确性……是的，有时基本算法会给你最好的结果😃</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><p id="a1cb" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">在使用<strong class="jp hi">逻辑回归模型</strong>的验证数据集上，我们得到了<strong class="jp hi"> 78% </strong>的准确率</p><ul class=""><li id="4dfb" class="mx my hh jp b jq jr jt ju jw nn ka no ke np ki nq nf ng nh bi translated">让我们评估混淆矩阵</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure><p id="ad2f" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">混淆矩阵结果</strong>:在来自验证数据集的<strong class="jp hi"> 123 </strong>个客户中，模型以<strong class="jp hi"> 100%的准确率</strong>预测了<strong class="jp hi"> 96 </strong> (79+17)个客户，但是未能预测出<strong class="jp hi"> 27 </strong> (22+5)个客户的正确贷款状态。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es pc"><img src="../Images/50ad67c486400cb73ba05c8ccbd8abde.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*9p-rCxvDKQXmgFcxxVT-vw.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">混淆矩阵</figcaption></figure></div><div class="ab cl lu lv go lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ha hb hc hd he"><h2 id="d8df" class="ks kt hh bd ku kv kw kx ky kz la lb lc jw ld le lf ka lg lh li ke lj lk ll lm bi translated"><strong class="ak">步骤8:准备最终预测提交文件</strong></h2><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="oh oi l"/></div></figure></div><div class="ab cl lu lv go lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ha hb hc hd he"><h2 id="889d" class="ks kt hh bd ku kv kw kx ky kz la lb lc jw ld le lf ka lg lh li ke lj lk ll lm bi translated"><strong class="ak">第9步:结论和要点</strong></h2><ol class=""><li id="246e" class="mx my hh jp b jq mz jt na jw nb ka nc ke nd ki ne nf ng nh bi translated">最终提交的测试数据集为我赢得了80.55%的准确率&amp;<strong class="jp hi">截止到2011年2月20日，我在5250名</strong>参与者中排名第122(前2%) </li><li id="c492" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">新增功能有助于提高准确性</li><li id="a759" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">有时添加新功能可能会降低准确性，因此需要谨慎选择新功能。</li><li id="2583" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">使用<strong class="jp hi"> XGBOOST和CATBOOST </strong>(其通常比任何其他算法执行得更好)以及<strong class="jp hi">超参数调整&amp; </strong>基于树的模型，如<strong class="jp hi">随机森林</strong>、<strong class="jp hi">决策树分类算法</strong>不能匹配简单的<strong class="jp hi">逻辑回归</strong>的精度</li><li id="a01b" class="mx my hh jp b jq ni jt nj jw nk ka nl ke nm ki ne nf ng nh bi translated">我前面还有121名参与者，这意味着还有提高准确性的空间。</li></ol><p id="bc22" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">干杯，感谢阅读！😃</p><p id="ace8" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">你可以在我的<a class="ae jm" href="https://github.com/rahul-pednekar/Loan-Prediction-Analyticsvidhya-Hackathon/blob/main/Loan-Prediction-AV.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="jp hi"> GitHub </strong> </a>库中找到完整的Python代码。</p><blockquote class="ln lo lp"><p id="3639" class="jn jo lq jp b jq jr ii js jt ju il jv lr jx jy jz ls kb kc kd lt kf kg kh ki ha bi translated">如有任何疑问，请随时联系我的<a class="ae jm" href="https://www.linkedin.com/in/pednekar-rahul/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp hi"> LinkedIn </strong> </a> &amp;我将竭诚为您服务。</p></blockquote><p id="16d2" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><em class="lq">跟我上</em><a class="ae jm" href="https://www.linkedin.com/in/pednekar-rahul/" rel="noopener ugc nofollow" target="_blank"><em class="lq">LinkedIn</em></a><em class="lq"/><a class="ae jm" rel="noopener" href="/@rahul.pednekar"><em class="lq">Medium</em></a><em class="lq">和</em> <a class="ae jm" href="https://www.kaggle.com/rahulpednekar" rel="noopener ugc nofollow" target="_blank"> <em class="lq"> Kaggle </em> </a></p></div></div>    
</body>
</html>