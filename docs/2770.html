<html>
<head>
<title>Smart Water: Data Labeling with Active Learning And H2O.ai</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">智能水:主动学习和H2O.ai的数据标签</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/smart-water-data-labeling-with-active-learning-and-h2o-ai-c97349c0ba09?source=collection_archive---------15-----------------------#2021-05-16">https://medium.com/analytics-vidhya/smart-water-data-labeling-with-active-learning-and-h2o-ai-c97349c0ba09?source=collection_archive---------15-----------------------#2021-05-16</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/></div><div class="ab cl ie if go ig" role="separator"><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij"/></div><div class="ha hb hc hd he"><h1 id="d3d5" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">直觉</h1><p id="40ba" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">数据是人工智能的食物。对于机器学习或监督学习，黄金标签是模型识别数据中模式的关键。然而，在现实世界的数据中，通常很难获得大量的标注数据，例如搜索相关性、新闻话题、自动驾驶等。最近，Angrew Ng做了一个关于<a class="ae kh" href="https://www.youtube.com/watch?v=06-AZXmwHjo" rel="noopener ugc nofollow" target="_blank"> <em class="ki"> MLOps:从以模型为中心到以数据为中心的AI </em> </a>的演讲，他在演讲中提到了从大数据到好数据的想法。良好的数据被一致地定义，并涵盖重要的案例。它有来自生产数据的及时反馈，并且大小合适。</p><p id="71ff" class="pw-post-body-paragraph jj jk hh jl b jm kj jo jp jq kk js jt ju kl jw jx jy km ka kb kc kn ke kf kg ha bi translated">所以现在的问题是如何获得高质量的数据。众所周知，获取未标记的数据相对容易，但是标记大量的数据是昂贵的:它需要人类开始基于特征给出正确的判断，并且需要一些领域知识。有一些方法比随机选择未标记的数据更好，主动学习只是其中一种，帮助你标记样本，可以为模型提供更多的信息。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es ko"><img src="../Images/1012cbfba6d4abdc13de84c8573d1ce0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l9vkny3N10OjXpGqIHoGYw.png"/></div></div></figure><p id="3add" class="pw-post-body-paragraph jj jk hh jl b jm kj jo jp jq kk js jt ju kl jw jx jy km ka kb kc kn ke kf kg ha bi translated">在这个项目中，我们创建了一个平台，用户可以从本地设备上传未标记的数据，或AWS S3桶，我们使用主动学习和H2O.ai来智能地选择哪些样本应该首先被标记。这可以显著降低数据标记成本，并帮助用户为他们的机器学习模型获得高质量的数据。</p><h1 id="5329" class="il im hh bd in io la iq ir is lb iu iv iw lc iy iz ja ld jc jd je le jg jh ji bi translated">主动学习</h1><p id="1534" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">在深入我们的解决方案之前，让我解释一下主动学习是如何工作的，以及为什么它可以更好地对要标记的未标记数据进行优先排序。</p><p id="be9e" class="pw-post-body-paragraph jj jk hh jl b jm kj jo jp jq kk js jt ju kl jw jx jy km ka kb kc kn ke kf kg ha bi translated">有三种情况可以使用主动学习。</p><ul class=""><li id="4e01" class="lf lg hh jl b jm kj jq kk ju lh jy li kc lj kg lk ll lm ln bi translated">成员查询合成:生成的样本被发送到oracle进行标记。</li><li id="fa79" class="lf lg hh jl b jm lo jq lp ju lq jy lr kc ls kg lk ll lm ln bi translated">基于流的选择性采样:每个样本被单独考虑。</li><li id="4992" class="lf lg hh jl b jm lo jq lp ju lq jy lr kc ls kg lk ll lm ln bi translated">基于池的采样:样本从未标记的数据池中选择，用于标记。</li></ul><p id="3681" class="pw-post-body-paragraph jj jk hh jl b jm kj jo jp jq kk js jt ju kl jw jx jy km ka kb kc kn ke kf kg ha bi translated">对于这个项目，我们使用基于池的抽样。从有限的标记数据开始，我们训练模型，然后对所有未标记的数据进行预测。基于这些预测，我们可以使用一些查询策略框架来选择具有某些属性的样本，这告诉我们这些样本可以对模型的学习过程做出更多贡献。然后在对待标记的样本进行标记后，再对模型进行重新训练，对其他未标记的数据进行预测，反复重复同样的过程，直到得到足够多的已标记数据，或者模型性能变得足够好。</p><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es lt"><img src="../Images/3e7e9e34a7bedc080225f6fe5f9016e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*TZiXKAJlUtcV9jaxs4K7qw.png"/></div><figcaption class="lu lv et er es lw lx bd b be z dx translated">主动学习循环</figcaption></figure><p id="ec8c" class="pw-post-body-paragraph jj jk hh jl b jm kj jo jp jq kk js jt ju kl jw jx jy km ka kb kc kn ke kf kg ha bi translated">为了选择样本，我们选择具有高度不确定性的样本，因为模型对它们感到困惑，如果我们首先标记它们，我们可以更好地监督模型。以下是一些计算不确定性的流行方法:</p><ul class=""><li id="1d28" class="lf lg hh jl b jm kj jq kk ju lh jy li kc lj kg lk ll lm ln bi translated">边际抽样</li></ul><p id="2086" class="pw-post-body-paragraph jj jk hh jl b jm kj jo jp jq kk js jt ju kl jw jx jy km ka kb kc kn ke kf kg ha bi translated">我们选择在两个最高类别概率之间具有最低差异的k个样本，即，对于其模型对于单个类别非常确定的样本，将给出较高的数字，而对于其类别概率非常相似的样本，将给出较低的数字。例如，三类分类的两个预测是[0.9，0.06，0.04]和[0.6，0.3，0.1]。显然，该模型比第二个样本更了解第一个样本，因为它可以将样本从一个类别分离到其他类别。</p><pre class="kp kq kr ks fd ly lz ma mb aw mc bi"><span id="744b" class="md im hh lz b fi me mf l mg mh">def marginSample():<br/>    d = {} <br/>    for i in range(len(X_pool)):<br/>        probs = clf.predict_proba(X_pool[i].reshape(1, -1))<br/>        sorted_probs = sorted(probs[0],reverse=True)<br/>         <br/>        margin = sorted_probs[0]-sorted_probs[1]<br/>        d[i] = margin<br/>    idx = sorted(d, key=d.get,reverse=True)[0]      <br/>    return idx</span></pre><ul class=""><li id="c305" class="lf lg hh jl b jm kj jq kk ju lh jy li kc lj kg lk ll lm ln bi translated">熵选择</li></ul><p id="8140" class="pw-post-body-paragraph jj jk hh jl b jm kj jo jp jq kk js jt ju kl jw jx jy km ka kb kc kn ke kf kg ha bi translated">我们选择具有最高熵的“k”个样本，即具有高不确定性。</p><pre class="kp kq kr ks fd ly lz ma mb aw mc bi"><span id="1fdf" class="md im hh lz b fi me mf l mg mh"># pick sample based on maximum entropy<br/>def entropy(x):<br/>    return -x*np.log(x+ 1e-10)<br/>def max_entropy():<br/>    d = collections.defaultdict(list) <br/>    for i in range(len(X_pool)):<br/>        for _ in range(5):<br/>                  d[i].append(entropy(clf.predict_proba(X_pool[i].reshape(1, -1))))<br/>        d[i] = np.mean(d[i])<br/>    idx = sorted(d, key=d.get,reverse = True)[0]<br/>    return idx, X_pool[idx]</span></pre><ul class=""><li id="8dfd" class="lf lg hh jl b jm kj jq kk ju lh jy li kc lj kg lk ll lm ln bi translated">最不自信</li></ul><p id="3441" class="pw-post-body-paragraph jj jk hh jl b jm kj jo jp jq kk js jt ju kl jw jx jy km ka kb kc kn ke kf kg ha bi translated">我们选择置信度最低的“k”个样本。在二元或多类分类问题中，我们对属于每一类的概率进行预测。我们可以用概率的最大值作为确定度，用k个最小的最大值作为待标注的样本。</p><pre class="kp kq kr ks fd ly lz ma mb aw mc bi"><span id="7eec" class="md im hh lz b fi me mf l mg mh">def least_confidence():<br/>    d = {}<br/>    for i in range(len(X_pool)):<br/>        probs = clf.predict_proba(X_pool[i].reshape(1, -1))<br/>        d[i] = max(probs)<br/>    idx = sorted(d, key=d.get)[0]<br/>    return idx</span></pre><h1 id="4b73" class="il im hh bd in io la iq ir is lb iu iv iw lc iy iz ja ld jc jd je le jg jh ji bi translated">解决方案架构</h1><p id="c06b" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">我们允许用户从本地设备和S3自动气象站上传数据集。在明确了任务的类型和目标列之后，平台将根据上述不确定性对未标记的样本进行优先排序。然后，用户可以在平台内标记数据，并通过重新训练模型获得更多未标记的数据。在获得足够的数据或性能达到某个阈值后，用户可以下载标记的数据，并回去训练自己的模型。</p><p id="a18d" class="pw-post-body-paragraph jj jk hh jl b jm kj jo jp jq kk js jt ju kl jw jx jy km ka kb kc kn ke kf kg ha bi translated">在我们的平台中，我们为不同的任务使用不同的算法。</p><ul class=""><li id="71c9" class="lf lg hh jl b jm kj jq kk ju lh jy li kc lj kg lk ll lm ln bi translated">对于表格预测，我们在分类和回归问题中都使用了H2O.ai中的随机森林。</li><li id="f889" class="lf lg hh jl b jm lo jq lp ju lq jy lr kc ls kg lk ll lm ln bi translated">对于NLP标注，我们使用Hugging Face开发的transformers包作为特征提取器，将文本转换为嵌入，嵌入是文本中所有单词嵌入的平均值。然后，我们应用分类模型来选择高不确定性样本</li><li id="f90a" class="lf lg hh jl b jm lo jq lp ju lq jy lr kc ls kg lk ll lm ln bi translated">对于图像标注，我们正在积极开发..</li></ul><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mi"><img src="../Images/e548cf77579d84b4b6e492ef66606746.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ARINQE0uuEQctRNpheJadg.png"/></div></div><figcaption class="lu lv et er es lw lx bd b be z dx translated">智能水务工作流程</figcaption></figure><p id="9b32" class="pw-post-body-paragraph jj jk hh jl b jm kj jo jp jq kk js jt ju kl jw jx jy km ka kb kc kn ke kf kg ha bi translated">我们用streamlit构建平台，用Heroku部署平台。</p><h1 id="7715" class="il im hh bd in io la iq ir is lb iu iv iw lc iy iz ja ld jc jd je le jg jh ji bi translated">演示</h1><figure class="kp kq kr ks fd kt er es paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="er es mj"><img src="../Images/49f55b01a50ebc603cf07e24762b4d6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*re5YRiwcNR1a8lFKGPgguA.png"/></div></div></figure><figure class="kp kq kr ks fd kt er es paragraph-image"><div class="er es mk"><img src="../Images/68e1c8608d2c4a4f2d12186e9f5450b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*vJm-Ef80jWBnQ7xQ_OzzbQ.png"/></div></figure><h1 id="5d16" class="il im hh bd in io la iq ir is lb iu iv iw lc iy iz ja ld jc jd je le jg jh ji bi translated">后续步骤</h1><p id="fa84" class="pw-post-body-paragraph jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">在目前的平台中，我们有许多可以改进的地方。我们可以允许用户上传定制的模型进行主动学习。我们可以支持更多类型的任务，并且可以优化计算资源以实现更快的标记。</p></div></div>    
</body>
</html>