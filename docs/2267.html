<html>
<head>
<title>KDE vs PDF in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的KDE vs PDF</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/kde-vs-pdf-in-python-53ffbf578995?source=collection_archive---------4-----------------------#2021-04-15">https://medium.com/analytics-vidhya/kde-vs-pdf-in-python-53ffbf578995?source=collection_archive---------4-----------------------#2021-04-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0064" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">今天我用Python绘制了概率密度函数和核密度估计。</p><p id="237f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了首先理解概率密度函数或PDF，我们需要先看看<a class="ae jd" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html" rel="noopener ugc nofollow" target="_blank"> scipy.stats.norm </a>的文档。</p><h1 id="dd6b" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">scipy.stats.norm</h1><blockquote class="kc kd ke"><p id="a3ec" class="if ig kf ih b ii ij ik il im in io ip kg ir is it kh iv iw ix ki iz ja jb jc hb bi translated">正态连续随机变量。</p><p id="78c7" class="if ig kf ih b ii ij ik il im in io ip kg ir is it kh iv iw ix ki iz ja jb jc hb bi translated">location ( <code class="du kj kk kl km b">loc</code>)关键字指定了平均值。scale ( <code class="du kj kk kl km b">scale</code>)关键字指定标准偏差。</p></blockquote><p id="44f4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">给定一个数据帧和该数据帧中的一列，我们可以使用以下公式计算变量的概率密度函数:</p><pre class="kn ko kp kq fd kr km ks kt aw ku bi"><span id="5db8" class="kv jf hi km b fi kw kx l ky kz">from scipy import stats</span><span id="435b" class="kv jf hi km b fi la kx l ky kz">data = df['column']<br/>loc = data.mean()<br/>scale = data.std()</span><span id="1012" class="kv jf hi km b fi la kx l ky kz">pdf = stats.norm.pdf(data, loc=loc, scale=scale)</span></pre><p id="b09c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还可以使用stats.norm来查找事件发生的概率。使用累积分布函数，找出点p的曲线下的面积，我们可以找到p出现的概率。如果我们需要经过点p的曲线下的面积，我们可以用1-p，或者事件不会发生的概率。</p><pre class="kn ko kp kq fd kr km ks kt aw ku bi"><span id="2e5b" class="kv jf hi km b fi kw kx l ky kz">prob = stats.norm(loc=loc, scale=scale)<br/>event = prob.cdf(point)<br/>event2 = 1 - prob.cdf(point)</span><span id="04c4" class="kv jf hi km b fi la kx l ky kz"># Write the probability as a percentage<br/>event_pct = str(round(event*100, 1)) + '%'<br/>print('The probability that the event will occur is: ', event_pct)</span></pre><h1 id="5213" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated"><strong class="ak"> seaborn.lineplot </strong></h1><p id="27bd" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">使用<a class="ae jd" href="https://seaborn.pydata.org/generated/seaborn.lineplot.html" rel="noopener ugc nofollow" target="_blank"> seaborn.lineplot </a>，我们可以绘制如下所示的PDF:</p><pre class="kn ko kp kq fd kr km ks kt aw ku bi"><span id="82f6" class="kv jf hi km b fi kw kx l ky kz">import seaborn as sns</span><span id="2938" class="kv jf hi km b fi la kx l ky kz">fig, ax = plt.subplots()<br/>ax = sns.lineplot(x=data, y=pdf, ax=ax)<br/>plt.show()</span></pre><h1 id="ee86" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">用例</h1><p id="1748" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">数据取自我的<a class="ae jd" href="https://github.com/kaseymallette/blackjack" rel="noopener ugc nofollow" target="_blank">二十一点项目</a>，其中shoe_df是一个数据帧，包含关于2880双六张二十一点牌的信息。我找到了玩家赢、玩家输、手推和玩家数(赢的手减去输的手)的PDF，然后绘制了所有四个PDF。</p><pre class="kn ko kp kq fd kr km ks kt aw ku bi"><span id="2c31" class="kv jf hi km b fi kw kx l ky kz">def plot_pdf(x, ax, xlabel, title, color):<br/>    'Creates subplots of probability density functions'</span><span id="39d6" class="kv jf hi km b fi la kx l ky kz">    data = shoe_df[x]<br/>    loc = data.mean()<br/>    scale = data.std()<br/>    pdf = stats.norm.pdf(data, loc=loc, scale=scale)</span><span id="e6ca" class="kv jf hi km b fi la kx l ky kz">    # Plot pdf using sns.lineplot<br/>    ax = sns.lineplot(x=data, y=pdf, color=color, ax=ax)</span><span id="bc3a" class="kv jf hi km b fi la kx l ky kz">    # Change face color and grid lines<br/>    ax.set_facecolor('white')<br/>    ax.grid(which='major', linewidth='0.2', color='gray')</span><span id="3c6b" class="kv jf hi km b fi la kx l ky kz">    # Set title, x and y labels<br/>    ax.set_title(title)<br/>    ax.set_xlabel(xlabel)<br/>    ax.set_ylabel('Probability Density')</span><span id="dfc3" class="kv jf hi km b fi la kx l ky kz"><br/># Create four subplots<br/>fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2,2, figsize=(15,12))</span><span id="8ae1" class="kv jf hi km b fi la kx l ky kz"># Find the pdf's of player win, loss, push, and count<br/>plot_pdf('player_win', ax1, 'Hands won', 'PDF of Hands Won', 'purple')<br/>plot_pdf('player_loss', ax2, 'Hands lost', 'PDF of Hands Lost', 'red')<br/>plot_pdf('push', ax3, 'Hands pushed', 'PDF of Hands Pushed', 'orange')<br/>plot_pdf('player_count', ax4, 'Player count', 'PDF of Player Count', 'blue)</span><span id="6929" class="kv jf hi km b fi la kx l ky kz"># Show plots<br/>plt.show()</span></pre><figure class="kn ko kp kq fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lg"><img src="../Images/428bde2b4e0d3db25ba5b795346fef39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bj9trieMbK10hqsh0-2V6Q.png"/></div></div></figure><h1 id="2d17" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">seaborn.kdeplot</h1><p id="96f5" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">我们可以使用<a class="ae jd" href="https://seaborn.pydata.org/generated/seaborn.kdeplot.html" rel="noopener ugc nofollow" target="_blank"> seaborn.kdeplot </a>来绘制KDE的PDF，以获得更平滑的曲线。</p><blockquote class="kc kd ke"><p id="c8e6" class="if ig kf ih b ii ij ik il im in io ip kg ir is it kh iv iw ix ki iz ja jb jc hb bi translated">核密度估计(KDE)图是一种可视化数据集中观察值分布的方法，类似于直方图。KDE使用一维或多维的连续概率密度曲线来表示数据。</p></blockquote><pre class="kn ko kp kq fd kr km ks kt aw ku bi"><span id="af12" class="kv jf hi km b fi kw kx l ky kz">def plot_kde(x, ax, xlabel, title, color):<br/>    'Creates subplots of kernel density estimations'</span><span id="b8fa" class="kv jf hi km b fi la kx l ky kz">    data = shoe_df[x]<br/>    loc = data.mean()<br/>    scale = data.std()<br/>    pdf = stats.norm.pdf(data, loc=loc, scale=scale)</span><span id="0261" class="kv jf hi km b fi la kx l ky kz">    # Plot pdf as a kde<br/>    ax = <strong class="km hj">sns.kdeplot</strong>(x=data, y=pdf, color=color, <strong class="km hj">fill=True</strong>, ax=ax)</span><span id="c407" class="kv jf hi km b fi la kx l ky kz">    # Change face color and grid lines<br/>    ax.set_facecolor('white')<br/>    ax.grid(which='major', linewidth='0.2', color='gray')</span><span id="7084" class="kv jf hi km b fi la kx l ky kz">    # Set title, x and y labels<br/>    ax.set_title(title)<br/>    ax.set_xlabel(xlabel)<br/>    ax.set_ylabel('Probability Density')</span><span id="3b98" class="kv jf hi km b fi la kx l ky kz"><br/># Create subplots<br/>fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2,2, figsize=(15,12))</span><span id="c429" class="kv jf hi km b fi la kx l ky kz"># Find the kde's of player win, loss, push, and count<br/>plot_kde('player_win', ax1, 'Hands won', 'PDF of Hands Won', 'purple')<br/>plot_kde('player_loss', ax2, 'Hands lost', 'PDF of Hands Lost', 'red')<br/>plot_kde('push', ax3, 'Hands pushed', 'PDF of Hands Pushed', 'orange')<br/>plot_kde('player_count', ax4, 'Player count', 'PDF of Player Count', 'blue)</span><span id="e1bd" class="kv jf hi km b fi la kx l ky kz"># Show plots<br/>plt.show()</span></pre><figure class="kn ko kp kq fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lo"><img src="../Images/0a43c5d3c28a030a45d883720a36c39a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oUeR3XGJGJCEn0up7xM5iQ.png"/></div></div></figure><h1 id="7bbf" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">彩色地图</h1><p id="0b07" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">我们可以改变KDE的色彩映射表以获得不同的绘图效果。matplotlib中关于色彩映射表的文档可以在<a class="ae jd" href="https://matplotlib.org/stable/tutorials/colors/colormaps.html" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><pre class="kn ko kp kq fd kr km ks kt aw ku bi"><span id="2a60" class="kv jf hi km b fi kw kx l ky kz">def plot_kde(x, ax, xlabel, title):<br/>    'Creates subplots of kernel density estimations'</span><span id="f83a" class="kv jf hi km b fi la kx l ky kz">    data = shoe_df[x]<br/>    loc = data.mean()<br/>    scale = data.std()<br/>    pdf = stats.norm.pdf(data, loc=loc, scale=scale)</span><span id="559b" class="kv jf hi km b fi la kx l ky kz">    # Plot pdf as a kde<br/>    ax = sns.kdeplot(x=data, y=pdf, fill=True, <br/>                     <strong class="km hj">cmap='coolwarm'</strong>, ax=ax)</span><span id="f243" class="kv jf hi km b fi la kx l ky kz">    # Change face color and grid lines<br/>    ax.set_facecolor('white')<br/>    ax.grid(which='major', linewidth='0.2', color='gray')</span><span id="1b27" class="kv jf hi km b fi la kx l ky kz">    # Set title, x and y labels<br/>    ax.set_title(title)<br/>    ax.set_xlabel(xlabel)<br/>    ax.set_ylabel('Probability Density')<br/></span><span id="6932" class="kv jf hi km b fi la kx l ky kz"># Create subplots<br/>fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2,2, figsize=(15,12))</span><span id="945e" class="kv jf hi km b fi la kx l ky kz"># Find the kde's of player win, loss, push, and count<br/>plot_kde('player_win', ax1, 'Hands won', 'PDF of Hands Won')<br/>plot_kde('player_loss', ax2, 'Hands lost', 'PDF of Hands Lost')<br/>plot_kde('push', ax3, 'Hands pushed', 'PDF of Hands Pushed')<br/>plot_kde('player_count', ax4, 'Player count', 'PDF of Player Count')</span><span id="89d2" class="kv jf hi km b fi la kx l ky kz"># Show plots<br/>plt.show()</span></pre><figure class="kn ko kp kq fd lh er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lo"><img src="../Images/06d8abe85f47aea73ab944de5e4a5342.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uP7CJA4AVASP_98s7SF0Kg.png"/></div></div></figure><p id="b03e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我希望这有助于理解概率密度函数和核密度估计，也有助于你制作一些非常酷的图表！</p><p id="9577" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更多关于使用数据的文章，请在LinkedIn上联系我。</p><p id="cac3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">编码快乐！</p></div></div>    
</body>
</html>