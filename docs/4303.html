<html>
<head>
<title>Covid-19 Protein Analysis using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python进行新冠肺炎蛋白质分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/covid-19-protein-analysis-with-python-82bccb607b98?source=collection_archive---------4-----------------------#2021-09-20">https://medium.com/analytics-vidhya/covid-19-protein-analysis-with-python-82bccb607b98?source=collection_archive---------4-----------------------#2021-09-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="acd7" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">用新冠肺炎刺突蛋白学习蛋白质分析的基础知识(教程的第1部分，共5部分)</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/36eb28d46be9672b8e463f69465194c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ub7qKlGRA_R03Afl.jpg"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">来源:<a class="ae jm" href="http://www.orchardsoft.com" rel="noopener ugc nofollow" target="_blank">果园软件</a></figcaption></figure><h1 id="dd11" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">介绍</h1><p id="69f0" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">蛋白质组学是对生物系统中蛋白质的研究。典型地，在这个领域中，研究蛋白质的结构、功能和相互作用。但是这个领域最重要的目标之一是描述蛋白质的三维结构。在接下来的文章中，我们将探索分析新冠肺炎刺突蛋白三维结构的方法。但在我们开始之前，让我们先了解我们正在使用的DNA序列，并使用python进行蛋白质合成。</p></div><div class="ab cl lb lc go ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ha hb hc hd he"><h1 id="2e01" class="jn jo hh bd jp jq li js jt ju lj jw jx in lk io jz iq ll ir kb it lm iu kd ke bi translated">设置环境</h1><ol class=""><li id="81f6" class="ln lo hh kh b ki kj kl km ko lp ks lq kw lr la ls lt lu lv bi translated">下载<a class="ae jm" href="https://docs.anaconda.com/anaconda/install/windows/" rel="noopener ugc nofollow" target="_blank">蟒蛇包</a></li><li id="581e" class="ln lo hh kh b ki lw kl lx ko ly ks lz kw ma la ls lt lu lv bi translated">下载Python 3</li><li id="280c" class="ln lo hh kh b ki lw kl lx ko ly ks lz kw ma la ls lt lu lv bi translated">在这里安装来自<a class="ae jm" href="https://anaconda.org/anaconda/biopython" rel="noopener ugc nofollow" target="_blank">的Biopython】</a></li><li id="a447" class="ln lo hh kh b ki lw kl lx ko ly ks lz kw ma la ls lt lu lv bi translated">打开Jupyter笔记本</li></ol><h1 id="f657" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">下载数据</h1><p id="32b5" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">为了这个演示，我们需要新冠肺炎基因组的FASTA序列。使用下面的<strong class="kh hi"> wget </strong>命令下载项目数据:</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="9078" class="mg jo hh mc b fi mh mi l mj mk"># Get the data<br/>!wget <a class="ae jm" href="https://raw.githubusercontent.com/VarunSendilraj/Bioinformatics/main/covid19_basic%20_protien_analysis/sequence.fasta" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/VarunSendilraj/Bioinformatics/main/covid19_basic _protien_analysis/sequence.fasta</a></span></pre><p id="6427" class="pw-post-body-paragraph kf kg hh kh b ki ml ii kk kl mm il kn ko mn kq kr ks mo ku kv kw mp ky kz la ha bi translated">如果您在widows或mac上，<strong class="kh hi"> wget </strong>命令将不起作用，因此请使用<strong class="kh hi"> urlib </strong>库:</p><p id="1812" class="pw-post-body-paragraph kf kg hh kh b ki ml ii kk kl mm il kn ko mn kq kr ks mo ku kv kw mp ky kz la ha bi translated"><strong class="kh hi"> Windows/Mac: </strong></p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="9b7f" class="mg jo hh mc b fi mh mi l mj mk">import urllib.request<br/>url = '<a class="ae jm" href="https://raw.githubusercontent.com/VarunSendilraj/Bioinformatics/main/covid19_basic%20_protien_analysis/sequence.fasta'" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/VarunSendilraj/Bioinformatics/main/covid19_basic%20_protien_analysis/sequence.fasta'</a><br/>filename = 'sequence.fasta'<br/>urllib.request.urlretrieve(url, filename)</span></pre><h1 id="f7ce" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">了解FASTA文件</h1><p id="e932" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">让我们从导入<strong class="kh hi"> Biopython </strong>库并解析基因组文件开始我们的分析:</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="c289" class="mg jo hh mc b fi mh mi l mj mk">import Bio<br/>from Bio import SeqIO # library used to parse the file<br/>from Bio import Seq</span><span id="a61d" class="mg jo hh mc b fi mq mi l mj mk">covid19 = SeqIO.parse('sequence.fasta', 'fasta')</span></pre><p id="afce" class="pw-post-body-paragraph kf kg hh kh b ki ml ii kk kl mm il kn ko mn kq kr ks mo ku kv kw mp ky kz la ha bi translated">在一个典型的FASTA文件中，除了感兴趣的序列之外，还有多个其他记录存储在那里。让我们遍历FASTA文件，分离并打印出感兴趣的信息:</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="91b7" class="mg jo hh mc b fi mh mi l mj mk">for rec in covid19:<br/>    seq = rec.seq  #genome sequence<br/>    print(rec.description)<br/>    print(seq[:10])<br/>    print(seq.alphabet)</span><span id="3199" class="mg jo hh mc b fi mq mi l mj mk">--------------------------------------------------------------------<br/><strong class="mc hi">#expected output:</strong></span><span id="78a9" class="mg jo hh mc b fi mq mi l mj mk">NC_045512.2 Severe acute respiratory syndrome coronavirus 2 isolate Wuhan-Hu-1, complete genome<br/>ATTAAAGGTT<br/>SingleLetterAlphabet()</span></pre><p id="a7a4" class="pw-post-body-paragraph kf kg hh kh b ki ml ii kk kl mm il kn ko mn kq kr ks mo ku kv kw mp ky kz la ha bi translated">正如我们上面看到的，我们的字母表顺序是<a class="ae jm" href="https://biopython.org/docs/1.75/api/Bio.Alphabet.html" rel="noopener ugc nofollow" target="_blank"><strong class="kh hi">【singletelphabet()】</strong></a><strong class="kh hi">。</strong>因为我们正在处理DNA，所以让我们将字母表转换成<a class="ae jm" href="https://biopython.org/docs/1.75/api/Bio.Alphabet.html" rel="noopener ugc nofollow" target="_blank"><strong class="kh hi">ambiguous _ DNA()</strong></a>这样我们就可以在教程的后面执行特定的操作:</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="51ba" class="mg jo hh mc b fi mh mi l mj mk">from Bio import Seq<br/>from Bio.Alphabet import IUPAC</span><span id="ad93" class="mg jo hh mc b fi mq mi l mj mk">seq = Seq.Seq(str(seq), IUPAC.unambiguous_dna)</span></pre><p id="6cc7" class="pw-post-body-paragraph kf kg hh kh b ki ml ii kk kl mm il kn ko mn kq kr ks mo ku kv kw mp ky kz la ha bi translated">现在，如果我们打印出这个序列，它看起来会非常吓人和令人困惑:</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="40fe" class="mg jo hh mc b fi mh mi l mj mk">print(seq)</span><span id="d565" class="mg jo hh mc b fi mq mi l mj mk">--------------------------------------------------------------------<strong class="mc hi">#expected output:</strong></span><span id="5117" class="mg jo hh mc b fi mq mi l mj mk">ATTAAAGGTTTATACCTTCCCAGGTAACAAACCAACCAACTTTCGATCTCTTGTAGATCTGTTCTCTAAACGAACTTTAAAATCTGTGTGGCTGTCACTCGGCTGCATGCTTAGTGCACTCACGCAGTATAATTAA<br/>...........<br/>TGAACAATGCTAGGGAGAGCTGCCTATATGGAAGAGCCCTAATGTGTAAAATTAATTTTAGTAGTGCTATCCCCATGTGATTTTAATAGCTTCTTAGGAGAATGACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span></pre><p id="43d5" class="pw-post-body-paragraph kf kg hh kh b ki ml ii kk kl mm il kn ko mn kq kr ks mo ku kv kw mp ky kz la ha bi translated">因此，让我们使用<a class="ae jm" href="https://realpython.com/python-defaultdict/" rel="noopener ugc nofollow" target="_blank"> <strong class="kh hi">默认值</strong> </a>来计算基因组中每个含氮碱基的数量:</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="912e" class="mg jo hh mc b fi mh mi l mj mk">from collections import defaultdict<br/>count = defaultdict(int)</span><span id="ada4" class="mg jo hh mc b fi mq mi l mj mk">for letter in seq:<br/>    count[letter] += 1<br/>    <br/>total = sum(count.values())<br/>count</span><span id="b3c3" class="mg jo hh mc b fi mq mi l mj mk">--------------------------------------------------------------------<strong class="mc hi">#expected output:</strong></span><span id="b335" class="mg jo hh mc b fi mq mi l mj mk">defaultdict(int,<br/>    {'A': 8954, <br/>     'T': 9594, <br/>     'G': 5863, <br/>     'C': 5492})</span></pre><p id="6e0c" class="pw-post-body-paragraph kf kg hh kh b ki ml ii kk kl mm il kn ko mn kq kr ks mo ku kv kw mp ky kz la ha bi translated">让我们分析一下每个碱基的百分比:</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="1227" class="mg jo hh mc b fi mh mi l mj mk">for letter, count in count.items():<br/>    print(f'{letter}: {100.*count / total} {count}')</span><span id="5c01" class="mg jo hh mc b fi mq mi l mj mk">--------------------------------------------------------------------<strong class="mc hi">#expected output:</strong></span><span id="c5a8" class="mg jo hh mc b fi mq mi l mj mk">A: 29.943483931378122 8954<br/>T: 32.083737417650404 9594<br/>G: 19.60672842189747 5863<br/>C: 18.366050229074006 5492</span></pre><h1 id="3bc6" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">新冠肺炎蛋白质合成</h1><p id="8da4" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">既然我们已经了解了基因组，让我们把DNA转化成蛋白质。这个过程的第一步叫做转录。这是DNA序列在酶<a class="ae jm" href="https://www.bing.com/search?q=RNA+polymerase&amp;filters=sid%3a31ff3089-4479-977c-79a7-5c2469e159c2&amp;form=ENTLNK" rel="noopener ugc nofollow" target="_blank"> RNA聚合酶</a>的帮助下转化为RNA分子的过程。我们实际上可以用Biopython的<a class="ae jm" href="http://biopython.org/DIST/docs/tutorial/Tutorial.html#sec24" rel="noopener ugc nofollow" target="_blank"> <strong class="kh hi">转录()</strong> </a>函数来模拟这一点:</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="cef6" class="mg jo hh mc b fi mh mi l mj mk">rnaCount = defaultdict(int)</span><span id="b89d" class="mg jo hh mc b fi mq mi l mj mk">for letter in rna:<br/>    rnaCount[letter] += 1<br/>    <br/>total = sum(rnaCount.values())<br/>print(rnaCount)</span><span id="37be" class="mg jo hh mc b fi mq mi l mj mk">--------------------------------------------------------------------#expected output:<br/>defaultdict(int, {'A': 8954, 'U': 9594, 'G': 5863, 'C': 5492})</span></pre><p id="76a1" class="pw-post-body-paragraph kf kg hh kh b ki ml ii kk kl mm il kn ko mn kq kr ks mo ku kv kw mp ky kz la ha bi translated">通过上面的代码我们可以看到<em class="mr"> T(胸腺嘧啶)</em>被<em class="mr"> U(尿嘧啶)</em>所取代。这表明转录是成功的。下一步是通过翻译将其转化为蛋白质。翻译是用来描述<a class="ae jm" href="https://www.bing.com/search?q=Ribosome&amp;filters=sid%3a195ffa10-9311-01fe-8ce7-9446487ed838&amp;form=ENTLNK" rel="noopener ugc nofollow" target="_blank">核糖体</a>合成蛋白质过程的术语。类似于上面的例子，这可以通过一个<a class="ae jm" href="http://biopython.org/DIST/docs/tutorial/Tutorial.html#sec25" rel="noopener ugc nofollow" target="_blank"> <strong class="kh hi"> translate() </strong> </a>函数来完成:</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="4e65" class="mg jo hh mc b fi mh mi l mj mk">protien = rna.translate(stop_symbol="*") #(*)represent stop codon</span><span id="1b2c" class="mg jo hh mc b fi mq mi l mj mk">print(protien)</span><span id="e326" class="mg jo hh mc b fi mq mi l mj mk">--------------------------------------------------------------------#expected output:<br/>Seq('IKGLYLPR*QTNQLSISCRSVL*TNFKICVAVTRLHA*CTHAV*LITNYCR*QD...KKK', HasStopCodon(IUPACProtein(), '*'))</span></pre><p id="818b" class="pw-post-body-paragraph kf kg hh kh b ki ml ii kk kl mm il kn ko mn kq kr ks mo ku kv kw mp ky kz la ha bi translated">终止密码子由<strong class="kh hi">星号(*)表示。</strong>这告诉核糖体停止在该位点构建特定的蛋白质。有了这些知识，我们可以将序列分解成独立的蛋白质，并将其组织在一个数据框架中:</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="5d36" class="mg jo hh mc b fi mh mi l mj mk">aa = protien.split("*")</span><span id="dc87" class="mg jo hh mc b fi mq mi l mj mk">ncov = [str(i) for i in aa]<br/>ncov_len = [len(str(i)) for i in aa]</span><span id="1764" class="mg jo hh mc b fi mq mi l mj mk">#store the amino acid chains into a df<br/>import pandas as pd<br/>df = pd.DataFrame({'Amino Acids': ncov, 'Lenght': ncov_len })</span><span id="9e12" class="mg jo hh mc b fi mq mi l mj mk">df.head()</span></pre><p id="a174" class="pw-post-body-paragraph kf kg hh kh b ki ml ii kk kl mm il kn ko mn kq kr ks mo ku kv kw mp ky kz la ha bi translated">输出应该是这样的:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ms"><img src="../Images/00450a4bdff03938407defdc73ef4732.png" data-original-src="https://miro.medium.com/v2/resize:fit:386/format:webp/1*RZ1I73hfcQILA1t10fCQ1A.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图片作者:Varun Sendilraj</figcaption></figure><p id="aac3" class="pw-post-body-paragraph kf kg hh kh b ki ml ii kk kl mm il kn ko mn kq kr ks mo ku kv kw mp ky kz la ha bi translated">让我们看看最长和最短的氨基酸序列(蛋白质):</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="a7d8" class="mg jo hh mc b fi mh mi l mj mk">df.nlargest(5, "Length")</span><span id="758a" class="mg jo hh mc b fi mq mi l mj mk">df.nsmallest(5, "Length")</span></pre><p id="4804" class="pw-post-body-paragraph kf kg hh kh b ki ml ii kk kl mm il kn ko mn kq kr ks mo ku kv kw mp ky kz la ha bi translated">最长序列:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mt"><img src="../Images/c9d74733c0e29697aeb5afd582a80ec8.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*CSZ_amSVLui_a3AMx0MRoA.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图片作者:Varun Sendilraj</figcaption></figure><p id="fd0d" class="pw-post-body-paragraph kf kg hh kh b ki ml ii kk kl mm il kn ko mn kq kr ks mo ku kv kw mp ky kz la ha bi translated">最短序列:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mu"><img src="../Images/6506499f00d5ccf57259aa26019f1e33.png" data-original-src="https://miro.medium.com/v2/resize:fit:344/format:webp/1*x0k99DR6vWo_ILjK-FKAGQ.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图片作者:Varun Sendilraj</figcaption></figure><p id="b478" class="pw-post-body-paragraph kf kg hh kh b ki ml ii kk kl mm il kn ko mn kq kr ks mo ku kv kw mp ky kz la ha bi translated">最后，让我们看看最常见的氨基酸:</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="4b62" class="mg jo hh mc b fi mh mi l mj mk">from collections import Counter</span><span id="8058" class="mg jo hh mc b fi mq mi l mj mk">Counter(protien).most_common(10)<br/>--------------------------------------------------------------------<br/>#expected output</span><span id="c8e3" class="mg jo hh mc b fi mq mi l mj mk">[('L', 886),<br/> ('S', 810),<br/> ('*', 774),<br/> ('T', 679),<br/> ('C', 635),<br/> ('F', 593),<br/> ('R', 558),<br/> ('V', 548),<br/> ('Y', 505),<br/> ('N', 472)]</span></pre></div><div class="ab cl lb lc go ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ha hb hc hd he"><p id="e195" class="pw-post-body-paragraph kf kg hh kh b ki ml ii kk kl mm il kn ko mn kq kr ks mo ku kv kw mp ky kz la ha bi translated">最后，我们获得了新冠肺炎基因组，并进行了蛋白质合成。在下一个教程中，我们将采用新型冠状病毒穗的PDB文件，并做一些蛋白质可视化和三维分析。</p></div><div class="ab cl lb lc go ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ha hb hc hd he"><p id="5713" class="pw-post-body-paragraph kf kg hh kh b ki ml ii kk kl mm il kn ko mn kq kr ks mo ku kv kw mp ky kz la ha bi translated"><strong class="kh hi">已完成的Jupyter笔记本</strong> : <a class="ae jm" href="https://github.com/VarunSendilraj/Bioinformatics/blob/main/covid19_basic%20_protien_analysis/Covid-19%20Protien%20Analysis%20part%201.ipynb" rel="noopener ugc nofollow" target="_blank">生物信息学/新冠肺炎蛋白质分析第1部分. ipynb在主要的VarunSendilraj/生物信息学(github.com)</a></p><p id="9eee" class="pw-post-body-paragraph kf kg hh kh b ki ml ii kk kl mm il kn ko mn kq kr ks mo ku kv kw mp ky kz la ha bi translated">第二部分:即将推出</p></div></div>    
</body>
</html>