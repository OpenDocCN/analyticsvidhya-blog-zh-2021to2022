<html>
<head>
<title>Mercari price suggestion: kaggle competition problem</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">市场价格建议:kaggle竞争问题</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/mercari-price-suggestion-kaggle-competition-problem-22bd5adafd26?source=collection_archive---------17-----------------------#2021-01-23">https://medium.com/analytics-vidhya/mercari-price-suggestion-kaggle-competition-problem-22bd5adafd26?source=collection_archive---------17-----------------------#2021-01-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/8312c267f0a049a99c4e46db47a805ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kY50yElPi4Sswcnw"/></div></div></figure><p id="5860" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里我就分享一下我是怎么解决这个问题的。</p><p id="1a7a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">所以让我们开始——</p><p id="1fe2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">以下是路径，我将一一挑选并解释。</p><ol class=""><li id="fe21" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">介绍</li><li id="c6ca" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">商业问题</li><li id="e12c" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">映射到ML/DL问题</li><li id="a89b" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">理解数据</li><li id="99f9" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">第一次切割溶液</li><li id="eaab" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">电子设计自动化(Electronic Design Automation)</li><li id="305a" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">特征工程</li><li id="516b" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">系统模型化</li><li id="5764" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">结果</li><li id="62b1" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">结论和未来工作</li><li id="7f46" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">轮廓</li><li id="9a2b" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">参考</li></ol><p id="8852" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们深入了解每一部分。</p><h2 id="1fda" class="kb kc hh bd kd ke kf kg kh ki kj kk kl ja km kn ko je kp kq kr ji ks kt ku kv bi translated">1.简介—</h2><p id="3e62" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">Mercari是日本的购物应用。他们希望向卖家建议价格，但这并不容易，所以他们需要一个系统或算法来自动建议产品价格。所以他们的主人带着一些奖品把这个问题放在kaggle上。</p><p id="783f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">基本上在这里，我必须预测产品的价格给定一些产品的信息，如产品描述，产品名称，产品品牌名称等。</p><h2 id="d2a2" class="kb kc hh bd kd ke kf kg kh ki kj kk kl ja km kn ko je kp kq kr ji ks kt ku kv bi translated">2.商业问题—</h2><p id="7ef9" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">其中一件毛衣售价335美元，另一件售价9.99美元。你能猜出哪个是哪个吗？</p><p id="261b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">毛衣_1 —绝对防御复仇者联盟男式女式休闲时尚运动衫常规合身冬季夹克男孩女孩连帽衫。</p><p id="e2dd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">毛衣_2 — ADRO Heartbeat Love妈妈和爸爸设计的男女印花连帽衫/运动衫。</p><p id="1811" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这是我们必须解决的问题。问题是在给定一些信息的情况下建议产品的价格。</p><p id="e21b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">大型电子商务公司的产品定价越来越大。因此，基本上问题是，当任何卖家在电子商务网站上列出他们的产品时，他们用来填写该产品的价格，而不是根据产品，所以这样一来，产品就卖不出去(假设任何一个人将他10年前的hero bike标价40，000，所以很明显任何人都不想这样做，因为新的hero bike价格本身就接近50，000)。当产品卖不出去，那么产品在网站上持续很长时间，所以公司(拥有该网站)不能从该产品中获利。所以如果有很多这样的产品，那么公司将不得不承担损失。这个问题可能会导致公司倒闭。因此，为了解决这个问题，我们将建立一个ml模型，可以预测价格的基础</p><p id="d217" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在它的产品描述等功能上，为此我们将有数据来训练我们的模型。</p><h2 id="4799" class="kb kc hh bd kd ke kf kg kh ki kj kk kl ja km kn ko je kp kq kr ji ks kt ku kv bi translated">3.映射到ML/DL问题—</h2><p id="bebe" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">这里的标签是真实值，所以这是一个回归问题。对于给定的产品特性，我们必须预测它的价格。</p><p id="f2af" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">a.预测价格和实际价格之间的差异不能太大，否则就无法实施ml模型</p><p id="4d4e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">b.没有任何严格的延迟问题，可能需要2到5秒。</p><p id="1645" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">c.可解释性很重要。</p><p id="3769" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">正如我们所知，这是一个回归问题，我们可以使用RMSE或RMSE或MAE或R平方作为性能指标。</p><h2 id="b681" class="kb kc hh bd kd ke kf kg kh ki kj kk kl ja km kn ko je kp kq kr ji ks kt ku kv bi translated">4.理解数据— —</h2><p id="8a94" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">我已经下载了kaggle竞赛本身的数据。</p><p id="816c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你可以从<a class="ae lb" href="https://www.kaggle.com/c/mercari-price-suggestion-challenge" rel="noopener ugc nofollow" target="_blank">这里</a>下载数据。</p><p id="125a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这是关于数据的信息—</p><p id="a674" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">数据集中有八列。</p><p id="526b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">1.Train_id —这是每个产品的id。前任。1、2、3等</p><p id="7358" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">2.名称—产品的名称。《出埃及记》MLB辛辛那提红人t恤尺寸XL。它是文本数据。</p><p id="7177" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">3.Item_condition_id —这是根据产品的条件对其进行的评级。《出埃及记》1、2、4等。</p><p id="653c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">4.类别名称—产品的类别。《出埃及记》男士/上衣/T恤。这是分类数据。</p><p id="f36c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">5.品牌名称——产品的品牌名称。《出埃及记》阿迪达斯。这是一个分类列。</p><p id="df3d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">6.价格——产品的价格，这是目标特性。</p><p id="29cd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">7.运费——运费由卖方还是买方支付。它将是0或1。</p><p id="fc66" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">8.Item_description —这是产品的描述。《出埃及记》条纹男子连帽领红色，黑色t恤。这是文本数据。</p><h2 id="149f" class="kb kc hh bd kd ke kf kg kh ki kj kk kl ja km kn ko je kp kq kr ji ks kt ku kv bi translated">5.第一次切割解决方案—</h2><ol class=""><li id="8dd9" class="jn jo hh ir b is kw iw kx ja lc je ld ji le jm js jt ju jv bi translated">首先，我将准备数据，这意味着我将清理数据并对其进行预处理。</li><li id="af4d" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">我会做探索性的数据分析。基于可视化移除异常值。</li><li id="111b" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">对文本数据进行预处理，并使用tf-idf或bow或在我们的文本语料库上使用自己训练的word2vec将其转换为向量。对于tf-idf矢量化，我可以使用sklearn tfidfvectorizer方法。</li><li id="363a" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">我将基于<a class="ae lb" href="https://arxiv.org/ftp/arxiv/papers/1612/1612.08333.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/ftp/arxiv/papers/1612/1612.08333.pdf</a>这篇论文制作一些特征，比如我将统计产品描述中的单词并将其制作成一个特征，将描述中所有单词的词频相加并用句子长度等进行划分，我们将基于分析生成更多这样的特征。</li><li id="bb9b" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">然后，我将制作一个随机模型，并找到一个度量分数，以便我们可以检查我们的下一个模型有多好。</li><li id="ff1d" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">之后，我将训练一些回归模型，如岭回归，然后我也将建立一个MLP模型。</li><li id="59b8" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">对于训练mlp模型，我将首先训练关于文本描述的word2vec cbow模型，对于训练word2vec模型，我将首先使来自每个描述焦点单词的数据作为标签，上下文单词作为特征。这里，我们可以基于分析获取上下文单词。为了制作每个上下文单词的特征，我们首先制作词汇的向量大小(描述列中的单词),在上下文向量的索引上，我放置1，在其他索引上，我放置0，所以这将是第一个上下文单词(由二进制向量表示),假设如果我选择了上下文单词为5，那么我们将对5个上下文向量中的每一个执行上述步骤，在完成所有这些之后，我将获得5个向量，每个向量的词汇大小。我们也将为我们的焦点单词这样做，然后给出作为那些上下文向量的输入(我们从上下文单词中得到这些向量，所以假设我们的vocab_size=50，context_word=5，那么输入向量的总长度是250)。我将有一个大小为n(n是每个单词表示向量的大小)的隐藏层，然后我有一个带有softmax激活函数的vocab_size节点的输出密集层。</li><li id="a239" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">训练这个模型，我将得到隐藏层和输出层之间的权重向量矩阵，大小为(vocab_size，n ),每个单词有一个大小为n的表示向量。</li><li id="e6da" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">使用word2vec模型，我将把每一行(描述列)转换成n个大小向量。然后我将使用一个简单的mlp模型来训练这些新数据。</li><li id="5176" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">根据结果，我会进一步修改。</li><li id="bb93" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">基本上我必须做大量的超高计调整。</li></ol><h2 id="5b99" class="kb kc hh bd kd ke kf kg kh ki kj kk kl ja km kn ko je kp kq kr ji ks kt ku kv bi translated">6.EDA —</h2><ul class=""><li id="b561" class="jn jo hh ir b is kw iw kx ja lc je ld ji le jm lf jt ju jv bi translated">文本数据—</li></ul><p id="14d9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">首先，我预处理文本数据。数据中的文本列是item_description和name。</p><p id="4307" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了预处理文本数据，我做了一些函数去压缩和预处理文本数据。</p><p id="6283" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Decontracted函数——在这个函数中，我们将一些简短的形式转换为完整的形式(如果在数据中),比如将不会转换为不会等等。你可以看到下面的代码—</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="9d16" class="kb kc hh ll b fi lp lq l lr ls">def decontracted(phrase):<br/>    # specific<br/>    # in this function we are converting some short form to full #     #form like won't to will not<br/>    phrase = re.sub(r"won't", "will not", phrase)<br/>    phrase = re.sub(r"can\'t", "can not", phrase)</span><span id="ae2b" class="kb kc hh ll b fi lt lq l lr ls"># general<br/>    phrase = re.sub(r"n\'t", " not", phrase)<br/>    phrase = re.sub(r"\'re", " are", phrase)<br/>    phrase = re.sub(r"\'s", " is", phrase)<br/>    phrase = re.sub(r"\'d", " would", phrase)<br/>    phrase = re.sub(r"\'ll", " will", phrase)<br/>    phrase = re.sub(r"\'t", " not", phrase)<br/>    phrase = re.sub(r"\'ve", " have", phrase)<br/>    phrase = re.sub(r"\'m", " am", phrase)<br/>    return phrase</span><span id="8270" class="kb kc hh ll b fi lt lq l lr ls">decontracted('this product isn't good, I can't buy it')<br/># output -------<br/># this product is not good, I can not buy it.</span></pre><p id="c51f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Preprocessing_text_data —在这个函数中，我们删除了a-z和A-z中的所有内容，比如删除停用词和特殊字符。基本上这可以通过这一行实现—</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="1d99" class="kb kc hh ll b fi lp lq l lr ls">sen = re.sub(‘[^a-zA-Z \n\.]’, ‘’, sen)<br/># if sen ='oh no! this product is very bad,you should not buy it 😢'<br/># output ----<br/># 'oh no this product is very bad you should not buy it'</span></pre><p id="e662" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">但是我写了这么多代码，如果你想的话，你可以注释一些行。在这一点上，我也将单词词条化，这样它就可以生成有意义的词根。这个函数返回预处理过的文本。你可以在这里看到它的代码—</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="8390" class="kb kc hh ll b fi lp lq l lr ls">stop_words=stopwords.words(‘english’)<br/>lemmatizer_=WordNetLemmatizer()<br/>def preprocess_text_data(values):<br/> preprocessed_text=[]<br/> for sen in tqdm(values):<br/>    sen=str(sen).lower()<br/>    sen=decontracted(sen)<br/> # removing special characters<br/> sen=sen.replace(“‘s”,’     is’).replace(“’”,’’).replace(‘!’,’’).replace(‘,’,’ ‘).replace(‘-’,’ ‘).replace(‘.’,’’).replace(‘(‘,’’).replace(‘)’,’’)\<br/> .replace(‘\r’,’’).replace(‘\n’,’’).replace(‘\”’,’’).replace(‘&amp;’,’’).replace(‘=’,’’).replace(‘?’,’’).replace(‘:’,’’).replace(“‘re”,’ are’)\<br/> .replace(“‘ve”,’ have’).replace(“‘m”,’ am’).replace(“‘t”,’ not’).replace(“…”,’ ‘).replace(“….”,’ ‘).replace(‘\\r’,’’).replace(‘\\n’,’’)\<br/> .replace(‘\\’,’’).replace(‘*’,’’).replace(“‘“,’’).replace(“;”,’’).replace(“+”,’’).replace(“%”,’’).replace(“ “,’ ‘)<br/> <br/> sen=sen.replace(‘/’,’ ‘).replace(‘[‘,’ ‘).replace(‘]’,’ ‘).replace(‘⚡️’,’’).replace(‘✨’,’’).replace(‘❤️’,’’).replace(‘#’,’’).replace(‘$’,’’)<br/> # lemmatizing each word in sentences<br/> sen = ‘ ‘.join(lemmatizer_.lemmatize(e) for e in sen.split() if e.lower() not in stop_words and len(e)&gt;2)<br/> # except a-z and A-Z remove all things from sentence.<br/> sen = re.sub(‘[^a-zA-Z \n\.]’, ‘’, sen)<br/> #sen = re.sub(“ \d+”, “ “, sen)<br/> # reference — #<a class="ae lb" href="https://stackoverflow.com/questions/33404752/removing-emojis-from-a-string-in-python" rel="noopener ugc nofollow" target="_blank">https://stackoverflow.com/questions/33404752/removing-emojis-from-#a-string-in-python</a><br/> <br/> preprocessed_text.append(sen.strip())<br/> return preprocessed_text</span><span id="a970" class="kb kc hh ll b fi lt lq l lr ls">preprocess_text_data('this's good...,I love this! ❤')<br/># output -----<br/># 'this is good I love this'</span></pre><p id="e9d1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">写完这两个函数后，我将我的每个文本列一个接一个地传递给预处理_文本_数据函数，该函数返回具有预处理值的相同长度的列表，最后将所有列保存到df。你可以在下面看到这个的代码—</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="dc5a" class="kb kc hh ll b fi lp lq l lr ls">df[‘name’]=preprocess_text_data(df[‘name’].values)<br/>df[‘item_description’]=preprocess_text_data(df[‘item_description’].values)</span></pre><ul class=""><li id="1e4f" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm lf jt ju jv bi translated">分类数据—</li></ul><p id="b8fb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我将讨论分类数据。我的数据类别名称和品牌名称中有两个分类列。</p><p id="6a7b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我降低了品牌名称列的大小写，这样所有品牌名称行都变成了小写。我这样做是因为模特可以把阿迪达斯和阿迪达斯算作不同的品牌名称。</p><p id="62b6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们继续讨论category_name。在category_name列上，我做了同样的事情，将所有类别转换成小写。然后，我在预处理之间做了一些分析，发现类别列有最大5个类别和最小3个类别，所以我在这里想，为什么我不为类别列的每一行做五列(因为一行中可以有最大5个类别)，让我们直观地看一下—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/1b429698c430fde5097fd7a718246a13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*p3h2BkpYEmntVAN8"/></div></div></figure><p id="7abd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我觉得现在可以理解了。我这样做是因为我可以分析类别和子类别，现在也很容易特征化。你可以在这里看到它的代码—</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="d214" class="kb kc hh ll b fi lp lq l lr ls">df[‘subcat1’]=df[‘category_name’].apply(lambda x:x.split(‘/’)[0])<br/>df[‘subcat2’]=df[‘category_name’].apply(lambda x:x.split(‘/’)[1])<br/>df[‘subcat3’]=df[‘category_name’].apply(lambda x:x.split(‘/’)[2])<br/>def subcat4_fun(x):<br/> try:<br/>   c=x.split(‘/’)[3]<br/> except:<br/>   c=’nan’<br/> return c <br/> <br/>def subcat5_fun(x):<br/> try:<br/>   c=x.split(‘/’)[4]<br/> except:<br/>   c=’nan’<br/> return c<br/>df[‘subcat4’]=df[‘category_name’].apply(subcat4_fun)<br/>df[‘subcat5’]=df[‘category_name’].apply(subcat5_fun)</span></pre><p id="170c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这一切之后，我必须继续处理数字数据，这与数字列无关，所以就让它这样吧。</p><p id="7b92" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我将进入下一部分。</p><p id="8154" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">注意— </strong>关于分析和可视化的代码，你可以查看github链接，我会粘贴在这个博客的底部。</p><p id="aa5e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">对数据进行EDA并了解每个特征— </strong></p><p id="fb68" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">首先我会看到价格的分布。看这里的图表—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/148eafe11399e0058bc9021e84b252d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1vrsRLHPE0J4N-TK"/></div></div></figure><p id="27b4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这张图中，我可以看到大多数产品的价格都在50英镑以下，这意味着很少有产品的价格非常高。</p><ol class=""><li id="da4b" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">姓名栏——首先我想了解属于某个价格范围的词语，我能看到一些决定价格是低还是高的词语吗？因此，让我们绘制价格高于50英镑的产品名称的单词云。</li></ol><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/90d586f94cce675bbb4609f4e9519100.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XOr1vQk_g1TJxIix"/></div></div></figure><p id="803f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这里，我可以看到单词bundle、Michael kor、kate spade等很大，因此这些单词在价格高于50英镑的产品中非常常见。</p><p id="08af" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们看看价格低于50英镑的产品名称</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/d6a8054489b66486ff52bc417196c711.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2Jpk7b4xVjy4afx9"/></div></div></figure><p id="faae" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这很有趣。在这里我可以看到，那些在大于50个字的云中很大的字不在这里。这里比较常见的词是维多利亚秘密免费送货等。</p><p id="51c0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">从这两张图片中，我可以看到有些词正在影响价格。所以这个名字特征在决定价格上似乎很重要。</p><p id="52c6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我根据产品名称的字数来标价格。看剧情——</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lv"><img src="../Images/6576665ae1880483770f75b94ba6c2e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/0*rijLBgxcvpuIivuO"/></div></figure><p id="23de" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我看到这里有更少的产品，价格更低，有7，8或9个单词。意味着大部分产品名称的字数较少，价格较低和较高。这似乎不是很重要，如果我计算价格和每个名称长度之间的相关性，那么我发现0.038，这不是很好。</p><p id="2a9f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">2.项目_条件_id —</p><p id="930b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">首先查看item_condition_id的计数图—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lw"><img src="../Images/8c9673dfd95da2e724b5944ccd387a2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zYrcpf22BDM68r60"/></div></div></figure><p id="330f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">具有item_condition_id 4和5的数据点非常少。</p><p id="8f59" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我正在绘制item_condition_id和价格之间的散点图。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lx"><img src="../Images/39ad313b5c85effe05228dee08b1bcbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/0*bVS2i7mtZbApuKf5"/></div></figure><p id="abe4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在上面的散点图中，当condition_id为5时，价格总是小于750，对于condition_id 1，2，3，价格也低也高，很明显，有更多的数据点具有item_condition_id 1，2和3。这个特性看起来也没那么重要。因为价格和这个特性的关联度不高。</p><p id="ea5a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当我看到每个condition_id的价格分布时，它确认了这不是那么重要。看方框图—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ly"><img src="../Images/d09a3e18d99e9559430333079f507281.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oLDexSAap7ZU0dY-"/></div></div></figure><p id="3ff5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">3.Subcat1 —</p><p id="29e0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">首先，我已经解释了我是如何生成这个特性的。借助于箱线图，我们来看一下每个子卡1的价格分布</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lz"><img src="../Images/f504d6c872c73103e95d85b65f2befee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HHusFgTLad6hOoHG"/></div></div></figure><p id="c040" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我可以在方框图中看到，一些类别，特别是儿童和手工制品的价格分布与男性子类别略有不同，但在这两个类别之间，有一些子类别的价格完全重叠，这不是一个好现象，但在第一和最后还是有一些差异。这可能是价格预测的问题。</p><p id="6d9f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在让我们向前迈出一步，绘制每个条件下的每个subcat1价格分布，然后查看是否有任何subcat1在不同条件下具有不同的价格分布。看下面的图—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/b4a36bef1292f179507fecd072723d7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ws2-_nA8pEOu77x1"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/24cf36d682717f60bae49536e7721c35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*j35ubHn0d-BtIyjl"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/923af15456548c37e3f34497b9a4a5c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*md4kpnbdWCUFq0xY"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/be78cd3b0b4e71af63f697b65d99e75f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BVgnClabDyzDNcre"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/cea9861d891213ebd149c597fbf1ff99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*odcfhzAyoat7Num_"/></div></div></figure><p id="4efd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在所有上述图中，没有任何图显示，在变化的条件id下，价格分布也在变化。有一些差异但不大。意味着在所有条件下，子类别的价格范围几乎相同。</p><p id="d068" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">4.Subcat2 —</p><p id="7612" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了分析subcat2，我绘制了前20个subcat2的价格分布，这给了我一些更好的视觉效果。这是方框图——</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mb"><img src="../Images/0d8a9894e4f6b2a94d94421fe5680f5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QVMGHs2SAmb9-_6o"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mc"><img src="../Images/c79e6bfedfe05cdfde04931f7b0de7c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YIf4QcAL9cB53ooS"/></div></div></figure><p id="f3b2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果你看到这个箱形图，你会发现每个子资本的价格分布有很大差异。《出埃及记》看看女性手提包和手机&amp;配件的价格分布，有很大的差异，所以这是一个有趣的特点。</p><p id="9fb8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们看看每种情况下的前5种subcat2价格分布—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/21a742b416374c2a4d3f4f8501b6d907.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DuPFG5MmSTVoMB2p"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/fc82e273fe7ab25003a6e4932c0ccc8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zPcqCCmA3Rp9pfPp"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/12cdac2310b56afecd15fc2bb4ee4824.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*f5gpta2okactrPWi"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/a448d09f5f0919bb0405d6a53e15317c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1zIzfGUz6bFZYVyc"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/6e60f960f524a049102618fe7587fac3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wGbRFgcAx-IlK4i2"/></div></div></figure><p id="5483" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当你看到上面这些分布图时，你会注意到有一些子条件2，每个条件在价格分布上有一些不同。《出埃及记》条件id为1的运动服装subcat2具有一些不同的价格分布，鞋subcat2在每个条件之间也有一些差异，并且条件1的珠宝具有不同的分布。</p><p id="a5f9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">看到这个之后，我可以说这将是一个重要的特性。</p><p id="7112" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">5.Subcat3 —</p><p id="586b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我在这里也画了同样的东西，价格分布的前5个子3。在顶部有一个subcat3 other，这意味着给定产品没有第三个子类别。</p><p id="70db" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们看看方框图——</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/a46fdcb115157df038f2e61bb3135a85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zfpF6mpIWa-l0BbP"/></div></div></figure><p id="a431" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这个方框图中，裤子、紧身裤和打底裤的价格分布与没有给出第三层subcat的情况非常不同。裤子紧身裤打底裤鞋子价格分布也有一些区别。所以也是一个很好的特性。</p><p id="c0f5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">再次绘制价格距离。前5个子卡特彼勒3的状况—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/b476a1f72fd7f87562cf2e0f438ede1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YECFuJTVNDH1PXO9"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/027d31a0562bdf6cd4d433a001f8a802.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*V7fmqu8z6f4Zy-BR"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/048bd860eff58af6fae1688c423627a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kiHyS-bM-cTGXMIu"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/592c6164e1f63e47c322b54832f2fc72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xnj0CkB4-84Kxtk2"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/4199311bc88ed25486fdefc99ab37b9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*29opNSd4Vf7xzbcm"/></div></div></figure><p id="f92d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">价格分布差别不大，但是看第一个剧情裤子紧身裤打底裤条件1和条件4价格分布看起来不一样。但除此之外，所有的分布几乎是相同的。</p><p id="671e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">所以让我们继续前进。</p><p id="68f7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">6.Subcat4 —</p><p id="72df" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">该列/特征有六个分类值。看它们的价格分布—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/fca8841ebb0086999b250760d8e659e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*f0KsqPgBHsklnNFZ"/></div></div></figure><p id="8cf1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">看看平板电脑的分布和芭蕾，它们是完全不同的意思，如果subcat4是平板电脑，那么价格通常很高，subcat4是芭蕾，那么价格很低。比较芭蕾和发球，它们也是完全不同的。</p><p id="b552" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">像这样对subcat5进行分析，看看。我已经做了，但没有在这里提到。</p><p id="3173" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在是时候看看更多的功能了—</p><p id="792a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">7.品牌名称—</p><p id="4caa" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果我谈论brand_name特性，我注意到的第一件事是它有许多缺失值或nan值，在数据中42%的行没有品牌名称。怎么处理？我稍后会谈到这一点，现在看到的分析与南值。</p><p id="1142" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在进行分析之前，我已经将我的nan行转换为nan字符串，只是为了像对待一个类别一样对待它。</p><p id="42c5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在让我们看看前10个最常见的品牌名称的价格分布—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/62eb02424b29c6ed1462b91a62fa6472.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_pmnGMxQjhML5Eim"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/e1a568b9bffe4c8dde96855151cc8f21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QVyreJga2u82Oxrx"/></div></div></figure><p id="4bc0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在看看分布。看到苹果和迈克高仕分布在那里的价格范围很广，那里的价格也相当高，看到粉红色，intendo和永远21，他们的价格范围低。每个品牌都有自己不同的价格分布。这是一个非常好的特性。如果我们将苹果作为品牌名称，那么价格高的可能性很大，但如果品牌名称是forever 21，那么价格高的可能性就很小。所以这是一个很好的预测价格范围的特征。</p><p id="8616" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在来看看前10名品牌的价格分布情况</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es md"><img src="../Images/084035bdaf1401861fc6f95dc91dcd9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GCqWMxoxlIcGPIOt"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es me"><img src="../Images/3aec4391dc528d5e52cd2ebb5598845f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mz-k9Hal6OZefvEA"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mf"><img src="../Images/fb45f9515b2e355417f8a920d6954e7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DZxOO67FFktDAanH"/></div></div></figure><p id="71b4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，如果我看到上面的分布，并根据其条件获得lululemon价格分布，那么我会看到条件5的lululemon与条件1的lululemon具有不同的分布，就像你可以看到苹果和迈克高仕相对于其条件的价格分布，看到迈克高仕条件5的分布和迈克高仕条件1的分布，它们是多么不同(意味着条件1的迈克高仕的价格比条件5的迈克高仕更高)。你也可以在苹果的价格分布中看到这些东西。</p><p id="5aea" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在看看，如果有任何影响航运和品牌名称的价格。我已经画出了十大品牌在运输方面的价格范围。先看方框图—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mg"><img src="../Images/d36a26083415b4225f16eca48bd0f7b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nzShyBl_n92gLwbz"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mh"><img src="../Images/37d45d55e0e5a59755d7cebd58a4fc92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WqvzDS8grbsTWleL"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mi"><img src="../Images/d728df3611ba3cadf065c62c0ee8fa3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1Ump5aiRwAPp3Gh8"/></div></div></figure><p id="7b5d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果你看到所有的方框图，那么在每个方框图中有一个共同点，我可以在这里看到每个蓝色方框稍微领先于每个橙色方框，这意味着当运费由买家支付时，价格就很高，如果我们看到每个运费(0和1)的美国鹰品牌名称的价格范围与迈克高仕和lululemon的价格范围不同，我们可以看到更多这样的关系。</p><p id="7e57" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">8.航运—</p><p id="ce01" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">有两个值，0表示运费由买方支付，1表示运费由卖方支付。</p><p id="ce9f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果运费由卖方支付，则平均价格较低，而当运费由买方支付时，则成本稍高。你可以在每个发货id 0和1的价格分布图中看到这一点。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/2ae5562deb0b5631c6c61cac832e7ef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-EeCKHj5gwJ0aS_a"/></div></div></figure><p id="d097" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果我们看到价格和运输之间的相关性，它几乎是-0。24.这很好。</p><p id="ae36" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">9.项目描述—</p><p id="93c3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这完全是文本特征。我在item_description中绘制了价格和字数之间的散点图，得到了这个图。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/52a28f97e9556d366aabd187c74c9f1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4dFHObM0PPSorGLO"/></div></div></figure><p id="db02" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">从上面的情节我可以说两件事。首先，有详细描述的数据较少，其次，有详细描述的数据价格较低，而有详细描述的数据价格较低，所有类型的价格都意味着低和高。就是这样。</p><p id="7d2d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这些都在EDA部分。你可以做得更多。</p><p id="c0c2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们看看功能和价格之间的关联热图</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/b587920eaea9ef4014bdba796460c3c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*83HnK-J5cSdZBBb5"/></div></div></figure><p id="307d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里有一些彼此高度相关的特征。我将移除其中一个高度相关的要素，因为多重共线性是不好的。运输与价格高度相关。</p><p id="703e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最后，我选择了15个特征。这里你可以看到—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es mj"><img src="../Images/8fa64976ce771a45dc5e3a4f2365caa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/0*wqvCyECu7bMf-ar9"/></div></figure><h2 id="8f1c" class="kb kc hh bd kd ke kf kg kh ki kj kk kl ja km kn ko je kp kq kr ji ks kt ku kv bi translated">7.特征工程—</h2><p id="6d97" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">从前面的分析中，我们知道品牌名称的不可用性确实会影响价格，所以我认为如果我创建一个只有0和1的新功能会怎么样，如果给定了品牌名称，我会将其设为1，如果没有，我会将其设为0(看这里，我没有删除原始功能品牌名称，我正在创建一个新功能，让我们将其命名为品牌名称存在编码器)。添加这个特性后，当我计算这个特性和价格之间的相关性时，我得到的值几乎是0.21，这相当不错。</p><p id="68e0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">所以现在我们又多了一个功能brand_name_exist_encoder。</p><p id="d5fd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">但是，我没有使用这个功能，因为当我训练我的模型时，我的系统似乎被关闭了，因为它占用了我所有的内存。因为数据很大，差不多140万我处理不了。顺便说一下，我已经成功地训练了一些模型，与此相比，它给了我更好的结果(我将向你展示)。更好的结果背后的原因可能是更多的数据和一个与价格有很好相关性的特征(brand_name_exist_encoder)。所以如果你的笔记本有更多的内存，你可以试试这个。</p><p id="09b7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在进行特征化之前，我将把我的数据分成训练集和测试集。</p><p id="1e5c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，在这一节中，我将用三种方法进行特征化。</p><p id="9c4b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">1.一个热编码</p><p id="1b0c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">2.TF-IDF矢量器</p><p id="1d88" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">3.Word2Vec</p><p id="8e15" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我可以做tf-idf word2vec，但仅限于我自己用这三个。</p><p id="103d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">基本上我已经用每种方法做出了特征。</p><p id="ed85" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在分类数据上，我只应用了一种热编码，但是对于文本，我应用了这三种方法，并建立了三个特征集</p><p id="3c6e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">(train_ohe，test_ohe)，(train_tfidf，test_tfidf)和(train_w2v，test_w2v)。</p><p id="7031" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">注意——在这里，我将所有编码器安装在唯一的训练上，并转换训练和测试以防止数据泄漏。</p><ol class=""><li id="4ccd" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">一个热门的编码—</li></ol><p id="5277" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">一个热编码意味着什么，假设我有一个列brand_name，它有三个频繁出现的值，假设我有十行，这里我有三个唯一的值，所以我将这三个唯一的brand_name值组成三列name，现在我将选择第一列，并检查行(实际brand_name)的值是否与first_column name相同，我将它设为1，否则设为0。我将对剩下的两列进行同样的处理。你可以通过这张图片更好地理解它—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/90bb7677a6e023d2ed9c4d71242a48ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_X0HDPtDxkRegaib"/></div></div></figure><p id="84d5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在上图中，A列表示品牌名称A出现的位置和不出现的位置。</p><p id="6dc5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">首先，我用一个hot编码创建特性，这意味着我将对文本和分类数据应用onehotencoder。</p><p id="d7a3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我将使用堆栈来堆叠所有要素，包括数字要素，并将其保存为train_ohe和test_ohe。</p><p id="3af0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">2.TF-IDF矢量器—</p><p id="d50b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我已经对分类数据进行了一次热编码，所以不需要再做一次。这里我只需要对文本数据(name和item_description)进行tfi-df矢量化。</p><p id="aa18" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">tf-idf表示-术语频率*逆文档频率。</p><p id="d080" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">术语频率公式为-</p><p id="742c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">一个词的词频=该词在句子中出现的次数/句子中的总字数。</p><p id="d960" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">单词的IDF = log(语料库中句子的数量/出现单词的语料库的数量)。</p><p id="646c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这里，TF给予频繁出现在句子中的单词更多的重要性，而IDF给予出现在语料库中很少的句子中的重要单词。在IDF公式中，有一个用于标准化数值的对数，如果没有对数，那么数值的范围将会太大，这对我们的模型不利。</p><p id="e739" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们看一个tf-idf矢量器的例子—</p><p id="a0f4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">科珀斯——你好，你真有趣，他也很有趣</p><p id="9608" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在计算TF(你在你好吗中)=1/3和idf(你)=log(3/2)</p><p id="6f76" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">所以我们在句子“你好吗”中的tf-idf值是(1/3)*log(3/2)。</p><p id="61bb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我将创建一个向量，这个向量的大小将等于语料库的vocab大小。在我的例子中，vocab的大小是7。所以向量看起来像(how，are，you，so，滑稽，he，is)。现在句子“how are you”的向量表示会是这样的(tf-idf(how)，tf-idf(are)，tf-idf(you)=(1/3)*log(3/2)，tf-idf(so)，……。，tf-idf(is))。</p><p id="2852" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在同样的事情，我将堆栈所有的功能，包括一个数字也使用堆栈，我将它保存为train_tfidf和test_tfidf，这样我就不必再次运行它。</p><p id="cd94" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">3.Word2Vec —</p><p id="c512" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我只在文本数据上应用word2vec，基本上我会将每个单词转换成一个句子的向量并求和。所以它将代表我们的一个文本。</p><p id="e437" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">看到下面的图片，你会明白—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/e72107625f75952ee231d25b1891edb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*23j6PIx4GCsZuD45"/></div></div></figure><p id="8283" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在的问题是，我将如何生成d-dim向量，所以这里我选择将其转换为100维向量，我已经用预训练的手套向量完成了它，一旦你下载了这个预训练的手套向量模型，然后你可以给出一个单词，它将返回100维向量。你可以在代码中看到如何做，是的，你可以从<a class="ae lb" href="https://www.kaggle.com/rtatman/glove-global-vectors-for-word-representation" rel="noopener ugc nofollow" target="_blank">这里</a>从kaggle下载手套向量模型，或者你可以在谷歌上搜索“手套向量100 d kaggle下载”，你会找到它。让我们看看代码—</p><figure class="lg lh li lj fd ii"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="019a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我就存成train_w2v，test_w2v。</p><p id="02a3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我们的所有功能集都准备好了，所以从这里我们将继续第一次削减模型。</p><h2 id="ff5f" class="kb kc hh bd kd ke kf kg kh ki kj kk kl ja km kn ko je kp kq kr ji ks kt ku kv bi translated">8.建模—</h2><p id="5f74" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">在kaggle比赛中他们建议使用RMSLE作为度量，为什么？因为RMSLE受异常值的影响较小，如果我们说我的数据中有异常值，现在如果我们计算mse，那么误差会非常高，所以如果我们使用mse或任何没有记录的数据，那么我们得到的误差，基于该误差，我们不能说我的模型是好是坏。 举例来说，假设我们在x_test中有三个数据，它们现在都是内联的，如果你的模型很好，那么它会给出很少的误差，现在如果我添加第四个x_test数据，它是离群值，那么现在当你评估你的模型时，你会得到很高的误差，你会认为模型很差，现在如果你用误差的对数代替误差，那么对数会做什么，它会压缩误差，并向你显示更好的误差。</p><p id="cdcb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在上面的例子中，你可以看到我是如何认为我的模型是不好的，因为那个异常点，但那是错误的，所以这就是log所做的事情。</p><p id="9e0b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这里，我将在y_train和x_train上进行最小最大缩放，我将只在y_train上拟合最小最大值，并转换y_train，在这里，我不会触摸y_test。参见代码—</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="8dc9" class="kb kc hh ll b fi lp lq l lr ls">scaler=MinMaxScaler()<br/>scaler.fit(np.array(y_train).reshape(-1,1))<br/>y_train_minmax=scaler.transform(np.array(y_train).reshape(-1,1))</span></pre><p id="8d65" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在的问题是我将如何评估我的模型，因为现在我的模型预测价格是按比例调整的格式，我们的y_test是原始的(未按比例调整),因此为此我将保存我们的y_train min和max，现在如果我有y_train的max和min，那么我可以按原始价格的比例转换我们的预测输出价格。</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="ca0e" class="kb kc hh ll b fi lp lq l lr ls">y_pred=model.predict(test_tfidf)</span><span id="76d1" class="kb kc hh ll b fi lt lq l lr ls"># converting out y_pred to original scale.<br/>y_pred1=(y_pred*y_train.max())-y_train.min()</span><span id="8c6a" class="kb kc hh ll b fi lt lq l lr ls"># calculating mse<br/>mean_squared_error(y_test,y_pred1)</span></pre><p id="7f5d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，首先我会做一个随机模型(像哑模型)，这样我们就可以看到我们的第一次切割模型比随机模型好，或者比随机模型差。</p><p id="37de" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在随机模型中，我将取y_train的平均值，并将其作为整个x_test的预测价格，然后计算mse，参见此处的代码——</p><pre class="lg lh li lj fd lk ll lm ln aw lo bi"><span id="9017" class="kb kc hh ll b fi lp lq l lr ls">avg_price=y_test_minmax.mean()<br/>predicted_y = [avg_price for i in range(test_tfidf.shape[0])]<br/>y_pred1=(np.array(predicted_y)*y_train.max())-y_train.min()<br/>print("mean_squared_error on Test Data using Random Model",mean_squared_error(y_test, y_pred1))</span></pre><p id="995f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当你运行这个程序的时候，你会得到<em class="mm">。46860 . 68868888661</em></p><p id="fdbe" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在你有一条线，你知道在这条线以下，你的模型是愚蠢的。</p><ol class=""><li id="dc8b" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">SGDRegression model — <br/>我用超参数调整将我的三个训练集(OHE、TF-IDF、WORD2VEC)逐一拟合在这个模型上。在这里，我得到了OHE数据的mse为1185，TFIDF数据的MSE为1263，W2V数据的MSE为1366。我可以看到OHE的数据给出了更好的结果。</li><li id="f0eb" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">LGBMRegressor模型— <br/>在这里，我得到了OHE数据的mse为1041，TFIDF数据的MSE为1002，W2V数据的MSE为1065。我可以看到OHE的数据给出了更好的结果。在这里，我得到了tfidf数据的最佳结果。</li><li id="4395" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">岭回归模型— <br/>这里我在OHE数据上得到了1108，在TFIDF数据上得到了1157，在W2V数据上得到了1303。我可以看到OHE的数据给出了更好的结果。在这里，我得到了OHE数据的最佳结果。</li><li id="f86d" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">Lasso回归模型— <br/>这里我得到了OHE数据的mse为1592，TFIDF数据的MSE为1672，W2V数据的MSE为1644。我可以看到OHE的数据给出了更好的结果。在这里，我得到了OHE数据的最佳结果。这是迄今为止最差的型号。</li><li id="9a7b" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">XGBRegressor模型— <br/>在这里，我得到了OHE数据的mse为1210，TFIDF数据的MSE为1236，W2V数据的MSE为1278。我可以看到OHE的数据给出了更好的结果。在这里，我得到了OHE数据的最佳结果。</li></ol><p id="4228" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这五个模型我已经尝试作为我的第一个削减模型，为更多的改善，这些结果你可以做更多的超参数调整，也许你应该得到一些更好的结果。</p><p id="0500" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，在一个地方查看所有型号的性能，这是迄今为止最好的结果—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/4379d729cfc9a664150573223fec04a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gSc7pbHXDXcvsyUH"/></div></div></figure><p id="7d0a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在上面我可以看到最好的模型和它的参数，所以最好的模型是LGBMRegressor，它给我们1002的误差，根据tf-idf数据训练，超参数是{'boosting_type': 'gbdt '，' learning_rate': 0.1，' max_depth': 8，' n_estimators': 200，' num_leaves': 60}。</p><h2 id="fbcd" class="kb kc hh bd kd ke kf kg kh ki kj kk kl ja km kn ko je kp kq kr ji ks kt ku kv bi translated">使用一些堆叠技术—</h2><p id="48bc" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated"><strong class="ir hi">集成技术— </strong></p><p id="6fc2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在继续，我已经实现了集成技术，作为集成技术，我已经使用了堆叠，并且我已经从我自己开始编码，首先做超参数调谐。我在meta_model、sample_size(在此基础上训练了我的基本模型)和base_models上进行了超参数调优。我已经在每个特性集(ohe、tfidf和w2v数据)上这样做了。</p><p id="654d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">基本上，为了做到这一点，我做了一些函数，通过调用它三次，我得到了三个带有超参数和错误的表(对于ohe数据、tfidf数据和w2v数据),我将向您展示下面的代码和结果→</p><figure class="lg lh li lj fd ii"><div class="bz dy l di"><div class="mk ml l"/></div></figure><figure class="lg lh li lj fd ii"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="a61a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当我在OHE数据的叠加回归量之上训练时，我得到了结果—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es mn"><img src="../Images/30983f88519ef3580f99e020f2e32e0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/0*feRJG8sbtvV7K6Sk"/></div></figure><p id="4194" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在tf-idf数据上—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es mo"><img src="../Images/7d5f5a7ffef8042598535a573084e7ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/0*UdqINN4NgaOzhqvr"/></div></figure><p id="dbe9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在word2vec数据上—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es mo"><img src="../Images/c29b89e9c09dc5899eba0ff08f607c8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/0*AiZNwPymJuzltUUL"/></div></figure><p id="d03b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当数据为OHE时，最好的结果为1009，基本模型为sgd_lgbm_ridge_lasso，每个样本大小为250000，元模型为岭回归模型。</p><p id="c502" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">使用带超参数调节的StackingCVRegressor进行堆叠— </strong></p><p id="c7c3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我将使用<strong class="ir hi"> StackingCVRegressor，</strong>使用它我可以更好地进行超参数调优。点击阅读<strong class="ir hi">StackingCVRegressor</strong><a class="ae lb" href="http://rasbt.github.io/mlxtend/user_guide/regressor/StackingCVRegressor/" rel="noopener ugc nofollow" target="_blank"><strong class="ir hi"/>。</a></p><p id="a027" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">参见下面的实现—</p><figure class="lg lh li lj fd ii"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="81ad" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当我在OHE数据上拟合上述实现时，我得到了这个结果—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/6ccca1fee32efad62c1663544d077e48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DGUWn71U3JQf47dI"/></div></div></figure><p id="8d16" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在tf-idf数据上—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/9cf423750bdb4ac42f31a8f4d1b8464e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oGloWu3hGYVCS-uN"/></div></div></figure><p id="df15" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在word2vec数据上—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/e32d71f2df0076ed1127ad8c59118296.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*t7dbvSKKAwIhWS0x"/></div></div></figure><p id="48af" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在上述结果中，当基本模型是sgd_lgbm_ridge_lasso且元模型是ridge时，OHE数据的最佳结果是982。</p><p id="8cab" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这是目前为止最好的结果。</p><p id="05b1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，我将在神经网络上拟合我的word2vec数据。</p><h2 id="83a4" class="kb kc hh bd kd ke kf kg kh ki kj kk kl ja km kn ko je kp kq kr ji ks kt ku kv bi translated">实现深度学习模型—</h2><p id="b0ae" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">对于深度学习模型，首先我将使用我的word2vec数据来训练它。我已经有w2v数据了。这是神经网络结构和神经网络训练的代码—</p><figure class="lg lh li lj fd ii"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="a477" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了训练神经网络，我使用了数据加载器，因为它在任何特定的时间占用较少的内存。</p><p id="143c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">通过在w2v数据上训练这个神经网络，我得到了mse 1011，这不是最好的结果，记住我在堆栈实现中得到了几乎982。</p><p id="09d8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">具有嵌入层的神经网络— </strong></p><p id="4550" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，我不会使用预先训练的word2vec来训练神经网络，我将通过嵌入层为每个单词(在分类和文本数据中)学习自己的向量。</p><p id="dc95" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了训练这个神经网络，我必须首先将每个分类列和文本列转换为整数序列，这是在keras预处理的帮助下完成的。假设我必须将item_description转换为sequence，为此，我首先将train_item_desc列与tokenizer(keras . preprocessing . tokenizer . fit _ on _ texts(x _ train))相匹配，然后使用texts_to_sequences将train_item_desc和test_item_desc列转换为sequence，之后我使用pad_sequencs方法对train和text进行填充，以便train_item_desc和test_item_desc中的每个数据长度相同。让我们看看下面的图片，以便更好地理解—</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/b37a9c6fb0864af3ddc3322dcb226dd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Nut9h7CkewxG9SxL"/></div></div></figure><p id="d3ab" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我已经完成了所有文本和分类列的编码，我还堆叠了所有数字列(你可以看到下面的代码部分)。</p><p id="6ffe" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们来看看模型结构的代码和拟合模型上的数据——</p><figure class="lg lh li lj fd ii"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="0e78" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在训练这个神经网络时，我得到了mse 893，这是迄今为止最小的误差。</p><p id="3e47" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最初，当你训练这个网络时，你会过度拟合你的数据，所以在遭遇中，我使用了不同的初始化器、退出和提前停止。</p><h2 id="8d92" class="kb kc hh bd kd ke kf kg kh ki kj kk kl ja km kn ko je kp kq kr ji ks kt ku kv bi translated">9.结果—</h2><p id="f8d1" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">下表显示了基于数据的模型最佳性能。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/062967e84b531a1198432534414a8381.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uOXqbRP_uQtca2_x"/></div></div></figure><p id="de62" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最佳模型是带嵌入层的神经网络模型，误差为893.9278</p><p id="ae6a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我已经在kaggle上提交了我的模型预测价格，我得到了0.65249的RMSLE。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/29697c65d38788948dacc1e35343bc4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0ezFqY9S7wSOCVJZ"/></div></div></figure><h2 id="af37" class="kb kc hh bd kd ke kf kg kh ki kj kk kl ja km kn ko je kp kq kr ji ks kt ku kv bi translated">10.结论和未来工作—</h2><ol class=""><li id="21aa" class="jn jo hh ir b is kw iw kx ja lc je ld ji le jm js jt ju jv bi translated">我们可以通过增加一个特征来改进我们的模型，这个特征将决定品牌名称是否存在。《出埃及记》如果品牌名称存在，则为1，如果不存在，则为0。如果我们这样做，那么误差可能会减少。</li><li id="1702" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">在这里，我没有使用tf-idf加权word2vec进行特征化，我们可以这样做，看看所有模型的表现如何。</li><li id="cc7c" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">为了填充缺失的品牌名称值，我们可以使用基于模型预测的填充技术。我们可以将brand_name出现的所有数据作为train_data，将brand_name缺失的数据作为测试数据，现在根据训练数据拟合模型并预测测试数据。但这将是一个棘手的问题，因为这里我们将brand_name作为target_variable，它是分类的，有这么多类别。我能想到的一种方法是，您可以从x_train中删除那些brand _ name在train中很少出现的行，例如。您可以删除出现少于5或10个的与brand_name相关的数据点，这样您可以减少target_variable中的类的数量。</li></ol><h2 id="3b47" class="kb kc hh bd kd ke kf kg kh ki kj kk kl ja km kn ko je kp kq kr ji ks kt ku kv bi translated">11.个人资料—</h2><p id="1acc" class="pw-post-body-paragraph ip iq hh ir b is kw iu iv iw kx iy iz ja ky jc jd je kz jg jh ji la jk jl jm ha bi translated">我的linkedin个人资料—<a class="ae lb" href="https://www.linkedin.com/in/vishwas-upadhyay-36b94b1b6/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/vishwas-upadhyay-36b94b1b6/</a></p><p id="be09" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">代码的Github链接—<a class="ae lb" href="https://github.com/vishwas-upadhyaya/mercari_price_suggestion" rel="noopener ugc nofollow" target="_blank">https://github . com/vish was-upadhyaya/mercari _ price _ suggestion</a></p><h2 id="514b" class="kb kc hh bd kd ke kf kg kh ki kj kk kl ja km kn ko je kp kq kr ji ks kt ku kv bi translated">12.参考文献—</h2><ol class=""><li id="d98f" class="jn jo hh ir b is kw iw kx ja lc je ld ji le jm js jt ju jv bi translated"><a class="ae lb" href="https://www.appliedaicourse.com/course/11/Applied-Machine-learning-course" rel="noopener ugc nofollow" target="_blank">https://www . Applied ai course . com/course/11/Applied-Machine-learning-course</a></li><li id="df87" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">https://machinelearningmastery.com/category/deep-learning/<a class="ae lb" href="https://machinelearningmastery.com/category/deep-learning/" rel="noopener ugc nofollow" target="_blank"/></li></ol></div></div>    
</body>
</html>