# PyCaret 101 â€”é€‚åˆåˆå­¦è€…

> åŸæ–‡ï¼š<https://medium.com/analytics-vidhya/pycaret-101-for-beginners-27d9aefd34c5?source=collection_archive---------1----------------------->

å¦‚ä½•å¼€å§‹ä½¿ç”¨ PyCaret è¿›è¡Œæ‰€æœ‰æœºå™¨å­¦ä¹ é¡¹ç›®

![](img/264779a37dad449da6cedc20ed6e7fec.png)

py caretâ€”â€”Python ä¸­çš„å¼€æºã€ä½ä»£ç æœºå™¨å­¦ä¹ åº“

# PyCaret

[PyCaret](https://www.pycaret.org) æ˜¯ä¸€ä¸ªå¼€æºã€ä½ä»£ç çš„æœºå™¨å­¦ä¹ åº“å’Œç«¯åˆ°ç«¯çš„æ¨¡å‹ç®¡ç†å·¥å…·ï¼Œå†…ç½®äº Python ä¸­ï¼Œç”¨äºè‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ å·¥ä½œæµã€‚å®ƒçš„æ˜“ç”¨æ€§ã€ç®€å•æ€§ä»¥åŠå¿«é€Ÿé«˜æ•ˆåœ°æ„å»ºå’Œéƒ¨ç½²ç«¯åˆ°ç«¯æœºå™¨å­¦ä¹ ç®¡é“çš„èƒ½åŠ›å°†ä¼šè®©æ‚¨å¤§åƒä¸€æƒŠã€‚

PyCaret æ˜¯ä¸€ä¸ªæ›¿ä»£çš„ä½ä»£ç åº“ï¼Œå¯ä»¥ç”¨å‡ è¡Œä»£ç ä»£æ›¿æ•°ç™¾è¡Œä»£ç ã€‚è¿™ä½¿å¾—å®éªŒå‘¨æœŸæˆå€åœ°å¿«é€Ÿå’Œæœ‰æ•ˆã€‚

PyCaret æ˜¯**ç®€å•æ˜“ç”¨ã€‚**py caret ä¸­æ‰§è¡Œçš„æ‰€æœ‰æ“ä½œéƒ½é¡ºåºå­˜å‚¨åœ¨ä¸€ä¸ª**æµæ°´çº¿**ä¸­ï¼Œè¯¥æµæ°´çº¿å¯¹äº**éƒ¨ç½²æ˜¯å®Œå…¨è‡ªåŠ¨åŒ–çš„ã€‚**æ— è®ºæ˜¯è¾“å…¥ç¼ºå¤±å€¼ã€ä¸€é”®ç¼–ç ã€è½¬æ¢åˆ†ç±»æ•°æ®ã€ç‰¹å¾å·¥ç¨‹ï¼Œç”šè‡³æ˜¯è¶…å‚æ•°è°ƒæ•´ï¼ŒPyCaret éƒ½å®ç°äº†è‡ªåŠ¨åŒ–ã€‚è¦äº†è§£ PyCaret çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·è§‚çœ‹è¿™æ®µ 1 åˆ†é’Ÿçš„è§†é¢‘ã€‚

py caretâ€”â€”Python ä¸­çš„å¼€æºã€ä½ä»£ç æœºå™¨å­¦ä¹ åº“

# PyCaret çš„ç‰¹ç‚¹

![](img/e24ce956f3fc7f2d4f812bbdbfce84fc.png)

ä½œè€…å›¾ç‰‡

# PyCaret ä¸­çš„æ¨¡å—

PyCaret æ˜¯ä¸€ä¸ªæ¨¡å—åŒ–çš„åº“ï¼Œåˆ†ä¸ºå¤šä¸ªæ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—ä»£è¡¨ä¸€ä¸ªæœºå™¨å­¦ä¹ ç”¨ä¾‹ã€‚åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œæ”¯æŒä»¥ä¸‹æ¨¡å—:

![](img/a46b47dea4a92f56e0ca7c3b4aa3d5f1.png)

ä½œè€…å›¾ç‰‡ PyCaret ä¸­æ”¯æŒçš„æœºå™¨å­¦ä¹ ç”¨ä¾‹

**æ—¶é—´åºåˆ—æ¨¡å—æ­£åœ¨åˆ¶ä½œä¸­ï¼Œå°†åœ¨ä¸‹ä¸€ä¸ªä¸»è¦ç‰ˆæœ¬ä¸­æä¾›ã€‚*

# æ­£åœ¨å®‰è£… PyCaret

å®‰è£… PyCaret éå¸¸å®¹æ˜“ï¼Œåªéœ€è¦å‡ åˆ†é’Ÿã€‚æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒæ¥é¿å…ä¸å…¶ä»–åº“çš„æ½œåœ¨å†²çªã€‚

PyCaret çš„é»˜è®¤å®‰è£…æ˜¯ pycaret çš„ç²¾ç®€ç‰ˆæœ¬ï¼Œåªå®‰è£…è¿™é‡Œåˆ—å‡ºçš„ç¡¬ä¾èµ–é¡¹ã€‚

```
**# install slim version (default)** pip install pycaret**# install the full version**
pip install pycaret[full]
```

å½“æ‚¨å®‰è£… pycaret çš„å®Œæ•´ç‰ˆæœ¬æ—¶ï¼Œè¿™é‡Œåˆ—å‡ºçš„æ‰€æœ‰å¯é€‰ä¾èµ–é¡¹[ä¹Ÿä¼šè¢«å®‰è£…ã€‚](https://github.com/pycaret/pycaret/blob/master/requirements-optional.txt)

![](img/01d4b94ff93aeb5780b17221c6a715a2.png)

æŒ‰æ•°å­—æ’åˆ—çš„ PyCaret æŒ‰ä½œè€…æ’åˆ—çš„å›¾ç‰‡

# ğŸ‘‰æˆ‘ä»¬å¼€å§‹å§

åœ¨æˆ‘å‘æ‚¨å±•ç¤ºä½¿ç”¨ PyCaret è¿›è¡Œæœºå™¨å­¦ä¹ æœ‰å¤šç®€å•ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆä»è¾ƒé«˜çš„å±‚é¢æ¥è°ˆè°ˆæœºå™¨å­¦ä¹ çš„ç”Ÿå‘½å‘¨æœŸ:

![](img/9a6eca7769058208d4e599bf5af8cf11.png)

æœºå™¨å­¦ä¹ ç”Ÿå‘½å‘¨æœŸ-æŒ‰ä½œè€…åˆ†ç±»çš„å›¾ç‰‡(ä»å·¦è‡³å³é˜…è¯»)

*   **ä¸šåŠ¡é—®é¢˜â€”** è¿™æ˜¯æœºå™¨å­¦ä¹ å·¥ä½œæµç¨‹çš„ç¬¬ä¸€æ­¥ã€‚è¿™å¯èƒ½éœ€è¦å‡ å¤©åˆ°å‡ å‘¨çš„æ—¶é—´æ¥å®Œæˆï¼Œè¿™å–å†³äºç”¨ä¾‹ä»¥åŠé—®é¢˜çš„å¤æ‚æ€§ã€‚æ­£æ˜¯åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæ•°æ®ç§‘å­¦å®¶ä¸ä¸»é¢˜ä¸“å®¶(SME)ä¼šé¢ï¼Œä»¥äº†è§£é—®é¢˜ï¼Œé‡‡è®¿å…³é”®åˆ©ç›Šç›¸å…³è€…ï¼Œæ”¶é›†ä¿¡æ¯ï¼Œå¹¶è®¾å®šé¡¹ç›®çš„æ€»ä½“é¢„æœŸã€‚
*   **æ•°æ®æ¥æº& ETL â€”** ä¸€æ—¦ç†è§£äº†é—®é¢˜ï¼Œæ¥ä¸‹æ¥å°±è¦ä½¿ç”¨é‡‡è®¿ä¸­è·å¾—çš„ä¿¡æ¯ä»ä¼ä¸šæ•°æ®åº“ä¸­è·å–æ•°æ®ã€‚
*   **æ¢ç´¢æ€§æ•°æ®åˆ†æ(EDA)â€”â€”**å»ºæ¨¡è¿˜æ²¡å¼€å§‹ã€‚EDA æ˜¯åˆ†æåŸå§‹æ•°æ®çš„åœ°æ–¹ã€‚æ‚¨çš„ç›®æ ‡æ˜¯æ¢ç´¢æ•°æ®å¹¶è¯„ä¼°æ•°æ®è´¨é‡ã€ç¼ºå¤±å€¼ã€ç‰¹å¾åˆ†å¸ƒã€ç›¸å…³æ€§ç­‰ã€‚
*   **æ•°æ®å‡†å¤‡â€”** ç°åœ¨è¯¥å‡†å¤‡æ•°æ®æ¨¡å‹åŸ¹è®­äº†ã€‚è¿™åŒ…æ‹¬å°†æ•°æ®åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€è¾“å…¥ç¼ºå¤±å€¼ã€ä¸€é”®ç¼–ç ã€ç›®æ ‡ç¼–ç ã€ç‰¹å¾å·¥ç¨‹ã€ç‰¹å¾é€‰æ‹©ç­‰ã€‚
*   **æ¨¡ç‰¹åŸ¹è®­&é€‰æ‹”â€”** è¿™æ˜¯æ¯ä¸ªäººéƒ½ä¸ºä¹‹å…´å¥‹çš„ä¸€æ­¥ã€‚è¿™åŒ…æ‹¬è®­ç»ƒä¸€ç³»åˆ—æ¨¡å‹ã€è°ƒæ•´è¶…å‚æ•°ã€æ¨¡å‹é›†åˆã€è¯„ä¼°æ€§èƒ½æŒ‡æ ‡ã€æ¨¡å‹åˆ†æ(å¦‚ AUCã€æ··æ·†çŸ©é˜µã€æ®‹å·®ç­‰),ä»¥åŠæœ€ç»ˆé€‰æ‹©ä¸€ä¸ªæœ€ä½³æ¨¡å‹éƒ¨ç½²åˆ°ç”Ÿäº§ä¸­ä»¥ä¾›ä¸šåŠ¡ä½¿ç”¨ã€‚
*   **éƒ¨ç½²&ç›‘æ§â€”** è¿™æ˜¯æœ€åä¸€æ­¥ï¼Œä¸»è¦æ˜¯å…³äº MLOpsã€‚è¿™åŒ…æ‹¬æ‰“åŒ…æ‚¨çš„æœ€ç»ˆæ¨¡å‹ã€åˆ›å»º docker æ˜ åƒã€ç¼–å†™è¯„åˆ†è„šæœ¬ï¼Œç„¶åè®©å®ƒä»¬ä¸€èµ·å·¥ä½œï¼Œæœ€åå°†å…¶å‘å¸ƒä¸º APIï¼Œå¯ç”¨äºè·å¾—å¯¹é€šè¿‡ç®¡é“ä¼ è¾“çš„æ–°æ•°æ®çš„é¢„æµ‹ã€‚

æ—§çš„æ–¹æ³•éå¸¸éº»çƒ¦ã€å†—é•¿ï¼Œå¹¶ä¸”éœ€è¦å¤§é‡çš„æŠ€æœ¯çŸ¥è¯†ï¼Œæˆ‘å¯èƒ½æ— æ³•åœ¨ä¸€ä¸ªæ•™ç¨‹ä¸­æ¶µç›–å®ƒã€‚ç„¶è€Œï¼Œåœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨ PyCaret æ¥æ¼”ç¤ºå¯¹äºä¸€ä¸ªæ•°æ®ç§‘å­¦å®¶æ¥è¯´ï¼Œéå¸¸é«˜æ•ˆåœ°å®Œæˆæ‰€æœ‰è¿™äº›å·¥ä½œæ˜¯å¤šä¹ˆå®¹æ˜“ã€‚

# ğŸ‘‰å•†ä¸šé—®é¢˜

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨è¾¾é¡¿å•†å­¦é™¢éå¸¸å—æ¬¢è¿çš„æ¡ˆä¾‹ç ”ç©¶ï¼Œå‘è¡¨åœ¨[å“ˆä½›å•†å­¦é™¢](https://hbsp.harvard.edu/product/UV0869-PDF-ENG)ä¸Šã€‚è¿™ä¸ªæ¡ˆå­æ˜¯å…³äºä¸¤ä¸ªæœªæ¥å°†è¦ç»“å©šçš„äººçš„æ•…äº‹ã€‚åå«*æ ¼é›·æ ¼*çš„å®¶ä¼™æƒ³ä¹°ä¸€æšæˆ’æŒ‡å‘ä¸€ä¸ªåå«*èæ‹‰*çš„å¥³å­©æ±‚å©šã€‚é—®é¢˜æ˜¯æ‰¾åˆ°èæ‹‰ä¼šå–œæ¬¢çš„æˆ’æŒ‡ï¼Œä½†åœ¨ä»–çš„å¯†å‹å»ºè®®åï¼Œæ ¼é›·æ ¼å†³å®šä¹°ä¸€é¢—é’»çŸ³ï¼Œè¿™æ ·èæ‹‰å°±å¯ä»¥å†³å®šå¥¹çš„é€‰æ‹©ã€‚ç„¶åï¼Œæ ¼é›·æ ¼æ”¶é›†äº† 6000 é¢—é’»çŸ³çš„ä»·æ ¼å’Œåˆ‡å‰²ã€é¢œè‰²ã€å½¢çŠ¶ç­‰å±æ€§æ•°æ®ã€‚

# ğŸ‘‰æ•°æ®

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨ä¸€ä¸ªæ•°æ®é›†ï¼Œè¯¥æ•°æ®é›†æ¥è‡ªè¾¾é¡¿å•†å­¦é™¢ä¸€ä¸ªéå¸¸å—æ¬¢è¿çš„æ¡ˆä¾‹ç ”ç©¶ï¼Œå‘è¡¨åœ¨[å“ˆä½›å•†ä¸š](https://hbsp.harvard.edu/product/UV0869-PDF-ENG)ä¸Šã€‚æœ¬æ•™ç¨‹çš„ç›®æ ‡æ˜¯æ ¹æ®é’»çŸ³çš„é‡é‡ã€åˆ‡å‰²ã€é¢œè‰²ç­‰å±æ€§æ¥é¢„æµ‹é’»çŸ³çš„ä»·æ ¼ã€‚æ‚¨å¯ä»¥ä» [PyCaret çš„å­˜å‚¨åº“](https://github.com/pycaret/pycaret/tree/master/datasets)ä¸‹è½½æ•°æ®é›†ã€‚

```
**# load the dataset from pycaret** from pycaret.datasets import get_data
data = get_data('diamond')
```

![](img/c4d712bd222f99b6b9520df1c0fb94b8.png)

æ•°æ®ä¸­çš„æ ·æœ¬è¡Œ

# ğŸ‘‰æ¢ç´¢æ€§æ•°æ®åˆ†æ

è®©æˆ‘ä»¬åšä¸€äº›å¿«é€Ÿå¯è§†åŒ–æ¥è¯„ä¼°ç‹¬ç«‹ç‰¹å¾(é‡é‡ã€åˆ‡å‰²ã€é¢œè‰²ã€å‡€åº¦ç­‰)ä¹‹é—´çš„å…³ç³»ã€‚)ä¸ç›®æ ‡å˜é‡å³`Price`

```
**# plot scatter carat_weight and Price**
import plotly.express as px
fig = px.scatter(x=data['Carat Weight'], y=data['Price'], 
                 facet_col = data['Cut'], opacity = 0.25, template = 'plotly_dark', trendline='ols',
                 trendline_color_override = 'red', title = 'SARAH GETS A DIAMOND - A CASE STUDY')
fig.show()
```

![](img/672efc277f36fb9b451658f6b3f0282a.png)

è®©æˆ‘ä»¬æ£€æŸ¥ç›®æ ‡å˜é‡çš„åˆ†å¸ƒã€‚

```
**# plot histogram**
fig = px.histogram(data, x=["Price"], template = 'plotly_dark', title = 'Histogram of Price')
fig.show()
```

![](img/5b93ebfe25f8ca0d68cf21cbf19cd512.png)

è¯·æ³¨æ„ï¼Œ`Price`çš„åˆ†å¸ƒæ˜¯å³åçš„ï¼Œæˆ‘ä»¬å¯ä»¥å¿«é€ŸæŸ¥çœ‹å¯¹æ•°å˜æ¢æ˜¯å¦å¯ä»¥ä½¿`Price`æ¥è¿‘æ­£æ€ï¼Œä»è€Œç»™å‡è®¾æ­£æ€çš„ç®—æ³•ä¸€ä¸ªæœºä¼šã€‚

```
import numpy as np**# create a copy of data**
data_copy = data.copy()**# create a new feature Log_Price**
data_copy['Log_Price'] = np.log(data['Price'])**# plot histogram**
fig = px.histogram(data_copy, x=["Log_Price"], title = 'Histgram of Log Price', template = 'plotly_dark')
fig.show()
```

![](img/8cb41e897ba12ab7f54b289c02c7f8d7.png)

è¿™è¯å®äº†æˆ‘ä»¬çš„å‡è®¾ã€‚è¿™ç§è½¬æ¢å°†å¸®åŠ©æˆ‘ä»¬æ‘†è„±åæ€ï¼Œä½¿ç›®æ ‡å˜é‡æ¥è¿‘æ­£æ€ã€‚åŸºäºæ­¤ï¼Œæˆ‘ä»¬å°†åœ¨è®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹ä¹‹å‰è½¬æ¢`Price`å˜é‡ã€‚

# ğŸ‘‰æ•°æ®å‡†å¤‡

å¯¹äº PyCaret ä¸­çš„æ‰€æœ‰æ¨¡å—æ¥è¯´ï¼Œ`setup`æ˜¯ä»»ä½•ä½¿ç”¨ PyCaret çš„æœºå™¨å­¦ä¹ å®éªŒä¸­çš„ç¬¬ä¸€æ­¥ï¼Œä¹Ÿæ˜¯å”¯ä¸€ä¸€æ­¥ã€‚è¯¥å‡½æ•°è´Ÿè´£è®­ç»ƒæ¨¡å‹ä¹‹å‰æ‰€éœ€çš„æ‰€æœ‰æ•°æ®å‡†å¤‡ã€‚é™¤äº†æ‰§è¡Œä¸€äº›åŸºæœ¬çš„é»˜è®¤å¤„ç†ä»»åŠ¡ï¼ŒPyCaret è¿˜æä¾›äº†ä¸€ç³»åˆ—é¢„å¤„ç†åŠŸèƒ½ã€‚è¦äº†è§£ PyCaret ä¸­æ‰€æœ‰é¢„å¤„ç†åŠŸèƒ½çš„æ›´å¤šä¿¡æ¯ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹è¿™ä¸ª[é“¾æ¥](https://pycaret.org/preprocessing/)ã€‚

```
**# initialize setup**
from pycaret.regression import *
s = setup(data, target = 'Price', transform_target = True, log_experiment = True, experiment_name = 'diamond')
```

![](img/82f15bd34610cd17a9287a402880e916.png)

pycaret.regression æ¨¡å—ä¸­çš„è®¾ç½®å‡½æ•°

å½“æ‚¨åœ¨ PyCaret ä¸­åˆå§‹åŒ–`setup`å‡½æ•°æ—¶ï¼Œå®ƒä¼šåˆ†ææ•°æ®é›†å¹¶æ¨æ–­æ‰€æœ‰è¾“å…¥è¦ç´ çš„æ•°æ®ç±»å‹ã€‚å¦‚æœæ‰€æœ‰æ•°æ®ç±»å‹éƒ½æ¨æ–­æ­£ç¡®ï¼Œæ‚¨å¯ä»¥æŒ‰ enter é”®ç»§ç»­ã€‚

è¯·æ³¨æ„:

*   æˆ‘å·²ç»é€šè¿‡äº†`log_experiment = True`å’Œ`experiment_name = 'diamond'`ï¼Œè¿™å°†å‘Šè¯‰ PyCaret åœ¨æ‚¨è¿›è¡Œå»ºæ¨¡é˜¶æ®µæ—¶è‡ªåŠ¨è®°å½•æ‰€æœ‰çš„åº¦é‡ã€è¶…å‚æ•°å’Œæ¨¡å‹å·¥ä»¶ã€‚ç”±äºä¸ [MLflow](https://www.mlflow.org/) çš„é›†æˆï¼Œè¿™æ˜¯å¯èƒ½çš„ã€‚
*   è¿˜æœ‰ï¼Œæˆ‘åœ¨`setup`é‡Œé¢ç”¨è¿‡`transform_target = True`ã€‚PyCaret å°†ä½¿ç”¨ box-cox å˜æ¢åœ¨å¹•åå˜æ¢`Price`å˜é‡ã€‚å®ƒä»¥ç±»ä¼¼äºæ—¥å¿—è½¬æ¢*(æŠ€æœ¯ä¸Šä¸åŒ)*çš„æ–¹å¼å½±å“æ•°æ®çš„åˆ†å¸ƒã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº box-cox å˜æ¢çš„çŸ¥è¯†ï¼Œä½ å¯ä»¥å‚è€ƒè¿™ä¸ª[é“¾æ¥](https://onlinestatbook.com/2/transformations/box-cox.html)ã€‚

![](img/e69a646ca557dab66a433f717f222538.png)

è®¾ç½®çš„è¾“å‡ºâ€”ä¸ºæ˜¾ç¤ºè€Œæˆªæ–­

# ğŸ‘‰æ¨¡å‹è®­ç»ƒå’Œé€‰æ‹©

ç°åœ¨æ•°æ®å·²ç»å‡†å¤‡å¥½è¿›è¡Œå»ºæ¨¡ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨`compare_models`å‡½æ•°å¼€å§‹è®­ç»ƒè¿‡ç¨‹ã€‚å®ƒå°†è®­ç»ƒæ¨¡å‹åº“ä¸­æ‰€æœ‰å¯ç”¨çš„ç®—æ³•ï¼Œå¹¶ä½¿ç”¨ k-fold äº¤å‰éªŒè¯è¯„ä¼°å¤šä¸ªæ€§èƒ½æŒ‡æ ‡ã€‚

```
**# compare all models**
best = compare_models()
```

![](img/3e65d11e5a378ca6e41c918bf5357e68.png)

compare_models çš„è¾“å‡º

```
**# check the residuals of trained model**
plot_model(best, plot = 'residuals_interactive')
```

![](img/d42b707ff2b4f0f3885a3959b30a2487.png)

æœ€ä½³æ¨¡å‹çš„æ®‹å·®å’Œ QQ å›¾

```
**# check feature importance**
plot_model(best, plot = 'feature')
```

![](img/e477a937e33b06776cc3167ca37bd6fc.png)

# å®Œæˆå¹¶ä¿å­˜ç®¡é“

ç°åœ¨è®©æˆ‘ä»¬æœ€ç»ˆç¡®å®šæœ€ä½³æ¨¡å‹ï¼Œå³åœ¨åŒ…æ‹¬æµ‹è¯•é›†åœ¨å†…çš„æ•´ä¸ªæ•°æ®é›†ä¸Šè®­ç»ƒæœ€ä½³æ¨¡å‹ï¼Œç„¶åå°†ç®¡é“ä¿å­˜ä¸º pickle æ–‡ä»¶ã€‚

```
**# finalize the model**
final_best = finalize_model(best)**# save model to disk** save_model(final_best, 'diamond-pipeline')
```

`save_model`åŠŸèƒ½å°†æŠŠæ•´ä¸ªç®¡é“(åŒ…æ‹¬æ¨¡å‹)ä¿å­˜ä¸ºæœ¬åœ°ç£ç›˜ä¸Šçš„ pickle æ–‡ä»¶ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä¼šå°†æ–‡ä»¶ä¿å­˜åœ¨ç¬”è®°æœ¬æˆ–è„šæœ¬æ‰€åœ¨çš„æ–‡ä»¶å¤¹ä¸­ï¼Œä½†æ˜¯å¦‚æœæ‚¨æ„¿æ„ï¼Œä¹Ÿå¯ä»¥ä¼ é€’å®Œæ•´çš„è·¯å¾„:

```
save_model(final_best, 'c:/users/moez/models/diamond-pipeline'
```

# ğŸ‘‰éƒ¨ç½²

è¿˜è®°å¾—æˆ‘ä»¬åœ¨è®¾ç½®å‡½æ•°ä¸­é€šè¿‡äº†`log_experiment = True`å’Œ`experiment_name = 'diamond'`ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ PyCaret åœ¨ MLflow çš„å¸®åŠ©ä¸‹åœ¨å¹•åå®ç°äº†ä»€ä¹ˆã€‚è®©æˆ‘ä»¬å¯åŠ¨ MLflow æœåŠ¡å™¨æ¥çœ‹çœ‹è¿™ä¸ªç¥å¥‡çš„è¿‡ç¨‹:

```
**# within notebook (notice ! sign infront)** !mlflow ui**# on command line in the same folder** mlflow ui
```

ç°åœ¨æ‰“å¼€ä½ çš„æµè§ˆå™¨ï¼Œè¾“å…¥â€œhttps://localhost:5000â€ã€‚å®ƒå°†æ‰“å¼€è¿™æ ·ä¸€ä¸ªç”¨æˆ·ç•Œé¢:

![](img/fd265053d73bee186da5f153f12b0ae9.png)

[https://localhost:5000](https://localhost:5000)

ä¸Šè¡¨ä¸­çš„æ¯ä¸ªæ¡ç›®ä»£è¡¨ä¸€ä¸ªè®­ç»ƒè¿è¡Œï¼Œè¯¥è¿è¡Œäº§ç”Ÿä¸€ä¸ªè®­ç»ƒç®¡é“å’Œä¸€å †å…ƒæ•°æ®ï¼Œä¾‹å¦‚è¿è¡Œçš„æ—¥æœŸæ—¶é—´ã€æ€§èƒ½åº¦é‡ã€æ¨¡å‹è¶…å‚æ•°ã€æ ‡ç­¾ç­‰ã€‚è®©æˆ‘ä»¬ç‚¹å‡»å…¶ä¸­ä¸€ä¸ªæ¨¡å‹:

![](img/4f0d3f07bfd0ff293d50d5a54c6a1518.png)

ç¬¬ä¸€éƒ¨åˆ†â€” CatBoost å›å½’å™¨

![](img/ec90154d1f2689d5574ef8e2fd88439a.png)

ç¬¬äºŒéƒ¨åˆ†â€” CatBoost å›å½’å™¨(ç»­)

![](img/331a0f151e6f61975450427fc6a9b375.png)

ç¬¬ä¸‰éƒ¨åˆ†â€” CatBoost å›å½’å™¨

æ³¨æ„ï¼Œæ‚¨æœ‰ä¸€ä¸ª`logged_model`çš„åœ°å€è·¯å¾„ã€‚è¿™æ˜¯å¸¦æœ‰ Catboost å›å½’å™¨çš„è®­ç»ƒç®¡é“ã€‚æ‚¨å¯ä»¥ä½¿ç”¨`load_model`å‡½æ•°è¯»å–è¯¥ç®¡é“ã€‚

```
**# load model**
from pycaret.regression import load_model
pipeline = load_model('C:/Users/moezs/mlruns/1/b8c10d259b294b28a3e233a9d2c209c0/artifacts/model/model')**# print pipeline** print(pipeline)
```

![](img/66b8bbe7f05a23bc9b9bf095c8fb5ec8.png)

æ‰“å°è¾“å‡º(ç®¡é“)

ç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªç®¡é“æ¥ç”Ÿæˆå¯¹æ–°æ•°æ®çš„é¢„æµ‹

```
**# create a copy of data and drop Price** data2 = data.copy()
data2.drop('Price', axis=1, inplace=True)**# generate predictions** from pycaret.regression import predict_model
predictions = predict_model(pipeline, data=data2)
predictions.head()
```

![](img/5eaa4ee08186c6d84521c10e46d1ff29.png)

ä»ç®¡é“ç”Ÿæˆçš„é¢„æµ‹

å‘œå“‡ï¼æˆ‘ä»¬ç°åœ¨ä»è®­ç»ƒæœ‰ç´ çš„ç®¡é“ä¸­å¾—åˆ°æ¨è®ºã€‚æ­å–œï¼Œå¦‚æœè¿™æ˜¯ä½ çš„ç¬¬ä¸€æ¬¡ã€‚è¯·æ³¨æ„ï¼Œæ‰€æœ‰è½¬æ¢ï¼Œå¦‚ç›®æ ‡è½¬æ¢ã€ä¸€é”®ç¼–ç ã€ç¼ºå¤±å€¼æ’è¡¥ç­‰ã€‚è‡ªåŠ¨åœ¨å¹•åå‘ç”Ÿã€‚ä½ å¾—åˆ°ä¸€ä¸ªå®é™…è§„æ¨¡çš„é¢„æµ‹æ•°æ®æ¡†æ¶ï¼Œè¿™å°±æ˜¯ä½ æ‰€å…³å¿ƒçš„ã€‚

![](img/0374cbe6299d0e4f3576b4fa6b87abac.png)

ä½œè€…å›¾ç‰‡

![](img/3ff485bc78b79f58ed85115d317b8a5d.png)

ä½œè€…å›¾ç‰‡

ä½¿ç”¨ Python ä¸­çš„è¿™ä¸ªè½»é‡çº§å·¥ä½œæµè‡ªåŠ¨åŒ–åº“ï¼Œæ‚¨å¯ä»¥å®ç°çš„ç›®æ ‡æ˜¯æ— é™çš„ã€‚å¦‚æœä½ è§‰å¾—è¿™å¾ˆæœ‰ç”¨ï¼Œè¯·ä¸è¦å¿˜è®°ç»™æˆ‘ä»¬ GitHub åº“ä¸Šçš„â­ï¸ã€‚

æƒ³äº†è§£æ›´å¤šå…³äº PyCaret çš„ä¿¡æ¯ï¼Œè¯·åœ¨ LinkedIn å’Œ Youtube ä¸Šå…³æ³¨æˆ‘ä»¬ã€‚

åŠ å…¥æˆ‘ä»¬çš„ä¼‘é—²é¢‘é“ã€‚é‚€è¯·é“¾æ¥[æ­¤å¤„](https://join.slack.com/t/pycaret/shared_invite/zt-p7aaexnl-EqdTfZ9U~mF0CwNcltffHg)ã€‚

# æ‚¨å¯èƒ½è¿˜å¯¹ä»¥ä¸‹å†…å®¹æ„Ÿå…´è¶£:

[ä½¿ç”¨ PyCaret 2.0](https://towardsdatascience.com/build-your-own-automl-in-power-bi-using-pycaret-8291b64181d)
[åœ¨ Power BI ä¸­æ„å»ºæ‚¨è‡ªå·±çš„ AutoML ä½¿ç”¨ Docker](https://towardsdatascience.com/deploy-machine-learning-pipeline-on-cloud-using-docker-container-bec64458dc01)
[åœ¨ Azure ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“åœ¨ Google Kubernetes å¼•æ“ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“](https://towardsdatascience.com/deploy-machine-learning-model-on-google-kubernetes-engine-94daac85108b)
[åœ¨ AWS Fargate ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“](https://towardsdatascience.com/deploy-machine-learning-pipeline-on-aws-fargate-eb6e1c50507)
[æ„å»ºå¹¶éƒ¨ç½²æ‚¨çš„ç¬¬ä¸€ä¸ªæœºå™¨å­¦ä¹  web åº”ç”¨](https://towardsdatascience.com/build-and-deploy-your-first-machine-learning-web-app-e020db344a99)
[ä½¿ç”¨ AWS Fargate server less](https://towardsdatascience.com/deploy-pycaret-and-streamlit-app-using-aws-fargate-serverless-infrastructure-8b7d7c0584c2)
[éƒ¨ç½² PyCaret å’Œ Streamlit åº”ç”¨](https://towardsdatascience.com/build-and-deploy-machine-learning-web-app-using-pycaret-and-streamlit-28883a569104)

# é‡è¦é“¾æ¥

[æ–‡æ¡£](https://pycaret.readthedocs.io/en/latest/installation.html)
[åšå®¢](/@moez_62905)
[GitHub](http://www.github.com/pycaret/pycaret)
[stack overflow](https://stackoverflow.com/questions/tagged/pycaret)
[å®‰è£… PyCaret](https://pycaret.readthedocs.io/en/latest/installation.html) [ç¬”è®°æœ¬æ•™ç¨‹](https://pycaret.readthedocs.io/en/latest/tutorials.html) [è´¡çŒ®äº PyCaret](https://pycaret.readthedocs.io/en/latest/contribute.html)

# æƒ³äº†è§£æŸä¸ªç‰¹å®šæ¨¡å—ï¼Ÿ

å•å‡»ä¸‹é¢çš„é“¾æ¥æŸ¥çœ‹æ–‡æ¡£å’Œå·¥ä½œç¤ºä¾‹ã€‚

[åˆ†ç±»](https://pycaret.readthedocs.io/en/latest/api/classification.html) [å›å½’](https://pycaret.readthedocs.io/en/latest/api/regression.html)
[èšç±»](https://pycaret.readthedocs.io/en/latest/api/clustering.html)
å¼‚å¸¸æ£€æµ‹
[è‡ªç„¶è¯­è¨€å¤„ç†](https://pycaret.readthedocs.io/en/latest/api/nlp.html) [å…³è”è§„åˆ™æŒ–æ˜](https://pycaret.readthedocs.io/en/latest/api/arules.html)

# æ‚¨å¯èƒ½å¯¹ä»¥ä¸‹æ•™ç¨‹æ„Ÿå…´è¶£:

[](https://towardsdatascience.com/easy-mlops-with-pycaret-mlflow-7fbcbf1e38c6) [## ä½¿ç”¨ PyCaret + MLflow è½»æ¾å®ç° MLOps

### ä¸€ä¸ªåˆå­¦è€…å‹å¥½çš„ï¼Œä¸€æ­¥ä¸€æ­¥çš„æ•™ç¨‹ï¼Œä½¿ç”¨ PyCaret åœ¨ä½ çš„æœºå™¨å­¦ä¹ å®éªŒä¸­é›†æˆ MLOps

towardsdatascience.com](https://towardsdatascience.com/easy-mlops-with-pycaret-mlflow-7fbcbf1e38c6) [](https://towardsdatascience.com/write-and-train-your-own-custom-machine-learning-models-using-pycaret-8fa76237374e) [## ä½¿ç”¨ PyCaret ç¼–å†™å’Œè®­ç»ƒæ‚¨è‡ªå·±çš„è‡ªå®šä¹‰æœºå™¨å­¦ä¹ æ¨¡å‹

towardsdatascience.com](https://towardsdatascience.com/write-and-train-your-own-custom-machine-learning-models-using-pycaret-8fa76237374e) [](https://towardsdatascience.com/build-with-pycaret-deploy-with-fastapi-333c710dc786) [## ç”¨ PyCaret æ„å»ºï¼Œç”¨ FastAPI éƒ¨ç½²

### ä¸€æ­¥ä¸€æ­¥ï¼Œåˆå­¦è€…å‹å¥½çš„æ•™ç¨‹ï¼Œå¦‚ä½•å»ºç«‹ä¸€ä¸ªç«¯åˆ°ç«¯çš„æœºå™¨å­¦ä¹ ç®¡é“ä¸ PyCaret å’Œâ€¦

towardsdatascience.com](https://towardsdatascience.com/build-with-pycaret-deploy-with-fastapi-333c710dc786) [](https://towardsdatascience.com/time-series-anomaly-detection-with-pycaret-706a6e2b2427) [## åŸºäº PyCaret çš„æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹

### ä½¿ç”¨ PyCaret å¯¹æ—¶é—´åºåˆ—æ•°æ®è¿›è¡Œæ— ç›‘ç£å¼‚å¸¸æ£€æµ‹çš„åˆ†æ­¥æ•™ç¨‹

towardsdatascience.com](https://towardsdatascience.com/time-series-anomaly-detection-with-pycaret-706a6e2b2427) [](https://towardsdatascience.com/supercharge-your-machine-learning-experiments-with-pycaret-and-gradio-5932c61f80d9) [## ä½¿ç”¨ PyCaret å’Œ Gradio å¢å¼ºæ‚¨çš„æœºå™¨å­¦ä¹ å®éªŒ

### å¿«é€Ÿå¼€å‘æœºå™¨å­¦ä¹ ç®¡é“å¹¶ä¸ä¹‹äº¤äº’çš„å¾ªåºæ¸è¿›æ•™ç¨‹

towardsdatascience.com](https://towardsdatascience.com/supercharge-your-machine-learning-experiments-with-pycaret-and-gradio-5932c61f80d9) [](https://towardsdatascience.com/multiple-time-series-forecasting-with-pycaret-bc0a779a22fe) [## åŸºäº PyCaret çš„å¤šæ—¶é—´åºåˆ—é¢„æµ‹

### ä½¿ç”¨ PyCaret é¢„æµ‹å¤šä¸ªæ—¶é—´åºåˆ—çš„åˆ†æ­¥æ•™ç¨‹

towardsdatascience.com](https://towardsdatascience.com/multiple-time-series-forecasting-with-pycaret-bc0a779a22fe) [](https://towardsdatascience.com/time-series-forecasting-with-pycaret-regression-module-237b703a0c63) [## ç”¨ PyCaret å›å½’æ¨¡å—è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹

### ä½¿ç”¨ PyCaret è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹çš„åˆ†æ­¥æ•™ç¨‹

towardsdatascience.com](https://towardsdatascience.com/time-series-forecasting-with-pycaret-regression-module-237b703a0c63) [](https://towardsdatascience.com/5-things-you-are-doing-wrong-in-pycaret-e01981575d2a) [## PyCaret ä¸­ä½ åšé”™çš„ 5 ä»¶äº‹

### æ¥è‡ª PyCaret çš„åˆ›é€ è€…

towardsdatascience.com](https://towardsdatascience.com/5-things-you-are-doing-wrong-in-pycaret-e01981575d2a) [](https://towardsdatascience.com/github-is-the-best-automl-you-will-ever-need-5331f671f105) [## GitHub æ˜¯ä½ éœ€è¦çš„æœ€å¥½çš„æ±½è½¦

### ä½¿ç”¨ PyCaret 2.0 æ„å»º AutoML çš„åˆ†æ­¥æ•™ç¨‹

towardsdatascience.com](https://towardsdatascience.com/github-is-the-best-automl-you-will-ever-need-5331f671f105) [](https://towardsdatascience.com/build-your-own-automl-in-power-bi-using-pycaret-8291b64181d) [## ä½¿ç”¨ PyCaret åœ¨ Power BI ä¸­æ„å»ºè‡ªå·±çš„ AutoML

### åœ¨ Power BI ä¸­æ„å»º AutoML è§£å†³æ–¹æ¡ˆçš„åˆ†æ­¥æ•™ç¨‹

towardsdatascience.com](https://towardsdatascience.com/build-your-own-automl-in-power-bi-using-pycaret-8291b64181d) [](https://towardsdatascience.com/deploy-pycaret-and-streamlit-app-using-aws-fargate-serverless-infrastructure-8b7d7c0584c2) [## ä½¿ç”¨ AWS Fargate(æ— æœåŠ¡å™¨åŸºç¡€è®¾æ–½)éƒ¨ç½² PyCaret å¹¶ç®€åŒ–åº”ç”¨ç¨‹åº

### ä½¿ç”¨ AWS Fargate å®¹å™¨åŒ–æœºå™¨å­¦ä¹  app å¹¶è¿›è¡Œéƒ¨ç½²çš„åˆ†æ­¥æ•™ç¨‹ã€‚

towardsdatascience.com](https://towardsdatascience.com/deploy-pycaret-and-streamlit-app-using-aws-fargate-serverless-infrastructure-8b7d7c0584c2) [](https://towardsdatascience.com/deploy-machine-learning-app-built-using-streamlit-and-pycaret-on-google-kubernetes-engine-fd7e393d99cb) [## åœ¨ Google Kubernetes å¼•æ“ä¸Šéƒ¨ç½²ä½¿ç”¨ Streamlit å’Œ PyCaret æ„å»ºçš„æœºå™¨å­¦ä¹ åº”ç”¨ç¨‹åº

### åœ¨ Google Kubernetes å¼•æ“ä¸Šå°è£…å’Œéƒ¨ç½² Streamlit åº”ç”¨ç¨‹åºçš„å¾ªåºæ¸è¿›çš„åˆå­¦è€…æŒ‡å—

towardsdatascience.com](https://towardsdatascience.com/deploy-machine-learning-app-built-using-streamlit-and-pycaret-on-google-kubernetes-engine-fd7e393d99cb) [](https://towardsdatascience.com/build-and-deploy-machine-learning-web-app-using-pycaret-and-streamlit-28883a569104) [## ä½¿ç”¨ PyCaret å’Œ Streamlit æ„å»ºå’Œéƒ¨ç½²æœºå™¨å­¦ä¹  web åº”ç”¨ç¨‹åº

### åœ¨ Heroku PaaS ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ åº”ç”¨ç¨‹åºçš„åˆå­¦è€…æŒ‡å—

towardsdatascience.com](https://towardsdatascience.com/build-and-deploy-machine-learning-web-app-using-pycaret-and-streamlit-28883a569104) [](https://towardsdatascience.com/deploy-machine-learning-pipeline-on-aws-fargate-eb6e1c50507) [## åœ¨ AWS Fargate ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“

### åœ¨ AWS Fargate ä¸Šæ— æœåŠ¡å™¨å°è£…å’Œéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“çš„åˆå­¦è€…æŒ‡å—

towardsdatascience.com](https://towardsdatascience.com/deploy-machine-learning-pipeline-on-aws-fargate-eb6e1c50507) [](https://towardsdatascience.com/topic-modeling-in-power-bi-using-pycaret-54422b4e36d6) [## åŸºäº PyCaret çš„ Power BI ä¸»é¢˜å»ºæ¨¡

### åœ¨ Power BI ä¸­å®ç°ä¸»é¢˜æ¨¡å‹çš„åˆ†æ­¥æŒ‡å—

towardsdatascience.com](https://towardsdatascience.com/topic-modeling-in-power-bi-using-pycaret-54422b4e36d6) [](https://towardsdatascience.com/deploy-machine-learning-model-on-google-kubernetes-engine-94daac85108b) [## åœ¨ Google Kubernetes å¼•æ“ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“

### åœ¨ Google Kubernetes å¼•æ“ä¸Šå°è£…å’Œéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“çš„åˆå­¦è€…æŒ‡å—

towardsdatascience.com](https://towardsdatascience.com/deploy-machine-learning-model-on-google-kubernetes-engine-94daac85108b) [](https://towardsdatascience.com/how-to-implement-clustering-in-power-bi-using-pycaret-4b5e34b1405b) [## å¦‚ä½•ä½¿ç”¨ PyCaret åœ¨ Power BI ä¸­å®ç°é›†ç¾¤

### åœ¨ Power BI ä¸­å®ç°é›†ç¾¤çš„åˆ†æ­¥æ•™ç¨‹

towardsdatascience.com](https://towardsdatascience.com/how-to-implement-clustering-in-power-bi-using-pycaret-4b5e34b1405b) [](https://towardsdatascience.com/build-your-first-anomaly-detector-in-power-bi-using-pycaret-2b41b363244e) [## ä½¿ç”¨ PyCaret åœ¨ Power BI ä¸­æ„å»ºç¬¬ä¸€ä¸ªå¼‚å¸¸æ£€æµ‹å™¨

### åœ¨ Power BI ä¸­å®ç°å¼‚å¸¸æ£€æµ‹çš„åˆ†æ­¥æŒ‡å—

towardsdatascience.com](https://towardsdatascience.com/build-your-first-anomaly-detector-in-power-bi-using-pycaret-2b41b363244e) [](https://towardsdatascience.com/deploy-machine-learning-pipeline-on-cloud-using-docker-container-bec64458dc01) [## ä½¿ç”¨ Docker å®¹å™¨åœ¨äº‘ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“

### ä½¿ç”¨ PyCaretã€Flaskã€Docker å®¹å™¨å’Œ Azure Web åœ¨äº‘ä¸Šéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“çš„åˆå­¦è€…æŒ‡å—â€¦

towardsdatascience.com](https://towardsdatascience.com/deploy-machine-learning-pipeline-on-cloud-using-docker-container-bec64458dc01) [](https://towardsdatascience.com/build-and-deploy-your-first-machine-learning-web-app-e020db344a99) [## æ„å»ºå¹¶éƒ¨ç½²æ‚¨çš„ç¬¬ä¸€ä¸ªæœºå™¨å­¦ä¹  web åº”ç”¨

### ä½¿ç”¨ PyCaret åœ¨ Python ä¸­è®­ç»ƒå’Œéƒ¨ç½²æœºå™¨å­¦ä¹ ç®¡é“çš„åˆå­¦è€…æŒ‡å—

towardsdatascience.com](https://towardsdatascience.com/build-and-deploy-your-first-machine-learning-web-app-e020db344a99) [](https://towardsdatascience.com/machine-learning-in-power-bi-using-pycaret-34307f09394a) [## ä½¿ç”¨ PyCaret å®ç° Power BI ä¸­çš„æœºå™¨å­¦ä¹ 

### å‡ åˆ†é’Ÿå†…åœ¨ Power BI ä¸­å®ç°æœºå™¨å­¦ä¹ çš„åˆ†æ­¥æ•™ç¨‹

towardsdatascience.com](https://towardsdatascience.com/machine-learning-in-power-bi-using-pycaret-34307f09394a) 

# å‰§ç»ˆ