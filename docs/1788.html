<html>
<head>
<title>Credit Card Fraud Detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä¿¡ç”¨å¡æ¬ºè¯ˆæ£€æµ‹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/credit-card-fraud-detection-fd634f70327d?source=collection_archive---------4-----------------------#2021-03-18">https://medium.com/analytics-vidhya/credit-card-fraud-detection-fd634f70327d?source=collection_archive---------4-----------------------#2021-03-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/9b4a185d019daa7e0d7f1c04958d21af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lci4cCUXgb6zZRyKmgWfVA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated"><a class="ae it" href="https://dataaspirant.com/credit-card-fraud-detection-classification-algorithms-python/" rel="noopener ugc nofollow" target="_blank">æ¥æº</a></figcaption></figure><p id="b8f5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å„ç§æœºå™¨å­¦ä¹ ç®—æ³•æ¥è§£å†³ä¿¡ç”¨å¡æ¬ºè¯ˆæ£€æµ‹é—®é¢˜ï¼Œæˆ‘ä»¬è¿˜å°†æ¯”è¾ƒæ‰€æœ‰è¿™äº›ç®—æ³•ï¼Œå¹¶æ‰¾åˆ°å“ªä¸€ä¸ªæœ€é€‚åˆè¿™ä¸ªé—®é¢˜ã€‚</p><p id="835a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æ–‡ç« åˆ†ä¸ºå‡ ä¸ªéƒ¨åˆ†</p><ol class=""><li id="b920" class="js jt hh iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">é—®é¢˜ç†è§£</li><li id="b964" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">æ•°æ®å®¡æŸ¥</li><li id="6cd5" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">æ•°æ®å¤„ç†</li><li id="3ecb" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">ç‰¹å¾é€‰æ‹©</li><li id="5251" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">æ¨¡å‹æ„å»º</li><li id="1e7d" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">æ¬ é‡‡æ ·</li><li id="5e55" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">è¿‡é‡‡æ ·</li><li id="1a00" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">æ‘˜è¦</li></ol><p id="259e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æ‰€ä»¥è®©æˆ‘ä»¬å¼€å§‹å§ã€‚</p><h1 id="a66b" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">1.é—®é¢˜ç†è§£</h1><p id="1da9" class="pw-post-body-paragraph iu iv hh iw b ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ä¿¡ç”¨å¡è¯ˆéª—</p><blockquote class="lj lk ll"><p id="0bbf" class="iu iv lm iw b ix iy iz ja jb jc jd je ln jg jh ji lo jk jl jm lp jo jp jq jr ha bi translated">ä¿¡ç”¨æ¬ºè¯ˆæ˜¯æŒ‡çŠ¯ç½ªåˆ†å­åˆ©ç”¨ä»–äººçš„ä¸ªäººå‡­æ®ä»¥åŠä»–ä»¬çš„ä¿¡ç”¨çŠ¶å†µæ¥å€Ÿé’±æˆ–ä½¿ç”¨ä¿¡ç”¨å¡è´­ä¹°å•†å“æˆ–æœåŠ¡ï¼Œè€Œæ— æ„å¿è¿˜å€ºåŠ¡ã€‚</p></blockquote><p id="efca" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å› æ­¤ï¼Œä¿¡ç”¨å¡å…¬å¸èƒ½å¤Ÿè¯†åˆ«æ¬ºè¯ˆæ€§çš„ä¿¡ç”¨å¡äº¤æ˜“éå¸¸é‡è¦ï¼Œè¿™æ ·å®¢æˆ·å°±ä¸ä¼šä¸ºä»–ä»¬æ²¡æœ‰è´­ä¹°çš„å•†å“ä»˜è´¹ã€‚</p><h1 id="dc9b" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">2.æ•°æ®å®¡æŸ¥</h1><p id="7d38" class="pw-post-body-paragraph iu iv hh iw b ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">æ•°æ®é›†åŒ…å«æ¬§æ´²æŒå¡äººé€šè¿‡ä¿¡ç”¨å¡è¿›è¡Œçš„äº¤æ˜“ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œ æ‰¾åˆ°Kaggleä¿¡ç”¨å¡æ¬ºè¯ˆæ£€æµ‹ç«èµ›æ•°æ®é›†<a class="ae it" href="https://www.kaggle.com/mlg-ulb/creditcardfraud" rel="noopener ugc nofollow" target="_blank"> <em class="lm">çš„å…¨éƒ¨æ•°æ®ã€‚è¯¥æ•°æ®é›†æ˜¾ç¤ºäº†ä¸¤å¤©å†…å‘ç”Ÿçš„äº¤æ˜“ï¼Œå…¶ä¸­284ï¼Œ807ç¬”äº¤æ˜“ä¸­æœ‰492ç¬”æ¬ºè¯ˆã€‚</em></a></p><p id="409e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å®ƒä»¬æ˜¯æ•°æ®é›†ä¸­çš„31åˆ—ï¼Œå…¶ä¸­ç‰¹å¾V1ã€V2â€¦v 28æ˜¯ç”¨PCAè·å¾—çš„ä¸»è¦æˆåˆ†ï¼Œå”¯ä¸€æ²¡æœ‰ç”¨PCAè½¬æ¢çš„ç‰¹å¾æ˜¯â€œæ—¶é—´â€å’Œâ€œæ•°é‡â€ã€‚å®ƒä»¬æ˜¯ä¸€ä¸ªåä¸ºclassçš„åˆ—ï¼Œå¦‚æœäº¤æ˜“æ˜¯åˆæ³•çš„(éæ¬ºè¯ˆ)ï¼Œåˆ™è¯¥åˆ—çš„å€¼ä¸º0ï¼Œå¦‚æœæ˜¯æ¬ºè¯ˆï¼Œåˆ™è¯¥åˆ—çš„å€¼ä¸º1ã€‚</p><h1 id="2dec" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">3.æ•°æ®å¤„ç†</h1><p id="be5a" class="pw-post-body-paragraph iu iv hh iw b ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">é¦–å…ˆï¼Œè®©æˆ‘ä»¬å°†æ•°æ®å¯è§†åŒ–</p><figure class="lr ls lt lu fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lq"><img src="../Images/632c38a2fa351e754fff7566be5a06b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kSoiQg39oQYqqYpRgE0rxA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">æ•°æ®</figcaption></figure><p id="0e84" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">é€šè¿‡è§‚å¯Ÿï¼Œç‰¹å¾é‡çš„æ•°æ®å€¼ä½äº0åˆ°25691.16çš„èŒƒå›´å†…ï¼Œè¿™æ˜¾ç„¶æ˜¯éå¸¸å®½çš„èŒƒå›´ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡åº”ç”¨æ ‡å‡†åŒ–æŠ€æœ¯åœ¨(-1ï¼Œ1)ä¹‹é—´è°ƒæ•´å®ƒçš„å€¼ã€‚</p><p id="24d7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æ‰€ä»¥æˆ‘ä»¬æ­£åœ¨åšçš„æ˜¯</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="be7c" class="ma kh hh lw b fi mb mc l md me">from sklearn.preprocessing import StandardScaler</span><span id="387d" class="ma kh hh lw b fi mf mc l md me">data['scaled_Amount'] = StandardScaler().fit_transform(data['Amount'].values.reshape(-1,1))</span><span id="f1ae" class="ma kh hh lw b fi mf mc l md me">data = data.drop(['Amount'],axis=1)</span></pre><p id="a47f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å› æ­¤ï¼Œé€šè¿‡ä½¿ç”¨sklearné¢„å¤„ç†æ¨¡å—ä¸­çš„StandardScalerå‡½æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ•°æ®é›†ä¸­çš„Amountåˆ—è¿›è¡Œè½¬æ¢ã€‚</p><h2 id="1a76" class="ma kh hh bd ki mg mh mi km mj mk ml kq jf mm mn ku jj mo mp ky jn mq mr lc ms bi translated">ä»€ä¹ˆæ˜¯StandardScalerï¼Ÿ</h2><p id="35ee" class="pw-post-body-paragraph iu iv hh iw b ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">æ ‡å‡†ç¼©æ”¾å™¨å°†è¦ç´ ç¼©æ”¾ä¸ºå¹³å‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1ã€‚å®ƒè¾“å‡ºéå¸¸æ¥è¿‘æ­£æ€åˆ†å¸ƒã€‚</p><p id="5747" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è¯·æ³¨æ„ï¼Œæˆ‘ä»¬æ­£åœ¨è¿›è¡Œæ•´å½¢(-1ï¼Œ1)ä»¥å°†æ•°ç»„åºåˆ—è½¬æ¢ä¸º2Dæ•°ç»„ã€‚</p><figure class="lr ls lt lu fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mt"><img src="../Images/114f3cbc6555231b7d52c7577c025773.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e6JYIFAleMnUWHhEbRsmkA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">æ¯”ä¾‹é‡‘é¢</figcaption></figure><p id="106d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨ä¸Šå›¾ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°è¾“å‡ºã€‚</p><h1 id="ad22" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">4.ç‰¹å¾é€‰æ‹©</h1><h2 id="0ef0" class="ma kh hh bd ki mg mh mi km mj mk ml kq jf mm mn ku jj mo mp ky jn mq mr lc ms bi translated">æ—¶é—´</h2><p id="aaf0" class="pw-post-body-paragraph iu iv hh iw b ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">è®©æˆ‘ä»¬ç»˜åˆ¶å›¾è¡¨ï¼Œæ˜¾ç¤ºåˆæ³•äº¤æ˜“å’Œæ¬ºè¯ˆäº¤æ˜“åœ¨æ—¶é—´å˜é‡æ–¹é¢çš„ç›¸ä¼¼æ€§ã€‚</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="3c1d" class="ma kh hh lw b fi mb mc l md me">data["Time_Hr"] = data["Time"]/3600 # convert to hours<br/>print(data["Time_Hr"].tail(5))<br/>fig, (ax1, ax2) = plt.subplots(2, 1, sharex = True, figsize=(10,6))<br/>ax1.hist(data.Time_Hr[data.Class==0],bins=48,color='g',alpha=0.5)<br/>ax1.set_title('Genuine')<br/>ax2.hist(data.Time_Hr[data.Class==1],bins=48,color='r',alpha=0.5)<br/>ax2.set_title('Fraud')<br/>plt.xlabel('Time (hrs)')<br/>plt.ylabel('# Transactions')</span></pre><figure class="lr ls lt lu fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mu"><img src="../Images/3ffdf070280909d2cea92549e8b6669d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f3GWsrZsu6x36Dofhyay8w.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">æ—¶é—´å˜é‡</figcaption></figure><p id="d6b5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">é€šè¿‡çœ‹å›¾è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ï¼Œä»–ä»¬æ²¡æœ‰å¤ªå¤šçš„ä¿¡æ¯æ¥è¯æ˜äº¤æ˜“æ˜¯æ¬ºè¯ˆã€‚æ‰€ä»¥å®ƒæ²¡æœ‰ä»»ä½•é¢„æµ‹èƒ½åŠ›ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä»æ•°æ®é›†ä¸­åˆ é™¤æ—¶é—´å˜é‡ã€‚</p><p id="1df4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ç°åœ¨è®©æˆ‘ä»¬æ£€æŸ¥å˜é‡æ•°é‡</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="98ff" class="ma kh hh lw b fi mb mc l md me">fig, (ax3,ax4) = plt.subplots(2,1, figsize = (10,6), sharex = True)<br/>ax3.hist(data.Amount[data.Class==0],bins=50,color='g',alpha=0.5)<br/>ax3.set_yscale('log') # to see the tails<br/>ax3.set_title('Genuine') # to see the tails<br/>ax3.set_ylabel('# transactions')<br/>ax4.hist(data.Amount[data.Class==1],bins=50,color='r',alpha=0.5)<br/>ax4.set_yscale('log') # to see the tails<br/>ax4.set_title('Fraud') # to see the tails<br/>ax4.set_xlabel('Amount ($)')<br/>ax4.set_ylabel('# transactions')</span></pre><figure class="lr ls lt lu fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mv"><img src="../Images/bc62406c0d3b1b65f1e28e16d194203d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EHOxdi34z4Hu8M4lUgiE1Q.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">æ•°é‡å˜é‡</figcaption></figure><p id="cb7b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å› æ­¤ï¼Œä½ å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ä¸¤ä¸ªå›¾è¡¨ä¸­çš„å·¨å¤§å·®å¼‚ï¼Œå³çœŸå®å’Œæ¬ºè¯ˆã€‚åŒæ ·é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œåœ¨çœŸæ­£çš„(åˆæ³•äº¤æ˜“)ä¸­ï¼Œè¶…è¿‡1ä¸‡è‹±é•‘çš„äº¤æ˜“å·²ç»å®Œæˆï¼Œä½†åœ¨æ¬ºè¯ˆæ¡ˆä»¶ä¸­ï¼Œæ²¡æœ‰äº¤æ˜“è¶…è¿‡1ä¸‡è‹±é•‘ã€‚</p><p id="a6b7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¯´å®ƒæœ‰é¢„æµ‹èƒ½åŠ›ã€‚</p><p id="0a7c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åŒæ ·ï¼Œæˆ‘ä»¬éœ€è¦æ£€æŸ¥V1åˆ°V28çš„æ‰€æœ‰åŠŸèƒ½ï¼Œä»¥ä¾¿å¦‚æœä»»ä½•å˜é‡åœ¨åˆæ³•å’Œæ¬ºè¯ˆäº¤æ˜“ä¸­æ²¡æœ‰å·®å¼‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ”¾å¼ƒè¯¥åŠŸèƒ½ã€‚ä½ å¯ä»¥åœ¨æˆ‘çš„<a class="ae it" href="https://github.com/kamlesh11/Credit-Card-Fraud-Detection" rel="noopener ugc nofollow" target="_blank"> github repo </a>çœ‹åˆ°æ¯ä¸ªå˜é‡çš„åˆ†æã€‚</p><p id="e171" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»é€‰æ‹©äº†æ‰€æœ‰å¯è®­ç»ƒçš„ç‰¹å¾ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†æ•°æ®åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚</p><h2 id="8df8" class="ma kh hh bd ki mg mh mi km mj mk ml kq jf mm mn ku jj mo mp ky jn mq mr lc ms bi translated">åˆ†å‰²æ•°æ®</h2><p id="7014" class="pw-post-body-paragraph iu iv hh iw b ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">æˆ‘ä»¬å°†æŠŠæ•°æ®åˆ†æˆ80%çš„è®­ç»ƒé›†å’Œ20%çš„æµ‹è¯•é›†</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="43e1" class="ma kh hh lw b fi mb mc l md me">def split_data(df,drop_list):<br/>    df=df.drop(drop_list,axis=1)<br/>    X=df[df['Class']==1]<br/>    Y=df[df['Class']==0]<br/>    X=df.drop(['Class'], axis = 1) <br/>    Y=df["Class"] <br/>    xData = X.values <br/>    yData = Y.values <br/>    xTrain, xTest, yTrain, yTest = train_test_split( <br/>            xData, yData, test_size = 0.2, random_state = 42)<br/>    return xTrain, xTest, yTrain, yTest</span><span id="6a16" class="ma kh hh lw b fi mf mc l md me">drop_list = ['V13','V15','V22','V26','V25','V23']<br/>x_Train,x_Test,y_Train,y_Test=split_data(data,dropList)</span></pre><p id="137c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æˆ‘ä»¬æ­£åœ¨åˆ›å»ºhelperå‡½æ•°print_scoresï¼Œå®ƒå°†æ¥å—y_Testã€y_predså’Œy_pred_probs(é¢„æµ‹æ¦‚ç‡),å¹¶å°†ä¸ºæˆ‘ä»¬æ‰“å°æ‰€æœ‰æµ‹é‡å€¼ï¼Œå³precisionã€recallã€f1_scoreã€AUC_scoreã€ROC_AUC scoreå’Œkappa score(cohen kappa score)ã€‚</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="594d" class="ma kh hh lw b fi mb mc l md me"># print_scores function for printing scores<br/>def print_scores(y_test,y_pred,y_pred_prob):<br/>    precision,recall,_ =      precision_recall_curve(y_test,y_pred_prob[:,1])<br/>    print('precision_score : ',precision_score(y_test,y_pred))<br/>    print('recall_score : ',recall_score(y_test,y_pred))<br/>    print('f1 score : ', f1_score(y_test,y_pred))<br/>    print('AUC score : ', auc(recall,precision))<br/>    print('ROC_AUC score : ', roc_auc_score(y_test, <br/>y_pred_prob[:,1]))<br/>    print('kappa : ', cohen_kappa_score(y_test,y_pred))</span></pre><h1 id="2bd2" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">5.æ¨¡å‹ç»“æ„</h1><p id="0076" class="pw-post-body-paragraph iu iv hh iw b ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">å…·ä½“æ¥è¯´ï¼Œæˆ‘å·²ç»å»ºç«‹äº†7ä¸ªä¸åŒçš„æ¨¡å‹</p><h2 id="0538" class="ma kh hh bd ki mg mh mi km mj mk ml kq jf mm mn ku jj mo mp ky jn mq mr lc ms bi translated">1.æœ´ç´ è´å¶æ–¯</h2><ul class=""><li id="5c12" class="js jt hh iw b ix le jb lf jf mw jj mx jn my jr mz jy jz ka bi translated">å®ƒæ˜¯ä¸€ç§åŸºäºè´å¶æ–¯å®šç†çš„åˆ†ç±»æŠ€æœ¯ï¼Œå‡è®¾é¢„æµ‹å› å­ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ã€‚ç®€è€Œè¨€ä¹‹ï¼Œæœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨å‡è®¾ä¸€ä¸ªç±»ä¸­ç‰¹å®šç‰¹å¾çš„å­˜åœ¨ä¸ä»»ä½•å…¶ä»–ç‰¹å¾çš„å­˜åœ¨æ— å…³ã€‚</li></ul><figure class="lr ls lt lu fd ii er es paragraph-image"><div class="er es na"><img src="../Images/67190b98e43c2d429467bf308e0ac658.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/0*Yioy69l5MGqm-McD.jpg"/></div></figure><ul class=""><li id="0550" class="js jt hh iw b ix iy jb jc jf ju jj jv jn jw jr mz jy jz ka bi translated">å…·ä½“æ¥è¯´ï¼Œå®ƒç›´æ¥ä»æ¦‚ç‡çš„è§’åº¦ä½¿ç”¨è´å¶æ–¯å®šç†çš„æ¦‚å¿µã€‚</li><li id="8d07" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr mz jy jz ka bi translated">å‡è®¾äº¤æ˜“æ˜¯åˆæ³•çš„ï¼Œæˆ‘ä»¬æ­£åœ¨è®¡ç®—äº¤æ˜“è¢«æ¬ºè¯ˆçš„æ¦‚ç‡ã€‚åŒæ ·çš„é“ç†ï¼Œæœ€ç»ˆçš„é¢„æµ‹æ˜¯ä¸¤è€…çš„æœ€å¤§å€¼ã€‚</li><li id="147b" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr mz jy jz ka bi translated">æ›´å¤šä¿¡æ¯å¯ä»¥è®¿é—®<a class="ae it" href="https://www.analyticsvidhya.com/blog/2017/09/naive-bayes-explained/" rel="noopener ugc nofollow" target="_blank"> <em class="lm">è¿™é‡Œ</em> </a> <em class="lm">ã€‚</em></li></ul><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="eada" class="ma kh hh lw b fi mb mc l md me">from sklearn.naive_bayes import GaussianNB<br/>NBclf=GaussianNB()<br/>NBclf.fit(x_Train,y_Train)<br/>NB_pred,NB_pred_prob=NBclf.predict(x_Test),NBclf.predict_proba(x_Test)<br/>print_scores(y_Test,NB_pred,NB_pred_prob)</span></pre><h2 id="ff5d" class="ma kh hh bd ki mg mh mi km mj mk ml kq jf mm mn ku jj mo mp ky jn mq mr lc ms bi translated">2.é€»è¾‘å›å½’</h2><ul class=""><li id="9fb2" class="js jt hh iw b ix le jb lf jf mw jj mx jn my jr mz jy jz ka bi translated"><strong class="iw hi">é€»è¾‘å›å½’</strong>æ˜¯å› å˜é‡ä¸ºäºŒåˆ†å˜é‡(äºŒå…ƒ)æ—¶è¿›è¡Œçš„é€‚å½“å›å½’åˆ†æã€‚åƒæ‰€æœ‰å›å½’åˆ†æä¸€æ ·ï¼Œé€»è¾‘å›å½’æ˜¯ä¸€ç§é¢„æµ‹åˆ†æã€‚é€»è¾‘å›å½’ç”¨äºæè¿°æ•°æ®ï¼Œå¹¶è§£é‡Šä¸€ä¸ªå› å˜é‡ä¸ä¸€ä¸ªæˆ–å¤šä¸ªåä¹‰å˜é‡ã€åºæ•°å˜é‡ã€åŒºé—´å˜é‡æˆ–æ¯”ç‡æ°´å¹³è‡ªå˜é‡ä¹‹é—´çš„å…³ç³»ã€‚</li><li id="e808" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr mz jy jz ka bi translated">ç®€å•åœ°è¯´ï¼Œå®ƒä½¿ç”¨é€»è¾‘å‡½æ•°(Sigmoidå‡½æ•°)è¿›è¡Œé¢„æµ‹ã€‚</li><li id="9f93" class="js jt hh iw b ix kb jb kc jf kd jj ke jn kf jr mz jy jz ka bi translated">ç‚¹å‡»å¯ä»¥äº†è§£æ›´å¤šå…³äº<a class="ae it" href="https://towardsdatascience.com/logistic-regression-detailed-overview-46c4da4303bc" rel="noopener" target="_blank"> <em class="lm">çš„é€»è¾‘å›å½’çŸ¥è¯†ã€‚</em></a></li></ul><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="f00c" class="ma kh hh lw b fi mb mc l md me">from sklearn.linear_model import LogisticRegression<br/>lr = LogisticRegression(C = 0.01, penalty = 'l2',max_iter=1000)<br/>lr.fit(x_Train, y_Train)<br/>lr_pred,lr_prob=lr.predict(x_Test),lr.predict_proba(x_Test)<br/>print_scores(y_Test,lr_pred,lr_prob)</span></pre><h2 id="0099" class="ma kh hh bd ki mg mh mi km mj mk ml kq jf mm mn ku jj mo mp ky jn mq mr lc ms bi translated">3.çº¿æ€§åˆ¤åˆ«åˆ†æ</h2><ul class=""><li id="9519" class="js jt hh iw b ix le jb lf jf mw jj mx jn my jr mz jy jz ka bi translated"><a class="ae it" href="https://towardsdatascience.com/linear-discriminant-analysis-in-python-76b8b17817c2#:~:text=Linear%20Discriminant%20Analysis%20(LDA)%20is,as%20much%20information%20as%20possible." rel="noopener" target="_blank"> <em class="lm">çº¿æ€§åˆ¤åˆ«åˆ†æ</em> </a>ï¼Œæ­£æ€åˆ¤åˆ«åˆ†æï¼Œæˆ–ç§°åˆ¤åˆ«å‡½æ•°åˆ†ææ˜¯Fisherçº¿æ€§åˆ¤åˆ«çš„æ¨å¹¿ï¼Œæ˜¯ç»Ÿè®¡å­¦ç­‰é¢†åŸŸä½¿ç”¨çš„ä¸€ç§æ–¹æ³•ï¼Œå¯»æ‰¾è¡¨å¾æˆ–åŒºåˆ†ä¸¤ç±»æˆ–ä¸¤ç±»ä»¥ä¸Šå¯¹è±¡æˆ–äº‹ä»¶çš„ç‰¹å¾çš„çº¿æ€§ç»„åˆã€‚</li></ul><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="2360" class="ma kh hh lw b fi mb mc l md me">from sklearn.discriminant_analysis import LinearDiscriminantAnalysis<br/>lda_clf=LinearDiscriminantAnalysis()<br/>lda_clf.fit(x_Train,y_Train)<br/>lda_pred, lda_prob = lda_clf.predict(x_Test),lda_clf.predict_proba(x_Test)<br/>lda_precision,lda_recall,_ = precision_recall_curve(y_Test,lda_prob[:,1])<br/>print_scores(y_Test,lda_pred,lda_prob)</span></pre><h2 id="4ede" class="ma kh hh bd ki mg mh mi km mj mk ml kq jf mm mn ku jj mo mp ky jn mq mr lc ms bi translated">4.å†³ç­–å›¾è¡¨</h2><figure class="lr ls lt lu fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nb"><img src="../Images/98e08bbb49cd6422c7d2790c3e3264db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Uu39HI9lf-uVFk5M.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">å†³ç­–å›¾è¡¨</figcaption></figure><ul class=""><li id="36f2" class="js jt hh iw b ix iy jb jc jf ju jj jv jn jw jr mz jy jz ka bi translated">æˆ‘å¸Œæœ›ä½ èƒ½ä»ä¸Šé¢çš„å›¾ç‰‡ä¸­äº†è§£ä»€ä¹ˆæ˜¯å†³ç­–æ ‘ã€‚</li></ul><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="fdaa" class="ma kh hh lw b fi mb mc l md me">from sklearn.tree import DecisionTreeClassifier<br/>Dtree = DecisionTreeClassifier()<br/>Dtree.fit(x_Train,y_Train)<br/>DT_preds,DT_probs = Dtree.predict(x_Test),Dtree.predict_proba(x_Test)<br/>print_scores(y_Test,DT_preds,DT_probs)</span></pre><h2 id="7156" class="ma kh hh bd ki mg mh mi km mj mk ml kq jf mm mn ku jj mo mp ky jn mq mr lc ms bi translated">5.éšæœºæ£®æ—</h2><p id="e76d" class="pw-post-body-paragraph iu iv hh iw b ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">éšæœºæ£®æ—(éšæœºæ£®æ—åˆ†ç±»å™¨)æ˜¯è®¸å¤šè¿™æ ·çš„å†³ç­–æ ‘çš„é›†åˆå’Œè®¸å¤šå†³ç­–æ ‘çš„ç»„åˆã€‚</p><figure class="lr ls lt lu fd ii er es paragraph-image"><div class="er es nc"><img src="../Images/cd339746c1a4fb354eb0476a1f70e8c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/0*p50C9QFrzuhIMTe4.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated"><a class="ae it" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fcorporatefinanceinstitute.com%2Fresources%2Fknowledge%2Fother%2Frandom-forest%2F&amp;psig=AOvVaw0VQzHvQ5OoUbL9QUouLd2A&amp;ust=1616169824690000&amp;source=images&amp;cd=vfe&amp;ved=0CA0QjhxqFwoTCPCsvPmbuu8CFQAAAAAdAAAAABAx" rel="noopener ugc nofollow" target="_blank">è°·æ­Œ</a></figcaption></figure><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="b335" class="ma kh hh lw b fi mb mc l md me">from sklearn.ensemble import RandomForestClassifier<br/>RF_clf = RandomForestClassifier()<br/>RF_clf.fit(x_Train, y_Train)<br/>RF_pred,RF_prob = RF_clf.predict(x_Test),RF_clf.predict_proba(x_Test)<br/>print_scores(y_Test,RF_pred,RF_prob)</span></pre><h2 id="8eb1" class="ma kh hh bd ki mg mh mi km mj mk ml kq jf mm mn ku jj mo mp ky jn mq mr lc ms bi translated">6.æ”¯æŒå‘é‡æœº</h2><p id="e11b" class="pw-post-body-paragraph iu iv hh iw b ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">æ”¯æŒå‘é‡æœºç®—æ³•çš„ç›®æ ‡æ˜¯åœ¨Nç»´ç©ºé—´(N-ç‰¹å¾çš„æ•°é‡)ä¸­æ‰¾åˆ°ä¸€ä¸ªè¶…å¹³é¢ï¼Œè¯¥è¶…å¹³é¢æ¸…æ¥šåœ°åˆ†ç±»æ•°æ®ç‚¹ã€‚</p><p id="a54c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å®ƒçš„æ¦‚å¿µæ˜¯å–Nç»´è¾“å…¥å¹¶å°†å…¶æ‰©å±•åˆ°ç¬¬N+1ç»´ï¼Œæ‰¾åˆ°è¶…å¹³é¢ï¼Œç„¶åå°†å…¶é™ä½åˆ°ç¬¬Nç»´ã€‚æˆ‘ä»¬å¾—åˆ°äº†å†³ç­–è¾¹ç•Œã€‚</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="76ba" class="ma kh hh lw b fi mb mc l md me">from sklearn.svm import SVC<br/>clf = SVC(probability=True)<br/>SVM_pred,SVM_prob=SVMclf.predict(x_Test),SVMclf.predict_proba(x_Test)<br/>print_scores(y_Test,SVM_pred,SVM_prob)</span></pre><h2 id="8cf3" class="ma kh hh bd ki mg mh mi km mj mk ml kq jf mm mn ku jj mo mp ky jn mq mr lc ms bi translated">7.æ·±åº¦ç¥ç»ç½‘ç»œ</h2><p id="7499" class="pw-post-body-paragraph iu iv hh iw b ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">æˆ‘å·²ç»å»ºç«‹äº†ä¸€ä¸ª5å±‚çš„ç¥ç»ç½‘ç»œï¼Œé€šè¿‡å®ƒæˆ‘å¾—åˆ°äº†éå¸¸å¥½çš„ç»“æœã€‚</p><p id="8e2a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä½†æ˜¯æ‚¨å¯ä»¥å¾®è°ƒä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½ã€‚</p><p id="79e6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æˆ‘ä½¿ç”¨4ä¸ªå¯†é›†å±‚å’Œ1ä¸ªä¸¢å¼ƒå±‚ï¼Œé˜ˆå€¼ä¸º0.5ï¼Œä¼˜åŒ–å™¨ä¸ºadamï¼ŒæŸå¤±ä¸ºbinary_crossentropyï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªåˆ†ç±»é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯2ä¸ªäºŒè¿›åˆ¶åˆ†ç±»é—®é¢˜ã€‚</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="3b96" class="ma kh hh lw b fi mb mc l md me">import keras<br/>from keras import layers<br/>from keras.models import load_model</span><span id="54b0" class="ma kh hh lw b fi mf mc l md me"># Deep Neural Network<br/><br/>model = keras.Sequential([<br/>layers.Dense(input_dim = 23,units= 23, activation = 'relu'),<br/>layers.Dense(units = 20,activation = 'relu'),<br/>layers.Dropout(0.5),<br/>layers.Dense(units = 16,activation = 'relu'),<br/>layers.Dense(units =1, activation = 'sigmoid')])</span><span id="138a" class="ma kh hh lw b fi mf mc l md me">model.compile(optimizer = 'adam', loss = 'binary_crossentropy', metrics = ['accuracy'])<br/>model.fit(x_Train, y_Train, batch_size = 16, epochs = 5)</span><span id="b9c9" class="ma kh hh lw b fi mf mc l md me">Dnn_preds,Dnn_prob= model.predict(x_Test),model.predict_proba(x_Test)print_scores(y_Test ,DNN_preds)</span><span id="b41d" class="ma kh hh lw b fi mf mc l md me">print('precision_score :',precision_score(y_Test,Dnn_preds.round()))<br/>print('recall_score : ',recall_score(y_Test,Dnn_preds.round()))<br/>print('f1_score : ',<br/>f1_score(y_Test,Dnn_preds.round()))<br/>print('AUC_score : ', auc(DNN_recall,DNN_precision))<br/>print('ROC_AUC_score : ', roc_auc_score(y_Test, Dnn_prob))<br/>print('kappa : ', cohen_kappa_score(y_Test,Dnn_preds.round()))</span></pre><p id="faf2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">é€šè¿‡å°†æ•°æ®æ‹Ÿåˆåˆ°æ‰€æœ‰æ¨¡å‹ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä»¥ä¸‹ç»“æœã€‚</p><figure class="lr ls lt lu fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nd"><img src="../Images/b0ca3b1b4cc4b205fe620cdcf82d9e6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WkEBAaioZaapbEwszGeehg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">è¡¨æ¼”</figcaption></figure><p id="d9a3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">é€šè¿‡æŸ¥çœ‹ä¸Šé¢çš„æ€§èƒ½è¡¨ï¼Œä½ å¯ä»¥è‚¯å®šåœ°è¯´ï¼Œéšæœºæ£®æ—æ­£åœ¨èµ¢å¾—è¿™åœºæ¯”èµ›ã€‚</p><p id="26fe" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬çš„èµ¢å®¶éšæœºæ£®æ—çš„ç²¾åº¦ä¸å¬å›åˆ†æ•°</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="cb29" class="ma kh hh lw b fi mb mc l md me">plt.figure(figsize=(8,6))<br/>plt.title('Precision Recall Curve of Random Forest Classifier')<br/>plt.plot(RF_recall, RF_precision, label='Random Forest',color='violet')<br/>plt.xlabel('Recall')<br/>plt.ylabel('Precision')<br/>plt.legend(loc='lower left')<br/>plt.show()</span></pre><figure class="lr ls lt lu fd ii er es paragraph-image"><div class="er es ne"><img src="../Images/d53bacbd034ea34c826db1d09fea2969.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*Pw1gU7fXnYYrj_NA_B5pbw.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">ç²¾ç¡®å¬å›å›¾</figcaption></figure><p id="bf0e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åŒæ ·ï¼Œæ‚¨å¯ä»¥ç»˜åˆ¶ä»»ä½•åˆ†ç±»å™¨çš„å›¾å½¢ã€‚æˆ‘åªæ˜¯ç»™ä½ çœ‹å…¶ä¸­æœ€å¥½çš„ä¸€ä¸ªã€‚</p><p id="b121" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä½ å¯ä»¥ä»<a class="ae it" href="https://github.com/kamlesh11/Credit-Card-Fraud-Detection/blob/main/Credit%20card%20fraud%20detection%20Oversampling.ipynb" rel="noopener ugc nofollow" target="_blank"> <em class="lm">è¿™é‡Œ</em>å¾—åˆ°å®Œæ•´çš„ä»£ç ã€‚</a></p><h2 id="2103" class="ma kh hh bd ki mg mh mi km mj mk ml kq jf mm mn ku jj mo mp ky jn mq mr lc ms bi translated">ä½†æ˜¯åœ¨æˆ‘ä»¬çš„æ•°æ®é›†ä¸­æœ‰ä¸€ä¸ªé—®é¢˜</h2><figure class="lr ls lt lu fd ii er es paragraph-image"><div class="er es nf"><img src="../Images/91395bd2786dd820095a05a6069a275b.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*AXMlnu9sIRfJlsTdnvmMbA.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">æ•°æ®é¥¼å›¾</figcaption></figure><p id="6552" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥çœ‹åˆ°æ•°æ®é«˜åº¦åå‘äºçœŸå®è´Ÿå€¼ï¼Œå³çœŸå®(åˆæ³•)äº¤æ˜“ã€‚</p><p id="e460" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æˆ‘ä»¬ç¨åä¼šçœ‹åˆ°æˆ‘ä»¬èƒ½åšäº›ä»€ä¹ˆæ¥å…‹æœè¿™ä¸ªé—®é¢˜ã€‚</p><p id="e788" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æˆ‘ä»¬çŸ¥é“è¯¥æ•°æ®é«˜åº¦åå‘äºè´Ÿæˆäº¤ï¼Œå³åˆæ³•äº¤æ˜“ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦é‡‡å–ä¸€äº›æªæ–½æ¥å¹³è¡¡æ•°æ®åˆ†å¸ƒã€‚</p><p id="d147" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æœ‰ä¸¤ç§æŠ€æœ¯æˆ‘ä»¬å¯ä»¥åº”ç”¨æ¬ é‡‡æ ·å’Œè¿‡é‡‡æ ·</p><p id="b810" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å…ˆæ¥çœ‹æ¬ é‡‡æ ·ã€‚</p><h1 id="5d3a" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">6.æ¬ é‡‡æ ·</h1><blockquote class="ng"><p id="cfea" class="nh ni hh bd nj nk nl nm nn no np jr dx translated"><a class="ae it" href="https://machinelearningmastery.com/undersampling-algorithms-for-imbalanced-classification/" rel="noopener ugc nofollow" target="_blank"><em class="nq"/></a><em class="nq">æ¬ é‡‡æ ·ï¼ŒåŒ…æ‹¬é€šè¿‡æ¶ˆé™¤å±äºå¤šæ•°ç±»çš„æ ·æœ¬æ¥å‡å°‘æ•°æ®ï¼Œç›®çš„æ˜¯å‡è¡¡æ¯ä¸ªç±»çš„æ ·æœ¬æ•°é‡ã€‚</em></p></blockquote><p id="5c69" class="pw-post-body-paragraph iu iv hh iw b ix nr iz ja jb ns jd je jf nt jh ji jj nu jl jm jn nv jp jq jr ha bi translated">å› æ­¤ï¼Œæˆ‘ä»¬å°†ä»åˆæ³•äº¤æ˜“ä¸­åˆ é™¤ä¸€äº›æ•°æ®ï¼Œä»¥å¹³è¡¡æ•°æ®ã€‚</p><p id="b12f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è®©æˆ‘ä»¬çœ‹çœ‹æ¬ é‡‡æ ·çš„ä»£ç ã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä»¬é€‰æ‹©éšæœºé€‰é¡¹å¹¶åˆ é™¤å®ƒä»¬ä»¥è·å¾—ç›¸åŒçš„åˆ†å¸ƒã€‚æˆ‘ä»¬è¿™æ ·åšæ˜¯ä»¥ä¸€äº›æœ‰ç”¨çš„ä¿¡æ¯ä¸ºä»£ä»·çš„ã€‚ğŸ˜¢</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="8ae8" class="ma kh hh lw b fi mb mc l md me">df=data<br/>fraud_ind = np.array(df[df.Class == 1].index)<br/>gen_ind = df[df.Class == 0].index<br/>n_fraud = len(df[df.Class == 1])<br/># random selection from genuine class<br/>random_gen_ind = np.random.choice(gen_ind, n_fraud, replace = False)<br/>random_gen_ind = np.array(random_gen_ind)<br/># merge two class indices: random genuine + original fraud<br/>under_sample_ind = np.concatenate([fraud_ind,random_gen_ind])<br/># Under sample dataset<br/>undersample_df = df.iloc[under_sample_ind,:]<br/>y_undersample  = undersample_df['Class'].values #target<br/>X_undersample = undersample_df.drop(['Class'],axis=1).values #features</span><span id="1484" class="ma kh hh lw b fi mf mc l md me">print("# transactions in undersampled data: ", len(undersample_df))<br/>print("% genuine transactions: ",len(undersample_df[undersample_df.Class == 0])/len(undersample_df))<br/>print("% fraud transactions: ", sum(y_undersample)/len(undersample_df))</span></pre><p id="cdaa" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">é€šè¿‡åº”ç”¨éæŠ½æ ·ï¼Œæˆ‘ä»¬åªå‰©ä¸‹984ä¸ªè§‚å¯Ÿå€¼ã€‚</p><p id="3fcd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å¥½äº†ï¼Œç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹ç®—æ³•çš„æ€§èƒ½ã€‚</p><figure class="lr ls lt lu fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nw"><img src="../Images/4f4d5b71c09d2246afb24b55dc4bc235.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0i2Xfs3kckUCXx9M8bY7bA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">æ¬ é‡‡æ ·æ€§èƒ½</figcaption></figure><p id="89df" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">é€šè¿‡ä½¿ç”¨æ¬ é‡‡æ ·ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€äº›å¥½çš„ç»“æœã€‚ä½†ç°åœ¨ï¼Œå…°ç™»æ£®æ—å’ŒDNNä¹‹é—´å±•å¼€äº†æ¿€çƒˆçš„ç«äº‰ã€‚å°½ç®¡å¦‚æ­¤ï¼Œå…°ç™»æ£®æ—ä»ç„¶åœ¨æ‰€æœ‰å…¬å¸ä¸­è¡¨ç°è‰¯å¥½ã€‚</p><p id="0c2d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹å®ƒçš„ç²¾ç¡®å›å¿†å›¾</p><figure class="lr ls lt lu fd ii er es paragraph-image"><div class="er es nx"><img src="../Images/00460faa40524870a57b7e1286af0ace.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*VuMzhpgEP_u_BkzwOTwjDA.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">åº”ç”¨æ¬ é‡‡æ ·åéšæœºæ£®æ—çš„ç²¾ç¡®å¬å›å›¾</figcaption></figure><p id="8082" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä½ å¯ä»¥çœ‹åˆ°å®ƒç°åœ¨åšå¾—å¥½å¤šäº†ã€‚</p><p id="61d2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è®©æˆ‘ä»¬çœ‹çœ‹è¿‡é‡‡æ ·çš„æ€§èƒ½å¦‚ä½•ã€‚</p><h1 id="ecfe" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">7.è¿‡é‡‡æ ·</h1><blockquote class="ng"><p id="d9b3" class="nh ni hh bd nj nk nl nm nn no np jr dx translated"><a class="ae it" href="https://machinelearningmastery.com/smote-oversampling-for-imbalanced-classification/" rel="noopener ugc nofollow" target="_blank"> <em class="nq"> SMOTE </em> </a> <em class="nq">é¦–å…ˆéšæœºé€‰æ‹©ä¸€ä¸ªå°‘æ•°ç±»å®ä¾‹aï¼Œæ‰¾åˆ°å…¶kä¸ªæœ€è¿‘çš„å°‘æ•°ç±»é‚»å±…ã€‚ç„¶åï¼Œé€šè¿‡éšæœºé€‰æ‹©kä¸ªæœ€è¿‘é‚»å±…bä¸­çš„ä¸€ä¸ªå¹¶è¿æ¥aå’Œbä»¥åœ¨ç‰¹å¾ç©ºé—´ä¸­å½¢æˆçº¿æ®µï¼Œæ¥åˆ›å»ºåˆæˆå®ä¾‹ã€‚åˆæˆå®ä¾‹ç”Ÿæˆä¸ºä¸¤ä¸ªé€‰å®šå®ä¾‹aå’Œbçš„å‡¸ç»„åˆã€‚</em></p></blockquote><p id="d3de" class="pw-post-body-paragraph iu iv hh iw b ix nr iz ja jb ns jd je jf nt jh ji jj nu jl jm jn nv jp jq jr ha bi translated">åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†ä¸€äº›æ ·æœ¬æ·»åŠ åˆ°æ¬ºè¯ˆäº¤æ˜“ä¸­ï¼Œä»¥å‡è¡¡æ•°æ®ã€‚</p><pre class="lr ls lt lu fd lv lw lx ly aw lz bi"><span id="d214" class="ma kh hh lw b fi mb mc l md me">drop_list = ['V13','V15','V22','V26','V25','V23']<br/>Y = data['Class']<br/>X=data.drop(['Class']+drop_list, axis = 1)<br/>X_resample, y_resample = SMOTE().fit_resample(X, Y)<br/>print(X_resample.shape)</span></pre><p id="2919" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å°±è¿™æ ·ï¼Œæˆ‘ä»¬çš„æ•°æ®ç°åœ¨è¢«è¿‡åº¦é‡‡æ ·äº†ã€‚è¿‡é‡‡æ ·åçš„æ ·æœ¬æ€»æ•°ä¸º568630ã€‚ç°åœ¨æ•°æ®çš„åˆ†å¸ƒæ˜¯50-50ã€‚</p><figure class="lr ls lt lu fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nw"><img src="../Images/68f7ca669206a06bff61790e8b9fa53e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E0uDRvPPDHSh14kC6FkXdw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">è¿‡é‡‡æ ·æ€§èƒ½</figcaption></figure><p id="d468" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä¸Šè¿°æ€§èƒ½è‚¯å®šæ˜¯ä»¤äººæ»¡æ„çš„ï¼Œå› ä¸ºåœ¨å®ƒæ‰€æœ‰çš„ç®—æ³•éƒ½åšå¾—éå¸¸å¥½ï¼Œä½†è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨éšæœºæ£®æ—çš„æµ‹é‡ä¸­è·å¾—äº†å¤§çº¦100%çš„å‡†ç¡®æ€§ã€‚</p><p id="b5a0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å¦ä¸€ä¸ªéœ€è¦æ³¨æ„çš„é‡è¦äº‹é¡¹æ˜¯ï¼Œåœ¨è¿‡é‡‡æ ·ä¸­ï¼Œæˆ‘æ²¡æœ‰ä½¿ç”¨SVMï¼Œå› ä¸ºæˆ‘ä»¬çš„æ•°æ®å¤§å°å¢åŠ åˆ°568630ä¸ªæ ·æœ¬ï¼Œå¦‚æœæˆ‘ä»¬å¯¹å…¶åº”ç”¨éšæœºæ£®æ—ï¼Œå®ƒå°†æ— ä¼‘æ­¢åœ°è¿è¡Œã€‚</p><p id="b3d0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹ç²¾ç¡®å›å¿†æ›²çº¿ã€‚</p><figure class="lr ls lt lu fd ii er es paragraph-image"><div class="er es ny"><img src="../Images/19cfea5ca284ee09a24b2ae6b68f2906.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*tN8elkt1aohUjzRYZiu95Q.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">åº”ç”¨è¿‡é‡‡æ ·åéšæœºæ£®æ—çš„ç²¾ç¡®å¬å›æ›²çº¿</figcaption></figure><p id="192b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å¯¹äºæˆ‘ä»¬çš„é—®é¢˜æ¥è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ªè¿‘ä¹å®Œç¾çš„åˆ†ç±»å™¨ã€‚</p><blockquote class="lj lk ll"><p id="b951" class="iu iv lm iw b ix iy iz ja jb jc jd je ln jg jh ji lo jk jl jm lp jo jp jq jr ha bi translated">ç»“è®ºå£°æ˜æ˜¯ï¼Œåœ¨åº”ç”¨æ‰€æœ‰æŠ€æœ¯åï¼Œæˆ‘ä»¬åœ¨è¿‡é‡‡æ ·ä¸­è·å¾—äº†æœ€ä½³ç»“æœï¼Œåœ¨åˆ†æä¸Šè¿°ç»“æœåï¼Œè¯¥é—®é¢˜çš„æœ€ä½³ç®—æ³•æ˜¯<strong class="iw hi">éšæœºæ£®æ—ã€‚</strong></p></blockquote><h1 id="94b2" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">8.æ‘˜è¦</h1><p id="aafe" class="pw-post-body-paragraph iu iv hh iw b ix le iz ja jb lf jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">æˆ‘ä»¬åˆ›å»ºäº†7ä¸ªæ¨¡å‹æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¹¶å¯¹å…¶è¿›è¡Œäº†åˆ†æï¼Œæ ¹æ®æˆ‘ä»¬å¾—åˆ°çš„ç»“æœï¼Œå‘ç°éšæœºæ£®æ—æ˜¯è¿„ä»Šä¸ºæ­¢æœ€å¥½çš„ã€‚è¿™å°±æ˜¯ä¿¡ç”¨å¡æ¬ºè¯ˆæ£€æµ‹ä¹‹æ—…ã€‚ğŸ»</p><p id="7225" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä½ å¯ä»¥åœ¨æˆ‘çš„githubåº“<a class="ae it" href="https://github.com/kamlesh11/Credit-Card-Fraud-Detection" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>è·å¾—å®Œæ•´çš„ä»£ç ã€‚</p></div></div>    
</body>
</html>