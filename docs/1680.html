<html>
<head>
<title>March Madness 2021: Simulating a Bracket, Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">2021年疯狂三月:模拟支架，第2部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/march-madness-2021-simulating-a-bracket-part-2-fe8841b1be0b?source=collection_archive---------23-----------------------#2021-03-12">https://medium.com/analytics-vidhya/march-madness-2021-simulating-a-bracket-part-2-fe8841b1be0b?source=collection_archive---------23-----------------------#2021-03-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/c7390c816b63ec3e6f41ee6702411e0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HQ8HZEslO6OvZfXhs3ZsuQ.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">2017年3月疯狂期间办公室里到处都是支架。</figcaption></figure><p id="904d" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">欢迎来到第2部分！如果您错过了第1部分，请查看下面的故事，了解我们在这里所做的一些背景知识:</p><div class="jr js ez fb jt ju"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/march-madness-2021-simulating-a-bracket-part-1-7aa1cad69a65"><div class="jv ab dw"><div class="jw ab jx cl cj jy"><h2 class="bd hi fi z dy jz ea eb ka ed ef hg bi translated">2021年疯狂三月:模拟支架，第1部分</h2><div class="kb l"><h3 class="bd b fi z dy jz ea eb ka ed ef dx translated">在实际工作和这个项目工作之间的最后几周，我一直很安静…我很兴奋终于…</h3></div><div class="kc l"><p class="bd b fp z dy jz ea eb ka ed ef dx translated">medium.com</p></div></div><div class="kd l"><div class="ke l kf kg kh kd ki in ju"/></div></div></a></div><p id="d298" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在这篇文章中，我们将得到更多的技术。我将解释我是如何使用数组、指数分布和大量随机数实现今年的模型的…</p><h1 id="fdaa" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">模型流程</h1><p id="39b5" class="pw-post-body-paragraph it iu hh iv b iw lh iy iz ja li jc jd je lj jg jh ji lk jk jl jm ll jo jp jq ha bi translated">一场篮球赛由一串“所有物”组成。作为一个团队，你要么处于两个世界之一:</p><ul class=""><li id="762a" class="lm ln hh iv b iw ix ja jb je lo ji lp jm lq jq lr ls lt lu bi translated">你没有球。这意味着你要试着通过<strong class="iv hi">偷</strong>球，迫使<strong class="iv hi">失误</strong>，或者<strong class="iv hi">阻挡</strong>射门来得到球。你也要尽量不要犯下会给对方罚球的<strong class="iv hi">犯规</strong>。</li><li id="f208" class="lm ln hh iv b iw lv ja lw je lx ji ly jm lz jq lr ls lt lu bi translated">你有球。这意味着你要努力避免上述所有结果，然后<strong class="iv hi">投篮</strong>(希望<strong class="iv hi">投篮成功！</strong>)。如果你成功了，有可能你的队友<strong class="iv hi">会协助</strong>投篮。如果你投篮不中，比赛将有可能进入<strong class="iv hi">反弹局面。</strong></li></ul><p id="cdb2" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">这两个项目符号很好地描述了模型的核心！我们简单地循环这些可能性，一次一个球，模拟结果并更新数据，直到比赛结束。当然，任何熟悉篮球的人都会意识到我在这里遗漏了一些细微差别，这是故意的。像由进攻造成的犯规或界外比赛这样的事情并没有被精确地建模，因为它们属于我们在第1部分中谈到的“复杂且不一定有价值”的范畴。(我们也没有那么精细的数据，所以无论如何都很难建模！)</p><p id="5d4e" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我们还没有真正谈到的一个问题是，在一场篮球比赛中，每次控球时间有多长。你可以想象这个数字会有很大的变化，但是我们知道一次控球的最长时间是30秒(计时表上的时间长度)。由于在kenpom.com的统计，我们也知道了本赛季每支球队比赛的快慢。举个例子:</p><ul class=""><li id="430b" class="lm ln hh iv b iw ix ja jb je lo ji lp jm lq jq lr ls lt lu bi translated">康涅狄格州今年迄今的AdjT统计数据为66.1，佐治亚州为73.6。因此，如果这两支球队今年打一场比赛，我们预计在40分钟的比赛中会有139.7(约140)次控球。</li><li id="5c01" class="lm ln hh iv b iw lv ja lw je lx ji ly jm lz jq lr ls lt lu bi translated">一个40分钟的游戏是2400秒…2400/140告诉我们，我们在模型中的平均拥有时间应该是大约<strong class="iv hi"> 17秒。</strong></li><li id="a372" class="lm ln hh iv b iw lv ja lw je lx ji ly jm lz jq lr ls lt lu bi translated">为了给这个数字引入一些波动性，我选择使用标准差= 4的正态分布。正态分布的特性告诉我们，使用这些参数随机生成的触发时钟几乎100%的时间都在5到29秒之间。这对我来说似乎足够好了(尽管将来肯定有机会围绕所有权长度的分布做更多的科学研究)。</li><li id="c68f" class="lm ln hh iv b iw lv ja lw je lx ji ly jm lz jq lr ls lt lu bi translated">如果你访问GitHub 上的<a class="ae ma" href="https://github.com/AnnuityDew/api-tarpeydev/blob/master/src/api/autobracket.py" rel="noopener ugc nofollow" target="_blank">代码，你会注意到我实际上最终将<strong class="iv hi">设置为15秒</strong>的平均值。在早期的模拟运行中，我注意到17秒结束时我得到的控球次数比我期望的要少…我最终意识到<strong class="iv hi">这是因为控球只有在球传到另一队时才算！</strong>举个例子，一个队可能会用掉30秒，错过一个镜头，找回他们自己错过的镜头，然后用掉更多的时间。我们的17秒计算假设球总是在17秒结束时易手。为了不使分布过于复杂，我只是将平均值向左移动了一点，以补偿这些额外的长度。</a></li></ul><h1 id="f2b8" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">选择玩家</h1><p id="ad74" class="pw-post-body-paragraph it iu hh iv b iw lh iy iz ja li jc jd je lj jg jh ji lk jk jl jm ll jo jp jq ha bi translated">我们模型的“大本营”是一个数据帧，我们称之为“matchup_df”。在这里，我们将能够使用我最喜欢的熊猫功能之一pd来跟踪每场比赛中每个球员的模拟数据。DataFrame.update()。</p><p id="3ffe" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">对于每次控球，我们需要选择10名球员(每队5名)来完成我上面描述的所有可能的场景。一旦我们做到了这一点，我们就可以使用我们可靠的update语句来记录每个玩家在游戏中花费的时间:</p><figure class="mb mc md me fd ii"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="fe4e" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">“更新”语句允许我们随时更新我们“主场”matchup_df中的相关模拟统计数据！熊猫文献对此做了最好的描述:</p><blockquote class="mh mi mj"><p id="0483" class="it iu mk iv b iw ix iy iz ja jb jc jd ml jf jg jh mm jj jk jl mn jn jo jp jq ha bi translated">数据帧的长度不会因为更新而增加，只会更新匹配索引/列标签处的值。</p></blockquote><h1 id="dbc0" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">指数分布</h1><p id="0afd" class="pw-post-body-paragraph it iu hh iv b iw lh iy iz ja li jc jd je lj jg jh ji lk jk jl jm ll jo jp jq ha bi translated">我想使用每个球员的赛季总统计数据来得出一个“比率参数”,以显示他们得分、抢篮板、抢断等的频率。这个想法非常符合<a class="ae ma" href="https://online.stat.psu.edu/stat414/lesson/15/15.1" rel="noopener ugc nofollow" target="_blank">指数分布</a>的特性……我们可以简单地查看(玩的秒数/选择你的统计数据)来得出玩家做那件特定事情所花费的平均时间。然后，我们可以将其与他们刚刚在我们的模拟中在地板上花费的时间进行比较，以计算给定事件将在该占有中发生的概率！</p><figure class="mb mc md me fd ii"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="c12d" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">上面的代码快照最终成为我需要建模的几乎所有统计数据的一个很好的模板。其他一些属性的逻辑在某些重要的情况下有一些额外的细微差别(例如，射击逻辑有额外的代码来决定一个2pt。或者3pt。已拍摄)。</p><p id="870f" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">这个模型最近增加的内容(比如，今天早上)是上面第40行中的“相对实力”的概念。我得到了非常扭曲的比赛结果，在这种情况下，一个整年都在打弱赛程(低级别球队)并产生非常漂亮的统计数据的球队一直在击败一个整年都在打强赛程(高级别球队)的球队，但他们的统计数据并不那么耀眼(可能是因为他们的比赛相对更难！).幸运的是，Kenpom对所有事情都有一个统计…我们可以简单地比较两个队之间的赛程强度，并对每个赛事的随机数生成器进行适当的调整。我仍然在这个页面上工作，但是你可以在下面的链接中看到这个“相对强度”调整的例子。</p><div class="jr js ez fb jt ju"><a href="https://lit-autobracket.tarpey.dev/" rel="noopener  ugc nofollow" target="_blank"><div class="jv ab dw"><div class="jw ab jx cl cj jy"><h2 class="bd hi fi z dy jz ea eb ka ed ef hg bi translated">细流</h2><div class="kb l"><h3 class="bd b fi z dy jz ea eb ka ed ef dx translated">汽车球拍</h3></div><div class="kc l"><p class="bd b fp z dy jz ea eb ka ed ef dx translated">lit-auto Bragg . tarpey . dev</p></div></div></div></a></div><h1 id="7c44" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">那么，现在一切都是数组了吗？</h1><p id="17a8" class="pw-post-body-paragraph it iu hh iv b iw lh iy iz ja li jc jd je lj jg jh ji lk jk jl jm ll jo jp jq ha bi translated">差不多吧！在上面的代码示例中，“possession_length”是一个镜头时钟数组，每个游戏一个。(“sample_size”是确定同时模拟多少游戏的变量，即每个数组需要多长)。还有一个大型的“跟踪”数组，用于保存每个游戏的状态数据(基本上是一堆1和0，根据需要可以切换开/关):</p><figure class="mb mc md me fd ii"><div class="bz dy l di"><div class="mf mg l"/></div></figure><p id="fa2b" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">对于我在第1部分中描述的原型，所有这些变量都是简单的标量值！通过将它们扩展为数组，数组中的每个值代表一个不同的游戏，我们能够以更具可伸缩性的方式并行操作更多的游戏。</p><h1 id="432f" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">下次…</h1><p id="0e0d" class="pw-post-body-paragraph it iu hh iv b iw lh iy iz ja li jc jd je lj jg jh ji lk jk jl jm ll jo jp jq ha bi translated">在第3部分中，我们将讨论最终输出。我将讨论我在MongoDB的免费层中遇到的存储限制，以及我实现的小技巧，以便最终用户仍然可以看到他们模拟范围内每个游戏的完整模拟分数。(我们甚至可能会说React……虽然还是很丑，但我正在学习。)我会将您链接到最终的网页，您可以在那里生成自己今年的分类！</p><div class="jr js ez fb jt ju"><a href="https://miketarpey.medium.com/march-madness-2021-simulating-a-bracket-part-3-354e2285419c" rel="noopener follow" target="_blank"><div class="jv ab dw"><div class="jw ab jx cl cj jy"><h2 class="bd hi fi z dy jz ea eb ka ed ef hg bi translated">2021年疯狂三月:模拟支架，第3部分</h2><div class="kb l"><h3 class="bd b fi z dy jz ea eb ka ed ef dx translated">欢迎学习第3部分！如果你错过了第1部分和第2部分，你可以从这里开始:</h3></div><div class="kc l"><p class="bd b fp z dy jz ea eb ka ed ef dx translated">miketarpey.medium.com</p></div></div><div class="kd l"><div class="mo l kf kg kh kd ki in ju"/></div></div></a></div><p id="a2de" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">感谢您的阅读——一如既往，欢迎分享您的任何问题、想法或观点，无论是技术方面的还是其他方面的！</p></div></div>    
</body>
</html>