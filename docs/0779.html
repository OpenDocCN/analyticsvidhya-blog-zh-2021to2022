<html>
<head>
<title>Clipboard operations in python.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">python中的剪贴板操作。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/clipboard-operations-in-python-3cf2b3bd998c?source=collection_archive---------0-----------------------#2021-01-31">https://medium.com/analytics-vidhya/clipboard-operations-in-python-3cf2b3bd998c?source=collection_archive---------0-----------------------#2021-01-31</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="03dd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用<strong class="ig hi"> ctrl+c </strong>和<strong class="ig hi"> ctrl+v，</strong>可以非常容易地执行剪贴板的复制/粘贴操作。您可能认为使用编程语言执行剪贴板操作可能很困难，但是我们可以使用python通过几行代码非常容易地做到这一点。Python有专门用于剪贴板操作的库。在这篇短文中，我们将看到三个这样的python库。</p><h1 id="8eff" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated"><strong class="ak"> pyperclip: </strong></h1><p id="854b" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">pyperclip有方法copy()和paste()来执行复制/粘贴操作。它是一个跨平台的库，这意味着我们可以在不同的操作系统上使用这个库。让我们先来看看pyperclip在不同操作系统中的依赖关系。</p><p id="34ca" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">在Windows </strong>上，不需要额外的模块。<br/> <strong class="ig hi">在Mac </strong>上，使用pyobjc模块，回退到pbcopy和pbpaste cli <br/>命令。(这些命令应该是OS X附带的)。<br/> <strong class="ig hi">在Linux </strong>上，通过包管理器安装xclip、xsel或wl-clipboard(用于“wayland”会话)。<br/> <em class="kf">比如在Debian中:<br/>sudo apt-get install xclip<br/>sudo apt-get install xsel<br/>sudo apt-get install wl-clipboard</em></p><p id="83bb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">执行复制/粘贴的方法:</strong></p><p id="5f22" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Pyperclip有copy()和paste()方法来执行这些操作。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="a3f9" class="kp jd hh kl b fi kq kr l ks kt">import pyperclip as pc<br/>x = "Data to be copied to clipboard"<br/>pc.copy(x)<br/>a = pc.paste()<br/>print(a)</span></pre><p id="0792" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">输出:</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="5641" class="kp jd hh kl b fi kq kr l ks kt">Data to be copied to clipboard</span></pre><p id="9694" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Pyperclip会将所有数据类型转换为字符串</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="5810" class="kp jd hh kl b fi kq kr l ks kt">print(type(a))</span><span id="f4d5" class="kp jd hh kl b fi ku kr l ks kt">#output<br/>&lt;class 'str'&gt;</span></pre><p id="bb98" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">pyperclip的其他方法:</strong></p><ol class=""><li id="d666" class="kv kw hh ig b ih ii il im ip kx it ky ix kz jb la lb lc ld bi translated"><strong class="ig hi">确定_clipboard(): </strong> <br/>确定操作系统/平台，并相应设置copy()和paste()函数<br/>。</li></ol><p id="1fcf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 2。waitForNewPaste(time out = None):</strong><br/>该函数调用一直阻塞，直到<br/>剪贴板上出现一个新的文本字符串，该字符串不同于第一次调用函数<br/>时的文本。它返回这个文本。<br/>如果超时被设置为<br/>，并且非空文本没有被放入<br/>剪贴板，则该函数引发PyperclipTimeoutException。<br/> <br/> <strong class="ig hi"> 3。waitForPaste(time out = None):</strong><br/>该函数调用阻塞，直到<br/>剪贴板上存在非空文本字符串。它返回这个文本。<br/>如果超时被设置为<br/>，则该函数引发PyperclipTimeoutException，即非空文本没有被放入<br/>剪贴板的秒数。</p><p id="09ba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 4。set_clipboard(剪贴板):</strong>显式设置剪贴板机制。</p><h1 id="2b7b" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated"><strong class="ak"> pyperclip3 </strong></h1><p id="4274" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">这个模块类似于pyperclip，所有在pyperclip中可用的方法也在这个模块中出现。唯一的区别是，它将每种数据类型转换为字节。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="b1be" class="kp jd hh kl b fi kq kr l ks kt">import pyperclip3 as pc<br/>x = "Data to be copied to clipboard"<br/>pc.copy(x)<br/>a = pc.paste()<br/>print(a)<br/>print(type(a))</span></pre><p id="e18d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">输出:</strong></p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="e615" class="kp jd hh kl b fi kq kr l ks kt">b'Data to be copied to clipboard'<br/>&lt;class 'bytes'&gt;</span></pre><h1 id="18d1" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated"><strong class="ak">剪贴板</strong></h1><p id="92df" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">这个模块只有copy()和paste()方法。以前库中可用的其他方法在本模块中不可用。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="8899" class="kp jd hh kl b fi kq kr l ks kt">import clipboard as c<br/>x = "Data to be copied to clipboard"<br/>c.copy(x)<br/>a = c.paste()<br/>print(a)<br/>print(type(a))</span></pre><p id="65e1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">输出:</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="cfa4" class="kp jd hh kl b fi kq kr l ks kt">Data to be copied to clipboard<br/>&lt;class 'str'&gt;</span></pre><p id="f19a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">结论:</strong></p><p id="9831" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们已经看到了三个python模块(pyperclip、pyperclip3、clipboard ),它们专门用于执行剪贴板操作。但是，Python中有一些包，有内置的方法来执行剪贴板操作，比如熊猫的to_clipboard，类似的tkinter，PyQT都有自己的方法来执行剪贴板操作。</p></div></div>    
</body>
</html>