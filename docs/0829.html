<html>
<head>
<title>Building a simple weather chatbot using Rasa</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Rasa构建一个简单的天气聊天机器人</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/building-a-simple-weather-chatbot-using-rasa-54eaf97daa82?source=collection_archive---------1-----------------------#2021-02-02">https://medium.com/analytics-vidhya/building-a-simple-weather-chatbot-using-rasa-54eaf97daa82?source=collection_archive---------1-----------------------#2021-02-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="50d1" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">在本文中，您将学习如何使用Rasa框架并制作类似人类的对话聊天机器人。</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/f3e712209a0a43d993cef9543adca4a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*x6yJ5yAhtNFEwgmx.jpeg"/></div></div></figure><blockquote class="ji jj jk"><p id="473e" class="jl jm jn jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><strong class="jo hi">所以..Rasa &amp;最重要的是什么为什么是Rasa？？</strong></p><p id="1174" class="jl jm jn jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">Rasa是一个易于定制的开源框架，这使得创建聊天机器人对于初学者来说是一项非常简单的任务。使用Rasa时，会提供完整的bot构建工具。与对话流不同，需要对任何一种编程语言有一点了解。当它以前被称为Rasa堆栈时(当他们开始时)，有单独的库用于<strong class="jo hi"> Rasa NLU </strong>，框架的自然语言理解组件，和<strong class="jo hi"> Rasa核心</strong>，它是对话引擎。现在，这两个组件在Rasa保护伞下共存，尽管如果您愿意，您仍然可以单独使用Rasa NLU。</p></blockquote><blockquote class="ki"><p id="775f" class="kj kk hh bd kl km kn ko kp kq kr kh dx translated">许多大公司和企业，如Adobe、宝马、空客、ENGIE、HCA Healthcare和Orange都使用Rasa NLU。</p></blockquote><p id="2ea1" class="pw-post-body-paragraph jl jm hh jo b jp ks ii jr js kt il ju ku kv jx jy kw kx kb kc ky kz kf kg kh ha bi translated">现在，关于Rasa的<em class="jn">了解</em>已经够多了。让我们开始构建我们的天气聊天机器人。</p><blockquote class="ki"><p id="3180" class="kj kk hh bd kl km la lb lc ld le kh dx translated">我强烈建议您一步一步地仔细阅读每个部分，并阅读Rasa文档以更好地理解概念。</p></blockquote><p id="f1c8" class="pw-post-body-paragraph jl jm hh jo b jp ks ii jr js kt il ju ku kv jx jy kw kx kb kc ky kz kf kg kh ha bi translated">为了收集天气数据，我们必须使用API，因为天气不是一个静态的实体，它会不断变化。所以我们可以使用任何开源的天气API提供者。这里，为了简单起见，我选择了<a class="ae lf" href="https://openweathermap.org/" rel="noopener ugc nofollow" target="_blank"> OpenWeatherMap </a>。你只需登录网站，然后在API密匙部分提供一个API密匙来访问他们的数据。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lg"><img src="../Images/744af5e2d3d5665138c9111f3919e1ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pNA5QQzuOUN8LF7B.png"/></div></div><figcaption class="lh li et er es lj lk bd b be z dx translated"><strong class="bd ll">天气API键</strong></figcaption></figure><p id="4200" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju ku jw jx jy kw ka kb kc ky ke kf kg kh ha bi translated">既然我们已经设置了API，我们可以开始Rasa设置了。</p><p id="5c42" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju ku jw jx jy kw ka kb kc ky ke kf kg kh ha bi translated">Rasa有太多的依赖项，因此我们可以为Rasa创建一个单独的虚拟环境，而不是搞乱我们的<em class="jn">基础环境。要创建虚拟环境，请打开命令提示符，或者如果您使用anaconda提示符，效果会更好。</em></p><pre class="ix iy iz ja fd lm ln lo lp aw lq bi"><span id="0b65" class="lr ls hh ln b fi lt lu l lv lw"><em class="jn">For command prompt:<br/></em>$ python3 -m venv /path/to/new/virtual/environment<em class="jn">For </em>anaconda <em class="jn">prompt:<br/></em>$ conda create -n RasaEnv python=3.7.6</span></pre><p id="8225" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju ku jw jx jy kw ka kb kc ky ke kf kg kh ha bi translated">创建这个虚拟环境后，我们必须从基础环境切换到虚拟环境。这里，我使用anaconda，因为它很简单。</p><pre class="ix iy iz ja fd lm ln lo lp aw lq bi"><span id="161c" class="lr ls hh ln b fi lt lu l lv lw">$ source ./venv/bin/activate<br/><strong class="ln hi">OR<br/></strong>$ conda activate RasaEnv</span></pre><p id="1a6d" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju ku jw jx jy kw ka kb kc ky ke kf kg kh ha bi translated">现在使用conda安装ujson、tensorflow包。到目前为止，conda还没有rasa库，所以我们必须使用pip来安装Rasa。我们不必担心这些库，它们只是让安装变得简单一点。</p><pre class="ix iy iz ja fd lm ln lo lp aw lq bi"><span id="fc54" class="lr ls hh ln b fi lt lu l lv lw">$ pip install rasa</span><span id="8a64" class="lr ls hh ln b fi lx lu l lv lw"><strong class="ln hi">After installation completes, check the version using</strong><br/>$ rasa --version</span></pre><p id="41f4" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju ku jw jx jy kw ka kb kc ky ke kf kg kh ha bi translated">为使用Rasa创建一个单独的文件夹，以便于管理。下一步是创建一个Rasa项目结构的模型，然后根据我们的需要从内部进行编辑。</p><pre class="ix iy iz ja fd lm ln lo lp aw lq bi"><span id="532a" class="lr ls hh ln b fi lt lu l lv lw">$ rasa init --no-prompt</span></pre><p id="68af" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju ku jw jx jy kw ka kb kc ky ke kf kg kh ha bi translated"><code class="du ly lz ma ln b">rasa init</code>命令创建Rasa项目需要的所有文件，并在一些样本数据上训练一个简单的机器人。如果您忽略了<code class="du ly lz ma ln b">--no-prompt</code>标志，您将被询问一些关于您希望如何设置项目的问题。这将创建以下文件:</p><pre class="ix iy iz ja fd lm ln lo lp aw lq bi"><span id="f718" class="lr ls hh ln b fi lt lu l lv lw">.<br/>├── actions.py<br/>├── config.yml<br/>├── credentials.yml<br/>├── data<br/>│   ├── nlu.md<br/>│   └── stories.md<br/>├── domain.yml<br/>├── endpoints.yml<br/>└── models<br/>    └── &lt;timestamp&gt;.tar.gz</span></pre><p id="3351" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju ku jw jx jy kw ka kb kc ky ke kf kg kh ha bi translated">我们主要将只使用3个主要文件，即<strong class="jo hi"> <em class="jn"> nlu.md、stories.md </em> </strong>和<strong class="jo hi"> <em class="jn"> domain.yml </em> </strong>。我们不需要打扰其他文件。忘了它们吧，让它们挂在那里。使用任何代码编辑器来轻松处理这些文件，我个人的偏好是Visual Studio代码(VS代码)。</p></div><div class="ab cl mb mc go md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ha hb hc hd he"><p id="fa95" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju ku jw jx jy kw ka kb kc ky ke kf kg kh ha bi translated">我们主要只使用3个主要文件，即<strong class="jo hi"> <em class="jn"> nlu.md、stories.md </em> </strong>和<strong class="jo hi"> <em class="jn"> domain.yml </em> </strong>。我们不需要打扰其他文件。忘了它们吧，让它们挂在那里。使用任何代码编辑器来轻松处理这些文件，我更喜欢Visual Studio代码(而不是代码)。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mi"><img src="../Images/d516fdec043bee68023bea882edf2bdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/0*K2gcpeUP4rUjrIlN.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated"><strong class="bd ll">向聊天机器人询问天气情况的对话示例</strong></figcaption></figure><p id="4818" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju ku jw jx jy kw ka kb kc ky ke kf kg kh ha bi translated">为了从这些语句中提取城市的名称，我们必须使用另一个称为实体的特性。我们可以通过突出城市来做同样的事情。确保添加不同类型的条目，以便NLU能够正确地获取用户。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mj"><img src="../Images/1309e50e0d4f9e18450edce637a7f8c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/0*vPXybFuj3Jwr66JX.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated"><strong class="bd ll">【城市名称】是实体，而(位置)是给这个实体的名称</strong></figcaption></figure><p id="bc69" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju ku jw jx jy kw ka kb kc ky ke kf kg kh ha bi translated">这部分现在打开<strong class="jo hi">后的<em class="jn">域. yml </em>后的</strong>文件。我们将看到列出的意图，在下面添加您的新意图，您添加的顺序无关紧要。添加一个名为实体和插槽的两个新组件，然后将<em class="jn">位置的</em>列为实体。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mk"><img src="../Images/5a60ba46300d9fa5155575c96ff778f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/0*hziwNq0cKRNINAGS.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated">如果你有不同的实体要收集，一定要提到。</figcaption></figure><p id="8e07" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju ku jw jx jy kw ka kb kc ky ke kf kg kh ha bi translated">继续查看responses部分下的<strong class="jo hi"> <em class="jn"> domain.yml </em> </strong>文件，我们会发现<code class="du ly lz ma ln b">utter_greet</code> <em class="jn"> </em>在此文件下，如果用户问候意图被激活，我们应该编写我们的聊天机器人应该向用户问候的条目。同样我们也应该充满其他的意图。为了让对话更人性化，我们应该添加不同的回应，这样每次我们的机器人就不会重复同样的事情。如果你不能理解，请访问我的GitHub文件库。我在本文末尾提供了链接。</p><blockquote class="ji jj jk"><p id="bd26" class="jl jm jn jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><em class="hh">这里的</em> <strong class="jo hi">表示</strong> <em class="hh">是我们聊天机器人的输出，而</em> <strong class="jo hi">动作</strong> <em class="hh">表示当用户激活某个意图时，我们聊天机器人所做的动作。现在提及</em>动作<em class="hh">部分的所有话语和动作。</em></p></blockquote></div><div class="ab cl mb mc go md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ha hb hc hd he"><p id="b488" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju ku jw jx jy kw ka kb kc ky ke kf kg kh ha bi translated">最后，在<strong class="jo hi"> <em class="jn"> stories.md </em> </strong>文件中创建至少5个故事，如下所示，这将确保聊天机器人对用户进行的任何类型的对话做出有意义的回复。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ml"><img src="../Images/bf89812c9da15e20d7d32e9cff356531.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/0*uVyS3r5ZhwoNt4OS.png"/></div></figure><p id="a728" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju ku jw jx jy kw ka kb kc ky ke kf kg kh ha bi translated">用户可以提出尽可能多的请求，也就是说，用户可以一个接一个地询问不同地方的天气状况和温度，你插入的故事数量将保持这种情况。</p></div><div class="ab cl mb mc go md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ha hb hc hd he"><p id="5e2a" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju ku jw jx jy kw ka kb kc ky ke kf kg kh ha bi translated">现在是<strong class="jo hi"> <em class="jn">动作的编码部分。py </em> </strong>这是一个python文件。提供了一个示例代码片段，它将是注释的一部分，仅取消注释代码和必要的库。将有两个组件，即“<em class="jn">调度器</em>”和“<em class="jn">跟踪器</em>”。跟踪器用于从对话语句中选择或提取位置(城市)实体名称。dispatcher变量用于将来自这个<em class="jn"> action.py </em>文件的响应返回给<strong class="jo hi"> Rasa核心</strong>。请参考我的Git存储库中的文件。用这个actions.py文件连接天气API。我们必须创建另一个提取数据的python文件。这是单独编写的，因为我们不应该不惜任何代价弄乱actions.py文件。</p></div><div class="ab cl mb mc go md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ha hb hc hd he"><h2 id="b6ae" class="lr ls hh bd ll mm mn mo mp mq mr ms mt ku mu mv mw kw mx my mz ky na nb nc nd bi translated">现在，我们已经为项目结构做好了准备。我们必须根据我们的作战需要训练NLU皇家陆军和核心部队。</h2><p id="f60b" class="pw-post-body-paragraph jl jm hh jo b jp ne ii jr js nf il ju ku ng jx jy kw nh kb kc ky ni kf kg kh ha bi translated">为了训练Rasa核心和NLU，使用了一个简单的命令。</p><pre class="ix iy iz ja fd lm ln lo lp aw lq bi"><span id="c0a5" class="lr ls hh ln b fi lt lu l lv lw">$ rasa train</span></pre><p id="9efc" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju ku jw jx jy kw ka kb kc ky ke kf kg kh ha bi translated">训练完成后，我们就可以开始和我们的聊天机器人交谈了。在我们开始使用聊天机器人之前，我们必须启动服务器，以便<em class="jn"> actions.py [server] </em>开始工作，即API将获取数据并将其返回给我们的程序。</p><pre class="ix iy iz ja fd lm ln lo lp aw lq bi"><span id="fb56" class="lr ls hh ln b fi lt lu l lv lw"><em class="jn">Initiate the server for using API</em><br/>$ rasa run actions</span></pre><blockquote class="ji jj jk"><p id="5b1a" class="jl jm jn jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><strong class="jo hi">注</strong></p><p id="7c59" class="jl jm jn jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">动作服务器的启动应该在单独的终端中完成，Rasa聊天机器人的激活应该在另一个终端中单独完成。</p></blockquote><p id="4313" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju ku jw jx jy kw ka kb kc ky ke kf kg kh ha bi translated">有两种方法可以做到这一点。我们可以选择经典的命令提示符风格或新的GUI方法。使用GUI方法的优点是我们可以修改故事和它们的路径，而不用再次跳到代码编辑器中。利用这一点，我们可以不断改进我们的助手聊天机器人。</p><pre class="ix iy iz ja fd lm ln lo lp aw lq bi"><span id="1933" class="lr ls hh ln b fi lt lu l lv lw"><em class="jn">Start conversation in command prompt</em><br/>$ rasa shell</span><span id="0b51" class="lr ls hh ln b fi lx lu l lv lw"><em class="jn">Start conversation in Rasa GUI</em><br/>$ rasa x</span></pre><blockquote class="ji jj jk"><p id="d36f" class="jl jm jn jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">什么是Rasa X？</p><p id="59f7" class="jl jm jn jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">Rasa X是一个工具集，帮助您利用对话来改善您的助手。一旦你建立了一个最小可行的助手，一个可以处理最重要的快乐路径故事的助手，Rasa X会帮助你进入下一个阶段。有关更多信息，请访问<a class="ae lf" href="https://rasa.com/docs/rasa-x/#improve-your-contextual-assistant-with-rasa-x" rel="noopener ugc nofollow" target="_blank"> rasa x </a>文档。</p></blockquote><p id="4d15" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju ku jw jx jy kw ka kb kc ky ke kf kg kh ha bi translated">最后，我们成功地完成了对机器人的训练，使它能够理解自然语言并做出相应的回答。</p></div><div class="ab cl mb mc go md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ha hb hc hd he"><h2 id="aa63" class="lr ls hh bd ll mm mn mo mp mq mr ms mt ku mu mv mw kw mx my mz ky na nb nc nd bi translated">Rasa中可以尝试的一些附加功能</h2><p id="d686" class="pw-post-body-paragraph jl jm hh jo b jp ne ii jr js nf il ju ku ng jx jy kw nh kb kc ky ni kf kg kh ha bi translated">下面的可视化可以看到你的聊天机器人，也可以使用下面的命令来查看聊天机器人的工作结构。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es nj"><img src="../Images/ab2185e9889a984063acd745529738ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/0*1A3xrNRbLl14azRr.png"/></div><figcaption class="lh li et er es lj lk bd b be z dx translated"><strong class="bd ll">可视化经过训练的聊天机器人的对话流程</strong></figcaption></figure><pre class="ix iy iz ja fd lm ln lo lp aw lq bi"><span id="3ba4" class="lr ls hh ln b fi lt lu l lv lw">$ rasa visualize</span></pre><p id="01ed" class="pw-post-body-paragraph jl jm hh jo b jp jq ii jr js jt il ju ku jw jx jy kw ka kb kc ky ke kf kg kh ha bi translated"><em class="jn">感谢阅读！</em>😊如果你喜欢，请支持我并分享这个故事！！！ ❤</p><h2 id="0dab" class="lr ls hh bd ll mm mn mo mp mq mr ms mt ku mu mv mw kw mx my mz ky na nb nc nd bi translated">如果你需要源代码，这里是我的<a class="ae lf" href="https://github.com/GowriSankar-JG/WeatherBot-using-Rasa" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>。</h2><p id="961b" class="pw-post-body-paragraph jl jm hh jo b jp ne ii jr js nf il ju ku ng jx jy kw nh kb kc ky ni kf kg kh ha bi translated"><em class="jn">如果我错了，你可以随时纠正我，分享你的想法、反馈、评论和澄清。它帮助我鼓励和即兴发挥自己。</em></p><blockquote class="ki"><p id="7883" class="kj kk hh bd kl km la lb lc ld le kh dx translated"><em class="nk">更多我的资讯文章，关注我</em> <a class="ae lf" rel="noopener" href="/@SiddharthIvan"> <em class="nk">中</em> </a> <em class="nk">。干杯❤和快乐学习！！</em></p></blockquote><p id="8450" class="pw-post-body-paragraph jl jm hh jo b jp ks ii jr js kt il ju ku kv jx jy kw kx kb kc ky kz kf kg kh ha bi translated">如果你对数据科学/机器学习有热情，欢迎在<a class="ae lf" href="http://linkedin.com/in/gowrisankar-jg/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上加我。</p><h1 id="7506" class="nl ls hh bd ll nm nn no mp np nq nr mt in ns io mw iq nt ir mz it nu iu nc nv bi translated">参考资料:</h1><p id="0feb" class="pw-post-body-paragraph jl jm hh jo b jp ne ii jr js nf il ju ku ng jx jy kw nh kb kc ky ni kf kg kh ha bi translated">[1] <a class="ae lf" href="https://rasa.com/docs/" rel="noopener ugc nofollow" target="_blank">官方文档</a><br/>【2】<a class="ae lf" rel="noopener" href="/front-end-weekly/how-to-build-awesome-rasa-chatbot-for-a-web-ce4a9acafd3b">如何为一个web搭建牛逼的Rasa聊天机器人</a><br/>【3】<a class="ae lf" rel="noopener" href="/coinmonks/rasa-python-weather-chatbot-51fc218d346d">Rasa Python天气聊天机器人</a><br/>【4】获得证书:<a class="ae lf" href="https://www.coursera.org/projects/chatbot-rasa-python" rel="noopener ugc nofollow" target="_blank"> Coursera项目</a></p></div></div>    
</body>
</html>