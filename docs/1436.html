<html>
<head>
<title>Non-Linear Regression Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">éçº¿æ€§å›å½’åˆ†æ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/non-linear-regression-analysis-e150447ac1a3?source=collection_archive---------0-----------------------#2021-03-02">https://medium.com/analytics-vidhya/non-linear-regression-analysis-e150447ac1a3?source=collection_archive---------0-----------------------#2021-03-02</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/c5eb8de6fd47ba8e58632679c47b5d49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hccTducJo17wcYBGazQwag.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">å›¾ç‰‡æ¥æº:ä½œè€…</figcaption></figure><div class=""/></div><div class="ab cl iu iv gp iw" role="separator"><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz ja"/><span class="ix bw bk iy iz"/></div><div class="hb hc hd he hf"><h1 id="c280" class="jb jc hx bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy bi translated">ä»‹ç»</h1><p id="adf1" class="pw-post-body-paragraph jz ka hx kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi kx translated"><span class="l ky kz la bm lb lc ld le lf di">å¦‚æœ</span>æ•°æ®æ˜¾ç¤ºæ›²çº¿è¶‹åŠ¿ï¼Œé‚£ä¹ˆ<strong class="kb hy">çº¿æ€§å›å½’</strong>ä¸<strong class="kb hy">éçº¿æ€§å›å½’</strong>ç›¸æ¯”ä¸ä¼šäº§ç”Ÿéå¸¸å‡†ç¡®çš„ç»“æœï¼Œå› ä¸ºé¡¾åæ€ä¹‰ï¼Œ<strong class="kb hy">çº¿æ€§å›å½’</strong>å‡å®š<strong class="kb hy">æ•°æ®</strong>æ˜¯<strong class="kb hy">çº¿æ€§çš„</strong>ã€‚è®©æˆ‘ä»¬å­¦ä¹ ä¸€ä¸‹<strong class="kb hy">éçº¿æ€§å›å½’</strong>å¹¶åœ¨<strong class="kb hy"> python </strong>ä¸­åº”ç”¨ä¸€ä¸ªä¾‹å­ã€‚åœ¨è¿™æœ¬ç¬”è®°æœ¬ä¸­ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ª<strong class="kb hy">éçº¿æ€§æ¨¡å‹</strong>æ‹Ÿåˆåˆ°ä¸1960å¹´è‡³2014å¹´ä¸­å›½GDPç›¸å¯¹åº”çš„<strong class="kb hy">æ•°æ®ç‚¹</strong>ã€‚</p><h1 id="7dc1" class="jb jc hx bd jd je lg jg jh ji lh jk jl jm li jo jp jq lj js jt ju lk jw jx jy bi translated">å¯¼å…¥æ‰€éœ€çš„åº“</h1><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="cea2" class="lu jc hx lq b fi lv lw l lx ly"># Basic Data Science libraries<em class="lz"><br/></em><strong class="lq hy">import numpy as np<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>%matplotlib inline</strong></span><span id="bcaa" class="lu jc hx lq b fi ma lw l lx ly"><strong class="lq hy">sns.set()</strong></span></pre><blockquote class="mb mc md"><p id="f8bb" class="jz ka lz kb b kc me ke kf kg mf ki kj mg mh km kn mi mj kq kr mk ml ku kv kw hb bi translated">è™½ç„¶çº¿æ€§å›å½’å¾ˆå¥½åœ°è§£å†³äº†è®¸å¤šé—®é¢˜ï¼Œä½†å®ƒä¸èƒ½ç”¨äºæ‰€æœ‰æ•°æ®é›†ã€‚é¦–å…ˆå›å¿†ä¸€ä¸‹<strong class="kb hy">çº¿æ€§å›å½’</strong>å¦‚ä½•å¯¹æ•°æ®é›†å»ºæ¨¡ã€‚å®ƒæ¨¡æ‹Ÿäº†ä¸€ä¸ª<strong class="kb hy">å› å˜é‡</strong>å˜é‡<strong class="kb hy"> <em class="hx"> y </em> </strong>å’Œä¸€ä¸ª<strong class="kb hy">è‡ªå˜é‡</strong>å˜é‡<strong class="kb hy"> <em class="hx"> x </em> </strong>ä¹‹é—´çš„<strong class="kb hy">çº¿æ€§å…³ç³»ã€‚å®ƒæœ‰ä¸€ä¸ªç®€å•çš„1æ¬¡æ–¹ç¨‹ï¼Œä¾‹å¦‚<strong class="kb hy"> y = 2ğ‘¥ + 3 </strong>ã€‚</strong></p></blockquote><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="df85" class="lu jc hx lq b fi lv lw l lx ly"><strong class="lq hy">x = np.arange(-5.0, 5.0, 0.1)<br/></strong>#You can adjust the slope and intercept to verify the changes in the graph.<br/><strong class="lq hy">y = 2*(x) + 3<br/>y_noise = 2 * np.random.normal(size=x.size)<br/>ydata = y + y_noise<br/>plt.figure(figsize=(8,6))<br/>plt.plot(x, ydata,  'bo')<br/>plt.plot(x,y, 'r') <br/>plt.ylabel('Dependent Variable')<br/>plt.xlabel('Indepdendent Variable')<br/>plt.show()</strong></span></pre><figure class="ll lm ln lo fd hk er es paragraph-image"><div class="er es mm"><img src="../Images/2f1ab5e1d15c5c4edb8a40463a23e68f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*jr0mGkTbRtMpP49c19FJZg.png"/></div></figure><p id="e6e3" class="pw-post-body-paragraph jz ka hx kb b kc me ke kf kg mf ki kj kk mh km kn ko mj kq kr ks ml ku kv kw hb bi translated"><strong class="kb hy">éçº¿æ€§å›å½’</strong>æ˜¯<strong class="kb hy">ç‹¬ç«‹</strong>å˜é‡<strong class="kb hy"> ğ‘¥ </strong>å’Œ<strong class="kb hy">å› å˜é‡</strong>ğ‘¦ä¹‹é—´çš„å…³ç³»ï¼Œè¿™å¯¼è‡´äº†<strong class="kb hy">éçº¿æ€§å‡½æ•°æ¨¡å‹åŒ–</strong>æ•°æ®ã€‚æœ¬è´¨ä¸Šä»»ä½•ä¸æ˜¯<strong class="kb hy">çº¿æ€§</strong>çš„å…³ç³»éƒ½å¯ä»¥ç§°ä¸º<strong class="kb hy">éçº¿æ€§</strong>ï¼Œé€šå¸¸ç”¨<strong class="kb hy"> ğ‘˜ </strong>åº¦çš„<strong class="kb hy">å¤šé¡¹å¼</strong>è¡¨ç¤º(æœ€å¤§åŠŸç‡<strong class="kb hy"> ğ‘¥ </strong>)ã€‚</p><blockquote class="mb mc md"><p id="b12c" class="jz ka lz kb b kc me ke kf kg mf ki kj mg mh km kn mi mj kq kr mk ml ku kv kw hb bi translated"><strong class="kb hy"> ğ‘¦ =ğ‘x +ğ‘ğ‘¥ +ğ‘ğ‘¥+ğ‘‘ </strong></p></blockquote><p id="d62c" class="pw-post-body-paragraph jz ka hx kb b kc me ke kf kg mf ki kj kk mh km kn ko mj kq kr ks ml ku kv kw hb bi translated"><strong class="kb hy">éçº¿æ€§</strong>å‡½æ•°å¯ä»¥æœ‰ç±»ä¼¼äº<strong class="kb hy">æŒ‡æ•°</strong>ã€<strong class="kb hy">å¯¹æ•°</strong>ã€<strong class="kb hy">åˆ†æ•°</strong>ç­‰å…ƒç´ ã€‚ä¾‹å¦‚:</p><blockquote class="mb mc md"><p id="8a62" class="jz ka lz kb b kc me ke kf kg mf ki kj mg mh km kn mi mj kq kr mk ml ku kv kw hb bi translated"><strong class="kb hy"> ğ‘¦=log(ğ‘¥) </strong></p></blockquote><p id="6a50" class="pw-post-body-paragraph jz ka hx kb b kc me ke kf kg mf ki kj kk mh km kn ko mj kq kr ks ml ku kv kw hb bi translated">ç”šè‡³æ›´å¤æ‚ï¼Œä¾‹å¦‚:</p><blockquote class="mb mc md"><p id="f2f9" class="jz ka lz kb b kc me ke kf kg mf ki kj mg mh km kn mi mj kq kr mk ml ku kv kw hb bi translated"><strong class="kb hy"> ğ‘¦=log(ğ‘ğ‘¥ +ğ‘ğ‘¥ +ğ‘ğ‘¥+ğ‘‘) </strong></p></blockquote><p id="c314" class="pw-post-body-paragraph jz ka hx kb b kc me ke kf kg mf ki kj kk mh km kn ko mj kq kr ks ml ku kv kw hb bi translated">è®©æˆ‘ä»¬æ¥çœ‹çœ‹ä¸€ä¸ª<strong class="kb hy">ä¸‰æ¬¡</strong>å‡½æ•°çš„å›¾å½¢ã€‚</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="3c45" class="lu jc hx lq b fi lv lw l lx ly"><strong class="lq hy">x = np.arange(-5.0, 5.0, 0.1)<br/></strong>#You can adjust the slope and intercept to verify the changes in the graph<br/><strong class="lq hy">y = 1*(x**3) + 1*(x**2) + 1*x + 3<br/>y_noise = 20 * np.random.normal(size=x.size)<br/>ydata = y + y_noise<br/>plt.plot(x, ydata,  'bo')<br/>plt.plot(x,y, 'r') <br/>plt.ylabel('Dependent Variable')<br/>plt.xlabel('Indepdendent Variable')<br/>plt.show()</strong></span></pre><figure class="ll lm ln lo fd hk er es paragraph-image"><div class="er es mn"><img src="../Images/382709007a069205442060882abf4715.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*mIFxOiWX6UQrNQciLw2gfg.png"/></div></figure><blockquote class="mb mc md"><p id="8d29" class="jz ka lz kb b kc me ke kf kg mf ki kj mg mh km kn mi mj kq kr mk ml ku kv kw hb bi translated">å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªå‡½æ•°æœ‰<strong class="kb hy"> <em class="hx"> ğ‘¥ </em> </strong>å’Œ<strong class="kb hy"> <em class="hx"> ğ‘¥ </em> </strong>ä½œä¸º<strong class="kb hy">ç‹¬ç«‹</strong>å˜é‡ã€‚æ­¤å¤–ï¼Œè¯¥å‡½æ•°çš„å›¾å½¢ä¸æ˜¯åœ¨<strong class="kb hy"> 2D </strong>å¹³é¢ä¸Šçš„ç›´çº¿ã€‚æ‰€ä»¥è¿™æ˜¯ä¸€ä¸ª<strong class="kb hy">éçº¿æ€§å‡½æ•°</strong>ã€‚</p></blockquote><h1 id="4a77" class="jb jc hx bd jd je lg jg jh ji lh jk jl jm li jo jp jq lj js jt ju lk jw jx jy bi translated">éçº¿æ€§å›å½’ç¤ºä¾‹</h1><p id="50d9" class="pw-post-body-paragraph jz ka hx kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">ä¸¾ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å°†å°è¯•ç”¨ä¸€ä¸ªéçº¿æ€§æ¨¡å‹æ¥æ‹Ÿåˆ1960å¹´è‡³2014å¹´ä¸­å›½GDPçš„æ•°æ®ç‚¹ã€‚æˆ‘ä»¬ä¸‹è½½äº†ä¸€ä¸ªæœ‰ä¸¤åˆ—çš„æ•°æ®é›†ï¼Œç¬¬ä¸€åˆ—æ˜¯1960å¹´åˆ°2014å¹´ä¹‹é—´çš„ä¸€å¹´ï¼Œç¬¬äºŒåˆ—æ˜¯ä¸­å›½åœ¨é‚£ä¸€å¹´ä»¥ç¾å…ƒè®¡ç®—çš„ç›¸åº”å¹´åº¦å›½å†…ç”Ÿäº§æ€»å€¼ã€‚</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="14e9" class="lu jc hx lq b fi lv lw l lx ly"><strong class="lq hy">import numpy as np<br/>import pandas as pd</strong></span><span id="c42d" class="lu jc hx lq b fi ma lw l lx ly">#downloading dataset<br/><strong class="lq hy">!wget -nv -O china_gdp.csv </strong><a class="ae mo" href="https://s3-api.us-geo.objectstorage.softlayer.net/cf-courses-data/CognitiveClass/ML0101ENv3/labs/china_gdp.csv" rel="noopener ugc nofollow" target="_blank"><strong class="lq hy">https://s3-api.us-geo.objectstorage.softlayer.net/cf-courses-data/CognitiveClass/ML0101ENv3/labs/china_gdp.csv</strong></a><strong class="lq hy"><br/>    <br/>df = pd.read_csv("china_gdp.csv")<br/>df.head(10)</strong></span></pre><figure class="ll lm ln lo fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mp"><img src="../Images/483c25057b75923abb35dbd5eb085632.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v8UOz6IG4YYRViaN7Eglvg.png"/></div></div></figure><h1 id="82ee" class="jb jc hx bd jd je lg jg jh ji lh jk jl jm li jo jp jq lj js jt ju lk jw jx jy bi translated">ç»˜åˆ¶æ•°æ®é›†</h1><p id="2b61" class="pw-post-body-paragraph jz ka hx kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">è¿™æ˜¯æ•°æ®ç‚¹çš„æ ·å­ã€‚å®ƒçœ‹èµ·æ¥æœ‰ç‚¹åƒé€»è¾‘å‡½æ•°æˆ–æŒ‡æ•°å‡½æ•°ã€‚å¼€å§‹æ—¶å¢é•¿ç¼“æ…¢ï¼Œä»2005å¹´å¼€å§‹ï¼Œå¢é•¿éå¸¸æ˜¾è‘—ã€‚æœ€åï¼Œå®ƒåœ¨2010å¹´ä»£ç•¥æœ‰å‡é€Ÿã€‚</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="2110" class="lu jc hx lq b fi lv lw l lx ly"><strong class="lq hy">plt.figure(figsize=(8,5))<br/>x_data, y_data = (df["Year"].values, df["Value"].values)<br/>plt.plot(x_data, y_data, 'ro')<br/>plt.ylabel('GDP')<br/>plt.xlabel('Year')<br/>plt.show()</strong></span></pre><figure class="ll lm ln lo fd hk er es paragraph-image"><div class="er es mq"><img src="../Images/758978f2f728061ffc1af8ff6a00fa9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*uBtG4AzRukjv7Fg0eiisHA.png"/></div></figure><h1 id="b328" class="jb jc hx bd jd je lg jg jh ji lh jk jl jm li jo jp jq lj js jt ju lk jw jx jy bi translated">é€‰æ‹©æ¨¡å‹</h1><blockquote class="mb mc md"><p id="7213" class="jz ka lz kb b kc me ke kf kg mf ki kj mg mh km kn mi mj kq kr mk ml ku kv kw hb bi translated">ä»å¯¹è¯¥å›¾çš„åˆæ­¥è§‚å¯Ÿï¼Œæˆ‘ä»¬ç¡®å®šé€»è¾‘å‡½æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è¿‘ä¼¼ï¼Œå› ä¸ºå®ƒå…·æœ‰ä»ç¼“æ…¢å¢é•¿å¼€å§‹ï¼Œåœ¨ä¸­é—´å¢é•¿ï¼Œç„¶ååœ¨æœ€åå†æ¬¡ä¸‹é™çš„ç‰¹æ€§ï¼›å¦‚ä¸‹å›¾æ‰€ç¤º:</p></blockquote><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="f6d0" class="lu jc hx lq b fi lv lw l lx ly"><strong class="lq hy">X = np.arange(-5.0, 5.0, 0.1)<br/>Y = 1.0 / (1.0 + np.exp(-X))</strong></span><span id="e5f0" class="lu jc hx lq b fi ma lw l lx ly"><strong class="lq hy">plt.plot(X,Y) <br/>plt.ylabel('Dependent Variable')<br/>plt.xlabel('Indepdendent Variable')<br/>plt.show()</strong></span></pre><figure class="ll lm ln lo fd hk er es paragraph-image"><div class="er es mq"><img src="../Images/6c52dba65e9f3cadaa70556bff50248e.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*g6m0kqsEK5bdLB4HKqEIQA.png"/></div></figure><figure class="ll lm ln lo fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mr"><img src="../Images/d50802e5e07178a29f60f8f50f26ff49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*prOURZZamtYGyhGzWIMMTw.png"/></div></div></figure><h1 id="5d2e" class="jb jc hx bd jd je lg jg jh ji lh jk jl jm li jo jp jq lj js jt ju lk jw jx jy bi translated">æ„å»ºæ¨¡å‹</h1><p id="1788" class="pw-post-body-paragraph jz ka hx kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ„å»ºæˆ‘ä»¬çš„å›å½’æ¨¡å‹å¹¶åˆå§‹åŒ–å®ƒçš„å‚æ•°ã€‚</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="9a0c" class="lu jc hx lq b fi lv lw l lx ly"><strong class="lq hy">def sigmoid(x, Beta_1, Beta_2):<br/>     y = 1 / (1 + np.exp(-Beta_1*(x-Beta_2)))<br/>     return y</strong></span><span id="fead" class="lu jc hx lq b fi ma lw l lx ly"><strong class="lq hy">beta_1 = 0.10<br/>beta_2 = 1990.0</strong></span><span id="81e0" class="lu jc hx lq b fi ma lw l lx ly">#logistic function<br/><strong class="lq hy">Y_pred = sigmoid(x_data, beta_1 , beta_2)</strong></span><span id="c108" class="lu jc hx lq b fi ma lw l lx ly"><strong class="lq hy">#plot initial prediction against datapoints<br/>plt.plot(x_data, Y_pred*15000000000000.)<br/>plt.plot(x_data, y_data, 'ro'</strong></span></pre><figure class="ll lm ln lo fd hk er es paragraph-image"><div class="er es ms"><img src="../Images/c7f46e6a57fbd8240750fc0b2a1a67d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*A44fRkKY51jH0i-ypa5KSg.png"/></div></figure><p id="1c99" class="pw-post-body-paragraph jz ka hx kb b kc me ke kf kg mf ki kj kk mh km kn ko mj kq kr ks ml ku kv kw hb bi translated">æˆ‘ä»¬åœ¨è¿™é‡Œçš„ä»»åŠ¡æ˜¯ä¸ºæˆ‘ä»¬çš„<strong class="kb hy">æ¨¡å‹</strong>æ‰¾åˆ°<strong class="kb hy">æœ€ä½³å‚æ•°</strong>ã€‚è®©æˆ‘ä»¬å…ˆæŠŠ<strong class="kb hy">æ­£å¸¸åŒ–</strong>æˆ‘ä»¬çš„<em class="lz"> </em> <strong class="kb hy"> <em class="lz"> x </em> </strong>å’Œ<strong class="kb hy"> <em class="lz"> y </em> </strong>:</p><h2 id="e5aa" class="lu jc hx bd jd mt mu mv jh mw mx my jl kk mz na jp ko nb nc jt ks nd ne jx nf bi translated">æˆ‘ä»¬å¦‚ä½•ä¸ºæ‹Ÿåˆçº¿æ‰¾åˆ°æœ€ä½³å‚æ•°ï¼Ÿ</h2><p id="671d" class="pw-post-body-paragraph jz ka hx kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong class="kb hy"> curve_fit </strong>ï¼Œå®ƒä½¿ç”¨éçº¿æ€§æœ€å°äºŒä¹˜æ³•æ¥æ‹Ÿåˆæˆ‘ä»¬çš„<strong class="kb hy"> sigmoidå‡½æ•°</strong>åˆ°æ•°æ®ã€‚ä½¿<strong class="kb hy"> sigmoid(xdataï¼Œ*popt) </strong> - <strong class="kb hy"> ydata </strong>çš„æ®‹å·®å¹³æ–¹å’Œæœ€å°çš„å‚æ•°çš„æœ€ä½³å€¼ã€‚poptæ˜¯æˆ‘ä»¬ä¼˜åŒ–çš„å‚æ•°ã€‚</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="5588" class="lu jc hx lq b fi lv lw l lx ly"># Lets normalize our data<br/><strong class="lq hy">xdata =x_data/max(x_data)<br/>ydata =y_data/max(y_data)</strong></span><span id="7ab0" class="lu jc hx lq b fi ma lw l lx ly"><strong class="lq hy">from scipy.optimize import curve_fit<br/>popt, pcov = curve_fit(sigmoid, xdata, ydata)</strong></span><span id="89e2" class="lu jc hx lq b fi ma lw l lx ly"># Now we plot our resulting regression model.<br/><strong class="lq hy">x = np.linspace(1960, 2015, 55)<br/>x = x/max(x)<br/>plt.figure(figsize=(8,5))<br/>y = sigmoid(x, *popt)<br/>plt.plot(xdata, ydata, 'ro', label='data')<br/>plt.plot(x,y, linewidth=3.0, label='fit')<br/>plt.legend(loc='best')<br/>plt.ylabel('GDP')<br/>plt.xlabel('Year')<br/>plt.show()</strong></span></pre><figure class="ll lm ln lo fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ng"><img src="../Images/5586c01a20bb92357010c2e78feb0a59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_lvC0rd13UCCWioWRB1nlg.png"/></div></div></figure><h1 id="59be" class="jb jc hx bd jd je lg jg jh ji lh jk jl jm li jo jp jq lj js jt ju lk jw jx jy bi translated"><strong class="ak">æˆ‘ä»¬æ¨¡å‹çš„è®¡ç®—ç²¾åº¦ï¼Ÿ</strong></h1><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="1529" class="lu jc hx lq b fi lv lw l lx ly"># split data into train/test<br/><strong class="lq hy">msk = np.random.rand(len(df)) &lt; 0.8<br/>train_x = xdata[msk]<br/>test_x = xdata[~msk]<br/>train_y = ydata[msk]<br/>test_y = ydata[~msk]</strong></span><span id="c46b" class="lu jc hx lq b fi ma lw l lx ly"># build the model using train set<br/><strong class="lq hy">popt, pcov = curve_fit(sigmoid, train_x, train_y)</strong></span><span id="e464" class="lu jc hx lq b fi ma lw l lx ly"># predict using test set<br/><strong class="lq hy">y_hat = sigmoid(test_x, *popt)</strong></span><span id="0ee8" class="lu jc hx lq b fi ma lw l lx ly"># evaluation<br/><strong class="lq hy">print("Mean absolute error: %.2f" % np.mean(np.absolute(y_hat - test_y)))<br/>print("Residual sum of squares (MSE): %.2f" % np.mean((y_hat - test_y) ** 2))<br/>from sklearn.metrics import r2_score<br/>print("R2-score: %.2f" % r2_score(y_hat , test_y)</strong></span></pre><blockquote class="mb mc md"><p id="2bcc" class="jz ka lz kb b kc me ke kf kg mf ki kj mg mh km kn mi mj kq kr mk ml ku kv kw hb bi translated"><strong class="kb hy">å¹³å‡ç»å¯¹è¯¯å·®:0.05 <br/>æ®‹å·®å¹³æ–¹å’Œ(MSE): 0.00 <br/> R2è¯„åˆ†:0.95 </strong></p></blockquote><h1 id="bb7e" class="jb jc hx bd jd je lg jg jh ji lh jk jl jm li jo jp jq lj js jt ju lk jw jx jy bi translated">æ„Ÿè°¢é˜…è¯»</h1><p id="da76" class="pw-post-body-paragraph jz ka hx kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hb bi translated">æ›´å¤šæ­¤ç±»å†…å®¹<a class="ae mo" rel="noopener" href="/@kalamanoj989">ç‚¹å‡»æ­¤å¤„</a>å¹¶å…³æ³¨æˆ‘ã€‚</p></div></div>    
</body>
</html>