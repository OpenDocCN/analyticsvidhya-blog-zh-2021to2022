<html>
<head>
<title>CRUD operations in MongoDB using python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用python在MongoDB中进行CRUD操作</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/crud-operations-in-mongodb-using-python-49b7850d627e?source=collection_archive---------1-----------------------#2021-03-14">https://medium.com/analytics-vidhya/crud-operations-in-mongodb-using-python-49b7850d627e?source=collection_archive---------1-----------------------#2021-03-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/b13d73b04499d4dcbd0c4d11d394f749.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GhppzYy9K7yD0IirJLSzgw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">MongoDB CRUD操作(图片由作者提供)</figcaption></figure><blockquote class="iu iv iw"><p id="41a7" class="ix iy iz ja b jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv hb bi translated"><strong class="ja hj"> MongoDB </strong> …。有没有听说过MongoDB，想知道什么是MongoDB，如何在MongoDB中进行CRUD操作？</p></blockquote><p id="0be6" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">到本文结束时，您将会熟悉。</p><ol class=""><li id="e180" class="jz ka hi ja b jb jc jf jg jw kb jx kc jy kd jv ke kf kg kh bi translated">什么是MongoDB？</li><li id="27d1" class="jz ka hi ja b jb ki jf kj jw kk jx kl jy km jv ke kf kg kh bi translated">如何使用python在MongoDB中执行C-Create R-Retrieve U-Update D-Delete操作？</li></ol><p id="9efd" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated"><strong class="ja hj">什么是MongoDB？</strong></p><p id="35a1" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">MongoDB是一个面向文档的NoSQL数据库。由于其灵活性和易用性，它是业内广泛使用的数据库之一。MongoDB的架构由集合和文档组成。MongoDB以JSON文档格式存储数据，也就是说，它以键值对的形式存储数据。一组JSON文档可以称为一个集合。与SQL表不同，MongoDB文档没有任何固定的模式。通过使用动态模式，我们可以轻松地对应用程序进行更改，而不会出现任何中断。</p><p id="1542" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated"><strong class="ja hj">如何使用Python在MongoDB中执行CRUD操作。</strong></p><p id="b56b" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">要使用python连接MongoDB服务器，我们需要安装一个名为pymongo的python驱动程序。它包含使用python与MongoDB交互的工具。</p><p id="5cd9" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">要安装pymongo，我们需要在命令提示符下输入下面的命令。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="f581" class="kw kx hi ks b fi ky kz l la lb">pip install pymongo</span></pre><p id="9605" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">我们将使用MongoDB compass，这是一个用于与存储在MongoDB中的数据进行交互的GUI。你可以在这里找到MongoDB指南针安装说明<a class="ae lc" href="https://docs.mongodb.com/compass/master/install/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="0266" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">一旦您成功安装了MongoDB compass，通过传递下面的字符串作为输入来连接到MongoDB compass，然后单击connect按钮。</p><p id="e519" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">mongodb://localhost:27017/</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div class="er es ld"><img src="../Images/b218e992f4f7742292e37c9723f29d9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*yyeu3mz9IlLgKXlpmkx6xQ.png"/></div></figure><p id="0eec" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">现在我们将看到如何连接MongoDB并使用python执行CRUD操作。</p><p id="4c59" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">首先，我们需要导入pymongo包</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="c57e" class="kw kx hi ks b fi ky kz l la lb">import pymongo</span></pre><p id="2a9c" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">我们将定义一个名为connection_url的变量来存储MongoDB连接url</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="a32b" class="kw kx hi ks b fi ky kz l la lb">connection_url="mongodb://localhost:27017/"</span></pre><p id="1271" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">为了连接到MongoDB服务器，我们将使用MongoClient方法。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="e3a0" class="kw kx hi ks b fi ky kz l la lb">client=pymongo.MongoClient(connection_url)</span></pre><p id="6896" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">使用上面创建的客户机对象，我们可以访问MongoDB中的数据库。为了显示数据库，我们使用list_database_names()方法。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="b902" class="kw kx hi ks b fi ky kz l la lb">client.list_database_names()</span></pre><p id="353b" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">默认情况下，我们可以看到3个数据库，分别是admin、config和local。使用MongoDB compass可以看到同样的情况。</p><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es le"><img src="../Images/b6b80404b37418cb717bb0b4093cb417.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e8dt9ih9S4E6gcFzM0EK4A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">默认数据库</figcaption></figure><p id="6eeb" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">我们可以使用下面的命令创建一个数据库。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="b15c" class="kw kx hi ks b fi ky kz l la lb">database_name=”student_database”<br/>student_db=client[database_name]</span></pre><p id="7317" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">在MongoDB中，除非我们向数据库添加任何文档，否则我们无法在可用数据库列表中看到创建的数据库。为了创建文档，我们需要在数据库中创建一个存储文档的集合。这里我们将集合名称定为计算机科学。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="c40a" class="kw kx hi ks b fi ky kz l la lb">collection_name=”computer science”<br/>collection=student_db[collection_name]</span></pre><p id="74b4" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">要列出数据库中可用的集合，我们可以使用下面的命令。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="b84c" class="kw kx hi ks b fi ky kz l la lb">student_db.list_collection_names()</span></pre><p id="11ae" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated"><strong class="ja hj">在集合中插入文档</strong></p><p id="22bb" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">可以通过以下两种方式将文档插入到集合中</p><ol class=""><li id="bded" class="jz ka hi ja b jb jc jf jg jw kb jx kc jy kd jv ke kf kg kh bi translated">将单个文档插入集合。</li><li id="e040" class="jz ka hi ja b jb ki jf kj jw kk jx kl jy km jv ke kf kg kh bi translated">将多个文档插入集合。</li></ol><p id="ec9a" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">要插入单个文档，我们使用insert_one()方法。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="db15" class="kw kx hi ks b fi ky kz l la lb">document={"Name":"Raj",<br/>"Roll No ":  153,<br/>"Branch ": "CSE"}<br/>collection.insert_one(document)</span></pre><p id="dbd3" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">要插入多个文档，我们将使用insert_many()方法。为了插入这些文档，我们将创建一个包含要插入到集合中的数据的字典列表，并将该列表传递给insert_many()方法。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="f9a0" class="kw kx hi ks b fi ky kz l la lb">documents=[{"Name":"Roshan","Roll No":159,"Branch":"CSE"},{"Name":"Rahim","Roll No":155,"Branch":"CSE"},{"Name":"Ronak","Roll No":156,"Branch":"CSE"}]<br/>collection.insert_many(documents)</span></pre><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lf"><img src="../Images/b90b381e23df528db367bc822654e199.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pQxtTSBj2XNw93-3SnI_Hw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">将数据插入MongoDB</figcaption></figure><p id="e77e" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">在这两种情况下，我们可以看到为每个文档创建了一个名为_id的附加条目。_id是为每个文档创建的唯一标识。用户也可以在插入文档时给出一个custom _id。</p><p id="f841" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated"><strong class="ja hj">从集合中检索数据</strong></p><p id="9d24" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">可以通过以下两种方式检索数据。<br/> 1。检索单个文档<br/> 2。检索多个文档</p><p id="8ccd" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">从集合中检索单个文档。</p><p id="837c" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">为了检索单个文档，我们使用find_one()方法。我们需要将一个查询作为参数传递给find_one()方法，find_one()方法搜索集合，它将返回第一个命中的文档。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="738e" class="kw kx hi ks b fi ky kz l la lb">query={"Name":"Raj"}<br/>print(collection.find_one(query))</span></pre><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/6e0e696ca4bbed9687ad8a611a616d42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7vp90-o5WkLpAVoTwsSTyg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">检索单个记录</figcaption></figure><p id="3e63" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">从集合中检索多个文档。</p><p id="4b31" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">为了检索多个文档，我们使用find_many()方法。find_many()的返回类型是一个游标对象。我们可以使用for loop来循环游标对象。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="b935" class="kw kx hi ks b fi ky kz l la lb">query={"Branch":"CSE"}<br/>result=collection.find(query)<br/>for i in result:<br/>    print(i)</span></pre><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/35a46a3ae4ebb7aaafe441abfd2627ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*93cPef_K31vNzlb3XqVDQA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">检索多条记录</figcaption></figure><p id="cb5e" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">要检索所有文档，您需要向find方法传递一个空查询。如果我们想要限制要检索的文档数量，那么我们使用limit()方法。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="0064" class="kw kx hi ks b fi ky kz l la lb">result=collection.find({}).limit(2)<br/>for i in result:<br/>    print(i)</span></pre><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es li"><img src="../Images/c2b91672a5d4f62c60e2ab9bfbbcb1be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XEnL6WuymCtJkWcFByCqSw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">限制结果</figcaption></figure><p id="536b" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">您可以使用查询运算符(如gt、lt、eq等)过滤查询。，您可以在这里找到查询操作<a class="ae lc" href="https://docs.mongodb.com/manual/reference/operator/query/" rel="noopener ugc nofollow" target="_blank">的完整列表</a>。<br/>查询过滤示例:</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="ecbb" class="kw kx hi ks b fi ky kz l la lb">query={"Roll No ":{"$eq":153}}<br/>print(collection.find_one(query))</span></pre><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lj"><img src="../Images/48f1b628ee53ae2f51d0d0463ae84af2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3QFaoZwrvaIQbCm-WDH17g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">在查询中使用过滤器</figcaption></figure><p id="c951" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated"><strong class="ja hj">更新集合中的文档</strong></p><p id="87d1" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">可以通过以下两种方式更新文档。<br/> 1。更新单个文档<br/> 2。更新多个文档</p><p id="84cd" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">为了更新单个文档，我们使用update_one()方法。</p><p id="8dcb" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">为了更新文档，我们需要在方法中提供两个参数。第一个参数是过滤参数，第二个参数是更新参数。filter参数是一个与要更新的文档相匹配的查询。更新参数是应用于该文档的修改。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="197d" class="kw kx hi ks b fi ky kz l la lb">query={"Roll No":{"$eq":153}}<br/>present_data=collection.find_one(query)<br/>new_data={'$set':{"Name":'Ramesh'}}<br/>collection.update_one(present_data,new_data)</span></pre><p id="3091" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">为了更新多个文档，我们使用update_many()方法。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="d749" class="kw kx hi ks b fi ky kz l la lb">present_data={“Branch”:”CSE”}<br/>new_data={“$set”:{“Branch”:”ECE”}}<br/>collection.update_many(present_data,new_data)</span></pre><figure class="kn ko kp kq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lk"><img src="../Images/daa4352ccf33053f9d439d3439f101f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3iNt3k8RHNqbD6mj5L9Hzw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">更新的文档</figcaption></figure><p id="c1c8" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated"><strong class="ja hj">从集合中删除文档</strong></p><p id="3adf" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">可以通过以下两种方式删除文档。<br/> 1。删除单个文档<br/> 2。删除多个文档</p><p id="31d0" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">要删除单个文档，我们使用delete_one()方法，将一个查询作为参数传递。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="f825" class="kw kx hi ks b fi ky kz l la lb">query={“Roll No”:153}<br/>collection.delete_one(query)</span></pre><p id="190c" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">要删除多个文档，我们使用delete_many()方法。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="d67e" class="kw kx hi ks b fi ky kz l la lb">query={"Branch":"ECE"}<br/>collection.delete_many(query)</span></pre><p id="d5da" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated"><strong class="ja hj">从数据库中删除集合</strong></p><p id="4f88" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">要删除一个集合，我们使用drop()方法。一旦执行drop方法，该集合中的所有数据都将被删除。</p><pre class="kn ko kp kq fd kr ks kt ku aw kv bi"><span id="02f6" class="kw kx hi ks b fi ky kz l la lb">collection.drop()</span></pre><p id="0c96" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">你可以在Github 找到完整的代码。</p><p id="6f8a" class="pw-post-body-paragraph ix iy hi ja b jb jc jd je jf jg jh ji jw jk jl jm jx jo jp jq jy js jt ju jv hb bi translated">感谢您阅读这篇文章。如果您在执行代码时遇到任何问题，请随时在下面发表评论。</p></div></div>    
</body>
</html>