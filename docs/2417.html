<html>
<head>
<title>Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">线性回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/simple-linear-regression-4f55f9bdb987?source=collection_archive---------14-----------------------#2021-04-22">https://medium.com/analytics-vidhya/simple-linear-regression-4f55f9bdb987?source=collection_archive---------14-----------------------#2021-04-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><h2 id="7718" class="hf hg hh bd b fp hi hj hk hl hm hn dx ho translated" aria-label="kicker paragraph">简单线性回归</h2><div class=""/><div class=""><h2 id="6206" class="pw-subtitle-paragraph in hq hh bd b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je dx translated">线性回归背后的统计学</h2></div><p id="3420" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">害怕数学和统计的人。不要再这样了，因为我太害怕它了，但是当我发现它背后的数学，每个计算都是由软件包和模块完成的，为什么要承受这种压力。线性回归模型背后有简单的数学原理<br/>我们都知道上学时遇到的斜率截距公式。</p><h2 id="af18" class="kb kc hh bd kd ke kf kg kh ki kj kk kl jo km kn ko js kp kq kr jw ks kt ku hn bi translated">我们今天学了什么？？</h2><ol class=""><li id="bf71" class="kv kw hh jh b ji kx jl ky jo kz js la jw lb ka lc ld le lf bi translated">线性回归简介</li><li id="3871" class="kv kw hh jh b ji lg jl lh jo li js lj jw lk ka lc ld le lf bi translated">线性回归方程</li><li id="51c6" class="kv kw hh jh b ji lg jl lh jo li js lj jw lk ka lc ld le lf bi translated">数据的特征</li><li id="397f" class="kv kw hh jh b ji lg jl lh jo li js lj jw lk ka lc ld le lf bi translated">斜率和截距</li><li id="4799" class="kv kw hh jh b ji lg jl lh jo li js lj jw lk ka lc ld le lf bi translated">带有数据集的ML模型</li></ol><h2 id="d316" class="kb kc hh bd kd ke kf kg kh ki kj kk kl jo km kn ko js kp kq kr jw ks kt ku hn bi translated">线性回归方程:</h2><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="2745" class="kb kc hh lq b fi lu lv l lw lx"><strong class="lq hr">y = mx + c </strong> --&gt;(1)</span></pre><p id="5fbf" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">根据上面的等式。y是因变量。x值的任何变化都会导致y变量的变化。所以，艾尔莎证实了‘y’是从属的，而‘x’是独立的。</p><p id="e062" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">我们来看一个小情节来理解回归。</p><figure class="ll lm ln lo fd lz er es paragraph-image"><div class="er es ly"><img src="../Images/beec544b69d7aab658236021623f5863.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/0*CVKakIoRUso46FE1.png"/></div><figcaption class="mc md et er es me mf bd b be z dx translated">线性回归拟合。</figcaption></figure><p id="0eae" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">其中m是斜率，c是截距。</p><h2 id="4f81" class="kb kc hh bd kd ke kf kg kh ki kj kk kl jo km kn ko js kp kq kr jw ks kt ku hn bi translated">数据的特征:</h2><p id="30c0" class="pw-post-body-paragraph jf jg hh jh b ji kx ir jk jl ky iu jn jo mg jq jr js mh ju jv jw mi jy jz ka ha bi translated">特征可以是用于分析的属性、变量、数字或可测量的分类数据，例如年龄、姓名等。</p><p id="6bca" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">我们获得了多个数据点和特征。我们所需要做的只是绘制x和y之间的数据。根据上面的公式，我们从提供的x值、斜率和截距来预测“y”。</p><p id="f374" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">艾尔莎正努力让你明白这一点。她用知识的结合让事情变得简单</p><figure class="ll lm ln lo fd lz er es paragraph-image"><div class="er es mj"><img src="../Images/245c1ec3ffea68addb41c86b82cc0f62.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*GCXnvZ-kj_diSnjDMWFWwA.jpeg"/></div></figure><p id="44a6" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">到现在为止，您可能已经理解了线性回归是一种使用独立变量对目标进行建模的方法。这是一个直线拟合。<br/>这里我们的主要目的是拟合斜率和截距的最佳值，以获得理想的最小误差直线拟合图。</p><p id="2f61" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">现在让我们将公式改写如下</p><figure class="ll lm ln lo fd lz er es paragraph-image"><div class="er es mk"><img src="../Images/4d0009fa91e0c0f66745d2f805149024.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*6WKlzzSz_7qYcJxvH7jSdw.png"/></div><figcaption class="mc md et er es me mf bd b be z dx translated"><strong class="bd kd">线性回归方程</strong></figcaption></figure><h2 id="b5c1" class="kb kc hh bd kd ke kf kg kh ki kj kk kl jo km kn ko js kp kq kr jw ks kt ku hn bi translated">斜率和截距:</h2><p id="272d" class="pw-post-body-paragraph jf jg hh jh b ji kx ir jk jl ky iu jn jo mg jq jr js mh ju jv jw mi jy jz ka ha bi translated"><strong class="jh hr">其中截距和斜率值可通过以下等式获得。</strong></p><figure class="ll lm ln lo fd lz er es paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="er es ml"><img src="../Images/1c4e63ba939a9dbf1c421de2738a02df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5jKTHgWqyOEutDWR43_Xiw.png"/></div></div><figcaption class="mc md et er es me mf bd b be z dx translated"><strong class="bd kd">计算回归模型所需的值</strong></figcaption></figure><p id="1d77" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">这里，X的平均值是X，y的平均值是y。我们计算X[I]项和X的平均值的差，对于y也是如此，并将它们呈现在上面的公式中，以获得斜率和截距项。</p><p id="7e39" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated"><strong class="jh hr">让我们从方程式中得到“不给糖就捣蛋”的游戏，并建立一个模型。</strong></p><h2 id="bf0d" class="kb kc hh bd kd ke kf kg kh ki kj kk kl jo km kn ko js kp kq kr jw ks kt ku hn bi translated">带数据集的ML模型:</h2><p id="b106" class="pw-post-body-paragraph jf jg hh jh b ji kx ir jk jl ky iu jn jo mg jq jr js mh ju jv jw mi jy jz ka ha bi translated"><strong class="jh hr">将Salary_data.csv文件作为数据集示例</strong></p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="76fb" class="kb kc hh lq b fi lu lv l lw lx">Salary_data.csv<br/>YearsExperience,Salary<br/>1.1,39343.00<br/>1.3,46205.00<br/>1.5,37731.00<br/>2.0,43525.00<br/>2.2,39891.00<br/>2.9,56642.00<br/>3.0,60150.00<br/>3.2,54445.00<br/>3.2,64445.00<br/>3.7,57189.00<br/>3.9,63218.00<br/>4.0,55794.00<br/>4.0,56957.00<br/>4.1,57081.00<br/>4.5,61111.00<br/>4.9,67938.00<br/>5.1,66029.00<br/>5.3,83088.00<br/>5.9,81363.00<br/>6.0,93940.00<br/>6.8,91738.00<br/>7.1,98273.00<br/>7.9,101302.00<br/>8.2,113812.00<br/>8.7,109431.00<br/>9.0,105582.00<br/>9.5,116969.00<br/>9.6,112635.00<br/>10.3,122391.00<br/>10.5,121872.00</span></pre><p id="0dfa" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated"><strong class="jh hr">数据集描述:</strong></p><p id="9353" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">这个特定的数据集包含30行和2列，其中一列是从属的，另一列是独立的。我猜工资是因变量。猜猜这是什么？</p><p id="a3f4" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">我的猜测怎么是正确的？？我没猜错，众所周知，当我们工作了很长一段时间，或者有了足够的经验或技能而得到提升时，工资就会增加。这仅仅是常识。</p><p id="91b0" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">我们已经准备好了数据集。让我们来了解一下适合我们模型的包</p><p id="a499" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">这些python包可以帮助我们做数学</p><h2 id="d1bd" class="kb kc hh bd kd ke kf kg kh ki kj kk kl jo km kn ko js kp kq kr jw ks kt ku hn bi translated">1.使用的库:</h2><p id="0a88" class="pw-post-body-paragraph jf jg hh jh b ji kx ir jk jl ky iu jn jo mg jq jr js mh ju jv jw mi jy jz ka ha bi translated"><strong class="jh hr">让我简单列举一下:</strong></p><ol class=""><li id="4aa6" class="kv kw hh jh b ji jj jl jm jo mq js mr jw ms ka lc ld le lf bi translated"><strong class="jh hr"> numpy- </strong> numpy是一个用于计算数字数据的python。</li><li id="29e5" class="kv kw hh jh b ji lg jl lh jo li js lj jw lk ka lc ld le lf bi translated"><strong class="jh hr"> pandas- </strong> pandas用于数据操作、数据帧和创建虚拟值</li><li id="5328" class="kv kw hh jh b ji lg jl lh jo li js lj jw lk ka lc ld le lf bi translated">matplotlib- 用于数据可视化的最佳和最强大的库</li><li id="a374" class="kv kw hh jh b ji lg jl lh jo li js lj jw lk ka lc ld le lf bi translated"><strong class="jh hr"> seaborn- </strong>用于数据可视化的Python库</li><li id="0b29" class="kv kw hh jh b ji lg jl lh jo li js lj jw lk ka lc ld le lf bi translated"><strong class="jh hr"> scikit learn- </strong>用于构建机器学习模型的库</li></ol><p id="dbea" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">让我们根据需求编写代码</p><p id="bf3e" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated"><strong class="jh hr"> 2。使用导入功能导入库:</strong></p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="83cd" class="kb kc hh lq b fi lu lv l lw lx">import numpy as np <br/>import pandas as pd <br/>import matplotlib.pyplot as plt <br/>from sklearn.model_selection import train_test_split<br/>from sklearn.preprocessing import StandardScaler <br/>from sklearn.linear_model import LinearRegression<br/>from sklearn import metrics</span></pre><p id="f0f2" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated"><strong class="jh hr"> 3。从数据集salary_data.csv中读取数据</strong></p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="7a46" class="kb kc hh lq b fi lu lv l lw lx">df =pd.read_csv(“salary_data.csv”) <br/>#if data is in the same directory as notebook we are executing code<br/>                         or<br/>df = pd.read_csv('desktop/maa/ml_proj/salary_data.csv')<br/></span></pre><p id="a4e0" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated"><strong class="jh hr"> 4。使用pandas </strong>检查数据中的任何空值</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="80d2" class="kb kc hh lq b fi lu lv l lw lx">df.isnull().sum()<br/>---------------------<br/>#we get this as solution if no missing values<br/>YearsExperience    0<br/>Salary             0<br/>dtype: int64</span></pre><p id="3a4f" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated"><strong class="jh hr"> 5。绘制数据，了解X和y的关系</strong></p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="b4be" class="kb kc hh lq b fi lu lv l lw lx">p = sns.color_palette("ch:s=.25,rot=-.25", as_cmap=True)<br/>plt.figure(figsize=(12,6))<br/>plt.title("Salary plot")<br/>sns.lineplot(data=df,x=df.YearsExperience,y=df.Salary,palette=p)</span></pre><figure class="ll lm ln lo fd lz er es paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="er es mt"><img src="../Images/919e62a2e412333cead1617150c0282f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rMG4S9AZ6gd1pc8yBv8Jcw.png"/></div></div><figcaption class="mc md et er es me mf bd b be z dx translated"><strong class="bd kd">工作年限和工资的关系</strong></figcaption></figure><p id="f456" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated"><strong class="jh hr"> 5。指定X和y值</strong></p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="260b" class="kb kc hh lq b fi lu lv l lw lx">X = df.iloc[:,:-1] # this means all the rows excluding last column <br/>y = df.iloc[:,1]   # this means all the rows and first column </span></pre><p id="bfc6" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated"><strong class="jh hr"> train_test_split </strong>其实就是把数据分成2类。训练数据用于训练数据以建立模型，测试数据用于测试数据以检查我们的模型是否有效。</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="0c59" class="kb kc hh lq b fi lu lv l lw lx">X_train,X_test, y_train, y_test = train_test_split(X,y,          test_size=0.3, random_state= 40 )</span></pre><p id="e32a" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated"><strong class="jh hr">标准缩放器</strong>是一种缩小特征的特征缩放技术。这里我们的特色是多年的经验。为了避免模型中的错误。</p><p id="8072" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">标准定标器是如何工作的？</p><p id="4e39" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">标准缩放器缩放数据。这里x(i)std是第I个样本数据的标准差，<code class="du mu mv mw lq b">μ,σ</code>是x列的均值和标准差。</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="77ce" class="kb kc hh lq b fi lu lv l lw lx">x(i)std =  ( x(i)- μx)/(σx )</span></pre><p id="b007" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">6。拟合和转换数据:</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="c8bf" class="kb kc hh lq b fi lu lv l lw lx">sc = StandardScaler()<br/>X_train_sc = sc.fit_transform(X_train)<br/>X_test_sc = sc.fit_transform(X_test)<br/>y_train_sc = sc.fit_transform(y_train)</span></pre><p id="5421" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated"><strong class="jh hr"> 7。拟合线性模型并预测y_test: </strong></p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="01d4" class="kb kc hh lq b fi lu lv l lw lx">lr = LinearRegression()<br/>lr.fit(X_train_sc,y_train_sc)<br/>pred = lr.predict(X_test_sc)</span></pre><p id="2219" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated"><strong class="jh hr"> 8。指标:</strong></p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="dacb" class="kb kc hh lq b fi lu lv l lw lx">print(metrics.mean_squared_error(y_test,pred))<br/>print(metrics.mean_absolute_error(y_test,pred))<br/>print(np.sqrt(metrics.mean_squared_error(y_test,pred)))<br/>-----------------------------------------------<br/>#we get the following result <br/>44024061.33808141 <br/>5822.332723050979 <br/>6635.063024424215</span></pre><figure class="ll lm ln lo fd lz er es paragraph-image"><div class="er es ly"><img src="../Images/6ddaf441400f55c5e0059469795d1996.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*C7BAhHKw2mBrI9ZqlfFs6A.png"/></div><figcaption class="mc md et er es me mf bd b be z dx translated"><strong class="bd kd">图形</strong></figcaption></figure><p id="e9fd" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">我希望这给了你足够的信息…..</p><p id="4e04" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">谢谢大家！！！</p><p id="9e07" class="pw-post-body-paragraph jf jg hh jh b ji jj ir jk jl jm iu jn jo jp jq jr js jt ju jv jw jx jy jz ka ha bi translated">快乐学习</p></div></div>    
</body>
</html>