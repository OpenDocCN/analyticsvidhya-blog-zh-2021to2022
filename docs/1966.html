<html>
<head>
<title>Automate Bank Reconciliations using Pandas library in Jupyter notebooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Jupyter笔记本中的Pandas库实现银行对账自动化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/automate-bank-reconciliations-using-pandas-library-in-jupyter-notebooks-ccdb0cb4c32d?source=collection_archive---------4-----------------------#2021-03-29">https://medium.com/analytics-vidhya/automate-bank-reconciliations-using-pandas-library-in-jupyter-notebooks-ccdb0cb4c32d?source=collection_archive---------4-----------------------#2021-03-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e057" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们，会计师，通常是非常非常冷静的人，我们大多数人都这么认为。但有些事情会让最有耐心的会计师也难以保持冷静。想象一下，查看成千上万行看似永无止境的银行月结单，并试图将其与您的银行分类账报表进行匹配……仅此一项就足以说明这一过程会多么令人沮丧和耗时。</p><p id="41e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们中的大多数人仍然依赖Excel来准备这样的报告，然而，不管Excel有多好，对我来说，在做银行rec时，它仍然太手工化和僵化了。我决定使用一些其他工具来寻找我的救赎，这时我发现了我一生的爱Python中的熊猫库。我知道你们也喜欢<code class="du jd je jf jg b">Pandas</code>,事实上，它是最广泛使用的语言之一。</p><p id="0bc6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">只用几行代码，我就可以实现银行对账单与银行分类账的自动匹配，识别不匹配的记录，甚至还能享受其中的乐趣。使用Excel做银行记录节省了我们一个多小时。这里唯一需要手动操作的是显示文件的路径，眨眼之间，报告就生成并保存了！</p><p id="e1a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面我分享Jupyter笔记本中使用样本测试银行对账单和银行分类账号码的步骤和全部代码。</p><p id="027d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了便于解释，我将使用样本测试银行对账单和银行分类账报告:</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es jh"><img src="../Images/e15fd2874cbc292cc08775eca6195013.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*VUnmYrcZMltUHgaaC3nK3g.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">银行对账单样本</figcaption></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es jt"><img src="../Images/aee5d98ffb67ccda57e0850b0bcca68a.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*FruSyyESUEspUVSKiVdGcg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">银行分类帐报表样本</figcaption></figure><p id="2250" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们所看到的，我们在两个报告之间有14美元的差异，我们将使用<code class="du jd je jf jg b">Pandas</code>来查找所有匹配和不匹配的条目，并生成对账报告。银行rec使用一系列因公司而异的技术来完成，然而，最常用的技术之一是<em class="ju">“日期+金额”</em>连接技术来匹配交易。其中交易日期和借项/贷项金额连接在每个报表的单独单元格中，然后查找匹配项。它看起来会像下面这样:</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es jv"><img src="../Images/6e67f96a582c8a2285f9bfc3aa06df62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VF0kePV6oeUSbbQp_U7CyA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">示例:在Excel中完成日期+金额串联，为匹配做准备</figcaption></figure><p id="fabc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们开始编码吧！</p><ol class=""><li id="5b4a" class="ka kb hi ih b ii ij im in iq kc iu kd iy ke jc kf kg kh ki bi translated">导入<code class="du jd je jf jg b">pandas</code>库，阅读我们的csv文件:</li></ol><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kj"><img src="../Images/1db83b396f2871b27788ac477b08b3c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sVPe2oXGL8hD_E_kaxoEdA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">文件已准备就绪</figcaption></figure><p id="1ef0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.第二步将涉及我们的文件预处理，准备使用“日期+总和”方法进行匹配。</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kk"><img src="../Images/7955ec03dec5df1e5b4022609a2bdcfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gbOTlyPpyuHfyQBvStHRmQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">注意，作为预处理的一部分，我们有两个单独的列。现在这是一个简单的例子，但是在real statement/GLs中，必须执行许多步骤来准备我们的匹配数据。</figcaption></figure><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kl"><img src="../Images/a8d8f6a0b459226ef3504384506906d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PYBDIVBeo3EYS1yDj0iNWg.png"/></div></div></figure><p id="665d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.现在，我们可以匹配这两个文件，并查看银行总账中缺失或错误过账的数字:</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es km"><img src="../Images/e4de80426fc87133220edc42e6c6e002.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_WK2c9v88tPJmLflLlXpLA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">银行对账单中五个分录中只有两个在总账中正确过账。必须对其他不匹配的交易记录进行更正分录。</figcaption></figure><p id="181c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.匹配已经完成，但是，让我们以适当且“方便读者”的方式呈现这些数据——让我们在“状态”列上多下功夫，让非财务用户更容易理解，同时我们可以用适当的零替换“NaN ”:</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kn"><img src="../Images/f05a2255637e9209d5bf256d24684164.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9wrtNrt3Uq9Hb6AVwMADBQ.png"/></div></div></figure><p id="9416" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们打开并查看我们保存的<code class="du jd je jf jg b">csv</code>文件:</p><figure class="ji jj jk jl fd jm er es paragraph-image"><div class="er es ko"><img src="../Images/91083c02dced69d3381e6fc413c1a8af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*9PvEA3eiy9g5sqchKetPCQ.png"/></div></figure><p id="8aa0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">显然，用真实的银行对账单和总账做这件事可能需要更多的预处理步骤或准备好数据，但最终过程总是相同的，以匹配和找到缺失/错误的交易。您还可以在准备过程中修改和添加额外的步骤，并帮助实现另一个手动过程的自动化。从小处着手，全部完成！</p></div></div>    
</body>
</html>