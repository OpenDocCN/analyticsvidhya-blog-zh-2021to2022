<html>
<head>
<title>Human Face Emotion Recognition System</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">人脸情感识别系统</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/human-face-emotion-recognition-system-460436ee2393?source=collection_archive---------2-----------------------#2021-05-25">https://medium.com/analytics-vidhya/human-face-emotion-recognition-system-460436ee2393?source=collection_archive---------2-----------------------#2021-05-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><blockquote class="ie if ig"><p id="601c" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">今天我们将讨论<strong class="ik hi">从一个人的图像中识别情感</strong>。我们要用的数据集，取自<a class="ae jg" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> kaggle </a>，命名为<strong class="ik hi">面部表情识别</strong> ( <a class="ae jg" href="https://www.kaggle.com/msambare/fer2013" rel="noopener ugc nofollow" target="_blank"> FER2013 </a>)。这是一个非常流行的情感识别数据集，包含七种不同情感类别的图像。</p></blockquote><p id="665f" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jh iu iv iw ji iy iz ja jj jc jd je jf ha bi translated"><strong class="ik hi">动机:</strong>情绪在识别一个人的情绪中起着至关重要的作用。一般有六种原始情绪:快乐、悲伤、愤怒、恐惧、惊讶、厌恶、蔑视。可以看出，研究工作集中在四种主要情绪上，即快乐、悲伤、愤怒和中立。此外，识别情绪在摄像头监控捕捉嫌疑人的过程中发挥着重要作用；例如，在害怕的人的情况下，发出警报的系统会有所帮助。情感识别系统可以用作各种应用的子模块，如推荐音乐和各种摄像机监控系统。</p><blockquote class="ie if ig"><p id="e190" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated"><strong class="ik hi">数据预处理</strong></p></blockquote><p id="c42b" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jh iu iv iw ji iy iz ja jj jc jd je jf ha bi translated">至于识别情绪，模型更容易预测图像是否倾斜或翻转。所有这些都在Kaggle提供的数据集中处理。我们所需要做的就是，下载数据集并将其存储在shape <strong class="ik hi">(样本数* 48 * 48 * 1)的NumPy数组中。</strong>所有图像都是形状(48 * 48 * 1)。为了方便起见，我们将它存储在数组中，或者我们也可以使用来自<em class="ij"> keras.preprocessing.image，</em>的ImageDataGenerator类将它保存在文件夹中进行数据扩充，这完全由您决定。</p><blockquote class="ie if ig"><p id="81f7" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated"><strong class="ik hi">模型架构&amp;工作</strong></p></blockquote><p id="ed39" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jh iu iv iw ji iy iz ja jj jc jd je jf ha bi translated">在应用各种CNN(卷积神经网络)架构之后，以下模型架构给出了良好的准确性。同样的架构进一步采取了<strong class="ik hi"> <em class="ij">四级分类并集成了五级情感分类的模型。</em>T25】</strong></p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/d74c8364a46803bf9720910f73e36873.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b53T_QLDJEekK5XnKJBSbA.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">CNN模型架构</figcaption></figure><p id="2e6e" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jh iu iv iw ji iy iz ja jj jc jd je jf ha bi translated">下面的GIF展示了CNN模型的工作原理，使用<strong class="ik hi"> <em class="ij"> OpenCV </em> </strong>模块将原始图像转换成48*48*1的形状。之后，CNN模型将此图像作为输入，并使用<strong class="ik hi"> <em class="ij"> Conv2D、BatchNormalization、MaxPooling2D、dropool</em></strong>层应用所有3个块。每个块只从图像中提取重要的特征，池层通过提取重要的(最大)特征将图像的大小减少一半(通过稍微模糊的图像和缩小的大小来显示，只是为了更好的可视化)。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ka"><img src="../Images/aea8a2a15565b1cc8b3fcd3a3b0088aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*puTLD18bPKwl9pqWhwCcMw.gif"/></div></div></figure><blockquote class="ie if ig"><p id="014a" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated"><strong class="ik hi">结果&amp;评估</strong></p></blockquote><p id="4c5d" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jh iu iv iw ji iy iz ja jj jc jd je jf ha bi kb translated"><span class="l kc kd ke bm kf kg kh ki kj di">7</span><strong class="ik hi"><em class="ij">——类别(愤怒、高兴、悲伤、中性、惊讶、恐惧、厌恶)</em> </strong>分类采用上述模式:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kk"><img src="../Images/936646a6b7758c6d91393338d77e0481.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*llB4iRnJst9di52TCjtgiQ.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">不同型号和CNN变体的精确度</figcaption></figure><p id="b291" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jh iu iv iw ji iy iz ja jj jc jd je jf ha bi translated">预定义的模型，如VGG模型、例外模型等。，太多了。这就是为什么CNN的被使用。下图显示了CNN架构的<strong class="ik hi"> <em class="ij">精度与纪元图</em> </strong>。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kl"><img src="../Images/af960b1f6a2e72ce151c530d95f860e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*ipQj8wCv8IV8-CpjgRwfUg.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">CNN模型的精度与时期图</figcaption></figure><p id="eb09" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jh iu iv iw ji iy iz ja jj jc jd je jf ha bi translated"><strong class="ik hi"> <em class="ij">在4类(愤怒、悲伤、快乐、中性)</em> </strong>分类中，使用相同的CNN架构，准确率从<strong class="ik hi"> <em class="ij">的65.58%提高到</em> </strong>的73.58%。</p><blockquote class="ie if ig"><p id="d9bc" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated"><strong class="ik hi">集成技术:</strong>这种<strong class="ik hi"> </strong>方法产生了很好的效果，首先为每个情感类别单独训练模型，然后将它们结合起来预测测试数据。发现对于<strong class="ik hi"> 5类(快乐、悲伤、中性、愤怒、惊喜)情绪，</strong>模型给出了<strong class="ik hi"> 75.3% </strong>的准确度，这明显优于最好的CNN模型对于4 &amp; 7类情绪的准确度。虽然这种方法是使用相同的CNN架构，但这些CNN的组合，给出了不可思议的结果。</p></blockquote><p id="1e8e" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jh iu iv iw ji iy iz ja jj jc jd je jf ha bi translated">为了检查随机图像上的模型结果，我们首先必须构建一个模块，从原始图像中获取人脸图像。这个任务是使用OpenCV的<strong class="ik hi"> <em class="ij"> cv2 </em> </strong>模块<strong class="ik hi"> <em class="ij">完成的。</em> </strong>取图像后，模型预测人脸图像的情感。让我们来看一个我在自己的图像上尝试的输出。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es km"><img src="../Images/2c2c5b11e43025b11f76c88c5567d730.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*L9U9msHovpYtdMshYkP9hg.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">该模型预测了上面这张图片的快乐情绪。</figcaption></figure><blockquote class="ie if ig"><p id="399f" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated"><strong class="ik hi">结论</strong></p></blockquote><p id="ce51" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jh iu iv iw ji iy iz ja jj jc jd je jf ha bi translated">取得的结果是可喜的。该系统具有高精度和快速响应时间，这使得它适合于大多数实际目的。使用OpenCV模块提取人脸，然后检测情绪，使得系统对特定数据更加鲁棒。所提出的CNN架构在七类情感识别的情况下给出了65.58%的准确度，在四级情感识别的情况下给出了73.58%的准确度。使用集成方法，模型的精度大大提高，对五类分类给出了<strong class="ik hi"><em class="ij"/></strong>75.3%<strong class="ik hi"><em class="ij">0.753 F1分</em> </strong>。</p><blockquote class="ie if ig"><p id="bc71" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">代码和数据集</p></blockquote><div class="kn ko ez fb kp kq"><a href="https://www.kaggle.com/msambare/fer2013" rel="noopener  ugc nofollow" target="_blank"><div class="kr ab dw"><div class="ks ab kt cl cj ku"><h2 class="bd hi fi z dy kv ea eb kw ed ef hg bi translated">FER-2013年</h2><div class="kx l"><h3 class="bd b fi z dy kv ea eb kw ed ef dx translated">从图像中学习面部表情</h3></div><div class="ky l"><p class="bd b fp z dy kv ea eb kw ed ef dx translated">www.kaggle.com</p></div></div><div class="kz l"><div class="la l lb lc ld kz le ju kq"/></div></div></a></div><div class="kn ko ez fb kp kq"><a href="https://github.com/deepankarkansal/Information_Retrieval/tree/main/Endsem_Project" rel="noopener  ugc nofollow" target="_blank"><div class="kr ab dw"><div class="ks ab kt cl cj ku"><h2 class="bd hi fi z dy kv ea eb kw ed ef hg bi translated">deepankarkansal/信息检索</h2><div class="kx l"><h3 class="bd b fi z dy kv ea eb kw ed ef dx translated">numpy(用于处理数组和数学计算的库，如线性代数、傅立叶变换等。)ast(库…</h3></div><div class="ky l"><p class="bd b fp z dy kv ea eb kw ed ef dx translated">github.com</p></div></div><div class="kz l"><div class="lf l lb lc ld kz le ju kq"/></div></div></a></div><h1 id="52fb" class="lg lh hh bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">参考</h1><ol class=""><li id="1a1c" class="me mf hh ik b il mg ip mh jh mi ji mj jj mk jf ml mm mn mo bi translated"><a class="ae jg" href="https://github.com/deepankarkansal/Information_Retrieval/blob/main/Endsem_Project/IR_Project_Report.pdf" rel="noopener ugc nofollow" target="_blank">项目报告</a>(也包含音乐推荐系统，不在本文讨论范围之内)</li><li id="25d9" class="me mf hh ik b il mp ip mq jh mr ji ms jj mt jf ml mm mn mo bi translated">弗兰·科斯·乔莱。例外:具有深度可分卷积的深度学习。IEEE计算机视觉和模式识别会议论文集，第1251-1258页，2017年。</li><li id="3e34" class="me mf hh ik b il mp ip mq jh mr ji ms jj mt jf ml mm mn mo bi translated">Ananya Dhar和Bilal N. Shaikh Mohammad。使用面部特征提取和深度学习的音乐情感识别。SSRN学术论文ID 3560840，社会科学研究网络，纽约州罗彻斯特，2020年4月。</li><li id="053e" class="me mf hh ik b il mp ip mq jh mr ji ms jj mt jf ml mm mn mo bi translated">拉斐尔·卡布雷多·埃米尔·伊恩诉阿斯卡隆。基于情感的音乐推荐系统。基于歌词的音乐情绪识别，3:1–8，2015。</li><li id="152b" class="me mf hh ik b il mp ip mq jh mr ji ms jj mt jf ml mm mn mo bi translated">Shlok Gilda、Husain Zafar、Chintan Soni和Kshitija Waghurdekar。集成面部情感识别和音乐情绪推荐的智能音乐播放器。2017年无线通信、信号处理和网络国际会议(WiSPNET)，第154–158页。IEEE，2017。</li></ol></div></div>    
</body>
</html>