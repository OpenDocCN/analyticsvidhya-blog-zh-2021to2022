<html>
<head>
<title>Guitar classifier using fast.ai library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用fast.ai库的吉他分类器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/guitar-classifier-using-fast-ai-library-778e985123d9?source=collection_archive---------11-----------------------#2021-07-04">https://medium.com/analytics-vidhya/guitar-classifier-using-fast-ai-library-778e985123d9?source=collection_archive---------11-----------------------#2021-07-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="2742" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是我为fast-ai第1部分课程创建的一个入门项目。该分类器仅使用200幅示例图像就能够以大约90%的准确度学习区分芬达和吉布森吉他。这个项目展示了fast-ai库中可用的开箱即用工具的力量，是开始深度学习的一个很好的方式。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/cde9ad516efa59f642deeca2da0fdb78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KE0EmVPEcEPZ5SNg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx">Photo by <a class="ae js" href="https://unsplash.com/@toyamakanna?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">戸山 神奈</a> on <a class="ae js" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="47a5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">提取吉他图像</strong></p><p id="01e2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">快速人工智能库让这一步变得异常简单。打开google images选项卡，搜索感兴趣的关键字，对于我们的例子，我们可以简单地搜索“fender guitar”和“gibson guitar”。</p><p id="3f90" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">运行这个由fast-ai团队提供的javascript代码来保存google images标签中所有图片的URL。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jt"><img src="../Images/11bc6b9c3c371de09641b61c4fde3c21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MG9h1BsW4Uh5ZswQid59ig.png"/></div></div></figure><p id="f96c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦我们得到了所有图片的网址，fast-ai library就可以直接使用api <a class="ae js" href="https://docs.fast.ai/vision.utils.html#download_images" rel="noopener ugc nofollow" target="_blank">调用</a>来下载图片。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ju"><img src="../Images/45b3a431771287b87bfb3f2b8acd4ce2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*il5o5yp5FZvTUFO8J28ljQ.png"/></div></div></figure><p id="1ced" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">加载并预处理数据</strong></p><p id="d682" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在此步骤中，我们使用fast-ai视觉库函数<a class="ae js" href="https://docs.fast.ai/vision.data.html#ImageDataLoaders.from_folder" rel="noopener ugc nofollow" target="_blank"><em class="jv">image data loaders::from _ folder</em></a>，该函数加载图像，并将它们分割到训练/测试/验证集中，并对数据进行批处理。它还提供了在加载图像之前对图像数据进行转换的选项。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jw"><img src="../Images/babee76e37751a9888c6fffe4b3fa4da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*onR8rJpn-bwamjGCSVNgLA.png"/></div></div></figure><p id="c73e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过预览批来验证数据看起来合理。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jx"><img src="../Images/ee4eec2196713b8c98b29666503e80e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0rR9Dr9B8kb-dBeASTDXWA.png"/></div></div></figure><p id="67f7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">检查训练和测试数据——在我们的例子中，我们有216个训练样本和53个验证集。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jy"><img src="../Images/782f99a9555e6fb7bbe479f7503cc550.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VOUtnKyl3zVpfjQTLq4MRQ.png"/></div></div></figure><p id="8e4d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">列车型号</strong></p><p id="8dd1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用cnn风格的resnet架构训练模型。使用<a class="ae js" href="https://fastai1.fast.ai/vision.learner.html#cnn_learner" rel="noopener ugc nofollow" target="_blank"> cnn_learner </a> fast-ai函数实例化学习者。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jz"><img src="../Images/3f8d8d349278a1b4a9e648b31cdcb75d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tTQXBfNYQGdmQfw59KP3LA.png"/></div></div></figure><p id="f046" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用一个周期<a class="ae js" href="https://sgugger.github.io/the-1cycle-policy.html" rel="noopener ugc nofollow" target="_blank">调度器</a>开始训练模型。注意在随后的时期中错误率的降低，在7个时期(1个时期=训练数据的一次扫描)之后，模型收敛到11%的错误率。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ka"><img src="../Images/ee90875f60b5b08ff85357fd46b9d32a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HYSMTev3867RkX1hb0rFog.png"/></div></div></figure><p id="e960" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过绘制混淆矩阵来检查结果。从矩阵中可以看出，模型误差率= (5+1)/(5+1+18+29) = 11.3%</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kb"><img src="../Images/3bade103fb04afd08e7b2694ef3a08e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nJUMFm_5-OTyQc4rtfvlmA.png"/></div></div></figure><p id="e942" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Github回购代码/数据可从以下网址获得:</p><p id="fbba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae js" href="https://github.com/shreyas88/gibson-or-fender" rel="noopener ugc nofollow" target="_blank">https://github.com/shreyas88/gibson-or-fender</a></p></div></div>    
</body>
</html>