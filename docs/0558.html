<html>
<head>
<title>Car Sales Prediction — Using Basic Matrix Operations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">汽车销售预测—使用基本矩阵运算</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/car-sales-prediction-using-basic-matrix-operations-60ca8ede3bfa?source=collection_archive---------11-----------------------#2021-01-21">https://medium.com/analytics-vidhya/car-sales-prediction-using-basic-matrix-operations-60ca8ede3bfa?source=collection_archive---------11-----------------------#2021-01-21</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="4532" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们从上学开始就一直在学习Ax = b这样的矩阵运算，但我们有没有意识到它的简化线性回归(y=mx+c)问题是如何。是的，今天我们将使用矩阵运算来寻找斜率(m)和截距(c)以预测<strong class="ig hi">汽车转售价值</strong>。</p><p id="bc98" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在进入问题之前，让我们试着回顾一下Ax=b，下面是一个例子。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/29cd1729be1f32d1789bbb9c071515d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/0*p5dRnvAzAiREop1f"/></div></figure><p id="6413" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">其中A是大小为m×n的矩阵，与x(n×1)线性组合以获得目标变量b(n×1)</p><p id="4e33" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">如何将这与线性回归问题联系起来？</strong></p><p id="6faa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我们的汽车销售数据中，我们有两列，一列是功率性能系数和转售价值，其中我们需要预测相对于输入特性功率系数(x)的转售价值(y)。</p><blockquote class="jk jl jm"><p id="59af" class="ie if jn ig b ih ii ij ik il im in io jo iq ir is jp iu iv iw jq iy iz ja jb ha bi translated">转售价值=斜率*功率因数+截距</p></blockquote><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jr"><img src="../Images/1abed1c289ce46e60e796bd8cf41b728.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*g0aWM07phCzFDde6v3_Taw.png"/></div></div></figure><p id="20b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了以矩阵形式表示这一点，我们需要形成一个矩阵A，其中一列为输入特性(功率因数)，另一列为用于添加偏差的1，B矩阵将是我们的转售价值，x将是我们的斜率和截距变量。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jw"><img src="../Images/78e3561f4150ab9e56c275ed6d333984.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7eKOmUOTwotDye_rHlLHYg.png"/></div></div></figure><p id="3cc5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于单个特征，我们可能认为矩阵运算不是很必要，但认为如果您有数十亿行和数十亿个特征来预测汽车转售价值，那么以矩阵格式表示方程(y = mx + c)会使我们的预测变得更容易。</p></div><div class="ab cl jx jy go jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="ha hb hc hd he"><h1 id="280d" class="ke kf hh bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">Python实现</h1><pre class="jd je jf jg fd lc ld le lf aw lg bi"><span id="fedc" class="lh kf hh ld b fi li lj l lk ll">#importing necessary libraries</span><span id="3870" class="lh kf hh ld b fi lm lj l lk ll"># pandas -- &gt; dataframe operations<br/># matplot --&gt; visualizations<br/># numpy --&gt; Matrix operations</span><span id="6b4e" class="lh kf hh ld b fi lm lj l lk ll">import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import numpy as np</span><span id="81f6" class="lh kf hh ld b fi lm lj l lk ll">#reading the data set<br/>data=pd.read_csv('Car_sales.csv')</span><span id="8b17" class="lh kf hh ld b fi lm lj l lk ll">#storing input feature in variable x<br/>x = np.array(data['Power_perf_factor'].values)</span><span id="c9a0" class="lh kf hh ld b fi lm lj l lk ll">#formating the input feature as matrix A as shown in above figure<br/>mat_A = np.transpose(np.vstack((x,np.ones(len(x)))))</span><span id="074a" class="lh kf hh ld b fi lm lj l lk ll">#calculating slope and intercept (x = B/A)<br/>output = np.matmul(np.linalg.pinv(mat_A),np.expand_dims(data['Resale_value'].values,1))</span><span id="d8d6" class="lh kf hh ld b fi lm lj l lk ll">#calculating ydash value based on slope and intercept(y=mx+c)<br/>ydash = output[0,:]*x + output[1,:]</span><span id="7177" class="lh kf hh ld b fi lm lj l lk ll">#plotting the original y value and predicted y value<br/>plt.figure(figsize=(20,5))plt.plot(y, label = 'True Label')<br/>plt.plot(ydash, label = 'Predicted')</span><span id="0d5e" class="lh kf hh ld b fi lm lj l lk ll"><br/>#naming y axis<br/>plt.ylabel('Resale Value')</span><span id="837b" class="lh kf hh ld b fi lm lj l lk ll">#to show legend <br/>plt.legend()<br/>plt.show()</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es ln"><img src="../Images/d56d0e6bfa1421139e7e081a8a86bd6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gLAmPsv6IWQWTBLhFYYxAg.png"/></div></div></figure></div></div>    
</body>
</html>