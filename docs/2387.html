<html>
<head>
<title>How to combine multiple CSVs into one</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将多个CSV合并为一个</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-combine-multiple-csvs-into-one-6e4dc807735d?source=collection_archive---------28-----------------------#2021-04-20">https://medium.com/analytics-vidhya/how-to-combine-multiple-csvs-into-one-6e4dc807735d?source=collection_archive---------28-----------------------#2021-04-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="9817" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于数据分析人员来说，将结构相同或相似的文本文件组合成一个文件是很常见的。这里我们来看看不同类型的场景。结合esProc做文件很方便。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/64b7130fed4c36de2b52605004bdd96e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ILTTu9WNYNzyqC-DhzJs4Q.jpeg"/></div></div></figure><h1 id="5a38" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">相同结构的文本文件</h1><p id="5253" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">目录包含许多列标题和结构相同的文本文件，但行数和详细数据不同。我们希望将这些文件合并成一个文件，放在一组列标题下。</p><p id="99de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">示例:e:/orders下有记录每日订单的相同结构的文本文件。每个文件在第一行有列标题，从第二行开始有详细数据，如下所示。我们希望将它们合并到一个名为orders.txt的文件中。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ks"><img src="../Images/6fae757f2f254292ac98db7e1b0af5ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-mLZVHni-3UoOL5B3W9LZg.png"/></div></div></figure><p id="2d33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">esProc SPL脚本:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kt"><img src="../Images/3bb77c74d2914f06d542f446af743a7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*86Nd4SZlnr8QsJMHUD99YQ.png"/></div></div></figure><p id="3e88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果e:/orders有子目录，那么每个子目录下的文本文件也需要合并。在这种情况下，A1可以重写为=directory@ps("e:/orders/*。txt”)。@s选项支持递归获取所有子目录下的文件。</p><h1 id="6a10" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结构相似的文本文件</h1><p id="b7f6" class="pw-post-body-paragraph if ig hi ih b ii kn ik il im ko io ip iq kp is it iu kq iw ix iy kr ja jb jc hb bi translated">有时文本文件并不具有完全相同的结构。它们可能包含不同数量的列，或者具有不同顺序的列，尽管它们都共享许多公共列。要将所有文件中的公共列合并到一个文件中，我们需要按照指定的顺序从每个文件中检索它们。</p><p id="64c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">示例:在前面的e:/orders中，所有订单文件都有ID、Company、Area、OrderDate和Amount列，尽管订单不同。有些文件包含其他列。任务是合并每个文件的这五列，并将结果写入orders.txt。</p><p id="568b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">esProc SPL脚本:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ku"><img src="../Images/e501339f10dac4aa65eee7f9b1b8ff7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iSa7QQkitmZdzO8h9GqkCQ.png"/></div></div></figure><p id="5329" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的脚本是在合并后的数据可以放入内存的条件下编写的。如果不能，请参见更复杂的场景<a class="ae kv" href="http://c.raqsoft.com/article/1600309450633" rel="noopener ugc nofollow" target="_blank">合并和拆分文件的示例</a></p></div></div>    
</body>
</html>