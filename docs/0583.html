<html>
<head>
<title>What is a form in lisp ?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">lisp中的表单是什么？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/what-is-a-form-in-lisp-7a8ed120d98f?source=collection_archive---------22-----------------------#2021-01-22">https://medium.com/analytics-vidhya/what-is-a-form-in-lisp-7a8ed120d98f?source=collection_archive---------22-----------------------#2021-01-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="9a16" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一个形式就是<strong class="ig hi"> <em class="jc">要被评估</em>的任何东西。</strong></p><p id="31c6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Lisp是由两个东西<a class="ae jd" href="https://twiserandom.com/lisp/what-is-an-atom-a-symbol-a-cons-and-a-list-in-lisp/" rel="noopener ugc nofollow" target="_blank">原子和cons </a>组成的<strong class="ig hi"> <em class="jc">。</em></strong></p><p id="ccf1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一个<code class="du je jf jg jh b">atom</code> <strong class="ig hi"> <em class="jc">是一个</em> </strong>而不是一个<code class="du je jf jg jh b">cons</code>，一个<code class="du je jf jg jh b">cons</code>拥有两个引用。</p><p id="f740" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一个<code class="du je jf jg jh b"><strong class="ig hi"><em class="jc">list</em></strong></code> <strong class="ig hi"> <em class="jc">由零个或多个<code class="du je jf jg jh b">cons</code>的</em> </strong>组成，其中每个<code class="du je jf jg jh b">cons</code>的第二个元素是对下一个<code class="du je jf jg jh b">cons</code>的引用，最后一个<code class="du je jf jg jh b">cons</code>的最后一个元素或者是对代表空列表<code class="du je jf jg jh b">()</code>的<code class="du je jf jg jh b">nil</code>元素的引用，或者什么都没有，或者最后一个<code class="du je jf jg jh b">cons</code>的最后一个元素是对一个原子的引用。在后一种情况下，这个列表称为点列表。列表的元素被括在左括号<code class="du je jf jg jh b">(</code>和右括号<code class="du je jf jg jh b">)</code>之间</p><p id="9173" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">话虽如此，一个表单或<strong class="ig hi"> <em class="jc">在lisp中可以被求值的</em> </strong> <em class="jc"> </em>，要么是一个<code class="du je jf jg jh b">atom</code>或一个<code class="du je jf jg jh b">cons</code>，或者更一般地，改为或称一个<code class="du je jf jg jh b">cons</code>，一个<code class="du je jf jg jh b">list</code>。</p><h1 id="e70c" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated">评估原子形式</h1><p id="f48d" class="pw-post-body-paragraph ie if hh ig b ih kg ij ik il kh in io ip ki ir is it kj iv iw ix kk iz ja jb ha bi translated">一个<strong class="ig hi"> <em class="jc">原子形式可以是</em> </strong> <em class="jc"> </em>或者是一个自评估原子，或者是一个符号。</p><h2 id="3e85" class="kl jj hh bd jk km kn ko jo kp kq kr js ip ks kt jw it ku kv ka ix kw kx ke ky bi translated">自我评估原子</h2><p id="db1b" class="pw-post-body-paragraph ie if hh ig b ih kg ij ik il kh in io ip ki ir is it kj iv iw ix kk iz ja jb ha bi translated">如果形式是一个原子，那么原子可以是一个<strong class="ig hi"> <em class="jc">原子，它评估为自身</em> </strong>，因此评估原子形式的值就是原子本身。</p><p id="0c18" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如，当评估一个数字(如<code class="du je jf jg jh b">1</code>)时，它评估为<code class="du je jf jg jh b">1</code>，或者当评估一个字符串(如<code class="du je jf jg jh b">"Hello world "</code>)时，它评估为<code class="du je jf jg jh b">"Hello world "</code>。</p><pre class="kz la lb lc fd ld jh le lf aw lg bi"><span id="8a5e" class="kl jj hh jh b fi lh li l lj lk">&gt; 1<br/>;;;evaluating 1 , yields <br/>;;;1 .<br/>1</span><span id="3377" class="kl jj hh jh b fi ll li l lj lk">&gt; "Hello world"<br/>;;;evaluating "Hello world" , <br/>;;;yields "Hello world" .<br/>"Hello world"</span></pre><h2 id="b4e2" class="kl jj hh bd jk km kn ko jo kp kq kr js ip ks kt jw it ku kv ka ix kw kx ke ky bi translated">标志</h2><p id="eca2" class="pw-post-body-paragraph ie if hh ig b ih kg ij ik il kh in io ip ki ir is it kj iv iw ix kk iz ja jb ha bi translated">如果形式是原子，原子也可以是符号。<strong class="ig hi"> <em class="jc">一个符号有</em> </strong>，除了别的以外，还有一个名字，一个函数属性，一个值属性。</p><p id="27bd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果形式只是一个符号，那么<strong class="ig hi"> <em class="jc">所评估的是</em> </strong>它的值属性。一些符号对自身求值，例如空列表<code class="du je jf jg jh b">()</code>的<code class="du je jf jg jh b">nil</code>，都是对自身求值的符号。</p><pre class="kz la lb lc fd ld jh le lf aw lg bi"><span id="6dcc" class="kl jj hh jh b fi lh li l lj lk">&gt;(symbolp nil )<br/>;;;symbolp checks if the passed<br/>;;;argument is a symbol , it <br/>;;;returns true , since nil <br/>;;;is a symbol .<br/>T</span><span id="0643" class="kl jj hh jh b fi ll li l lj lk">&gt; nil<br/>;;;nil evaluates to itself <br/>nil</span><span id="0f25" class="kl jj hh jh b fi ll li l lj lk">&gt; (set 'ip "192.168.0.1" )<br/>;;;set the value property of <br/>;;;the symbol ip to the string<br/>;;;192.168.0.1 . ip is quoted<br/>;;;using ' as not to be evaluated .</span><span id="3a24" class="kl jj hh jh b fi ll li l lj lk">&gt; ip<br/>;;;ip is evaluated , this returns<br/>;;;the attribute value , which is :<br/>"192.168.0.1"</span></pre><h1 id="5e1e" class="ji jj hh bd jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated">评估列表表单</h1><p id="e376" class="pw-post-body-paragraph ie if hh ig b ih kg ij ik il kh in io ip ki ir is it kj iv iw ix kk iz ja jb ha bi translated">如果要评估的是非空列表，因此是包含一些元素的列表，那么这个列表称为<strong class="ig hi"> <em class="jc">复合形式</em> </strong>。空单<code class="du je jf jg jh b">( )</code>是一个符号，它自己评价自己。</p><p id="b76a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一个列表<em class="jc">、</em>、<strong class="ig hi">、<em class="jc">取决于它所拥有的第一个元素</em>、</strong>，被称为:函数形式、lambda形式、宏形式或特殊形式</p><h2 id="7bed" class="kl jj hh bd jk km kn ko jo kp kq kr js ip ks kt jw it ku kv ka ix kw kx ke ky bi translated">什么是函数形式？</h2><p id="6a04" class="pw-post-body-paragraph ie if hh ig b ih kg ij ik il kh in io ip ki ir is it kj iv iw ix kk iz ja jb ha bi translated"><strong class="ig hi"> <em class="jc">函数执行</em> </strong>计算，如加法或正则表达式匹配。</p><p id="2f3d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">函数形式只是一个非空列表，其中<strong class="ig hi"> <em class="jc">的第一个元素</em> </strong> <em class="jc"> </em>是一个符号，它具有函数属性，定义了一个函数。</p><p id="b189" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如何对<strong class="ig hi"> <em class="jc">函数形式</em> </strong>求值，首先是列表的剩余元素，称为列表的<code class="du je jf jg jh b">cdr</code>，从左到右依次求值。一旦他们的评估完成，他们的评估被应用到函数。</p><p id="d5ac" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jc">标准没有指定</em> </strong>，如果包含函数定义的符号在自变量求值之前、之后或之间求值。</p><pre class="kz la lb lc fd ld jh le lf aw lg bi"><span id="2dfe" class="kl jj hh jh b fi lh li l lj lk">&gt; (+ 1 pi )<br/>;;;This is a function form , <br/>;;;+ is a symbol , which has<br/>;;;its function property defining<br/>;;;a function . <br/>;;;First the remainder elements of <br/>;;;the list are evaluated from left <br/>;;;to right , one after the other . <br/>;;;1 evaluates to 1 .<br/>;;;pi is a symbol , its value property <br/>;;;is evaluated , this returns :<br/>;;; 3.1415926535897932385L0 .<br/>;;;The standard does not specify , <br/>;;;when symbol + is evaluated . <br/>;;;Evaluating the symbol + , returns<br/>;;;its function definition . <br/>;;;Once arguments and function definition<br/>;;;evaluation is done , the function <br/>;;;is called with the evaluated arguments .<br/>;;;The addition of 1 and  <br/>;;; 3.1415926535897932385L0 , is <br/>;;;equal to 4.1415926535897932383L0 . <br/>4.1415926535897932383L0</span></pre><p id="41d2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要检查符号<strong class="ig hi"> <em class="jc">的功能属性是否属于功能类型</em> </strong>，<code class="du je jf jg jh b">functionp</code>都可以使用，这与检查不同，如果符号的功能属性有界，在这种情况下可以使用<code class="du je jf jg jh b">fboundp</code>。</p><pre class="kz la lb lc fd ld jh le lf aw lg bi"><span id="b82d" class="kl jj hh jh b fi lh li l lj lk">&gt;(functionp '+ )<br/>;;;' is used to quote a <br/>;;;symbol , as not to be<br/>;;;evaluated .<br/>;;;The symbol + is not<br/>;;;of type function , it<br/>;;;is a symbol which has <br/>;;;some properties . <br/>NIL</span><span id="c75a" class="kl jj hh jh b fi ll li l lj lk">&gt;(functionp #'+ )<br/>;;;#' returns the value<br/>;;;of the property : function<br/>;;; of a symbol .<br/>;;;The function property of <br/>;;;+ is of a function type . <br/>T</span><span id="a1b1" class="kl jj hh jh b fi ll li l lj lk">&gt;(fboundp '+ )<br/>;;;Checks if the symbol +<br/>;;;has its property : function <br/>;;;bounded .<br/>T</span></pre><h2 id="98ff" class="kl jj hh bd jk km kn ko jo kp kq kr js ip ks kt jw it ku kv ka ix kw kx ke ky bi translated">什么是lambda形式？</h2><p id="0fb1" class="pw-post-body-paragraph ie if hh ig b ih kg ij ik il kh in io ip ki ir is it kj iv iw ix kk iz ja jb ha bi translated">lambda形式是非空列表，其中<strong class="ig hi"> <em class="jc">的第一个元素</em> </strong>是lambda表达式。</p><p id="1628" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">λ表达式是一个函数，它没有名字，通过使用一个列表来定义，第一个元素是符号<code class="du je jf jg jh b">lambda</code>，后面是一个包含函数参数的列表，称为λ列表，λ列表可以是空的，因为函数不接收任何参数。lambda列表后跟零个或多个可选形式，构成了函数体。如果lambda函数没有主体，它只返回<code class="du je jf jg jh b">nil</code>，否则它返回最后一个求值形式的值。</p><p id="d2da" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">λ形式 的<strong class="ig hi"> <em class="jc">求值，相当于使用<code class="du je jf jg jh b">funcall</code>。这意味着，由于<code class="du je jf jg jh b">funcall</code>是一个函数，它的所有参数首先从左到右被求值，因此lambda表达式首先被求值，然后是列表的剩余元素，最后<code class="du je jf jg jh b">funcall</code>将把从lambda表达式得到的函数应用于求值的参数，并返回结果。</em></strong></p><pre class="kz la lb lc fd ld jh le lf aw lg bi"><span id="a771" class="kl jj hh jh b fi lh li l lj lk">&gt; ((lambda (x ) (* x x ) ) 2 )<br/>;;;This is a lambda form , since <br/>;;;the first element of the list<br/>;;;is a lambda expression . <br/>;;;The lambda expression is first <br/>;;;evaluated to get its function <br/>;;;definition .<br/>;;;The second element of the form , <br/>;;;is 2 , it evaluates to itself , <br/>;;;which is 2 .<br/>;;;The gotten function is applied <br/>;;;to the argument 2 , this<br/>;;;returns 4 .<br/>4</span></pre><h2 id="b8de" class="kl jj hh bd jk km kn ko jo kp kq kr js ip ks kt jw it ku kv ka ix kw kx ke ky bi translated">什么是宏表单？</h2><p id="10f4" class="pw-post-body-paragraph ie if hh ig b ih kg ij ik il kh in io ip ki ir is it kj iv iw ix kk iz ja jb ha bi translated">一个函数执行一个计算，比如加法，或者排序一些元素，<strong class="ig hi"> <em class="jc">而一个宏函数</em> </strong>，返回另一个要求值的形式，换句话说，它返回一个新的程序。</p><p id="a77a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">宏表单是一个非空列表，其第一个元素是一个符号，该符号具有其<strong class="ig hi"> <em class="jc">功能属性，定义了</em> </strong>宏。</p><p id="08e8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">到<em class="jc">检查如果</em>的功能属性</strong>为一个符号，定义了一个宏，<code class="du je jf jg jh b">macro-function</code>可以使用。<code class="du je jf jg jh b">macro-function</code>如果符号的属性函数没有定义宏，则返回nil。</p><pre class="kz la lb lc fd ld jh le lf aw lg bi"><span id="7bc5" class="kl jj hh jh b fi lh li l lj lk">&gt; (defmacro sub(var )<br/>   `(- ,var 1 ) )<br/>;;;Define the symbol sub ,<br/>;;;function property with<br/>;;;a macro definition . <br/>SUB</span><span id="f281" class="kl jj hh jh b fi ll li l lj lk">&gt;&gt; (macro-function '+ )<br/>;;;The property function of the<br/>;;;symbol + , is not a macro<br/>;;; definition , hence <br/>;;; macro-function returns NIL .<br/>NIL</span><span id="384d" class="kl jj hh jh b fi ll li l lj lk">&gt; (macro-function 'sub )<br/>;;;The symbol sub function property <br/>;;;is a macro definition , hence<br/>;;;macro-function does not return<br/>;;;nil . <br/>#&lt;FUNCTION SUB (SYSTEM::&lt;MACRO-FORM&gt; SYSTEM::&lt;ENV-ARG&gt;)<br/>  (DECLARE (CONS SYSTEM::&lt;MACRO-FORM&gt;)) (DECLARE (IGNORE SYSTEM::&lt;ENV-ARG&gt;))<br/>  (IF (NOT (SYSTEM::LIST-LENGTH-IN-BOUNDS-P SYSTEM::&lt;MACRO-FORM&gt; 2 2 NIL))<br/>   (SYSTEM::MACRO-CALL-ERROR SYSTEM::&lt;MACRO-FORM&gt;)<br/>   (LET* ((VAR (CADR SYSTEM::&lt;MACRO-FORM&gt;))) (BLOCK SUB `(- ,VAR 1))))&gt;</span></pre><p id="1817" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一个<strong class="ig hi"> <em class="jc">宏表单被</em> </strong>评估，通过首先评估宏，并扩展它，替换宏表单。参数作为扩展形式的一部分进行评估。</p><pre class="kz la lb lc fd ld jh le lf aw lg bi"><span id="0301" class="kl jj hh jh b fi lh li l lj lk">&gt; (defmacro sub(var )<br/>    `(- ,var 1 ) )<br/>;;;Defines the function property<br/>;;;of the symbol sub , as being <br/>;;;a macro defintion .</span><span id="16db" class="kl jj hh jh b fi ll li l lj lk">&gt; (sub pi)<br/>;;;sub function property , is a macro<br/>;;;definition , hence what happens first,<br/>;;;is that sub is expanded , and the form<br/>;;;is replaced , by sub expansion .<br/>;;;pi as a symbol , is not evaluated , <br/>;;;first , it is only evaluated ,<br/>;;;when evaluating the replacement <br/>;;;form , which is now :<br/>;;;(- pi 1 )<br/>;;;This is a function form , <br/>;;;the cdr of the list , <br/>;;;which is its remainder , <br/>;;;is evaluated . <br/>;;; pi is evaluated to get <br/>;;;3.1415926535897932385L0<br/>;;;1 is evaluated to 1 .<br/>;;;The standard does not specify ,<br/>;;;when the symbol - is evaluated , <br/>;;;to get its function definition .<br/>;;;It can be , before , after , or<br/>;;;in between evaluating the arguments.<br/>;;;Once the elements of the list <br/>;;;are evaluated , the function <br/>;;;- is applied to the gotten <br/>;;;arguments , and the returned <br/>;;;value is 2.1415926535897932385L0 <br/>2.1415926535897932385L0</span></pre><h2 id="6aa2" class="kl jj hh bd jk km kn ko jo kp kq kr js ip ks kt jw it ku kv ka ix kw kx ke ky bi translated">什么是特殊形态？</h2><p id="3df9" class="pw-post-body-paragraph ie if hh ig b ih kg ij ik il kh in io ip ki ir is it kj iv iw ix kk iz ja jb ha bi translated">特殊表单，是一个表单，其中<strong class="ig hi"> <em class="jc">的第一个元素</em> </strong>是一个特殊运算符。特殊操作员包括:</p><pre class="kz la lb lc fd ld jh le lf aw lg bi"><span id="6e65" class="kl jj hh jh b fi lh li l lj lk">block                            <br/>catch                         <br/>eval-when                 <br/>flet                             <br/>function                  <br/>go                     <br/>if                           <br/>labels                                      <br/>let          <br/>let*<br/>load-time-value<br/>locally<br/>macrolet<br/>multiple-value-call <br/>multiple-value-prog1 <br/>progn<br/>progv<br/>quote<br/>return-from <br/>setq<br/>symbol-macrolet <br/>tagbody<br/>the<br/>throw<br/>unwind-protect</span></pre><p id="c194" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一个特殊的表单，可能有一个特殊的语法，或者<strong class="ig hi"> <em class="jc">一个特殊的求值规则</em> </strong>，例如它可能不会求值它所有的参数。</p><pre class="kz la lb lc fd ld jh le lf aw lg bi"><span id="c033" class="kl jj hh jh b fi lh li l lj lk">&gt; (if t 1 pi )<br/>;;;In this example , pi is <br/>;;;never evaluated , since <br/>;;;the condition is true , <br/>;;;hence what is evaluated <br/>;;;is 1 , which evaluates ,<br/>;;;to itself .<br/>1</span></pre></div><div class="ab cl lm ln go lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ha hb hc hd he"><p id="f7a7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">原载于2021年1月22日https://twiserandom.com</em><a class="ae jd" href="https://twiserandom.com/lisp/what-is-a-form-in-lisp/" rel="noopener ugc nofollow" target="_blank"><em class="jc"/></a><em class="jc">。</em></p></div></div>    
</body>
</html>