<html>
<head>
<title>Bert Question Answering Finetune Visualization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">伯特问题回答微调可视化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/bert-question-answering-finetune-visualization-f86198279c13?source=collection_archive---------12-----------------------#2021-05-07">https://medium.com/analytics-vidhya/bert-question-answering-finetune-visualization-f86198279c13?source=collection_archive---------12-----------------------#2021-05-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="de70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我将尝试展示Bert是如何通过训练学会回答我们的自定义问题的。我将尝试揭示中间步骤以及这些步骤中的变化。</p><p id="8f8e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">代码在github : <a class="ae jd" href="https://github.com/mcelikkaya/medium_articles2/blob/main/bert_qa_tune.ipynb" rel="noopener ugc nofollow" target="_blank">链接</a> <br/>可以在nbviewer查看:<a class="ae jd" href="https://nbviewer.jupyter.org/github/mcelikkaya/medium_articles2/blob/main/bert_qa_tune.ipynb" rel="noopener ugc nofollow" target="_blank">链接</a></p><p id="5259" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将试着展示什么样的模型在学习。在每个训练周期结束时(我正在1乘1地捕捉中间步骤，我尝试询问单个问题的答案，并记录返回的结果。下图是两个条形图。<br/> <strong class="ih hj">蓝色</strong>:开始分数，(130)表示130令牌，训练循环前“未训练”。<br/>垂直黄线是我们预期的输出位置。(我在这里做了一个欺骗，令牌索引和位置之间存在xticks宽度问题，所以我通过尝试找到了预期的位置，因为没有做matplotlib演算，您可以忽略这里，专注于逻辑。<br/> <strong class="ih hj">橙色</strong>:结束分数，(130)表示130代币，训练周期前“未训练”。垂直红线是我们期望最终结果的地方。</p><p id="a497" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们来总结一下培训Bert QA。我们给出一个有130个记号的上下文。我们问一个问题，并把问题的开始和结束给伯特。Bert QA试图找到答案开始和结束。在猜测之后，我们计算损失并告诉Bert QA更新它的权重。通过这种方式，我们希望Bert QA通过培训使实际的开始和结束更加一致。因为我在训练中记录了中间步骤，所以我会显示所有步骤的分数。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/50ec48d5a36b142deb3d9d9ff1a8720b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JsxMSocxOnT46q1nAbg7jQ.png"/></div></div></figure><p id="94d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如你在上面看到的，最初一切都是随机的。很多代币都有很高的正分。训练后你会看到事情会有怎样的变化。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jq"><img src="../Images/bf4eaed4b6a29a14210e78fb1d66231a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P8qTyCPvO9AioGhMarloqQ.png"/></div></div></figure><p id="b0b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在上面你可以看到，在1个训练周期中，许多令牌得到了负分，只有少数项目得到了正分。同样，对于开始，请注意3个柱线靠近我们的开始黄色垂直线。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jr"><img src="../Images/bdf751f6be060da6b72cb5da31600d1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_1-0nKy8GITxDeW1YKBU1w.png"/></div></div></figure><p id="ffd1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面你可以看到，在第二个训练周期后，模特几乎学会了我们的问题。(起点和终点的最高线条都接近预期的垂直线。)</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es js"><img src="../Images/ca17c429568deed1c6169d82f6a1ce00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G24905qV3bl4YnzLulSa_Q.png"/></div></div></figure><p id="a25e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上图可以看出，在第五个训练周期后，模型对问题变得更加清楚，并学会了问题的开始和结束。</p><p id="d813" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上图是一个<strong class="ih hj">单项问答</strong>的旅程。如何才能把<strong class="ih hj">整个学习过程</strong>可视化。为此，我选择了距离小于100的答案子集。(预测的开始索引和预测的结束索引)。然后我用横条表示真实距离，预测距离。起初，这些预测棒线是随机的。(见下图)。在合并部分，我将这两个图表合并成一个。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jt"><img src="../Images/9ee1ab2933c6deb3c60a5f324a115a08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wOEPmBaHtCjaArENZzEjtg.png"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated"><strong class="bd jy">未经任何培训</strong></figcaption></figure><p id="5f22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在第一个训练周期后(如上图),你可以看到预测和实际并不一致。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es jz"><img src="../Images/73097765ab5721c9e216bc24973d6421.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ti_yDYnllesS3k-t0AVdXw.png"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated"><strong class="bd jy">第一个列车周期后</strong></figcaption></figure><p id="8422" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在最后一个训练周期后(下图)，你可以看到这些水平杆排列得更好了。通过最后的步骤，它们重叠太多了。通过这种方式，我们可以看到预测在训练中的累积变化。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ka"><img src="../Images/a3dea81ca06701fbfcc31337cf2fe95d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fk9JYIVpmhrTVHlGD1CVCw.png"/></div></div><figcaption class="ju jv et er es jw jx bd b be z dx translated"><strong class="bd jy">在最后一个训练周期后</strong></figcaption></figure><p id="5ca1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以我用这两种类型的图表展示了训练的过程。</p><p id="a262" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">伯特QA已经用小队集合训练过了，所以你可能会问，为什么它没有从一开始就猜对。第一班是一个有点偏见的数据集。大多数答案和问题都有相同的词汇。我的数据集准备得有点差，试图回答糟糕的问题(我是故意这样做的，不是从一开始就得到正确的答案)</p><p id="a0ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在下游任务中，最好用你的数据训练已经训练好的网络。已经训练的网络的类比可以是图像处理任务中的边缘检测器。在这种情况下，团队数据对我们来说可能是一个低级编码器，我们必须用我们的数据集来训练它，以符合我们的目标。</p><p id="7cb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你检查初始(未训练)图片并训练1个周期，即使1个周期后网络学到了很多。我怀疑这是因为我的数据集非常同质，很容易捕捉到那里的意图。因此，玩玩视觉和代码，看看Bert QA如何解决您的问题。</p></div></div>    
</body>
</html>