<html>
<head>
<title>Spotify in Docker Container</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Docker容器中的Spotify</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/spotify-in-docker-container-881cbe798269?source=collection_archive---------1-----------------------#2021-06-12">https://medium.com/analytics-vidhya/spotify-in-docker-container-881cbe798269?source=collection_archive---------1-----------------------#2021-06-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/3bb5b5317258f3db9c0e9ad0cff5e03c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*hq0WMxa_UofUtDqYCgWfdw.gif"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片由我:)</figcaption></figure><p id="8f0d" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">如果你遇到一个问题，你是否可以在docker容器中运行图形应用程序，因为你很好奇或者你已经创建了一些GUI应用程序，你想在容器中运行，那么你的问题的答案是肯定的，我们可以在容器中运行GUI应用程序。</p><p id="a0f5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">但是如果你尝试过用传统的docker命令运行它，那么它就不会工作。这是因为Docker容器只是基于CLI的，需要物理显示器来运行GUI应用程序。因此，为了在容器中运行图形应用程序，我们需要与容器共享基本主机的显示。</p><p id="0c27" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这很容易做到。这只是一个命令，但是要理解这个命令，首先需要理解两件事</p><ol class=""><li id="eb40" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">x服务器或X11</li><li id="4e6d" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">显示环境变量</li></ol><h2 id="afcc" class="kg kh hi bd ki kj kk kl km kn ko kp kq jf kr ks kt jj ku kv kw jn kx ky kz la bi translated">什么是X服务器？</h2><p id="7106" class="pw-post-body-paragraph iu iv hi iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr hb bi translated">x服务器是在Linux系统/内核中实现图形用户界面的一种方式。Linux主要是关于CLI的，但是在X server的帮助下，你可以在Linux上运行图形应用程序和其他任何东西，就像在Microsoft Windows中一样。X服务器只是一个在显示屏上图形化绘制窗口的套接字。</p><blockquote class="lg lh li"><p id="c90c" class="iu iv lj iw b ix iy iz ja jb jc jd je lk jg jh ji ll jk jl jm lm jo jp jq jr hb bi translated">有趣的事实:-在X server的帮助下，您可以通过网络将输出发送到一些远程显示器。</p></blockquote><h2 id="915e" class="kg kh hi bd ki kj kk kl km kn ko kp kq jf kr ks kt jj ku kv kw jn kx ky kz la bi translated">显示器是什么？</h2><p id="2661" class="pw-post-body-paragraph iu iv hi iw b ix lb iz ja jb lc jd je jf ld jh ji jj le jl jm jn lf jp jq jr hb bi translated">它是一个环境变量，包括</p><ul class=""><li id="701a" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr ln jy jz ka bi translated">一个键盘，</li><li id="c0ef" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr ln jy jz ka bi translated">一只老鼠</li><li id="518a" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr ln jy jz ka bi translated">和一个屏幕。</li></ul><p id="5ce4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">X服务器从这个变量中获取值，以知道它必须将输出发送到哪里，或者简单地说，通过这个变量，X服务器知道您的显示器在哪里。</p><p id="52d1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">显示变量的格式如下</p><pre class="lo lp lq lr fd ls lt lu lv aw lw bi"><span id="749e" class="kg kh hi lt b fi lx ly l lz ma">hostname:D.S</span></pre><p id="9624" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在哪里，</p><ol class=""><li id="4b68" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr jx jy jz ka bi translated">主机名是主机的名称或IP</li><li id="771f" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">如果有多台显示器，d是显示器编号(通常为0)</li><li id="b96a" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr jx jy jz ka bi translated">如果有多个屏幕，s是屏幕号(通常为0)</li></ol><p id="a3a2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在我们知道了这两个概念，是时候实现它们了。我们将在这里做一个惊人的项目。我们将在容器中启动一个Spotify应用程序。是不是很神奇？</p><p id="7fc3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">下面是创建图像的Dockerfile文件，你可以复制它，它非常容易理解</p><pre class="lo lp lq lr fd ls lt lu lv aw lw bi"><span id="948c" class="kg kh hi lt b fi lx ly l lz ma">FROM debian:sid-slim<br/>LABEL maintainer “Saurabh Rohankar”<br/>RUN apt-get update &amp;&amp; apt-get install -y <br/>RUN apt-get install curl -y <br/>RUN apt-get update &amp;&amp; apt-get install -y gnupg2 sudo<br/>RUN curl -sS <a class="ae mb" href="https://download.spotify.com/debian/pubkey_0D811D58.gpg" rel="noopener ugc nofollow" target="_blank">https://download.spotify.com/debian/pubkey_0D811D58.gpg</a> | apt-key add — <br/>RUN echo “deb <a class="ae mb" href="http://repository.spotify.com" rel="noopener ugc nofollow" target="_blank">http://repository.spotify.com</a> stable non-free” &gt;&gt; /etc/apt/sources.list.d/spotify.list<br/>RUN sudo apt-get update &amp;&amp; sudo apt-get install spotify-client -y<br/>ENTRYPOINT [ “spotify” ]</span></pre><p id="a131" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">但是如果你不想创建图像，你可以使用我已经创建并上传到Docker <a class="ae mb" href="https://hub.docker.com/r/saurabh19/spotify_instance" rel="noopener ugc nofollow" target="_blank"> Hub </a>上的那个。</p><p id="69af" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">只需运行下面的命令来从docker hub中提取它</p><pre class="lo lp lq lr fd ls lt lu lv aw lw bi"><span id="29fb" class="kg kh hi lt b fi lx ly l lz ma">docker pull saurabh19/spotify_instance:v1</span></pre><p id="8462" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在，在容器中运行Spotify应用程序的最后一个命令是</p><pre class="lo lp lq lr fd ls lt lu lv aw lw bi"><span id="5adb" class="kg kh hi lt b fi lx ly l lz ma">docker run -it -e DISPLAY=:0 -v /tmp/.X11-unix:/tmp/.X11-unix --device /dev/snd spotify_instance:v1 bash</span></pre><p id="9c27" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在哪里，</p><ul class=""><li id="5799" class="js jt hi iw b ix iy jb jc jf ju jj jv jn jw jr ln jy jz ka bi translated">-e代表导出环境变量，(共享环境变量)</li><li id="594e" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr ln jy jz ka bi translated">-v代表绑定挂载卷(以附加卷)</li><li id="a47e" class="js jt hi iw b ix kb jb kc jf kd jj ke jn kf jr ln jy jz ka bi translated">-设备允许主机设备访问容器</li></ul><p id="5460" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">在上面的命令中，我们首先使用<strong class="iw hj"> -e </strong>选项设置显示的环境变量。</p><p id="b10e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">然后，我们使用<strong class="iw hj"> -v </strong>选项将主机中的X服务器套接字的文件夹安装到docker容器中。我们这样做是因为docker容器没有X服务器，所以我们从主机复制它(不完全是复制而是共享文件夹)。</p><p id="5227" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">由于它是一个Spotify应用程序，我们肯定希望听到音乐，而不仅仅是能够运行它，所以我们还需要与容器共享主机的声音驱动程序/设备，我们正在借助- <strong class="iw hj">设备</strong>选项来实现这一点。</p><p id="d7fd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">因此，最后当您运行上述命令时，您的容器将被启动，它将运行Spotify应用程序。</p><p id="4e8c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">现在坐下来，喝杯咖啡，享受你最喜欢的音乐。顺便说一下，你也可以在这里听我的<a class="ae mb" href="https://open.spotify.com/playlist/3UsA2oWh9duWjxmSJQjtWO?si=QVvhZCOZRMqbIa0Pj3Yh0w&amp;utm_source=copy-link&amp;dl_branch=1" rel="noopener ugc nofollow" target="_blank">播放列表</a>。</p><p id="414f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">这一次就这样了。希望你喜欢这个博客。我会在下一个有趣的话题中看到你。</p></div></div>    
</body>
</html>