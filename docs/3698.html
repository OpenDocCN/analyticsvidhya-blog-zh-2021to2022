<html>
<head>
<title>Beginners guide to Apache Spark for data analytics — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Apache Spark数据分析初学者指南—第2部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/beginners-guide-to-apache-spark-for-data-analytics-part-2-f0cf7307fa49?source=collection_archive---------14-----------------------#2021-07-18">https://medium.com/analytics-vidhya/beginners-guide-to-apache-spark-for-data-analytics-part-2-f0cf7307fa49?source=collection_archive---------14-----------------------#2021-07-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="8e93" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">学习数据分析中使用的spark函数的基本语法</h2></div></div><div class="ab cl iw ix go iy" role="separator"><span class="iz bw bk ja jb jc"/><span class="iz bw bk ja jb jc"/><span class="iz bw bk ja jb"/></div><div class="ha hb hc hd he"><p id="253d" class="pw-post-body-paragraph jd je hh jf b jg jh ii ji jj jk il jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi jz translated"><span class="l ka kb kc bm kd ke kf kg kh di">在前面的章节中，我们看到了创建数据帧的不同方法。如果没有，请参考下面的链接。本文包含关于a)初始化spark &amp; b)在spark中创建数据帧的<a class="ae ki" rel="noopener" href="/@akash865/learn-basics-in-spark-for-data-analytics-11cee514ac30"> python笔记本</a></span></p><div class="kj kk ez fb kl km"><a rel="noopener follow" target="_blank" href="/@akash865/learn-basics-in-spark-for-data-analytics-11cee514ac30"><div class="kn ab dw"><div class="ko ab kp cl cj kq"><h2 class="bd hi fi z dy kr ea eb ks ed ef hg bi translated">Apache Spark数据分析初学者指南—第1部分</h2><div class="kt l"><h3 class="bd b fi z dy kr ea eb ks ed ef dx translated">学习数据分析中常用的基本spark语法</h3></div><div class="ku l"><p class="bd b fp z dy kr ea eb ks ed ef dx translated">medium.com</p></div></div><div class="kv l"><div class="kw l kx ky kz kv la lb km"/></div></div></a></div><p id="5958" class="pw-post-body-paragraph jd je hh jf b jg jh ii ji jj jk il jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">既然我们已经创建了包含我们的数据的数据框架，那么是时候看看在分析中经常使用的数据操作了。</p><blockquote class="lc ld le"><p id="adb6" class="jd je lf jf b jg jh ii ji jj jk il jl lg jn jo jp lh jr js jt li jv jw jx jy ha bi translated">我们将研究不同的方法和函数来<code class="du lj lk ll lm b">select</code>特定的字段/列、<code class="du lj lk ll lm b">drop, rename</code>和其他类似的表达式。我们将研究对“剪切和切片”使用过滤操作。</p></blockquote><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es ln"><img src="../Images/778a00d996bd58b10420bb16dc99d0ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*-gAujIz9l7bXvV78j5XC6A.png"/></div></figure><p id="f05c" class="pw-post-body-paragraph jd je hh jf b jg jh ii ji jj jk il jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">在我们开始这一部分之前，让我们从导入现有数据开始。然后我们将使用一些基本的函数/语法。这些数据已经在github上共享了，所以您可以使用相同的数据继续。</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="lu lv l"/></div></figure><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es lw"><img src="../Images/74edf9695266ec4f80007ae19e0decd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*ag3xcliWJGobhrGHRsz7Hw.png"/></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">以上导入时的输出</figcaption></figure><h2 id="ef47" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">在spark中使用SQL</h2><p id="f39f" class="pw-post-body-paragraph jd je hh jf b jg mw ii ji jj mx il jl jm my jo jp jq mz js jt ju na jw jx jy ha bi translated">SQL是RDD表数据操作最常用的语言。虽然spark提供了我们在SQL中使用的几乎所有函数，但由于SQL的熟悉性，它通常更容易使用。请注意，最好避免在列名中使用空格(在下面的例子中)。我们还将学习spark函数/方法，这将有助于我们的工作。我们可以从模式细节开始。</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="lu lv l"/></div></figure><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es nb"><img src="../Images/4ec24d7a065798314fd0e67ab943b9f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*VddP36T2HOAygJ8-k4oXHQ.png"/></div></figure><h2 id="159b" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">1.描述数据框架</h2><p id="585b" class="pw-post-body-paragraph jd je hh jf b jg mw ii ji jj mx il jl jm my jo jp jq mz js jt ju na jw jx jy ha bi translated">Describe是一个在所有列上执行<code class="du lj lk ll lm b">count</code>、<code class="du lj lk ll lm b">mean</code>、<code class="du lj lk ll lm b">stddev</code>、<code class="du lj lk ll lm b">min</code>和<code class="du lj lk ll lm b">max</code>的有用方法。我们可以通过在<code class="du lj lk ll lm b">describe</code>中传递列名来限制变量。</p><pre class="lo lp lq lr fd nc lm nd ne aw nf bi"><span id="8265" class="mb mc hh lm b fi ng nh l ni nj">df.describe().show()</span></pre><figure class="lo lp lq lr fd ls er es paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="er es nk"><img src="../Images/a854ef0724057932cdea9f1453e01837.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xDS-ryyVlNGieEnTtCTQng.png"/></div></div></figure><pre class="lo lp lq lr fd nc lm nd ne aw nf bi"><span id="8533" class="mb mc hh lm b fi ng nh l ni nj">df.describe('City', 'ST').show()</span></pre><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es np"><img src="../Images/c04ce59509441eb5641ea0b96cdaeea4.png" data-original-src="https://miro.medium.com/v2/resize:fit:350/format:webp/1*kow3E1pBg7ujUTX-p39vUQ.png"/></div></figure><h2 id="9998" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">2.计数、列和模式</h2><p id="e127" class="pw-post-body-paragraph jd je hh jf b jg mw ii ji jj mx il jl jm my jo jp jq mz js jt ju na jw jx jy ha bi translated">在进行数据处理之前，必须查看<code class="du lj lk ll lm b">counts</code>、<code class="du lj lk ll lm b">columns</code>和<code class="du lj lk ll lm b">data types</code>。这在下面很容易做到。我们可以使用<code class="du lj lk ll lm b">dtypes</code>查看字符串和数字列。</p><pre class="lo lp lq lr fd nc lm nd ne aw nf bi"><span id="52d9" class="mb mc hh lm b fi ng nh l ni nj">print('df.count		:', df.count())<br/>print('df.columns	:', df.columns)<br/>print('df dtypes	:', df.dtypes)<br/>print('df schema 1:', df.schema)</span></pre><figure class="lo lp lq lr fd ls er es paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="er es nq"><img src="../Images/0e933256b8cb8580b23b6e0ecee042d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fMvgyM4rGmBy-PM96JYEeg.png"/></div></div></figure><pre class="lo lp lq lr fd nc lm nd ne aw nf bi"><span id="05e5" class="mb mc hh lm b fi ng nh l ni nj">print('df schema 1:')<br/>df.printSchema()</span></pre><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es nr"><img src="../Images/9ec6c373777eb78d26aa0c7c62f666e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*V5qIFjIpupJdnbb2HK5NSg.png"/></div></figure><h2 id="e8f2" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">3.删除重复项</h2><p id="64d0" class="pw-post-body-paragraph jd je hh jf b jg mw ii ji jj mx il jl jm my jo jp jq mz js jt ju na jw jx jy ha bi translated">当处理来自其他来源的数据时，通常需要在进一步处理之前清理它们。<code class="du lj lk ll lm b">dropDuplicates</code>删除重复行的所有实例。请注意,“完整的”重复行被删除，并且不考虑重复id。删除重复id需要使用<code class="du lj lk ll lm b">window</code>函数，我们将在后面介绍。该数据帧没有副本，因此新的数据帧具有相同的计数。</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="lu lv l"/></div></figure><figure class="lo lp lq lr fd ls er es paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="er es ns"><img src="../Images/493307afa24a46b66a4d575ad47cd800.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ysG_djS4jcAqU8QBA7ya4w.png"/></div></div></figure><h2 id="6f9c" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">4.选择特定列</h2><p id="483b" class="pw-post-body-paragraph jd je hh jf b jg mw ii ji jj mx il jl jm my jo jp jq mz js jt ju na jw jx jy ha bi translated">可以使用<code class="du lj lk ll lm b">select</code>语句将特定的列存储在dataframe中。它接受list作为特定列/字段列表的参数。</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="lu lv l"/></div></figure><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es nt"><img src="../Images/d38869f30169dcb686a4f86604aa0be6.png" data-original-src="https://miro.medium.com/v2/resize:fit:490/format:webp/1*cgge-TY-gVgODI1nK0uxYQ.png"/></div></figure><h2 id="ae71" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">5.选择多列</h2><p id="4a25" class="pw-post-body-paragraph jd je hh jf b jg mw ii ji jj mx il jl jm my jo jp jq mz js jt ju na jw jx jy ha bi translated">如果我们有一个需要删除的列列表，或者我们可以从dataframe中删除多个列。因此，我们使用python中的列表操作来获取变量列表子集。然后使用<code class="du lj lk ll lm b">select</code>方法创建一个具有特定列的dataframe。</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="lu lv l"/></div></figure><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es nu"><img src="../Images/2258ab04a8c3edd49fd06c424f4b372c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*NiEX5oSRa3IfpYLbeYPt4g.png"/></div></figure><h2 id="6eb2" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">6.重命名列</h2><p id="275c" class="pw-post-body-paragraph jd je hh jf b jg mw ii ji jj mx il jl jm my jo jp jq mz js jt ju na jw jx jy ha bi translated">我们将在下面的例子中重命名多个列。我发现在字段名中看到空格很烦人。所以让我们从使用<code class="du lj lk ll lm b">withColumnRenamed</code>移除列中的空格开始。第一个参数是现有列，第二个参数是新列名。</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="lu lv l"/></div></figure><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es nv"><img src="../Images/32a6e6525b94818e03272cabaa91d4c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*p7SEU1DS9k3S_ZoA7DyYOw.png"/></div></figure><h2 id="1e13" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">7.使用循环重命名列</h2><p id="ce92" class="pw-post-body-paragraph jd je hh jf b jg mw ii ji jj mx il jl jm my jo jp jq mz js jt ju na jw jx jy ha bi translated">对于重命名多个列，我们可以使用循环来帮助我们执行类似的操作，如大小写改变、替换字符。在下面的例子中，我们用<code class="du lj lk ll lm b">_</code>替换所有的空格。</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="lu lv l"/></div></figure><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es nw"><img src="../Images/492a1e51a25eb376af63996ef4bc096a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*mhVZ0yPAM1y9UVMNc9mZwA.png"/></div></figure><h2 id="1124" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">8.添加列</h2><p id="171e" class="pw-post-body-paragraph jd je hh jf b jg mw ii ji jj mx il jl jm my jo jp jq mz js jt ju na jw jx jy ha bi translated">在下面的例子中，我们将使用<code class="du lj lk ll lm b">col</code>函数复制列状态。PySpark SQL库包含许多函数，我们将通过。注意<code class="du lj lk ll lm b">col</code>就是这样一个返回列值的函数。</p><pre class="lo lp lq lr fd nc lm nd ne aw nf bi"><span id="ff77" class="mb mc hh lm b fi ng nh l ni nj">df2 = df.withColumn('state', col('ST'))<br/>df2.show(2)</span></pre><figure class="lo lp lq lr fd ls er es paragraph-image"><div role="button" tabindex="0" class="nl nm di nn bf no"><div class="er es nx"><img src="../Images/776a4dbba9a1c57bc98b7e05a2a21074.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*X2-eGK-Q14fFk3TPZ303PA.png"/></div></div></figure><h2 id="93d1" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">9.添加常量列</h2><p id="cd29" class="pw-post-body-paragraph jd je hh jf b jg mw ii ji jj mx il jl jm my jo jp jq mz js jt ju na jw jx jy ha bi translated">如果我们想添加一个具有相同值的列。假设在这种情况下，我们想要添加country—‘US’作为新列。<code class="du lj lk ll lm b">lit</code>帮助我们将该值“线性转换”到数据帧中的所有行。</p><pre class="lo lp lq lr fd nc lm nd ne aw nf bi"><span id="3aaf" class="mb mc hh lm b fi ng nh l ni nj">df2 = df.withColumn('country', lit('US'))<br/>df2.show(2)</span></pre><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es ny"><img src="../Images/92737c06c65acbb840f1a19bb7aeda95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*xCas2cHFrIq7_hLiRn7NLw.png"/></div></figure><h2 id="2417" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">10.删除列</h2><p id="4bbc" class="pw-post-body-paragraph jd je hh jf b jg mw ii ji jj mx il jl jm my jo jp jq mz js jt ju na jw jx jy ha bi translated">除了选择特定的列，我们还可以选择分析不需要的<code class="du lj lk ll lm b">drop</code>列。</p><pre class="lo lp lq lr fd nc lm nd ne aw nf bi"><span id="b4f6" class="mb mc hh lm b fi ng nh l ni nj">df2 = df.drop('CERT')<br/>df2.show(2)</span></pre><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es nz"><img src="../Images/d6f47f2c396c54ddf8ec260e27aeb781.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*T2_HUbL2QJ_UM4bPviBeOQ.png"/></div></figure><h2 id="ca64" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">11.删除多列</h2><p id="7426" class="pw-post-body-paragraph jd je hh jf b jg mw ii ji jj mx il jl jm my jo jp jq mz js jt ju na jw jx jy ha bi translated">与<code class="du lj lk ll lm b">select</code>一样，删除multipl列也很简单。我们所要做的就是传递一个列列表，使用<code class="du lj lk ll lm b">*</code>来移除。下面有两种方法可以做到这一点。</p><pre class="lo lp lq lr fd nc lm nd ne aw nf bi"><span id="2720" class="mb mc hh lm b fi ng nh l ni nj">df2 = df.drop(*['CERT','ST'])<br/>df2.show(2)</span></pre><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es oa"><img src="../Images/fc9044da49da2924d6e081e3d453698d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*OXDJNj73m3qqxKgWubNs6A.png"/></div></figure><pre class="lo lp lq lr fd nc lm nd ne aw nf bi"><span id="472c" class="mb mc hh lm b fi ng nh l ni nj">df2 = reduce(DataFrame.drop, ['CERT','ST'], df)<br/>df2.show(2)</span></pre><h2 id="935f" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">12.过滤数据</h2><p id="7d11" class="pw-post-body-paragraph jd je hh jf b jg mw ii ji jj mx il jl jm my jo jp jq mz js jt ju na jw jx jy ha bi translated">在查看数据表时，我们需要“切割和切片”来获得洞察力。下面是使用<code class="du lj lk ll lm b">&gt;</code>、<code class="du lj lk ll lm b">&lt;</code>、<code class="du lj lk ll lm b">==</code>、<code class="du lj lk ll lm b">between</code>和<code class="du lj lk ll lm b">isin</code>过滤数据的例子</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="lu lv l"/></div></figure><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es ob"><img src="../Images/7e62cd6be0a4b199881af90903248ecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:240/format:webp/1*jT3OdubtJDqy7tH0KwQmZw.png"/></div></figure><pre class="lo lp lq lr fd nc lm nd ne aw nf bi"><span id="69bb" class="mb mc hh lm b fi ng nh l ni nj"><em class="lf"># Equal to values</em><br/>df2 = df.where(df['ST'] == 'NE')<br/><br/>print('<strong class="lm hi">\n</strong>df2 sample below')<br/>df2.show(2)</span></pre><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es oc"><img src="../Images/a543b19b0196ed36d1e1ef5c982e2450.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*6DnDvzTWVc2pgQzm2dNNhw.png"/></div></figure><h2 id="941d" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">13.使用逻辑运算符过滤数据</h2><p id="ea57" class="pw-post-body-paragraph jd je hh jf b jg mw ii ji jj mx il jl jm my jo jp jq mz js jt ju na jw jx jy ha bi translated">如果我们需要使用多个条件进行过滤，我们可以使用逻辑运算符。请注意这里的逻辑运算符，<code class="du lj lk ll lm b">AND</code> : <code class="du lj lk ll lm b">&amp;</code>，<code class="du lj lk ll lm b">OR</code> : <code class="du lj lk ll lm b">|</code>，<code class="du lj lk ll lm b">NOT</code> : <code class="du lj lk ll lm b">!</code>。在给定的数据框架中，我们在“东北”州和“埃里克森”市只有一家倒闭银行。</p><pre class="lo lp lq lr fd nc lm nd ne aw nf bi"><span id="dcd6" class="mb mc hh lm b fi ng nh l ni nj">df2 = df.where((df['ST'] == 'NE') &amp; (df['City'] == 'Ericson'))<br/>df2.show(3)</span></pre><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es od"><img src="../Images/86bc548e5dd28537fe8485cf7eb0f6c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*WyfVZl_v7qy_p83kMrce1Q.png"/></div></figure><h2 id="f4b8" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">14.强制转换数据类型</h2><p id="11ea" class="pw-post-body-paragraph jd je hh jf b jg mw ii ji jj mx il jl jm my jo jp jq mz js jt ju na jw jx jy ha bi translated">通常我们需要改变特定变量的数据类型。当我们使用文本文件创建数据帧时，由于数据中的一些错误/缺失，可能会出现数据类型不匹配的情况。我们可以根据需要将其转换为不同的数据类型。我们稍后将处理日期类型。请注意下面将数据类型转换为字符串的两种方法。我们也可以在转换后的变量中使用相同的变量名。</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="lu lv l"/></div></figure><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es oe"><img src="../Images/6202e316275becb532ef5dbed3ee6afd.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*kCjCIMbowTN5ppLg0lF-IA.png"/></div></figure><h2 id="45ff" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">15.联合</h2><p id="3f30" class="pw-post-body-paragraph jd je hh jf b jg mw ii ji jj mx il jl jm my jo jp jq mz js jt ju na jw jx jy ha bi translated"><code class="du lj lk ll lm b">Coalesce</code>是我在学习SQL之后开始频繁使用的一个词。在某些情况下，我们需要用一个常数或者同一数据中的另一列来替换一些包含空值的列。我们可以使用<code class="du lj lk ll lm b">CASE</code>语句来优先替换空值，或者使用<code class="du lj lk ll lm b">coalesce</code>派上用场。</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="lu lv l"/></div></figure><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es of"><img src="../Images/4d03d8282d08169e5651fc0f8dd90a67.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*KcQ3_mKPt7Gt81uPqUdmEg.png"/></div></figure><h2 id="d4ec" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">16.替换数据帧中的值</h2><p id="ef4e" class="pw-post-body-paragraph jd je hh jf b jg mw ii ji jj mx il jl jm my jo jp jq mz js jt ju na jw jx jy ha bi translated">替换数据帧中的所有值</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="lu lv l"/></div></figure><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es og"><img src="../Images/445ae94d6680b63c35585062c13d9636.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*pcJV5xNCo0-Gs3m1BoR-1A.png"/></div></figure><h2 id="3be9" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">17.排序值</h2><p id="6a2b" class="pw-post-body-paragraph jd je hh jf b jg mw ii ji jj mx il jl jm my jo jp jq mz js jt ju na jw jx jy ha bi translated">数据帧中的排序</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="lu lv l"/></div></figure><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es oh"><img src="../Images/e5db153475bedcda924e9b64579374b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/format:webp/1*l5fK0E-s8oy_vr2vuCxbEw.png"/></div></figure><p id="9de0" class="pw-post-body-paragraph jd je hh jf b jg jh ii ji jj jk il jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">这部分就这些了。我将上传另一节关于日期格式，串联，跨表和空值处理。请留下您的评论/反馈。</p></div><div class="ab cl iw ix go iy" role="separator"><span class="iz bw bk ja jb jc"/><span class="iz bw bk ja jb jc"/><span class="iz bw bk ja jb"/></div><div class="ha hb hc hd he"><p id="4675" class="pw-post-body-paragraph jd je hh jf b jg jh ii ji jj jk il jl jm jn jo jp jq jr js jt ju jv jw jx jy ha bi translated">下面是包含完整笔记本的colab笔记本和github资源库的链接。</p><div class="kj kk ez fb kl km"><a href="https://github.com/akash865/spark_101/blob/master/Spark_101_DataManipulation.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="kn ab dw"><div class="ko ab kp cl cj kq"><h2 class="bd hi fi z dy kr ea eb ks ed ef hg bi translated">akash865/spark_101</h2><div class="kt l"><h3 class="bd b fi z dy kr ea eb ks ed ef dx translated">火花基本代码。在GitHub上创建一个帐户，为akash865/spark_101开发做出贡献。</h3></div><div class="ku l"><p class="bd b fp z dy kr ea eb ks ed ef dx translated">github.com</p></div></div><div class="kv l"><div class="oi l kx ky kz kv la lb km"/></div></div></a></div><div class="kj kk ez fb kl km"><a href="https://colab.research.google.com/drive/1yJof33vdHqzFejqX_e8_gm0jRw-sfk6j?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="kn ab dw"><div class="ko ab kp cl cj kq"><h2 class="bd hi fi z dy kr ea eb ks ed ef hg bi translated">谷歌联合实验室</h2><div class="kt l"><h3 class="bd b fi z dy kr ea eb ks ed ef dx translated">编辑描述</h3></div><div class="ku l"><p class="bd b fp z dy kr ea eb ks ed ef dx translated">colab.research.google.com</p></div></div><div class="kv l"><div class="oj l kx ky kz kv la lb km"/></div></div></a></div></div><div class="ab cl iw ix go iy" role="separator"><span class="iz bw bk ja jb jc"/><span class="iz bw bk ja jb jc"/><span class="iz bw bk ja jb"/></div><div class="ha hb hc hd he"><h2 id="ed7c" class="mb mc hh bd md me mf mg mh mi mj mk ml jm mm mn mo jq mp mq mr ju ms mt mu mv bi translated">参考资料:</h2><ol class=""><li id="39aa" class="ok ol hh jf b jg mw jj mx jm om jq on ju oo jy op oq or os bi translated">Spark SQL函数库[<a class="ae ki" href="https://spark.apache.org/docs/latest/api/java/org/apache/spark/sql/functions.html" rel="noopener ugc nofollow" target="_blank">https://spark . Apache . org/docs/latest/API/Java/org/Apache/spark/SQL/functions . html</a></li></ol></div></div>    
</body>
</html>