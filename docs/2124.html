<html>
<head>
<title>RustID: Rust Identification in African Wheat Plants</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">锈病:非洲小麦植株中的锈病鉴定</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/rustid-rust-identification-in-african-wheat-plants-7243936e1129?source=collection_archive---------21-----------------------#2021-04-05">https://medium.com/analytics-vidhya/rustid-rust-identification-in-african-wheat-plants-7243936e1129?source=collection_archive---------21-----------------------#2021-04-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="b15f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">小麦叶锈病是一种毁灭性的疾病，影响着数百万非洲农民的农作物。及早发现这种植物疾病每年可以节省数吨农产品。这不仅有利于减少饥饿人口，也有利于农民，确保他们获得应得的收成。我的好朋友Rohan Rajpal、T2、Tejas Oberoi和我致力于解决这个问题，并参加了ICLR研讨会挑战1:CGIAR 2020年农作物疾病计算机视觉。<strong class="ig hi">我们在847个参与团队中排名第39位，我们的模型实现了0.265的竞争对数损失。</strong></p><p id="169c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了应对这一挑战，我们提出了一种深度学习算法，该算法给定植物的图像，对植物是否健康、是否患有茎锈病或是否患有叶锈病进行分类。我们探索了各种最先进的模型，并提出了我们自己的改进的DenseNet模型。我们的实验探索了我们的模型在各种烧蚀下的性能。</p><p id="2270" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">完整报告可在此处获得—<a class="ae je" href="https://drive.google.com/file/d/1xbDBYw164tbQa0gD8RFvv1zGshEzIb7q/view" rel="noopener ugc nofollow" target="_blank">https://drive . Google . com/file/d/1 xbdbyw 164 tbqa 0 GD 8 RF vv1 zgshezib7q/view</a></p><h1 id="e9ff" class="jf jg hh bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated"><strong class="ak">问题陈述</strong></h1><p id="53c6" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kf ir is it kg iv iw ix kh iz ja jb ha bi translated">该挑战的目标是建立一个深度学习算法，以正确分类小麦植物是健康的、有茎锈病还是有叶锈病。可能是这样的情况，一些图像既有茎锈病又有叶锈病。目标是根据图像中小麦锈病的主要类型对图像进行分类。在图1中可以看到这三个类别的样本图像。</p><div class="ki kj kk kl fd ab cb"><figure class="km kn ko kp kq kr ks paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/52edf48794194ceb00a103cdb85697a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*cvbaomZ_bIfLzcfkll6pKQ.png"/></div></figure><figure class="km kn kz kp kq kr ks paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/98f3f9bae737386a183c2494f4df3a5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*inJUvmEriHiybGweMcJMaw.png"/></div></figure><figure class="km kn la kp kq kr ks paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><img src="../Images/c6b535b91d312e1d2e00f750a22393e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*QGym8DbSgPwbGt_xbWlbvQ.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx lf di lg lh translated">描述(I)茎锈病感染的(ii)叶锈病感染的(iii)健康小麦植物的样本图像</figcaption></figure></div><h1 id="cef5" class="jf jg hh bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">资料组</h1><p id="8fe2" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kf ir is it kg iv iw ix kh iz ja jb ha bi translated"><strong class="ig hi">分配</strong></p><figure class="ki kj kk kl fd kn er es paragraph-image"><div class="er es li"><img src="../Images/a2fb11eacf4e6cd4355125b18736b4bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*u4EAqjgBORtuX4aF2IJiTQ.png"/></div></figure><p id="757c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">训练集中有876个图像，测试集中有610个图像。我们对原始训练集进行了分层随机采样，训练值分割为80:20，以获得由700幅图像组成的新训练集和由176幅图像组成的验证集。</p><p id="2dca" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">分析</strong></p><figure class="ki kj kk kl fd kn er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lj"><img src="../Images/f0add877bf7303ba7feabe222926a3c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VJ-8ryUpSwAIA7hRwZ1F1g.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">通道值的分布</figcaption></figure><p id="d2c5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">分析了图像的RGB通道值(参见上图)。发现通道值具有以106为中心的大致正态分布。最大通道激活为255。这意味着平均通道值小于最大值的一半，这表明大多数时间通道的激活程度很低。</p><figure class="ki kj kk kl fd kn er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es lk"><img src="../Images/0bba7e7b765265da274d50df56678e22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kmGra9CqAg9HYRHJotb3Mg.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">平均值与颜色通道图</figcaption></figure><p id="1bd6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上图显示了平均值与颜色通道的统计数据。方框下端表示q1，中间线表示中位数，方框上端表示q3。Q1是数据下半部分的中间值，Q3是数据上半部分的中间值。绿色是最明显的通道，中值为122，其次是红色，中值为114.5，蓝色为81.5。</p><h1 id="a63d" class="jf jg hh bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">方法学</h1><p id="3688" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kf ir is it kg iv iw ix kh iz ja jb ha bi translated"><strong class="ig hi">设计选择</strong></p><p id="31b7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因为我们为训练集提供了正确的标签，所以我们把这个问题作为一个监督学习问题来处理。我们的目标是构建一个端到端的深度学习模型，该模型提供小麦植株在其茎或叶上生锈的概率。我们通过<br/> 1来处理<br/>这个问题。我们在整个DL课程中学到的培训架构，如ResNet、DenseNet等。通用培训范例。<br/> 2。探索不在我们课程材料中的艺术状态(EfficentNet)。<br/> 3。用不同的训练范例探索不同的架构。</p><p id="fed3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">模型选择策略如下进行。首先，使用一组默认范例，我们训练了3.3.4节中提到的模型。根据我们为其训练模型的训练范例，我们从中选择了最佳模型。<br/> 2。接下来，在选定的模型上进行各种消融。</p><p id="abb4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们做了以下实验-</p><p id="b48b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">架构— ResNet、SE-ResNeXt、DenseNet、EfficientNet</p><p id="f6d2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">增强——垂直和水平翻转(随机图像在数据集中被<br/>垂直和水平翻转)、Augmix、mix、Cutmix。</p><p id="2768" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">优化者—亚当、R-亚当、护林员</p><p id="6af7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">测试时间增加</strong></p><p id="822d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们还采用了测试时间增强(TTA)，其目的是对测试图像进行随机修改。我们将多次向模型显示增强图像，而不是只向训练过的模型显示一次常规的“干净”图像。我们将平均所有相应预测的预测，然后平均每个cor- <br/>响应图像的预测，并将其作为我们的最终猜测。</p><p id="54e7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">评估</strong></p><p id="c71c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">训练程序</strong> <br/>首先，为了准备验证集，我们分层分割训练集并执行5重交叉验证。接下来，在我们的模型管道中，图像被随机地垂直、水平或90度翻转。我们还通过使用余弦退火来改变我们的学习速率。在余弦退火中，最初学习速率保持较高。当模型接近局部最小值时，学习率相应地降低。对于所有模型，我们使用预训练的权重(在ImageNet上训练)初始化模型。我们使用的最大学习率为0.001，最小学习率为0.00002。</p><h1 id="5056" class="jf jg hh bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated">结果</h1><p id="6302" class="pw-post-body-paragraph ie if hh ig b ih kd ij ik il ke in io ip kf ir is it kg iv iw ix kh iz ja jb ha bi translated"><strong class="ig hi">最佳模特</strong></p><figure class="ki kj kk kl fd kn er es paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="er es ll"><img src="../Images/5fc24afa59aef1ce7a5f870da20e7093.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a14_vweY83F9Pz0fk2aIGw.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">DenseNet-201的体系结构在CGIAR数据集上提供了最佳性能。在典型的DenseNet-201架构中，我们添加了批量标准化层和一个丢弃层。</figcaption></figure><p id="6770" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">DenseNet-201架构产生了最佳性能。修改包括在每个卷积层块后增加一个批量归一化层和一个0.5的丢弃层[参见图5]。其次，我们用0.001的最大学习率训练前三个块，用0.00002的学习率训练后两个块。我们这样做的理由是，对于我们的数据集来说，较低级别的特征更加精细，这种变化可能会反映在较高级别的特征本身中。因此，需要较低的学习速率来微调较高级的特征。我们试验了上面提到的增强和优化。我们观察到，在β1 = 0.999和β2 = 0.9的默认设置下，Adam优化器的性能优于R-Adam。最好的改性DenseNet-201在0.265处产生对数损失(参见下表)。表2列出了与其他基线一起获得的最终结果。我们使用改进的DenseNet-201架构击败了最先进的efficient net-B6。尽管需要注意的是，EfficientNet并不是为这一特定任务而设计的。</p><figure class="ki kj kk kl fd kn er es paragraph-image"><div class="er es lm"><img src="../Images/b458575a84b0fd4bb8aa065492054722.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*41aIpTJUIWOCaIPPuD8VTA.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">改良DenseNet-201的损失图，验证损失在20个时期后趋于稳定。</figcaption></figure><figure class="ki kj kk kl fd kn er es paragraph-image"><div class="er es ln"><img src="../Images/8e5992c7210a1af49332000bd9bf2c22.png" data-original-src="https://miro.medium.com/v2/resize:fit:488/format:webp/1*Goska1NMbTzpThObOkwXfw.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">所有基准测试集和修改后的DenseNet-201模型的综合性能。</figcaption></figure><p id="ffee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">分类分离</strong></p><figure class="ki kj kk kl fd kn er es paragraph-image"><div class="er es lo"><img src="../Images/0c264f2981ba6fa71e24a12a8790200a.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*s2DrKxSd0uCskrGgJPMTZQ.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">验证样本特征的TSNE可视化，描述验证样本的可分离性。红色、蓝色和绿色分别代表健康的小麦、叶锈病和茎锈病。</figcaption></figure><p id="0975" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们还在验证集上可视化了我们的模型所获得的特征，如上图所示。我们的结论是，我们的模型可以有效地将样本分为上述类别。</p><p id="55d8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">班级表现</strong></p><p id="7364" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们检验了类的wise性能，发现健康小麦类是最好的分类类，其次是叶锈病和茎锈病。我们在验证集上获得了92.57%的总体准确率。</p><figure class="ki kj kk kl fd kn er es paragraph-image"><div class="er es lp"><img src="../Images/c3e4ab410942a28dd4ff0f66b2ec3065.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*5Ko2kl1k7Cg3GSVileGUww.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">不同班级的表现。(精确度以百分比表示)</figcaption></figure><figure class="ki kj kk kl fd kn er es paragraph-image"><div class="er es lq"><img src="../Images/82c373f9017fc81fd1d5191262cafe51.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*6J1isxUiAi_E2L-ok_pPXg.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">最终改进的DenseNet-201架构的混淆矩阵。0、1和2分别代表健康小麦、叶锈病和茎锈病类别。该模型最好地识别健康的植物。</figcaption></figure><h1 id="c606" class="jf jg hh bd jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc bi translated"><strong class="ak">消融</strong></h1><ol class=""><li id="652f" class="lr ls hh ig b ih kd il ke ip lt it lu ix lv jb lw lx ly lz bi translated"><strong class="ig hi">分层分割增加了损失:</strong>在应用分层分割制作验证集时，我们观察到测试集的对数损失增加了0.23。这可能是因为测试集本身是不平衡的。或者，我们的模型可能更擅长学习一个类。</li><li id="e65a" class="lr ls hh ig b ih ma il mb ip mc it md ix me jb lw lx ly lz bi translated"><strong class="ig hi">过采样增加了损失:</strong>过采样健康小麦类极大地增加了测试和验证集的对数损失，尽管它减少了训练损失，这表明向<br/>模型添加许多副本可能会导致过拟合。</li><li id="b0e2" class="lr ls hh ig b ih ma il mb ip mc it md ix me jb lw lx ly lz bi translated"><strong class="ig hi">余弦退火的效果:</strong>余弦退火略微提高了性能，降低了0.07的损耗。</li><li id="881a" class="lr ls hh ig b ih ma il mb ip mc it md ix me jb lw lx ly lz bi translated"><strong class="ig hi">垂直翻转实际上减少了对数损失:</strong>最初，由于上图中的图像清楚地区分了天空和草地，我们预计垂直翻转图像可能会增加损失。然而，相反的情况发生了，我们注意到损失实际上减少了。这可能是因为像这样的图像可能会添加非常需要的噪声，从而改进模型。</li><li id="ebad" class="lr ls hh ig b ih ma il mb ip mc it md ix me jb lw lx ly lz bi translated"><strong class="ig hi">混合增强表现最好:</strong>在提到的增强中，混合增强表现最好。这可能是因为，使用Cutmix可能会导致im- <br/> ages的错误随机补丁被打乱(例如，生锈的茎可能会替换另一个图像中的健康茎。)</li><li id="37f1" class="lr ls hh ig b ih ma il mb ip mc it md ix me jb lw lx ly lz bi translated"><strong class="ig hi">试验时间增加(TTA)改善了试验对数损失:</strong>利用试验时间增加将改良DenseNet-201的试验损失降低了0.17。测试集上使用的扩充与训练和验证集上使用的扩充完全相同。</li></ol><figure class="ki kj kk kl fd kn er es paragraph-image"><div class="er es mf"><img src="../Images/2d45950f54a0a2e1712671a1649ee530.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*J8KaStQzttMAMIzY8HKoSA.png"/></div></figure></div></div>    
</body>
</html>