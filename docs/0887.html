<html>
<head>
<title>Predicting molecular properties</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测分子性质</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predicting-molecular-properties-cc278b4927a9?source=collection_archive---------28-----------------------#2021-02-04">https://medium.com/analytics-vidhya/predicting-molecular-properties-cc278b4927a9?source=collection_archive---------28-----------------------#2021-02-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/86c59192d53d5adfa54e3f3ee5efe4a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*zQkcF5-JHyh_kzpQDjw40g.png"/></div></figure><p id="c99b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">机器学习可能是我们这一代最通用的技术工具。给定足够的数据和适当的算法，我们可以将ML应用于我们能想到的任何问题；二手车值多少钱？基于受教育年限的平均收入是多少？或者，如果我的狗是一只7岁的哈士奇，我应该遛狗多长时间？</p><p id="f7b3" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这是我通过这个项目想要回答的问题；我们能根据一种材料的分子组成和几何形状来预测它的性质吗？更具体地说，我们追求的性质是带隙能和形成能。尽管深入研究它们的技术细节对于理解我的方法来说并不是必要的，但足以说明它们在确定材料的透明度、导电性、稳定性和制造成本时是重要的。</p><p id="b12c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">讨论中的化合物由4种元素(铝、镓、铟和氧)组成，遵循一个特定的化学式，但我们也不会深究。我应该指出的是，<a class="ae jj" href="https://www.kaggle.com/c/nomad2018-predict-transparent-conductors" rel="noopener ugc nofollow" target="_blank">数据集</a>不包括任何关于分子中氧的信息。不管怎样，我们为什么要在乎呢？嗯，这些分子结合在一起，创造出导体作为最终的材料，这就是现代社会的积木！</p><p id="8c4e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这些是我在这次探索中采取的主要步骤:</p><ol class=""><li id="e9e5" class="jk jl hh in b io ip is it iw jm ja jn je jo ji jp jq jr js bi translated">数据“清理”</li><li id="5b14" class="jk jl hh in b io jt is ju iw jv ja jw je jx ji jp jq jr js bi translated">定义培训数据和目标</li><li id="117a" class="jk jl hh in b io jt is ju iw jv ja jw je jx ji jp jq jr js bi translated">定义、训练和评分模型</li><li id="4b35" class="jk jl hh in b io jt is ju iw jv ja jw je jx ji jp jq jr js bi translated">优化、重新训练和重新评分模型</li><li id="13b9" class="jk jl hh in b io jt is ju iw jv ja jw je jx ji jp jq jr js bi translated">可视化结果</li></ol><h2 id="d0f2" class="jy jz hh bd ka kb kc kd ke kf kg kh ki iw kj kk kl ja km kn ko je kp kq kr ks bi translated">数据清理</h2><p id="b45f" class="pw-post-body-paragraph il im hh in b io kt iq ir is ku iu iv iw kv iy iz ja kw jc jd je kx jg jh ji ha bi translated">与任何ML项目一样，第一步是将我的数据加载到pandas数据框架中。数据一开始是相当干净的，但是减少打字量总是在我的任务列表中，所以我重新命名了一切！关于特征工程，以下是实现的变化:</p><ul class=""><li id="38a7" class="jk jl hh in b io ip is it iw jm ja jn je jo ji ky jq jr js bi translated"><strong class="in hi">增加了三种元素的{elem}_atoms </strong>和<strong class="in hi">减少了百分比_atom_{elem} </strong>栏；分子中特定元素的百分比似乎不如该元素在分子中的原子总数有用。</li><li id="472c" class="jk jl hh in b io jt is ju iw jv ja jw je jx ji ky jq jr js bi translated"><strong class="in hi">添加元素比率(Al:Ga，Al:In，In:Ga) </strong>并用给定列中的最大值替换其未定义的值；任何给定元素相对于整个分子的数量都很重要，但我想考虑元素之间的相互关系。</li></ul><p id="b891" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">你可能会问自己，为什么我用最大值代替平均值或者使用简单估算？在这些情况下，比值没有多大意义，因为其中一种元素根本不存在于分子中。然而，我的未定义值实际上是np.inf(无穷大)，这意味着我将<em class="kz">某个</em>数(<strong class="in hi">任何</strong>实数)除以0。尽可能从字面上理解，我想在不扭曲数据的情况下使这些值<em class="kz">变大</em>，因此我决定给定列的最大值将优于平均值。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es la"><img src="../Images/3875212a867d447a4b7a17d0f71a4e4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wRydC6it727QmWKvhJVg2w.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">train.head()</figcaption></figure><h2 id="9bed" class="jy jz hh bd ka kb kc kd ke kf kg kh ki iw kj kk kl ja km kn ko je kp kq kr ks bi translated">定义培训数据和目标</h2><p id="f121" class="pw-post-body-paragraph il im hh in b io kt iq ir is ku iu iv iw kv iy iz ja kw jc jd je kx jg jh ji ha bi translated">因为我的数据帧被清楚地标记并且容易理解，所以这一步非常简单。我将目标和数据定义如下:</p><p id="b533" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><em class="kz"> y1 = 'bg_energy' </em></p><p id="99e0" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><em class="kz"> y2 = 'f_energy' </em></p><p id="6e67" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><em class="kz"> X =其他一切</em></p><p id="75e7" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">作为最后一步，我使用总是很方便的train_test_split函数创建了最终的训练和验证集。</p><h2 id="796d" class="jy jz hh bd ka kb kc kd ke kf kg kh ki iw kj kk kl ja km kn ko je kp kq kr ks bi translated">定义、训练和评分模型</h2><p id="caeb" class="pw-post-body-paragraph il im hh in b io kt iq ir is ku iu iv iw kv iy iz ja kw jc jd je kx jg jh ji ha bi translated">目标都是连续值，训练集不包括任何分类特征/变量，即。都是很好的正数！我选择了这4个回归模型作为我的预测器:</p><p id="efd2" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><a class="ae jj" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html" rel="noopener ugc nofollow" target="_blank"> <em class="kz">线性回归</em> </a></p><p id="5bbd" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><a class="ae jj" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Ridge.html" rel="noopener ugc nofollow" target="_blank"> <em class="kz">山脊</em> </a></p><p id="36fc" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><a class="ae jj" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html" rel="noopener ugc nofollow" target="_blank"> <em class="kz">随机森林</em> </a></p><p id="9ebb" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><a class="ae jj" href="https://xgboost.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank"> <em class="kz"> XGB回归器</em> </a></p><p id="c5dc" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在定义这些模型后，我用我的训练数据(基本上只是X1，y1，y2的子集)拟合它们，而不使用任何特定的参数来衡量模型开箱即用的表现有多好。我使用两个指标对它们进行了评估:</p><p id="35b2" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><a class="ae jj" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.mean_absolute_error.html" rel="noopener ugc nofollow" target="_blank">平均绝对误差</a></p><p id="05e7" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><a class="ae jj" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.r2_score.html" rel="noopener ugc nofollow" target="_blank"> R分数</a></p><h2 id="e43c" class="jy jz hh bd ka kb kc kd ke kf kg kh ki iw kj kk kl ja km kn ko je kp kq kr ks bi translated">优化、重新训练和重新评分模型</h2><p id="261c" class="pw-post-body-paragraph il im hh in b io kt iq ir is ku iu iv iw kv iy iz ja kw jc jd je kx jg jh ji ha bi translated">在任何分析中，调整模型参数都是最耗时的步骤之一，这也不例外。我使用了<a class="ae jj" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.model_selection.RandomizedSearchCV.html" rel="noopener ugc nofollow" target="_blank">randomsearccv</a>函数来优化模型(对于线性和可能的脊形来说肯定是过度的)，之后我用RSCV给出的最佳参数重新训练了我的模型。</p><h2 id="ddf2" class="jy jz hh bd ka kb kc kd ke kf kg kh ki iw kj kk kl ja km kn ko je kp kq kr ks bi translated">可视化结果</h2><p id="9b5d" class="pw-post-body-paragraph il im hh in b io kt iq ir is ku iu iv iw kv iy iz ja kw jc jd je kx jg jh ji ha bi translated">下面有不少图，但总比通读文字好！</p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es ln"><img src="../Images/cc099b8e57fa21717f819d2eb2c19e46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dO1mgqTZZT9YlsU2LhysUA.png"/></div></div></figure><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lo"><img src="../Images/0a1525ca3de69b2dbab361a2a145186c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PsyoL760j1q8DNSO9HCgFQ.png"/></div></div></figure><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lp"><img src="../Images/3aa2159f5c7964cb46723ce8974283c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_yyRxa5eLhEIXZLzS6QLgQ.png"/></div></div></figure><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lq"><img src="../Images/43e5f7744aeaccbf1b9cd28be62db7c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WgY9evMIQcjUuXzF3eppxg.png"/></div></div></figure><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lr"><img src="../Images/cda40a3033f76750fea53bea89ceb5c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NvykbkV0vi6x9gYxPECDdQ.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">地层能量分数(验证集)</figcaption></figure><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es ls"><img src="../Images/1ce2766cdcf5b0a8465cced4f1c1a4f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B_75kc5DcxCMxVNjaQMvbQ.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">地层能量分数(训练集)</figcaption></figure><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lt"><img src="../Images/0c11770867808edd52711dd860030ea2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mZFGCpK1ZOB0KpvtJQ-6yQ.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">带隙能量分数(验证集)</figcaption></figure><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lu"><img src="../Images/efb0d03da91f7c71f4915f4f9fdf39f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RLU0lkcjDQr441Mfo9k6MQ.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">带隙能量分数(训练集)</figcaption></figure><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lv"><img src="../Images/9095908fd4e886214c44bc5f1988862a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n72M5vsbqnR73i9A0Yp4jA.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">铝铟比与带隙能量</figcaption></figure><figure class="lb lc ld le fd ii er es paragraph-image"><div class="er es lw"><img src="../Images/c5dcccacccde45342009303e7e403251.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*lu1rnmF3RIq35r9KJGmfqg.png"/></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">铝镓比率和铟镓比率与带隙能量</figcaption></figure><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lx"><img src="../Images/74c1f5dec20534ef6396a6bd2bb5c499.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6VKQlsVr14RhSk38ffLzAw.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">铝铟比与地层能量</figcaption></figure><figure class="lb lc ld le fd ii er es paragraph-image"><div class="er es ly"><img src="../Images/6ee4fc1389bcf1816fba46b41e81d06c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*7uD5xlIQrf4if_32YP3k-w.png"/></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">铝镓比和铟镓比与地层能量</figcaption></figure><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es lz"><img src="../Images/8ec238c9d26ef26ce2e0332c4ec337d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8pB8Pa68jqU5RucuVEyKuw.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">带隙能量形状图</figcaption></figure><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="er es ma"><img src="../Images/eb6f88c40b5bce130576cfb36e6f87b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2AmOK3WVZb-DTGZqrmf9DQ.png"/></div></div><figcaption class="lj lk et er es ll lm bd b be z dx translated">地层能量形状图</figcaption></figure><h2 id="f83f" class="jy jz hh bd ka kb kc kd ke kf kg kh ki iw kj kk kl ja km kn ko je kp kq kr ks bi translated">结束语</h2><p id="9238" class="pw-post-body-paragraph il im hh in b io kt iq ir is ku iu iv iw kv iy iz ja kw jc jd je kx jg jh ji ha bi translated">和科学数据探索一样，我不知道我会发现什么。然而，在使用了一些ML算法并将结果可视化后，我可以自信地说，在确定带隙和形成时，元素之间的比率比它们的绝对量更重要。也许更重要的是，似乎化合物的空间几何在决定其性质方面比其组成起着更大的作用。</p><p id="b96a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我将继续寻找数据来阐述这些发现。</p><p id="93a1" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">下次见！</p><p id="7cc4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><em class="kz">有问题吗？只是想聊聊天？留言评论！</em></p><p id="684b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><em class="kz">或者这里联系我:</em><a class="ae jj" href="https://www.linkedin.com/in/ricardo-a-rodriguez-f/" rel="noopener ugc nofollow" target="_blank"><em class="kz">LinkedIn</em></a><em class="kz"/><a class="ae jj" href="https://github.com/reesh19" rel="noopener ugc nofollow" target="_blank"><em class="kz">GitHub</em></a></p></div></div>    
</body>
</html>