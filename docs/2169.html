<html>
<head>
<title>Linear Regression: The maths behind it, how it works, and an example</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">线性回归:背后的数学，它是如何工作的，以及一个例子</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/linear-regression-the-maths-behind-it-how-it-works-and-an-example-c911a66f02bd?source=collection_archive---------4-----------------------#2021-04-09">https://medium.com/analytics-vidhya/linear-regression-the-maths-behind-it-how-it-works-and-an-example-c911a66f02bd?source=collection_archive---------4-----------------------#2021-04-09</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="eb24" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">线性回归可能是您在开始数据科学学习之旅时遇到的第一个算法，猜猜会发生什么？我也是，很可能其他人也是。这是理解和应用起来最简单的算法之一。</p><p id="7fc7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们从数学开始，我知道这不是整个数据科学有趣的部分，但它和其他任何东西一样重要。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/d0916008cc3a702148eba62b8a9df4d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vCwX5dfX29pFhn4X"/></div></div></figure><p id="0bee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们把这个等式分解成容易理解的部分:</p><ul class=""><li id="be25" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb jt ju jv jw bi translated">y :否则也可以称为y-hat(可能看起来像ŷ)是因变量，基本上是我们试图预测的东西。</li><li id="8123" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb jt ju jv jw bi translated"><strong class="ig hi"> b0 </strong>:这是y轴上斜率相交的点，在机器学习术语中，这被称为偏差。</li><li id="b4ae" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb jt ju jv jw bi translated"><strong class="ig hi"> b1: </strong>称为系数或权重，作为模型参数并赋给<strong class="ig hi"> х </strong>。系数描述了因变量和自变量之间的关系，所以如果它是负的，那么就有一个反比关系。如果是肯定的，那么就有直接的关系。</li><li id="0c06" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb jt ju jv jw bi translated"><strong class="ig hi"> x1 </strong>:这是自变量，也称为特征。这是直接影响因变量的变量，也是我们试图找到关系的地方。它的范围可以从对因变量的强烈影响到完全没有影响。</li></ul><p id="e52c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">还不算太糟，是吧？线性回归是人们用来寻找一个因变量和一个或多个自变量之间的线性(牛津语言将线性定义为沿着一条直线或接近直线排列或延伸的<em class="kc">)的途径。这用一个斜率(一条直线)来表示，以映射变量之间的关系。</em></p><p id="195d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，在很大程度上，这是最简单的线性回归形式，但在现实中，如果不是永远，你会在99.99%的时间里处理多元线性回归。本质上，它们都以同样的方式工作，除了在多元线性回归的情况下，你有不止一个自变量，比如更多。让我们看看它是什么样子的。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kd"><img src="../Images/d77651dce71990efc8300f3c28d95aa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Cvggxddli4_TXqAJ"/></div></div></figure><p id="ee75" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于简单的线性回归，我们有一个偏差，一个系数和一个独立变量。对于多元线性回归，顾名思义，我们有——多元。如上图所示，我们有多个独立变量，每个变量都有自己的偏差。</p><p id="2551" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里有一张图来形象地说明这两个公式之间的区别。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ke"><img src="../Images/e5b6f3313e69243a869d61e15f1eb8ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fr2NtfEx-ZrVMwz4"/></div></div></figure><p id="dc8d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">他们的目标都是一样的——找到所有值的最佳拟合线。在简单线性回归中，这用平面或直线表示，而在多元线性回归中，这用超平面表示。</p><p id="3abe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了知道我们的最佳拟合线/平面是否可行，我们需要知道预测值和实际值之间的差异有多大，以便尽可能小。为了实现这一点，我们需要找到每个独立变量/特征的权重。Scikit-learn采用的线性回归使用了一种称为普通最小二乘法的方法，尽管还有其他方法我们不会在本指南中讨论。这是通过四个主要步骤完成的:</p><ol class=""><li id="50ea" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb kf ju jv jw bi translated">首先，我们随机地给权重赋值，这听起来可能有点武断，因为事实就是如此。</li><li id="ec23" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kf ju jv jw bi translated">我们将随机变量插入线性方程，然后为每个值生成一个预测。</li><li id="25d5" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kf ju jv jw bi translated">使用残差平方和计算损失，基本上，找出实际产量和预测产量之间的差异，数字应该类似于(实际值-预测值)。然后我们将它们平方，最后将所有的值相加，这将返回我们的剩余平方和。</li><li id="feba" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kf ju jv jw bi translated">重复，直到我们达到最小值。</li></ol><p id="540d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来应该会出现一个明显的问题:我们如何得到最小残差平方和呢？为此，我们使用了梯度下降法。</p><p id="3319" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">顾名思义，我们要做的是根据权重找到函数的梯度/斜率。重复这个过程，直到我们达到可达到的最小误差。</p><p id="dd54" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">按说在这之后，我们应该有一个好的模型，我们需要评估它有多好。线性回归有许多可以使用的指标:</p><ol class=""><li id="510e" class="jo jp hh ig b ih ii il im ip jq it jr ix js jb kf ju jv jw bi translated">r平方:解释模型产生的方差与实际方差的比较，范围为0到1。越接近1越好。</li><li id="034b" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kf ju jv jw bi translated">均方误差:这是所有误差的平方根的平均值。这给出了总体平均误差。</li><li id="d9d2" class="jo jp hh ig b ih jx il jy ip jz it ka ix kb jb kf ju jv jw bi translated">均方根误差:与均方误差相同，但在其上加了一个根，以产生一个更可读的误差范围。</li></ol><p id="bebc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">线性回归不能用于任何数据集，但尽管如此，它可以用来解决很多问题。因此，从属值必须是连续值，如基于教育程度的工资、基于面积和邮政编码的房价、基于营销预算和价格等因素的销售额，等等。</p></div></div>    
</body>
</html>