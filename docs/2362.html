<html>
<head>
<title>Understanding Oscillators (Python)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解振荡器(Python)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/understanding-oscillators-python-2813ec38781d?source=collection_archive---------3-----------------------#2021-04-20">https://medium.com/analytics-vidhya/understanding-oscillators-python-2813ec38781d?source=collection_archive---------3-----------------------#2021-04-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="b07d" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated"><strong class="ak">从简谐振动直观到微分方程的数值解。</strong></h2></div></div><div class="ab cl ix iy gp iz" role="separator"><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc jd"/><span class="ja bw bk jb jc"/></div><div class="hb hc hd he hf"><p id="c00f" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi ka translated"><span class="l kb kc kd bm ke kf kg kh ki di">简谐振子是物理学中最基本的现象之一。它本质上描述了附在弹簧上的质量的运动。描述其行为的方程是牛顿第二定律和胡克定律相结合的结果，这两个定律都是力的概念的定义。</span></p><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es kj"><img src="../Images/183ddf8db527b826991c5a96ab60b21c.png" data-original-src="https://miro.medium.com/v2/resize:fit:372/format:webp/1*h_k0J0pIplBqFcUWHlkhqQ.png"/></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">牛顿第二定律。等式(1)</figcaption></figure><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es kv"><img src="../Images/437c4aae46ba33653c091dc2ca77c307.png" data-original-src="https://miro.medium.com/v2/resize:fit:316/format:webp/1*zTgtbGaMyhf2sGPhrruOKA.png"/></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">胡克定律。等式(2)</figcaption></figure><p id="ecb3" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">将牛顿定律代入胡克定律，得到简谐振子微分方程:</p><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es kw"><img src="../Images/9054c1b3dfabbba35d04e36bcd8504db.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*xQLHwQeYHDx9isH-RajBfA.png"/></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">其中，ω平方= √k/m。等式(3)</figcaption></figure><p id="b727" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">瞧啊。如此简单的公式，在牛顿力学中却如此有用。</p><p id="dece" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">微分方程既可以解析求解(如果解是精确的)，也可以数值求解(如果解没有精确的形式)。该方程的解可以通过分析找到，其一般形式为:</p><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es kx"><img src="../Images/852d55bf9b7118d4e26468b3527fadbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*9YLpWjYg76E2DRQGssjQFA.png"/></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">三角函数的线性叠加，其中A和B是振幅常数。等式(4)</figcaption></figure><p id="6c61" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我推荐在提供工具来绘制它们的网站上使用这些函数，比如<a class="ae ky" href="https://www.desmos.com/?lang=en" rel="noopener ugc nofollow" target="_blank">德斯莫斯</a>。这确实有助于获得视觉洞察力，从而增强学习过程。或者，您可以使用Python或您喜欢的编程语言来绘制它们。</p><p id="7a9b" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">记住这个简短的解释，我们将跳到编码方面，在那里我们将使用SciPy库来寻找一个数值解。这种方法的最大优点是它的通用性，因为它可以推广到多种类型的微分方程。</p><h1 id="66bf" class="kz la hi bd lb lc ld le lf lg lh li lj io lk ip ll ir lm is ln iu lo iv lp lq bi translated"><strong class="ak">在Python中</strong></h1><p id="757a" class="pw-post-body-paragraph je jf hi jg b jh lr ij jj jk ls im jm jn lt jp jq jr lu jt ju jv lv jx jy jz hb bi translated">首先，我们导入相关的库。</p><pre class="kk kl km kn fd lw lx ly lz aw ma bi"><span id="32bd" class="mb la hi lx b fi mc md l me mf">import numpy as np <br/>from scipy.integrate import solve_ivp<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>sns.set()</span></pre><p id="300d" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">然后，我们定义时间的积分范围、ω平方的值以及位置(x)和速度(v)的初始值，在这种情况下分别为0和2，如变量<em class="mg"> y </em>所示</p><pre class="kk kl km kn fd lw lx ly lz aw ma bi"><span id="de15" class="mb la hi lx b fi mc md l me mf">t = np.linspace(0,15,1000)<br/>omega_sq = 1<br/>y = [0,2] #y[0]=x and y[1]=v</span></pre><p id="ec8f" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">现在才是有趣的开始。首先，我们将二阶常微分方程分解为两个一阶微分方程。</p><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es mh"><img src="../Images/dfdc10c34ad94422bc4a4e82db9d4fc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*pu6sifAK8b6TjQOJppr0jw.png"/></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">速度是位置相对于时间的变化率。等式(5)</figcaption></figure><p id="af1c" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">然后过程如下，我们定义一个向量，变量被微分，正如你在上面看到的，它们是x和v，都作为时间的函数变化(等式(5))。</p><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es mi"><img src="../Images/ffbf68fd311d8ab8f5fce266f992bf43.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/format:webp/1*Xz6TNNc6peVLJqvCU05zVw.png"/></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">一般定义。等式(6)</figcaption></figure><p id="b5ce" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如果对等式(5)的理解是正确的，那么在一般定义(等式(6))中插入我们的变量是很自然的。</p><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es mj"><img src="../Images/75a2c1f8557cf01ee81bcab64ca0e806.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*QZpsSJQPJNtY1sX11chPoQ.png"/></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">用于我们的例子的一般定义(来自等式(3))</figcaption></figure><p id="f9e1" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">一旦达到这一点，我们只需创建一个返回向量dy/dt的函数，如下面的代码所示</p><pre class="kk kl km kn fd lw lx ly lz aw ma bi"><span id="c40b" class="mb la hi lx b fi mc md l me mf">def harmonic(t,y):<br/>    solution = [y[1],-omega_sq*y[0]]<br/>    return solution</span><span id="90d9" class="mb la hi lx b fi mk md l me mf">sho = solve_ivp(harmonic, [0,1000], y0 = y, t_eval = t)</span></pre><p id="9f7c" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">Solve_ivp是SciPy库的一个函数，它解决了常微分方程组的初值问题，这种情况就发生了。欲了解更多信息，请访问<a class="ae ky" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html" rel="noopener ugc nofollow" target="_blank">在线文档</a>。</p><p id="d826" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">任何初值问题的解都是特定解，对于这种情况，给定之前陈述的初始条件，我们得到与一般解一致的三角函数，方程(4)。现在我们只是使用<a class="ae ky" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> matplotlib库</a>来可视化这个特殊的解决方案。</p><pre class="kk kl km kn fd lw lx ly lz aw ma bi"><span id="20c6" class="mb la hi lx b fi mc md l me mf">plt.plot(t,sho.y[0])<br/>plt.ylabel("Position")<br/>plt.xlabel("Time")<br/>plt.title('SHO', fontsize = 20)</span></pre><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es ml"><img src="../Images/6b4f8738a4008bf5d93f544a879cdffd.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*EcRhm1SqPmEOcyuGSvrHFw.png"/></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">给定某些初始条件的振荡模式x(t)。</figcaption></figure><p id="dc67" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">这种方法同样适用于阻尼振动。由于在现实生活中总是存在能量耗散(永恒运动机器在现实生活中不起作用)，我们必须在等式(3)中引入拖曳力项，以获得更现实的振荡方法:</p><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es mm"><img src="../Images/38e06156be635f8d8f044be0594f95dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*DYNrL5A0PoOCctOPSBu4Jg.png"/></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">阻尼振子，其中dx/dt代表拖曳力。等式(7)</figcaption></figure><p id="0072" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">解决这个问题的方法与谐振子相同:</p><pre class="kk kl km kn fd lw lx ly lz aw ma bi"><span id="7238" class="mb la hi lx b fi mc md l me mf">t = np.linspace(0,15,1000)<br/>y = [0,1]<br/>gamma = 1<br/>omega_sqr = 100</span><span id="f02a" class="mb la hi lx b fi mk md l me mf">def sho(t,y):<br/>    solution = (y[1],(-gamma*y[1]-omega_sqr*y[0]))<br/>    return solution<br/>solution = solve_ivp(sho, [0,1000], y0 = y, t_eval = t)</span><span id="ef7c" class="mb la hi lx b fi mk md l me mf">plt.plot(t,solution.y[0])<br/>plt.ylabel("Position")<br/>plt.xlabel("Time")<br/>plt.title('Damped Oscillator', fontsize = 20)</span></pre><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es mn"><img src="../Images/bee4e389d6be4863808b0853380d95d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*6j1SWvR4zFMmkqzlbwqawQ.png"/></div><figcaption class="kr ks et er es kt ku bd b be z dx translated">阻尼振动函数x(t)</figcaption></figure><p id="322e" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">从这个特殊的数值解中，我们可以看到振荡是如何指数衰减到平衡态的，这里x(t) = 0。在前面对SHO的分析中，这种衰变不会出现，系统永远保持运动状态。</p><p id="a6ea" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">有整本书致力于研究振荡和波，这方面有更多的探索，它为各个领域的一些物理现象奠定了基础，甚至是量子力学。这篇文章旨在给出振动的一个基本概述，并添加一些方便的数值解。请随意复制代码，尝试各种值并探索解决方案，这可能是从等式中获得洞察力的最佳方式之一。</p><p id="2276" class="pw-post-body-paragraph je jf hi jg b jh ji ij jj jk jl im jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">玩得开心，乘风破浪！</p><figure class="kk kl km kn fd ko er es paragraph-image"><div class="er es mo"><img src="../Images/22e08c7734bc6300937fe63039de3815.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/1*aYVeyVXa-sSg46sZMa9YwQ.gif"/></div></figure></div></div>    
</body>
</html>