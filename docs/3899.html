<html>
<head>
<title>Photo Geolocation with Neural Networks: How to and How not to</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用神经网络进行照片地理定位:如何做和如何不做</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/photo-geolocation-with-neural-networks-how-to-and-how-not-to-8aa7f10abb34?source=collection_archive---------1-----------------------#2021-08-07">https://medium.com/analytics-vidhya/photo-geolocation-with-neural-networks-how-to-and-how-not-to-8aa7f10abb34?source=collection_archive---------1-----------------------#2021-08-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f672" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">建立一个可以对户外图像进行地理标记的神经网络，以及如何用grad-cam捕捉作弊的神经网络</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="30f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">卷积神经网络(CNN)是目前计算机视觉领域的最新技术。在本文中，我讨论了我构建CNN模型地理标记图像的经验——将图像作为输入，并预测该图像的位置作为输出。我还讨论了该模型的前一次迭代，它愚弄了我，让我相信该模型已经变得非常擅长地理定位，但结果证明这是一个数据泄漏的案例。</p><p id="f0ca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该模型在谷歌街景图像数据集上进行训练。我搜集了印度随机地点的图像来生成这个数据集。这个模型在预测方面相当不错。它通常预测实际位置的附近。</p><p id="015f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个针对不耐烦者的结果快速视图-阴影区域表示得分高的格网，预测位置是格网质心和得分的加权平均值:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/6a5b473578fa7da27d47e90018b19399.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ye0fSu2wngX_a31Nh1H4Pg.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">地理位置模型评估-阴影区域表示得分高的格网，预测位置是格网质心和得分的加权平均值</figcaption></figure><p id="e782" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些都是精心挑选的好例子。即使模型的预测位置是错误的，预测的网格也是合理的:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ka"><img src="../Images/a63f3d9b1b56dd0375e88910f7e8da46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L-gS1uJbL09vrrOgWQKYhA.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">可原谅的错误-阴影区域表示得分高的格网，预测位置是格网质心和得分的加权平均值</figcaption></figure><h1 id="d2e5" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak">抓骗子</strong></h1><p id="886b" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">我的第一次模型迭代给了我非常好的结果。准确率达到了60%，这对于这种方法来说是不可思议的，远远高于类似研究中提到的基准。这激起了我的怀疑，我进一步挖掘。</p><p id="68c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">经过进一步的研究，我发现即使对于质量不好的图像，预测也非常准确。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es le"><img src="../Images/382c3a804347db82b023d8e95cfe3f41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ZRVstA-YlTuioJ-FcTf-Q.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">对低质量图像的良好预测——非常可疑</figcaption></figure><p id="0425" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是非常可疑的，因为在损失曲线中没有过度拟合的迹象。然后，我决定使用grad-cam方法研究神经网络中的层激活，以了解模型在做出这些决定时在看什么。不料，骗局被揭穿了！！</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lf"><img src="../Images/06890106804107f4d311428b00159ca6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jslfQvwL2Y4yYZfhw62HZQ.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">模特如何作弊</figcaption></figure><p id="0e69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该模型在谷歌图像中查看上传者的名字，并使用它来预测位置。非常狡猾。多亏了gradcam，我们现在可以照亮“黑匣子”了。</p><p id="4545" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我遮住右下角的名字时。模型失控了。抓住你了。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es lg"><img src="../Images/ee4ee287740ee712a7b115ae678ff79a.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*fnE36rtHk8kJYDUEgezapw.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">当摄影师的名字被掩盖时，预测的准确性急剧下降</figcaption></figure><p id="1880" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在后来的迭代中，我裁剪掉了图像的底部。模型精度不是很高，但它能够提取一些一般的模式，如景观、建筑物、植被、道路、地形等。做预测的时候。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lh"><img src="../Images/cd725ad6ede7ec1f9194c73375a106eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ldGI0Q4DpMcXyml6sUprLw.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">为了防止作弊，模特在照片上接受了重新训练，并掩盖了摄影师的名字</figcaption></figure></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h2 id="cedd" class="li kc hi bd kd lj lk ll kh lm ln lo kl iq lp lq kp iu lr ls kt iy lt lu kx lv bi translated"><strong class="ak">建模方法:</strong></h2><p id="5381" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">我把这个框定为多类分类问题。我把印度地图分割成网格，用网格数作为目标变量训练模型。</p><p id="db6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据集准备</strong></p><p id="7982" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我在印度地图上叠加了一个等距网格。生成的网格中包含模型需要预测的目标变量。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es lw"><img src="../Images/e751b7bc268b6bf6292386f0d25fe4d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*paMr5XLkXohaXQcIFRyvWg.png"/></div></figure><p id="c57e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我在每个网格中均匀采样点，使用谷歌的街景API获得与街景图像最近的位置，并从360°视图中抓取角度为0、90、180和270度的4幅图像。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lx"><img src="../Images/14c3a4a01a117a3b8d4103e216fefbbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kWGaTrvQWhf1kUz33ilsCA.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">数据准备——从网格中随机采样位置坐标并采集图像</figcaption></figure><p id="c26b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">造型</strong></p><p id="f3ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">模型架构:ResNext50</p><p id="8b3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">班级数量:58</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ly"><img src="../Images/0473c88a71d732b31e24d3e6c18e3b12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LstXnq-aMRlEbygvIsTAmw.png"/></div></div></figure><p id="eef6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最终预测的坐标计算为预测概率分布的质心的加权和。</p><p id="5ac4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">评测</strong></p><p id="d9ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">方法:【KFold分组— 10个拆分—按位置分组</strong></p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es lz"><img src="../Images/18caf2ed1ac233230ffe0f4a43c3a593.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8UZRJwnu5cPiPyMGd1LLKA.png"/></div></div></figure><p id="7506" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">混淆矩阵:</strong></p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es ma"><img src="../Images/8482c6851b1d1a5a3fd7d7d8625ee081.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*IFf7YXE6-z8TCUvvuOqzNg.png"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">评估数据集上的混淆矩阵</figcaption></figure><p id="99cb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">平均准确率:</strong> 25%</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="85bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> GitHub回购:</strong><a class="ae mb" href="https://github.com/kvsnoufal/ImageGeoLocation" rel="noopener ugc nofollow" target="_blank">https://github.com/kvsnoufal/ImageGeoLocation</a></p><p id="a391" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">巨人的肩膀</strong></p><ol class=""><li id="3705" class="mc md hi ih b ii ij im in iq me iu mf iy mg jc mh mi mj mk bi translated">具有卷积神经网络的行星地理定位—<a class="ae mb" href="https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/45488.pdf" rel="noopener ugc nofollow" target="_blank">https://static . Google user content . com/media/research . Google . com/en//pubs/archive/45488 . pdf</a></li><li id="dd7e" class="mc md hi ih b ii ml im mm iq mn iu mo iy mp jc mh mi mj mk bi translated">DeepGeo:深度神经网络照片定位—<a class="ae mb" href="https://arxiv.org/abs/1810.03077" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/1810.03077</a></li><li id="88c7" class="mc md hi ih b ii ml im mm iq mn iu mo iy mp jc mh mi mj mk bi translated">https://www.kaggle.com/skylord/grad-cam-on-resnext</li></ol><blockquote class="mq mr ms"><p id="26d4" class="if ig mt ih b ii ij ik il im in io ip mu ir is it mv iv iw ix mw iz ja jb jc hb bi translated"><strong class="ih hj">关于作者</strong></p><p id="2c0b" class="if ig mt ih b ii ij ik il im in io ip mu ir is it mv iv iw ix mw iz ja jb jc hb bi translated">我在阿联酋迪拜控股公司工作，是一名数据科学家。你可以到kvsnoufal@gmail.com或https://www.linkedin.com/in/kvsnoufal/找我</p></blockquote></div></div>    
</body>
</html>