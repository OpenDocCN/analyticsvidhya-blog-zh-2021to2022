<html>
<head>
<title>Handling Imbalanced Datasets With Oversampling Techniques. It’s Pros &amp; Cons.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用过采样技术处理不平衡数据集。有利有弊。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/handling-imbalanced-datasets-with-oversampling-techniques-its-pros-cons-ba9f36ac5b71?source=collection_archive---------0-----------------------#2021-06-16">https://medium.com/analytics-vidhya/handling-imbalanced-datasets-with-oversampling-techniques-its-pros-cons-ba9f36ac5b71?source=collection_archive---------0-----------------------#2021-06-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="ad31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我们将讨论可用于克服不平衡数据的过采样技术。要了解有关数据不平衡的更多信息，请参考:<a class="ae jd" href="https://akalbir.medium.com/what-is-an-imbalanced-data-how-to-handle-imbalanced-data-in-python-e6067792950f" rel="noopener">https://akalbir . medium . com/what-a-an-unbalanced-data-how-to-handle-unbalanced-data-in-python-e 6067792950 f</a>。</p><p id="dc32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">简而言之，我将过采样定义为欠采样的反义词，因为在过采样中，我们通过将新的点插入少数类来平衡类，而不是将它们从多数类中移除。你现在可能会想，既然我们没有更多的数据，我们怎么能在少数类中插入新的点呢？为了回答这个问题，我会说，我们通过随机生成或数学计算来为少数群体生成分数。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es je"><img src="../Images/c68c861b19151206cf059a4d65cdda34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*YMedN9UJ4uCDlpa5k7ufcw.jpeg"/></div></figure><p id="a55d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有不同类型的过采样技术，比如随机过采样和SMOTE等。我们来详细讨论一下。</p><h1 id="0941" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">过采样技术的类型</h1><h2 id="3226" class="kk jn hi bd jo kl km kn js ko kp kq jw iq kr ks ka iu kt ku ke iy kv kw ki kx bi translated">随机过采样</h2><p id="5a0e" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">顾名思义，这是一种从少数类中选择随机点并复制它们以增加少数类中数据点数量的技术。但是被认为是最健壮的。这种方法被认为是最基本的过采样技术。由于点的选择是随机的，这人为地减少了数据集的方差。在我的案例中，我对欺诈交易数据集使用了随机过采样。这被证明比SMOTE过采样执行得更好。让我们看一下过采样之前的分布和代码片段，以了解它的实现。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ld"><img src="../Images/10d1034aba545f1576b105996ab71b8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*G3CTyzOkvoRUSa2vsMZWKw.png"/></div></figure><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="cf4a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，应用此方法后，我们得到如下输出:</p><pre class="jf jg jh ji fd lg lh li lj aw lk bi"><span id="b5b0" class="kk jn hi lh b fi ll lm l ln lo">Counter({0: 284315,<br/>         1: 284315})</span></pre><p id="065f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是在不平衡数据集上实现随机过采样的方法。</p><h2 id="3390" class="kk jn hi bd jo kl km kn js ko kp kq jw iq kr ks ka iu kt ku ke iy kv kw ki kx bi translated">SMOTE过采样</h2><p id="91c1" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">SMOTE代表合成少数过采样技术。该技术通过在原始数据集的观测值之间插入一个点来生成新的观测值。它利用了K-最近邻策略。SMOTE过采样有近85种变体。要了解更多，请查看:【https://github.com/analyticalmindsltd/smote_variants】T2</p><p id="8c38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于给定的观测值xi，通过在k个最近邻之一xzi之间进行插值来生成新的(合成)观测值。</p><p id="e1aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">xnew = Xi+λ(xzi Xi)xnew = Xi+λ(xzi Xi)</p><p id="361f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中λ是在[0，1][0，1]范围内的随机数。这个插值将在xi和xzi之间的线上创建一个样本。我在我的H1 B签证预测中使用了这种技术。让我们通过代码更好地理解它。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lp"><img src="../Images/7e29a443264ae488498663cb9fa6978c.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*azMOXfYaY_ZKXqQtP-jOHg.png"/></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">击打前</figcaption></figure><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="le lf l"/></div></figure><p id="3384" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上图可以看出，H1-B签证是高度不平衡的，所以我们用SMOTE处理了这种不平衡。产出如下:</p><pre class="jf jg jh ji fd lg lh li lj aw lk bi"><span id="022f" class="kk jn hi lh b fi ll lm l ln lo">Counter({0:2818282           1:2818282})</span></pre><p id="15ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，这是另一种平衡数据集的技术。</p><h2 id="0016" class="kk jn hi bd jo kl km kn js ko kp kq jw iq kr ks ka iu kt ku ke iy kv kw ki kx bi translated">阿达辛</h2><p id="d527" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">最后但并非最不重要的是自适应合成采样方法。这种方法基于SMOTE的方法论，但是它不是从附近的点生成点，而是使用离群点，即“更难学习的点”来生成新点。但是这样做的缺点是，由于它的适应性，它的精度会受到影响。同样，对于分散的少数样本，每个邻域可能只包含1个少数样本。</p><h1 id="2e9c" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">利弊</h1><p id="da4a" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">优点:</p><p id="7393" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(1)这种方法不会导致信息损失。</p><p id="d208" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(2)运行良好并给出良好的准确性。</p><p id="2d18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">缺点:</p><p id="99c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(1)增加学习时间</p><p id="1824" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(2)使过度拟合更有可能。</p><h1 id="c73d" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">结论</h1><p id="7d42" class="pw-post-body-paragraph if ig hi ih b ii ky ik il im kz io ip iq la is it iu lb iw ix iy lc ja jb jc hb bi translated">总结这篇文章，我想说的是，在分享我的经历的同时，我也学到了很多。这就是处理不平衡数据系列的结束。我希望你喜欢这篇文章，如果你有任何建议，请随时与我联系。快乐阅读伙计们！继续学习！</p></div></div>    
</body>
</html>