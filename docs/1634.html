<html>
<head>
<title>A Comprehensive Guide to Creating a Basic Reddit Bot [Part 2]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建基本Reddit机器人的综合指南[第2部分]</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-comprehensive-guide-to-creating-a-basic-reddit-bot-part-2-85de2fd300cd?source=collection_archive---------13-----------------------#2021-03-10">https://medium.com/analytics-vidhya/a-comprehensive-guide-to-creating-a-basic-reddit-bot-part-2-85de2fd300cd?source=collection_archive---------13-----------------------#2021-03-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="4108" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">Reddit机器人开发101</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/1bf73332975a0b9394ec94ac1fb8b52b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ccJFSX-aNKyPp8M0"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><a class="ae jn" href="https://unsplash.com/@agk42?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">亚历山大·奈特</a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="a2fc" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在本系列的第一部分中，我向您展示了如何启动和运行我们的机器人。我们知道机器人如何访问Reddit，以及它如何看到帖子。然而，我们从来没有谈到机器人的交互部分，这无疑是它最重要的特性。所以在这篇文章中，这就是我们将要讨论的内容。</p><p id="cedc" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果您还没有阅读第1部分，我强烈建议您阅读:</p><div class="kk kl ez fb km kn"><a href="https://ashishkulkarnii.medium.com/a-comprehensive-guide-to-creating-a-basic-reddit-bot-part-1-15fb0e4cebcb" rel="noopener follow" target="_blank"><div class="ko ab dw"><div class="kp ab kq cl cj kr"><h2 class="bd hj fi z dy ks ea eb kt ed ef hh bi translated">创建基本Reddit机器人的综合指南[第1部分]</h2><div class="ku l"><h3 class="bd b fi z dy ks ea eb kt ed ef dx translated">创建简单的交互式Reddit机器人指南的第1部分。</h3></div><div class="kv l"><p class="bd b fp z dy ks ea eb kt ed ef dx translated">ashishkulkarnii.medium.com</p></div></div></div></a></div><h1 id="91b1" class="kw kx hi bd ky kz la lb lc ld le lf lg io lh ip li ir lj is lk iu ll iv lm ln bi translated">用我们的机器人发表评论</h1><p id="3785" class="pw-post-body-paragraph jo jp hi jq b jr lo ij jt ju lp im jw jx lq jz ka kb lr kd ke kf ls kh ki kj hb bi translated">老实说，这是轻而易举的事，因为PRAW给了我们所有需要的工具。我们所要做的就是导入PRAW，调用我们的机器人，将其添加到一个subreddit(我们选择的)，寻找一个或多个提交(按<em class="lt">热门、热门、新、</em>或<em class="lt">上升</em>排序)，并发布回复。我们可以这样做:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="1944" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我再次使用r/SpaceJam2021作为测试的子编辑。不要在你的机器人测试中散布流行的子目录，这会让其他用户感到厌烦。</p><p id="4c03" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><em class="lt">submission . reply(" "</em>)用传递的参数作为评论进行回复，它下面的一行只是给了我们一个我们的bot在终端回复的帖子的确认。</p><h1 id="b0a3" class="kw kx hi bd ky kz la lb lc ld le lf lg io lh ip li ir lj is lk iu ll iv lm ln bi translated">评论满足条件的帖子</h1><p id="8add" class="pw-post-body-paragraph jo jp hi jq b jr lo ij jt ju lp im jw jx lq jz ka kb lr kd ke kf ls kh ki kj hb bi translated">让我们更进一步，为我们的机器人应该回复的帖子添加一些条件。在大多数情况下，让一个机器人评论每一篇帖子是不切实际的。</p><p id="0322" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">所以在下面的程序中，我指示我们的机器人回答“我是机器人！”只对标题中包含字符串“你是机器人”的帖子，忽略大小写。通过更改<em class="lt">限制</em>，您可以更改每次执行时您想要查看的帖子数量。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lu lv l"/></div></figure><h1 id="08fc" class="kw kx hi bd ky kz la lb lc ld le lf lg io lh ip li ir lj is lk iu ll iv lm ln bi translated">访问和解析数据集以获得所需的统计数据</h1><p id="7a35" class="pw-post-body-paragraph jo jp hi jq b jr lo ij jt ju lp im jw jx lq jz ka kb lr kd ke kf ls kh ki kj hb bi translated">我在第1部分中提到过，我的项目的目标是创建一个Reddit机器人，提供特定地理区域的新冠肺炎案例的统计数据。我决定创建一个机器人，而不是像应用程序或网页这样更通用的东西，是因为我想通知那些不知道的人。我想告诉那些甚至没有寻找我要给他们的信息的人。我认为没有其他实现可以有效地完成这项任务。</p><p id="0226" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">所以我的机器人的主要部分，不一定与你的机器人相关，是在免费在线API的帮助下访问数据集。</p><p id="e07d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我采取的第一步是找到一个免费的API服务，它愿意访问可靠的、维护良好的数据集，这些数据集存储了新冠肺炎的统计数据(活跃病例、死亡人数等)。).我发现了一个免费可信的网络抓取解决方案，它访问各种政府/官方网站获取新冠肺炎统计数据，并将这些数据转化为每五分钟更新一次的公共API。</p><p id="5313" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">例如，Apify访问印度新冠肺炎州的<a class="ae jn" href="https://mohfw.gov.in/" rel="noopener ugc nofollow" target="_blank">卫生和家庭福利部</a>，访问美国的<a class="ae jn" href="https://www.cdc.gov/" rel="noopener ugc nofollow" target="_blank">疾病控制和预防中心</a>。</p><p id="a87e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">Apify的数据集是JSON文件，所以很容易用Python解析。这个是世界数据集的样子，这个<a class="ae jn" href="https://api.apify.com/v2/key-value-stores/toDWvRj1JpTXiM8FF/records/LATEST?disableRedirect=true" rel="noopener ugc nofollow" target="_blank">是印度数据集的样子。</a></p><p id="8703" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">因为我总是想要最新最好的数据，所以把数据存储在本地是没有意义的。因此，我们将不得不在运行时访问在线数据集。下面是我用来做这件事的代码:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="8b74" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">没有必要赘述，但基本上<em class="lt"> world_covid_stats </em>现在是一个字典，包含了Apify当时在世界新冠肺炎统计上的所有数据。</p><p id="8901" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">因为我来自印度，所以我决定提供一些关于印度国内统计的更深入的信息。所以我添加了这段代码来获取状态信息:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="f814" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我使用India _ covid _ stats[" region data "]的原因是，JSON文件的开头是关于整个印度的数据，我想在运行时跳过对它的解析。</p><h1 id="06bf" class="kw kx hi bd ky kz la lb lc ld le lf lg io lh ip li ir lj is lk iu ll iv lm ln bi translated">创造我们的最终机器人</h1><p id="a09c" class="pw-post-body-paragraph jo jp hi jq b jr lo ij jt ju lp im jw jx lq jz ka kb lr kd ke kf ls kh ki kj hb bi translated">现在我们已经有了所有需要的数据，我们可以开始完成我们的代码了。我希望机器人在没有被明确调用的情况下提供信息，这意味着我必须考虑用户的各种造句。我肯定更高级的编码人员会决定在机器人中实现NLP模型，但我决定走一条稍微容易一点的路线。</p><p id="2a5b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">该机器人在Reddit帖子的标题中查找关键词，如<em class="lt">去</em>、<em class="lt">访</em>、中的<em class="lt">等。如果它碰巧找到其中任何一个，它会在两个数据集中查找一个印度州的名称或一个国家的名称。如果找到一个，它就检索相应的数据并把它放在注释中。</em></p><p id="cb82" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">例如，如果一个帖子说<em class="lt">我正在俄罗斯访问一段时间</em>，机器人会回复<em class="lt">俄罗斯有348160个当前病例，小心！</em></p><p id="84e6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这是我的机器人的代码:</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="f3b7" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果您对运行covibot感兴趣，请前往<a class="ae jn" href="https://github.com/ashishkulkarnii/covibot" rel="noopener ugc nofollow" target="_blank"> it's repo </a>，并阅读README.md文件中的说明。</p></div><div class="ab cl lw lx gp ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="hb hc hd he hf"><p id="e7d1" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们终于有了一个可以与其他平台用户智能交互的Reddit机器人！你可能认为我们已经完成了，但还没有。这里有一些我们尚未解决的缺陷:</p><ol class=""><li id="339d" class="md me hi jq b jr js ju jv jx mf kb mg kf mh kj mi mj mk ml bi translated">我们的机器人必须手动调用。它不会自动回复我们subreddit上的帖子，相反，我们必须在每次需要时运行它。</li><li id="710f" class="md me hi jq b jr mm ju mn jx mo kb mp kf mq kj mi mj mk ml bi translated">我们的机器人还不知道哪些帖子已经回复，哪些没有回复。因此，如果你运行它两次，并且在这两次之间没有新的帖子，你一定会看到我们的机器人的多个评论。</li></ol><p id="e89e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这是本系列的第3部分，我们将解决最后两个问题:</p><div class="kk kl ez fb km kn"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/a-comprehensive-guide-to-creating-a-basic-reddit-bot-part-3-351817cffae2"><div class="ko ab dw"><div class="kp ab kq cl cj kr"><h2 class="bd hj fi z dy ks ea eb kt ed ef hh bi translated">创建基本Reddit机器人的综合指南[第3部分]</h2><div class="ku l"><h3 class="bd b fi z dy ks ea eb kt ed ef dx translated">Reddit机器人开发101</h3></div><div class="kv l"><p class="bd b fp z dy ks ea eb kt ed ef dx translated">ashishkulkarnii.medium.com</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw jh kn"/></div></div></a></div></div></div>    
</body>
</html>