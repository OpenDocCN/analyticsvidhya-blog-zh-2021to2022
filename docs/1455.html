<html>
<head>
<title>Feature Engineering is Important! ⚙️</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">特征工程很重要！⚙️</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/feature-engineering-is-important-%EF%B8%8F-b2e13956002b?source=collection_archive---------19-----------------------#2021-03-02">https://medium.com/analytics-vidhya/feature-engineering-is-important-%EF%B8%8F-b2e13956002b?source=collection_archive---------19-----------------------#2021-03-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="2242" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一个简单的教程，介绍了特征工程如何简化你的机器学习模型。</p></div><div class="ab cl jc jd go je" role="separator"><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh"/></div><div class="ha hb hc hd he"><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es jj"><img src="../Images/d70085c1f4493b309ddf49b20ac3c862.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zz0ztGgICt0z192EqInOWg.jpeg"/></div></div><figcaption class="jv jw et er es jx jy bd b be z dx translated">照片由<a class="ae jz" href="https://www.pexels.com/@pixabay" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>拍摄</figcaption></figure><h1 id="a472" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">密码强度分类器</strong>🔑</h1><blockquote class="ky kz la"><p id="0d78" class="ie if lb ig b ih ii ij ik il im in io lc iq ir is ld iu iv iw le iy iz ja jb ha bi translated">预测密码是否强的机器学习模型。</p></blockquote><p id="8d42" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据集链接:<a class="ae jz" href="https://www.kaggle.com/bhavikbb/password-strength-classifier-dataset" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/bhavikbb/password-strength-classifier-dataset</a></p><p id="71f4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我们的分析中使用的密码是从网上可获得的000网站主机泄漏。我们如何确定哪些密码更强，哪些密码更弱？乔治亚理工大学有一个叫PARS的工具，里面集成了所有的商业密码计量器。我所做的就是给那个工具所有的密码，它给我每个商业密码强度计的新文件。文件包含多一列的密码，即基于商业密码强度计的密码强度。</p><p id="f047" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我使用的商业密码强度算法是Twitter、微软和battle的。这个算法和这些测力计有什么不同？首先，它完全基于机器学习而不是基于规则。其次，我只保留了那些被所有三个强度计标记为弱、中、强的密码。这意味着所有的密码都是弱、中或强的。</p><h2 id="8ca3" class="lf kb hh bd kc lg lh li kg lj lk ll kk ip lm ln ko it lo lp ks ix lq lr kw ls bi translated"><strong class="ak">关于此文件</strong></h2><p id="86c6" class="pw-post-body-paragraph ie if hh ig b ih lt ij ik il lu in io ip lv ir is it lw iv iw ix lx iz ja jb ha bi translated">密码—在线收集的密码的67万个唯一值。强度—三个值(0，1，2)，即0代表弱，1代表中，2代表强。基于规则(如包含数字、特殊符号等)的密码强度。)</p></div><div class="ab cl jc jd go je" role="separator"><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh"/></div><div class="ha hb hc hd he"><h1 id="0bf0" class="ka kb hh bd kc kd ly kf kg kh lz kj kk kl ma kn ko kp mb kr ks kt mc kv kw kx bi translated">数据分布📊</h1><pre class="jk jl jm jn fd md me mf mg aw mh bi"><span id="aa43" class="lf kb hh me b fi mi mj l mk ml"><strong class="me hi">import</strong> <strong class="me hi">numpy</strong> <strong class="me hi">as</strong> <strong class="me hi">np</strong><br/><strong class="me hi">import</strong> <strong class="me hi">pandas</strong> <strong class="me hi">as</strong> <strong class="me hi">pd</strong><br/><strong class="me hi">import</strong> <strong class="me hi">matplotlib.pyplot</strong> <strong class="me hi">as</strong> <strong class="me hi">plt</strong><br/><strong class="me hi">import</strong> <strong class="me hi">seaborn</strong> <strong class="me hi">as</strong> <strong class="me hi">sns</strong><br/><strong class="me hi">import</strong> <strong class="me hi">re</strong></span><span id="a6f4" class="lf kb hh me b fi mm mj l mk ml">data=pd.read_csv('data.csv',error_bad_lines=<strong class="me hi">False</strong>)<br/><em class="lb"># figure for strength</em><br/>plt.figure(figsize=(15,10))<br/>sns.countplot(x=data['strength'])<br/>plt.title('Countplot for Strength of Password')<br/>plt.xlabel('STRENGTH')<br/>plt.ylabel('COUNT')<br/>plt.savefig('strength.jpg')<br/>plt.show()</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es mn"><img src="../Images/45daf28467f224d1c2eadebec6e25058.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7yoMZuz2GCE7ASUbbzb36Q.jpeg"/></div></div></figure><p id="a351" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过查看密码的计数图，我们可以得出数据集高度不平衡的结论。与弱密码和强密码的数据点数相比，属于中等强度的密码具有最高的数据点数。</p></div><div class="ab cl jc jd go je" role="separator"><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh"/></div><div class="ha hb hc hd he"><h1 id="26a8" class="ka kb hh bd kc kd ly kf kg kh lz kj kk kl ma kn ko kp mb kr ks kt mc kv kw kx bi translated">🧰特征工程</h1><h2 id="c708" class="lf kb hh bd kc lg lh li kg lj lk ll kk ip lm ln ko it lo lp ks ix lq lr kw ls bi translated">为什么？</h2><p id="2447" class="pw-post-body-paragraph ie if hh ig b ih lt ij ik il lu in io ip lv ir is it lw iv iw ix lx iz ja jb ha bi translated">数据集仅由两列组成，即密码和强度的类别标签，需要进行预处理并应用一些特征工程。</p></div><div class="ab cl jc jd go je" role="separator"><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh"/></div><div class="ha hb hc hd he"><h2 id="0759" class="lf kb hh bd kc lg lh li kg lj lk ll kk ip lm ln ko it lo lp ks ix lq lr kw ls bi translated">解决办法</h2><p id="bee8" class="pw-post-body-paragraph ie if hh ig b ih lt ij ik il lu in io ip lv ir is it lw iv iw ix lx iz ja jb ha bi translated">这是我用来做简单特征工程的代码，它给了我的模型更多的输入来更好地训练和分类密码。这些都是决定密码强弱的重要因素。</p><pre class="jk jl jm jn fd md me mf mg aw mh bi"><span id="3b9b" class="lf kb hh me b fi mi mj l mk ml"><strong class="me hi">def</strong> cal_len(x):<br/>    <em class="lb">'''</em><br/><em class="lb">    Calculates the length of a given password.</em><br/><em class="lb">    '''</em><br/>    x=str(x)<br/>    <strong class="me hi">return</strong> len(x)</span><span id="6aec" class="lf kb hh me b fi mm mj l mk ml"><strong class="me hi">def</strong> cal_capL(x):<br/>    <em class="lb">'''</em><br/><em class="lb">    Calculates the number of capital letters in the password.</em><br/><em class="lb">    '''</em><br/>    x=str(x)<br/>    cnt=0<br/>    <strong class="me hi">for</strong> i <strong class="me hi">in</strong> x:<br/>        <strong class="me hi">if</strong>(i.isupper()):<br/>            cnt+=1<br/>    <strong class="me hi">return</strong> cnt<br/><br/><strong class="me hi">def</strong> cal_smL(x):<br/>    <em class="lb">'''</em><br/><em class="lb">    Calculates the number of small letters in the password.</em><br/><em class="lb">    '''</em><br/>    x=str(x)<br/>    cnt=0<br/>    <strong class="me hi">for</strong> i <strong class="me hi">in</strong> x:<br/>        <strong class="me hi">if</strong>(i.islower()):<br/>            cnt+=1<br/>    <strong class="me hi">return</strong> cnt<br/><br/><strong class="me hi">def</strong> cal_spc(x):<br/>    <em class="lb">'''</em><br/><em class="lb">    Calculates the number of special characters in the password.</em><br/><em class="lb">    '''</em><br/>    x=str(x)<br/>    <strong class="me hi">return</strong> (len(x)-len(re.findall('[\w]',x)))</span><span id="cdb7" class="lf kb hh me b fi mm mj l mk ml"><strong class="me hi">def</strong> cal_num(x):<br/>    <em class="lb">'''</em><br/><em class="lb">    Calculates the number of numeric values in the password.</em><br/><em class="lb">    '''</em><br/>    x=str(x)<br/>    cnt=0<br/>    <strong class="me hi">for</strong> i <strong class="me hi">in</strong> x:<br/>        <strong class="me hi">if</strong>(i.isnumeric()):<br/>            cnt+=1<br/>    <strong class="me hi">return</strong> cnt<br/><br/>length=<strong class="me hi">lambda</strong> x:cal_len(x)<br/>capital=<strong class="me hi">lambda</strong> x:cal_capL(x)<br/>small=<strong class="me hi">lambda</strong> x:cal_smL(x)<br/>special=<strong class="me hi">lambda</strong> x:cal_spc(x)<br/>numeric=<strong class="me hi">lambda</strong> x:cal_num(x)</span><span id="cb0f" class="lf kb hh me b fi mm mj l mk ml">data['length']=pd.DataFrame(data.password.apply(length))<br/>data['capital']=pd.DataFrame(data.password.apply(capital))<br/>data['small']=pd.DataFrame(data.password.apply(small))<br/>data['special']=pd.DataFrame(data.password.apply(special))<br/>data['numeric']=pd.DataFrame(data.password.apply(cal_num))</span></pre></div><div class="ab cl jc jd go je" role="separator"><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh"/></div><div class="ha hb hc hd he"><h1 id="f39c" class="ka kb hh bd kc kd ly kf kg kh lz kj kk kl ma kn ko kp mb kr ks kt mc kv kw kx bi translated">为了更好地理解而绘制的图📊</h1><p id="16ac" class="pw-post-body-paragraph ie if hh ig b ih lt ij ik il lu in io ip lv ir is it lw iv iw ix lx iz ja jb ha bi translated">这些图将帮助你理解数据点的分布。看一看！！！😃</p><h2 id="5633" class="lf kb hh bd kc lg lh li kg lj lk ll kk ip lm ln ko it lo lp ks ix lq lr kw ls bi translated">密码的长度📏</h2><pre class="jk jl jm jn fd md me mf mg aw mh bi"><span id="c40b" class="lf kb hh me b fi mi mj l mk ml">plt.figure(figsize=(15,10))<br/>sns.countplot(x=data['length'],color='red')<br/>plt.title('Countplot for Length of Password')<br/>plt.xlabel('LENGTH')<br/>plt.ylabel('COUNT')<br/>plt.savefig('length.jpg')<br/>plt.show()</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es mn"><img src="../Images/b568be5f03ed544746d54d999bd40164.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jMdDIw8Hi2_FFZaAjdHDNg.jpeg"/></div></div></figure><h2 id="7da5" class="lf kb hh bd kc lg lh li kg lj lk ll kk ip lm ln ko it lo lp ks ix lq lr kw ls bi translated">密码中的大写字母🔠</h2><pre class="jk jl jm jn fd md me mf mg aw mh bi"><span id="9a98" class="lf kb hh me b fi mi mj l mk ml">plt.figure(figsize=(15,10))<br/>sns.countplot(x=data['capital'],color='blue')<br/>plt.title('Countplot for Capital Letters of Password')<br/>plt.xlabel('CAPITAL LETTERS')<br/>plt.ylabel('COUNT')<br/>plt.savefig('capital.jpg')<br/>plt.show()</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es mn"><img src="../Images/ad483241ae92bbe9269cc03a0fc8939d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d0KYGO9voPieOfzySqY0Tg.jpeg"/></div></div></figure><h2 id="7069" class="lf kb hh bd kc lg lh li kg lj lk ll kk ip lm ln ko it lo lp ks ix lq lr kw ls bi translated">密码中的小写字母🔡</h2><pre class="jk jl jm jn fd md me mf mg aw mh bi"><span id="7198" class="lf kb hh me b fi mi mj l mk ml">plt.figure(figsize=(15,10))<br/>sns.countplot(x=data['small'],color='orange')<br/>plt.title('Countplot for Small Letters of Password')<br/>plt.xlabel('SMALL LETTERS')<br/>plt.ylabel('COUNT')<br/>plt.savefig('small.jpg')<br/>plt.show()</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es mn"><img src="../Images/290589c1caa276af3bf7e9c7558ef4ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RPS_-m5YDVBs8SswSu7KTA.jpeg"/></div></div></figure><h2 id="006b" class="lf kb hh bd kc lg lh li kg lj lk ll kk ip lm ln ko it lo lp ks ix lq lr kw ls bi translated">密码中的数值🔢</h2><pre class="jk jl jm jn fd md me mf mg aw mh bi"><span id="ec18" class="lf kb hh me b fi mi mj l mk ml">plt.figure(figsize=(15,10))<br/>sns.countplot(x=data['numeric'],color='teal')<br/>plt.title('Countplot for Numerics of Password')<br/>plt.xlabel('NUMERICS')<br/>plt.ylabel('COUNT')<br/>plt.savefig('numerics.jpg')<br/>plt.show()</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es mn"><img src="../Images/81898c7a2c0dca5f1208a2ba28edf0f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JaqqNLpUE-6Jhsy-MJWyZw.jpeg"/></div></div></figure><h2 id="aed1" class="lf kb hh bd kc lg lh li kg lj lk ll kk ip lm ln ko it lo lp ks ix lq lr kw ls bi translated">密码中的特殊字符🔣</h2><pre class="jk jl jm jn fd md me mf mg aw mh bi"><span id="5c93" class="lf kb hh me b fi mi mj l mk ml">plt.figure(figsize=(15,10))<br/>sns.countplot(x=data['special'],color='violet')<br/>plt.title('Countplot for Special Characters of Password')<br/>plt.xlabel('SPECIAL CHARACTERS')<br/>plt.ylabel('COUNT')<br/>plt.savefig('special.jpg')<br/>plt.show()</span></pre><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es mn"><img src="../Images/a07fc95b0b6285b97388e7260e25e54f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3woImz_BHXdGOhA5q7HsRg.jpeg"/></div></div></figure></div><div class="ab cl jc jd go je" role="separator"><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh"/></div><div class="ha hb hc hd he"><h1 id="06d9" class="ka kb hh bd kc kd ly kf kg kh lz kj kk kl ma kn ko kp mb kr ks kt mc kv kw kx bi translated">模型架构🤖</h1><p id="9fc1" class="pw-post-body-paragraph ie if hh ig b ih lt ij ik il lu in io ip lv ir is it lw iv iw ix lx iz ja jb ha bi translated">在这里，我使用了来自sklearn的<code class="du mo mp mq me b">MLP Classifier</code>和<code class="du mo mp mq me b">2 hidden layers each having 16 nodes with ReLU activation.</code>，模型的输入只是使用标准缩放器缩放的特征工程值。</p><pre class="jk jl jm jn fd md me mf mg aw mh bi"><span id="842d" class="lf kb hh me b fi mi mj l mk ml"><strong class="me hi">from</strong> <strong class="me hi">sklearn.preprocessing</strong> <strong class="me hi">import</strong> StandardScaler<br/><strong class="me hi">from</strong> <strong class="me hi">sklearn.neural_network</strong> <strong class="me hi">import</strong> MLPClassifier<br/><strong class="me hi">from</strong> <strong class="me hi">sklearn.model_selection</strong> <strong class="me hi">import</strong> train_test_split <strong class="me hi">as</strong> tts<br/><strong class="me hi">from</strong> <strong class="me hi">sklearn.metrics</strong> <strong class="me hi">import </strong>accuracy_score<br/><strong class="me hi">from</strong> <strong class="me hi">sklearn.metrics</strong> <strong class="me hi">import </strong>classification_report<br/><strong class="me hi">from</strong> <strong class="me hi">sklearn.metrics</strong> <strong class="me hi">import </strong>confusion_matrix</span><span id="3d10" class="lf kb hh me b fi mm mj l mk ml">y=data['strength'].values<br/>x=data[['length','capital','small','special','numeric']].values</span><span id="8d2a" class="lf kb hh me b fi mm mj l mk ml">xtrain,xtest,ytrain,ytest=tts(x,y,test_size=0.2,random_state=42)<br/>print(xtrain.shape,ytrain.shape)<br/>print(xtest.shape,ytest.shape)</span><span id="60c9" class="lf kb hh me b fi mm mj l mk ml">sc=StandardScaler()<br/>xtrain=sc.fit_transform(xtrain)<br/>xtest=sc.transform(xtest)</span><span id="a34c" class="lf kb hh me b fi mm mj l mk ml">model=MLPClassifier(hidden_layer_sizes=(16,16),max_iter=300)<br/>model.fit(xtrain,ytrain)</span></pre></div><div class="ab cl jc jd go je" role="separator"><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh"/></div><div class="ha hb hc hd he"><h1 id="254f" class="ka kb hh bd kc kd ly kf kg kh lz kj kk kl ma kn ko kp mb kr ks kt mc kv kw kx bi translated">模特表演🥇</h1><p id="5c13" class="pw-post-body-paragraph ie if hh ig b ih lt ij ik il lu in io ip lv ir is it lw iv iw ix lx iz ja jb ha bi translated">模型的精确度达到了<code class="du mo mp mq me b">99.99%</code>，因为模型只做了一次错误分类。</p><pre class="jk jl jm jn fd md me mf mg aw mh bi"><span id="e381" class="lf kb hh me b fi mi mj l mk ml">ypred=model.predict(xtest)<br/>print("The accuracy of the model is: ",accuracy_score(ytest,ypred)*100," % !!!")<br/><br/>print(classification_report(ytest,ypred))</span><span id="1fd5" class="lf kb hh me b fi mm mj l mk ml">print("The confusion matrix is: ") <br/>cf=confusion_matrix(ytest,ypred) <br/>print(cf)</span><span id="a7e1" class="lf kb hh me b fi mm mj l mk ml"> <br/>plt.figure(figsize=(15,10)) <br/>sns.heatmap(cf,annot=<strong class="me hi">True</strong>,cmap='Blues') <br/>plt.title('Confusion Matrix') <br/>plt.savefig('confusion.jpg') <br/>plt.show()</span></pre><p id="23d1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了更好地理解，下面是混淆矩阵:</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="er es mn"><img src="../Images/81e5bbf0a0e0b092a4fcae094cd474ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Oz46rOZxbWyaWCURnxNb1g.jpeg"/></div></div></figure></div><div class="ab cl jc jd go je" role="separator"><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh"/></div><div class="ha hb hc hd he"><blockquote class="ky kz la"><p id="8fd1" class="ie if lb ig b ih ii ij ik il im in io lc iq ir is ld iu iv iw le iy iz ja jb ha bi translated">特征工程有助于表示数据的底层结构。</p></blockquote><p id="0330" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可以点击下面的链接访问我的Github repo。如果你真的喜欢它，给它一颗星。</p><div class="mr ms ez fb mt mu"><a href="https://github.com/Ankit152/Password-Strength-Classifier" rel="noopener  ugc nofollow" target="_blank"><div class="mv ab dw"><div class="mw ab mx cl cj my"><h2 class="bd hi fi z dy mz ea eb na ed ef hg bi translated">ankit 152/密码强度分类器</h2><div class="nb l"><h3 class="bd b fi z dy mz ea eb na ed ef dx translated">在我们的分析中使用的密码是从网上可获得的000网站主机泄漏。我们是如何发现哪个…</h3></div><div class="nc l"><p class="bd b fp z dy mz ea eb na ed ef dx translated">github.com</p></div></div><div class="nd l"><div class="ne l nf ng nh nd ni jt mu"/></div></div></a></div><p id="4619" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">领英:<a class="ae jz" href="https://www.linkedin.com/in/ankitk152/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/ankitk152/</a></p><p id="1c9c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">GitHub:<a class="ae jz" href="https://github.com/Ankit152" rel="noopener ugc nofollow" target="_blank">https://github.com/Ankit152</a></p><p id="3a45" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">推特:<a class="ae jz" href="https://twitter.com/theankitkurmi" rel="noopener ugc nofollow" target="_blank">安基特·库尔米</a></p></div></div>    
</body>
</html>