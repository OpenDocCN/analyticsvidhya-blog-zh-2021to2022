<html>
<head>
<title>Stock Buy/Sell/Hold Prediction(Multi Class Classification )</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">股票买入/卖出/持有预测(多类分类)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/stocks-market-prediction-multi-class-classification-f23fc3286136?source=collection_archive---------1-----------------------#2021-08-20">https://medium.com/analytics-vidhya/stocks-market-prediction-multi-class-classification-f23fc3286136?source=collection_archive---------1-----------------------#2021-08-20</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="00d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">机器学习案例研究…</p><p id="cac1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大家好，对我个人来说，这是一个非常有趣的案例研究，我对股票非常感兴趣，我喜欢机器学习，所以我试图将这两者结合起来，</p><p id="4cc7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个案例中，我们关注动量交易，它不同于基本面分析和技术分析。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/83c577484dacbe8905cdb4481cda3e22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*o-qaF_Oovg26BoCd"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">尼克·崇在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="aa91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我给你举个例子…</p><p id="a014" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设你想从A地到B地，你可以在公共汽车站选择两辆公共汽车。第一辆巴士是豪华巴士，有很多空间，他们也会给你食物，但唯一的问题是“你不知道巴士什么时候走”。</p><p id="1fa7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有另一辆公共汽车，这辆公共汽车挤满了人，给你的空间很小，一点也不豪华，但唯一的好处是“你知道公共汽车就要离开了”，这里没有等待。</p><p id="848e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以不同的人可能会选择不同的巴士，第二巴士是动量交易。这里我们不使用</p><p id="e776" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“低买高卖”</p><p id="d7a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用，</p><p id="d578" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“高买高卖”。</p><p id="0634" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这种交易中，没有股票的基本面分析，不管管理层是什么，也不管年度报告是什么，唯一重要的是动力。</p><p id="3a16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在问题来了，我们怎么知道什么股票会涨，因为有一些规则，这些规则可能有1000条，你需要知道什么对你有效。</p><p id="5e87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这只是动量交易的一个小的概述，如果你想了解更多，请跟随ALOK JAIN先生，他很棒。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ju jv l"/></div></figure><p id="28e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们跳到机器学习公式，可以用机器学习预测股市吗？</p><p id="7bd2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是个大问题…</p><h1 id="b2a2" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">商业目标</h1><p id="cc47" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">过去几年投资股票的人激增，特别是当人们可以用自己的智能手机投资时，他们开始理解投资的重要性，无论是股票、房地产还是金属。</p><p id="4dc6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">许多人不太了解股票的表现，也不知道他们应该在什么时候买入/卖出特定的股票。考虑到所涉及的风险，推荐模型可以帮助他们选择正确的股票。</p><p id="3ab8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个可以实时向用户推荐买什么或卖什么的模型是我们的业务目标。</p><p id="8629" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">约束</strong></p><p id="ecf2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.低延迟(在几纳秒的时间内，模型应该能够根据市场对股票进行分类)</p><p id="6fe9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.错误可能代价高昂，人们可能因为一个错误的预测而损失金钱，尽管模型不可能100%准确。</p><p id="c5b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.可解释性很重要。</p><p id="0a77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.需要特定股票属于每个类别的概率。</p><p id="71eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">机器学习公式</strong></p><p id="c683" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种推荐模型应该对特定的股票进行分类，无论它是“强买”“强卖”“买”“卖”“持有”。</p><p id="0e87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个分类问题的主要挑战是类别标签的不均衡性质，大多数情况下用户必须持有股票，很少有强烈的买入和卖出信号。</p><p id="185d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据</strong></p><p id="7f9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从Yahoo Finance网站收集了64家美国公司的数据，最初数据有41k行和67个特征，推荐列已作为目标类添加到数据中，该推荐列是使用股票市场的领域知识(来自一些基于规则的系统)以及人工观察计算的。</p><p id="ebbf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">绩效指标</strong></p><p id="6127" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是一个简单的多类分类问题，我们可以使用多类日志丢失来检查性能。</p><p id="fee9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">除此之外，我们将使用准确性(在检查数据是否平衡之后)，这里重要的是我们同样关心精确度和召回率，因为我们同样关心假阳性和假阴性。</p><p id="2016" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">例1 </strong></p><p id="541e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设我们有这样一个案例，当时股票实际上“不是强卖”,而模型预测它是“强卖”,此时用户将卖出股票，一段时间后股票价格上涨，用户不会对模型满意，他/她可能以后不会使用它。这是一个假阳性的例子。</p><p id="9efe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">例2 </strong></p><p id="bcdc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设我们有一个案例，实际上股票是一个“强卖”的时刻，模型预测它是“不是一个强卖”，现在在这种情况下，用户可以失去钱，因为趋势可能会改变一段时间后，股票价格将下降，用户肯定不会使用该模型。这就是假阴性的情况。</p><p id="940d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，最佳性能度量将是F1得分，因为F1得分是精确度和召回率之间的调和平均值，并且当精确度和召回率都高时，F1得分也高。</p><p id="fc3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们开始吧</p><p id="555d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首要任务是生成数据…</p><h2 id="a3c2" class="kz jx hi bd jy la lb lc kc ld le lf kg iq lg lh kk iu li lj ko iy lk ll ks lm bi translated"><strong class="ak">来自雅虎财经的数据抓取</strong></h2><p id="2d72" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">我用yfinance python模块和美汤库抓取了不同股票的信息，我已经抓取了64家公司2年的数据。</p><p id="3cec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我有一个关于美丽汤库的详细博客，有兴趣的可以看看。</p><div class="ln lo ez fb lp lq"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/web-scraping-2559f72c6c80"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hj fi z dy lv ea eb lw ed ef hh bi translated">数据科学和网络搜集</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">我使用BeautifulSoup Library从不同的新闻网站上搜集某个特定主题的新闻。</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">medium.com</p></div></div><div class="lz l"><div class="ma l mb mc md lz me jn lq"/></div></div></a></div><p id="1172" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">YouTube上有很多从雅虎财经网站上盗取的视频，如果你想看的话，可以看看。</p><h1 id="caa6" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">探索性数据分析</h1><ol class=""><li id="490d" class="mf mg hi ih b ii ku im kv iq mh iu mi iy mj jc mk ml mm mn bi translated">我们将在这里探索数据，看看数据告诉我们关于股票的什么故事。</li><li id="1e88" class="mf mg hi ih b ii mo im mp iq mq iu mr iy ms jc mk ml mm mn bi translated">我们将检查空值并尝试估算它们。</li><li id="922b" class="mf mg hi ih b ii mo im mp iq mq iu mr iy ms jc mk ml mm mn bi translated">我们将检查每一个功能，看看它是否对我们有用。</li><li id="95fc" class="mf mg hi ih b ii mo im mp iq mq iu mr iy ms jc mk ml mm mn bi translated">我们将绘制各种图来了解不同特征之间的关系。</li><li id="ff32" class="mf mg hi ih b ii mo im mp iq mq iu mr iy ms jc mk ml mm mn bi translated">我们将做单变量和双变量分析。</li><li id="548f" class="mf mg hi ih b ii mo im mp iq mq iu mr iy ms jc mk ml mm mn bi translated">我们将检查数据之间是否存在相关性。我们将检查异常值</li></ol><p id="5b0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从基于规则的系统中，我们添加了一个建议列(这是我们的目标变量)，我们在目标变量中有3个类</p><ol class=""><li id="c720" class="mf mg hi ih b ii ij im in iq mt iu mu iy mv jc mk ml mm mn bi translated">购买</li><li id="cf8e" class="mf mg hi ih b ii mo im mp iq mq iu mr iy ms jc mk ml mm mn bi translated">出售</li><li id="f3fe" class="mf mg hi ih b ii mo im mp iq mq iu mr iy ms jc mk ml mm mn bi translated">强力买入</li><li id="4342" class="mf mg hi ih b ii mo im mp iq mq iu mr iy ms jc mk ml mm mn bi translated">强势销售</li></ol><p id="bc1c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们增加了另一个名为“持有”的类别标签，你只需持有股票。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mw"><img src="../Images/f22b7cc5f89b5ee0ff05c848ce03d3fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VX_xAQTtHExcs1av04g2zA.png"/></div></div></figure><p id="1637" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种阶层失衡是意料之中的，大多数时候你只需要持有股票，而不是买卖。</p><p id="2053" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看我们有什么栏目</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mx"><img src="../Images/c7486510ea46c7b15954f414c92e9d2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F1MDbtsxj65GwEBmAX228A.png"/></div></div></figure><p id="76a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看数据中有哪些公司</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mx"><img src="../Images/85a883e0b1ab5cf146d06bc21004ee38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b5TwJdz1zdxTBmesjuyJBQ.png"/></div></div></figure><p id="3b43" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些都是美国公司。</p><p id="621d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们知道班级是不平衡的，让我们看看百分比分布</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es my"><img src="../Images/b1b27000602907a02dbdafaae3fc3fce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YlsC-8nW_-0VmMwYSB4JYg.png"/></div></div></figure><h2 id="dea2" class="kz jx hi bd jy la lb lc kc ld le lf kg iq lg lh kk iu li lj ko iy lk ll ks lm bi translated">单变量和双变量分析</h2><p id="4f47" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">很难把所有的东西都放在一个博客里，这需要很多博客来覆盖，所以我不会在这个博客里添加详细的数据分析。</p><p id="c30a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请参考我的github个人资料，我把一切都详细。</p><div class="ln lo ez fb lp lq"><a href="https://github.com/Nishesh2115/Stock-Prediction-Project/blob/main/STOCK_ENTRY_EXIT_PREDICTION_ipynb%28AAIC_PROJECT%29.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab dw"><div class="ls ab lt cl cj lu"><h2 class="bd hj fi z dy lv ea eb lw ed ef hh bi translated">股票-预测-项目/股票_进场_出场_预测_ ipynb(AAIC _项目)。ipynb在主…</h2><div class="lx l"><h3 class="bd b fi z dy lv ea eb lw ed ef dx translated">这个项目是关于基于动量交易的股票预测。…</h3></div><div class="ly l"><p class="bd b fp z dy lv ea eb lw ed ef dx translated">github.com</p></div></div><div class="lz l"><div class="mz l mb mc md lz me jn lq"/></div></div></a></div><h1 id="d165" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">降维</h1><p id="4e3e" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">降维是在低维中可视化数据的一种非常好的技术。</p><p id="9f67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个项目中，我主要会用到两种技术</p><p id="e4a9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">PCA(代表主成分分析)这个想法很简单，我们想找到方向f '使得xi在f '上的投影方差最大，这里xi的是数据点。</p><p id="1bfd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">T-sne是一个复杂的想法，但直觉上它试图将高维点嵌入到低维中，这样就很容易将它们可视化。TSNE代表t分布随机邻域嵌入。</p><h2 id="0d77" class="kz jx hi bd jy la lb lc kc ld le lf kg iq lg lh kk iu li lj ko iy lk ll ks lm bi translated">Tsne</h2><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es na"><img src="../Images/775277b1d82bd9cc9007a43051a61caa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2esk8shbM7w1FVhuQqpAFg.png"/></div></div></figure><h2 id="36d6" class="kz jx hi bd jy la lb lc kc ld le lf kg iq lg lh kk iu li lj ko iy lk ll ks lm bi translated">主成分分析</h2><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nb"><img src="../Images/0b5b27e7b4deb5ac1ed529172cf109c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FTz-4ax9QJOAGTFGO4lsXA.png"/></div></div></figure><p id="279a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据数据分析和基于规则的系统的领域知识，在所有功能中，我们只选择了19个功能</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nb"><img src="../Images/cd0eb6e6097cda6ce130bd00ae0cd5f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4yHPSqwuOBk-snihi5zrKw.png"/></div></div></figure><p id="7660" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在问题在于处理不平衡数据。</p><p id="41c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了处理不平衡数据，我尝试了SMOTE技术，SMOTE内部使用最近邻算法来综合产生带有目标变量的数据点，在我们的情况下，我们有大约70%的持有值，9%的销售值，等等，但理想情况下，我们需要40%的持有值，20%的销售值，20%的销售值。</p><p id="f91d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">应用smote后，我们得到</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nc"><img src="../Images/28a868adc8b163960341cf15b9bdacd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iqNlJBXnPWDaEfJDuIzgNQ.png"/></div></div></figure><h2 id="f4ec" class="kz jx hi bd jy la lb lc kc ld le lf kg iq lg lh kk iu li lj ko iy lk ll ks lm bi translated">建模/评估</h2><p id="4d9f" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">我们试过了</p><ol class=""><li id="94af" class="mf mg hi ih b ii ij im in iq mt iu mu iy mv jc mk ml mm mn bi translated">有smote和无smote的逻辑回归。</li><li id="3d7f" class="mf mg hi ih b ii mo im mp iq mq iu mr iy ms jc mk ml mm mn bi translated">有和没有重击的随机森林。</li><li id="7998" class="mf mg hi ih b ii mo im mp iq mq iu mr iy ms jc mk ml mm mn bi translated">GBDT有和没有击打。</li></ol><p id="83ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">建模，hyper参数调优，评测，一切都做得很详细，贴在github上，请看一下。</p><p id="8dd4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不管有没有smote，我们都从GBDT获得了不错的f1分数</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nd"><img src="../Images/89e2d7c78d3477cc11ae9e559928b3f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PWe7V0RJphcs5S0JjIABXw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">GBDT(SMOTE)</figcaption></figure><p id="43c5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看困惑。不带smote的gbdt矩阵</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ne"><img src="../Images/c3f5e23dd47a2da296bf088fa7fbc97d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MCJvXNPID4XvTSvYoHwYrQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">GBDT没有被打败</figcaption></figure><p id="6b33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">没有经过smote的GBDT看起来更有说服力。</p><p id="a2d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用F1 _SCORE宏作为评估指标，因为它对少数民族班级的惩罚最大。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ne"><img src="../Images/4e0e40a664dd3cf5519e38f08ac5d724.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PBaUVcerX4a98tBHIhtiPw.png"/></div></div></figure><h2 id="e2fe" class="kz jx hi bd jy la lb lc kc ld le lf kg iq lg lh kk iu li lj ko iy lk ll ks lm bi translated">可解释AI/ML</h2><p id="049f" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">这是一个非常新的研究领域，每次我们使用机器学习来预测一些事情，了解特定预测背后的推理非常重要，特别是在涉及高风险的医疗和金融行业。</p><p id="ea0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">特定预测背后的推理让我们了解机器学习模型如何以及为什么预测特定的结果。</p><p id="1e99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有两种著名的算法可以很好地完成这项任务:</p><ol class=""><li id="c3c8" class="mf mg hi ih b ii ij im in iq mt iu mu iy mv jc mk ml mm mn bi translated">石灰</li><li id="bcf8" class="mf mg hi ih b ii mo im mp iq mq iu mr iy ms jc mk ml mm mn bi translated">Shap</li></ol><p id="6d46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些算法最好的部分是，它们不关心你正在使用的Ml模型，你可以给出任何ML模型，这些技术将解释特定预测背后的推理。</p><p id="3c38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将在这个项目中使用石灰。</p><p id="2a42" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于Sell，Lime显示的内容是这样的…</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nf"><img src="../Images/8cdb9f45cdd537bd32669191881f7a2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B_A1jGESYeGVdL7rtGOqGw.png"/></div></div></figure><p id="67a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它给出了GBDT预测某一行“卖出”的明确理由</p><p id="7964" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用于购买</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nf"><img src="../Images/fa809436a3abf3e3a59f9564f2dd4fb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RoeF8YUtdfDHr1DHG5udoA.png"/></div></div></figure><p id="e93a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本案例研究到此结束，希望您喜欢。</p><h1 id="dde9" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">模型的再训练</h1><ol class=""><li id="d5c4" class="mf mg hi ih b ii ku im kv iq mh iu mi iy mj jc mk ml mm mn bi translated">根据再培训的结果，我们可以每月或每三个月进行再培训。</li><li id="4953" class="mf mg hi ih b ii mo im mp iq mq iu mr iy ms jc mk ml mm mn bi translated">假设我们提取了截至(2021年8月1日)的数据，并在此基础上建立了一个模型，那么在2021年9月1日，我们将再次获得一个月的数据，我们将提取这些数据，并对整个数据进行再培训(直至2021年9月1日)。我们可以根据这些数据重新训练随机森林、逻辑回归、GBDT，看看结果与上次训练的结果有何不同。</li><li id="f660" class="mf mg hi ih b ii mo im mp iq mq iu mr iy ms jc mk ml mm mn bi translated">在重新训练时，我们需要遵循我们在训练模型时使用的相同过程，但是如果使用一些特征变换可以改善结果，那么这总是一个好主意。</li></ol><h1 id="9714" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">确认</h1><ol class=""><li id="e3c3" class="mf mg hi ih b ii ku im kv iq mh iu mi iy mj jc mk ml mm mn bi translated">模型的验证可以通过观察基于规则的系统来完成。</li><li id="f015" class="mf mg hi ih b ii mo im mp iq mq iu mr iy ms jc mk ml mm mn bi translated">F1分数、多标签混淆矩阵等评估指标也有助于验证模型。</li><li id="316d" class="mf mg hi ih b ii mo im mp iq mq iu mr iy ms jc mk ml mm mn bi translated">像Lime和Shap这样的技术可以帮助我们解释模型的结果。</li></ol><h1 id="18b1" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">尼舍什·戈吉亚</h1><ul class=""><li id="8f06" class="mf mg hi ih b ii ku im kv iq mh iu mi iy mj jc ng ml mm mn bi translated"><strong class="ih hj"> <em class="nh">如果你喜欢这个，</em> </strong> <a class="ae jt" rel="noopener ugc nofollow" target="_blank" href="/@nishesh.kumar"> <strong class="ih hj"> <em class="nh">跟我来这里</em> </strong> </a> <strong class="ih hj"> <em class="nh">了解更多</em> </strong></li><li id="5836" class="mf mg hi ih b ii mo im mp iq mq iu mr iy ms jc ng ml mm mn bi translated"><strong class="ih hj"> <em class="nh">有兴趣合作吗？下面我们连线上</em></strong><a class="ae jt" href="https://www.instagram.com/nishesh_gogia/" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj"><em class="nh">insta gram</em></strong></a></li></ul></div></div>    
</body>
</html>