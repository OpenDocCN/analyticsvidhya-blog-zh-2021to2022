<html>
<head>
<title>Dream11 Team Predictor with Python and Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和机器学习的Dream11团队预测器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/dream11-team-predictor-with-python-and-machine-learning-f0dfce1489eb?source=collection_archive---------0-----------------------#2021-01-09">https://medium.com/analytics-vidhya/dream11-team-predictor-with-python-and-machine-learning-f0dfce1489eb?source=collection_archive---------0-----------------------#2021-01-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c983c55788169a71a903c0b2e5a65af4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y4V8EqKjyWvPwMqfG3tOvw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">孟买印度人vs德里首都，Dream11 IPL 2020决赛</figcaption></figure><p id="7af7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">始于2008年的印度超级联赛，由于其3小时的小形式，已经成为一年一度的两个月节日，从所有板球国家带来了高质量的人才，为他们提供了一个平台，与板球运动中的大牌明星进行比赛，以向印度这样的板球疯狂国家和世界展示。</p><p id="8bc4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">近几年IPL的指数级上升也导致了<strong class="iw hj">奇幻游戏在印度</strong>的流行，这种变化的火炬手是<strong class="iw hj"> Dream11 </strong>。Dream11是一个梦幻体育平台，在这里组织现金竞赛，参赛者需要在每场比赛的22名选手中选择11名选手，并获得最高分以赢得最高奖励。</p><p id="bcc1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">组队规则和约束</strong></p><p id="474b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">你在Dream11上建立的每个板球队都必须有11名球员，其中最多7名球员<strong class="iw hj">可以来自任何一个参加现实生活比赛的球队。</strong></p><p id="33d9" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">您的梦想11可以有不同的球员组合，但必须在100信用上限内，并且必须符合以下团队选择标准:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es js"><img src="../Images/7897434216c267aa1b7d8911bc71cc21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ycl-F1D-6jnbXmciHrsJ2A.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">梦想11团队构成限制</figcaption></figure><p id="566c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">一旦你从所有可供比赛的球员中选出11名球员，你必须为你的球队选出队长和副队长。队长会给你他们在实际比赛中得的<strong class="iw hj"> 2x分</strong>。副队长会给你<strong class="iw hj">1.5倍的分数</strong>他们在实际比赛中的分数。</p><p id="5c33" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><a class="ae jx" href="https://www.linkedin.com/in/madhav-goswami-13018b1a/" rel="noopener ugc nofollow" target="_blank">我</a>和<a class="ae jx" href="https://www.linkedin.com/in/abhishekanand374/" rel="noopener ugc nofollow" target="_blank"> Abhishek Anand </a>在每场比赛前尝试使用机器学习来预测与XI比赛的最佳球队，并试图获得最大的奖励。有很多方法可以解决这个问题。</p><ol class=""><li id="6236" class="jy jz hi iw b ix iy jb jc jf ka jj kb jn kc jr kd ke kf kg bi translated">我们可以使用分类器预测所有8个可能结果中的每个球的结果。每个球的结果可以是点球、1分、2分、3分、4分、5分、6分、出局、加时。(为了简单起见，将所有其他情况放在一边)。在模拟整场比赛后，我们可以结合结果，从22名球员中选出前11名。</li><li id="955c" class="jy jz hi iw b ix kh jb ki jf kj jj kk jn kl jr kd ke kf kg bi translated">我们可以使用ML回归器来预测单个玩家获得的分数，基于角色和玩家在过去对抗对手团队时获得的分数，从当前22名玩家中选择前11名玩家。</li></ol><p id="d912" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">前一种方法被放弃了，因为每个球有太多的状态依赖性，并且在决定两个队的击球顺序方面有许多其他假设。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es km"><img src="../Images/69e3803a2cf6985d980c51100ac315b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*abAkeR_HMpHdlUPM0Qnqvw.png"/></div></div></figure><p id="fb12" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">继续第二种方法，第一步是收集所有IPL的数据。我们使用网络抓取从espncricinfo.com下载所有季节的数据。每场比赛的一个球一个球，比赛投掷，场地，赢家，输家，通过跑垒或三柱门的输赢数据被下载。</p><p id="64f6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">数据准备</strong></p><p id="f7cb" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">为了<a class="ae jx" href="https://github.com/abhishek374/dream11/blob/636dc8b206ed0765ec9a7ac9e006c72abdcf8136/data_prep.py" rel="noopener ugc nofollow" target="_blank">准备数据</a>，对于每场比赛，每个球员的击球、保龄球、防守(在某种程度上)统计数据被捕获在每球数据中。击球手汇总、投球手汇总和玩家角色基于所打的球，决定并存储投球，这可以进一步用于将每个玩家获得的11分转化为梦想。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kn"><img src="../Images/bcd083fa8322ef6a4d5c7203e9e15bb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RsQ0ueZWRZwVmNT816Fe8Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">从espn cricinfo收集的样本匹配数据</figcaption></figure><p id="4674" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Dream11通过一个积分系统给击球手、投球手和外野手打分，你可以在这里找到<a class="ae jx" href="https://www.dream11.com/games/point-system" rel="noopener ugc nofollow" target="_blank"/>。我们用它来将击球和保龄球统计数据转换成每场比赛的11分。</p><p id="6e49" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">一些其他的功能也建立在主队、客场、输赢、移动平均线上。由于COVID 19，IPL 20主场比赛功能不相关，所有比赛的场地都被转移到阿联酋，不允许现场观众。</p><p id="99ae" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">培训模式</strong></p><p id="14f3" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">一旦收集了数据并生成了特征，我们就进入了<a class="ae jx" href="https://github.com/abhishek374/dream11/blob/master/point_prediction.py" rel="noopener ugc nofollow" target="_blank">训练阶段</a>，在此阶段，我们首先使用玩XIs所得分数的移动平均值作为基线来校准我们的ML模型的性能。</p><p id="e9aa" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">使用的ML模型是随机森林、XG boost和Catboost。<a class="ae jx" href="https://www.analyticsvidhya.com/blog/2019/11/shapley-value-machine-learning-interpretability-game-theory/" rel="noopener ugc nofollow" target="_blank"> SHapley加法解释</a> (Shap值)是解读这些机器学习黑盒的一种方式。我们计算了每个特性的Shapley值，看看它们是否有意义:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ko"><img src="../Images/1504f2563f2ddd4ca11cb327c8503253.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3FGQ9H3HHreQje1C6EuIzw.png"/></div></div></figure><p id="7c25" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">选择最佳11 </strong></p><p id="ee0c" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">一旦我们的模型给了我们每个玩家在一场比赛中获得的预测点数，我们就必须应用所有上述的<strong class="iw hj">规则和选择团队的约束</strong>来选择在dream11上选择的最佳团队。我们<a class="ae jx" href="https://github.com/abhishek374/dream11/blob/master/optimized_selection.py" rel="noopener ugc nofollow" target="_blank">使用线性规划</a>来放置这些约束。纸浆图书馆帮助我们实现了这一目标。11名球员的球队选择将基于每个球员的得分/预测的梦想11分和每个球员的信用成本。</p><p id="3552" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">信用成本是众星云集的比赛的一个主要问题，例如，MI vs RCB，你想要Rohit Sharma，Virat Kohli，AB Villiers，Y Chahal，Hardik Pandya，都花费超过10个信用点，但不允许你获得体面的另一半团队的信用点。</p><p id="7dd4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">对于被选中的11名球员，我们的系统将选择前2名球员作为队长和副队长，他们将在比赛中获得2倍和1.5倍的积分。</p><p id="021a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">绩效评估</strong></p><p id="b78a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们应用了所有的约束条件，并根据玩家的实际梦想得分选择了最佳的11个，然后将其与由我们的ML模型预测的得分值和每个玩家的信用产生的最佳11个进行比较。</p><p id="d0ef" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">有两种方法，我们评估模型选择团队的表现:</p><ol class=""><li id="6275" class="jy jz hi iw b ix iy jb jc jf ka jj kb jn kc jr kd ke kf kg bi translated">错误率:在限制条件下，得分与最佳得分团队之间的偏差，例如，22名球员中有11名球员得分最高，11分赢得650分，系统选择的团队得分为450分，然后出现错误。(650–450)/650 = 0.307</li><li id="1b1a" class="jy jz hi iw b ix kh jb ki jf kj jj kk jn kl jr kd ke kf kg bi translated">奖励估计:基于启发式，我们可以很容易地说，赚取的点数是高度右偏的概率分布。排行榜上排名第一和第二的团队获得的积分之间的差异将大于排名100和101的团队。此外，第一组和第二组获得的奖励之间的差异将是1Cr和50 lacs，参加金额为100的4 Cr INR比赛。但是排名100和101的团队将各获得200印度卢比。在错误率的基础上，我们定义了由我们的模型选择的11个玩家获得的奖励。</li></ol><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kp"><img src="../Images/56e846fb1ddbc49ce48a7c2edd3e2b0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VbVYZsvt_ZjBFQHaXmXSCQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">IPL整个赛季获得的奖励预测</figcaption></figure><p id="3744" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">整个系统的性能是根据一个赛季的所有比赛计算的。使用IPLs 2008至2018的数据进行训练，并使用IPL19数据集进行测试。Catboost看起来是所有IPL赛季最有希望和一致的。</p><p id="3377" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们选择Catboost作为预测团队的模型1，并使用1/2 * Catboost + 1/6*移动平均+ 1/6* XGBoost + 1/6*随机森林的集合模型模型2来预测最佳团队。</p><p id="f841" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">IPL 20</strong>每场比赛运行流水线</p><p id="49c4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">我们使用cronjob运行了一个脚本，在比赛开始前15分钟与XI队(每个对手有20-25名可用球员)进行比赛。对这些玩家运行模型以预测每个玩家将获得的分数，然后选择最佳的11名玩家来参加这场比赛的dream11。Pipeline使用Xgboost和catboost算法预测了一个csv，并预测了今天的团队应该选择哪个球员。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kq"><img src="../Images/c7bfde6b03d208c0ba3c704bb5500310.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E9svUiOBj13cZtOuJpyzYQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">预测11 csv从梦境中生成11预测器，用于选择MI对DC决赛IPL 20的球队</figcaption></figure><p id="c5d6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">注意——我们在赛季初手动收集并存储球员成本，这些球员成本会根据每个球员的表现在赛季中发生变化。对于2020年IPL决赛，HH pandya，Ishan Kishan，Q De Kock的球员成本都在10信用点以上。</p><p id="bf5b" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">结论</strong></p><p id="f1ca" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">2020赛季的Catboost模型给了我们积极的结果，但是数量并不显著，这给该方法带来了限制。模型的团队在超过65%的比赛中处于有利地位，但是模型无法获得这些比赛的最佳团队(如果我们能够获得哪怕一场比赛的最佳团队，我就不会写这篇文章，而是在某个海滩上喝冷饮)。</p><p id="7623" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">选择队长和副队长对你的团队进入排行榜至关重要，因为他们获得的dream11积分会成倍增加。如果他们没有被正确选择，你的团队很少有机会取得好成绩。可以创建单独的模型来更好地预测这些。</p><p id="d3ff" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">IPL是一年一度的赛事，两者之间有10个月的间隔，球员的表现和状态都在变化，还有很多我们可以考虑的其他因素，如球员在其他T20比赛中的表现，天气，球场条件，球员的年龄(记得看到Dhoni女士在双跑后第一次筋疲力尽)等。当前的方法更适合于玩家排名是单个锦标赛表现的集合的锦标赛。</p><p id="7033" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><a class="ae jx" href="https://github.com/abhishek374/dream11" rel="noopener ugc nofollow" target="_blank"> Github回购链接</a></p></div></div>    
</body>
</html>