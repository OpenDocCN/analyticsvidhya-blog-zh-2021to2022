<html>
<head>
<title>Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">线性回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/linear-regression-f1a50fd995dc?source=collection_archive---------6-----------------------#2021-08-12">https://medium.com/analytics-vidhya/linear-regression-f1a50fd995dc?source=collection_archive---------6-----------------------#2021-08-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="604b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">线性回归是一种试图以线性方式预测因变量Y和自变量X之间关系的回归模型。</p><p id="aeb8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">y=mx+c</p><p id="a7cd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">它是一个回归模型，这意味着它用于预测连续值。</p><p id="48c5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">例如:</strong>股票预测、保险金额预测、贷款金额预测、房价预测等..</p><p id="7f82" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">使用SKlearn实现线性回归。</strong></p><p id="66ee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">标准标量</strong>以均值=0，标准差=1的方式转换数据，这是标准正态分布。</p><p id="466b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">标准标量如何影响测试数据？</p><p id="a8b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">使用RFECV(递归特征消除和交叉验证)的特征选择</strong></p><p id="b55f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以递归方式消除不重要的特征。</p><ol class=""><li id="9e88" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">模型-您想要训练的机器学习算法。</li><li id="5c76" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">步长-确定我们想要在onw迭代中消除多少特征，步长为1是一个不错的选择。</li><li id="876c" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">Min_features_to_select当RFECV递归迭代时，我们需要强制停止它。</li></ol><p id="120a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">a.如果我们至少一次排除了所有的特征。</p><p id="9e1c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">b.如果我们达到了最小特征数阈值。</p><p id="a8dc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> RFECV有助于特性排名</strong></p><p id="9876" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">根据各要素与主得分的偏差对其进行排名</p><ol class=""><li id="71c1" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">如果得分大幅下降:重要特征</li><li id="4039" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">如果得分下降较低:不太重要的功能</li><li id="d283" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">如果分数没有下降:不重要的特征(没有影响)</li></ol><p id="1b82" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">得分低是由于预测列中值的分布和偏斜。</p><p id="e561" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> K线交叉折叠验证</strong></p><p id="fc40" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将我们的数据分成k个折叠，其中k一般在5到10之间。1折用于测试，其余(k-1)折用于培训。不断重复这个过程，直到我们至少使用了一次每个折叠进行测试。</p><p id="5f67" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">缺点</strong></p><p id="d144" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们在每次迭代中重新创建训练和测试分割，并从头开始训练我们的模型。</p><p id="988d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">a.如果k=5，我们需要训练模型5次。</p><p id="2b0c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">乙。当数据太大或k值很高时，计算开销很大。</p><p id="4507" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从sklearn.model_selection导入Kfold</p><p id="5059" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">列车试运行的缺点</strong></p><ol class=""><li id="e5b4" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">20%的测试数据太小，无法对预测充满信心。</li><li id="32ff" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">我们不会验证剩余80%的数据，因为我们已经对其进行了培训..</li></ol><p id="7e79" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">a.也许我们可以用这80%来提高我们对预测的信心。</p><p id="f089" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">分析回归模型的性能。</strong></p><p id="49e9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了理解回归模型的性能，我们需要理解损失函数的概念。</p><p id="a710" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">损失函数</strong></p><ol class=""><li id="21bf" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">外部模型在训练阶段试图最小化的目标函数</li></ol><p id="e3e3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">a.当模型出错时，通过惩罚它来帮助模型做出更好的预测。</p><p id="93e5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.消极导向，越低越好。</p><p id="f8ab" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">a.当损失较高时，模型被严重扣分。</p><p id="ae20" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">回归模型的两个主要损失函数是</strong></p><ol class=""><li id="7e9d" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated"><strong class="ig hi"> MAE-平均绝对误差- </strong>与原始值相比，预测误差的平均幅度</li><li id="8b4f" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated"><strong class="ig hi"> RMSE-均方根误差- </strong>原始值和预测值之差的均方根。</li></ol><p id="9553" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">哪个更好？</p><ol class=""><li id="f370" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">MAE和RMSE的范围都是从0到无穷大，但是RMSE的值总是大于或等于MAE。</li></ol><p id="81cf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">a.当所有数据点的原始值和预测值之间的差异相等时，相等条件达到。</p><p id="f03b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.误差在被平均之前被平方，RMSE对较大的误差给予相对较高的权重</p><p id="42cb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">a.当模型做出错误的预测时，RMSE比MAE更有效地惩罚了模型。</p><p id="3601" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> R2得分和调整后的R2得分直觉</strong></p><p id="35c7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">r平方用于确定特征和目标之间的相关强度。</p><p id="46fe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">a.它让我们知道与平均值相比，回归模型有多好。</p><p id="b870" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">公式</strong>为(R2)R平方= 1-SSR/SST</p><p id="6675" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">分析R2</p><ol class=""><li id="b771" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">如果SSR=0，R2将为1，即..Y=Y-hat，这意味着预测值与实际值完全相同，</li></ol><p id="2876" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">a.这永远不会发生，因为精确预测连续值是不可能的。</p><p id="6d02" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.如果SSR=SSt，Rsquare将为0，即..y_hat=y_bar</p><p id="f5ab" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">a.如果我们的预测不比平均值好，那么我们的模型表现很差。</p><p id="ee89" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.R2也可以是负值，这发生在SSR&gt;SST时，</p><p id="1730" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">a.也就是说，我们的预测并没有遵循价值的趋势，而是遵循相反的趋势。</p><p id="b2b7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">R方的缺点</strong></p><ol class=""><li id="9f93" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">通过增加更多的特征数，R平方不断增加，这个性质被称为“R平方膨胀”或“R平方增加的性质”。</li><li id="cc04" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">调整后的R平方能够随着不太重要的变量的增加而减小，从而产生更可靠和准确的评估。</li><li id="81c9" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">调整后的R平方是更好的模型评估器。</li></ol><p id="0ba2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">注- </strong></p><p id="81fc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">主成分分析(PCA) </strong>是一种统计程序，使用正交变换将一组相关变量转换为一组不相关变量。PCA是探索性数据分析和预测模型的机器学习中最广泛使用的工具。此外，PCA是一种无监督的统计技术，用于检查一组变量之间的相互关系。它也被称为一般因素分析，其中回归确定最佳拟合线。</p><p id="8ac2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">决定系数- </strong>这是一种统计测量，在预测给定事件的结果时，检验一个变量的差异如何用第二个变量的差异来解释。</p><p id="614f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">外推法</strong>是指通过假设现有趋势将继续或当前方法将继续适用来估计或推断某事的行为。</p><p id="f85d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">使用案例</strong></p><ul class=""><li id="1941" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jq ji jj jk bi translated">非常强大的统计技术，用于洞察消费者行为，了解业务和影响盈利能力的因素。</li><li id="61d3" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jq ji jj jk bi translated">用于评估趋势并做出预测或估计</li><li id="88d2" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jq ji jj jk bi translated">用于分析产品销售的营销效果、定价和促销。</li><li id="6111" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jq ji jj jk bi translated">在银行业中，线性回归用于根据年龄、以前的贷款、资产、申请的贷款额、职位等来预测特定人员的贷款额</li></ul><p id="166f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">—个人属性的风险越大，提供给他们的贷款就越少。</p><p id="487f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">让我们总结一下</strong></p><p id="335c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">线性回归</strong>用于预测连续值。</p><p id="3b97" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> RFECV </strong> —以递归方式删除不重要的特征</p><ul class=""><li id="7386" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jq ji jj jk bi translated">模型</li><li id="d60b" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jq ji jj jk bi translated">步骤</li><li id="9cec" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jq ji jj jk bi translated">最少功能</li></ul><p id="b8c3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">交叉验证</strong></p><p id="f40a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">绩效指标</strong></p><ul class=""><li id="0945" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jq ji jj jk bi translated">R2评分，调整后的R2评分，梅和RMSE</li></ul></div></div>    
</body>
</html>