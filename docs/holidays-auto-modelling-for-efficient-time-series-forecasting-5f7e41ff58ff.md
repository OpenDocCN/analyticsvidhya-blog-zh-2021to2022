# 用于有效时间序列预测的假期自动建模

> 原文：<https://medium.com/analytics-vidhya/holidays-auto-modelling-for-efficient-time-series-forecasting-5f7e41ff58ff?source=collection_archive---------0----------------------->

![](img/3c515cf2c0b883d9a310b8354f7aab72.png)

[菠萝供应公司](https://unsplash.com/@pineapple?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

在零售业中处理预测通常意味着需要为一些特殊事件(如促销活动或假期)调整未来销售。我们在官方、非官方或宗教节日前后观察到的那些过度销售背后有着自然的消费模式:顾客可能希望为庆祝活动预付费用，或者可能需要在之后补充供应。有时他们也享受很大的折扣，或者可能只是在假期期间有足够的自由时间(由于法定假日)购物。

以这种或那种方式，在 [RBC Group](https://www.rbcgrp.com/ua/) 我们将当地节假日日历添加到我们的时间序列预测模型中，作为经验法则。我们偶尔用于预测销售额的一些算法，如 [**Prophet**](https://facebook.github.io/prophet/docs/seasonality,_holiday_effects,_and_regressors.html#specifying-custom-seasonalities) 已经有了一个相当方便的现成选项来模拟假期和周期性事件。此外，您可以轻松地将假期延长到日期前后的某个时间段内的几天。例如，除了圣诞节*和感恩节*之外，你可能有理由想把平安夜*和圣诞节*包括在内，或者想把黑色星期五*和感恩节*包括在内。

真正的问题是决定在每种情况下使用哪个窗口大小，因为我们有不同类型业务的客户。因此，假日窗口的设置可以仅考虑业务所有者的专业知识(这通常不是一个好的做法)或分析性的(我们更喜欢这样做)。在后一种情况下，基本思想是收集历史时期内与假日相关的销售统计数据，并计算每个事件的平均窗口，以包括特定日期前后的所有超常销售。此外，我们将在 Kaggle 上著名的 [M5 预测准确性竞赛](https://www.kaggle.com/competitions/m5-forecasting-accuracy)中演示这种方法。

下载完数据后，我们将把争论限制在一个州—*【CA】*(只是为了简单起见):

由于我们不打算在“商店-商品”级别上工作，我们需要组合所有三个数据集，并将我们的目标值— *、【每日销售额】、* —指定为*、*和*、【销售价格】*列的产品。

此外，我们将合计州内所有商店的销售额，以获得公司的每日销售额。现在，我们可以设定一个规则来标记与假期相关的过度销售——在这个演示中，我们将把它们视为**高于 7 天移动平均线**的销售。

对于被视为“与假日相关”的超额销售，需要在假日日期之前或之后进行**观察，即与活动直接相邻。在图上，您可以很容易地观察到红色垂直线(节假日和特殊事件)附近黑色曲线(7 天 MVA)上方的销售额:**

下面是上图的分析表示(1 表示高于正常的销售额，0 表示正常的销售额)。有了这样一个表，人们可以无缝地计算出每个假期的平均(每年)相邻“一”的数量。

计算完成后，我们可以完全自动地以 Prophet 标准模式获得我们的假日日历。

现在是时候评估 Prophet 模型在使用/不使用节假日作为预测因素的情况下的性能了(我们将对 2016 年的 143 个观测值进行测试，以良好的方式将它们排除在所有之前的计算之外):

看看，这个模型是如何显著地提升了对超级碗(2016-02-07)、*复活节(2016-03-27)*或*五月节(2016-05-05)*前几天的预测。所有这些调整都是通过仅仅考虑历史销售模式的几行代码完成的。每个事件都有一个单独的窗口，用于进一步模拟业务特性，而我们使用一个公共日历，将假日日期作为主要输入。