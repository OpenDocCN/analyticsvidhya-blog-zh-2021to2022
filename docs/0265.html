<html>
<head>
<title>Interfacing R using Python for Bioinformatics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python与生物信息学的R接口</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/interfacing-r-using-python-for-bioinformatics-9387c17344bd?source=collection_archive---------22-----------------------#2021-01-10">https://medium.com/analytics-vidhya/interfacing-r-using-python-for-bioinformatics-9387c17344bd?source=collection_archive---------22-----------------------#2021-01-10</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="c2ec" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">学习使用Rpy2库作为使用python与R接口的一种方式</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/8ea65dffb0d351ee4e91abf519abf4eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iwJVoV7wq0SPrekRPyRWHw.jpeg"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">来源:<a class="ae jm" href="https://www.istockphoto.com/photo/dna-sequence-with-colored-letters-on-black-background-containing-mutation-gm589572010-101296599" rel="noopener ugc nofollow" target="_blank"> iStock照片</a></figcaption></figure><h1 id="10ad" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">介绍</h1><p id="0662" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">在生物信息学中，所有任务都可以使用两种编程语言中的一种来完成:</p><ul class=""><li id="e531" class="lb lc hh kh b ki ld kl le ko lf ks lg kw lh la li lj lk ll bi translated">稀有</li><li id="d6b1" class="lb lc hh kh b ki lm kl ln ko lo ks lp kw lq la li lj lk ll bi translated">计算机编程语言</li></ul><p id="25e6" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">Python是一种高级编程语言，以其<strong class="kh hi">【易于阅读和学习】</strong>格式而闻名。Python可以完成从自动化到数据科学和机器学习的任务。</p><p id="2c8b" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">另一方面，R是一种为<strong class="kh hi">统计和数据处理而设计的编程语言。</strong></p><p id="ebad" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">在过去的几年中，R被生物信息学社区采用为发布新包的头号编程语言，部分原因是Bioconductor(用于下一代测序分析的成熟库集合)和用于高级绘图的ggplot2库。</p><blockquote class="lu lv lw"><p id="c885" class="kf kg lx kh b ki ld ii kk kl le il kn ly lr kq kr lz ls ku kv ma lt ky kz la ha bi translated">但是从我个人的生物信息学经验来看，我的大部分数据争论和操作都是在python和端点分析中完成的，绘图是在R中完成的。但是R几乎可以做Python可以做的任何事情，在统计方面甚至更多。我对R的唯一问题是有时不直观的语法<strong class="kh hi"> ( &lt; -，% &gt; %，variable$attribute) </strong>，但是有一种方法可以解决这个问题，那就是使用python中的rpy2库。</p></blockquote><p id="c34c" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">在这篇文章中，我想展示一个将这个库用于生物信息学的例子。</p></div><div class="ab cl mb mc go md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ha hb hc hd he"><h1 id="3090" class="jn jo hh bd jp jq mi js jt ju mj jw jx in mk io jz iq ml ir kb it mm iu kd ke bi translated">设置环境</h1><ol class=""><li id="95b4" class="lb lc hh kh b ki kj kl km ko mn ks mo kw mp la mq lj lk ll bi translated">下载<a class="ae jm" href="https://docs.anaconda.com/anaconda/install/windows/" rel="noopener ugc nofollow" target="_blank"> Anaconda包</a></li><li id="b935" class="lb lc hh kh b ki lm kl ln ko lo ks lp kw lq la mq lj lk ll bi translated">下载Python 3和R</li><li id="5baf" class="lb lc hh kh b ki lm kl ln ko lo ks lp kw lq la mq lj lk ll bi translated">从<a class="ae jm" href="https://anaconda.org/r/rpy2" rel="noopener ugc nofollow" target="_blank">这里</a>安装rpy2</li><li id="e3fa" class="lb lc hh kh b ki lm kl ln ko lo ks lp kw lq la mq lj lk ll bi translated">打开Jupyter笔记本</li></ol><h1 id="e694" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">下载数据</h1><p id="c0c0" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">在这次演示中，我们将使用来自1000基因组计划的数据。使用下面的<strong class="kh hi"> wget </strong>命令下载项目数据:</p><p id="58fa" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated"><strong class="kh hi"> Linux: </strong></p><pre class="ix iy iz ja fd mr ms mt mu aw mv bi"><span id="ddb8" class="mw jo hh ms b fi mx my l mz na"># Get the data<br/>!wget https://raw.githubusercontent.com/VarunSendilraj/Bioinformatics/main/rpy2_tutorial/1000-genomes_other_sample_info_sample_info.csv</span></pre><p id="c296" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">如果您在widows或mac上，<strong class="kh hi"> wget </strong>命令将不起作用，因此请使用<strong class="kh hi"> urlib </strong>库:</p><p id="7844" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">Windows/Mac: </p><pre class="ix iy iz ja fd mr ms mt mu aw mv bi"><span id="d2c7" class="mw jo hh ms b fi mx my l mz na">import urllib.request<br/>url = 'https://raw.githubusercontent.com/VarunSendilraj/Bioinformatics/main/rpy2_tutorial/1000-genomes_other_sample_info_sample_info.csv'<br/>filename = 'genomes_other_sample_info_sample_info.csv'<br/>urllib.request.urlretrieve(url, filename)</span></pre><h1 id="a4d7" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">将Python数据帧转换为R数据帧</h1><p id="eab8" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">让我们从导入必要的库开始，打开python数据帧并将其转换为R数据帧:</p><pre class="ix iy iz ja fd mr ms mt mu aw mv bi"><span id="fb7c" class="mw jo hh ms b fi mx my l mz na">#Import Libraries</span><span id="244c" class="mw jo hh ms b fi nb my l mz na">import pandas as pd<br/>import rpy2.robjects as ro<br/>from rpy2.robjects.packages import importr<br/>from rpy2.robjects import pandas2ri<br/>from rpy2.robjects.conversion import localconverter</span></pre><p id="5e82" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">现在让我们打开我们使用pandas<a class="ae jm" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html" rel="noopener ugc nofollow" target="_blank"><strong class="kh hi">read _ CSV</strong></a><strong class="kh hi"/>函数下载的文件:</p><pre class="ix iy iz ja fd mr ms mt mu aw mv bi"><span id="e6cb" class="mw jo hh ms b fi mx my l mz na">df = pd.read_csv('1000-genomes_other_sample_info_sample_info.csv')<br/>df.head()</span></pre><p id="5245" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">使用。head()方法我们能够查看前几行的数据。在我们继续之前，让我们仔细检查这是一个熊猫数据帧:</p><pre class="ix iy iz ja fd mr ms mt mu aw mv bi"><span id="1660" class="mw jo hh ms b fi mx my l mz na">print(type(df))</span><span id="067c" class="mw jo hh ms b fi nb my l mz na">#expected output: &lt;class 'pandas.core.frame.DataFrame'&gt;</span></pre><p id="c47e" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">随着pandas DataFrame到R DataFrame的转换，转换在对浮点和整数值进行编码时遇到了问题，所以让我们从将整个DataFrame转换为一个字符串开始。</p><pre class="ix iy iz ja fd mr ms mt mu aw mv bi"><span id="32a7" class="mw jo hh ms b fi mx my l mz na">#converts values in df into string <br/>df = df.applymap(str)</span><span id="1c80" class="mw jo hh ms b fi nb my l mz na"># Double check that values have changed<br/>print(type(df['In_Final_Phase_Variant_Calling'][0]))</span><span id="78d2" class="mw jo hh ms b fi nb my l mz na">#Expected output: &lt;class 'str'&gt;</span></pre><p id="94de" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">现在让我们使用rpy2库中的<a class="ae jm" href="https://rpy2.github.io/doc/v3.0.x/html/generated_rst/pandas.html" rel="noopener ugc nofollow" target="_blank"><strong class="kh hi">local converter</strong></a>将熊猫数据帧转换为R数据帧:</p><pre class="ix iy iz ja fd mr ms mt mu aw mv bi"><span id="52bb" class="mw jo hh ms b fi mx my l mz na">#conversion<br/>with localconverter(ro.default_converter + pandas2ri.converter):<br/>  r_df = ro.conversion.py2rpy(df)</span><span id="5f17" class="mw jo hh ms b fi nb my l mz na">#Check if conversion Worked<br/>print(type(r_df))</span><span id="e013" class="mw jo hh ms b fi nb my l mz na">#Expected output: rpy2.robjects.vectors.DataFrame</span></pre><h1 id="4558" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">使用rpy2转换数据类型</h1><p id="3723" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">在我们继续之前，让我们更好地理解我们的数据:</p><pre class="ix iy iz ja fd mr ms mt mu aw mv bi"><span id="00eb" class="mw jo hh ms b fi mx my l mz na">print(f'This dataframe has {r_df.ncol} columns and {r_df.nrow} rows\n')<br/>print(r_df.colnames)</span></pre><p id="245a" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">这里我们只是打印出数据框中不同的列。输出应该如下所示:</p><pre class="ix iy iz ja fd mr ms mt mu aw mv bi"><span id="f5a4" class="mw jo hh ms b fi mx my l mz na">This dataframe has 62 columns and 3500 rows<br/><br/> [1] "Sample"                              "Family_ID"                          <br/> [3] "Population"                          "Population_Description"             <br/> [5] "Gender"                              "Relationship"                       <br/> [7] "Unexpected_Parent_Child"             "Non_Paternity"                      <br/> [9] "Siblings"                            "Grandparents"                       <br/>[11] "Avuncular"                           "Half_Siblings"                      <br/>[13] "Unknown_Second_Order"                "Third_Order"                        <br/>[15] "In_Low_Coverage_Pilot"               "LC_Pilot_Platforms"                 <br/>[17] "LC_Pilot_Centers"                    "In_High_Coverage_Pilot"             <br/>[19] "HC_Pilot_Platforms"                  "HC_Pilot_Centers"                   <br/>[21] "In_Exon_Targetted_Pilot"             "ET_Pilot_Platforms"                 <br/>[23] "ET_Pilot_Centers"                    "Has_Sequence_in_Phase1"             <br/>[25] "Phase1_LC_Platform"                  "Phase1_LC_Centers"                  <br/>[27] "Phase1_E_Platform"                   "Phase1_E_Centers"                   <br/>[29] "In_Phase1_Integrated_Variant_Set"    "Has_Phase1_chrY_SNPS"               <br/>[31] "Has_phase1_chrY_Deletions"           "Has_phase1_chrMT_SNPs"              <br/>[33] "Main_project_LC_Centers"             "Main_project_LC_platform"           <br/>[35] "Total_LC_Sequence"                   "LC_Non_Duplicated_Aligned_Coverage" <br/>[37] "Main_Project_E_Centers"              "Main_Project_E_Platform"            <br/>[39] "Total_Exome_Sequence"                "X_Targets_Covered_to_20x_or_greater"<br/>[41] "VerifyBam_E_Omni_Free"               "VerifyBam_E_Affy_Free"              <br/>[43] "VerifyBam_E_Omni_Chip"               "VerifyBam_E_Affy_Chip"              <br/>[45] "VerifyBam_LC_Omni_Free"              "VerifyBam_LC_Affy_Free"             <br/>[47] "VerifyBam_LC_Omni_Chip"              "VerifyBam_LC_Affy_Chip"             <br/>[49] "LC_Indel_Ratio"                      "E_Indel_Ratio"                      <br/>[51] "LC_Passed_QC"                        "E_Passed_QC"                        <br/>[53] "In_Final_Phase_Variant_Calling"      "Has_Omni_Genotypes"                 <br/>[55] "Has_Axiom_Genotypes"                 "Has_Affy_6_0_Genotypes"             <br/>[57] "Has_Exome_LOF_Genotypes"             "EBV_Coverage"                       <br/>[59] "DNA_Source_from_Coriell"             "Has_Sequence_from_Blood_in_Index"   <br/>[61] "Super_Population"                    "Super_Population_Description"</span></pre><p id="18b0" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">现在，我们需要执行一些数据清理。例如，一些列应该被解释为整数或浮点数，但是它们被读取为字符串:</p><p id="5f2b" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">让我们从定义<a class="ae jm" href="https://r-lang.com/as-numeric-r/" rel="noopener ugc nofollow" target="_blank"> <strong class="kh hi">为_numeric </strong> </a>和<a class="ae jm" href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/match" rel="noopener ugc nofollow" target="_blank"> <strong class="kh hi"> match </strong> </a>函数开始:</p><pre class="ix iy iz ja fd mr ms mt mu aw mv bi"><span id="ddfe" class="mw jo hh ms b fi mx my l mz na">#define the as_numeric function<br/>as_numeric = ro.r('as.numeric')</span><span id="ed8c" class="mw jo hh ms b fi nb my l mz na">#define the Match function<br/>match = ro.r.match</span></pre><p id="60aa" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">功能:</p><ul class=""><li id="4509" class="lb lc hh kh b ki ld kl le ko lf ks lg kw lh la li lj lk ll bi translated"><strong class="kh hi"> as_numeric </strong>:将字符串转换为整数值或浮点值</li><li id="cbc4" class="lb lc hh kh b ki lm kl ln ko lo ks lp kw lq la li lj lk ll bi translated"><strong class="kh hi">匹配</strong>:类似python索引函数</li></ul><p id="27cd" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">因为有许多列需要转换成数字，所以让我们将这些列名存储在一个列表中并遍历它:</p><pre class="ix iy iz ja fd mr ms mt mu aw mv bi"><span id="4bdb" class="mw jo hh ms b fi mx my l mz na">#columns<br/>numCol = ['Has_Sequence_in_Phase1','In_Phase1_Integrated_Variant_Set','Has_Phase1_chrY_SNPS','Has_phase1_chrY_Deletions','Has_phase1_chrMT_SNPs','LC_Passed_QC','E_Passed_QC','In_Final_Phase_Variant_Calling','Has_Omni_Genotypes', 'Has_Axiom_Genotypes','Has_Affy_6_0_Genotypes','Has_Exome_LOF_Genotypes', 'Has_Sequence_from_Blood_in_Index', 'Total_LC_Sequence', 'LC_Non_Duplicated_Aligned_Coverage','Total_Exome_Sequence', 'X_Targets_Covered_to_20x_or_greater', 'VerifyBam_E_Omni_Free', 'VerifyBam_E_Affy_Free', 'VerifyBam_E_Omni_Chip', 'VerifyBam_E_Affy_Chip', 'VerifyBam_LC_Omni_Free', 'VerifyBam_LC_Affy_Free','VerifyBam_LC_Omni_Chip','VerifyBam_LC_Affy_Chip', 'LC_Indel_Ratio', 'E_Indel_Ratio', 'EBV_Coverage']</span><span id="8bb1" class="mw jo hh ms b fi nb my l mz na">#loop<br/>for col in numCol:<br/>    my_col = match(col, r_df.colnames)[0] #returned as a vector <br/>    print('Type of read count before as.numeric: %s' % r_df[my_col - 1].rclass[0])<br/>    r_df[my_col - 1] = as_numeric(r_df[my_col - 1])<br/>    print('Type of read count after as.numeric: %s' % r_df[my_col - 1].rclass[0])</span></pre><p id="e97c" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">结果应该如下所示(确保所有列都转换为数字):</p><pre class="ix iy iz ja fd mr ms mt mu aw mv bi"><span id="feec" class="mw jo hh ms b fi mx my l mz na">Type of read count before as.numeric: character<br/>Type of read count after as.numeric: numeric<br/>Type of read count before as.numeric: character<br/>Type of read count after as.numeric: numeric<br/>Type of read count before as.numeric: character<br/>Type of read count after as.numeric: numeric<br/>Type of read count before as.numeric: character<br/>Type of read count after as.numeric: numeric<br/>Type of read count before as.numeric: character<br/>Type of read count after as.numeric: numeric<br/>...<br/>Type of read count before as.numeric: character<br/>Type of read count after as.numeric: numeric<br/>Type of read count before as.numeric: character<br/>Type of read count after as.numeric: numeric<br/></span></pre><h1 id="01cc" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">使用ggplot2绘制数据</h1><p id="611c" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">现在让我们使用rpy2库中的<a class="ae jm" href="https://ggplot2.tidyverse.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="kh hi"> ggplot2 </strong> </a>来绘制我们的数据。</p><p id="c71a" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">让我们从制作一个柱状图开始，绘制每个国家参与<a class="ae jm" href="https://console.cloud.google.com/storage/browser/genomics-public-data/1000-genomes/other/sample_info;tab=objects?prefix=&amp;forceOnObjectsSortingFiltering=false" rel="noopener ugc nofollow" target="_blank"> <strong class="kh hi"> 1000基因组计划</strong> </a>的人数:</p><pre class="ix iy iz ja fd mr ms mt mu aw mv bi"><span id="8970" class="mw jo hh ms b fi mx my l mz na">#import ggplot2<br/>import rpy2.robjects.lib.ggplot2 as ggplot2<br/>from rpy2.robjects.functions import SignatureTranslatedFunction</span><span id="eaa0" class="mw jo hh ms b fi nb my l mz na">#set theme<br/>ggplot2.theme = SignatureTranslatedFunction(ggplot2.theme, init_prm_translate = {'axis_text_x': 'axis.text.x'})</span><span id="bd3c" class="mw jo hh ms b fi nb my l mz na">#plot<br/>bar = ggplot2.ggplot(r_df) + ggplot2.geom_bar() + ggplot2.aes_string(x='Population') + ggplot2.theme(axis_text_x=ggplot2.element_text(angle=90, hjust=1))</span><span id="2327" class="mw jo hh ms b fi nb my l mz na">#save to img<br/>ro.r.png('out.png', type='cairo-png')<br/>bar.plot()<br/>dev_off = ro.r('dev.off')<br/>dev_off()</span></pre><p id="aaf8" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">这可能看起来有点吓人，但它主要只是样板代码:</p><ul class=""><li id="9523" class="lb lc hh kh b ki ld kl le ko lf ks lg kw lh la li lj lk ll bi translated">绘图代码:</li></ul><blockquote class="lu lv lw"><p id="b64d" class="kf kg lx kh b ki ld ii kk kl le il kn ly lr kq kr lz ls ku kv ma lt ky kz la ha bi translated">bar = gg plot 2 . gg plot(seq _ data)+gg plot 2 . geom _ bar()+gg plot 2 . AES _ string(x = ' CENTER _ NAME ')+gg plot 2 . theme(axis _ text _ x = gg plot 2 . element _ text(angle = 90，hjust=1))</p></blockquote><ul class=""><li id="98a9" class="lb lc hh kh b ki ld kl le ko lf ks lg kw lh la li lj lk ll bi translated">格式:</li></ul><blockquote class="lu lv lw"><p id="7a7f" class="kf kg lx kh b ki ld ii kk kl le il kn ly lr kq kr lz ls ku kv ma lt ky kz la ha bi translated">variableName = gg plot 2 . gg plot(* * data frame * *)+gg plot。** GRAPH _ TYPE * *+gg plot 2 . AES _ string(X = ' * * X轴* * ')+gg plot 2 . THEME(* *根据需要调整主题* *)</p></blockquote><p id="71ce" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">最后，图表将存储在pdf文件中，但您也可以在您的笔记本中查看该文件:</p><pre class="ix iy iz ja fd mr ms mt mu aw mv bi"><span id="cbde" class="mw jo hh ms b fi mx my l mz na">from IPython.display import Image</span><span id="c0bd" class="mw jo hh ms b fi nb my l mz na">Image(filename='out.png')</span></pre><p id="3f3d" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">图表:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es nc"><img src="../Images/28614a24e36fb907604f6be001e580e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*51LRePa3qqaVFRHsAasAZA.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图片作者:Varun Sendilraj</figcaption></figure><p id="1896" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">同样，让我们创建一个散点图来比较<strong class="kh hi"> Total_LC_Sequence </strong>和<strong class="kh hi">LC _ Non _ Duplicated _ Aligned _ Coverage</strong>与<strong class="kh hi">人口</strong>和<strong class="kh hi">性别:</strong></p><pre class="ix iy iz ja fd mr ms mt mu aw mv bi"><span id="eeda" class="mw jo hh ms b fi mx my l mz na">#plot<br/>pp = ggplot2.ggplot(r_df) + ggplot2.aes_string(x='Total_LC_Sequence', y='LC_Non_Duplicated_Aligned_Coverage', col='Population', shape='Gender') + ggplot2.geom_point()</span><span id="2cf8" class="mw jo hh ms b fi nb my l mz na">#save img<br/>ro.r.png('scatter.png', type='cairo-png')<br/>pp.plot()<br/>dev_off = ro.r('dev.off')<br/>dev_off()</span><span id="3a11" class="mw jo hh ms b fi nb my l mz na">#veiw img<br/>Image(filename='scatter.png')</span></pre><p id="c93a" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">图表:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es nc"><img src="../Images/020572402f83e7f676416c9da6571527.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*QZ4EYZVoSahO4CeoEzuQBQ.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图片作者:Varun Sendilraj</figcaption></figure><p id="23b3" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">我们也可以使用上面的相同数据绘制箱线图:</p><pre class="ix iy iz ja fd mr ms mt mu aw mv bi"><span id="60be" class="mw jo hh ms b fi mx my l mz na">#plot<br/>bp = ggplot2.ggplot(r_df) + ggplot2.aes_string(x='Total_LC_Sequence', y='LC_Non_Duplicated_Aligned_Coverage', fill='Population') + ggplot2.geom_boxplot()</span><span id="301e" class="mw jo hh ms b fi nb my l mz na">#save img<br/>ro.r.png('box.png', type='cairo-png')<br/>bp.plot()<br/>dev_off = ro.r('dev.off')<br/>dev_off()</span><span id="b3ed" class="mw jo hh ms b fi nb my l mz na">#veiw img<br/>Image(filename='box.png')</span></pre><p id="f053" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">图表:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es nc"><img src="../Images/da19ec8451b84a222a7ff50007b17890.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*NJ7mJk5Tj5iVQEJOZNl5Pw.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图片作者:Varun Sendilraj</figcaption></figure><p id="5038" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">使用ggplot2可以做更多的事情。如果您想了解更多信息，请参考关于使用rpy2绘制的文档。</p></div><div class="ab cl mb mc go md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ha hb hc hd he"><p id="bde5" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">完整的Jupyter笔记本:</p><p id="ee19" class="pw-post-body-paragraph kf kg hh kh b ki ld ii kk kl le il kn ko lr kq kr ks ls ku kv kw lt ky kz la ha bi translated">【github.com】</p></div></div>    
</body>
</html>