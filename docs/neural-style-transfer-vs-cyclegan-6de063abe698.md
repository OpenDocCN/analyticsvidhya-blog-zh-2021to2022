# 神经类型转移 vs CycleGAN

> 原文：<https://medium.com/analytics-vidhya/neural-style-transfer-vs-cyclegan-6de063abe698?source=collection_archive---------7----------------------->

![](img/2272f749c43f470bda753e749271a10c.png)

去年夏天我在实习的时候参与了一个项目。我的任务是拍摄晴朗和晴朗的天空图像，并将它们转换成阴雨的图像。我想在这里写下我的研究历程，以及我在项目中遇到的不同架构之间的比较。

![](img/3ff76740040efefe71916e5596022408.png)

图片分为内容和风格两大部分。一幅图像的内容，你可以从它的名字、形状和图像中的主线来理解。你可以像看灰度图像一样思考，没有颜色也没有样式，只有形状和线条。另一部分是图像的风格，可以说是图像中颜色的分布。一幅图像有多亮，哪些颜色更强烈，什么是主调，喜欢热色还是冷色……这些都是关于图像风格的问题。人们认为，如果图像由两部分组成，为什么我们不能改变其中的一部分，而另一部分是固定的。

# **艺术风格的神经算法**

![](img/c8c5939c67f5682b54b7e66268582151.png)

有两个问题摆在那些认为可以改变图像的一个属性而另一个属性不变的人面前。首先，他们如何将图像分为风格和内容，其次，他们如何改变不固定的部分。正如你从[论文的名字](https://arxiv.org/pdf/1508.06576.pdf)中可以理解的，他们决定使用神经网络来完成这两项任务。神经网络通常用于预测复杂的任务，但在这种情况下，我们不必预测任何事情。我们只需要知道网络的哪一部分学习图像的风格，哪一部分学习内容。因此，他们使用了一种没有预测层或展平层的架构。当然，他们在处理图像数据时使用了卷积神经网络。CNN 中的过滤器已经被用于从图像中提取特征。我们可以认为内容和风格也是图像的特征。因此，根据这些信息，我们可以通过查看下图来了解该架构:

![](img/d9e59fc9bb702a30a19eefe392db71b0.png)

现在，我们知道他们如何将风格与内容分开。他们还想在一部分固定的情况下改变一部分。对于该任务，应该有两个名为样式图像和内容图像的图像，样式图像将用于输出图像的样式，内容图像将用于输出图像的内容。因此，您可以认为我们正在组合两个图像，并创建一个包含这两个图像的不同特征的图像。样式和内容的效果可以像*一样加权 0.3×样式+0.7×内容。*

> 我们最小化的损失函数是 **Ltotal(~p，~a，~x) = αLcontent(~p，~x) + βLstyle(~a，~x)** 其中 **α和β分别是内容和风格重建的加权因子**。(来自论文)

→您可以在浏览器中从[这里](https://reiinakano.com/arbitrary-image-stylization-tfjs/)和[这里](https://deepart.io)在线尝试风格转换。

首先，我尝试为我的*变化的天气条件*项目使用神经风格转移。内容图片是我想要转换的阳光图片，风格图片是我想要取其风格的阴雨图片。结果对任务来说不够好。

# CycleGAN

所以在我尝试了风格转移之后，我找到了另一个名为 [CycleGAN](https://junyanz.github.io/CycleGAN/) 的架构。

[生成对抗网络](https://arxiv.org/pdf/1406.2661.pdf)用于生成从不存在的图像。正常的 GAN 架构使用两个网络。一个负责从随机噪声中生成图像。另一个负责将生成的(伪)图像与真实图像区分开来。

![](img/093169039dbe821070e7f1371db9f208.png)

CycleGAN 架构的工作方式不同于普通 GAN 架构，并且比普通 GAN 架构大得多，因为它使用四个网络，其中两个负责生成，两个负责鉴别。

![](img/d0405dcf8575b4a984d9d171b1410db9.png)

神经类型转移和 CycleGAN 之间的主要区别是，CycleGAN 不使用成对图像来从一个图像转换到另一个图像，这与神经类型转移相反。正如你所记得的，如果我们想使用神经风格转移，我们必须有两个图像，一个用于内容，一个用于风格。然而现在，我们可以用斑马和马这两个类别的许多图片来训练我们的模型(CycleGAN 论文中也使用了这种情况)。培训结束后，模特将学习如何在不要求任何额外样式图像的情况下将一个类转换为另一个类。

![](img/a45c1b9c41509c92e6583652057b9b2f.png)

正如你所看到的，在我的项目中也有类似的例子，比如从夏天到冬天的转换。当我看到这些类似的案例时，我决定也尝试这种架构来应对不断变化的天气条件。在我的案例中，将雨天的图片放在第一类文件夹中，将晴天的图片放在第二类文件夹中，效果比第一种架构要好。

# 神经类型转移 vs CycleGAN

如果你有特定的和少量的图像，你想改变它们的风格，你可以使用神经风格转移。因为在这种架构中，控制权更多地掌握在您手中，而不是在 CycleGAN 中。例如，您可以根据需要更改内容图像或样式图像的权重，也可以为内容图像选择最合适的样式图像。

另一方面，CycleGAN 可以用于像我这样的情况。我有很多类似的图片，这并不重要，哪种风格的图像用于转换或多少重量是从风格的图像。任何下雨的图像都足够了。Model 将学习如何以一般和肤浅的方式从一个类转换到另一个类。这种学习对我来说已经足够了。

![](img/b907893c4ff07077b45c3e1a81108976.png)

我想把我的结果也放在这篇文章里，但是现在不可能了。所以你可以闭上眼睛，想象一个有雨声的雨天。这肯定比看我的结果更让人放松…