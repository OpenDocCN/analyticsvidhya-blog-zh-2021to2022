<html>
<head>
<title>Face Detection Simplified</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简化的人脸检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/face-detection-simplified-5e0aeb729d3d?source=collection_archive---------25-----------------------#2021-02-08">https://medium.com/analytics-vidhya/face-detection-simplified-5e0aeb729d3d?source=collection_archive---------25-----------------------#2021-02-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="6dcb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们看过各种间谍和科幻电影，其中一些秘密服务的监视系统通过搜索或识别他们的数据库来匹配一个身份不明的个人。我们也购买了许多使用面部识别和游戏体验的玩具游戏。</p><p id="155d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在现实世界中，办公室安全、签证和移民、员工出勤的身份验证系统使用人脸生物识别技术。面部识别也用于从通过闭路电视捕获的图像/视频中识别商店扒手。随着移动设备将人脸识别作为无处不在的解锁手机的方式，它也成为了一种非常常见的家居用品。</p><p id="d7ff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这篇博文通过一个例子来解释人脸生物识别技术是如何用于人脸检测、识别和验证的。</p><p id="1772" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">多任务级联卷积网络</strong></p><p id="0561" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">人脸检测是指识别图像或视频中的人脸。脸书标签是一个很好的例子。人脸识别是一种使用人脸生物特征与数据库进行匹配的方法，而人脸验证是一种一对一的匹配，用于认证或验证给定身份的声明。有各种库和算法来执行面部检测。然而，多任务级联卷积网络<strong class="ig hi"> </strong> (MTCNN)是最流行和易于使用的ML库之一，它提供了具有非常高精确度的人脸检测。这是一个非常轻的重量检测器，由于它有较短的推理时间。</p><p id="1d64" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">MTCNN算法由3个阶段组成，从图像中检测人脸的包围盒并识别5个点标志。</p><p id="09a4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">阶段1 </strong>:图像被缩小以创建图像金字塔，由此每个缩小的版本通过CNN。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/f6a91c6d453eab239b3b33973130deee.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*YHeJuIPf1DnaK2T0F9JuKA.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">图像金字塔缩小</figcaption></figure><p id="eb58" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">阶段2 </strong>:提取包围盒的图像块</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jp"><img src="../Images/65467bd2b794aed5777f18788a28c6eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*LxHS_T2fiOTLkeT9gRUqdg.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">包围盒</figcaption></figure><p id="0c4a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">阶段3 </strong>:计算标志点(口左、口右、左眼、右眼、鼻子)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jq"><img src="../Images/45751a4db0983683fe0afd4af24beefc.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*96UT-D8uSXjlnyvs9DZTog.png"/></div><figcaption class="jl jm et er es jn jo bd b be z dx translated">标志点检测</figcaption></figure><p id="118d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">总的来说，MTCNN的3个阶段总结如下:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es jr"><img src="../Images/38ca58d46697c329e5c8bdac5d1adf25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*becdITzGOviRMrESrgtf8A.jpeg"/></div></div></figure><p id="1997" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">MTCNN的python实现的Github链接可在<a class="ae jw" href="https://github.com/ipazc/mtcnn" rel="noopener ugc nofollow" target="_blank">https://github.com/ipazc/mtcnn</a>获得。它基于论文<a class="ae jw" href="https://arxiv.org/abs/1503.03832" rel="noopener ugc nofollow" target="_blank"> FaceNet:人脸识别和聚类的统一嵌入</a></p><p id="e4e6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">环境细节</em>:康达Python3</p><blockquote class="jx jy jz"><p id="a794" class="ie if jc ig b ih ii ij ik il im in io ka iq ir is kb iu iv iw kc iy iz ja jb ha bi translated">pip install mtcnn #用于安装mtcnn库</p><p id="9f55" class="ie if jc ig b ih ii ij ik il im in io ka iq ir is kb iu iv iw kc iy iz ja jb ha bi translated">pip安装tensorflow #tensorflow用于运行mtcnn算法</p><p id="4f50" class="ie if jc ig b ih ii ij ik il im in io ka iq ir is kb iu iv iw kc iy iz ja jb ha bi translated">pip安装cv2-PLT-im show #用于笔记本显示图像</p></blockquote><p id="c447" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将任何图像下载到服务器。我从维基百科下载了下面的图片:<a class="ae jw" href="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8d/President_Barack_Obama.jpg/800px-President_Barack_Obama.jpg" rel="noopener ugc nofollow" target="_blank">https://upload . wikimedia . org/Wikipedia/commons/thumb/8/8d/President _ Barack _ Obama . jpg/800 px-President _ Barack _ Obama . jpg</a></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kd"><img src="../Images/b5a78345ad63dcd2d70de3aee9bf03ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*iKlAaRGNYg-piIwFgrsfPg.png"/></div></figure><p id="9655" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦您成功地将图像加载到cv2或任何其他处理库中，您就可以创建一个用于面部和标志检测的检测器对象。</p><blockquote class="jx jy jz"><p id="c619" class="ie if jc ig b ih ii ij ik il im in io ka iq ir is kb iu iv iw kc iy iz ja jb ha bi translated">detector = mt CNN()<br/>faces = detector . detect _ faces(image)<br/>for face in faces:<br/>print(face)</p></blockquote><p id="8d72" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这将返回一个json对象，带有面部边界框、置信度得分和其他关键点(界标):</p><pre class="je jf jg jh fd ke kf kg kh aw ki bi"><span id="d5e9" class="kj kk hh kf b fi kl km l kn ko">{'box': [178, 45, 118, 148], 'confidence': 0.9990620017051697, 'keypoints': {'left_eye': (213, 103), 'right_eye': (264, 104), 'nose': (237, 132), 'mouth_left': (209, 153), 'mouth_right': (266, 153)}}</span></pre><p id="d3b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，为了直观显示，我们将创建一个函数，以参数化的方式获取这些值:</p><blockquote class="jx jy jz"><p id="e9e5" class="ie if jc ig b ih ii ij ik il im in io ka iq ir is kb iu iv iw kc iy iz ja jb ha bi translated">def create _ bounding _ box(image):<br/>faces = detector . detect _ faces(image)<br/>bounding _ box = faces[0][' box ']#在我们的情况下获得唯一的一个图像<br/>key points = faces[0][' key points ']<br/><br/>cv2 . rectangle(image，(bounding_box[0]，bounding_box[1])，<br/>(bounding _ box[0]+bounding _ box[2]，bounding _ box[1]+bounding _ box[3])</p></blockquote><p id="ab4f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里cv2.rectangle是从openCV库中获得的，openCV库通常用于计算机视觉问题，定义如下以绘制矩形，其中起点和终点解释如下</p><p id="08e4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc"> cv2.rectangle(图像，起点，终点，颜色，厚度)</em></p><pre class="je jf jg jh fd ke kf kg kh aw ki bi"><span id="bdcd" class="kj kk hh kf b fi kl km l kn ko">cv2.rectangle(img, (x1, y1), (x2, y2), (255,0,0), 2)<br/><br/><br/>x1,y1 ------<br/>|          |<br/>|          |<br/>|          |<br/>--------x2,y2</span></pre><p id="67f4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">同样，cv2.circle用于在任何图像上画一个圆。</p><p id="c6d4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du kp kq kr kf b">image <strong class="ig hi">=</strong></code> <code class="du kp kq kr kf b">cv2.circle(image, center_coordinates, radius, color, thickness)</code></p><blockquote class="jx jy jz"><p id="e2c3" class="ie if jc ig b ih ii ij ik il im in io ka iq ir is kb iu iv iw kc iy iz ja jb ha bi translated">image _ with _ markers = create _ bounding _ box(image)#方法调用</p><p id="f1ce" class="ie if jc ig b ih ii ij ik il im in io ka iq ir is kb iu iv iw kc iy iz ja jb ha bi translated">cv2 _ PLT _ im show(image _ with _ markers)#用矩形和圆形显示图像</p></blockquote><p id="0458" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">正如你在下面看到的，下面显示了代表面部和面部标志的边界框。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="er es ks"><img src="../Images/58aa7237aed04430a3c6164b3b259ed9.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*QwKN5-0GkTIxjb8J0HHQfw.png"/></div></div></figure><p id="e5ac" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，作为下一步，这一基本逻辑可用于使用一些相似性距离度量(如余弦)或警报系统(入侵者)将面部生物特征与其他图像进行匹配，该警报系统根据相机中检测到的面部采取行动。这可以进一步用于构建企业级用例，如考勤系统、监控、刑事调查等。</p></div></div>    
</body>
</html>