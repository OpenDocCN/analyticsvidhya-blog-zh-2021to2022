<html>
<head>
<title>Migrating SQL Database to Azure Cosmos DB using Migration Tool</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用迁移工具将SQL数据库迁移到Azure Cosmos DB</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/migrating-sql-database-to-azure-cosmos-db-using-migration-tool-19ddaa06792c?source=collection_archive---------22-----------------------#2021-03-12">https://medium.com/analytics-vidhya/migrating-sql-database-to-azure-cosmos-db-using-migration-tool-19ddaa06792c?source=collection_archive---------22-----------------------#2021-03-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/555b330d51fa3f04380821acb90ec203.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*NWFMCkjKbJOMY7q4t1gF9A.png"/></div></figure><p id="ba7a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">当今的应用程序需要高度响应且始终在线。为了实现低延迟和高可用性，这些应用程序的实例需要部署在靠近用户的数据中心。应用程序需要实时响应高峰时段使用量的巨大变化，存储不断增长的数据量，并在几毫秒内将这些数据提供给用户。</p><blockquote class="jk jl jm"><p id="4748" class="im in jn io b ip iq ir is it iu iv iw jo iy iz ja jp jc jd je jq jg jh ji jj hb bi translated">这是一个由Azure提供的名为Cosmos DB的NoSQL数据库</p></blockquote><p id="f00e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">NoSQL数据库的优势</p><ul class=""><li id="6bbd" class="jr js hi io b ip iq it iu ix jt jb ju jf jv jj jw jx jy jz bi translated">向外扩展</li><li id="5639" class="jr js hi io b ip ka it kb ix kc jb kd jf ke jj jw jx jy jz bi translated">模式自由</li><li id="3365" class="jr js hi io b ip ka it kb ix kc jb kd jf ke jj jw jx jy jz bi translated">分布式(副本)</li></ul><p id="6ab1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">利用Azure开发NoSQL宇宙数据库的优势</p><ul class=""><li id="a1bb" class="jr js hi io b ip iq it iu ix jt jb ju jf jv jj jw jx jy jz bi translated">低延迟</li><li id="b752" class="jr js hi io b ip ka it kb ix kc jb kd jf ke jj jw jx jy jz bi translated">高可用性</li><li id="6abf" class="jr js hi io b ip ka it kb ix kc jb kd jf ke jj jw jx jy jz bi translated">多API(核心SQL API)</li><li id="9784" class="jr js hi io b ip ka it kb ix kc jb kd jf ke jj jw jx jy jz bi translated">没有模式管理</li></ul><p id="c9c6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在<strong class="io hj"> Cosmos DB </strong>中，我们需要<strong class="io hj">容器</strong>来保存数据——在容器中，数据以分区的形式保存，如果数据增加，Azure会自动增加分区。</p><p id="2330" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们还可以为不同的数据获取多个容器，因为数据可以存储在相同的容器中，但在不同的分区中，但有些数据必须用更多的Ru处理，而有些则用更少的Ru处理，因此从技术上来说，我们选择不同的容器。</p><p id="655e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们还必须在制作容器时指定分区键，这是针对SQL API的。如果我们部署一个MongoDB API，那么我们必须使用集合而不是容器</p><figure class="kg kh ki kj fd ij er es paragraph-image"><div class="er es kf"><img src="../Images/be378796fa56d4c5b1a33b61ca515345.png" data-original-src="https://miro.medium.com/v2/resize:fit:454/format:webp/1*WFjC04i0VEjYkHyzTN6MfQ.png"/></div></figure><p id="0734" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">从SQL Server迁移数据</strong></p><p id="63f4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">正如我们所知，cosmos DB是一个非结构化的数据库，因此当从SQL Server迁移时，我们将关注模式是否定义良好，因为在cosmos DB中我们不能创建连接，因此需要在文档之间建立良好的关系。</p><p id="f70c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们将需要迁移工具- Azure宇宙数据库数据迁移工具</p><p id="c21a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第一步:</strong></p><p id="0e1e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我们需要选择迁移选项作为SQL，并将连接字符串作为<strong class="io hj"> data source=。；初始目录= AdventureWorks2017集成安全性= true</strong></p><p id="9e4b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">在将查询粘贴到框中之前，请记住创建一个包含所有相关信息的normalize视图，行数将定义要创建的文档数，我们必须使用(<strong class="io hj">)。操作符来创建分区，因为Cosmos DB将使用该操作符来区分嵌套的属性。</strong></p><figure class="kg kh ki kj fd ij er es paragraph-image"><div class="er es kk"><img src="../Images/53cc4b26a6c769ef6111ec7b975d3f34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*vig3rfkYNGafsF18Kj7-vA.png"/></div></figure><p id="d209" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第二步:</strong></p><p id="23e7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">现在，我们将放置cosmos DB的连接字符串，我们将选择主连接字符串，因为它使我们能够完全访问我们将从门户中的密钥部分获得的帐户</p><p id="14bf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">粘贴连接字符串后，必须先创建一个数据库，因为它不会自动生成</p><figure class="kg kh ki kj fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/8d8e29c8482c7060d9db0be206f696c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*838AphtePcFleIBgaIWLtw.png"/></div></figure><p id="8e50" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">不需要选择高级选项并开始导入，要验证导入是否正确，我们可以通过运行上面的查询(预期701行)看到已传输的项目数与SSMS的行数相同。</p><figure class="kg kh ki kj fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/3227b6afed2b6f87c1763f50228ed3a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*pHFhnRioOR9Alhyk0aRxAQ.png"/></div></figure><figure class="kg kh ki kj fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/68a4689494f5bc01df89fbaa35763e7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*RbJ48PcAms6-K2avBLLw9g.png"/></div></figure><p id="feb0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">第三步:</strong></p><p id="38fe" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">然后，我们可以前往门户网站，检查迁移是否成功。</p><figure class="kg kh ki kj fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/ceb53cb137ae31abeb4fcd664f633299.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*MbwVACzOG0yRb1VtCEapUA.png"/></div></figure></div></div>    
</body>
</html>