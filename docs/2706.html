<html>
<head>
<title>2 apply() Method Alternatives You Should Try</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">2 apply()方法您应该尝试的替代方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/2-apply-method-alternatives-you-should-try-909f3f06cec6?source=collection_archive---------3-----------------------#2021-05-14">https://medium.com/analytics-vidhya/2-apply-method-alternatives-you-should-try-909f3f06cec6?source=collection_archive---------3-----------------------#2021-05-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="837f" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">速度和显示你的熊猫系列操作的进展。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/18a5db8c97f46c170abcc03394338140.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-ZVhH8Pz0RuIsUMP"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">由<a class="ae jn" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Markus Spiske </a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="d16c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在这篇文章中，我将举例说明熊猫系列<code class="du kk kl km kn b">.apply()</code>方法的两种替代方法。</p><h2 id="4393" class="ko kp hi bd kq kr ks kt ku kv kw kx ky jx kz la lb kb lc ld le kf lf lg lh li bi translated">先决条件</h2><p id="af71" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">本文假设读者对Python编程和Pandas有基本的了解。</p><h1 id="f74e" class="lo kp hi bd kq lp lq lr ku ls lt lu ky io lv ip lb ir lw is le iu lx iv lh ly bi translated">熊猫系列。apply()方法</h1><p id="9464" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">如果您不知道Pandas series <code class="du kk kl km kn b">.apply()</code>方法是做什么的，这是一种遍历Pandas series中的数据行的有效方法。<code class="du kk kl km kn b">.apply()</code>方法遍历熊猫系列，对熊猫系列中的每一项执行给定的函数。这个方法的行为类似于python默认的<code class="du kk kl km kn b">map()</code>函数。</p><p id="4613" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">因为这篇文章不是关于熊猫系列<code class="du kk kl km kn b">.apply()</code>的方法，我们将直接跳到替代方案。如果你想了解更多关于熊猫系列<code class="du kk kl km kn b">.apply()</code>的方法，请查看下面的链接:</p><ul class=""><li id="0f78" class="lz ma hi jq b jr js ju jv jx mb kb mc kf md kj me mf mg mh bi translated">【熊猫医生】(<a class="ae jn" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.apply.html" rel="noopener ugc nofollow" target="_blank">https://pandas.pydata.org/docs/reference/api/pandas.Series.apply.html</a></li><li id="26bc" class="lz ma hi jq b jr mi ju mj jx mk kb ml kf mm kj me mf mg mh bi translated">[数据营](<a class="ae jn" href="https://www.datacamp.com/community/tutorials/pandas-apply" rel="noopener ugc nofollow" target="_blank">https://www.datacamp.com/community/tutorials/pandas-apply</a>)</li></ul><h1 id="2814" class="lo kp hi bd kq lp lq lr ku ls lt lu ky io lv ip lb ir lw is le iu lx iv lh ly bi translated">可供选择的事物</h1><p id="0815" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">本文中我们将看到的两种替代方法是<code class="du kk kl km kn b">.parallel_apply()</code>方法和<code class="du kk kl km kn b">.progress_apply()</code>方法。</p><ul class=""><li id="1145" class="lz ma hi jq b jr js ju jv jx mb kb mc kf md kj me mf mg mh bi translated"><code class="du kk kl km kn b">.parallel_apply()</code>如果你想加快一点速度的方法(用于多重处理)</li><li id="488d" class="lz ma hi jq b jr mi ju mj jx mk kb ml kf mm kj me mf mg mh bi translated"><code class="du kk kl km kn b">.progress_apply()</code>方法，如果你想显示熊猫系列操作的进度。</li></ul><h1 id="fbf1" class="lo kp hi bd kq lp lq lr ku ls lt lu ky io lv ip lb ir lw is le iu lx iv lh ly bi translated">pandarallel的parallel_apply()</h1><p id="8a1f" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">使用Pandas <code class="du kk kl km kn b">.apply()</code>方法的主要目的是加快运算速度，避免使用循环来迭代数据，但是您可以通过使用<code class="du kk kl km kn b">.parallel_apply()</code>方法将运算分布到计算机中的所有CPU上来使Pandas运算运行得更快。</p><p id="b6ab" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">Pandarallel是一个简单有效的工具，可以在所有可用的CPU上并行执行Pandas操作。</p><p id="6fad" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">来自文件的注释</strong>；</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mn"><img src="../Images/ee6b9863276189759807d5ca10f7dcda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*liKlcCqJ0iCUcs26oIR7kw.png"/></div></div></figure><p id="ac3e" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">简单地说，只有在处理大型数据集时才需要pandarallel。</p><h2 id="d3d2" class="ko kp hi bd kq kr ks kt ku kv kw kx ky jx kz la lb kb lc ld le kf lf lg lh li bi translated">装置</h2><pre class="iy iz ja jb fd mo kn mp mq aw mr bi"><span id="32f3" class="ko kp hi kn b fi ms mt l mu mv">$ pip install pandarallel</span></pre><h2 id="039f" class="ko kp hi bd kq kr ks kt ku kv kw kx ky jx kz la lb kb lc ld le kf lf lg lh li bi translated">使用。parallel_apply()</h2><ul class=""><li id="db51" class="lz ma hi jq b jr lj ju lk jx mw kb mx kf my kj me mf mg mh bi translated">要使用<code class="du kk kl km kn b">.parallel_apply() </code>方法，只需使用<code class="du kk kl km kn b">from pandarallel import pandarallel</code>导入<strong class="jq hj">panda parallel</strong>。</li><li id="238c" class="lz ma hi jq b jr mi ju mj jx mk kb ml kf mm kj me mf mg mh bi translated">使用<code class="du kk kl km kn b">pandarallel.initialize()</code>导入<strong class="jq hj">panda parallel</strong>后初始化。</li><li id="0d8f" class="lz ma hi jq b jr mi ju mj jx mk kb ml kf mm kj me mf mg mh bi translated">用<code class="du kk kl km kn b">.parallel_apply()</code>替换代码中的<code class="du kk kl km kn b">.apply()</code>方法。</li></ul><h2 id="c02b" class="ko kp hi bd kq kr ks kt ku kv kw kx ky jx kz la lb kb lc ld le kf lf lg lh li bi translated">例子</h2><p id="172a" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">在本例中，我们将使用随机生成的10，000，000个数据点的集合。目标是得到数据集中每个数字的平方根。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mz"><img src="../Images/970d6f65902de75c8e2b8479a2532452.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*AmcN1brDlbKV7xK3y4HoUA.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">为我们的数据集生成随机数</figcaption></figure><pre class="iy iz ja jb fd mo kn na bn nb nc bi"><span id="05a4" class="nd kp hi kn b be ne nf l ng mv">from pandarallel import pandarallel # import pandarallel<br/>pandarallel.initialize() # initialize pandarallel<br/><br/># define the funtion you want to apply on the pandas series<br/>def square_root(x):<br/>  """ Return the square root of x """<br/>  return x**0.5<br/><br/># call the parallel_apply(func) method on "numbers" column<br/># store the transformed out to a new column "sqrt"<br/>df['sqrt'] = df['numbers'].parallel_apply(square_root)</span></pre><p id="15c0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在我们生成的数据集上运行上述代码会产生以下输出。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nh"><img src="../Images/1c804713ae2bfd2cab6eb667d173a78a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*pWC9bm4WcFsgYqGkrd2tag.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">运行程序后的输出</figcaption></figure><p id="183a" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">从下面的图片中，您会看到<code class="du kk kl km kn b">.parallel_apply()</code>方法的执行时间比<code class="du kk kl km kn b">.apply()</code>方法要短。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ni"><img src="../Images/a8f79ef4405c1f0625698914c91b9297.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*ZLx7xV-pc8Gs9u-rgAvPTw.png"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nj"><img src="../Images/de7ff3a7b49d742b31a218465fc960c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*1Z6XuboV1_m7utRrbWQVjA.png"/></div></figure><h1 id="a887" class="lo kp hi bd kq lp lq lr ku ls lt lu ky io lv ip lb ir lw is le iu lx iv lh ly bi translated">tqdm中的progress_apply()</h1><p id="b6d0" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">如果您想在执行Pandas系列操作时显示进度指示器，请使用<code class="du kk kl km kn b">.progress_apply()</code>方法。<strong class="jq hj"> progress_apply() </strong>方法是最初创建的<strong class="jq hj"> tqdm </strong>包的一部分，它使您能够创建一个进度表，并估计迭代的“完成时间”。</p><h2 id="aa25" class="ko kp hi bd kq kr ks kt ku kv kw kx ky jx kz la lb kb lc ld le kf lf lg lh li bi translated">装置</h2><pre class="iy iz ja jb fd mo kn mp mq aw mr bi"><span id="4332" class="ko kp hi kn b fi ms mt l mu mv">$ pip install tqdm</span></pre><h2 id="cde5" class="ko kp hi bd kq kr ks kt ku kv kw kx ky jx kz la lb kb lc ld le kf lf lg lh li bi translated">使用。progress_apply()</h2><ul class=""><li id="3bc9" class="lz ma hi jq b jr lj ju lk jx mw kb mx kf my kj me mf mg mh bi translated">使用<code class="du kk kl km kn b">from tqdm import tqdm </code>简单地导入<strong class="jq hj"> tqdm </strong>。</li><li id="f15a" class="lz ma hi jq b jr mi ju mj jx mk kb ml kf mm kj me mf mg mh bi translated">使用<code class="du kk kl km kn b">tqdm.pandas()</code>为熊猫初始化<strong class="jq hj"> tqdm </strong>。</li><li id="b916" class="lz ma hi jq b jr mi ju mj jx mk kb ml kf mm kj me mf mg mh bi translated">用<code class="du kk kl km kn b">.progress_apply()</code>替换代码中的<code class="du kk kl km kn b">.apply()</code>方法。</li></ul><h2 id="1246" class="ko kp hi bd kq kr ks kt ku kv kw kx ky jx kz la lb kb lc ld le kf lf lg lh li bi translated">例子</h2><pre class="iy iz ja jb fd mo kn na bn nb nc bi"><span id="c62a" class="nd kp hi kn b be ne nf l ng mv">from tqdm import tqdm # import tqdm<br/><br/>tqdm.pandas() # initialize tqdm for pandas<br/># call the progress_apply(func) method on "numbers" column<br/># store the transformed out to a new column "sqrt"<br/>df['sqrt'] = df['numbers'].progress_apply(square_root)p</span></pre><p id="5d5f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在我们生成的数据集上运行上述代码会显示以下输出:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nk"><img src="../Images/2ed93813e1dc5d3f3d6f7110304aa3a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*4HdIdraLgerSTqpp_pYCiQ.gif"/></div></div></figure><h1 id="03b6" class="lo kp hi bd kq lp lq lr ku ls lt lu ky io lv ip lb ir lw is le iu lx iv lh ly bi translated">结论</h1><p id="d3ab" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">在本文中，我们已经讨论了两种替代方法，根据您要解决的问题，您可以使用Pandas系列的<code class="du kk kl km kn b"><strong class="jq hj">.</strong>apply<strong class="jq hj">()</strong></code> <strong class="jq hj"> </strong>方法。<code class="du kk kl km kn b">parallel_apply()</code>如果你想加速你的熊猫操作，以及<code class="du kk kl km kn b">progress_apply()</code>如果你想显示你的熊猫操作的进度表。</p><p id="99d0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">建议只有在处理非常大的数据集时才使用<code class="du kk kl km kn b">parallel_apply()</code>。</p><h1 id="e69b" class="lo kp hi bd kq lp lq lr ku ls lt lu ky io lv ip lb ir lw is le iu lx iv lh ly bi translated">信用</h1><ul class=""><li id="c3ee" class="lz ma hi jq b jr lj ju lk jx mw kb mx kf my kj me mf mg mh bi translated">【熊猫医生】(<a class="ae jn" href="https://pandas.pydata.org/docs/reference/api/pandas.Series.apply.html" rel="noopener ugc nofollow" target="_blank">https://pandas.pydata.org/docs/reference/api/pandas.Series.apply.html</a></li><li id="f21b" class="lz ma hi jq b jr mi ju mj jx mk kb ml kf mm kj me mf mg mh bi translated">[数据营](<a class="ae jn" href="https://www.datacamp.com/community/tutorials/pandas-apply" rel="noopener ugc nofollow" target="_blank">https://www.datacamp.com/community/tutorials/pandas-apply</a>)</li><li id="6765" class="lz ma hi jq b jr mi ju mj jx mk kb ml kf mm kj me mf mg mh bi translated">和平行的文件(<a class="ae jn" href="https://github.com/nalepae/pandarallel" rel="noopener ugc nofollow" target="_blank">https://github.com/nalepae/pandarallel</a>)</li><li id="ef00" class="lz ma hi jq b jr mi ju mj jx mk kb ml kf mm kj me mf mg mh bi translated">[S<a class="ae jn" href="https://stackoverflow.com/a/34365537" rel="noopener ugc nofollow" target="_blank">tack overflow</a>(<a class="ae jn" href="https://stackoverflow.com/a/34365537" rel="noopener ugc nofollow" target="_blank">https://stackoverflow.com/a/34365537</a></li><li id="2a1f" class="lz ma hi jq b jr mi ju mj jx mk kb ml kf mm kj me mf mg mh bi translated"><a class="ae jn" href="https://towardsdatascience.com/progress-bars-in-python-and-pandas-f81954d33bae" rel="noopener" target="_blank">https://towards data science . com/progress-bars-in-python-and-pandas-f 81954d 33 BAE</a></li></ul></div></div>    
</body>
</html>