<html>
<head>
<title>Automating a Tableau dashboard with Excel, Google Sheets and Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Excel、Google Sheets和Python实现Tableau仪表板的自动化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/automated-dashboard-with-tableau-excel-python-208805994b7d?source=collection_archive---------4-----------------------#2021-05-18">https://medium.com/analytics-vidhya/automated-dashboard-with-tableau-excel-python-208805994b7d?source=collection_archive---------4-----------------------#2021-05-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/1e42c97e78f757191087a7a58ef49485.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VIic3SzoKvDHDxUY27MDXA.jpeg"/></div></div></figure><h1 id="8a1d" class="iq ir hi bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">内容:</strong></h1><ol class=""><li id="4155" class="jo jp hi jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf bi translated">导入实时数据</li><li id="e0da" class="jo jp hi jq b jr kg jt kh jv ki jx kj jz kk kb kc kd ke kf bi translated">将Tableau连接到实时数据</li><li id="c011" class="jo jp hi jq b jr kg jt kh jv ki jx kj jz kk kb kc kd ke kf bi translated">使用Python刷新数据</li><li id="c60c" class="jo jp hi jq b jr kg jt kh jv ki jx kj jz kk kb kc kd ke kf bi translated">使用Tableau Public创建和发布仪表板</li></ol></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="d014" class="iq ir hi bd is it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn bi translated"><strong class="ak"> 1。导入实时数据</strong></h1><p id="f1cb" class="pw-post-body-paragraph kx ky hi jq b jr js kz la jt ju lb lc jv ld le lf jx lg lh li jz lj lk ll kb hb bi translated">第一个挑战是以自我更新的方式导入<a class="ae lm" href="https://ourworldindata.org/coronavirus-source-data" rel="noopener ugc nofollow" target="_blank">所需的数据</a>。我尝试了几种方法，但是都失败了，因为我要导入的数据太大了。</p><p id="4ff2" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">原始数据源可以在<a class="ae lm" href="https://raw.githubusercontent.com/owid/covid-19-data/master/public/data/owid-covid-data.csv" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h2 id="9cf3" class="ls ir hi bd is lt lu lv iw lw lx ly ja jv lz ma je jx mb mc ji jz md me jm mf bi translated"><strong class="ak"> 1.1 Tableau Web数据连接器(WDC)——适用于静态数据</strong></h2><p id="6920" class="pw-post-body-paragraph kx ky hi jq b jr js kz la jt ju lb lc jv ld le lf jx lg lh li jz lj lk ll kb hb bi translated">我在<a class="ae lm" href="https://tableau.github.io/webdataconnector/community/" rel="noopener ugc nofollow" target="_blank">社区门户</a>上找到了这个<a class="ae lm" href="https://basic-csv-wdc.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">由柯夏萝丝</a>制作的CSV URL连接器。直接将在线CSV导入Tableau是一个很神奇的<a class="ae lm" href="https://help.tableau.com/current/pro/desktop/en-us/examples_web_data_connector.htm" rel="noopener ugc nofollow" target="_blank"> WDC </a>并且简单易用。它甚至有更大文件的快速模式。</p><p id="fb35" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">但是因为一个小问题，我不能使用这个方法。在<a class="ae lm" href="https://public.tableau.com/en-us/s/" rel="noopener ugc nofollow" target="_blank"> Tableau Public </a>上发布时，Tableau工作表和数据打包在一起，这意味着数据无法更新。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/20e1ecd884bc0cc1f048b2c5384002ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vUaFf0mzfn1bxIf5si8reg.png"/></div></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">CSV URL连接器</figcaption></figure><h2 id="3137" class="ls ir hi bd is lt lu lv iw lw lx ly ja jv lz ma je jx mb mc ji jz md me jm mf bi translated"><strong class="ak">1.2 Google Sheets——中小型实时数据的有效替代方案</strong></h2><p id="19c6" class="pw-post-body-paragraph kx ky hi jq b jr js kz la jt ju lb lc jv ld le lf jx lg lh li jz lj lk ll kb hb bi translated">Google Sheets是在Tableau中建立实时连接的最佳方式之一。为了将CSV导入工作表，我使用了<a class="ae lm" href="https://support.google.com/docs/answer/3093335?hl=en" rel="noopener ugc nofollow" target="_blank">导入数据</a>功能。</p><blockquote class="mp mq mr"><p id="8cbd" class="kx ky ms jq b jr ln kz la jt lo lb lc mt lp le lf mu lq lh li mv lr lk ll kb hb bi translated">= import data(" https://raw . githubusercontent . com/owid/新冠肺炎-data/master/public/data/owid-covid-data . CSV ")</p></blockquote><p id="7d7c" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">我真的希望这能解决我的问题，但当我发现Google Sheets对使用该功能导入的数据大小有限制时，我又陷入了困境。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/31f4cf43132e18807906cdf2a776a42e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HfyXA-DA8sZrm_uGzv2Rhw.png"/></div></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">Google工作表错误</figcaption></figure><p id="4c64" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">也就是说，这种方法对于导入较小的文件来建立实时连接非常方便。</p><h2 id="159e" class="ls ir hi bd is lt lu lv iw lw lx ly ja jv lz ma je jx mb mc ji jz md me jm mf bi translated"><strong class="ak"> 1.3 Excel —大型数据集的解决方案</strong></h2><p id="7c27" class="pw-post-body-paragraph kx ky hi jq b jr js kz la jt ju lb lc jv ld le lf jx lg lh li jz lj lk ll kb hb bi translated">在多次尝试失败后，我不得不求助于<a class="ae lm" href="https://victorleungtw.medium.com/getting-real-time-data-from-web-to-excel-467913abe61a#:~:text=First%2C%20open%20Microsoft%20excel%20365,for%20you%20to%20choose%20from." rel="noopener">通过网络连接</a>将数据导入Excel。这种方法在从网站获取数据和直接在excel表格上工作时非常有效。当工作簿关闭时，“每‘x’分钟刷新”选项似乎不起作用。即使工作簿是打开的并且数据在后台更新，用户也必须在退出之前手动保存工作簿，以便将更改反映在最终副本中。</p><p id="549f" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">由于我使用的是指向CSV的原始链接(通常是下载URL ),所以我不得不选择不同的路径。以下是对我有效的方法:</p><p id="908b" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">转到“数据”选项卡。点击“获取外部数据”。然后选择“从文本”。现在输入包含CSV文件的所需URL。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es mx"><img src="../Images/e276e9fc437d2749a5bffb8b85a2372d.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*ThUzyuNUFVDHGr949Bbceg.png"/></div></figure><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es my"><img src="../Images/7537afb5320719c8071d2da6943b1458.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*HQ_4jhZ-G3ogl_i8gko7sg.png"/></div></figure><p id="887e" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">然后按照以下步骤操作:</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es mz"><img src="../Images/c1a89869f3c8764849c1bd893d2a5e60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*WmOTpqaC86rmtxrV7TG28w.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">第一步</figcaption></figure><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es mz"><img src="../Images/405b1a2e0aa44a36e8756378a1087bcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*X5sKKQ7ye5sTWM-9_s-_Zw.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">第二步</figcaption></figure><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es mz"><img src="../Images/26dc6447011036de0b01fa9d282382b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*QW83Rcxu9ta9Wy9zsCsQTQ.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">第三步</figcaption></figure><p id="752e" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">记得保存为. xlsx文件。</p><p id="d0f3" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">完整的数据终于出现了。现在，我需要弄清楚如何使用这个Excel工作簿作为实时连接，并自动刷新数据源。</p></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="5320" class="iq ir hi bd is it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn bi translated">2.将Tableau连接到实时数据</h1><p id="21c9" class="pw-post-body-paragraph kx ky hi jq b jr js kz la jt ju lb lc jv ld le lf jx lg lh li jz lj lk ll kb hb bi translated">尽管现在已经导入了完整的实时数据并可以使用，但我不能直接使用Excel工作簿作为Tableau中的数据源。如1.1中所述，打包的Tableau工作簿会阻止我更新数据源。</p><p id="06d6" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">为了建立实时连接，我再次求助于Google Sheets。我下载了<a class="ae lm" href="https://www.google.com/drive/download/" rel="noopener ugc nofollow" target="_blank">谷歌备份和同步(针对个人)</a>并备份了文件夹，里面只有上面提到的Excel工作簿。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/0b10d97827f139715efdfe729e19d135.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZrnvfMlSWlJBCOh5EVCsGQ.png"/></div></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">谷歌备份和同步</figcaption></figure><p id="3852" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">这里需要注意的关键点是，当Excel工作簿上传到我的个人Google Drive时，它是以Google工作表的形式存储在那里的。这让我绕过了1.2中提到的大小限制。此外，在此工作簿中所做的任何更改都将反映在Google工作表中(保存时)。</p><p id="766a" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">以下是建立实时连接的方法:</p><p id="13c0" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">打开Tableau公共桌面，选择Google Sheets。在Google Drive中找到所需的工作表，然后点击“打开”。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/047013bd5931b6f8129a30186ee4792d.png" data-original-src="https://miro.medium.com/v2/resize:fit:394/format:webp/1*0t_vUwQf6qTxf8PBNQS0aA.png"/></div></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">将Tableau连接到Google Sheets</figcaption></figure></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="a734" class="iq ir hi bd is it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn bi translated">3.使用Python刷新数据</h1><p id="0e41" class="pw-post-body-paragraph kx ky hi jq b jr js kz la jt ju lb lc jv ld le lf jx lg lh li jz lj lk ll kb hb bi translated">数据导入？检查。已建立实时连接？检查。构建仪表板之前的最后一步是自动刷新数据并保存Excel工作簿。</p><p id="5b41" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">我发现这个Python脚本正好做到了这一点:</p><pre class="mh mi mj mk fd nc nd ne nf aw ng bi"><span id="d0a4" class="ls ir hi nd b fi nh ni l nj nk">import win32com.client<br/>xlapp = win32com.client.Dispatch('Excel.Application')<br/>wb = xlapp.Workbooks.open('Path to xlsx')<br/>wb.RefreshAll()<br/>wb.Save()<br/>xlapp.Quit()</span></pre><p id="745b" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">由于数据只需要每天刷新一次，所以我使用<a class="ae lm" href="https://towardsdatascience.com/automate-your-python-scripts-with-task-scheduler-661d0a40b279" rel="noopener" target="_blank"> Windows任务调度器</a>将它设置为每天在同一时间运行。为此，我必须确保我的电脑在预定时间开机。如果我当时不能打开它，我可以在Excel中“刷新全部”并手动保存。</p></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><h1 id="99b4" class="iq ir hi bd is it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn bi translated">4.在Tableau Public上创建和发布仪表板</h1><p id="226a" class="pw-post-body-paragraph kx ky hi jq b jr js kz la jt ju lb lc jv ld le lf jx lg lh li jz lj lk ll kb hb bi translated">既然其他一切都已就绪，是时候创建仪表板了。因为数据不干净，我使用了一些<a class="ae lm" href="https://help.tableau.com/current/pro/desktop/en-us/filtering_global.htm" rel="noopener ugc nofollow" target="_blank">全局过滤器</a>来消除不想要的和空值。我还使用了一些简单的<a class="ae lm" href="https://help.tableau.com/current/pro/desktop/en-us/calculations_calculatedfields_create.htm" rel="noopener ugc nofollow" target="_blank">计算字段</a>来创建想要的可视化效果。总的来说，仪表板非常简单，易于理解。然后我把它发布到Tableau Public上，可以在这里<a class="ae lm" href="https://public.tableau.com/app/profile/devanirudh/viz/Covid-19Dashboard_16222251768430/Covid-19Country-WiseStats" rel="noopener ugc nofollow" target="_blank">访问</a>。切换到桌面布局并使用全屏模式以获得最佳对齐效果。</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nl"><img src="../Images/d5b94d0f5acac10af9b1ffb39d61933d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*7qgTys1YpfheKYBTs4Blaw.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">最终仪表板</figcaption></figure><p id="e6e6" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">有几件事要记住:</p><ol class=""><li id="c3fd" class="jo jp hi jq b jr ln jt lo jv nm jx nn jz no kb kc kd ke kf bi translated">将仪表板保存到Tableau Public时选中此框—</li></ol><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es np"><img src="../Images/319ccc44ca491e98228aca74046f8f59.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*zbW6Bma3yEg6qx58BmMfPQ.png"/></div></figure><p id="2506" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">2.一旦仪表板在Tableau Public上发布，请转到“编辑详细信息”并选中此框——</p><figure class="mh mi mj mk fd ij er es paragraph-image"><div class="er es nq"><img src="../Images/e6aa2ef533e6a5f5bc11ecdbc8f02403.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*o3e6muAzHYURhNRD7S-3OQ.png"/></div></figure></div><div class="ab cl kl km gp kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="hb hc hd he hf"><p id="f0f8" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">这只是一个简单的教程，适用于像我这样的完全初学者，考虑到我花了大量的时间来解决所有问题，我觉得我需要以一种详细和逐步的方式将所有内容发布在一个地方，以供那些发现自己陷入困境的人使用。这不是一个详尽的指南，我相信有更容易和更有效的方法来达到相同甚至更好的效果。</p><p id="b497" class="pw-post-body-paragraph kx ky hi jq b jr ln kz la jt lo lb lc jv lp le lf jx lq lh li jz lr lk ll kb hb bi translated">感谢您的阅读。</p></div></div>    
</body>
</html>