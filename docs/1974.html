<html>
<head>
<title>Meet Streamlit Sharing | Build a Simple Photo Editor</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">满足Streamlit共享|构建简单的照片编辑器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/meet-streamlit-sharing-build-a-simple-photo-editor-9d9e2e8872a?source=collection_archive---------12-----------------------#2021-03-29">https://medium.com/analytics-vidhya/meet-streamlit-sharing-build-a-simple-photo-editor-9d9e2e8872a?source=collection_archive---------12-----------------------#2021-03-29</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/a9c374b38d01939cb8f3c6abb3a14ab9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rKg0JE-joexmjWbC3YKQfA.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">依兰石科彭斯</figcaption></figure><p id="0d63" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我最近收到了Streamlit的邀请，测试他们的新工具<strong class="iw hi"> Streamlit Sharing </strong>，它允许快速、简单地实现用Streamlit创建的应用程序，因为这个项目已经在Github库中。</p><p id="078f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我承认，我对自己能够实现一个项目的速度感到惊讶，以前这个项目只能在我的机器上本地运行，现在世界上任何地方的任何人都可以访问这个应用程序。</p><p id="9d8a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在进入代码细节之前，重要的是，这个工具不是为每个人发布的，但你可以请求访问，只需<a class="ae it" href="https://streamlit.io/sharing" rel="noopener ugc nofollow" target="_blank">单击此处</a>，你将被重定向到Streamlit共享页面。</p><h2 id="fd39" class="js jt hh bd ju jv jw jx jy jz ka kb kc jf kd ke kf jj kg kh ki jn kj kk kl km bi translated">让我们来看看代码</h2><p id="026f" class="pw-post-body-paragraph iu iv hh iw b ix kn iz ja jb ko jd je jf kp jh ji jj kq jl jm jn kr jp jq jr ha bi translated">完整的代码在我的Github上，如果你想看的话，<a class="ae it" href="https://github.com/rafaelgrecco/Filter-Selector" rel="noopener ugc nofollow" target="_blank">点击这里</a></p><p id="7a12" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">要输入代码，首先，我们将了解将建立什么，这个想法是一个人可以上传一个图像，并对该图像进行一些修改，例如，应用一些过滤器，增加或减少亮度或对比度等可能的修改。这是一个非常简单的应用程序，但对于正在学习计算机视觉的人来说，它非常丰富。</p><p id="5542" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">像往常一样，第一步是导入将要使用的库。</p><figure class="ks kt ku kv fd ii"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="6c0e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在第7行，我已经配置了我们图像的大小，这里我留了500，但是，你可以在你的项目中随意调整这个值。</p><p id="04d1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">正如我们在我的文章《Streamlit简介》中看到的，我们应用程序的所有代码都必须在函数内部，如下所示:</p><figure class="ks kt ku kv fd ii"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="037b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如上所述，所有代码都必须在创建的函数中。</p></div><div class="ab cl ky kz go la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ha hb hc hd he"><p id="b183" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">完成后，让我们创建一个将加载占位符图像的函数，这一步是必要的，因为要部署Streamlit共享，您的图像不能在您的计算机上，在这种情况下，我将它放在项目存储库中，并从那里使用它。你可以用同一个，只要去我一开始留的Github链接，这个图片在images文件夹里。</p><figure class="ks kt ku kv fd ii"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="7e97" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">你可能已经注意到，这个函数在一个<em class="lf"> @ st.cache </em>下面，这是为了在运行我们的Streamlit应用程序时，这个函数只加载一次，这使得应用程序的操作更加敏捷。</p><p id="2bea" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这个函数的基本功能是获取我们图像的URL，正如我所说的，它在Github上，并返回包含在该URL中的图像。</p></div><div class="ab cl ky kz go la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ha hb hc hd he"><p id="ea84" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在我们已经创建了我们的函数，我们可以调用它并将我们的URL作为参数传递，同时，我们将把标题添加到我们的应用程序，以及它的侧边栏。</p><figure class="ks kt ku kv fd ii"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="0bef" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这一步中，我还添加了将出现在侧边栏中的选项。在第7行，我将用户的选择存储在变量<em class="lf"> op </em>中。</p><p id="d8de" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们看看我们的应用程序到目前为止做得怎么样:</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div class="er es lg"><img src="../Images/0bea33e1962723b7050f9eeeb13f986b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*ZZ8HmH_PWAquwpYg3-4Eyg.gif"/></div></figure><p id="8d54" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">可能会注意到，当我在菜单中选择一个选项时，没有任何变化，这是因为我们还没有为单击任何选项编写任何程序，我们将在下一步中这样做。</p></div><div class="ab cl ky kz go la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ha hb hc hd he"><p id="c8df" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们看看当op = Filters时我们的代码是如何开始的</p><figure class="ks kt ku kv fd ii"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="51ae" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">好的，最初这可能看起来像一个复杂的步骤，然而，我在这里做的非常简单，当用户设置过滤器选项时，它进入代码的那一部分，在那里她将有可能上传他的机器的图像，为此我们使用命令<strong class="iw hi"><em class="lf">ST . file _ uploader()</em></strong>，作为参数我们传递我们想要出现的文本，然后将允许执行上传的文件格式，这里是主要的3个图像。</p><p id="d01b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们来看看这一刻是怎样的:</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lh"><img src="../Images/25ee5fb82269a7785750d7b95a662f02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HmTsc-53-ejfbQ5kyfBvBw.png"/></div></div></figure><p id="c3a6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">请注意，我们创建的过滤器列表已经出现在侧边栏中。以及用户从他的机器上传图像的空间。</p></div><div class="ab cl ky kz go la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ha hb hc hd he"><p id="7881" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们做过滤器，我会添加代码，我会解释代码的每一部分。</p><figure class="ks kt ku kv fd ii"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="3903" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">第一个滤镜是灰度，这是最容易创建的，使用cvtColor()函数，最后，使用命令<strong class="iw hi"> <em class="lf"> st.image() </em> </strong>我们在我们的应用Streamlit中显示图像。</p><p id="8e21" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下一个过滤器是棕褐色，要应用它，必须构建提供所需结果的内核。要找到这个内核的值，很简单，我在这里找到了它们<a class="ae it" href="https://programmerbackpack.com/python-opencv-building-instagram-like-image-filters/" rel="noopener ugc nofollow" target="_blank"/>。<br/>使用将要放入内核的值，我们设置它，最后用<strong class="iw hi"><em class="lf">cv2 . filter 2d()</em></strong>函数应用它。</p><p id="0b48" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，模糊过滤器除了其他已经提出的，最初，它是非常简单的，我们应用高斯模糊函数，但它有一个新的组件，滑块，可以改变模糊的强度将被应用。为此，我们使用Streamlit的滑块函数，该函数以引号中的描述作为参数，然后接下来的值是指最小值、最大值和将被设置为标准的量，最后是步长，这里的值为2，因此模糊将从2变化到2，这是因为当应用奇数的核时，高斯模糊函数的结果更令人满意。</p><p id="2e93" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下一个滤镜是轮廓滤镜，它的构造非常简单，遵循的步骤是首先应用模糊滤镜，然后用<strong class="iw hi"> <em class="lf"> cv2.canny() </em> </strong>函数应用Canny边缘检测器。</p><p id="0fa6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最后一个滤镜是sketch，就是让照片看起来是画出来的，这个滤镜每一步的构造都在Github里，在Support笔记本里。但简而言之，我们把灰度图像反过来，黑色调变成白色，反之亦然。这个反转的图像就是我们要应用模糊滤镜的地方。接下来，我们将使用cv2.divide函数将灰度图像中的像素除以255-blur_image，该方法返回一个类似于绘图的图像。一定要查看笔记本，在那里你可以看到这些正在进行中的图片。</p><p id="eb61" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果没有选择滤镜，我们将只显示原始图像。</p><p id="d025" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们来看看结果:</p><div class="ks kt ku kv fd ab cb"><figure class="li ii lj lk ll lm ln paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/b5c61904b62dd7a0aec793bbaacbedd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*p8sb6wmi0GWG4HZyy5rXrQ.jpeg"/></div></figure><figure class="li ii lo lk ll lm ln paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/305b7fa96c7d0c2aa58a168e76ee9fa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*tU-hY0nu_JSsX11yi9XNbA.jpeg"/></div></figure><figure class="li ii lp lk ll lm ln paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/375cb5ff99cc392d9cfef86e4b5a87c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*vtMV6s2qTPu0ElAVTaiyoQ.jpeg"/></div></figure></div><div class="ab cb"><figure class="li ii lq lk ll lm ln paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/c5b77187176755d312823b8d92a340d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*9WIG0vLz1SG8bLi665unBQ.jpeg"/></div></figure><figure class="li ii lr lk ll lm ln paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/1d4c59b5dffce59f67857615e3635b56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*Y1ghEC6QfOUH4dEiJLuzHg.jpeg"/></div></figure></div><p id="d22a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">正如你所看到的，结果非常令人满意，在应用了模糊滤镜的图像中，幻灯片出现了，在这里可以控制模糊的强度。</p></div><div class="ab cl ky kz go la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ha hb hc hd he"><p id="fcd5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">然而，我们还有很多工作要做，我们必须安排图像校正。</p><p id="3324" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我要像以前一样，展示整个代码，然后逐段注释。</p><figure class="ks kt ku kv fd ii"><div class="bz dy l di"><div class="kw kx l"/></div></figure><p id="0bf4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这里，MImage变量将存储用户想要对图像应用什么样的改进，选项有:</p><ul class=""><li id="2794" class="ls lt hh iw b ix iy jb jc jf lu jj lv jn lw jr lx ly lz ma bi translated">对比</li><li id="29d1" class="ls lt hh iw b ix mb jb mc jf md jj me jn mf jr lx ly lz ma bi translated">聪明</li><li id="96e0" class="ls lt hh iw b ix mb jb mc jf md jj me jn mf jr lx ly lz ma bi translated">锐利</li></ul><p id="5bc2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这一步比前一步简单，因为我们有一个模式，在变量<em class="lf"> enh </em>中，我们将总是存储我们想要申请改进的内容，总是以同样的方式ImageEnhance后跟我们想要执行的改进，例如在第一种情况下我们有:<strong class="iw hi"> <em class="lf"> ImageEnhance。对比</em> </strong>，然后用enhance函数我们已经把改进放在了滑块中的值的函数中，所有的改进都遵循相同的模式。</p><p id="dc62" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最后，我已经添加了信息菜单中的内容，如果我用一个简单的句子告诉你是谁开发的，请随意添加你认为相关的信息。</p></div><div class="ab cl ky kz go la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ha hb hc hd he"><p id="8ca1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这些步骤都准备好了，就该开始了解Streamlit共享了，你的项目完成后，可以上传到Github，记得导入requirements.txt，可以用pipreqs获取，必须安装使用。这边走:</p><pre class="ks kt ku kv fd mg mh mi mj aw mk bi"><span id="f1fd" class="js jt hh mh b fi ml mm l mn mo">pip install pipreqs<br/>pipreqs /home/project/location</span></pre><p id="e6a5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果你有apt-get需要的包，一定要用packages.txt上传到Github，在Github链接里，我用了这个文件，检查一下是怎么用的，<a class="ae it" href="https://github.com/rafaelgrecco/Filter-Selector/blob/master/packages.txt" rel="noopener ugc nofollow" target="_blank">点这里</a>。</p><p id="2066" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在项目已经在Github上，并且您已经收到测试Stramlit共享的邀请之后，我们将部署该应用程序。</p><p id="b33b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果你的请求还没有得到答复，请再等一会儿，继续按照教程来做，看看使用起来有多简单。</p><p id="1b4e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">点击“新建应用程序”按钮后，将会打开以下窗口:</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mp"><img src="../Images/ee1dadd48b988afb496f597ad085629d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yNPtJlWgF5byMAJ6xmCl7A.jpeg"/></div></div></figure><p id="32d8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在选择了您的应用程序所在的存储库和哪个分支之后，您将选择哪个。py文件，因为我的只有main.py，它已经自动识别了。</p><p id="1e15" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">单击“deploy ”,您将等待几分钟，部署将会完成，几分钟后(根据您的应用程序的复杂程度而有所不同),部署就绪，您的应用程序已经可供所有人查看。</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mq"><img src="../Images/c3aeb1b305817b5617a84e34de58381f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NyX2J0b74fbWYnxLPHj3-g.jpeg"/></div></div></figure><p id="c5be" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在Streamlit Sharing的初始选项卡中，您的所有应用程序都被保留。</p><p id="bdfd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">查看本文结果，只需<a class="ae it" href="https://share.streamlit.io/rafaelgrecco/filter-selector/main.py" rel="noopener ugc nofollow" target="_blank">点击此处</a>。</p><p id="e15a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们就要结束了，我希望这篇教程能帮助你对Streamlit和计算机视觉领域有更多的了解。欢迎在评论里留下建议，看看我的其他文章。好好学习！！！</p></div></div>    
</body>
</html>