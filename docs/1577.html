<html>
<head>
<title>Easily analyse audio features from Spotify playlists — Part 1.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">轻松分析Spotify播放列表中的音频功能—第1部分。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/easily-analyse-audio-features-from-spotify-playlists-part-1-3b004cd406b3?source=collection_archive---------6-----------------------#2021-03-08">https://medium.com/analytics-vidhya/easily-analyse-audio-features-from-spotify-playlists-part-1-3b004cd406b3?source=collection_archive---------6-----------------------#2021-03-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="727a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用Python从Spotify播放列表获取音频功能和预览音频文件的简单指南。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/d06d0bda5651d9490af5fafe1d836293.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*UeqUzgXxWNLQ5PPRgAd5wA.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">GSA输出示例</figcaption></figure><p id="060d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">音乐是我们生活中决定性的一部分。随着听音乐已经主要成为一种数字化和在线活动，它为研究人员提供了一个很好的途径来深入了解我们为什么听音乐。虽然mixtapes的时代早已过去，但收集音乐的过程仍然以播放列表的形式存在。在Spotify上，播放列表既是组织音乐的一种方式，也是创建适合不同场合的曲目集的一种方式。</p><p id="bd53" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">就我个人而言，我有多个目的和原因的播放列表。一个包含我工作时听的曲目。另一个包含怀旧游行，还有一个放着让我的孩子们放松的歌曲。如果你在Spotify上搜索播放列表，你会发现成千上万的关键词，比如“悲伤的歌曲”、“睡眠音乐”、“跳舞”。</p><p id="0b0d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这些播放列表提供了一种理解特定场合音乐特征的方式。人们睡觉用的铁轨和跳舞用的铁轨在数量上有区别吗？看一个人的播放列表能看出他的年龄吗？</p><p id="72ea" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这只是人们可以通过查看播放列表来解决的问题的两个例子。</p><p id="d150" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇文章中，我将展示如何使用Python和一个简单的脚本，即<a class="ae jo" href="https://github.com/OleAd/GeneralizedSpotifyAnalyser" rel="noopener ugc nofollow" target="_blank">通用Spotify Analyser (GSA) </a>，从播放列表中快速获取元数据和音频功能。这篇文章假设你对Python和编程有一定的了解，但是我会尽量让它更容易理解。</p><blockquote class="jp jq jr"><p id="aba0" class="ie if js ig b ih ii ij ik il im in io jt iq ir is ju iu iv iw jv iy iz ja jb ha bi translated">这篇文章是GSA的第一个“版本”,随着它的发展，我会相应地更新它。最后一次更新是2021年3月17日。</p></blockquote><ul class=""><li id="a693" class="jw jx hh ig b ih ii il im ip jy it jz ix ka jb kb kc kd ke bi translated">第1部分涵盖了启动和运行。</li><li id="8393" class="jw jx hh ig b ih kf il kg ip kh it ki ix kj jb kb kc kd ke bi translated"><a class="ae jo" href="https://oleheggli.medium.com/easily-analyse-audio-features-from-spotify-playlists-part-2-51959638450c" rel="noopener">第2部分</a>展示了如何将GSA作为大型数据收集的一部分。</li><li id="e31c" class="jw jx hh ig b ih kf il kg ip kh it ki ix kj jb kb kc kd ke bi translated"><a class="ae jo" href="https://oleheggli.medium.com/easily-analyse-audio-features-from-spotify-playlists-part-3-ec00a55e87e4" rel="noopener">第3部分</a>给出了一些如何分析音频特征的例子。</li></ul><p id="6eba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可以在<a class="ae jo" href="https://github.com/OleAd/GeneralizedSpotifyAnalyser" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到这里使用的脚本。</p><h1 id="04c9" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">先决条件</h1><ul class=""><li id="f8b8" class="jw jx hh ig b ih li il lj ip lk it ll ix lm jb kb kc kd ke bi translated">Python 3</li></ul><p id="7d6a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">前往<a class="ae jo" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank">https://www.python.org/downloads/</a>并遵循那里的指示。确保至少选择Python 3.8或更新版本。</p><ul class=""><li id="732f" class="jw jx hh ig b ih ii il im ip jy it jz ix ka jb kb kc kd ke bi translated">Spotify账户</li></ul><p id="c0a3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你需要一个Spotify账户和一个Spotify开发者账户。两者都可以免费得到。去<a class="ae jo" href="https://developer.spotify.com/dashboard/" rel="noopener ugc nofollow" target="_blank">https://developer.spotify.com/dashboard/</a>做一个。</p><ul class=""><li id="44fc" class="jw jx hh ig b ih ii il im ip jy it jz ix ka jb kb kc kd ke bi translated">(可选)IDE</li></ul><p id="54d5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我使用Spyder，这是一个用Python编程的开源IDE。您可以使用任何其他IDE，或者根本不使用，但是如果您使用Spyder，本系列后面的部分可能会更容易理解。</p><h1 id="219c" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">获取脚本</h1><p id="bcc7" class="pw-post-body-paragraph ie if hh ig b ih li ij ik il lj in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">首先，您需要获得GSA脚本。你可以从<a class="ae jo" href="https://github.com/OleAd/GeneralizedSpotifyAnalyser" rel="noopener ugc nofollow" target="_blank">这里</a>下载它们，按“代码”，然后按“下载ZIP”。将此文件解压缩到您选择的目录中。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lq"><img src="../Images/b0261637f4fc33896b4dfda82e0bca41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6QDnrpVJHZnjAu9zrq2cMw.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">点击GitHub上的下载ZIP获取脚本。</figcaption></figure><h1 id="d993" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">获取API访问权限</h1><p id="0732" class="pw-post-body-paragraph ie if hh ig b ih li ij ik il lj in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">接下来您需要做的是获得API访问权。为此，你需要在<a class="ae jo" href="https://developer.spotify.com/dashboard/" rel="noopener ugc nofollow" target="_blank"> Spotify开发者仪表盘</a>中设置一个应用。你给你的应用起什么名字并不重要。您需要的是以下内容:客户端ID、客户端密码、重定向URL和您的Spotify用户名。</p><p id="bd14" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦你制作了一个应用程序，你可以看到一个客户端ID和(通过按下显示客户端密码)一个客户端密码。按“编辑设置”找到你的重定向URIs，并添加“<a class="ae jo" href="http://example.com/callback/" rel="noopener ugc nofollow" target="_blank">http://example.com/callback/</a>”如果它还没有填写。获得所有这些信息后，转到您提取GSA脚本的文件夹。</p><p id="1172" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在GSA文件夹中，您会找到一个名为“<em class="js">spotifyConstants _ template . py</em>”的文件。编辑该文件，并粘贴您在Spotify for Developers仪表板上找到的信息。现在将这个文件重命名为“<em class="js"> spotifyConstants.py </em>”。</p><h1 id="d633" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">安装要求</h1><p id="eb35" class="pw-post-body-paragraph ie if hh ig b ih li ij ik il lj in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">下一步是安装使GSA工作所需的包。这主要是你在Python中使用的常规包，加上了Spotify API的包装器<a class="ae jo" href="https://github.com/plamere/spotipy" rel="noopener ugc nofollow" target="_blank"> SpotiPy </a>。</p><p id="2555" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用命令行界面，导航到解压缩GSA的文件夹，然后键入:</p><pre class="jd je jf jg fd lv lw lx ly aw lz bi"><span id="1e97" class="ma kl hh lw b fi mb mc l md me">pip install -r requirements.txt</span></pre><p id="5df8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">完成后，你就可以测试GSA了！</p><h1 id="e9ab" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">使用GSA</h1><p id="42b6" class="pw-post-body-paragraph ie if hh ig b ih li ij ik il lj in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">GSA中包含了两个示例脚本。我们先来看一下基本的例子(<em class="js"> GSA_basicExample.py </em>)。这个脚本向您展示了如何获取单个播放列表的音频特性，然后下载播放列表中曲目的30秒预览MP3。</p><p id="2910" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我们导入GSA和pandas(Python中用于数据操作的库)。</p><blockquote class="jp jq jr"><p id="afb3" class="ie if js ig b ih ii ij ik il im in io jt iq ir is ju iu iv iw jv iy iz ja jb ha bi translated">如果使用命令行界面，现在应该输入Python。</p></blockquote><pre class="jd je jf jg fd lv lw lx ly aw lz bi"><span id="d5ab" class="ma kl hh lw b fi mb mc l md me">import GSA<br/>import pandas as pd</span></pre><p id="7207" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，我们需要使用Spotify API进行认证。</p><pre class="jd je jf jg fd lv lw lx ly aw lz bi"><span id="c1bd" class="ma kl hh lw b fi mb mc l md me">GSA.authenticate()</span></pre><p id="7e63" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第一次运行该脚本时，会打开一个网页，您可以在其中通过Spotify的系统允许脚本使用您的凭据。一旦你同意，你将被转到另一个网页。这就是URI之前提到的重定向。复制这个地址并粘贴回控制台。您现在应该已经通过验证了！</p><blockquote class="jp jq jr"><p id="e881" class="ie if js ig b ih ii ij ik il im in io jt iq ir is ju iu iv iw jv iy iz ja jb ha bi translated">如果您之前已通过身份验证，GSA将刷新您的令牌，而不是创建新的令牌。</p></blockquote><h1 id="702b" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">获取播放列表信息</h1><p id="e213" class="pw-post-body-paragraph ie if hh ig b ih li ij ik il lj in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">为了从播放列表中获取元数据和音频特性，我们需要它的ID。对于这个例子，我们将使用挪威制造的播放列表。您可以通过按share并选择“复制Spotify URI”来找到播放列表ID。这将为您提供以下文本:Spotify:playlist:37i 9 dqzf 1 dx 3 hgbb 9 nreb 1。我们感兴趣的是最后那些数字。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es mf"><img src="../Images/e4d69694f996c6e89457307798f01766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZKosU0WUu1R3if7NeCZdxw.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">该图显示了如何获取播放列表ID</figcaption></figure><blockquote class="jp jq jr"><p id="b88a" class="ie if js ig b ih ii ij ik il im in io jt iq ir is ju iu iv iw jv iy iz ja jb ha bi translated">有关获取播放列表id的不同方法，请参见GSA_example.py。</p></blockquote><p id="5f05" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们现在可以使用GSA.getInformation()函数来查询Spotify关于播放列表的API。</p><pre class="jd je jf jg fd lv lw lx ly aw lz bi"><span id="bbf0" class="ma kl hh lw b fi mb mc l md me">myPlaylist = GSA.getInformation(‘37i9dQZF1DX3hgbB9nrEB1’, verbose=True)</span></pre><p id="d6fd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这将创建一个pickle文件(。pkl)与您的播放列表中的曲目的所有信息，并将其保存到子文件夹“播放列表”。<strong class="ig hi"> verbose=True </strong>参数使函数输出每个音轨的标题。为了访问Python中的信息，我们现在可以使用pandas读回它:</p><pre class="jd je jf jg fd lv lw lx ly aw lz bi"><span id="3912" class="ma kl hh lw b fi mb mc l md me">myPlaylistInformation = pd.read_pickle(myPlaylist)</span></pre><p id="4cc6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，我们将pickle文件作为包含所有信息的数据帧读取，包括播放列表中每个音轨的音频特性。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es mg"><img src="../Images/b27266ad0a4ab4a754421854fc083d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L35w8BSQj1A3pvKONdDUAQ.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">示例输出，此处显示在Spyder的变量浏览器中。</figcaption></figure><h1 id="7040" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">下载预览MP3</h1><p id="2100" class="pw-post-body-paragraph ie if hh ig b ih li ij ik il lj in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">Spotify上的大多数歌曲都有相关的30秒MP3预览。如果您想要快速收听播放列表中的音乐，或者如果您想要运行不同的音频分析，这些功能尤其有用。</p><blockquote class="jp jq jr"><p id="673d" class="ie if js ig b ih ii ij ik il im in io jt iq ir is ju iu iv iw jv iy iz ja jb ha bi translated">我将在以后的文章中阐述Spotify的音频功能和更常规的音乐信息检索分析之间的相关性和联系。</p></blockquote><p id="8d3a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为此，可以使用GSA.downloadTracks()函数。该函数将包含以下信息的列表作为输入:SampleURL、TrackName、TrackID和playlistID。这些都存在于我们之前创建的数据帧中，因此我们可以从那里提取它们。</p><pre class="jd je jf jg fd lv lw lx ly aw lz bi"><span id="c0ac" class="ma kl hh lw b fi mb mc l md me">toDownload = myPlaylistInformation[[‘SampleURL’, ‘TrackName’, ‘TrackID’, ‘playlistID’]].values.tolist()</span></pre><p id="da09" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们需要创建一个循环，在每个轨道上调用GSA.downloadTracks()。我们还需要记录成功下载的曲目。</p><pre class="jd je jf jg fd lv lw lx ly aw lz bi"><span id="d672" class="ma kl hh lw b fi mb mc l md me"># Create an array to keep track of which were successfully downloaded</span><span id="3e0d" class="ma kl hh lw b fi mh mc l md me">downloaded = []</span><span id="b36f" class="ma kl hh lw b fi mh mc l md me"># Now download preview MP3s, in a loop:</span><span id="fffb" class="ma kl hh lw b fi mh mc l md me">for track in toDownload:<br/>    print(‘Downloading track: ‘ + track[1])<br/>    # this prints the current track name<br/>    success = GSA.downloadTracks(track)<br/>    downloaded.append(success)</span></pre><p id="aa21" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下载的MP3可以在Audio子文件夹中找到。</p><h1 id="bf46" class="kk kl hh bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">摘要</h1><p id="58a3" class="pw-post-body-paragraph ie if hh ig b ih li ij ik il lj in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">第1部分到此结束！您现在应该已经安装了<a class="ae jo" href="https://github.com/OleAd/GeneralizedSpotifyAnalyser" rel="noopener ugc nofollow" target="_blank"> GSA </a>，并且能够从单个播放列表中获取信息。在<a class="ae jo" href="https://oleheggli.medium.com/easily-analyse-audio-features-from-spotify-playlists-part-2-51959638450c" rel="noopener">第2部分</a>中，我将向您展示如何使用GSA作为更大数据收集的一部分。在<a class="ae jo" href="https://oleheggli.medium.com/easily-analyse-audio-features-from-spotify-playlists-part-3-ec00a55e87e4" rel="noopener">第三部</a>中，我们做统计和可视化。</p></div></div>    
</body>
</html>