<html>
<head>
<title>Darts: A New Approach Simplifying Time Series Analysis And Forecasting In Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Darts:机器学习中简化时间序列分析和预测的新方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/darts-a-new-approach-simplifying-time-series-analysis-and-forecasting-in-machine-learning-8edcc177ad89?source=collection_archive---------0-----------------------#2021-09-22">https://medium.com/analytics-vidhya/darts-a-new-approach-simplifying-time-series-analysis-and-forecasting-in-machine-learning-8edcc177ad89?source=collection_archive---------0-----------------------#2021-09-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/6d4e38e4840d85f3c8c66df5382b2066.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*I4zbf9orkPukckoH"/></div></div></figure></div><div class="ab cl ip iq go ir" role="separator"><span class="is bw bk it iu iv"/><span class="is bw bk it iu iv"/><span class="is bw bk it iu"/></div><div class="ha hb hc hd he"><p id="6c76" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi ju translated"><span class="l jv jw jx bm jy jz ka kb kc di"> D </span> arts是由<a class="ae kd" href="https://unit8.co/casestudies/darts-time-series-forecasting/" rel="noopener ugc nofollow" target="_blank"> Unit8 </a>开发的开源Python库，用于时间序列的轻松处理、预处理和预测。它包含一系列模型，从ARIMA等标准统计模型到深度神经网络。Darts利用<code class="du ke kf kg kh b"><em class="ki">fit()</em></code>和<code class="du ke kf kg kh b"><em class="ki">predict()</em></code>函数，类似于scikit-learn。事实上，darts类似于scikit-learn，但是具有专用于时间序列数据的附加功能。该库还提供对模型的回测，并结合几个模型的预测，同时分析多个模型。Darts支持单变量和多变量统计和模型。此外，所有神经网络以及回归模型都可以在多个时间序列上进行训练。</p><h1 id="5f0b" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">为什么是飞镖？</h1><p id="d0bd" class="pw-post-body-paragraph iw ix hh iy b iz lh jb jc jd li jf jg jh lj jj jk jl lk jn jo jp ll jr js jt ha bi translated">对于非时间序列数据，您通常可以使用<a class="ae kd" href="https://scikit-learn.org/" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a>来完成大多数ML工作——从预处理到预测和模型选择。但是对于时间序列，我们必须使用专门的库，如pandas来预处理数据，<a class="ae kd" href="https://www.statsmodels.org/" rel="noopener ugc nofollow" target="_blank"> statsmodels </a>来检查季节性、趋势性、平稳性、自相关性等..和<a class="ae kd" href="https://facebook.github.io/prophet/" rel="noopener ugc nofollow" target="_blank">脸书预言家</a>作为预测模型，我们需要实现我们自己的回溯测试和模型选择例程。</p><p id="3570" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">sci kit-learn——一个具有一致API的开源库，包含一套优秀的端到端机器学习工具。Darts试图成为一个针对时间序列的scikit-learn，其首要目标是简化整个时间序列机器学习体验。</strong></p><p id="682d" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">没有很多文章解释darts的意义，这篇博客对不知道这个库的机器学习工程师/开发人员会有帮助。因此，在这篇博客的结尾，你会学到什么是飞镖，包括技术和模型。</p><figure class="ln lo lp lq fd ii er es paragraph-image"><div class="er es lm"><img src="../Images/2e79620ef7f4311fb232b4aac90473a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*8nIk2qAyub5qtr_v7TrD9Q.png"/></div></figure><p id="9a6d" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">Unit8通过提供示例笔记本、API参考(如scikit-learn ),让首次接触飞镖的人更容易清楚地了解飞镖。它预先加载了一些流行的时间序列数据集，从经典到深度学习模型的模型列表，用于测量准确性的指标，还有更多我在这篇博客中没有涉及的内容，因为unit8已经通过下面提到的链接中的例子清楚地解释了一切。</p><p id="8b6b" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">此外，该库还包含回测预测和回归模型、执行网格搜索、预处理时间序列、评估残差，甚至执行自动模型选择的功能，这是一件有趣的事情。</p><h1 id="ed23" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">飞镖入门</h1><p id="4361" class="pw-post-body-paragraph iw ix hh iy b iz lh jb jc jd li jf jg jh lj jj jk jl lk jn jo jp ll jr js jt ha bi translated">虽然我提到，unit8已经用例子清楚地解释了飞镖，但我还是附上我编写的学习飞镖的基本代码片段。</p><h2 id="6bea" class="lr kk hh bd kl ls lt lu kp lv lw lx kt jh ly lz kx jl ma mb lb jp mc md lf me bi translated"><strong class="ak">安装</strong></h2><p id="059a" class="pw-post-body-paragraph iw ix hh iy b iz lh jb jc jd li jf jg jh lj jj jk jl lk jn jo jp ll jr js jt ha bi translated">有些模型严重依赖于很少的库，如prophet、torch等。因此，我建议创建一个单独的conda环境，以确保无错误安装。</p><p id="dec7" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">为Python创建一个conda环境(在安装<a class="ae kd" href="https://docs.conda.io/en/latest/miniconda.html" rel="noopener ugc nofollow" target="_blank"> conda </a>之后):</p><pre class="ln lo lp lq fd mf kh mg mh aw mi bi"><span id="8643" class="lr kk hh kh b fi mj mk l ml mm">conda create <strong class="kh hi">--</strong>name <strong class="kh hi">&lt;</strong>env<strong class="kh hi">-</strong>name<strong class="kh hi">&gt;</strong> python<strong class="kh hi">=3.7</strong></span></pre><p id="ae60" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">激活您创建的虚拟环境</p><pre class="ln lo lp lq fd mf kh mg mh aw mi bi"><span id="3ca8" class="lr kk hh kh b fi mj mk l ml mm">conda activate <strong class="kh hi">&lt;</strong>env<strong class="kh hi">-</strong>name<strong class="kh hi">&gt;</strong></span></pre><p id="9155" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">在所有可用型号上安装省道:</p><p id="4b20" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><code class="du ke kf kg kh b">pip install darts</code></p><p id="de51" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">如果这在您的平台上失败，请遵循<a class="ae kd" href="https://facebook.github.io/prophet/docs/installation.html#python" rel="noopener ugc nofollow" target="_blank"> prophet </a>和<a class="ae kd" href="https://pytorch.org/get-started/locally/" rel="noopener ugc nofollow" target="_blank"> torch </a>的官方安装指南，然后再次尝试安装飞镖。</p><p id="9b96" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">如果上述所有型号的安装都失败，我们也可以使用由<code class="du ke kf kg kh b">u8darts</code>包提供的如下较轻的安装。</p><ul class=""><li id="d25c" class="mn mo hh iy b iz ja jd je jh mp jl mq jp mr jt ms mt mu mv bi translated">仅安装核心(没有神经网络、Prophet或AutoARIMA): <code class="du ke kf kg kh b">pip install u8darts</code></li><li id="6e8f" class="mn mo hh iy b iz mw jd mx jh my jl mz jp na jt ms mt mu mv bi translated">安装核心+神经网络(PyTorch): <code class="du ke kf kg kh b">pip install 'u8darts[torch]'</code></li><li id="2b46" class="mn mo hh iy b iz mw jd mx jh my jl mz jp na jt ms mt mu mv bi translated">安装核心+脸书先知:<code class="du ke kf kg kh b">pip install 'u8darts[prophet]'</code></li><li id="142d" class="mn mo hh iy b iz mw jd mx jh my jl mz jp na jt ms mt mu mv bi translated">安装核心+ AutoARIMA: <code class="du ke kf kg kh b">pip install 'u8darts[pmdarima]'</code></li></ul><p id="0a20" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">现在让我们开始编码吧！！</p><p id="f270" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">出于一个简单的演示目的，我使用darts中预加载的数据集，名为“航空乘客数据集”。</p><figure class="ln lo lp lq fd ii er es paragraph-image"><div class="er es nb"><img src="../Images/e2a8cf2855237a27db4796867ef73a4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*FFAA_A4DYvRyDe7NmNQVog.png"/></div><figcaption class="nc nd et er es ne nf bd b be z dx translated">testing.ipynb</figcaption></figure><p id="edf3" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">让我们将时间序列分成训练和验证序列。我在考虑训练系列到1957年，其余的是验证系列。</p><figure class="ln lo lp lq fd ii er es paragraph-image"><div class="er es ng"><img src="../Images/8250b7eb4c25dba9f62e31d0ad51e6d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*sJjqtppOJmzqtCkldVNy9A.png"/></div><figcaption class="nc nd et er es ne nf bd b be z dx translated">testing.ipynb</figcaption></figure><p id="9d35" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">我们还可以使用ACF和PACF图来理解时间序列中的观测值与先前时间步(即平稳时间步)的观测值之间的关系强度，以及季节性，如下所示:</p><figure class="ln lo lp lq fd ii er es paragraph-image"><div class="er es nh"><img src="../Images/61f12dc2716f858a438636d3e5eaa54d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*wCi6XcHwvOn9ilbyNRNiyw.png"/></div></figure><p id="015f" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">正如我们所看到的，随着滞后值的增加有所下降，所以我们的序列是稳定的。</p><p id="7803" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">现在，让我们将不同的模型拟合到我们的系列中，并从其他模型中选择一个具有较高MAPE的模型，如果可能的话，通过调整参数来减少误差，以增强预测。</p><figure class="ln lo lp lq fd ii er es paragraph-image"><div class="er es ni"><img src="../Images/8fbc3bdef6cdcdbb3f474e63f41e27e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*92757kN6EVOQS8AcPZ5_Pg.png"/></div></figure><p id="1229" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">在这些模型中，θ模型具有更高的MAPE。让我们看看它是如何预测验证系列的。</p><figure class="ln lo lp lq fd ii er es paragraph-image"><div class="er es nj"><img src="../Images/921e418c1495cac44ab62f10b8e8cc29.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*rQotFx1yoPYucKsCnbvnTg.png"/></div></figure><p id="c4a2" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">当然，预测并不好。因此，让我们尝试用50个不同的值来调整theta参数，并再次输入数据以拟合()和预测()具有最佳theta值的函数。</p><figure class="ln lo lp lq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nk"><img src="../Images/07cad8ba3f48cfac49ddb7c73df342a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zzi3tWhvm6WILAAnv4Plaw.png"/></div></div></figure><figure class="ln lo lp lq fd ii er es paragraph-image"><div class="er es nl"><img src="../Images/247e7186189239a2e26273355a2bb1c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*uUkKYT-JyJwx5wsWXfG7pw.png"/></div></figure><p id="7410" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">瞧啊。:)我们可以观察到误差已经大大减小，并且预测也接近验证数据。</p><p id="ce21" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">本文中使用的完整代码附后</p><figure class="ln lo lp lq fd ii"><div class="bz dy l di"><div class="nm nn l"/></div><figcaption class="nc nd et er es ne nf bd b be z dx translated">testing.ipynb</figcaption></figure><p id="3cf3" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">我们不仅可以使用模型并调整它们，还可以对预测进行回溯测试，集成多个模型，等等。</p><blockquote class="no np nq"><p id="78ad" class="iw ix ki iy b iz ja jb jc jd je jf jg nr ji jj jk ns jm jn jo nt jq jr js jt ha bi translated"><strong class="iy hi">注</strong>:我安装了最新的torch，当我尝试安装“u8darts[all]”时，弹出以下错误:<br/> <strong class="iy hi">错误:找不到满足要求的版本torch==1.5.1 <br/> </strong>目前darts支持torch版本1.5.1，为了安装darts不出错，建议为darts创建一个单独的conda环境并安装所需的版本，以避免此类问题。</p></blockquote><p id="e1af" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">了解更多关于飞镖的知识—<a class="ae kd" href="https://unit8co.github.io/darts/index.html#" rel="noopener ugc nofollow" target="_blank">https://unit8co.github.io/darts/index.html#</a></p></div><div class="ab cl ip iq go ir" role="separator"><span class="is bw bk it iu iv"/><span class="is bw bk it iu iv"/><span class="is bw bk it iu"/></div><div class="ha hb hc hd he"><h1 id="1613" class="kj kk hh bd kl km nu ko kp kq nv ks kt ku nw kw kx ky nx la lb lc ny le lf lg bi translated">结论</h1><p id="ea59" class="pw-post-body-paragraph iw ix hh iy b iz lh jb jc jd li jf jg jh lj jj jk jl lk jn jo jp ll jr js jt ha bi translated">对于任何大型组织来说，时间序列分析都是数据分析最重要的方面之一，因为它有助于了解销售和分销中的季节性、趋势、周期性和随机性以及其他属性。我觉得在Python中使用scikit-learn或任何其他时间序列包的体验并不顺畅。</p><p id="acf0" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">因此，Darts是一个专用于时间序列的库，它使python中的预测变得容易，并帮助我们加快这个过程，以便- <br/> 1。降低成本。<br/> 2。提高准确性。<br/> 3。减少人工。</p><p id="0305" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">感谢您的阅读！希望有帮助:)</p></div></div>    
</body>
</html>