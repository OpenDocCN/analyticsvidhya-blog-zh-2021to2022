<html>
<head>
<title>How to predict user churn with PySpark on Big Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在大数据上用PySpark预测用户流失</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-predict-user-churn-with-pyspark-on-big-data-f5922865d72b?source=collection_archive---------4-----------------------#2021-07-07">https://medium.com/analytics-vidhya/how-to-predict-user-churn-with-pyspark-on-big-data-f5922865d72b?source=collection_archive---------4-----------------------#2021-07-07</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/7d18fad905301ab656076fbff2a77d9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GE5kaDzGbNl0H3YtCl6HRQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated"><a class="ae it" href="https://databricks.com/glossary/pyspark" rel="noopener ugc nofollow" target="_blank">https://databricks.com/glossary/pyspark</a></figcaption></figure><p id="2c70" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">想象你正在为世界上最大的(虚构的)音乐流媒体公司<strong class="iw hi"> Sparkify </strong>工作。一切都很顺利，直到你开始失去付费客户。然而，该公司一直在为其用户保留详细的日志，包括他们的活动，每次会话花费的时间和人口统计数据等。</p><p id="0a1b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">“这是我的时刻”，你可能会说。熊猫、Matplotlib和scikit的时候到了——学会展现自己的价值，为剩下的用户提供准确的流失(取消)预测。我们开始吧！</p><blockquote class="js"><p id="298b" class="jt ju hh bd jv jw jx jy jz ka kb jr dx translated">但是等一下，这个数据集有超过1亿行。</p><p id="7331" class="jt ju hh bd jv jw jx jy jz ka kb jr dx translated">哦不。</p></blockquote><figure class="kd ke kf kg kh ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kc"><img src="../Images/2bac202b64e39c6fd20bebe43d670862.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EhP50KW2TqwP84z5zsjxjg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">Udacity数据科学</figcaption></figure><h1 id="05c6" class="ki kj hh bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">项目概述</h1><p id="a647" class="pw-post-body-paragraph iu iv hh iw b ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi translated">考虑到如此大量的数据，没有一台机器能够在合理的时间内(如果有的话)产生有意义的输出。所以，我们需要一个新的解决方案:进入<strong class="iw hi">阿帕奇火花</strong>。</p><p id="7b15" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">Spark和它的Python API，<strong class="iw hi"> PySpark，</strong>可以通过在分布式机器集群上工作来解决这个问题，比如AWS Elastic Map-Reduce (EMR)服务。</p><p id="5477" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">它可以操纵大型和现实的数据集，以设计预测客户流失的相关功能。此外，Spark MLlib可以利用大型数据集构建机器学习模型，远远超过scikit-learn等非分布式技术所能做到的。</p><h2 id="6814" class="ll kj hh bd kk lm ln lo ko lp lq lr ks jf ls lt kw jj lu lv la jn lw lx le ly bi translated">问题陈述</h2><p id="1a76" class="pw-post-body-paragraph iu iv hh iw b ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi translated">给定一个音乐流媒体服务的大量用户日志，预测哪些用户对该服务<em class="lz">满意或</em> <em class="lz">不满意</em>。这被定义为<strong class="iw hi">用户流失，</strong>因为了解为什么会发生这种情况以采取纠正措施很重要。</p><p id="8dab" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">数据集包含用户日志，其中包含有关用户及其行为的信息，如唯一id、时间戳、会话信息、订阅类型和用户操作。</p><h2 id="d1df" class="ll kj hh bd kk lm ln lo ko lp lq lr ks jf ls lt kw jj lu lv la jn lw lx le ly bi translated">项目细分:</h2><ol class=""><li id="911a" class="ma mb hh iw b ix lg jb lh jf mc jj md jn me jr mf mg mh mi bi translated"><strong class="iw hi">数据预处理:</strong>加载并清理数据，检查无效或缺失的条目(即没有用户id)。</li><li id="d534" class="ma mb hh iw b ix mj jb mk jf ml jj mm jn mn jr mf mg mh mi bi translated"><strong class="iw hi">探索性数据分析:</strong>定义流失，比较流失用户与未流失用户的行为。</li><li id="8a5e" class="ma mb hh iw b ix mj jb mk jf ml jj mm jn mn jr mf mg mh mi bi translated"><strong class="iw hi">特征工程:</strong>在探索用于训练模型的数据之后构建特征。</li><li id="b8a1" class="ma mb hh iw b ix mj jb mk jf ml jj mm jn mn jr mf mg mh mi bi translated"><strong class="iw hi">模型实现和验证:</strong>将数据集拆分成train/val/test集，比较几种ML方法，评估性能(精度和F1分数)。</li></ol><h1 id="ecbd" class="ki kj hh bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">数据预处理</h1><p id="3af8" class="pw-post-body-paragraph iu iv hh iw b ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi translated">数据集以JSON格式存储，具有<strong class="iw hi"> 18 </strong> <strong class="iw hi">字段</strong>(特性)，并包含用户日志，其中包含有关用户及其行为的信息，如唯一id、时间戳、会话信息、订阅类型和用户操作，具体如下所示:</p><figure class="mp mq mr ms fd ii er es paragraph-image"><div class="er es mo"><img src="../Images/7a420420dfcc32427e87bec9932ecbfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*nSMsIFKppALhAbc_ONYQgA.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">火花化数据集架构</figcaption></figure><p id="f498" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">此外，<code class="du mt mu mv mw b">page</code>字段特别重要，因为它描述了用户采取的动作，这些动作是从访问过的页面得到的。这些被定义为<code class="du mt mu mv mw b">user events </code>，如下所示:</p><figure class="mp mq mr ms fd ii er es paragraph-image"><div class="er es mx"><img src="../Images/27d997f7310650983fc7736b411c1ba4.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/format:webp/1*lvjPwb0LA36o8dPbxhOLCw.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">带有计数的页面事件的类型</figcaption></figure><p id="34db" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">删除指定的行后，数据集还剩下278154行，其中包含18个要素。</p><p id="1942" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">第一步是确保数据没有问题。特别是，如果一行缺少<code class="du mt mu mv mw b">userID</code>或<code class="du mt mu mv mw b">sessionID</code>，那么它就不能链接到用户，并且会被删除。</p><p id="e052" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因为目标是预测客户流失，所以必须定义这个特性。一个新的列<code class="du mt mu mv mw b">Churn</code>被用作未来模型的标签，它由<code class="du mt mu mv mw b">Cancellation Confirmation</code>事件定义，这些事件对付费和免费用户都发生。如果注册了这样的事件，用户将获得正的<code class="du mt mu mv mw b">Churn</code>值1，否则为0。这样，问题就变成了一个二元分类问题。</p><h1 id="8367" class="ki kj hh bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated"><strong class="ak">探索性数据分析</strong></h1><p id="28c1" class="pw-post-body-paragraph iu iv hh iw b ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi translated">随后，生成了许多可视化效果，首先比较活动用户和取消用户之间的<strong class="iw hi">订阅类型(级别)</strong><strong class="iw hi">(订阅状态)</strong>。正如所料，这两个类的免费用户数量都更多:</p><figure class="mp mq mr ms fd ii er es paragraph-image"><div class="er es my"><img src="../Images/dd9a0cbdfdd6426dded03a8fd17f759d.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*zvAGA0qA887mdnGnJigTeQ.png"/></div></figure><p id="4c6b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">接下来是根据订阅状态比较性别分布，如下图所示:</p><figure class="mp mq mr ms fd ii er es paragraph-image"><div class="er es mz"><img src="../Images/2dc214b39e183878c5334bca8122004f.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*zbxS49CtgHCXyJxTmdsNLQ.png"/></div></figure><p id="236e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下图显示了一个重要的亮点，其中由<code class="du mt mu mv mw b">page</code>列定义的事件根据订阅状态进行了比较。可以观察到，最终取消的用户有更负面的体验:</p><figure class="mp mq mr ms fd ii er es paragraph-image"><div class="er es na"><img src="../Images/e32850f16bbe3b1385fd9374719ac34b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*fkODO3avUGOTbTRrd_e_HA.png"/></div></figure><p id="aacc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">对于被搅动的用户来说，特别重要的似乎是:</p><ul class=""><li id="011c" class="ma mb hh iw b ix iy jb jc jf nb jj nc jn nd jr ne mg mh mi bi translated"><strong class="iw hi">显示的广告数量(滚动广告)</strong>；比未搅拌的高得多</li><li id="c1ec" class="ma mb hh iw b ix mj jb mk jf ml jj mm jn mn jr ne mg mh mi bi translated"><strong class="iw hi">点赞数(竖起大拇指)</strong>；低于未搅拌的</li><li id="caa5" class="ma mb hh iw b ix mj jb mk jf ml jj mm jn mn jr ne mg mh mi bi translated"><strong class="iw hi">不喜欢的数量(拇指向下)</strong>；高于未搅拌的</li></ul><p id="a051" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">然后，为两个订阅计算基于小时播放的歌曲数量的分布。最终取消的用户在下午听了更大比例的歌曲，尤其是在15-20:</p><figure class="mp mq mr ms fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nf"><img src="../Images/037ab6b1e68b6d81978bdebfefff08c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BCclfnouw4nVAYETETIMDQ.png"/></div></div></figure><p id="02da" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最后，在前半个月，被搅动的用户注册的页面事件的平均数量<strong class="iw hi">也明显高于</strong>，之后会显著下降。这与活跃用户不同，活跃用户在一个月内的行为更加一致:</p><figure class="mp mq mr ms fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ng"><img src="../Images/f9425480683e3ad128eb2500dec030f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UDKCNRvStA-1FFlUatBCUA.png"/></div></div></figure><h1 id="7f9e" class="ki kj hh bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated"><strong class="ak">特色工程</strong></h1><p id="13c3" class="pw-post-body-paragraph iu iv hh iw b ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi translated">在熟悉数据之后，有必要为机器学习模型建立一些特征来进行训练，因为原始数据不能直接使用。因此，功能分为两类:</p><p id="4000" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="lz">用户统计:</em></p><ul class=""><li id="428b" class="ma mb hh iw b ix iy jb jc jf nb jj nc jn nd jr ne mg mh mi bi translated">播放的歌曲数量、艺术家数量、平均收听时间、总收听时间、用户寿命、用户性别、用户订阅类型</li></ul><p id="b4f3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="lz">用户事件:</em></p><ul class=""><li id="2d23" class="ma mb hh iw b ix iy jb jc jf nb jj nc jn nd jr ne mg mh mi bi translated">平均值。每次会话的歌曲数量、错误数量、给出的喜欢数量、给出的不喜欢数量、添加到播放列表的歌曲数量、显示的广告数量、帮助页面访问量。</li></ul><p id="811d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="lz">标签:</em> <code class="du mt mu mv mw b">Churn</code>每个用户的值。</p><figure class="mp mq mr ms fd ii er es paragraph-image"><div class="er es nh"><img src="../Images/50b72f2debe36c60aa3eda4f8a7517d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*r6n7TX7Q5UY21YM_KzWZVg.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">ML型号的工程特性</figcaption></figure><p id="df20" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">然后使用PySpark的<code class="du mt mu mv mw b">VectorAssembler</code>对新要素进行矢量化(无标签)，并使用<code class="du mt mu mv mw b">StandardScaler</code>进行缩放，因为要素之间的值差异很大；例如点赞数:21；总收听时间:94008。</p><h1 id="f162" class="ki kj hh bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated"><strong class="ak">模型实施和验证</strong></h1><p id="5ddc" class="pw-post-body-paragraph iu iv hh iw b ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi translated">在训练模型之前，新特征数据集按照以下比例被随机分为训练、验证和测试:<code class="du mt mu mv mw b">[0.7, 0.1, 0.2]</code>。</p><h2 id="ceaa" class="ll kj hh bd kk lm ln lo ko lp lq lr ks jf ls lt kw jj lu lv la jn lw lx le ly bi translated">韵律学</h2><p id="8651" class="pw-post-body-paragraph iu iv hh iw b ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi translated">对于评分，使用两个指标，<strong class="iw hi">准确度</strong>和<strong class="iw hi"> F1分数</strong>。F1尤其相关，因为与其他用户相比，搅动的用户子集相当小。指标定义如下:</p><figure class="mp mq mr ms fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ni"><img src="../Images/358289d3ee557b2f7257dcb0e6149d14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DLxj9Iu_2MneKaZTJwfn3A.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">准确性度量定义</figcaption></figure><figure class="mp mq mr ms fd ii er es paragraph-image"><div class="er es nj"><img src="../Images/3cc2e93b7bf705dc7b38ddae76e4ab19.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*p_szGF8ckJmI5Y-2G3MvVw.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">F1得分指标定义</figcaption></figure><p id="d46a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">使用网格搜索和三重交叉验证(CV)来训练和测试三个不同的机器学习模型，以找到超参数的最佳组合和最佳执行模型:</p><h2 id="89fe" class="ll kj hh bd kk lm ln lo ko lp lq lr ks jf ls lt kw jj lu lv la jn lw lx le ly bi translated">逻辑回归:</h2><p id="68e0" class="pw-post-body-paragraph iu iv hh iw b ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi translated">测试的第一个模型类型是逻辑回归(logit)。它是一种预测分析，可以解释因变量(输出变量)和一组自变量(输入变量)之间的关系。对于Sparkify，这会导致二元逻辑回归问题(流失与无流失),其特征如下:</p><ul class=""><li id="a4e4" class="ma mb hh iw b ix iy jb jc jf nb jj nc jn nd jr ne mg mh mi bi translated"><code class="du mt mu mv mw b">maxIter=10</code></li><li id="a93e" class="ma mb hh iw b ix mj jb mk jf ml jj mm jn mn jr ne mg mh mi bi translated">网格搜索:<code class="du mt mu mv mw b">regParam=[.0, .05, .1]</code></li><li id="8e12" class="ma mb hh iw b ix mj jb mk jf ml jj mm jn mn jr ne mg mh mi bi translated">测试结果(最佳模型):精度:0.7611；F1: 0.6824</li></ul><h2 id="cf43" class="ll kj hh bd kk lm ln lo ko lp lq lr ks jf ls lt kw jj lu lv la jn lw lx le ly bi translated">神经网络(多层感知器):</h2><p id="e964" class="pw-post-body-paragraph iu iv hh iw b ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi translated">多层感知器分类器，通常称为前馈神经网络，是另一种类型的分类器，由多层节点组成。每一层都完全连接到网络中的下一层，其中第一层中的节点表示输入数据，其余节点将输入映射到输出层:</p><ul class=""><li id="a6e8" class="ma mb hh iw b ix iy jb jc jf nb jj nc jn nd jr ne mg mh mi bi translated">层:<code class="du mt mu mv mw b">[14, 10, 6, 2]</code>，在那里麻木。特征是14，输出是2(二进制分类)。</li><li id="d32e" class="ma mb hh iw b ix mj jb mk jf ml jj mm jn mn jr ne mg mh mi bi translated"><code class="du mt mu mv mw b">blockSize=32</code></li><li id="2741" class="ma mb hh iw b ix mj jb mk jf ml jj mm jn mn jr ne mg mh mi bi translated"><code class="du mt mu mv mw b">solver="l-bfgs"</code></li><li id="6c1f" class="ma mb hh iw b ix mj jb mk jf ml jj mm jn mn jr ne mg mh mi bi translated">网格搜索:<code class="du mt mu mv mw b">stepSize=[.01, .1]</code></li><li id="e76a" class="ma mb hh iw b ix mj jb mk jf ml jj mm jn mn jr ne mg mh mi bi translated">Sigmoid激活和Softmax最终层</li><li id="a030" class="ma mb hh iw b ix mj jb mk jf ml jj mm jn mn jr ne mg mh mi bi translated">测试结果(最佳模型):精度:0.8059；F1: 0.7890</li></ul><h2 id="478e" class="ll kj hh bd kk lm ln lo ko lp lq lr ks jf ls lt kw jj lu lv la jn lw lx le ly bi translated">梯度增强树:</h2><p id="5f17" class="pw-post-body-paragraph iu iv hh iw b ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi translated">最终开发的分类器基于一种<em class="lz">集成</em>技术，梯度增强树(GBT)。在实践中，该模型由多个决策树组成，这些决策树被迭代训练以最小化损失函数，具有梯度下降的版本(类似于神经网络):</p><ul class=""><li id="c236" class="ma mb hh iw b ix iy jb jc jf nb jj nc jn nd jr ne mg mh mi bi translated"><code class="du mt mu mv mw b">maxIter=10</code></li><li id="6efe" class="ma mb hh iw b ix mj jb mk jf ml jj mm jn mn jr ne mg mh mi bi translated">网格搜索:<code class="du mt mu mv mw b">maxDepth=[4, 5]</code></li><li id="15be" class="ma mb hh iw b ix mj jb mk jf ml jj mm jn mn jr ne mg mh mi bi translated">测试结果(最佳模型):精度:0.8060；F1: 0.7950</li></ul><h1 id="ed4c" class="ki kj hh bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">结果</h1><p id="ada6" class="pw-post-body-paragraph iu iv hh iw b ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi translated">基于以上结果，<strong class="iw hi">梯度增强树(GBT)模型</strong>被选为性能最好的模型。最终验证结果是:</p><ul class=""><li id="583b" class="ma mb hh iw b ix iy jb jc jf nb jj nc jn nd jr ne mg mh mi bi translated"><code class="du mt mu mv mw b">maxIter=10</code></li><li id="83af" class="ma mb hh iw b ix mj jb mk jf ml jj mm jn mn jr ne mg mh mi bi translated"><code class="du mt mu mv mw b">maxDepth=5</code></li><li id="fead" class="ma mb hh iw b ix mj jb mk jf ml jj mm jn mn jr ne mg mh mi bi translated"><strong class="iw hi"> GBT精度:0.8059；F1: 0.7950 </strong></li></ul><h2 id="0e1a" class="ll kj hh bd kk lm ln lo ko lp lq lr ks jf ls lt kw jj lu lv la jn lw lx le ly bi translated">正当理由；辩解</h2><p id="9793" class="pw-post-body-paragraph iu iv hh iw b ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi translated">GBT模型的另一个优势是能够通过使用梯度值来说明最有价值的要素。下图说明并证实了exploration部分所做的假设，因为预测每个用户流失的最有价值的特征是访问帮助页面的次数<strong class="iw hi"/>，其次是显示的广告数量<strong class="iw hi"/>，添加到播放列表中的歌曲数量<strong class="iw hi">和不喜欢的数量<strong class="iw hi"/></strong></p><figure class="mp mq mr ms fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nk"><img src="../Images/4552796d47146debbce8821c8a018b67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Aldq-ywI8F35MiSMkkcSw.png"/></div></div></figure><p id="63bb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这些信息对整个公司来说可能非常有价值，因为它证明了<strong class="iw hi"> <em class="lz">为什么</em> </strong>用户对服务<em class="lz">不满意，而不仅仅是</em> <strong class="iw hi"> <em class="lz">谁</em> </strong> <em class="lz">对</em>不满意<em class="lz">。</em></p><h1 id="c906" class="ki kj hh bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">结论</h1><p id="4e15" class="pw-post-body-paragraph iu iv hh iw b ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi translated">总而言之，当数据量对于单台机器来说太大时，Spark是一个很好的工具，因为它可以在分布式集群中分配工作负载。</p><p id="7e81" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在给定的Sparkify场景中，成功开发了一个<strong class="iw hi">梯度提升树</strong>模型来预测可能会取消订阅(流失)的用户，而<strong class="iw hi">功能重要性分数</strong>则提供了一个关于哪些功能与预测最相关的清晰画面。</p><h2 id="e8a0" class="ll kj hh bd kk lm ln lo ko lp lq lr ks jf ls lt kw jj lu lv la jn lw lx le ly bi translated">改进</h2><p id="bff7" class="pw-post-body-paragraph iu iv hh iw b ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn lk jp jq jr ha bi translated">根据模型结果，下一步是将系统部署到AWS的EMR，并从大型数据集(12 GB)中获取结果。此外，可以部署一个web应用程序来以交互方式展示结果。</p><p id="7669" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">感谢阅读！</p><p id="3ff8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">提比略-伊万·萨特马里</strong></p><p id="f6a7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">iosz@demant.com</p><p id="0b70" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">链接到<a class="ae it" href="https://github.com/tioans/spark-user-churn" rel="noopener ugc nofollow" target="_blank"> GitHub </a>。</p></div></div>    
</body>
</html>