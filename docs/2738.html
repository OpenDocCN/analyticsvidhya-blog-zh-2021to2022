<html>
<head>
<title>Using Deep Learning for Mammography Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨æ·±åº¦å­¦ä¹ è¿›è¡Œä¹³è…ºæ‘„å½±åˆ†ç±»</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/using-convolutional-neural-networks-for-mammogram-classification-6e67ed4e0cad?source=collection_archive---------4-----------------------#2021-05-15">https://medium.com/analytics-vidhya/using-convolutional-neural-networks-for-mammogram-classification-6e67ed4e0cad?source=collection_archive---------4-----------------------#2021-05-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a85f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">é¦–æ¬¡äº®ç›¸ä¸­çº§å’Œæ·±åº¦å­¦ä¹ :)ğŸ’»</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="aa3c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æˆ‘å¯¹å›¾åƒåˆ†ç±»å¾ˆæ„Ÿå…´è¶£ï¼Œè¿™æ˜¯ä¸€æ¬¡éå¸¸ä¸°å¯Œçš„ç»å†ï¼Œç‰¹åˆ«æ˜¯è¿™ä¸ªä¸»é¢˜çš„é‡è¦æ€§ã€‚è¿™ä¸ªå°é¡¹ç›®æ˜¯æˆ‘åœ¨Awariæ•°æ®ç§‘å­¦å­¦é™¢è¿›è¡Œæ¯•ä¸šè®¾è®¡çš„çµæ„Ÿæ¥æºã€‚</p><p id="c40c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">è·å–æ•°æ®</strong></p><p id="3939" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Miasä¹³æˆ¿é€ å½±æ•°æ®é›†å¯ä»Kaggleç½‘ç«™ä¸‹è½½ï¼Œç½‘å€ä¸º:</p><div class="jk jl ez fb jm jn"><a href="https://www.kaggle.com/kmader/mias-mammography" rel="noopener  ugc nofollow" target="_blank"><div class="jo ab dw"><div class="jp ab jq cl cj jr"><h2 class="bd hj fi z dy js ea eb jt ed ef hh bi translated">MIASä¹³æˆ¿xçº¿æ‘„å½±</h2><div class="ju l"><h3 class="bd b fi z dy js ea eb jt ed ef dx translated">å¯»æ‰¾ä¹³è…ºç™Œ</h3></div><div class="jv l"><p class="bd b fp z dy js ea eb jt ed ef dx translated">www.kaggle.com</p></div></div></div></a></div><p id="bd3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">MIASæ•°æ®é›†</strong></p><p id="f494" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¯¥æ•°æ®é›†æœ€åˆæœ‰332å¼ å¤§å°ä¸º1024x1024çš„ç°åº¦ä¹³æˆ¿xå…‰ç…§ç‰‡ã€‚æœ‰6ç±»å¼‚å¸¸ï¼ŒæŒ‰ä¸¥é‡ç¨‹åº¦åˆ†ä¸ºè‰¯æ€§(B)æˆ–æ¶æ€§(M)ã€‚æ­£å¸¸æ‰«æï¼Œå³ä¸å­˜åœ¨å¼‚å¸¸çš„æ‰«æï¼Œå‡ºäºåˆ†ç±»ç›®çš„è¢«ä»»æ„åœ°èµ‹äºˆå€¼(A)ã€‚</p><p id="774c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°è¿™ä¸ªé¡¹ç›®<a class="ae jw" href="https://github.com/cpoles/data_science/tree/main/projects/deep_learning/mias_mammography" rel="noopener ugc nofollow" target="_blank">çš„ä»£ç å’Œéœ€è¦çš„æ–‡ä»¶ã€‚</a></p><p id="1f1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">é¡¹ç›®æ–‡ä»¶å¤¹ç»“æ„</strong></p><p id="9670" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">â”œâ”€â”€å…¨mias <br/> â”œâ”€â”€ç¬”è®°æœ¬<br/> â””â”€â”€ src <br/> â””â”€â”€æ¨¡å—</p><p id="7b6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="jx">all-mias</em></strong><em class="jx">:åŸå§‹æ‰«æ<br/> </em> <strong class="ih hj"> <em class="jx">ç¬”è®°æœ¬</em> </strong> <em class="jx"> : jupyterç¬”è®°æœ¬<br/></em><strong class="ih hj"><em class="jx">src/modules</em></strong><em class="jx">:è‡ªå®šä¹‰åº“å’Œç±»</em></p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="aa69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">åº“</strong></p><pre class="jy jz ka kb fd kc kd ke kf aw kg bi"><span id="5311" class="kh ki hi kd b fi kj kk l kl km"># system related<br/>import os<br/>import sys</span><span id="f030" class="kh ki hi kd b fi kn kk l kl km">sys.path.append('../src/')</span><span id="bbc5" class="kh ki hi kd b fi kn kk l kl km"># import custom modules<br/>import helpers as hp<br/>import mammoscan as ms</span><span id="eb5e" class="kh ki hi kd b fi kn kk l kl km"># path manipulation</span><span id="6a36" class="kh ki hi kd b fi kn kk l kl km">from pathlib import Path</span><span id="9c9c" class="kh ki hi kd b fi kn kk l kl km"># regex<br/>import re</span><span id="fe4c" class="kh ki hi kd b fi kn kk l kl km"># plotting<br/>import matplotlib.pyplot as plt<br/>import matplotlib.image as mpimg<br/>from matplotlib.patches import Circle</span><span id="734c" class="kh ki hi kd b fi kn kk l kl km"># data manipulation / preparation<br/>import numpy as np<br/>import pandas as pd<br/>from sklearn.model_selection import train_test_split<br/>from tensorflow.keras.preprocessing.image import ImageDataGenerator</span><span id="f703" class="kh ki hi kd b fi kn kk l kl km"># image manipulation<br/>from PIL import Image<br/>from IPython.display import Image</span><span id="bb7a" class="kh ki hi kd b fi kn kk l kl km"># metrics<br/>from sklearn.metrics import confusion_matrix, classification_report</span><span id="eb18" class="kh ki hi kd b fi kn kk l kl km"># keras<br/>from tensorflow.keras.models import Sequential</span><span id="f8c1" class="kh ki hi kd b fi kn kk l kl km">from tensorflow.keras.layers import Conv2D, Dense, Flatten, MaxPool2D, Dropout</span><span id="9877" class="kh ki hi kd b fi kn kk l kl km">from tensorflow.keras.utils import plot_model</span><span id="60cf" class="kh ki hi kd b fi kn kk l kl km">from tensorflow.keras.callbacks import EarlyStopping, ModelCheckpoint</span><span id="b9b4" class="kh ki hi kd b fi kn kk l kl km">from tensorflow.keras.optimizers import Adam</span></pre><p id="fe59" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">ä¸ºæ‰«æä¿¡æ¯åˆ›å»ºæ•°æ®å¸§</strong></p><p id="9ef0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"><em class="jx">create _ mias _ dataset(path:)</em></strong>å‡½æ•°ä¸ºå®éªŒåˆ›å»ºå¿…è¦çš„æ•°æ®å¸§ã€‚å®ƒå°†åŒ…å«æ‰«ææ•°æ®çš„æ–‡æœ¬æ–‡ä»¶(' scan_file_data.txt ')çš„è·¯å¾„ä½œä¸ºå‚æ•°ã€‚</p><pre class="jy jz ka kb fd kc kd ke kf aw kg bi"><span id="f291" class="kh ki hi kd b fi kj kk l kl km">mammo = hp.create_mias_dataset('../scan_file_data.txt')</span></pre><p id="1e6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">æ•°æ®æ¡†åˆ—æè¿°:</strong></p><pre class="jy jz ka kb fd kc kd ke kf aw kg bi"><span id="484a" class="kh ki hi kd b fi kj kk l kl km">1st column:<br/>MIAS database reference number.</span><span id="a70e" class="kh ki hi kd b fi kn kk l kl km">2nd column:<br/>Character of background tissue:<br/>F Fatty<br/>G Fatty-glandular<br/>D Dense-glandular</span><span id="26a3" class="kh ki hi kd b fi kn kk l kl km">3rd column:<br/>Class of abnormality present:<br/>CALC Calcification<br/>CIRC Well-defined/circumscribed masses<br/>SPIC Spiculated masses<br/>MISC Other, ill-defined masses<br/>ARCH Architectural distortion<br/>ASYM Asymmetry<br/>NORM Normal</span><span id="f7d0" class="kh ki hi kd b fi kn kk l kl km">4th column:<br/>Severity of abnormality;<br/>B Benign<br/>M Malignant</span><span id="f2a8" class="kh ki hi kd b fi kn kk l kl km">5th, 6th columns:<br/>x,y image-coordinates of centre of abnormality.</span><span id="43c4" class="kh ki hi kd b fi kn kk l kl km">7th column:<br/>Approximate radius (in pixels) of a circle enclosing the abnormality.</span></pre><p id="b949" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">ç›è«æ–¯åçº§</strong></p><p id="c46b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Mammoscanç±»å°è£…äº†æ‰«æå›¾åƒåŠå…¶ç›¸åº”çš„æ•°æ®ã€‚è¯¥ç±»æä¾›äº†ä¸€ä¸ªAPIæ¥è®¿é—®å®ƒçš„å±æ€§å’Œæ–¹æ³•ï¼Œä»¥ä¾¿ä¸ºæ¨¡å‹ç»˜åˆ¶å’Œç”Ÿæˆç¼©å°çš„è£å‰ªå›¾åƒã€‚å¯ä»¥é€šè¿‡å¯¼å…¥'<strong class="ih hj"><em class="jx">/SCR/modules/Mammoscan . py '</em></strong>æ–‡ä»¶æ¥ä½¿ç”¨Mammoscanç±»ã€‚</p><p id="c695" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">æ•°æ®å‡†å¤‡</strong></p><p id="9f99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä¸€äº›æ‰«æåŒ…å«ä¸å¯ç”¨çš„æ•°æ®ï¼Œå› æ­¤æœ€åˆå¿…é¡»ç§»é™¤ï¼Œå› ä¸ºå®ƒä»¬ç¼ºå°‘å¼‚å¸¸çš„ä½ç½®ã€‚åœ¨<strong class="ih hj"> <em class="jx"> helpers.py </em> </strong>æ¨¡å—ä¸­ï¼Œæœ‰ä¸€ä¸ªç”¨äºåˆ é™¤æ­¤ç±»æ‰«æçš„åŠŸèƒ½:</p><pre class="jy jz ka kb fd kc kd ke kf aw kg bi"><span id="b344" class="kh ki hi kd b fi kj kk l kl km">def clean_ds_files(df: pd.DataFrame) -&gt; pd.DataFrame:<br/> â€˜â€™â€™Removes records with invalid data<br/> and cast x and y to floatâ€™â€™â€™<br/> new_df = df.copy()<br/> # search for invalid x values for removal<br/> indices = new_df.x[lambda x: x == â€˜*NOTEâ€™].index<br/> <br/> for idx in indices:<br/> n_idx = new_df.index.get_loc(idx)<br/> # drop from dataset<br/> new_df.drop(new_df.index[n_idx], inplace=True)<br/> # delete from directory<br/> delete_image(idx)</span><span id="9097" class="kh ki hi kd b fi kn kk l kl km"># make x and y float values<br/> new_df.x = new_df.x.astype(float)<br/> new_df.y = new_df.y.astype(float)<br/> <br/> return new_df</span></pre><p id="f676" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ ¹æ®<strong class="ih hj"> <em class="jx"> Gregoryç­‰äºº</em> </strong>çš„è¯´æ³•ï¼Œç”¨å°å°ºå¯¸å›¾åƒæ‹ŸåˆCNNå°†æé«˜è®¡ç®—æ€§èƒ½å’Œæ¯ä¸ªå¼‚å¸¸çš„å¬å›ç‡ã€‚æ­¤å¤–ï¼Œåˆ›å»ºåŸå§‹å›¾åƒçš„å­é›†ä¹Ÿå°†æ”¹å–„åˆ†ç±»ç»“æœã€‚è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºæ•°æ®æ‰©å……ï¼Œæ—¨åœ¨åˆ©ç”¨CNNåœ¨æ•°æ®é›†æœ€åˆæä¾›çš„æ‰«ææ ·æœ¬å¦‚æ­¤ä¹‹å°‘çš„æƒ…å†µä¸‹çš„æ€§èƒ½ã€‚</p><p id="fcb8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç­–ç•¥æ˜¯åœ¨æ‰«æä¸­åˆ›å»ºå¼‚å¸¸çš„æ—‹è½¬å’Œé•œåƒç¼©å°ç‰ˆæœ¬ã€‚è¿™äº›ä¹³æˆ¿xå…‰ç‰‡åŒ…å«(xï¼Œy)åæ ‡å’Œå¼‚å¸¸çš„åŠå¾„ï¼ŒæŒ‡ç¤ºæ½œåœ¨è‚¿ç˜¤(è‰¯æ€§(B)æˆ–æ¶æ€§(M ))å¯èƒ½åœ¨å“ªé‡Œã€‚è‡³äºæ­£å¸¸æ‰«æï¼Œå†³å®šéšæœºé€‰æ‹©å›¾åƒä¸­å¿ƒå‘¨å›´çš„ä¸€ä¸ªç‚¹ï¼Œå¹¶æŒ‰ç…§Gregoryç­‰äººçš„å»ºè®®è¿›è¡Œ48x48çš„è£å‰ªã€‚</p><p id="9563" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">å›¾åƒå˜æ¢</strong></p><figure class="jy jz ka kb fd kp er es paragraph-image"><div class="er es ko"><img src="../Images/00bfb4f53b5e2c915ca091fd95b22e05.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*PhdNJ_MteGN_-60-gESJOw.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">åŸå§‹æ‰«æ</figcaption></figure><figure class="jy jz ka kb fd kp er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es kw"><img src="../Images/0154ea3b7476ce5baa207b041648ee4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*QButQ7gmrs9yRN0oeL_2ew.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">è£å‰ªæ—‹è½¬ç‰ˆæœ¬ç¤ºä¾‹(ä¸Šä¸‹é•œåƒ)</figcaption></figure><figure class="jy jz ka kb fd kp er es paragraph-image"><div class="er es ko"><img src="../Images/7754dfa629574569590969e458b339de.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*PNnblrISvU1cfmEa-nD5CA.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">åŸå§‹æ‰«æ</figcaption></figure><figure class="jy jz ka kb fd kp er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es kw"><img src="../Images/df474ebb2656317c74009ce6105b1dbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*tsDgDSwkQWrr92OKOh0NQw.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">è£å‰ªæ—‹è½¬ç‰ˆæœ¬ç¤ºä¾‹(ä¸Šä¸‹é•œåƒ)</figcaption></figure><p id="4d37" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">helpersæ¨¡å—æœ‰ä¸€ä¸ªåä¸º<strong class="ih hj"><em class="jx">generate _ sub samples(path:ï¼Œdf:) </em> </strong>çš„å‡½æ•°ï¼Œå®ƒæ‰§è¡Œæ‰€æœ‰å¿…è¦çš„å›¾åƒè½¬æ¢ï¼Œå¹¶å°†å®ƒä»¬ä¿å­˜åˆ°<em class="jx"> subsamples </em>æ–‡ä»¶å¤¹ä¸­ã€‚å®ƒè¿˜è¾“å‡ºåŒ…å«æ‰«ææ•°æ®çš„æ•°æ®æ¡†ï¼ŒåŒ…æ‹¬å›¾åƒçš„çŸ©é˜µç‰ˆæœ¬ä»¥åŠå›¾åƒåœ¨å­æ ·æœ¬æ–‡ä»¶å¤¹ä¸­çš„ä½ç½®ã€‚</p><pre class="jy jz ka kb fd kc kd ke kf aw kg bi"><span id="9af5" class="kh ki hi kd b fi kj kk l kl km">mias = hp.generate_subsamples('../all-mias/', mias)</span></pre><figure class="jy jz ka kb fd kp er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lb"><img src="../Images/fa35bc12354a217f6734c362c4b21224.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yzp5hMVpEXjXnDe3TW5qdQ.png"/></div></div></figure><p id="139e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨æ•°æ®æ‰©å……è¿‡ç¨‹ä¹‹åï¼Œæˆ‘ä»¬æœ‰3828ä¸ª48Ã—48çš„å›¾åƒã€‚è¿™è¡¨ç¤ºå›¾åƒæ•°é‡å¢åŠ äº†1100%ä»¥ä¸Šã€‚</p><p id="6c92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">å¼‚å¸¸æ•°æ®åˆ†å¸ƒ</strong></p><p id="2f82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å¤§çº¦65%çš„æ•°æ®é›†æ˜¯æ­£å¸¸æ‰«æã€‚è‡³äºå¼‚å¸¸ç±»ï¼Œæ•°æ®æ›´å¹³è¡¡ï¼Œä½†ä¸ç†æƒ³ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œåœ¨æ‹Ÿåˆæ¨¡å‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ¯ä¸ªç±»åˆ«ç›¸åŒæ•°é‡çš„è‰¯æ€§(B)å’Œæ¶æ€§(M)æ ·æœ¬ã€‚æ¯å½“ç”¨ä»»ä½•å¼‚å¸¸ç±»åˆ«çš„ä¸å¹³è¡¡æ‰«ææ ·æœ¬è¿›è¡Œè®­ç»ƒæ—¶ï¼Œè¯¥æ¨¡å‹è¡¨ç°ä¸ä½³ã€‚</p><figure class="jy jz ka kb fd kp er es paragraph-image"><div class="er es lc"><img src="../Images/3079430b3005043f80258959a56b9210.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*6b3-LtAU9HEvR11DWNgEJA.png"/></div></figure><p id="424e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½¿ç”¨äº†ä¸¤ç§æ•°æ®é›†å¹³è¡¡æ–¹æ³•:</p><ul class=""><li id="8b33" class="ld le hi ih b ii ij im in iq lf iu lg iy lh jc li lj lk ll bi translated"><strong class="ih hj">å®Œå…¨å¹³è¡¡</strong>:æ‰€æœ‰ç±»åˆ«æŒ‰ç…§ä¸¥é‡ç¨‹åº¦å¹³å‡åˆ†å¸ƒï¼Œå¹¶ä¸”åŸºäºæœ€ä¸é¢‘ç¹çš„ç±»åˆ«å…·æœ‰ç›¸åŒçš„æ ·æœ¬å¤§å°ã€‚</li><li id="b2f1" class="ld le hi ih b ii lm im ln iq lo iu lp iy lq jc li lj lk ll bi translated"><strong class="ih hj">ç±»åˆ«å¹³è¡¡</strong>:æ¯ä¸ªç±»åˆ«æŒ‰ç…§ä¸¥é‡æ€§å’ŒåŸå§‹æ ·æœ¬é‡å¹³å‡åˆ†é…</li></ul><p id="1be1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ‚¨å¯ä»¥ä½¿ç”¨è¾…åŠ©å‡½æ•°<strong class="ih hj"><em class="jx">balance _ df _ by _ severity(df:ï¼Œab_class:) </em> </strong>è¿›è¡Œç±»å¹³è¡¡ï¼Œæˆ–è€…ä½¿ç”¨<strong class="ih hj"><em class="jx">full _ balance _ df _ by _ severity(df:ï¼Œab_class:) </em> </strong>è¿›è¡Œå®Œå…¨åŒè´¨æ•°æ®é›†ã€‚</p><p id="5829" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">é’™åŒ–â€”â€”ç­‰çº§å¹³è¡¡ç¤ºä¾‹</strong></p><pre class="jy jz ka kb fd kc kd ke kf aw kg bi"><span id="3166" class="kh ki hi kd b fi kj kk l kl km">calcifications_unbalanced = mias[mias.ab_class == 'CALC']</span><span id="4fac" class="kh ki hi kd b fi kn kk l kl km">calcifications_unbalanced.severity.value_counts().plot(kind='bar')</span></pre><figure class="jy jz ka kb fd kp er es paragraph-image"><div class="er es lr"><img src="../Images/f6e123315da9f8b897bea223493a1a81.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*puLcDZs8IjJEmeje8jbEvg.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">å¹³è¡¡å‰çš„é’™åŒ–</figcaption></figure><pre class="jy jz ka kb fd kc kd ke kf aw kg bi"><span id="c2de" class="kh ki hi kd b fi kj kk l kl km">calcifications_balanced = hp.balance_by_severity(mias, 'CALC')</span><span id="7953" class="kh ki hi kd b fi kn kk l kl km">calcifications_balanced.severity.value_counts().plot(kind='bar')</span></pre><figure class="jy jz ka kb fd kp er es paragraph-image"><div class="er es lr"><img src="../Images/fe60e6d1d54f49206c6095428e9cfafd.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*yy91E6ZD432Yt7QKVlShLg.png"/></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">å¹³è¡¡åçš„é’™åŒ–</figcaption></figure><p id="9998" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Mias â€”ç±»å¹³è¡¡ç¤ºä¾‹</strong></p><figure class="jy jz ka kb fd kp er es paragraph-image"><div class="er es ls"><img src="../Images/a4b425a91e2e370f85c4c9d617c3c02e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*leaDK-_Bq0tZR0_di5EDrw.png"/></div></figure><p id="3428" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> Mias â€”å®Œå…¨å¹³è¡¡ç¤ºä¾‹</strong></p><figure class="jy jz ka kb fd kp er es paragraph-image"><div class="er es ls"><img src="../Images/ebbfdfa3b47e5f512554cdb8fb74fcdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*uVr5tjI2Kk-gFP5_QKJ-lQ.png"/></div></figure></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="94f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">å·ç§¯ç¥ç»ç½‘ç»œ</strong></p><p id="8140" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¯¥æ¨¡å‹æ˜¯ä½¿ç”¨è°·æ­Œçš„TensorFlowå»ºç«‹çš„ï¼Œå¹¶ä½¿ç”¨RELUä½œä¸ºå·ç§¯å±‚çš„æ¿€æ´»å‡½æ•°ã€‚å†³å®šè¾“å‡ºçš„æ¿€æ´»åŠŸèƒ½æ˜¯softmaxã€‚è¿˜åœ¨æ¯ä¸ªå·ç§¯åæ·»åŠ äº†æœ€å¤§æ±‡é›†ï¼Œå¹¶ä¸”ä¸‹é™ç‡ä¸º0.25ã€‚</p><p id="af9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è¾“å…¥å±‚æ˜¯å…·æœ‰32ä¸ªå†…æ ¸æ»¤æ³¢å™¨å¤§å°(3x3)çš„å·ç§¯å±‚ã€‚ç„¶åï¼Œæ·»åŠ äº†ä¸€ä¸ªé¢å¤–çš„å·ç§¯å±‚ï¼Œå…·æœ‰64ä¸ªå†…æ ¸è¿‡æ»¤å™¨å¤§å°(3Ã—3)å’Œä¸€ä¸ªæœ€å¤§æ± å¤§å°(2Ã—2)ã€‚</p><p id="f51c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ä½¿ç”¨softmaxæ¿€æ´»å‡½æ•°çš„å…¨è¿æ¥å±‚(å¯†é›†å±‚)è¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œè¯¥å…ƒç»„å…·æœ‰ç”¨äºæ¨æ–­å¼‚å¸¸ç±»åˆ«çš„æ¦‚ç‡ã€‚å…ƒç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ è¯´æ˜è‰¯æ€§(B)æ ·æœ¬ï¼Œç¬¬äºŒä¸ªå…ƒç´ è¯´æ˜æ¶æ€§(M)æ ·æœ¬ã€‚</p><pre class="jy jz ka kb fd kc kd ke kf aw kg bi"><span id="a95b" class="kh ki hi kd b fi kj kk l kl km">cnn_calc = Sequential()<br/># first layer<br/>cnn_calc.add(Conv2D(32, kernel_size=(3, 3),activation='relu',input_shape=(48, 48, 1)))<br/>cnn_calc.add(Conv2D(64, kernel_size=(3,3),activation='relu'))<br/>cnn_calc.add(MaxPool2D(pool_size=(2, 2)))</span><span id="5e1e" class="kh ki hi kd b fi kn kk l kl km">cnn_calc.add(Conv2D(64, kernel_size=(3,3),activation='relu'))<br/>cnn_calc.add(MaxPool2D(pool_size=(2, 2)))<br/>cnn_calc.add(Dropout(0.25))<br/># Add dense layer to reduce the number of features<br/>cnn_calc.add(Dense(64, activation='relu'))<br/>cnn_calc.add(Dropout(0.25))<br/># flattening results<br/>cnn_calc.add(Flatten())<br/># Dense layer to produce final output<br/>cnn_calc.add(Dense(2, activation='softmax'))<br/># print summary<br/>mass_calc.summary()</span></pre><figure class="jy jz ka kb fd kp er es paragraph-image"><div class="er es lt"><img src="../Images/d113e273cef9a2c56f579ee1859ac896.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*Mh73oNMT92dTyjImICjG-A.png"/></div></figure><pre class="jy jz ka kb fd kc kd ke kf aw kg bi"><span id="b403" class="kh ki hi kd b fi kj kk l kl km">Model: "sequential"<br/>_________________________________________________________________<br/>Layer (type)                 Output Shape              Param #   <br/>=================================================================<br/>conv2d (Conv2D)              (None, 46, 46, 32)        320       <br/>_________________________________________________________________<br/>conv2d_1 (Conv2D)            (None, 44, 44, 64)        18496     <br/>_________________________________________________________________<br/>max_pooling2d (MaxPooling2D) (None, 22, 22, 64)        0         <br/>_________________________________________________________________<br/>conv2d_2 (Conv2D)            (None, 20, 20, 64)        36928     <br/>_________________________________________________________________<br/>max_pooling2d_1 (MaxPooling2 (None, 10, 10, 64)        0         <br/>_________________________________________________________________<br/>dropout (Dropout)            (None, 10, 10, 64)        0         <br/>_________________________________________________________________<br/>dense (Dense)                (None, 10, 10, 64)        4160      <br/>_________________________________________________________________<br/>dropout_1 (Dropout)          (None, 10, 10, 64)        0         <br/>_________________________________________________________________<br/>flatten (Flatten)            (None, 6400)              0         <br/>_________________________________________________________________<br/>dense_1 (Dense)              (None, 2)                 12802     <br/>=================================================================<br/>Total params: 72,706<br/>Trainable params: 72,706<br/>Non-trainable params: 0<br/>_________________________________________________________________</span></pre><p id="91c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">è®­ç»ƒæ¨¡å‹</strong></p><p id="4e68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åŸºäºæµ‹è¯•ï¼Œå½“ä»¥0.001çš„å­¦ä¹ ç‡è®­ç»ƒ10ï¼Œ000ä¸ªæ—¶æœŸæ—¶ï¼Œæ‰€æœ‰æƒ…å†µä¸‹éƒ½è·å¾—äº†æœ€ä½³ç»“æœã€‚ç›®çš„æ˜¯æé«˜æ‰€æœ‰ç­çº§çš„å¬å›ç‡ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¸Œæœ›æ”¹å–„ä¸å‡é˜´æ€§å’Œå‡é˜³æ€§æ¡ˆä¾‹ç›¸å…³çš„ç»“æœï¼Œå¹¶å¢åŠ å¯¹çœŸé˜´æ€§å’ŒçœŸé˜³æ€§æ¡ˆä¾‹çš„è‡ªä¿¡ã€‚</p><p id="dde4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬éœ€è¦ä¼˜åŒ–æ¨¡å‹é¢„æµ‹è‰¯æ€§(B)è€Œå®é™…ä¸Šæ˜¯æ¶æ€§(M)å¼‚å¸¸çš„æƒ…å†µï¼Œåä¹‹äº¦ç„¶ã€‚ä»é”™è¯¯è¯Šæ–­çš„è§’åº¦æ¥çœ‹ï¼Œæ‚£è€…å¯èƒ½è¢«ç»™äºˆä¸å¿…è¦çš„æ²»ç–—(å‡é˜³æ€§)æˆ–æ²¡æœ‰åŠæ—¶æ¥å—æ²»ç–—(å‡é˜´æ€§)ã€‚</p><pre class="jy jz ka kb fd kc kd ke kf aw kg bi"><span id="1041" class="kh ki hi kd b fi kj kk l kl km"># compiling the model<br/>adam = Adam(0.001)<br/>cnn_calc.compile(optimizer=adam,<br/>            loss='categorical_crossentropy',<br/>            metrics=['accuracy'])</span><span id="8c8f" class="kh ki hi kd b fi kn kk l kl km"># training and evaluating the model<br/>early_stopping = EarlyStopping(patience=3000, restore_best_weights=True)</span><span id="0a0e" class="kh ki hi kd b fi kn kk l kl km">model_check_point = ModelCheckpoint(filepath= './', <br/>                                    monitor='val_loss', verbose=1, <br/>                                    save_best_only=True,<br/>                                    save_weights_only=False, <br/>                                    mode='auto', save_freq='epoch')</span><span id="4537" class="kh ki hi kd b fi kn kk l kl km"># fit the model<br/>hist = cnn_calc.fit(train_data, <br/>                    validation_data=test_data, <br/>                    epochs=10000,<br/>                    callbacks=[early_stopping, model_check_point])</span></pre><p id="727f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">è¿›è¡Œé¢„æµ‹å¹¶è¯„ä¼°ç»“æœ</strong></p><p id="adce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ ¹æ®ç»“æœï¼Œå½“æ¨¡å‹è¾¾åˆ°å…¶æœ€ä½éªŒè¯æŸå¤±æˆ–æœ€é«˜éªŒè¯å‡†ç¡®æ€§æ—¶ï¼Œæƒ…å†µä¼šæœ‰æ‰€ä¸åŒã€‚ä¸€äº›CNNéœ€è¦è‡³å°‘1000ä¸ªæ­¥éª¤æ¥äº§ç”Ÿä¸€è‡´çš„ç»“æœã€‚å°½ç®¡å¦‚æ­¤ï¼Œå½“ä»…ç”¨é’™åŒ–è®­ç»ƒæ—¶ï¼Œå¯ä»¥ç”¨è¾ƒå°‘çš„æ—¶æœŸè·å¾—ç›¸å¯¹æ»¡æ„çš„ç»“æœã€‚</p><p id="afc3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åœ¨ä¸‹é¢çš„æµ‹è¯•ä¸­ï¼Œè¯¥æ¨¡å‹å¯¹äºæ¶æ€§é’™åŒ–ç—…ä¾‹å®ç°äº†97%çš„å¬å›ç‡å’Œ100%çš„ç²¾ç¡®åº¦ã€‚è¿™æ˜¯æœ€å¥½çš„ç»“æœï¼Œå®ƒæ˜¯åœ¨Googleçš„Collabä¸Šä½¿ç”¨GPUè¿è¡Œæ—¶è¿è¡Œçš„ã€‚</p><pre class="jy jz ka kb fd kc kd ke kf aw kg bi"><span id="f381" class="kh ki hi kd b fi kj kk l kl km"># get predictions<br/>y_pred = cnn_calc.predict(test_data)<br/>predicted = [np.argmax(w) for w in y_pred] # highest probabilities<br/>expected = test_data.labels</span><span id="e37a" class="kh ki hi kd b fi kn kk l kl km">print(classification_report(expected, predicted))</span><span id="712e" class="kh ki hi kd b fi kn kk l kl km">                   precision    recall  f1-score   support<br/><br/>           0       0.97      1.00      0.98        31<br/>           1       1.00      0.97      0.98        29<br/><br/>    accuracy                           0.98        60<br/>   macro avg       0.98      0.98      0.98        60<br/>weighted avg       0.98      0.98      0.98        60</span></pre><p id="3211" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ®è§‚å¯Ÿï¼Œç¡¬ä»¶ä¸ä»…å½±å“è¿è¡Œé€Ÿåº¦ï¼Œè€Œä¸”å½±å“æ•´ä¸ªæ¨¡å‹çš„æ€§èƒ½ã€‚è¯¥æ¨¡å‹åœ¨MacBook Pro i7 16 GBå†…å­˜ã€Mac mini i5 8GBå†…å­˜å’Œè°·æ­Œçš„Collabé»˜è®¤è¿è¡Œæ—¶ä¸Šè¿›è¡Œè®­ç»ƒã€‚å½“è¿è¡Œä¸€ä¸ªè¶…è¿‡1000æ­¥çš„æ¨¡å‹æ—¶ï¼Œæˆ‘ä¼šå»ºè®®åœ¨è°·æ­Œçš„Collab GPUè¿è¡Œæ—¶ä¸Šè¿è¡Œç¬”è®°æœ¬ã€‚</p><p id="35e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">æœ€ç»ˆç»“æœå›¾â€”â€”æ¶æ€§ç—…ä¾‹</strong></p><figure class="jy jz ka kb fd kp er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lu"><img src="../Images/cb0bc558381fef017aab7d2cb109f1c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-SEKM1qMpAngzznH3gwHgA.png"/></div></div></figure><p id="1c21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">å°šä¸æ¸…æ¥šä¸ºä»€ä¹ˆè¯¥æ¨¡å‹åœ¨é¢„æµ‹é’™åŒ–æ—¶è¡¨ç°æ›´ä¸€è‡´ã€‚è¿™æ˜¯ä»åˆå§‹æµ‹è¯•ä¸­è§‚å¯Ÿåˆ°çš„ï¼Œæ—¢æ²¡æœ‰åº”ç”¨æ•°æ®é›†å¹³è¡¡ï¼Œä¹Ÿæ²¡æœ‰åº”ç”¨æ•°æ®æ‰©å……ã€‚é’™åŒ–ç‚¹å¿…é¡»æœ‰ä¸€ä¸ªæ¸…æ™°çš„å¯è¯†åˆ«çš„æ¨¡å¼ï¼Œè¿™æ ·åªæœ‰275ä¸ªæ—¶æœŸçš„æ¨¡å‹å°†è¾¾åˆ°å‡ ä¹90%çš„å‡†ç¡®åº¦ã€ç²¾ç¡®åº¦å’Œå¬å›ç‡ã€‚</p><p id="520e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">è‡³äºè´¨é‡ï¼Œä½¿ç”¨ç±»å¹³è¡¡æ–¹æ³•çš„æ¨¡å‹ä¹Ÿè¡¨ç°å¾—æ›´å¥½ã€‚å¯¹è‚¿å—çš„æ£€æµ‹å‡ ä¹å’Œå¯¹é’™åŒ–çš„æ£€æµ‹ä¸€æ ·å¥½ã€‚å¦‚æœæˆ‘ä»¬è€ƒè™‘è´¨é‡åŒ…æ‹¬ä¸‰ç§ä¸åŒç±»å‹çš„å¼‚å¸¸ï¼Œæ¨¡å‹çš„æ•´ä½“æ€§èƒ½ç›¸å½“å¥½ã€‚ä¸é’™åŒ–ç›¸åï¼Œé€šè¿‡è®­ç»ƒæ¨¡å‹è‡³å°‘1000æ­¥ï¼Œå¯ä»¥è·å¾—æ˜¾è‘—çš„ç»“æœã€‚</p><p id="bbb7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ç”¨æ‰€æœ‰ç±»åˆ«è®­ç»ƒè¯¥æ¨¡å‹ï¼Œç»“æœæ˜¾ç¤ºå¯¹äºç±»åˆ«å¹³è¡¡å’Œå®Œå…¨å¹³è¡¡æ–¹æ³•ï¼Œåœ¨æ¶æ€§ç—…ä¾‹ä¸Šçš„æ¨¡å‹æ€§èƒ½ç¨å¥½ã€‚</p><figure class="jy jz ka kb fd kp er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es lu"><img src="../Images/41604a7982698aff286640f024443879.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JBw_CQ7FMIN2Blia1AamLw.png"/></div></div></figure><p id="37a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">åº”ç”¨æ•°æ®æ‰©å……æŠ€æœ¯åçš„ç»“æœå¼ºåŒ–äº†æœ€åˆçš„ç­–ç•¥ï¼Œå³ä½¿ç”¨æ•°æ®æ‰©å……æŠ€æœ¯ä½œä¸ºå¢å¼ºæ¨¡å‹å­¦ä¹ å’Œé¢„æµ‹èƒ½åŠ›çš„æ‰‹æ®µã€‚å®éªŒè¿˜è¡¨æ˜ï¼Œå½“ä½¿ç”¨ç±»å¹³è¡¡æ–¹æ³•æ—¶ï¼Œè¯¥æ¨¡å‹æ¯”å®Œå…¨å¹³è¡¡æ–¹æ³•äº§ç”Ÿç¨å¥½çš„ç»“æœã€‚æ­¤å¤–ï¼Œä»ä¸¥é‡æ€§çš„è§’åº¦æ¥çœ‹ï¼Œè¯¥æ¨¡å‹åœ¨æ¶æ€§ç—…ä¾‹ä¸Šè¡¨ç°ç¨å¥½ã€‚</p><p id="a0da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">æ„Ÿè°¢é˜…è¯»ï¼</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><p id="4663" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[1] Gregoryç­‰äººï¼Œ<a class="ae jw" href="https://ehnree.github.io/documents/papers/mammogram_conv_net.pdf" rel="noopener ugc nofollow" target="_blank">ä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œè¿›è¡Œä¹³æˆ¿xçº¿ç…§ç‰‡åˆ†ç±»</a></p><p id="d0ef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">[2] Deitelï¼Œæ•°æ®ç§‘å­¦å’Œè®¡ç®—æœºç§‘å­¦çš„Pythonä»‹ç»</p></div></div>    
</body>
</html>