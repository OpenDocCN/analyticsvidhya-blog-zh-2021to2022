<html>
<head>
<title>Which Machine Learning Model Is the Best For Predicting Which Stocks Are Worth Buying?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å“ªç§æœºå™¨å­¦ä¹ æ¨¡å‹æœ€é€‚åˆé¢„æµ‹å“ªäº›è‚¡ç¥¨å€¼å¾—ä¹°ï¼Ÿ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/showdown-which-machine-learning-model-is-the-best-for-predicting-which-stocks-are-worth-buying-2516de68d34f?source=collection_archive---------5-----------------------#2021-05-08">https://medium.com/analytics-vidhya/showdown-which-machine-learning-model-is-the-best-for-predicting-which-stocks-are-worth-buying-2516de68d34f?source=collection_archive---------5-----------------------#2021-05-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/eb23c86dbf9f6ca11d965f2ec284759e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*raJCtjXLEVNomYOVZ_S47g.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">èµ„æ–™æ¥æº:wccftech</figcaption></figure><p id="04c4" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">æŒ‡å¯¼é—®é¢˜:</strong> <em class="js">å“ªç§æœºå™¨å­¦ä¹ æ¨¡å‹æœ€é€‚åˆé¢„æµ‹å“ªäº›è‚¡ç¥¨å€¼å¾—ä¹°å…¥ï¼Ÿ</em></p><h2 id="47b3" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">æ•°æ®é›†æè¿°</h2><p id="3c09" class="pw-post-body-paragraph iu iv hi iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated">å¯¹äºè¿™ä¸ªåˆ†æï¼Œæˆ‘å°†ä½¿ç”¨æ¥è‡ªKaggle çš„<a class="ae kt" href="https://www.kaggle.com/cnic92/200-financial-indicators-of-us-stocks-20142018" rel="noopener ugc nofollow" target="_blank">â€œç¾å›½è‚¡ç¥¨200+é‡‘èæŒ‡æ ‡(2018)â€æ•°æ®é›†ã€‚</a></p><p id="a779" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¯¥æ•°æ®é›†åŒ…å«2018å¹´ç¾å›½è‚¡å¸‚çš„æ•°æ®ã€‚å®ƒåŒ…å«200å¤šä¸ªè´¢åŠ¡æŒ‡æ ‡ï¼Œè¿™äº›æŒ‡æ ‡é€šå¸¸å‡ºç°åœ¨æ¯ä¸ªä¸Šå¸‚å…¬å¸æ¯å¹´å‘å¸ƒçš„10-Kæ–‡ä»¶ä¸­ï¼Œæ¶‰åŠè¶…è¿‡4kåªè‚¡ç¥¨ã€‚æœ€åä¸€åˆ—â€œç±»åˆ«â€åˆ—å‡ºäº†æ¯åªè‚¡ç¥¨çš„äºŒè¿›åˆ¶åˆ†ç±»ã€‚å¦‚æœclass = 1ï¼Œé‚£ä¹ˆè‚¡ç¥¨çš„ä»·æ ¼å˜åŒ–ç™¾åˆ†æ¯”åœ¨é‚£ä¸€å¹´ä¹‹åä¸Šå‡ï¼›å¦‚æœclass = 0ï¼Œé‚£ä¹ˆè‚¡ç¥¨çš„ä»·æ ¼å˜åŒ–ç™¾åˆ†æ¯”åœ¨é‚£ä¸€å¹´ä¹‹åä¸‹é™ã€‚è¿™ä¸ªâ€œç±»åˆ«â€æ å¯ä»¥ç”¨æ¥è¡¡é‡è‚¡ç¥¨æ˜¯å¦å€¼å¾—è´­ä¹°ã€‚</p><h1 id="2524" class="ku ju hi bd jv kv kw kx jz ky kz la kd lb lc ld kg le lf lg kj lh li lj km lk bi translated">ğŸ•µï¸â€â™€ï¸æ•°æ®å‹˜æ¢å…¬å¸</h1><p id="46a4" class="pw-post-body-paragraph iu iv hi iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated">ä¸ºäº†ç»™æˆ‘çš„æ¨¡å‹é€‰æ‹©æä¾›ä¿¡æ¯ï¼Œæˆ‘å°†é¦–å…ˆç ”ç©¶æˆ‘çš„æ•°æ®ã€‚</p><h2 id="fd23" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated"><strong class="ak">æ•°æ®é›†æ¦‚è¿°</strong></h2><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="47e9" class="jt ju hi lq b fi lu lv l lw lx">df.info()</span></pre><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/40e4cdbb2a200180a16eca48e16edd47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mTi9YTBjlye6ts93hYX2UA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd jv">å›¾1 </strong>:æ•°æ®é›†ä¿¡æ¯</figcaption></figure><h2 id="f066" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated"><strong class="ak">å…³è”çƒ­å›¾</strong></h2><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="e147" class="jt ju hi lq b fi lu lv l lw lx">fig, ax = plt.subplots(figsize=(20,15))<br/>sns.heatmap(df.corr(), annot=False, cmap='YlGnBu', vmin=-1, vmax=1, center=0, ax=ax)<br/>plt.show()</span></pre><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/827a21e915d7059e6f72e42fa7651703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zoNs2MFNyQgCUZDJIqR6bw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd jv">å›¾2: </strong>æ˜¾ç¤ºæ•°æ®é›†ä¸­è¦ç´ ä¹‹é—´ç›¸å…³æ€§çš„çƒ­å›¾</figcaption></figure><p id="f147" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">ç›¸å…³è¡¨</strong></p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="6a51" class="jt ju hi lq b fi lu lv l lw lx">corr = df.corr().abs()<br/>s = corr.unstack()<br/>so = s.sort_values(kind="quicksort")<br/>print(so[-4470:-4460])</span></pre><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/da3e25de971a941d838473cc59e8361d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AYk971PMJKk3Rf-tTHdNuQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd jv">è¡¨1: </strong>æ˜¾ç¤ºå…·æœ‰æœ€é«˜ç›¸å…³æ€§çš„ç‰¹å¾å’Œå®ƒä»¬å„è‡ªçš„ç›¸å…³ç³»æ•°çš„è¡¨</figcaption></figure><h2 id="10d5" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated"><strong class="ak">æ¢ç´¢â€œç±»â€åŠŸèƒ½</strong></h2><p id="8de4" class="pw-post-body-paragraph iu iv hi iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated"><strong class="iw hj">ç­çº§è®¡æ•°æ å‰§æƒ…</strong></p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="4be7" class="jt ju hi lq b fi lu lv l lw lx">classes = df['Class'].value_counts()<br/>class_len = len(classes)<br/>sns.set_style("darkgrid")<br/>sns.barplot(np.arange(class_len), classes)<br/>plt.title('Class Count', fontsize=18)<br/>plt.show()</span></pre><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/bf1d58e77a2b99d2f7fb2ec83570a6b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*ypj723MupWM2uValx6iIcw.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd jv">å›¾3: </strong>æ˜¾ç¤ºæ•°æ®é›†â€œç±»â€ç‰¹å¾ä¸­çš„å€¼å’Œè¿™äº›å€¼çš„è®¡æ•°çš„æ¡å½¢å›¾</figcaption></figure><p id="2edf" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">è®¡ç®—â€œç±»â€ä¸­ç©ºå€¼çš„æ•°é‡</strong></p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="0acb" class="jt ju hi lq b fi lu lv l lw lx">print("Number of null values in 'Class':", df['Class'].isnull().sum())</span></pre><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/2525c5a8054dd41b569f89caccb526fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uEpS_Pqfrh-6DEGxLI58mQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd jv">å›¾4: </strong>æ˜¾ç¤ºäº†â€œç±»â€ç‰¹å¾ä¸­ç©ºå€¼çš„æ•°é‡</figcaption></figure><p id="db78" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¿™ä¸€æ¢ç´¢æ­ç¤ºäº†ä¸¤ä¸ªä¸»è¦å‘ç°:</p><ol class=""><li id="3f16" class="md me hi iw b ix iy jb jc jf mf jj mg jn mh jr mi mj mk ml bi translated">å¦‚<em class="js">å›¾1 </em>æ‰€ç¤ºï¼Œè¯¥æ•°æ®é›†å…·æœ‰å¤§é‡çš„ç‰¹å¾(223)å’Œæ¡ç›®(4392)ï¼Œå› æ­¤æˆ‘å°†é€‰æ‹©èƒ½å¤Ÿæ”¯æŒè¯¥æ•°æ®é›†å¤§å°çš„æ¨¡å‹</li><li id="5981" class="md me hi iw b ix mm jb mn jf mo jj mp jn mq jr mi mj mk ml bi translated">â€œç±»â€ç‰¹å¾æ˜¯äºŒè¿›åˆ¶çš„ï¼Œå®ƒä¸æ˜¯0å°±æ˜¯1 ( <em class="js">å›¾3 </em>)ã€‚å¯¹äºä»»ä½•è¡Œï¼Œå®ƒä¹Ÿä¸ä¼šä¸¢å¤±ï¼Œè¿™æ„å‘³ç€æ¯åªè‚¡ç¥¨éƒ½è¢«èµ‹äºˆ0æˆ–1å€¼(<em class="js">å›¾4 </em>)ã€‚è¿™è¯å®äº†æˆ‘å¯ä»¥å°†â€œClassâ€ä½œä¸ºç›®æ ‡å˜é‡æ¥ä½¿ç”¨è¿™ä¸ªæ•°æ®é›†çš„åˆ†ç±»æ¨¡å‹ã€‚</li></ol><p id="3159" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">åŸºäºè¿™äº›å‘ç°ï¼Œæˆ‘å°†é€‰æ‹©ä½¿ç”¨èƒ½å¤Ÿå¤„ç†å¤§å‹æ•°æ®é›†çš„åˆ†ç±»æ¨¡å‹æ¥åˆ†æè¿™ä¸ªæ•°æ®é›†ã€‚</p><h1 id="2a0d" class="ku ju hi bd jv kv kw kx jz ky kz la kd lb lc ld kg le lf lg kj lh li lj km lk bi translated">æ•°æ®æ¸…ç†å’Œå‡†å¤‡ğŸ›</h1><h2 id="71f8" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">å°†â€œæ‰‡åŒºâ€åˆ—è½¬æ¢ä¸ºè™šæ‹Ÿå€¼</h2><p id="1f3c" class="pw-post-body-paragraph iu iv hi iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated">â€œéƒ¨é—¨â€ç‰¹å¾æè¿°å…¬å¸æ˜¯ä»€ä¹ˆéƒ¨é—¨çš„ä¸€éƒ¨åˆ†ï¼›ä¾‹å¦‚:åŒ»ç–—ä¿å¥ã€ç§‘æŠ€ã€èƒ½æºã€æˆ¿åœ°äº§ç­‰ã€‚ä¸ºäº†èƒ½å¤Ÿåœ¨æˆ‘çš„æ¨¡å‹ä¸­é›†æˆâ€œSectorâ€ç‰¹æ€§ï¼Œæˆ‘å°†æŠŠè¿™ä¸ªåˆ—è½¬æ¢æˆè™šæ‹Ÿå€¼ã€‚</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="1690" class="jt ju hi lq b fi lu lv l lw lx">dummy = pd.get_dummies(df['Sector'])<br/>dummy.head()</span></pre><p id="960a" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç„¶åï¼Œæˆ‘å¯ä»¥ä»æ•°æ®æ¡†ä¸­åˆ é™¤åŸå§‹çš„â€œæ‰‡åŒºâ€è¦ç´ ï¼Œå¹¶ç”¨æ–°çš„è™šæ‹Ÿå€¼åˆ—æ›¿æ¢å®ƒã€‚</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="77a3" class="jt ju hi lq b fi lu lv l lw lx">df = df.drop('Sector', axis=1)<br/>df1 = pd.concat([dummy, df], axis=1)</span></pre><h2 id="201e" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated"><strong class="ak">å¤„ç†ç¼ºå¤±å€¼</strong></h2><p id="5dc4" class="pw-post-body-paragraph iu iv hi iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated">è¿™ä¸ªæ•°æ®é›†æœ‰å¤šå°‘ä¸ªç¼ºå¤±å€¼ï¼Ÿ</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="de78" class="jt ju hi lq b fi lu lv l lw lx">print("Total number of null values:", df1.isnull().sum(axis = 1).sum())</span></pre><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/31051fbcef53a61edce2cf3967d4a2b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*3hiJZORvPNxpAqIJm1AEug.png"/></div></div></figure><p id="db5e" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ˜¾ç„¶ï¼Œè¿™ä¸ªæ•°æ®é›†æœ‰éœ€è¦å¤„ç†çš„ç¼ºå¤±å€¼ã€‚ä½†æ˜¯ï¼Œåœ¨æˆ‘è¿™æ ·åšä¹‹å‰ï¼Œæˆ‘æƒ³ä½¿ç”¨çƒ­å›¾æ¥äº†è§£ä¸€ä¸‹è¿™ä¸ªç¼ºå¤±å€¼çš„åˆ†å¸ƒæƒ…å†µã€‚</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="5c03" class="jt ju hi lq b fi lu lv l lw lx">plt.figure(figsize = (40,10))<br/>sns.heatmap(df1.isnull(), yticklabels=False)</span></pre><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/6cff1802a1c9874457758df5914eb83d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yxDbdKqsCF5o4KgmEeeSKA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd jv">å›¾5: </strong>æ˜¾ç¤ºæ•°æ®é›†ä¸­æ‰€æœ‰è¦ç´ çš„ç©ºå€¼åˆ†å¸ƒçš„çƒ­å›¾</figcaption></figure><p id="a1e8" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä»<em class="js">å›¾5 </em>ä¸­ï¼Œæˆ‘å·²ç»å¯ä»¥çœ‹å‡ºæœ‰ä¸€äº›ç‰¹å¾çš„ç¼ºå¤±å€¼ç™¾åˆ†æ¯”éå¸¸é«˜ã€‚ä¸ºäº†æŸ¥çœ‹ä¸¢å¤±å€¼æœ€å¤šçš„è¦ç´ ä»¥åŠä¸¢å¤±å€¼çš„ç™¾åˆ†æ¯”æ˜¯å¦é«˜åˆ°å€¼å¾—ç§»é™¤è¯¥è¦ç´ ï¼Œæˆ‘å°†å¯¹æ¯ä¸ªè¦ç´ çš„ç©ºå€¼æ±‚å’Œï¼Œå°†è¿™äº›æ•°æ®æ”¾å…¥æ•°æ®æ¡†ä¸­ï¼ŒæŒ‰é™åºå¯¹æ•°æ®æ¡†è¿›è¡Œæ’åºï¼Œå¹¶æ‰“å°å‰20ä¸ªå€¼ã€‚æˆ‘è¿˜å°†æ‰¾åˆ°è¿™äº›ç‰¹å¾çš„ç©ºå€¼çš„ç™¾åˆ†æ¯”ã€‚</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="a320" class="jt ju hi lq b fi lu lv l lw lx">col_len = df1.shape[0]</span><span id="a81f" class="jt ju hi lq b fi mt lv l lw lx">null_df = df1.isnull().sum().sort_values(ascending=False).head(20)<br/>null_df = null_df.to_frame()<br/>null_df.rename(columns={0:"Null Count"}, inplace=True)<br/>null_df['Percentage Null'] = ((null_df["Null Count"] / col_len)*100)</span><span id="c702" class="jt ju hi lq b fi mt lv l lw lx">print(null_df)</span></pre><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/d920d11a794b14af3f5b0bd34f1bfcac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*izcE1xnwDGL02rkdAN04_g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd jv">è¡¨2: </strong>æ•°æ®å¸§ä¸­å…·æœ‰æœ€é«˜ç©ºå€¼è®¡æ•°çš„äºŒåä¸ªç‰¹å¾åŠå…¶å„è‡ªç¼ºå¤±å€¼çš„ç™¾åˆ†æ¯”</figcaption></figure><p id="1895" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">åŠŸèƒ½â€œcashConversionCycleâ€å’Œâ€œoperatingCycleâ€çš„ç©ºå€¼ç™¾åˆ†æ¯”éå¸¸é«˜ã€‚å»ºè®®ç§»é™¤ç¼ºå¤±å€¼è¶…è¿‡70â€“75%çš„ä»»ä½•è¦ç´ ï¼›ç”±äºè¿™ä¸¤åˆ—æœ‰è¶…è¿‡99%çš„ç©ºå€¼ï¼Œå®ƒä»¬å°†è¢«åˆ é™¤ã€‚</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="f0cd" class="jt ju hi lq b fi lu lv l lw lx">df1 = df1.drop('cashConversionCycle', axis=1)<br/>df1 = df1.drop('operatingCycle', axis=1)</span></pre><p id="54f7" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è¿˜å‰©ä¸‹å¤§é‡çš„ç©ºå€¼ï¼›ä½†æ˜¯ï¼Œæˆ‘å·²ç»ç§»é™¤äº†ç¼ºå¤±å€¼ç™¾åˆ†æ¯”å¤§åˆ°å€¼å¾—ç§»é™¤çš„è¦ç´ ã€‚å› ä¸ºåˆ é™¤æ›´å¤šçš„ç‰¹æ€§ä¸æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œæ‰€ä»¥æˆ‘å°†ä½¿ç”¨Scikit-learn KNNImputerï¼Œå®ƒä½¿ç”¨k-Nearest Neighborsæ–¹æ³•æ¥å¡«å……ä¸¢å¤±çš„å€¼ã€‚</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="db8c" class="jt ju hi lq b fi lu lv l lw lx">imputer = KNNImputer(n_neighbors=2)<br/>df_filled = imputer.fit_transform(df1)</span></pre><p id="65b5" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç°åœ¨ï¼Œæ‰€æœ‰ç¼ºå¤±çš„å€¼éƒ½å·²å¡«å……ï¼Œæˆ‘å¯ä»¥å°†æ•°æ®æ”¾å…¥æ¨¡å‹ä¸­ã€‚</p><h1 id="5d39" class="ku ju hi bd jv kv kw kx jz ky kz la kd lb lc ld kg le lf lg kj lh li lj km lk bi translated">æ¨¡å‹ğŸ“ˆ</h1><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="98b6" class="jt ju hi lq b fi lu lv l lw lx">X = df1.drop('Class',axis=1)<br/>y = df1.loc[:,'Class'].values</span><span id="a8b4" class="jt ju hi lq b fi mt lv l lw lx">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)</span></pre><p id="8a59" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">åœ¨ç¡®å®šæˆ‘çš„ç›®æ ‡å˜é‡å¹¶å°†æˆ‘çš„æ•°æ®åˆ†æˆè®­ç»ƒå’Œæµ‹è¯•ä¹‹åï¼Œæˆ‘å¯ä»¥å¼€å§‹æ„å»ºæˆ‘çš„æ¨¡å‹ã€‚</p><h2 id="59c2" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">å†³ç­–å›¾è¡¨</h2><p id="1bbb" class="pw-post-body-paragraph iu iv hi iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated"><strong class="iw hj">ä½¿ç”¨å†³ç­–æ ‘çš„ç†ç”±:</strong>æˆ‘é€‰æ‹©å†³ç­–æ ‘ä½œä¸ºæˆ‘çš„æ¨¡å‹ä¹‹ä¸€ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿåœ¨ä¸åŒçš„åˆ†ç±»é˜¶æ®µä½¿ç”¨ä¸åŒçš„ç‰¹å¾å­é›†å’Œå†³ç­–è§„åˆ™ã€‚è™½ç„¶å†³ç­–æ ‘é€šå¸¸å®¹æ˜“è¿‡åº¦æ‹Ÿåˆï¼Œä½†æˆ‘å¸Œæœ›é€šè¿‡ä¿®å‰ªæ¥å‡è½»è¿™ç§æƒ…å†µã€‚</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="471e" class="jt ju hi lq b fi lu lv l lw lx">dt = DecisionTreeClassifier(criterion='entropy', random_state=0, max_depth=10)<br/>dt.fit(X_train, y_train)<br/>y_pred = dt.predict(X_test)<br/>acc_testing = accuracy_score(y_pred, y_test)</span><span id="fd32" class="jt ju hi lq b fi mt lv l lw lx">print("Accuracy = ",acc_testing)</span></pre><p id="9985" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç»“æœ:<strong class="iw hj">ç²¾åº¦= 0.6641379310344827 </strong></p><h2 id="d685" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">éšæœºæ£®æ—æ¨¡å‹</h2><p id="a3e1" class="pw-post-body-paragraph iu iv hi iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated"><strong class="iw hj">ä½¿ç”¨éšæœºæ£®æ—æ¨¡å‹çš„ç†ç”±:</strong>ä¼—æ‰€å‘¨çŸ¥ï¼Œéšæœºæ£®æ—æ¨¡å‹å¯ä»¥å¾ˆå¥½åœ°å¤„ç†å¤§é‡æ•°æ®ï¼Œè¿™æœ‰åˆ©äºæ­¤åˆ†æï¼Œå› ä¸ºæ•°æ®é›†éå¸¸å¤§ã€‚å®ƒä»¬ä¹Ÿä¸å®¹æ˜“åœ¨åˆ†ç±»ä¸­è¿‡åº¦æ‹Ÿåˆï¼Œå› ä¸ºå®ƒä»¬åªè€ƒè™‘ç‰¹å¾çš„å­é›†ï¼Œå¹¶ä¸”æ¨¡å‹çš„æœ€ç»ˆç»“æœä¾èµ–äºæ‰€æœ‰çš„æ ‘ã€‚</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="ff5a" class="jt ju hi lq b fi lu lv l lw lx">from sklearn.metrics import recall_score<br/>from sklearn.ensemble import RandomForestClassifier</span><span id="1900" class="jt ju hi lq b fi mt lv l lw lx">model_rf = RandomForestClassifier(n_estimators=100, random_state=42)</span><span id="c381" class="jt ju hi lq b fi mt lv l lw lx">model_rf.fit(X_train, y_train)</span><span id="dead" class="jt ju hi lq b fi mt lv l lw lx">predict_rf = model_rf.predict(X_test)</span><span id="9e83" class="jt ju hi lq b fi mt lv l lw lx">recall_rf = recall_score(y_test, predict_rf, pos_label=1.0)</span><span id="f22f" class="jt ju hi lq b fi mt lv l lw lx">precision_rf = precision_score(y_test, predict_rf, pos_label=1.0)</span><span id="93fc" class="jt ju hi lq b fi mt lv l lw lx">print(' Accuracy = ', precision_rf)</span></pre><p id="dbba" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç»“æœ:<strong class="iw hj">ç²¾åº¦= 0.7627551020408163 </strong></p><h2 id="acbb" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">é€»è¾‘å›å½’</h2><p id="51e4" class="pw-post-body-paragraph iu iv hi iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated"><strong class="iw hj">ä½¿ç”¨é€»è¾‘å›å½’çš„ç†ç”±:</strong>æˆ‘é€‰æ‹©äº†é€»è¾‘å›å½’ä½œä¸ºæˆ‘çš„æ¨¡å‹ä¹‹ä¸€ï¼Œå› ä¸ºå®ƒåœ¨åˆ†ç±»æ–¹é¢éå¸¸æœ‰æ•ˆï¼Œè€Œä¸”å®ç°èµ·æ¥éå¸¸ç®€å•ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¸ªæ•°æ®æ¡†æ¶æ¯”é€šå¸¸ç”¨äºé€»è¾‘å›å½’çš„è¦å¤§ï¼Œä½†æ˜¯æˆ‘å¯ä»¥é€šè¿‡å¢åŠ â€œmax_iterâ€æ¥ä½¿æˆ‘çš„æ¨¡å‹é€‚åº”è¿™ä¸ªæƒ…å†µã€‚æˆ‘ä¹Ÿå°†ä½¿ç”¨L2æ­£è§„åŒ–ï¼Œä»¥å¸®åŠ©é˜²æ­¢è¿‡åº¦æ‹Ÿåˆã€‚</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="6a48" class="jt ju hi lq b fi lu lv l lw lx">model = LogisticRegression(max_iter=500000000, penalty='l2', solver='liblinear')</span><span id="70b7" class="jt ju hi lq b fi mt lv l lw lx">model.fit(X_train, y_train)</span><span id="9de3" class="jt ju hi lq b fi mt lv l lw lx">y_pred = model.predict(X_test)</span><span id="f3df" class="jt ju hi lq b fi mt lv l lw lx">log_acc = accuracy_score(y_test, y_pred)</span><span id="5165" class="jt ju hi lq b fi mt lv l lw lx">print('Accuracy =', log_acc)</span></pre><p id="5145" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç»“æœ:<strong class="iw hj">ç²¾åº¦= 0.6793103448275862 </strong></p><h2 id="923f" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">XGBoost</h2><p id="74be" class="pw-post-body-paragraph iu iv hi iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated"><strong class="iw hj">ä½¿ç”¨XGBoostçš„ç†ç”±:</strong>å‡ºäºå„ç§åŸå› ï¼Œæˆ‘é€‰æ‹©äº†ä¸€ä¸ªXGBooståˆ†ç±»å™¨ä½œä¸ºæˆ‘çš„æ¨¡å‹ä¹‹ä¸€:</p><ul class=""><li id="c276" class="md me hi iw b ix iy jb jc jf mf jj mg jn mh jr mv mj mk ml bi translated">ä¼—æ‰€å‘¨çŸ¥ï¼Œå®ƒå…·æœ‰å‡ºè‰²çš„é€Ÿåº¦å’Œæ€§èƒ½</li><li id="7695" class="md me hi iw b ix mm jb mn jf mo jj mp jn mq jr mv mj mk ml bi translated">å®ƒæœ‰å„ç§å„æ ·çš„è°ƒè°å‚æ•°</li><li id="c3c9" class="md me hi iw b ix mm jb mn jf mo jj mp jn mq jr mv mj mk ml bi translated">å…¶æ ¸å¿ƒç®—æ³•æ˜¯å¯å¹¶è¡Œçš„</li><li id="4ca1" class="md me hi iw b ix mm jb mn jf mo jj mp jn mq jr mv mj mk ml bi translated">åœ¨å¤šç§æœºå™¨å­¦ä¹ åŸºå‡†æ•°æ®é›†ä¸Šï¼Œè¯¥æ–¹æ³•è¡¨ç°å‡ºæ¯”å…¶ä»–MLæ–¹æ³•æ›´å¥½çš„æ€§èƒ½</li></ul><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="1b90" class="jt ju hi lq b fi lu lv l lw lx">xgb_model = XGBClassifier(objective="binary:logistic", random_state=2020, learning_rate=0.1)</span><span id="f539" class="jt ju hi lq b fi mt lv l lw lx">xgb_model.fit(X_train, y_train)</span><span id="df8f" class="jt ju hi lq b fi mt lv l lw lx">y_pred = xgb_model.predict(X_test)</span><span id="4cb4" class="jt ju hi lq b fi mt lv l lw lx">xgb_acc = accuracy_score(y_test, y_pred)</span><span id="9e84" class="jt ju hi lq b fi mt lv l lw lx">print("Accuracy = ", xgb_acc )</span></pre><p id="7fa1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç»“æœ:<strong class="iw hj">ç²¾åº¦= 0.7282758620689656 </strong></p><h2 id="b996" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">è£…è¢‹åˆ†çº§æœº</h2><p id="7507" class="pw-post-body-paragraph iu iv hi iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated"><strong class="iw hj">ä½¿ç”¨Baggingåˆ†ç±»å™¨çš„ç†ç”±:</strong>æˆ‘çš„è®¸å¤šæ¨¡å‹éƒ½ä½¿ç”¨å†³ç­–æ ‘ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå†³ç­–æ ‘å®¹æ˜“è¿‡åº¦æ‹Ÿåˆã€‚æ­¤å¤–ï¼Œå†³ç­–æ ‘é€šå¸¸ä¸ç¨³å®šï¼Œè¿™æ„å‘³ç€å³ä½¿è®­ç»ƒæ•°æ®ä¸­éå¸¸å°çš„å˜åŒ–ä¹Ÿä¼šå¯¼è‡´éå¸¸ä¸åŒçš„å†³ç­–æ ‘æ¨¡å‹ã€‚</p><p id="1c7f" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç„¶è€Œï¼Œæ ¹æ®æˆ‘çš„<em class="js"> ITP 449:æœºå™¨å­¦ä¹ çš„åº”ç”¨</em>è¯¾å ‚ç¬”è®°:â€œåŸºäºæ ‘çš„Baggingé›†æˆé€šè¿‡å°†æ¯æ£µæ ‘æ‹Ÿåˆåˆ°è®­ç»ƒæ•°æ®çš„ä¸åŒå¼•å¯¼æ ·æœ¬ä¸Šæ¥åˆ©ç”¨è¿™äº›ç¼ºç‚¹ã€‚ç”±äºå†³ç­–æ ‘çš„ä¸ç¨³å®šæ€§è´¨ï¼Œä½¿æ¯æ£µæ ‘è¿‡åº¦é€‚åº”å…¶ç‰¹å®šçš„è‡ªä¸¾æ ·æœ¬å°†å¯¼è‡´å…·æœ‰ä¸åŒæ ‘é›†åˆçš„é›†åˆã€‚è™½ç„¶æ¯æ£µå•ç‹¬çš„æ ‘éƒ½è¿‡åº¦æ‹Ÿåˆäº†å®ƒç”¨æ¥è®­ç»ƒçš„æ•°æ®ï¼Œä½†ç”±äºè¿™äº›ä¸åŒçš„æ ‘ï¼Œæ•´ä½“çš„æ–¹å·®å‡å°‘äº†ã€‚â€</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="180d" class="jt ju hi lq b fi lu lv l lw lx">model_bagging = BaggingClassifier(DecisionTreeClassifier(), n_estimators = 10, random_state = 42)</span><span id="252e" class="jt ju hi lq b fi mt lv l lw lx">model_bagging.fit(X_train, y_train)</span><span id="9a5a" class="jt ju hi lq b fi mt lv l lw lx">pred_bagging = model_bagging.predict(X_test)</span><span id="8fed" class="jt ju hi lq b fi mt lv l lw lx">bagging_acc = accuracy_score(y_test, pred_bagging)</span><span id="e963" class="jt ju hi lq b fi mt lv l lw lx">print(' Accuracy = ', bagging_acc)</span></pre><p id="1aee" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç»“æœ:<strong class="iw hj">ç²¾åº¦= 0.6841379310344827 </strong></p><h2 id="13c5" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">æŠ•ç¥¨ç»„åˆ</h2><p id="9dae" class="pw-post-body-paragraph iu iv hi iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated"><strong class="iw hj">ä½¿ç”¨æŠ•ç¥¨é›†æˆçš„ç†ç”±:</strong>æˆ‘é€‰æ‹©æŠ•ç¥¨é›†æˆä½œä¸ºæˆ‘çš„æ¨¡å‹ä¹‹ä¸€ï¼Œå› ä¸ºè¯¥æ¨¡å‹ç»“åˆäº†å¤šä¸ªæ¨¡å‹çš„é¢„æµ‹ï¼Œä»è€Œæœ‰åŠ©äºæé«˜é¢„æµ‹çš„å‡†ç¡®æ€§ã€‚</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="ba60" class="jt ju hi lq b fi lu lv l lw lx">rfClf = RandomForestClassifier(max_depth = 10, n_estimators=200, random_state=0)<br/>dtcClf = DecisionTreeClassifier(max_depth = 10)<br/>logClf = LogisticRegression(max_iter=500000000, penalty='l2', solver='liblinear')<br/>xgbClf = XGBClassifier()</span><span id="9cdb" class="jt ju hi lq b fi mt lv l lw lx">clf2 = VotingClassifier(estimators = [('rf',rfClf), ('dt',dtcClf), ('xgb',xgbClf), ('log', logClf)], voting='soft')<br/>clf2.fit(X_train, y_train)<br/>clf2_pred = clf2.predict(X_test)</span><span id="51aa" class="jt ju hi lq b fi mt lv l lw lx">recall_voting = recall_score(y_test, clf2_pred, average="binary", pos_label=1.0)</span><span id="fd42" class="jt ju hi lq b fi mt lv l lw lx">precision_voting = precision_score(y_test, clf2_pred, pos_label=1.0)</span><span id="1a28" class="jt ju hi lq b fi mt lv l lw lx">vote_acc = accuracy_score(y_test, clf2_pred)</span><span id="8734" class="jt ju hi lq b fi mt lv l lw lx">print('Accuracy score', vote_acc)</span></pre><p id="8549" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç»“æœ:<strong class="iw hj">ç²¾åº¦= 0.7151724137931035 </strong></p><h1 id="76fc" class="ku ju hi bd jv kv kw kx jz ky kz la kd lb lc ld kg le lf lg kj lh li lj km lk bi translated">å‹å·é€‰æ‹©ğŸ“Š</h1><p id="68b2" class="pw-post-body-paragraph iu iv hi iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated">ä¸ºäº†æ¯”è¾ƒæ¯ä¸ªåˆ†ç±»å™¨çš„å‡†ç¡®æ€§å¹¶æ¨æ–­å‡ºæœ€å‡†ç¡®çš„ä¸€ä¸ªï¼Œæˆ‘å°†åœ¨ä¸€ä¸ªå¸¦æ ‡ç­¾çš„æ¡å½¢å›¾ä¸Šç»˜åˆ¶æ¯ä¸ªåˆ†ç±»å™¨çš„å‡†ç¡®æ€§ã€‚</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="cb4d" class="jt ju hi lq b fi lu lv l lw lx">plt.style.use('ggplot')</span><span id="64c8" class="jt ju hi lq b fi mt lv l lw lx">data = {'Classifier':  ["DecisionTreeClassifier", "RandomForestClassifier", "Logistic Regression", "XGBoost", "Bagging Classifier", "Voting Ensemble"],'Acc': [acc_testing, precision_rf, log_acc, xgb_acc, bagging_acc, vote_acc ],}</span><span id="83c3" class="jt ju hi lq b fi mt lv l lw lx">for count, el in enumerate(data['Acc']):<br/>   data['Acc'][count] = el * 100</span><span id="2cb2" class="jt ju hi lq b fi mt lv l lw lx">acc_data = pd.DataFrame (data, columns = ['Classifier','Acc'])</span><span id="fce8" class="jt ju hi lq b fi mt lv l lw lx">g = sns.barplot(x='Classifier', y='Acc', data=acc_data)<br/>plt.xticks(rotation=45)<br/>plt.ylabel('Accuracy %')<br/>plt.title('Classifier Accuracy')</span><span id="c441" class="jt ju hi lq b fi mt lv l lw lx">for p in g.patches:<br/>    g.annotate(format(p.get_height(), '.1f'),(p.get_x() +          p.get_width() / 2., p.get_height()),ha = 'center', va = 'center', xytext = (0, 9), textcoords = 'offset points')</span><span id="a5e2" class="jt ju hi lq b fi mt lv l lw lx">plt.show()</span></pre><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es mw"><img src="../Images/015f0b9d1bbf73b429786645fc1d2de2.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*EqxxfnPrfZSUZiWm5HYSew.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd jv">å›¾5: </strong>æ¯ä¸ªåˆ†ç±»å™¨çš„å‡†ç¡®åº¦ç™¾åˆ†æ¯”</figcaption></figure><p id="2958" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">éšæœºæ£®æ—åˆ†ç±»å™¨å…·æœ‰æœ€é«˜çš„å‡†ç¡®åº¦% (76.3)ï¼Œå…¶æ¬¡æ˜¯XGBosst (72.8)å’ŒæŠ•ç¥¨é›†æˆ(71.5)ã€‚ä¸ºäº†ç¡®ä¿éšæœºæ£®æ—åˆ†ç±»å™¨å®é™…ä¸Šæ˜¯æœ€æœ‰å¸Œæœ›çš„æ¨¡å‹ï¼Œè€Œä¸æ˜¯ç®€å•åœ°è¿‡åº¦æ‹Ÿåˆï¼Œæˆ‘å°†å¯¹æ¯ä¸ªæ¨¡å‹è¿›è¡Œäº¤å‰éªŒè¯ã€‚</p><p id="dfd0" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">éšæœºæ£®æ—åˆ†ç±»å™¨çš„äº¤å‰éªŒè¯</strong></p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="ff71" class="jt ju hi lq b fi lu lv l lw lx">rfc_cv = RandomForestClassifier(n_estimators=100, random_state=42)</span><span id="91e9" class="jt ju hi lq b fi mt lv l lw lx">scores = cross_val_score(rfc_cv, X_train, y_train, cv=10, scoring = "accuracy")</span><span id="89c2" class="jt ju hi lq b fi mt lv l lw lx">print("Scores:", scores)<br/>print("Mean:", scores.mean())<br/>print("Standard Deviation:", scores.std())</span><span id="7f61" class="jt ju hi lq b fi mt lv l lw lx">rfc_cv_mean = scores.mean()</span></pre><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/14a7fbef250bee23659d016cad13d160.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dR2RBxT3amrxobQLqso-uQ.png"/></div></div></figure><p id="55c6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">XGBooståˆ†ç±»å™¨çš„äº¤å‰éªŒè¯</strong></p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="d9b7" class="jt ju hi lq b fi lu lv l lw lx">xgb_cv = XGBClassifier(objective="binary:logistic", random_state=2020, learning_rate=0.1)</span><span id="1363" class="jt ju hi lq b fi mt lv l lw lx">scores = cross_val_score(xgb_cv, X_train, y_train, cv=10, scoring = "accuracy")</span><span id="0c81" class="jt ju hi lq b fi mt lv l lw lx">print("Scores:", scores)<br/>print("Mean:", scores.mean())<br/>print("Standard Deviation:", scores.std())</span><span id="85f4" class="jt ju hi lq b fi mt lv l lw lx">xgb_cv_mean = scores.mean()</span></pre><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es my"><img src="../Images/7dcc5a3d4ae9defd5ba013ed40729f32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Qelj-Hx6DxTz2ZU3iLDew.png"/></div></div></figure><p id="df75" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">æŠ•ç¥¨ç»„åˆçš„äº¤å‰éªŒè¯</strong></p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="7703" class="jt ju hi lq b fi lu lv l lw lx">rfClf = RandomForestClassifier(max_depth = 10, n_estimators=200, random_state=0)<br/>dtcClf = DecisionTreeClassifier(max_depth = 10)<br/>logClf = LogisticRegression(max_iter=500000000, penalty='l2', solver='liblinear')<br/>xgbClf = XGBClassifier()</span><span id="23a5" class="jt ju hi lq b fi mt lv l lw lx">clf2 = VotingClassifier(estimators = [('rf',rfClf), ('dt',dtcClf), ('xgb',xgbClf), ('log', logClf)], voting='soft')</span><span id="9ccf" class="jt ju hi lq b fi mt lv l lw lx">vote_cv = XGBClassifier(objective="binary:logistic", random_state=2020, learning_rate=0.1)<br/>scores = cross_val_score(vote_cv, X_train, y_train, cv=10, scoring = "accuracy")</span><span id="da80" class="jt ju hi lq b fi mt lv l lw lx">print("Scores:", scores)<br/>print("Mean:", scores.mean())<br/>print("Standard Deviation:", scores.std())</span><span id="88f7" class="jt ju hi lq b fi mt lv l lw lx">vote_cv_mean = scores.mean()</span></pre><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mz"><img src="../Images/eb4a11e773d67ffd0c4331e66662519d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dTc0IdbHjTEYUde_fWF6BQ.png"/></div></div></figure><p id="a9f1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated"><strong class="iw hj">å„æ¨¡å‹é—´äº¤å‰éªŒè¯åˆ†æ•°çš„æ¯”è¾ƒ</strong></p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="c2a0" class="jt ju hi lq b fi lu lv l lw lx">data1 = {'Classifier':  ["RandomForestClassifier","XGBoost", "Voting Ensemble"],'Cross Validation Score': [rfc_cv_mean, xgb_cv_mean, vote_cv_mean],}</span><span id="4480" class="jt ju hi lq b fi mt lv l lw lx">cv_data = pd.DataFrame (data1, columns = ['Classifier','Cross Validation Score'])</span><span id="ce92" class="jt ju hi lq b fi mt lv l lw lx">cv_data.sort_values(by='Cross Validation Score', ascending=False)</span></pre><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es na"><img src="../Images/18c2fdce2fc3e7e1c234a5141c184ef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nTCH7JOBJMgWMKUq5I9DIw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd jv">è¡¨3: </strong>ä»¥é™åºæ˜¾ç¤ºæ¯ä¸ªåˆ†ç±»å™¨çš„äº¤å‰éªŒè¯åˆ†æ•°</figcaption></figure><p id="1af1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ ¹æ®<em class="js">è¡¨3 </em>ï¼Œéšæœºæ£®æ—åˆ†ç±»å™¨å…·æœ‰æœ€é«˜çš„äº¤å‰éªŒè¯åˆ†æ•°ä»¥åŠæœ€é«˜çš„å‡†ç¡®æ€§ï¼›å› æ­¤ï¼Œæˆ‘å°†é€‰æ‹©å®ƒä½œä¸ºæˆ‘çš„æœ€ç»ˆæ¨¡å‹ã€‚</p><h2 id="587b" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">æ¨¡å‹å¾®è°ƒ</h2><p id="401e" class="pw-post-body-paragraph iu iv hi iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated">ä¸ºäº†å¾®è°ƒæˆ‘çš„æ¨¡å‹ï¼Œæˆ‘å°†ä½¿ç”¨Scikit-learnçš„GridSearchCVæ¥ä¼˜åŒ–æˆ‘çš„æ¨¡å‹çš„è¶…å‚æ•°ã€‚</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="3f8a" class="jt ju hi lq b fi lu lv l lw lx">from sklearn.model_selection import GridSearchCV</span><span id="b0a6" class="jt ju hi lq b fi mt lv l lw lx">param_grid = {'max_depth': [10, None],'n_estimators': [10, 50, 200],'random_state':[0, 42, None]}</span><span id="d06b" class="jt ju hi lq b fi mt lv l lw lx">grid = GridSearchCV(RandomForestClassifier(), param_grid, refit = True, verbose = 2,n_jobs=-1)</span><span id="346b" class="jt ju hi lq b fi mt lv l lw lx">grid.fit(X_train, y_train)</span><span id="cae1" class="jt ju hi lq b fi mt lv l lw lx">grid_predictions = grid.predict(X_test)</span><span id="56dd" class="jt ju hi lq b fi mt lv l lw lx">print(classification_report(y_test, grid_predictions))</span><span id="59dc" class="jt ju hi lq b fi mt lv l lw lx">print(grid.best_params_)</span></pre><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nb"><img src="../Images/a8c81e8cf801a81c541ded578596dc5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yiJGRej3ap1Z2kS_PnvDlg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">å›¾6</figcaption></figure><p id="5120" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">Scikit-learnçš„GridSearchCVæ¨èä»¥ä¸‹è¶…å‚æ•°:</p><ul class=""><li id="80ef" class="md me hi iw b ix iy jb jc jf mf jj mg jn mh jr mv mj mk ml bi translated">max_depth = 10</li><li id="89b5" class="md me hi iw b ix mm jb mn jf mo jj mp jn mq jr mv mj mk ml bi translated">n _ä¼°è®¡å€¼= 200</li><li id="410f" class="md me hi iw b ix mm jb mn jf mo jj mp jn mq jr mv mj mk ml bi translated">éšæœºçŠ¶æ€= 0</li></ul><p id="11ca" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">å› æ­¤ï¼Œæˆ‘å°†ç”¨è¿™äº›è¶…å‚æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„éšæœºæ£®æ—åˆ†ç±»å™¨ã€‚</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="9e34" class="jt ju hi lq b fi lu lv l lw lx">after_cv_rf = RandomForestClassifier(max_depth = 10, n_estimators = 200, random_state = 0)<br/>after_cv_rf.fit(X_train, y_train)<br/>after_cv_predict = model_rf.predict(X_test)<br/>recall_cv = recall_score(y_test, after_cv_predict, pos_label=1.0)<br/>aftercv_precision_rf = precision_score(y_test, after_cv_predict, pos_label=1.0)</span><span id="09ac" class="jt ju hi lq b fi mt lv l lw lx">print('Accuracy = ', aftercv_precision_rf)</span><span id="32e0" class="jt ju hi lq b fi mt lv l lw lx">aftercv_rfc_cv = RandomForestClassifier(max_depth = 10, n_estimators = 200, random_state = 0)<br/>scores = cross_val_score(aftercv_rfc_cv, X_train, y_train, cv=10, scoring = "accuracy")</span><span id="6e91" class="jt ju hi lq b fi mt lv l lw lx">aftercv_cv_mean = scores.mean()</span><span id="6ee5" class="jt ju hi lq b fi mt lv l lw lx">print("Mean cross-validation score = ", scores.mean())</span></pre><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nc"><img src="../Images/8a3b54d424a34ca6c4424662f2af2804.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E2jjO0sJNFSWt2IU-1n_CQ.png"/></div></div></figure><p id="3487" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬æ•´åˆåœ¨ä¸€èµ·:</p><pre class="ll lm ln lo fd lp lq lr ls aw lt bi"><span id="a5c3" class="jt ju hi lq b fi lu lv l lw lx">data2 = {"Before Cross-validation":  [precision_rf,rfc_cv_mean ], "After Cross-validation": [aftercv_precision_rf, aftercv_cv_mean], "Type": ["Accuracy Score", "Mean Cross-validation Score"]}</span><span id="57ba" class="jt ju hi lq b fi mt lv l lw lx">final_df = pd.DataFrame (data2, columns = ["Type", "Before Cross-validation","After Cross-validation"])</span><span id="8189" class="jt ju hi lq b fi mt lv l lw lx">final_df.set_index("Type")<br/>final_df.head()</span></pre><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nd"><img src="../Images/3d56619989bf5c217ce844fc87f9d24e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oUe-KuwRIgxF7At0K9zLOA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd jv">è¡¨4: </strong>å¯¹æ¯”äº¤å‰éªŒè¯å‰åçš„å‡†ç¡®åº¦å¾—åˆ†å’Œå¹³å‡äº¤å‰éªŒè¯å¾—åˆ†</figcaption></figure><p id="9ee2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è™½ç„¶æ¨¡å‹çš„å‡†ç¡®æ€§å¾—åˆ†æ²¡æœ‰å¢åŠ ï¼Œä½†å…¶å¹³å‡äº¤å‰éªŒè¯å¾—åˆ†å¢åŠ äº†ï¼Œè¿™æ„å‘³ç€æ¨¡å‹ç”±äºè¶…å‚æ•°ä¼˜åŒ–è€Œå¾—åˆ°äº†æ”¹å–„(<em class="js">è¡¨4 </em>)ã€‚</p><h2 id="30fd" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">ğŸ§™â€â™€ï¸æœ€ç»ˆåˆ¤å†³:</h2><p id="887e" class="pw-post-body-paragraph iu iv hi iw b ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn ks jp jq jr hb bi translated"><strong class="iw hj">éšæœºæ£®æ—æ¨¡å‹å…·æœ‰76.2%çš„å‡†ç¡®ç‡å’Œ73.1%çš„äº¤å‰éªŒè¯åˆ†æ•°ï¼Œæ˜¯é¢„æµ‹å“ªäº›è‚¡ç¥¨å€¼å¾—è´­ä¹°çš„æœ€ä½³æœºå™¨å­¦ä¹ æ¨¡å‹</strong>ğŸ‰<em class="js">(è‡³å°‘å¯¹äºè¿™ä¸ªæ•°æ®é›†)</em></p><h1 id="eddc" class="ku ju hi bd jv kv kw kx jz ky kz la kd lb lc ld kg le lf lg kj lh li lj km lk bi translated">ğŸé¢å¤–æ”¶è·:ä¸€äº›è§è§£</h1><h2 id="7e60" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">ç‰¹å¾é‡è¦æ€§</h2><figure class="ll lm ln lo fd ij er es paragraph-image"><div class="er es ne"><img src="../Images/4b57c0129fc942cac51bdcd89ad1b89e.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*K4zsjfoaRf6h-mwjnu-IXg.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd jv">å›¾7: </strong>æ ¹æ®æˆ‘ä»¬çš„éšæœºæ£®æ—æ¨¡å‹ï¼Œé¢„æµ‹è‚¡ç¥¨â€œç±»åˆ«â€çš„åä¸ªæœ€é‡è¦çš„ç‰¹å¾</figcaption></figure><p id="e9cd" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">æ ¹æ®<em class="js">å›¾7 </em>ï¼Œåœ¨è¯¥æ¨¡å‹ä¸­ï¼Œä»¥ä¸‹ç‰¹å¾åœ¨é¢„æµ‹è‚¡ç¥¨æ˜¯å¦å€¼å¾—å–å‡ºæ—¶æœ€ä¸ºé‡è¦:</p><ol class=""><li id="8228" class="md me hi iw b ix iy jb jc jf mf jj mg jn mh jr mi mj mk ml bi translated"><strong class="iw hj">æœ‰å½¢èµ„äº§ä»·å€¼:</strong>â€œæ˜¯å…¬å¸ç»è¥ä¸­ä½¿ç”¨çš„æœ‰å½¢çš„ã€å¯è®¡é‡çš„èµ„äº§ã€‚è´¢äº§ã€å‚æˆ¿å’Œè®¾å¤‡ç­‰èµ„äº§æ˜¯æœ‰å½¢èµ„äº§ã€‚å®ƒä»¬ä¸ºå…¬å¸æä¾›ç”Ÿäº§å•†å“å’ŒæœåŠ¡çš„æ‰‹æ®µï¼Œä»è€Œæ„æˆäº†å…¬å¸ä¸šåŠ¡çš„æ”¯æŸ±ã€‚ç„¶è€Œï¼Œç”±äºæœ‰å½¢èµ„äº§æ˜¯æœ‰å½¢èµ„äº§ï¼Œè‡ªç„¶å‘ç”Ÿçš„äº‹æ•…ä¼šæŸåæœ‰å½¢èµ„äº§ã€‚â€(é€šè¿‡Investopedia)</li><li id="1dd2" class="md me hi iw b ix mm jb mn jf mo jj mp jn mq jr mi mj mk ml bi translated"><strong class="iw hj">æ”¶ç›Šæ”¶ç›Šç‡:</strong>â€œæŒ‡æœ€è¿‘12ä¸ªæœˆçš„æ¯è‚¡æ”¶ç›Šé™¤ä»¥å½“å‰æ¯è‚¡å¸‚ä»·ã€‚æ”¶ç›Šæ”¶ç›Šç‡(å¸‚ç›ˆç‡çš„å€’æ•°)æ˜¾ç¤ºçš„æ˜¯å…¬å¸æ¯è‚¡æ”¶ç›Šçš„ç™¾åˆ†æ¯”ã€‚â€(é€šè¿‡Investopedia)</li><li id="d87a" class="md me hi iw b ix mm jb mn jf mo jj mp jn mq jr mi mj mk ml bi translated"><strong class="iw hj">æ€»èµ„äº§:</strong>â€œä¸ªäººã€å…¬å¸æˆ–å›½å®¶æ‹¥æœ‰æˆ–æ§åˆ¶çš„å…·æœ‰ç»æµä»·å€¼çš„èµ„æºçš„æ€»å’Œï¼Œé¢„æœŸå®ƒå°†æä¾›æœªæ¥çš„åˆ©ç›Šã€‚â€(é€šè¿‡Investopedia)</li></ol><h2 id="63ec" class="jt ju hi bd jv jw jx jy jz ka kb kc kd jf ke kf kg jj kh ki kj jn kk kl km kn bi translated">è¡Œä¸šæ´å¯Ÿ</h2><div class="ll lm ln lo fd ab cb"><figure class="nf ij ng nh ni nj nk paragraph-image"><img src="../Images/ce4a2bb6d8ea0706d4aa66a5a5ed0c6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*PjoKamcsr0tg3wBtDLsaBg.png"/></figure><figure class="nf ij nl nh ni nj nk paragraph-image"><img src="../Images/893841053f8afe23e068f63cef5a7d2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*1FsbTzW-H4zoES1UdnfzsQ.png"/><figcaption class="iq ir et er es is it bd b be z dx nm di nn no translated"><strong class="bd jv">å›¾8 </strong>:ç»Ÿè®¡æ•°æ®é›†ä¸­æ¯ä¸ªæ¿å—çš„è‚¡ç¥¨æ•°é‡ã€‚<strong class="bd jv">å›¾9: </strong>æ¯ä¸ªæ‰‡åŒºä¸­â€œ0â€å’Œâ€œ1â€è®¡æ•°çš„å †ç§¯æ¡å½¢å›¾ã€‚</figcaption></figure></div><p id="73b2" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä»<em class="js">å›¾8å’Œå›¾9 </em>ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ•°æ®é›†ä¸­æœ€å—æ¬¢è¿çš„è¡Œä¸šå¦‚ä¸‹:</p><ol class=""><li id="8a13" class="md me hi iw b ix iy jb jc jf mf jj mg jn mh jr mi mj mk ml bi translated">é‡‘èæœåŠ¡</li><li id="bc9f" class="md me hi iw b ix mm jb mn jf mo jj mp jn mq jr mi mj mk ml bi translated">å«ç”Ÿä¿å¥</li><li id="a924" class="md me hi iw b ix mm jb mn jf mo jj mp jn mq jr mi mj mk ml bi translated">æŠ€æœ¯ã€‚</li></ol><p id="12e1" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">è€Œæ•°æ®é›†ä¸­æœ€ä¸å—æ¬¢è¿çš„éƒ¨é—¨å¦‚ä¸‹:</p><ol class=""><li id="cc64" class="md me hi iw b ix iy jb jc jf mf jj mg jn mh jr mi mj mk ml bi translated">é€šä¿¡æœåŠ¡</li><li id="2bc9" class="md me hi iw b ix mm jb mn jf mo jj mp jn mq jr mi mj mk ml bi translated">å…¬ç”¨äº‹ä¸š</li><li id="a918" class="md me hi iw b ix mm jb mn jf mo jj mp jn mq jr mi mj mk ml bi translated">æ¶ˆè´¹è€…é˜²å¾¡</li></ol><figure class="ll lm ln lo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es np"><img src="../Images/a358b8a21e014b5223d55b7946cfb040.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NQZNmGAi7L2kuPaYTbCMKw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><strong class="bd jv">å›¾10: </strong>æ¯ä¸ªæ‰‡åŒºçš„â€œ0â€å’Œâ€œ1â€è®¡æ•°çš„åˆ†ç±»å›¾ã€‚</figcaption></figure><p id="dbf6" class="pw-post-body-paragraph iu iv hi iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">ä»<em class="js">å›¾10 </em>ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯è‚¡å€¼å¾—è´­ä¹°è‚¡ç¥¨æ¯”ä¾‹æœ€é«˜çš„è¡Œä¸šå¦‚ä¸‹:</p><ol class=""><li id="43c5" class="md me hi iw b ix iy jb jc jf mf jj mg jn mh jr mi mj mk ml bi translated">é‡‘èæœåŠ¡</li><li id="edcb" class="md me hi iw b ix mm jb mn jf mo jj mp jn mq jr mi mj mk ml bi translated">æˆ¿åœ°äº§</li><li id="4754" class="md me hi iw b ix mm jb mn jf mo jj mp jn mq jr mi mj mk ml bi translated">å·¥ä¸š</li></ol></div></div>    
</body>
</html>