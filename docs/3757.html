<html>
<head>
<title>One-Hot Encoding Categorical Variables — What is it? Why is it? How is it?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一次性编码分类变量——是什么？为什么呢？怎么样？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/one-hot-encoding-categorical-variables-what-is-it-why-is-it-how-is-it-6fd9ed3a161?source=collection_archive---------2-----------------------#2021-07-23">https://medium.com/analytics-vidhya/one-hot-encoding-categorical-variables-what-is-it-why-is-it-how-is-it-6fd9ed3a161?source=collection_archive---------2-----------------------#2021-07-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/2dc73093b8ff0841a6ef108ecf8fd9d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0IGSnpy9APhfXb_zBxzDfw.jpeg"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">图片来自作者</figcaption></figure><div class=""/><p id="a1c9" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><em class="jr"> ***来自银河护卫队的线索Drax】</em></p><p id="fd1e" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><em class="jr">简要解释了什么是分类变量，如何使用一键编码处理它们，以及如何用Python编写11行代码。</em></p><p id="cf9c" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在我们进入什么是一键编码之前，让我们简单地定义一下什么是分类变量。</p><p id="93f1" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hx"> <em class="jr">分类变量</em> </strong>包含名称、标签或字符串形式的值。乍一看，这些变量似乎无害。然而，它们会给你的机器学习模型带来困难，因为它们不知道如何给它们分配一些数值重要性。<strong class="iv hx"> <em class="jr">为什么？</em> </strong>因为机器学习模型希望一切都以数字形式提供给它们。</p><blockquote class="js"><p id="b891" class="jt ju hw bd jv jw jx jy jz ka kb jq dx translated">"机器学习模型希望一切都以数字形式提供给它们."</p></blockquote><p id="7b58" class="pw-post-body-paragraph it iu hw iv b iw kc iy iz ja kd jc jd je ke jg jh ji kf jk jl jm kg jo jp jq ha bi translated">一个广泛使用的例子是预测房价。在一个完美的世界里，所有的输入变量都是数字，所以运行一个模型将是轻而易举的。但是，我们并不是在一个完美的世界中，所以数据有各种形状和大小，而且通常情况下，其中会有一个或多个分类变量，或者有时您希望将分类变量添加到您的模型中，因为您认为它会改进对输出变量的预测。</p><p id="f14c" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">所以，现在的问题是，你如何提取这些分类变量持有的有意义的信息？<em class="jr">参见下面的例子:</em></p><p id="aebc" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">这里，我们有一个项目的样本数据，我们希望预测Airbnb房源的每晚价格。看数据和我们正在解决的问题，我们很容易说这是一个监督的问题。</p><figure class="ki kj kk kl fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es kh"><img src="../Images/3c10e0899bfbced08ce85613d4f9362f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y8BdTl0T4N4MmbGf_uLg-w.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">图片来自作者</figcaption></figure><p id="eb88" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">由于这是一个监督问题，我们有一列价格<em class="jr">(目标变量)</em>和输入变量，我们将把它们放入我们的模型，因为我们认为它们与每晚价格变量有某种关系。但是，Airbnb  变量的<strong class="iv hx"> <em class="jr">类型是<strong class="iv hx"> <em class="jr">分类</em> </strong>。它为每一类Airbnb房源提供了一个标签。<em class="jr"> *见下文</em></em></strong></p><figure class="ki kj kk kl fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es km"><img src="../Images/d01858844823ff64780a811d48ddce82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nWSijGE9DJXWRzZd7A_0Fw.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">图片来自作者</figcaption></figure><p id="acd7" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我们不可能理解这些类之间的数字差异，因为它们没有任何顺序或规模。但一眼看去，Airbnb的类型似乎真的可以用来预测每晚的价格，所以我们不想放弃它。所以，我们将回到我们之前的问题——你如何处理这样的分类变量？一个可能的解决方案是将每个类转换成数字形式。<em class="jr">*见下文</em></p><figure class="ki kj kk kl fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es kn"><img src="../Images/c2e09aafc7bc99786a4a50e0ea79f879.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HAZCcICUQiKdBVV5f8eqQA.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">图片来自作者</figcaption></figure><p id="444e" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">你可以看到，整个房子被分配为1，别墅为2，共享房间为3，私人房间为4。这种方法实际上是可行的，模型将毫无问题地接受这个新变量。然而，这可能是<strong class="iv hx"> <em class="jr">而不是</em> </strong>成为<strong class="iv hx"> <em class="jr">这个变量的最佳逼近</em> </strong>或变换。<strong class="iv hx"> <em class="jr">为什么？</em>在这里，我们告诉模型，共享房间比整个房子或别墅类型的列表好三倍，并将导致模型在这个转换变量<em class="jr">(Airbnb的数字形式类型)</em>和我们的输出变量<em class="jr">(每晚价格)</em>之间找到错误的关系或没有关系。</strong></p><p id="8b9d" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">还是这个问题，<strong class="iv hx"> <em class="jr">“你如何处理这样的分类变量？”</em> </strong>解？创建新变量，通常称为<strong class="iv hx"> <em class="jr">虚拟变量</em> </strong>。为了做到这一点，我们将使用一种叫做一键编码的方法。</p><blockquote class="js"><p id="6d5b" class="jt ju hw bd jv jw jx jy jz ka kb jq dx translated">"独热编码是分类变量作为二进制向量的表示."</p></blockquote><p id="6c66" class="pw-post-body-paragraph it iu hw iv b iw kc iy iz ja kd jc jd je ke jg jh ji kf jk jl jm kg jo jp jq ha bi translated">现在，让我们使用one-hot编码方法转换Airbnb的分类变量类型，或者将类表示为二进制向量。<em class="jr">*见下文</em></p><figure class="ki kj kk kl fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es ko"><img src="../Images/2f8476c7cfd84ed7aabef4dfb90d4822.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*03AfBg-yPTu-rA4nXbSLAQ.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">图片来自作者</figcaption></figure><p id="1313" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我们现在为我们的Airbnb列中存在的每个类都有了一个新列。现在，整个house列的值为1，其他三列的值为0，同样的逻辑也适用于其他列。在这种用二进制值表示的转换中，我们没有给它们分配任何特定的顺序或数据比例。我们刚刚创建了新的列，模型可以轻松公正地评估是否存在任何预测关系。</p><p id="68e0" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我们现在可以使用这些列作为模型中的输入变量，并放弃Airbnb列的类型，因为包含的信息现在完全由模型可以处理的这4个新的数字列表示。<em class="jr">*见下文</em></p><figure class="ki kj kk kl fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es ko"><img src="../Images/b6a5f2b69af565e5216414891637e75d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d72_F1vexmGUpMi0pcaB5Q.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">图片来自作者</figcaption></figure><p id="8e63" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">但是，我们仍然要考虑我们之前提到的一件事，那就是<strong class="iv hx"> <em class="jr">虚拟变量陷阱</em> </strong>。</p><blockquote class="js"><p id="6489" class="jt ju hw bd jv jw jx jy jz ka kb jq dx translated">“<strong class="ak"> <em class="kp">虚拟变量陷阱</em> </strong>是输入变量完美地预测彼此的地方——创建<strong class="ak"> <em class="kp">多重共线性</em> </strong>。”</p></blockquote><p id="95a5" class="pw-post-body-paragraph it iu hw iv b iw kc iy iz ja kd jc jd je ke jg jh ji kf jk jl jm kg jo jp jq ha bi translated"><strong class="iv hx"> <em class="jr">多重共线性</em> </strong>当两个或两个以上的输入变量<strong class="iv hx"> <em class="jr">高度相关</em> </strong>时发生。这是我们试图避免的情况，因为虽然它不一定会影响模型的整体预测准确性，但很难相信关于模型表现如何以及它实际上有多少输入变量的统计数据。</p><p id="c4e8" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">那么，哑变量陷阱有解决方法吗？<strong class="iv hx">是的！这很简单。我们所需要的是去掉一个虚拟变量，以确保它们之间没有完美的信息。如果我们有只需要三列或四列(如下图所示)甚至十列的虚拟变量，我们只需要删除其中一列。</strong></p><figure class="ki kj kk kl fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es kq"><img src="../Images/56082470ec13128618ccfb4497df3e8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Ky76FtzS_QvG_M5w2qd3A.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">图片来自作者</figcaption></figure><p id="3661" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hx"> <em class="jr">注意:</em> </strong> <em class="jr">对你的模型中的每一组新的虚拟变量都这样做是很重要的。</em></p><p id="c695" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">例如，如果您有另一个分类变量需要一次性编码处理，那么您也需要从该集合中删除一列。</p><p id="6c6f" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">那么，我们如何使用Scikit-learn在Python中仅用几行代码(尤其是11行代码)实现这种一次性编码处理呢？<em class="jr"> *参见下面的代码模板</em></p><p id="fc98" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hx"> <em class="jr">导入所需套餐</em> </strong></p><figure class="ki kj kk kl fd hj"><div class="bz dy l di"><div class="kr ks l"/></div></figure><p id="ade0" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hx"> <em class="jr">导入您的数据</em> </strong></p><figure class="ki kj kk kl fd hj"><div class="bz dy l di"><div class="kr ks l"/></div></figure><p id="048d" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hx"> <em class="jr">将分类变量放入列表，实例化OHE </em> </strong></p><figure class="ki kj kk kl fd hj"><div class="bz dy l di"><div class="kr ks l"/></div></figure><p id="6dd9" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hx"> <em class="jr">对数据进行OHE处理</em> </strong></p><figure class="ki kj kk kl fd hj"><div class="bz dy l di"><div class="kr ks l"/></div></figure><p id="4959" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">现在，您有了一个可以在模型中使用的独热编码模板。但是你要知道还有其他方法来编码你的分类变量。我刚刚向你展示了最常见的处理方法。你可以在这里  检查并尝试其他方法<a class="ae kt" href="https://feature-engine.readthedocs.io/en/1.0.x/encoding/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="iv hx"> <em class="jr">。</em></strong></a></p></div><div class="ab cl ku kv go kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ha hb hc hd he"><p id="3482" class="pw-post-body-paragraph it iu hw iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">参考资料:</p><div class="hg hh ez fb hi lb"><a href="https://github.com/ZL63388" rel="noopener  ugc nofollow" target="_blank"><div class="lc ab dw"><div class="ld ab le cl cj lf"><h2 class="bd hx fi z dy lg ea eb lh ed ef hv bi translated">ZL63388 -概述</h2><div class="li l"><h3 class="bd b fi z dy lg ea eb lh ed ef dx translated">阻止或报告该存储库是用于模型构建的基本和高级代码模板的集合。所有代码…</h3></div><div class="lj l"><p class="bd b fp z dy lg ea eb lh ed ef dx translated">github.com</p></div></div><div class="lk l"><div class="ll l lm ln lo lk lp ho lb"/></div></div></a></div><div class="hg hh ez fb hi lb"><a href="https://data-science-infinity.teachable.com/courses/data-science-infinity?affcode=716157_jcwmqdhh" rel="noopener  ugc nofollow" target="_blank"><div class="lc ab dw"><div class="ld ab le cl cj lf"><h2 class="bd hx fi z dy lg ea eb lh ed ef hv bi translated">数据科学无限</h2><div class="li l"><h3 class="bd b fi z dy lg ea eb lh ed ef dx translated">以正确的方式学习正确的内容，并提供无限的支持和指导，我致力于帮助您成为一名…</h3></div><div class="lj l"><p class="bd b fp z dy lg ea eb lh ed ef dx translated">data-science-infinity.teachable.com</p></div></div><div class="lk l"><div class="lq l lm ln lo lk lp ho lb"/></div></div></a></div></div></div>    
</body>
</html>