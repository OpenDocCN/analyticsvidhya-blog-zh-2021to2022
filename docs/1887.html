<html>
<head>
<title>Deploy your model using a Flask Web Service</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Flask Web服务部署您的模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/deploy-your-model-using-a-flask-web-service-461ccaef9ea0?source=collection_archive---------1-----------------------#2021-03-24">https://medium.com/analytics-vidhya/deploy-your-model-using-a-flask-web-service-461ccaef9ea0?source=collection_archive---------1-----------------------#2021-03-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="827c" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">创建您的深度学习API，并在您的网站中使用它</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/d59bf4e0f16f870109eea6eab33214c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a-Furs_r-pR-9EAhoLAI5w.jpeg"/></div></div></figure><p id="4535" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">当处理一个ML项目时，我们首先探索数据并选择合适的模型和预处理。然后我们训练和测试，直到我们达到预期的表现。之后，我们需要部署我们的模型，以便从网站或应用程序中使用它。</p><p id="165e" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">我们当然不能用笔记本，因为那会很乱！此外，除非我们的web应用程序是基于Django的，否则它甚至可能不是用python编写的。那么，我们如何将我们的模型部署为一个API，然后从应用程序中调用它呢？</p><p id="9048" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">一种选择是将我们的模型转移到web服务中。这样，我们用HTML和JavaScript编写的web应用程序将能够通过与python Flask Web服务通信的HTTP请求来访问我们的模型。</p><p id="aaf8" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">为了更详细地说明这一点，我们遵循以下流程:</p><ul class=""><li id="af95" class="ke kf hh jk b jl jm jo jp jr kg jv kh jz ki kd kj kk kl km bi translated">1.创建我们的模型</li><li id="7354" class="ke kf hh jk b jl kn jo ko jr kp jv kq jz kr kd kj kk kl km bi translated">2.安装并发射烧瓶</li><li id="9790" class="ke kf hh jk b jl kn jo ko jr kp jv kq jz kr kd kj kk kl km bi translated">3.用Flask交换数据并托管我们的模型</li><li id="7ff1" class="ke kf hh jk b jl kn jo ko jr kp jv kq jz kr kd kj kk kl km bi translated">4.构建一个前端web应用程序来与我们的API进行通信</li><li id="48fd" class="ke kf hh jk b jl kn jo ko jr kp jv kq jz kr kd kj kk kl km bi translated">5.数据安全和隐私</li></ul><h1 id="e27a" class="ks kt hh bd ku kv kw kx ky kz la lb lc in ld io le iq lf ir lg it lh iu li lj bi translated">1.创建我们的模型</h1><p id="e393" class="pw-post-body-paragraph ji jj hh jk b jl lk ii jn jo ll il jq jr lm jt ju jv ln jx jy jz lo kb kc kd ha bi translated">在本文中，我们将简单地从Keras中选取一个预先训练好的模型，以便专注于下面的部分。我们将使用著名的Resnet50对包含一千个类的ImageNet数据进行训练。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lq lr l"/></div></figure><h1 id="31bf" class="ks kt hh bd ku kv kw kx ky kz la lb lc in ld io le iq lf ir lg it lh iu li lj bi translated">2.安装并发射烧瓶</h1><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ls"><img src="../Images/fcca845d14260272e55a3def60c7e30a.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*dWTkWdquk4SlBOmzooqVEg.png"/></div></figure><p id="e5a3" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">下面是在python环境中安装Flask的两种方法:</p><pre class="ix iy iz ja fd lt lu lv lw aw lx bi"><span id="6b02" class="ly kt hh lu b fi lz ma l mb mc"># <em class="md">option 1 : pip</em><br/>pip install flask</span><span id="c0b4" class="ly kt hh lu b fi me ma l mb mc"># <em class="md">option 2 : conda</em><br/>conda install -c anaconda flask</span></pre><p id="dd01" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">接下来，我们将创建一个非常基本的应用程序，如果我们浏览URL:“/test”，它将显示文本“Flask中的第一个应用程序”。这只是为了看看我们的安装是否正常工作。下面是我们项目的结构:</p><pre class="ix iy iz ja fd lt lu lv lw aw lx bi"><span id="1dda" class="ly kt hh lu b fi lz ma l mb mc">flask_applications/<br/>    app.py</span></pre><p id="757c" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">这是我们的app.py:</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="c95c" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">打开您的终端，转到“flask_applications/”文件夹来运行这个命令(<a class="ae lp" href="http://windows.com" rel="noopener ugc nofollow" target="_blank"> windows等价物</a>):</p><pre class="ix iy iz ja fd lt lu lv lw aw lx bi"><span id="6e42" class="ly kt hh lu b fi lz ma l mb mc"># run this the first time you declare an app<br/>export FLASK_APP=app.py</span><span id="2394" class="ly kt hh lu b fi me ma l mb mc"># then launch it<br/>flask run --host=0.0.0.0</span></pre><p id="455a" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">选择您喜欢的浏览器并导航到您终端上显示的地址:<a class="ae lp" href="http://127.0.0.1:5000/static/app.html" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:5000 </a>。现在转到激活我们的函数“test”的url，所以在url中添加“/test”。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mf"><img src="../Images/02be5abc643a12bcf1a4cf45fb681329.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c2CjxCQWM7EIKUTnWNggXg.jpeg"/></div></div><figcaption class="mg mh et er es mi mj bd b be z dx translated">屏幕上显示程序运行的图片</figcaption></figure><p id="d4d4" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">我们做了第一个应用！这很好，但目前没什么用…</p><h1 id="d39d" class="ks kt hh bd ku kv kw kx ky kz la lb lc in ld io le iq lf ir lg it lh iu li lj bi translated">3.用flask交换数据并托管我们的模型</h1><h2 id="05a0" class="ly kt hh bd ku mk ml mm ky mn mo mp lc jr mq mr le jv ms mt lg jz mu mv li mw bi translated">3.1如何与Flask交换数据</h2><p id="c285" class="pw-post-body-paragraph ji jj hh jk b jl lk ii jn jo ll il jq jr lm jt ju jv ln jx jy jz lo kb kc kd ha bi translated">我们想创建一个Flask应用程序，它将作为我们的web应用程序的后端。我们的Flask应用程序需要能够接收来自HTTP post请求的图像。它还需要以Json格式发回结果。</p><p id="63ff" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">为此，我们将使用两个额外的库:“request”检索来自post请求的数据，而“jsonify”将结果转换为json格式。以下是我们更新的app.py:</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="6d51" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">我们的应用程序的目标是将图像作为输入，并通过我们的模型传递它们。让我们再一次改变我们的app.py😉</p><h2 id="c25e" class="ly kt hh bd ku mk ml mm ky mn mo mp lc jr mq mr le jv ms mt lg jz mu mv li mw bi translated">3.2用烧瓶装载我们的模型</h2><p id="3eb3" class="pw-post-body-paragraph ji jj hh jk b jl lk ii jn jo ll il jq jr lm jt ju jv ln jx jy jz lo kb kc kd ha bi translated">我们将从post请求中获得的数据是一个图像。我们想给我们的ResNet50提供这个图像来获得预测。之后，我们的Flask应该将结果存储为Json格式的dictionary cast并返回它。这是我们新版本的app.py:</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="5274" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">我们的后端完成了！下一步是创建一个前端web应用程序来与我们的Flask应用程序进行通信。</p><h1 id="b39a" class="ks kt hh bd ku kv kw kx ky kz la lb lc in ld io le iq lf ir lg it lh iu li lj bi translated">4.构建一个前端web应用程序来与我们的API进行通信</h1><p id="8f08" class="pw-post-body-paragraph ji jj hh jk b jl lk ii jn jo ll il jq jr lm jt ju jv ln jx jy jz lo kb kc kd ha bi translated">我们需要在项目中再添加一个文件:</p><pre class="ix iy iz ja fd lt lu lv lw aw lx bi"><span id="ad9d" class="ly kt hh lu b fi lz ma l mb mc">flask_applications/<br/>    app.py<br/>    static/<br/>        app.html</span></pre><p id="ba69" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">基本上，我们的app.html需要包括:</p><ul class=""><li id="cf1c" class="ke kf hh jk b jl jm jo jp jr kg jv kh jz ki kd kj kk kl km bi translated">上传图像的输入</li><li id="1c90" class="ke kf hh jk b jl kn jo ko jr kp jv kq jz kr kd kj kk kl km bi translated">一个按钮，点击并激活一个脚本调用我们的Flask应用程序</li><li id="a394" class="ke kf hh jk b jl kn jo ko jr kp jv kq jz kr kd kj kk kl km bi translated">显示预测结果的段落</li><li id="087b" class="ke kf hh jk b jl kn jo ko jr kp jv kq jz kr kd kj kk kl km bi translated">显示上传图像的图像元素</li><li id="62cb" class="ke kf hh jk b jl kn jo ko jr kp jv kq jz kr kd kj kk kl km bi translated">当然还有与我们的烧瓶通信的脚本。这个脚本还用预测更新段落文本，用上传的图像更新图像元素。</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="6630" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">现在，我们可以像以前一样启动应用程序，并导航到<a class="ae lp" href="http://10.0.0.4:5000/static/predict.html" rel="noopener ugc nofollow" target="_blank">http://0 . 0 . 0 . 0:5000/static/app . html</a></p><p id="d660" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">您现在应该会看到这样一个网页:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mx"><img src="../Images/e95f29f91a05dcd4a1777174bb58f40a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zwhQmfrOA4-MJP7FF1_YjA.jpeg"/></div></div></figure><p id="5331" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">上传一个”。png”图像并点击“预测”。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es my"><img src="../Images/2c23c621ea73fb7de767a64b877da856.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cilqXTJYWmvGwSpSv67BVw.jpeg"/></div></div></figure><p id="d46c" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">哇！好的，布局不是最漂亮的，但是你只是通过调用Flask应用程序在网页上使用了你的模型。基本上你创建了你的第一个深度学习API。如果你成功了，恭喜你！</p><h1 id="c454" class="ks kt hh bd ku kv kw kx ky kz la lb lc in ld io le iq lf ir lg it lh iu li lj bi translated">5.数据安全和隐私</h1><p id="f9de" class="pw-post-body-paragraph ji jj hh jk b jl lk ii jn jo ll il jq jr lm jt ju jv ln jx jy jz lo kb kc kd ha bi translated">简单回顾一下，我们上传了一张图片，并通过HTTP Post请求将其发送到我们的Flask应用程序。然后我们处理它，得到结果，并把它们作为Json发送回我们的前端。最后，我们的网页显示了响应。</p><p id="59da" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">这里我们只发送一个不包含有价值信息的图像。但是，如果我们想要发送像身份证或驾照这样的私人信息，会发生什么呢？我们不想冒这个险。</p><p id="3674" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">如果我们不通过网络传输数据，而是将数据保存在本地，并将模型发送到前端应用程序中运行。这样，一切都可以直接在浏览器中运行。因此，信息可以在浏览器中输入模型，而不必通过网络发送。</p><p id="295d" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">我们如何做到这一点？您可以使用TensorFlow.js库并将您的模型作为JavaScript运行:这将是我下一篇文章的主题😊</p><p id="8566" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">希望对你有所帮助。如果你喜欢看这篇文章，请留言，不要犹豫。</p><h1 id="dd0a" class="ks kt hh bd ku kv kw kx ky kz la lb lc in ld io le iq lf ir lg it lh iu li lj bi translated">参考</h1><div class="mz na ez fb nb nc"><a href="https://flask.palletsprojects.com/en/1.1.x/" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab dw"><div class="ne ab nf cl cj ng"><h2 class="bd hi fi z dy nh ea eb ni ed ef hg bi translated">欢迎使用Flask - Flask文档(1.1.x)</h2><div class="nj l"><h3 class="bd b fi z dy nh ea eb ni ed ef dx translated">欢迎阅读Flask的文档。开始安装，然后了解快速入门概述。有…</h3></div><div class="nk l"><p class="bd b fp z dy nh ea eb ni ed ef dx translated">flask.palletsprojects.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq jg nc"/></div></div></a></div><div class="mz na ez fb nb nc"><a href="https://www.tensorflow.org/" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab dw"><div class="ne ab nf cl cj ng"><h2 class="bd hi fi z dy nh ea eb ni ed ef hg bi translated">张量流</h2><div class="nj l"><h3 class="bd b fi z dy nh ea eb ni ed ef dx translated">一个面向所有人的端到端开源机器学习平台。探索TensorFlow灵活的工具生态系统…</h3></div><div class="nk l"><p class="bd b fp z dy nh ea eb ni ed ef dx translated">www.tensorflow.org</p></div></div><div class="nl l"><div class="nr l nn no np nl nq jg nc"/></div></div></a></div><div class="mz na ez fb nb nc"><a href="https://deeplizard.com/" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab dw"><div class="ne ab nf cl cj ng"><h2 class="bd hi fi z dy nh ea eb ni ed ef hg bi translated">深海蜥蜴——构建集体智慧</h2><div class="nj l"><h3 class="bd b fi z dy nh ea eb ni ed ef dx translated">filter_1机器学习&amp;深度学习基础filter_2 Keras - Python深度学习神经网络API…</h3></div><div class="nk l"><p class="bd b fp z dy nh ea eb ni ed ef dx translated">deeplizard.com</p></div></div><div class="nl l"><div class="ns l nn no np nl nq jg nc"/></div></div></a></div></div></div>    
</body>
</html>