<html>
<head>
<title>Categorical variables: How to encode them and why?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分类变量:如何编码，为什么？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/categorical-variables-how-to-encode-them-and-why-cf0e6f571821?source=collection_archive---------3-----------------------#2021-06-15">https://medium.com/analytics-vidhya/categorical-variables-how-to-encode-them-and-why-cf0e6f571821?source=collection_archive---------3-----------------------#2021-06-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="3ddf" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">对背后现实的一瞥</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/efc3da49e16cb3f01cb8e7259c2cfc64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2dZR705jcmtunv6tNSYjhw.jpeg"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">来源:谷歌图片</figcaption></figure><h2 id="19be" class="jm jn hh bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">摘要:</h2><p id="efe6" class="pw-post-body-paragraph kk kl hh km b kn ko ii kp kq kr il ks jx kt ku kv kb kw kx ky kf kz la lb lc ha bi translated">分类变量可以通过顺序(1，2，3，…)或一键(001，010，100，…)编码方案进行编码。对于不存在任何相关排序的分类变量，例如(男性、女性和其他)，在任何意义上没有一个大于另一个，使用序数编码可能会导致问题，因为(1，2，3)中固有的排序可能会进入计算中。我们将试图找出这个问题的真实程度，它对特征变量和响应变量是否有相似的影响，以及造成这种情况的原因是什么。在这个过程中，我们希望能对背后的现实有所了解。所以系好你的安全带！</p><h2 id="aafa" class="jm jn hh bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">问题:</h2><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ld"><img src="../Images/c58f1f230be7f6462643e1e5c874bc32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8w86it6YRB54YU5eL7Qo_w.jpeg"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">来自谷歌图片</figcaption></figure><p id="5558" class="pw-post-body-paragraph kk kl hh km b kn le ii kp kq lf il ks jx lg ku kv kb lh kx ky kf li la lb lc ha bi translated">我们将尝试回答两个具体的问题-</p><ol class=""><li id="e355" class="lj lk hh km b kn le kq lf jx ll kb lm kf ln lc lo lp lq lr bi translated">假设一个包含3个无序类的响应变量是有序编码的(1，2，3)。当类号映射变化时，模型输出是否不同？</li><li id="928a" class="lj lk hh km b kn ls kq lt jx lu kb lv kf lw lc lo lp lq lr bi translated">当分类特征变量被普通编码时，会出现类似的效果吗？</li></ol><h2 id="26c0" class="jm jn hh bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">问题I —响应变量的情况:</h2><p id="72dc" class="pw-post-body-paragraph kk kl hh km b kn ko ii kp kq kr il ks jx kt ku kv kb kw kx ky kf kz la lb lc ha bi translated">从现在开始的1、2、3级将分别称为红、蓝、绿；它们也将用相同的颜色绘制。它们分别编码为1、2和3。</p><p id="8089" class="pw-post-body-paragraph kk kl hh km b kn le ii kp kq lf il ks jx lg ku kv kb lh kx ky kf li la lb lc ha bi translated">让我们有一个在范围(-1.0，7.0)上均匀分布的特征变量<em class="lx"> x </em>。对于任何一个<em class="lx"> x </em>，红色、蓝色和绿色都有可能发生。下面是在<em class="lx"> x </em>范围内各个等级的概率分布。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ly"><img src="../Images/e278f4f0b7b4bd52bbed9dfd33779ede.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*Taedd30Mw4LO38uIMnr1Ig.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated"><em class="lz"> x </em>上的分类概率分布</figcaption></figure><p id="2599" class="pw-post-body-paragraph kk kl hh km b kn le ii kp kq lf il ks jx lg ku kv kb lh kx ky kf li la lb lc ha bi translated">我们生成遵循这个概率分布的(<em class="lx"> X_train，Y_train </em>)。训练集如下-</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ly"><img src="../Images/7d16eba06e531a54f1703d59e956a504.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*xEYRsD85wl9sdrRnhMKFBg.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">训练集数据</figcaption></figure><p id="3fc5" class="pw-post-body-paragraph kk kl hh km b kn le ii kp kq lf il ks jx lg ku kv kb lh kx ky kf li la lb lc ha bi translated">我们根据这些数据训练一个线性回归模型并进行预测(<em class="lx"> X_test，Y_testPredict </em>)。以下是我们得到的结果-</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ly"><img src="../Images/e7af691b7e66cb098a876629155c705a.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*BEBSF3EcgqSo52ytgBZlSg.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">测试集预测</figcaption></figure><p id="4755" class="pw-post-body-paragraph kk kl hh km b kn le ii kp kq lf il ks jx lg ku kv kb lh kx ky kf li la lb lc ha bi translated">因此，我们看到线性回归模型很好地捕捉到了这种分布。现在保持<em class="lx"> X_train </em>、<em class="lx"> X_test </em>和类别概率分布不变，我们只改变编码方案——红色-2、蓝色-1和绿色-3。</p><p id="a461" class="pw-post-body-paragraph kk kl hh km b kn le ii kp kq lf il ks jx lg ku kv kb lh kx ky kf li la lb lc ha bi translated">随着这一改变的引入，训练集(<em class="lx"> X_train，Y_train </em>)现在看起来如下</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ly"><img src="../Images/d197392e8725d46577cbeb8797532bc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*gZ0E2m3V1eRu-dMJr9ohqg.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">具有改进编码R-2，B-1，G-3的训练集</figcaption></figure><p id="11f1" class="pw-post-body-paragraph kk kl hh km b kn le ii kp kq lf il ks jx lg ku kv kb lh kx ky kf li la lb lc ha bi translated">应用线性回归，测试集(<em class="lx"> X_test，Y_testPredict </em>)现在看起来如下</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ly"><img src="../Images/44388710ef8a2ea2caa9f14ba402aa66.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*wa_iB2oUz83wPdxZpq-ZeA.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">具有修改的编码R-2、B-1、G-3的测试集</figcaption></figure><p id="968d" class="pw-post-body-paragraph kk kl hh km b kn le ii kp kq lf il ks jx lg ku kv kb lh kx ky kf li la lb lc ha bi translated">现在，您可以看到，与之前的编码方案相比，该模型显示的结果非常差，而且完全不同。</p><h2 id="8371" class="jm jn hh bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">问题2 —特征变量的情况</h2><p id="3092" class="pw-post-body-paragraph kk kl hh km b kn ko ii kp kq kr il ks jx kt ku kv kb kw kx ky kf kz la lb lc ha bi translated">现在，我们将引入一个非常简单的观察，而不是对特征变量进行类似的研究，这将引导我们获得有价值的见解(根据上面的数字，你们中的一些人可能已经猜到了)。</p><p id="e9b6" class="pw-post-body-paragraph kk kl hh km b kn le ii kp kq lf il ks jx lg ku kv kb lh kx ky kf li la lb lc ha bi translated">假设我们有一个分类特征变量，分类标签分别为红色、蓝色和绿色。对应的<em class="lx"> Y </em>值为4，5，6。类别标签到数字的映射是——红色-1、蓝色-2和绿色-3。整个数据集看起来如下-</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ma"><img src="../Images/3b748c977f52b9557446a3096e20817c.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/1*uEDF3-v9b2M1eXdjzY5Xug.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">简单的数据集</figcaption></figure><p id="a883" class="pw-post-body-paragraph kk kl hh km b kn le ii kp kq lf il ks jx lg ku kv kb lh kx ky kf li la lb lc ha bi translated">这些数据在绘制时—</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ly"><img src="../Images/33c091b51216d1776dc06a0000269177.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*cA8vbA-RE3GuiXpvnRetRA.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">编码方案R-1、B-2、G-3(看x轴)</figcaption></figure><p id="2d4e" class="pw-post-body-paragraph kk kl hh km b kn le ii kp kq lf il ks jx lg ku kv kb lh kx ky kf li la lb lc ha bi translated">该图显示，在这种情况下，线性回归会做得很好。</p><p id="cba1" class="pw-post-body-paragraph kk kl hh km b kn le ii kp kq lf il ks jx lg ku kv kb lh kx ky kf li la lb lc ha bi translated">使用红色-2、蓝色-1和绿色-3的不同编码方案，数据集将是—</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mb"><img src="../Images/4bc37f9600c1369015546cc5265f7069.png" data-original-src="https://miro.medium.com/v2/resize:fit:428/format:webp/1*qfMRis76gBAmSjNsfdjQFQ.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">编码方案R-2、B-1、G-3</figcaption></figure><p id="94f8" class="pw-post-body-paragraph kk kl hh km b kn le ii kp kq lf il ks jx lg ku kv kb lh kx ky kf li la lb lc ha bi translated">它的情节会像这样—</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ly"><img src="../Images/8d9a16ed19e8722d47a32bd42392649f.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*7ogxOIOknbBGEQH3HbfPwA.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">编码方案R-2、B-1、G-3</figcaption></figure><p id="6af4" class="pw-post-body-paragraph kk kl hh km b kn le ii kp kq lf il ks jx lg ku kv kb lh kx ky kf li la lb lc ha bi translated">线性案例现在变成了非线性，显然线性回归将无法捕捉到这一点。<strong class="km hi">特征和反应也是如此——改变编码惯例会引入非线性。</strong>再次检查R-2、B-1、G-3编码方案的(<em class="lx"> X_train，Y_train </em>)图，以确保响应变量也发生了类似的情况。</p><h2 id="e4e7" class="jm jn hh bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">结论——抵抗运动</h2><p id="2001" class="pw-post-body-paragraph kk kl hh km b kn ko ii kp kq kr il ks jx kt ku kv kb kw kx ky kf kz la lb lc ha bi translated">因此，当使用顺序编码时，由于不同的编码方案，线性模型可能变成非线性的。</p><p id="414e" class="pw-post-body-paragraph kk kl hh km b kn le ii kp kq lf il ks jx lg ku kv kb lh kx ky kf li la lb lc ha bi translated">现在，为了捕捉非线性，我们需要我们的模型更加灵活。这种灵活性是如何实现的？</p><ol class=""><li id="85b2" class="lj lk hh km b kn le kq lf jx ll kb lm kf ln lc lo lp lq lr bi translated">要么我们的模型本身是非线性的，例如QDA、多项式回归等。</li><li id="6d21" class="lj lk hh km b kn ls kq lt jx lu kb lv kf lw lc lo lp lq lr bi translated">或者我们在线性模型中有更多数量的特征——这与使用线性回归时对分类变量使用一次性编码是一样的(因为较低维度中的非线性可以在较高维度中变得相对更线性)。** <em class="lx">这就是在线性回归中使用多项式特征的作用。</em></li></ol><blockquote class="mc md me"><p id="6725" class="kk kl lx km b kn le ii kp kq lf il ks mf lg ku kv mg lh kx ky mh li la lb lc ha bi translated"><strong class="km hi">因此，当使用线性模型时，普通编码分类变量可能会导致问题(如果您不幸选择了一种编码约定，即使在良好的线性模型中也会引入糟糕的非线性)。同样，引入“独热”编码具有爆炸特征数量的潜在风险，并因此导致过度拟合或破坏模型的可解释性。因此，在线性模型中，两者之间有一个权衡；哪种方案更好取决于手头的具体情况，只能通过实验来决定。</strong></p><p id="9dd9" class="kk kl lx km b kn le ii kp kq lf il ks mf lg ku kv mg lh kx ky mh li la lb lc ha bi translated"><strong class="km hi">对于非线性模型，顺序编码可能通过，因为它们具有捕捉非线性的固有能力。虽然，即使这样也应该通过实验运行来测试，因为我不认为有一个通用的分析证明来涵盖所有不同的场景。</strong></p></blockquote><p id="f7e9" class="pw-post-body-paragraph kk kl hh km b kn le ii kp kq lf il ks jx lg ku kv kb lh kx ky kf li la lb lc ha bi translated">因此，我们的研究得出了一个可能有价值的结论。我希望这是一次富有成果的旅行。谢谢，再见，下次见。</p><p id="7b1a" class="pw-post-body-paragraph kk kl hh km b kn le ii kp kq lf il ks jx lg ku kv kb lh kx ky kf li la lb lc ha bi translated"><strong class="km hi"> PS: </strong>笔记本的代码(包含所有的情节和生成数据集的方法论)可以在下面的<a class="ae mi" href="https://github.com/AnirbanChakraborty06/StatisticalLearning---QA-and-demos-/blob/main/Question%208%20How%20ordinal%20encoding%20of%20categorical%20variable%20for%20more%20than%202%20classes%20affects%20model%20output.ipynb" rel="noopener ugc nofollow" target="_blank"> <em class="lx"> github链接</em> </a>中找到。</p></div></div>    
</body>
</html>