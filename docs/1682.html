<html>
<head>
<title>Alerting Dashboard for Tesla’s Stock Price with QuestDB and Grafana</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用QuestDB和Grafana为Tesla的股票价格提供警报仪表板</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/alerting-dashboard-for-teslas-stock-price-with-questdb-and-grafana-eacf2e6e112c?source=collection_archive---------25-----------------------#2021-03-12">https://medium.com/analytics-vidhya/alerting-dashboard-for-teslas-stock-price-with-questdb-and-grafana-eacf2e6e112c?source=collection_archive---------25-----------------------#2021-03-12</a></blockquote><div><div class="dt gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi fa fc hj hk es et paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="es et hg"><img src="../Images/7035d74ef4b311e48f5700e75b836898.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uBDKXxeRhHV3aOtYw78k0g.jpeg"/></div></div><figcaption class="hr hs eu es et ht hu bd b be z dy translated"><a class="ae hv" href="https://unsplash.com/@techdailyca?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">科技日报</a>在<a class="ae hv" href="https://unsplash.com/s/photos/chart?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><h2 id="d025" class="hw hx hy bd b fq hz ia ib ic id ie dy if translated" aria-label="kicker paragraph">时间序列，数据工程</h2><div class=""/><div class=""><h2 id="60f9" class="pw-subtitle-paragraph je ih hy bd b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv dy translated">关于如何使用QuestDB和Grafana设置时序数据警报的教程</h2></div><h1 id="0aa1" class="jw jx hy bd jy jz ka kb kc kd ke kf kg jn kh jo ki jq kj jr kk jt kl ju km kn bi translated">介绍</h1><p id="5de2" class="pw-post-body-paragraph ko kp hy kq b kr ks ji kt ku kv jl kw kx ky kz la lb lc ld le lf lg lh li lj hb bi translated">对时间序列数据做出反应非常有用的原因有很多，通常情况下，对数据变化做出反应越快越好。这项工作的最佳工具是时间序列数据库，这是一种设计用来读写大量随时间变化的测量数据的数据库。</p><p id="0ff5" class="pw-post-body-paragraph ko kp hy kq b kr lk ji kt ku ll jl kw kx lm kz la lb ln ld le lf lo lh li lj hb bi translated">在本教程中，您将学习如何从REST API读取数据，并将其传输到QuestDB，这是一个开源的时间序列数据库。我们将使用Grafana来可视化数据，并提醒Slack我们感兴趣的变化。我们使用Python从API获取数据，并将其传输到QuestDB，您可以轻松定制脚本来检查不同的股票甚至API。</p><h1 id="bc40" class="jw jx hy bd jy jz ka kb kc kd ke kf kg jn kh jo ki jq kj jr kk jt kl ju km kn bi translated">配置</h1><h2 id="23ef" class="lp jx hy bd jy lq lr ls kc lt lu lv kg kx lw lx ki lb ly lz kk lf ma mb km ie bi translated">先决条件</h2><p id="c4b7" class="pw-post-body-paragraph ko kp hy kq b kr ks ji kt ku kv jl kw kx ky kz la lb lc ld le lf lg lh li lj hb bi translated">在开始学习本教程之前，您需要以下东西:</p><ul class=""><li id="bf24" class="mc md hy kq b kr lk ku ll kx me lb mf lf mg lj mh mi mj mk bi translated"><a class="ae hv" href="https://www.docker.com/products/docker-desktop" rel="noopener ugc nofollow" target="_blank"> <strong class="kq ii"> Docker桌面</strong> </a> —我们已经创建了一个<a class="ae hv" href="https://github.com/bsmth/questdb-slack-grafana-alerts" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>，它将使您能够在Docker容器中运行Grafana和QuestDB。项目<code class="dv ml mm mn mo b"><strong class="kq ii">README</strong></code>还记录了Grafana、QuestDB和Python的设置步骤。</li><li id="6819" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj mh mi mj mk bi translated"><a class="ae hv" href="https://pypi.org/project/iexfinance/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq ii"> IEX账户</strong> </a> —我们将使用IexFinance API来查询股票价格，请注意，IexFinance上的免费账户每月最多可调用50，000次API</li><li id="e4c6" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj mh mi mj mk bi translated"><a class="ae hv" href="https://slack.com/intl/en-au/help/articles/206845317-Create-a-Slack-workspace" rel="noopener ugc nofollow" target="_blank"><strong class="kq ii">Slack workspace</strong></a>—要从Grafana发送股票价格警报，您需要一个能够创建新网页挂钩的Slack workspace。</li></ul><h2 id="f8cc" class="lp jx hy bd jy lq lr ls kc lt lu lv kg kx lw lx ki lb ly lz kk lf ma mb km ie bi translated">使用Docker部署QuestDB &amp; Grafana容器</h2><p id="0b1d" class="pw-post-body-paragraph ko kp hy kq b kr ks ji kt ku kv jl kw kx ky kz la lb lc ld le lf lg lh li lj hb bi translated">首先从GitHub 中克隆<a class="ae hv" href="https://github.com/bsmth/questdb-slack-grafana-alerts" rel="noopener ugc nofollow" target="_blank">库:</a></p><pre class="mu mv mw mx fe my mo mz na aw nb bi"><span id="8855" class="lp jx hy mo b fj nc nd l ne nf"><strong class="mo ii">git clone </strong><a class="ae hv" href="mailto:git@github.com" rel="noopener ugc nofollow" target="_blank"><strong class="mo ii">git@github.com</strong></a><strong class="mo ii">:bsmth/questdb-slack-grafana-alerts.git</strong></span></pre><p id="3d39" class="pw-post-body-paragraph ko kp hy kq b kr lk ji kt ku ll jl kw kx lm kz la lb ln ld le lf lo lh li lj hb bi translated">运行<code class="dv ml mm mn mo b"><strong class="kq ii">docker-compose up</strong></code> <strong class="kq ii"> </strong>将调出两个联网在一起的容器；Grafana在<code class="dv ml mm mn mo b"><strong class="kq ii">localhost:3000</strong></code>上运行，QuestDB在<code class="dv ml mm mn mo b"><strong class="kq ii">localhost:9000</strong></code>上有一个web控制台，在8812上有一个开放的端口，可以接受Postgres协议。</p><p id="0beb" class="pw-post-body-paragraph ko kp hy kq b kr lk ji kt ku ll jl kw kx lm kz la lb ln ld le lf lo lh li lj hb bi translated">要检查您的QuestDB和Grafana容器是否工作正常，请访问上述URL。或者，您可以在命令行上使用<code class="dv ml mm mn mo b"><strong class="kq ii">docker-compose ps</strong></code> <strong class="kq ii"> </strong>来检查状态，这将显示以下输出:</p><figure class="mu mv mw mx fe hk es et paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="es et ng"><img src="../Images/e6f7aedfd6a78bc63a13f3b8d91051a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_NeAgzoWj6Equq_PkriDeA.png"/></div></div></figure><p id="4c1a" class="pw-post-body-paragraph ko kp hy kq b kr lk ji kt ku ll jl kw kx lm kz la lb ln ld le lf lo lh li lj hb bi translated">运行<code class="dv ml mm mn mo b"><strong class="kq ii">docker-compose</strong></code>还将为Grafana提供默认的连接凭证来使用Postgres认证。这意味着您可以立即使用QuestDB作为Grafana中的默认数据源，而无需手动配置步骤。</p><h2 id="ea6b" class="lp jx hy bd jy lq lr ls kc lt lu lv kg kx lw lx ki lb ly lz kk lf ma mb km ie bi translated">安装Python库</h2><p id="f87f" class="pw-post-body-paragraph ko kp hy kq b kr ks ji kt ku kv jl kw kx ky kz la lb lc ld le lf lg lh li lj hb bi translated">本教程所需的所有Python库都列在<code class="dv ml mm mn mo b"><strong class="kq ii">requirements.txt</strong></code> <strong class="kq ii"> </strong>文件中。使用pip安装需求:</p><pre class="mu mv mw mx fe my mo mz na aw nb bi"><span id="621a" class="lp jx hy mo b fj nc nd l ne nf"><strong class="mo ii">pip install -r requirements.txt</strong></span></pre><h2 id="35be" class="lp jx hy bd jy lq lr ls kc lt lu lv kg kx lw lx ki lb ly lz kk lf ma mb km ie bi translated">将模拟数据导入QuestDB</h2><p id="74ed" class="pw-post-body-paragraph ko kp hy kq b kr ks ji kt ku kv jl kw kx ky kz la lb lc ld le lf lg lh li lj hb bi translated">我们需要QuestDB中的一些数据来创建一些可视化和警报。我们可以使用IexFinance API来获取股票价格，并使用一个额外的脚本来生成虚拟数据。IexFinance API在免费账户中每月有50，000个请求的上限，所以我们的模拟脚本可以生成随机价格，这样我们就不会在测试期间耗尽我们的试用。要开始将模拟数据接收到QuestDB中，请运行脚本:</p><pre class="mu mv mw mx fe my mo mz na aw nb bi"><span id="07a4" class="lp jx hy mo b fj nc nd l ne nf"><strong class="mo ii">cd python<br/>python mock_stock_data_example.py</strong></span></pre><p id="8f86" class="pw-post-body-paragraph ko kp hy kq b kr lk ji kt ku ll jl kw kx lm kz la lb ln ld le lf lo lh li lj hb bi translated">该脚本将自动创建一个表<code class="dv ml mm mn mo b"><strong class="kq ii">stock_prices</strong></code> <strong class="kq ii">，</strong>，并开始将模拟数据接收到这个包含三列的表中:</p><ul class=""><li id="a41b" class="mc md hy kq b kr lk ku ll kx me lb mf lf mg lj mh mi mj mk bi translated"><code class="dv ml mm mn mo b"><strong class="kq ii">stock</strong></code>—股票的上市名称，如TSLA代表特斯拉。QuestDB有一个优化的数据类型<code class="dv ml mm mn mo b"><strong class="kq ii">symbol</strong></code>，用于包含重复值的文本列。在<a class="ae hv" href="https://questdb.io/docs/concept/symbol/" rel="noopener ugc nofollow" target="_blank"> QuestDB的官方文档</a>中阅读更多相关内容。</li><li id="4c1d" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj mh mi mj mk bi translated"><code class="dv ml mm mn mo b"><strong class="kq ii">stockPrice</strong></code><strong class="kq ii"/>—<code class="dv ml mm mn mo b"><strong class="kq ii">double</strong></code>中股票的美元价格。</li><li id="8d26" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj mh mi mj mk bi translated"><code class="dv ml mm mn mo b"><strong class="kq ii">createdDateTime</strong></code>—<code class="dv ml mm mn mo b"><strong class="kq ii">timestamp</strong></code><code class="dv ml mm mn mo b"><strong class="kq ii">stockPrice</strong></code>摄入QuestDB的时间。</li></ul><p id="a087" class="pw-post-body-paragraph ko kp hy kq b kr lk ji kt ku ll jl kw kx lm kz la lb ln ld le lf lo lh li lj hb bi translated">在下面的截图中，您可以看到QuestDB中摄取的数据:</p><figure class="mu mv mw mx fe hk es et paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="es et nh"><img src="../Images/95cb1413367c046928f23c189102d0d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XJsBou_q18L6_3-QXK1Rug.png"/></div></div></figure><h2 id="8a1a" class="lp jx hy bd jy lq lr ls kc lt lu lv kg kx lw lx ki lb ly lz kk lf ma mb km ie bi translated">配置<a class="ae hv" href="https://iexcloud.io/console/usage" rel="noopener ugc nofollow" target="_blank"> IexFinance API </a></h2><p id="7154" class="pw-post-body-paragraph ko kp hy kq b kr ks ji kt ku kv jl kw kx ky kz la lb lc ld le lf lg lh li lj hb bi translated">一旦您测试了摄取，您就可以开始使用具有真实数据的API。使用这个API，您可以实时查询股票价格。如前所述，每个月有50000个免费API调用的上限，所以确保你在免费计划中不要超过这个限制。要配置IexFinance API，请按照下列步骤操作:</p><ol class=""><li id="23a2" class="mc md hy kq b kr lk ku ll kx me lb mf lf mg lj ni mi mj mk bi translated">在IexFinance上创建一个免费帐户。</li><li id="e6bc" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj ni mi mj mk bi translated">创建一个API令牌。</li><li id="3eda" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj ni mi mj mk bi translated">按下<code class="dv ml mm mn mo b"><strong class="kq ii">Reveal Secret Token</strong></code>，复制<code class="dv ml mm mn mo b"><strong class="kq ii">SECRET</strong></code> <strong class="kq ii"> </strong>令牌。</li><li id="36ee" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj ni mi mj mk bi translated">在<code class="dv ml mm mn mo b"><strong class="kq ii">./python</strong></code>文件夹中创建一个新文件<code class="dv ml mm mn mo b"><strong class="kq ii">.env</strong></code>。</li><li id="31a8" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj ni mi mj mk bi translated">将令牌粘贴到格式为→ <code class="dv ml mm mn mo b"><strong class="kq ii">IEX_TOKEN=Skwf93hD</strong></code>的<code class="dv ml mm mn mo b"><strong class="kq ii">.env</strong></code>文件中。</li></ol><figure class="mu mv mw mx fe hk es et paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="es et nh"><img src="../Images/c0afd99731a6939945df356a16a07ce8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yQi2I5IcBYGUFMCXRKOwpA.png"/></div></div></figure><h2 id="caef" class="lp jx hy bd jy lq lr ls kc lt lu lv kg kx lw lx ki lb ly lz kk lf ma mb km ie bi translated">配置松弛的传入Webhook</h2><p id="ea62" class="pw-post-body-paragraph ko kp hy kq b kr ks ji kt ku kv jl kw kx ky kz la lb lc ld le lf lg lh li lj hb bi translated">接下来，我们需要创建一个Slack webhook，用于从Grafana发送警告消息:</p><ol class=""><li id="9c8a" class="mc md hy kq b kr lk ku ll kx me lb mf lf mg lj ni mi mj mk bi translated">转到<code class="dv ml mm mn mo b"><a class="ae hv" href="https://api.slack.com/apps?new_app=1" rel="noopener ugc nofollow" target="_blank"><strong class="kq ii">https://api.slack.com/apps?new_app=1</strong></a></code></li><li id="3b86" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj ni mi mj mk bi translated">将你的Slack应用命名为<code class="dv ml mm mn mo b"><strong class="kq ii">QuestDB Stock Price Alerts</strong></code></li><li id="f533" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj ni mi mj mk bi translated">在<code class="dv ml mm mn mo b"><strong class="kq ii">Features and functionality</strong></code>中选择<em class="nj">入网挂钩</em></li><li id="7851" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj ni mi mj mk bi translated">激活传入的webhooks并点击<code class="dv ml mm mn mo b"><strong class="kq ii">Add New Webhook to Workspace</strong></code></li><li id="a43b" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj ni mi mj mk bi translated">选择允许应用程序发布的频道，然后单击<code class="dv ml mm mn mo b"><strong class="kq ii">Allow</strong></code></li><li id="48f2" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj ni mi mj mk bi translated">复制以下格式的web hook URL→<code class="dv ml mm mn mo b"><a class="ae hv" href="https://hooks.slack.com/services/T123/B0123/2Fb" rel="noopener ugc nofollow" target="_blank"><strong class="kq ii">https://hooks.slack.com/services/T123/B0123/2Fb</strong></a><strong class="kq ii">...</strong></code></li></ol><h2 id="127f" class="lp jx hy bd jy lq lr ls kc lt lu lv kg kx lw lx ki lb ly lz kk lf ma mb km ie bi translated">在Grafana中创建通知渠道</h2><p id="9d43" class="pw-post-body-paragraph ko kp hy kq b kr ks ji kt ku kv jl kw kx ky kz la lb lc ld le lf lg lh li lj hb bi translated">在浏览器中转至<code class="dv ml mm mn mo b"><strong class="kq ii">localhost:3000</strong></code>。要启用Grafana和Slack之间的连接以进行报警，请单击<code class="dv ml mm mn mo b"><strong class="kq ii">Alerting &gt; Notification channels</strong></code> <strong class="kq ii"> </strong>部分中的<code class="dv ml mm mn mo b"><strong class="kq ii">Add Channel</strong></code>，如下所示:</p><figure class="mu mv mw mx fe hk es et paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="es et nk"><img src="../Images/82df9a0e324bbc79083157d77df25144.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A695A1X6-Bh5LBjOpjFY8Q.png"/></div></div></figure><p id="2fb3" class="pw-post-body-paragraph ko kp hy kq b kr lk ji kt ku ll jl kw kx lm kz la lb ln ld le lf lo lh li lj hb bi translated">创建新的通知渠道时，将时差<code class="dv ml mm mn mo b"><strong class="kq ii">Incoming Webhook URL</strong></code> <strong class="kq ii"> </strong>粘贴到<code class="dv ml mm mn mo b"><strong class="kq ii">Url</strong></code> <strong class="kq ii"> </strong>字段，如下图所示:</p><figure class="mu mv mw mx fe hk es et paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="es et nk"><img src="../Images/1d937434fce188dfd9e493c4ced3c70f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pTRITm0iRTTVxds406YKEw.png"/></div></div></figure><p id="2753" class="pw-post-body-paragraph ko kp hy kq b kr lk ji kt ku ll jl kw kx lm kz la lb ln ld le lf lo lh li lj hb bi translated">您可以通过按下上面屏幕上的<code class="dv ml mm mn mo b"><strong class="kq ii">Test</strong></code> <strong class="kq ii"> </strong>按钮快速测试webhook是否工作正常。这将触发Grafana在Slack上发布通知。您可以在下面看到一个通知示例:</p><figure class="mu mv mw mx fe hk es et paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="es et nl"><img src="../Images/782148758a7a414b9c2f74b45de12790.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zCMwWvLYa3hGTVMXiDuH6w.png"/></div></div></figure><h2 id="349f" class="lp jx hy bd jy lq lr ls kc lt lu lv kg kx lw lx ki lb ly lz kk lf ma mb km ie bi translated">创建一个Grafana面板并设置警报</h2><p id="2fb1" class="pw-post-body-paragraph ko kp hy kq b kr ks ji kt ku kv jl kw kx ky kz la lb lc ld le lf lg lh li lj hb bi translated"><a class="ae hv" href="https://grafana.com/docs/grafana/latest/panels/add-a-panel/" rel="noopener ugc nofollow" target="_blank">使用以下步骤设置一个Grafana面板</a>来托管<code class="dv ml mm mn mo b"><strong class="kq ii">TSLA</strong></code> <strong class="kq ii"> </strong>股票价格的实时图形:</p><ol class=""><li id="2c90" class="mc md hy kq b kr lk ku ll kx me lb mf lf mg lj ni mi mj mk bi translated">导航至<code class="dv ml mm mn mo b"><strong class="kq ii">+</strong></code> <code class="dv ml mm mn mo b"><strong class="kq ii">Create and select Dashboard</strong></code></li><li id="e1b9" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj ni mi mj mk bi translated">点击<code class="dv ml mm mn mo b"><strong class="kq ii">+</strong></code> <code class="dv ml mm mn mo b"><strong class="kq ii">Add new panel</strong></code></li><li id="7f95" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj ni mi mj mk bi translated">在面板中，单击铅笔图标或单击<code class="dv ml mm mn mo b"><strong class="kq ii">Edit SQL</strong></code>并粘贴以下示例查询:</li></ol><figure class="mu mv mw mx fe hk"><div class="bz dz l di"><div class="nm nn l"/></div></figure><figure class="mu mv mw mx fe hk es et paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="es et nh"><img src="../Images/36ae2127a5663673abfeef9a666cb730.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S1Je8i24VIIEUvjxURJh-Q.png"/></div></div></figure><p id="4323" class="pw-post-body-paragraph ko kp hy kq b kr lk ji kt ku ll jl kw kx lm kz la lb ln ld le lf lo lh li lj hb bi translated">使用上图所示的查询创建Grafana面板后。保存仪表板。要创建关于<strong class="kq ii"> TSLA </strong>股票价格的警报，请执行以下步骤:</p><ol class=""><li id="d2c5" class="mc md hy kq b kr lk ku ll kx me lb mf lf mg lj ni mi mj mk bi translated">编辑仪表板中的面板。</li><li id="5feb" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj ni mi mj mk bi translated">转到<code class="dv ml mm mn mo b"><strong class="kq ii">Alert</strong></code>选项卡，将警报命名为<code class="dv ml mm mn mo b"><strong class="kq ii">Tesla Stock Price alert</strong></code>。</li><li id="3f4d" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj ni mi mj mk bi translated">将<code class="dv ml mm mn mo b"><strong class="kq ii">Evaluate every</strong></code> <strong class="kq ii"> </strong>设置为10秒<code class="dv ml mm mn mo b"><strong class="kq ii">for</strong></code> 30秒(<code class="dv ml mm mn mo b"><strong class="kq ii">Evaluate every</strong></code>表示调度程序评估预警规则的频率，而<code class="dv ml mm mn mo b"><strong class="kq ii">for</strong></code> <strong class="kq ii"> </strong>指定在触发预警通知之前查询需要违反阈值多长时间)。</li><li id="7ab6" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj ni mi mj mk bi translated">将条件设置为<code class="dv ml mm mn mo b"><strong class="kq ii">WHEN min() OF query(5-second Avg. of TSLA, 30s, now() IS BELOW</strong></code> <strong class="kq ii"> </strong> 762。换句话说，如果名为<code class="dv ml mm mn mo b"><strong class="kq ii">5-second Avg. of TSLA</strong></code>的查询的最小值在过去30秒内低于762，则满足警报条件。</li><li id="dfc1" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj ni mi mj mk bi translated">在<code class="dv ml mm mn mo b"><strong class="kq ii">No Data &amp; Error Handling</strong></code>部分，使用默认值。</li><li id="0591" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj ni mi mj mk bi translated">在<code class="dv ml mm mn mo b"><strong class="kq ii">Notifications → Send to</strong></code>中，选择我们之前设置的通知渠道，名为股票价格警报。</li><li id="115a" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj ni mi mj mk bi translated">添加消息<code class="dv ml mm mn mo b"><strong class="kq ii">The 5-second bucketed average of TSLA stock price has gone below 762 in the last 30 seconds</strong></code>。</li><li id="48bc" class="mc md hy kq b kr mp ku mq kx mr lb ms lf mt lj ni mi mj mk bi translated">保存面板。</li></ol><p id="38cc" class="pw-post-body-paragraph ko kp hy kq b kr lk ji kt ku ll jl kw kx lm kz la lb ln ld le lf lo lh li lj hb bi translated">您可以在下面看到实际操作步骤:</p><figure class="mu mv mw mx fe hk es et paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="es et nk"><img src="../Images/ec86bf3e59eabbcace427a6f560a3377.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lzbcXtf1FiPdudBwqVxiMQ.png"/></div></div></figure><p id="a201" class="pw-post-body-paragraph ko kp hy kq b kr lk ji kt ku ll jl kw kx lm kz la lb ln ld le lf lo lh li lj hb bi translated">一旦满足条件，Grafana就会触发警报，并向Slack发送通知。通知类似于下面的截图:</p><figure class="mu mv mw mx fe hk es et paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="es et no"><img src="../Images/27f3d43a0bce0f86d24ff3eca10ce7a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XHsRsW0Aj-z5zjcjiR6-iw.png"/></div></div></figure><p id="7da2" class="pw-post-body-paragraph ko kp hy kq b kr lk ji kt ku ll jl kw kx lm kz la lb ln ld le lf lo lh li lj hb bi translated">要更深入地了解警报状态的变化，可以访问<code class="dv ml mm mn mo b"><strong class="kq ii">State history</strong></code>。它将向您展示从一种状态到另一种状态的转换时间表。您可以在下面看到一个州历史示例:</p><figure class="mu mv mw mx fe hk es et paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="es et nh"><img src="../Images/4378db4b84eb7d6866acc9078713a025.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4yFKgawD9pFYkmY-BqzVrw.png"/></div></div></figure><p id="e85f" class="pw-post-body-paragraph ko kp hy kq b kr lk ji kt ku ll jl kw kx lm kz la lb ln ld le lf lo lh li lj hb bi translated">要了解更多关于使用Grafana为时间序列数据构建仪表板的信息，QuestDB网站上有另一个教程，其中有一个到示例数据的链接，可以详细尝试更多功能。</p><div class="hh hi fa fc hj np"><a href="https://questdb.io/tutorial/2020/10/19/grafana/" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab dx"><div class="nr ab ns cl cj nt"><h2 class="bd ii fj z dz nu eb ec nv ee eg ih bi translated">使用QuestDB和Grafana |时间序列数据更快地构建监控仪表板</h2><div class="nw l"><h3 class="bd b fj z dz nu eb ec nv ee eg dy translated">在本教程中，我们将介绍如何从加载演示数据。CSV文件导入QuestDB，并以此作为数据源…</h3></div><div class="nx l"><p class="bd b fq z dz nu eb ec nv ee eg dy translated">questdb.io</p></div></div><div class="ny l"><div class="nz l oa ob oc ny od hp np"/></div></div></a></div><h1 id="1b0f" class="jw jx hy bd jy jz ka kb kc kd ke kf kg jn kh jo ki jq kj jr kk jt kl ju km kn bi translated">结论</h1><p id="6824" class="pw-post-body-paragraph ko kp hy kq b kr ks ji kt ku kv jl kw kx ky kz la lb lc ld le lf lg lh li lj hb bi translated">在本教程中，您了解了Grafana如何使用PostgreSQL端点与QuestDB融合。使用从API获取到QuestDB的数据，您了解了如何在Grafana仪表板中可视化该数据，并基于一些预定义的条件设置警报。您还学习了如何向Slack等外部工具发布警报消息。有关本教程中任何主题的更多信息，请访问<a class="ae hv" href="https://questdb.io/docs/introduction/" rel="noopener ugc nofollow" target="_blank"> QuestDB的官方文档</a>。</p></div></div>    
</body>
</html>