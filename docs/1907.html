<html>
<head>
<title>[Part-1] Building RESTful API’s for complete beginners.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">[第1部分]为完全初学者构建RESTful API。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/building-restful-apis-for-complete-beginners-e1dfda170677?source=collection_archive---------9-----------------------#2021-03-25">https://medium.com/analytics-vidhya/building-restful-apis-for-complete-beginners-e1dfda170677?source=collection_archive---------9-----------------------#2021-03-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="9ac5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你曾经做过任何类型的数据分析或工程工作，那么你很可能使用过API来获取数据。今天我想探讨API是如何实际构建和部署的，以及它们设计背后的一些原则，尤其是在REST范式下。</p><p id="0b3c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可能知道，API代表应用程序编程接口。API的全部目的是通过创建一个易于使用的界面来简化软件系统的使用。通过这种方式，我们可以依赖软件的功能，而不必了解其代码和数据的具体细节。API几乎可以被认为是一种终端用户产品，除了它们更多的是面向开发者而不是消费者。API是特定软件应用程序和领域的高级抽象，因此它们的使用无处不在。</p><p id="7c4f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通常，API的使用模式如下:用户向API提交一些数据，API使用这些输入数据来生成/检索一些其他数据，并将结果数据输出回用户。如果你仔细想想，这真的是大多数计算归结为什么。你把数据输入电脑，就能得到结果。您将数据提供给一个函数，它在执行代码后返回一些值。如果您曾经使用过API，您可以看到相同的原理:您指定一些端点和查询，API为您提供一些数据。</p><p id="42ce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是你想做你自己的API！也许你开发了一个擅长预测的机器学习模型。现在您希望在线部署它，以便其他人可以向您的模型提交一些数据并检索预测。或者，您可能希望以一种便于人们访问、搜索和过滤的方式共享数据。这些是构建API的典型用例。</p><p id="6230" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">API运行在客户机-服务器模型上。客户端(即用户)通过互联网(HTTP)向运行我们的API程序的服务器发送请求，服务器处理请求，生成输出，并将其发送回用户。有许多框架用于构建web应用程序，但我将重点介绍如何使用Flask。Flask是一个基于python的web框架，相对轻量级且易于学习，同时功能强大且特性丰富。我们还将使用Flask-RESTful库，这是一个Flask扩展，专门用于构建RESTful应用程序。</p><p id="344f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要开始制作Flask powered API，请使用一个干净的virtualenv启动一个干净的存储库。然后，运行“pip安装flask”和“pip安装flask-RESTful”。然后，在您的根文件夹中创建一个名为app.py的文件。这是我们将为API本身编写代码的地方。</p><p id="1006" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是您的代码开始时的样子:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/d8e85c9ae1065a1ea773842643ed517e.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*6R7PXP3m74Qf3RUrQ6tFfw.png"/></div></figure><p id="c5ee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我们进口烧瓶。在第3行中，我们必须包含app = Flask(__name__)行。这是所有Flask应用程序中都包含的标准行。它实例化为Flask对象，这就是我们的应用程序的实际情况。然后，它将模块的__name__变量传递给Flask对象。回想一下，在运行时分配给我们的模块的__name__可能是不同的，这取决于该模块是直接从命令行执行的还是导入的。对于Flask来说，以这种方式指定模块来正确地创建模板、静态文件等等是很重要的。</p><p id="2151" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后从Flask_restful导入Api和资源。Api是Flask-RESTful用来实现API的核心类。我们在Flask之后实例化它，并向它传递我们实例化前一行的Flask应用程序(“app”)。通过这种方式，我们向Flask应用程序添加了一种层，使我们能够更好地将其构建为API。虽然理论上单独使用Flask实现API是可能的，但是Flask-RESTful API使我们更容易，同时更好地符合REST范式下的最佳实践。</p><p id="9f61" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们实际构建API的方式是定义“端点”并告诉Flask如何路由和处理对这些端点的请求。这主要是通过向我们的API添加“资源”来完成的，然后可以通过访问端点来访问这些资源。资源是一段代码，它可以响应对我们的API的请求，并作为响应提供新的数据。为了创建这些资源，我们必须创建从flask_restful导入的“resource”类的子类，并定义get、post和类似的对应于HTTP请求类型的方法。然后，我们必须将资源添加到API的资源集合中。</p><p id="ec02" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们来看看如何对此进行编码:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jk"><img src="../Images/9d8d20ea3cf5abe7f0e3bb4f3a16f362.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*Cfh1Wx7Mh5VF0fd_iCXfTA.png"/></div></figure><p id="fb55" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我们创建了一个记录字典，它将作为我们的测试数据库，以确保我们的API是否正常工作。关键字代表动物，值代表动物的类型。</p><p id="1ac1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后我们创建了一个名为Creature的新类，并传入了Resource类，让python知道我们的类是继承Resource类的所有方法和属性。我们需要这样做，以便让Flask-RESTful将我们的逻辑集成到它的框架中，并将我们的子类转换成可由服务器和库处理的资源。</p><p id="1bc3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Creatures接受一个名为“name”的变量，它实现了一个方法。这是get方法。我们将在后面的文章中深入讨论各种类型的请求，但现在只需要知道，当您向API提交url以在浏览器中检索信息时，从浏览器发送到服务器的请求类型是“GET”类型的请求。这是一组标准类型的服务器请求之一，还包括POST、PUT、DELETE等等。每个资源类型类必须包含一个对应于可以转发给它的每种请求类型的方法。因为我们的类现在只接受get请求，所以我们只定义GET方法。</p><p id="3e9e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将我们的资源类集成到运行的API中是通过倒数第二行实现的。我们调用api对象上的add_resource方法，并传入我们的Creature类以及它应该响应的端点的字符串表示。这就是“‘/生物/ <name>”。这个字符串告诉flask_restful哪个端点指向我们传入的资源，也就是说，用户必须传入的URL类型才能到达那个资源。此外，我们可以告诉flask_restful注意用户可能使用所示的<name>语法传入的变量。这告诉flask_restful，用户可以传入他们选择的字符串，flask将把这个字符串存储在名为“name”的变量中，然后将这个变量转发给Creature类。</name></name></p><p id="48af" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，您所要做的就是转到您的终端，确保您位于包含“app.py”文件的存储库的根文件夹中，然后运行命令“python app.py”。您将看到如下输出:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jl"><img src="../Images/e28deae3d3cc7b2d7766d8940d1430e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DKvnNfDg2vSEA2QYlLZmAw.png"/></div></div></figure><p id="495b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">继续点击最后一行中url。当它在浏览器中打开时，如果您看到“未找到”错误消息，请不要担心。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jm jn di jo bf jp"><div class="er es jq"><img src="../Images/8bc4ea3d1b22c92685062c05af6cf032.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XX8-sHG0WBC7TyNnHXfA8w.png"/></div></div></figure><p id="60a8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你得到这个的原因是因为我们没有真正告诉flask或flask_restful处理对根url的请求，当你点击链接时，你的浏览器提交一个get请求到那个链接，但是因为我们的服务器不知道如何处理它，我们得到一个错误。但是，如果您在url的末尾添加“生物/猫”,您应该会看到:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jr"><img src="../Images/b25b99cd5e252a6c12c0f7bdffb9795c.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*TaOfSB1_HimYay6B7RvYYg.png"/></div></figure><p id="c35f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">瞧啊。我们有一个可用的API。</p><p id="660e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们对API的工作原理以及如何开始构建有了基本的了解。但是，您一定已经意识到，像我们在这里所做的那样将数据存储在内存字典中，在任何规模下都不是一个可行的解决方案。但是你可以看到我们的前进方向:现在我们知道如何创建资源来传递数据和路由端点到它们，天空是无限的。我们可以开始在我们的资源中使用JSON文件或SQL数据库。但那是以后的事了。</p><p id="354a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下周继续收听，我们将深入探讨不同类型的请求以及我们如何处理它们。</p></div></div>    
</body>
</html>