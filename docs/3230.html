<html>
<head>
<title>Simple CNN using NumPy: Part I (Introduction &amp; Data Processing)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用NumPy的简单CNN:第一部分(简介和数据处理)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/simple-cnn-using-numpy-part-i-introduction-data-processing-b6652615604d?source=collection_archive---------3-----------------------#2021-06-20">https://medium.com/analytics-vidhya/simple-cnn-using-numpy-part-i-introduction-data-processing-b6652615604d?source=collection_archive---------3-----------------------#2021-06-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div class="er es hf"><img src="../Images/69c29457efab1e78ebcba171c589b704.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*noL5Bt0f-OHu-9D4RmKIzw.png"/></div></figure><div class=""/><h1 id="c384" class="il im ho bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">介绍</h1><p id="25c6" class="pw-post-body-paragraph jj jk ho jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">卷积神经网络(CNN)是一类能够很好地处理网格状数据(如图像)的神经网络。它们从图像中提取有用的特征，使图像识别过程更加鲁棒。这些网络的灵感来自于<strong class="jl hp">大卫·亨特·休伯尔&amp;托斯坦·维厄·瑟尔</strong>的实验结果，他们观察了猫的大脑对不同方向的直线的不同神经活动。</p><h2 id="432d" class="kh im ho bd in ki kj kk ir kl km kn iv ju ko kp iz jy kq kr jd kc ks kt jh ku bi translated">第一卷积网络</h2><p id="20ee" class="pw-post-body-paragraph jj jk ho jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">第一个卷积神经网络是由Kunihiko Fukushima博士在1980年实现的<a class="ae kv" href="http://www.scholarpedia.org/article/Neocognitron" rel="noopener ugc nofollow" target="_blank"> Neocognitron </a>。该系统使用分层结构来学习图像的简单&amp;复杂特征。使用无监督学习程序来识别手写字符。</p><p id="0e30" class="pw-post-body-paragraph jj jk ho jl b jm kw jo jp jq kx js jt ju ky jw jx jy kz ka kb kc la ke kf kg ha bi translated">Yann LeCun博士和他的团队在20世纪90年代改进了这些想法，包括反向传播来识别手写邮政编码(<a class="ae kv" href="http://yann.lecun.com/exdb/lenet/" rel="noopener ugc nofollow" target="_blank"> Le-Net5 </a>)。这些类型的实现已经导致图像识别任务的显著改进。</p><p id="475e" class="pw-post-body-paragraph jj jk ho jl b jm kw jo jp jq kx js jt ju ky jw jx jy kz ka kb kc la ke kf kg ha bi translated">CNN具有从图像中检测有用特征(边缘、水平线、垂直线、曲率等)的能力，这类似于大脑中针对图像的不同方向的不同神经元放电。卷积层使这一特性成为可能。</p><p id="82fb" class="pw-post-body-paragraph jj jk ho jl b jm kw jo jp jq kx js jt ju ky jw jx jy kz ka kb kc la ke kf kg ha bi translated">大卫·亨特·休伯尔&amp;托斯坦·维厄·瑟尔的实验可以在下面的Youtube视频中找到</p><figure class="lb lc ld le fd hj"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="7cf9" class="pw-post-body-paragraph jj jk ho jl b jm kw jo jp jq kx js jt ju ky jw jx jy kz ka kb kc la ke kf kg ha bi translated">在这一系列文章中，我将尝试使用NumPy实现一个基本的卷积神经网络。</p><h1 id="6561" class="il im ho bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">输入数据</h1><p id="d39d" class="pw-post-body-paragraph jj jk ho jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">这里使用的输入将是来自<a class="ae kv" href="https://www.kaggle.com/c/Kannada-MNIST" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>中的卡纳达数字MNIST数据库的卡纳达数字。卡纳达语是一种达罗毗荼语，有超过4500万人使用。卡纳达语的数字如下:</p><figure class="lb lc ld le fd hj er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lh"><img src="../Images/feac5f98d374b2931288e9b18f1ff130.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f2po8qPm5Kyd5_tQD-NmHA.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated"><strong class="bd in">从0到9的卡纳达数字</strong></figcaption></figure><h2 id="3921" class="kh im ho bd in ki kj kk ir kl km kn iv ju ko kp iz jy kq kr jd kc ks kt jh ku bi translated">输入数据处理</h2><p id="f3cb" class="pw-post-body-paragraph jj jk ho jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">输入来源于CSV文件，该文件包含图像的展平版本。数据预处理包括将这些条目中的每一个转换成像素值的28×28阵列。</p><figure class="lb lc ld le fd hj er es paragraph-image"><div class="er es lq"><img src="../Images/a59f718f46a4889c9d0a128feb55bcc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*xVuk3_C5RMar40GE5PxrmA.png"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated"><strong class="bd in">每个条目(行)被转换成一个28×28的数组</strong></figcaption></figure><p id="6cb9" class="pw-post-body-paragraph jj jk ho jl b jm kw jo jp jq kx js jt ju ky jw jx jy kz ka kb kc la ke kf kg ha bi translated">下面的代码创建了训练数据集</p><pre class="lb lc ld le fd lr ls lt lu aw lv bi"><span id="6db0" class="kh im ho ls b fi lw lx l ly lz">import pandas as pd<br/>import numpy as np<br/><br/><br/>np.random.seed(42)<br/>## import data set</span><span id="83b6" class="kh im ho ls b fi ma lx l ly lz">data = pd.read_csv('../input/Kannada-MNIST/train.csv')<br/>data['row_number'] = range(0,data.shape[0])<br/>## Shuffling the data<br/>data = data.sample(frac=1,random_state=42)<br/>tmp = pd.DataFrame()<br/>## Getting a balanced dataset with 600 entries per class</span><span id="5cbc" class="kh im ho ls b fi ma lx l ly lz">for label <strong class="ls hp">in</strong> range(10):<br/>    if label==0:<br/>        tmp = data[data['label']==label].head(600)<br/>    else:<br/>        temp = data[data['label']==label].head(600)<br/>        tmp = pd.concat([tmp,temp])<br/>data_train = tmp<br/>row_numbers_in_train_set = tmp['row_number'].values<br/>test_set = data.loc[~data['row_number'].isin(row_numbers_in_train_set)]<br/>## Create one hot encoding<br/>one_hot = pd.get_dummies(data_train['label'].unique())<br/>one_hot['label'] = one_hot.index<br/><br/>data_train = pd.merge(data_train,one_hot)<br/>data_test = test_set.sample(frac=1)<br/>tmp = pd.DataFrame()<br/>## Getting a balanced test set with 120 entries per class</span><span id="40ae" class="kh im ho ls b fi ma lx l ly lz">for label <strong class="ls hp">in</strong> range(10):<br/>    if label==0:<br/>        tmp = data_test[data_test['label']==label].head(120)<br/>    else:<br/>        temp = data_test[data_test['label']==label].head(120)<br/>        tmp = pd.concat([tmp,temp])<br/>data_test = tmp<br/>data_test = pd.merge(data_test,one_hot)<br/>data_train.drop('label',axis=1,inplace=True)<br/><br/>data_test.drop('label',axis=1,inplace=True)<br/><br/><em class="mb">## Create the train and test set and normalize the inputs</em><br/>X_train = np.array(data_train.drop([0,1,2,3,4,5,6,7,8,9,'row_number'],axis=1).values)/255<br/>y_train = np.array(data_train[[0,1,2,3,4,5,6,7,8,9]].values)<br/>X_test = np.array(data_test.drop([0,1,2,3,4,5,6,7,8,9,'row_number'],axis=1).values)/255<br/>y_test = np.array(data_test[[0,1,2,3,4,5,6,7,8,9]].values)</span></pre><p id="8980" class="pw-post-body-paragraph jj jk ho jl b jm kw jo jp jq kx js jt ju ky jw jx jy kz ka kb kc la ke kf kg ha bi translated">导入展平的数据以创建6000个条目的训练数据集和1000个条目的测试数据集。这些像素条目的范围从0到255(灰度)。这些条目通过除以最大值(255)来标准化。</p><p id="fa7d" class="pw-post-body-paragraph jj jk ho jl b jm kw jo jp jq kx js jt ju ky jw jx jy kz ka kb kc la ke kf kg ha bi translated">输出类被更改为独热编码表示。</p><p id="eb77" class="pw-post-body-paragraph jj jk ho jl b jm kw jo jp jq kx js jt ju ky jw jx jy kz ka kb kc la ke kf kg ha bi translated">下面将输入向量重新整形为28X28 NumPy数组</p><pre class="lb lc ld le fd lr ls lt lu aw lv bi"><span id="7052" class="kh im ho ls b fi lw lx l ly lz">X_train = X_train.T<br/>y_train = y_train.T<br/><br/>X_test = X_test.T<br/>y_test = y_test.T<br/>X_train_reshape = np.zeros((X_train.shape[1],1,28,28))<br/><br/>for i <strong class="ls hp">in</strong> range(X_train.shape[1]):<br/>    temp = X_train[:,i]<br/>    temp = np.ravel(temp)<br/>    temp = temp.reshape(28,28)<br/>    X_train_reshape[i,0,:,:] = temp<br/>    <br/>X_train= X_train_reshape  <br/><br/>X_test_reshape = np.zeros((X_test.shape[1],1,28,28))<br/><br/>from matplotlib import pyplot as plt<br/><br/>for i <strong class="ls hp">in</strong> range(X_test.shape[1]):<br/>    temp = X_test[:,i]<br/>    temp = np.ravel(temp)<br/>    temp = temp.reshape(28,28)<br/>    X_test_reshape[i,0,:,:] = temp<br/><br/>X_test= X_test_reshape</span></pre><p id="f431" class="pw-post-body-paragraph jj jk ho jl b jm kw jo jp jq kx js jt ju ky jw jx jy kz ka kb kc la ke kf kg ha bi translated">一些重新成形的阵列如下</p><figure class="lb lc ld le fd hj er es paragraph-image"><div class="er es mc"><img src="../Images/ef471f7a18866d5056fd38e65c87adbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*HJQGKhibv2tc251cvbVYuQ.png"/></div><figcaption class="lm ln et er es lo lp bd b be z dx">0</figcaption></figure><figure class="lb lc ld le fd hj er es paragraph-image"><div class="er es md"><img src="../Images/7005fb6a04c69ddeed0e383f0cb30430.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*SZ65nNEJQieDY53itsP0UQ.png"/></div><figcaption class="lm ln et er es lo lp bd b be z dx">1</figcaption></figure><figure class="lb lc ld le fd hj er es paragraph-image"><div class="er es me"><img src="../Images/3c5a11cb1f4dfd85dc6b2a515195b2f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*mxbOXqbpk6cggjOLfJbAww.png"/></div><figcaption class="lm ln et er es lo lp bd b be z dx">8</figcaption></figure><figure class="lb lc ld le fd hj er es paragraph-image"><div class="er es hf"><img src="../Images/b50d9b3b815a314def60a6af9b28fa3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*EEFoFFQXh_T2g9hmrdAVIw.png"/></div><figcaption class="lm ln et er es lo lp bd b be z dx">9</figcaption></figure><p id="6bb3" class="pw-post-body-paragraph jj jk ho jl b jm kw jo jp jq kx js jt ju ky jw jx jy kz ka kb kc la ke kf kg ha bi translated">在处理之后，输入训练数据集现在具有维度(6000，1，28，28)，而测试数据具有维度(1000，1，28，28)。</p><figure class="lb lc ld le fd hj er es paragraph-image"><div class="er es mf"><img src="../Images/6b440171b84d1d18c724fbb873588b8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*Lu23BNF54DvnUpG0nqk4KA.png"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated"><strong class="bd in">尺寸&amp;含义</strong></figcaption></figure><h1 id="e230" class="il im ho bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">CNN架构</h1><p id="c4e8" class="pw-post-body-paragraph jj jk ho jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">在数据处理之后，NumPy阵列形式的图像通过如下一系列层。</p><p id="4523" class="pw-post-body-paragraph jj jk ho jl b jm kw jo jp jq kx js jt ju ky jw jx jy kz ka kb kc la ke kf kg ha bi translated">假设我们正在传递一个维数为(1，1，28，28)的图像。神经网络的结构将如下</p><ul class=""><li id="7a99" class="mg mh ho jl b jm kw jq kx ju mi jy mj kc mk kg ml mm mn mo bi translated">输入层(1，1，28，28)</li><li id="211d" class="mg mh ho jl b jm mp jq mq ju mr jy ms kc mt kg ml mm mn mo bi translated">卷积滤波器(2，1，5，5)</li><li id="ea52" class="mg mh ho jl b jm mp jq mq ju mr jy ms kc mt kg ml mm mn mo bi translated">最大池层(2x2)</li><li id="73d4" class="mg mh ho jl b jm mp jq mq ju mr jy ms kc mt kg ml mm mn mo bi translated">全连接层(1，288)</li><li id="8e9c" class="mg mh ho jl b jm mp jq mq ju mr jy ms kc mt kg ml mm mn mo bi translated">第二完全连接层(1，60)</li><li id="beb8" class="mg mh ho jl b jm mp jq mq ju mr jy ms kc mt kg ml mm mn mo bi translated">输出层(1，10)</li></ul><figure class="lb lc ld le fd hj er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mu"><img src="../Images/b5485ee681e7c90a9a0d2164873cd28e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y4SqJA-xOC2Itbro0DOEuA.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">紫色的尺寸是经过每个相应的处理阶段后图像的最终尺寸</figcaption></figure><p id="aad4" class="pw-post-body-paragraph jj jk ho jl b jm kw jo jp jq kx js jt ju ky jw jx jy kz ka kb kc la ke kf kg ha bi translated">上图显示了网络的大致“蓝图”。我将在下一篇文章中解释卷积滤波器和卷积运算。</p><p id="13ea" class="pw-post-body-paragraph jj jk ho jl b jm kw jo jp jq kx js jt ju ky jw jx jy kz ka kb kc la ke kf kg ha bi translated">感谢阅读！如有反馈/疑问，请随时给我发电子邮件至padhokshaja@gmail.com。我会尽我所能回到他们身边。</p><h1 id="8713" class="il im ho bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">资源</h1><ul class=""><li id="b203" class="mg mh ho jl b jm jn jq jr ju mv jy mw kc mx kg ml mm mn mo bi translated"><a class="ae kv" href="http://yann.lecun.com/exdb/lenet/" rel="noopener ugc nofollow" target="_blank"> LeNet-5 </a></li><li id="2ff9" class="mg mh ho jl b jm mp jq mq ju mr jy ms kc mt kg ml mm mn mo bi translated"><a class="ae kv" href="https://en.wikipedia.org/wiki/Neocognitron#:~:text=The%20neocognitron%20is%20a%20hierarchical,inspiration%20for%20convolutional%20neural%20networks." rel="noopener ugc nofollow" target="_blank">新克隆体</a></li><li id="3b30" class="mg mh ho jl b jm mp jq mq ju mr jy ms kc mt kg ml mm mn mo bi translated">CNN的CS231n讲座</li></ul><h1 id="6d1d" class="il im ho bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">下一篇文章</h1><p id="6d02" class="pw-post-body-paragraph jj jk ho jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated"><a class="ae kv" rel="noopener" href="/@PAdhokshaja/simple-cnn-using-numpy-part-ii-convolution-operation-b8c5a02b0844">卷积运算</a></p></div></div>    
</body>
</html>