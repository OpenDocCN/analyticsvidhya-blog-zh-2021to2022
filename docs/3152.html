<html>
<head>
<title>Live video chat app using open cv2 Python module.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用开放式cv2 Python模块的视频直播聊天应用。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/live-video-chat-app-using-open-cv2-python-module-2c6232d88732?source=collection_archive---------4-----------------------#2021-06-12">https://medium.com/analytics-vidhya/live-video-chat-app-using-open-cv2-python-module-2c6232d88732?source=collection_archive---------4-----------------------#2021-06-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/9a17f4ffb101b79235fedf36c8c1613d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*17_Zy1E4px73q3xPLfckjg.png"/></div></div></figure><p id="dc02" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">该任务的目的是在服务器和客户端之间进行视频通话，因此为此，我们需要制作一个服务器和客户端。</p><h2 id="d8b6" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated"><strong class="ak">创建服务器端脚本</strong></h2><p id="67a0" class="pw-post-body-paragraph ip iq hh ir b is ki iu iv iw kj iy iz ja kk jc jd je kl jg jh ji km jk jl jm ha bi translated">首先我们必须导入<strong class="ir hi"> socket </strong>，cv2，<strong class="ir hi"> pickle </strong>，<strong class="ir hi"> struct </strong>和<strong class="ir hi"> imutils </strong>库。</p><blockquote class="kn ko kp"><p id="c078" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">导入套接字，cv2，pickle，struct，imutils</p></blockquote><p id="3c13" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">现在我们必须创建一个套接字</strong></p><blockquote class="kn ko kp"><p id="db84" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated"><em class="hh">server _ socket = socket . socket(socket。AF_INET，socket。SOCK _ STREAM)<br/>host _ name = socket . gethostname()<br/>host _ IP = socket . gethostbyname(host _ name)<br/>port = 9999<br/>socket _ address =(host _ IP，port) </em></p></blockquote><p id="c592" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">捆绑插座</strong></p><blockquote class="kn ko kp"><p id="c4d4" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">server_socket.bind(套接字地址)</p></blockquote><p id="df98" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">插座监听</strong></p><blockquote class="kn ko kp"><p id="8ce9" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">虽然正确:</p><p id="2709" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">客户端套接字，地址=服务器套接字.接受()</p><p id="1843" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">打印('连接来自:'，地址)</p><p id="a3e5" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">如果客户端套接字:</p><p id="663e" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">vid = cv2。视频捕获(0)</p><p id="d6f5" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">while(vid.isOpened()):</p><p id="8e42" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">img，frame = vid.read()</p><p id="f58a" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">frame = imutils.resize(frame，width=680)</p><p id="d70d" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">a = pickle . dumps(frame)message = struct . pack(" Q "，len(a))+a</p><p id="14cb" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">client_socket.sendall(消息)</p><p id="5c45" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">cv2.imshow('传输视频'，帧)</p><p id="b32c" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">key = cv2.waitKey(1) &amp; 0xFF</p><p id="b920" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">如果key ==13或key ==113或key==81: msg="q "</p><p id="6f63" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">client_socket.send(msg.encode()</p><p id="965b" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">client _套接字. close()</p><p id="3159" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">cv2.destroyAllWindows()</p></blockquote><p id="771c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我们已经创建了一个服务器端套接字。</p><h2 id="e1ba" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">创建客户端脚本</h2><p id="a4bd" class="pw-post-body-paragraph ip iq hh ir b is ki iu iv iw kj iy iz ja kk jc jd je kl jg jh ji km jk jl jm ha bi translated">所以作为服务器端套接字，我们必须导入python库</p><blockquote class="kn ko kp"><p id="da10" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">导入套接字，cv2，pickle，struct，imutils</p></blockquote><p id="fb6e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">现在我们可以创建我们的客户端套接字</strong></p><blockquote class="kn ko kp"><p id="b590" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">client _ socket = socket . socket(socket。AF_INET，socket。SOCK _ STREAM)<br/>host _ ip = ' 192 . 168 . 56 . 1 ' #<strong class="ir hi"><em class="hh">在这里粘贴你的服务器IP地址</em></strong><br/>port = 9999<br/>client _ socket . connect((host _ IP，port)) # a tuple <br/> data = b</p><p id="b125" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">while True:<br/>while len(data)&lt;payload _ size:<br/>packet = client _ socket . recv(4 * 1024)# 4K<br/>如果不是packet:break<br/>data+= packed _ msg _ size = data[:payload _ size]<br/>data = data[payload _ size:]<br/>msg _ size = struct . unpack(" Q "，packed_msg_size)[0]</p><p id="b321" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">而len(data)&lt; msg_size:<br/>data+= client _ socket . recv(4 * 1024)<br/>frame _ data = data[:msg _ size]<br/>data = data[msg _ size:]<br/>frame = pickle . loads(frame _ data)<br/>cv2 . im show("接收视频"，frame)<br/>key = cv2 . wait key(1)&amp;0x ff<br/>如果key ==13或key ==113或key==81:</p><p id="4ab1" class="ip iq kq ir b is it iu iv iw ix iy iz kr jb jc jd ks jf jg jh kt jj jk jl jm ha bi translated">cv2 . destroyallwindows()<br/>break<br/>client _ socket . close()</p></blockquote><p id="deb6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">希望这篇文章对你有帮助！！</p><p id="3a73" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如有任何疑问，请通过<a class="ae ku" href="https://www.linkedin.com/in/akash-babu-mca-2019/" rel="noopener ugc nofollow" target="_blank"> Linkedin个人资料</a>联系我。</p><p id="cdd9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于代码，你可以访问我的<a class="ae ku" href="https://github.com/babuakash68/CV-2-Task-4.git" rel="noopener ugc nofollow" target="_blank"> Git-Hub </a> Repo</p><p id="444c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">快乐学习: )</p></div></div>    
</body>
</html>