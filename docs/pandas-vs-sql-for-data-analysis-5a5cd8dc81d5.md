# Pandas VS SQL 用于数据分析

> 原文：<https://medium.com/analytics-vidhya/pandas-vs-sql-for-data-analysis-5a5cd8dc81d5?source=collection_archive---------3----------------------->

经常有一个关于哪一个更适合数据分析的争论，这里我们将生成随机数据，并用 pandas 和 SQL 对其进行分析，看看哪一个更适合我们。

在这种情况下，我们将通过一个例子来比较这两者。我们将首先在 Pandas 上分析提供给我们的数据，然后在 SQL 上分析同样的数据。

# 首先，让我们看看提供给我们的数据的模式

![](img/bf0eb4bc32834dab58d4a0eed46b5f1e.png)

MySQL 数据库的模式

这里我们看到这是一家有 3 张桌子的餐馆的数据

People table —该表包含访问餐馆的人的信息。该表有 4 列

1.  ID —该列存储访问餐馆的人的 ID。该列是表中唯一标识每个人的主键
2.  年龄——光顾餐厅的人的年龄
3.  性别——光顾餐厅的人的性别
4.  城市——此人居住的城市

偏好表—该表包含人们的食物偏好信息。该表有两列

1.  ID —访问餐馆的人的个人 ID。该列是 preferences 表中唯一标识每个客户的主键，但是该列也是 preference 表中引用 people 表中 ID 列的外键。这样做是因为除非在 people 表中有条目，否则在 preferences 表中不能有条目。这是因为只有去过餐馆的顾客才能回答关于他们喜欢的食物类型的调查
2.  FOOD_TYPE —该列存储每个客户的首选食物类型

工作表—该表包含每个客户的职业信息。该表也有两列

1.  ID —访问餐馆的人的个人 ID。该列是 preferences 表中唯一标识每个客户的主键，但是该列也是 preference 表中引用 people 表中 ID 列的外键。这样做是因为除非在人员表中有条目，否则在职务表中不可能有条目。这是因为只有去过餐馆的顾客才能回答关于他们工作的调查
2.  JOB —该列存储每个客户的职业

# 将数据读入 python，以便我们可以比较 SQL 和 python

导入必要的库和框架

建立到 MySQL 数据库的连接并读取数据

# 处理数据以进行更好的分析

我们可以把这些数据框中的数据结合起来，这样我们就可以在一个地方得到所有的信息

从该模式中我们可以看到，我们可以将年龄列划分为不同的年龄组，将城市列划分为不同的州，这将有助于我们的分析，然后我们还为男性和女性创建单独的数据框架，这也有助于我们的分析

现在，我们将组合的数据帧保存到一个 csv 文件中，并在 SQL 数据库中创建一个表，该表包含 csv 文件中的所有信息，这样我们就可以在新表中获得新创建的列

我们使用以下代码在数据库中创建新表

# 开始分析

首先，我们分析了总人口中的男性和女性的数量以及他们的年龄组，并根据每个州的年龄组分析了他们的人口

计算机编程语言

python 中的年龄组明智分析

结构化查询语言

SQL 中的年龄组明智分析

然后，我们执行州和城市明智的分析

计算机编程语言

python 中的城市和州明智分析

结构化查询语言

SQL 中的城市和州明智分析

然后我们进行工作智能分析

计算机编程语言

python 中的作业智能分析

结构化查询语言

SQL 中的作业智能分析

# 最终比较

SQL 在查询数据方面效率更高，但它的功能较少，而在 pandas 中，对于大量数据可能会有延迟，但它有更多的功能，使我们能够以有效的方式操作数据。Python 也有各种数据可视化库，如 matplotlib、seaborn、plotly、Altair 等，帮助我们可视化，从而帮助我们更有效地分析数据。

SQL 工作在一个关系模型上，这使得通过键连接表更加容易，并在外键约束的情况下管理其他表中的数据输入，但是 Pandas 使数据操作更加容易。

Pandas plotting 的绘图功能也使我们更容易分析数据，它提供了一个快速绘图功能，使我们能够更好地了解数据。熊猫的变形功能也有助于我们运用各种功能。Pandas join 函数还帮助我们连接索引上的数据，merge 函数的工作方式类似于 SQL，它使我们能够连接两个数据帧中的特定列。

如果您打算操作数据或绘制数据，Pandas 会更好，因为它可以在一个地方完成所有操作，而在 SQL 中，我们必须使用 Tableau 进行数据可视化

Github 仓库的代码:[仓库](https://github.com/aayush1036/data_analysis)

我的网站:[网站](https://aayush1036.github.io/profile_website/)

作者:

Aayushmaan Anvesh Jain

感谢您阅读博客