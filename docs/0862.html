<html>
<head>
<title>Using Linear Regression To Predict AAPL (Apple stock) Prices In Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Python中使用线性回归预测AAPL(苹果股票)价格</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/using-linear-regression-to-predict-aapl-apple-stock-prices-in-python-1a629fbea15b?source=collection_archive---------3-----------------------#2021-02-04">https://medium.com/analytics-vidhya/using-linear-regression-to-predict-aapl-apple-stock-prices-in-python-1a629fbea15b?source=collection_archive---------3-----------------------#2021-02-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="66be" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有可能预测AAPL价格的走向吗？</p><p id="8091" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">是的，让我们使用<a class="ae jc" href="https://www.quantinsti.com/blog/machine-learning-trading-predict-stock-prices-regression/" rel="noopener ugc nofollow" target="_blank">机器学习回归技术</a>来预测世界上最受关注的公司之一苹果公司的价格。</p><p id="35ad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将创建一个<a class="ae jc" href="https://quantra.quantinsti.com/course/introduction-to-machine-learning-for-trading" rel="noopener ugc nofollow" target="_blank">机器学习</a>线性回归模型，从过去的AAPL价格中获取信息，并返回第二天AAPL价格的预测。</p><h1 id="29e6" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">导入库并读取数据</h1><p id="59ce" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">首先:导入实现这个策略所需的所有必要的库。</p><figure class="kg kh ki kj fd kk"><div class="bz dy l di"><div class="kl km l"/></div></figure><p id="a890" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，我们读取过去13年的每日AAPL价格数据，并将其存储在Dataframe中。我们删除不相关的列，并使用dropna()函数删除NaN值。然后，我们绘制AAPL收盘价。</p><figure class="kg kh ki kj fd kk"><div class="bz dy l di"><div class="kl km l"/></div></figure><p id="6638" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">输出:</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div class="er es kn"><img src="../Images/e8c867d157dcdec6bd8d7bd8573d445b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*EWBDWiOF3eteCBXX-Cul2Q.png"/></div></figure><h1 id="6cb9" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">定义解释变量</h1><p id="9816" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">解释变量是被操纵来决定第二天AAPL价格的变量。简单地说，它们是我们想要用来预测AAPL价格的特征。该策略中的解释变量是过去3天和9天的移动平均值。我们使用dropna()函数删除NaN值，并将特征变量存储在x中。</p><p id="3ea2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是，您可以向X添加更多您认为对预测AAPL价格有用的变量。这些变量可以是技术指标</p><figure class="kg kh ki kj fd kk"><div class="bz dy l di"><div class="kl km l"/></div></figure><h1 id="b72b" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">定义因变量</h1><p id="7016" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">同样，因变量取决于解释变量的值。简单地说，这就是我们试图预测的AAPL价格。我们将AAPL的价格存储在y中。</p><pre class="kg kh ki kj fd kq kr ks kt aw ku bi"><span id="a07c" class="kv je hh kr b fi kw kx l ky kz">y = Df['Close']</span><span id="00e3" class="kv je hh kr b fi la kx l ky kz">y.head()</span></pre><h1 id="30c9" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">将数据分成训练和测试数据集</h1><p id="1255" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">在这一步中，我们将预测器和输出数据分为训练和测试数据。通过将输入与预期输出配对，训练数据用于创建线性回归模型。测试数据用于评估模型的训练情况。</p><ol class=""><li id="d592" class="lb lc hh ig b ih ii il im ip ld it le ix lf jb lg lh li lj bi translated">前80%的数据用于训练，其余数据用于测试</li><li id="03da" class="lb lc hh ig b ih lk il ll ip lm it ln ix lo jb lg lh li lj bi translated">X_train和y_train是训练数据集</li><li id="c5be" class="lb lc hh ig b ih lk il ll ip lm it ln ix lo jb lg lh li lj bi translated">X_test和y_test是测试数据集</li></ol><figure class="kg kh ki kj fd kk"><div class="bz dy l di"><div class="kl km l"/></div></figure><h1 id="ad99" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">创建线性回归模型</h1><p id="e80d" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">我们现在将创建一个线性回归模型。但是，什么是线性回归呢？</p><p id="1ff5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我们试图捕捉“x”和“y”变量之间的数学关系，即通过散点图拟合一条线，根据“x”的观察值“最好地”解释“y”的观察值，那么x和y之间的这种方程称为线性回归分析。</p><pre class="kg kh ki kj fd kq kr ks kt aw ku bi"><span id="74d5" class="kv je hh kr b fi kw kx l ky kz"><strong class="kr hi"><em class="lp">Y = m1 * X1 + m2 * X2 + C AAPL price = m1 * 3 days moving average + m2 * 15 days moving average + c</em></strong></span></pre><p id="2965" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，我们使用拟合方法来拟合自变量和因变量(x和y ),以生成回归系数和常数。</p><pre class="kg kh ki kj fd kq kr ks kt aw ku bi"><span id="22af" class="kv je hh kr b fi kw kx l ky kz">linear = LinearRegression().fit(X_train,y_train)</span></pre><h1 id="8c8e" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">预测AAPL价格</h1><p id="ef0b" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">现在，是时候检查模型是否在测试数据集中工作了。我们使用使用训练数据集创建的线性模型来预测AAPL价格。预测方法找到给定解释变量x的AAPL价格(y)</p><figure class="kg kh ki kj fd kk"><div class="bz dy l di"><div class="kl km l"/></div></figure><p id="4fcb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">输出</p><figure class="kg kh ki kj fd kk er es paragraph-image"><div class="er es kn"><img src="../Images/286fea4379a84fdcba6ea71f49f22222.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*BY0EGTVFdqSmnf9JiQuxrg.png"/></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">该图显示了AAPL的预测价格和实际价格。</figcaption></figure><h1 id="2998" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">让我们检查一下我们的准确性</h1><p id="7545" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">现在，让我们使用score()函数来计算拟合度。</p><pre class="kg kh ki kj fd kq kr ks kt aw ku bi"><span id="094d" class="kv je hh kr b fi kw kx l ky kz">r2_score = linear.score(X[t:],y[t:])*100  float("{0:.2f}".format(r2_score))</span></pre><h1 id="90b5" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak">输出— 99.42 </strong></h1><p id="a444" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">可以看出，模型的R平方为99.42%。r平方始终介于0和100%之间。接近100%的分数表明该模型很好地解释了AAPL价格。</p><p id="2afd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">恭喜你。你刚刚学会了一个基本而强大的<a class="ae jc" href="https://www.quantinsti.com/blog/overview-machine-learning-trading/" rel="noopener ugc nofollow" target="_blank">机器学习</a>技术。感谢阅读！</p><p id="78a5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">再见！</p></div></div>    
</body>
</html>