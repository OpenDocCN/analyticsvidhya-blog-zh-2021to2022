<html>
<head>
<title>Load Data from S3 to Snowflake and Use TensorFlow Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将数据从S3加载到雪花并使用张量流模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/load-data-from-s3-to-snowflake-and-use-tensorflow-model-29ccd938cc1b?source=collection_archive---------9-----------------------#2021-03-11">https://medium.com/analytics-vidhya/load-data-from-s3-to-snowflake-and-use-tensorflow-model-29ccd938cc1b?source=collection_archive---------9-----------------------#2021-03-11</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6d26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">了解如何将数据从S3加载到雪花，并在StreamSets数据收集器、<a class="ae jd" href="https://streamsets.com/products/dataops-platform/data-collector/" rel="noopener ugc nofollow" target="_blank">快速数据摄取引擎</a>和数据管道中为TensorFlow模型提供服务，以便对从S3流向雪花的数据进行评分。</p><p id="f275" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据和分析正在帮助我们更快、更明智地保持健康。云规模的开放数据集和分析是释放准确性的关键，以在医疗领域产生真正的影响。<a class="ae jd" href="https://streamsets.com/solutions/streamsets-for-snowflake/" rel="noopener ugc nofollow" target="_blank">像雪花这样的数据云</a>是通过自助式数据访问和反映当今数据动态性质的规模来开放分析的主要推动者。一个突出的模式和关键的第一步是将数据从S3加载到雪花，以快速获得数据云的价值。然而，如果您不能加载全部的关系和流数据源，您的雪花数据云的价值可能永远不会实现。<a class="ae jd" href="https://streamsets.com/products/dataops-platform/data-collector/" rel="noopener ugc nofollow" target="_blank">智能数据管道</a>让您可以从企业的各个角落发送和同步数据，并以正确的格式将其放入您的数据云中，为分析做好准备。这意味着您可以为数据科学和机器学习提供生产就绪数据。</p><h1 id="070e" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">用例</h1><p id="37a0" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">我们将回顾的用例是将乳腺癌肿瘤分类为or，并展示我们将使用作为<a class="ae jd" href="http://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_breast_cancer.html" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a>的一部分提供的威斯康星州乳腺癌数据集。为了了解我如何用Python训练和导出一个简单的TensorFlow模型，<a class="ae jd" href="https://github.com/iamontheinet/datascience/blob/master/Breast_Cancer/breast_cancer_training.py" rel="noopener ugc nofollow" target="_blank">在GitHub </a>上检查我的代码。正如您将注意到的，模型架构保持最小化，非常简单，只有几层。代码需要注意的重要方面是如何使用<a class="ae jd" href="https://www.tensorflow.org/versions/r1.15/api_docs/python/tf/saved_model/builder" rel="noopener ugc nofollow" target="_blank">tensor flow SavedModelBuilder</a>*导出和保存模型。</p><p id="0193" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kh">*注意:要在Data Collector中使用TensorFlow模型，应使用TensorFlow SavedModelBuilder以您选择的支持语言(如Python)导出/保存它们。</em></p><h1 id="a898" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">什么是张量流？</h1><p id="fdb1" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">TensorFlow是一个为深度神经网络构建的开源机器学习框架。它是由谷歌大脑团队创造的。TensorFlow支持在CPU、GPU和TPU上进行可扩展和可移植的训练。截至今天，它是GitHub上最受欢迎和最活跃的机器学习项目。</p><h1 id="8a76" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">数据管道概述</h1><p id="9b56" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">下面是数据管道的概述。</p><ul class=""><li id="a0c6" class="ki kj hi ih b ii ij im in iq kk iu kl iy km jc kn ko kp kq bi translated">从亚马逊S3获取乳腺癌肿瘤数据</li><li id="393e" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">执行转换</li><li id="37d0" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">使用TensorFlow机器学习模型将肿瘤分类为<strong class="ih hj"> <em class="kh">良性</em> </strong>或<strong class="ih hj"> <em class="kh">恶性</em> </strong></li><li id="8bbc" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">将乳腺癌肿瘤数据与癌症分类一起存储在雪花中</li></ul><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/ebdea5dcf4e63eb817b0123a56f1ef83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iscPd8t1vygQ78Mr.png"/></div></div></figure><h1 id="7af3" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">将数据从S3加载到雪花</h1><h1 id="b573" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">亚马逊S3</h1><ul class=""><li id="367b" class="ki kj hi ih b ii kc im kd iq li iu lj iy lk jc kn ko kp kq bi translated"><a class="ae jd" href="https://streamsets.com/documentation/datacollector/latest/help/datacollector/UserGuide/Origins/AmazonS3.html#concept_kvs_3hh_ht" rel="noopener ugc nofollow" target="_blank"> origin </a>将加载存储在亚马逊S3上的. csv文件中的乳腺癌肿瘤记录。一些重要的配置包括:</li><li id="e5a0" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">AWS凭据—您可以使用实例配置文件或AWS访问密钥进行身份验证</li><li id="82e0" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">亚马逊S3存储桶名称</li><li id="3e2e" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">包含要从亚马逊S3加载的输入数据的对象/文件名或文件名模式。</li></ul><h1 id="c05d" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">现场转换器</h1><ul class=""><li id="8ba8" class="ki kj hi ih b ii kc im kd iq li iu lj iy lk jc kn ko kp kq bi translated">这个<a class="ae jd" href="https://streamsets.com/documentation/datacollector/latest/help/datacollector/UserGuide/Processors/FieldTypeConverter.html#concept_is3_zkp_wq" rel="noopener ugc nofollow" target="_blank">处理器</a>将把所有输入列从String转换成Float。在这种情况下，所有字段都需要包含在列表中，因为它们都是张量流模型将使用的要素。</li></ul><h1 id="7c33" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">张量流评估器</h1><ul class=""><li id="759d" class="ki kj hi ih b ii kc im kd iq li iu lj iy lk jc kn ko kp kq bi translated">保存的模型路径:要使用的预训练TF模型的位置。</li><li id="a8f6" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">模型标签:设置为<strong class="ih hj"><em class="kh">【serve】</em></strong>，因为元图(在我们导出的模型中)旨在用于服务。更多详情，请参见<a class="ae jd" href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/saved_model/tag_constants.py" rel="noopener ugc nofollow" target="_blank"> tag_constants.py </a>。</li><li id="a25b" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">输入配置:在训练和导出模型期间配置的输入张量信息。(参见<a class="ae jd" href="https://github.com/iamontheinet/datascience/blob/master/Breast_Cancer/neural_networks_with_tensorflow-breast-cancer.ipynb" rel="noopener ugc nofollow" target="_blank">训练模型，并使用tensor flow SavedModelBuilder</a>部分保存/导出它。)</li><li id="17c2" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">输出配置:在训练和导出模型期间配置的输出张量信息。(参见<a class="ae jd" href="https://github.com/iamontheinet/datascience/blob/master/Breast_Cancer/neural_networks_with_tensorflow-breast-cancer.ipynb" rel="noopener ugc nofollow" target="_blank">训练模型，并使用tensor flow SavedModelBuilder</a>部分保存/导出。)</li><li id="35d5" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">输出字段:我们想要存储分类值的输出记录字段。</li></ul><h1 id="5a7d" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">字段重命名器</h1><ul class=""><li id="dac7" class="ki kj hi ih b ii kc im kd iq li iu lj iy lk jc kn ko kp kq bi translated">这个<a class="ae jd" href="https://streamsets.com/documentation/datacollector/latest/help/datacollector/UserGuide/Processors/FieldRenamer.html#concept_vyv_zsg_ht" rel="noopener ugc nofollow" target="_blank">处理器</a>将使我们能够重命名列，使它们更易于理解。</li></ul><h1 id="8658" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">表达式评估器</h1><ul class=""><li id="1d2d" class="ki kj hi ih b ii kc im kd iq li iu lj iy lk jc kn ko kp kq bi translated">这个<a class="ae jd" href="https://streamsets.com/documentation/datacollector/latest/help/datacollector/UserGuide/Processors/Expression.html#concept_zm2_pp3_wq" rel="noopener ugc nofollow" target="_blank">处理器</a>会使用表达式<em class="kh">$ { record:value('/class ification ')= = 0？良性':'恶性' } </em>评估<em class="kh">'条件'</em>列值，并根据肿瘤分类创建一个新列，其值为<em class="kh">'良性'</em>或<em class="kh">'恶性'</em>。</li></ul><h1 id="3de1" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">现场清除器</h1><ul class=""><li id="5849" class="ki kj hi ih b ii kc im kd iq li iu lj iy lk jc kn ko kp kq bi translated">这个<a class="ae jd" href="https://streamsets.com/documentation/datacollector/latest/help/datacollector/UserGuide/Processors/FieldRemover.html#concept_jdd_blr_wq" rel="noopener ugc nofollow" target="_blank">处理器</a>将使我们能够删除不需要存储在雪花中的列。</li></ul><h1 id="df41" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">雪花</h1><ul class=""><li id="ddb2" class="ki kj hi ih b ii kc im kd iq li iu lj iy lk jc kn ko kp kq bi translated">转换后的数据存储在<a class="ae jd" href="https://streamsets.com/documentation/datacollector/latest/help/datacollector/UserGuide/Destinations/Snowflake.html#concept_vxl_zzc_1gb" rel="noopener ugc nofollow" target="_blank">雪花</a>中。一些重要的配置包括:</li><li id="585a" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">雪花帐户、用户名、密码、仓库、数据库、模式和表名。<strong class="ih hj"> <em class="kh">注意:</em> </strong> <em class="kh">如果表格不存在，管道将自动创建表格。所以不需要在雪花</em>中预先创建。</li><li id="3a35" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">处理新数据时，您可以配置雪花目的地，使用COPY命令<a class="ae jd" href="https://streamsets.com/documentation/datacollector/latest/help/datacollector/UserGuide/Destinations/Snowflake.html#concept_w35_vsq_2gb" rel="noopener ugc nofollow" target="_blank">将数据加载到雪花表</a>。</li><li id="4d9d" class="ki kj hi ih b ii kr im ks iq kt iu ku iy kv jc kn ko kp kq bi translated">当处理变更数据捕获(CDC)数据时，您可以配置雪花目的地使用MERGE命令<a class="ae jd" href="https://streamsets.com/documentation/datacollector/latest/help/datacollector/UserGuide/Destinations/Snowflake.html#concept_w35_vsq_2gb" rel="noopener ugc nofollow" target="_blank">将数据加载到雪花表</a>。</li></ul><h1 id="291b" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">数据管道执行</h1><p id="43a9" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">在执行流水线时，输入的乳腺癌肿瘤记录通过上述数据流水线，包括使用张量流模型的实时评分。发送到雪花数据云的输出记录包括模型用于分类的乳腺癌肿瘤特征、<strong class="ih hj"> 0或1、</strong>的模型输出值以及各自的肿瘤情况<strong class="ih hj">良性</strong>或<strong class="ih hj">恶性。</strong>见下文。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/c8d919bd134ff32e9e27ccd957528e01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IbxyNkhARo8emzOr.png"/></div></div></figure><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/0d8a55e2fba3b8cd9bae946910e42c0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fbkbHz1FBXGZPw6x.png"/></div></div></figure><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/7c2a6da5820410dce5e5617440f80da2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-zDfgG-65qSAOg_l.png"/></div></div></figure><h1 id="c639" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">结论</h1><p id="65be" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated"><a class="ae jd" href="https://streamsets.com/solutions/streamsets-for-snowflake/" rel="noopener ugc nofollow" target="_blank"> StreamSets和Snowflake </a>之间的集成使数据工程师能够构建智能数据管道来同步和异步加载数据。同步负载的一个很好的例子是使用<a class="ae jd" href="https://streamsets.com/getting-started/building-data-pipelines/#1591636712645-71b4c920-2f56" rel="noopener ugc nofollow" target="_blank">变更数据捕获(CDC) </a>的多表实时复制，对于异步、高吞吐量和纯插入类型的工作负载，数据工程师可以利用流集中的<a class="ae jd" href="https://streamsets.com/documentation/datacollector/latest/help/datacollector/UserGuide/Destinations/Snowflake.html#concept_nzd_mgj_2gb" rel="noopener ugc nofollow" target="_blank"> Snowpipe集成</a>。</p><p id="cddc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">立即开始，在您选择的云提供商上部署数据收集器<a class="ae jd" href="https://streamsets.com/products/dataops-platform/data-collector/download/" rel="noopener ugc nofollow" target="_blank">快速数据摄取引擎</a>，或者您也可以下载它用于本地开发。</p></div><div class="ab cl ll lm gp ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="hb hc hd he hf"><p id="74f0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="kh">原载于2021年3月11日https://streamsets.com</em><em class="kh">的</em> <a class="ae jd" href="https://streamsets.com/blog/load-data-from-s3-to-snowflake-and-use-tensorflow-model/" rel="noopener ugc nofollow" target="_blank"> <em class="kh">。</em></a></p></div></div>    
</body>
</html>