<html>
<head>
<title>SQL Interview Questions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL面试问题</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sql-interview-questions-c004d91dffc?source=collection_archive---------2-----------------------#2021-03-28">https://medium.com/analytics-vidhya/sql-interview-questions-c004d91dffc?source=collection_archive---------2-----------------------#2021-03-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="c045" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题1:什么是SQL？</strong></p><p id="ff18" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">答案1: SQL代表结构化查询语言。它是用于与数据库交互的主要语言。在SQL的帮助下，人们可以从数据库中提取数据，修改这些数据，并在需要时更新这些数据。</p><p id="c4b6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题2:什么是数据库管理系统？</strong></p><p id="0d76" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据库管理系统(DBMS)是控制数据库的创建、维护和使用的程序。DBMS可以被称为文件管理器，它管理数据库中的数据，而不是将数据保存在文件系统中。</p><p id="068c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题3:什么是SQL server？</strong></p><p id="083b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">SQL Server是一个关系数据库管理系统，它以表格格式存储数据。它是“关系型”的，因为每个表中的值都是相互关联的，这使得一次跨多个表运行查询成为可能。</p><p id="b016" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题4:在SQL中查找员工的第二高工资？</strong></p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="40d6" class="jl jm hh jh b fi jn jo l jp jq">SELECT MAX(Salary) FROM Employee<br/>WHERE Salary NOT IN (SELECT MAX(Salary) FROM Employee)</span></pre><p id="5cb4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">SQL查询select MAX(Salary from Employee)在Employee表中查找最高薪金，但是添加“WHERE Salary NOT IN”将筛选不包括最高薪金值的薪金值。例如，如果Employee表中的最高薪金是300，000，则使用“NOT IN”运算符将该值从结果中排除，除300，000以外的所有值都将保留在结果中。因此，我们实际获得的最高值是Employee表中的第二高值。因此，当我们从新的结果集中选择最高工资时，它给出了雇员表中第二高的工资。</p><p id="51c7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题5:在SQL中使用top关键字查找员工的第n个最高工资？</strong></p><p id="8c7d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以使用SQL Server这样的数据库的TOP关键字来查找第n个最高工资。要理解下面的查询，首先看一下子查询，该子查询在Employee表中查找最高的N份薪水，并按降序排列。然后，外部查询实际上将按升序重新排列这些值，这就是最后一行“ORDER BY Salary”所做的。最后，这意味着第n个最高工资将在工资列表的顶部，这意味着我们只需要第一行，这正是“选择前1名工资”将做的。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="0de5" class="jl jm hh jh b fi jn jo l jp jq">SELECT TOP 1 Salary<br/>FROM (<br/>      SELECT DISTINCT TOP N Salary<br/>      FROM Employee<br/>      ORDER BY Salary DESC<br/>      ) AS Emp<br/>ORDER BY Salary</span></pre><p id="bdd0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题6:用SQL中的稠密秩函数求员工的第n高工资？</strong></p><p id="cad7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">dense rank函数(dense_rank)计算一组有序行中某一行的排名，并以数字形式返回该排名。排名基于order by子句中的值。在下面的查询中，根据雇员表的薪金返回排名。在出现平局的情况下，所有行的等级都相同。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="6a91" class="jl jm hh jh b fi jn jo l jp jq">select * from( select Salary, dense_rank() <br/>over(order by Salary desc)r from Employee) <br/>where r=&amp;n;<br/>To find the 2nd highest salary set n = 2<br/>To find the 3rd highest salary set n = 3.</span></pre><p id="ddf5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题SQL中的约束是什么？</strong></p><p id="1a31" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">约束用于指定关于表中数据的规则。在创建表的过程中，或者在使用ALTER TABLE命令创建表之后，它可以应用于SQL表中的单个或多个字段。这些限制是:</p><ul class=""><li id="ee06" class="jr js hh ig b ih ii il im ip jt it ju ix jv jb jw jx jy jz bi translated"><strong class="ig hi"> NOT NULL </strong> —限制将空值插入到列中。</li><li id="c43b" class="jr js hh ig b ih ka il kb ip kc it kd ix ke jb jw jx jy jz bi translated"><strong class="ig hi">检查</strong> —验证字段中的所有值都满足条件。</li><li id="740a" class="jr js hh ig b ih ka il kb ip kc it kd ix ke jb jw jx jy jz bi translated"><strong class="ig hi">默认值</strong> —如果没有为字段指定值，则自动分配默认值。</li><li id="96f6" class="jr js hh ig b ih ka il kb ip kc it kd ix ke jb jw jx jy jz bi translated"><strong class="ig hi">唯一</strong> —确保插入字段的值是唯一的。</li><li id="8f6d" class="jr js hh ig b ih ka il kb ip kc it kd ix ke jb jw jx jy jz bi translated"><strong class="ig hi">索引</strong> —对字段进行索引，以提供更快的记录检索。</li><li id="5f4e" class="jr js hh ig b ih ka il kb ip kc it kd ix ke jb jw jx jy jz bi translated"><strong class="ig hi">主键</strong> —唯一标识表中的每条记录。</li><li id="040f" class="jr js hh ig b ih ka il kb ip kc it kd ix ke jb jw jx jy jz bi translated"><strong class="ig hi">外键</strong> —确保另一个表中记录的引用完整性。</li></ul><p id="a2fc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题8:使用%通配符执行简单搜索？</strong></p><p id="6635" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">SQL模式匹配提供了数据中的模式搜索，而不是写入精确的单词。类似于的<strong class="ig hi">操作符与<strong class="ig hi"> SQL通配符</strong>一起使用，以获取所需的信息。在下面的查询中，我们从姓氏以K开头的学生的表中获取所有记录，通配符%表示零个或多个字符。</strong></p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="6223" class="jl jm hh jh b fi jn jo l jp jq"><strong class="jh hi">SELECT</strong> *<br/><strong class="jh hi">FROM</strong> students<br/><strong class="jh hi">WHERE</strong> last_name <strong class="jh hi">LIKE</strong> 'K%'</span></pre><p id="290b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题9:从学生的表中查找姓氏中第三个字母k的所有记录？</strong></p><p id="7f76" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面的查询中，我们从学生的表中获取所有记录，其中第三个字母是k，而' _ '恰好表示一个字符。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="d283" class="jl jm hh jh b fi jn jo l jp jq"><strong class="jh hi">SELECT</strong> *<br/><strong class="jh hi">FROM</strong> students<br/><strong class="jh hi">WHERE</strong> last_name <strong class="jh hi">LIKE</strong> '___k%'</span></pre><p id="360d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题10:从学生的表中查找姓氏中没有第三个字母k的所有记录？</strong></p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="9454" class="jl jm hh jh b fi jn jo l jp jq"><strong class="jh hi">SELECT</strong> *<br/><strong class="jh hi">FROM</strong> students<br/><strong class="jh hi">WHERE</strong> last_name NOT LIKE '__k%'</span></pre><p id="c560" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题11:从学生的表中找出姓氏中有字母k的所有记录？</strong></p><p id="db3e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">'<strong class="ig hi"> % </strong>'通配符的两个实例返回姓氏中任何地方包含k的所有记录。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="6d03" class="jl jm hh jh b fi jn jo l jp jq"><strong class="jh hi">SELECT</strong> *<br/><strong class="jh hi">FROM</strong> students<br/><strong class="jh hi">WHERE</strong> last_name LIKE '%k%'</span></pre><p id="f624" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">问题12:从学生的表中找出所有记录，该表列出了所有姓氏以字母表前半部分的字母开头但不以元音结尾的学生。</p><p id="668c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面的查询中，'<strong class="ig hi"> % </strong>'通配符匹配零个或多个任意类型的字符，可用于定义模式中的通配符。通过将字符范围括在方括号中来指定字符范围。通配符<strong class="ig hi">【a-m】</strong>匹配字母表前半部分的任何字母。此外，通过在左方括号内直接包含克拉字符来否定一系列字符有助于匹配任何非元音字符。例如，在下面的查询中，<strong class="ig hi">【^aeiou】</strong>匹配任何非元音字符。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="194b" class="jl jm hh jh b fi jn jo l jp jq"><strong class="jh hi">SELECT </strong>*<br/><strong class="jh hi">FROM </strong>employees<br/><strong class="jh hi">WHERE</strong> last_name LIKE '[a-m]%[^aeiou]'</span></pre><p id="eb68" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">问题13:编写一个SQL查询来查找下表中的孙子和爷爷。</p><figure class="jc jd je jf fd kg er es paragraph-image"><div class="er es kf"><img src="../Images/1b511953ca096f41a4c7b319583e424d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*WMpB-4T5FTqB86XQxLs5jw.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">表格:父亲-儿子表格</figcaption></figure><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="c097" class="jl jm hh jh b fi jn jo l jp jq">SELECT a.Son as grandson, b.Father as grandfather<br/>from Father-Son as a innerjoin Father-Son as b<br/>where a.Father = b.son</span></pre><p id="c804" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在上面的查询中，对父子表应用了自连接来查找孙子和外孙。比如Arun是Kunal的父亲，但他也是Jagdish的儿子。因此，Arun上的自连接表a和B(a和B是父子表的别名，自连接将发生在Arun上，Arun是表a中Kunal的父亲，表B中Jagdish的儿子)。</p><p id="9a9c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题14:写一个SQL查询，在下表中找到雇员的经理。</strong></p><p id="d66a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面的查询中，employee和manager是employee表的别名，这两个表在employee表的Manager Id和Manager表的EmployeeID上进行自联接。</p><figure class="jc jd je jf fd kg er es paragraph-image"><div class="er es kn"><img src="../Images/a2ac2fd830fd8b9a06b0704982984804.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*JcN2oeRoc0yWmVdXSBg0yg.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">表格:雇主</figcaption></figure><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="f91d" class="jl jm hh jh b fi jn jo l jp jq">SELECT employee.EmployeeName , manager.EmployeeName from Employer employee innerjoin Employer manager where employee.ManagerID = manager.EmployeeID</span></pre><p id="56d0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题15:列出在同一个部门工作的员工的记录。</strong></p><figure class="jc jd je jf fd kg er es paragraph-image"><div class="er es ko"><img src="../Images/9139b33ad05e3f083234447cdb929cb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*byfKwU9jfjt8AYfrNOdCug.png"/></div></figure><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="ae39" class="jl jm hh jh b fi jn jo l jp jq">SELECT a.EmployeeName ,b.EmployeeName, a.Department from Employer a innerjoin Employer b where a.department = b.department and a.EmployeeID != b.EmployeeID</span></pre><p id="94f9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题16:使用SQL中的self join查找员工的第n份最高工资？</strong></p><p id="ca78" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面的查询中，我们通过计算e2表(employee info表的别名)中雇员的薪金，找到了employee info表中第三高的薪金，它大于e1表(employee info表的别名)中雇员的薪金。对于查找第三高的薪金，不同薪金的计数应为2，对于查找第n高的薪金，计数应为n-1。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="c22f" class="jl jm hh jh b fi jn jo l jp jq">SELECT salary from employeeinfo e1 where N-1 = (SELECT COUNT(Distinct salary) from employeeinfo e2 where e2.salary &gt; e1.salary)</span></pre><p id="8c9d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题17:找出每个部门工资最高的员工？</strong></p><figure class="jc jd je jf fd kg er es paragraph-image"><div class="er es kp"><img src="../Images/99cba39e8f30553c2cdace2f9eebdfde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*XRsFkIc_Lk-kfwOC17-vdw.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">雇主表</figcaption></figure><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="fb47" class="jl jm hh jh b fi jn jo l jp jq">SELECT a.First Name + ' ' + a.Last Name, a.Salary from Employer a Inner Join (Select Department Name,Max(Salary)as Salary from Employer group by Department Name)b<br/>where a.Department Name = b.Department Name and a.Salary = b.Salary.</span></pre><p id="2e6f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在上面的SQL查询中，我们将首先创建表b，选择每个部门的最高工资。稍后，我们将表a与表b连接起来，其中表(a)中的部门名称和雇员的薪金与表b中每个部门和部门名称的最高薪金相匹配。</p><p id="490d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题18:什么是丢弃、删除和截断？</strong></p><p id="e0aa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">它们是可以用来修改数据库的命令。</p><p id="f40e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">1)DROP从数据库中删除整个表。</p><p id="838b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2)删除从表格中删除一行。</p><p id="1640" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3)TRUNCATE从表中删除所有行。</p><p id="617d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题19:确定一个表中的重复数？</strong></p><p id="d84f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果每个不同记录的频率计数</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="3943" class="jl jm hh jh b fi jn jo l jp jq">SELECT year, country, COUNT(*)<br/>FROM 2019_Sales<br/>GROUP BY year, country<br/>HAVING COUNT(*)&gt;1</span></pre><p id="41ad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题20:如何删除表格中重复记录的个数？</strong></p><p id="2048" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下表中，我们可以看到名字和姓氏列中的重复记录，但是具有不同的雇员键，我们决定保留最大雇员id以防任何重复记录。</p><figure class="jc jd je jf fd kg er es paragraph-image"><div class="er es kq"><img src="../Images/469be1427f40cf1022b21224b9188e23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*jkfSbw7sUXNiZVJOm537qQ.jpeg"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">雇员</figcaption></figure><p id="a2e2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">第一次接近</strong></p><p id="6190" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在上面的查询中，我们创建了一个名为“雇员CTE”的临时表，它由一个名为RowNum的列组成。这些记录首先按名字和姓氏分组，然后按雇员ID的降序分配行号。稍后，我们删除雇员CTE表中RowNum &gt;1的所有记录。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="8edd" class="jl jm hh jh b fi jn jo l jp jq">With Employee CTE as(<br/>Select firstName, LastName,EmployeeID, Row_NUMBER() over (partition by First Name, Last Name, order by EmployeeID desc) as RowNum<br/>from dbo.Employee)</span><span id="6591" class="jl jm hh jh b fi kr jo l jp jq">delete from Employee CTE where RowNum &gt; 1</span></pre><p id="cedf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">第二种方法</strong></p><p id="eb0e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在上面的查询中，我们创建了一个名为“雇员CTE”的临时表，其中包含一个名为“等级”的列名。这些记录首先按名字和姓氏分组，然后按雇员ID的降序排列等级。稍后，我们从雇员CTE表中删除所有等级&gt; 1的记录。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="e571" class="jl jm hh jh b fi jn jo l jp jq">With Employee CTE as(<br/>Select firstName, LastName,EmployeeID, dense_rank() over (partition by First Name, Last Name, order by EmployeeID desc) as Rank<br/>from dbo.Employee)</span><span id="c1f3" class="jl jm hh jh b fi kr jo l jp jq">delete from Employee CTE where Rank &gt; 1</span></pre><p id="18d1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题21:秩和密秩的区别？</strong></p><p id="0c57" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">RANK指定有序分区内的等级。然而，如果多个项目具有相同的排名，那么分配的下一个排名将不会是连续的。例如，如果我们有3个等级为2的记录，那么分配给该记录的下一个等级将是5。</p><p id="e96e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">DENSE_RANK在有序分区内分配排名，但排名是连续的，如果多个项目被赋予相同的排名，则不会跳过任何排名。</p><p id="2626" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题22:查询薪资高于本部门平均薪资的员工？</strong></p><p id="4f91" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面的SQL查询中，我们将首先创建一个AvgEmpSal表，选择每个部门的平均工资。稍后，我们将在部门名称上将上表与表a连接起来，并且表(a)中雇员的薪金应该大于AvgEmpSal表中的薪金。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="626f" class="jl jm hh jh b fi jn jo l jp jq">Select a.FirstName + ' ' + a.LastName as Employeename , a.DepartmentName, a.Salary from Employee a inner join<br/>(Select DepartmentName, Avg(Salary) as Salary from dbo.Employee group by DepartmentName) AvgEmpSal<br/>on a.DepartmentName = AvgEmpSal.DepartmentName and a.Salary &gt; AvgEmpSal.Salary</span></pre><p id="9723" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题23:查询薪资高于部门平均薪资但低于部门整体平均薪资的员工？</strong></p><p id="a159" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面的SQL查询中，我们将首先创建一个AvgEmpSal表，选择每个部门的平均工资。稍后，我们将在部门名称上将上表与表a连接起来，并且表(a)中雇员的薪金应该大于AvgEmpSal表中的薪金。但是，表(a)中员工的薪金应该低于员工表中的总体平均薪金。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="ccb8" class="jl jm hh jh b fi jn jo l jp jq">Select a.FirstName + ' ' + a.LastName as Employeename , a.DepartmentName, a.Salary from Employee a inner join<br/>(Select DepartmentName, Avg(Salary) as Salaryfrom dbo.Employee group by DepartmentName) AvgEmpSal<br/>on a.DepartmentName = AvgEmpSal.DepartmentName and a.Salary &gt; AvgEmpSal.Salary<br/>where a.Salary &lt; (select Avg(Salary) from Employee)</span></pre><p id="dad9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题24:为在公司工作满两年的员工加薪。</strong></p><p id="c065" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面的查询中，我们将首先使用SQL中的GETDATE()函数来获取当前日期和时间戳。稍后，我们会将GETDATE()函数的数据类型转换为日期类型。然后，我们将选择Employeekey、FirstName、LastName、Salary，并从Employee表中创建一个新变量IncrSalary，并筛选出今天的日期与雇用日期相差超过两年的记录。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="0468" class="jl jm hh jh b fi jn jo l jp jq">Select CAST(GETDATE() As Date);<br/>Select Employeekey, FirstName,LastName, Salary, Salary*1.15 as IncrSalary from dbo.Employee emp where Datediff(Year,Hiredate, Getdate())&gt;2</span></pre><p id="0769" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题25:找出薪水比经理高的员工？</strong></p><p id="77e2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面的SQL查询中，我们将首先通过选择经理姓名和薪金来创建一个表Mng。稍后，我们将把上面的表与Emp表的经理键上的Emp表以及Mng表和Emp表的雇员键连接起来。薪金必须大于Mng.Salary</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="8780" class="jl jm hh jh b fi jn jo l jp jq">Select Emp.FirstName+ ' ' + Emp.LastName as EmployeeName, Emp.Salary, Mng.ManagerName,Mng.Salary from dbo.Employee Emp join (Select FirstName+ ' ' + LastName as ManagerName, Salary from dbo.Employee) Mng on Emp. Manager Key = Mng.Employer Key and Emp.Salary &gt; Mng.Salary</span></pre><p id="53fd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题26:找出所有员工都是男性的部门？</strong></p><p id="f085" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下面的查询中，我们首先从Employee表中选择了所有有男性雇员的部门名称。后来，我们在SQL server中使用except子句排除了包含女性和第三性别雇员的部门。</p><p id="1b8f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">SQL中的<strong class="ig hi"> EXCEPT </strong>子句/运算符用于组合两条SELECT语句，它只返回第一条SELECT语句中的行，这些行在第二条SELECT语句中不可用。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="2c9b" class="jl jm hh jh b fi jn jo l jp jq">Select distinct DepartmentName<br/>from dbo.Employee<br/>where Gender = 'M'</span><span id="8226" class="jl jm hh jh b fi kr jo l jp jq">Except</span><span id="08cf" class="jl jm hh jh b fi kr jo l jp jq">Select distinct DepartmentName<br/>from dbo.Employee<br/>where Gender &lt;&gt; 'M'</span></pre><h2 id="ee98" class="jl jm hh bd ks kt ku kv kw kx ky kz la ip lb lc ld it le lf lg ix lh li lj lk bi translated">结束注释</h2><p id="0314" class="pw-post-body-paragraph ie if hh ig b ih ll ij ik il lm in io ip ln ir is it lo iv iw ix lp iz ja jb ha bi translated">希望这篇文章能帮你理清SQL面试问题。本文由你管视频链接:【https://youtu.be/_2jhFL1EnF4 T4】</p></div></div>    
</body>
</html>