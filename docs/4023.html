<html>
<head>
<title>Crypto Price Forecasting with GRU</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用GRU预测加密价格</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/crypto-price-forecasting-with-bi-gru-c9bcec76b69f?source=collection_archive---------4-----------------------#2021-08-19">https://medium.com/analytics-vidhya/crypto-price-forecasting-with-bi-gru-c9bcec76b69f?source=collection_archive---------4-----------------------#2021-08-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/07fc680e3fc94f93f13260dc282123c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HCj2Wz1sKuMLsW0R"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">安德烈·弗朗索瓦·麦肯齐在<a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="4f8b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">注:不作为理财建议。</strong></p><p id="8f8d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi js translated">众所周知，加密货币非常不稳定，因此预测大方向更具挑战性，更不用说每天的信号了。在这篇博文中，我将尝试借助一些深度学习技术来解决这个挑战。</p><h1 id="c697" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">内容:</h1><ol class=""><li id="088b" class="kz la hh iw b ix lb jb lc jf ld jj le jn lf jr lg lh li lj bi translated">问题定式化</li><li id="f02b" class="kz la hh iw b ix lk jb ll jf lm jj ln jn lo jr lg lh li lj bi translated">收集数据</li><li id="ab04" class="kz la hh iw b ix lk jb ll jf lm jj ln jn lo jr lg lh li lj bi translated">预处理数据</li><li id="1119" class="kz la hh iw b ix lk jb ll jf lm jj ln jn lo jr lg lh li lj bi translated">探索性数据分析</li><li id="6fda" class="kz la hh iw b ix lk jb ll jf lm jj ln jn lo jr lg lh li lj bi translated">生成序列数据</li><li id="ed02" class="kz la hh iw b ix lk jb ll jf lm jj ln jn lo jr lg lh li lj bi translated">基线模型</li><li id="d9fe" class="kz la hh iw b ix lk jb ll jf lm jj ln jn lo jr lg lh li lj bi translated">序列模型介绍</li><li id="43cf" class="kz la hh iw b ix lk jb ll jf lm jj ln jn lo jr lg lh li lj bi translated">LSTM模型</li><li id="2e86" class="kz la hh iw b ix lk jb ll jf lm jj ln jn lo jr lg lh li lj bi translated">双GRU模型</li><li id="fdb2" class="kz la hh iw b ix lk jb ll jf lm jj ln jn lo jr lg lh li lj bi translated">主要学习内容</li></ol></div><div class="ab cl lp lq go lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ha hb hc hd he"><h1 id="235e" class="kb kc hh bd kd ke lw kg kh ki lx kk kl km ly ko kp kq lz ks kt ku ma kw kx ky bi translated">1.问题定式化</h1><p id="a735" class="pw-post-body-paragraph iu iv hh iw b ix lb iz ja jb lc jd je jf mb jh ji jj mc jl jm jn md jp jq jr ha bi translated">手头的任务是在给定固定长度的先前序列的情况下预测单个时间序列值。为这个问题选择的加密货币将是中本聪的创造，独一无二的<strong class="iw hi">比特币</strong>。<strong class="iw hi"> </strong>但是<strong class="iw hi"> </strong>这可以很容易地扩展到任何令牌，您将在下一节中发现这一点。</p><p id="61aa" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">类型:</strong> <strong class="iw hi"> <em class="me">多变量单步</em> </strong>预测，即在序列中使用多个特征进行预测，而不是只使用一个特征(单变量预测)。单步表示预测序列前面的一个值。或者，也可以预测多个值。</p><p id="cedc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">性能度量:</strong>平均绝对误差(<strong class="iw hi"> MAE </strong>)，它是测试数据中绝对误差的平均值。</p><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es mf"><img src="../Images/0d4399dbfc17407a4a66aa89565b06f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/0*P7-a4U6s0KS5JqC8.png"/></div></figure><h1 id="1c05" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">2.收集数据</h1><p id="9f87" class="pw-post-body-paragraph iu iv hh iw b ix lb iz ja jb lc jd je jf mb jh ji jj mc jl jm jn md jp jq jr ha bi translated">我将利用<a class="ae it" href="https://lunarcrush.com/developers/docs" rel="noopener ugc nofollow" target="_blank"> LunarCRUSH API </a>获取历史比特币数据。此外，您可以实时获取几乎任何令牌的数据并对其进行分析，这使得该资源变得如此强大。我们将利用<a class="ae it" href="https://lunarcrush.com/developers/docs#assets" rel="noopener ugc nofollow" target="_blank">资产</a> Rest API端点来加载时序数据，并选择我们选择的任意数量的指标。</p><figure class="mg mh mi mj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mk"><img src="../Images/cc1cbc1c893505fa38fc4316f304f98e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I0t3hIUImrGyvMDL-U-2oA.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated"><a class="ae it" href="https://lunarcrush.com/developers/docs" rel="noopener ugc nofollow" target="_blank"> LunarCRUSH API </a></figcaption></figure><figure class="mg mh mi mj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ml"><img src="../Images/57c6411efb6bda1eeec377e4f3e871f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h0FG2t2h-zKHBXCi5WF9qQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">资产端点</figcaption></figure><p id="a5e3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">选择LunarCrush的原因是，除了返回开盘价/收盘价等正常的时间序列数据外，它还包括社交优势、情绪得分、推文频率、Reddit活跃度等有见地的指标，以及他们自己的一些指标，如所有受支持的加密货币资产的Galaxy得分。自由层计划允许我们一次请求720个数据点。</p><figure class="mg mh mi mj fd ii"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="b7f4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我来分解一下这个请求:</p><p id="e0dd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="me">'</em><strong class="iw hi"><em class="me">&amp;key =</em></strong><code class="du mo mp mq mr b"><em class="me">{api_key}</em></code><strong class="iw hi"><em class="me">'</em></strong>:<strong class="iw hi"><em class="me"/></strong>使用加载的API密钥(每个账户唯一)。</p><p id="d7f9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="me">'</em><strong class="iw hi"><em class="me">&amp;symbol =</em></strong><code class="du mo mp mq mr b"><em class="me">BTC</em></code><em class="me">'</em>:请求比特币的时序数据。也可以传递逗号分隔的列表来获取多种加密货币的数据。</p><p id="a92f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="me">'</em><strong class="iw hi"><em class="me">&amp;interval =</em></strong><code class="du mo mp mq mr b"><em class="me">day</em></code><em class="me">'</em>:间隔字符串值，可以是“小时”，也可以是“天”。如果省略，则默认为“小时”。</p><p id="04f8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="me">'</em>'<strong class="iw hi"><em class="me">&amp;time _ series _ indicators =</em></strong><code class="du mo mp mq mr b"><em class="me">{features}</em></code><em class="me">'</em>:要包含在时间序列值中的度量的逗号分隔列表。</p><p id="3c7a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="me">'</em>'<strong class="iw hi"><em class="me">&amp;data _ points =</em></strong><code class="du mo mp mq mr b"><em class="me">720</em></code><em class="me">'</em>:资产要包含的时间序列数据点的数量。默认为24。最多接受720个数据点。</p><figure class="mg mh mi mj fd ii"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="1225" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们接收到一个JSON字符串对象，其中包含时间序列数据，可以使用<code class="du mo mp mq mr b">json.loads()</code>方法解析并转换成Python字典对象。正如您在上面看到的，我们获得了我们传递的各个指标的比特币系列数据(仅显示了前三个数据点)，以及发送请求的特定日期的其他指标。</p><h1 id="e367" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">3.预处理数据</h1><p id="5f02" class="pw-post-body-paragraph iu iv hh iw b ix lb iz ja jb lc jd je jf mb jh ji jj mc jl jm jn md jp jq jr ha bi translated">有必要将原始数据转换为一种形式，这种形式可以进入数据分析的高级阶段，并可用于机器学习模型。让我们来看看这个过程中的一些步骤:</p><p id="5ac0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">转换为数据帧:</strong>首先，我们通过引用‘time series’键将时间序列JSON字符串转换为字典，并将其转换为pandas数据帧以供进一步处理。</p><pre class="mg mh mi mj fd ms mr mt mu aw mv bi"><span id="db03" class="mw kc hh mr b fi mx my l mz na">series_dict = json.loads(obj)[‘data’][0][‘timeSeries’]<br/>df = pd.DataFrame(series_dict)<br/>df</span></pre><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es nb"><img src="../Images/0e89b9b0e87b053ae59ed4d2c999e8e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*h9eMuPICAvGpommiF4pBBw.png"/></div></figure><p id="260b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">处理空值:</strong>有许多时间序列数据的插补技术，如后移下一次观测值(NOCB)、LOCF、线性/样条插值，但这些方法依赖于相邻观测值相似的假设。因为只有开始的20个点包含空值，所以我决定删除这些点本身。</p><pre class="mg mh mi mj fd ms mr mt mu aw mv bi"><span id="fc61" class="mw kc hh mr b fi mx my l mz na"># removing rows with null values<br/>df = df.dropna()<br/>df = df.reset_index(drop=True)</span></pre><p id="87cd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">提取日期和月份:</strong>time列包含Unix时间戳(从epoch开始的秒数)，可以使用datetime模块的<code class="du mo mp mq mr b">utcfromtimestamp()</code>方法将其转换为更易理解的格式。我们还将从时间戳中提取月份，这可用于下一节中的一些数据分析。</p><figure class="mg mh mi mj fd ii"><div class="bz dy l di"><div class="mm mn l"/></div></figure><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es nc"><img src="../Images/e9d47ac4e43495855499580def1ec39c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*ERstMcy1lO7OdytoAmS8Jw.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">最终数据帧</figcaption></figure><h1 id="7149" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">4.探索性数据分析</h1><h2 id="1a0d" class="mw kc hh bd kd nd ne nf kh ng nh ni kl jf nj nk kp jj nl nm kt jn nn no kx np bi translated"><strong class="ak">多重共线性</strong></h2><p id="266d" class="pw-post-body-paragraph iu iv hh iw b ix lb iz ja jb lc jd je jf mb jh ji jj mc jl jm jn md jp jq jr ha bi translated">具有一个以上隐藏层的神经网络<a class="ae it" href="https://datascience.stackexchange.com/a/87741" rel="noopener ugc nofollow" target="_blank">不会遭受多重共线性</a>。无论如何，检查彼此之间高度线性相关的特征是一个好的做法。我们将通过在pandas的<code class="du mo mp mq mr b">corr()</code>方法上使用seaborn的热图显示相关矩阵来检查数据集中的共线性。</p><pre class="mg mh mi mj fd ms mr mt mu aw mv bi"><span id="360d" class="mw kc hh mr b fi mx my l mz na">import seaborn as sns</span><span id="466b" class="mw kc hh mr b fi nq my l mz na">data = df.iloc[:, 2:].copy()<br/>ax = sns.heatmap(data.corr(), cmap='inferno', annot=True)</span></pre><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es nr"><img src="../Images/9cfbfa4617b3de64ccffc97f64bcf0d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*UDw1D2O80etDnRMi-1kzGg.png"/></div></figure><p id="c19b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mo mp mq mr b">Close</code>价格与推文和社交评分高度相关(&gt; 0.7)。如果你不熟悉,“预测者”和“目标”之间的相关性是更好的可预测性的良好标志。<code class="du mo mp mq mr b">tweets</code>和<code class="du mo mp mq mr b">social_score</code>如预期的那样高度相关，而<code class="du mo mp mq mr b">news</code>和<code class="du mo mp mq mr b">24h_%</code>与任何其他特征都不相关，这些特征并不令人印象深刻，但鉴于比特币的波动性，这是意料之中的。现在让我们绘制<code class="du mo mp mq mr b">close</code>和<code class="du mo mp mq mr b">social_score</code>来仔细观察特征之间的关系的本质。</p><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es ns"><img src="../Images/efc8af7ec150a5f41b8419fb63d71a66.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*L36VnHR9boOSRWNwvdBcLQ.png"/></div></figure><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es nt"><img src="../Images/335ef53051947c99fb76a6991c6879db.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*EZfjBxkm4FCbCLjbF5kdag.png"/></div></figure><p id="b752" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">上面的图再次证实了之前的观察:收盘价和社会活跃度几乎成反比。随着比特币价格上涨，推文活跃度和社交得分通常会下降(除非大幅上升)，而当市场下跌时，社交活跃度似乎会增加。为什么会这样呢？这个世界以恐惧和消极为食，在秘密空间中被称为“FUD”。</p><h2 id="bbce" class="mw kc hh bd kd nd ne nf kh ng nh ni kl jf nj nk kp jj nl nm kt jn nn no kx np bi translated"><strong class="ak">月度分析</strong></h2><p id="b0a1" class="pw-post-body-paragraph iu iv hh iw b ix lb iz ja jb lc jd je jf mb jh ji jj mc jl jm jn md jp jq jr ha bi translated">按月对我们的数据进行分组并探索趋势可以为我们提供一些关于特定令牌的有趣见解。</p><pre class="mg mh mi mj fd ms mr mt mu aw mv bi"><span id="9b07" class="mw kc hh mr b fi mx my l mz na">monthly = df.groupby('month').mean()<br/>monthly</span></pre><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es nu"><img src="../Images/dce6fa5be26727817495fa99dd335937.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*z99dB4u_Cpff8Ca4x4DhtQ.png"/></div></figure><p id="791b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们来看看社交得分和每日价格变化(百分比)是如何按月变化的。</p><figure class="mg mh mi mj fd ii"><div class="bz dy l di"><div class="mm mn l"/></div></figure><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es nv"><img src="../Images/f6fc6b97d0195b4145a2505324e882f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*u2OTM9dFrKgnxXvZq4y-qg.png"/></div></figure><figure class="mg mh mi mj fd ii"><div class="bz dy l di"><div class="mm mn l"/></div></figure><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es nv"><img src="../Images/9e99776b02dcfbcdcdeb83dad8a04db6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*PUq64iGcE8TNmY1yze0Cqw.png"/></div></figure><p id="eeb7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们可以再次间接观察到市场和社会活动之间的反向关系，六月和五月是社会活动最活跃的月份，同时也是社会活动最低迷的月份。九月表现突出，平均降幅第二，社交活动仍然最少。我们必须注意并记住，数据集仅限于700天(近2年)的数据，洞察仅限于这一时间框架，因此不能在未来数据点的月度或季度基础上进行概括。</p><h2 id="71fa" class="mw kc hh bd kd nd ne nf kh ng nh ni kl jf nj nk kp jj nl nm kt jn nn no kx np bi translated"><strong class="ak">烛台图表</strong></h2><p id="8c63" class="pw-post-body-paragraph iu iv hh iw b ix lb iz ja jb lc jd je jf mb jh ji jj mc jl jm jn md jp jq jr ha bi translated">蜡烛图是一种金融图表，用于描述证券、衍生品或货币的价格变动。在交易者指定的时间内，它使用四个价格点(开盘价、收盘价、最高价和最低价)。交易通常受情绪支配，这可以从蜡烛图中看出。</p><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es nw"><img src="../Images/15f11304ce91a5991bfe784bf1781f97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/0*6fsxNLdqq8SjhHTj.jpg"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">烛台吧。演职员表<a class="ae it" href="https://www.dummies.com/personal-finance/investing/technical-analysis/basics-of-candlestick-charts-in-technical-analysis/" rel="noopener ugc nofollow" target="_blank">dummies.com</a></figcaption></figure><p id="d2c2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">它有三个基本特征:</p><ol class=""><li id="97d3" class="kz la hh iw b ix iy jb jc jf nx jj ny jn nz jr lg lh li lj bi translated"><strong class="iw hi">主体</strong>代表从打开到关闭的范围。</li><li id="7723" class="kz la hh iw b ix lk jb ll jf lm jj ln jn lo jr lg lh li lj bi translated"><strong class="iw hi">灯芯</strong>，或阴影，表示日内最高价和最低价。</li><li id="ac1c" class="kz la hh iw b ix lk jb ll jf lm jj ln jn lo jr lg lh li lj bi translated"><strong class="iw hi">颜色</strong>，揭示市场运动方向——绿色(或白色/蓝色)体表示价格上涨，红色(或黑色)体表示价格下跌。</li></ol><p id="5378" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将使用<a class="ae it" href="https://plotly.com/" rel="noopener ugc nofollow" target="_blank"> Plotly </a>，一个交互式图形库和袖扣库，使我们能够直接从熊猫创建可视化。如果为给定的资产提供了所需的开盘、收盘、盘高和盘低柱，该方法可以轻松地绘制出蜡烛图。</p><figure class="mg mh mi mj fd ii"><div class="bz dy l di"><div class="mm mn l"/></div></figure><figure class="mg mh mi mj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es oa"><img src="../Images/ed565089406086163ada2a4a78c53e50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4zpmX8hvJWb8Qi1nZVP66g.png"/></div></div></figure><p id="baa6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这是2019年8月28日至2021年7月27日所有数据点的简单移动平均线(红色)的烛台图快照。该图本质上是交互式的(在笔记本中)，可以在特定时间段内放大或缩小，如下所示为最近2个月的情况。</p><figure class="mg mh mi mj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es oa"><img src="../Images/82b5ddeebf765e6caaad948f2959cafa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4GZw-Y3ILD8bM7eWvTs0Cw.png"/></div></div></figure><p id="1a84" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">专业交易员利用蜡烛图作为技术分析的最重要组成部分之一，来识别不同类型的模式(看涨、看跌和中性)，并做出购买、出售或持有资产的相关决定。更多探索，你可以在这里找到最流行的烛台图案<a class="ae it" href="https://www.ig.com/en/trading-strategies/16-candlestick-patterns-every-trader-should-know-180615" rel="noopener ugc nofollow" target="_blank"/>。</p><h1 id="cc8d" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">5.生成序列数据</h1><p id="2f5c" class="pw-post-body-paragraph iu iv hh iw b ix lb iz ja jb lc jd je jf mb jh ji jj mc jl jm jn md jp jq jr ha bi translated">这是本帖最微妙也是最关键的部分。如果序列数据不合适，或者哪怕有一点点错误，所有的预测模型都会崩溃。首先，让我们看看如何分割数据集和缩放要素。</p><h2 id="0946" class="mw kc hh bd kd nd ne nf kh ng nh ni kl jf nj nk kp jj nl nm kt jn nn no kx np bi translated">基于时间的拆分:</h2><p id="e851" class="pw-post-body-paragraph iu iv hh iw b ix lb iz ja jb lc jd je jf mb jh ji jj mc jl jm jn md jp jq jr ha bi translated">标准化数据集中的特征(即，将它们放在相同的尺度上)是神经网络良好运行和更快收敛所必需的。我们更喜欢进行基于时间的分割，而不是随机分割——将时间序列数据分割成训练集和测试集。在我们的例子中，训练数据点将用于预测过去30天的价格。首先，我们将数据拟合到<code class="du mo mp mq mr b">split_index</code>，然后使用sklearn的<code class="du mo mp mq mr b">StandardScaler</code>实现来缩放数据集。</p><figure class="mg mh mi mj fd ii"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="c7e7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">除了缩放特征之外，保持标签(<code class="du mo mp mq mr b">close</code>价格)的缩放比例(均值和方差)也很重要。该缩放器将用于将预测转换回最初使用<code class="du mo mp mq mr b">inverse_transform</code>方法的比例，如稍后在绘图功能中演示的。</p><h2 id="6348" class="mw kc hh bd kd nd ne nf kh ng nh ni kl jf nj nk kp jj nl nm kt jn nn no kx np bi translated">进入序列数据的窗口</h2><p id="cec3" class="pw-post-body-paragraph iu iv hh iw b ix lb iz ja jb lc jd je jf mb jh ji jj mc jl jm jn md jp jq jr ha bi translated">首先，让我直观地告诉您如何对数据点进行窗口处理，并生成序列数据，这些数据可以输入到模型中进行预测。</p><pre class="mg mh mi mj fd ms mr mt mu aw mv bi"><span id="f891" class="mw kc hh mr b fi mx my l mz na">1 --&gt; 2 --&gt; 3 --&gt; 4 --&gt; 5 --&gt; 6 --&gt; 7 --&gt; 8 --&gt; 9 --&gt; 10</span></pre><p id="36a6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们假设一个简单的时间序列，前十个自然数。现在我们将把它转换成给定窗口大小的序列。<strong class="iw hi">窗口大小</strong>决定了每个序列的长度，并且是一个超参数，选择正确的大小将导致最佳结果。假设窗口大小为4，序列将如下所示:</p><pre class="mg mh mi mj fd ms mr mt mu aw mv bi"><span id="b3ae" class="mw kc hh mr b fi mx my l mz na">features --&gt; label<br/>__________________</span><span id="a4f8" class="mw kc hh mr b fi nq my l mz na">1, 2, 3, 4 --&gt; 5<br/>2, 3, 4, 5 --&gt; 6<br/>3, 4, 5, 6 --&gt; 7<br/>4, 5, 6, 7 --&gt; 8</span></pre><p id="60ff" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">给定左边的序列，该模型将被训练来预测相应的标签。类似地，在我们的例子中，训练集和测试集都将以这种格式形成。主要的区别是我们正在处理一个多变量的问题，它将包括4维而不是1维的序列。</p><figure class="mg mh mi mj fd ii"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="8211" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们定义一个<code class="du mo mp mq mr b">windowingData</code>函数，它接受数据集的开始/结束索引、窗口大小(<code class="du mo mp mq mr b">14</code>和数据集本身。该函数返回训练数据和测试数据的序列及其各自的标签。</p><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es ob"><img src="../Images/e385d0fd4ce0bf27d2c0e69b598a6be5.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*Cnrj-xIT4V3I086gJG90zQ.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">训练和测试数据形状。</figcaption></figure><p id="2ccd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">训练数据包含656个序列，每个输入序列的大小为14x4，即14天，具有4个特征:关闭、推文、社交得分和新闻。下面显示的输入序列预计输出值-0.5761。</p><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es oc"><img src="../Images/3cb8ed805b69985455f564e683907b72.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*zwIrdI0xuDqZEg8Ip49n-g.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">样本输入序列和标签。</figcaption></figure><h2 id="5263" class="mw kc hh bd kd nd ne nf kh ng nh ni kl jf nj nk kp jj nl nm kt jn nn no kx np bi translated">绘图功能:</h2><p id="9ea9" class="pw-post-body-paragraph iu iv hh iw b ix lb iz ja jb lc jd je jf mb jh ji jj mc jl jm jn md jp jq jr ha bi translated">定义这个效用绘图函数将帮助我们方便地对测试数据进行单个未来预测或多个未来预测的绘图。</p><figure class="mg mh mi mj fd ii"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="c30c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">该函数接受数据标签(历史、真实和预测的未来)、先前保存的定标器、绘图标题和一个布尔变量作为参数。<code class="du mo mp mq mr b">multi</code>决定剧情类型，单未来或多未来。使用保存的缩放器将点转换为其原始比例，并使用相关标记进行绘制，如下图示例所示:</p><pre class="mg mh mi mj fd ms mr mt mu aw mv bi"><span id="b2fa" class="mw kc hh mr b fi mx my l mz na">i = 0<br/>day = df.index[i+14]<br/>title = f'Sample plot: {day}'<br/>ax = plot((X_train[i], y_train[i]), scaler_labels, title)</span></pre><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es od"><img src="../Images/13524095a6472bdde8b31f62437f133d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*hnsquMdEO1J5hCprqkEfFQ.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">第一个输入序列和标签，原始比例。</figcaption></figure><h1 id="e1d3" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">6.基线模型</h1><p id="5390" class="pw-post-body-paragraph iu iv hh iw b ix lb iz ja jb lc jd je jf mb jh ji jj mc jl jm jn md jp jq jr ha bi translated">基线模型通常是您可以实现的最基本的模型，对于前面的复杂模型，它们的性能应该是最低的。在我们的例子中，我们将实现一个简单的移动窗口平均模型，它将返回最后14个观察值(收盘价)的平均值作为输出。</p><figure class="mg mh mi mj fd ii"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="ebd7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">该函数将在通过测试数据时返回一个值列表(序列的平均值),这是一个三维numpy数组。让我们来看几个基于基线模型的预测:</p><div class="mg mh mi mj fd ab cb"><figure class="oe ii of og oh oi oj paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/28fb57d573804da8a5bad13157b12727.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*dSDK1dWS_IwXxtz3mdIQ8Q.png"/></div></figure><figure class="oe ii of og oh oi oj paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/2fe63298063846f194ca50d6ba01c0d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*vs7SWfdoJCW-C7pzzvvxtg.png"/></div></figure></div><p id="505b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">还不错！我们现在将通过使用<code class="du mo mp mq mr b">base_ma</code>函数传递测试序列、标签和移动平均值来可视化所有测试数据的所有单步预测。</p><figure class="mg mh mi mj fd ii"><div class="bz dy l di"><div class="mm mn l"/></div></figure><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es ok"><img src="../Images/ca16f84914aa885772c33e9e099bfc9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*GpQ_Z8PtTbTsmlcAqMdHfA.png"/></div></figure><p id="632e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">预测曲线看起来过于简单，比真实的未来价格更平滑，但仍然做得不错。因此，预计下一个模型将更好地概括预测，但在实施之前，我将在下一节中简要介绍序列模型及其特点或优势。</p><h1 id="d720" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">7.序列模型介绍</h1><blockquote class="ol om on"><p id="ef96" class="iu iv me iw b ix iy iz ja jb jc jd je oo jg jh ji op jk jl jm oq jo jp jq jr ha bi translated">人类不是每秒钟都从零开始思考。当你阅读这篇文章时，你是在理解前面单词的基础上理解每个单词的。你不会抛弃一切，重新从头开始思考。你的思想有持久性。</p></blockquote><p id="0567" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">以上是克里斯多夫·奥拉在《T4》中对RNN和LSTM的精彩阐述中的一段。传统的技术和神经网络根本不关心序列的概念，也不能保存以前对解决当前任务有用的信息。<strong class="iw hi">循环神经网络</strong>前来救援。RNN可以被认为是同一个神经网络的多个副本，随着时间的推移，将信息从一个时间点传送到另一个时间点。</p><figure class="mg mh mi mj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es or"><img src="../Images/5bf4f198f60f04fbb8219fce4d39b8a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*n13ps8cFeRxK_DVK.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">展开RNN。演职员表:<a class="ae it" href="https://en.wikipedia.org/wiki/Recurrent_neural_network" rel="noopener ugc nofollow" target="_blank">维基百科</a></figcaption></figure><p id="790c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">但是RNN患有<strong class="iw hi">短期记忆</strong>。如果一个序列足够长，它们将很难把信息从较早的时间步骤传送到较晚的时间步骤。考虑尝试预测<code class="du mo mp mq mr b">“Lionel Messi is Argentine, he speaks Spanish.”</code>中的最后一个单词最近的信息表明，最后一个单词应该是一种语言的名称。在这里，上下文单词<code class="du mo mp mq mr b">“Argentine”</code>和最后一个单词之间的差距很小，但是随着这种差距的扩大，RNN将无法很好地表现。在反向传播过程中，RNN可能会遇到<strong class="iw hi">消失梯度</strong>问题。当一个梯度变得太小，对学习的贡献就不大。</p><p id="b6c6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">长短期记忆(<strong class="iw hi"> LSTM的</strong>)网络和门控循环单元(<strong class="iw hi"> GRU的</strong>)负责长期依赖性。它们是特殊种类的RNN，具有被称为“门”的内部机制来调节信息的流动。</p><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es os"><img src="../Images/7e52fe44e1594906717195c0acd95a01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/0*cYAdTN-vJJ5A-6JQ"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">LSTM和GRU建筑。<a class="ae it" href="https://www.slideshare.net/hytae/recent-progress-in-rnn-and-nlp-63762080" rel="noopener ugc nofollow" target="_blank">学分</a></figcaption></figure><p id="e026" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这些门具有不同的功能，例如保留来自前一单元(时间步长)的累积信息的多少部分，或者确定当前单元的输出。GRU的体系结构不太复杂，导致方程较少，这反过来加快了反向传播。因此，GRU的解决方案提供了更快、更有效的解决方案，并且被发现在更少量的数据上表现得更好。因此，可以说GRU比LSTM更适合我们的问题。</p><h2 id="a3d7" class="mw kc hh bd kd nd ne nf kh ng nh ni kl jf nj nk kp jj nl nm kt jn nn no kx np bi translated"><strong class="ak">双向网络:</strong></h2><figure class="mg mh mi mj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ot"><img src="../Images/2072d5501aa91067913a283af6ff124f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BW4K3cuXvPMA7uwM.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">双向RNN。<a class="ae it" href="https://www.researchgate.net/figure/Bidirectional-recurrent-neural-networks-BRNNs_fig3_282530613" rel="noopener ugc nofollow" target="_blank">学分</a></figcaption></figure><p id="61cf" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在双向RNN中，一个网络的输入序列按正常时间顺序输入，另一个网络则按相反的时间顺序输入。这两个网络的输出通常在每个时间步被连接起来。这种实现允许网络在每个时间步都具有关于该序列的前向和后向信息，即也查看未来的上下文。</p><h1 id="635c" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">8.LSTM模型</h1><p id="4935" class="pw-post-body-paragraph iu iv hh iw b ix lb iz ja jb lc jd je jf mb jh ji jj mc jl jm jn md jp jq jr ha bi translated">现在是代码实现和测试一些模型的时候了。我将利用<code class="du mo mp mq mr b">Tensorflow 2.0/Keras</code>。首先，我们将定义一些<strong class="iw hi">回调</strong>，这是在培训或评估阶段定制我们模型的一种强有力的方式。</p><figure class="mg mh mi mj fd ii"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="7c8f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mo mp mq mr b">ModelCheckpoint</code>:以某一频率保存模型或模型权重，在我们的情况下，只要验证损失最小(最佳权重)。</p><p id="9468" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mo mp mq mr b">EarlyStopping</code>:当确认损失10个周期没有改善时，停止训练。</p><p id="62f6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mo mp mq mr b">LearningRateScheduler</code>:每隔2个历元降低5%的学习率。为了取得更好的成绩，经常改变/降低学习速度通常是一个很好的做法。</p><figure class="mg mh mi mj fd ii"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="d405" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这是一个堆叠的LSTM架构(多个LSTM层)，带有<code class="du mo mp mq mr b">Relu</code>激活和<code class="du mo mp mq mr b">Adam</code>优化器。使用<code class="du mo mp mq mr b">return_sequences=True</code>，下一层的输入将是一个相同长度的序列，而不仅仅是一个向量。</p><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es ou"><img src="../Images/2b659cc3713957a4f0875aefa6f9cd12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*VWu9oKV53szGjx_gF3ftiQ.png"/></div></figure><h2 id="d05e" class="mw kc hh bd kd nd ne nf kh ng nh ni kl jf nj nk kp jj nl nm kt jn nn no kx np bi translated">综合预测:</h2><pre class="mg mh mi mj fd ms mr mt mu aw mv bi"><span id="c184" class="mw kc hh mr b fi mx my l mz na">day = df.index[670]<br/>title = f'LSTM model: {day} onwards'<br/>ax = plot((y_train[-30:], y_test, lstm.predict(X_test)), scaler_labels, title, multi=True)</span></pre><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es ok"><img src="../Images/8f609170235d2ac41429883ebfe9e9f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*C5dyUGmBWsPz8Yn1p1w69w.png"/></div></figure><p id="9f6b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">预测曲线比基线移动平均线稍精确，但不太平滑。然而，它无法更精确地描述比特币价格在接近尾声时的突然上涨，以及在开始时相当低的价格。让我们尝试另一种架构。</p><h1 id="b4fa" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">9.双GRU模型</h1><p id="0c16" class="pw-post-body-paragraph iu iv hh iw b ix lb iz ja jb lc jd je jf mb jh ji jj mc jl jm jn md jp jq jr ha bi translated">如前所述，有理由假设GRU可能更适合这个问题。此外，我们将利用<strong class="iw hi">堆叠双向GRU的</strong>，最终使用密集连接层，而不是另一个GRU层。休息与辍学相同，以控制过度拟合，重新激活和亚当优化。</p><figure class="mg mh mi mj fd ii"><div class="bz dy l di"><div class="mm mn l"/></div></figure><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es ov"><img src="../Images/67c357f798d24241ad42bcc79a6313ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*0h6iFrSxxJaoq4tNZsiUBQ.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">BiGRU训练阶段，过去10个纪元。</figcaption></figure><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es ow"><img src="../Images/96f620a0fe6b4af93e6fdeadbfe862f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*QIdRErYqwZeY1si702NmNQ.png"/></div></figure><p id="8302" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们从第30个<strong class="iw hi">时段(图中的#29)加载模型权重，这给了我们最佳的测试损失(在随后的时段中没有改善)。注意，训练损失持续下降，直到最后一个时期，并且随着两个损失之间的差距扩大，过拟合增加。我们来看一些测试数据序列的单步预测和合并预测。</strong></p><div class="mg mh mi mj fd ab cb"><figure class="oe ii of og oh oi oj paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/baeeed681c10a713529dfe54b99ed6df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*0Hzd6qyHR-GR84RHGgip6Q.png"/></div></figure><figure class="oe ii of og oh oi oj paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/aa1d943a49a7eb54c14375644f586fa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*3u5wK09V4WZV4yd7KRrSWw.png"/></div></figure></div><h2 id="c8b2" class="mw kc hh bd kd nd ne nf kh ng nh ni kl jf nj nk kp jj nl nm kt jn nn no kx np bi translated">综合预测:</h2><pre class="mg mh mi mj fd ms mr mt mu aw mv bi"><span id="9e5a" class="mw kc hh mr b fi mx my l mz na">day = df.index[670]<br/>title = f'BiGRU model: {day} onwards'<br/>ax = plot((y_train[-30:], y_test, BiGRU.predict(X_test)), scaler_labels, title, multi=True)</span></pre><figure class="mg mh mi mj fd ii er es paragraph-image"><div class="er es ok"><img src="../Images/f3b63ef1ef1ec9529baa96567a0a831d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*IGLrxEaOIgkrmW-XF3U6vQ.png"/></div></figure><p id="a47a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">绝对是三个模型中对比特币价格最好的概括。当合并后，它能够比LSTM更好地预测接近尾声时的突然上升。几乎不可能预测准确的价格，但利用社交评分或新闻活动等特征提前了解资产价格方向是一个重大利好。</p><figure class="mg mh mi mj fd ii"><div class="bz dy l di"><div class="mm mn l"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">车型对比。</figcaption></figure><h1 id="c8d1" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">10.主要学习内容</h1><p id="5c07" class="pw-post-body-paragraph iu iv hh iw b ix lb iz ja jb lc jd je jf mb jh ji jj mc jl jm jn md jp jq jr ha bi translated">学习了从零开始为金融数据构建多变量时间序列预测模型的生命周期，步骤包括:获取实时加密货币数据，清理并转换为相关格式，通过数据分析了解关键模式，生成序列数据，实施并调整序列模型。</p><h2 id="07e7" class="mw kc hh bd kd nd ne nf kh ng nh ni kl jf nj nk kp jj nl nm kt jn nn no kx np bi translated">未来的工作</h2><p id="738e" class="pw-post-body-paragraph iu iv hh iw b ix lb iz ja jb lc jd je jf mb jh ji jj mc jl jm jn md jp jq jr ha bi translated">从特征工程的角度来看，可以添加一些复杂的特征(例如，当天最高价和最低价的差异/平均值)。如果有更多的数据点以及模型架构的变化，那么像窗口大小(在我们的例子中是14天)这样的超参数可能会增加。</p><h2 id="432a" class="mw kc hh bd kd nd ne nf kh ng nh ni kl jf nj nk kp jj nl nm kt jn nn no kx np bi translated">参考</h2><p id="f809" class="pw-post-body-paragraph iu iv hh iw b ix lb iz ja jb lc jd je jf mb jh ji jj mc jl jm jn md jp jq jr ha bi translated">[1]应用人工智能课程，【https://www.appliedaicourse.com/ T2】</p><p id="57e4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">[2] LunarCRUSH API，【https://lunarcrush.com/developers/docs T4】</p><p id="ac93" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">[3] Tensorflow教程，时间序列预测，<a class="ae it" href="https://www.tensorflow.org/tutorials/structured_data/time_series" rel="noopener ugc nofollow" target="_blank">https://www . tensor flow . org/tutorials/structured _ data/time _ series</a></p><p id="4fcc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">[4]克里斯多佛·奥拉，2015年，<a class="ae it" href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/" rel="noopener ugc nofollow" target="_blank">https://colah.github.io/posts/2015-08-Understanding-LSTMs/</a></p><p id="9693" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">[5] Michael Phi，2018，<a class="ae it" href="https://towardsdatascience.com/illustrated-guide-to-lstms-and-gru-s-a-step-by-step-explanation-44e9eb85bf21" rel="noopener" target="_blank">https://towardsdatascience . com/illustrated-guide-to-lstms-and-gru-s-a-step-by-step-explain-44e 9 EB 85 BF 21</a></p><p id="1c6e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">[6]贾森·龙，2016年，<a class="ae it" href="https://senseful.github.io/text-table/" rel="noopener ugc nofollow" target="_blank">https://senseful.github.io/text-table/</a></p></div></div>    
</body>
</html>