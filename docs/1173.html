<html>
<head>
<title>Random Forest(🎄🌴🌲) for Regression…</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">随机森林(🎄🌴🌲)对于回归…</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/random-forest-for-regression-199ef5e8c34c?source=collection_archive---------15-----------------------#2021-02-17">https://medium.com/analytics-vidhya/random-forest-for-regression-199ef5e8c34c?source=collection_archive---------15-----------------------#2021-02-17</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/d427c707cf423e8be9fc4e467b8008fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*62doyy__fWMOEGhr"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">随机森林</figcaption></figure><p id="4f32" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">随机森林或随机决策森林，是一种<em class="jr">机器学习算法。</em>它也是使用最多的算法之一，因为它很简单。</p><p id="7608" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">随机森林是一种使用“装袋”方法训练几个决策树的集成方法。</p><p id="7a76" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在了解随机森林直觉之前，我们先了解一下</p><h2 id="7a81" class="js jt hh bd ju jv jw jx jy jz ka kb kc je kd ke kf ji kg kh ki jm kj kk kl km bi translated"><strong class="ak">为什么，随机森林？</strong></h2><p id="6fe4" class="pw-post-body-paragraph it iu hh iv b iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm kr jo jp jq ha bi translated">随机森林是决策树的替代品。像森林一样，随机森林算法由多个单独的决策树组成。它<strong class="iv hi">减少模型的方差而不增加偏差</strong>。它也适用于高维数据，并且比决策树训练速度更快。</p><blockquote class="ks kt ku"><p id="8865" class="it iu jr iv b iw ix iy iz ja jb jc jd kv jf jg jh kw jj jk jl kx jn jo jp jq ha bi translated">事实:<br/>随机森林经常被用作商业中的“黑箱”模型，其背后的原因是它们可以通过大范围的数据生成合理的预测。</p></blockquote><h2 id="ad0c" class="js jt hh bd ju jv jw jx jy jz ka kb kc je kd ke kf ji kg kh ki jm kj kk kl km bi translated">随机森林算法背后的理论:</h2><p id="7405" class="pw-post-body-paragraph it iu hh iv b iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm kr jo jp jq ha bi translated">随机森林应用<strong class="iv hi"> bootstrap聚合</strong>或<strong class="iv hi"> Bagging算法的通用技术。</strong></p><blockquote class="ks kt ku"><p id="7dbc" class="it iu jr iv b iw ix iy iz ja jb jc jd kv jf jg jh kw jj jk jl kx jn jo jp jq ha bi translated"><strong class="iv hi">重复(B次)的Bagging算法</strong>选择随机样本，替换训练集，并使树适合这些样本。</p></blockquote><p id="e6b7" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在决策树中，单个树的预测对其训练集中的噪声高度敏感，但是在自举过程的情况下，我们取许多树的平均值，这有助于减少噪声。</p><p id="898a" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在随机森林中，唯一的区别是他们使用一种改进的树学习算法，该算法在学习过程中选择每个候选特征的随机子集，这被称为<strong class="iv hi">“特征打包”</strong></p><p id="bb41" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi ky translated">我是时候把手弄脏了！！！</p><p id="7014" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">现在，在这篇博客中，我不会解释数据清理、探索性数据分析、特性缩放或标准标量化。你可以在我之前关于使用python 的<a class="ae lh" rel="noopener" href="/analytics-vidhya/decision-tree-using-python-for-regression-ecf0ccd8884e">决策树的博客中读到。</a></p><p id="2d1f" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我将从训练数据集开始，</p><p id="2178" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">为了训练数据集，我们将使用Scikit-Learn库中的Ensemble模块。</p><blockquote class="ks kt ku"><p id="739b" class="it iu jr iv b iw ix iy iz ja jb jc jd kv jf jg jh kw jj jk jl kx jn jo jp jq ha bi translated"><a class="ae lh" href="https://scikit-learn.org/stable/modules/ensemble.html#ensemble" rel="noopener ugc nofollow" target="_blank"> <strong class="iv hi">集成方法</strong> </a>的目标是结合用给定学习算法构建的几个基本估计量的预测，以提高单个估计量的可推广性/鲁棒性。</p></blockquote><p id="2d29" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在系综模块中，我们将使用RandomForestRegressor。<br/>导入库:</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="a723" class="js jt hh ln b fi lr ls l lt lu"># Importing the library<br/>from sklearn.ensemble import RandomForestRegressor</span></pre><p id="ee12" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">现在，在我们去拟合数据集之前，让我们了解几个重要的参数。<br/> 1。<strong class="iv hi"> n_estimators </strong> : int，default value = 100 <br/>它估计森林中的树木数量</p><p id="9c58" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">2.<strong class="iv hi">判据</strong> : {'mse '，' mae'}，default = 'mse' <br/> mse =均方误差<br/> mae =平均绝对误差<br/>这有助于衡量拆分的质量。</p><p id="cfa6" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">3.<strong class="iv hi"> max_depth </strong> : int，default = None <br/>树的最大深度。</p><p id="1268" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">4.<strong class="iv hi"> random_state </strong> : int，default = None <br/>控制构建树时使用的样本自举的随机性。</p><p id="e3ac" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">让我们创建一个RandomForesetRegressor方法的对象，</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="0146" class="js jt hh ln b fi lr ls l lt lu"># Object of the method<br/>regressor = RandomForestRegressor(n_estimators = 200, max_depth = 4, random_state = 0)</span></pre><p id="c958" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">既然我们的方法已经有了一个对象，那么是时候去适应训练和测试数据集了，</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="6d1d" class="js jt hh ln b fi lr ls l lt lu"># Fitting the dataset<br/>regressor.fit(X_train, y_train)</span></pre><blockquote class="ks kt ku"><p id="69fb" class="it iu jr iv b iw ix iy iz ja jb jc jd kv jf jg jh kw jj jk jl kx jn jo jp jq ha bi translated">注意:X_train和y_train是在split方法中初始化的。</p></blockquote><p id="a076" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我们将使用预测方法来预测我们的测试结果，</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="506d" class="js jt hh ln b fi lr ls l lt lu"># Prediction<br/>pred = regressor.predict(X_test)</span></pre><p id="2dbb" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">现在我们将找出准确性和F1分数，为此我们将从sklearn导入矩阵模块</p><pre class="li lj lk ll fd lm ln lo lp aw lq bi"><span id="73a9" class="js jt hh ln b fi lr ls l lt lu"># importing the library<br/>from sklearn.metrics import accuracy_score, f1_score<br/>print('Accuracy of our dataset is:', accuracy_score(y_test, pred))<br/>print('f1 score of our dataset is:', f1_score(y_test, pred))</span></pre><p id="87b7" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">Colab笔记本:</p><div class="lv lw ez fb lx ly"><a href="https://colab.research.google.com/drive/1PCRAQfOkkPuNftiz6r-tPiCxJUy2tkbM?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab dw"><div class="ma ab mb cl cj mc"><h2 class="bd hi fi z dy md ea eb me ed ef hg bi translated">谷歌联合实验室</h2><div class="mf l"><h3 class="bd b fi z dy md ea eb me ed ef dx translated">编辑描述</h3></div><div class="mg l"><p class="bd b fp z dy md ea eb me ed ef dx translated">colab.research.google.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm in ly"/></div></div></a></div><blockquote class="mn"><p id="13ae" class="mo mp hh bd mq mr ms mt mu mv mw jq dx translated">编码快乐！！</p></blockquote></div></div>    
</body>
</html>