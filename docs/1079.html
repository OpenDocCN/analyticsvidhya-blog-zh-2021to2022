<html>
<head>
<title>Machine Learning: How to Handle Class Imbalance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习:如何处理班级失衡</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/machine-learning-how-to-handle-class-imbalance-920e48c3e970?source=collection_archive---------7-----------------------#2021-02-13">https://medium.com/analytics-vidhya/machine-learning-how-to-handle-class-imbalance-920e48c3e970?source=collection_archive---------7-----------------------#2021-02-13</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/56e5f600c8995dde01ea80ba3269b76c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oBdmmY8h4CKbqemwjC-9kw.png"/></div></div></figure><h2 id="2aab" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated"><strong class="ak">简介:</strong></h2><p id="cbd1" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">当构建分类模型时，您可能会获得很好的结果(高准确度分数),但会意识到您的模型只是将每个观察值预测到一个类。这是阶级不平衡造成的。类别不平衡是机器学习中的一个问题，其中一类数据的总数远远超过另一类数据的总数。为了说明类别不平衡是什么样子以及它是如何工作的，我们假设您有一个两个类别的数据集，其中包括50名糖尿病患者和5000名非糖尿病患者。在这个例子中，分类模型倾向于将患者分类为非糖尿病患者，因为它不能拾取将导致患者患有糖尿病的数据和趋势。即使该模型通过仅仅将每个患者分类为非糖尿病患者而以99%的准确率结束，该模型也不能有效地对患者进行适当的分类。</p><p id="8e6d" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">许多数据集在每个类中都有奇数个实例，但微小的差异通常是可以接受的。根据经验，如果两个类的数据集之间的差异大于65%到35%，那么它应该被视为具有类不平衡的数据集。如果您使用的数据集包含两个以上的类，并且不确定是否存在类不平衡，您可以随时尝试在不进行任何调整的情况下运行您的模型，并确定模型是否正常运行，或者它是否仅预测某些类。</p><h2 id="643b" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated"><strong class="ak">处理阶层失衡的方法:</strong></h2><p id="fb8b" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated"><strong class="jp hi">我)使用不同的绩效指标</strong></p><p id="5f22" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">如前所述，当数据中存在类别不平衡时，准确度分数不是一个好的度量标准。在处理班级失衡时，一些指标可能更有帮助:</p><ul class=""><li id="3c63" class="kn ko hh jp b jq ki ju kj ja kp je kq ji kr kh ks kt ku kv bi translated">精度—相关实例在检索到的实例中所占的比例</li><li id="b1f6" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">召回—检索到的相关实例的比例</li><li id="6c3a" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">F1分数—精确度和召回率的加权平均值</li><li id="5ab8" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">混淆矩阵——说明正确预测和错误预测的表格</li></ul><figure class="lc ld le lf fd ii er es paragraph-image"><div class="er es lb"><img src="../Images/5148d3caf0f14a752001d9285e0d81ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*IkFDEZHk1Jbx4b1h8VAZlQ.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx translated">精确度和召回率</figcaption></figure><figure class="lc ld le lf fd ii er es paragraph-image"><div class="er es lk"><img src="../Images/a59edc34db913a612481f6a60e6340d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*g5zpskPaxO8uSl0OWT4NTQ.png"/></div><figcaption class="lg lh et er es li lj bd b be z dx translated">混淆矩阵</figcaption></figure><p id="1af3" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><strong class="jp hi"> II)收集更多数据</strong></p><p id="4139" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">这可能是不言自明的，但是，通过收集更多的数据，您可能能够创建一个更加平衡的数据集。如果有更多的数据可以帮助平衡数据集中的类，这可能是一种简单易行的解决类不平衡的方法。</p><p id="86ab" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><strong class="jp hi"> III)对数据集进行重新采样</strong></p><p id="e606" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">您可以通过添加少数类的实例副本(过采样)或删除多数类的实例(欠采样)来对数据集进行重采样，以创建更加平衡的数据集。这两种方法非常简单，易于实现。根据一般经验，当数据集非常大时，通常应该使用欠采样。同样，当数据集很小时，通常应该使用过采样。不管怎样，尝试这两种方法并看看你的结果会受到怎样的影响是没有坏处的。</p><p id="5940" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><strong class="jp hi"> IV)生成合成样本</strong></p><p id="f8b4" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">您可以使用一些算法来生成合成样本，如SMOTE(合成少数过采样技术)和Tomek链接。</p><p id="cefa" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">SMOTE是一种从少数类创建合成样本的过采样方法。它的工作原理是选择彼此相似的少数观察值，并在示例之间画一条线，以创建新的合成样本。</p><p id="0369" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">Tomek链接通过检测最近邻的相反类的观察值来工作。它删除这些对的大多数实例。Tomek链接的目标是澄清少数民族和多数民族类之间的边界，以使少数民族区域在模型中更加明显。</p><h2 id="de37" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated"><strong class="ak">参考文献:</strong></h2><ul class=""><li id="a0bf" class="kn ko hh jp b jq jr ju jv ja ll je lm ji ln kh ks kt ku kv bi translated">队伍，走向AI。"处理阶层失衡——虚拟分类器."<em class="lo">走向人工智能——最好的技术、科学和工程</em>，2020年8月2日，</li><li id="02b6" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">布朗利，杰森。"在你的机器学习数据集中对抗不平衡类的8个策略."<em class="lo">机器学习掌握</em>，2020年8月15日，machinelingmastery . com/tactics-to-combat-unbalanced-classes-in-your-Machine-Learning-dataset/。</li><li id="bd60" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">布朗利，杰森。"对不平衡分类的温和介绍."<em class="lo">机器学习掌握</em>，2020年1月14日，machinelementmastery . com/what-is-unbalanced-classification/。</li><li id="49d2" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">布朗利，杰森。"如何结合过采样和欠采样进行不平衡分类."<em class="lo">机器学习掌握</em>，2021年1月4日，machinelementmastery . com/combine-over-sampling-under-sampling-for-unbalanced-class ification/。</li><li id="70b1" class="kn ko hh jp b jq kw ju kx ja ky je kz ji la kh ks kt ku kv bi translated">“从不平衡的班级中学习。”<em class="lo">kdnugges</em>，<a class="ae lp" href="http://www.kdnuggets.com/2016/08/learning-from-imbalanced-classes.html/2." rel="noopener ugc nofollow" target="_blank">www . kdnugges . com/2016/08/learning-from-unbalanced-classes . html/2。</a></li></ul></div></div>    
</body>
</html>