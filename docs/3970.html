<html>
<head>
<title>Solving your first Regression Program — House Price Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解决你的第一个回归程序——房价预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/solving-your-first-regression-program-house-price-prediction-bc31a0fe9e7b?source=collection_archive---------6-----------------------#2021-08-14">https://medium.com/analytics-vidhya/solving-your-first-regression-program-house-price-prediction-bc31a0fe9e7b?source=collection_archive---------6-----------------------#2021-08-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="0664" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，在本文中，我们将解决预测房价的第一个回归程序。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/d46d2302232607dade28a5270c38bf97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qc2I5z5PscJfr5o0h5-5Ug.jpeg"/></div></div></figure><p id="b1a3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，你得准备好环境。我上传了一个YouTube视频来指导你安装Python和iPython (Jupyter笔记本)。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jo jp l"/></div></figure><p id="7964" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在打开命令窗口，开始安装我们将在这个项目中使用的包。我们在之前的<a class="ae jq" href="https://omaratef3221.medium.com/starting-guide-to-artificial-intelligence-part-2-e411d8335e4f" rel="noopener">文章</a>中讨论过这些包。现在首先我们将通过编写这个命令来安装pandas库。</p><blockquote class="jr js jt"><p id="118d" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated">pip安装熊猫</p></blockquote><p id="11c1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们将安装Numpy库。</p><blockquote class="jr js jt"><p id="ff6f" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated">pip安装数量</p></blockquote><p id="02da" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，我们将通过键入以下命令来安装sci-kit learn</p><blockquote class="jr js jt"><p id="30ce" class="ie if ju ig b ih ii ij ik il im in io jv iq ir is jw iu iv iw jx iy iz ja jb ha bi translated">pip安装scikit-学习</p></blockquote><p id="cd3a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们准备好出发了！</p><p id="ad20" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我们将从<a class="ae jq" href="https://www.kaggle.com/vedavyasv/usa-housing" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>下载数据集美国住房。</p><p id="437c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，将这些文件保存在笔记本所在的同一文件夹中，以便我们在Jupyter笔记本中使用这些文件时一切都变得简单。</p><p id="7514" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">打开笔记本后，首先，我们将开始读取数据，我们将使用pandas库读取数据，首先，我们将使用import语句读取pandas库，然后我们将读取如下所示的文件。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jy jp l"/></div></figure><p id="bf56" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，在阅读数据之后，我们必须在继续机器学习部分之前探索一下。首先，我们将检查数据集每个要素的数据类型。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jy jp l"/></div></figure><p id="8015" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这段代码的输出如下所示:</p><pre class="jd je jf jg fd jz ka kb kc aw kd bi"><span id="ec43" class="ke kf hh ka b fi kg kh l ki kj">Avg. Area Income                float64<br/>Avg. Area House Age             float64<br/>Avg. Area Number of Rooms       float64<br/>Avg. Area Number of Bedrooms    float64<br/>Area Population                 float64<br/>Price                           float64<br/>Address                          object</span></pre><p id="c739" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这意味着我们在这个数据集中有6个特征，我们在机器学习中称之为“独立变量”。我们只有一个产量，即价格“因变量”。上图中显示的数据类型表明所有变量都是float64，除了地址是一个对象，这是有意义的，因为它是一个描述房子地址的字符串。</p><ul class=""><li id="89ca" class="kk kl hh ig b ih ii il im ip km it kn ix ko jb kp kq kr ks bi translated">平均值。地区收入:是居住在这个地区的人们的平均收入。</li><li id="f959" class="kk kl hh ig b ih kt il ku ip kv it kw ix kx jb kp kq kr ks bi translated">平均值。地区房屋年龄:是该地区房屋的平均年龄。</li><li id="578b" class="kk kl hh ig b ih kt il ku ip kv it kw ix kx jb kp kq kr ks bi translated">平均值。面积房间数:是该地区房屋的平均房间数。</li><li id="a77b" class="kk kl hh ig b ih kt il ku ip kv it kw ix kx jb kp kq kr ks bi translated">平均值。卧室面积数:是该地区房屋的平均卧室数。</li><li id="35c9" class="kk kl hh ig b ih kt il ku ip kv it kw ix kx jb kp kq kr ks bi translated">地区人口:该地区的人口。</li><li id="f73f" class="kk kl hh ig b ih kt il ku ip kv it kw ix kx jb kp kq kr ks bi translated">地址:是房子的地址。</li></ul><p id="8b50" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，为了简单起见，我们将不使用字符串数据类型，我们将使用下面的代码删除行地址:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jy jp l"/></div></figure><p id="cf80" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上面的代码不会有任何输出，但是如果您想确保它工作正常，只需在单独的单元格中键入数据并检查输出。</p><p id="c729" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我们将使用下面的代码研究基本的统计属性:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jy jp l"/></div></figure><p id="941d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这一行的输出将是一个包含数据集详细信息的表。不同的详细信息，如每列的最大和最小数量、计数、平均值和标准偏差。此外，下限和上限百分点。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ky"><img src="../Images/da48b98fc99becd503c6ffefbaa8b5cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sHrZRXUAoJ_PJ5QUX6ZwCQ.png"/></div></div></figure><p id="a9b3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">任何机器学习任务中最常见的问题之一是缺少值。收集的数据通常会有一些错误和一些缺失值。可能是由于任何原因，特别是机器学习数据是非常大量的数据，所以它们大多是使用web报废或任何自动化方法收集的。所以处理缺失值有几种方法。我们将在接下来的博客中讨论如何处理缺失的价值观。现在，我们可以使用以下代码来检查丢失的值:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jy jp l"/></div></figure><p id="2cfa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">输出将是:</p><pre class="jd je jf jg fd jz ka kb kc aw kd bi"><span id="6eff" class="ke kf hh ka b fi kg kh l ki kj">Avg. Area Income                0<br/>Avg. Area House Age             0<br/>Avg. Area Number of Rooms       0<br/>Avg. Area Number of Bedrooms    0<br/>Area Population                 0<br/>Price                           0<br/>dtype: int64</span></pre><p id="32c5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">幸运的是，这个数据集没有任何缺失值，但是请记住，这种情况不会经常发生！</p><p id="7240" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们可以从机器学习的第一部分开始，这是一个监督学习项目，所以在任何ML监督学习项目中，数据都要拆分成训练和测试。培训中的数据应该与测试中的数据完全不同。这和你教孩子的方式一模一样。你可以通过一些图片教他猫和狗的区别。然后当你想测试他的时候，你不能用你以前教他的图片来测试他！不然会被认为是出轨，没有意义！</p><p id="10b3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，数据应该分为训练输入、训练输出、测试输入和测试输出。</p><p id="88e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，让我们划分训练和测试的输入和输出。下面的代码将把数据分成输入(x)和输出(y)。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jy jp l"/></div></figure><p id="6faf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，第一行使用iloc函数，该函数将获取一部分数据并将其存储在值x中。冒号(:)表示所有行，第二个参数表示第一列中最后一列之前的一行(-1)。-1表示除最后1外，-2表示除最后2外，以此类推。</p><p id="d367" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第二行代码将获取所有行，只获取最后一列，即输出列。</p><p id="ff53" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">那么，让我们看看X和Y是什么样子的，只需在单元格中键入每个变量的名称，它就会自动显示出来。</p><p id="2d5e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">x:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kz"><img src="../Images/7f8d8c5519db24c964831c3b7d4c711f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T_tB98jg5-evoGshvOUqxQ.png"/></div></div></figure><p id="9797" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">y:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es la"><img src="../Images/aa52670668f2d3f9f6844f7971d1942f.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*GrzS85Fp2KHwVHdDjgoOQw.png"/></div></figure><p id="b1e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，数据被分为输入和输出。现在让我们将培训和测试分开。通常情况下，训练量应该大于测试量。大多数情况下，训练占数据的70%，测试占30%。我们之前下载的Sklearn包提供了一个简单易用的函数来拆分数据，如下所示，首先，我们必须导入一个名为train test split的函数，我们将要求python导入它，然后我们将使用它。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jy jp l"/></div></figure><p id="d701" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第一行是从这个包中导入一个特定的函数，第二行是使用带有3个主要参数的函数，并输出输入序列(x_train)、输入测试(x_test)、输出序列(y_train)和输出测试(y_test)。它有3个参数，分别是x，y，测试数据大小是0.3 (30%测试)。</p><p id="92fb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我们将建立一个线性回归模型。该模型将是简单的，将只是根据我们之前谈到的数据预测房价。</p><p id="8985" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先从sklearn包中导入线性回归函数，然后创建一个新模型，从而构建模型:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jy jp l"/></div></figure><p id="86cd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，我们将使用如下所示的拟合函数来训练模型。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jy jp l"/></div></figure><p id="3f53" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们有了一个训练有素的模型。所以现在我们必须在测试数据上测试我们的模型。在ML中，我们使用术语(预测)。以下代码将预测测试输入的输出:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jy jp l"/></div></figure><p id="c3c4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">变量predicted_result将与存储在y_test中的实际结果进行比较。然后我们可以提取模型预测的准确性。我们将检查输出的均方误差(MSE)和R2变量，该变量显示预测数据和真实数据是如何分散和匹配在一起的，我们需要最低的均方误差和最高的R2:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jy jp l"/></div></figure><p id="c552" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以我们从包中导入了两个函数来获得MSE和R2。结果如下:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lb"><img src="../Images/8070f42108ddf42ba29900efc770d4a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*jgxVF89OUPDSG0jH4f-9vA.png"/></div></figure><p id="d8b9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">MSE误差太高，但这是意料之中的，因为我们比较的工资显然是一个很高的数字，然而，R2是91%，这意味着我们的模型表现非常好。</p><p id="5b4e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们已经建立了一个线性回归模型，ML不是那么简单，但这是一个开始。后面的文章会有更多的模型和更高级的解释。</p></div></div>    
</body>
</html>