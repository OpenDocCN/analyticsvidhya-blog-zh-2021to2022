<html>
<head>
<title>Is that text SARCASTIC … ?🤔</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">那条短信是讽刺吗…？🤔</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/is-that-text-sarcastic-36fe4369a6a?source=collection_archive---------13-----------------------#2021-09-10">https://medium.com/analytics-vidhya/is-that-text-sarcastic-36fe4369a6a?source=collection_archive---------13-----------------------#2021-09-10</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="de26" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">众所周知，人工智能和机器学习正在改变世界。它在从医学到视频游戏的各个领域都有大量的应用。</p><p id="d371" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">电子商务和社交媒体等领域已经幸运地使用了人工智能，并受益最大。(AI)预计到2026年<strong class="ig hi">这个市场将增长到1260亿美元</strong>。</p><p id="210a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jc">然而，在这个项目中，我决定用AI来完成一项有趣的任务。我试图建立一个模型来检测文本中的讽刺。</em></strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/ac033a551c27a76ee5fd242abffc1d0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V8rPXcZWbZqkeRqF3Y0FlQ.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">来源:谷歌图片</figcaption></figure><p id="ad29" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这听起来可能难以置信，但随着人工智能领域每天都有新的研究和改进，建立这种模型是可能的。我能够创建一个模型，以83 %的准确率检测文本中的讽刺。</p><p id="421a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在开始解释模型的构建之前，让我们尝试在一些著名的电影/网络系列中发现讽刺:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jt"><img src="../Images/292c6589bd49b2e1fb9bf78f3054c7e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*ILD9OZn2842JXUHfXz4onQ.gif"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">电影:《死侍2》</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ju"><img src="../Images/641cbaf4cf2f6731a31baaf970b56803.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-BeiVRtM7QyogMbIDHoifg.jpeg"/></div></div></figure><p id="2dfa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi">2.</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/01718444c0fa148c980db35c9c605694.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z8aNl7oWVeOywmrvEMUFtw.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">生活大爆炸第四季第二十四集</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jv"><img src="../Images/516fd2d83206c979ea4dd687f339ad3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GIZKfXYRCrgXtqEmTD0__A.jpeg"/></div></div></figure><h1 id="192d" class="jw jx hh bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated"><strong class="ak">解释模型:</strong></h1><h2 id="a5e5" class="ku jx hh bd jy kv kw kx kc ky kz la kg ip lb lc kk it ld le ko ix lf lg ks lh bi translated"><strong class="ak"> 1。使用的库和数据集:</strong></h2><p id="e34d" class="pw-post-body-paragraph ie if hh ig b ih li ij ik il lj in io ip lk ir is it ll iv iw ix lm iz ja jb ha bi translated">整个项目用python语言制作，在google colab环境下进行。为了设计神经网络，使用Keras顺序API，TensorFlow作为后端。</p><p id="5d70" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于可视化数据和数据分析:pandas，使用matplotlib库。</p><p id="7039" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该数据集可在一个开源网站上获得，<strong class="ig hi"><em class="jc"/></strong><a class="ae ln" href="http://kaggle.com" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi"><em class="jc">kaggle</em></strong></a>。数据集在。<em class="jc"> json </em>格式。因此，使用python的<strong class="ig hi"> <em class="jc"> json </em> </strong>和<strong class="ig hi"> <em class="jc"> requests </em> </strong>库来获取模型的数据集。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lo"><img src="../Images/0d61991c5d49e9705df253036fab2a48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vcZo-3ycKzMah775P_jkuQ.jpeg"/></div></div></figure><h2 id="fe1a" class="ku jx hh bd jy kv kw kx kc ky kz la kg ip lb lc kk it ld le ko ix lf lg ks lh bi translated"><strong class="ak"> 2。标记和填充文本数据</strong></h2><p id="b321" class="pw-post-body-paragraph ie if hh ig b ih li ij ik il lj in io ip lk ir is it ll iv iw ix lm iz ja jb ha bi translated">为了让模型做出预测，它需要有数字格式的文本数据。因此我们需要通过<strong class="ig hi"> <em class="jc">分词</em> </strong>和<strong class="ig hi"> <em class="jc">填充</em> </strong>对数据进行预处理。<br/>通过在TensorFlow中创建Tokenizer类的实例，可以轻松完成标记化。为了将原始文本转换成数字序列，我在标记器上使用了<strong class="ig hi"><em class="jc">texts _ to _ sequences</em></strong>方法。<br/>将所有文本串转换成序列后，进行填充，使所有训练文本长度一致。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lp"><img src="../Images/a881c95d6587d56217fa9ed9854a81d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3VMlE3-6qvyoYp_Vzma2nA.jpeg"/></div></div></figure><h2 id="86fd" class="ku jx hh bd jy kv kw kx kc ky kz la kg ip lb lc kk it ld le ko ix lf lg ks lh bi translated"><strong class="ak"> 3。建立长短期记忆神经网络:</strong></h2><p id="cd0d" class="pw-post-body-paragraph ie if hh ig b ih li ij ik il lj in io ip lk ir is it ll iv iw ix lm iz ja jb ha bi translated"><strong class="ig hi">长短期记忆神经网络</strong>或<strong class="ig hi"> LSTM </strong>是一类神经网络，最常用于<strong class="ig hi">序列预测问题</strong>。</p><p id="78db" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">建立的模型是连续的，包括:嵌入层，双向LSTM层，具有24个神经元和“relu”激活的密集层，以及具有sigmoid激活的输出层。</p><p id="bc01" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于我们的任务是二进制分类，即预测文本是否讽刺，我在最终输出层使用一个神经元的sigmoid激活，并使用“二进制交叉熵”来计算损失。</p><p id="e304" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了在神经网络上执行梯度下降，我使用了Adam optimizer。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lq"><img src="../Images/7123b86c4e97b3fccc29af04b0a43c45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3J2yvLewn0cGIEPKh9Rtjw.jpeg"/></div></div></figure><h2 id="1fc8" class="ku jx hh bd jy kv kw kx kc ky kz la kg ip lb lc kk it ld le ko ix lf lg ks lh bi translated"><strong class="ak"> 4。评估模型</strong></h2><p id="4f64" class="pw-post-body-paragraph ie if hh ig b ih li ij ik il lj in io ip lk ir is it ll iv iw ix lm iz ja jb ha bi translated"><strong class="ig hi">T3】观想:T5】</strong></p><p id="1299" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了可视化每个时期后训练和验证数据集的准确性和损失，我在matplotlib库的帮助下绘制了它们。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lr"><img src="../Images/064aa584e0de4e7965b167216f9994ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*C958KjiktBO8MMpDPrk38g.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lr"><img src="../Images/36d997d42356b4fd53ce3b5f8ad0368f.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*s5nOVAdTQITDv_Q4falXCw.png"/></div></figure><p id="d108" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，在测试集上对该模型进行了评估，即在它从未见过的文本上，其准确率为81.71 %</p><p id="c590" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">现在让我们在其他一些著名电影或网络系列对话上测试我们的模型:</strong></p><p id="3fbc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi">1)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ls"><img src="../Images/b18be9a2dd299c389ac5846817841bc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/1*ol1kecD_Xl9rRDbrvmmPew.gif"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">复仇者联盟:奥创时代</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lt"><img src="../Images/e707c41d078b08421bcf4291dbca5994.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tTv6auTUeu-Y327G0QDUtw.jpeg"/></div></div></figure><p id="7acb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi">2)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jt"><img src="../Images/f80b66646dd2cc2391303430924dd2fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*BcZV4LGNSXrd6ts5IAgNFA.gif"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">老友记(第六季第五集)</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lu"><img src="../Images/48c5a31c56313ebfd842896d332d0d0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xFPsIflY9spSU6Xz0iSCkQ.jpeg"/></div></div></figure><p id="3a28" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi">3)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lv"><img src="../Images/18470721a3c0fc91daacc579347643b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*mJjf3UJ2ZA2XmbntvRRCYw.jpeg"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">办公室(第九季第二十三集)</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lw"><img src="../Images/d52a8d6bc3888e5bd2241f53b9aebb63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z2d4FbzwaergxR354PbG3A.jpeg"/></div></div></figure><p id="d1fd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4)阿姆:<strong class="ig hi">“被B方谋杀的音乐”——阿尔弗雷德的主题曲</strong></p><p id="e748" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">歌词— <em class="jc">“所以叫我圣诞老人吧，因为现在，我比他们唱得都好”</em></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lx"><img src="../Images/a284dcef87f0b044717650ee66dc88f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*7MXXmVF5Ytgmj9kO5pFm3w.jpeg"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ly"><img src="../Images/2a8408416000d8a572904e71f489143f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oEJLCNMq2mCNOR98xQ7xog.jpeg"/></div></div></figure><p id="1ffb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">参考资料:</p><ol class=""><li id="a485" class="lz ma hh ig b ih ii il im ip mb it mc ix md jb me mf mg mh bi translated">Google Colab项目:<a class="ae ln" href="https://colab.research.google.com/drive/1knz8La6hkzkq_qssz9JxM-Tzuk_v8UNX?usp=sharing" rel="noopener ugc nofollow" target="_blank">https://Colab . research . Google . com/drive/1 knz 8 la 6 hkzkq _ qssz 9 jxm-Tzuk _ V8 unx？usp =共享</a></li><li id="4b5c" class="lz ma hh ig b ih mi il mj ip mk it ml ix mm jb me mf mg mh bi translated">dataset:<a class="ae ln" href="https://www.kaggle.com/rmisra/news-headlines-dataset-for-sarcasm-detection" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/RMI SRA/news-headlines-dataset-for-spirus-detection</a></li></ol></div></div>    
</body>
</html>