<html>
<head>
<title>Predicting the future using Machine Learning part III</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习预测未来第三部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predicting-the-future-using-machine-learning-part-iii-410e1a1742c7?source=collection_archive---------28-----------------------#2021-01-08">https://medium.com/analytics-vidhya/predicting-the-future-using-machine-learning-part-iii-410e1a1742c7?source=collection_archive---------28-----------------------#2021-01-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="7afa" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">Pyhton中的交叉验证+实现</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/5f5a15aae3b9520908ef2011d52715e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UPm8jXrssckMwcfm"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">詹姆斯·哈里逊在<a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="8190" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">正如在本系列的前一部分中所承诺的，我将讨论一种可以应用的方法，以便选择一个比二阶的<a class="ae jm" href="https://minasuntea.medium.com/predicting-the-future-using-machine-learning-part-ii-fb45806e5b71" rel="noopener">多项式模型更不容易过度拟合的通用模型。这种方法被称为交叉验证。</a></p><h2 id="c528" class="kj kk hh bd kl km kn ko kp kq kr ks kt jw ku kv kw ka kx ky kz ke la lb lc ld bi translated">交互效度分析</h2><p id="13c2" class="pw-post-body-paragraph jn jo hh jp b jq le ii js jt lf il jv jw lg jy jz ka lh kc kd ke li kg kh ki ha bi translated">交叉验证方法是一种在给定比率的情况下，将数据拆分为训练集和验证集的方法。例如，比率为0.6时，60%的数据用作训练集来训练模型，40%的数据用作验证集来拟合模型。在Python中实现交叉验证方法给出了:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lj"><img src="../Images/45d28a5ba9213564d59a161bb5a8ff64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t-_O6krz9nOorIT3tS_l3A.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">数据的X和R部分的训练和验证集</figcaption></figure><p id="3802" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><em class="lk"> validation_split </em>函数返回数据集的X和R部分的训练和验证集。请注意，我们仍将使用我在本系列的<a class="ae jm" href="https://minasuntea.medium.com/predicting-the-future-using-machine-learning-part-i-48da5d48a40f" rel="noopener">第一部分</a>和<a class="ae jm" href="https://minasuntea.medium.com/predicting-the-future-using-machine-learning-part-ii-fb45806e5b71" rel="noopener">第二部分</a>中使用的数据集，结果是:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ll"><img src="../Images/9ca71dad173b0cb2d523b096fe143b75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nTJZOf12U_L2VhuTy25M3A.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">选择0.6的比率，这导致60%的训练和40%的验证。</figcaption></figure><p id="069f" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">使用这种新的数据分割方法，不同阶的多项式现在可以在训练集上重复拟合，同时查看哪一个在验证集上产生的成本最低。在验证集上产生最低成本的权重集概括了对新数据的最佳拟合，因此是对数据集的最佳总体拟合。</p><p id="9667" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">为了找到最佳拟合，我编写了一个名为<em class="lk"> best_poly_fit </em>的函数，在这个函数中，我在很大范围内迭代，比如1到50个多项式阶。每次从训练样本计算D_matrix，并用<em class="lk"> poly_fit </em>函数拟合到相应的训练值，之后用函数<em class="lk"> poly_cost </em>计算该拟合的成本。每个循环的成本都与最小成本进行比较，并根据成本值替换和返回相应的权重。所以我的<em class="lk"> best_poly_fit </em>函数看起来像这样:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lm"><img src="../Images/b6551e07f505bf455bc598f68993d67a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FCVrVCX8mqe3T9PDnoVfGg.png"/></div></div></figure><p id="612f" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">现在唯一要做的就是想象出最合适的衣服，以及最好的重量和最低的成本:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ln"><img src="../Images/07a71a3c0703c4250f48a69891752a86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BqBju6txtxd61p-q6mx8Xw.png"/></div></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es lo"><img src="../Images/f03f24e266891b8e2ff8f7d783794ce2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*q2Z0AluAz1MngxT4FkdLcQ.png"/></div></figure><p id="7042" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">与线性拟合和二阶多项式拟合相比，这种拟合是迄今为止最好的。交叉验证方法的优势在于，在用数据集的一部分对模型进行训练之后，找到的模型不容易过拟合或欠拟合。通过这篇文章，我已经结束了监督学习算法的第一个主要类型，即回归。在我接下来的文章中，我将介绍另一种主要的监督学习算法，也称为分类算法。</p></div></div>    
</body>
</html>