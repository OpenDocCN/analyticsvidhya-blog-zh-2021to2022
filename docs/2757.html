<html>
<head>
<title>Time Series Forecasting: Predicting mobile traffic with LSTM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时间序列预测:用LSTM预测移动通信量</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/time-series-forecasting-predicting-mobile-traffic-with-lstm-649e6ba7ee49?source=collection_archive---------2-----------------------#2021-05-16">https://medium.com/analytics-vidhya/time-series-forecasting-predicting-mobile-traffic-with-lstm-649e6ba7ee49?source=collection_archive---------2-----------------------#2021-05-16</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/31ca045144f6a49258c9e73bab904ee4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G9DQlO6zuoqqiwW07pq3VQ.png"/></div></div></figure><p id="814f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi jn translated"><span class="l jo jp jq bm jr js jt ju jv di">一个</span> <strong class="ir hi">电信中的人工智能为客户和提供商带来更好的体验。</strong>它有助于行业发展，使流程更加便捷，这是任何企业的最终目标，电信也是如此。</p><p id="dd3a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这篇文章是根据我去年在一家领先的电信公司实习时的亲身经历写的。在那里，我被分配到一个项目，该项目涉及预测公司在全国的手机信号塔的未来移动流量。虽然我对编程和机器学习感兴趣，但我从未有过这方面的工业经验。由于公司的规模和预期的工作质量，这是一个非常具有挑战性的项目，但我在享受学习和编码的过程中度过了非常美好的时光。</p><p id="5dfd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当我开始这个项目的时候，我对时间序列预测没有太多的经验。我在深度学习方面做了一些个人项目和竞赛，但在预测方面一无所获。所以在开始的时候，它是关于深入学习时间序列预测的神经网络背后的数学，然后我开始钻研代码。事不宜迟，让我们进入技术部分。</p><p id="421b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">通常时间序列预测是困难的，不像回归和分类时间序列问题增加了观测值之间顺序依赖的困难。传统上，时间序列预测一直由线性方法主导，因为它们在许多类型的应用中被很好地理解和有效。但是这些经典方法也有许多局限性。</p><p id="b2be" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">随着机器学习的进步，神经网络被用来解决这个问题。由于时间序列数据是序列相关的，因此设计了不同类型的神经网络，称为递归神经网络(RNN)。但是简单的递归网络仍然存在一个基本问题，即不能捕获序列中的长期相关性。这是一个问题，因为我们想要跟踪长序列的时间序列数据。为了解决这个问题<a class="ae jw" href="http://www.mitpressjournals.org/doi/abs/10.1162/neco.1997.9.8.1735" rel="noopener ugc nofollow" target="_blank"> LSTM是由Sepp Hochreiter和Jurgen Schmidhuber </a>在90年代后期提出的</p><p id="b1d2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">长短期记忆网络，简称LSTM，可用于时间序列预测。有许多类型的LSTM模型可用于每个特定类型的时间序列预测问题。在这篇文章中，你将看到如何使用长短期记忆模型来预测移动网络流量。</p><p id="3f26" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您做出的预测与数据的实际行为相关联。换句话说，你不需要未来确切的流量值，而是移动流量动向。让我们开始吧。</p></div><div class="ab cl jx jy go jz" role="separator"><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc kd"/><span class="ka bw bk kb kc"/></div><div class="ha hb hc hd he"><p id="bda7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们进口我们需要的一切。</p><figure class="ke kf kg kh fd ii"><div class="bz dy l di"><div class="ki kj l"/></div></figure><h2 id="8259" class="kk kl hh bd km kn ko kp kq kr ks kt ku ja kv kw kx je ky kz la ji lb lc ld le bi translated">数据探索</h2><p id="49fe" class="pw-post-body-paragraph ip iq hh ir b is lf iu iv iw lg iy iz ja lh jc jd je li jg jh ji lj jk jl jm ha bi translated">让我们加载数据并查看一下:</p><figure class="ke kf kg kh fd ii"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="c22d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">数据集形状= (305，1)</p><figure class="ke kf kg kh fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lk"><img src="../Images/77a8c691a70ab37f40d472f6cbdacb9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*68Ub2ao7-M36ggDlzH8SNA.jpeg"/></div></div></figure><h2 id="e0dd" class="kk kl hh bd km kn ko kp kq kr ks kt ku ja kv kw kx je ky kz la ji lb lc ld le bi translated"><strong class="ak">可视化数据</strong></h2><figure class="ke kf kg kh fd ii"><div class="bz dy l di"><div class="ki kj l"/></div></figure><figure class="ke kf kg kh fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ll"><img src="../Images/99c8c1ef043176ce8cb3cca44a15938e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sEus2neaHs-rAEQcMF2kJw.jpeg"/></div></div></figure><h2 id="c91d" class="kk kl hh bd km kn ko kp kq kr ks kt ku ja kv kw kx je ky kz la ji lb lc ld le bi translated"><strong class="ak">预处理</strong></h2><p id="b044" class="pw-post-body-paragraph ip iq hh ir b is lf iu iv iw lg iy iz ja lh jc jd je li jg jh ji lj jk jl jm ha bi translated">如果我们想提高模型的训练速度和性能，我们必须缩放数据(值将在0和1之间)。我们将使用scikit-learn中的<code class="du lm ln lo lp b">MinMaxScaler</code>:</p><figure class="ke kf kg kh fd ii"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="be83" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将保留数据的前0.8部分用于训练，其余部分用于测试:</p><figure class="ke kf kg kh fd ii"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="9515" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">每个训练示例都包含30个数据点的历史序列，以及模型需要预测的真实值的标签。</p><figure class="ke kf kg kh fd ii"><div class="bz dy l di"><div class="ki kj l"/></div></figure><p id="e6a5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">重塑数据</p><figure class="ke kf kg kh fd ii"><div class="bz dy l di"><div class="ki kj l"/></div></figure><h2 id="d837" class="kk kl hh bd km kn ko kp kq kr ks kt ku ja kv kw kx je ky kz la ji lb lc ld le bi translated"><strong class="ak">建立模型</strong></h2><p id="6054" class="pw-post-body-paragraph ip iq hh ir b is lf iu iv iw lg iy iz ja lh jc jd je li jg jh ji lj jk jl jm ha bi translated">创建模型的架构。这里我们使用张量流和keras:</p><figure class="ke kf kg kh fd ii"><div class="bz dy l di"><div class="ki kj l"/></div></figure><h2 id="5caf" class="kk kl hh bd km kn ko kp kq kr ks kt ku ja kv kw kx je ky kz la ji lb lc ld le bi translated"><strong class="ak">训练模型</strong></h2><p id="95b9" class="pw-post-body-paragraph ip iq hh ir b is lf iu iv iw lg iy iz ja lh jc jd je li jg jh ji lj jk jl jm ha bi translated">我们将使用均方差来衡量我们的训练误差。</p><figure class="ke kf kg kh fd ii"><div class="bz dy l di"><div class="ki kj l"/></div></figure><h2 id="8cb7" class="kk kl hh bd km kn ko kp kq kr ks kt ku ja kv kw kx je ky kz la ji lb lc ld le bi translated"><strong class="ak">做出预测</strong></h2><p id="8135" class="pw-post-body-paragraph ip iq hh ir b is lf iu iv iw lg iy iz ja lh jc jd je li jg jh ji lj jk jl jm ha bi translated">这个模型只能预测未来30天。</p><figure class="ke kf kg kh fd ii"><div class="bz dy l di"><div class="ki kj l"/></div></figure><figure class="ke kf kg kh fd ii er es paragraph-image"><div class="er es lq"><img src="../Images/7f868ebc33102552a52338ea7f6464e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*M0RIL8MkBDW3W575nc9-sw.png"/></div></figure><p id="c54d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">好的，看起来不错。让我们通过观想来看一看，以获得一个好的视野。</p><figure class="ke kf kg kh fd ii"><div class="bz dy l di"><div class="ki kj l"/></div></figure><figure class="ke kf kg kh fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lr"><img src="../Images/20727ee0015b441de613e2d87c55aac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nzqkf2ELU9D6ZOOlQSdadQ.png"/></div></div></figure><h2 id="fe55" class="kk kl hh bd km kn ko kp kq kr ks kt ku ja kv kw kx je ky kz la ji lb lc ld le bi translated">对未来日期的预测</h2><p id="7cf0" class="pw-post-body-paragraph ip iq hh ir b is lf iu iv iw lg iy iz ja lh jc jd je li jg jh ji lj jk jl jm ha bi translated">我们将使用我们的“训练”模型来预测未来30天的流量，并对缩放器进行逆变换:</p><figure class="ke kf kg kh fd ii"><div class="bz dy l di"><div class="ki kj l"/></div></figure><h2 id="bc5b" class="kk kl hh bd km kn ko kp kq kr ks kt ku ja kv kw kx je ky kz la ji lb lc ld le bi translated">可视化预测</h2><figure class="ke kf kg kh fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ls"><img src="../Images/b744fa502ec70873e79d9da52898d720.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5K9MKMTfNnwfCj9YaUSV0Q.png"/></div></div></figure><h2 id="6a4a" class="kk kl hh bd km kn ko kp kq kr ks kt ku ja kv kw kx je ky kz la ji lb lc ld le bi translated">保存已训练的模型</h2><figure class="ke kf kg kh fd ii"><div class="bz dy l di"><div class="ki kj l"/></div></figure><h2 id="85b8" class="kk kl hh bd km kn ko kp kq kr ks kt ku ja kv kw kx je ky kz la ji lb lc ld le bi translated">加载模型以使用新数据重新训练或预测未来</h2><figure class="ke kf kg kh fd ii"><div class="bz dy l di"><div class="ki kj l"/></div></figure><h2 id="de9c" class="kk kl hh bd km kn ko kp kq kr ks kt ku ja kv kw kx je ky kz la ji lb lc ld le bi translated">为什么保存模型并再次加载以重用？</h2><p id="1c81" class="pw-post-body-paragraph ip iq hh ir b is lf iu iv iw lg iy iz ja lh jc jd je li jg jh ji lj jk jl jm ha bi translated">保存已经训练好的模型的主要优点是保存训练好的参数，以便可以再次使用新数据对其进行重新训练。这被称为迁移学习，这将为我们提供一种选择，避免在每次新数据到来时，用所有数据一遍又一遍地对模型进行长时间的繁重训练。加载已经训练好的模型并用新数据再次训练它将节省时间和计算能力。</p><h1 id="30c2" class="lt kl hh bd km lu lv lw kq lx ly lz ku ma mb mc kx md me mf la mg mh mi ld mj bi translated">结论</h1><p id="8738" class="pw-post-body-paragraph ip iq hh ir b is lf iu iv iw lg iy iz ja lh jc jd je li jg jh ji lj jk jl jm ha bi translated">您了解了如何使用Tensorflow和keras创建处理时间序列数据的递归神经网络LSTM模型。模型性能不是很好，但这是意料之中的，因为数据量很小。</p><h1 id="61b2" class="lt kl hh bd km lu lv lw kq lx ly lz ku ma mb mc kx md me mf la mg mh mi ld mj bi translated">参考</h1><div class="mk ml ez fb mm mn"><a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab dw"><div class="mp ab mq cl cj mr"><h2 class="bd hi fi z dy ms ea eb mt ed ef hg bi translated">时间序列预测与LSTM递归神经网络在Python与Keras -机器学习…</h2><div class="mu l"><h3 class="bd b fi z dy ms ea eb mt ed ef dx translated">时间序列预测问题是一种困难的预测建模问题。与回归预测不同…</h3></div><div class="mv l"><p class="bd b fp z dy ms ea eb mt ed ef dx translated">machinelearningmastery.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb in mn"/></div></div></a></div><div class="mk ml ez fb mm mn"><a href="https://machinelearningmastery.com/introduction-to-time-series-forecasting-with-python/" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab dw"><div class="mp ab mq cl cj mr"><h2 class="bd hi fi z dy ms ea eb mt ed ef hg bi translated">用Python -机器学习掌握时间序列预测</h2><div class="mu l"><h3 class="bd b fi z dy ms ea eb mt ed ef dx translated">用Python进行时间序列预测简介了解如何准备数据和开发模型来预测…</h3></div><div class="mv l"><p class="bd b fp z dy ms ea eb mt ed ef dx translated">machinelearningmastery.com</p></div></div><div class="mw l"><div class="nc l my mz na mw nb in mn"/></div></div></a></div></div></div>    
</body>
</html>