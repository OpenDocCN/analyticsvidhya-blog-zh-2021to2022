<html>
<head>
<title>Multi-task learning in Computer Vision: Image classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">计算机视觉中的多任务学习:图像分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/multi-task-learning-in-computer-vision-image-classification-ea7b61fb4a0a?source=collection_archive---------1-----------------------#2021-07-12">https://medium.com/analytics-vidhya/multi-task-learning-in-computer-vision-image-classification-ea7b61fb4a0a?source=collection_archive---------1-----------------------#2021-07-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/d9ca01ae092eaf21edaab52f29f368ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-p6oknfuzKhCmrB9JS1Lbw.jpeg"/></div></div></figure></div><div class="ab cl ip iq go ir" role="separator"><span class="is bw bk it iu iv"/><span class="is bw bk it iu iv"/><span class="is bw bk it iu"/></div><div class="ha hb hc hd he"><h1 id="2b35" class="iw ix hh bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">简介:</h1><p id="4899" class="pw-post-body-paragraph ju jv hh jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">曾经面临过由于需求而不得不创建大量深度学习模型的问题，现在不用担心了，因为多任务学习就在这里。如果每个模型中的基础数据集保持不变，多任务学习会有很大帮助。不需要创建单独的模型，您可以使用基本网络层简单地提取数据集的特征，最后以并行方式将不同类型的头层附加到基本网络之上，以同时学习不同的模型。这可以解决计算机视觉领域中的一些用例:</p><ul class=""><li id="d4fb" class="ks kt hh jw b jx ku kb kv kf kw kj kx kn ky kr kz la lb lc bi translated">房价和房屋类型预测</li><li id="d421" class="ks kt hh jw b jx ld kb le kf lf kj lg kn lh kr kz la lb lc bi translated">人脸性别和年龄检测</li><li id="6db2" class="ks kt hh jw b jx ld kb le kf lf kj lg kn lh kr kz la lb lc bi translated">作物分离及其健康分析</li></ul><p id="7104" class="pw-post-body-paragraph ju jv hh jw b jx ku jz ka kb kv kd ke kf li kh ki kj lj kl km kn lk kp kq kr ha bi translated">在这里，我们将查看一个用例，其中我们将创建一个简单的图像分类模型来检测给定图像中出现的汽车的颜色和类型。我们不要再等了。</p><h1 id="ee1c" class="iw ix hh bd iy iz ll jb jc jd lm jf jg jh ln jj jk jl lo jn jo jp lp jr js jt bi translated">数据准备:</h1><p id="209f" class="pw-post-body-paragraph ju jv hh jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">在下面的练习中，我选择了在<a class="ae lq" href="https://www.kaggle.com/vedanshdwivedi/automobile-images-dataset" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>中公开提供的数据集，该数据集由不同的目录组成，每个目录都遵循“color_type”的模式。你可能已经猜到了我们要做什么，是的，我们将把这作为一个多任务图像分类问题，颜色和类型是我们希望模型学习的不同目标值。让我们看看数据结构，并根据要求准备数据集。</p><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es lr"><img src="../Images/1c154f24d811f6cc0e40f9753e7c27cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/0*1tfyy4eXQk92y9-y.png"/></div></figure><p id="70e8" class="pw-post-body-paragraph ju jv hh jw b jx ku jz ka kb kv kd ke kf li kh ki kj lj kl km kn lk kp kq kr ha bi translated">因此，数据集由大约<strong class="jw hi"> 18个类</strong>组成，每个类可以仅由大约<strong class="jw hi"> 50个图像</strong>组成，这在正常图像分类问题的情况下可以说是较少的，而从多任务学习者的角度来看，我们可以将其分成两个学习者:一个用于颜色，另一个用于使用单一模型的车辆类型。让我们为此准备数据集。</p><p id="7954" class="pw-post-body-paragraph ju jv hh jw b jx ku jz ka kb kv kd ke kf li kh ki kj lj kl km kn lk kp kq kr ha bi translated"><strong class="jw hi">数据加载和准备</strong></p><p id="5731" class="pw-post-body-paragraph ju jv hh jw b jx ku jz ka kb kv kd ke kf li kh ki kj lj kl km kn lk kp kq kr ha bi translated">在这里，图像按照模型的要求被加载和整形。此外，我们将18个类分成了两个不同的集合:</p><ul class=""><li id="9008" class="ks kt hh jw b jx ku kb kv kf kw kj kx kn ky kr kz la lb lc bi translated">颜色标签:4</li><li id="87b0" class="ks kt hh jw b jx ld kb le kf lf kj lg kn lh kr kz la lb lc bi translated">类型标签:5</li></ul><figure class="ls lt lu lv fd ii"><div class="bz dy l di"><div class="lw lx l"/></div></figure><p id="2ecf" class="pw-post-body-paragraph ju jv hh jw b jx ku jz ka kb kv kd ke kf li kh ki kj lj kl km kn lk kp kq kr ha bi translated"><strong class="jw hi">数据增强</strong></p><figure class="ls lt lu lv fd ii"><div class="bz dy l di"><div class="lw lx l"/></div></figure><p id="08e8" class="pw-post-body-paragraph ju jv hh jw b jx ku jz ka kb kv kd ke kf li kh ki kj lj kl km kn lk kp kq kr ha bi translated"><strong class="jw hi">准备目标数据</strong></p><figure class="ls lt lu lv fd ii"><div class="bz dy l di"><div class="lw lx l"/></div></figure><p id="4b81" class="pw-post-body-paragraph ju jv hh jw b jx ku jz ka kb kv kd ke kf li kh ki kj lj kl km kn lk kp kq kr ha bi translated"><strong class="jw hi">利用迁移学习建模</strong></p><p id="6e8e" class="pw-post-body-paragraph ju jv hh jw b jx ku jz ka kb kv kd ke kf li kh ki kj lj kl km kn lk kp kq kr ha bi translated">现在，我们将创建构建多任务图像分类问题所需的图层，我决定尝试使用预训练的权重进行迁移学习，因为模型使用预训练的权重会学习得更好。该模型的具体内容如下:</p><p id="d81f" class="pw-post-body-paragraph ju jv hh jw b jx ku jz ka kb kv kd ke kf li kh ki kj lj kl km kn lk kp kq kr ha bi translated"><em class="ly">模型:Mobilenet_v2在Imagenet数据集上训练，输入图像大小为[128，128，3] </em></p><ul class=""><li id="670c" class="ks kt hh jw b jx ku kb kv kf kw kj kx kn ky kr kz la lb lc bi translated">第1层用于学习数据集中车辆的颜色</li><li id="4ad7" class="ks kt hh jw b jx ld kb le kf lf kj lg kn lh kr kz la lb lc bi translated">第2层用于学习数据集中的车辆类型</li></ul><p id="6f65" class="pw-post-body-paragraph ju jv hh jw b jx ku jz ka kb kv kd ke kf li kh ki kj lj kl km kn lk kp kq kr ha bi translated"><strong class="jw hi">建立和训练模型</strong></p><figure class="ls lt lu lv fd ii"><div class="bz dy l di"><div class="lw lx l"/></div></figure><p id="f5d3" class="pw-post-body-paragraph ju jv hh jw b jx ku jz ka kb kv kd ke kf li kh ki kj lj kl km kn lk kp kq kr ha bi translated">该模型在验证数据集方面做得相当好，因为损失非常接近该图的较低水平</p><figure class="ls lt lu lv fd ii er es paragraph-image"><div class="er es lz"><img src="../Images/1ebbb8244256e65728964b3da29dda7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/0*yu3nWJxFqGVaAmol.png"/></div></figure><p id="e549" class="pw-post-body-paragraph ju jv hh jw b jx ku jz ka kb kv kd ke kf li kh ki kj lj kl km kn lk kp kq kr ha bi translated"><strong class="jw hi">用随机图像推断模型</strong></p><p id="b517" class="pw-post-body-paragraph ju jv hh jw b jx ku jz ka kb kv kd ke kf li kh ki kj lj kl km kn lk kp kq kr ha bi translated">让我们使用来自互联网的随机图像来检查模型的能力，我已经下载了一些样本来测试模型的效率。我选择了三组图像:一辆黑色卡车、一辆白色卡车和一辆绿色自行车。让我们看看结果是如何分布的:</p><figure class="ls lt lu lv fd ii"><div class="bz dy l di"><div class="lw lx l"/></div></figure><p id="2a56" class="pw-post-body-paragraph ju jv hh jw b jx ku jz ka kb kv kd ke kf li kh ki kj lj kl km kn lk kp kq kr ha bi translated"><strong class="jw hi">获得预测，并将它们重新映射到类上</strong></p><figure class="ls lt lu lv fd ii"><div class="bz dy l di"><div class="lw lx l"/></div></figure><figure class="ls lt lu lv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/176a461eeb48f83c96b5361fea645981.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YQy2fJOrVHKy1mcC.png"/></div></div></figure><p id="b224" class="pw-post-body-paragraph ju jv hh jw b jx ku jz ka kb kv kd ke kf li kh ki kj lj kl km kn lk kp kq kr ha bi translated">正如我们在这里看到的，如果基础数据集是通用的，我们可以通过利用多任务学习来节省更多时间并构建高效的模型，而不是为不同的用例开发不同的模型集。一定要试试这个，并给我反馈，直到那时再见朋友。注意安全。</p></div></div>    
</body>
</html>