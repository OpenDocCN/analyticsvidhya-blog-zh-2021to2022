<html>
<head>
<title>COVID-19 vaccinations — An animated Choropleth Map with Plotly Express</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">新冠肺炎疫苗接种——带Plotly Express的动画Choropleth地图</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/covid-19-vaccinations-an-animated-choropleth-map-with-plotly-express-50aa3c83e01e?source=collection_archive---------10-----------------------#2021-04-04">https://medium.com/analytics-vidhya/covid-19-vaccinations-an-animated-choropleth-map-with-plotly-express-50aa3c83e01e?source=collection_archive---------10-----------------------#2021-04-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/7d92eb025cde09bd0a17d7847a7c3f5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iwoZLwicX8YhyPFOYPjm7A.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">作者图片</figcaption></figure><div class=""/><div class=""><h2 id="74f0" class="pw-subtitle-paragraph it hv hw bd b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk dx translated">如何用不到20行代码创建一个美国各州的地图，以动画形式展示辉瑞新冠肺炎疫苗的推出。</h2></div><p id="9a93" class="pw-post-body-paragraph jl jm hw jn b jo jp ix jq jr js ja jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated"><em class="kh">需要注意几个问题:这个案例研究只研究了辉瑞疫苗，使用的人口数据来自2019年。该数据仅用于演示</em> <a class="ae ki" href="https://plotly.com/python/choropleth-maps/" rel="noopener ugc nofollow" target="_blank"> <em class="kh">图表达Choropleth </em> </a> <em class="kh">图的使用。</em></p><p id="ebc4" class="pw-post-body-paragraph jl jm hw jn b jo jp ix jq jr js ja jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">Plotly express是一种奇妙的、高级的和用户友好的与Plotly交互的方式。它抽象出了创建许多可用的美丽情节所涉及的复杂性，下面我们将重点关注我最喜欢的一个——动画Choropleth地图。</p><h2 id="7d79" class="kj kk hw bd kl km kn ko kp kq kr ks kt ju ku kv kw jy kx ky kz kc la lb lc ld bi translated"><strong class="ak">进口:</strong></h2><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="6d7a" class="kj kk hw lj b fi ln lo l lp lq">import pandas as pd<br/>import plotly.express as px</span></pre><h2 id="a4f1" class="kj kk hw bd kl km kn ko kp kq kr ks kt ju ku kv kw jy kx ky kz kc la lb lc ld bi translated"><strong class="ak">数据:</strong></h2><p id="5aee" class="pw-post-body-paragraph jl jm hw jn b jo lr ix jq jr ls ja jt ju lt jw jx jy lu ka kb kc lv ke kf kg ha bi translated">本练习的数据来自:</p><ul class=""><li id="7f90" class="lw lx hw jn b jo jp jr js ju ly jy lz kc ma kg mb mc md me bi translated"><a class="ae ki" href="https://data.cdc.gov/Vaccinations/COVID-19-Vaccine-Distribution-Allocations-by-Juris/saz5-9hgg" rel="noopener ugc nofollow" target="_blank">美国疾病预防控制中心:按辖区划分的新冠肺炎疫苗分销分配——辉瑞</a></li><li id="6537" class="lw lx hw jn b jo mf jr mg ju mh jy mi kc mj kg mb mc md me bi translated"><a class="ae ki" href="https://www.infoplease.com/us/states/state-population-by-rank" rel="noopener ugc nofollow" target="_blank"> Infoplease:各州人口排名</a> (2019)</li></ul><p id="4105" class="pw-post-body-paragraph jl jm hw jn b jo jp ix jq jr js ja jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">为了让数据进入我在动画中使用的状态，需要一些数据争论和特征工程。我已经在这个<a class="ae ki" href="https://gist.github.com/Tavnuh/e414a18e7667581383ae0363d04f4529" rel="noopener ugc nofollow" target="_blank">要点</a>中提供了争论的数据，你可以在这个项目的<a class="ae ki" href="https://github.com/Tavnuh/COVID-19-Vaccine-Rollout-Map/blob/master/US%20Covid-19%20Vaccinations.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub回购中看到争论的操作。</a></p><p id="ecab" class="pw-post-body-paragraph jl jm hw jn b jo jp ix jq jr js ja jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">我选择使用每个州按人均计算的首剂分配的累计总和来显示每个州人口的覆盖率。</p><h1 id="bec8" class="mk kk hw bd kl ml mm mn kp mo mp mq kt jc mr jd kw jf ms jg kz ji mt jj lc mu bi translated">动画Choropleth地图</h1><pre class="le lf lg lh fd li lj lk ll aw lm bi"><span id="f5fd" class="kj kk hw lj b fi ln lo l lp lq">px.choropleth(data_frame = data.query(‘jurisdiction != “Alaska”’),<br/>              locations=’state_codes’,<br/>              color=’vax_per_cap’,<br/>              template = ‘plotly_dark’,<br/>              color_continuous_scale=”viridis”,<br/>              animation_frame=’week’,<br/>              locationmode=’USA-states’,<br/>              basemap_visible=False,<br/>              scope=’usa’,<br/>              height=600,<br/>              width=800,<br/>              title=’Pfizer COVID-16 Vaccine allocations’,<br/>              hover_name = ‘jurisdiction’,<br/>              labels={‘vax_per_cap’:’Vaxes % of Population’,<br/>                      ‘week’:’Week’,<br/>                      ‘state_codes’:’State Code’})</span></pre><figure class="le lf lg lh fd hj"><div class="bz dy l di"><div class="mv mw l"/></div></figure><p id="65c3" class="pw-post-body-paragraph jl jm hw jn b jo jp ix jq jr js ja jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">上面你可以看到生成的地图，以及由Plotly Express提供的一些内置交互性的简短演示。</p><h2 id="d7fe" class="kj kk hw bd kl km kn ko kp kq kr ks kt ju ku kv kw jy kx ky kz kc la lb lc ld bi translated">论据的解释:</h2><p id="6250" class="pw-post-body-paragraph jl jm hw jn b jo lr ix jq jr ls ja jt ju lt jw jx jy lu ka kb kc lv ke kf kg ha bi translated"><code class="du mx my mz lj b">data_frame </code>:接受一个数据框架或字典作为输入，在这种情况下，我过滤掉了阿拉斯加，纯粹是因为它在人均剂量方面遥遥领先，并且扰乱了色阶:)</p><p id="4a3c" class="pw-post-body-paragraph jl jm hw jn b jo jp ix jq jr js ja jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated"><code class="du mx my mz lj b">locations</code> : Plotly express需要美国地图的州代码(不是州名)，这是由<a class="ae ki" href="https://gist.github.com/rogerallen/1583593" rel="noopener ugc nofollow" target="_blank"> rogerallen </a>提供的字典帮助的，包含在GitHub repo中。干杯罗杰。</p><p id="2d9f" class="pw-post-body-paragraph jl jm hw jn b jo jp ix jq jr js ja jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated">这是将要告诉绘图对象如何给地图上色的列或系列。</p><p id="39d2" class="pw-post-body-paragraph jl jm hw jn b jo jp ix jq jr js ja jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated"><code class="du mx my mz lj b">template</code>:给你一个简单的方法来访问一些默认的颜色。你可以从<code class="du mx my mz lj b">['ggplot2', 'seaborn', 'simple_white', 'plotly', 'plotly_white', 'plotly_dark'</code>等地选择。</p><p id="1526" class="pw-post-body-paragraph jl jm hw jn b jo jp ix jq jr js ja jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated"><code class="du mx my mz lj b">color_continuous_scale</code>:根据提供给“颜色”栏的数据的分布方式，选择不同的<a class="ae ki" href="https://plotly.com/python/builtin-colorscales/" rel="noopener ugc nofollow" target="_blank">色标</a>可能会有用。</p><p id="d534" class="pw-post-body-paragraph jl jm hw jn b jo jp ix jq jr js ja jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated"><code class="du mx my mz lj b">animation_frame</code>:这是一列将指示颜色如何从一帧到另一帧变化，通常是一个时间序列数据点。</p><p id="57b0" class="pw-post-body-paragraph jl jm hw jn b jo jp ix jq jr js ja jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated"><code class="du mx my mz lj b">basemap_visible</code>:去掉没有相应数据的陆地区域，这里是阿拉斯加。</p><p id="0812" class="pw-post-body-paragraph jl jm hw jn b jo jp ix jq jr js ja jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated"><code class="du mx my mz lj b">labels</code>:我用来清理图例和悬停工具提示中的一些数据标签的字典。</p><p id="ac30" class="pw-post-body-paragraph jl jm hw jn b jo jp ix jq jr js ja jt ju jv jw jx jy jz ka kb kc kd ke kf kg ha bi translated"><strong class="jn hx">关于色阶的一个词:</strong>你可能注意到右边的色阶条是动态的，即。根据每一帧的最小值和最大值在动画过程中进行更改。有一个名为<code class="du mx my mz lj b">range_color</code>的参数，它将上限和下限作为一个元组，允许您锁定一个颜色范围。我在这里没有使用它，因为我想显示状态之间随时间的比较，但如果您希望传递给<code class="du mx my mz lj b">color</code>的变量与一个设定的上下限进行比较，它可以让您进行控制。</p><h1 id="4b33" class="mk kk hw bd kl ml mm mn kp mo mp mq kt jc mr jd kw jf ms jg kz ji mt jj lc mu bi translated">结论！</h1><p id="68b8" class="pw-post-body-paragraph jl jm hw jn b jo lr ix jq jr ls ja jt ju lt jw jx jy lu ka kb kc lv ke kf kg ha bi translated">目前就这些。显然，这里的数据并不是新冠肺炎疫苗推广数据的完美或超级可靠的来源，但希望它是超级强大和易于使用的体面展示<strong class="jn hx"> Plotly Express </strong>，以及在这些麻烦时期世界可能走向何方的一些有希望的迹象。请，请随意叉回购，增加更多的疫苗制造商，并根据您的喜好进行其他调整！很想看看你在评论中提出了什么。</p></div></div>    
</body>
</html>