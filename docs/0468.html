<html>
<head>
<title>ML20: Stepwise Linear Regression with R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ML20:带R的逐步线性回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/ml20-abb54a435b3?source=collection_archive---------25-----------------------#2021-01-17">https://medium.com/analytics-vidhya/ml20-abb54a435b3?source=collection_archive---------25-----------------------#2021-01-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="3e81" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">更高级的术语和交互</h2></div><p id="aa94" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="iz hj">关键词</strong>:逐步线性回归，高次项，相互作用，AIC，BIC，相关热图，散点图</p><p id="9d36" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在Colab上完成R代码:【https://bit.ly/3oRq3cR】T4</p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><ul class=""><li id="e8e5" class="kb kc hi iz b ja jb jd je jg kd jk ke jo kf js kg kh ki kj bi translated">线性回归是最大似然法中一个重要但经常被低估的模型。</li><li id="e514" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">LR提供了一个快速演练<strong class="iz hj">，为</strong>实现更复杂的ML建模和更复杂的分析做准备。</li><li id="215f" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">此外，LR可以作为基准模型<strong class="iz hj">来评估更复杂的ML模型的性能。</strong></li></ul></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><p id="a9bd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在ML19的基础上，我们现在向前迈进，更仔细地看看使用R处理玩具数据集“fuel2001”(燃料数据)的线性回归。)【③】。在第1章&amp;第3章，这本著名的教科书利用这个玩具数据集简明地演示了<strong class="iz hj"> <em class="kp">散点图矩阵</em></strong><strong class="iz hj"><em class="kp">汇总统计</em></strong><strong class="iz hj"><em class="kp">相关矩阵</em> </strong>和<strong class="iz hj"> <em class="kp">多元线性回归</em> </strong></p><div class="kq kr ez fb ks kt"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/ml19-4069a5f7a552"><div class="ku ab dw"><div class="kv ab kw cl cj kx"><h2 class="bd hj fi z dy ky ea eb kz ed ef hh bi translated">ML19:线性回归中的“线性”</h2><div class="la l"><h3 class="bd b fi z dy ky ea eb kz ed ef dx translated">这个“线性”是代表线性函数还是线性映射？</h3></div><div class="lb l"><p class="bd b fp z dy ky ea eb kz ed ef dx translated">medium.com</p></div></div><div class="lc l"><div class="ld l le lf lg lc lh li kt"/></div></div></a></div></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><blockquote class="lj lk ll"><p id="991f" class="ix iy kp iz b ja jb ij jc jd je im jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated"><strong class="iz hj"> <em class="hi">轮廓</em></strong><em class="hi"><br/></em><strong class="iz hj"><em class="hi">(1)</em></strong><em class="hi"/><a class="ae jt" href="#b151" rel="noopener ugc nofollow"><strong class="iz hj"><em class="hi">在Colab中使用R</em></strong></a></p><p id="05ec" class="ix iy kp iz b ja jb ij jc jd je im jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated"><strong class="iz hj"><em class="hi">(2)</em></strong><a class="ae jt" href="#d6a1" rel="noopener ugc nofollow"><strong class="iz hj"><em class="hi">数据来源:油耗</em> </strong> </a></p><p id="25c1" class="ix iy kp iz b ja jb ij jc jd je im jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated"><strong class="iz hj"><em class="hi">【3】</em></strong><em class="hi"/><a class="ae jt" href="#a552" rel="noopener ugc nofollow"><strong class="iz hj"><em class="hi">数据预处理</em></strong></a><em class="hi"><br/>3–1删除一列<br/>3–2转换<br/>3–3保留需要的列</em></p><p id="4587" class="ix iy kp iz b ja jb ij jc jd je im jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated"><strong class="iz hj"><em class="hi">(4)</em></strong><a class="ae jt" href="#7b6f" rel="noopener ugc nofollow"><strong class="iz hj"><em class="hi">数据探索</em></strong></a><em class="hi"><br/>4–1描述性统计<br/>4–2相关矩阵<br/>4–3散点图矩阵<br/>4–4散点图</em></p><p id="bd10" class="ix iy kp iz b ja jb ij jc jd je im jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated"><strong class="iz hj"><em class="hi">(5)</em></strong><em class="hi"/><a class="ae jt" href="#614d" rel="noopener ugc nofollow"><strong class="iz hj"><em class="hi">线性回归</em></strong></a><em class="hi"><br/>5–1信息标准:AIC vs BIC<br/>5–2 LR<br/>5–3 LR有交互<br/>5–4 LR有交互&amp;高次项<br/>5–5逐步LR使用lm()<br/>5–6逐步LR使用lm()&amp;BIC<br/>5–7</em></p><p id="aeb9" class="ix iy kp iz b ja jb ij jc jd je im jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated"><strong class="iz hj"><em class="hi">(6)</em></strong><em class="hi"/><a class="ae jt" href="#abd5" rel="noopener ugc nofollow"><strong class="iz hj"><em class="hi">概要</em></strong></a><em class="hi"><br/></em><strong class="iz hj"><em class="hi">(7)</em></strong><a class="ae jt" href="#793f" rel="noopener ugc nofollow"><strong class="iz hj"><em class="hi">参考文献</em> </strong> </a></p></blockquote></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="b151" class="lp lq hi bd lr ls lt lu lv lw lx ly lz io ma ip mb ir mc is md iu me iv mf mg bi translated">(1)在Colab中使用R[4]</h1><p id="add5" class="pw-post-body-paragraph ix iy hi iz b ja mh ij jc jd mi im jf jg mj ji jj jk mk jm jn jo ml jq jr js hb bi translated">对于新的R-notebook，使用<a class="ae jt" href="https://colab.research.google.com/notebook#create=true&amp;language=r" rel="noopener ugc nofollow" target="_blank">此链接</a>。(速记是<a class="ae jt" href="https://colab.to/r" rel="noopener ugc nofollow" target="_blank">colab.to/r</a>)</p><p id="609b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">可以从IRkernel的演示中学习，比如<a class="ae jt" href="https://colab.fan/IRkernel/IRkernel/example-notebooks/Demo.ipynb" rel="noopener ugc nofollow" target="_blank"> demo.ipynb </a>。</p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="d6a1" class="lp lq hi bd lr ls lt lu lv lw lx ly lz io ma ip mb ir mc is md iu me iv mf mg bi translated">(2)数据来源:燃料消耗[3][6]</h1><p id="c115" class="pw-post-body-paragraph ix iy hi iz b ja mh ij jc jd mi im jf jg mj ji jj jk mk jm jn jo ml jq jr js hb bi translated">读者可以下载下面的“fuel2001.csv”数据集。<br/><a class="ae jt" href="http://users.stat.umn.edu/~sandy/alr4ed/data/" rel="noopener ugc nofollow" target="_blank">http://users.stat.umn.edu/~sandy/alr4ed/data/</a></p><blockquote class="lj lk ll"><p id="dc62" class="ix iy kp iz b ja jb ij jc jd je im jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated"><strong class="iz hj"> <em class="hi">油耗</em> </strong> <em class="hi"> <br/>这个例子的目的是了解美国50个州和哥伦比亚特区的油耗如何变化<br/>(联邦公路管理局，2001)。表1.1描述了本例中使用的变量；数据在文件fuel2001中给出。这些数据是由美国联邦公路管理局收集的。</em></p></blockquote><ul class=""><li id="a13a" class="kb kc hi iz b ja jb jd je jg kd jk ke jo kf js kg kh ki kj bi translated">1.形状:7个变量的51个观察值</li><li id="a167" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">2.目标:“燃料”</li><li id="a087" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">3.功能:“司机”、“收入”、“里程”、“MPC”、“Pop”、“税收”</li></ul></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="a552" class="lp lq hi bd lr ls lt lu lv lw lx ly lz io ma ip mb ir mc is md iu me iv mf mg bi translated">(3)数据预处理</h1><h2 id="7ca0" class="mm lq hi bd lr mn mo mp lv mq mr ms lz jg mt mu mb jk mv mw md jo mx my mf mz bi translated">3–1删除列</h2><pre class="na nb nc nd fd ne nf ng nh aw ni bi"><span id="354a" class="mm lq hi nf b fi nj nk l nl nm">fuel2001 = read.table("fuel2001.csv",sep=",",header = T)<br/>head(fuel2001, n = 4)</span><span id="653f" class="mm lq hi nf b fi nn nk l nl nm">fuel2001_2 = fuel2001[,c(-1)]<br/>names(fuel2001_2)</span></pre><figure class="na nb nc nd fd np er es paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="er es no"><img src="../Images/c0c663cda88409259b9d83313f55a1d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HkfDo6U4GxJfq7g4MWvNCA.png"/></div></div></figure><p id="6e5f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们发现一个奇怪而无用的列，所以我们删除它。</p><h2 id="6813" class="mm lq hi bd lr mn mo mp lv mq mr ms lz jg mt mu mb jk mv mw md jo mx my mf mz bi translated">3–2转换</h2><pre class="na nb nc nd fd ne nf ng nh aw ni bi"><span id="db33" class="mm lq hi nf b fi nj nk l nl nm">fuel2001_3 &lt;- transform(fuel2001_2,<br/>Dlic=1000 * Drivers/Pop,<br/>Fuel=1000 * FuelC/Pop,<br/>Income_2 =Income/1000,<br/>log_Miles = log(Miles))</span></pre><p id="4312" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们做特征工程，通过<em class="kp"> transform() </em>添加新的变量。</p><h2 id="f7c2" class="mm lq hi bd lr mn mo mp lv mq mr ms lz jg mt mu mb jk mv mw md jo mx my mf mz bi translated">3–3保留所需的列</h2><pre class="na nb nc nd fd ne nf ng nh aw ni bi"><span id="f921" class="mm lq hi nf b fi nj nk l nl nm">fuel2001_4 = fuel2001_3[, c(7,8,9,10,11)]<br/>names(fuel2001_4)</span><span id="555e" class="mm lq hi nf b fi nn nk l nl nm">fuel2001_4 = fuel2001_3[, -c(1:6)]<br/>names(fuel2001_4)</span></pre><p id="218a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在“燃料2001_4”的信息如下:</p><ul class=""><li id="7028" class="kb kc hi iz b ja jb jd je jg kd jk ke jo kf js kg kh ki kj bi translated">1.形状:5个变量的51个观察值</li><li id="1a9b" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">2.目标:“燃料”</li><li id="826b" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">3.特征:“税”、“Dlic”、“收入_2”、“对数_英里”</li></ul></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="7b6f" class="lp lq hi bd lr ls lt lu lv lw lx ly lz io ma ip mb ir mc is md iu me iv mf mg bi translated">(4)数据探索[1]</h1><h2 id="8b04" class="mm lq hi bd lr mn mo mp lv mq mr ms lz jg mt mu mb jk mv mw md jo mx my mf mz bi translated">4–1描述性统计</h2><pre class="na nb nc nd fd ne nf ng nh aw ni bi"><span id="0642" class="mm lq hi nf b fi nj nk l nl nm">str(fuel2001_4)</span><span id="bbe4" class="mm lq hi nf b fi nn nk l nl nm">attributes(fuel2001_4)</span><span id="b44b" class="mm lq hi nf b fi nn nk l nl nm">mode(fuel2001_4$Tax)<br/>class(fuel2001_4$Tax)<br/>typeof(fuel2001_4$Tax)</span><span id="2dbe" class="mm lq hi nf b fi nn nk l nl nm">summary(fuel2001_4)</span><span id="8c18" class="mm lq hi nf b fi nn nk l nl nm">colnames(fuel2001_4)<br/>names(fuel2001_4)<br/>rownames(fuel2001_4)<br/>nrow(fuel2001_4)</span><span id="6015" class="mm lq hi nf b fi nn nk l nl nm">head(fuel2001_4, n = 3)<br/>tail(fuel2001_4, n = 3)</span><span id="5a1d" class="mm lq hi nf b fi nn nk l nl nm">dim(fuel2001_4)<br/>length(fuel2001_4)</span><span id="4ebe" class="mm lq hi nf b fi nn nk l nl nm">round(cor(fuel2001_4), 4)<br/>round(var(fuel2001_4), 4) # OR cov(fuel2001_4)</span></pre><figure class="na nb nc nd fd np er es paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="er es nv"><img src="../Images/0864492a74be6402b2bbbd38da87fb3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LQBh4R3iKl20lkd_F6Z0HQ.png"/></div></div></figure><h2 id="278d" class="mm lq hi bd lr mn mo mp lv mq mr ms lz jg mt mu mb jk mv mw md jo mx my mf mz bi translated">4–2相关矩阵</h2><pre class="na nb nc nd fd ne nf ng nh aw ni bi"><span id="1400" class="mm lq hi nf b fi nj nk l nl nm">corrgram(round(cor(fuel2001_4), 4), order=TRUE, upper.panel=panel.cor)</span></pre><div class="na nb nc nd fd ab cb"><figure class="nw np nx ny nz oa ob paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><img src="../Images/56e9115ab9083031755f72595bf00077.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*dWwoFO3ZOBleTLY6PMYsfg.png"/></div></figure><figure class="nw np oc ny nz oa ob paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><img src="../Images/10a283c95b3a81f9409a83ce499d6a5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*FrGWBCOUofwuHlk4ZRTACQ.png"/></div></figure></div><h2 id="abc2" class="mm lq hi bd lr mn mo mp lv mq mr ms lz jg mt mu mb jk mv mw md jo mx my mf mz bi translated">4–3散点图矩阵</h2><figure class="na nb nc nd fd np er es paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="er es od"><img src="../Images/5447d80d326bf9c81679fcd54449882b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U0MWzI2Nag1sR34TP7HceA.png"/></div></div></figure><div class="na nb nc nd fd ab cb"><figure class="nw np oe ny nz oa ob paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><img src="../Images/d980729a2fa493678054be27938e224b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*9bnGCGswFbDznAkDXLhmyg.png"/></div></figure><figure class="nw np oe ny nz oa ob paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><img src="../Images/844b3fe016981c69526a2858bef003a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*sydl1-2_Bsu6tIsTXjryTg.png"/></div></figure></div><h2 id="301a" class="mm lq hi bd lr mn mo mp lv mq mr ms lz jg mt mu mb jk mv mw md jo mx my mf mz bi translated">4–4散点图</h2><div class="na nb nc nd fd ab cb"><figure class="nw np oe ny nz oa ob paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><img src="../Images/b260e3a5aaf7bbdec725bfebb949bb8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*BeV_76Sc59AUeETefFWqTA.png"/></div></figure><figure class="nw np oe ny nz oa ob paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><img src="../Images/49d8352e1a92f934492acbc573e4a2af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*BHuKCs3UzF-BsEQWflT4oQ.png"/></div></figure></div></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="614d" class="lp lq hi bd lr ls lt lu lv lw lx ly lz io ma ip mb ir mc is md iu me iv mf mg bi translated">(5)线性回归</h1><h2 id="c321" class="mm lq hi bd lr mn mo mp lv mq mr ms lz jg mt mu mb jk mv mw md jo mx my mf mz bi translated">5-1信息标准:AIC对BIC [3][8]</h2><ul class=""><li id="fed7" class="kb kc hi iz b ja mh jd mi jg of jk og jo oh js kg kh ki kj bi translated">AIC = n log(RSSpc/n) + 2 Pc</li><li id="2c57" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">BIC = n log(RSSpc/n) + log(n) Pc</li><li id="67db" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">AIC是坂本等人(1986)给出的；BIC是由施瓦茨(1978)给出的。</li><li id="5677" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">AIC和BIC首选较小的值。</li><li id="7cad" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">信息标准通过复杂性术语在<strong class="iz hj"> <em class="kp">缺乏拟合</em> </strong>和<strong class="iz hj"> <em class="kp">复杂性</em> </strong>之间提供平衡，本质上是防止模型过度拟合的惩罚。</li></ul><p id="6b97" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">显然，当<strong class="iz hj"> <em class="kp">样本量n </em> </strong>增加时，AIC的惩罚会相对较小，因而不能降低模型的复杂度。在这种情况下，BIC运行得更好。</p><h2 id="eae1" class="mm lq hi bd lr mn mo mp lv mq mr ms lz jg mt mu mb jk mv mw md jo mx my mf mz bi translated">5–2个左后轮</h2><pre class="na nb nc nd fd ne nf ng nh aw ni bi"><span id="ead3" class="mm lq hi nf b fi nj nk l nl nm">LR_fuel = lm(Fuel ~ Tax  + Dlic + Income_2 + log_Miles, data=fuel2001_4)<br/>summary(LR_fuel)<br/>cat("AIC = ", AIC(LR_fuel), sep = "")</span></pre><figure class="na nb nc nd fd np er es paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="er es oi"><img src="../Images/97d7bf25d9469439869df365aa0703f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ls3SxyuZ7npep44MmiLWDg.png"/></div></div></figure><ul class=""><li id="404d" class="kb kc hi iz b ja jb jd je jg kd jk ke jo kf js kg kh ki kj bi translated">AIC = 577.086</li><li id="8a81" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">BIC = 588.6769</li></ul><h2 id="ca06" class="mm lq hi bd lr mn mo mp lv mq mr ms lz jg mt mu mb jk mv mw md jo mx my mf mz bi translated">带交互的5–3 LR</h2><pre class="na nb nc nd fd ne nf ng nh aw ni bi"><span id="9a8f" class="mm lq hi nf b fi nj nk l nl nm">LR_fuel = lm(Fuel ~ Tax + Dlic + Tax:Dlic + Income_2 + log_Miles, data=fuel2001_4)<br/>summary(LR_fuel)<br/>cat("AIC = ", AIC(LR_fuel), sep = "")</span></pre><ul class=""><li id="d741" class="kb kc hi iz b ja jb jd je jg kd jk ke jo kf js kg kh ki kj bi translated">AIC = 575.6349</li><li id="c874" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">BIC = 589.1577</li></ul><h2 id="ad12" class="mm lq hi bd lr mn mo mp lv mq mr ms lz jg mt mu mb jk mv mw md jo mx my mf mz bi translated">5–4 LR，带交互和更高阶项</h2><pre class="na nb nc nd fd ne nf ng nh aw ni bi"><span id="7fd3" class="mm lq hi nf b fi nj nk l nl nm">LR_fuel = lm(formula = Fuel ~  Tax + Dlic + Tax:Dlic + Income_2 + log_Miles + Tax:Dlic + I(log_Miles**2), data = fuel2001_4)<br/>summary(LR_fuel)<br/>cat("AIC = ", AIC(LR_fuel), sep = "")</span></pre><ul class=""><li id="53c0" class="kb kc hi iz b ja jb jd je jg kd jk ke jo kf js kg kh ki kj bi translated">AIC = 574.9257</li><li id="e935" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">BIC = 592.3121</li></ul><h2 id="e588" class="mm lq hi bd lr mn mo mp lv mq mr ms lz jg mt mu mb jk mv mw md jo mx my mf mz bi translated">使用lm() [7]的5–5逐步LR</h2><pre class="na nb nc nd fd ne nf ng nh aw ni bi"><span id="96aa" class="mm lq hi nf b fi nj nk l nl nm">null_model = lm(Fuel ~ 1, data=fuel2001_4)<br/>full_model = lm(Fuel ~ Tax + Dlic + Income_2 + log_Miles + Tax:Dlic + Tax:Income_2 + Tax:log_Miles + Dlic:Income_2 + Dlic:log_Miles + Income_2:log_Miles + I(Tax^2) + I(Tax^3) + I(Tax^4) + I(Dlic^2) + I(Dlic^3) + I(Dlic^4) + I(Income_2^2) + I(Income_2^3) + I(Income_2^4) + I(log_Miles^2) + I(log_Miles^3) + I(log_Miles^4), data=fuel2001_4)</span><span id="46e5" class="mm lq hi nf b fi nn nk l nl nm">model_step = step(null_model, <br/>                  scope = list(lower=null_model, upper=full_model),<br/>                  direction = "both", k= 2) <br/>                  # direction = c("both", "backward", "forward")<br/>                  # k=2 for AIC; k=log(nrow(train_data)) for BIC</span></pre><ul class=""><li id="a6a5" class="kb kc hi iz b ja jb jd je jg kd jk ke jo kf js kg kh ki kj bi translated"><em class="kp">步骤()</em>的默认信息标准是AIC。</li><li id="8aba" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">k是用于惩罚的自由度的倍数。只有k = 2给出了真正的AIC；k = log(n)有时被称为BIC或SBC。</li></ul><p id="a2d9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">经过反复试验，逐步线性回归给出了如下模型:</p><blockquote class="lj lk ll"><p id="887f" class="ix iy kp iz b ja jb ij jc jd je im jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated"><em class="hi"> lm(公式= Fuel ~ I(Income _ 2)+Dlic+log _ Miles+I(Tax)+I(Dlic)，data = fuel2001_4) </em></p></blockquote><figure class="na nb nc nd fd np er es paragraph-image"><div role="button" tabindex="0" class="nq nr di ns bf nt"><div class="er es oj"><img src="../Images/ade98e09507d5ba256875abaa3c18098.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cJ78qej88PMw2e10KcZghg.png"/></div></div></figure><ul class=""><li id="d8f6" class="kb kc hi iz b ja jb jd je jg kd jk ke jo kf js kg kh ki kj bi translated">AIC = 573.7994</li><li id="fc2f" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">BIC = 587.3221</li></ul><h2 id="c873" class="mm lq hi bd lr mn mo mp lv mq mr ms lz jg mt mu mb jk mv mw md jo mx my mf mz bi translated">使用lm() &amp; BIC的5–6逐步LR</h2><pre class="na nb nc nd fd ne nf ng nh aw ni bi"><span id="8743" class="mm lq hi nf b fi nj nk l nl nm">null_model = lm(Fuel ~ 1, data=fuel2001_4)<br/>full_model = lm(Fuel ~ Tax + Dlic + Income_2 + log_Miles + Tax:Dlic + Tax:Income_2 + Tax:log_Miles + Dlic:Income_2 + Dlic:log_Miles + Income_2:log_Miles + I(Tax^2) + I(Tax^3) + I(Tax^4) + I(Dlic^2) + I(Dlic^3) + I(Dlic^4) + I(Income_2^2) + I(Income_2^3) + I(Income_2^4) + I(log_Miles^2) + I(log_Miles^3) + I(log_Miles^4), data=fuel2001_4)</span><span id="ce1b" class="mm lq hi nf b fi nn nk l nl nm">model_step = step(null_model, <br/>                  scope = list(lower=null_model, upper=full_model),<br/>                  direction = "both", k= log(nrow(fuel2001_4)) ) <br/>                  # direction = c("both", "backward", "forward")<br/>                  # k=2 for AIC; k=log(nrow(train_data)) for BIC</span></pre><p id="5c68" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">经过反复试验，逐步线性回归给出了如下模型:</p><blockquote class="lj lk ll"><p id="f22b" class="ix iy kp iz b ja jb ij jc jd je im jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated"><em class="hi"> lm(公式= Fuel ~ I(Income _ 2)+Dlic+I(Tax)+I(Dlic)，data = fuel2001_4) </em></p></blockquote><ul class=""><li id="e3dd" class="kb kc hi iz b ja jb jd je jg kd jk ke jo kf js kg kh ki kj bi translated">AIC = 575.0315</li><li id="51e7" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">BIC = 586.6225</li></ul><h2 id="c919" class="mm lq hi bd lr mn mo mp lv mq mr ms lz jg mt mu mb jk mv mw md jo mx my mf mz bi translated">使用glm() &amp; BIC的5–7步线性回归</h2><pre class="na nb nc nd fd ne nf ng nh aw ni bi"><span id="7fa4" class="mm lq hi nf b fi nj nk l nl nm">null_model = glm(Fuel ~ 1, data=fuel2001_4, family = gaussian(link = "identity"))</span><span id="6bf4" class="mm lq hi nf b fi nn nk l nl nm">full_model = glm(Fuel ~ Tax + Dlic + Income_2 + log_Miles + Tax:Dlic + Tax:Income_2 + Tax:log_Miles + Dlic:Income_2 + Dlic:log_Miles + Income_2:log_Miles + I(Tax^2) + I(Tax^3) + I(Tax^4) + I(Dlic^2) + I(Dlic^3) + I(Dlic^4) + I(Income_2^2) + I(Income_2^3) + I(Income_2^4) + I(log_Miles^2) + I(log_Miles^3) + I(log_Miles^4), data=fuel2001_4, family = gaussian(link = "identity"))</span><span id="c2f5" class="mm lq hi nf b fi nn nk l nl nm">model_step = step(null_model, <br/>                  scope = list(lower=null_model, upper=full_model),<br/>                  direction = "both", k= log(nrow(fuel2001_4)) ) <br/>                  # direction = c("both", "backward", "forward")<br/>                  # k=2 for AIC; k=log(nrow(train_data)) for BIC</span></pre><p id="193c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="kp"> glm() </em>只是<em class="kp"> lm() </em>的一般形式。<em class="kp"> glm() </em>启用逻辑回归。</p><p id="03b0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">经过反复试验，逐步线性回归给出了如下模型:</p><blockquote class="lj lk ll"><p id="4470" class="ix iy kp iz b ja jb ij jc jd je im jf lm jh ji jj ln jl jm jn lo jp jq jr js hb bi translated"><em class="hi"> glm(公式= Fuel ~ I(Income _ 2)+Dlic+I(Tax)+I(Dlic)，family = gaussian(link = "identity ")，data = fuel2001_4) </em></p></blockquote><ul class=""><li id="5f92" class="kb kc hi iz b ja jb jd je jg kd jk ke jo kf js kg kh ki kj bi translated">AIC = 575.0315</li><li id="5a32" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">BIC = 586.6225</li></ul></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="abd5" class="lp lq hi bd lr ls lt lu lv lw lx ly lz io ma ip mb ir mc is md iu me iv mf mg bi translated">(6)总结</h1><ol class=""><li id="cb2d" class="kb kc hi iz b ja mh jd mi jg of jk og jo oh js ok kh ki kj bi translated">我们探讨了一个玩具数据集“fuel2001”所给出的“<em class="kp">应用线性回归(第4版。)</em>“使用r实现线性回归。我们不仅重现了第1章&amp;第3章中的结果“<em class="kp">应用线性回归(第4版。)</em>”，同时也将这个玩具例子扩展为一个完整的数据分析过程。</li><li id="8492" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js ok kh ki kj bi translated">一般来说，数据分析过程[2]的步骤包括</li></ol><ul class=""><li id="941b" class="kb kc hi iz b ja jb jd je jg kd jk ke jo kf js kg kh ki kj bi translated">思维能力</li><li id="ae0e" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">检索</li><li id="ef37" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">准备</li><li id="958b" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">探测</li><li id="4fd3" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">建模</li><li id="01dc" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">介绍会；展示会</li><li id="3580" class="kb kc hi iz b ja kk jd kl jg km jk kn jo ko js kg kh ki kj bi translated">生殖</li></ul><p id="1a3c" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从预处理、探索到逐步线性回归。换句话说，我们在这篇文章中从检索、准备、探索、建模到演示。</p><p id="6f8a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.我们用交互作用和更高次项(degree &gt; 1) 来体验<strong class="iz hj">逐步回归的力量，这在ML/DS的书或网上的文章中很少提到。</strong></p><p id="b708" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这正是R盛行Python的地方。我们可以<strong class="iz hj">快速选择期望的特征</strong>用于解释或预测，通过这种具有相互作用和更高次项(度&gt; 1)的逐步线性回归。然后，这些选择的特征可以放入更复杂的模型，如SVM，随机森林，XGBoost，节省了大量的时间。</p><p id="9ea4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">读者可以使用Python在ML21中进行相同的分析来检查相应的文章。</p><div class="kq kr ez fb ks kt"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/ml21-8fb43cc5082d"><div class="ku ab dw"><div class="kv ab kw cl cj kx"><h2 class="bd hj fi z dy ky ea eb kz ed ef hh bi translated">ML21:使用Python进行线性回归</h2><div class="la l"><h3 class="bd b fi z dy ky ea eb kz ed ef dx translated">更高级的术语和交互</h3></div><div class="lb l"><p class="bd b fp z dy ky ea eb kz ed ef dx translated">medium.com</p></div></div><div class="lc l"><div class="ol l le lf lg lc lh li kt"/></div></div></a></div></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="793f" class="lp lq hi bd lr ls lt lu lv lw lx ly lz io ma ip mb ir mc is md iu me iv mf mg bi translated">(7)参考文献</h1><p id="81b0" class="pw-post-body-paragraph ix iy hi iz b ja mh ij jc jd mi im jf jg mj ji jj jk mk jm jn jo ml jq jr js hb bi translated">[1]兰德公司J.P. (2017)。人人共享:高级分析和图形(第2版。).马萨诸塞州:艾迪生-韦斯利专业公司。</p><p id="1d76" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[2] Heydt，M. (2017年)。学习熊猫:Python中的高性能数据操作和分析(第2版。).英国伯明翰:Packt出版公司。</p><p id="8cb0" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[3]韦斯伯格，S. (2014年)。应用线性回归(第4版。).新泽西州，约翰·威利父子公司。</p><p id="6865" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[4]科拉科特(2019)。如何将R与Google Colaboratory配合使用？检索自</p><div class="kq kr ez fb ks kt"><a href="https://stackoverflow.com/questions/54595285/how-to-use-r-with-google-colaboratory" rel="noopener  ugc nofollow" target="_blank"><div class="ku ab dw"><div class="kv ab kw cl cj kx"><h2 class="bd hj fi z dy ky ea eb kz ed ef hh bi translated">如何将R与Google Colaboratory配合使用？</h2><div class="la l"><h3 class="bd b fi z dy ky ea eb kz ed ef dx translated">感谢贡献一个堆栈溢出的答案！请务必回答问题。提供详细信息并分享…</h3></div><div class="lb l"><p class="bd b fp z dy ky ea eb kz ed ef dx translated">stackoverflow.com</p></div></div><div class="lc l"><div class="om l le lf lg lc lh li kt"/></div></div></a></div><p id="5836" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[5]身份不明(身份不明)。散点图矩阵-R底图。检索自</p><div class="kq kr ez fb ks kt"><a href="http://www.sthda.com/english/wiki/scatter-plot-matrices-r-base-graphs" rel="noopener  ugc nofollow" target="_blank"><div class="ku ab dw"><div class="kv ab kw cl cj kx"><h2 class="bd hj fi z dy ky ea eb kz ed ef hh bi translated">散点图矩阵- R基础图</h2><div class="la l"><h3 class="bd b fi z dy ky ea eb kz ed ef dx translated">之前，我们描述了R编程的要点，并提供了将数据导入R的快速入门指南</h3></div><div class="lb l"><p class="bd b fp z dy ky ea eb kz ed ef dx translated">www.sthda.com</p></div></div><div class="lc l"><div class="on l le lf lg lc lh li kt"/></div></div></a></div><p id="8d9e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">[6]文件(身份不明)。燃料2001:燃料消耗。检索自</p><div class="kq kr ez fb ks kt"><a href="https://www.rdocumentation.org/packages/alr4/versions/1.0.5/topics/fuel2001" rel="noopener  ugc nofollow" target="_blank"><div class="ku ab dw"><div class="kv ab kw cl cj kx"><h2 class="bd hj fi z dy ky ea eb kz ed ef hh bi translated">2001年燃料</h2><div class="la l"><h3 class="bd b fi z dy ky ea eb kz ed ef dx translated">2001年汽车燃料消耗和相关变量的燃料消耗数据。单位是国家在…</h3></div><div class="lb l"><p class="bd b fp z dy ky ea eb kz ed ef dx translated">www.rdocumentation.org</p></div></div></div></a></div><h2 id="96b9" class="mm lq hi bd lr mn mo mp lv mq mr ms lz jg mt mu mb jk mv mw md jo mx my mf mz bi translated">(中文)</h2><p id="3d5f" class="pw-post-body-paragraph ix iy hi iz b ja mh ij jc jd mi im jf jg mj ji jj jk mk jm jn jo ml jq jr js hb bi">[7] 陳景祥 (2018)。R軟體：應用統計方法 (第二版)。台北：東華書局。</p><p id="a3dc" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi">[8] 钱魏Way (2020)。最优模型选择准则：AIC和BIC。取自<br/><a class="ae jt" href="https://www.biaodianfu.com/aic-bic.html" rel="noopener ugc nofollow" target="_blank">https://www.biaodianfu.com/aic-bic.html</a></p></div></div>    
</body>
</html>