<html>
<head>
<title>COVID-19: Face Mask Detection System with TensorFlow and OpenCV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">新冠肺炎:基于TensorFlow和OpenCV的人脸面具检测系统</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/covid-19-face-mask-detection-system-with-tensorflow-and-opencv-1bd19a14125e?source=collection_archive---------1-----------------------#2021-06-25">https://medium.com/analytics-vidhya/covid-19-face-mask-detection-system-with-tensorflow-and-opencv-1bd19a14125e?source=collection_archive---------1-----------------------#2021-06-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="2ab0" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">关于我</h1><p id="9944" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">嗨，我是Vishal S R，我住在钦奈，我是一名最后一年的B-Tech计算机科学学生。我专攻机器学习。我非常相信自学。我把每个问题都视为探索新事物的机会。</p><p id="d1ad" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">LinkedIn:<a class="ae kf" href="http://www.linkedin.com/in/vishalsr" rel="noopener ugc nofollow" target="_blank"><em class="kg">vishalsr</em>T3】</a></p><p id="bc5e" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">Github: <a class="ae kf" href="https://github.com/vishal-sr" rel="noopener ugc nofollow" target="_blank"> vishal-sr </a></p><p id="c29c" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">insta gram:<a class="ae kf" href="https://www.instagram.com/vishal.sr_" rel="noopener ugc nofollow" target="_blank">T7】vishal . SrT9】_</a></p><p id="09a2" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">项目回购:<a class="ae kf" href="https://github.com/vishal-sr/AI-in-Healthcare/tree/main/Face%20Mask%20Detection" rel="noopener ugc nofollow" target="_blank">T11】Github回购T13】</a></p><h1 id="979b" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">目录</h1><ol class=""><li id="d660" class="kh ki hh je b jf jg jj jk jn kj jr kk jv kl jz km kn ko kp bi translated">摘要</li><li id="6076" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">方法学</li><li id="d43b" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">数据和预处理</li><li id="008f" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">履行</li><li id="3a2c" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">代码😎👨‍💻</li><li id="6a96" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">结论</li></ol><h1 id="cf72" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">摘要</h1><p id="7f76" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi kv translated">世界开始关注人工智能的好处，而不是它的启示。人们开始使用人工智能解决复杂的问题，我们也是。我研究了检测和分类一个人是否戴口罩的问题。随着这个疫情成为<strong class="je hi"> <em class="kg">新常态</em> </strong>戴口罩很重要，并确认我们周围的人是否戴口罩。让我们让人工智能来解决这个问题。我用了两步流水线来解决这个问题。</p><h1 id="f348" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">方法学</h1><p id="edb5" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">正如我提到的，这个项目包括两个步骤，下图显示了两步管道的设计。</p><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es le"><img src="../Images/89d2dc4294844e3ea7ae2a3f5ceff19f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zzg0d9wD4DjMVJ3rWaRjmQ.jpeg"/></div></div></figure><p id="0c04" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">让我们看看我们的系统如何检测人脸并分类人脸是否包含人脸面具。</p><p id="1f2e" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">从视频捕获中，我使用OpenCV获取了一个单独的帧，并将获取的帧传递给Viola-Jones人脸检测器(HaarCascade人脸检测器)。在检测器检测到人脸后，我裁剪了人脸ROI(感兴趣区域),并将其传递到流行的CNN架构VGG16中，以分类人脸ROI是否包含人脸遮罩。之后，使用来自Viola-Jones检测器的坐标和来自VGG16模型的类别概率，我分别为所有可能的人脸及其类别概率绘制了边界框。</p><h1 id="ddb3" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">数据和预处理</h1><p id="cbb3" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我从<a class="ae kf" href="http://github.com/balajisrinivas/Face-Mask-Detection/tree/master/dataset" rel="noopener ugc nofollow" target="_blank"><strong class="je hi"><em class="kg">Github repo</em></strong></a>中收集了数据，其中包含了戴面具和不戴面具的人脸图像。在训练VGG16网络之前，我们必须对数据进行预处理。获取和预处理数据的步骤如下:</p><h2 id="5c05" class="lq if hh bd ig lr ls lt ik lu lv lw io jn lx ly is jr lz ma iw jv mb mc ja md bi translated">导航到数据集文件夹并创建类别、标签字典:</h2><p id="757e" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">获取图像文件夹(带面罩的人脸文件夹和不带面罩的人脸文件夹)并创建类别和标签字典。</p><pre class="lf lg lh li fd me mf mg mh aw mi bi"><span id="da30" class="lq if hh mf b fi mj mk l ml mm">Main folder<br/>    - with_mask<br/>          -- images<br/>          .<br/>          .<br/>    - without_mask<br/>          -- images<br/>          .<br/>          .</span></pre><figure class="lf lg lh li fd lj"><div class="bz dy l di"><div class="mn mo l"/></div></figure><h2 id="b497" class="lq if hh bd ig lr ls lt ik lu lv lw io jn lx ly is jr lz ma iw jv mb mc ja md bi translated">从子文件夹中获取图像并对其进行预处理:</h2><p id="40ae" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">使用OpenCV单独获取每张图像并执行一些预处理步骤，</p><ol class=""><li id="d106" class="kh ki hh je b jf ka jj kb jn mp jr mq jv mr jz km kn ko kp bi translated">将BGR图像转换为RGB格式的cv2.imread()函数将图像读取为BGR。</li><li id="e506" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">将图像大小调整为160 x 160 x 3。</li><li id="02c5" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">将图像转换成NumPy矩阵。</li><li id="570e" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">将所有像素从0重新调整到1</li><li id="bf6a" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">将图像矩阵的大小调整为#images，160，160，3。</li><li id="c88f" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">将目标标签转换成一个热点向量。</li><li id="0b36" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">分为训练集、验证集和测试集。</li></ol><figure class="lf lg lh li fd lj"><div class="bz dy l di"><div class="mn mo l"/></div></figure><h1 id="9826" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">履行</h1><p id="af56" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">当我们有管道、数据和解决问题的方法时，实现整个检测系统是容易的。接近的步骤，</p><ol class=""><li id="8aee" class="kh ki hh je b jf ka jj kb jn mp jr mq jv mr jz km kn ko kp bi translated">导入所需的库和框架</li><li id="0314" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">数据和预处理</li><li id="d1c9" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">建模</li><li id="45af" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">模特培训</li><li id="07e4" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">估价</li><li id="a6fb" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">把所有的放在一起</li></ol><h2 id="b8c5" class="lq if hh bd ig lr ls lt ik lu lv lw io jn lx ly is jr lz ma iw jv mb mc ja md bi translated">导入所需的库和框架</h2><p id="b3f6" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">要实现我们的项目，我们必须首先选择所需的库。</p><pre class="lf lg lh li fd me mf mg mh aw mi bi"><span id="8511" class="lq if hh mf b fi mj mk l ml mm">import os<br/>import cv2<br/>import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.metrics import classification_report, confusion_matrix<br/>from tensorflow.keras.applications.vgg16 import VGG16<br/>from tensorflow.keras.layers import Input, Dense, Flatten<br/>from tensorflow.keras.models import Model, load_model<br/>from tensorflow.keras.preprocessing.image import ImageDataGenerator<br/>from tensorflow.keras.utils import to_categorical</span></pre><h2 id="3ff2" class="lq if hh bd ig lr ls lt ik lu lv lw io jn lx ly is jr lz ma iw jv mb mc ja md bi translated">数据和预处理</h2><p id="ccde" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">数据和所有预处理步骤在上一节中讨论过。</p><h2 id="5bb1" class="lq if hh bd ig lr ls lt ik lu lv lw io jn lx ly is jr lz ma iw jv mb mc ja md bi translated">建模</h2><p id="8f62" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">在这个项目中，我定义了两个模型，一个用于检测人脸，另一个用于对检测到的人脸进行分类。</p><ol class=""><li id="6769" class="kh ki hh je b jf ka jj kb jn mp jr mq jv mr jz km kn ko kp bi translated">人脸检测器</li><li id="2906" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">面罩分类器</li></ol><p id="cb01" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">人脸检测器:</strong></p><p id="5467" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">为了检测人脸，我使用了Viola-Jones人脸检测算法。它将视频帧作为输入，并给我可能的面部坐标、面部高度和宽度。</p><pre class="lf lg lh li fd me mf mg mh aw mi bi"><span id="0278" class="lq if hh mf b fi mj mk l ml mm">faceCascade = cv2.CascadeClassifier(cv2.data.haarcascades + 'haarcascade_frontalface_default.xml')</span></pre><p id="81ee" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">口罩分类器:</strong></p><p id="9571" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">对于人脸面具分类器，我使用了一种流行的技术，称为VGG16 CNN架构的转移学习。</p><blockquote class="ms mt mu"><p id="fd1d" class="jc jd kg je b jf ka jh ji jj kb jl jm mv kc jp jq mw kd jt ju mx ke jx jy jz ha bi translated">迁移学习是机器学习中的一种技术，其中我们可以通过修剪顶层(完全连接的层)来使用在大型数据集上训练的预训练CNN模型进行检测或分类问题。底层(卷积层或扁平化层以下)用于特征提取，我们新添加的全连接层用于分类。</p></blockquote><p id="c05a" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在我们的例子中，我在ImageNet上的预训练VGG16上使用了迁移学习技术，并添加了64个单元作为完全连接层(ReLU激活)和2个单元作为输出层(Softmax激活)。在我们的模型中，只有最后两个层被设置为在我们的数据集上训练(带_mask和不带_mask ),因为所有其他层都是预训练的。</p><figure class="lf lg lh li fd lj"><div class="bz dy l di"><div class="mn mo l"/></div></figure><pre class="lf lg lh li fd me mf mg mh aw mi bi"><span id="aeb4" class="lq if hh mf b fi mj mk l ml mm">Model: "model" _________________________________________________________________ Layer (type)                 Output Shape              Param #    ================================================================= input_1 (InputLayer)         [(None, 160, 160, 3)]     0          _________________________________________________________________ block1_conv1 (Conv2D)        (None, 160, 160, 64)      1792       _________________________________________________________________ block1_conv2 (Conv2D)        (None, 160, 160, 64)      36928      _________________________________________________________________ block1_pool (MaxPooling2D)   (None, 80, 80, 64)        0          _________________________________________________________________ block2_conv1 (Conv2D)        (None, 80, 80, 128)       73856      _________________________________________________________________ block2_conv2 (Conv2D)        (None, 80, 80, 128)       147584     _________________________________________________________________ block2_pool (MaxPooling2D)   (None, 40, 40, 128)       0          _________________________________________________________________ block3_conv1 (Conv2D)        (None, 40, 40, 256)       295168     _________________________________________________________________ block3_conv2 (Conv2D)        (None, 40, 40, 256)       590080     _________________________________________________________________ block3_conv3 (Conv2D)        (None, 40, 40, 256)       590080     _________________________________________________________________ block3_pool (MaxPooling2D)   (None, 20, 20, 256)       0          _________________________________________________________________ block4_conv1 (Conv2D)        (None, 20, 20, 512)       1180160    _________________________________________________________________ block4_conv2 (Conv2D)        (None, 20, 20, 512)       2359808    _________________________________________________________________ block4_conv3 (Conv2D)        (None, 20, 20, 512)       2359808    _________________________________________________________________ block4_pool (MaxPooling2D)   (None, 10, 10, 512)       0          _________________________________________________________________ block5_conv1 (Conv2D)        (None, 10, 10, 512)       2359808    _________________________________________________________________ block5_conv2 (Conv2D)        (None, 10, 10, 512)       2359808    _________________________________________________________________ block5_conv3 (Conv2D)        (None, 10, 10, 512)       2359808    _________________________________________________________________ block5_pool (MaxPooling2D)   (None, 5, 5, 512)         0          _________________________________________________________________ flatten (Flatten)            (None, 12800)             0          _________________________________________________________________ dense_1 (Dense)              (None, 64)                819264     _________________________________________________________________ dense (Dense)                (None, 2)                 130        ================================================================= Total params: 15,534,082 <br/>Trainable params: 819,394 <br/>Non-trainable params: 14,714,688 _________________________________________________________________</span></pre><h2 id="863c" class="lq if hh bd ig lr ls lt ik lu lv lw io jn lx ly is jr lz ma iw jv mb mc ja md bi translated"><strong class="ak">模型训练(人脸面具分类器):</strong></h2><p id="aa2a" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我们的模型在我们之前预处理的图像数据集的ImageDataGenerator()上训练。</p><pre class="lf lg lh li fd me mf mg mh aw mi bi"><span id="a602" class="lq if hh mf b fi mj mk l ml mm">datagen = ImageDataGenerator(<br/>      rotation_range=15,<br/>      zoom_range = 0.15,<br/>      width_shift_range=0.1,<br/>      height_shift_range=0.1)</span></pre><p id="ae8f" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">训练属性和超参数:</p><ul class=""><li id="f839" class="kh ki hh je b jf ka jj kb jn mp jr mq jv mr jz my kn ko kp bi translated">损失函数—分类交叉熵</li><li id="8d87" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz my kn ko kp bi translated">优化器— Adam(自适应矩估计)</li><li id="e7cc" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz my kn ko kp bi translated">纪元— 11</li></ul><figure class="lf lg lh li fd lj"><div class="bz dy l di"><div class="mn mo l"/></div></figure><pre class="lf lg lh li fd me mf mg mh aw mi bi"><span id="972e" class="lq if hh mf b fi mj mk l ml mm">Epoch 1/11 loss: 0.2238 - accuracy: 0.9185 - val_loss: 0.0804 - val_accuracy: 0.9661 <br/>Epoch 2/11 loss: 0.0576 - accuracy: 0.9801 - val_loss: 0.0729 - val_accuracy: 0.9713 <br/>Epoch 3/11 loss: 0.0534 - accuracy: 0.9808 - val_loss: 0.0807 - val_accuracy: 0.9869 <br/>Epoch 4/11 loss: 0.0397 - accuracy: 0.9840 - val_loss: 0.0724 - val_accuracy: 0.9765 <br/>Epoch 5/11 loss: 0.0503 - accuracy: 0.9801 - val_loss: 0.0753 - val_accuracy: 0.9817 <br/>Epoch 6/11 loss: 0.0339 - accuracy: 0.9850 - val_loss: 0.0879 - val_accuracy: 0.9765 <br/>Epoch 7/11 loss: 0.0274 - accuracy: 0.9902 - val_loss: 0.0805 - val_accuracy: 0.9791 <br/>Epoch 8/11 loss: 0.0351 - accuracy: 0.9889 - val_loss: 0.1267 - val_accuracy: 0.9582 <br/>Epoch 9/11 loss: 0.0485 - accuracy: 0.9856 - val_loss: 0.0778 - val_accuracy: 0.9843 <br/>Epoch 10/11 loss: 0.0180 - accuracy: 0.9945 - val_loss: 0.0712 - val_accuracy: 0.9765 <br/>Epoch 11/11 loss: 0.0172 - accuracy: 0.9941 - val_loss: 0.0987 - val_accuracy: 0.9791</span></pre><h2 id="e312" class="lq if hh bd ig lr ls lt ik lu lv lw io jn lx ly is jr lz ma iw jv mb mc ja md bi translated">评估(面罩分类器):</h2><p id="ad9d" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">在这里，我使用三个度量或函数来评估模型，</p><ol class=""><li id="c2c4" class="kh ki hh je b jf ka jj kb jn mp jr mq jv mr jz km kn ko kp bi translated">准确(性)</li><li id="c246" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">混淆矩阵</li><li id="5848" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">分类报告</li><li id="7a9c" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz km kn ko kp bi translated">绘制损耗和精确度</li></ol><p id="ba6d" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">精度:</strong></p><p id="96d1" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在第11个纪元结束时，我们的模型获得了，</p><ul class=""><li id="4984" class="kh ki hh je b jf ka jj kb jn mp jr mq jv mr jz my kn ko kp bi translated">99.41%的训练准确率，</li><li id="b414" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz my kn ko kp bi translated">97.91%的验证准确性，以及</li><li id="2b44" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz my kn ko kp bi translated">99.21%的测试准确率。</li></ul><pre class="lf lg lh li fd me mf mg mh aw mi bi"><span id="87c1" class="lq if hh mf b fi mj mk l ml mm">correct = 0<br/>total = 0<br/>pred = np.argmax(model.predict(X_test), axis=1)<br/>for i, img in enumerate(pred):<br/>      if img == np.argmax(y_test[i]):<br/>            correct += 1<br/>      total += 1</span><span id="1243" class="lq if hh mf b fi mz mk l ml mm">print(correct/total * 100)</span></pre><p id="7301" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">混淆矩阵:</strong></p><p id="7517" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">从测试集(384个样本)上的混淆矩阵中，我获得了，</p><ul class=""><li id="73fa" class="kh ki hh je b jf ka jj kb jn mp jr mq jv mr jz my kn ko kp bi translated">真阳性和真阴性分别是200和181，</li><li id="c268" class="kh ki hh je b jf kq jj kr jn ks jr kt jv ku jz my kn ko kp bi translated">假阳性和假阴性分别为1和2。</li></ul><pre class="lf lg lh li fd me mf mg mh aw mi bi"><span id="de0a" class="lq if hh mf b fi mj mk l ml mm">cm = confusion_matrix(<br/>      np.argmax(model.predict(X_test), axis=1), <br/>      np.argmax(y_test, axis = 1)<br/>     )<br/>print(cm)</span></pre><p id="58b5" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">分类报告:</strong></p><figure class="lf lg lh li fd lj er es paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="er es na"><img src="../Images/5b4c33f2b42c8c72951d1fac04e791c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6nQTFdSA-8hw3Z_QEypMMg.png"/></div></div></figure><pre class="lf lg lh li fd me mf mg mh aw mi bi"><span id="9f53" class="lq if hh mf b fi mj mk l ml mm">cr = classification_report(<br/>      np.argmax(model.predict(X_test), axis=1), <br/>      np.argmax(y_test, axis = 1)<br/>     )<br/>print(cr)</span></pre><p id="a2e5" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">标绘损失和精度:</strong></p><figure class="lf lg lh li fd lj er es paragraph-image"><div class="er es nb"><img src="../Images/4223b042c92f5a85c7324ec282d45edf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*i7O7bnmX2w2nu3GDW6Jv4g.png"/></div></figure><pre class="lf lg lh li fd me mf mg mh aw mi bi"><span id="828a" class="lq if hh mf b fi mj mk l ml mm">plt.plot(np.arange(0, 11), <br/>      history.history['val_loss'], label='val_loss')<br/>plt.plot(np.arange(0, 11), <br/>      history.history['loss'], label = 'loss')<br/>plt.plot(np.arange(0, 11), <br/>      history.history['accuracy'], label = 'accuracy')<br/>plt.plot(np.arange(0, 11), <br/>      history.history['val_accuracy'], label = 'val_accuracy')<br/>plt.legend()<br/>plt.show()</span></pre><h2 id="34a4" class="lq if hh bd ig lr ls lt ik lu lv lw io jn lx ly is jr lz ma iw jv mb mc ja md bi translated">综上所述:</h2><p id="f738" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">让我们看看我们的系统的工作流程，首先我从视频源(视频链接，网络摄像头等)捕捉帧。)并处理图像(从BGR转换为灰度)。将处理后的图像传入Viola-Jones人脸检测器，并获取可能人脸的坐标。在得到人脸的坐标后，我裁剪了人脸ROI(感兴趣区域),并将人脸ROI传递到VGG16人脸遮罩分类器中。VGG16模型返回人脸ROI是否包含人脸遮罩，以及它们的分类概率。根据Viola-Jones和VGG16模型的结果，我使用OpenCV编程绘制了它们的类概率的边界框和文本。</p><figure class="lf lg lh li fd lj"><div class="bz dy l di"><div class="mn mo l"/></div></figure><h2 id="9560" class="lq if hh bd ig lr ls lt ik lu lv lw io jn lx ly is jr lz ma iw jv mb mc ja md bi translated">代码😎👨‍💻</h2><figure class="lf lg lh li fd lj"><div class="bz dy l di"><div class="mn mo l"/></div></figure><figure class="lf lg lh li fd lj"><div class="bz dy l di"><div class="mn mo l"/></div></figure><h1 id="9bd7" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">结论</h1><p id="0da6" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">一个人工智能系统被成功地规划、构建、评估和测试，以发现一个人是否戴着面罩。我所有的项目代码和数据集都上传到了<a class="ae kf" href="https://github.com/vishal-sr/AI-in-Healthcare/tree/main/Face%20Mask%20Detection" rel="noopener ugc nofollow" target="_blank"> Github </a>。</p></div></div>    
</body>
</html>