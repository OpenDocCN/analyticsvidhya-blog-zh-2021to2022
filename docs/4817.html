<html>
<head>
<title>Formula 1 Final Round Twitter Analysis: Scraping</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一级方程式决赛推特分析:刮痧</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/formula-1-final-round-twitter-analysis-scraping-5a78669025c?source=collection_archive---------11-----------------------#2022-02-25">https://medium.com/analytics-vidhya/formula-1-final-round-twitter-analysis-scraping-5a78669025c?source=collection_archive---------11-----------------------#2022-02-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="6850" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">了解如何使用snscrape收集您在Twitter上最喜欢的话题的数据。</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/75bb23346ce23ec49924bbd87e61b244.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3k-IUtMrU3T59Erg"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">Abed Ismail 在<a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="2b24" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我是一个相对较新的F1车迷，嗯，我从小就开始看，我看过迈克尔·舒马赫历史性的世界车手锦标赛，也看过费尔南多·阿隆索以历史性的方式赢得的首个冠军，揭穿了有史以来最伟大的冠军之一。2007年决赛，最不可能的冠军基米·莱科宁和刘易斯·汉密尔顿在最后一个弯道获得了第一个冠军，这对我的国家来说是一个巨大的挫折。</p><p id="8ca9" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">但是没有什么比2021年发生的事情更重要，马克斯·维斯塔潘对奖杯的第一次尝试令人印象深刻，汉密尔顿的赛季呢？伙计，这是一段时间以来世界上最令人印象深刻的比赛之一。</p><p id="65c2" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">但本赛季发生的所有事情都因阿布扎比的最后一场比赛事件而蒙上了阴影，当时尼古拉斯·拉蒂菲在58圈的第53圈撞车，将安全车带入赛道清理混乱，比赛总监迈克尔·马西面临着巨大的压力，要给世界最后一圈，不幸的是，他做出了一系列糟糕的决定。</p><p id="9850" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">在这篇文章中，我将对Twiter上的主要标签进行数据收集，以检查该平台用户的看法如何，一些记者、有影响力的人，甚至是<a class="ae jm" href="https://www.instagram.com/p/CXv8vfcNtER/" rel="noopener ugc nofollow" target="_blank">的司机</a>都表示，由于今年的Homeric冠军争夺战，用户的看法不太友好。</p><h1 id="8419" class="kj kk hh bd kl km kn ko kp kq kr ks kt in ku io kv iq kw ir kx it ky iu kz la bi translated">哪些标签会被使用？</h1><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lb"><img src="../Images/6df0e18b3772f9e1041b7f5304ead354.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*z-rVnSHXPnfgUltW"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">加里·巴特菲尔德在<a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="1c7c" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这是文章的核心，一个错误的标签，一切都可能有偏差，所以我必须在这里peaky。我不会使用任何类似#F1xed或#IStandWithLewisHamilton的东西，因为这些看起来有偏见，但我不会忘记今年的粉丝群有明显的划分，所以像# MaxVerstappen33和#LewisHamilton44这样的标签被考虑在内，因为它们应该是明显的对立面。</p><p id="9a2d" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">但为了更好地发布推文，我将更多地关注平台上任何F1粉丝都使用的更通用的标签，例如F1官方的比赛标签。在TagsFinder上搜索后，将使用的标签列表如下:</p><ul class=""><li id="d145" class="lc ld hh jp b jq jr jt ju jw le ka lf ke lg ki lh li lj lk bi translated">#f1</li><li id="d55a" class="lc ld hh jp b jq ll jt lm jw ln ka lo ke lp ki lh li lj lk bi translated">#配方一</li><li id="fa12" class="lc ld hh jp b jq ll jt lm jw ln ka lo ke lp ki lh li lj lk bi translated">#公式1</li><li id="624d" class="lc ld hh jp b jq ll jt lm jw ln ka lo ke lp ki lh li lj lk bi translated">#国际汽联</li><li id="d964" class="lc ld hh jp b jq ll jt lm jw ln ka lo ke lp ki lh li lj lk bi translated">#abudhabigp</li><li id="f690" class="lc ld hh jp b jq ll jt lm jw ln ka lo ke lp ki lh li lj lk bi translated">#MaxVerstappen33</li><li id="dd71" class="lc ld hh jp b jq ll jt lm jw ln ka lo ke lp ki lh li lj lk bi translated">#LewisHamilton44</li></ul><h1 id="8258" class="kj kk hh bd kl km kn ko kp kq kr ks kt in ku io kv iq kw ir kx it ky iu kz la bi translated">将如何实施？</h1><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lb"><img src="../Images/d0b4544558e61b802cbce34a673e048d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ur8abf1GqVlXYp1r"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">照片由<a class="ae jm" href="https://unsplash.com/@clark_fransa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">阿诺德·弗朗西斯卡</a>在<a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="a0ca" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">本文的目标是为每一天的每个标签生成一个JSON文件，其中包含从2021年12月12日到2021年12月15日4天内收集的所有推文，我不考虑16日的任何事情，因为梅赛德斯声明称他们不会在国际上诉法院对管家的决定提起上诉。</p><p id="67d5" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">关于JSON文件的决定是由于它处理大量数据的能力，如果你不明白我是如何做出这个决定的，我推荐阅读一篇文章，这篇文章来自eduCBA上的Priya Pedamkar。</p><p id="467e" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">为了从Twitter中检索信息，将使用snscrape库，因为它对提取的tweets的数量没有太多限制，可以使用标签和日期作为过滤器。从每个标签中可以检索到50，000条推文，总共有1，400，000条推文。</p><p id="6ac0" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这个统计很重要，因为这是一个备受关注的话题，因此需要大量的推文，这就需要开发者帐户每月收集200万条推文。</p><h1 id="af99" class="kj kk hh bd kl km kn ko kp kq kr ks kt in ku io kv iq kw ir kx it ky iu kz la bi translated">刮之前</h1><p id="89b3" class="pw-post-body-paragraph jn jo hh jp b jq lq ii js jt lr il jv jw ls jy jz ka lt kc kd ke lu kg kh ki ha bi translated">要开始这个抓取，您需要下载snscrape库，但是这里有一个技巧，直接从GitHub下载您的包比从pip下载更好，因为对于开发人员来说，提交一个错误修复比重新加载pip库中的所有文件更快。</p><p id="0a72" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">使用这个程序你唯一需要的要求就是有Python 3.8或更高版本，而且很好用。</p><p id="3785" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">因此，在您的终端上键入以下内容:</p><pre class="ix iy iz ja fd lv lw lx ly aw lz bi"><span id="aecf" class="ma kk hh lw b fi mb mc l md me">pip install git+https://github.com/JustAnotherArchivist/snscrape.git</span></pre><p id="2558" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">然后就起来了！</p><h1 id="91d0" class="kj kk hh bd kl km kn ko kp kq kr ks kt in ku io kv iq kw ir kx it ky iu kz la bi translated">我们刮吧！</h1><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mf"><img src="../Images/4a66758c49f8d2d6d9b19ebb737d891d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*57Xm-ptmIYAf_3Uu"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">照片由<a class="ae jm" href="https://unsplash.com/@drscythe?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">张秀坤镰刀</a>在<a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="c1b9" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这里非常重要的一点是，snscrape是一个通过命令行工作的程序，而且，它不需要任何类型的认证，因为它是直接从web上抓取的。</p><p id="77b7" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">代码非常简单，如下所示:</p><pre class="ix iy iz ja fd lv lw lx ly aw lz bi"><span id="3e52" class="ma kk hh lw b fi mb mc l md me">import os</span><span id="9155" class="ma kk hh lw b fi mg mc l md me">dates = ["2021-12-13", "2021-12-14", "2021-12-15", "2021-12-16"]</span><span id="30c2" class="ma kk hh lw b fi mg mc l md me">hashtags = ["f1", "formula1", "formulaone", "fia", "abudhabigp", "maxverstappen33", "lewishamilton44"]</span><span id="d3f4" class="ma kk hh lw b fi mg mc l md me">for hashtag in hashtags:<br/>    for date in dates:<br/>        os.system(f"snscrape --jsonl --max-results 50000 twitter-   hashtag '{hashtag} until:{date}' &gt; hash{hashtag}{date}.json")<br/>        print(f"Scrape {hashtag} on {date} done!")<br/>    print(f"Scrape of {hashtag} done!")</span><span id="ef52" class="ma kk hh lw b fi mg mc l md me">print("All done!")</span></pre><p id="0ce8" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">让我向您介绍一下，首先导入了<code class="du mh mi mj lw b">os</code>库操作系统，因此可以从代码中执行终端命令，然后提供了一个日期列表，因此可以对其进行迭代，还提供了一个标签列表。首先，程序遍历标签，然后遍历日期。</p><p id="d3db" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">现在是snscrape部分，在这里我们将使用基本语法，调用程序，用<code class="du mh mi mj lw b">--jsonl</code>通知文件的类型，然后是废弃所需的tweets数量<code class="du mh mi mj lw b">--max-results 50000</code>，你想要的搜索类型<code class="du mh mi mj lw b">twitter-hashtag</code>，提供hashtag和你想要抓取的日期限制<code class="du mh mi mj lw b">'{hashtag} until:{date}'</code>，最后是你想要存储数据的文件名<code class="du mh mi mj lw b">&gt; hash{hashtag}{date}.json</code>由于这段代码需要一段时间才能完成， 我放了一些输出来声明它在哪里，也是基于循环，最后一个输出是发送一个通知，说明一切都完成了，中间发生的任何错误都可能被snscrape显示出来。</p><p id="540f" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">在这里，我想对马丁·贝克(Martin Beck)发表一篇令人难以置信的关于如何使用snscrape(snscrape)的教程(T10)，他在这个项目上给了我很大的帮助。虽然，我的台词和他的还是有一些区别，除了教程上用了关键词<code class="du mh mi mj lw b">twitter-search</code>之外，我用<code class="du mh mi mj lw b">twitter-hashtag</code>的原因很明显。</p><p id="f7f7" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">但是我从这个工具中学到的最重要的东西是，因为我是在giving day搜索帖子，所以只用关键字<code class="du mh mi mj lw b">until:</code>就足够了。另一个重要的教训是，我在我的约会中增加了一天，你可能已经注意到了，因为关键词是搜索的上限，所以后面的任何内容都可能被删除，下一个问题是，5万条推文太多了吗？嗯，我不这么认为，但是你可以看看我关于这个项目的下一篇文章，在那里我将清理所有这些数据。</p><p id="0d41" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这里有一个关于这个项目的警告，从平台中提取所有这些tweet花费了大量的时间，我不会很快再次运行它来检查准确的时间，但是代码的第一个改进是打印运行的总时间，以控制抓取所有tweet所需的小时数。</p><h1 id="677d" class="kj kk hh bd kl km kn ko kp kq kr ks kt in ku io kv iq kw ir kx it ky iu kz la bi translated">结论</h1><p id="5b94" class="pw-post-body-paragraph jn jo hh jp b jq lq ii js jt lr il jv jw ls jy jz ka lt kc kd ke lu kg kh ki ha bi translated">取消比赛当天到几天后的所有推文成功实现了，我检查了文件，所有文件都有各种语言的所需数量的推文。以下是我的VSCode窗口中一些文件的打印件:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mm"><img src="../Images/df0f60268db5aa70c2dbe7b0daa4c812.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*2losMY172b9H2jDTlSUqOQ.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">VSCode上的文件列表。(图片鸣谢:作者)</figcaption></figure><p id="c418" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">接下来，我将批量清理所有这些数据，然后创建一个. csv文件来存储所有相关信息。谢谢你阅读它。</p><p id="1a5c" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">下一站见，保重！</p></div></div>    
</body>
</html>