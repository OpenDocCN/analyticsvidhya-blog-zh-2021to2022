<html>
<head>
<title>Analytics Operation Center (AoC) — Azure Modern Data/ML Platform Data Ops</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分析运营中心(AoC) — Azure现代数据/ML平台数据运营</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/analytics-operation-center-aoc-azure-modern-data-platform-data-ops-8441a8837819?source=collection_archive---------4-----------------------#2021-04-01">https://medium.com/analytics-vidhya/analytics-operation-center-aoc-azure-modern-data-platform-data-ops-8441a8837819?source=collection_archive---------4-----------------------#2021-04-01</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="0212" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">能够将Azure现代数据湖/数据仓库架构作为数据操作(DataOps)进行监控。了解每天在数据接收、处理和存储以及向客户交付数据的过程中会发生什么，有助于运营部门向客户提供SLA。</p><p id="94ac" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当作业在任何步骤或数据移动时的处理或数据点失败时，正确的报告和警报至关重要。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/1be65b2abd890c2dadd6cdcadb8ee68f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*U3sc9nnE4vg3NAju.jpg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jo"><img src="../Images/2e125dfbd4ec58411bb07f7f2c4c52a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VktDW6pIALHzLkTl.jpg"/></div></div></figure><p id="ecbf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用日志分析获取所有日志，然后构建一个操作控制面板。还要为单个服务构建多个dashbaord</p><ul class=""><li id="6db4" class="jp jq hh ig b ih ii il im ip jr it js ix jt jb ju jv jw jx bi translated">日志分析仪表板开发人员</li><li id="1e3c" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Kusto查询知识</li><li id="886e" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">工作簿创建</li><li id="ae55" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">构建用于监控的KPI</li><li id="1bf9" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">为支持和监控构建运行操作</li><li id="5ec3" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Azure数据工厂</li><li id="b494" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Azure函数</li><li id="af51" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Azure数据湖商店</li><li id="c68a" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Azure数据块</li><li id="27c1" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Azure数据块增量</li><li id="f4dc" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Azure数据工厂</li><li id="e12b" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Azure数据工厂—数据流</li><li id="5e20" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Azure Synapse分析工作区</li><li id="75c5" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Azure机器学习工作区</li><li id="a863" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">功率BI</li><li id="cc5f" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Azure DevOps</li><li id="6808" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Azure KeyVault</li><li id="2713" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">应用洞察</li><li id="ee92" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Azure Synapse分析—工作区</li><li id="6fe4" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">创建一个高级仪表板来查看整个解决方案</li><li id="2a7f" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">成功处理的ETL作业+成功的数据块作业+可处理的数据可用性=可用性</li><li id="f0f9" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">成功作业总数/成功作业总数(ADF) +成功作业总数/成功作业总数(ADB) = SLA</li><li id="2544" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">ADF ETL的时间和ADB的时间，x分钟=性能</li><li id="35e4" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">ADF或ADB =容量中触发作业失败</li><li id="a98e" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">成本管理</li><li id="0f7a" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">作业警报</li></ul><p id="7870" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae kd" href="https://docs.microsoft.com/en-us/azure/service-health/service-health-overview" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/azure/service-health/service-health-overview</a></p><p id="5bfd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">状态页面:</p><ul class=""><li id="3488" class="jp jq hh ig b ih ii il im ip jr it js ix jt jb ju jv jw jx bi translated">转到Azure门户网站</li><li id="829e" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">搜索服务运行状况</li><li id="6119" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">单击服务健康资源</li><li id="f089" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">选择订阅</li><li id="daef" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">选择部署应用程序的地区</li><li id="8d2d" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">选择应用程序的服务</li><li id="e1bd" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">另存为并为视图命名。</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ke"><img src="../Images/d95b0956ef3e016d5f47102c67cce519.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iv5dUeNlEmOPgf0P.jpg"/></div></div></figure><p id="567a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">范围要监视的相关指标/事件*要使用的指标/源源监视平台(监视器、日志分析等。)ServiceNow集成方法(直接或通过其他工具)</p><ul class=""><li id="671c" class="jp jq hh ig b ih ii il im ip jr it js ix jt jb ju jv jw jx bi translated">高水平的SRE KPI</li><li id="d34a" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">总体总结</li><li id="d1d7" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Azure数据工厂+ Azure数据块+ Azure Synapse分析(SQL DW)</li><li id="1c00" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">由于Azure Data Factory是编排引擎，任何端到端的数据处理都可以在这里进行编排</li><li id="d262" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">因此，对于通过监控Azure Data factory进行的数据处理，我们几乎可以涵盖整个数据处理</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kf"><img src="../Images/01c54e2fcca17be2a06d9d3181edc9fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*T_-hW_UfifWUk59t.jpg"/></div></div></figure><ul class=""><li id="d282" class="jp jq hh ig b ih ii il im ip jr it js ix jt jb ju jv jw jx bi translated">服务级别摘要</li><li id="090d" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Azure数据工厂+ Azure数据块=数据处理</li><li id="6fe5" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Azure Synapse Analytics (SQL DW) =服务/可视化</li><li id="2238" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Azure机器学习=机器学习</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kg"><img src="../Images/970657553afd2137a5c22dea33dcf126.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*m3z5mc7L8qrLb9qZ.jpg"/></div></div></figure><pre class="jd je jf jg fd kh ki kj kk aw kl bi"><span id="a87c" class="km kn hh ki b fi ko kp l kq kr">let Query1 = view () {<br/>let query3 = view () { <br/>ADFPipelineRun <br/>| project Status, Start, End, datetime_diff("Minute",End,Start)<br/>| where Status == "Succeeded" or Status == "Failed" <br/>| summarize Total = todouble(countif(Status == "Succeeded"))/(todouble(countif(Status == "Succeeded")) + todouble(countif(Status == "Failed"))) * 100<br/>| project sre = 'Availability', Total <br/>};<br/>let query4 = view () { <br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where MetricName == "dwu_consumption_percent"<br/>| summarize Total = avg(Total) by MetricName<br/>| project sre = 'Availability', Total<br/>};<br/>let query5 = view () { <br/>DatabricksJobs<br/>| project TimeGenerated, ActionName<br/>| where ActionName == "runSucceeded" or ActionName == "runFailed"<br/>| summarize Total = todouble(countif(ActionName == "runSucceeded"))/(todouble(countif(ActionName == "runSucceeded")) + todouble(countif(ActionName == "runFailed"))) * 100 <br/>| project sre = 'Availability', Total<br/>};<br/>union withsource="TempTableName" query3, query4, query5<br/>| summarize Total = avg(Total) by sre<br/>| project sre, Total<br/>};<br/>let Query2 = view () {<br/>let query3 = view () { <br/>ADFPipelineRun <br/>| project Start, End, datetime_diff("Minute",End,Start), Status<br/>| where Status == "Succeeded"<br/>| summarize duration=avg(datetime_diff("Minute",End,Start)) by Status<br/>| project sre = "Performance" , Total = (duration/10) * 100<br/>};<br/>let query4 = view () { <br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where MetricName == "dwu_used"<br/>| summarize Total = avg(Total) by MetricName<br/>| project sre = 'Performance', Total<br/>};<br/>let query5 = view () { <br/>DatabricksJobs<br/>| project TimeGenerated, ActionName<br/>| where ActionName == "runSucceeded" or ActionName == "runFailed"<br/>| summarize Total = todouble(countif(ActionName == "runSucceeded"))/(todouble(countif(ActionName == "runSucceeded")) + todouble(countif(ActionName == "runFailed"))) * 100 <br/>| project sre = 'Performance', Total<br/>};<br/>union withsource="TempTableName" query3, query4, query5<br/>| summarize Total = avg(Total) by sre<br/>| project sre, Total<br/>}; <br/>let Query3 = view () {<br/>let query3 = view () { <br/>ADFPipelineRun <br/>| project Status<br/>| where Status == "Succeeded" or Status == "Failed" <br/>| summarize Total = todouble(countif(Status == "Succeeded"))/(todouble(countif(Status == "Succeeded")) + todouble(countif(Status == "Failed"))) * 100<br/>| project sre = 'Capacity', Total<br/>};<br/>let query4 = view () { <br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where MetricName == "cache_hit_percent"<br/>| summarize Total = avg(Total) by MetricName<br/>| project sre = 'Capacity', Total<br/>};<br/>let query5 = view () { <br/>DatabricksJobs<br/>| project TimeGenerated, ActionName<br/>| where ActionName == "runSucceeded" or ActionName == "runFailed"<br/>| summarize Total = todouble(countif(ActionName == "runSucceeded"))/(todouble(countif(ActionName == "runSucceeded")) + todouble(countif(ActionName == "runFailed"))) * 100 <br/>| project sre = 'Capacity', Total<br/>};<br/>union withsource="TempTableName" query3, query4, query5<br/>| summarize Total = avg(Total) by sre<br/>| project sre, Total<br/>};   <br/>union withsource="TempTableName" Query1, Query2, Query3<br/>| project sre, Total<br/>| order by sre asc</span><span id="0660" class="km kn hh ki b fi ks kp l kq kr">let Query1 = view () {<br/>let query3 = view () { <br/>ADFPipelineRun <br/>| project Status, Start, End, datetime_diff("Minute",End,Start)<br/>| where Status == "Succeeded" or Status == "Failed" <br/>| summarize Total = todouble(countif(Status == "Succeeded"))/(todouble(countif(Status == "Succeeded")) + todouble(countif(Status == "Failed"))) * 100 by bin(Start, 1d)<br/>| project sre = 'Availability', TimeVal = Start, Total <br/>};<br/>let query4 = view () { <br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where MetricName == "dwu_consumption_percent"<br/>| summarize Total = avg(Total) by bin(TimeGenerated, 1d)<br/>| project sre = 'Availability', TimeVal = TimeGenerated, Total<br/>};<br/>let query5 = view () { <br/>DatabricksJobs<br/>| project TimeGenerated, ActionName<br/>| where ActionName == "runSucceeded" or ActionName == "runFailed"<br/>| summarize Total = todouble(countif(ActionName == "runSucceeded"))/(todouble(countif(ActionName == "runSucceeded")) + todouble(countif(ActionName == "runFailed"))) * 100 by bin(TimeGenerated, 1d)<br/>| project sre = 'Availability', TimeVal = TimeGenerated, Total<br/>};<br/>union withsource="TempTableName" query3, query4, query5<br/>| summarize Total = avg(Total) by sre, TimeVal<br/>| project sre, TimeVal, Total<br/>};<br/>let Query2 = view () {<br/>let query3 = view () { <br/>ADFPipelineRun <br/>| project Start, End, datetime_diff("Minute",End,Start), Status<br/>| where Status == "Succeeded"<br/>| summarize duration=avg(datetime_diff("Minute",End,Start)) by bin(Start, 1d)<br/>| project sre = "Performance", TimeVal = Start , Total = (duration/10) * 100<br/>};<br/>let query4 = view () { <br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where MetricName == "dwu_used"<br/>| summarize Total = avg(Total) by bin(TimeGenerated, 1d)<br/>| project sre = 'Performance', TimeVal = TimeGenerated, Total<br/>};<br/>let query5 = view () { <br/>DatabricksJobs<br/>| project TimeGenerated, ActionName<br/>| where ActionName == "runSucceeded" or ActionName == "runFailed"<br/>| summarize Total = todouble(countif(ActionName == "runSucceeded"))/(todouble(countif(ActionName == "runSucceeded")) + todouble(countif(ActionName == "runFailed"))) * 100 by bin(TimeGenerated, 1d)<br/>| project sre = 'Performance', TimeVal = TimeGenerated, Total<br/>};<br/>union withsource="TempTableName" query3, query4, query5<br/>| summarize Total = avg(Total) by sre, TimeVal<br/>| project sre, TimeVal, Total<br/>}; <br/>let Query3 = view () {<br/>let query3 = view () { <br/>ADFPipelineRun <br/>| project Status, TimeGenerated<br/>| where Status == "Succeeded" or Status == "Failed" <br/>| summarize Total = todouble(countif(Status == "Succeeded"))/(todouble(countif(Status == "Succeeded")) + todouble(countif(Status == "Failed"))) * 100 by bin(TimeGenerated, 1d)<br/>| project sre = 'Capacity', TimeVal = TimeGenerated, Total<br/>};<br/>let query4 = view () { <br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where MetricName == "cache_hit_percent"<br/>| summarize Total = avg(Total) by bin(TimeGenerated, 1d)<br/>| project sre = 'Capacity', TimeVal = TimeGenerated, Total<br/>};<br/>let query5 = view () { <br/>DatabricksJobs<br/>| project TimeGenerated, ActionName<br/>| where ActionName == "runSucceeded" or ActionName == "runFailed"<br/>| summarize Total = todouble(countif(ActionName == "runSucceeded"))/(todouble(countif(ActionName == "runSucceeded")) + todouble(countif(ActionName == "runFailed"))) * 100 by bin(TimeGenerated, 1d)<br/>| project sre = 'Capacity', TimeVal = TimeGenerated, Total<br/>};<br/>union withsource="TempTableName" query3, query4, query5<br/>| summarize Total = avg(Total) by sre, TimeVal<br/>| project sre, TimeVal, Total<br/>};   <br/>union withsource="TempTableName" Query1, Query2, Query3<br/>| project sre, TimeVal, Total</span><span id="39bb" class="km kn hh ki b fi ks kp l kq kr">let Query1 = view () {<br/>ADFPipelineRun <br/>| project Status, Start, End, datetime_diff("Minute",End,Start)<br/>| where Status == "Succeeded" or Status == "Failed" <br/>| summarize Total = todouble(countif(Status == "Succeeded"))/(todouble(countif(Status == "Succeeded")) + todouble(countif(Status == "Failed"))) * 100<br/>| project sre = 'Availability', Total <br/>};<br/>let Query2 = view () {<br/>ADFPipelineRun <br/>| project Start, End, datetime_diff("Minute",End,Start), Status<br/>| where Status == "Succeeded"<br/>| summarize duration=avg(datetime_diff("Minute",End,Start)) by Status<br/>| project sre = 'Performance' , Total = (duration/10) * 100<br/>}; <br/>let Query3 = view () {<br/>ADFPipelineRun <br/>| project Status<br/>| where Status == "Succeeded" or Status == "Failed" <br/>| summarize Total = todouble(countif(Status == "Succeeded"))/(todouble(countif(Status == "Succeeded")) + todouble(countif(Status == "Failed"))) * 100<br/>| project sre = 'Capacity', Total<br/>};   <br/>union withsource="TempTableName" Query1, Query2, Query3<br/>| project sre, Total<br/>| order by sre asc</span><span id="200d" class="km kn hh ki b fi ks kp l kq kr">let Query1 = view () {<br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where MetricName == "dwu_consumption_percent"<br/>| summarize Total = avg(Total) by MetricName<br/>| project sre = 'Capacity', Total<br/>};<br/>let Query2 = view () {<br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where MetricName == "dwu_used"<br/>| summarize Total = avg(Total) by MetricName<br/>| project sre = 'Availability', Total<br/>}; <br/>let Query3 = view () {<br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where MetricName == "cache_hit_percent"<br/>| summarize Total = avg(Total) by MetricName<br/>| project sre = 'Performance', Total<br/>};   <br/>union withsource="TempTableName" Query1, Query2, Query3<br/>| project sre, Total = 100-Total<br/>| order by sre asc</span><span id="b0a8" class="km kn hh ki b fi ks kp l kq kr">let Query1 = view () {<br/>AmlRunStatusChangedEvent  <br/>| project Status<br/>| where Status == "Completed" or Status == "Failed" <br/>| summarize Total = todouble(countif(Status == "Completed"))/(todouble(countif(Status == "Completed")) + todouble(countif(Status == "Failed"))) * 100<br/>| project sre = 'Availability', Total <br/>};<br/>let Query2 = view () {<br/>AmlRunStatusChangedEvent  <br/>| project Status<br/>| where Status == "Completed" or Status == "Failed" <br/>| summarize Total = todouble(countif(Status == "Completed"))/(todouble(countif(Status == "Completed")) + todouble(countif(Status == "Failed"))) * 100<br/>| project sre = 'Performance', Total<br/>}; <br/>let Query3 = view () {<br/>AmlRunStatusChangedEvent  <br/>| project Status<br/>| where Status == "Completed" or Status == "Failed" <br/>| summarize Total = todouble(countif(Status == "Completed"))/(todouble(countif(Status == "Completed")) + todouble(countif(Status == "Failed"))) * 100<br/>| project sre = 'Capacity', Total<br/>};   <br/>union withsource="TempTableName" Query1, Query2, Query3<br/>| project sre, Total<br/>| order by sre asc</span></pre><ul class=""><li id="1b8b" class="jp jq hh ig b ih ii il im ip jr it js ix jt jb ju jv jw jx bi translated">仪表板构建监控数据生命周期操作</li><li id="e22e" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Azure数据工厂和数据块</li><li id="0029" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">可用性和性能</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kt"><img src="../Images/a2822c8212acebaa1fc4fd6f4127af5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*a9hdjTyA7hhT1ztH.jpg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ku"><img src="../Images/020c8a6086a82afb103038f7d3df73b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZPerwKDsQ2_e_nbt.jpg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kv"><img src="../Images/a13492bb6e2c78a70412c54c2db3dc13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kSIYAVoO50jeMpga.jpg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kw"><img src="../Images/9ef6748c78e4b6b3feeb5838e7450b25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TD6G3bjBnhk2iBFn.jpg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kx"><img src="../Images/43e2713cadc758fc4d85a798773558bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rPRaSG4EWzQ9ZUgK.jpg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ky"><img src="../Images/64fd0bce88c990af97094303e8a73cc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vWBGwOB9HJd3AU8S.jpg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kz"><img src="../Images/1ba6265c4553680ba3762284a5dadc01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xVuWmlbigjbSAD6O.jpg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es la"><img src="../Images/d5c1f0fbade54bbf5b00c7d2c894cd9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Y01R8q22kl1Z1Fv0.jpg"/></div></div></figure><ul class=""><li id="1d5a" class="jp jq hh ig b ih ii il im ip jr it js ix jt jb ju jv jw jx bi translated">Azure Synapse工作区</li><li id="b2ed" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">安装在里面的</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kv"><img src="../Images/c8a736f04b13d1c444fa6fb6220199cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lnBRFn6qvQTkMpcr.jpg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kv"><img src="../Images/885ff1b7e09cb95aab7109c0dc44c9cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XGUoJlsmpjkre_3g.jpg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kv"><img src="../Images/6d3bd8e840e10879ba40b574a3e0d440.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*t-f8VUlHtMQiHxR-.jpg"/></div></div></figure><ul class=""><li id="0373" class="jp jq hh ig b ih ii il im ip jr it js ix jt jb ju jv jw jx bi translated">数据湖可用性</li><li id="155d" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">查询KQL</li><li id="a004" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">有效性</li></ul><pre class="jd je jf jg fd kh ki kj kk aw kl bi"><span id="a00a" class="km kn hh ki b fi ko kp l kq kr">ADFPipelineRun <br/>| project Status<br/>| where Status contains "Succeeded" or Status contains "Failed" <br/>| summarize Count=count() by Status<br/>| project Status, Count<br/><br/>DatabricksClusters <br/>| where RequestParams contains "Terminated"<br/>| summarize Count=count() by RequestParams<br/>| project 'Completed', Count</span><span id="d02c" class="km kn hh ki b fi ks kp l kq kr">ADFPipelineRun <br/>| project Start, End, datetime_diff("Minute",End,Start), Status<br/>| where Status == "Succeeded"<br/>| summarize duration=avg(datetime_diff("Minute",End,Start)) by Status<br/>| project "Performance" , duration</span><span id="d4f1" class="km kn hh ki b fi ks kp l kq kr">ADFPipelineRun<br/>| where Status == "Succeeded" or Status == "Failed"<br/>| summarize Count=count()<br/>| project 'Capacity', Count</span><span id="6003" class="km kn hh ki b fi ks kp l kq kr">AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where MetricName == "dwu_consumption_percent"<br/>| summarize sum(Total) by MetricName<br/><br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where MetricName == "dwu_used"<br/>| summarize sum(Total) by MetricName<br/><br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where MetricName == "cache_hit_percent"<br/>| summarize avg(Total) by MetricName</span><span id="82af" class="km kn hh ki b fi ks kp l kq kr">ADFPipelineRun <br/>| where OperationName contains "InProgress"<br/>| summarize Count=count()<br/>| project 'Jobs Running', Count<br/><br/>DatabricksClusters <br/>| where RequestParams contains "Running"<br/>| summarize Count=count() by RequestParams<br/>| project 'Running', Count</span><span id="5d1c" class="km kn hh ki b fi ks kp l kq kr">ADFPipelineRun<br/>| where Status  contains "Succeeded" or Status contains "Failed"<br/>| order by TimeGenerated desc <br/>| project PipelineName, Status, TimeGenerated<br/>| limit 5<br/><br/>DatabricksNotebook <br/>| project TimeGenerated, ResourceId, RequestParams<br/>| order by TimeGenerated desc <br/>| limit 5</span><span id="3738" class="km kn hh ki b fi ks kp l kq kr">DatabricksJobs <br/>| project TimeGenerated, ActionName, UserAgent, Response, RequestParams<br/>| where ActionName == "runSucceeded"<br/>| order by TimeGenerated desc<br/>| limit 5</span><span id="fcc2" class="km kn hh ki b fi ks kp l kq kr">let Query1 = view () {<br/>AzureMetrics<br/>| project MetricName, Average, Total, TimeGenerated, ResourceProvider<br/>| where ResourceProvider == "MICROSOFT.STORAGE" and MetricName == "Availability"<br/>| summarize Total = avg(Average) by MetricName<br/>| project MetricName, Total<br/>};<br/>let Query2 = view () {<br/>AzureMetrics<br/>| project MetricName, Average, Total, TimeGenerated, ResourceProvider<br/>| where ResourceProvider == "MICROSOFT.STORAGE" and MetricName != "Availability"<br/>| summarize Total = sum(Total) by MetricName<br/>| project MetricName, Total<br/>}; <br/>union withsource="TempTableName" Query1, Query2<br/>| project MetricName, Total<br/>| order by MetricName asc</span><span id="3a01" class="km kn hh ki b fi ks kp l kq kr">let Query1 = view () {<br/>AzureMetrics<br/>| project MetricName, Average, Total, TimeGenerated, ResourceProvider<br/>| where ResourceProvider == "MICROSOFT.KEYVAULT" and MetricName == "Availability"<br/>| summarize Total = avg(Average) by MetricName<br/>| project MetricName, Total = (Total * 100)<br/>| order by MetricName asc <br/>};<br/>let Query2 = view () {<br/>AzureMetrics<br/>| project MetricName, Average, Total, TimeGenerated, ResourceProvider<br/>| where ResourceProvider == "MICROSOFT.KEYVAULT" and MetricName != "Availability" and MetricName != "ServiceApiLatency"<br/>| summarize Total = sum(Total) by MetricName<br/>| project MetricName, Total<br/>}; <br/>let Query3 = view () {<br/>AzureMetrics<br/>| project MetricName, Average, Total, TimeGenerated, ResourceProvider<br/>| where ResourceProvider == "MICROSOFT.KEYVAULT" and MetricName == "ServiceApiLatency"<br/>| summarize Total = sum(Total) by MetricName<br/>| project MetricName, Total<br/>};<br/>union withsource="TempTableName" Query1, Query2, Query3<br/>| project MetricName, Total<br/>| order by MetricName asc</span><span id="f7ec" class="km kn hh ki b fi ks kp l kq kr">AzureMetrics<br/>| project MetricName, Average, Total, TimeGenerated, ResourceProvider<br/>| where ResourceProvider == "MICROSOFT.EVENTHUB"<br/>| summarize Total = sum(Total) by MetricName</span><span id="4edb" class="km kn hh ki b fi ks kp l kq kr">AzureMetrics<br/>| project MetricName, Average, Total, TimeGenerated, ResourceProvider<br/>| where ResourceProvider == "MICROSOFT.CONTAINERREGISTRY"<br/>| summarize Total = sum(Total) by MetricName</span><span id="afca" class="km kn hh ki b fi ks kp l kq kr">StorageBlobLogs <br/>| project TimeGenerated, AccountName, OperationName, StatusCode, DurationMs, ServerLatencyMs<br/><br/>StorageBlobLogs <br/>| project TimeGenerated, AccountName, OperationName, StatusCode, DurationMs, ServerLatencyMs<br/>| summarize DurationMs=avg(DurationMs), ServerLatencyMs=avg(ServerLatencyMs) by OperationName</span></pre><ul class=""><li id="fb6a" class="jp jq hh ig b ih ii il im ip jr it js ix jt jb ju jv jw jx bi translated">Azure Synapse分析工作区KPI</li><li id="8b79" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">工作空间数据、集成、spark和内置sql和sql池</li><li id="93b2" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">缺失内置sql指标</li></ul><pre class="jd je jf jg fd kh ki kj kk aw kl bi"><span id="fed0" class="km kn hh ki b fi ko kp l kq kr">SynapseBigDataPoolApplicationsEnded <br/><br/>SynapseBigDataPoolApplicationsEnded<br/>| project TimeGenerated, Properties.startTime, Properties.endTime, Properties.applicationName, Properties.livyState, minute = datetime_diff('minute',todatetime(Properties.endTime), todatetime(Properties.startTime))<br/><br/>SynapseSqlPoolDmsWorkers <br/><br/>SynapseSqlPoolExecRequests <br/><br/>SynapseSqlPoolExecRequests <br/>| project TimeGenerated, OperationName , Status, StartTime, EndTime ,minute = datetime_diff('day',todatetime(EndTime), todatetime(StartTime))<br/><br/>SynapseSqlPoolRequestSteps <br/><br/>SynapseSqlPoolRequestSteps <br/>| project TimeGenerated, Status, StartTime, EndTime, Command<br/><br/>SynapseSqlPoolSqlRequests <br/><br/>SynapseSqlPoolSqlRequests<br/>| project TimeGenerated, Status, StartTime, EndTime, Command<br/><br/>SynapseBuiltinSqlPoolRequestsEnded <br/><br/>SynapseBuiltinSqlPoolRequestsEnded <br/>| project TimeGenerated, Properties.startTime, Properties.endTime, Properties.command, Properties.queryText<br/>| sort by TimeGenerated desc <br/>| limit 10<br/><br/>SynapseRbacOperations <br/>| sort by TimeGenerated desc<br/>| limit 10<br/><br/>SynapseGatewayApiRequests <br/>| sort by TimeGenerated desc<br/>| limit 20</span></pre><ul class=""><li id="cf0d" class="jp jq hh ig b ih ii il im ip jr it js ix jt jb ju jv jw jx bi translated">基于每个服务</li><li id="4a1e" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">监控什么</li><li id="30b8" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">活动失败</li><li id="d773" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">管道故障运行</li><li id="76e7" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">TriggerFailedRuns</li><li id="fdab" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">SSISIntegrationRuntimeStartFailed失败</li><li id="db0f" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">管道成功运行</li><li id="e692" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">有效性</li><li id="fd4b" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">数据工厂的可用性就像完成的任务和失败的任务。例如，运行了100个作业，10个失败，因此可用性为90%。这是用于作业操作的。我相信PipelineSucceededRuns和PipelineFailedRuns可以提供这些细节来计算公式。</li><li id="6443" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Azure Datafactory服务的正常运行时间显示在Azure服务可用性仪表板中。</li><li id="d003" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">数据流的度量包括接收器处理时间、写入每个接收器的行数和从每个源读取的行数。更多信息可在<a class="ae kd" href="https://docs.microsoft.com/en-us/azure/data-factory/concepts-data-flow-monitoring" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</li></ul><pre class="jd je jf jg fd kh ki kj kk aw kl bi"><span id="e3bb" class="km kn hh ki b fi ko kp l kq kr">ADFActivityRun <br/>| where  OperationName == "dataflow1 - Succeeded"</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lb"><img src="../Images/8b7b9e4532d02d261d0138b6017fc397.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Fyo_RM4qxGcMI6GE.jpg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lc"><img src="../Images/e610835495d745cb12a567410fbcdbd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*52Pi6aGpVuDP7TgJ.jpg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ld"><img src="../Images/25ccc10e8197f497acd3bb50711ede30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*73lHGhs0H4Vt0DZu.jpg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kx"><img src="../Images/e0ba96933f9db016529b71632abf708c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*F8qfVyKLvuDgg0td.jpg"/></div></div></figure><pre class="jd je jf jg fd kh ki kj kk aw kl bi"><span id="1311" class="km kn hh ki b fi ko kp l kq kr">let Query1 = view () {<br/>AzureMetrics<br/>| project MetricName, Average, Total, TimeGenerated, ResourceProvider<br/>| where ResourceProvider == "MICROSOFT.STORAGE" and MetricName == "Availability"<br/>| summarize Total = avg(Average) by MetricName<br/>| project MetricName, Total<br/>};<br/>let Query2 = view () {<br/>AzureMetrics<br/>| project MetricName, Average, Total, TimeGenerated, ResourceProvider<br/>| where ResourceProvider == "MICROSOFT.STORAGE" and MetricName != "Availability"<br/>| summarize Total = sum(Total) by MetricName<br/>| project MetricName, Total<br/>}; <br/>union withsource="TempTableName" Query1, Query2<br/>| project MetricName, Total<br/>| order by MetricName asc</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es le"><img src="../Images/40c19feb67893b23eeb5a23dc3e7df1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*x_IWNpi7eih_4Q4-.jpg"/></div></div></figure><p id="cca6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae kd" href="https://github.com/balakreshnan/Accenture/blob/master/cap/ADLScontainerSize.md" rel="noopener ugc nofollow" target="_blank">https://github . com/balakreshnan/Accenture/blob/master/cap/adlscontainersize . MD</a></p><p id="17ad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae kd" href="https://github.com/balakreshnan/Accenture/blob/master/cap/SparkADLSlogview.md" rel="noopener ugc nofollow" target="_blank">https://github . com/balakreshnan/Accenture/blob/master/cap/sparkadlslogview . MD</a></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kv"><img src="../Images/495a2dbca6ae00e5603a8e43f9c80b7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*x5FA9OKzMsapKxck.jpg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kv"><img src="../Images/f7c3909c2ad11723e6bd908256525b4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GtkgXRtf9ingku2b.jpg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kv"><img src="../Images/29aa33c1d4a5fb815a5a1ab4e7be1f42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kPQl_YOKTJawopsy.jpg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kv"><img src="../Images/6f2155f5ebfd4cd0483aa1768669219a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DtGjlzFn89IP6zW2.jpg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kv"><img src="../Images/893d3b2b31b2d17dd3d46e7f29d10765.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JLHo0lElFu-wWRcD.jpg"/></div></div></figure><ul class=""><li id="ed6c" class="jp jq hh ig b ih ii il im ip jr it js ix jt jb ju jv jw jx bi translated">失败的请求</li><li id="e364" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">服务器响应时间</li><li id="54c2" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">服务器请求</li><li id="083c" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">可用性</li><li id="3c75" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">代码错误必须更新到application insights中，以构建自定义仪表板。</li><li id="e159" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">容量</li></ul><pre class="jd je jf jg fd kh ki kj kk aw kl bi"><span id="7a9f" class="km kn hh ki b fi ko kp l kq kr">import json <br/>import pandas as pd <br/>from pandas.io.json import json_normalize<br/><br/>end_point = '/api/2.0/jobs/runs/list?limit=50'<br/><br/>response = requests.get(<br/>  DOMAIN + end_point,<br/>  headers={'Authorization': 'Bearer ' + TOKEN}<br/> )<br/>data = response.json()<br/>pdf = json_normalize(data['runs'])<br/>pdf.to_csv("/dbfs/tmp/Export_data.csv",index=False)<br/>df = spark.read.csv("/tmp/Export_data.csv")<br/>jobs = (df.filter("_c0&lt;&gt;'job_id'")<br/>       .select(col("_c0").alias("job_id"),<br/>               col("_c1").alias("run_id"),<br/>               col("_c4").alias("start_time_unix"),<br/>               col("_c5").alias("setup_duration"),<br/>               col("_c6").alias("execution_duration"),<br/>               col("_c7").alias("cleanup_duration"),<br/>               col("_c8").alias("trigger"),<br/>               col("_c10").alias("run_name"),<br/>               col("_c12").alias("run_type"),<br/>               col("_c16").alias("schedule"),<br/>               col("_c19").alias("notebook"),<br/>               col("_c27").alias("cluster_id"),<br/>               col("_c26").alias("libraries"))<br/>          )<br/><br/>jobs.createOrReplaceTempView("jobs")<br/>display(jobs)</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lf"><img src="../Images/20b739016a75526916758587a896c387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hXhZZLN1X0n1-HYQ.jpg"/></div></div></figure><ul class=""><li id="8437" class="jp jq hh ig b ih ii il im ip jr it js ix jt jb ju jv jw jx bi translated">CPU百分比—可用性</li><li id="a31c" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">数据IO百分比</li><li id="eaa0" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">记忆百分比</li><li id="04db" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">DWU百分比—容量</li><li id="d4b6" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">本地温度百分比</li><li id="39ba" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">排队查询</li><li id="3971" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">DWU百分比是一个很好的观察，因为更多的DWU使用性能将下降(容量)。</li><li id="00f2" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">计算(DWU百分比/DWU限制)* 100将给出容量。</li><li id="0497" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">DWU极限-DWU百分比-将给出可用性。</li><li id="a962" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">平均排队查询—性能</li><li id="300d" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">工作簿根据顶部设置的时间范围进行过滤</li></ul><pre class="jd je jf jg fd kh ki kj kk aw kl bi"><span id="45e7" class="km kn hh ki b fi ko kp l kq kr">ADFPipelineRun <br/>| where OperationName contains "Queued" or OperationName contains "Succeeded"<br/><br/>// count of Job Queued<br/><br/>ADFPipelineRun <br/>| project Status<br/>| where Status contains "Succeeded" or Status contains "Failed" <br/>| summarize Count=count() by Status<br/>| project Status, Count<br/><br/>ADFPipelineRun <br/>| project Start, End, datetime_diff("Minute",End,Start), Status<br/>| where Status == "Succeeded"<br/>| summarize duration=avg(datetime_diff("Minute",End,Start))<br/><br/><br/>ADFPipelineRun<br/>| where Status == "Succeeded" or Status == "Failed"<br/><br/>ADFPipelineRun<br/>| where Status == "Succeeded" or Status == "Failed"<br/>| summarize Count=count()<br/>| project 'Capacity', Count<br/><br/>ADFPipelineRun <br/>| where OperationName contains "Queued"<br/>| where TimeGenerated &gt; ago(62d)<br/>| summarize count()<br/><br/>//Count of Jobs in Progress<br/>ADFPipelineRun <br/>| where OperationName contains "InProgress"<br/>| where TimeGenerated &gt; ago(62d)<br/>| summarize count()<br/><br/>//count of job succeeded<br/>ADFPipelineRun <br/>| where OperationName contains "Succeeded"<br/>| where TimeGenerated &gt; ago(62d)<br/>| summarize count()<br/><br/>//top 10 pipeline in progress<br/>ADFPipelineRun<br/>| where OperationName  contains "InProgress"<br/>| where TimeGenerated &gt; ago(62d)<br/>| order by TimeGenerated desc <br/>| limit 10<br/><br/>//top 10 pipeline in progress<br/>ADFPipelineRun<br/>| where OperationName  contains "Succeeded"<br/>| where TimeGenerated &gt; ago(62d)<br/>| order by TimeGenerated desc <br/>| limit 10<br/><br/>//Pipeline runs and count over time period<br/>ADFPipelineRun<br/>| project TimeGenerated, OperationName<br/>| where TimeGenerated &gt; ago(62d)<br/>| order by TimeGenerated desc <br/>| summarize Count=count() by OperationName<br/><br/><br/>DatabricksNotebook <br/><br/>DatabricksClusters <br/><br/>//Cluster succeeded<br/>DatabricksClusters<br/>| where OperationName contains "startResult" and Response contains "200"<br/>| where TimeGenerated &gt; ago(62d)<br/><br/>//cluster failure<br/>DatabricksClusters<br/>| where OperationName contains "startResult" and Response !contains "200"<br/>| where TimeGenerated &gt; ago(62d)<br/><br/>DatabricksClusters <br/>| project RequestParams<br/>| where RequestParams contains "Running"<br/><br/>DatabricksClusters <br/>| project RequestParams<br/>| where RequestParams contains "Terminated"<br/><br/>DatabricksClusters <br/>| project RequestParams<br/>| where RequestParams contains "Failed"<br/><br/>//cluster running count<br/>DatabricksClusters <br/>| where RequestParams contains "Running"<br/>| where TimeGenerated &gt; ago(62d)<br/>| summarize count()<br/><br/>//Clusters that got terminated<br/>DatabricksClusters <br/>| where RequestParams contains "Terminated"<br/>| where TimeGenerated &gt; ago(62d)<br/>| summarize count()<br/><br/>//clusters that failed<br/>DatabricksClusters <br/>| where RequestParams contains "Failed"<br/>| where TimeGenerated &gt; ago(62d)<br/>| summarize count()<br/><br/>//List of notebooks ran<br/>DatabricksNotebook <br/>| where TimeGenerated &gt; ago(31d)<br/>| order by TimeGenerated desc <br/><br/>//Current Top 20 notebooks<br/>DatabricksNotebook <br/>| project TimeGenerated, RequestParams<br/>| where TimeGenerated &gt; ago(31d)<br/>| order by TimeGenerated desc <br/>| limit 10<br/><br/>AzureDiagnostics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where TimeGenerated &gt; ago(62d)<br/>| limit 1000<br/><br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where TimeGenerated &gt; ago(62d)<br/>| summarize avg(Total) by MetricName<br/><br/>//display consumption used<br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where TimeGenerated &gt; ago(62d)<br/>| where MetricName contains "dtu_consumption_percent"<br/>| summarize avg(Total) by MetricName<br/><br/>//Average storaged used<br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where TimeGenerated &gt; ago(62d)<br/>| where MetricName == "storage"<br/>| summarize Total=avg(Total) by MetricName<br/><br/>//Failed connection<br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where TimeGenerated &gt; ago(62d)<br/>| where MetricName == "connection_failed"<br/>| summarize Total=avg(Total) by MetricName<br/><br/><br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where TimeGenerated &gt; ago(62d)<br/>| where MetricName == "dtu_used"<br/>| summarize Total=avg(Total) by MetricName<br/><br/><br/>//active connection session percent<br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where TimeGenerated &gt; ago(62d)<br/>| where MetricName == "sessions_percent"<br/>| summarize Total=avg(Total) by MetricName<br/><br/><br/>//Data Stored<br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where TimeGenerated &gt; ago(62d)<br/>| where MetricName == "allocated_data_storage"<br/>| summarize Total=avg(Total) by MetricName<br/><br/>//DWU used by synapse analytics<br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where TimeGenerated &gt; ago(62d)<br/>| where MetricName == "dwu_used"<br/>| summarize Total=avg(Total) by MetricName<br/><br/>//Get query status<br/>AzureDiagnostics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where Category contains "QueryStoreRuntimeStatistics"<br/>| where TimeGenerated &gt; ago(62d)<br/>| limit 1000<br/><br/>//Audit logs for Azure KeyVault<br/>AzureDiagnostics<br/>| where ResourceProvider == "MICROSOFT.KEYVAULT"<br/>| where TimeGenerated &gt; ago(62d)<br/>| limit 1000<br/><br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where MetricName == "dwu_consumption_percent"<br/>| summarize sum(Total) by MetricName<br/><br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where MetricName == "dwu_used"<br/>| summarize sum(Total) by MetricName<br/><br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| where MetricName == "cache_hit_percent"<br/>| summarize avg(Total) by MetricName</span><span id="a8c2" class="km kn hh ki b fi ks kp l kq kr">DatabricksClusters<br/>| limit 100 <br/><br/>DatabricksNotebook<br/>| limit 1000<br/><br/>ADFPipelineRun<br/>| limit 100<br/><br/>AmlComputeClusterEvent<br/>| limit 1000<br/><br/>Alert<br/>| limit 1000<br/><br/>AzureDiagnostics<br/>| limit 1000<br/><br/>AzureDiagnostics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| limit 1000<br/><br/>Usage<br/>| limit 1000<br/><br/>Usage<br/>| summarize sum(Quantity) by DataType<br/>| limit 1000<br/><br/>AzureMetrics<br/>| limit 1000<br/><br/>AzureMetrics<br/>| where ResourceProvider == "MICROSOFT.SQL"<br/>| summarize avg(Average) by MetricName<br/><br/>DatabricksAccounts<br/>| limit 1000<br/><br/>ADFActivityRun<br/>| limit 100<br/><br/>SynapseBigDataPoolApplicationsEnded <br/><br/>SynapseSqlPoolDmsWorkers <br/><br/>SynapseSqlPoolExecRequests <br/><br/>SynapseSqlPoolRequestSteps <br/><br/>SynapseSqlPoolSqlRequests <br/><br/>StorageBlobLogs</span></pre><h1 id="06a2" class="lg kn hh bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">可以通过审计日志或活动日志来访问用户活动</h1><ul class=""><li id="2fd7" class="jp jq hh ig b ih md il me ip mf it mg ix mh jb ju jv jw jx bi translated">审核日志(需要全局管理员权限)—可通过<a class="ae kd" href="https://login.microsoftonline.com/common/oauth2/authorize?client_id=80ccca67-54bd-44ab-8625-4b79c4dc7775&amp;response_mode=form_post&amp;response_type=code+id_token&amp;scope=openid+profile&amp;state=OpenIdConnect.AuthenticationProperties%3dWRK9KZQqQFYyvDJMx2gsCDvNRAXsW_yPWi6mVSfpkFHUoKnolNp2G_zAs_3qT8tpiIEvZVEdD0KKLgP9PO1-CKla2nlIeBSEViJeMsDHGpstT9Nh5JuAM3v-kXs3ePi2D_tBoctidZfql5oVsud9iQ&amp;nonce=637402999850476896.YjdkZWMzNDUtNjgwNS00NDZiLTk2YTktOTJlZjAyZDdjYmQ5YzZjMWY0YmYtZGUwZi00ZmMzLTk2ODItZmQ4ZDYwZWY3MzM2&amp;redirect_uri=https%3a%2f%2fsip.protection.office.com%2f&amp;sso_nonce=AQABAAAAAAB2UyzwtQEKR7-rWbgdcBZI15x292ADpHdlvN0n9XD4R-rlvhfX4kYgbGSwB1x7famWSCY260PTbf-mxRtnFc_zjTx0MZGLV-_mKp9iCKx6OCAA&amp;client-request-id=30cc94a0-8550-490c-ac91-4a26a579f591&amp;mscrid=30cc94a0-8550-490c-ac91-4a26a579f591#/unifiedauditlog" rel="noopener ugc nofollow" target="_blank"> Office 365 Securirt &amp;合规中心</a>获得</li><li id="7820" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">Power BI活动日志(需要Power BI服务管理员或全局管理员权限)—Power BI REST API可用于生成类似于以下请求的活动事件。更多信息可在<a class="ae kd" href="https://docs.microsoft.com/en-us/power-bi/admin/service-admin-auditing#activity-log-requirements" rel="noopener ugc nofollow" target="_blank">这里</a>找到</li></ul><pre class="jd je jf jg fd kh ki kj kk aw kl bi"><span id="a9b6" class="km kn hh ki b fi ko kp l kq kr"><a class="ae kd" href="https://api.powerbi.com/v1.0/myorg/admin/activityevents?startDateTime='2019-08-31T00:00:00'&amp;endDateTime='2019-08-31T23:59:59" rel="noopener ugc nofollow" target="_blank">https://api.powerbi.com/v1.0/myorg/admin/activityevents?startDateTime='2019-08-31T00:00:00'&amp;endDateTime='2019-08-31T23:59:59</a></span></pre><ul class=""><li id="34ee" class="jp jq hh ig b ih ii il im ip jr it js ix jt jb ju jv jw jx bi translated">已创建电源BI报告</li><li id="e407" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">已创建电源BI数据集</li><li id="20d8" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">请求的Power BI数据集刷新</li><li id="41e3" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">完整名单可以在<a class="ae kd" href="https://docs.microsoft.com/en-us/power-bi/admin/service-admin-auditing#operations-available-in-the-audit-and-activity-logs" rel="noopener ugc nofollow" target="_blank">这里找到</a></li></ul><h1 id="31e2" class="lg kn hh bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">通过管理门户和容量指标应用程序监控高级容量</h1><ul class=""><li id="607e" class="jp jq hh ig b ih md il me ip mf it mg ix mh jb ju jv jw jx bi translated">概述—应用程序版本、容量和工作空间数量</li><li id="865d" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">系统摘要—内存和CPU指标</li><li id="2436" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">数据集摘要—数据集数量、DQ/LC、刷新和查询指标</li><li id="9add" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">数据流摘要—数据流数量和数据集指标</li><li id="0bbb" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">分页报告摘要—刷新和查看指标</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mi"><img src="../Images/3a0a4bd42b2340ab67c762677bc81b19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/0*SF7DvGwvQzZRr_7O"/></div></figure><ul class=""><li id="058d" class="jp jq hh ig b ih ii il im ip jr it js ix jt jb ju jv jw jx bi translated">创建一个专业团队</li><li id="8e69" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">创建一个组织</li><li id="7669" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">创建运行手册</li><li id="f3b0" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">设计和开发运行操作手册</li><li id="e61f" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">提供上报流程</li><li id="ed1b" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">自动化支持相关问题</li></ul><p id="9699" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">贡献者</p><ul class=""><li id="b3c7" class="jp jq hh ig b ih ii il im ip jr it js ix jt jb ju jv jw jx bi translated">巴拉穆鲁甘·巴拉克雷什南</li><li id="4959" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">罗伯特·诺托里</li><li id="e56f" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">凯特·托马斯</li><li id="e1a2" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">亚伯拉罕·帕巴蒂</li><li id="357c" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">托尼奥·洛拉</li><li id="93df" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">马特·鲁玛</li><li id="f1b0" class="jp jq hh ig b ih jy il jz ip ka it kb ix kc jb ju jv jw jx bi translated">迪·库马尔</li></ul></div><div class="ab cl mj mk go ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ha hb hc hd he"><p id="518d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">【https://github.com】最初发表于<a class="ae kd" href="https://github.com/balakreshnan/Accenture/blob/master/cap/dataops.md" rel="noopener ugc nofollow" target="_blank"><em class="mq"/></a><em class="mq">。</em></p></div></div>    
</body>
</html>