<html>
<head>
<title>Implementation of Association Rule-Based Learning on Groceries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于关联规则的学习在杂货上的实现</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/implementation-of-association-rule-based-learning-on-groceries-bfd4ef87ef1a?source=collection_archive---------3-----------------------#2021-08-31">https://medium.com/analytics-vidhya/implementation-of-association-rule-based-learning-on-groceries-bfd4ef87ef1a?source=collection_archive---------3-----------------------#2021-08-31</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/c50a5d19608cfd9b75f204e64c034e4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8uwpICZe6ek5I3tPUOZ5_g.jpeg"/></div></div></figure><div class=""/><p id="8f48" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用<a class="ae jn" href="https://www.python.org/" rel="noopener ugc nofollow" target="_blank"> python </a>，<a class="ae jn" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> Numpy </a>，<a class="ae jn" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a>，<a class="ae jn" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> Matplotlib </a>，<a class="ae jn" href="https://seaborn.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Seaborn </a>，<a class="ae jn" href="https://pypi.org/project/apyori/" rel="noopener ugc nofollow" target="_blank"> apyori </a></p><p id="4cda" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">关联规则学习是一种基于规则的机器学习方法，用于发现大型数据库中变量之间的有趣关系。它旨在使用一些感兴趣的度量来识别在数据库中发现的强规则。</p><p id="c781" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">基于强规则的概念，Rakesh Agrawal、Tomasz Imieliński和Arun Swami引入了关联规则，用于发现超市销售点(POS)系统记录的大规模交易数据中产品之间的规律性。例如，在超市的销售数据中找到的规则右箭头右箭头表示，如果客户一起购买洋葱和土豆，他们很可能也会购买汉堡肉。此类信息可用作营销活动决策的基础，例如促销定价或产品放置。</p><p id="71d8" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">除了上面来自购物篮分析的例子之外，关联规则现在还被用于许多应用领域，包括Web使用挖掘、入侵检测、连续生产和生物信息学。与序列挖掘相比，关联规则学习通常不考虑事务内或跨事务的项目顺序。</p><h1 id="c88b" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">数据集:</h1><p id="fbce" class="pw-post-body-paragraph ip iq hs ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">这个数据集是基于杂货的。这个数据集中总共有9836行和32列。通过使用这个数据集，创建了这个机器学习项目。</p><p id="128a" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里我们使用google COLAB来运行这些代码并分析数据集，但是您也可以使用其他平台来运行代码。</p><p id="f26b" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在让我们开始这个项目包含什么。</p><h1 id="10ca" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">先验分析:</h1><p id="ef7d" class="pw-post-body-paragraph ip iq hs ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">Apriori是一种在关系数据库上进行频繁项集挖掘和关联规则学习的算法。它通过识别数据库中频繁出现的单个项目，并将其扩展到越来越大的项目集，只要这些项目集在数据库中出现得足够频繁。由Apriori确定的频繁项集可以用来确定关联规则，这些规则突出了数据库中的一般趋势:这在诸如市场购物篮分析的领域中有应用。</p><h1 id="b099" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">支持:</strong></h1><figure class="ks kt ku kv fd hj er es paragraph-image"><div class="er es kr"><img src="../Images/d18500c782c626699689177e13789a4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*V8h7hasN6Qja9sB4mnFkSA.png"/></div></figure><h1 id="52f5" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">信心:</strong></h1><figure class="ks kt ku kv fd hj er es paragraph-image"><div class="er es kw"><img src="../Images/640de20aa2e54d1cbe31b6d7a56bc521.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*UoXK7GjwVoeIgvlE3GMXaQ.png"/></div></figure><h1 id="7ed5" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">电梯:</strong></h1><figure class="ks kt ku kv fd hj er es paragraph-image"><div class="er es kx"><img src="../Images/c3fb463167405ec5a52b86245bed7963.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*4N9Y3XTsIaexxLyUzlvlOw.png"/></div></figure><h1 id="859d" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak"> Apriori算法:</strong></h1><ol class=""><li id="90c9" class="ky kz hs ir b is km iw kn ja la je lb ji lc jm ld le lf lg bi translated">设定最低支持和信心。</li><li id="79f6" class="ky kz hs ir b is lh iw li ja lj je lk ji ll jm ld le lf lg bi translated">收集支持度高于最小支持度的事务中的所有子集。</li><li id="6605" class="ky kz hs ir b is lh iw li ja lj je lk ji ll jm ld le lf lg bi translated">收集这些具有比最小置信度更高置信度的子集的所有规则。</li><li id="0901" class="ky kz hs ir b is lh iw li ja lj je lk ji ll jm ld le lf lg bi translated">按适合度递减对规则进行排序。</li></ol><h1 id="899b" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">安装先验库:</strong></h1><pre class="ks kt ku kv fd lm ln lo lp aw lq bi"><span id="5f5c" class="lr jp hs ln b fi ls lt l lu lv">!pip install apyori</span></pre><h1 id="be66" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">导入库:</h1><pre class="ks kt ku kv fd lm ln lo lp aw lq bi"><span id="4a97" class="lr jp hs ln b fi ls lt l lu lv">import numpy as np</span><span id="eb0e" class="lr jp hs ln b fi lw lt l lu lv">import matplotlib.pyplot as plt</span><span id="c43b" class="lr jp hs ln b fi lw lt l lu lv">import pandas as pd</span></pre><h1 id="f223" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">正在加载数据集:</h1><pre class="ks kt ku kv fd lm ln lo lp aw lq bi"><span id="53d7" class="lr jp hs ln b fi ls lt l lu lv">import io</span><span id="3e60" class="lr jp hs ln b fi lw lt l lu lv">df2=pd.read_csv("groceries - groceries.csv", header = None)</span></pre><h1 id="1a18" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">显示数据:</h1><pre class="ks kt ku kv fd lm ln lo lp aw lq bi"><span id="f6df" class="lr jp hs ln b fi ls lt l lu lv">df2.head</span></pre><figure class="ks kt ku kv fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es lx"><img src="../Images/ecc48a176e8bed62782a65f6dae5b96c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OwXsumKz01NjE7hUdYnrBw.png"/></div></div></figure><h1 id="d447" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">数据的形状:</h1><pre class="ks kt ku kv fd lm ln lo lp aw lq bi"><span id="d2f8" class="lr jp hs ln b fi ls lt l lu lv">df2.shape</span></pre><figure class="ks kt ku kv fd hj er es paragraph-image"><div class="er es ly"><img src="../Images/908e1cdb1e579b6e77cda66fb4e41bb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*_ibHmhprfS91pIyE5plaZA.png"/></div></figure><h1 id="9419" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">数据集上的先验训练:</h1><pre class="ks kt ku kv fd lm ln lo lp aw lq bi"><span id="703d" class="lr jp hs ln b fi ls lt l lu lv">from apyori import apriori</span><span id="17f2" class="lr jp hs ln b fi lw lt l lu lv">rules = apriori(transactions = transactions, min_support = 0.003, min_confidence = 0.2, min_lift = 3, min_length = 2, max_length = 2)</span></pre><h1 id="df38" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">可视化结果:</h1><pre class="ks kt ku kv fd lm ln lo lp aw lq bi"><span id="83b2" class="lr jp hs ln b fi ls lt l lu lv">def inspect(results):</span><span id="5a6f" class="lr jp hs ln b fi lw lt l lu lv">product1         = [tuple(result[2][0][0])[0] for result in results]</span><span id="772d" class="lr jp hs ln b fi lw lt l lu lv">product2         = [tuple(result[2][0][1])[0] for result in results]</span><span id="041b" class="lr jp hs ln b fi lw lt l lu lv">supports    = [result[1] for result in results]</span><span id="b630" class="lr jp hs ln b fi lw lt l lu lv">confidences = [result[2][0][2] for result in results]</span><span id="7234" class="lr jp hs ln b fi lw lt l lu lv">lifts       = [result[2][0][3] for result in results]</span><span id="9907" class="lr jp hs ln b fi lw lt l lu lv">return list(zip(product1, product2, supports, confidences, lifts))</span><span id="337d" class="lr jp hs ln b fi lw lt l lu lv">DataFrame_intelligence = pd.DataFrame(inspect(results), columns = ['product1', 'product2', 'Support', 'Confidence', 'Lift'])</span></pre><figure class="ks kt ku kv fd hj er es paragraph-image"><div class="er es lz"><img src="../Images/e4fe43f4880a694ee3d9ea6270fd4a9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*jFU5G18yw81u7z7oLGApmw.png"/></div></figure><h1 id="d7e9" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">ECLAT分析:</h1><p id="d457" class="pw-post-body-paragraph ip iq hs ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">ECLAT算法代表等价类聚类和自底向上的格遍历。它是流行的关联规则挖掘方法之一。它是Apriori算法的一个更有效和可扩展的版本。Apriori算法以模拟图的宽度优先搜索的水平方式工作，而ECLAT算法以垂直方式工作，就像图的深度优先搜索一样。ECLAT算法的这种垂直方法使其成为比Apriori算法更快的算法。</p><h1 id="2bf2" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">ECLAT算法</h1><ol class=""><li id="9cb4" class="ky kz hs ir b is km iw kn ja la je lb ji lc jm ld le lf lg bi translated">设置最小支撑。</li><li id="3262" class="ky kz hs ir b is lh iw li ja lj je lk ji ll jm ld le lf lg bi translated">接受支持度高于最小支持度的事务中的所有子集。</li><li id="ac0b" class="ky kz hs ir b is lh iw li ja lj je lk ji ll jm ld le lf lg bi translated">按支持度递减对这些子集进行排序。</li></ol><pre class="ks kt ku kv fd lm ln lo lp aw lq bi"><span id="3590" class="lr jp hs ln b fi ls lt l lu lv">def inspect(results):</span><span id="7fe3" class="lr jp hs ln b fi lw lt l lu lv">product1         = [tuple(result[2][0][0])[0] for result in results]</span><span id="4847" class="lr jp hs ln b fi lw lt l lu lv">product2         = [tuple(result[2][0][1])[0] for result in results]</span><span id="34ba" class="lr jp hs ln b fi lw lt l lu lv">supports    = [result[1] for result in results]</span><span id="36b3" class="lr jp hs ln b fi lw lt l lu lv">confidences = [result[2][0][2] for result in results]</span><span id="cc5d" class="lr jp hs ln b fi lw lt l lu lv">lifts       = [result[2][0][3] for result in results]</span><span id="a3c5" class="lr jp hs ln b fi lw lt l lu lv">return list(zip(product1, product2, supports))</span><span id="5cbe" class="lr jp hs ln b fi lw lt l lu lv">DataFrame_intelligence1 = pd.DataFrame(inspect(results), columns = ['product1', 'product2', 'Support'])</span></pre><figure class="ks kt ku kv fd hj er es paragraph-image"><div class="er es ma"><img src="../Images/b757efbac3a6e3b093906b065834ba3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*5r4zn7N6tOsAezfE-ezNmQ.png"/></div></figure><p id="1406" class="pw-post-body-paragraph ip iq hs ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">从上面的结果可以看出，牛肉和根菜肉是支持度最高的推荐对(. 017)。支持值越高，产品之间的相关性越高。</p><h1 id="f28c" class="jo jp hs bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">讨论:</strong></h1><ol class=""><li id="d042" class="ky kz hs ir b is km iw kn ja la je lb ji lc jm ld le lf lg bi translated">先验基础分析对应于支持度、置信度和提升值。</li><li id="c52b" class="ky kz hs ir b is lh iw li ja lj je lk ji ll jm ld le lf lg bi translated">在基于先验的分析中，提升值越高，产品之间的相关性越高。</li><li id="4536" class="ky kz hs ir b is lh iw li ja lj je lk ji ll jm ld le lf lg bi translated">ECLAT基础分析只对应于支持值。</li><li id="6abc" class="ky kz hs ir b is lh iw li ja lj je lk ji ll jm ld le lf lg bi translated">在基于ECLAT的分析中，支持值越高，产品之间的相关性越高。</li><li id="e98e" class="ky kz hs ir b is lh iw li ja lj je lk ji ll jm ld le lf lg bi translated">在基于ECLAT的分析中，我们创建数据子集，并通过关联算法对其进行预测。</li><li id="eb33" class="ky kz hs ir b is lh iw li ja lj je lk ji ll jm ld le lf lg bi translated">基于关联规则学习的主要目标是创建一个好的推荐系统。</li></ol><figure class="ks kt ku kv fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mb"><img src="../Images/8f5e0d98b125552271be60624555ed3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sYYp4pBzjha1FctdD2O1SA.png"/></div></div></figure></div></div>    
</body>
</html>