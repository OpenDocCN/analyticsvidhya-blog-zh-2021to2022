<html>
<head>
<title>Time-Series Forecasting: Predicting Apple Stock Price Using An LSTM Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时间序列预测:用LSTM模型预测苹果股票价格</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/time-series-forecasting-predicting-apple-stock-price-using-an-lstm-model-f1bb73bd8a80?source=collection_archive---------7-----------------------#2021-02-09">https://medium.com/analytics-vidhya/time-series-forecasting-predicting-apple-stock-price-using-an-lstm-model-f1bb73bd8a80?source=collection_archive---------7-----------------------#2021-02-09</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="7500" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">时间序列和预测模型</h1><p id="f756" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">传统上，大多数机器学习(ML)模型使用一些观察值(样本/实例)作为输入特征，但数据中没有<strong class="je hi">时间</strong> <strong class="je hi">维度</strong>。</p><p id="1bf3" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">时间序列预测</strong>模型是能够根据<strong class="je hi">先前</strong> <strong class="je hi">观测</strong> <strong class="je hi">值</strong>预测 <strong class="je hi">未来值</strong>的模型。时间序列预测广泛用于<strong class="je hi">非平稳数据</strong>。<strong class="je hi">非平稳数据</strong>被称为统计属性(如平均值和标准偏差)不随时间保持不变，而是随时间变化的数据。</p><p id="1873" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">这些非平稳输入数据(用作这些模型的输入)通常被称为<strong class="je hi">时间序列。</strong>时间序列的一些例子包括随时间变化的温度值、随时间变化的股票价格、随时间变化的房屋价格等。因此，输入是一个<strong class="je hi">信号</strong>(时间序列),它是由在时间中连续获得的观察值<strong class="je hi">定义的。</strong></p><figure class="kg kh ki kj fd kk er es paragraph-image"><div class="er es kf"><img src="../Images/6c0e4c44e39cc6de6000dc2e17397dc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/0*9vW0lDYVNJxneWiI.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">时间序列示例</figcaption></figure><h1 id="4559" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">LSTM模式</h1><p id="bc48" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated"><strong class="je hi">长短期记忆</strong> ( <strong class="je hi"> LSTM </strong>)是一种用于深度学习领域的人工递归神经网络(RNN)架构。与标准的前馈神经网络不同，LSTM有反馈连接。它不仅可以处理单个数据点(例如图像)，还可以处理整个数据序列(例如语音或视频输入)。</p><p id="cbee" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi"> LSTM型号</strong>能够储存一段时间的信息。</p><h1 id="059a" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">开始编码吧！</h1><p id="4b5f" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我们将构建一个<strong class="je hi">多层LSTM递归神经网络</strong>来<strong class="je hi">预测</strong>一系列值的最后一个值<strong class="je hi">，即本例中的AAPL股票价格。</strong></p><p id="ae5d" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><em class="kr">所需模块:Keras、Tensorflow、Pandas、Scikit-Learn &amp; Numpy </em></p><p id="c138" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">让<strong class="je hi">加载</strong>数据和<strong class="je hi">检查</strong>它们:</p><figure class="kg kh ki kj fd kk"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="3924" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">我们将收集AAPL最近20年的EOD数据，越多越好。</p><p id="d364" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">我使用的是AAPL数据集，它已经被分成了训练集和测试集，但是你可以用一个简单的命令来完成这个划分！</p><pre class="kg kh ki kj fd ku kv kw kx aw ky bi"><span id="2296" class="kz if hh kv b fi la lb l lc ld">training_set = df.iloc[:4780, 1:2].values<br/>test_set = df.iloc[4780:, 1:2].values</span></pre><h1 id="3c40" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">让我们将数据集可视化</h1><figure class="kg kh ki kj fd kk er es paragraph-image"><div class="er es le"><img src="../Images/839e9f399aff5667d6e2c3469506af09.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*ifbW5igeIg_aUcBIGG3LPA.png"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">数据集的前几行</figcaption></figure><h1 id="05fa" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">要预测的目标值将是“<strong class="ak">收盘</strong>股价值。因此有了下面的陈述。</h1><pre class="kg kh ki kj fd ku kv kw kx aw ky bi"><span id="507c" class="kz if hh kv b fi la lb l lc ld">training_set = dataset_train.iloc[:, 1:2].values</span></pre><p id="a8ff" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在<strong class="je hi">模型</strong> <strong class="je hi">拟合</strong>之前，<strong class="je hi">归一化</strong>数据是个好主意。这将提高性能。</p><figure class="kg kh ki kj fd kk"><div class="bz dy l di"><div class="ks kt l"/></div></figure><h1 id="96e5" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">构建输入变量</h1><p id="c1b0" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">作为本文的一个例子，我使用了上面描述的模型来预测AAPLstock下一个交易日的收盘价，给出了过去六十个交易日的数据</p><figure class="kg kh ki kj fd kk"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="932c" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">我们现在已经将<strong class="je hi">数据重新调整为</strong>以下格式(#值、#时间步长、#1维输出)。</p><p id="b124" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">现在，是时候建立模型了。</strong>我们将建立有100个神经元和5个<strong class="je hi">隐层</strong>的<strong class="je hi"> LSTM </strong>。最后，我们将在输出层分配1个神经元用于预测标准化的股票价格。我们将使用MSE损失函数和Adam随机梯度下降优化器。</p><figure class="kg kh ki kj fd kk"><div class="bz dy l di"><div class="ks kt l"/></div></figure><figure class="kg kh ki kj fd kk er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lf"><img src="../Images/97853e97e26f059eda065ccd09da5403.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jFx6qex-3Vcyz-569SKWGQ.png"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">它会像这样继续下去</figcaption></figure><h1 id="eb8e" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">准备好测试数据并进行预测</h1><figure class="kg kh ki kj fd kk"><div class="bz dy l di"><div class="ks kt l"/></div></figure><h1 id="bd02" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">可视化结果</h1><figure class="kg kh ki kj fd kk"><div class="bz dy l di"><div class="ks kt l"/></div></figure><figure class="kg kh ki kj fd kk er es paragraph-image"><div class="er es lk"><img src="../Images/2e84ebba411c25d839d134c4450fe4a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*h6bZGkzVQECpO63T7NNH5A.png"/></div></figure><p id="c178" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">我们可以清楚地看到，我们的模型表现得非常好。它能够准确地跟踪大多数不可接受的上涨/下跌，但是，对于最近的日期戳，我们可以看到，与股票价格的实际值相比，模型预期(预测)的值较低。</p><p id="2cc1" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">免责声明</strong>已经有人尝试使用时间序列分析算法来预测股票价格，尽管它们仍然不能用于在真实市场中下注。这只是一篇教程文章，并不打算以任何方式“指导”人们购买股票。</p><p id="a2e5" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">下次见！</p></div></div>    
</body>
</html>