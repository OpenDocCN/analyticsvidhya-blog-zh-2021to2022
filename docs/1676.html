<html>
<head>
<title>How to implement Linear Regression using sklearn library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用sklearn库实现线性回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-implement-linear-regression-using-sklearn-library-a1afb74fa664?source=collection_archive---------19-----------------------#2021-03-12">https://medium.com/analytics-vidhya/how-to-implement-linear-regression-using-sklearn-library-a1afb74fa664?source=collection_archive---------19-----------------------#2021-03-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="f00d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Python被认为是机器学习和基于人工智能的项目的最佳编程语言，因为它有各种各样的库和框架。Scikit-learn 可能是Python中最有用的机器学习库。sklearn库有很多机器学习和统计建模的有效工具，包括分类、回归、聚类等。</p><p id="2666" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我将展示如何使用sklearn库实现线性回归算法。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/05d924dbd592c79777acc8aa0b1ab85e.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*T1NcXD6P0JUT-KMM8GR06A.png"/></div></figure><p id="11ba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">对于非库(从头开始)实现的算法，可以查看</strong> <a class="ae jk" href="https://abiyevanar.medium.com/machine-learning-linear-regression-project-from-scratch-without-library-87294048020" rel="noopener"> <strong class="ig hi">我之前的论文</strong> </a> <strong class="ig hi">。</strong></p></div><div class="ab cl jl jm go jn" role="separator"><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq jr"/><span class="jo bw bk jp jq"/></div><div class="ha hb hc hd he"><p id="221f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">进入编码部分，就像python中库的任何其他用法一样，它极大地简化了代码。这就是为什么，这一节在代码本身方面非常简单，并有足够的解释。</p><ol class=""><li id="0f39" class="js jt hh ig b ih ii il im ip ju it jv ix jw jb jx jy jz ka bi translated"><strong class="ig hi">导入必要的库:</strong></li></ol><pre class="jd je jf jg fd kb kc kd ke aw kf bi"><span id="c9b3" class="kg kh hh kc b fi ki kj l kk kl">from sklearn.linear_model import LinearRegression<br/>import pandas as pd<br/>import numpy as np</span></pre><p id="4544" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 2。加载和操作数据集，以便能够与sklearn函数一起使用:</strong></p><pre class="jd je jf jg fd kb kc kd ke aw kf bi"><span id="2a04" class="kg kh hh kc b fi ki kj l kk kl">train_data = pd.read_csv('train.csv')          #pandas dataframe</span><span id="4d14" class="kg kh hh kc b fi km kj l kk kl">X = train_data['x']                            #pandas series <br/>Y = train_data['y']                            </span><span id="1226" class="kg kh hh kc b fi km kj l kk kl">X = np.array(X)                                #numpy array<br/>Y = np.array(Y)                                </span><span id="d780" class="kg kh hh kc b fi km kj l kk kl">X = X.reshape(-1, 1)                           #reshaped numpy array<br/>Y = Y.reshape(-1, 1)</span></pre><p id="db03" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">read_csv获取csv文件并将其转换为pandas数据帧，该数据帧保存在train_data变量中。</p><p id="a02a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在数据集被写成pandas dataframe之后，它可以被分成X(自变量)和Y(因变量)。X和Y是pandas系列，当sklearn使用numpy数组时，使用np.array()操作符将X和Y变量转换为numpy数组。</p><p id="e489" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一般来说，将数字放入矩阵中并进行乘法等运算效率更高。这就是为什么，在这里我们重塑numpy数组以形成一个(n×1)矩阵。</p><p id="6ec8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">整形前的numpy数组:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kn"><img src="../Images/e8b4e0accf68edab214c36c7a8c0795f.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*lU7vbBKYwF_VI3YhjOepkw.png"/></div></figure><p id="5bf1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">整形后的numpy数组:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ko"><img src="../Images/a11f592f5a1bd2906436d2d2ef58c14b.png" data-original-src="https://miro.medium.com/v2/resize:fit:92/format:webp/1*hhTn9O4PHMlS_K53FGiK9A.png"/></div></figure><p id="df5b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 3。建立模型:</strong></p><pre class="jd je jf jg fd kb kc kd ke aw kf bi"><span id="aa41" class="kg kh hh kc b fi ki kj l kk kl">model = LinearRegression().fit(X, Y)<br/>print(model.coef_)<br/>print(model.intercept_)</span></pre><p id="3b7a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">拟合函数将自变量(X)和因变量(X)作为输入，并返回模型。之后就可以打印出拦截点和系数了。</p><p id="d482" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 4。测试模型:</strong></p><pre class="jd je jf jg fd kb kc kd ke aw kf bi"><span id="681e" class="kg kh hh kc b fi ki kj l kk kl">test_data = pd.read_csv('test.csv')<br/>X_test = np.array(test_data['x']).reshape(-1, 1)<br/>Y_test = np.array(test_data['y']).reshape(-1, 1)</span><span id="d134" class="kg kh hh kc b fi km kj l kk kl">print(model.score(X_test, Y_test))</span></pre><p id="3a7e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在机器学习中，每一个模型都应该在建立之后进行测试。为此，使用了另一个数据集—测试集。因为训练集已经为模型所熟悉，因为它被用于构建过程。这就是为什么使用训练集来测试模型不会显示模型的真实性能。</p><p id="fc82" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里，我们再次读取csv文件，并将其写入test_data变量。在与训练集中相同的数据集操作之后，X_test和Y_test变量包含测试集的独立值和从属值。</p><p id="68e8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">score函数将X_test和Y_test作为输入，并返回一个介于0和1之间的数字，分别表示完全失败和完全成功。</p><h1 id="6373" class="kp kh hh bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">谢谢你</h1></div></div>    
</body>
</html>