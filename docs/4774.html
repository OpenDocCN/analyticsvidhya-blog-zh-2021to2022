<html>
<head>
<title>Random Forest ML Algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">随机森林ML算法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/random-forest-ml-algorithm-fbb5188222cf?source=collection_archive---------1-----------------------#2022-02-10">https://medium.com/analytics-vidhya/random-forest-ml-algorithm-fbb5188222cf?source=collection_archive---------1-----------------------#2022-02-10</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="3da4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有许多机器学习算法用于监督机器学习。一种流行的机器学习算法是随机森林算法。</p><p id="0f96" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">随机森林(RF)是一种集成机器学习算法。集成机器学习算法利用了使用多种算法预测的优势。整体技术包括增压和装袋技术。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/169eecc667929f72ff43ccead8c81d20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/0*bqzqpiYewq3KV-al.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">随机森林:来源-<a class="ae jo" href="https://community.tibco.com/wiki/random-forest-template-tibco-spotfirer-wiki-page" rel="noopener ugc nofollow" target="_blank"><br/>https://community . tibco . com/wiki/random-Forest-template-tibco-spot firer-wiki-page</a>(Venkata Jagannath-Wikipedia)</figcaption></figure><blockquote class="jp jq jr"><p id="afb7" class="ie if js ig b ih ii ij ik il im in io jt iq ir is ju iu iv iw jv iy iz ja jb ha bi translated"><strong class="ig hi">随机森林是一种bagging集成机器学习算法</strong>。</p></blockquote><p id="811d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在装袋中，可以使用不同的机器学习模型。然而，在随机森林中，只存在多个决策树。<strong class="ig hi"> RF可用于回归和分类任务。</strong></p><h2 id="6281" class="jw jx hh bd jy jz ka kb kc kd ke kf kg ip kh ki kj it kk kl km ix kn ko kp kq bi translated">随机森林分类器</h2><p id="a134" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">决策树的主要缺点是容易过拟合，导致低偏差和高方差。对于RF，我们的目标是避免这种情况，并实现低偏置和低方差。<br/>在RF分类器中，<strong class="ig hi">对数据进行行和列采样</strong>，并将其提供给每个决策树。这里需要注意的一点是，每个决策树收到的数据可能会有重叠。这也称为自举聚合，用于减少噪声数据集的方差。最后，在采样的训练数据上训练每个决策树。在测试阶段，收集每个决策树的输出，并应用多数表决来实现输出类。</p><h2 id="c2e2" class="jw jx hh bd jy jz ka kb kc kd ke kf kg ip kh ki kj it kk kl km ix kn ko kp kq bi translated">随机森林回归量</h2><p id="4e5a" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">如上所述，随机森林也能够回归。在这种情况下，也使用了与随机森林分类器类似的方法。区别在于输出阶段。在随机森林回归的情况下，取所有决策树输出的平均值。</p><h2 id="7149" class="jw jx hh bd jy jz ka kb kc kd ke kf kg ip kh ki kj it kk kl km ix kn ko kp kq bi translated">随机森林编码样本</h2><p id="43eb" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">让我们来看一个使用随机森林解决虹膜分类问题的示例代码。关于在<a class="ae jo" href="https://scikit-learn.org/stable/auto_examples/datasets/plot_iris_dataset.html" rel="noopener ugc nofollow" target="_blank"> IRIS </a>数据集上加载和执行探索性数据分析(EDA)，请参考我之前的博客<a class="ae jo" rel="noopener" href="/p/589a002989f8">这里的</a>。</p><p id="789d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们获取数据:</p><pre class="jd je jf jg fd kw kx ky kz aw la bi"><span id="925d" class="jw jx hh kx b fi lb lc l ld le">from sklearn.datasets import load_iris<br/>import pandas as pddata = load_iris() <br/>X = pd.DataFrame(data.data, columns=data.feature_names)<br/>y = pd.DataFrame(data.target, columns=["target"])<br/>df = pd.concat([X, y], axis=1)<br/>print(df.head())</span></pre><p id="07e4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下载的数据集如下所示:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lf"><img src="../Images/12546b59add354bbc415a19c7d07ea75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ygX6a50mDIFUzm7eAVxlww.png"/></div></div></figure><pre class="jd je jf jg fd kw kx ky kz aw la bi"><span id="84f8" class="jw jx hh kx b fi lb lc l ld le"># Perform Train-Test Split<br/>from sklearn.model_selection import train_test_split<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=42)</span></pre><p id="a92c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们从sklearn创建一个随机森林分类器对象。更多参数信息可在<a class="ae jo" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><pre class="jd je jf jg fd kw kx ky kz aw la bi"><span id="c937" class="jw jx hh kx b fi lb lc l ld le">from sklearn.ensemble import RandomForestClassifier<br/>model = RandomForestClassifier(max_depth=5, n_estimators=10)</span></pre><p id="3602" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">理解随机森林算法的内部参数非常重要，因为它们在避免过拟合方面起着巨大的作用。<strong class="ig hi">在这种情况下，我们没有优化算法，因为这是出于演示目的</strong>。现在，让我们在这个随机森林模型上拟合数据，并在测试数据上测试它。</p><pre class="jd je jf jg fd kw kx ky kz aw la bi"><span id="30ee" class="jw jx hh kx b fi lb lc l ld le">from sklearn.metrics import classification_report</span><span id="5e63" class="jw jx hh kx b fi lk lc l ld le">model.fit(X_train, y_train)<br/>y_pred = model.predict(X_test)<br/>print(classification_report(y_test, y_pred))</span></pre><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ll"><img src="../Images/e9a1a33292a032320f5bb16e91503fce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*ZdjxtYbX6yYenoo3-R0Cmg.png"/></div></figure><p id="59a4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从分类矩阵中可以明显看出，随机森林分类器在分类鸢尾属物种方面做得很好。</p><blockquote class="jp jq jr"><p id="7646" class="ie if js ig b ih ii ij ik il im in io jt iq ir is ju iu iv iw jv iy iz ja jb ha bi translated"><strong class="ig hi">补充信息:随机森林算法中不需要进行归一化。</strong></p></blockquote></div></div>    
</body>
</html>