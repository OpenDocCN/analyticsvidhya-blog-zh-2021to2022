<html>
<head>
<title>Predicting Volcanic Eruptions from Seismic Behavior</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">根据地震行为预测火山爆发</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predicting-volcanic-eruptions-from-seismic-behavior-3b8e6bbd7ffc?source=collection_archive---------9-----------------------#2021-05-12">https://medium.com/analytics-vidhya/predicting-volcanic-eruptions-from-seismic-behavior-3b8e6bbd7ffc?source=collection_archive---------9-----------------------#2021-05-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="db39" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">开发基于网络的机器学习应用程序，根据地震信号预测火山爆发</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/a8fb6d0294f71e93e81356076b1c298c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CV1INkwm_A6O0hdVUE5wMA.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">危地马拉安提瓜阿凯特南戈火山:<a class="ae js" href="https://unsplash.com/photos/BvI2MKKCTZ4" rel="noopener ugc nofollow" target="_blank">亚伦·托马斯在Unsplash上拍摄的照片</a></figcaption></figure><p id="60f6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我们可以像预测天气一样预测火山爆发会怎么样？一个可靠的预测将有助于充分的应急反应计划，潜在地拯救<a class="ae js" href="http://volcano.oregonstate.edu/how-do-volcanoes-affect-people" rel="noopener ugc nofollow" target="_blank">成千上万的生命</a>。</p><p id="5cd5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">几个组织，包括美国宇航局，美国地质勘探局，INGV，和其他人，正在倡导这项事业。这些组织的主要目标是更好地理解地球的结构和地质行为，同时最大限度地减少随之而来的<a class="ae js" href="https://www.who.int/health-topics/volcanic-eruptions#tab=tab_1" rel="noopener ugc nofollow" target="_blank">威胁。</a></p><p id="d265" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">根据研究，地震指标是火山即将爆发的绝佳预测指标。然而，地震信号的问题在于它们很难解释。在(利用这些信号的)系统中，只能提前几分钟预测火山爆发，但长期预测是困难的。</p><p id="56da" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇博客中，我们将经历创建一个web应用程序的端到端过程(从问题理解到部署)，该应用程序可以根据安装在火山附近的传感器收集的地震信号来预测火山爆发的大致时间。</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="e64f" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">(尤指为开车者设计的) 公路交通图</h1><p id="8f23" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">这一部分包括应用程序的议程，旨在提供本案例研究主要阶段的高级概述。</p><p id="f223" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">本博客将涵盖的主题如下。</p><ul class=""><li id="fee2" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><strong class="ig hi">先决条件</strong></li><li id="95e6" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><strong class="ig hi">数据收集</strong></li><li id="7d9f" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><strong class="ig hi">问题理解</strong></li><li id="7145" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><strong class="ig hi">探索性数据分析</strong></li><li id="2fa5" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><strong class="ig hi">以前的作品</strong></li><li id="c0de" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><strong class="ig hi">开发基准模型</strong></li><li id="94a6" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><strong class="ig hi">开发定制堆叠集合模型</strong></li><li id="2d1a" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><strong class="ig hi">使用Streamlit开发网络应用</strong></li><li id="e2f6" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><strong class="ig hi">Heroku平台上的网络应用部署</strong></li></ul><p id="8c80" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们先来看一些想法、资源和平台，它们是顺利阅读这篇博客所需要的。</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="c19e" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">1.先决条件</h1><p id="4bcf" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">这里列出了构建类似的数据相关项目所需的先决条件(或者说是有帮助的)。</p><ul class=""><li id="8f5f" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><strong class="ig hi"> Kaggle账号</strong>——没有账号？在kaggle.com<a class="ae js" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank">报名</a></li><li id="dc42" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><strong class="ig hi">使用Git</strong>——HubSpot的<a class="ae js" href="https://product.hubspot.com/blog/git-and-github-tutorial-for-beginners" rel="noopener ugc nofollow" target="_blank">这个</a>不错的博客对如何使用Git和GitHub做了精彩的介绍。</li><li id="e26a" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><strong class="ig hi">虚拟环境、python、pip和机器学习基础</strong></li></ul><blockquote class="lr ls lt"><p id="6c34" class="ie if lu ig b ih ii ij ik il im in io lv iq ir is lw iu iv iw lx iy iz ja jb ha bi translated"><strong class="ig hi">注意:</strong>本博客主要关注开发定制的ML模型及其作为基于web的应用程序的开发，而不是机器学习本身。</p></blockquote><p id="8217" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您的工具箱中没有先决条件，请不要担心，请浏览博客。一个人可以随时回来学习需要什么！</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="3174" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">2.数据收集</h1><p id="62d3" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">现在，我们已经完成了我们的议程，并提到了一些先决条件，我们现在终于可以拿到数据了。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ly"><img src="../Images/0b28aa733285e14c0502a426b1c5a405.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/format:webp/1*Y5We118f5tsxeE594U8JrA.png"/></div></figure><p id="27a7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">意大利国家地球物理和火山学研究所(INGV)通过Kaggle竞赛发布了这些数据。可以通过下面提供的链接访问这些数据。</p><p id="165a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="lu">来源</em> : </strong> <a class="ae js" href="https://www.kaggle.com/c/predict-volcanic-eruptions-ingv-oe/data" rel="noopener ugc nofollow" target="_blank">卡格尔INGV火山喷发预测数据</a></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lz"><img src="../Images/422085d68629af481ec17a68d1ad6fa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ig6wBEEdi0RmZ848n0wgXw.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">图2:卡格尔INGV竞赛数据浏览器快照</figcaption></figure><p id="47d1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下载将以zip文件的形式进行，解压缩后会生成一个目录，如下所示:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ma"><img src="../Images/22c282fc0b2881d06bef30b4f3f74e8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*2IAJOiA2ecCSFQZvOb8qeQ.jpeg"/></div></figure></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="eacf" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">3.理解问题</h1><h2 id="b3fa" class="mb kb hh bd kc mc md me kg mf mg mh kk ip mi mj ko it mk ml ks ix mm mn kw mo bi translated"><strong class="ak"> 3.1概述</strong></h2><p id="8da9" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">我们正在处理的这个案子是基于Kaggle主办的一个竞赛。提供的数据包括放置在活火山周围不同位置的地震仪的测量结果。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mp"><img src="../Images/625e1564e434a0c52146dae530abb4a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kuwhm05fbwxsGVro7yqp0A.jpeg"/></div></div></figure><p id="011a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这些测量值中的每一个都是十个时间序列的集合，这些时间序列是从十个地震仪在十分钟的持续时间内以规则的间隔捕获的，并且它们中的每一个都与一个称为喷发时间的值相关联，该值表示测量结束和喷发开始之间经过的时间。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mq"><img src="../Images/b72d195cd576cd308f25a8dc46c0cb42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jkFD5dmgGWBBv-lbsUt8rA.jpeg"/></div></div></figure><p id="40a1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但问题是，我们对数据的其他方面了解不多，比如传感器的信号意味着什么，或者它们相对于其他信号的位置。在这项研究中，我们将利用机器学习方法从原始数据中提取有用的特征，并尝试对数据和相应的喷发时间值之间的关系进行建模。</p><h2 id="4d3e" class="mb kb hh bd kc mc md me kg mf mg mh kk ip mi mj ko it mk ml ks ix mm mn kw mo bi translated">3.2主要制约因素</h2><p id="72a6" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">然而，<strong class="ig hi">关键约束</strong>是模型必须具有<strong class="ig hi">低延迟</strong>标准(几秒甚至几分钟是可以接受的)，具有极强的描述性和<strong class="ig hi">可靠性</strong>，因此像这样的条件不能被忽略，并且不能发出错误警报。</p><h2 id="f4e9" class="mb kb hh bd kc mc md me kg mf mg mh kk ip mi mj ko it mk ml ks ix mm mn kw mo bi translated">3.3机器学习的使用</h2><p id="2276" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">机器学习的目的是理解数据的本质，并通过数学建模捕捉其本质，这反过来可以被用户用来理解或预测未来类似类型的数据。</p><p id="cef5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本案例研究中，我们将尝试使用监督机器学习算法，根据多维地震预测值对喷发时间值进行建模。由于这一变量在本质上是连续的，因此在我们的案例中，建模的类型将是回归，而在本案例研究的不同阶段，用于测量模型性能的规定关键性能指标是平均绝对误差。</p><p id="bbd5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但机器学习不仅仅是建模本身，而是从收集、理解、清理和转换数据到部署开发的模型的整个过程。</p><p id="903c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们一步一步来…</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="e93d" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">4.探索性数据分析</h1><p id="2913" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">我们已经将数据下载到我们的设备上，现在可以开始工作了。让我们看看这里有什么。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ma"><img src="../Images/22c282fc0b2881d06bef30b4f3f74e8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*2IAJOiA2ecCSFQZvOb8qeQ.jpeg"/></div></figure><ul class=""><li id="331e" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">我们有两个csv文件(<em class="lu"> train.csv </em>和<em class="lu"> sample submission.csv </em>)和两个目录(<em class="lu"> train </em>、<em class="lu"> test </em>)</li><li id="7df7" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><em class="lu"> train </em>目录包含4431个csv文件，作为我们的训练数据。</li><li id="8d24" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><em class="lu"> train.csv </em>中有两列:<em class="lu">段id </em>和<em class="lu">喷发时间</em>。<em class="lu">喷发时间</em>变量的每个值与某个<em class="lu">段id </em>相关联，并且该<em class="lu">段id </em>指示特定<em class="lu">喷发时间</em>与哪个训练数据相关联。</li><li id="0386" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">同样的，<em class="lu">测试</em>目录包含4520测试数据，<em class="lu"> sample submission.csv文件</em>包含4520 <em class="lu">段id</em>(测试数据文件名)，但是<em class="lu">爆发时间</em>值这次未知。</li></ul><p id="24fa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们看看<em class="lu">训练</em>或<em class="lu">测试</em>文件夹中的那些特定csv文件包含什么。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mr"><img src="../Images/9be6600d4c931c660e058f90bac9afc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zROG2aCnj4c-HWVyXXJZHg.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">图5:来自训练和测试数据的两个随机csv文件的前几个样本</figcaption></figure><p id="a0fc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，对于每个段id(一个数据点)，我们有来自10个传感器的总共60001个读数。以10分钟(600秒)的规则间隔记录每个片段的多变量时间序列数据。所以我们可以假设读数是每百分之一秒或每十毫秒或每百分之一秒读取一次。我们还有一个变量叫做喷发时间，它与每个分段id相关联。该变量表示每10分钟时间段结束和爆发开始之间经过的时间。</p><p id="5d79" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们来看看可变喷发时间的分布。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ms"><img src="../Images/a35a2825de45e0875c63db4ab71890da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*Ky8kUu8ODuicCNlgCTi6Eg.jpeg"/></div></figure><pre class="jd je jf jg fd mt mu mv mw aw mx bi"><span id="f0ab" class="mb kb hh mu b fi my mz l na nb">The minimum value of time_to_eruption : 6250<br/>which is basically 0 hours 1 minutes<br/><br/>The maximum value of time_to_eruption : 49046087<br/>which is basically 136 hours 14 minutes</span><span id="d3e4" class="mb kb hh mu b fi nc mz l na nb">The average bin width of the histogram is 2043326.5416666667<br/>Which in hour-minute format stands 5 hrs 40 mins</span></pre><ul class=""><li id="1e97" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">上述喷发时间密度分布图显示，该分布类似于给定变量最小值(0.0006e7)和最大值(4.9e7)之间的均匀分布。</li><li id="9b60" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">我们在直方图绘制方法中使用了24个箱。由于喷发的时间范围从1分钟到136小时(5天以上)，我们在绘图函数中使用了24个区间，区间宽度可视为6小时(准确地说是5小时40分钟)。换句话说，第一个框包含的数据的爆发时间变量在(0-6小时)之间变化，第二个框在(6-12小时)之间变化，依此类推。</li><li id="64a5" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">最后两个箱中的条目/数据点的数量(或密度)低于其他箱中的数量。因此，在过去12小时内爆发的部分较少(数量相对较少)。</li></ul><p id="aa25" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">多变量时间序列的可视化</strong></p><p id="bc9e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们从绘制喷发前时间变量的最小值部分的数据开始。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nd"><img src="../Images/09995165667ea327bf7b7cf0c005198d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mVdnkczTILwRb4nfW45Isg.jpeg"/></div></div></figure><p id="1397" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上图是具有最小喷发时间(6250或约1分钟)值的区段的传感器值的可视化</p><ul class=""><li id="7e8c" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">在所有传感器中，在第4分钟[~25000](记录的总10分钟跨度)时，大多数传感器中存在一些突然的尖峰。</li><li id="0a57" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">传感器1和传感器7在第8分钟也出现峰值[~50000]</li><li id="9da5" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">传感器4捕捉到了一些严重的震动。</li><li id="4d90" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">传感器2、3和8完全没有捕捉到任何东西。这种缺席可能只是巧合，是技术错误的结果，也可能是隐藏模式的结果。</li></ul><p id="1ba6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">相同段的传感器信号的pdf如下所示</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ne"><img src="../Images/d8391ca03970e30fa783da9a1e6913ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vdMKZAEZmTM0KhHPl0j2kQ.jpeg"/></div></div></figure><ul class=""><li id="0c4c" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">上图描述了喷发时间最低的一段中每个传感器的密度分布</li><li id="c37c" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">传感器读数(从视觉上看)非常类似于正态分布。</li><li id="06bc" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">我们还可以检查其他片段的传感器密度分布，并查看它们是否也被表征为正常。</li></ul><p id="0ba8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们已经表明，有些测试段完全没有传感器列。我们现在将尝试找出哪些传感器完全跳过了某个特定部分。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nf"><img src="../Images/6e214d2a029325300e9aa1adf94f31a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jHQZbVQgnYINHjHa0u295Q.jpeg"/></div></div></figure><p id="a203" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从上面的图中我们可以看出:</p><ul class=""><li id="e359" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">传感器2跳过了18.84%的数据段(835)，是与其他传感器相比数量最多的数据段，其次是传感器5(13.43%)、传感器8(9.93%)和传感器3(9.82%)</li><li id="23c5" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">传感器1、7、9和10丢失的数据片段较少。</li><li id="f1f1" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">而对于传感器4和6，我们有所有训练段的数据</li></ul><p id="19bc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们看看每个传感器的值的范围。我们将通过确定所有训练段的每个传感器的最大值和最小值来做到这一点。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ng"><img src="../Images/72dbff302c978271144a0ad00df17678.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LNhshbucUymNW0ilGnZMfA.jpeg"/></div></div></figure><p id="184a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以从上面的输出中推断出所有传感器值的范围是从-32767到32767。现在，我们将按喷发时间对列车分段进行排序，并检查一些具有低喷发时间值和高喷发时间值的分段。</p><p id="890b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们来看一些具有低爆发时间值的片段的时间序列可视化。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nh"><img src="../Images/2467270a3e32e6e43424f7021329ab8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IQZ_kun_z9_XEYBPtgLrSQ.jpeg"/></div></div></figure><p id="1bf3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上图描绘了未来大约(4分钟)爆发的时间段(采集数据时的wrt时间)。让我们再来看一些低爆发时间值的数据。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ni"><img src="../Images/b84900d7447d8cc7a7713ccc92c3e5a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TmjcmM7Ch5w7s6H6KRJiZA.jpeg"/></div></div></figure><p id="4024" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第二段和第三段(第二段和第三段火山爆发时间)的可视化显示在上面两个图中，我们可以看到:</p><ul class=""><li id="7301" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">在30000 cs期间，第一个图中的信号在所有传感器中表现出明显的颤动。</li><li id="1a05" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">第二个图中的信号也在10000至20000 cs和40000至50000 cs之间具有峰值和下降，但是它们不像第一个图中那样明显可区分。</li><li id="cbf1" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">这些数据的高点和低点可能有助于预测火山爆发。</li></ul><p id="9dd0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们看看其他几个具有更高爆发时间值的细分市场。我们现在将绘制具有大得多的喷发时间值的数据，并查看它如何与上面的图(具有小得多的喷发时间)相比较。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nj"><img src="../Images/74b8640034b4484891a32816e330ce68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wCCindSazqQ7KdrIqEwYjw.jpeg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nk"><img src="../Images/116cfc393e8be327589101ba5ba740aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r715c82g2y00DZPmbhhP8g.jpeg"/></div></div></figure><p id="5eed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上面的两个图显示了最后两个部分的传感器值(根据喷发时间):</p><ul class=""><li id="5518" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">传感器1和5未能捕捉到具有最高喷发时间值的时间段的时间序列。</li><li id="c538" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">特定时间间隔(在给定的10分钟内)之间的峰值和下降可以用作时间序列特征。</li><li id="8d67" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">特定传感器或传感器组缺少整个序列也可以指示喷发时间。</li></ul><p id="1fbe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我们将从训练数据的一些随机片段中生成传感器值密度图，以检查它们的分布模式。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nl"><img src="../Images/5971232ab5b8316acdf19a8c05ac0583.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OQ_ShACrIxjXo7eMfTI4ug.jpeg"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nm"><img src="../Images/112e0412ef0a82d63d2ebb72dc8ee440.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ZPWscVJ3dLfv8iC-AvSxQ.jpeg"/></div></div></figure><p id="522c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于以上两个情节，我们可以得出结论:</p><ul class=""><li id="b636" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">尽管大多数传感器的分布似乎是正态的，但并非所有的都是正态的。我们可以通过检查传感器6和10(第一个图)以及传感器5和6(第二个图)的分布来验证这一点。</li><li id="46d8" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">然而，它们中的大多数类似于正态分布的钟形曲线。因此，我们考虑向每个数据段添加来自传感器分布的特征，例如平均值、标准偏差、不同分位数值、偏斜度和峰度</li></ul></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="6115" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">5.相关作品</h1><p id="1000" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">让我们简单看一下以前应对这一挑战的一些方法。这一部分不是开发过程的一部分，但是它通过调查过去在这个方向上所采取的思想的实现提供了一个更广阔的观点；下面简要讨论其中一些:</p><h2 id="a319" class="mb kb hh bd kc mc md me kg mf mg mh kk ip mi mj ko it mk ml ks ix mm mn kw mo bi translated"><strong class="ak"> 5.1 Mel声谱图+混合ResNets </strong> <em class="nn"> ( </em> <a class="ae js" href="https://www.kaggle.com/c/predict-volcanic-eruptions-ingv-oe/discussion/211315" rel="noopener ugc nofollow" target="_blank"> <em class="nn">链接</em> </a> <em class="nn"> ) </em></h2><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es no"><img src="../Images/61a4f370fbb2f2587c3dfb021d0c87b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*IDwt0laxYUgZYubSBKoflA.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">图2:解决方案管道图</figcaption></figure><p id="4340" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该方法采用混合的ResNet模型，该模型应用于从信号导出的可视化。因此，这项技术分为两部分:</p><ul class=""><li id="c162" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">来自每个部分的传感器信号被转换成Mel大小的光谱图，其用作信号的视觉表示。</li><li id="2a69" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">然后将这些光谱图输入几个ResNet和基于树的模型的加权平均值(图2)。</li></ul><h2 id="143d" class="mb kb hh bd kc mc md me kg mf mg mh kk ip mi mj ko it mk ml ks ix mm mn kw mo bi translated">5.2 <strong class="ak">双向</strong> <strong class="ak">叠加使用渐变增强树</strong> <em class="nn"> ( </em> <a class="ae js" href="https://www.kaggle.com/c/predict-volcanic-eruptions-ingv-oe/discussion/209766" rel="noopener ugc nofollow" target="_blank"> <em class="nn">链接</em> </a> <em class="nn"> ) </em></h2><p id="43a3" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">该方法遵循的步骤如下:</p><ul class=""><li id="0f90" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><em class="lu">特色工程</em></li><li id="dad5" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><em class="lu">验证和特性选择</em></li><li id="778b" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><em class="lu">第一级模型:</em>堆叠分类器的第一级使用三个模型，即LightGBM、XGBoost和神经网络。</li><li id="bd83" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><em class="lu">第二级模型:</em>基于第一级LightGBM的两个模型在第二级堆叠时创建</li><li id="d997" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><em class="lu">平均混合:</em>最后，对两个模型(在第二级)的预测进行平均，以获得更好的LB分数</li></ul><h2 id="1e9e" class="mb kb hh bd kc mc md me kg mf mg mh kk ip mi mj ko it mk ml ks ix mm mn kw mo bi translated">5.3 <strong class="ak">深度学习模型使用LSTM层</strong> <em class="nn"> ( </em> <a class="ae js" href="https://www.kaggle.com/c/predict-volcanic-eruptions-ingv-oe/discussion/209534" rel="noopener ugc nofollow" target="_blank"> <em class="nn">)链接</em> </a> <em class="nn"> ) </em></h2><p id="a856" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">这种方法采用LSTM递归神经网络结构。建议的方法分为两个阶段:</p><ul class=""><li id="b78b" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><em class="lu">特征工程:</em>数据集中包含四类特征，即时间特征、频率特征、倒谱特征和光谱特征</li><li id="4952" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><em class="lu">深度学习模型:</em>模型的架构如下。在模型中，LSTM层之后是三个Conv1D层。然后使用展平层进行展平。展平层的输出然后被馈送到完全连接的NN(由分别为64、32和1个单位的三个密集层组成)。</li></ul></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="e1d6" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak"> 6。开发基准模型</strong></h1><p id="b8bf" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">我们已经深入研究了我们的数据，开始一些简单的建模。我们知道，每个数据点是一组10维的时间序列，而每个时间序列可以被认为是传感器值分布对应的特定数据点或数据段。</p><h2 id="4f48" class="mb kb hh bd kc mc md me kg mf mg mh kk ip mi mj ko it mk ml ks ix mm mn kw mo bi translated">6.1每个片段的描述性统计<strong class="ak">s</strong></h2><p id="388e" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">在本节中，我们将开发传感器值分布的一些基本描述特征。这些特征集将包括:每个传感器分布平均值、标准偏差、最小值、最大值、不同分位数值(第30、60、80、90)、偏斜度和峰度。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><p id="ca02" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">相关系数图</strong></p><p id="8709" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们现在可以调查特征的相关统计数据，并与目标变量喷发时间进行比较。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nr"><img src="../Images/e8346904270eda9697c5ef89f01eaea8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uao4Dke6p8VwDP6Qu7yGbQ.jpeg"/></div></div></figure><blockquote class="lr ls lt"><p id="346e" class="ie if lu ig b ih ii ij ik il im in io lv iq ir is lw iu iv iw lx iy iz ja jb ha bi translated"><strong class="ig hi">注:</strong>图片是实际图片的一小部分，点击<a class="ae js" href="https://imgur.com/a/c1P97SO" rel="noopener ugc nofollow" target="_blank">链接</a>查看完整图片。</p></blockquote><p id="d75e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上图描述了特征和目标变量之间的相关性。</p><ul class=""><li id="508a" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">所有的基本特征，每一个或多或少都是相关的(积极的或消极的)。</li><li id="7e5a" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">代表传感器最小值和第30个分位数的特征与喷发时间变量正相关。</li><li id="7f6e" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">代表标准偏差、最大值和分位数(第60、80、90位)值的所有传感器特征都与目标负相关。</li><li id="6ca9" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">对于某些传感器分布特征，如平均值、偏斜度和峰度，相关幅度非常差。</li></ul><p id="de97" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">相对特征重要性图</strong></p><p id="34d8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下图描述了所绘制要素的相对要素重要性。特征重要性由随机森林算法计算。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ns"><img src="../Images/db5c54515dc54abfe2867ec1584bf5b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CKU64obnR453MfBXiRl8Qw.png"/></div></div></figure><ul class=""><li id="be9e" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">传感器2和传感器5的标准偏差比其他特征更重要。</li><li id="3da4" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">大多数偏斜度和均值特征的值相对较低。</li><li id="c328" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">由于这些特性中的大多数在某种程度上都很重要，我们将使用它们来构建我们的基准模型。</li><li id="9609" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">然而，在建模时，我们将忽略所有传感器分布的均值和偏斜度特征。</li></ul><p id="4370" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于我们通过每段记录每个传感器的最小值和最大值，因此我们不需要记录错过的传感器，因为这是一个冗余信息。我们用零来估算缺失值，因此对于任何传感器完全缺失的部分，最小和最大特征都为零。</p><p id="accf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">关于基本描述特征的机器学习模型</strong></p><p id="3a96" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">给定片段的第一组特征已经绘制出来。在这一节中，我们将合并各种ML模型，并检查所绘制特征的有用性。</p><p id="8bf0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本节中，我们将检查微小的代码片段及其相关结果，试图防止完整的代码遍历。复制案例研究的实现代码将在本博客的最后以相应GitHub资源库链接的形式给出。</p><ul class=""><li id="336a" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><strong class="ig hi">弹力网</strong></li></ul><p id="2579" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本实验中，我们将检查与各种α值(决定要应用的正则化量的常数)相关的误差度量，并使用产生最小误差量的α来训练弹性网络模型。但是，我们将首先对数据进行缩放，然后训练模型，而不是向模型提供获得的数据。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nt"><img src="../Images/2ff0bf895e4bf1e6195931187aaafb47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MUx_wb3XerB6BiXNlA0CCQ.jpeg"/></div></div></figure><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><ul class=""><li id="5a36" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><strong class="ig hi">随机森林回归器</strong></li></ul><p id="9a04" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我们将研究随机森林模型相对于不同数量的基础学习者的误差测量，并使用最佳数量的基础学习者训练随机森林。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nu"><img src="../Images/43ead746bc7cfb282fe1d9c84701e432.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NZzRFjBT9l7T4cWFqsvSeg.jpeg"/></div></div></figure><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><ul class=""><li id="c737" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><strong class="ig hi"> XGBoost回归器</strong></li></ul><p id="e050" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将重复我们对随机森林模型所做的实验，并用最佳数量的基础学习器来训练梯度推进回归器。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nv"><img src="../Images/604aeee0c8c082cb29a1e77512be0068.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_leAxTRJwFi_HFdakXaeEQ.jpeg"/></div></div></figure><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><p id="1818" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">总结:</strong></p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><ul class=""><li id="2cf8" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">在验证mae方面，XGBoost和RandomForest都优于ElasticNet，但它们都过度拟合了训练结果。</li><li id="8318" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">在这种情况下，RandomForest优于XGBoost，因为XGBoost回归器过拟合训练集，并且具有比RF模型更高的验证mae。</li><li id="5883" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">因此，我们现在可以继续使用RandomSearchCV对随机森林和XGBoost模型进行超参数调整，以避免过度拟合。</li></ul><p id="c738" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">超参数调谐</strong></p><ul class=""><li id="7df5" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">随机森林回归量</li></ul><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><pre class="jd je jf jg fd mt mu mv mw aw mx bi"><span id="8113" class="mb kb hh mu b fi my mz l na nb">For hyperparameter tuned RandomForestRegressor with parameters : </span><span id="b877" class="mb kb hh mu b fi nc mz l na nb">{'n_estimators': 1500, 'min_samples_split': 12, 'min_samples_leaf': 5, 'max_samples': 0.8, 'max_features': 0.6000000000000001, 'max_depth': 12}  </span><span id="b0b7" class="mb kb hh mu b fi nc mz l na nb">Mean Absolute Error for train data :  4383116.024559133 <br/>Mean Absolute Error for cv data :  5500394.4091687715</span></pre><ul class=""><li id="1ebd" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">XGBoost回归器</li></ul><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><pre class="jd je jf jg fd mt mu mv mw aw mx bi"><span id="7e92" class="mb kb hh mu b fi my mz l na nb">For hyperparameter tuned XGBoostRegressor with parameters :</span><span id="9d32" class="mb kb hh mu b fi nc mz l na nb">{'subsample': 0.4, 'n_estimators': 800, 'max_depth': 9, 'learning_rate': 0.05, 'colsample_bytree': 0.8}  </span><span id="050b" class="mb kb hh mu b fi nc mz l na nb">Mean Absolute Error for train data :  19707.49871692089 <br/>Mean Absolute Error for cv data :  4116339.266495798</span></pre><p id="87fa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">总结:</strong></p><pre class="jd je jf jg fd mt mu mv mw aw mx bi"><span id="78e9" class="mb kb hh mu b fi my mz l na nb"><strong class="mu hi"><em class="lu">Note</em></strong><em class="lu">: HPT = hyperparameter Tuned</em></span></pre><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><h2 id="15b5" class="mb kb hh bd kc mc md me kg mf mg mh kk ip mi mj ko it mk ml ks ix mm mn kw mo bi translated">6.2描述性统计各段的wrt时间步长</h2><p id="8368" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">在这一节中，我们将构建与上一节中派生的特性相似的特性，但是有一点点不同。我们首先将整个部分分成六个部分(每个部分包含10000个时间步长的数据)，然后分别测量这六个部分中每个部分的数据的简单静态(如平均值、最大值和最小值)以获得新的特征。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><p id="3bdb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">相关系数图</strong></p><p id="c636" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们现在将研究特征相对于目标变量的相关性统计:喷发时间</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nw"><img src="../Images/9a784f8f34b7d91b9fb043d2aad2ba6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8aY5ATAGu95Qic7e4HhMEQ.jpeg"/></div></div></figure><blockquote class="lr ls lt"><p id="a629" class="ie if lu ig b ih ii ij ik il im in io lv iq ir is lw iu iv iw lx iy iz ja jb ha bi translated"><strong class="ig hi">注意:</strong>图片是实际图片的一小部分，点击<a class="ae js" href="https://imgur.com/a/PkmSntx" rel="noopener ugc nofollow" target="_blank">链接</a>查看完整图片。</p></blockquote><p id="fd01" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上图描述了特征和目标变量之间的相关性。</p><ul class=""><li id="4ed7" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">大多数特征(除了与均值、峰度和偏度相关的特征)都与目标变量相关。</li><li id="8cf9" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">诸如最大值、标准差、60分位数、80分位数、90分位数等特征与目标负相关</li><li id="2290" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">而最小的30分位数特征是正相关的。</li></ul><p id="4c93" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">相对特征重要性图</strong></p><p id="a8e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下图给出了新功能的相对功能重要性。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nx"><img src="../Images/7189b367a94e5fb08ae62c58562328d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tUNJQOs9rdqjmqHbU_0RSw.jpeg"/></div></div></figure><blockquote class="lr ls lt"><p id="6733" class="ie if lu ig b ih ii ij ik il im in io lv iq ir is lw iu iv iw lx iy iz ja jb ha bi translated"><strong class="ig hi">注意:</strong>图片是实际图片的一小部分，点击<a class="ae js" href="https://imgur.com/a/hXSbDxa" rel="noopener ugc nofollow" target="_blank">链接</a>查看完整图片。</p></blockquote><ul class=""><li id="13b3" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">sensor_2_60的标准偏差比其余特征更重要。</li><li id="12ed" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">由于这些特性中有许多在某种程度上很重要，我们将使用它们来构建我们的基准模型。</li><li id="b67e" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">然而，这次我们将忽略给定传感器分布的均值、峰度和偏斜度特征。</li></ul><p id="9907" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">不同时间窗口上基本描述特征的机器学习模型</strong></p><p id="b56c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">每个细分市场的第二组功能已经开发出来。在本节中，我们将使用与上一节相同的ML模型来评估所绘制特征的有效性。</p><p id="8b8c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这一部分中，我们将使用ElasticNet、RandomForest和XGBoost进行与上一部分相似的实验。这些实验的结果总结如下。</p><p id="cd03" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">总结:</strong></p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><p id="5034" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">时间步长方面的描述性特征对特征化过程没有显著贡献，如MAE得分与先前特征集的比较所示。因此，在这组实验中，我们没有做任何超参数调整工作。</p><h2 id="5c36" class="mb kb hh bd kc mc md me kg mf mg mh kk ip mi mj ko it mk ml ks ix mm mn kw mo bi translated"><strong class="ak"> 6.3 </strong>以上两个特征集上的机器学习模型</h2><p id="f07d" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">我们现在可以考虑这两个特征集，并将它们输入特征选择模块，以确定在决定喷发时间时真正有用的特征的最佳数量。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ny"><img src="../Images/05ed2625a206743bff8feb06de77c3ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7BguLsSTWtUEmzw0Ly8baQ.jpeg"/></div></div></figure><p id="7ca5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上图显示，最佳特征数为60。我们现在将对之前使用的三个模型重复相同的一系列实验，并将结果总结如下。</p><p id="442a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">概要:</strong></p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><p id="e42e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">超参数调优后，验证集的效率有所下降，但过度拟合的问题大大减少。在继续之前，让我们看一下到目前为止得到的平均绝对误差值。</p><p id="da2c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">总结:</strong></p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><p id="67f7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是，如果我们使用以下标准评估模型的性能:</p><ul class=""><li id="3051" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">安装列车组</li><li id="e0d7" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">验证集上的模型性能</li></ul><p id="b882" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们认为Desc统计特性集(模型1)的HPT·随机森林和Desc统计特性集(模型2)的HPT·随机森林都是很好的基准。我们已经使用它们获得了公开测试数据的结果，并将结果文件提交给了<a class="ae js" href="https://www.kaggle.com/c/predict-volcanic-eruptions-ingv-oe" rel="noopener ugc nofollow" target="_blank">比赛现场</a>。</p><p id="dbf9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面给出了在私有和公共测试集上获得的Kaggle分数:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nz"><img src="../Images/486dcfd46fde7fc0805548f621dedb43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IIZ5TQo4hFmXprseWkVN8A.jpeg"/></div></div></figure><ul class=""><li id="87f8" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">通过考虑为测试集生成预测所花费的时间和Kaggle生成的性能分数，Model_1具有更好的性能</li><li id="b85c" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">因此，我们将选择Model_1(基本描述性特征+ RandomForestRegressor)作为基准/基线</li></ul></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="a8bd" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">7.<strong class="ak">开发定制集合模型</strong></h1><p id="142c" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">本节提供了一个定制的集成算法来模拟我们的数据。该模型使用堆叠机制，即从基础模型获得预测作为特征，并使用该特征来训练元学习器，以对所获得的特征和目标变量之间的关系进行建模。</p><p id="a849" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">列车组建模过程如下所述:</p><ul class=""><li id="6f4f" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">将列车组平均分成两组:D1和D2</li><li id="ee68" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">对D1进行替换取样，创建k个样本:d <em class="lu"> 1 </em>，d <em class="lu"> 2 </em>，d <em class="lu"> 3 </em>，…，d <em class="lu"> k </em></li><li id="6ffb" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">使用这些<em class="lu"> k个</em>样本来训练k个数量基础模型(在我们的例子中是决策树)</li><li id="3a8f" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">现在使用D2，通过让D2通过经过<em class="lu"> k </em>训练的基础学习器，获得<em class="lu"> k- </em>维特征集</li><li id="d647" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">在这个从D2和D2目标获得的k维特征集的帮助下，训练一个元学习者。任何回归算法都可以用作元学习器。</li></ul><p id="1f1f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们已经在python类下定义了这个自定义集成回归变量，定义如下:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><p id="5f2c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们测试了各种元学习者，包括SVM、决策树和其他基于树的模型，发现拥有1300个基础学习者的XGBoost比其他模型表现更好。因此，我们可以将基础学习者的数量限制在1300个，将元学习者设置为XGBoost，只对元学习者进行网格搜索。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><pre class="jd je jf jg fd mt mu mv mw aw mx bi"><span id="a9da" class="mb kb hh mu b fi my mz l na nb">With number of base learners = 1300 and meta learner = xgboost the best MAE score we get : </span><span id="47ac" class="mb kb hh mu b fi nc mz l na nb">Mean Absolute Error for train data : 1992397.2213964183 <br/>Mean Absolute Error for cv data : 5385850.012225198</span></pre><p id="67d2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我们已经设计并获得了定制堆叠系综的分数，让我们看看迄今为止得到的平均绝对误差值。</p><p id="bb1f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">总结:</strong></p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><p id="2cef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个定制模型将以Python Pickle格式保存，以便以后用于部署。目前，我们将使用该模型在公共测试集上评估其性能。在公共和私人测试集上获得的mae分数如下所示:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es oa"><img src="../Images/689a2e97acf1571ad08af699b8dd5fce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uMag8tzjTlWLH-pjZ-qV1g.jpeg"/></div></div></figure></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="d45f" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">8.简化web应用程序</h1><p id="84de" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">在这一部分中，我们将使用根据数据训练的自定义集合模型来构建一个web-app界面，以便用户使用Streamlit进行交互。这是一个开源python库，旨在构建和共享网络应用。</p><p id="9d03" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">安装:</strong></p><pre class="jd je jf jg fd mt mu mv mw aw mx bi"><span id="2ffb" class="mb kb hh mu b fi my mz l na nb">pip install streamlit</span></pre><p id="1ca8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">出于模块化的考虑，我们将代码分成了单独的python(。py)文件，如下所示:</p><ul class=""><li id="2094" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><em class="lu">model . py</em>——定义自定义模型类</li><li id="0859" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><em class="lu"> predict.py </em> —定义最终预测函数和返回误差测量值的函数</li><li id="65b8" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><em class="lu"> helper.py — </em>定义应用程序所需的任何附加功能</li><li id="e7dd" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><em class="lu"> app.py — </em>包含主要的streamlit代码，有助于在网络浏览器上呈现应用程序</li></ul><p id="5293" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">人们只需将所有内容放在<em class="lu"> app.py </em>文件中。在这一节中，我们将只研究<em class="lu"> app.py </em>，其余python文件的内容将在模型开发一节中解释。</p><p id="c874" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们开始吧…</p><p id="eb03" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">第一步:</strong>为网络应用程序设置标题、封面图片，并创建一个侧边栏来显示应用程序的其他信息。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ob"><img src="../Images/3ffd9d72f63a1d98eda99b24a64c5948.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EKDzbdxfvdkzIzwvx2WHWQ.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">图2:标题、封面和侧栏</figcaption></figure><blockquote class="lr ls lt"><p id="1c76" class="ie if lu ig b ih ii ij ik il im in io lv iq ir is lw iu iv iw lx iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="hh">注:</em> </strong> <em class="hh">侧边栏中About下的文本被写入一个txt文件:</em> about.txt <em class="hh">，该文件与</em> app.py <em class="hh">文件位于同一目录。</em></p></blockquote><p id="9e79" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">步骤2: </strong>创建一个文件上传对象，用于处理csv文件上传以供测试</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es oc"><img src="../Images/3e4d08bc895e7591da8686e97e7938c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zql4VOzfRoMF-RsNNofjaA.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">图2:文件上传器</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es od"><img src="../Images/8cb3f9552ca85b9936482266fb1ae237.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aQH2bZWCM2Q0jTFLsue1NA.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">图2:文件上传器预测输出</figcaption></figure><p id="3710" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">步骤3: </strong>为上传的多维时间序列的可视化创建选项</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np nq l"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es oe"><img src="../Images/e46cbb7f2e7bc4ead3e50a06b1babd29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OsqoYSTb_bx3R01eYgqfoA.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">图2:可视化输出</figcaption></figure><p id="62f7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">到目前为止，一切顺利；我们已经浏览了web应用程序的主要组件。查看<a class="ae js" href="https://github.com/cssoumyade/heroku-app-volcano/blob/main/app.py" rel="noopener ugc nofollow" target="_blank"><em class="lu">app . py</em></a><em class="lu"/>获取完整代码。</p><p id="0e34" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在线部署web-app之前，可以通过在环境提示符下运行以下命令在本地验证应用程序。</p><pre class="jd je jf jg fd mt mu mv mw aw mx bi"><span id="d9bb" class="mb kb hh mu b fi my mz l na nb">streamlit run app.py</span></pre><blockquote class="lr ls lt"><p id="7bd8" class="ie if lu ig b ih ii ij ik il im in io lv iq ir is lw iu iv iw lx iy iz ja jb ha bi translated">从Youtube上JCharis的优秀视频教程中了解更多关于Streamlit的信息</p></blockquote></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="bbc7" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">9.Heroku部署</h1><p id="e609" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">现在我们已经完成了大部分任务，我们有一个可以在本地运行的应用程序，只有开发人员可以看到或运行它。</p><p id="b62d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，Heroku开始发挥作用。Heroku平台在可靠和一致的运行时环境中执行虚拟容器中的用户应用程序。为了将开发的应用程序部署到Heroku服务器上，我们经历了三个主要步骤:</p><ul class=""><li id="d01c" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">创建Heroku成功运行应用程序所需的文件。</li><li id="70ca" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">使Heroku平台可以通过。开源代码库</li><li id="8aae" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">将代码报告与容器连接</li></ul><p id="92e1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第一步:创建Heroku需要的文件</p><p id="ac18" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">到目前为止，我们项目的主要目录包括:</p><ul class=""><li id="57d5" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><strong class="ig hi"><em class="lu">custensemblexgb . pkl</em></strong><em class="lu">—</em>我们最终模型的序列化版本</li><li id="7bed" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><strong class="ig hi"><em class="lu">model . py</em></strong><em class="lu">—</em>自定义模型定义</li><li id="51d0" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><strong class="ig hi"><em class="lu">predict . py</em></strong><em class="lu">—</em>预测和评分所需的函数</li><li id="ea9e" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><strong class="ig hi"><em class="lu">helper . py</em></strong><em class="lu">—</em>附加助手功能</li><li id="66c5" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><strong class="ig hi"> <em class="lu"> app.py </em> </strong> —包含streamlit前端的脚本</li></ul><p id="bdff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Heroku希望得到更多的细节，比如加载哪个Python版本，需要哪些依赖项，或者在部署的环境中运行哪个文件。平台所需的所有信息都由以下文件提供，这些文件与其他文件一样，应该位于主目录中:</p><ul class=""><li id="c333" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><strong class="ig hi"><em class="lu">setup . sh</em></strong><em class="lu">—</em>该文件将包含构建新目录streamlit的命令，以及不同的环境初始化参数。</li></ul><pre class="jd je jf jg fd mt mu mv mw aw mx bi"><span id="e67e" class="mb kb hh mu b fi my mz l na nb">mkdir -p ~/.streamlit/ <br/>echo “\<br/>[server]\n\<br/>port = $PORT\n\<br/>enableCORS = false\n\<br/>headless = true\n\<br/>\n\<br/>” &gt; ~/.streamlit/config.toml</span></pre><ul class=""><li id="8f28" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><strong class="ig hi"><em class="lu">Procfile</em></strong><em class="lu">—</em>需要启动web应用程序并运行设置脚本和简化应用程序</li></ul><pre class="jd je jf jg fd mt mu mv mw aw mx bi"><span id="696e" class="mb kb hh mu b fi my mz l na nb">web: sh setup.sh &amp;&amp; streamlit run app.py</span></pre><ul class=""><li id="e5a3" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><strong class="ig hi"><em class="lu">runtime . txt</em></strong><em class="lu">—</em>指定app需要的python版本</li></ul><pre class="jd je jf jg fd mt mu mv mw aw mx bi"><span id="cf40" class="mb kb hh mu b fi my mz l na nb">python-3.7.10</span></pre><blockquote class="lr ls lt"><p id="faef" class="ie if lu ig b ih ii ij ik il im in io lv iq ir is lw iu iv iw lx iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="hh">注意:</em> </strong>创建runtine.txt文件前检查<a class="ae js" href="https://devcenter.heroku.com/articles/python-support#supported-runtimes" rel="noopener ugc nofollow" target="_blank"> Heroku Python支持</a>。</p></blockquote><ul class=""><li id="d947" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><strong class="ig hi"><em class="lu">requirements . txt</em></strong><em class="lu">—</em>指定其他依赖的版本需求</li></ul><pre class="jd je jf jg fd mt mu mv mw aw mx bi"><span id="4c4e" class="mb kb hh mu b fi my mz l na nb">streamlit==0.80.0<br/>pandas==1.1.0<br/>numpy==1.18.5<br/>scikit-learn==0.22.2.post1<br/>matplotlib==3.3.0<br/>xgboost==1.1.1</span></pre><p id="df98" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过验证环境的软件包列表，仔细检查您的软件包版本</p><p id="55ee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">第二步:</strong>通过以下方式使Heroku可以访问代码。开源代码库</p><ul class=""><li id="10bd" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">创建空的GitHub repo</li><li id="950e" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">用git init初始化主目录</li><li id="aab9" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">将代码推送到创建的repo中</li><li id="e427" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">确保添加README.md和许可证文件</li></ul><blockquote class="lr ls lt"><p id="4453" class="ie if lu ig b ih ii ij ik il im in io lv iq ir is lw iu iv iw lx iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="hh">注:</em> </strong>如果您是git新手，请查看这个<a class="ae js" href="https://product.hubspot.com/blog/git-and-github-tutorial-for-beginners" rel="noopener ugc nofollow" target="_blank">精彩的博客</a>(在先决条件中已经提到)</p></blockquote><p id="f854" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">步骤3: </strong>将回购与Heroku容器连接</p><p id="3f8e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦代码被推送，你就可以在Heroku dashboard中构建一个应用了。为此，我们必须:</p><ul class=""><li id="f773" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">创建一个<a class="ae js" href="https://www.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a>账户</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es of"><img src="../Images/7ba30476292e4f9b56c18581c2d1185f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p7TTUYBghBqzKZOKRAr6Wg.jpeg"/></div></div></figure><ul class=""><li id="1a57" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">然后从Heroku dashboard创建一个新应用程序。分配一个合适的名称&amp;在后续表单中选择一个地区，然后点击创建应用程序。</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es og"><img src="../Images/745a44b1946b9afbd872d155d11976e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LCteSSpm-IbQanIsZ7POvw.jpeg"/></div></div></figure><ul class=""><li id="ac65" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">一旦我们在创建的应用程序的仪表板上，选择部署方法为GitHub。然后部署应用程序文件所在的特定回购分支，在我们的例子中，它将是<em class="lu">主节点。</em></li><li id="5b47" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">等待它设置容器并初始化环境。完成后，它将自动生成成功的构建消息和到部署的web应用程序的链接。</li></ul><blockquote class="lr ls lt"><p id="9d52" class="ie if lu ig b ih ii ij ik il im in io lv iq ir is lw iu iv iw lx iy iz ja jb ha bi translated">要了解更多关于Heroku的信息，请参考<a class="ae js" href="https://devcenter.heroku.com/categories/reference" rel="noopener ugc nofollow" target="_blank">官方文档</a></p></blockquote></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="24db" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">10.讨论</h1><ul class=""><li id="89dc" class="ld le hh ig b ih ky il kz ip oh it oi ix oj jb li lj lk ll bi translated">在这个案例研究中，我们有机会接触到INGV通过Kaggle提供地震数据</li><li id="d715" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">我们基本上有两组数据:训练(4431)和测试(4520)，由10个传感器记录的数据组成</li><li id="dbe5" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">首先，我们绘制了每个数据点的每个传感器分布的特征，例如最小值、最大值和其他分布属性</li><li id="9e61" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">另一组类似的特征(但这次特征的数量更多，因为我们不是从整个传感器分布中提取特征，而是在更小的时间窗口的基础上收集它们)将在接下来的部分中绘制</li><li id="be91" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">然后，主要将三种(弹性网、随机森林、XGBoost) ML算法应用于两个集合的组合，并对特征和性能进行了比较。</li><li id="ee66" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">我们还设计了一个定制的堆叠集成模型，并用获得的特征对其进行训练。</li><li id="4a7d" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">最后，在实际部署到Heroku网络之前，我们采用了模型的序列化版本并创建了一个基本的Streamlit web界面。</li></ul></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="6e8c" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">11.未来的工作</h1><ul class=""><li id="4b6d" class="ld le hh ig b ih ky il kz ip oh it oi ix oj jb li lj lk ll bi translated">要考虑丰富的特征工程技术，比如把时域转换到频域。还可以考虑像tsfresh这样的开源库来绘制与时间序列数据相关的特性。</li><li id="066b" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">我们还应该尝试更复杂的建模技术(如ann、DL)。</li><li id="6802" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">我们可以寻找一些预先训练的网络，用于特征提取，这些网络已经能够完成与时间序列数据相关的类似任务。</li><li id="d6b6" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">向应用程序添加更多功能，并优化其现场性能。</li></ul></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="84cd" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">12.参考</h1><ul class=""><li id="ef55" class="ld le hh ig b ih ky il kz ip oh it oi ix oj jb li lj lk ll bi translated"><a class="ae js" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">申请课程</a></li><li id="fd07" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><a class="ae js" href="https://www.kaggle.com/c/predict-volcanic-eruptions-ingv-oe" rel="noopener ugc nofollow" target="_blank">ka ggle——预测火山爆发</a></li><li id="9e5e" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><a class="ae js" href="https://www.kaggle.com/c/predict-volcanic-eruptions-ingv-oe/discussion/211315" rel="noopener ugc nofollow" target="_blank"> Mel光谱图+混合结果图</a></li><li id="4b83" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><a class="ae js" href="https://www.kaggle.com/c/predict-volcanic-eruptions-ingv-oe/discussion/209600" rel="noopener ugc nofollow" target="_blank">使用librosa和混合神经网络进行特征提取</a></li><li id="a876" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><a class="ae js" href="https://www.kaggle.com/c/predict-volcanic-eruptions-ingv-oe/discussion/209766" rel="noopener ugc nofollow" target="_blank">使用梯度增强树的2级堆叠</a></li><li id="e40b" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><a class="ae js" href="https://www.kaggle.com/c/predict-volcanic-eruptions-ingv-oe/discussion/209534" rel="noopener ugc nofollow" target="_blank">使用LSTM层的深度学习模型</a></li><li id="165d" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><a class="ae js" href="https://product.hubspot.com/blog/git-and-github-tutorial-for-beginners" rel="noopener ugc nofollow" target="_blank"> Git和GitHub博客</a></li><li id="6503" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><a class="ae js" href="https://devcenter.heroku.com/categories/reference" rel="noopener ugc nofollow" target="_blank"> Heroku文档</a></li></ul></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="3624" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">外部链接</h1><ul class=""><li id="bd62" class="ld le hh ig b ih ky il kz ip oh it oi ix oj jb li lj lk ll bi translated"><a class="ae js" href="https://heroku-app-volcano.herokuapp.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">已部署的web-app </strong> </a></li><li id="8558" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><a class="ae js" href="https://github.com/cssoumyade/heroku-app-volcano" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> GitHub资源库</strong> </a></li><li id="6364" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><a class="ae js" href="https://www.linkedin.com/in/cssoumyade/" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">在LinkedIn </strong>上和我联系</a></li></ul></div></div>    
</body>
</html>