<html>
<head>
<title>A complete guide to fit Machine Learning models in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用R语言拟合机器学习模型的完整指南</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-complete-guide-to-fitting-machine-learning-models-in-r-24a3dea2ee82?source=collection_archive---------13-----------------------#2021-01-04">https://medium.com/analytics-vidhya/a-complete-guide-to-fitting-machine-learning-models-in-r-24a3dea2ee82?source=collection_archive---------13-----------------------#2021-01-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="98e4" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">这比你想象的要简单</p></blockquote><p id="277a" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">本文描述了如何在<em class="ik"> R </em>中使用各种机器学习模型进行训练和预测。<em class="ik"> R </em>是一种强大的编程语言，主要面向统计研究，尽管它有更广泛的应用。我们将公开<strong class="il hj">的语法实现</strong>，另外我们将描述每个模型的常用<strong class="il hj">拟合选项</strong>和<strong class="il hj">超参数</strong>，如何使用<strong class="il hj">交叉验证</strong>，以及最终<strong class="il hj">如何做出预测</strong>。我们还将展示如何<strong class="il hj">保存模型</strong>。</p><p id="f445" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">我们将使用的数据可以在[1]中找到。它由12 054场<em class="ik"> NBA </em>比赛，以及日期、最终结果和一些体育分析中常用的预测变量(输赢记录、攻防表现)组成。这只是一个示例数据集，显然我要展示的代码与这个特定的数据集无关。数据集如下所示:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/74f150f05e678784f211109536823c10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c_BzTX1vlnBX8WD88ueNkA.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">图1:数据集概述(绿色为预测变量，黄色为结果，灰色为杂项信息)</figcaption></figure></div><div class="ab cl ka kb gp kc" role="separator"><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf"/></div><div class="hb hc hd he hf"><p id="b0a9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">0-加载库和数据</p><p id="474b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">I —随机森林</p><p id="f0f1" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">二——LDA、QDA等。</p><p id="e3bc" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">III —支持向量机</p><p id="f2c9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">四、平均神经网络</p><p id="75db" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">V —做出预测</p></div><div class="ab cl ka kb gp kc" role="separator"><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf"/></div><div class="hb hc hd he hf"><p id="10c6" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> 0 —加载库和数据</strong></p><p id="e6f7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">首先，我们导入库，加载数据集，并只选择预测变量<em class="ik"> X </em>和独立变量<em class="ik"> Y </em>(在我们的数据集的情况下是<em class="ik">赢家</em>)来创建我们的训练和测试集。下面的模型将被训练来预测分类变量——因为<em class="ik"> Y </em>要么是主队(<em class="ik"> H </em>)要么是客场(<em class="ik">A</em>)——但是预测定量输出的代码是严格相同的。</p><p id="1b63" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><em class="ik">注意:完整代码可从【2】</em>获得</p><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="kh ki l"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">图2:导入库、数据，并设置训练集和测试集</figcaption></figure><p id="e9b7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">我们最终定义<em class="ik"> trainControl </em>对象以进行交叉验证，该工具是可选的，但它减少了训练过程中的差异，并将在训练过程中使用:</p><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="kh ki l"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">图3:定义10重交叉验证</figcaption></figure><p id="570b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> I —随机森林</strong></p><p id="df16" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">我们将使用<em class="ik"> randomForest </em>包来构建和训练一个随机森林模型。通常的关键参数是我们平均的树的数量(<em class="ik"> ntree </em>)和用于构建的度量(<em class="ik">度量</em>)。更多细节可在[3]中找到。</p><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="kh ki l"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">图4:在R中训练和保存一个随机森林模型</figcaption></figure><p id="623b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">二——LDA、QDA等。</strong></p><p id="2f20" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">我们将在那里使用<em class="ik"> MASS </em>包[4]中包含的<em class="ik"> train() </em>函数。这非常有用，因为自变量'<em class="ik">方法'</em>允许我们在各种已经包含的模型中训练任何种类的ML模型。方法的详细列表和进一步的文档可在[5]中找到。构建和拟合QDA模型的代码如下所示:</p><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="kh ki l"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">图5:在R中拟合并保存一个QDA模型</figcaption></figure><p id="d33c" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> III —支持向量机</strong></p><p id="e6c8" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">尽管可以用<em class="ik"> train() </em>功能训练<em class="ik"> SVM </em>车型，但我们在这里将使用<em class="ik"> e1071 </em>包。该软件包包含用于<em class="ik"> SVM </em>模型的高级方法，以这种方式存在多种选项，例如分类类型、内核类型(<em class="ik">线性</em>、<em class="ik">径向</em>、<em class="ik">多项式</em>、自定义函数)、度量，以及训练模型预测分类概率的可能性。更多文档可在[6]中找到。</p><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="kh ki l"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">图6:在R中拟合并保存一个SVM模型</figcaption></figure><p id="e144" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> IV —平均神经网络(avNNet) </strong></p><p id="c5c7" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">在这最后一部分，我们将概述一下<em class="ik"> avNNet </em>包。这是一个特殊的包，允许建立和训练平均神经网络:具体来说，该函数适合一定数量的具有不同起始种子的神经网络，对它们进行平均，并从中建立一个独特的模型。该过程允许减少训练过程中的变化，从而获得更鲁棒的模型。关键参数是构建的NN的数量(<em class="ik">重复</em>)和每个模型的隐藏层数(<em class="ik">大小</em>)。更多文档可在[7]中找到。</p><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="kh ki l"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">图7:在R中拟合和保存avNNet模型</figcaption></figure><p id="120b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> V —做出预测</strong></p><p id="4f5d" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">一旦我们训练并保存了我们的模型，根据新数据进行预测可能会很有趣。我们只需要加载模型，然后借助<em class="ik"> predict() </em>函数进行预测。这里的关键参数是<em class="ik">类型的</em>参数。更多文档可在[8]找到。</p><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="kh ki l"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">图8:从R中保存的模型进行预测</figcaption></figure></div><div class="ab cl ka kb gp kc" role="separator"><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf kg"/><span class="kd bw bk ke kf"/></div><div class="hb hc hd he hf"><p id="e210" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">不要犹豫留下任何反馈/问题/ <em class="ik">掌声</em>或者联系我获取更多信息。</p><p id="cbc2" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">另一篇文章</strong> <em class="ik">(用机器学习构建体育博彩算法)</em> <strong class="il hj"> </strong> <a class="ae kj" rel="noopener" href="/analytics-vidhya/how-covid-19-prevented-me-from-being-a-millionnaire-in-2020-5b2144e8bdef">新冠肺炎如何阻止我在2020年成为百万富翁|作者sébastien Cararo | Analytics vid hya | 2020年12月| Medium </a></p><p id="4a82" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">联系人:</strong> sebcararo@hotmail.fr</p><p id="23d9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj">来源</strong></p><p id="8131" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">[1]数据集位置</p><p id="3b1e" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><a class="ae kj" href="https://raw.githubusercontent.com/Seb943/PCA_and_ML_R/main/Data/Example_dataset.csv" rel="noopener ugc nofollow" target="_blank">https://raw . githubusercontent . com/SEB 943/PCA _ and _ ML _ R/main/Data/Example _ dataset . CSV</a></p><p id="e57b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">[2]整个代码</p><p id="7784" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><a class="ae kj" href="https://github.com/Seb943/PCA_and_ML_R/blob/main/Codes/FittingMLmodelsInR.R" rel="noopener ugc nofollow" target="_blank">PCA _ and _ ML _ R/fittinglmodelsinr。R在主SEB 943/PCA _ and _ ML _ R(github.com)</a></p><p id="6430" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">[3]随机森林文件</p><p id="0461" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><a class="ae kj" href="https://www.rdocumentation.org/packages/randomForest/versions/4.6-14/topics/randomForest" rel="noopener ugc nofollow" target="_blank"> randomForest函数| R文档</a></p><p id="9840" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">[4]批量包装文档</p><p id="2377" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><a class="ae kj" href="https://cran.r-project.org/web/packages/MASS/MASS.pdf" rel="noopener ugc nofollow" target="_blank">MASS.pdf(r-project.org)</a></p><p id="4d97" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">[5] <em class="ik">质量<em class="ik">包中的列车</em>功能</em></p><p id="f0a9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><a class="ae kj" href="https://www.rdocumentation.org/packages/caret/versions/4.47/topics/train" rel="noopener ugc nofollow" target="_blank">列车功能| R文档</a></p><p id="dcd6" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">[6] e1071包装文件(<em class="ik"> SVM </em>)</p><p id="80b0" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><a class="ae kj" href="https://cran.r-project.org/web/packages/e1071/e1071.pdf" rel="noopener ugc nofollow" target="_blank">r-project.org e1071.pdf</a></p><p id="e79b" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">[7] avNNet软件包文档</p><p id="ea90" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><a class="ae kj" href="https://www.rdocumentation.org/packages/caret/versions/6.0-86/topics/avNNet" rel="noopener ugc nofollow" target="_blank"> avNNet函数| R文档</a></p><p id="0fee" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">[8]预测功能文档</p><p id="24aa" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><a class="ae kj" href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/predict" rel="noopener ugc nofollow" target="_blank">预测函数| R文档</a></p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kk"><img src="../Images/b3178a300294fd3d63c9623d04b655f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/0*kyWjqiYZKUvss8tP.jpg"/></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">图9:封面图片</figcaption></figure></div></div>    
</body>
</html>