<html>
<head>
<title>How well can Machine Learning models predict the price of Bitcoin?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习模型能多好地预测比特币的价格？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-well-can-machine-learning-models-predict-the-price-of-bitcoin-f036fdecdc03?source=collection_archive---------0-----------------------#2021-05-08">https://medium.com/analytics-vidhya/how-well-can-machine-learning-models-predict-the-price-of-bitcoin-f036fdecdc03?source=collection_archive---------0-----------------------#2021-05-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="e241" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">通过Python中的ARIMA、XGBoost、Prophet和LSTM模型预测比特币价格</h2></div><h2 id="b216" class="iw ix hh bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">介绍</h2><p id="420d" class="pw-post-body-paragraph ju jv hh jw b jx jy ii jz ka kb il kc jh kd ke kf jl kg kh ki jp kj kk kl km ha bi translated">随着越来越多的人/组织开始采用加密货币比特币，比特币继续成为世界头条新闻，并越来越受欢迎。在本文中，我将测试Python中4种不同机器学习模型的比特币预测能力:ARIMA、预言家、XGBoost和LSTM。通过将数据分成测试和训练集，我将比较每个模型的性能，并得出哪个性能最好的结论。这里是<a class="ae kn" href="https://github.com/AaronFlore/Forecasting_BitcoinPrices" rel="noopener ugc nofollow" target="_blank"> Github库</a>。</p><h2 id="cc2c" class="iw ix hh bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">探索性数据分析</h2><p id="b4aa" class="pw-post-body-paragraph ju jv hh jw b jx jy ii jz ka kb il kc jh kd ke kf jl kg kh ki jp kj kk kl km ha bi translated">虽然几个月前我已经在我的上一篇媒体文章<a class="ae kn" rel="noopener" href="/analytics-vidhya/day-trading-bitcoin-an-exploratory-analysis-using-historical-bitcoin-data-c0865383ebf5">日交易比特币:使用历史比特币数据的探索性分析</a>中探索和分析了这个<a class="ae kn" href="https://www.kaggle.com/mczielinski/bitcoin-historical-data" rel="noopener ugc nofollow" target="_blank">比特币数据集</a>，但我确实想调整我将用来训练各种模型的数据。我没有使用2012年1月至2021年3月的所有比特币数据，而是决定将数据限制在最近4年，因为这是比特币价格开始波动和变得不稳定的时候。</p><p id="2963" class="pw-post-body-paragraph ju jv hh jw b jx ko ii jz ka kp il kc jh kq ke kf jl kr kh ki jp ks kk kl km ha bi translated">我使用了下面的比特币价格数据(图1)。然而，接下来我需要为我的训练和测试数据决定一个数据分割。由于价格在2021年1月飙升如此之高，我知道这些模型不会准确预测这种发展。因此，我决定将培训和测试分成70%和30%。这30%的分割允许模型在不可预测的峰值之前预测大量的值。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es kt"><img src="../Images/0e54373169d2d52db877e04ed4ebba97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j1jN2KhQ9J2fu4rt9bIFxg.png"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx translated">图1 —比特币价格，从2021年3月开始的过去4年</figcaption></figure><h2 id="85ca" class="iw ix hh bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">测试模型的标准化程序</h2><p id="cb72" class="pw-post-body-paragraph ju jv hh jw b jx jy ii jz ka kb il kc jh kd ke kf jl kg kh ki jp kj kk kl km ha bi translated">正如我刚才所说的，每个模型将在时间序列的前70%进行训练，然后在剩余的30% (439天)根据其预测值进行测试。我将使用每个模型测试的均方根误差(RMSE)来确定最佳模型。RMSE是残差的标准差，或者更简单地说，是残差的分布程度。</p><h2 id="43a7" class="iw ix hh bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">基线RMSE:滚动预测ARIMA模型</h2><p id="494d" class="pw-post-body-paragraph ju jv hh jw b jx jy ii jz ka kb il kc jh kd ke kf jl kg kh ki jp kj kk kl km ha bi translated">我首先创建了一个滚动预测ARIMA模型，以获得一个伟大的RMSE是什么的基线。然而，由于这个模型预测的是每天滚动的增量，因此与其他模型进行比较是不公平的。如下图所示(图2)，预测用红色表示，实际价格用蓝色表示。然而，我们必须放大更多才能区分这两者。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lj"><img src="../Images/186f56cc1694db32ec59dd6b31fd896b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y7RnED32XxHmKIEl8kCRSQ.png"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx translated">图2-最近439天的滚动ARIMA预测</figcaption></figure><p id="ed16" class="pw-post-body-paragraph ju jv hh jw b jx ko ii jz ka kp il kc jh kq ke kf jl kr kh ki jp ks kk kl km ha bi translated">一旦放大到过去50天(图3)，模型的日复一日的滞后是清晰可见的。这个模型产生了一个RMSE: 914.737，它向我们表明了一个好的RMSE是什么样子的，以及我们在其他模型中应该以什么为目标。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lk"><img src="../Images/e7c6f96ac83e70860678510d2ddeeebc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FK26be1qDYPTL_KcQxXN-A.png"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx translated">图3-最近50天的滚动ARIMA预测</figcaption></figure><h2 id="4f99" class="iw ix hh bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">1.先知模型</h2><p id="3f15" class="pw-post-body-paragraph ju jv hh jw b jx jy ii jz ka kb il kc jh kd ke kf jl kg kh ki jp kj kk kl km ha bi translated">Prophet library是一个由脸书开发的开源库，旨在自动预测时间序列数据。这个模型主要侧重于预测趋势和季节性。然而，由于它的易用性，我决定先用默认设置实现这个模型。如下图(图4)先知模型预测比特币价格会下跌。此外，该模型还提供了上限和下限估计(阴影区域的边缘)。虽然上限估计具有精确的斜率方向，但与测试数据相比，该模型表现不佳。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es ll"><img src="../Images/31ae58ddaed5278b86b2fbf08e842849.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C6EmmTHARtXUDlnI0WSK1A.png"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx translated">图4 —预言者预测，包括上限和下限(阴影)</figcaption></figure><p id="c914" class="pw-post-body-paragraph ju jv hh jw b jx ko ii jz ka kp il kc jh kq ke kf jl kr kh ki jp ks kk kl km ha bi translated">蓝色是实际测试数据与红色预测数据的对比(图5)。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lm"><img src="../Images/6f6616d136c617f2a1056545ca723460.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uo4_gqitHvxMZO6M9H3ETg.png"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx translated">图5 —与实际测试数据相比的Prophet模型</figcaption></figure><p id="0699" class="pw-post-body-paragraph ju jv hh jw b jx ko ii jz ka kp il kc jh kq ke kf jl kr kh ki jp ks kk kl km ha bi translated">很明显，该模型没有很好地预测RMSE: 24810.845。</p><h2 id="99b8" class="iw ix hh bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">2.ARIMA模型</h2><p id="d278" class="pw-post-body-paragraph ju jv hh jw b jx jy ii jz ka kb il kc jh kd ke kf jl kg kh ki jp kj kk kl km ha bi translated">接下来是ARIMA，首字母缩写代表自回归综合移动平均线。ARIMA是一种广泛用于分析和预测时间序列数据的统计方法。它由时间序列数据中的一套标准结构组成，并提供了一种简单而强大的方法来进行熟练的时间序列预测。ARIMA模型有3个参数(p，d，q ),表示使用的特定ARIMA模型。我只是简单地应用了我过去在不同时间序列数据上使用的参数，这可能会导致一个不利的模型(图6)。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es ln"><img src="../Images/e0288421e54e3d1f6e14337ca8593361.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZW7Slg4f5-ijAejaJYnuxg.png"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx translated">图6 — ARIMA价格预测与实际价格对比</figcaption></figure><p id="408b" class="pw-post-body-paragraph ju jv hh jw b jx ko ii jz ka kp il kc jh kq ke kf jl kr kh ki jp ks kk kl km ha bi translated">如果我不得不重做这个实验，我肯定会对数据进行更适当的探索，以便计算出p、d、q参数。然而，在完成LTSM模型后，我不认为对ARIMA的任何调整会允许像LTSM这样低的RMSE。这款ARIMA车型的最终RMSE是19633.653。</p><h2 id="541d" class="iw ix hh bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">3.LTSM模型</h2><p id="5df1" class="pw-post-body-paragraph ju jv hh jw b jx jy ii jz ka kb il kc jh kd ke kf jl kg kh ki jp kj kk kl km ha bi translated">长短期记忆(LSTM)模型是一种能够学习观察序列的递归神经网络。这使得它们成为非常适合时间序列预测的深度学习网络。然而，通常情况下，LTSM会与像比特币一样不稳定和不可预测的时间序列数据集进行斗争。在尝试应用我的数据的艰苦过程之后，我终于训练了这个模型。在我的最终拟合中，我使用了50个历元和“亚当”优化器。下图是模型预测与实际测试数据价格的对比。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lo"><img src="../Images/8242bacddba563a49364a4ba5e9e1ad2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-BC94rNkQ_k85Fcei_UP9g.png"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx translated">图7 — LTSM预测与实际价格</figcaption></figure><p id="1e30" class="pw-post-body-paragraph ju jv hh jw b jx ko ii jz ka kp il kc jh kq ke kf jl kr kh ki jp ks kk kl km ha bi translated">这是RMSE最成功的模型:8950.128</p><h2 id="fa6a" class="iw ix hh bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">4.XGBOOST型号:</h2><p id="9328" class="pw-post-body-paragraph ju jv hh jw b jx jy ii jz ka kb il kc jh kd ke kf jl kg kh ki jp kj kk kl km ha bi translated">XGBoost是目前最流行的机器学习算法之一。不管手头的预测任务的类型如何；回归，或者说分类。众所周知，XGBoost提供了比其他机器学习算法更好的解决方案。事实上，自诞生以来，它已经成为处理结构化数据的“最先进”的机器学习算法。但是，在这种情况下，我们将对时间序列数据使用它。因此，该模型需要从日期时间索引中创建时间序列特征，以便在预测时与其目标价格标签一起使用。不幸的是，最终这个模型并不公平。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lp"><img src="../Images/5af1bf4332ca358852c6266ace358bb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lZrBtpt1-GcrhAmg0Vc1rQ.png"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx translated">图8 — XGBoost模型</figcaption></figure><p id="4a80" class="pw-post-body-paragraph ju jv hh jw b jx ko ii jz ka kp il kc jh kq ke kf jl kr kh ki jp ks kk kl km ha bi translated">同样，这可能是因为参数选择不当，或者只是因为XGBoost模型不是专门针对时间序列的。然而，我相信LTSM模式已被证明具有最低的RMSE，因此是最好的。XGBoost的最终RMSE是18483.212。</p><h2 id="721b" class="iw ix hh bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">比较和结果</h2><p id="f0ef" class="pw-post-body-paragraph ju jv hh jw b jx jy ii jz ka kb il kc jh kd ke kf jl kg kh ki jp kj kk kl km ha bi translated">实验的最终结果如下图9所示。事实证明，长短期记忆模型在处理比特币价格等不稳定且难以预测的数据时最为有效。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lq"><img src="../Images/30e79d1ecc37ea7da54be47756e484d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OcrVXV8Vb2gBSNAy8j91Tw.png"/></div></div><figcaption class="lf lg et er es lh li bd b be z dx translated">图9 —最终的RMSE模型结果</figcaption></figure><h2 id="0498" class="iw ix hh bd iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">结论</h2><p id="7a85" class="pw-post-body-paragraph ju jv hh jw b jx jy ii jz ka kb il kc jh kd ke kf jl kg kh ki jp kj kk kl km ha bi translated">这个比特币数据集由极其不稳定和异常的时间序列数据组成。因此，我毫不惊讶地发现，模型很难预测最近439天的价格。此外，我承认我可以为这些模型和库选择更好、更明智的参数，以使结果更加公平。然而，我认为LSTM模型的低RMSE证明了神经网络在机器学习中的强大。我很想在未来更多地探索RNN的金融时间序列数据！</p><p id="4b9a" class="pw-post-body-paragraph ju jv hh jw b jx ko ii jz ka kp il kc jh kq ke kf jl kr kh ki jp ks kk kl km ha bi translated">感谢阅读！</p></div></div>    
</body>
</html>