<html>
<head>
<title>LASSO REGRESSION MODEL FOR PREDICTING GDP USING MACROECONOMIC VARIABLES</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用宏观经济变量预测GDP的LASSO回归模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/multiple-regression-model-for-predicting-gdp-using-macroeconomic-variables-part-2-59996c61b862?source=collection_archive---------4-----------------------#2021-08-09">https://medium.com/analytics-vidhya/multiple-regression-model-for-predicting-gdp-using-macroeconomic-variables-part-2-59996c61b862?source=collection_archive---------4-----------------------#2021-08-09</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/b86bc7e86536ea3c1600e2d86f4cf8b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*yLic6gq_YWuvHDANP87KKQ.jpeg"/></div><figcaption class="il im et er es in io bd b be z dx translated">来源:https://www.nxtmine.com/</figcaption></figure><h1 id="e8de" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">简介</strong></h1><p id="2a23" class="pw-post-body-paragraph jo jp hh jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ha bi translated">幸运的是，使用机器学习(ML)算法来检测与驱动业务的变量相关的模式的能力，使其在预测与业务决策相关的风险因素方面非常有用。我们的兴趣是识别和评估宏观经济变量对GDP的影响。这个项目的这一部分侧重于使用机器学习方法，通过宏观经济变量来预测GDP。这是<a class="ae ip" rel="noopener" href="/@msamiyu2/multiple-regression-model-for-predicting-gdp-using-macroeconomic-variables-part-1-7bfef9a527e3">第一部分</a>的延续，在第一部分中，我们使用多元线性回归模型预测了六个预测值的GDP，增加了两个新的宏观经济变量，以观察每个变量在p值、r平方和调整后r平方方面对基础模型拟合的敏感性。根据为研究设置的阈值(VIF &gt; 2 ),观察到的方差膨胀因子(VIF)显示了某种程度的多重共线性。因此，在本次会议中，我们有兴趣使用正则化回归模型(Lasso Regression)，一种机器学习方法来处理这一点。Lasso回归向残差平方和添加了收缩惩罚，由于多重共线性，通过强制回归系数为零来移除某些预测变量。随机森林技术主要像套索模型一样进行特征选择，但我们更感兴趣的是对观察到的宏观经济变量的解释和预测。</p><h1 id="3c54" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">数据预处理</strong></h1><p id="db4e" class="pw-post-body-paragraph jo jp hh jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ha bi translated">数据:宏观经济变量(美国经济分析局)</p><p id="24a1" class="pw-post-body-paragraph jo jp hh jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl ha bi translated">来源:<a class="ae ip" href="https://fred.stlouisfed.org/series" rel="noopener ugc nofollow" target="_blank">宏观经济变量——FRED</a>(合并到excel表格中的变量——转换为年度百分比:28列272行)。</p><p id="2da6" class="pw-post-body-paragraph jo jp hh jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl ha bi translated">将数据集分为训练(70%)和测试(30%)后，缺失值通过使用R中的“mice包”进行插补来单独处理。为缺失值创建一个数据框，然后“mice包”对缺失数据进行插补，以确保不再有任何缺失数据(参见<a class="ae ip" href="https://github.com/msamiyu/MULTIPLE-REGRESSION-MODEL-FOR-PREDICTING-GDP-USING-MACROECONOMIC-VARIABLES-PART-2" rel="noopener ugc nofollow" target="_blank"> GitHub </a>中的R代码)。</p><h1 id="0114" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">测量</strong></h1><p id="e464" class="pw-post-body-paragraph jo jp hh jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ha bi translated"><strong class="jq hi">因变量</strong>:国内生产总值(GDP)——年百分比(GDP。美联社)</p><p id="231b" class="pw-post-body-paragraph jo jp hh jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl ha bi translated"><strong class="jq hi">自变量</strong>:人口比率(POPTHM) —年百分比(POPTHM。美联社)</p><p id="fd93" class="pw-post-body-paragraph jo jp hh jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl ha bi translated">利率(INTDSRUSM193) —年百分比(INTDSRUSM193。美联社)</p><p id="c9fc" class="pw-post-body-paragraph jo jp hh jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl ha bi translated">10年期国债固定到期利率(DGS10) —年百分比(DGS10。美联社)</p><p id="5193" class="pw-post-body-paragraph jo jp hh jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl ha bi translated">失业率(U2RATE) —年百分比(U2RATE。美联社)</p><p id="695e" class="pw-post-body-paragraph jo jp hh jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl ha bi translated">所有交易房价指数(USSTHPI)-年百分比(USSTHPI。美联社)</p><p id="227e" class="pw-post-body-paragraph jo jp hh jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl ha bi translated">公司税后利润(CP) —年百分比(CP。美联社)</p><p id="db79" class="pw-post-body-paragraph jo jp hh jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl ha bi translated">10年盈亏平衡通货膨胀率(T10YIE) —年百分比(T10YIE。美联社)</p><h1 id="1e3f" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">功能选择</strong></h1><p id="fc05" class="pw-post-body-paragraph jo jp hh jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ha bi translated">自变量或预测值由其他宏观经济变量组成，即人口率、利率、国债固定到期率、失业率、房价指数、企业利润和通货膨胀率，而因变量是国内生产总值，每个变量都转换为年度百分比。</p><p id="714f" class="pw-post-body-paragraph jo jp hh jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl ha bi translated"><strong class="jq hi">模型:</strong>套索回归模型的形式为:</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es kr"><img src="../Images/dd3c1ff225e68fd6b1c0b25a671c53f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eOe3WMz0mgO9zTilu3wOsA.png"/></div></div></figure><p id="d1fd" class="pw-post-body-paragraph jo jp hh jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl ha bi translated"><strong class="jq hi">注:</strong></p><ul class=""><li id="763a" class="la lb hh jq b jr km jv kn jz lc kd ld kh le kl lf lg lh li bi translated">调整超参数以获得用于构建Lasso回归模型的最佳lambda值。</li><li id="34c1" class="la lb hh jq b jr lj jv lk jz ll kd lm kh ln kl lf lg lh li bi translated">R中用于计算最佳λ的“glmnet”库默认使用alpha来表示上面(1)中的λ。</li><li id="2424" class="la lb hh jq b jr lj jv lk jz ll kd lm kh ln kl lf lg lh li bi translated">对于Lasso回归，出于“glmnet”库计算的目的，alpha设置为1。</li></ul><h1 id="1d32" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">模型验证</strong></h1><p id="9e95" class="pw-post-body-paragraph jo jp hh jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ha bi translated">● <strong class="jq hi">交叉验证(CV): </strong>数据集分为训练集(原始数据的70%)和测试集(30%)。该模型在训练集上进行训练，然后在测试集上进行测试。为了确保原始数据集中的每个观察/记录都可以出现在训练和测试集中，我们应用了<strong class="jq hi"> K-Fold CV </strong>。</p><h1 id="c106" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">车型性能</strong></h1><p id="7a00" class="pw-post-body-paragraph jo jp hh jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ha bi translated">模型的性能应基于以下指标:</p><p id="8295" class="pw-post-body-paragraph jo jp hh jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl ha bi translated">●<strong class="jq hi">R-Square</strong>-它是一种相对拟合度，显示了模型中的方差与总方差的对应关系。较高的R-Square表明更适合我们的回归模型。</p><p id="7e56" class="pw-post-body-paragraph jo jp hh jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl ha bi translated">● <strong class="jq hi"> RMSE(均方根误差)</strong> —这是一种绝对的拟合度量，显示了模型无法解释的方差的标准偏差。较低的RMSE表明更适合我们的回归模型。</p><h1 id="9e00" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">结果</strong></h1><ul class=""><li id="7a2b" class="la lb hh jq b jr js jv jw jz lo kd lp kh lq kl lf lg lh li bi translated"><strong class="jq hi">最优λ</strong>:对列车数据进行10重交叉验证后，得到的最小均方误差(MSE)的最优λ值为:</li></ul><figure class="ks kt ku kv fd ii er es paragraph-image"><div class="er es lr"><img src="../Images/2006cdb56c29cc3804322a12b3ee6ed9.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*8zorJ8UhpZLdpXR1-vV3qA.png"/></div></figure><p id="f154" class="pw-post-body-paragraph jo jp hh jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl ha bi translated">最佳值的列车MSE图如下所示；</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es ls"><img src="../Images/db4f72597d383085db1722b04fd44de0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GvgGq8jXlvWyTkO9Rk7t6Q.png"/></div></div></figure><ul class=""><li id="33d1" class="la lb hh jq b jr km jv kn jz lc kd ld kh le kl lf lg lh li bi translated"><strong class="jq hi">重要的独立变量</strong>:下面的输出显示了对预测更重要的独立变量(显示的值)以及那些系数将被缩减的变量，Lasso模型将移除它们的预测值。输出显示利率(INTDSRUSM193)和通货膨胀率(T10YIE)变量被Lasso模型收缩和去除。</li></ul><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="er es lt"><img src="../Images/58b68ca99c1754d9ebd37d58219abf6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9duKaJQ5mZ2NQgaq7jszUg.png"/></div></div></figure><p id="6a86" class="pw-post-body-paragraph jo jp hh jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl ha bi translated"><strong class="jq hi">车型性能</strong></p><ul class=""><li id="f943" class="la lb hh jq b jr km jv kn jz lc kd ld kh le kl lf lg lh li bi translated"><strong class="jq hi">列车数据:</strong></li></ul><figure class="ks kt ku kv fd ii er es paragraph-image"><div class="er es lu"><img src="../Images/48ecfcf2715db01700186b7a7ff24211.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*OPuwLAVpSjtvDoNutWhd-A.png"/></div></figure><p id="1388" class="pw-post-body-paragraph jo jp hh jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl ha bi translated">从上面的输出中，r平方(88.8%)显示，我们训练的宏观经济数据中约有89%符合Lasso回归模型。而RMSE (0.0114)表明约1.1%的方差无法用我们的模型解释。</p><ul class=""><li id="7a76" class="la lb hh jq b jr km jv kn jz lc kd ld kh le kl lf lg lh li bi translated"><strong class="jq hi">测试数据:</strong></li></ul><figure class="ks kt ku kv fd ii er es paragraph-image"><div class="er es lv"><img src="../Images/05132d43355968deac990dadd068bf73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*qtcP5AyVnZA8_DcOE_xAUQ.png"/></div></figure><p id="20a0" class="pw-post-body-paragraph jo jp hh jq b jr km jt ju jv kn jx jy jz ko kb kc kd kp kf kg kh kq kj kk kl ha bi translated">从上面的输出中，r平方(73.2%)表明，我们的测试宏观经济数据中约有73%符合Lasso回归模型。而RMSE (0.018)表明约1.2%的方差无法用我们的模型解释。</p><h1 id="bec6" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">结论</strong></h1><p id="c573" class="pw-post-body-paragraph jo jp hh jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ha bi translated">在这篇短文中，我们研究了如何使用其他宏观经济变量来预测GDP。为了实现这一目标，我们使用套索回归技术扩展了本文第一部分的<a class="ae ip" rel="noopener" href="/@msamiyu2/multiple-regression-model-for-predicting-gdp-using-macroeconomic-variables-part-1-7bfef9a527e3">中开发的模型，通过在5%的显著性水平上比较VIF值和p值来评估每个额外变量如何影响我们的回归拟合。Lasso回归模型似乎是一种合适的正则化技术，它通过将一些参数强制为零来帮助克服线性回归基础模型中的多重共线性效应，并帮助我们进行要素选择。获得的r平方似乎更可靠，训练和测试数据的RMSE给出了最小的预测误差。它还可以防止普通回归模型输出中可能出现的过度拟合。相比之下，机器学习方法有助于预测准确性。</a></p><h1 id="d05d" class="iq ir hh bd is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn bi translated"><strong class="ak">参考文献</strong></h1><ul class=""><li id="12cf" class="la lb hh jq b jr js jv jw jz lo kd lp kh lq kl lf lg lh li bi translated">弗雷德经济数据:<a class="ae ip" href="https://fred.stlouisfed.org/series" rel="noopener ugc nofollow" target="_blank">数据来源</a></li><li id="d266" class="la lb hh jq b jr lj jv lk jz ll kd lm kh ln kl lf lg lh li bi translated">Deepika Singh: <strong class="jq hi"> </strong> <a class="ae ip" href="https://www.pluralsight.com/guides/linear-lasso-and-ridge-regression-with-r" rel="noopener ugc nofollow" target="_blank">线性，套索和，带R的脊回归</a></li><li id="c318" class="la lb hh jq b jr lj jv lk jz ll kd lm kh ln kl lf lg lh li bi translated">作者的GitHub: <a class="ae ip" href="https://github.com/msamiyu/MULTIPLE-REGRESSION-MODEL-FOR-PREDICTING-GDP-USING-MACROECONOMIC-VARIABLES-PART-2" rel="noopener ugc nofollow" target="_blank"> GitHub </a></li></ul></div></div>    
</body>
</html>