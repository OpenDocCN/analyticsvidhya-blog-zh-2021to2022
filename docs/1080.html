<html>
<head>
<title>Demystifying GANS and implementation of DCGANS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">揭开GANS的神秘面纱并实现DCGANS</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/demystifying-gans-and-implementation-of-dcgans-5e2f30619d8?source=collection_archive---------8-----------------------#2021-02-13">https://medium.com/analytics-vidhya/demystifying-gans-and-implementation-of-dcgans-5e2f30619d8?source=collection_archive---------8-----------------------#2021-02-13</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/25a9a4e3a454e3e4cdb282740c8c6f00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*9p3vCVmRHY5QoPQM98Kx0A.gif"/></div><figcaption class="il im et er es in io bd b be z dx translated">学分:gif.com</figcaption></figure><p id="514c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，如果你在机器学习社区有点活跃，你应该已经听说过<strong class="ir hi"> GANS </strong>(生成对抗网络)</p><h2 id="2ad1" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">GANS到底是什么？</h2><p id="e9d2" class="pw-post-body-paragraph ip iq hh ir b is ki iu iv iw kj iy iz ja kk jc jd je kl jg jh ji km jk jl jm ha bi translated">简而言之，GANS让两个神经网络互相竞争，我知道我对上面的陈述没有说清楚，所以让我给你打个比方。</p><p id="4d00" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们考虑伪造者和调查者之间的关系</p><figure class="kn ko kp kq fd ii er es paragraph-image"><div class="er es ie"><img src="../Images/ec9a9863ee42c7c17d795345273f8845.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*W7uMlJEyX53N3VcnT0P_vw.jpeg"/></div><figcaption class="il im et er es in io bd b be z dx translated">学分:everydaysigth.com</figcaption></figure><p id="9ae0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">伪造者的任务是创作著名艺术家原画的赝品。如果这件赝品能冒充真品，伪造者就能从这件赝品中获得一大笔钱。</p><p id="2b16" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">另一方面，艺术调查员的任务是抓住这些制造赝品的伪造者。他是怎么做到的？他知道是什么让原创艺术家与众不同，以及他应该创作什么样的画。他用手中的作品评估这些知识，以检查它是真是假。</p><p id="0d31" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">伪造者与调查者之间的竞赛仍在继续，最终造就了世界级的调查者(不幸的是，也造就了世界级的伪造者)。</p><p id="ed11" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在你可能想知道它和GANS有什么关系？GANS以类似的方式工作，其中<strong class="ir hi">生成器</strong>(伪造者)负责创建假数据(图像)，而<strong class="ir hi">鉴别器</strong>(调查者)负责查看数据并移除假数据，以及向生成器提供必要的反馈以创建更好的图像。</p><figure class="kn ko kp kq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es kr"><img src="../Images/430bf76b55390185b86b991c766329d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*53O0o5C1BuukH6V3wLXSzg.png"/></div></div><figcaption class="il im et er es in io bd b be z dx translated">信用TDS</figcaption></figure><p id="af0e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">生成器神经网络将随机噪声作为输入来生成一些图像，这些图像与一些真实图像混合并发送给鉴别器，鉴别器网络的任务是从真实数据或生成器中获取输入，并尝试预测该输入是真实的还是生成的。</p><p id="be70" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们在尝试实现一个基本的<strong class="ir hi"> DCGANS </strong>(深度卷积GANS)的同时，尝试了解一下技术细节</p><p id="c8c5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">深度卷积GAN (DCGAN)是演示如何构建实用GAN的模型之一，该GAN可以自学如何合成新图像。DCGAN非常类似于GAN，但它特别关注使用深度卷积网络来代替全连接网络。</p><h2 id="99b3" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">DCGAN实施</h2><p id="ca10" class="pw-post-body-paragraph ip iq hh ir b is ki iu iv iw kj iy iz ja kk jc jd je kl jg jh ji km jk jl jm ha bi translated">现在让我们尝试使用<strong class="ir hi"> mnist_dataset来实现DCGANs。</strong></p><h2 id="7a52" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">导入库</h2><p id="3a05" class="pw-post-body-paragraph ip iq hh ir b is ki iu iv iw kj iy iz ja kk jc jd je kl jg jh ji km jk jl jm ha bi translated">我们将使用<a class="ae kx" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"><strong class="ir hi">tensor flow 2.0</strong></a>来实现DCGAN，我们将使用以下层:<strong class="ir hi"> Dense </strong>、<strong class="ir hi"> Conv2D </strong>和<strong class="ir hi"> Conv2DTranspose </strong>。我们将使用<strong class="ir hi"> RMSprop </strong>作为模型和绘图的优化器，我使用了matplotlib库。</p><figure class="kn ko kp kq fd ii"><div class="bz dy l di"><div class="ky kz l"/></div></figure><h2 id="cd68" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">生成器神经网络</h2><figure class="kn ko kp kq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es la"><img src="../Images/e7bf4f406989e9158b2263f07767d784.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P4O02XAw3_Mbq-WBavCvOw.jpeg"/></div></div><figcaption class="il im et er es in io bd b be z dx translated">学分:<a class="ae kx" href="https://www.mygreatlearning.com/blog/generative-adversarial-networks-gans/" rel="noopener ugc nofollow" target="_blank">https://www . mygreatlearning . com/blog/generative-adversarial-networks-gans/</a></figcaption></figure><p id="9501" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">正如我们从上面的图像中看到的，生成器首先将随机噪声作为输入，在DCGANS中，我们使用<strong class="ir hi"> Conv2DTranspose </strong>对其进行解卷积，并生成虚假数据，然后将这些数据与鉴别器进行比较，我们在构建这个模型时使用了函数方法，如果您对函数方法的确切含义感到困惑，可以参考我以前的博客<a class="ae kx" rel="noopener" href="/analytics-vidhya/functional-api-model-with-tensorflow-2-0-y-network-ed59bfd810">T5这里T7】</a></p><figure class="kn ko kp kq fd ii"><div class="bz dy l di"><div class="ky kz l"/></div></figure><p id="e032" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在上面的生成器网络中，我们首先对数据进行整形，在滤波器[128，64，32，1]中，我们增加步长，然后使用<strong class="ir hi"> Conv2DTranspose </strong>将其转换为图像输出并返回生成器模型。</p><h2 id="aba7" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">鉴别器神经网络</h2><figure class="kn ko kp kq fd ii er es paragraph-image"><div class="er es lb"><img src="../Images/ea4435487fb205d428ac13b3a85b461b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*TxWHTlzVQwcgsp6t5bHbng.jpeg"/></div><figcaption class="il im et er es in io bd b be z dx translated">演职员表:<a class="ae kx" href="https://robotronblog.com/2017/09/05/gans/" rel="noopener ugc nofollow" target="_blank">https://robotronblog.com/2017/09/05/gans/</a></figcaption></figure><p id="de92" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，让我们尝试构建模型的鉴别器部分，它充当调查器，将真实图像标记为1.0，将生成器神经网络生成的伪图像标记为0.0。<strong class="ir hi"> Sigmoid </strong>激活函数用于在该模型中区分真假图像。</p><figure class="kn ko kp kq fd ii"><div class="bz dy l di"><div class="ky kz l"/></div></figure><p id="b06e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在鉴别器模型中，我们使用了<strong class="ir hi"> Conv2D </strong>层来捕捉图像中的特征，由于我们使用了<strong class="ir hi"> Sigmoid </strong>作为激活函数，输出将为0.0(假)或1.0(真)。</p><h2 id="a34f" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">训练GAN模型</h2><figure class="kn ko kp kq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es lc"><img src="../Images/870c6da79a181837ec591235ec9effbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uo-nTi9hiiOW-86UHbSnMQ.png"/></div></div><figcaption class="il im et er es in io bd b be z dx translated">学分:机器学习掌握</figcaption></figure><p id="9680" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在让我们分批交替训练<strong class="ir hi">鉴别器</strong>和<strong class="ir hi">对抗</strong>网络，首先用真实和虚假图像训练鉴别器，然后用伪装成真实的虚假图像训练对抗网络，最后我们用来自鉴别器的反馈每500个间隔产生虚假图像。</p><blockquote class="ld le lf"><p id="9e56" class="ip iq kw ir b is it iu iv iw ix iy iz lg jb jc jd lh jf jg jh li jj jk jl jm ha bi translated">记住要稳定GAN，并确保发生器学到一些东西，鉴别器应该比发生器更强大(训练有素),只有这样它才能向发生器发送有价值的反馈，从中学习并创建更好的假图像</p></blockquote><figure class="kn ko kp kq fd ii"><div class="bz dy l di"><div class="ky kz l"/></div></figure><p id="1e3d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在上面的训练函数中，我们使用随机噪声生成假图像，然后将这些假图像添加到真实数据中，然后我们用这些数据训练鉴别器，其中将真实图像标记为1，将假图像标记为0，我们将训练它并存储它的损失和准确性。</p><p id="5db7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在训练鉴别器之后，我们将训练对抗网络，其中假图像被标记为1.0，并且在训练对抗网络时，鉴别器权重被冻结，并且仅训练生成器，并且我们将创建用于绘制生成器神经网络已经生成的图像的函数，并且我们还为每500个时间步长保存该当前模型。</p><h2 id="c55f" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">绘制发电机图像</h2><figure class="kn ko kp kq fd ii er es paragraph-image"><div class="er es lj"><img src="../Images/11aa7302549c9f299b81a72c0d08d0c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*cz8x4cK9nJ8jwU7h9Qj93A.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">18000个历元时生成的图像</figcaption></figure><p id="85bc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在让我们创建一个函数，它绘制生成的图像，并以每500个时间步长保存它们</p><figure class="kn ko kp kq fd ii"><div class="bz dy l di"><div class="ky kz l"/></div></figure><p id="c2ac" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在上面的函数中，我们创建了一个图像网格，其中生成器尝试使用噪声和来自鉴别器的反馈来重新创建图像，我们将所有这些图像存储在一个名为<em class="kw"> GAN_mnist </em>的文件夹中</p><h2 id="f9da" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">构建和训练模型</h2><figure class="kn ko kp kq fd ii er es paragraph-image"><div class="er es lk"><img src="../Images/fd93c2689047dc946d5dc23193c5c5b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*FJ-e6cxeaxhMb1guaHbTvA.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">40000个历元时生成的图像</figcaption></figure><p id="f5b0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因为我们已经为生成器和鉴别器创建了函数，所以让我们尝试构建和训练所有的网络</p><figure class="kn ko kp kq fd ii"><div class="bz dy l di"><div class="ky kz l"/></div></figure><p id="92e0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们正在加载Mnist_dataset，然后首先训练模型的鉴别器部分(正如我在上面提到的DCGAN模型的稳定性和进展),然后我们从生成器中提取噪声来生成图像</p><p id="a70a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">对抗网络=生成器+鉴别器</strong>，在训练对抗网络时我们冻结了鉴别器的权重，之后我们编译了对抗网络，其中我们使用了<em class="kw">二元交叉熵</em>作为损失函数。</p><h2 id="d8c3" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">运行DCGAN</h2><p id="3eec" class="pw-post-body-paragraph ip iq hh ir b is ki iu iv iw kj iy iz ja kk jc jd je kl jg jh ji km jk jl jm ha bi translated">现在让我们运行模型</p><figure class="kn ko kp kq fd ii"><div class="bz dy l di"><div class="ky kz l"/></div></figure><p id="da98" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">上面的代码首先检查你是否有预先训练好的保存模型，如果有，它从那里继续训练，如果没有，它重新开始</p><p id="2676" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这是我在训练mnist DCGANS时得到的结果</p><figure class="kn ko kp kq fd ii er es paragraph-image"><div class="er es lj"><img src="../Images/454e9d96dea9664dddb85fda9c00c91a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*jDWWQAo0lu2HGbs_pU3Fow.gif"/></div><figcaption class="il im et er es in io bd b be z dx translated">这是40000个时代中生成图像变化的视频</figcaption></figure><p id="cd95" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">结束(至少现在)</p><p id="582b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你可以从<a class="ae kx" href="https://github.com/Pavankunchala/Deep-Learning/blob/master/Tensorflow_Basics/GANS/DCGANS/dcGans_mnist.py" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">这里</strong> </a>找到博客的代码</p><p id="228c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> PS </strong>:如果你有任何疑问，你可以给我发邮件<a class="ae kx" href="http://pavankunchalapk@gmail.com/" rel="noopener ugc nofollow" target="_blank">这里</a> (pavankunchalapk@gmail.com)，你可以在我的linkedin上联系我，从<a class="ae kx" href="https://www.linkedin.com/in/pavan-kumar-reddy-kunchala/" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">这里</strong> </a> <strong class="ir hi"> </strong>你也可以在我的Github上查看我的其他代码(它有非常酷的东西)，从<a class="ae kx" href="https://github.com/Pavankunchala" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">这里</strong> </a></p><p id="f9d5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我也在寻找深度学习和计算机视觉领域的自由职业机会，如果你愿意合作，请在这里给我发邮件(<a class="ae kx" href="mailto:pavankunchalapk@gmail.com" rel="noopener ugc nofollow" target="_blank">pavankunchalapk@gmail.com</a></p><p id="5ee7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">祝你有美好的一天！</p></div></div>    
</body>
</html>