<html>
<head>
<title>CUSTOMIZED DATA GENERATOR IN KERAS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">KERAS中的定制数据生成器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/customized-data-generator-in-keras-29a8912760ac?source=collection_archive---------27-----------------------#2021-02-22">https://medium.com/analytics-vidhya/customized-data-generator-in-keras-29a8912760ac?source=collection_archive---------27-----------------------#2021-02-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/1aec21c828fcab9d02f69659cb43604a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MHkJLwHm5-6wMaO0po5UXw.png"/></div></div></figure><div class=""/><p id="ad1b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据生成器已经成为任何基于深度学习的方法的强制性代码模块。过去，我们曾经一次将整个数据集加载到RAM中，并多次训练我们的分类器，即使在CPU上工作也不会出现任何OOM(内存不足)错误。数据生成器旨在从您的硬盘中检索小批量的数据，并将其提供给每次迭代的训练、测试和验证功能。这有助于避免OOM错误以及系统的突然关闭。Keras的<a class="ae jo" href="https://keras.io/api/preprocessing/image/" rel="noopener ugc nofollow" target="_blank">教程</a>提供了不同的函数来制作你的数据生成器，例如从数据帧读取(<a class="ae jo" href="https://keras.io/api/preprocessing/image/#flowfromdataframe-method" rel="noopener ugc nofollow" target="_blank"> flow_from_dataframe方法</a>)，从目录读取(<a class="ae jo" href="https://keras.io/api/preprocessing/image/#flowfromdirectory-method" rel="noopener ugc nofollow" target="_blank"> flow_from_directory方法</a>)。然而，我们都需要一个可以根据我们的需求定制的数据生成器模块。</p><p id="14d6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">动机</strong></p><p id="0496" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">自定义数据生成器有两个主要方面</p><ol class=""><li id="ede6" class="jp jq ht is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated">数据处理-如何存储您的数据，以便使用数据生成器轻松检索</li><li id="6f16" class="jp jq ht is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">数据发生器功能</li></ol><p id="4521" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在设计我自己的第一个data gen时，我不得不按照我的要求努力匹配这两个方面。我正在研究一个医学领域的分类问题，其中我想针对r.t主题建立训练集、测试集和验证集。浏览了许多教程，我最终设计了自己的数据生成器，记住了上面的两个关键需求，使用了斯坦福的教程和博客</p><p id="d6d5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以让我们开始吧...</p><ol class=""><li id="e237" class="jp jq ht is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated"><strong class="is hu">数据处理:</strong></li></ol><ul class=""><li id="161d" class="jp jq ht is b it iu ix iy jb jr jf js jj jt jn kd jv jw jx bi translated">以您要求的文件格式分别保存每个受试者/样本/即时/观察结果。例:如果我有100个正常类的实例和100个异常类的实例。mat文件，保存为</li></ul><p id="ad05" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1_NOR.mat，2_NOR.mat，100 _ NOR.mat，1_AB.mat，…..，100_AB.mat。</p><ul class=""><li id="b714" class="jp jq ht is b it iu ix iy jb jr jf js jj jt jn kd jv jw jx bi translated">对于分类来说，在用于训练、测试和验证之前预先定义瞬间是无害的。</li><li id="fc33" class="jp jq ht is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated">所以形成一个字典，有关键字<em class="ke">‘训练’【测试】</em>和<em class="ke">‘验证’</em>。在每个键中，保存相应时刻的列表。</li><li id="f4e9" class="jp jq ht is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated">以下代码将帮助您做到这一点</li></ul><figure class="kf kg kh ki fd hk"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="13bf" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.<strong class="is hu">数据发生器模块</strong>:</p><p id="e7da" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是创建一个名为<em class="ke">‘label _ data’</em>的字典，这个字典的关键字将是实例的名称，它们的值将是它们的类标签。下面的代码做同样的事情。</p><figure class="kf kg kh ki fd hk"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="9325" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后是数据生成模块</p><ul class=""><li id="fdfb" class="jp jq ht is b it iu ix iy jb jr jf js jj jt jn kd jv jw jx bi translated">我更喜欢单独的数据生成器用于训练、测试和验证。原因是，对于训练数据生成器，希望生成训练瞬间的随机序列(以便更好地训练模型)，而在验证和测试中没有这样的要求。</li><li id="adb7" class="jp jq ht is b it jy ix jz jb ka jf kb jj kc jn kd jv jw jx bi translated"><em class="ke"> get_input( ) </em>和<em class="ke"> get_output() </em>函数将为训练、测试和验证的数据生成器所共用。这些函数将分别从你的硬盘和相关标签中载入每一个瞬间</li></ul><figure class="kf kg kh ki fd hk"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="f3c0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">验证生成器将与测试生成器相同。对于这个任务，这个代码还可以有其他的即兴创作。例如，在受试者具有多个瞬间的情况下，有必要将受试者的所有瞬间限于训练/测试/验证。在这种情况下，你需要修改'<em class="ke">分区'</em>字典。另一个例子是交叉验证的多次迭代。我希望它能达到目的。通过你的评论让我知道</p></div></div>    
</body>
</html>