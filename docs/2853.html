<html>
<head>
<title>Power up spatial data science workflow with CARTOframes.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用CARTOframes增强空间数据科学工作流程。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/power-up-your-spatial-data-science-workflow-with-cartoframes-8fd1022127a9?source=collection_archive---------5-----------------------#2021-05-20">https://medium.com/analytics-vidhya/power-up-your-spatial-data-science-workflow-with-cartoframes-8fd1022127a9?source=collection_archive---------5-----------------------#2021-05-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/2cf2e1a4053e2ce92c675d5f645fe25a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TFsDjuvZ-b5OD7NGcp6UDg.png"/></div></div></figure><p id="7702" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在本教程中，我们将分析如何通过python使用CARTOframes来构建仪表盘，并与您的观众分享您的见解。</p><h2 id="0d17" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">关于CARTO平台的一些信息，</h2><div class="ki kj ez fb kk kl"><a href="https://docs.carto.com/get-started/#carto-in-a-nutshell" rel="noopener  ugc nofollow" target="_blank"><div class="km ab dw"><div class="kn ab ko cl cj kp"><h2 class="bd hi fi z dy kq ea eb kr ed ef hg bi translated">CARTO入门</h2><div class="ks l"><h3 class="bd b fi z dy kq ea eb kr ed ef dx translated">Builder是我们的拖放工具，用于设计、构建和发布包含您的位置数据的交互式web地图。地图可以是…</h3></div><div class="kt l"><p class="bd b fp z dy kq ea eb kr ed ef dx translated">docs.carto.com</p></div></div><div class="ku l"><div class="kv l kw kx ky ku kz in kl"/></div></div></a></div><p id="4226" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> CARTO </strong>是<strong class="ir hi">位置情报</strong>领域的领导者之一。有利于解决包括<br/> 1在内的许多行业的位置智能问题。电信<br/> 2。运输<br/> 3。物流，等等。</p><p id="1ddb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">CARTO平台的主要组件很少。</p><ul class=""><li id="ffb1" class="la lb hh ir b is it iw ix ja lc je ld ji le jm lf lg lh li bi translated">仪表盘</li><li id="fe30" class="la lb hh ir b is lj iw lk ja ll je lm ji ln jm lf lg lh li bi translated">建设者</li><li id="10cd" class="la lb hh ir b is lj iw lk ja ll je lm ji ln jm lf lg lh li bi translated">平台API和库</li><li id="197b" class="la lb hh ir b is lj iw lk ja ll je lm ji ln jm lf lg lh li bi translated">数据观测站</li><li id="53c8" class="la lb hh ir b is lj iw lk ja ll je lm ji ln jm lf lg lh li bi translated">相框</li></ul><p id="f69e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在本文中，我们将通过构建一个交互式仪表板来探索CARTOframes的基本功能。为此，我们将使用来自Kaggle的<a class="ae lo" href="https://www.kaggle.com/jameslko/gun-violence-data" rel="noopener ugc nofollow" target="_blank">枪支暴力数据</a>。</p><h2 id="8b21" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">帐户创建、安装和基本身份验证设置</h2><ol class=""><li id="71e8" class="la lb hh ir b is lp iw lq ja lr je ls ji lt jm lu lg lh li bi translated"><strong class="ir hi">账户创建</strong></li></ol><p id="9a8b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">注意</strong>:如果您将使用CARTOframes来可视化您的本地数据，这一步是可选的，但是如果您想与观众分享或需要使用一些高级功能，您肯定需要一个购物车帐户来进一步处理。</p><p id="a486" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果您是学生或教育工作者，您可以使用您的学术电子邮件获得一个使用<a class="ae lo" href="https://education.github.com/pack" rel="noopener ugc nofollow" target="_blank"> Github Education Pack </a>的学生帐户。</p><p id="cdd5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">创建帐户后，您可以从CARTO仪表板访问您的API密钥。现在，您已经准备好为本地应用程序设置身份验证了。您所需要做的就是获取您的API密钥和用户名，并将其保存为以下格式的JSON文件。将其命名为<code class="du lv lw lx ly b">creds.jon</code>并保存在当前工作目录中。</p><figure class="ma mb mc md fd ii er es paragraph-image"><div class="er es lz"><img src="../Images/18cfc5024e8fe1c7b6050614053c3aff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*hBPlMqJ948yUmZKNeikLKw.png"/></div><figcaption class="me mf et er es mg mh bd b be z dx translated">creds.json</figcaption></figure><p id="bb4f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">2.<strong class="ir hi">安装</strong></p><p id="e526" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">CARTOframes要求系统中已经有Shapely和Fiona库。因此，使用以下命令来正确安装它，</p><pre class="ma mb mc md fd mi ly mj mk aw ml bi"><span id="b495" class="jn jo hh ly b fi mm mn l mo mp">pip install shapely<br/>conda install -c conda-forge fiona<br/>pip install cartoframes</span></pre><p id="6439" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">3.<strong class="ir hi">设置认证</strong></p><p id="e87b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，您已经在机器中安装了CARTOframes并保存了您的凭据。然后，您可以使用下面几行代码设置身份验证。</p><pre class="ma mb mc md fd mi ly mj mk aw ml bi"><span id="9c99" class="jn jo hh ly b fi mm mn l mo mp">from cartoframes.auth import set_default_credentials<br/>set_default_credentials(‘creds.json’)</span></pre><p id="8921" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">好吧！现在我们可以进入下一阶段了。</p><h2 id="fd4e" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated"><strong class="ak">导入数据和预处理</strong></h2><p id="028a" class="pw-post-body-paragraph ip iq hh ir b is lp iu iv iw lq iy iz ja mq jc jd je mr jg jh ji ms jk jl jm ha bi translated">您可以使用<a class="ae lo" href="https://www.kaggle.com/jameslko/gun-violence-data" rel="noopener ugc nofollow" target="_blank">ka ggle站点</a>查看数据描述。它包含2013年至2018年的239，677起事件。</p><p id="cec2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">数据集的示例。</p><figure class="ma mb mc md fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mt"><img src="../Images/eec8b11560c260f61268cc7f41b9941a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q4JlP8deqZK6uOraK9_JeQ.png"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx translated">样品</figcaption></figure><p id="0adf" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">之后，我们只选择2018年发生的事件和少数几个栏目。</p><figure class="ma mb mc md fd ii"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="723e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我们有了下面的数据帧，</p><figure class="ma mb mc md fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mw"><img src="../Images/cc81ac8027bc82f87a320f541080ed2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*chYrLZ-opTFI1gyTJhnJcQ.png"/></div></div></figure><p id="4262" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，根据我们的用例，我们需要明确的参与者性别栏。我们将分别获得参与者的男性人数和女性人数。</p><figure class="ma mb mc md fd ii"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="ma mb mc md fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mx"><img src="../Images/17272809ebef6bdead057390eece321e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*00S83RCIB8EwxfwxO8f_OA.png"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx translated">清理的数据</figcaption></figure><h2 id="1bc3" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">形象化</h2><p id="2c55" class="pw-post-body-paragraph ip iq hh ir b is lp iu iv iw lq iy iz ja mq jc jd je mr jg jh ji ms jk jl jm ha bi translated">要使用CARTOframes可视化和空间化数据框，源数据框几何的CRS必须是<a class="ae lo" href="https://geopandas.org/docs/user_guide/projections.html#setting-a-projection" rel="noopener ugc nofollow" target="_blank"> WGS 84 </a> (EPSG:4326)。</p><p id="0fe8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最简单的方法是转换我们的熊猫。数据框到geopandas.GeoDataFrame</p><figure class="ma mb mc md fd ii"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="ma mb mc md fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es my"><img src="../Images/26af2e154cdf3a27483d8740db8554b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7GEKK1GYME8uxoc8jQ9uDA.png"/></div></div></figure><p id="c528" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我们可以可视化我们的数据。</p><figure class="ma mb mc md fd ii"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="ma mb mc md fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mz"><img src="../Images/20e8406b49cb58385b57332d8182a675.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NXvpbLSG-7iVYI2aTWC-rg.png"/></div></div></figure><p id="3b3b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">CARTOframes的另一个有用的组件是小部件、样式和弹出窗口。我们可以根据我们的用例选择合适的小部件。在这个可视化中，我们将使用，</p><ol class=""><li id="6d81" class="la lb hh ir b is it iw ix ja lc je ld ji le jm lu lg lh li bi translated"><strong class="ir hi">点击并悬停弹出窗口</strong>-显示一个由悬停事件触发的弹出窗口</li><li id="a166" class="la lb hh ir b is lj iw lk ja ll je lm ji ln jm lu lg lh li bi translated"><strong class="ir hi">直方图小部件</strong>——创建一个小部件来表示直方图中的分类、数字和日期值</li><li id="d597" class="la lb hh ir b is lj iw lk ja ll je lm ji ln jm lu lg lh li bi translated"><strong class="ir hi">类别小部件</strong>——创建一个小部件来表示类别值</li><li id="519e" class="la lb hh ir b is lj iw lk ja ll je lm ji ln jm lu lg lh li bi translated"><strong class="ir hi">公式小工具</strong>-以数字形式显示计数、平均值、最大值、最小值或总和运算的结果</li><li id="8b89" class="la lb hh ir b is lj iw lk ja ll je lm ji ln jm lu lg lh li bi translated"><strong class="ir hi">动画风格</strong>-能够通过动画控件播放、暂停和更改动画可视化</li></ol><p id="731d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们看看如何使用python实现它，</p><p id="d9d0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在此之前，我们需要创建一个名为<code class="du lv lw lx ly b">weekday</code>的新列</p><pre class="ma mb mc md fd mi ly mj mk aw ml bi"><span id="3bd2" class="jn jo hh ly b fi mm mn l mo mp">incidents_2018_gdf['weekday'] = (incidents_2018_gdf['date']<br/>                                  .dt.day_name())</span></pre><figure class="ma mb mc md fd ii"><div class="bz dy l di"><div class="mu mv l"/></div></figure><figure class="ma mb mc md fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es na"><img src="../Images/7010a5f225777243501f67ca14ea5784.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ZJPl2zReHw3DTzDDGIvjGg.gif"/></div></div></figure><p id="16de" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">接下来，我们将为<code class="du lv lw lx ly b">date </code>列创建另一个包含动画样式的层，</p><figure class="ma mb mc md fd ii"><div class="bz dy l di"><div class="mu mv l"/></div></figure><p id="ed41" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，我们的主仪表板可以使用了，此外，您可以使用以下方式发布它。<em class="nb">在此之前，您必须设置默认凭证。</em></p><pre class="ma mb mc md fd mi ly mj mk aw ml bi"><span id="621b" class="jn jo hh ly b fi mm mn l mo mp">map_viz.publish('viz_name',password='letmein',if_exists='replace')</span></pre><figure class="ma mb mc md fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nc"><img src="../Images/dcf4b2d52aaf2867529beef4091f646f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*5h89AnGsSyQb5ObmnDnKcw.gif"/></div></div></figure><p id="8976" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">另外，不要忘记访问<a class="ae lo" href="https://carto.com/developers/cartoframes/examples/#example-data-visualization" rel="noopener ugc nofollow" target="_blank">文档</a>，以防遇到困难😉</p><p id="1440" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">谢谢！</p></div></div>    
</body>
</html>