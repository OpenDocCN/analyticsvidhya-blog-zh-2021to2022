<html>
<head>
<title>Time Buttons in Plotly for Line Charts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">折线图的Plotly中的时间按钮</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/time-buttons-in-plotly-for-line-charts-5c4817cfbcb8?source=collection_archive---------8-----------------------#2021-05-29">https://medium.com/analytics-vidhya/time-buttons-in-plotly-for-line-charts-5c4817cfbcb8?source=collection_archive---------8-----------------------#2021-05-29</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="c09c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">大家好，在这个故事中，我们将尝试理解Plotly的时间按钮。我很兴奋，因为当我在约翰内斯堡学习英语时，我正试着用英语写技术文章。请原谅我的英语:)让我们试着用Plotly来解释时间按钮。</p><p id="6cab" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可以从<a class="ae jc" href="https://github.com/mebaysan/VeriBilimi/blob/master/Python/3-)KesifciVeriAnaliziVeVeriGorsellestirme/Plotly-Dash-Examples/Plotly-TimeButtons/Plotly-TimeButtons.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>访问jupyter笔记本获取该代码。</p><h1 id="a3e0" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">自我介绍和准备</h1><p id="0985" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">在开始使用时间按钮之前，我们需要安装一些依赖项。我们将使用<strong class="ig hi"> yfinance </strong>包来访问股票数据。因此，我们需要用pip安装yfinance来安装yfinance包。之后，我们需要安装熊猫和Plotly。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="1422" class="kp je hh kl b fi kq kr l ks kt">pip install yfinance<br/>pip install pandas<br/>pip install plotly</span></pre><h1 id="41d7" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">什么是时间按钮？</h1><p id="8792" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">我们可以在折线图中添加时间按钮，以过滤或放大特定时间段。我们可以在大多数股票网站上看到它们。他们可以为我们提供特定时间段的详细图像。首先，我们需要学习一些关于这个东西的短代码。</p><ul class=""><li id="15cd" class="ku kv hh ig b ih ii il im ip kw it kx ix ky jb kz la lb lc bi translated"><strong class="ig hi"> 1D </strong> =最后一天的数据</li><li id="f536" class="ku kv hh ig b ih ld il le ip lf it lg ix lh jb kz la lb lc bi translated"><strong class="ig hi"> 1M </strong> =上个月的数据</li><li id="fc1a" class="ku kv hh ig b ih ld il le ip lf it lg ix lh jb kz la lb lc bi translated"><strong class="ig hi"> 1Y </strong> =去年的数据</li><li id="d4c5" class="ku kv hh ig b ih ld il le ip lf it lg ix lh jb kz la lb lc bi translated"><strong class="ig hi"> YTD </strong> =年初至今的数据等。</li></ul><h1 id="652b" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">我们如何使用时间按钮？</h1><p id="97af" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">Plotly中的时间按钮是一个字典，列表中包含特定的键。</p><ul class=""><li id="066b" class="ku kv hh ig b ih ii il im ip kw it kx ix ky jb kz la lb lc bi translated"><strong class="ig hi">显示在按钮上的文本标签</strong></li><li id="4947" class="ku kv hh ig b ih ld il le ip lf it lg ix lh jb kz la lb lc bi translated"><strong class="ig hi">计算</strong>当我们点击按钮时要走多少步</li><li id="5880" class="ku kv hh ig b ih ld il le ip lf it lg ix lh jb kz la lb lc bi translated"><strong class="ig hi">步骤</strong>移动日期周期(月、年、日等)。)</li><li id="0f3f" class="ku kv hh ig b ih ld il le ip lf it lg ix lh jb kz la lb lc bi translated"><strong class="ig hi">步进模式</strong>为<strong class="ig hi">今天</strong>或<strong class="ig hi">向后。</strong>“todate”表示从<strong class="ig hi">步骤</strong>中表示的最近的整个时间段的开始(在通过计数后退之后)。<strong class="ig hi">向后倒</strong>为刚才按<strong class="ig hi">数向后倒。</strong></li></ul><h2 id="8857" class="kp je hh bd jf li lj lk jj ll lm ln jn ip lo lp jr it lq lr jv ix ls lt jz lu bi translated">今天对明天</h2><p id="36e1" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">为了理解<strong class="ig hi">今天</strong>对<strong class="ig hi">向后</strong>，假设一个数据集在10月20日结束，每个选项有一个6个月的按钮。</p><p id="463d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果stepmode等于<strong class="ig hi"> backward </strong>将缩放图以在4月20日开始(因为向后)</p><p id="15d9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果stepmode等于<strong class="ig hi">today</strong>将缩放绘图至5月1日开始(4月20日最近月份的开始)</p><h1 id="7bfb" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">获取数据并检查</h1><p id="a45d" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">现在我们知道了什么是时间按钮。我们可以把它们用在我们的地块上。我们将使用<strong class="ig hi"> yfinance </strong>模块的<strong class="ig hi">下载</strong>功能来访问数据。当我们使用这个函数时，我们需要提供"<strong class="ig hi">股票代码"</strong> " <strong class="ig hi">开始日期"</strong>" T8 "<strong class="ig hi">结束日期"</strong>。首先，我们需要导入我们依赖的包。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="1833" class="kp je hh kl b fi kq kr l ks kt">import yfinance as yf<br/>import pandas as pd<br/>import plotly.graph_objects as go</span><span id="0a54" class="kp je hh kl b fi lv kr l ks kt">data = yf.download("AAPL", start="2019-01-01", end="2021-04-01")</span><span id="0592" class="kp je hh kl b fi lv kr l ks kt">data.head()</span></pre><figure class="kg kh ki kj fd lx er es paragraph-image"><div class="er es lw"><img src="../Images/cac000a06d0dd556235bac0dfc6f36a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*1u1FjlqlrHwQ0AKvrWKTsw.png"/></div><figcaption class="ma mb et er es mc md bd b be z dx translated">如果您执行相同的代码，您将看到以下结果</figcaption></figure><h1 id="b197" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">让我们用计时按钮</h1><h2 id="f7d7" class="kp je hh bd jf li lj lk jj ll lm ln jn ip lo lp jr it lq lr jv ix ls lt jz lu bi translated">创建时间按钮</h2><p id="bcbc" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">为创建一个列表，其中包含关于带有特定键的按钮的特定词典。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="d002" class="kp je hh kl b fi kq kr l ks kt">time_buttons = [<br/>    {'count': 1, 'step': 'day', 'stepmode': 'todate', 'label': '1TD'},<br/>    {'count': 14, 'step': 'day', 'stepmode': 'todate', 'label': '2WTD'},<br/>    {'count': 6, 'step': 'month', 'stepmode': 'todate', 'label': '6MTD'},<br/>    {'count': 1, 'step': 'year', 'stepmode': 'todate', 'label': '1YTD'}<br/>]</span></pre><h2 id="2368" class="kp je hh bd jf li lj lk jj ll lm ln jn ip lo lp jr it lq lr jv ix ls lt jz lu bi translated">创建情节图</h2><p id="35de" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">首先，我们正在创造没有任何情节的形象。之后，我们将为我们需要的列添加跟踪。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="c95b" class="kp je hh kl b fi kq kr l ks kt">fig = go.Figure()</span><span id="c375" class="kp je hh kl b fi lv kr l ks kt">fig.add_trace(go.Scatter(x=data.index,y=data['Open'],mode='lines',name='Open'))</span><span id="b745" class="kp je hh kl b fi lv kr l ks kt">fig.add_trace(go.Scatter(x=data.index, y=data['High'], mode='lines', name='High'))</span><span id="7963" class="kp je hh kl b fi lv kr l ks kt">fig.add_trace(go.Scatter(x=data.index, y=data['Low'], mode='lines', name='Low'))</span><span id="17e6" class="kp je hh kl b fi lv kr l ks kt">fig.add_trace(go.Scatter(x=data.index, y=data['Close'], mode='lines', name='Close'))</span></pre><p id="75a6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果执行这段代码就会看到这个结果。</p><figure class="kg kh ki kj fd lx er es paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="er es me"><img src="../Images/b8501d16e5bc065385331076e931626c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-nOnh8F4RSNXmmhUSZV2qg.png"/></div></div></figure><p id="4f57" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们需要添加我们的按钮。我们可以用<strong class="ig hi"> update_xaxes </strong>函数添加它们。</p><p id="fdd9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你看，我用了<strong class="ig hi"> update_layout </strong>函数。用于更新悬停模式，当鼠标悬停在x轴上时，显示所有行数据。</p><p id="9d1d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我使用了<strong class="ig hi"> update_xaxes </strong>函数来添加我们的时间按钮。我们需要更新显示按钮的图表的x轴。</p><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="c401" class="kp je hh kl b fi kq kr l ks kt">fig.update_layout(hovermode="x unified")</span><span id="217c" class="kp je hh kl b fi lv kr l ks kt">fig.update_xaxes(rangeselector={'buttons': time_buttons})</span></pre><figure class="kg kh ki kj fd lx er es paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="er es mj"><img src="../Images/2b9d595cbb44a73b228bfdcdd35147ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2KA-Lv_C2c9tK7wV7mj6Sw.png"/></div></div><figcaption class="ma mb et er es mc md bd b be z dx translated">如果执行相同的代码，您将看到以下结果</figcaption></figure><p id="e482" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我希望这篇文章能对你理解时间按钮有所帮助。可以从<a class="ae jc" href="https://github.com/mebaysan/VeriBilimi/blob/master/Python/3-)KesifciVeriAnaliziVeVeriGorsellestirme/Plotly-Dash-Examples/Plotly-TimeButtons/Plotly-TimeButtons.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>访问jupyter笔记本获取该代码。</p></div></div>    
</body>
</html>