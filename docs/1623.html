<html>
<head>
<title>Twitter Direct Messages like a Pro (with Tweepy)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Twitter像专业人士一样直接发送消息(带Tweepy)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/twitter-direct-messages-like-a-pro-with-tweepy-48bc1cdade04?source=collection_archive---------2-----------------------#2021-03-10">https://medium.com/analytics-vidhya/twitter-direct-messages-like-a-pro-with-tweepy-48bc1cdade04?source=collection_archive---------2-----------------------#2021-03-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b59d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Twitter上的直接消息已经出现了一段时间。这并不令人惊讶，因为短信无疑对我们每天交流、工作和联系的方式产生了巨大影响。</p><p id="bd72" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在社交平台上，对于那些希望通过客户体验和支持扩大影响(增加关注者)、创建独特品牌或提供“不低于卓越”的企业来说，消息传递可以发挥关键作用。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/386b175875a5b0c884097091b1f889e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*squsEkPEiWNbIF4tS0WFNA.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">奥列格·马尼在<a class="ae jt" href="https://unsplash.com/s/photos/twitter-messaging?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="0ab3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里<strong class="ih hj"> 1) </strong>我将讨论一些关于直接的私人信息如何给一个品牌或组织带来价值的事实和考虑，<strong class="ih hj"> 2) </strong>我将深入一些技术性的例子(给技术人员)🤓Twitter机器人如何使用Tweepy读取和发送DMs。</p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><h1 id="ebc5" class="kb kc hi bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">直接信息的价值</h1><p id="8888" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">目的地管理系统可用于追求不同的目标:</p><ul class=""><li id="eebc" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc lj lk ll lm bi translated">珍惜你的追随者:任何新的追随者都会受到“谢谢你关注我们”的欢迎消息</li><li id="b0d1" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">参与:向关注者发送消息，告知他们一些重要的事情(服务或政策的变化)或新的机会(可用的优惠或有用的提示)</li><li id="55ab" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">个人:以友好和个人的方式私下接触可以在品牌和追随者之间建立联系</li><li id="a04d" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">利用这些功能:Twitter DMs支持多达10k个字符，允许客户提交他们的查询，而不受标准Tweet(最多280个字符)的限制</li></ul><p id="1d5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">直接信息<strong class="ih hj">不应被滥用</strong>，因为它们会变成垃圾信息，转移人们的兴趣，并给品牌形象蒙上阴影。出于同样的原因，它们<strong class="ih hj">不应该被忽略</strong>或被认为是响应较晚或较差的低优先级。</p><p id="1b87" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，当准备好并提交后，启用从每个人那里接收DMs的选项:当目标是让客户和用户能够联系到您时，这很重要。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ls"><img src="../Images/151baaca0f970b82bfa120f6bfbe77c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G0fExaJOWG5HZ8jVEaZGbA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">选中“允许来自所有人的消息请求”</figcaption></figure><h1 id="aaa5" class="kb kc hi bd kd ke lt kg kh ki lu kk kl km lv ko kp kq lw ks kt ku lx kw kx ky bi translated">Twitter机器人的片段和开发实践</h1><p id="9ac4" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">Tweepy是访问Twitter最流行的库之一。它提供了一个围绕Twitter REST API的包装器，以简化端点的配置、认证和调用。</p><p id="38aa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Tweepy对Twitter直接消息的支持非常好。</p><p id="490e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在以下部分中，我们将了解如何执行以下操作:</p><ul class=""><li id="b604" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc lj lk ll lm bi translated">设置对Twitter API的访问</li><li id="7668" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">获取发送到Twitter帐户的DMs</li><li id="d08a" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">表达重要意思</li><li id="f170" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc lj lk ll lm bi translated">删除邮件</li></ul><h1 id="e4f2" class="kb kc hi bd kd ke lt kg kh ki lu kk kl km lv ko kp kq lw ks kt ku lx kw kx ky bi translated">证明</h1><p id="360b" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">设置和验证非常简单。首先在<a class="ae jt" href="https://developer.twitter.com/en" rel="noopener ugc nofollow" target="_blank"> Twitter Dev </a>网站上申请一个Twitter开发者账户，以获得必要的访问密钥。</p><pre class="je jf jg jh fd ly lz ma mb aw mc bi"><span id="928f" class="md kc hi lz b fi me mf l mg mh">import tweepy<br/><br/># Authenticate access<br/>auth = tweepy.OAuthHandler("CONSUMER_KEY", "CONSUMER_SECRET")<br/>auth.set_access_token("ACCESS_TOKEN", "ACCESS_TOKEN_SECRET")<br/><br/># Create API handler<br/>api = tweepy.API(auth)</span></pre><p id="3dff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不要在源代码中硬编码令牌和凭证，而是将它们存储在一个外部文件中。env)或者(甚至更好)放在环境变量中。</p><h1 id="0665" class="kb kc hi bd kd ke lt kg kh ki lu kk kl km lv ko kp kq lw ks kt ku lx kw kx ky bi translated">收到直接信息</h1><p id="a5a7" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">发送到您帐户的DMs会出现在“信息”收件箱中。Tweepy库提供了一个获取它们的方法:</p><pre class="je jf jg jh fd ly lz ma mb aw mc bi"><span id="1a01" class="md kc hi lz b fi me mf l mg mh">messages = api.list_direct_messages(count=5)</span><span id="8123" class="md kc hi lz b fi mi mf l mg mh"><strong class="lz hj">for </strong>message <strong class="lz hj">in </strong>reversed(messages):<br/>  # who is sending?  <br/>  sender_id = message.message_create[<strong class="lz hj">"sender_id"</strong>]<br/>  # what is she saying?<br/>  text = message.message_create[<strong class="lz hj">"message_data"</strong>][<strong class="lz hj">"text"</strong>]</span></pre><p id="b80c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">关于上面代码的几点说明:</p><ol class=""><li id="4fe6" class="le lf hi ih b ii ij im in iq lg iu lh iy li jc mj lk ll lm bi translated">单个API调用获取的消息数量是可以控制的(默认值为20，最多可以使用50)</li><li id="a91f" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc mj lk ll lm bi translated">该列表被反向处理，首先读取最近的消息</li><li id="37a2" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc mj lk ll lm bi translated"><strong class="ih hj">所有收发的</strong>信息都会被返回(是的，还有我们的回复)</li><li id="0312" class="le lf hi ih b ii ln im lo iq lp iu lq iy lr jc mj lk ll lm bi translated">尽管DM很快出现在Twitter消息收件箱中，但是在通过API获得之前有一个<strong class="ih hj">延迟</strong></li></ol><p id="3e33" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更多信息请访问<a class="ae jt" href="https://developer.twitter.com/en/docs/twitter-api/v1/direct-messages/sending-and-receiving/api-reference/list-events" rel="noopener ugc nofollow" target="_blank"> Twitter REST API获取直接消息</a></p><h1 id="238a" class="kb kc hi bd kd ke lt kg kh ki lu kk kl km lv ko kp kq lw ks kt ku lx kw kx ky bi translated">发送直接信息</h1><p id="7c68" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">发送DMs也是一个简单的操作:</p><pre class="je jf jg jh fd ly lz ma mb aw mc bi"><span id="e1bf" class="md kc hi lz b fi me mf l mg mh">recipient_id = "123"  # ID of the user<br/>api.send_direct_message(recipient_id, <strong class="lz hj">"Hoi hoi"</strong>)</span></pre><p id="9d50" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">回复包括一个<strong class="ih hj">媒体</strong>，可能发送一个感谢gif或一个小的介绍视频，这可能会很酷。</p><pre class="je jf jg jh fd ly lz ma mb aw mc bi"><span id="35c6" class="md kc hi lz b fi me mf l mg mh"># upload media<br/>media = api.media_upload(filename=<strong class="lz hj">'/files/thankyou.png'</strong>)</span><span id="7999" class="md kc hi lz b fi mi mf l mg mh"># send with media<br/>recipient_id = "123"  # ID of the user<br/>api.send_direct_message(recipient_id=recipient_id, text='Thank You!', attachment_type=<strong class="lz hj">'media'</strong>, attachment_media_id=media.media_id)</span></pre><p id="20dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意<code class="du mk ml mm lz b">recipient_id</code>是Twitter用户的ID(号码),而不是用户名(字符串，即@beppecatanese)。数字用户ID可以通过API调用获得</p><pre class="je jf jg jh fd ly lz ma mb aw mc bi"><span id="b1fc" class="md kc hi lz b fi me mf l mg mh">user = api.get_user("beppecatanese")<br/>recipient_id = user.id_str</span></pre><p id="0d65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当回复一个DM时，我们收到的<code class="du mk ml mm lz b">recipient_id</code>可以在原始消息的JSON有效载荷中找到</p><pre class="je jf jg jh fd ly lz ma mb aw mc bi"><span id="b62c" class="md kc hi lz b fi me mf l mg mh">recipient_id<!-- --> = message.message_create[<strong class="lz hj">"sender_id"</strong>]</span></pre><p id="bffe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更多信息请访问<a class="ae jt" href="https://developer.twitter.com/en/docs/twitter-api/v1/direct-messages/sending-and-receiving/api-reference/new-event" rel="noopener ugc nofollow" target="_blank"> Twitter REST API发布直接消息</a></p><h1 id="23d1" class="kb kc hi bd kd ke lt kg kh ki lu kk kl km lv ko kp kq lw ks kt ku lx kw kx ky bi translated">删除直接消息</h1><p id="9350" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">删除消息也便于清理收件箱，还可以避免无意中回复同一条消息。</p><p id="19a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注意</strong>:我通常会在回复后删除一条消息，这样我就不用担心下次下载消息时会跳过这条消息。显然，这不是绝对必要的，但它简化了收件箱的管理。</p><pre class="je jf jg jh fd ly lz ma mb aw mc bi"><span id="b1b0" class="md kc hi lz b fi me mf l mg mh"># delete by ID<br/>api.destroy_direct_message(message.id)</span></pre><h1 id="c08b" class="kb kc hi bd kd ke lt kg kh ki lu kk kl km lv ko kp kq lw ks kt ku lx kw kx ky bi translated">结论</h1><p id="d474" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">在<a class="ae jt" href="https://github.com/gcatanese/1-2-3-Direct-Messages-With-Tweepy" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上查看源代码</p><p id="d309" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于十二个新手，我推荐一个非常好的关于真正Python的教程</p><p id="bdc8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如有反馈和问题，请通过推特联系我。</p></div></div>    
</body>
</html>