<html>
<head>
<title>Riding the Wave, Numerically.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从数字上看，乘风破浪。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/riding-the-wave-numerically-85f1ef461c95?source=collection_archive---------6-----------------------#2021-03-30">https://medium.com/analytics-vidhya/riding-the-wave-numerically-85f1ef461c95?source=collection_archive---------6-----------------------#2021-03-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="e31c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有限差分法简介及其在数值求解偏微分方程中的应用。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/f6c09dc921bc328b44a0e265621ab18d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aFvvpI0x6gRVSppaQZ4tPg.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">图像<a class="ae jt" href="https://www.insynergy.net.au/insights/tidal-wave-effect/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="8247" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi ju translated">宇宙是一个复杂的实体，其中各种自然现象由依赖于多个变量并具有非线性行为的方程控制。这些方程可以采用常微分方程或偏微分方程的形式。在之前的<a class="ae jt" rel="noopener" href="/analytics-vidhya/flying-a-rocket-numerically-404ed271ee23?sk=01af95073fd59344c7d7ed4559cad5f1">文章</a>中，我们看到了数值求解常微分方程(ODEs)的数值积分方法。在这篇文章中，我们将试图理解什么是偏微分方程，然后使用有限差分方法来解决一个物理现象。在这个过程中，我们还将学习一些广泛的python函数和库。</p><h1 id="8342" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">ODE vs PDE</h1><p id="5825" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">在常微分方程的情况下，我们根据时间积分解。因此，我们需要知道<strong class="ih hj"><em class="lg">u</em></strong>vs<strong class="ih hj"><em class="lg">t</em></strong>曲线上某一点的解，然后，从那里，我们可以整合我们的解，也称为<strong class="ih hj"> <em class="lg"> </em> </strong> <em class="lg">初值问题</em>。这意味着我们的解决方案只依赖于时间的演变，因此，一个单变量函数。然而，在PDEs的情况下，属性的解的演化可能依赖于时间<strong class="ih hj"> <em class="lg"> t </em> </strong>和一个空间维度(或更多)，比如说<strong class="ih hj"> <em class="lg"> x </em> </strong>。</p><h1 id="59b5" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">线性对流</h1><p id="5c31" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">线性对流方程是双曲方程的最简单形式，可用于了解PDEs的数值解。我们将使用一维形式的方程来进一步简化解决方案。这个等式可以写成</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lh"><img src="../Images/9a1d773f7c3618297efa5367cb35d47a.png" data-original-src="https://miro.medium.com/v2/resize:fit:238/format:webp/1*yIbQlbvmiBzpSBaVmAqWZA.png"/></div></figure><p id="60e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这只是以速度<strong class="ih hj"><em class="lg">【c】</em></strong>(此处为常数)向右(沿正<strong class="ih hj"> <em class="lg"> x </em> </strong>方向)传播任何轮廓，而不改变其形状。这也是为什么其有时也被称为<strong class="ih hj"><em class="lg"/></strong>(或<em class="lg">平流方程</em>)。</p><p id="780b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是双曲偏微分方程中的一个重要概念，也被称为<strong class="ih hj"> <em class="lg">特征</em></strong>——这些是时空中的曲线，沿着这些曲线解是常数。与这些曲线相关联的是波速，以该波速传递关于溶液如何变化的信息。</p><p id="2065" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为简单起见，我们将使用方波初始条件，定义如下:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es li"><img src="../Images/cce99a92d8740ef2cf0f01ba0cba6e15.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*u0K1oMD8XqmENnvHeD0TuQ.png"/></div></figure><p id="000c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们还需要一个关于<strong class="ih hj"> <em class="lg"> x </em> </strong>的边界条件:设<strong class="ih hj"><em class="lg">u = 1</em></strong>at<strong class="ih hj"><em class="lg">x = 0</em></strong>。我们对于数值解的空间域范围将是<strong class="ih hj"> <em class="lg"> x ∈ (0，2) </em> </strong>。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lj"><img src="../Images/c439efcb725e8dfca649512e8e6af65c.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*kifGQpEKicUkUOzun82WIw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">方波初始条件(图片由作者提供)</figcaption></figure><h1 id="e490" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">有限差分</h1><h2 id="6154" class="lk ke hi bd kf ll lm ln kj lo lp lq kn iq lr ls kr iu lt lu kv iy lv lw kz lx bi translated">区域离散化</h2><p id="2e07" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">想象一个时空图，垂直方向的坐标代表时间上的推进——比如说<strong class="ih hj"> <em class="lg"> tⁿ </em> </strong>到<strong class="ih hj"> <em class="lg"> tⁿ </em> ⁺ </strong>水平方向的坐标代表空间上的推进——比如说<strong class="ih hj"><em class="lg">xᵢ₋₁</em></strong><strong class="ih hj"><em class="lg">xᵢ</em></strong>和<strong class="ih hj"> <em class="lg"> xᵢ₊₁ </em> </strong>。这将创建一个网格，其中的点同时具有空间和时间索引。下面的每个网格点具有对应于向右增加的空间位置的索引I和对应于向上增加的时刻的索引n。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ly"><img src="../Images/64dee314b7f65053423f8cbb0b1f6e18.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*0ZftFE8nRM1_nySbSU21hQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">时空格网(图片由作者提供)</figcaption></figure><p id="55dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于数值解<strong class="ih hj"><em class="lg">【x，t】</em></strong>，我们将使用上标表示时间索引<strong class="ih hj"><em class="lg">【uⁿ</em></strong>，下标表示空间索引<strong class="ih hj"><em class="lg">【uᵢ</em></strong>。一个小网格段在每一点的数值解如下:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lz"><img src="../Images/659c4ea0ca4a0b6cd98eebafa9bb7acf.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*BH15Fq92SXtTMvV-ykt3Zw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">位于<strong class="bd kf"> i，n </strong>的网格点及其邻居(图片由作者提供)</figcaption></figure><h2 id="bf96" class="lk ke hi bd kf ll lm ln kj lo lp lq kn iq lr ls kr iu lt lu kv iy lv lw kz lx bi translated">方程离散化</h2><p id="c585" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">是时候在空间和时间上对一维线性对流方程进行离散化，并在我们在上一节中描述的时空网格上使用它了。根据定义，相对于<strong class="ih hj"> <em class="lg"> t </em> </strong>的偏导数仅随时间变化，而不随空间变化，即仅指数<strong class="ih hj"> <em class="lg"> n </em> </strong>受影响。类似地，相对于<strong class="ih hj"> <em class="lg"> x </em> </strong>的偏导数仅随空间而不随时间变化，即仅<strong class="ih hj"> <em class="lg"> i </em> </strong>指数受影响。</p><p id="1f7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从导数的定义，我们知道对于<strong class="ih hj"><em class="lg">δx</em></strong>足够小:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ma"><img src="../Images/f66179ddfe4ffc3bc11fb3f374a9f00e.png" data-original-src="https://miro.medium.com/v2/resize:fit:408/format:webp/1*GRYAljzUsYOIAUERU7aHDA.png"/></div></figure><p id="696e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但这不是我们估计导数的唯一方法。一阶导数<strong class="ih hj"> <em class="lg"> ∂u/∂x </em> </strong>在任一点的几何解释是，它代表曲线<strong class="ih hj"><em class="lg">【x】</em></strong>切线的斜率。</p><p id="3d76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有三种可能的方式来表示<strong class="ih hj"> <em class="lg"> ∂u/∂x </em> </strong>的离散形式，如下所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mb"><img src="../Images/54b2e2b97e655bb662e090d1d53adeac.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*nqr4gJgAxHGMa8AYI_xiXg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">三种有限差分(图片由作者提供)</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mc"><img src="../Images/7c017bb16c5f8e72375d6ef5081f0a24.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*bPmszkA2IA56_Nqmy76CJA.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es md"><img src="../Images/adc26c55016c3e1e9da9fd8720b5d4da.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*jPNw28pbnDkagRkoQpvUKA.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es me"><img src="../Images/bd107133ce9b7e20ad2cb090bf19eecd.png" data-original-src="https://miro.medium.com/v2/resize:fit:566/format:webp/1*4SswlTvWrOvmWez6UcFMOw.png"/></div></figure><p id="1d9d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae jt" rel="noopener" href="/analytics-vidhya/flying-a-rocket-numerically-404ed271ee23?sk=01af95073fd59344c7d7ed4559cad5f1">欧拉方法</a>相当于使用时间导数的前向差分方案。让我们坚持这一点，选择空间导数的后向差分格式。我们的离散方程变成:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mf"><img src="../Images/5c3419f8e0063cff7790b6f08f69c894.png" data-original-src="https://miro.medium.com/v2/resize:fit:474/format:webp/1*k9OjmMJ1ZqeG9J7kYqBoxA.png"/></div></figure><p id="0cbe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中<strong class="ih hj"> <em class="lg"> n </em> </strong>和<strong class="ih hj"> <em class="lg"> n+1 </em> </strong>是时间上连续的两步，而<strong class="ih hj"> <em class="lg"> i-1 </em> </strong>和<strong class="ih hj"> <em class="lg"> i </em> </strong>是离散化后的<strong class="ih hj"> <em class="lg"> x </em> </strong>坐标的两个相邻点。在给定初始条件的情况下，这个离散化过程中唯一未知的是<strong class="ih hj"> <em class="lg"> uᵢⁿ </em> ⁺ </strong>。</p><p id="68ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们解出这个未知数，得到一个方程式，让我们及时步入:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mg"><img src="../Images/e4736cd9ee87955f10e913bf982f289c.png" data-original-src="https://miro.medium.com/v2/resize:fit:486/format:webp/1*sSsD4sdDRSlIag4zpgO91g.png"/></div></figure><p id="ec3a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是这里到底发生了什么？让我们回到网格视图。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lz"><img src="../Images/39bf1049d8fe6224131d1520ac6f7f8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*fQMhaQMfZeWA8g92KCCLiQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">“向前时间/向后空间”方案的模板(图片由作者提供)</figcaption></figure><p id="daf9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们可以观察到，下一个解<strong class="ih hj"> <em class="lg"> uᵢⁿ </em> ⁺ </strong>是从相邻网格点的前一个解中导出的。这个图叫做<strong class="ih hj"> <em class="lg">蜡纸</em> </strong>。</p><h1 id="0afc" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">数解</h1><p id="524c" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">现在让我们开始使用python吧！首先，我们需要加载数组和绘图库。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="7a99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们定义一些变量。请注意，我们希望在空间域内创建一个均匀间隔的点网格。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="abe9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将使用一些NumPy函数来定义我们的初始条件。比如，<code class="du mj mk ml mm b">np.ones()</code>定义一个<code class="du mj mk ml mm b">nx</code>元素长的数组，每个值为<strong class="ih hj"> <em class="lg"> 1 </em> </strong>。然后，我们将数组的一部分更改为值<strong class="ih hj"> <em class="lg"> u=2 </em> </strong>，以获得带有NumPy函数<code class="du mj mk ml mm b">np.where()</code>的方波，该函数返回一个索引列表，其中向量<em class="lg"> x </em>满足某些条件<em class="lg"> </em>和<code class="du mj mk ml mm b">np.logical_and()</code>，这些条件计算给定范围的真值。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="58c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有了指数列表，我们现在可以更新初始条件，得到方波。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="3631" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们用一个情节来看初始条件。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mh mi l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mn"><img src="../Images/6de5b6fd52934568605a21418f08d6e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*vKlhCHjVlzCxcnt4XFha3g.png"/></div></figure><p id="6841" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是时候用我们选择的有限差分格式为对流方程的离散形式写一些代码了。对于数组<code class="du mj mk ml mm b">u</code>的每个元素，我们需要求解上面看到的离散化方程。</p><p id="b693" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将结果存储在一个新的数组(临时)<code class="du mj mk ml mm b">un</code>中，这将是下一个时间步的解<strong class="ih hj"> <em class="lg"> u </em> </strong>。该操作将在所有时间步重复进行。我们将初始化占位符数组<code class="du mj mk ml mm b">un</code>来保存我们为<strong class="ih hj"> <em class="lg"> n+1 </em> </strong>时间步长计算的值，再次使用NumPy函数<code class="du mj mk ml mm b">np.ones()</code>。</p><p id="1a6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作为一个更大的图片，我们有两个迭代操作，一个在空间中，即在一个时间瞬间在空间中的每个网格点求解方程，然后通过<strong class="ih hj"><em class="lg">δt</em></strong>来步进时间。所以，我们可以从在时间循环中嵌套一个空间循环开始。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mh mi l"/></div></figure><p id="9f92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里，我们没有在每次迭代中强加边界条件，因为我们的离散化不会改变<code class="du mj mk ml mm b">u[0]</code>的值。</p><p id="aa34" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们画出我们最终的解决方案。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="mh mi l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mn"><img src="../Images/d01fcbf0f1d82b6f7e960e2bb89cbeb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*HXGvZn9o8hQ3JJoTzZnSWQ.png"/></div></figure><p id="24c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从图中可以看出，波以25个时间步长向右移动，保持了波的特征。如果我们想看到波浪实时移动，我们需要更进一步来创建动画。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mo"><img src="../Images/647ad8c5a33c554405f32d62b1d322dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/1*jZxI_wZ4NNgdfifE9n2mTw.gif"/></div></figure><p id="a342" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意，对于这里使用的gif，mp4视频剪辑是使用Matplotlib的<em class="lg">动画</em>模块和IPython.display的<em class="lg"> HTML </em>模块创建的。</p><h1 id="4184" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">结论</h1><p id="2442" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">我们看到了由一阶双曲型偏微分方程控制的方波是如何沿一个方向传播的。对剧情和动画的快速观察显示，波动实际上有点失真。这是因为离散化的方程是我们要求解的连续微分方程的近似。</p><p id="7acb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完整的代码可以在的链接<a class="ae jt" href="https://github.com/sidhantjain90/Numerical-Methods/blob/master/SquareWaveModel.ipynb" rel="noopener ugc nofollow" target="_blank">中找到。</a></p><p id="52c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你喜欢这篇文章，想让我发表更多这样的文章，请打个掌，评论一下！</p></div></div>    
</body>
</html>