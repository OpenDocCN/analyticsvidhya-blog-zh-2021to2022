<html>
<head>
<title>Pandas VS SQL for Data Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Pandas VS SQL用于数据分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pandas-vs-sql-for-data-analysis-5a5cd8dc81d5?source=collection_archive---------3-----------------------#2021-05-29">https://medium.com/analytics-vidhya/pandas-vs-sql-for-data-analysis-5a5cd8dc81d5?source=collection_archive---------3-----------------------#2021-05-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f479" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">经常有一个关于哪一个更适合数据分析的争论，这里我们将生成随机数据，并用pandas和SQL对其进行分析，看看哪一个更适合我们。</p><p id="a511" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这种情况下，我们将通过一个例子来比较这两者。我们将首先在Pandas上分析提供给我们的数据，然后在SQL上分析同样的数据。</p></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="cb6c" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">首先，让我们看看提供给我们的数据的模式</h1><figure class="kj kk kl km fd kn er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es ki"><img src="../Images/bf0eb4bc32834dab58d4a0eed46b5f1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MY00s92km5kSkjTKazDxCQ.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">MySQL数据库的模式</figcaption></figure><p id="fde0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们看到这是一家有3张桌子的餐馆的数据</p><p id="5a63" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">People table —该表包含访问餐馆的人的信息。该表有4列</p><ol class=""><li id="5741" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">ID —该列存储访问餐馆的人的ID。该列是表中唯一标识每个人的主键</li><li id="1c2f" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">年龄——光顾餐厅的人的年龄</li><li id="4054" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">性别——光顾餐厅的人的性别</li><li id="c106" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">城市——此人居住的城市</li></ol><p id="e67e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">偏好表—该表包含人们的食物偏好信息。该表有两列</p><ol class=""><li id="947f" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">ID —访问餐馆的人的个人ID。该列是preferences表中唯一标识每个客户的主键，但是该列也是preference表中引用people表中ID列的外键。这样做是因为除非在people表中有条目，否则在preferences表中不能有条目。这是因为只有去过餐馆的顾客才能回答关于他们喜欢的食物类型的调查</li><li id="c3ff" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">FOOD_TYPE —该列存储每个客户的首选食物类型</li></ol><p id="178f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">工作表—该表包含每个客户的职业信息。该表也有两列</p><ol class=""><li id="794e" class="ky kz hi ih b ii ij im in iq la iu lb iy lc jc ld le lf lg bi translated">ID —访问餐馆的人的个人ID。该列是preferences表中唯一标识每个客户的主键，但是该列也是preference表中引用people表中ID列的外键。这样做是因为除非在人员表中有条目，否则在职务表中不可能有条目。这是因为只有去过餐馆的顾客才能回答关于他们工作的调查</li><li id="1f01" class="ky kz hi ih b ii lh im li iq lj iu lk iy ll jc ld le lf lg bi translated">JOB —该列存储每个客户的职业</li></ol></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="57f0" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">将数据读入python，以便我们可以比较SQL和python</h1><p id="6469" class="pw-post-body-paragraph if ig hi ih b ii lm ik il im ln io ip iq lo is it iu lp iw ix iy lq ja jb jc hb bi translated">导入必要的库和框架</p><figure class="kj kk kl km fd kn"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="ee5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">建立到MySQL数据库的连接并读取数据</p><figure class="kj kk kl km fd kn"><div class="bz dy l di"><div class="lr ls l"/></div></figure></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="fd6d" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">处理数据以进行更好的分析</h1><p id="6eb7" class="pw-post-body-paragraph if ig hi ih b ii lm ik il im ln io ip iq lo is it iu lp iw ix iy lq ja jb jc hb bi translated">我们可以把这些数据框中的数据结合起来，这样我们就可以在一个地方得到所有的信息</p><figure class="kj kk kl km fd kn"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="50c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从该模式中我们可以看到，我们可以将年龄列划分为不同的年龄组，将城市列划分为不同的州，这将有助于我们的分析，然后我们还为男性和女性创建单独的数据框架，这也有助于我们的分析</p><figure class="kj kk kl km fd kn"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="e90e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将组合的数据帧保存到一个csv文件中，并在SQL数据库中创建一个表，该表包含csv文件中的所有信息，这样我们就可以在新表中获得新创建的列</p><p id="e76b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用以下代码在数据库中创建新表</p><figure class="kj kk kl km fd kn"><div class="bz dy l di"><div class="lr ls l"/></div></figure></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="e7c6" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">开始分析</h1><p id="0edb" class="pw-post-body-paragraph if ig hi ih b ii lm ik il im ln io ip iq lo is it iu lp iw ix iy lq ja jb jc hb bi translated">首先，我们分析了总人口中的男性和女性的数量以及他们的年龄组，并根据每个州的年龄组分析了他们的人口</p><p id="a85c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">计算机编程语言</p><figure class="kj kk kl km fd kn"><div class="bz dy l di"><div class="lr ls l"/></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">python中的年龄组明智分析</figcaption></figure><p id="0475" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结构化查询语言</p><figure class="kj kk kl km fd kn"><div class="bz dy l di"><div class="lr ls l"/></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">SQL中的年龄组明智分析</figcaption></figure><p id="c916" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，我们执行州和城市明智的分析</p><p id="7283" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">计算机编程语言</p><figure class="kj kk kl km fd kn"><div class="bz dy l di"><div class="lr ls l"/></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">python中的城市和州明智分析</figcaption></figure><p id="4800" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结构化查询语言</p><figure class="kj kk kl km fd kn"><div class="bz dy l di"><div class="lr ls l"/></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">SQL中的城市和州明智分析</figcaption></figure><p id="5e6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后我们进行工作智能分析</p><p id="eedc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">计算机编程语言</p><figure class="kj kk kl km fd kn"><div class="bz dy l di"><div class="lr ls l"/></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">python中的作业智能分析</figcaption></figure><p id="ee7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">结构化查询语言</p><figure class="kj kk kl km fd kn"><div class="bz dy l di"><div class="lr ls l"/></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">SQL中的作业智能分析</figcaption></figure></div><div class="ab cl jd je gp jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="hb hc hd he hf"><h1 id="b38a" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated">最终比较</h1><p id="1cbc" class="pw-post-body-paragraph if ig hi ih b ii lm ik il im ln io ip iq lo is it iu lp iw ix iy lq ja jb jc hb bi translated">SQL在查询数据方面效率更高，但它的功能较少，而在pandas中，对于大量数据可能会有延迟，但它有更多的功能，使我们能够以有效的方式操作数据。Python也有各种数据可视化库，如matplotlib、seaborn、plotly、Altair等，帮助我们可视化，从而帮助我们更有效地分析数据。</p><p id="08c8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">SQL工作在一个关系模型上，这使得通过键连接表更加容易，并在外键约束的情况下管理其他表中的数据输入，但是Pandas使数据操作更加容易。</p><p id="98d2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Pandas plotting的绘图功能也使我们更容易分析数据，它提供了一个快速绘图功能，使我们能够更好地了解数据。熊猫的变形功能也有助于我们运用各种功能。Pandas join函数还帮助我们连接索引上的数据，merge函数的工作方式类似于SQL，它使我们能够连接两个数据帧中的特定列。</p><p id="62fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您打算操作数据或绘制数据，Pandas会更好，因为它可以在一个地方完成所有操作，而在SQL中，我们必须使用Tableau进行数据可视化</p><p id="f5d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Github仓库的代码:<a class="ae lt" href="https://github.com/aayush1036/data_analysis" rel="noopener ugc nofollow" target="_blank">仓库</a></p><p id="ff66" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的网站:<a class="ae lt" href="https://aayush1036.github.io/profile_website/" rel="noopener ugc nofollow" target="_blank">网站</a></p><p id="3e89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作者:</p><p id="2843" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Aayushmaan Anvesh Jain</p><p id="f10a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢您阅读博客</p></div></div>    
</body>
</html>