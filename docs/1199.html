<html>
<head>
<title>Push AWS S3 files to Google Drive</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将AWS S3文件推送到Google Drive</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/push-aws-s3-files-to-google-drive-dabf5005a278?source=collection_archive---------1-----------------------#2021-02-19">https://medium.com/analytics-vidhya/push-aws-s3-files-to-google-drive-dabf5005a278?source=collection_archive---------1-----------------------#2021-02-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/ab5965eaf5003e388ac6a4310a0455c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0N07MLVct_TDE_OGjRSQKw.png"/></div></div></figure><p id="7da6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本教程中，我将演示如何将AWS与Google Drive集成。我的客户要求每周将包含AWS成本和使用报告数据和图表的Excel文件推送到Google Drive，我希望就我如何着手解决这个问题提供一些见解。我将在后续文章中演示如何使用Python和<a class="ae jo" href="https://boto3.amazonaws.com/v1/documentation/api/latest/index.html" rel="noopener ugc nofollow" target="_blank"> Boto3 </a>和<a class="ae jo" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> pandas </a>来生成包含AWS成本和使用数据的Excel文件，但目前的重点是将AWS与Google Drive集成。</p><p id="0b61" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当我接到这个任务时，我觉得在网上找到一个如何使用Google Drive API的好例子应该很简单。我很快发现了相互矛盾的信息和不完整的代码片段，一些混乱来自实际的Google文档。所以我直接找到了<a class="ae jo" href="https://developers.google.com/drive/api/v3/reference/files/create" rel="noopener ugc nofollow" target="_blank"> Google Drive API </a>的源代码，看看如何推送一个文件，然后从那里开始逆向工作，确定了要创建的AWS Lambda函数的语言。我个人的语言选择是Node、Python、Go或C#，最终我选择了Python，因为它的简单性和在线信息的可用性。当我快完成这项任务时，我确实偶然发现了作为问题可行解决方案的PyDrive，但是我最终使用了Google API Python客户端。</p><p id="9ca6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我在Github中创建了一个演示解决方案<a class="ae jo" href="https://github.com/dspenard/google-drive-with-aws" rel="noopener ugc nofollow" target="_blank"> google-drive-with-aws </a>，我将通过一系列步骤来突出重要的部分。Github中的解决方案并不是全自动的，但是有95%是需要一些手工修改来运行必要的脚本。所以让我们开始吧。</p><h1 id="6e85" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">需要什么？</h1><p id="1eb7" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">从上面显示的交互图中，你可以看到AWS和Google的一些事情。基本步骤是:</p><ol class=""><li id="0eaf" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn kx ky kz la bi translated">创建GCP服务帐户</li><li id="85d7" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">创建Google Drive共享文件夹，并授予访问服务帐户的权限</li><li id="d024" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">部署CloudFormation堆栈以创建S3桶和参数存储参数</li><li id="ddc3" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">使用Google服务帐户凭据和Google Drive共享文件夹ID手动更新参数存储</li><li id="6b87" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">在S3设置测试文件</li><li id="0f55" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">封装Lambda代码和层</li><li id="a8c0" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">部署CloudFormation堆栈来创建Lambda资源</li><li id="9ffe" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">手动测试Lambda函数</li><li id="ec91" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn kx ky kz la bi translated">清理资源</li></ol><p id="5836" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤1 — GCP服务账户</strong></p><p id="1d0c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">除了本教程所要求的之外，我不会详细讨论使用GCP的细节，但是如果你还没有一个GCP帐户，你可以在这里创建一个免费的<a class="ae jo" href="https://cloud.google.com/free" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="4639" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦你有了GCP账户，第一件事就是创建一个项目。GCP的一个项目创建了一个GCP工作负载可以相互隔离的边界，非常类似于AWS帐户或Azure订阅的操作方式。</p><p id="17f9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以选择任何你喜欢的名字，但我选择了google-drive-access，以区别于我在GCP账户中已经有的其他项目。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lg"><img src="../Images/0819d24cb7114280314cbdc3eaef504c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*_roHOR2t3NZ2wlmyUXrF1w.png"/></div></figure><p id="182e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">项目准备就绪后，需要创建一个GCP服务帐户。服务帐户允许您以编程方式利用服务帐户权限所允许的GCP资源。出于我们的目的，该服务帐户将只与Google Drive进行交互，而不会与GCP的任何计算、网络或存储资源进行交互。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ll"><img src="../Images/81c6925555d26683f588f3443354945f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l8GSdxcR6bIrsZtNvONcsQ.png"/></div></div></figure><p id="646c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建服务帐户后，需要创建并下载一个密钥，其中包含JSON形式的凭证信息。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lm"><img src="../Images/d532440259398588e9a0a00d77ad2fdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iFaAEZq1INLalmYgQLsdQw.png"/></div></div></figure><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es ln"><img src="../Images/151a9c2b0919e978fd73f760f6fe247a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*IbBu9mguIm20yAAN7NXg6Q.png"/></div></figure><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lo"><img src="../Images/b3061bcacaece7915a6cde8dc1fce2c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y988jngnPCdaZD4t_4SKDg.png"/></div></div></figure><p id="6e05" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">稍后您将需要凭证文件来让AWS Lambda访问Google Drive。</p><p id="e1ff" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第二步——谷歌驱动</strong></p><p id="3c2b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">既然已经创建了GCP服务帐户，您需要做两件事:启用Google Drive API并允许服务帐户访问Google Drive。</p><p id="1d61" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先是Google Drive API。回到Google控制台，你可以搜索“Google Drive API”来找到你启用它的页面。方便的是，如果你忘记了这一步，当你稍后运行Lambda函数时，你会得到一个漂亮的、干净的错误消息，其中有一个链接指向你可以启用它的地方。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lp"><img src="../Images/1cadb557fee930fa59cadbdf1ad655ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nYsz6-L-S46WgAfhb8S6tA.png"/></div></div></figure><p id="9a8b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是授予服务帐户访问Google Drive的权限。转到Google Drive，创建一个文件夹。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/d9e51a8829afd36d9c72526363870e33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*SywdCy2ekwmP7-MeuVLAEg.png"/></div></figure><p id="1c64" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后点击该文件夹并选择共享。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/249aa1d0c5d2186d23d3bae7694d86e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*hyxnTQK7lsHq4FvFvl8WUA.png"/></div></figure><p id="f492" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后授予服务帐户写入该文件夹的权限。您将使用与服务帐户相关联的电子邮件地址，该地址位于Google Console中服务帐户的详细信息页面下。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/35c4ef4fc9b5e536d295656789ee49f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*70hJ6x27lrgUFljmEW5ouA.png"/></div></figure><p id="9693" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第三步——自动气象站云形成</strong></p><p id="cb72" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我假设你找到本教程是因为你正在使用AWS，需要将文件推送到Google Drive，但如果你还没有使用AWS，你可以在这里创建一个免费帐户<a class="ae jo" href="https://aws.amazon.com/free/?all-free-tier.sort-by=item.additionalFields.SortRank&amp;all-free-tier.sort-order=asc" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="66d3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当我为我的客户创建这个解决方案时，最终结果与我在我的<a class="ae jo" href="https://github.com/dspenard/google-drive-with-aws" rel="noopener ugc nofollow" target="_blank"> Github解决方案</a>中展示的略有不同，它完全是为了演示本教程的要点。我在本教程中决定的是一系列步骤，以最小的痛苦快速启动并运行解决方案，所以希望我能做到。</p><p id="da74" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了让事情进展顺利，我推荐使用<a class="ae jo" href="https://aws.amazon.com/cloudshell/" rel="noopener ugc nofollow" target="_blank"> AWS CloudShell </a>。它为AWS CLI、PowerShell、Bash、Python等提供了一个带有1 GB持久存储和大量预安装库的shell。唯一的要求是，您将用来运行本教程中的脚本的AWS帐户具有访问与本教程相关的shell和资源的适当权限。出于我自己的目的，我用下面显示的附加策略快速创建了一个组，然后将该组分配给我的用户。这肯定是给了太多的权限，所以我不建议在你运行这个解决方案后让你的帐户处于这种状态。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/b4728c1cc6b564def7930282bc0446e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*8JmtczsKvUn3eg2hWwWHnQ.png"/></div></figure><p id="a9d2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在您的AWS帐户已经拥有了必要的权限，启动CloudShell并开始工作。你要做的第一件事就是克隆我的回购协议。</p><pre class="lh li lj lk fd lu lv lw lx aw ly bi"><span id="c753" class="lz jq hi lv b fi ma mb l mc md">git clone <a class="ae jo" href="https://github.com/dspenard/google-drive-with-aws.git" rel="noopener ugc nofollow" target="_blank">https://github.com/dspenard/google-drive-with-aws.git</a></span></pre><p id="9bc0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后转到脚本文件夹。</p><pre class="lh li lj lk fd lu lv lw lx aw ly bi"><span id="0550" class="lz jq hi lv b fi ma mb l mc md">cd google-drive-with-aws/scripts</span></pre><p id="21fd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">然后运行bash脚本build-bucket-and-SSM-resources . sh。这个桶将用于保存要推送到Google Drive的文件以及Lambda代码和层文件。为了简单起见，我选择只有一个桶，但是在一个真实的生产系统中，你通常将Lambda代码和层zip文件放在一个专用的S3桶或一些其他工件存储库中。</p><pre class="lh li lj lk fd lu lv lw lx aw ly bi"><span id="6462" class="lz jq hi lv b fi ma mb l mc md">aws cloudformation create-stack \    <br/>  --stack-name google-drive-bucket-and-ssm \    <br/>  --template-body file://bucket-and-ssm-resources.yaml \    <br/>  --capabilities CAPABILITY_AUTO_EXPAND \    <br/>  --parameters        ParameterKey=LambdaAndReportBucket,ParameterValue=<strong class="lv hj">your-bucket-name</strong> \              ParameterKey=GoogleServiceAccountCredentials,ParameterValue=google-service-account-credentials \        ParameterKey=GoogleDriveFolderId,ParameterValue=google-drive-folder-id</span></pre><p id="e4b8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦选择了bucket名称并运行了脚本，就可以进入AWS控制台检查它的状态。</p><p id="9a3e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤4 — AWS参数存储</strong></p><p id="3ab9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦创建了CloudFormation堆栈，就需要对参数存储进行几次手动更新。Google服务帐户的凭证JSON和Google Drive共享文件夹的ID需要分别放入这些参数中。请注意，由于CloudFormation的限制，数据类型是String而不是SecureString，但这只是一个教程，所以请不要在真实的生产系统中使用明文字符串作为任何秘密信息。对于Google Drive共享文件夹ID，您只需在Google Drive中点击您的文件夹链接即可找到。</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/dd59eba2abf9062bb919aef984ec4bd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n92TY9gEZHHUm0pnf750hg.png"/></div></div></figure><p id="fcce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤5 — S3测试文件</strong></p><p id="c2a3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为我在为我的客户创建这个解决方案时使用的是Excel文件，所以我选择在本教程中保持不变。有几个虚拟的Excel文件可以通过脚本复制到S3。同样，您必须在脚本中指定S3存储桶名称。是的，我可以完全用脚本编写所有这些，但是本教程的重点是使用S3和Lambda的Google Drive，使用CloudFormation部署，而不是Bash脚本或适当的部署管道。</p><pre class="lh li lj lk fd lu lv lw lx aw ly bi"><span id="1472" class="lz jq hi lv b fi ma mb l mc md">bash copy-test-files.sh</span></pre><p id="8249" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第六步—λ</strong></p><p id="ebdc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我不打算详细讨论<a class="ae jo" href="https://github.com/dspenard/google-drive-with-aws/blob/main/src/google-drive-lambda.py" rel="noopener ugc nofollow" target="_blank"> Python脚本</a>中的功能，但基本的是:</p><ul class=""><li id="41b8" class="ks kt hi is b it iu ix iy jb ku jf kv jj kw jn mf ky kz la bi translated">从参数存储中获取Google服务帐户凭据和Google Drive ID</li><li id="80c0" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn mf ky kz la bi translated">使用凭据和驱动器ID连接到Google Drive</li><li id="f6d6" class="ks kt hi is b it lb ix lc jb ld jf le jj lf jn mf ky kz la bi translated">使用Boto3，从S3抓取指定的文件，然后使用<a class="ae jo" href="https://developers.google.com/drive/api/v3/reference/files/create" rel="noopener ugc nofollow" target="_blank"> Google Drive API create命令</a>将它们推送到Google Drive</li></ul><p id="e2ef" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你检查代码，你会发现如果你理解基本的Python，它是非常容易理解的，我甚至留下了一些需要改进的地方。一个这样的例子是当一个文件已经存在时调用<a class="ae jo" href="https://developers.google.com/drive/api/v3/reference/files/update" rel="noopener ugc nofollow" target="_blank"> Google Drive API更新命令</a>。您会注意到，在Google Drive中，文件名并不被认为是不同的，如果您多次为同名文件调用create，就会出现重复。此外，应该添加一些防御性的编码技术来使事情更加严密。</p><p id="3e00" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要压缩Lambda代码及其层并为部署做好准备，请运行脚本build-packages.sh，在此之前再次修改bucket名称，以匹配您使用第一个CloudFormation模板创建的bucket。我选择为Lambda层包含整个google-api-python-client库，这在4 MB以上有点大，所以如果在生产系统中这样做，请随意只为您的层包含绝对最小的库。</p><pre class="lh li lj lk fd lu lv lw lx aw ly bi"><span id="9271" class="lz jq hi lv b fi ma mb l mc md">bash build-packages.sh</span></pre><p id="dd6e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第7步—更多自动气象站云形成</strong></p><p id="4e78" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这一点上，S3桶已经建立了虚拟测试文件和Lambda代码压缩文件和层压缩文件，参数存储有什么Lambda需要连接到谷歌驱动器。现在是时候用已经设置好的父栈的子栈来部署Lambda函数了。对于这个脚本build-lambda-resources.sh，如果没有保留我在脚本中指定的默认名称来部署第3步中的第一个堆栈，那么只需修改指定的堆栈名称。</p><pre class="lh li lj lk fd lu lv lw lx aw ly bi"><span id="7b08" class="lz jq hi lv b fi ma mb l mc md">aws cloudformation create-stack \    <br/>  --stack-name google-drive-lambda \    <br/>  --template-body file://lambda-resources.yaml \    <br/>  --capabilities CAPABILITY_AUTO_EXPAND CAPABILITY_NAMED_IAM \    <br/>  --parameters ParameterKey=ParentStackName,ParameterValue=<strong class="lv hj">google-drive-bucket-and-ssm</strong></span></pre><p id="edd9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦您确认父栈名称是正确的，并运行脚本来部署栈，进入AWS控制台检查它的状态。</p><p id="6c19" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤8 —测试λ值</strong></p><p id="213e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在进入最精彩的部分，看看这东西是否真的有用。转到AWS控制台的Lambda函数google-drive-lambda，并使用适当的有效负载创建一个测试事件。随你怎么称呼它，然后点击Test，你就可以开始了。请注意，对于本教程，我选择让一个有效负载指定一个文件列表，以便从S3获取并推送到Google Drive，但是在实际的生产系统中，您可以从S3事件触发器中触发Lambda，或者选择其他路径。</p><pre class="lh li lj lk fd lu lv lw lx aw ly bi"><span id="d036" class="lz jq hi lv b fi ma mb l mc md">{    <br/>  "fileList": [      <br/>    "Report1.xlsx",      <br/>    "Report2.xlsx",      <br/>    "Report3.xlsx"    <br/>  ]<br/>}</span></pre><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/8f0681fc76931fd7098061ae06e5e298.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CD9BKtgmJ405I31SAzKGJQ.png"/></div></div></figure><p id="55e6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">瞧，你刚刚把文件从S3推到了谷歌驱动器上！</p><figure class="lh li lj lk fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/b3a254ae487adf3348d7c6a3dc1f5f61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p2hhYY7d0vS_JOXuLAE2cg.png"/></div></div></figure><p id="61cc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤9——清理</strong></p><p id="e392" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我没有编写AWS资源清理过程的脚本，但是它非常简单。在AWS控制台中，手动删除S3存储桶中的文件，然后进入CloudFormation并删除两个堆栈，从子堆栈google-drive-lambda开始，然后到父堆栈google-drive-bucket-and-ssm。应该可以了。编码快乐！</p></div></div>    
</body>
</html>