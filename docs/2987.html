<html>
<head>
<title>Sentiment Analysis on OpinRank Dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">OpinRank数据集上的情感分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sentiment-analyzer-on-opinrank-dataset-4e961dcaecbc?source=collection_archive---------12-----------------------#2021-05-28">https://medium.com/analytics-vidhya/sentiment-analyzer-on-opinrank-dataset-4e961dcaecbc?source=collection_archive---------12-----------------------#2021-05-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/a2c61bce91cad45abc6e693303e774c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mm8WAV3shOWmAUjpx7WabQ.jpeg"/></div></div></figure><p id="c131" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">今天生成的大量数据是非结构化的，需要经过处理才能产生洞察力。非结构化数据的一些例子是新闻文章、社交媒体上的帖子、产品和地点的评论以及搜索历史。分析自然语言并从中理解意义的过程属于自然语言处理(NLP)领域。情感分析是一项常见的自然语言处理任务，它包括将文本或部分文本分类为预定义的情感。我们将使用<a class="ae jo" href="https://www.nltk.org/" rel="noopener ugc nofollow" target="_blank">自然语言工具包(NLTK)</a>(Python中常用的NLP库)来分析文本数据。</p><p id="931b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">NLTK库包含各种实用程序，允许您有效地操作和分析语言数据。在它的高级特性中有<strong class="is hj">文本分类器</strong>，你可以使用它进行多种分类，包括情感分析。</p><p id="1dee" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">情感分析</strong>是使用算法将相关文本的各种样本分类为整体积极和消极类别的实践。使用NLTK，您可以通过强大的内置机器学习操作来使用这些算法，以从语言数据中获得洞察力。</p><h1 id="7d94" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">安装和导入</h1><p id="b90a" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">您将从安装一些先决条件开始，包括NLTK本身以及贯穿本教程所需的特定资源。</p><p id="b363" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，使用<code class="du ks kt ku kv b"><a class="ae jo" href="https://realpython.com/what-is-pip/" rel="noopener ugc nofollow" target="_blank">pip</a></code>安装NLTK:</p><pre class="kw kx ky kz fd la kv lb lc aw ld bi"><span id="0bc5" class="le jq hi kv b fi lf lg l lh li">$ python3 -m pip install nltk</span></pre><p id="a13f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">虽然这将安装NLTK模块，但是您仍然需要获得一些额外的资源。其中一些是文本样本，另一些是某些NLTK函数需要的数据模型。</p><p id="018f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要获得您需要的资源，请使用<code class="du ks kt ku kv b">nltk.download()</code>:</p><pre class="kw kx ky kz fd la kv lb lc aw ld bi"><span id="f78b" class="le jq hi kv b fi lf lg l lh li">import nltk<br/><br/>nltk.download()</span></pre><p id="b09e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当我们执行情感分析时，我们将使用NLTK中的vader_lexicon包。</p><ul class=""><li id="b991" class="lj lk hi is b it iu ix iy jb ll jf lm jj ln jn lo lp lq lr bi translated"><code class="du ks kt ku kv b">vader_lexicon</code> <strong class="is hj"> : </strong>由C.J .休顿和Eric Gilbert创建的NLTK在执行情感分析时引用的单词和术语的评分列表<a class="ae jo" href="https://github.com/cjhutto/vaderSentiment" rel="noopener ugc nofollow" target="_blank"/></li></ul><p id="ea43" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> OpinRank数据集:</strong></p><p id="ec3b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">OpinRank数据集包含实体(即汽车和酒店)的用户评论。它们构成了来自Tripadvisor(约259，000条评论)和Edmunds(约42，230条评论)的完整评论。数据集可以在链接中找到—<a class="ae jo" href="https://github.com/kavgan/OpinRank.git" rel="noopener ugc nofollow" target="_blank">https://github.com/kavgan/OpinRank.git</a></p><p id="5561" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该数据集最适用于分析文本数据、情感分析、数据汇总、评论分类以及文本挖掘中的许多其他功能。</p><p id="906f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">数据集采用以下格式:</p><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ls"><img src="../Images/67f6306d20fd0a3ad3f293cd61b9b78c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8t1gKyxOb-0utfUgx-BoOA.png"/></div></div></figure><p id="2a33" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">将上述标签格式转换为CSV格式:</strong></p><p id="ebb6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为此，我们将使用几个库。我们需要下载的第一个库是<a class="ae jo" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" rel="noopener ugc nofollow" target="_blank"> beautiful soup </a>，这是一个非常有用的Python抓取工具。在命令提示符下执行以下命令，下载漂亮的Soup实用程序。</p><pre class="kw kx ky kz fd la kv lb lc aw ld bi"><span id="f631" class="le jq hi kv b fi lf lg l lh li">$ python3 -m pip install beautifulsoup4</span></pre><p id="84fb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们需要解析XML和HTML的另一个重要库是<a class="ae jo" href="https://lxml.de/" rel="noopener ugc nofollow" target="_blank"> lxml </a>库。在命令提示符下执行以下命令来下载<code class="du ks kt ku kv b">lxml</code>:</p><pre class="kw kx ky kz fd la kv lb lc aw ld bi"><span id="d5c3" class="le jq hi kv b fi lf lg l lh li">$ python3 -m pip install lxml</span></pre><p id="8fdd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们使用一些python代码将数据从标记格式转换为CSV格式。使用Jupyter笔记本体验更好。</p><pre class="kw kx ky kz fd la kv lb lc aw ld bi"><span id="d5f2" class="le jq hi kv b fi lf lg l lh li"><em class="lt">#changing data from tag format into csv data</em><br/><em class="lt">#import BeautifulSoup package</em><br/><strong class="kv hj">from bs4 import BeautifulSoup</strong></span><span id="8984" class="le jq hi kv b fi lu lg l lh li"><em class="lt">#data file to load the data<br/></em><strong class="kv hj">data_file = "2009_audi_/2009_audi_a5"<br/></strong><em class="lt">#csv file to convert data in tag format into csv format<br/></em><strong class="kv hj">csv_file = "2009_audi_/2009_audi_a5.csv"</strong></span><span id="ec3a" class="le jq hi kv b fi lu lg l lh li"><em class="lt">#loading data from the data file in text format<br/></em><strong class="kv hj">with open(data_file) as txt_file:<br/>    data = txt_file.read()</strong></span><span id="7780" class="le jq hi kv b fi lu lg l lh li"><em class="lt">#using Beautiful soup to get the data into html format<br/></em><strong class="kv hj">soup = BeautifulSoup(data, 'lxml')</strong></span><span id="c36d" class="le jq hi kv b fi lu lg l lh li"><em class="lt">#taking list to load the data into csv format<br/></em><strong class="kv hj">csv_data = []<br/></strong><em class="lt">#headers for the csv format<br/></em><strong class="kv hj">csv_data.append(["date","author","text","favorite"])<br/></strong><em class="lt">#finding and printing the data of "doc" format<br/></em><strong class="kv hj">for doc_tag in soup.find_all("doc"):<br/></strong>    <em class="lt">#loading data in list to append the cummulated data to upper list</em><br/><strong class="kv hj">    raw_data = []<br/></strong><em class="lt">    #getting each values for a respective doc tag<br/></em>    <strong class="kv hj">raw_data.append(doc_tag.find("date").text)<br/>    raw_data.append(doc_tag.find("author").text)<br/>    raw_data.append(doc_tag.find("text").text)<br/>    raw_data.append(doc_tag.find("favorite").text)<br/>    csv_data.append(raw_data)</strong></span><span id="fbdc" class="le jq hi kv b fi lu lg l lh li"><em class="lt">#Converting list of lists to CSV<br/></em><strong class="kv hj">import csv<br/></strong><br/><em class="lt">#function to convert list of lists to csv format<br/></em><strong class="kv hj">def write_csv(file,data):<br/>    with open(file, 'w', newline='') as file:<br/>        writer = csv.writer(file)<br/>        writer.writerows(data)</strong></span><span id="3d90" class="le jq hi kv b fi lu lg l lh li"><em class="lt">#loading the data into csv format<br/></em><strong class="kv hj">write_csv(csv_file,csv_data)</strong></span></pre><p id="b9e4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们已经成功地将tag格式的数据转换为CSV格式。我已经将数据保存为CSV格式，这样我就可以为那些希望结果比工作更快的人共享这些文件。相反，你可以直接把它转换成熊猫数据帧。</p><p id="6ba3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">构建情感分析器:</strong></p><p id="c68c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦CSV格式的数据准备就绪，我们需要构建一个情感分析器来对评级进行分类并计算评级得分。</p><p id="57b2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，让我们使用一些python代码来完成这项任务。</p><pre class="kw kx ky kz fd la kv lb lc aw ld bi"><span id="47c5" class="le jq hi kv b fi lf lg l lh li"><strong class="kv hj">import pandas as pd</strong></span><span id="9a05" class="le jq hi kv b fi lu lg l lh li"><em class="lt">#loading the csv data into dataframe<br/></em><strong class="kv hj">df = pd.read_csv(csv_file)<br/>df.head(5)</strong></span></pre><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es lv"><img src="../Images/e2794a4eea3caa0710f598b163c2407c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*-aQd1ZE4WUeZzzrlqJ6SiQ.png"/></div></figure><pre class="kw kx ky kz fd la kv lb lc aw ld bi"><span id="3c79" class="le jq hi kv b fi lf lg l lh li"><em class="lt">#Using nltk to load the sentiment analyzer<br/></em><strong class="kv hj">import nltk<br/>nltk.download('vader_lexicon')</strong></span></pre><p id="012b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将使用来自<em class="lt">nltk . perspective . Vader</em>包的一个名为<em class="lt">SentimentIntensityAnalyzer()</em>的函数。<a class="ae jo" href="https://www.nltk.org/api/nltk.sentiment.html" rel="noopener ugc nofollow" target="_blank">情感分析器</a>可以使用NLTK算法和功能实现和促进情感分析任务，因此无需复杂的编码就可以生成情感得分。在使用它之前，我们需要调用它。</p><pre class="kw kx ky kz fd la kv lb lc aw ld bi"><span id="bfc5" class="le jq hi kv b fi lf lg l lh li"><em class="lt">#using sentiment analyzer of nltk<br/></em><strong class="kv hj">from nltk.sentiment.vader import SentimentIntensityAnalyzer<br/></strong><br/><em class="lt">#loading sentiment Analyzer<br/></em><strong class="kv hj">sid = SentimentIntensityAnalyzer()</strong></span></pre><p id="a267" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上述函数将生成极性得分。我们将得到四种类型的分数:负面的、中性的、正面的和复合的。我们将使用复合分数作为评级分数，因为我们可以通过保持特定阈值来使用它对评论进行分类。</p><pre class="kw kx ky kz fd la kv lb lc aw ld bi"><span id="6661" class="le jq hi kv b fi lf lg l lh li"><em class="lt">#storing scores<br/></em><strong class="kv hj">scores = []<br/></strong><br/><em class="lt">#iterating every review<br/></em><strong class="kv hj">for i in df["text"]:</strong><br/><em class="lt">    #calculating the sentiment score</em><br/><strong class="kv hj">    scores.append(sid.polarity_scores(i)["compound"]<br/></strong><br/><em class="lt">#loading rating score to dataframe<br/></em><strong class="kv hj">df["rating_score"] = scores<br/>df.head(10)</strong></span></pre><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/4af9ae9d7909846626dc53a948720c1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*W8Ewwnzwy2wwjHZ672Gm5A.png"/></div></figure><p id="fdd9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里，我们可以观察到评分的范围从负值到大约0.98。因此，通过应用某些阈值，我们可以更改上面的代码，并可以将评级分为积极、消极和中性。</p><pre class="kw kx ky kz fd la kv lb lc aw ld bi"><span id="4ac3" class="le jq hi kv b fi lf lg l lh li"><em class="lt">#lower and upper thresholds<br/></em><strong class="kv hj">threshold_lower = 0.4<br/>threshold_upper = 0.85</strong></span></pre><p id="aed4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">上述阈值是在对评级分数和评级进行统计观察后选择的。</p><pre class="kw kx ky kz fd la kv lb lc aw ld bi"><span id="8d1b" class="le jq hi kv b fi lf lg l lh li"><em class="lt">#storing scores and rating<br/></em><strong class="kv hj">scores = []<br/>rating = []</strong><br/><br/><em class="lt">#iterating every review<br/></em><strong class="kv hj">for i in df["text"]:</strong><em class="lt"><br/></em>    <em class="lt">#calculating the sentiment score and comparing threshold</em><br/>    <strong class="kv hj">if sid.polarity_scores(i)["compound"] &lt; threshold_lower:<br/>        rating.append("Negative")<br/>    elif sid.polarity_scores(i)["compound"] &lt; threshold_upper:<br/>        rating.append("Neutral")</strong><br/>    <strong class="kv hj">else:<br/>        rating.append("Positive")</strong><br/><em class="lt">    #appending scores<br/></em><strong class="kv hj">    scores.append(sid.polarity_scores(i)["compound"])<br/></strong><br/><em class="lt">#loading rating score and rating to dataframe<br/></em><strong class="kv hj">df["rating_score"] = scores<br/>df["rating"] = rating<br/>df.head(10)</strong></span></pre><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/d3f6f0b41e8e978f9b6a0eb0c3d3f6d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*JFhoJ13z0hSDiVwzcX3O3w.png"/></div></figure><p id="46b3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，我们实现了我们的目标，并将评级分为积极、消极和中立。完整的结构化代码可以在—<a class="ae jo" href="https://github.com/muttinenisairohith/OpinRank.git" rel="noopener ugc nofollow" target="_blank">https://github.com/muttinenisairohith/OpinRank.git</a>找到</p><p id="3e95" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以进一步分析评论并添加其他功能，如-</p><ul class=""><li id="0811" class="lj lk hi is b it iu ix iy jb ll jf lm jj ln jn lo lp lq lr bi translated">建立一个模型来总结人们喜欢/讨厌该产品的主要原因。</li><li id="39a6" class="lj lk hi is b it ly ix lz jb ma jf mb jj mc jn lo lp lq lr bi translated">通过提取其他产品的评论并推荐更好的产品，将情感得分与其他产品进行比较。</li><li id="eed8" class="lj lk hi is b it ly ix lz jb ma jf mb jj mc jn lo lp lq lr bi translated">基于评论生成为用户提供附加信息的特定主题的情感得分。</li></ul><p id="3b5b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以上话题将在我们以后的文章中涉及。</p><p id="8e73" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">敬请关注。</p></div></div>    
</body>
</html>