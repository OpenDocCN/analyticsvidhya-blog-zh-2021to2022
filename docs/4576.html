<html>
<head>
<title>A quick guide to using Loguru</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Loguru的快速指南</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-quick-guide-to-using-loguru-4042dc5437a5?source=collection_archive---------1-----------------------#2021-11-21">https://medium.com/analytics-vidhya/a-quick-guide-to-using-loguru-4042dc5437a5?source=collection_archive---------1-----------------------#2021-11-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b283" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是时候停止使用<em class="jd"> print("here") </em>来调试我们的程序了。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/2ed7447671ae7d124513e4bafbb03d02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ELdrn2i5hmYRO2y3"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">由<a class="ae ju" href="https://unsplash.com/@max_duz?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Max Duzij </a>在<a class="ae ju" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="37c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">日志记录在软件开发领域是必不可少的。它帮助程序员和系统管理员了解应用程序的状态，并在出现任何问题时帮助调试。想象一下，一觉醒来，发现你运行了一夜的程序崩溃了，却没有留下任何线索。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jv"><img src="../Images/f0a60bf5c7257860f7ce4a13608b001c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/0*aVtwcl0Af4WrDCzg"/></div></figure><p id="980e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我想简单介绍一下Loguru (<a class="ae ju" href="https://pypi.org/project/loguru/" rel="noopener ugc nofollow" target="_blank"/>——这是一个Python包，它以让日志记录变得更轻松、更有趣而自豪。</p></div><div class="ab cl jw jx gp jy" role="separator"><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb kc"/><span class="jz bw bk ka kb"/></div><div class="hb hc hd he hf"><h1 id="b00a" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">洛格鲁101</h1><p id="b919" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">让我们直接开始吧！这里有一个简单的例子。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lg lh l"/></div></figure><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">你的第一个使用Loguru的程序</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es li"><img src="../Images/56da33a5ba44e0ca4181a3e1c552bd7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2q_Gsd6MebCUoTidtzToKA.jpeg"/></div></div></figure><p id="602b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经看到我们的日志程序返回了比我们预期的更多的信息。它返回了时间戳、日志级别、调用日志记录器的位置以及我们传递的日志消息。</p><h1 id="b785" class="kd ke hi bd kf kg lj ki kj kk lk km kn ko ll kq kr ks lm ku kv kw ln ky kz la bi translated">自定义日志消息</h1><h2 id="f33b" class="lo ke hi bd kf lp lq lr kj ls lt lu kn iq lv lw kr iu lx ly kv iy lz ma kz mb bi translated">1.自定义消息格式</h2><p id="66dc" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">上面的片段已经覆盖了90%用户的需求。但是Loguru提供了更多的灵活性，其中之一是定制日志消息格式。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">自定义日志消息格式</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mc"><img src="../Images/23c68f847db45a260c08fc77e23b453d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YPVs6QxMnjhzz7HvIx0bLw.jpeg"/></div></div></figure><p id="6a6c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们逐一浏览每一行:</p><ul class=""><li id="c83b" class="md me hi ih b ii ij im in iq mf iu mg iy mh jc mi mj mk ml bi translated">logger.remove(0):这一行删除默认的(0ᵗʰ)处理程序。这需要完成，否则我们会收到同一个日志语句的多个日志消息。传递<em class="jd"> None </em>删除所有处理程序。</li><li id="23f2" class="md me hi ih b ii mm im mn iq mo iu mp iy mq jc mi mj mk ml bi translated">logger.add(…):这一行添加新的处理程序。唯一必需的参数是<em class="jd">接收器</em>，它是一个接收日志消息的对象。format参数指定日志的自定义格式。我们可以利用关键字(例如<em class="jd">级别</em>、<em class="jd">时间</em>、<em class="jd">消息</em>)来提供更多上下文信息。将<em class="jd"> colorize </em>设置为true允许使用标记标签给文本着色。着色不仅限于字体颜色，你也可以设置背景和文本样式。</li></ul><h2 id="f318" class="lo ke hi bd kf lp lq lr kj ls lt lu kn iq lv lw kr iu lx ly kv iy lz ma kz mb bi translated">2.添加额外信息</h2><p id="7121" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">除了记录器提供的键，我们可以通过使用<em class="jd"> bind() </em>方法添加额外的变量。看看下面的例子。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">使用bind()添加更多信息</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mc"><img src="../Images/0d3e141092ddca522e012fd151e58c9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bt6Cktg0Fvmf6M1wWGSENQ.jpeg"/></div></div></figure><p id="7fed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">像往常一样，我们导入必要的模块并删除默认的处理程序。接下来，我们创建新的处理程序，并通过添加时间(顺便提一下，<a class="ae ju" href="https://loguru.readthedocs.io/en/stable/api/logger.html#time" rel="noopener ugc nofollow" target="_blank">也可以格式化为</a>)、严重性级别、我们的自定义变量和消息来格式化它。我们使用<em class="jd"> bind() </em>方法来传递变量，并使用<em class="jd"> extra </em>字典来解析变量。</p><h1 id="09d2" class="kd ke hi bd kf kg lj ki kj kk lk km kn ko ll kq kr ks lm ku kv kw ln ky kz la bi translated">写入日志文件</h1><p id="cb7a" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">将日志消息重定向到文件非常简单，只需将默认接收器(<em class="jd"> sys.stderr </em>)更改为日志文件的名称。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">写入日志文件</figcaption></figure><p id="4f7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">处理器还可以配置其他逻辑，例如保持、旋转和压缩。下面是取自文档的另一个示例。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">旋转、保持和压缩示例</figcaption></figure><h1 id="89a1" class="kd ke hi bd kf kg lj ki kj kk lk km kn ko ll kq kr ks lm ku kv kw ln ky kz la bi translated">记录和诊断异常</h1><p id="1384" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">Loguru允许调试python程序容易得多。这可以通过将<em class="jd">回溯</em>和<em class="jd">诊断</em>参数设置为<em class="jd">真</em>来实现。<em class="jd">回溯</em>显示所有被调用的函数，而<em class="jd">诊断</em>显示传递给该函数的参数值。以下是取自文档的修改示例。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">使用Loguru诊断异常</figcaption></figure><p id="0140" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是生成的日志文件。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">out.log文件</figcaption></figure><p id="a2a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您计划在生产环境中使用Loguru，请小心使用这些设置，因为它们可能会泄漏信息。</p><h1 id="5a75" class="kd ke hi bd kf kg lj ki kj kk lk km kn ko ll kq kr ks lm ku kv kw ln ky kz la bi translated">额外信息</h1><p id="d16d" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">如果您阅读本文是为了快速了解如何使用Loguru，那么上面所有的例子都足够了。如果您仍然有兴趣了解更多，这里有一些可能有帮助的特性。</p><p id="6b95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.所有上下文信息都存储在<a class="ae ju" href="https://loguru.readthedocs.io/en/stable/api/logger.html#record" rel="noopener ugc nofollow" target="_blank"> <em class="jd">记录</em> </a> <em class="jd"> </em>字典中。下面是一个使用<em class="jd">消逝</em>和<em class="jd">文件</em>键的例子。另外，请注意我们如何使用<em class="jd"> time </em>键来命名日志文件。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">其他可能有用的密钥</figcaption></figure><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">out.log文件</figcaption></figure><p id="ba4b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.logger可以与python上下文管理器一起使用，并且可以帮助更容易地添加额外的上下文信息(否则使用<em class="jd"> bind() </em>方法完成)。下面的代码片段展示了我们如何重写我们之前的例子，在这里我们使用了<em class="jd"> bind() </em>。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">通过上下文管理器使用Loguru</figcaption></figure><p id="2070" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.<em class="jd"> patch() </em>方法<em class="jd"> </em>可用于更新<em class="jd">记录</em>字典。对<em class="jd">记录["extra"] </em>而不是<em class="jd">记录</em>应用修改总是更好，因为Loguru内部使用来自<em class="jd">记录</em>的值，修改它会导致意想不到的结果。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">使用patch()修改记录字典中的值</figcaption></figure><p id="7b32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.以下是格式化日志消息的各种其他方法:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">格式化消息的各种方式</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mr"><img src="../Images/64b81e69c826867f6740836db15f6873.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xe-govi9KdhdDTv_FUqdOQ.png"/></div></div></figure><p id="b401" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个特殊的<level>(缩写为<lvl>)标记对应于日志消息的严重性颜色。</lvl></level></p><p id="7148" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.根据您的场景，可以使用多个级别:跟踪、调试、信息、成功、警告、错误、严重。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">洛格鲁级别</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ms"><img src="../Images/23cdb164cd8a70d775e8e293966fc939.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UkIdzohAcXXHIuuE8uC_Iw.jpeg"/></div></div></figure><p id="fe9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">停下来。跟踪消息在哪里？这是因为默认情况下，记录器捕获的最低严重性是调试级别。为了包含跟踪级别，需要通过将<em class="jd">级别</em>设置为“跟踪”来修改处理程序。你甚至还可以添加自己的关卡。这里有一个稍加修改的例子，摘自<a class="ae ju" href="https://pypi.org/project/loguru/" rel="noopener ugc nofollow" target="_blank"> Loguru PyPI页面</a>。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">自定义蛇形关卡</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mc"><img src="../Images/95445abc85173502108994dd49d9b7d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*umUsvKjpvBExjRodYnJSig.png"/></div></div></figure><p id="af7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.最后，Loguru允许使用f字符串格式化消息。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="lg lh l"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">洛格鲁使用f弦</figcaption></figure><h1 id="f2f1" class="kd ke hi bd kf kg lj ki kj kk lk km kn ko ll kq kr ks lm ku kv kw ln ky kz la bi translated">结论——关于简单性和用法的一句话</h1><p id="7b29" class="pw-post-body-paragraph if ig hi ih b ii lb ik il im lc io ip iq ld is it iu le iw ix iy lf ja jb jc hb bi translated">就像我写的关于Colorama ( <a class="ae ju" rel="noopener" href="/analytics-vidhya/colorama-a-hidden-convinience-6fb22dc00835">无耻插件</a>)的文章一样，我还没有超过一周的使用Loguru的经验，我希望它有助于传达为什么Loguru是一个可以很容易拿起并且使用起来很有趣的包。</p><p id="9c99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这篇文章并没有涵盖Loguru能够实现的所有功能，更不用说它与其他包的集成，如<a class="ae ju" href="https://pypi.org/project/notifiers/" rel="noopener ugc nofollow" target="_blank">通知程序</a>向您的Gmail、Telegram或Slack发送日志消息。</p><p id="9cd9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">房间里还有另一只大象我想坦白——我还没有提到Python的内置日志模块。这是经过深思熟虑的，因为我假设你们中的许多人已经熟悉了默认的内置模块，我无法让自己再次复制所有的代码片段😅。我强烈建议你自己尝试感受一下不同之处。</p><blockquote class="mt"><p id="2cd1" class="mu mv hi bd mw mx my mz na nb nc jc dx translated">“我选择一个懒惰的人去做艰苦的工作。因为一个懒惰的人会找到一个简单的方法去做。”</p><p id="01d1" class="mu mv hi bd mw mx my mz na nb nc jc dx translated">—比尔·盖茨</p></blockquote><p id="33d1" class="pw-post-body-paragraph if ig hi ih b ii nd ik il im ne io ip iq nf is it iu ng iw ix iy nh ja jb jc hb bi translated">尽管loguru模块可能看起来比默认的日志模块更方便，但是总有一些情况下使用默认模块是最好的。2021年12月的Log4j漏洞突然引起了人们对软件安全，尤其是开源软件的关注。如果你不能完全确定使用loguru的优点是否超过了它潜在的缺点，那么最好坚持使用默认包。</p><p id="4f23" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">日志记录是任何开发人员工作中绝对重要的一部分。它不仅是一个伪文档，也是一个救命稻草。在正确的时间返回正确的日志消息可能是快速修复代码和彻夜不眠找出问题所在的区别。尽管日志记录很重要，但重要的是要强调，经常遵循敏捷开发的开发人员不能花太多时间配置或设置日志记录程序，这就是为什么我觉得Loguru是使用的完美包。</p><p id="cee2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我想写这篇文章，因为在媒体上或者一般的网上没有很多关于Loguru包的介绍性文章。我强烈建议你查看一下PyPI页面和T2文档，了解更多信息。</p></div></div>    
</body>
</html>