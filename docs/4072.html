<html>
<head>
<title>How To Use CNN Models With Full Potential?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用潜力满满的CNN模型？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-use-cnn-models-with-full-potential-2bc16d5f82a6?source=collection_archive---------7-----------------------#2021-08-23">https://medium.com/analytics-vidhya/how-to-use-cnn-models-with-full-potential-2bc16d5f82a6?source=collection_archive---------7-----------------------#2021-08-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="8960" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">什么是CNN模型？</h1><p id="3cd0" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">CNN模型是一种深度学习算法，用于训练分类模型。然而，使用CNN模型的方式取决于图像/视频(每秒帧数)是否计入每个示例中。</p><p id="dc81" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">CNN模型有两种主要的分类问题:</p><ol class=""><li id="fe12" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated">二元分类</li><li id="fdd4" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">多类分类</li></ol><h2 id="8db4" class="kt if hh bd ig ku kv kw ik kx ky kz io jn la lb is jr lc ld iw jv le lf ja lg bi translated">二元分类:</h2><p id="d2e5" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">二元分类处理2个类别，即只有2种类型的图像是模型中特定的输入。</p><p id="ee99" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">举例:</strong></p><ul class=""><li id="ce27" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz lh kl km kn bi translated">猫和狗</li><li id="cec0" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz lh kl km kn bi translated">苹果和芒果</li></ul><p id="eafa" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在这种分类模式下，整个CNN模型非常相似，除了输出层之外没有任何变化。在输出层，我们只使用一个神经元和Sigmoid激活函数，因为它更可靠，并且处理二进制预测。Sigmoid激活函数仅预测一个介于0和1之间的值。</p><h2 id="51fe" class="kt if hh bd ig ku kv kw ik kx ky kz io jn la lb is jr lc ld iw jv le lf ja lg bi translated">多类分类:</h2><p id="e510" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">相反，在多类分类中，你有优势对2种以上的图像进行分类。所以这里你可以有从2到n的任意数量的类。</p><p id="3028" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">举例:</strong></p><ul class=""><li id="0f58" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz lh kl km kn bi translated">猫，狗，人。</li><li id="a9b7" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz lh kl km kn bi translated">任何N个水果。</li><li id="44ca" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz lh kl km kn bi translated">任意N辆车。</li></ul><p id="aeda" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">这里有两种以上的图像类型，我们使用不同的方法。这里，输出层由N(即，作为神经元数量的图像类型总数)和名为Softmax的激活函数组成，以进行预测。</p><h1 id="815c" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">如何将CNN模型用于上述任何一种情况？</h1><p id="df12" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">首先，这两种类型没有太大区别。因此，将根据项目需要建立模型。</p><p id="0fd6" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">基本CNN模型包含4个主要层:</p><ol class=""><li id="ceb2" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated">Con2d</li><li id="3f5c" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">Maxpooling2d</li><li id="a006" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">变平</li><li id="7877" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">稠密的</li></ol><p id="d9f4" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">而一个更复杂、功能更强大的CNN模型由更少的层组成，上面有4层:</p><ol class=""><li id="0efa" class="kf kg hh je b jf ka jj kb jn kh jr ki jv kj jz kk kl km kn bi translated">批量生产</li><li id="83c6" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">拒绝传统社会的人</li></ol><p id="74da" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">以下是如何使用它们的快照。</p><h2 id="8015" class="kt if hh bd ig ku kv kw ik kx ky kz io jn la lb is jr lc ld iw jv le lf ja lg bi translated">基本CNN模型:</h2><figure class="li lj lk ll fd lm er es paragraph-image"><div class="ab fe cl ln"><img src="../Images/31573030d1a65a61fbd5e375cc6c1f55.png" data-original-src="https://miro.medium.com/v2/format:webp/1*b31hiO4ynbDLRrXWEFF4aQ.png"/></div></figure><p id="c920" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">正如我上面提到的，一个4层将完成工作，调整你的图像尺寸，数据集大小(每种类型的图像数量)，我将在稍后的数据扩充部分讨论。因此，目前这个基本的CNN可以解决大多数分类问题。层的形成取决于图像的尺寸。</p><p id="953a" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">举例:</strong></p><p id="8d89" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">如果图像是100×100，您需要将尺寸减小到8×8或7×7的最佳尺寸。</p><p id="a2b7" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">如果图像是500×500，那么你可能需要添加更多的层。因此，您可以打印模型摘要来检查尺寸减少到了多少。</p><h2 id="7419" class="kt if hh bd ig ku kv kw ik kx ky kz io jn la lb is jr lc ld iw jv le lf ja lg bi translated">复杂的CNN:</h2><figure class="li lj lk ll fd lm er es paragraph-image"><div class="ab fe cl ln"><img src="../Images/31573030d1a65a61fbd5e375cc6c1f55.png" data-original-src="https://miro.medium.com/v2/format:webp/1*b31hiO4ynbDLRrXWEFF4aQ.png"/></div></figure><p id="e778" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在这里，你可以看到我添加了几层，它们与其他几层结合在一起。将逐一讨论合并这些层背后的原因:</p><p id="f801" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">然而，添加批量归一化层通过输入层的归一化显著减少训练深度网络所需的训练时期的数量，使得CNN模型更快且更稳定。</p><p id="f734" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">因此，添加丢弃层有助于移除包含相同值的不明确节点。Dropout有助于避免过度拟合，因为它删除了大多数重复的节点，这些节点也在每个时期后给CNN模型相同的值。</p><p id="7650" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在建立了CNN模型之后，它需要被编译。</p><figure class="li lj lk ll fd lm er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lq"><img src="../Images/ed936550bdfacdeabab60ec12bf82c99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oTfPwS2d3uPcnlgU"/></div></div></figure><p id="d9fb" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">注:</strong>此处的损耗变量根据CNN模型类型(二进制或多进制)而变化，因此需要进行相应的改变。</p><h1 id="af93" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">那么，数据是如何进入CNN模型的呢？</h1><p id="9157" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">有一个被称为<strong class="je hi">数据增强</strong>的部分，它在数据被发送到管道之前处理数据预处理。数据扩充不过是基本的图形操作(如旋转、平移、缩放等)。所有这些操作都是在模型执行过程中发生的，使用数据扩充的主要原因是为了避免使用其他库进行手工数据预处理。</p><p id="5ad3" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">正如我上面提到的，数据扩充在具有较小数据集(每种图像类型几百个)的项目中起着巨大的作用。最好保持最佳的数据集大小，每个图像类型/类别至少有200个图像，尺寸为100 X 100。</p><p id="8fb0" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">即使这被认为是较小的，但数据扩充可以帮助您在运行时创建每个映像的更多副本，您无需担心在哪里存储这些副本，因为它们存储在RAM中，执行后创建的副本会被销毁。</p><figure class="li lj lk ll fd lm er es paragraph-image"><div class="ab fe cl ln"><img src="../Images/31573030d1a65a61fbd5e375cc6c1f55.png" data-original-src="https://miro.medium.com/v2/format:webp/1*b31hiO4ynbDLRrXWEFF4aQ.png"/></div></figure><p id="0dc8" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">这是数据扩充块的样子。</p><p id="d0c4" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">正如你所看到的，这里给出的操作是合并到一个库中的基本图像处理功能。</p><h1 id="fd11" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">结论:</h1><p id="e2b6" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">CNN模型的使用方式易于理解和实现。如果您非常了解您的模型和数据集属性，那么在需要不同修改的自定义数据集上训练您自己的模型可以很容易地完成。</p><h2 id="03b0" class="kt if hh bd ig ku kv kw ik kx ky kz io jn la lb is jr lc ld iw jv le lf ja lg bi translated">参考资料:</h2><ol class=""><li id="ed9a" class="kf kg hh je b jf jg jj jk jn lv jr lw jv lx jz kk kl km kn bi translated">h<a class="ae ly" rel="noopener" href="/analytics-vidhya/multi-class-classification-using-cnn-for-custom-dataset-7759865bd19?source=friends_link&amp;sk=e54faf08bbf2e3c73aabbccdc5d7480c">ttps://medium . com/analytics-vid hya/multi-class-classification-using-CNN-For-custom-dataset-7759865 BD 19？source = friends _ link&amp;sk = e 54 faf 08 bbf 2e 3c 73 aabbccdc5d 7480 c</a></li><li id="0170" class="kf kg hh je b jf ko jj kp jn kq jr kr jv ks jz kk kl km kn bi translated">引用:<br/> Https://Medium。com/Analytics-vid hya/Multi-Class-Classification-Using-Cnn-For-Custom-Dataset-7759865 BD 19？source = Friends _ link&amp;Sk = e 54 faf 08 bbf 2e 3c 73 aabbccdc5d 7480 c</li></ol></div></div>    
</body>
</html>