<html>
<head>
<title>Data Quality Assurance with Great Expectations and Kubeflow Pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">满怀期望的数据质量保证和Kubeflow管道</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-quality-assurance-with-great-expectations-and-kubeflow-pipelines-d83449fbaa81?source=collection_archive---------0-----------------------#2021-04-14">https://medium.com/analytics-vidhya/data-quality-assurance-with-great-expectations-and-kubeflow-pipelines-d83449fbaa81?source=collection_archive---------0-----------------------#2021-04-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="78d0" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">介绍</h1><p id="5126" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">数据质量验证在机器学习中的重要性怎么估计都不为过。然而，主要的ML平台仍然缺乏建立数据质量保证过程的工具。最近，<a class="ae ka" href="https://provectus.com/" rel="noopener ugc nofollow" target="_blank">provetus</a>对Kubeflow知识库做出了贡献，它将允许ML工程师使用Great Expectations组件测试和验证Kubeflow管道内部的数据。在本文中，我们将讨论它是什么，并展示如何使用它来检查ML管道的数据。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/40d2a0ad969be1db6a0e69f78e3fde40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Wd7PwCyIi7PYa8b4"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">Kubeflow Pipeline包含用于数据验证的远大前程组件</figcaption></figure><h1 id="bfbd" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">ML数据质量的提高</h1><p id="7135" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">在ML模型生命周期中缺乏数据质量保证总是会产生成本和反效果。您可以拥有您想要的所有一流的MLOps工具和高质量模型，但是如果您的数据是垃圾，这些都不重要。毫无准备的数据会湮灭它们的价值。</p><p id="2bd4" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">可用的研究年复一年地继续证实这一点。</p><p id="74d7" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">例如，最近的2020年Gartner调查发现，组织估计数据质量差的平均成本为每年1280万美元，随着业务环境变得越来越复杂，这一数字可能会上升。</p><p id="0c1d" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">为错误的事情进行优化的风险一直很高，没有人能够忽视模型和基于它们的产品的测试数据。无论您使用什么框架来编排您的ML，拥有适当的数据保证是消除有效ML和公司预算的头号敌人:坏数据的必要条件。在Provectus，我们通过将数据质量保证作为我们所有端到端<a class="ae ka" href="https://provectus.com/machine-learning-infrastructure/" rel="noopener ugc nofollow" target="_blank"> ML和数据基础设施</a>解决方案的一部分来解决这个问题。</p><p id="65d0" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated"><a class="ae ka" href="https://www.kubeflow.org/docs/components/pipelines/overview/pipelines-overview/" rel="noopener ugc nofollow" target="_blank"><strong class="je hi">kube flow Pipelines</strong></a>，一个流行的开源端到端ML编排平台，也不例外。当您使用Kubeflow Pipelines作为在Kubernetes上构建和管理ML工作流的首选工具时，您需要有数据质量保证。您肯定希望消除GIGO(“垃圾输入，垃圾输出”)情况，并获得第二张图片:</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/bca27afe898f1ec88fb74abbb3c25fe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EVT5J4YXiJAHq5i5"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">数据质量保证是有效数据管道的必要条件。图片作者。</figcaption></figure><p id="5c34" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">尽管数据质量保证的需求已经被ML社区广泛认可，但数据质量工具仍处于起步阶段，并且在许多主要的ML平台中基本上不存在，包括Kubeflow Pipelines。直到最近，Kubeflow用户还不能建立一个适当的流程来确保他们的数据在训练他们的模型之前得到测试和验证。</p><p id="9366" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">在Provectus，我们决定解决这个问题，并提交了一个pull请求，将一个<a class="ae ka" href="https://github.com/kubeflow/pipelines/tree/master/components/great-expectations/validate" rel="noopener ugc nofollow" target="_blank">Great expects数据验证组件</a>添加到Kubeflow存储库中。从现在开始，您可以将GE组件添加到您的Kubeflow管道中进行测试和验证。csv数据集与您在Expectations Suite中设置的规则进行比较。如果数据集无效，该组件将停止管道执行。如果它是有效的，您知道您的数据是健康的，并且管道继续执行。GE组件还输出一个HTML数据文档，其中包含每个场景中的验证报告。</p><h1 id="141c" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">什么是远大前程</h1><p id="65da" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated"><a class="ae ka" href="https://greatexpectations.io/" rel="noopener ugc nofollow" target="_blank"> Great Expectations </a>是一个用Python编写的开源数据验证框架，允许您测试、描述和记录数据，以在ML管道的任何阶段测量和维护其质量。这是避免不一致记录和数据管道问题的好方法。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/f3f76b10f4e39dc88108307cd81b6457.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2s5veWdfBYBHKfTL"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">Great Expectations测试和验证数据，生成报告，并提供日志记录和警报。图片作者。</figcaption></figure><p id="9165" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">例如，当您从各种外部数据提供者接收数据，并需要在将ETL添加到数据库之前检查其输出时。比方说，你正在为一家医疗企业做ML，并且不断地从保险公司获得数据集。这些数据通常质量很低，并且存在一些典型的问题，如与字典不匹配、数据类型不正确、格式错误、重复、值分布偏移等。</p><p id="9139" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">为了验证数据，您必须编写所谓的预期——描述数据集理想状态的断言。期望基本上是你的数据将被运行的单元测试。你可以从内置的<a class="ae ka" href="https://docs.greatexpectations.io/en/latest/reference/glossary_of_expectations.html#expectation-glossary" rel="noopener ugc nofollow" target="_blank">期望词汇表</a>中选择断言，也可以自己编写。</p><h1 id="7138" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">远大前程如何融入你的MLOps？</h1><p id="1097" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">ML模型生命周期包括三个主要阶段:</p><ol class=""><li id="fd73" class="kw kx hh je b jf kr jj ks jn ky jr kz jv la jz lb lc ld le bi translated"><strong class="je hi">数据准备。</strong>收集、清理、组织和丰富数据，为后续阶段做准备。</li><li id="0e00" class="kw kx hh je b jf lf jj lg jn lh jr li jv lj jz lb lc ld le bi translated"><strong class="je hi">模型开发。模型被设计、构建、训练、测试和微调，为部署做准备。</strong></li><li id="9dde" class="kw kx hh je b jf lf jj lg jn lh jr li jv lj jz lb lc ld le bi translated"><strong class="je hi">部署&amp;操作。</strong>经过微调的模型被打包并部署到生产中，然后对其质量和可靠性进行监控。</li></ol><p id="bb5d" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">你认为在ML生命周期的哪个阶段数据需要质量保证？</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/b9d197b16437ed776eed4af2419ae8a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VfcJSpM5c2TEEA6t"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">ML模型生命周期的三个主要阶段。图片作者。</figcaption></figure><p id="008f" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">没错:就像代码和模型一样，每个ML阶段的数据都应该被测试覆盖。</p><p id="3f21" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">Great Expectations是一个工具，可用于每个阶段的数据测试，我们将它引入Kubeflow Pipelines正是为了做到这一点。</p><p id="dc0a" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">根据您构建MLOps的方式，您的Kubeflow管道可以包含所有或部分这些块。数据QA属于其中的几个。以下是您可能希望在ML管道中安装数据QA来验证数据的地方:</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/c00df8716804a3a8e5ff38278af5077c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oiNtsUJjUk0XLsCm"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">ML生命周期中需要数据验证的步骤,“远大前程”组件可以提供帮助。图片作者。</figcaption></figure><p id="10e6" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">Great Expectations对于在摄取、数据清理、特征工程或模型输出阶段检查数据非常有帮助。在下面我们看到的用例中，图表上显示的前三个验证步骤适合第一个组件。让我们直入主题，看看如何开始使用Kubeflow Pipelines中的GE组件。</p><p id="794e" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">要了解更多有关远大前程如何融入MLOps生命周期的信息，请查看远大前程博客上的这篇文章:</p><p id="7e03" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated"><a class="ae ka" href="https://greatexpectations.io/blog/ml-ops-great-expectations/" rel="noopener ugc nofollow" target="_blank">远大前程如何融入MLOps？</a></p><h1 id="378a" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated"><strong class="ak">快速入门:对Kubeflow管道寄予厚望</strong></h1><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/f722026ff97a7be811739c5bc213f53a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8ZX-dMKx0SSe2nZG"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">对Kubeflow寄予厚望。作者图片</figcaption></figure><p id="4c7a" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">通过Kubeflow管道设置和使用Great Expectations是一件轻而易举的事情。除了先决条件之外，您还需要几个步骤来开始:</p><ol class=""><li id="2537" class="kw kx hh je b jf kr jj ks jn ky jr kz jv la jz lb lc ld le bi translated">加载GE组件定义(<strong class="je hi"> component.yaml </strong>)</li><li id="86b4" class="kw kx hh je b jf lf jj lg jn lh jr li jv lj jz lb lc ld le bi translated">将<strong class="je hi">期望套件</strong>文件添加到管道中</li><li id="2100" class="kw kx hh je b jf lf jj lg jn lh jr li jv lj jz lb lc ld le bi translated"><strong class="je hi">将通用电气组件集成到管道中</strong></li></ol><p id="76f6" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">之后，您将能够在Kubeflow工作负载中利用巨大的期望。</p><h1 id="6f43" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">0.先决条件</h1><p id="5f77" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">对于本教程，您需要:</p><ol class=""><li id="9ddf" class="kw kx hh je b jf kr jj ks jn ky jr kz jv la jz lb lc ld le bi translated">一个<strong class="je hi"> Kubeflow集群</strong>。要在AWS上启动并运行Kubeflow生产基础设施，您可以使用Swiss Army Kube——一个创建GitOps部署的简单蓝图。点击这里查看快速入门:<a class="ae ka" href="https://github.com/provectus/sak-kubeflow/blob/init/QUICKSTART.md" rel="noopener ugc nofollow" target="_blank"> SAKK快速入门</a>。</li><li id="d921" class="kw kx hh je b jf lf jj lg jn lh jr li jv lj jz lb lc ld le bi translated">一个<a class="ae ka" href="https://docs.greatexpectations.io/en/stable/reference/core_concepts/expectations/expectations.html#reference-core-concepts-expectations-expectation-suites" rel="noopener ugc nofollow" target="_blank"> <strong class="je hi">期望套件</strong> </a> —一个JSON文件，包含您对数据集的规则(期望)。搭建一个样板文件并编辑它，按照官方指南定义你的期望:<a class="ae ka" href="https://docs.greatexpectations.io/en/stable/guides/how_to_guides/creating_and_editing_expectations/how_to_create_a_new_expectation_suite_using_suite_scaffold.html" rel="noopener ugc nofollow" target="_blank">如何使用套件搭建创建一个新的期望套件</a>。或者，您可以创建自定义期望:<a class="ae ka" href="https://docs.greatexpectations.io/en/stable/guides/how_to_guides/creating_and_editing_expectations/how_to_create_custom_expectations.html" rel="noopener ugc nofollow" target="_blank">如何创建自定义期望</a>。</li><li id="50d4" class="kw kx hh je b jf lf jj lg jn lh jr li jv lj jz lb lc ld le bi translated">或者，您可能希望获得一个云帐户来存储Expectation Suite——在S3、云存储、Azure或Pandas支持的任何其他位置(例如静态HTTP位置)。</li></ol><h1 id="407f" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">用例</h1><p id="ee94" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">让我们以下面的Kubeflow管道为例。它实现了一个ML工作流，该工作流训练一个模型来预测客户为一次出租车旅行支付的小费金额:</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="lk ll l"/></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">一个示例分类ML模型，确定负责芝加哥出租车行程的公司。</figcaption></figure><p id="f9d4" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">该管道使用Kubeflow Pipelines SDK提供的默认组件存储(下一节将详细介绍)。</p><p id="29d6" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">编译并上传到Kubeflow后，管道应该是这样的(还没有GE组件):</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es lm"><img src="../Images/29d97ffa6e4a84e62fbbd641787ed5e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A0tf3dAzH4CLB_o12ZKcvw.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">Kubeflow管道示例。图片作者。</figcaption></figure><h1 id="e165" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">1.加载远大前程组件</h1><h2 id="f2ba" class="ln if hh bd ig lo lp lq ik lr ls lt io jn lu lv is jr lw lx iw jv ly lz ja ma bi translated">1.1通过Kubeflow ComponentStore加载定义文件</h2><p id="e0c9" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">首先加载GE组件定义文件<a class="ae ka" href="https://github.com/kubeflow/pipelines/blob/master/components/great-expectations/validate/CSV/component.yaml" rel="noopener ugc nofollow" target="_blank"> <strong class="je hi"> component.yaml </strong> </a>。最简单的方法是使用由<a class="ae ka" href="https://www.kubeflow.org/docs/components/pipelines/sdk/sdk-overview/" rel="noopener ugc nofollow" target="_blank"> Kubeflow Pipelines SDK </a>提供的默认组件库。从kfp加载组件存储，组件:</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="4e82" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">商店创建在Kubeflow Pipelines SDK库的<a class="ae ka" href="https://github.com/kubeflow/pipelines/tree/master/components" rel="noopener ugc nofollow" target="_blank">主分支</a>中定义的组件。您可以创建自定义存储来修复存储库版本:</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="3ecf" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">然后，您可以使用存储来加载组件定义:</p><pre class="kc kd ke kf fd mb mc md me aw mf bi"><span id="799f" class="ln if hh mc b fi mg mh l mi mj">validate_csv_step = store.load_component(“great-expectations/validate/CSV”)</span></pre><h2 id="374d" class="ln if hh bd ig lo lp lq ik lr ls lt io jn lu lv is jr lw lx iw jv ly lz ja ma bi translated">1.2通过URL或从文件加载定义</h2><p id="897e" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">另一种方式是加载<a class="ae ka" href="https://github.com/kubeflow/pipelines/blob/master/components/great-expectations/validate/CSV/component.yaml" rel="noopener ugc nofollow" target="_blank"> <strong class="je hi"> component.yaml </strong> </a>文件是通过其URL使用<a class="ae ka" href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.ComponentStore.load_component_from_url" rel="noopener ugc nofollow" target="_blank"> load_component_from_url </a>函数:</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="4bd3" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">或者，您可以将定义保存到文件中，并从该文件中加载组件:</p><pre class="kc kd ke kf fd mb mc md me aw mf bi"><span id="fcf7" class="ln if hh mc b fi mg mh l mi mj">validate_csv_step = load_component_from_file(ge_component_path)</span></pre><h1 id="af49" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">2.将期望套件添加到数据管道中</h1><p id="debc" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">GE组件需要一个期望套件作为文件传递给它。它可以通过从云存储中加载或注入到管道定义中来传递。</p><p id="08c5" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">例如，您有一个存储在AWS S3的期望套件。要从S3加载它，您需要创建一个组件来完成加载。在. yaml文件中编写加载组件的组件定义:</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="49d8" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">使用Python加载它:</p><pre class="kc kd ke kf fd mb mc md me aw mf bi"><span id="dfdb" class="ln if hh mc b fi mg mh l mi mj">load_from_s3_step = load_component_from_file(load_from_s3_component_path</span></pre><p id="8e61" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">根据其他云存储的基础架构需求，可以为其实现类似的组件。</p><p id="3fe2" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">最后，将这个步骤添加到管道中以加载套件:</p><pre class="kc kd ke kf fd mb mc md me aw mf bi"><span id="fbff" class="ln if hh mc b fi mg mh l mi mj">expectation_suite = load_from_s3_step(expectation_suite_uri).output</span></pre><p id="c848" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">或者，您可以在本地存储期望套件，并将其直接添加到管道中:</p><pre class="kc kd ke kf fd mb mc md me aw mf bi"><span id="e1b3" class="ln if hh mc b fi mg mh l mi mj">with open(‘expectation_suite.json') as file:</span><span id="37da" class="ln if hh mc b fi mk mh l mi mj">expectation_suite = file.read()</span></pre><h1 id="b5bf" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">3.将GE组件集成到数据管道中</h1><p id="c133" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">集成是通过将数据和期望套件的路径传递给GE组件来完成的:</p><pre class="kc kd ke kf fd mb mc md me aw mf bi"><span id="6b46" class="ln if hh mc b fi mg mh l mi mj">validate_csv_step(csv=csv_path, expectation_suite=expectation_suite)</span></pre><p id="c860" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">这里，“<strong class="je hi">CSV _ path”</strong>需要是将数据接收到管道中的组件的输出(例如，从S3读取数据集)，而“<strong class="je hi">expectation _ suite”</strong>需要是文件或管道组件的输出。</p><h1 id="77cf" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">4.编译管道并上传到Kubflow</h1><p id="bf0f" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">在步骤1–3之后，我们将拥有以下管道代码，假设Expectation Suite保存在本地的同一文件夹中(我们在步骤1–3中添加的代码以粗体显示):</p><figure class="kc kd ke kf fd kg"><div class="bz dy l di"><div class="lk ll l"/></div></figure><p id="d83b" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">在Kubeflow接口中，带有GE组件的管道将如下所示:</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es lm"><img src="../Images/870ee055ceb55a9fcca57642967c998e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yLnm9m_5yf8rwBoqYkeYlA.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">具有远大期望组件的Kubeflow管道示例(“使用远大期望验证csv”)。图片作者。</figcaption></figure><h1 id="05c6" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">5.满怀期望地检查您的数据</h1><p id="a149" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">现在，您有了一个包含GE组件的管道，可以利用它来验证进入该管道的数据集。如您所见,“Validate CSV”GE组件现在是“Xgboost train”和“Chicago Taxi”的依赖项之一。</p><p id="c3f6" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">每次运行管道时,“Validate CSV”组件都会根据Expectations Suite中的规则检查数据集。如果它成功地验证了数据，其余的管道将运行，并且它的所有步骤将变成绿色(1)。如果GE步骤检测到数据问题并失败，它将终止管道中的进一步执行并变为红色(2)。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es lm"><img src="../Images/153a153564bdd91e7970cf8c16119aec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nLFf0mpzFs3FvL_JowQXfg.jpeg"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">1—GE组件的验证成功通过，2—GE组件的验证失败，并终止管道中的进一步执行。图片作者。</figcaption></figure><h2 id="0bd0" class="ln if hh bd ig lo lp lq ik lr ls lt io jn lu lv is jr lw lx iw jv ly lz ja ma bi translated"><strong class="ak">数据文件</strong></h2><p id="ae43" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">执行后，GE组件还会创建一个数据文档:一个用于数据验证的HTML报告。要打开它，请在Kubeflow UI的输入/输出面板中单击Validate步骤的输出工件部分下的链接:</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/bb420f09c2563177c56fc5a8d4b64517.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xgHyAU6cGpKwzXrt"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">单击输出工件链接打开数据文档报告。图片作者。</figcaption></figure><p id="ca45" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">这是报告的样子:</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/750f0e7aecb13460afe77dc423da8781.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XlLX2xTF-E0rdAwR"/></div></div><figcaption class="kn ko et er es kp kq bd b be z dx translated">由Kubeflow中的远大前程组件生成的数据文档报告。图片作者。</figcaption></figure><p id="74a3" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">数据文档显示可用的期望套件、验证结果、通过和未通过期望的统计数据，并允许数据团队向下钻取值。在这里，您可以看到在期望套件中定义的每个检查的状态和值。</p><h1 id="c1fb" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">结论</h1><p id="bcaa" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">在本文中，我们简要介绍了机器学习管道的数据质量的重要性，以及如何在Kubeflow管道中使用新的Great Expectations组件来确保数据质量。关键要点:</p><ul class=""><li id="a6d7" class="kw kx hh je b jf kr jj ks jn ky jr kz jv la jz ml lc ld le bi translated"><strong class="je hi">在构建强大的ML管道时，数据质量是第一要务</strong>。</li><li id="b70d" class="kw kx hh je b jf lf jj lg jn lh jr li jv lj jz ml lc ld le bi translated"><strong class="je hi">谨记GIGO </strong>原则——如果不首先测试和验证数据，就不可能有健壮的管道和ML模型。</li><li id="f14e" class="kw kx hh je b jf lf jj lg jn lh jr li jv lj jz ml lc ld le bi translated"><strong class="je hi">模型训练前的测试数据</strong>——用不正确的数据运行管道成本很高，所以在上游尽早测试。</li><li id="a8f9" class="kw kx hh je b jf lf jj lg jn lh jr li jv lj jz ml lc ld le bi translated"><strong class="je hi"> Great Expectations component是确保Kubeflow管道中数据质量的首选工具</strong>，也是目前唯一的kube flow DQ工具。</li><li id="1a5c" class="kw kx hh je b jf lf jj lg jn lh jr li jv lj jz ml lc ld le bi translated"><strong class="je hi">数据文档有助于</strong>与其他数据团队成员合作，分析和管理Kubeflow管道的数据质量。</li></ul><h1 id="fe11" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated"><strong class="ak">特别感谢</strong></h1><p id="6a9e" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">感谢安东·基舍列夫和雅罗斯拉夫·贝希塔为Kubeflow开发和贡献了“远大前程”组件。</p><h1 id="91d5" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">词汇表</h1><p id="e061" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated"><strong class="je hi">期望套件</strong>是对数据集的描述。它存储为一个JSON文件。有几种方法可以创建一个期望套件:搭建一个样板文件并编辑它来构建你的规则(期望)你的数据集。csv将根据进行验证。或者从头开始创建一个期望套件。</p><p id="823a" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated"><strong class="je hi"> GE组件定义</strong>是一个Kubeflow组件的定义，在<strong class="je hi"> component.yaml </strong>文件中以规范格式描述给Kubeflow管道。根据这个预定义的组件规范。yaml，<a class="ae ka" href="https://kubeflow-pipelines.readthedocs.io/en/latest/source/kfp.components.html#kfp.components.ComponentStore.load_component" rel="noopener ugc nofollow" target="_blank"><strong class="je hi">componentstore . load _ components</strong></a>自动创建一个<a class="ae ka" href="https://cloud.google.com/solutions/machine-learning/architecture-for-mlops-using-tfx-kubeflow-pipelines-and-cloud-build#kubeflow-piplines-components" rel="noopener ugc nofollow" target="_blank"> <strong class="je hi">组件op </strong> </a>，允许调用Kubeflow管道中的组件。将<strong class="je hi"> component.yaml </strong>加载到<strong class="je hi"> ComponentStore </strong>中，让它创建一个<strong class="je hi">组件op </strong>以允许在Kubeflow管道中使用该组件。</p><p id="b744" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated"><strong class="je hi">期望</strong>是您在JSON格式的期望套装文件中定义的需求。它们充当数据的单元测试。“远大前程”将通过对照您的期望检查数据集来验证您的数据集。为了创建期望，你可以从内置的<a class="ae ka" href="https://docs.greatexpectations.io/en/latest/reference/glossary_of_expectations.html#expectation-glossary" rel="noopener ugc nofollow" target="_blank">期望词汇表</a>中选择断言，或者从头开始编写自己的断言。</p><p id="f521" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated"><a class="ae ka" href="https://docs.greatexpectations.io/en/latest/reference/glossary_of_expectations.html#expectation-glossary" rel="noopener ugc nofollow" target="_blank"> <strong class="je hi">期望词汇表</strong> </a> —所有内置期望的列表。</p><p id="e54e" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated"><a class="ae ka" href="https://docs.greatexpectations.io/en/stable/reference/core_concepts/data_docs.html" rel="noopener ugc nofollow" target="_blank"> <strong class="je hi">数据文档</strong> </a> <strong class="je hi"> </strong> —由远大前程为您的数据集编制的结构化格式验证报告，以期望和验证为特色。数据文档的一个例子是HTML文档。</p><p id="c32c" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated"><a class="ae ka" href="https://www.kubeflow.org/docs/components/pipelines/overview/pipelines-overview/#:~:text=Kubeflow%20Pipelines%20is%20a%20platform,workflows%20based%20on%20Docker%20containers." rel="noopener ugc nofollow" target="_blank"><strong class="je hi">kube flow Pipelines</strong></a>是一个基于Docker容器构建和部署可移植、可扩展的机器学习(ML)工作流的平台。</p><p id="80a3" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated"><a class="ae ka" href="https://www.kubeflow.org/docs/components/pipelines/sdk/sdk-overview/" rel="noopener ugc nofollow" target="_blank"><strong class="je hi">kube flow Pipelines SDK</strong></a>—<a class="ae ka" href="https://kubeflow-pipelines.readthedocs.io/en/stable/source/kfp.html" rel="noopener ugc nofollow" target="_blank">kfp包</a> —一组Python包，可用于指定和运行您的ML工作流(定义和操作管道和组件)。</p><p id="9bf5" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated"><strong class="je hi"> Pipeline </strong> —对ML工作流的描述，包括组成工作流中各个步骤的所有组件，以及这些组件如何相互交互。</p><p id="077a" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated">XGBoost(Extreme Gradient Boosting)是一个开源库，为C++、Java、Python、R、Julia、Perl和Scala提供了高效的梯度增强实现。</p><p id="6271" class="pw-post-body-paragraph jc jd hh je b jf kr jh ji jj ks jl jm jn kt jp jq jr ku jt ju jv kv jx jy jz ha bi translated"><a class="ae ka" href="https://en.wikipedia.org/wiki/Garbage_in,_garbage_out" rel="noopener ugc nofollow" target="_blank"> <strong class="je hi"> GIGO </strong> </a> <strong class="je hi">原理</strong> —一个有缺陷的、低质量的“垃圾”数据产生有缺陷的、低质量的输出(“垃圾”)的概念。</p></div></div>    
</body>
</html>