<html>
<head>
<title>Data Wrangling Solutions— Splitting Column with Each Cell Containing List of Values</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据争论解决方案—拆分列，每个单元格包含值列表</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-wrangling-solutions-splitting-column-with-each-cell-containing-list-of-values-fc95d14fa539?source=collection_archive---------24-----------------------#2021-03-12">https://medium.com/analytics-vidhya/data-wrangling-solutions-splitting-column-with-each-cell-containing-list-of-values-fc95d14fa539?source=collection_archive---------24-----------------------#2021-03-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="7218" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">常见的数据争论挑战和一步到位的解决方案。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/56d469cf1902036769640d9d4c118207.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cv_yvgTzHVcg6t4j"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">约书亚·苏考夫在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="97ea" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在分析项目的数据准备阶段，一个常见的挑战是让<strong class="jq hj">在表格的列中有一个值列表</strong>。通常，在这种情况下，分析师会将其拆分为多个记录。这种情况的直观表示如下:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kk"><img src="../Images/c603cf7ab35811d14c525b054d746996.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4iCwLdP9ZqBqRYsQsCe8KQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">示例场景(图片由作者提供)</figcaption></figure><p id="8c78" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在本教程中，我们将演示一步一步的方法来处理这种情况。<strong class="jq hj">根据<em class="kl"> Pandas </em>库的版本，可以遵循下面</strong>详述的不同解决方案。</p><h2 id="8f5c" class="km kn hi bd ko kp kq kr ks kt ku kv kw jx kx ky kz kb la lb lc kf ld le lf lg bi translated">假设和建议</h2><p id="b52e" class="pw-post-body-paragraph jo jp hi jq b jr lh ij jt ju li im jw jx lj jz ka kb lk kd ke kf ll kh ki kj hb bi translated">动手是掌握编程的关键。我们建议您在完成教程的过程中继续实现这些代码。要实现这一点，您可以从<a class="ae jn" href="https://github.com/dalmiaujjwal/Data_Wrangling_Tips_Tricks" rel="noopener ugc nofollow" target="_blank"><strong class="jq hj">this GitHub link</strong></a>的<strong class="jq hj"> Scenario_4文件夹</strong>中访问本教程中使用的示例数据和相关笔记本。</p><p id="e396" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果你是GitHub新手，想学习它，请通过<a class="ae jn" href="https://towardsdatascience.com/must-know-tools-for-data-scientists-114d0b52b0a9" rel="noopener" target="_blank"> <strong class="jq hj"> <em class="kl">这篇</em> </strong> </a>教程。要在您的系统上设置一个新的Python环境，请阅读本  教程中的<a class="ae jn" href="https://towardsdatascience.com/getting-started-guide-anaconda-80a4d30d3486" rel="noopener" target="_blank"> <strong class="jq hj"> <em class="kl">。</em></strong></a></p><p id="1bbc" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">以下是本教程中使用的pandas函数/方法列表:</p><ol class=""><li id="0522" class="lm ln hi jq b jr js ju jv jx lo kb lp kf lq kj lr ls lt lu bi translated">阅读_csv</li><li id="a9f9" class="lm ln hi jq b jr lv ju lw jx lx kb ly kf lz kj lr ls lt lu bi translated">字符串存取器</li><li id="7ab2" class="lm ln hi jq b jr lv ju lw jx lx kb ly kf lz kj lr ls lt lu bi translated">应用</li><li id="9fba" class="lm ln hi jq b jr lv ju lw jx lx kb ly kf lz kj lr ls lt lu bi translated">合并</li><li id="649e" class="lm ln hi jq b jr lv ju lw jx lx kb ly kf lz kj lr ls lt lu bi translated">熔化</li><li id="2914" class="lm ln hi jq b jr lv ju lw jx lx kb ly kf lz kj lr ls lt lu bi translated">德罗普纳</li><li id="7413" class="lm ln hi jq b jr lv ju lw jx lx kb ly kf lz kj lr ls lt lu bi translated">滴</li><li id="aac0" class="lm ln hi jq b jr lv ju lw jx lx kb ly kf lz kj lr ls lt lu bi translated">激增</li></ol><h1 id="ea6e" class="ma kn hi bd ko mb mc md ks me mf mg kw io mh ip kz ir mi is lc iu mj iv lf mk bi translated">我们开始吧</h1><h2 id="fed3" class="km kn hi bd ko kp kq kr ks kt ku kv kw jx kx ky kz kb la lb lc kf ld le lf lg bi translated">步骤1 —准备好数据</h2><p id="2f88" class="pw-post-body-paragraph jo jp hi jq b jr lh ij jt ju li im jw jx lj jz ka kb lk kd ke kf ll kh ki kj hb bi translated">对于本教程，我们搜集了一些关于加拿大公司破产的新闻。我们还使用了一些NLP技术来从抓取的文章的每个句子中提取关键词。该数据集和样本数据快照的数据字典如下:</p><ul class=""><li id="e389" class="lm ln hi jq b jr js ju jv jx lo kb lp kf lq kj ml ls lt lu bi translated">商品编号——识别商品的唯一编号</li><li id="6214" class="lm ln hi jq b jr lv ju lw jx lx kb ly kf lz kj ml ls lt lu bi translated">Sentence_Number —标识文章句子的唯一编号</li><li id="0ea3" class="lm ln hi jq b jr lv ju lw jx lx kb ly kf lz kj ml ls lt lu bi translated">文章发布日期—文章的发布日期</li><li id="3fba" class="lm ln hi jq b jr lv ju lw jx lx kb ly kf lz kj ml ls lt lu bi translated">关键字—用于文章网络搜索的关键字</li><li id="9a0b" class="lm ln hi jq b jr lv ju lw jx lx kb ly kf lz kj ml ls lt lu bi translated">Article_Body —文章的实际文本</li><li id="5f74" class="lm ln hi jq b jr lv ju lw jx lx kb ly kf lz kj ml ls lt lu bi translated">文章关键词—从文章句子中识别的重要关键词</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mm"><img src="../Images/26222e61ff420f749ae55cc2fb8a9f3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*krBWH7_kIa6-WZqATKHVrA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">样本数据快照(图片由作者提供)</figcaption></figure><p id="0316" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">注意，文章关键词以逗号分隔文本值的<strong class="jq hj">列表的形式出现。我们的目标是将它分成多个记录。</strong></p><h2 id="f1db" class="km kn hi bd ko kp kq kr ks kt ku kv kw jx kx ky kz kb la lb lc kf ld le lf lg bi translated">步骤2 —导入包和数据文件。</h2><p id="6d5c" class="pw-post-body-paragraph jo jp hi jq b jr lh ij jt ju li im jw jx lj jz ka kb lk kd ke kf ll kh ki kj hb bi translated">一旦有了可用的数据，下一步就是将其导入到Python环境中。</p><pre class="iy iz ja jb fd mn mo mp mq aw mr bi"><span id="f1f9" class="km kn hi mo b fi ms mt l mu mv"><strong class="mo hj">#### Sample Code<br/>#### Importing Pandas<br/></strong>import pandas as pd</span><span id="7aae" class="km kn hi mo b fi mw mt l mu mv"><strong class="mo hj">#### Importing Data File - Change the Windows Folder Location<br/></strong>imp_data = pd.read_csv("C:\\Ujjwal\\Analytics\\Git\\Scenario_4\\Sample_Data.csv")</span></pre><p id="985c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们使用了熊猫<strong class="jq hj"> <em class="kl"> read_csv </em> </strong>函数来读取Python中的数据。</p><h2 id="bf9e" class="km kn hi bd ko kp kq kr ks kt ku kv kw jx kx ky kz kb la lb lc kf ld le lf lg bi translated">步骤3 —将关键字文本转换为值列表。</h2><p id="8b39" class="pw-post-body-paragraph jo jp hi jq b jr lh ij jt ju li im jw jx lj jz ka kb lk kd ke kf ll kh ki kj hb bi translated">该任务的一个关键步骤是<strong class="jq hj">将逗号分隔的文本转换成Python序列对象(本例中为list)</strong>。以下是示例代码:</p><pre class="iy iz ja jb fd mn mo mp mq aw mr bi"><span id="92a3" class="km kn hi mo b fi ms mt l mu mv"><strong class="mo hj">#### Converting the keywords to a Python list object</strong><br/>imp_data["Article_Keywords_Converted"] = imp_data["Article_Keywords"].str.split(",")</span></pre><p id="8750" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">注意使用<strong class="jq hj"> <em class="kl">字符串访问器</em> </strong>和相关的<strong class="jq hj"> <em class="kl"> split </em> </strong>方法来获得想要的结果。<strong class="jq hj">文本值列表现在作为列表对象可用，其中每个关键字是一个列表组件</strong>。</p><h2 id="2892" class="km kn hi bd ko kp kq kr ks kt ku kv kw jx kx ky kz kb la lb lc kf ld le lf lg bi translated">步骤4a —使用低于0.25.0的Pandas版本的用户</h2><p id="cc12" class="pw-post-body-paragraph jo jp hi jq b jr lh ij jt ju li im jw jx lj jz ka kb lk kd ke kf ll kh ki kj hb bi translated">在0.25.0版本之前，Pandas没有任何现成的函数/方法来解决上述情况。如果您使用的是旧版本的Pandas，并且无法升级到最新版本，请遵循以下简单步骤:</p><ul class=""><li id="125d" class="lm ln hi jq b jr js ju jv jx lo kb lp kf lq kj ml ls lt lu bi translated"><strong class="jq hj">将带有列表对象的列转换为熊猫系列</strong>并存储在临时数据框中。通过将列表对象列转换为Pandas系列，每个列表组件将分成一个新数据框的多个列。新数据帧的示例代码和结构如下:</li></ul><pre class="iy iz ja jb fd mn mo mp mq aw mr bi"><span id="81b8" class="km kn hi mo b fi ms mt l mu mv"><strong class="mo hj">#### Sample Code</strong><br/>temp_df = imp_data["Article_Keywords_Converted"].apply(pd.Series)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mx"><img src="../Images/69f26a141602059b27094669e3a3b385.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y7urBURM-7MOfh0EYr6wzQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">转换后的示例值(图片由作者提供)</figcaption></figure><ul class=""><li id="70d8" class="lm ln hi jq b jr js ju jv jx lo kb lp kf lq kj ml ls lt lu bi translated"><strong class="jq hj">将临时数据帧与原始数据帧</strong>合并。由于新创建的数据框将与原始数据框具有相同的索引，因此我们可以使用左索引和右索引来合并这两个数据框。</li></ul><pre class="iy iz ja jb fd mn mo mp mq aw mr bi"><span id="9c93" class="km kn hi mo b fi ms mt l mu mv"><strong class="mo hj">#### Sample Code</strong><br/>imp_data = pd.merge(imp_data, temp_df, right_index=True, left_index=True, how = "left")</span></pre><ul class=""><li id="34a2" class="lm ln hi jq b jr js ju jv jx lo kb lp kf lq kj ml ls lt lu bi translated"><strong class="jq hj">融化新增的列</strong>。这一步将把所有单独的关键字值放在单独的行中。要了解熊猫的融化，请通读<a class="ae jn" rel="noopener" href="/analytics-vidhya/pandas-for-beginners-reshaping-dataframes-part-1-cfb43f6170bf"> <strong class="jq hj">这篇</strong> </a>教程。</li></ul><pre class="iy iz ja jb fd mn mo mp mq aw mr bi"><span id="2075" class="km kn hi mo b fi ms mt l mu mv"><strong class="mo hj">#### Sample Code</strong><br/>imp_data = pd.melt(imp_data, <br/>                   id_vars=['Article_Number','Sentence_Number',<br/>                            'Article_Publish_Date','Keyword',<br/>                            'Article_Body','Article_Keywords',<br/>                            'Article_Keywords_Converted'],<br/>                  value_name="Keywords")</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es my"><img src="../Images/00d2494fa65e04eec87d2d4edeb2de4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9uAykMVLWxoJwOYtdTBf-w.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">熔化数据帧后的输出(图片由作者提供)</figcaption></figure><ul class=""><li id="9711" class="lm ln hi jq b jr js ju jv jx lo kb lp kf lq kj ml ls lt lu bi translated"><strong class="jq hj">最后，删除新创建的Keywords字段中所有具有空值</strong>的记录。此外，删除所有临时的或不需要的列。最终的数据框将类似于下面共享的快照:</li></ul><pre class="iy iz ja jb fd mn mo mp mq aw mr bi"><span id="e644" class="km kn hi mo b fi ms mt l mu mv"><strong class="mo hj">#### Sample Code</strong><br/>imp_data.dropna(inplace = True)<br/>imp_data.drop(["Article_Keywords", "Article_Keywords_Converted", "variable"], axis = 1, inplace=True)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mz"><img src="../Images/c7a78dd0c786cb8367619756d9a8652c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ILxGOk174ZG8E5ZysGAQpw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">最终输出(图片由作者提供)</figcaption></figure><h2 id="73e5" class="km kn hi bd ko kp kq kr ks kt ku kv kw jx kx ky kz kb la lb lc kf ld le lf lg bi translated">步骤4b—Pandas 0 . 25 . 0及以上版本的用户</h2><p id="8cf9" class="pw-post-body-paragraph jo jp hi jq b jr lh ij jt ju li im jw jx lj jz ka kb lk kd ke kf ll kh ki kj hb bi translated">在0.25.0版本中，熊猫引入了新的<strong class="jq hj">数据帧方法</strong>叫做<strong class="jq hj"> <em class="kl">爆炸</em>。</strong>这个函数只需一步就能完成这项工作。在数据帧上使用这个方法，<strong class="jq hj">将列名作为参数</strong>传递。它会自动将值序列分割成多个记录。示例代码如下:</p><pre class="iy iz ja jb fd mn mo mp mq aw mr bi"><span id="ead5" class="km kn hi mo b fi ms mt l mu mv"><strong class="mo hj">#### Converting the list of values into multiple records<br/></strong>imp_data = imp_data.explode("Article_Keywords_Converted")<br/>imp_data.head()</span></pre><h1 id="2a74" class="ma kn hi bd ko mb mc md ks me mf mg kw io mh ip kz ir mi is lc iu mj iv lf mk bi translated">结束语</h1><p id="b529" class="pw-post-body-paragraph jo jp hi jq b jr lh ij jt ju li im jw jx lj jz ka kb lk kd ke kf ll kh ki kj hb bi translated">我敢肯定，教程最后一段一定是<strong class="jq hj"> <em class="kl">炸了</em> </strong>你的脑子。有了这些现成的解决方案，我们的数据争论任务变得容易实现。我希望上面介绍的解决方案是有帮助的。</p><p id="98c6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">快乐学习！！！！</p></div></div>    
</body>
</html>