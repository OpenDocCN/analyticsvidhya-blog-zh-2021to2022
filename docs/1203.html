<html>
<head>
<title>Time-Series Forecasting: Predicting Microsoft (MSFT) Stock Prices Using ARIMA Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时间序列预测:用ARIMA模型预测微软(MSFT)的股票价格</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/time-series-forecasting-predicting-microsoft-msft-stock-prices-using-arima-model-be1c45961739?source=collection_archive---------5-----------------------#2021-02-19">https://medium.com/analytics-vidhya/time-series-forecasting-predicting-microsoft-msft-stock-prices-using-arima-model-be1c45961739?source=collection_archive---------5-----------------------#2021-02-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="fb9c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在LSTM模式大获成功后，让我们试着用ARIMA模式重现成功。首先简单介绍一下时间序列，然后我们将讨论ARIMA在微软20多年的股票价格数据集上的实现。我们开始吧！</p><h1 id="b5f2" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">时间序列和预测模型</h1><p id="1c45" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">传统上，大多数机器学习(ML)模型使用一些观察值(样本/实例)作为输入特征，但数据中没有<strong class="ig hi">时间</strong> <strong class="ig hi">维度</strong>。</p><p id="92b9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">时间序列预测</strong>模型是能够根据<strong class="ig hi">以前的</strong> <strong class="ig hi">观测值</strong><strong class="ig hi"/>预测<strong class="ig hi">未来值</strong>的模型。时间序列预测广泛用于<strong class="ig hi">非平稳数据</strong>。<strong class="ig hi">非平稳数据</strong>被称为统计属性(如平均值和标准偏差)不随时间保持不变，而是随时间变化的数据。</p><p id="b879" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这些非平稳输入数据(用作这些模型的输入)通常被称为<strong class="ig hi">时间序列。时间序列的一些例子包括随时间变化的温度值、随时间变化的股票价格、随时间变化的房屋价格等。因此，输入是一个<strong class="ig hi">信号</strong>(时间序列),它是由在时间</strong>中连续进行的观察所定义的<strong class="ig hi">。</strong></p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es kg"><img src="../Images/99b6967a9edf31479e9f812d88ad366a.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/0*3LYNy0663sAjBS7z.png"/></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">时间序列示例</figcaption></figure><h1 id="c427" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">自回归综合移动平均(ARIMA)模型</h1><p id="60bd" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">用于时间序列预测的一种著名且广泛使用的预测方法是<strong class="ig hi">自回归综合移动平均(ARIMA) </strong>模型。<strong class="ig hi"> ARIMA </strong>模型能够捕捉时间序列数据中一套不同的标准时间结构。</p><h1 id="ea82" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">术语</h1><p id="16eb" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">让我们来分解这些术语:</p><ul class=""><li id="e745" class="ks kt hh ig b ih ii il im ip ku it kv ix kw jb kx ky kz la bi translated"><strong class="ig hi">AR:&lt;&gt;</strong>表示模型<strong class="ig hi">使用一个观测值和一些预定义数量的滞后观测值</strong>(也称为“时间滞后”或“滞后”)之间的依赖关系。</li><li id="2c0d" class="ks kt hh ig b ih lb il lc ip ld it le ix lf jb kx ky kz la bi translated"><strong class="ig hi"> I: &lt; Integrated &gt; </strong>是指模型采用<strong class="ig hi">原始观测值的差分</strong>(例如，它从前一时间步的一个观测值中减去一个观测值)，以使时间序列<strong class="ig hi">平稳。马</strong>:</li><li id="5b46" class="ks kt hh ig b ih lb il lc ip ld it le ix lf jb kx ky kz la bi translated"><strong class="ig hi"> <em class="lg"> MA: &lt;移动平均&gt; </em> </strong>是指模型利用了残差与观测值之间的<strong class="ig hi">关系。</strong></li></ul><h1 id="fbab" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">模型参数</h1><p id="6b38" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">标准ARIMA模型期望3个自变量作为输入参数，即p、d、q</p><ul class=""><li id="5a0d" class="ks kt hh ig b ih ii il im ip ku it kv ix kw jb kx ky kz la bi translated"><strong class="ig hi"> p </strong>是滞后观测值的<strong class="ig hi">数。</strong></li><li id="0f6d" class="ks kt hh ig b ih lb il lc ip ld it le ix lf jb kx ky kz la bi translated"><strong class="ig hi"> d </strong>是差分的<strong class="ig hi">度。</strong></li><li id="f1a5" class="ks kt hh ig b ih lb il lc ip ld it le ix lf jb kx ky kz la bi translated"><strong class="ig hi"> q </strong>是移动平均线窗口的<strong class="ig hi">大小/宽度。</strong></li></ul><h1 id="e96c" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">开始编码吧！</h1><p id="f0ba" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated"><em class="lg">所需模块:Keras、Tensorflow、Pandas、Scikit-Learn &amp; Numpy </em></p><p id="b9b3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里加载所有需要的模块。</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="lh li l"/></div></figure><p id="a76e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，让我们检查一下我们拥有的数据集。</p><pre class="kh ki kj kk fd lj lk ll lm aw ln bi"><span id="962b" class="lo je hh lk b fi lp lq l lr ls">df = pd.read_csv("MSFT.csv")</span><span id="9cb6" class="lo je hh lk b fi lt lq l lr ls">df.head(5)</span></pre><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es lu"><img src="../Images/e3c2893151acc5228dc395362bac5c17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tePQ01zhoH7F0RraQd63sA.png"/></div></div></figure><h1 id="fcef" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">要预测的目标值将是“接近”的股价值。</h1><p id="45c6" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">让我们准备好输入变量！</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="lh li l"/></div></figure><h1 id="09eb" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">制作我们的ARIMA模型</h1><p id="6fac" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">接下来，让我们<strong class="ig hi">将</strong>数据分成一个<strong class="ig hi">训练</strong> (70 %)和<strong class="ig hi">测试</strong> (30%)集合。对于本教程，我们选择以下<strong class="ig hi"> ARIMA参数:p=6，d=1，q=0。</strong></p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="lh li l"/></div></figure><h1 id="1c77" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">守则摘要</h1><ul class=""><li id="bbbf" class="ks kt hh ig b ih kb il kc ip lz it ma ix mb jb kx ky kz la bi translated"><strong class="ig hi">考虑到差分和AR模型对先前时间步骤中观测值的依赖性，需要一个滚动预测程序。为此，我们在收到每个新的观察结果后重新创建ARIMA模型。</strong></li><li id="ee14" class="ks kt hh ig b ih lb il lc ip ld it le ix lf jb kx ky kz la bi translated">最后，我们在一个名为<strong class="ig hi"> history </strong>的列表中手动跟踪所有的观察值，该列表以训练数据为种子，并且在每次迭代中向其追加新的观察值。</li></ul><p id="1cc0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">均方差为2.3522</p><h1 id="ec77" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">准备好测试数据并进行预测</h1><h1 id="109c" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">可视化结果</h1><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="lh li l"/></div></figure><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mc"><img src="../Images/c1dd8b532da0c32904501a598e4d33f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*l1tDV7kEPNrUeKN81-3t_g.png"/></div></figure><p id="c403" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我会让你们试验ARIMA模型的值，让我知道你是否能得到一个更好的MSE值！</p><p id="e383" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">已经有人尝试使用时间序列分析算法来预测股票价格，尽管它们仍然不能用于在真实市场中下注。这只是一篇教程文章，并不打算以任何方式“指导”人们购买股票。</p><p id="8b11" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">给我一个关注，如果你喜欢更多的技术博客！</p><p id="6acc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">再见了。</p></div></div>    
</body>
</html>