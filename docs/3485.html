<html>
<head>
<title>Effect of Target Transformation on Abalone Age Prediction Using Regression Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">目标转换对回归模型预测鲍鱼年龄的影响</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/effect-of-target-transformation-on-abalone-age-prediction-using-regression-model-da6d3a185a31?source=collection_archive---------2-----------------------#2021-07-04">https://medium.com/analytics-vidhya/effect-of-target-transformation-on-abalone-age-prediction-using-regression-model-da6d3a185a31?source=collection_archive---------2-----------------------#2021-07-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="d1a0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">迪马斯·邦塔尔托</p><h1 id="6392" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated"><strong class="ak">简介</strong></h1><p id="e6e4" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">回归是确定变量与其他变量之间因果关系的一种方法。在简单回归分析中，变量之间的关系是线性的，其中变量X的变化将永久地跟随变量的变化。</p><p id="bee6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">回归是一种分析方法，通常用于查看两个或多个变量之间的影响。通常，回归分析用于进行预测或预报。同时，这些变量之间的关系是函数关系，在数学模型中实现。</p><p id="3ac6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">其值被预测的变量称为目标。在回归中，目标值是连续的。</p><p id="a1dd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在现实世界中，有时会发现非正态分布的目标。这有时会影响模型的数据性能。</p><p id="c06d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在做分析之前，有时会先对目标进行变换，使分布接近正态。</p><p id="3cb8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">本文将尝试使用回归模型来确定目标转换对分析的影响。我们将使用的数据是鲍鱼数据集。</p><h1 id="f209" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">目标</h1><ul class=""><li id="c087" class="kf kg hh ig b ih ka il kb ip kh it ki ix kj jb kk kl km kn bi translated">了解目标转换对用于预测鲍鱼年龄的回归方法的影响。</li></ul><h1 id="c774" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">方法</h1><p id="225c" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">1.从http://archive.ics.uci.edu/ml/datasets/Abalone<a class="ae ko" href="http://archive.ics.uci.edu/ml/datasets/Abalone" rel="noopener ugc nofollow" target="_blank">网站</a>获取数据集。<br/> 2。检查数据集。<br/> 3。对数据集进行探索性数据分析。<br/> 4。对数据集进行要素工程。<br/> 5。比较有和没有目标转换的回归模型。</p><p id="f20f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将使用的回归模型有:<br/> 1。线性回归<br/> 2。k最近邻<br/> 3。决策树<br/> 4。支持向量机</p><p id="1ff8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">至于目标转换，我们将使用np.sqrt</p><h1 id="f43f" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">关于数据集</h1><p id="d591" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">数据集从<a class="ae ko" href="http://archive.ics.uci.edu/ml/datasets/Abalone" rel="noopener ugc nofollow" target="_blank">http://archive.ics.uci.edu/ml/datasets/Abalone</a>中检索。给出了属性名称、属性类型、度量单位和简短描述。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es kp"><img src="../Images/710c1c44c3e5d910497e34a6f8ac814b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*wtqkcQd-p6tL3el9BiYxbQ.png"/></div></figure><h1 id="6a97" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">导入库</h1><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es kx"><img src="../Images/4865eac1d66ea5243906deeb30bfa241.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*ViWRVS7yiFGnfDeJkc_aHw.png"/></div></figure><h1 id="637e" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">获取数据集</h1><p id="64a8" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">我们先得到数据集。我们通过网站<a class="ae ko" href="http://archive.ics.uci.edu/ml/datasets/Abalone" rel="noopener ugc nofollow" target="_blank">http://archive.ics.uci.edu/ml/datasets/Abalone</a>获得鲍鱼数据集</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es ky"><img src="../Images/8e230f87bbff7a9078aa22f54bbb3ca3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xZRbIyi5UQ166WEtsRzpcA.png"/></div></div></figure><p id="ed27" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从上表中我们可以看到，该数据有4，177个样本，包含9个特征。</p><h1 id="d7ac" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">检查数据集</h1><p id="f808" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">我们首先检查数据的条件，包括特征类型和数据描述。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es ld"><img src="../Images/7e671fe36b0f3e88bf2cdec7d35d2272.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*AnoQKb-S8tbcAiZqg-yalA.png"/></div></figure><p id="8185" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">除了“性别”特征之外，所有特征都是浮点和整数。从上面的信息中，我们可以发现数据中没有缺失值。</p><p id="93c2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们查看数据的描述，以确保数据是知情的。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es le"><img src="../Images/0be4a6d48d923433ebfe3153aaf49c42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qomdNHyM8Kr9UvD619Jh6A.png"/></div></div></figure><p id="4327" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据信息表明数据中没有缺失值。但是，如果你看数据描述，在高度测量中有一个值0(<code class="du lf lg lh li b">Height</code>列)。这个0值可能是数据中的测量误差，所以我们必须首先处理它。</p><h2 id="6480" class="lj jd hh bd je lk ll lm ji ln lo lp jm ip lq lr jq it ls lt ju ix lu lv jy lw bi translated">处理测量误差</h2><p id="ef14" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated"><code class="du lf lg lh li b">Height</code>栏中的数据可能有测量误差。我们首先检查0值的位置和数量。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lx"><img src="../Images/7ce3126a6ebfc5c602f2798984926233.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9YVNxpit0SPged63cXXgjQ.png"/></div></div></figure><p id="07f5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在<code class="du lf lg lh li b">Height</code>栏中有2个样本估计有测量误差。两个空值在婴儿性别(I)中。</p><p id="81fd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于只有两个样本，我们可以省略这两个值。只是在本文中我们将用婴儿(I)性别的平均值来代替它。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es ly"><img src="../Images/7daabbb158bea6baee6414fbd3076202.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2mXXXeiTxS0p06ZdY5wXlw.png"/></div></div></figure><p id="54dc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以看到数据集中没有空值。</p><h1 id="b40d" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">分割数据集</h1><p id="7e96" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">在我们将数据分为训练数据和测试数据之前，我们将首先确定鲍鱼的年龄。鲍鱼的年龄是年轮数加1.5得出的。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lz"><img src="../Images/0767c747790cc663e61de175e4ea1618.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4F-75FL5bScrPdv2UKkqhg.png"/></div></div></figure><p id="7b21" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">鲍鱼的年龄已经确定了。</p><p id="9b78" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，我们将把数据分成训练数据和测试数据组。我们将确定多达数据集30%的测试数据的大小</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es ma"><img src="../Images/8a37a66a1b701ee07f066ea36647f510.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F99yQNpOzb7oZGTuLg-i9w.png"/></div></div></figure><p id="4440" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了便于下一步，我们将现有的变量分开。</p><h1 id="65e7" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">探索性数据分析</h1><h2 id="8f17" class="lj jd hh bd je lk ll lm ji ln lo lp jm ip lq lr jq it ls lt ju ix lu lv jy lw bi translated">性别特征</h2><p id="638b" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">让我们开始分析数据火车。我们从查看性别条件开始(<code class="du lf lg lh li b">Sex</code>列)。因为关于性别的数据类型是分类数据，所以我们将使用饼图来分析它。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es mb"><img src="../Images/6ede3163f92bc1f913e3a5fdb5e08393.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*JKosENz5E1fypL3g6TiV1Q.png"/></div></figure><p id="3390" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我们观察一下，性别分布相当平衡，每个性别大约占30%。</p><p id="cd21" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在后面的建模中，我们仍然会使用这个分类特性。</p><p id="e100" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将使用一次性编码来进一步处理这个分类特征。</p><h2 id="c8e3" class="lj jd hh bd je lk ll lm ji ln lo lp jm ip lq lr jq it ls lt ju ix lu lv jy lw bi translated">数字特征</h2><p id="389a" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">接下来，让我们看看数字特征的分布。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mc"><img src="../Images/30b27b6ce2215714dea80c4cd5aa5ec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xd1Lyga8WLvo0O552hZ2dg.png"/></div></div></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es md"><img src="../Images/ab8a3d4d8a204a176d58f52aeafe3bdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lsjU6olXGpuYQRXCd9dk1A.png"/></div></div></figure><p id="9296" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从上图中，我们可以看到数字特征不是正态分布的，除了<code class="du lf lg lh li b">Height</code>特征看起来稍微呈正态分布。<code class="du lf lg lh li b">Length</code>和<code class="du lf lg lh li b">Diameter</code>特性的值分布在曲线的右侧，这意味着它们的偏斜度为负。其他要素的值分布在曲线的左侧，这意味着偏度为正。</p><p id="08d2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们看看这个数字特征中是否有异常值</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es me"><img src="../Images/3a04cd01ea46c45ed51e38f2dddced4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mxwzfpgn5tD-sPbHHJTqbA.png"/></div></div></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es md"><img src="../Images/eba09711fdc2348d15127dfdc96b0b27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5BC6C6LG5bXDHwOwJ5JLKw.png"/></div></div></figure><p id="aafc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以看到每个数字特征都有一个异常值。异常值的个数就是数据不呈正态分布的可能性。</p><p id="740c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们不会删除这个异常值，因为我们担心会丢失数据集中的信息。</p><p id="e2d0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于数字特征，在下一个过程中，我们将使用<code class="du lf lg lh li b">MinMaxScaler</code>缩放连续特征</p><h2 id="4c52" class="lj jd hh bd je lk ll lm ji ln lo lp jm ip lq lr jq it ls lt ju ix lu lv jy lw bi translated">目标分布</h2><p id="934f" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">接下来，我们将查看目标分布(<code class="du lf lg lh li b">Age</code>列)</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es mf"><img src="../Images/9ddfd22d5b9ac2550df1e38453f7dd79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*nTnQL8ZH7cvGrXgqVNaGdw.png"/></div></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mg"><img src="../Images/b50d1718914a5e3c10dd523eb470de67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ebd8TD0mHDdnl5CsDaTk2Q.png"/></div></div></figure><p id="324e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在上图中，我们可以看到目标不是正态分布，可能的值分布在曲线的左侧，这意味着偏斜度为正。</p><p id="a75a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了确保这一点，我们检查目标中是否有异常值。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es mh"><img src="../Images/f2a25d94e352cef5f07ea84186723449.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*TVImPXv5ftNa-jA8_G7ztQ.png"/></div></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es md"><img src="../Images/ca8c3b33e88199fcf21e533b8f7f235f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SIaLxutV_3yZWD3KlxfpGw.png"/></div></div></figure><p id="1ab2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">导致目标的异常值的存在不是最大分布的。我们也不会删除这些离群值，以免丢失数据集的信息。</p><p id="705f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将在目标上执行转换，以期提高模型的性能。</p><h2 id="7083" class="lj jd hh bd je lk ll lm ji ln lo lp jm ip lq lr jq it ls lt ju ix lu lv jy lw bi translated">皮尔逊相关</h2><p id="1b06" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">我们将看到特征之间的相关性，特别是数值特征与目标之间的相关性。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mi"><img src="../Images/8badf4cf3adb1f60289edbc0005463c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WlTYWQV6MGNjvrpGqU4PQg.png"/></div></div></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mj"><img src="../Images/9efa0ccc6f7ad82bb03ead46dc2f490f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d06Mdqs3HkAyyDNkHoZ86Q.png"/></div></div></figure><p id="a4c0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">每个数字特征与目标具有线性相关性，仅在0.5的范围内，这意味着与目标的线性既不太强也不太弱(中等)。</p><p id="bc7d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此外，我们可以在下面的散点图中看到它</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mk"><img src="../Images/53ad94f2991b8ceba80e8d051f940118.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WCzCyvijzq8kPpKf50KK9Q.png"/></div></div></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es md"><img src="../Images/ae34d4de1b39ce578762e71219bcc5f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P9PkeY1IxOZGlvG5X2zObw.png"/></div></div></figure><p id="58c9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以看到，在数字特征和目标之间存在线性关系，即使通过皮尔逊相关计算也是适度的。</p><h1 id="4f00" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">预处理和特征工程</h1><p id="0348" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">我们首先执行分类特征工程。我们将使用one-hot-encoding来编码分类特征。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es ml"><img src="../Images/b29ccc5749bf03b750e023382229c1b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*IrRDs45zUfteIo5Qx4ZM8g.png"/></div></figure><p id="1f03" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以看到数据集中的列增加到了11。让我们看看为结果设置的训练。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mm"><img src="../Images/7c494eaba7aa22c05ff449caa2bcc13a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BC0A4orbCgrEDyZoqCCKkw.png"/></div></div></figure><p id="2801" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，我们将特征与目标分开。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div class="er es mn"><img src="../Images/8da0fbe35eef0c4c793f8684c7f94765.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*lC14vcm8Zm0pbP08I4oiNA.png"/></div></figure><h1 id="bbff" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">系统模型化</h1><p id="c37f" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">我们将首先用<code class="du lf lg lh li b">MinMaxScaler</code>缩放特征。我们还将使用一个<code class="du lf lg lh li b">pipeline</code>来简化这个过程。我们还将使用<code class="du lf lg lh li b">GridSearchCV</code>来帮助估计最佳参数，其中cv等于5。</p><p id="3cf8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于使用转换目标的过程，我们将使用<code class="du lf lg lh li b">TransformedTargetRegressor</code>。</p><p id="eed2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将用<code class="du lf lg lh li b">np.sqrt</code>转换目标。</p><h2 id="5c9e" class="lj jd hh bd je lk ll lm ji ln lo lp jm ip lq lr jq it ls lt ju ix lu lv jy lw bi translated">线性回归</h2><p id="89f6" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">我们从线性回归模型开始。对于线性回归，我们估计的参数是<code class="du lf lg lh li b">fit_intercept</code>。</p><p id="9815" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">无目标转换的线性回归</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mo"><img src="../Images/187b58c89d4a3f21d16e12ef3c5fcd49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tQW0XPkjDEaKRRqU7j_0ug.png"/></div></div></figure><p id="b198" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">带目标转换的线性回归</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mm"><img src="../Images/a4df228d07d783b42eb5e84cf6cc1598.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rWFylcdVBw09hxzvEihQxg.png"/></div></div></figure><h2 id="e623" class="lj jd hh bd je lk ll lm ji ln lo lp jm ip lq lr jq it ls lt ju ix lu lv jy lw bi translated">最近邻回归</h2><p id="3325" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">我们将要估计的参数是<code class="du lf lg lh li b">n_neighbors</code></p><p id="18ac" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">无目标变换的最近邻回归</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mp"><img src="../Images/be50767337eb0c918136c9e33a83f488.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*76SY4nt6F2W_8TxEH5gDyQ.png"/></div></div></figure><p id="b41c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">采用目标变换的最近邻回归</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mq"><img src="../Images/8b3d3d84f508f46d8ea7ad6900fe2d2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Y2CXXqQyZL6XVnxWZ9IsA.png"/></div></div></figure><h2 id="a1c2" class="lj jd hh bd je lk ll lm ji ln lo lp jm ip lq lr jq it ls lt ju ix lu lv jy lw bi translated">决策树回归</h2><p id="daae" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">我们将为决策树回归设置的参数是<code class="du lf lg lh li b">max_depth</code>和<code class="du lf lg lh li b">max_features</code></p><p id="6570" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">没有目标转换的决策树</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mr"><img src="../Images/ebe17a1786df566732810ff0e959b797.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lYyHkPNzq-TU8hTOsk7LyA.png"/></div></div></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es ms"><img src="../Images/6bbf17b7d3b0c5d9bf7903289e0a7625.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oi_IpoUYgSIM2z44XaKCcQ.png"/></div></div></figure><p id="4b13" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">带目标转换的决策树</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mt"><img src="../Images/1672e59d7a1dbd74e3848d137e973793.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TMrozMFlsyqNoVRXRNqexQ.png"/></div></div></figure><h2 id="a20d" class="lj jd hh bd je lk ll lm ji ln lo lp jm ip lq lr jq it ls lt ju ix lu lv jy lw bi translated">支持向量回归</h2><p id="6666" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">我们将要设置的参数是<code class="du lf lg lh li b">C</code>和<code class="du lf lg lh li b">gamma</code>。</p><p id="b476" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">无目标转换的支持向量回归</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mu"><img src="../Images/1c2bb6e25daffc4d214b1e422074ebbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qUPi3iILiyyrbxd6c_XUjg.png"/></div></div></figure><p id="c795" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">带目标变换的支持向量回归</strong></p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mv"><img src="../Images/3b598d2f03f5fae67bd6309db989d164.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y-R7QdfsrjiCP90aUPvvcg.png"/></div></div></figure><p id="f692" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以上所有模型的计算，我们总结在下表中。</p><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mw"><img src="../Images/a73b79413fc10c81645e8c30092e0d72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D2UD_GcEEK65b5LKpHvxFA.png"/></div></div></figure><figure class="kq kr ks kt fd ku er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mx"><img src="../Images/ab2dede8e695d571d9440404a9521699.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k_gqfAdGvVPnLdsTAELCoA.png"/></div></div></figure><h1 id="19c5" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">讨论</h1><p id="b928" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">在线性回归中，目标变换能够减少均方误差值。它甚至能够提高模型的性能。但是，线性回归中的目标转换实际上降低了模型的复杂度。这可以在对转换的目标使用线性回归时看到，模型实际上经历了欠拟合。</p><p id="47eb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在KNN回归中，无论有没有目标变换，模型对数据都很复杂(过度拟合)。在这个模型中变换目标实际上降低了模型的性能并增加了均方误差值。虽然目标转换能够在相同模型的使用中稍微使模型更通用。</p><p id="c550" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">目标转换的效果在决策树回归中得到了很好的体现。目标变换能够减少均方误差值。虽然它降低了模型的复杂性，但目标转换能够使该模型对数据更通用。</p><p id="a28f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">目标变换对SVR模型有不利的影响。目标变换实际上增加了均方误差值，也降低了模型的性能。此模型中的目标转换也增加了模型的复杂性，从而使模型变得对数据不太通用。</p><h1 id="f60b" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">结论</h1><p id="4c4a" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">根据以上所有计算，可以得出以下结论:</p><ol class=""><li id="2975" class="kf kg hh ig b ih ii il im ip my it mz ix na jb nb kl km kn bi translated">目标转换对每个模型都有不同的影响。</li><li id="79e7" class="kf kg hh ig b ih nc il nd ip ne it nf ix ng jb nb kl km kn bi translated">在上面使用的四个模型中，可以用作预测器的模型是没有模型转换的线性回归。因为该模型是对数据最一般化的，即使它不是具有最小均方误差的模型。</li></ol><h1 id="46aa" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">进一步分析</h1><p id="f9d8" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">未来需要使用其他回归模型以及其他目标转换方法进行分析，如<code class="du lf lg lh li b">boxcox</code>、<code class="du lf lg lh li b">np.log1p</code>、<code class="du lf lg lh li b">np.log</code>等。</p><h1 id="9824" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">参考</h1><p id="a2d5" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">1.<a class="ae ko" href="http://archive.ics.uci.edu/ml/datasets/Abalone" rel="noopener ugc nofollow" target="_blank">http://archive.ics.uci.edu/ml/datasets/Abalone</a><br/>2。<a class="ae ko" href="https://thomassoseco.blogspot.com/2019/02/skewness-dan-kurtosis.html" rel="noopener ugc nofollow" target="_blank">https://thomassoseco . blogspot . com/2019/02/skewness-Dan-Kurt osis . html</a>T5】3 .<a class="ae ko" href="https://www.kaggle.com/ashokkumarpalivela/abalone-age-prediction-end-to-end-project" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/ashokkumarpalivela/鲍鱼-年龄-预测-端到端-项目</a> <br/> 4。<a class="ae ko" href="https://scikit-learn.org/stable/auto_examples/compose/plot_transformed_target.html" rel="noopener ugc nofollow" target="_blank">https://sci kit-learn . org/stable/auto _ examples/compose/plot _ transformed _ target . html</a><br/>5。<a class="ae ko" href="https://www.merdeka.com/jateng/regresi-adalah-metode-untuk-menentukan-sebab-akibat-kenali-jenis-dan-contohnya-kln.html?page=2" rel="noopener ugc nofollow" target="_blank">https://www . Merdeka . com/jateng/regrisi-adalah-meto de-untuk-menen tukan-sebab-aki bat-kenali-jenis-Dan-contohnya-kln . html？page=2 </a></p></div></div>    
</body>
</html>