<html>
<head>
<title>Statistical Inference in Bayesian and Frequentist Approach</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">贝叶斯和频率主义方法中的统计推断</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/statistical-inference-in-bayesian-and-frequentist-approach-530b58ed22f3?source=collection_archive---------16-----------------------#2021-07-15">https://medium.com/analytics-vidhya/statistical-inference-in-bayesian-and-frequentist-approach-530b58ed22f3?source=collection_archive---------16-----------------------#2021-07-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><blockquote class="ie if ig"><p id="8dd3" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">我正在阅读一篇关于标签一致性在机器学习系统中的重要性的文章，一个自然的问题进入了我的脑海——我们如何测试数据的一致性？在本文中，我设计了一个简化的场景来讨论在贝叶斯和频率主义方法中使用统计推断的解决方案。</p></blockquote><p id="f571" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated"><strong class="ik hi">问题描述<br/> </strong>我有一个数据集，包含100个类别的1，000，000张图片，但是它们没有标签。我是唯一一个在这个项目上工作的人，所以我决定聘请一家数据标签公司来为我做这项工作。在美国标记这么多图像的合理价格是25，555美元(基于<a class="ae jj" href="https://cloud.google.com/ai-platform/data-labeling/pricing" rel="noopener ugc nofollow" target="_blank">谷歌数据标记服务</a>)，我被承诺标记工作的正确率将是99%。这是一大笔钱，所以在我收到标记的数据后，我想检查它们是否达到99%的准确性。我该怎么做？</p><p id="1f40" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated"><strong class="ik hi">数据<br/> </strong>为了测试标记工作的准确性，我从数据集中随机抽取了500张图片，并手动检查每张图片的标签。我发现有12张图片分类错误。我能从这些实验数据中得到什么？</p><p id="43be" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">在我们继续讨论之前，有必要提一下我们对实验数据所做的一个假设。与1，000，000人口规模相比，500样本规模非常小，因此我们将假设每个样本是独立的同分布随机变量(i.i.d)。</p><p id="d4d3" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated"><strong class="ik hi">一种Frequentist方法<br/> </strong>在Frequentist框架中，我们可以使用数据进行假设检验，并计算p值。p值是在假设零假设为真的情况下，在替代假设的方向上观察到至少极值的概率。我们将假设如下。</p><p id="cc0e" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">H0(零假设) :标签的准确率是99%。<br/> H1(替代假设) :标签的准确率低于99%。</p><p id="8dcb" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">我们将测试的显著性值(alpha值)设置为0.05。</p><p id="dce6" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">现在我们假设标签工作的准确度是99%，我们需要计算P值。但是怎么做呢？假设工作的准确率为99%，在500个随机样本中观察到12个错误分类的图像甚至更多的概率是多少？</p><p id="1cee" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">嗯，我们可以把从人群中抽取一张图片看作伯努利过程。样本空间可以定义为{正确，不正确}，观察到不正确分类图像的概率P = 0.01。然后，我们可以将500个随机样本X中错误分类的图像数量视为一个随机变量，它遵循二项式分布。因此，我们有下面的等式。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/e7dca732a1ccfe989d5f647060006a2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DdGL74ZyqgTVBT9exRr5xQ.png"/></div></div></figure><p id="52c6" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">可以使用下面的代码在R中计算这个等式。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es jw"><img src="../Images/99f909ad772f37d748bb5c6455b9da4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*eVjKhhstf3Juq3sD_XBtvA.png"/></div></figure><p id="a229" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">我们的p值是0.005208，这意味着如果我们的零假设为真，即标记工作具有99%的准确性，我们有0.005208的概率在大小为500的随机样本中观察到12个或更多错误分类的图像。这个p值明显小于我们的alpha值0.05。因此，我们将拒绝零假设，因为样本测试提供了足够的证据反对零假设。</p><p id="f797" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">从Frequentist方法得出的结论是，标记工作的准确率低于99%。</p><p id="406a" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated"><strong class="ik hi">贝叶斯方法<br/> </strong>在贝叶斯范式中，我们也需要设定假设，但它与频率主义方法略有不同。贝叶斯假设，通常称为先验，是产生实验数据的可能模型。在我们的例子中，先验指的是在我们开始实验之前所有可能的准确性的可能性。然后，在我们有了每个精度的先验之后，我们将计算在每个精度下的实验中观察到这样的数据的可能性。在我们的例子中，它是在每个精度值下，在500个随机样本中观察到12个错误分类图像的可能性。最后，使用贝叶斯定理，我们可以计算每个精度值的后验分布，这是给定我们观察到12个错误分类图像的每个精度的可能性。在给定数据的情况下，具有最高后验概率的精度值将是我们对真实精度的最佳猜测。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jx"><img src="../Images/acfb90d1b1152fc55fee43f144d77f51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f7H4SlqiU8Ykfap2MvE5dw.png"/></div></div></figure><p id="f6b3" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">在贝叶斯推理中，先验分布是在一些证据被考虑之前，一个人对一些量的信念。在我们的案例中，我们感兴趣的是标签工作的真正准确性。在我们的样本测试之前，我们对工作的准确性了解多少？公司向我们承诺准确率为99%，但我们并不完全信任它。我们也知道，鉴于该公司的声誉，标签工作的准确率不太可能低于90%。鉴于我们所拥有的知识，我将设置我们的先验分布如下。我给99%的准确度0.5的先验，因为这是公司的保证，并且我在所有其他可能的准确度值中平均分配另外的0.5。所有先验的总和应该等于1。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jy"><img src="../Images/4ca7e461fe2af223c9511e94d5c126a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_1fUOfdmZmSo8UoEdy0i1w.png"/></div></div></figure><p id="09e0" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">接下来，我们将计算在每个精度值下观察到此类数据的可能性。同样，这个过程可以被视为伯努利过程。例如，如果精度为0.1，那么在500个随机样本中错误分类的图像数量遵循二项式分布，其中n = 500，p = 0.9。与频率主义方法的一个重要区别是，在贝叶斯方法中，观察至少极端数据的想法消失了。似然是每个模型下观察到确切实验数据的概率(精度值)。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jz"><img src="../Images/3d7b2bb150d3367f2e912c366ec6baaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Oca6DoLDz4VByg58dU20KQ.png"/></div></div></figure><p id="834b" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">以下是每种准确性的可能性。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ka"><img src="../Images/336925780c53a956f1a4e52ef7017f38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sryHlKFNqba0EL42EIAliA.png"/></div></div></figure><p id="68b0" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">现在我们可以计算证据，P(数据)= sum(先验*似然)。之后，我们可以使用贝叶斯公式计算后验概率的值。结果如下所示。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kb"><img src="../Images/a2c8804da0b618f51e177e7e93457ea6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*64kjKW0yrxiEaPAUCzKmxA.png"/></div></div></figure><p id="0204" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">从结果来看，acc=0.99的后验概率仅为0.144，而acc的后验概率&lt;0.99 is 0.856. Hence, we can conclude that it very likely the accuracy of the labelling work is below 99%. This conclusion aligns with our conclusion from the Frequentist approach.</p><p id="0ed6" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">Below is the complete R code for the Bayesian inference.</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kc"><img src="../Images/be946e2849fa730edafcc0a072b01015.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IIRPW9f6eLM_9dgIvk6aiw.png"/></div></div></figure><p id="dd8c" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated"><strong class="ik hi">结论<br/> </strong>从频率主义方法和贝叶斯方法我们得出结论，标记工作的真实准确度低于99%，这一点都不令人惊讶。直观来看，如果准确率为99%，错误分类图像的期望值n = 500 * 0.01 = 5，但我们观察到的是12。所以我们知道准确率很可能低于99%。事实上，如果我们仔细看看后验表，我们可以发现97%和98%的准确性具有最高的后验概率。在这些精度下，错误分类图像的预期数量分别为15和10。我们观察到的是12，介于两者之间，但更接近10。这就是为什么98%的准确率有最高的后验概率。</p><p id="9128" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">在本文中，我们对贝叶斯推理中的频繁者推理做了简单的比较。然而，有几件事我们现在还不能回答。例如，我们对自己的结论有多少信心？如果我们只是对图像的一个坏的部分进行采样，而实际上这项工作的总体准确率是99%，会发生什么呢？我将在下一篇文章中解决这些问题。感谢阅读！</p></div></div>    
</body>
</html>