<html>
<head>
<title>SMS Spam Classifier (Natural Language Processing)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">垃圾短信分类器(自然语言处理)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sms-spam-classifier-natural-language-processing-1751e2b324ed?source=collection_archive---------3-----------------------#2021-02-17">https://medium.com/analytics-vidhya/sms-spam-classifier-natural-language-processing-1751e2b324ed?source=collection_archive---------3-----------------------#2021-02-17</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/90483bcf71a593b00c007da358ac2563.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DPlpDiBvIWdbkcaRJSQpZQ.png"/></div></div></figure><p id="47ce" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">自然语言处理</strong> ( <strong class="ir hi"> NLP </strong>)是人工智能的一个分支，帮助计算机理解、解释和操纵人类语言</p><p id="802d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">今天，我将向您解释如何使用Python中的机器学习来构建一个垃圾短信分类器</p><p id="8f9c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将使用<strong class="ir hi">算法</strong>，例如:-</p><ul class=""><li id="028b" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">多项式朴素贝叶斯分类器</li><li id="1a44" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">支持向量机</li></ul><p id="232a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于这个项目，我们将使用<strong class="ir hi"> python库</strong>，比如:-</p><ul class=""><li id="746c" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">自然语言工具包</li><li id="0b92" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">sci kit-学习</li><li id="c1f9" class="jn jo hh ir b is jw iw jx ja jy je jz ji ka jm js jt ju jv bi translated">熊猫</li></ul><p id="36b9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">**Jupyter笔记本可在此<a class="ae kb" href="https://github.com/pulkitkhandelwal29/SMS-Spam-Classification" rel="noopener ugc nofollow" target="_blank"> github </a>帐户中找到**</p><h1 id="84a3" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">接近:-</h1><h1 id="9fed" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">1.读取数据</h1><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es la"><img src="../Images/ed69e741bc804030295eae93f62d2d4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rwL79e0fEjNe9-oBDCpyCQ.png"/></div></div></figure><p id="c729" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要读取数据，导入Pandas库并使用<em class="lf"> pd.read_csv() </em>读取数据。</p><p id="edcd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里文件中的数据是用制表符(\t)分隔的，所以我们必须提供“<em class="lf">sep</em>”(separate)参数。此外，该文件不包含任何列名，因此我们应该使用“<em class="lf"> names </em>”参数提供列名。</p><p id="ac45" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">数据存储在名为“<em class="lf">消息</em>”的数据帧中。</p><p id="f31f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要查看前5行数据，我们应该使用<em class="lf"> messages.head() </em></p><p id="0dba" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们可以看到，第一列包含<strong class="ir hi">标签(因变量)</strong>，即一条消息是垃圾邮件还是垃圾邮件，第二列包含实际的<strong class="ir hi">消息(自变量)</strong></p><h1 id="12f3" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">2.探索性数据分析</h1><figure class="lb lc ld le fd ii er es paragraph-image"><div class="er es lg"><img src="../Images/25aecb37fd2ed868fae6f330a9db0887.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*93WJ6Q-5KO9B_uxgPdU82w.png"/></div></figure><p id="263a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们可以看到这里有5572行和2列。这意味着有5572条消息和2个名为“<em class="lf">标签</em>”和“<em class="lf">消息</em>”的列。</p><p id="e610" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">数据中没有缺失值。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div class="er es lh"><img src="../Images/ea20d723c790b177995fa5e6fb957a06.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*5QTWsPpjdZ-tmtbj-nigkA.png"/></div></figure><p id="e541" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="lf">。value_counts() </em>帮助返回每个类别的总计数，即“火腿”和“垃圾邮件”。我们可以看到，垃圾短信比垃圾短信多。</p><p id="c371" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们看到，5572封邮件中有4825封(86.6%)是垃圾邮件。<br/>这意味着我们创建的任何机器学习模型都必须比86.6% 更好地执行<strong class="ir hi">才能击败随机机会。</strong></p><h1 id="8163" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">3.数据预处理</h1><p id="043b" class="pw-post-body-paragraph ip iq hh ir b is li iu iv iw lj iy iz ja lk jc jd je ll jg jh ji lm jk jl jm ha bi translated">在这里，我们计算每条消息的长度和标点符号以供进一步分析，并将其作为列添加到DataFrame ( <em class="lf">消息</em>)中。</p><div class="lb lc ld le fd ab cb"><figure class="ln ii lo lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/beb56b80c827339935d0f667fc10df9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*yrSZrNuQmTCuY5L7hWzivA.png"/></div></figure><figure class="ln ii lt lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/f66c2f8790408dc2d72939a3b4f74e36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*zdwdxPeuiTYuIuIzcNApJQ.png"/></div></figure></div><blockquote class="lu lv lw"><p id="0353" class="ip iq lf ir b is it iu iv iw ix iy iz lx jb jc jd ly jf jg jh lz jj jk jl jm ha bi translated"><strong class="ir hi">3.1</strong>T37】文字清理</p></blockquote><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/8a0c9501020b41e631e931798a0f8bdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m8VHWFbwxCpw3GMRHO2wqA.png"/></div></div></figure><p id="c036" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">消息包含文本，但带有许多标点符号和停用词(这些词在任何语言中都不会给句子增加太多意义。它们可以被安全地忽略，而不会牺牲句子的含义)、特殊字符和许多动词形式。</p><p id="d68b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，我们将通过删除不必要的内容来清理邮件。</p><p id="bd0b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将导入<strong class="ir hi"> re </strong> (regex库)，并从nltk库中导入<strong class="ir hi">停用词</strong>和<strong class="ir hi"> WordNet词汇化器</strong>(一个这样的方法<a class="ae kb" href="https://nlp.stanford.edu/IR-book/html/htmledition/stemming-and-lemmatization-1.html" rel="noopener ugc nofollow" target="_blank">词汇化</a>)并创建它的对象。</p><p id="0947" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，我们将遍历每条消息，并使用regex (substitute method)从消息中取出除小写字母(a-z)和大写字母(A-Z)之外的所有内容，并用空格替换。接下来，我们将小写该消息(因为abc与ABC不同)以使机器易于学习，然后将其拆分为单词。将通过列表理解中的拆分单词，我们将检查每个单词，它是否存在于nltk的停用词集合中，如果该单词不在停用词中，它将使用WordNet Lemmatizer对象进行词汇化。在每个单词被词条化后，我们将再次连接这些单词，形成一个句子，并添加到句子的语料库列表中</p><p id="39b7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="lf">用语料库中可用的已清理消息替换消息。</em></p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mb"><img src="../Images/a44d43c188b770b496940fcff0af9f51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XlSEyJuxIJv8WYZqZBuZmw.png"/></div></div></figure><blockquote class="lu lv lw"><p id="523d" class="ip iq lf ir b is it iu iv iw ix iy iz lx jb jc jd ly jf jg jh lz jj jk jl jm ha bi translated"><strong class="ir hi"> 3.2分析垃圾邮件和垃圾邮件的区别</strong></p></blockquote><p id="287e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">通过将标签与“垃圾邮件”或“垃圾邮件”进行比较，将其分为垃圾邮件和垃圾邮件，以供进一步分析。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mc"><img src="../Images/22ab7e469ca2dd267e533022e8782abb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cOgv09b01gx5Sd9FCLuTpg.png"/></div></div></figure><p id="8a36" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我们可以看到，spam_messages只有spam标签，ham_messages只有ham标签。这样做只是为了更好地了解数据。</p><div class="lb lc ld le fd ab cb"><figure class="ln ii md lp lq lr ls paragraph-image"><img src="../Images/162d933f39c94ef5895803d8b9403dd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*1SasQxyiT6NRQ9IBKGGhog.png"/></figure><figure class="ln ii me lp lq lr ls paragraph-image"><img src="../Images/8e472d6d47cb0ac4db4be010b43869c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*4r8OEWjMYv9ElbDX5tbJGw.png"/></figure></div><p id="d790" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们在这里可以看到，垃圾短信的平均字数比火腿短信多。标点符号也是一样，垃圾邮件比垃圾邮件有更多的平均标点符号。</p><h1 id="fef7" class="kc kd hh bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">4.模型结构</h1><p id="0795" class="pw-post-body-paragraph ip iq hh ir b is li iu iv iw lj iy iz ja lk jc jd je ll jg jh ji lm jk jl jm ha bi translated">分成'<em class="lf"> X </em>'，包含<strong class="ir hi">自变量</strong>即消息，'<em class="lf"> y </em>'包含<strong class="ir hi">因变量</strong>(目标变量)即标签(垃圾邮件或垃圾邮件)</p><div class="lb lc ld le fd ab cb"><figure class="ln ii mf lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/7f4ef2ddaccdd197f7b2f1132b39558b.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*5f88tNb_4c7H-cV7A_iuAw.png"/></div></figure><figure class="ln ii mg lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/ef3ee5e55815be42856eb0d653997204.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*cVkA8xDtfJmWtHqnbQ8ofw.png"/></div></figure></div><blockquote class="lu lv lw"><p id="2219" class="ip iq lf ir b is it iu iv iw ix iy iz lx jb jc jd ly jf jg jh lz jj jk jl jm ha bi translated"><strong class="ir hi"> 4.1列车试裂</strong></p></blockquote><p id="e690" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用scikit-learn库，我们可以将数据分为训练和测试。这里我将数据分为77%(训练数据)和33%(测试数据)</p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mh"><img src="../Images/5927409c3937ef4e58b0205c621bdbf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bTHJy-lHQoIrDHxoHUqOXA.png"/></div></div></figure><blockquote class="lu lv lw"><p id="f651" class="ip iq lf ir b is it iu iv iw ix iy iz lx jb jc jd ly jf jg jh lz jj jk jl jm ha bi translated"><strong class="ir hi"> 4.2处理文本(自然语言数据)数据</strong></p></blockquote><p id="535f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在该谈谈如何处理文本数据了。我们不能直接将文本传递给机器学习模型，因为机器只能理解0和1形式的数据。</p><p id="605f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了解决这个问题，我们将使用<a class="ae kb" rel="noopener" href="/@cmukesh8688/tf-idf-vectorizer-scikit-learn-dbc0244a911a"> TF-IDF矢量器</a>(词频-逆文档频)的概念。这是一种将文本转换为有意义的数字表示的标准算法，用于拟合预测的机器算法。</p><p id="6a25" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们也可以使用计数矢量器(单词包)，但是计数矢量器不像TF-IDF矢量器那样对单词进行加权。</p><p id="5307" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们可以使用scikit-learn库中的TF-IDF矢量器。接下来，创建一个TF-IDF矢量器的对象，并对数据进行fit_transform，它将转换为单词和句子的矩阵。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mi"><img src="../Images/d435935538d4b58db61eb261cb686634.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0GaYYcrquH4DA3I6yz6ZWQ.png"/></div></div></figure><p id="b170" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里，3733个是X_train的句子，5772个是从句子中获得的总字数。</p><blockquote class="lu lv lw"><p id="6742" class="ip iq lf ir b is it iu iv iw ix iy iz lx jb jc jd ly jf jg jh lz jj jk jl jm ha bi translated"><strong class="ir hi"> 4.3流水线作业</strong></p></blockquote><p id="7024" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们正在进行流水线作业，因为我们需要对测试数据执行相同的程序来获得预测；这可能会令人厌倦。</p><p id="bc12" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然而，这个管道对象的方便之处在于，它可以在单个单元中为您执行所有这些步骤，这意味着您可以直接提供数据。它将被矢量化，并在单个步骤中运行分类器。</p><p id="3fd1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">注意:-当我们稍后预测自定义文本时，我们可以直接将自定义文本传递给管道，这将有助于预测标签</p><p id="7803" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果您不了解管道，它会接受一个元组列表，其中每个元组接受您设置的名称，并调用您想要执行的任何方法。</p><p id="ec51" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">从sklearn.pipeline导入管道</strong></p><h2 id="8996" class="mj kd hh bd ke mk ml mm ki mn mo mp km ja mq mr kq je ms mt ku ji mu mv ky mw bi translated"><a class="ae kb" href="https://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes.MultinomialNB.html#:~:text=The%20multinomial%20Naive%20Bayes%20classifier,tf%2Didf%20may%20also%20work." rel="noopener ugc nofollow" target="_blank">多项式朴素贝叶斯分类器</a></h2><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mx"><img src="../Images/e4da5a21adfb44d92e8554025fc75ed1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z2RrYC_d5rO1l0MZ4Ul9ew.png"/></div></div></figure><p id="9919" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将从scikit-learn库中导入MultinomialNB模型。接下来，我们将使用管道创建一个名为"<em class="lf"> text_mnb </em>的模型，其中我们首先提供了<em class="lf"> TfidfVectorizer() </em>对象，然后提供了<em class="lf"> MultinomialNB() </em>对象。它应该按照我们想要的顺序提供，首先应该执行TfidfVectorizer，它的输出将被提供给模型，最后，我们用X_train和y_train拟合模型。</p><p id="314c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，每个内部功能都将由Pipeline处理，并相应地执行各个步骤。</p><p id="e23b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了进行预测，我们需要传递X_test数据，管道对象将处理它，即自动对其进行矢量化并为我们进行预测。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es my"><img src="../Images/4c6ca7c6c840537c172c02361c862cc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cO3OkPGFmAI_qWYiQ99KEQ.png"/></div></div></figure><p id="a777" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">"<em class="lf"> y_preds_mnb </em>"包含我们的模型进行的X_test的预测，达到大约<strong class="ir hi"> 97% </strong>的准确度，相对好于随机机会。</p><p id="729e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们必须知道，准确性本身并不能证明模型运行良好。我们将使用scikit-learn库来获得关于<strong class="ir hi">混淆_矩阵</strong>和<strong class="ir hi">分类_报告</strong>的报告</p><figure class="lb lc ld le fd ii er es paragraph-image"><div class="er es mz"><img src="../Images/48640feb5b0f199ebf228b010cf522f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*AHT7Wk1v65Wb85ur9x14wQ.png"/></div></figure><p id="a9da" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这里，我们可以看到“火腿”标签预测良好，但“垃圾邮件”标签预测不佳，因此我们不能说该模型是优秀的。模型无法准确预测垃圾邮件。</p><p id="3c86" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们用SVM(支持向量机)来尝试同样的问题</p><h2 id="3863" class="mj kd hh bd ke mk ml mm ki mn mo mp km ja mq mr kq je ms mt ku ji mu mv ky mw bi translated"><a class="ae kb" href="https://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes.MultinomialNB.html#:~:text=The%20multinomial%20Naive%20Bayes%20classifier,tf%2Didf%20may%20also%20work." rel="noopener ugc nofollow" target="_blank">线性SVC </a>(支持向量分类器)</h2><p id="2ea1" class="pw-post-body-paragraph ip iq hh ir b is li iu iv iw lj iy iz ja lk jc jd je ll jg jh ji lm jk jl jm ha bi translated">将执行与上面相同的步骤，唯一不同的是我们需要从scikit-learn库中导入LinearSVC</p><div class="lb lc ld le fd ab cb"><figure class="ln ii na lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/378e55275b5bc40423a0c71f7d3b1199.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*1Dw51LDi8bPe05AWxfuHKw.png"/></div></figure><figure class="ln ii nb lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/fe4bcc50d58fa6cd8f2a6690ac30c425.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*MxcFAhGkUMkXLyBdo3nfhw.png"/></div></figure></div><p id="176c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">从执行TfidfVectorizer和LinearSVC模型创建的管道对象创建名为“<em class="lf"> text_svm </em>的模型，然后将X_train和y_train拟合到该模型。“<em class="lf"> y_preds_svm </em>”是使用模型进行X_test的预测，准确率约为<strong class="ir hi"> 98.69% </strong>，优于多项式模型。</p><p id="bcf2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，让我们看看<strong class="ir hi">评估指标</strong>，以便更好地了解模型的表现。</p><figure class="lb lc ld le fd ii er es paragraph-image"><div class="er es nc"><img src="../Images/2f76bf9d3e021f6f698d5a0aab59dd65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*qD0ba-YgH3_tDKCDYHz4QA.png"/></div></figure><p id="a298" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们可以看到“火腿”得到了惊人的预测，与“多项”模型相比，“垃圾邮件”标签的预测也增加了。</p><p id="db81" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">现在模型已经创建好了，让我们在一个自定义文本上尝试一下，看看模型预测了什么！</strong></p><figure class="lb lc ld le fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nd"><img src="../Images/896849cf577e4a55ccc7444a9e9d3b7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RRMXfOXYQVYG1-r8tRqzVQ.png"/></div></div></figure><p id="5d13" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们提供了定制文本，并对文本进行了精炼(删除了停用词、标点符号，并执行了词汇化)。我们在上面已经做到了这一点；只是这里定义了一个函数，它使用自定义文本来删除所有内容。</p><p id="4c28" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后，我们使用SVM模型，即“<em class="lf"> text_svm </em>”，它具有包含TfidfVectorizer和LinearSVC模型函数的流水线。我们直接将精炼的单词(干净的单词)传递给模型，它预测该消息为“垃圾邮件”。</p><p id="b78e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这篇文章的最后，我希望你明白如何处理自然语言(文本数据)以及如何使用机器学习来解决现实世界的问题(Gmail使用ML来将邮件分类为垃圾邮件或Ham)</p><p id="aab1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">快乐学习！</p></div></div>    
</body>
</html>