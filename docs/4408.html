<html>
<head>
<title>Common Excel Functions in Julia</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Julia中常见的Excel函数</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/common-excel-functions-in-julia-df51674a896e?source=collection_archive---------0-----------------------#2021-10-07">https://medium.com/analytics-vidhya/common-excel-functions-in-julia-df51674a896e?source=collection_archive---------0-----------------------#2021-10-07</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/ac17b4a7f643d57d37d3e8bdb4503e39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RNQuqoX7rsdOqQ1F0cnvFQ.png"/></div></div></figure><p id="4470" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">去年我写了一篇关于如何用Python实现常见excel函数的文章。</p><p id="a0d7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我正在学习茱莉亚语言。这是一种为数据科学工作负载而设计的语言。它的语法和python一样简单，但是它的代码运行速度几乎和c一样快。</p><p id="843d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">所以我写了这篇关于如何在Julia中实现表格数据的常见操作的文章。</p><ol class=""><li id="ac7c" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated"><strong class="ir hi">朱丽亚的安装</strong></li></ol><p id="59e6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您可以从下面链接下载并执行适用于您操作系统安装程序来安装Julia</p><p id="4454" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">【https://julialang.org/downloads/ T4】</p><p id="b892" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">2.<strong class="ir hi">安装所需的库</strong></p><p id="ba79" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们需要XLSX，Dataframe和统计库来处理表格数据。为了在Julia中安装库，我们使用库Pkg的add函数。</p><p id="6413" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">首先在windows命令提示符或linux的bash中运行以下命令，以获得Julia命令提示符</p><pre class="jx jy jz ka fd kb kc kd ke aw kf bi"><span id="2305" class="kg kh hh kc b fi ki kj l kk kl">Julia</span></pre><p id="5afb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后，我们通过在Julia的命令提示符下执行以下命令来安装这些库</p><pre class="jx jy jz ka fd kb kc kd ke aw kf bi"><span id="b0e0" class="kg kh hh kc b fi ki kj l kk kl">using Pkg<br/>Pkg.add("DataFrames")<br/>Pkg.add("XLSX")<br/>Pkg.add("Statistics")</span></pre><p id="50c5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我用Jupyter笔记本进行数据探索。要安装jupyter notebook，在Julia shell中运行以下命令</p><pre class="jx jy jz ka fd kb kc kd ke aw kf bi"><span id="4277" class="kg kh hh kc b fi ki kj l kk kl">Pkg.add("IJulia")</span></pre><p id="5404" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要打开jupyter笔记本，请在Julia shell中运行以下命令</p><pre class="jx jy jz ka fd kb kc kd ke aw kf bi"><span id="ab28" class="kg kh hh kc b fi ki kj l kk kl">using IJulia<br/>notebook()</span></pre><p id="6f3a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下一节中的命令在Jupyter notebook中执行。</p><p id="4fcf" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">3.<strong class="ir hi">库的导入</strong></p><p id="d7ed" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">所需的库按如下方式导入</p><pre class="jx jy jz ka fd kb kc kd ke aw kf bi"><span id="1191" class="kg kh hh kc b fi ki kj l kk kl">using XLSX<br/>using DataFrames<br/>using Statistics</span></pre><p id="f34b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">4.<strong class="ir hi">读取Excel文件</strong></p><p id="dff8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您必须提供excel文件的文件名和工作表名，以使用XLSX库的readtable函数</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es km"><img src="../Images/05c44b977f6aa25b115d7dd8a03abaa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*mYk31XFJfV2TdqIX68zvIQ.png"/></div></figure><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es kn"><img src="../Images/0f1bae6f8cb96e420364eb93bab496c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*w1AR0rY5bHEpS_Y29IazSw.png"/></div></figure><p id="b7d9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果您想读取CSV文件，您可以使用以下语法</p><pre class="jx jy jz ka fd kb kc kd ke aw kf bi"><span id="482e" class="kg kh hh kc b fi ki kj l kk kl">using CSV<br/>DataFrame(CSV.File(input))</span></pre><p id="9221" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">5.<strong class="ir hi">数据检查</strong></p><p id="5203" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们可以通过使用Julia的第一个和最后一个命令来可视化笔记本中的数据帧。“First”输出数据帧的前n行。Last可用于输出数据帧的最后几行。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es ko"><img src="../Images/89afae87f62c57389d0f365e7814dab0.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*SDllHC_7bwUTxvUEaqzMFg.png"/></div></figure><p id="5408" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因为我提供了5作为参数，所以第一个命令输出数据帧的前五行。最后一个命令输出了数据帧的最后五行。</p><p id="9d98" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">6.<strong class="ir hi">通过索引访问数据</strong></p><p id="878a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们可以通过向[]操作符提供行和列来访问数据帧的行和列。我们必须提供行和列。如果我们想选择所有的行或列，那么我们必须使用“:”操作符。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es kp"><img src="../Images/e788b7bf823f441e460c69de2fcfe336.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*XhLPqGmTuvbj34LliM9KPw.png"/></div></figure><p id="618f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">1:3被转换成1到3的数组。因此，这选择了行1到行3。在第一个例子中，我提供了一个列名，因此它返回该列的前3个元素。当我提供“:”操作符作为列选择器时，它返回dataframe的前3行的所有列。</p><p id="4b6f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们可以使用数组和逻辑数组进行行或列索引。请注意“.”运算符用在'</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es kq"><img src="../Images/0ef195936f8e4e00f19cfaf5d3dbb3b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*mXSpR98-oArbTZF7SeM-5g.png"/></div></figure><p id="ea0a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">7. <strong class="ir hi"> Sum，Min，Max，Mean </strong>之前</p><p id="bb55" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Sum、minimum和maximum是核心的Julia函数，可用于任何Julia数组或向量。均值函数由我们导入的统计软件包提供。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es kr"><img src="../Images/6d44f0000acf12cf243b05a88e966e80.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*GIhU8e76F0K7HiFPI5SqIw.png"/></div></figure><p id="3e4e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">8.<strong class="ir hi">元素式操作</strong></p><p id="d6d7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们可以对数据帧的列执行算术运算符。标量数字被广播到数据帧的列的大小。我们用“.”算术运算符之前的运算符。在朱莉娅加了“.”在加减等算术运算符之前，向量化运算。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ks"><img src="../Images/6e7290d19184ce0ff6b2de17729bf383.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*4dKNtd_K0dII3hd1BTxdFg.png"/></div></div></figure><p id="ecfb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">9.<strong class="ir hi">列智操纵</strong></p><p id="6c44" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">以类似的方式，我们可以在数据帧的两列之间进行算术运算</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es kt"><img src="../Images/5934ed5b35cc2ea053e53193c9d73fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*6senBpmqek9W64QLmpxlzw.png"/></div></figure><p id="f35e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">10.<strong class="ir hi">琴弦操作</strong></p><p id="0838" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于串联，使用“*”运算符。在它之前添加一个点来矢量化操作。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es ku"><img src="../Images/500cba084ea7beda3317709a9e5dacca.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*465KiTGHHUt6QCI8QnFyqQ.png"/></div></figure><p id="22b2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Julia的Select函数用于将特定函数应用于数据帧的一列。Byrow用于在dataframe的列上应用函数元素方式。通过这种方式，我们可以获得字符串列的前5个字符。这类似于excel的左功能。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es kv"><img src="../Images/61eb7493a16569510b64fd53f5684aef.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*9CjOAmWxz55PKsaYehroVQ.png"/></div></figure><p id="1fbc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">--&gt; '用于创建一个匿名函数来获取字符串的前5个字符。</p><p id="a484" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Julia提供了常见的字符串操作函数，其细节如下</p><p id="6df7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae jn" href="https://docs.julialang.org/en/v1/base/strings/" rel="noopener ugc nofollow" target="_blank">https://docs.julialang.org/en/v1/base/strings/</a></p><p id="7500" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们可以使用上面链接中给出的常用字符串操作函数在Julia dataframe中进行字符串操作。Startswith、endswith和occursin是最有用的函数。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es kw"><img src="../Images/e884510b25a94845f000e308acd5640f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*dB28mfjzNx-kjWvL7wMuFQ.png"/></div></figure><p id="39ae" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">11 <strong class="ir hi">和积</strong></p><p id="d931" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Sum函数可用于两列乘积的输出。它将等同于Excel中的sumproduct函数。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es kx"><img src="../Images/e1449c9743951c1985b632d8266ff299.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*3Okf8OCiI-VPS2IzJZefbg.png"/></div></figure><p id="7360" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">12 <strong class="ir hi">排序</strong></p><p id="ca8d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Sort函数可用于对数据帧的行进行排序。我们必须提供列名或列名列表，数据帧的行将在其中排序。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es ky"><img src="../Images/dfb6dedd5780779ed0f96959ba2d43cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*3ICNv1DYl50uvOMwBO0nww.png"/></div></figure><p id="69cf" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于跨多个列的排序，我们提供了列的列表。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/6d4d63338cf7363b80517e47ad50a5cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*ElCKYmezuyQH1Szodw6Ewg.png"/></div></figure><p id="96be" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了以相反的顺序排序，我们必须提供rev= True作为函数的关键字参数。</p><p id="0f04" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">13 <strong class="ir hi">独特的</strong></p><p id="61d8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Unique函数可用于获取数据帧中的唯一行。如果我们不提供列名作为参数，它将考虑所有列来决定一行是否唯一。如果我们想在dataframe的列子集上获得唯一的值，我们可以提供一个列名或列名列表。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es la"><img src="../Images/81e76a6b33d7f9ea6d877c738bb9d6c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*nC4ojFzma9kAbsMvJ7yMDg.png"/></div></figure><p id="8eb9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">14 <strong class="ir hi"> Countif </strong></p><p id="2caa" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">COUNTIFS函数在excel中用于对满足一个或多个条件的单元格区域进行计数。</p><p id="229f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">count(df)仅返回数据帧或数组中的行数。但是我们也可以提供一个函数作为参数之一来计数。然后，它将返回函数返回true值的行数。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es lb"><img src="../Images/b9443103eb11c9d8eab8a16b05d5d1db.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*RTmOzDv1Mmkj4_4-Gq3eIg.png"/></div></figure><p id="6656" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">此函数计算数据帧中收入大于100的行数。每个row函数将数据帧转换为其所在行的可交互数据。然后，对其应用第一个参数中给出的匿名函数。</p><p id="d1e3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">15 <strong class="ir hi">枢轴</strong></p><p id="38b9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在Excel中，数据透视表用于计算分组统计数据。Julia没有数据透视表功能，但是使用groupby，我们可以对数据进行分组统计。</p><p id="ce96" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">首先使用groupby函数，我们得到数据中的组。然后，我们使用组合函数来应用聚合函数，以获得分组统计信息。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es lc"><img src="../Images/8e602627fb3a5be0259a78f342c0bd5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*xOJAJyEe1uHQAOgwR5KdIg.png"/></div></figure><p id="235b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里我们将location列传递给groupy。它将根据位置值识别组。我们可以传递其他列或列名列表。</p><p id="ac0b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后，我们对每个组的收入列应用sum函数。我们可以像在第二个例子中传递mean一样传递其他函数来获得组内平均值。</p><p id="4038" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">16 <strong class="ir hi">过滤器</strong></p><p id="8c62" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">有两种主要方法来过滤数据帧的行。我们可以使用过滤函数，它是Julia库的一部分。或者我们可以使用subset函数，它是Julia dataframe库的一部分。</p><p id="d11c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们向过滤函数传递两个参数。第一个参数是一个函数，它迭代数据帧的每一行。在下面提到的示例中，如果收入列大于零，则该函数返回true。Filter functions返回函数为其返回true值的行。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es ld"><img src="../Images/e658a4743612f1c99275860f4f4e9788.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*DfE4n6jgs76xqkQcfCD7IQ.png"/></div></figure><p id="a2e1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们可以使用按位and (&amp;)或按位运算符(|)来组合多个列的条件。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es le"><img src="../Images/1e6361f313fa9a1f1c2a627304e36f79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*GpV45NAqYGTZH23RbDiJWA.png"/></div></figure><p id="2bdd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">子集也用于过滤数据帧的行。在子集函数中，我们必须为每一列分别指定函数。在下面给出的示例中，函数应用于dataframe的Group列。它返回组列值大于3的行。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es lf"><img src="../Images/8222ad05a9b70e5381a7ae3ca4cfed8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*5Pr6gIqM5OvQEy32uHpmqg.png"/></div></figure><p id="0500" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果我们想在多列中应用条件，那么我们可以分别为每一列提供函数。它返回组列值大于3且收入列值大于200的行。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es lg"><img src="../Images/d76635f57c75ae2ad68d067820596406.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*Wtxo2t8b6mOacAFYIlIK7g.png"/></div></figure><p id="b14f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">17 <strong class="ir hi"> Vlookup </strong></p><p id="9c13" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">excel中的VLookup函数用于连接Excel中的两个表。它可以在Julia中使用leftjoin函数实现，如下所示。这里的组列是两个表之间的公共列。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es lh"><img src="../Images/3f400addda00589c4d0a2f60f32adbae.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*k9xp11mqNg0OK8UsBIUWQg.png"/></div></figure><p id="5e62" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">18 <strong class="ir hi">组合数据帧</strong></p><p id="8fb3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们可以使用vcat函数将一个数据帧的行追加到另一个数据帧中。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es li"><img src="../Images/5c4a9158c67e7c17da83c1fe43ce88d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*iT0kwOX1hIyx0zanbkARKA.png"/></div></figure><p id="82de" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于水平列追加，我们使用hcat函数。如果列不是唯一的，我们必须传递makeunique = true。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es lj"><img src="../Images/46823edd4384110051d9b69cebc395a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*KWfZi8xvLDGDFF3BJtsEzA.png"/></div></figure><p id="f731" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">19 <strong class="ir hi">如果否则</strong></p><p id="109f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果函数在excel中用于根据条件在值中进行选择。Julia的Ifelse函数可用于根据条件的结果返回值。如果收入大于100，下面给出的函数返回1，否则返回2。</p><figure class="jx jy jz ka fd ii er es paragraph-image"><div class="er es lk"><img src="../Images/7bad62342cf17427c9ca252fcd181d47.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*hJeNbfUKTFTZijSLnsGFMQ.png"/></div></figure><p id="f02b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> 20。保存文件</strong></p><p id="e240" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果要将输出保存为CSV文件，可以使用以下语法</p><pre class="jx jy jz ka fd kb kc kd ke aw kf bi"><span id="d4b6" class="kg kh hh kc b fi ki kj l kk kl">CSV.write(output, df)</span></pre><p id="75c4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果我们想将输出保存为excel，我们可以使用以下语法</p><pre class="jx jy jz ka fd kb kc kd ke aw kf bi"><span id="b295" class="kg kh hh kc b fi ki kj l kk kl">XLSX.writetable("df.xlsx", collect(DataFrames.eachcol(df)), DataFrames.names(df))</span></pre><p id="35e3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">21.<strong class="ir hi">总结</strong></p><p id="82db" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们可能有一个excel工作表，其中有许多公式。我们想在Julia中实现工作表的逻辑。在这种情况下，使用这些python函数，我们可以轻松地从Excel过渡到Julia。</p></div></div>    
</body>
</html>