<html>
<head>
<title>Polynomial Regression〰️</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多项式Regression〰️</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/polynomial-regression-%EF%B8%8F-e0e20bfbe9d5?source=collection_archive---------12-----------------------#2021-02-06">https://medium.com/analytics-vidhya/polynomial-regression-%EF%B8%8F-e0e20bfbe9d5?source=collection_archive---------12-----------------------#2021-02-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/1a8faa01093806762d656d890d6da13e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Ody0Ez0-VYDRF6eomVYJeg.gif"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated"><a class="ae it" href="http://stevenlio.shinyapps.io/polyfit" rel="noopener ugc nofollow" target="_blank">http://stevenlio.shinyapps.io/polyfit</a></figcaption></figure><h1 id="399b" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated"><strong class="ak">简介</strong></h1><p id="d6ba" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">我是线性代数的信徒，总是着迷于它强大的应用。线性回归是我学到的线性代数的第一个应用。简单来说，线性回归就是通过最小化数据与回归函数之间的距离，来概化一个标量变量(因变量~ <em class="kq"> y </em>)与一个或多个解释变量(自变量~ <em class="kq"> x </em>)之间的线性关系的过程。<em class="kq">又称简单线性回归中的最佳拟合线</em>。</p><h1 id="b0f2" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated"><strong class="ak">问题</strong></h1><figure class="ks kt ku kv fd ii er es paragraph-image"><div class="er es kr"><img src="../Images/bb0042f67ff33125f9657a476fb29dd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*XoaCE2UHVaWXWx4lPuiVZg.png"/></div></figure><p id="0670" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">但是…世界🌎是一个有趣的地方，纯粹的线性关系很少存在，事情喜欢以某种方式相互关联。因此，成功应用线性回归的线性关系和多重共线性假设在大多数情况下都会被违反。<em class="kq"> R，MSE </em>(均方误差)经常被引用作为回归模型好坏的指标。但是这些指标和数据建模中的许多其他指标一样，并不完美。(看你——相关性，ROC，p值等。)</p><p id="d23d" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">这里有一个著名的例证——<a class="ae it" href="https://en.wikipedia.org/wiki/Anscombe%27s_quartet" rel="noopener ugc nofollow" target="_blank"><strong class="ju hi">安斯康贝的四重奏</strong> </a>。</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lb"><img src="../Images/7bc5c22efa4bf59108c5112c42d5897f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*waTJFr6ouWljDqlsKXVvjQ.png"/></div></div></figure><p id="783e" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">这四组数据看起来非常不同，但所有的描述性统计数据都是相同的，并且“最佳拟合线”的行为也完全相同。这里<em class="kq"> x </em>与<em class="kq"> y </em>的相关性为<em class="kq"> 0.816 </em>，回归线为<strong class="ju hi">T25】y = 3.0+0.5x</strong><em class="kq"/><em class="kq">R</em>为<em class="kq"> 0.67 </em>。但细看剧情，很明显除了<strong class="ju hi">案例1 </strong>“最佳拟合”的直线对其他案例有意义吗？</p><ul class=""><li id="e8e5" class="lc ld hh ju b jv kw jz kx kd le kh lf kl lg kp lh li lj lk bi translated"><strong class="ju hi">情况1:</strong><em class="kq">x1</em>和<em class="kq"> y1 </em>之间的简单线性关系可能是最好的假设，可以很容易地建模。</li><li id="6c9b" class="lc ld hh ju b jv ll jz lm kd ln kh lo kl lp kp lh li lj lk bi translated"><strong class="ju hi">案例二:</strong>数据看起来像一个倒抛物线的一部分，因此<em class="kq"> x2 </em>和<em class="kq"> y2 </em>肯定不是线性关系。</li><li id="50b2" class="lc ld hh ju b jv ll jz lm kd ln kh lo kl lp kp lh li lj lk bi translated"><strong class="ju hi">案例三:</strong>似乎有一个<strong class="ju hi"><em class="kq"/></strong>异常值充当了一个非常<a class="ae it" href="https://en.wikipedia.org/wiki/Leverage_(statistics)" rel="noopener ugc nofollow" target="_blank"> <strong class="ju hi"> <em class="kq">高杠杆</em> <em class="kq">点</em></strong></a><strong class="ju hi"><em class="kq"/></strong>到回归线。即，线的斜率对这一点非常敏感，但是简单地排除这个<strong class="ju hi"> <em class="kq">异常值</em> </strong>将产生完美的线。</li><li id="24d8" class="lc ld hh ju b jv ll jz lm kd ln kh lo kl lp kp lh li lj lk bi translated"><strong class="ju hi">案例4: </strong>另一种类型的a <a class="ae it" href="https://en.wikipedia.org/wiki/Leverage_(statistics)" rel="noopener ugc nofollow" target="_blank"> <strong class="ju hi"> <em class="kq">高杠杆点</em> </strong> </a>，与<strong class="ju hi">案例3 </strong>不同，排除此点不会产生完美的线条，因为<em class="kq"> y4 </em>具有不同的值，而<em class="kq"> x4 </em> <strong class="ju hi"> <em class="kq"> </em> </strong>仍保持在<em class="kq"> 8 </em>。即<em class="kq"> x4 </em>和<em class="kq"> y4 </em>之间几乎没有关系</li></ul><p id="5422" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">总的来说，<strong class="ju hi">案例3 </strong>和<strong class="ju hi"> 4 </strong>在决定线性回归是否是建模这些数据的好选择之前，需要更好地理解数据。但是对于<strong class="ju hi">情况2 </strong>，一条“直线”可能还是可以的。</p><p id="633c" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">当数据不像<em class="kq">对数变换</em>那样线性时，有许多简单的<a class="ae it" href="https://en.wikipedia.org/wiki/Data_transformation_(statistics)" rel="noopener ugc nofollow" target="_blank">技巧</a>可以应用于数据。但是在处理<strong class="ju hi">非线性数据</strong>时，大多数情况可以归纳在<strong class="ju hi">曲线拟合</strong>的主题下。<strong class="ju hi"> </strong>当数据没有随机噪声时，寻找最佳拟合曲线<strong class="ju hi"> </strong>的问题就变成了<a class="ae it" href="https://en.wikipedia.org/wiki/Interpolation" rel="noopener ugc nofollow" target="_blank"> <strong class="ju hi">插值</strong> </a> <strong class="ju hi"> </strong>的问题。</p><h1 id="7337" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated"><strong class="ak">想法</strong></h1><p id="58e4" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated"><strong class="ju hi">曲线拟合</strong>是构建一条曲线的过程——一个对一系列数据点具有最佳拟合的数学函数。曲线拟合常用于<strong class="ju hi"> <em class="kq">插值</em> </strong>，从一个未知函数中抽取随机样本，并寻找通过每个样本点的最佳曲线。</p><p id="c2a5" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">此外，在工程中，在<strong class="ju hi"> <em class="kq">信号处理</em> </strong>或<strong class="ju hi"> <em class="kq">平滑</em> </strong>中，引入了一些随机噪声，或者数据是由一些底层函数生成的，其中构造了一个更简单的“<strong class="ju hi"> <em class="kq">平滑</em> </strong>”函数，它可以近似拟合数据，并理解所记录信号的趋势或特征。</p><p id="88a2" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">这是一个多项式函数，其形式为:</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div class="er es lq"><img src="../Images/975d75387619123d55828c0f1a20a370.png" data-original-src="https://miro.medium.com/v2/resize:fit:330/1*kb8_zrXEhvP-GieWaN6fig.gif"/></div></figure><p id="e3bf" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">系数<em class="kq"/><strong class="ju hi"><em class="kq"/></strong>为常数，<em class="kq"> </em> <strong class="ju hi"> <em class="kq"> n </em> </strong>表示多项式的最高次。</p><p id="8fed" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated"><strong class="ju hi">当k=0(常数)时:</strong></p><figure class="ks kt ku kv fd ii er es paragraph-image"><div class="er es lr"><img src="../Images/dd9ad7ad954e78d3233bcc34a305b9f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:202/1*8m-pAAeKNnZc7JbBFAYcAA.gif"/></div></figure><p id="a6c1" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated"><strong class="ju hi">当k=1时(a <em class="kq">直线</em>就像<em class="kq"> y = mx + b </em> ): </strong></p><figure class="ks kt ku kv fd ii er es paragraph-image"><div class="er es ls"><img src="../Images/f55eb6eb9ad41ebbb6a64c60285a8080.png" data-original-src="https://miro.medium.com/v2/resize:fit:334/1*QfnoNAx5BfKamLjM4K5MhQ.gif"/></div></figure><p id="ae1e" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated"><strong class="ju hi">当k=2时(二次多项式又称<em class="kq">抛物线</em>或<em class="kq">四次函数</em> ): </strong></p><figure class="ks kt ku kv fd ii er es paragraph-image"><div class="er es lt"><img src="../Images/36569adfc70e62ea0f9fa0181c213fd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:488/1*JF4A-B_F0Srh04IDp8VL7A.gif"/></div></figure><p id="1279" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated"><strong class="ju hi">那么当k=n ( <em class="kq"> n </em>次多项式):</strong></p><figure class="ks kt ku kv fd ii er es paragraph-image"><div class="er es lu"><img src="../Images/dc3e367245cbeff927a493b3839d0a86.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/1*lr644AoUI9JuzdlvpByXTg.gif"/></div></figure><p id="8acd" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">你可能会问，这有什么关系，让我们看看下面的例子。让我们从函数中生成随机点:</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div class="er es lv"><img src="../Images/5f509b8a804ca264d5d80a10aa9d6d7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:350/1*xkON4WN--sHKxoee8vXN4Q.gif"/></div></figure><figure class="ks kt ku kv fd ii er es paragraph-image"><div class="er es lw"><img src="../Images/7680501df2a0b6b6c2a03d2f4c5b89db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*8sX9FNk9GOjOaHCTBYVbVQ.png"/></div></figure><p id="42ef" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">人们怎么可能找到一条“线性”线来拟合这条曲线呢？这里的小数学称为<a class="ae it" href="https://en.wikipedia.org/wiki/Polynomial_expansion#:~:text=Expansion%20of%20a%20polynomial%20expression,sum%20of%20(repeated)%20products." rel="noopener ugc nofollow" target="_blank"> <strong class="ju hi"> <em class="kq">多项式展开</em> </strong> </a>:</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lx"><img src="../Images/87f89722bb8ecd4fe44dc0576fd74c41.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/1*0SSwX2_03ng2mLMi30ICdQ.gif"/></div></div></figure><p id="010e" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">我们可以看到这是一个3次多项式，因为最高次数项是3。但一旦你仔细观察，这看起来不正是一条有3个独立变量的回归线吗？</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div class="er es ly"><img src="../Images/3354c72f2edcd7bb2c87d72b58f2a42b.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/1*xKFJv7ftHHr3ZjljCldmeA.gif"/></div></figure><p id="7fcb" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">既然这样</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div class="er es lz"><img src="../Images/b59e4e20c429b80bc873b2ca4cf44371.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/1*XshDiVMge0GI4TXW2xtoYQ.gif"/></div></figure><p id="5bd9" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">这里我们可以看到每个自变量(<em class="kq"> x </em>)对应每个多项式次数项<em class="kq"> xᵏ </em>。</p><p id="c0e4" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">考虑到这一点，那么我们也许可以通过计算<em class="kq"> x，x，x </em> …，基于样本点的<em class="kq"> x </em>坐标创建新的独立变量。并添加到线性回归模型，而不是1个独立变量，我们现在有3个。</p><p id="0697" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">当我们不知道数据的基本功能时，我们可以慢慢地添加更高次的项，并重新评估拟合，但这几乎与猜测和假设数据来自多项式一样好。此外，多项式的次数没有限制，因此我们将花费无限的时间来测试每一个多项式，次数越高，多项式的表现就越激进，这会导致数据过度拟合(稍后解释)。</p><h1 id="2af1" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated"><strong class="ak">在实践中</strong></h1><p id="ef2b" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">为了说明这一点，我使用R Shiny构建了这个可视化工具。让我们尝试使用0次多项式(即常数)来拟合曲线:</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/c67b3c18e5450b43aba859ebe153f265.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WpcawkMUbgwGrk2yXl9G6g.png"/></div></div></figure><ul class=""><li id="902c" class="lc ld hh ju b jv kw jz kx kd le kh lf kl lg kp lh li lj lk bi translated"><strong class="ju hi">度-0 ( <em class="kq"> y=a </em> ) </strong></li></ul><p id="82b7" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">不出所料，拟合数据的最佳直线是<strong class="ju hi"> <em class="kq"> y=78.4 </em> </strong> <em class="kq"> </em>，它实质上是样本点的平均值。由于原始数据的对称性，常数线对于多项式的零点附近的值匹配得很好，但是对于两个尾端很差。</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mb"><img src="../Images/2204c304781224a85c913855ad1d130a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G4kxajJ-hVasgTqCxOGOGA.png"/></div></div></figure><ul class=""><li id="9a34" class="lc ld hh ju b jv kw jz kx kd le kh lf kl lg kp lh li lj lk bi translated"><strong class="ju hi">度-1 ( <em class="kq"> y=mx+b </em> ) </strong></li></ul><p id="a0a8" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">啊！线性回归会尽力用一条直线来拟合这个非线性数据。如果最高次项的前导系数是“大”的，那么3次多项式可以像直线一样工作。但不幸的是，在这种情况下没有。</p><p id="df80" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">回归线为<br/><strong class="ju hi"><em class="kq">y = 104.8 x-484.8</em></strong></p><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mc"><img src="../Images/623323e636c80ee55b68a48e308d7d14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hB0JPEIXpGtbn9XffO0-MQ.png"/></div></div></figure><ul class=""><li id="8eb4" class="lc ld hh ju b jv kw jz kx kd le kh lf kl lg kp lh li lj lk bi translated"><strong class="ju hi">度-2 ( <em class="kq"> y=ax +bx+c </em> ) </strong></li></ul><p id="1c4b" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">嗯……看起来是一条稍微弯曲的线。抛物线由<strong class="ju hi"><em class="kq">y = 2.08 x+81.8 x-477.324</em></strong>和1次项的系数(<em class="kq"> 81.8 </em>)远大于<strong class="ju hi"> <em class="kq"> x </em> </strong>项的系数(<em class="kq"> 2.08 </em>)。即<strong class="ju hi"> <em class="kq"> x </em> </strong>变化时，1次项比<strong class="ju hi"> <em class="kq"> x </em> </strong>更有权重，产生一个很宽的抛物线。</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es md"><img src="../Images/a113955615b27950e98a79d0ccd4fd36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ruFGxdSfB5yvr_ugDxGbmg.png"/></div></div></figure><ul class=""><li id="f099" class="lc ld hh ju b jv kw jz kx kd le kh lf kl lg kp lh li lj lk bi translated"><strong class="ju hi">度-3(y =<em class="kq">ax</em><em class="kq">+bx+CX+d</em>)</strong></li></ul><p id="a4d0" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">不足为奇，当我们拟合一个3次多项式时，它将完美地拟合数据。3次多项式是<strong class="ju hi"><em class="kq">y = 2x-30x+150 x–250</em></strong>这是我们展开<strong class="ju hi"> <em class="kq"> y=2(x-5) </em> </strong>时所预期的。显然，我们通常不会知道底层函数。</p><p id="44d3" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">你很幸运，那是一个多项式！正弦，余弦，对数，eˣ，你的例子太完美了！</p><p id="9e3c" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">令人惊讶的是，一个n次多项式可以很好地逼近这些函数。试想一下，正弦曲线只是一串正负抛物线或者一个很高次的多项式！</p><p id="582b" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">但是现在要小心，如果操作得当，这种方法可以很好地拟合您的数据，但是最佳拟合曲线只不过是拟合或插值数据。在某些情况下，做出预测或弄清楚变量之间的真实关系是很糟糕的。</p><p id="2430" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">例如，如果您正在处理具有未知周期行为的数据，如一天中的温度变化或海啸等。，我们更感兴趣的是知道周期和最大振幅。<strong class="ju hi">当超出训练数据特别用于周期性数据的周期时，拟合多项式不会给出正确的预测。</strong></p><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es me"><img src="../Images/09eb14898f5e422c23ecc14200a12334.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0oBjpReVq1Ydgi-64KUbKw.png"/></div></div></figure><p id="a530" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">但是谁说我们不能用所有已知函数组成的“变量”来拟合一条“线性”线？喜欢</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mf"><img src="../Images/da4f48703b0b06861ec225625005f29a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*6G_B418-IhVYM9Xqm9t3eA.gif"/></div></div></figure><p id="2a0e" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">这实际上被称为自变量(<em class="kq"> x </em>)的线性变换。引入线性变换的自变量，改善<em class="kq"> x </em>和<em class="kq"> y </em>之间的线性关系。</p><p id="992d" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">这导致许多其他曲线拟合技术，如使用级数展开，如具有确定项数的<a class="ae it" href="https://en.wikipedia.org/wiki/Fourier_series" rel="noopener ugc nofollow" target="_blank"> <em class="kq">傅立叶级数</em> </a> <em class="kq">、</em> <a class="ae it" href="https://en.wikipedia.org/wiki/Taylor_series" rel="noopener ugc nofollow" target="_blank"> <em class="kq">泰勒级数</em> </a> <em class="kq"> </em>。</p><p id="cb71" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">为了好玩，让我们看看多项式如何拟合更复杂的曲线。</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mg"><img src="../Images/8902a85fd189d70d2d376c7b8f82cf81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*4vUanUdSBvl-5s79dKMZyA.gif"/></div></div></figure><p id="055c" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">以上是函数<em class="kq"> x sin(3x) </em>使用0次到50次多项式范围的曲线拟合过程。您可以看到它逼近训练数据的速度有多快。在多项式中增加更高次的项，弯曲的数量也增加，因此给出足够高次的多项式，它可以模拟正弦曲线的周期模式。但是如上所述，它只能用于拟合给定的训练数据，而不能提供有效的预测。</p><h1 id="273c" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated"><strong class="ak">弊端</strong></h1><ul class=""><li id="6599" class="lc ld hh ju b jv jw jz ka kd mh kh mi kl mj kp lh li lj lk bi translated"><strong class="ju hi">性能:</strong></li></ul><p id="1b1b" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">为了使用n次多项式进行曲线拟合，您需要计算从0次到n次的输入数据向量(即，给定输入向量<em class="kq"> x </em>，您将需要计算<em class="kq"> x⁰,x ,…,xⁿ </em>。)因此，根据您的数据和n次多项式，训练数据可能会很快变大，其中的值可能会很大。(例如5 ⁰ = 9.5367432e+13)</p><p id="6c1d" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">对于数据插值(低方差)，有更简单的方法使用多项式进行曲线拟合，而无需求解大型矩阵的逆矩阵。(如<a class="ae it" href="https://en.wikipedia.org/wiki/Neville%27s_algorithm#:~:text=In%20mathematics%2C%20Neville's%20algorithm%20is,Neville's%20algorithm%20evaluates%20this%20polynomial." rel="noopener ugc nofollow" target="_blank"> <em class="kq">内维尔算法</em> </a>)。但是当你有不完善的数据时(由于样本差异)，也可以使用其他先进的ML方法。</p><ul class=""><li id="6643" class="lc ld hh ju b jv kw jz kx kd le kh lf kl lg kp lh li lj lk bi translated"><strong class="ju hi">过拟合:</strong></li></ul><p id="fef7" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">就其提供的“弯曲”数量而言，高次多项式确实提供了更多的“灵活性”。比如:</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mk"><img src="../Images/437e47f1d04b0c201c22829d84713405.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WRScROC00ApOsvjhPzNbWA.png"/></div></div></figure><p id="8c12" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">这是一个20次多项式，用于拟合<em class="kq"> x sin(3x) </em>。多项式的这个性质让我们可以在定义的范围内近似正弦波。</p><p id="5523" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">这也会导致过度拟合。这里有另一个例子来说明这一点:</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ml"><img src="../Images/a1c61f441a0aa8ab6c3426a650a085d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pe1mTsDM1myWFRbJkV80xw.png"/></div></div></figure><p id="742b" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">该数据由添加了随机噪声的简单x曲线生成。使用2次多项式(红色)和50次多项式(蓝色)比较曲线拟合。蓝色曲线的<em class="kq"> MSE </em>为<strong class="ju hi"> <em class="kq"> 2398.269 </em> </strong>，红色曲线的<em class="kq"> MSE </em>为<strong class="ju hi"> <em class="kq"> 1988.317 </em> </strong> <em class="kq">。</em></p><p id="d631" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">50次多项式提供了额外的弯曲，能够在空间中摆动，并能够到达更多较低次数多项式不能到达的点，因此它提供了更好的<em class="kq"> MSE </em>，但随后产生的模型也更加复杂，并过度拟合数据集。</p><p id="6961" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">一种快速查看是否可能过度拟合数据的方法是，每次添加拟合的高次项时，查看<em class="kq"> MSE </em>的变化。</p><figure class="ks kt ku kv fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ml"><img src="../Images/5e637fd8cbf324b04a54bea2391fd4a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zJC6dWjYeY6OL-MGu8_meg.png"/></div></div></figure><p id="7114" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">我们可以看到<em class="kq"> MSE </em>随着高阶项的增加而缩小。尽管不断增加更高的学位术语，但有时MSE 确实完全改变了。这里我们可以用<a class="ae it" href="https://en.wikipedia.org/wiki/Elbow_method_(clustering)" rel="noopener ugc nofollow" target="_blank"> <em class="kq">肘法</em> </a> <em class="kq"> </em>它告诉我们当多项式次数为2时，<em class="kq"> MSE </em>减少最多。这是显而易见的，因为数据是由2次多项式生成的。因此，与其使用-50度，我们还不如使用-2度，牺牲一些准确性。</p><h1 id="1737" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated"><strong class="ak">结论</strong></h1><p id="c0f4" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">总之，上面的例子实际上不是从一个简单的x生成的，它实际上是一个<em class="kq">正弦</em>曲线的微小部分，它实际上是从一个x <em class="kq"> ⁰⁰⁰⁰ </em>多项式生成的，反正谁知道。关键是我们找到了一种稳健的方法来建模我们的数据，如果我们愿意做出一些牺牲，我们可能会更好地了解我们周围的世界。</p><blockquote class="mm mn mo"><p id="b624" class="js jt kq ju b jv kw jx jy jz kx kb kc mp ky kf kg mq kz kj kk mr la kn ko kp ha bi translated">许多统计学家认为，所有的模型都是错误的，但有些是有用的。</p></blockquote><p id="99c8" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">还有，当你有疑问时，把它们画出来！</p><p id="2217" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">感谢您的阅读！🐣</p><h1 id="9e72" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated"><strong class="ak">附言</strong></h1><p id="1bb8" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">可视化工具可供您在以下位置使用:</p><div class="ms mt ez fb mu mv"><a href="https://stevenlio.shinyapps.io/polyfit/" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab dw"><div class="mx ab my cl cj mz"><h2 class="bd hi fi z dy na ea eb nb ed ef hg bi translated">可视化多边形拟合</h2><div class="nc l"><h3 class="bd b fi z dy na ea eb nb ed ef dx translated">编辑描述</h3></div><div class="nd l"><p class="bd b fp z dy na ea eb nb ed ef dx translated">斯蒂文利奥</p></div></div></div></a></div><p id="029e" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">Github:</p><p id="3505" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated"><a class="ae it" href="https://github.com/stevenlio88/Polyfit" rel="noopener ugc nofollow" target="_blank">https://github.com/stevenlio88/Polyfit</a></p><p id="0185" class="pw-post-body-paragraph js jt hh ju b jv kw jx jy jz kx kb kc kd ky kf kg kh kz kj kk kl la kn ko kp ha bi translated">或者在R:</p><pre class="ks kt ku kv fd ne nf ng nh aw ni bi"><span id="8431" class="nj iv hh nf b fi nk nl l nm nn">install.packages(“shiny”)<br/>library(shiny)</span><span id="7d36" class="nj iv hh nf b fi no nl l nm nn">runGitHub("Polyfit","stevenlio88")</span></pre></div></div>    
</body>
</html>