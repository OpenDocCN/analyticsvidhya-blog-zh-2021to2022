<html>
<head>
<title>Data Warehousing in AWS part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS中的数据仓库第2部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-warehousing-in-aws-part-2-aea9c458b383?source=collection_archive---------12-----------------------#2021-02-22">https://medium.com/analytics-vidhya/data-warehousing-in-aws-part-2-aea9c458b383?source=collection_archive---------12-----------------------#2021-02-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="9245" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">又见面了，所以我将继续我之前关于AWS中数据仓库的文章。所以让我们开始吧😊</p><p id="f7f8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在设计数据库并将数据加载到Redshift之前，您必须首先确定数据将来自何处。在将数据加载到Redshift之前有许多步骤。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/cc0fd5868e789372ad67e688daa4d8a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*U2QFq_TIY3yzMAt6EeUVdg.png"/></div></figure><p id="4d28" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据有不同的格式。有些数据是结构化的，但有些数据也是非结构化的。Amazon为您提供了许多加载数据服务。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jk"><img src="../Images/a37d4e95687eaf25f3c3e29949ccd0ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*HAxkVi-T3snaTxS0vK5CEA.png"/></div></figure><p id="cf82" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在上一篇文章中，我们谈到了数据集市，数据集市与数据湖有一些相似之处，但又有所不同。那么什么是数据湖呢？</p><blockquote class="jl jm jn"><p id="aeea" class="ie if jo ig b ih ii ij ik il im in io jp iq ir is jq iu iv iw jr iy iz ja jb ha bi translated"><strong class="ig hi">数据湖</strong>主要是由收集尽可能多的数据的需求驱动的，而不需要预先处理、了解需求或聚合，以便数据可以灵活地用于以后的分析。</p></blockquote><p id="d383" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">有什么不同？</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es js"><img src="../Images/aeada1b9cf5aa7c2dfaf1aa34b79d3f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*j3GmWl99hlHpRSBfuoTlcA.png"/></div></figure><p id="a854" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇文章中，我只谈论如何加载数据到亚马逊S3红移。</p><p id="28b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">亚马逊S3是互联网的存储。它旨在使开发人员更容易进行网络规模的计算。亚马逊S3提供了一个简单的网络服务接口，可以用来在任何时间、从网络上的任何地方存储和检索任何数量的数据。因此，使用亚马逊S3作为AWS中的数据湖，并将数据加载到其他服务中，如亚马逊红移。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jt"><img src="../Images/7a3df65a40fe0270f4277b9f9864dbbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*m3u1CWFzq3Ngma9BGeeJtA.png"/></div></figure><p id="090c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">亚马逊S3和亚马逊红移之间的集成使您能够:</p><ul class=""><li id="7148" class="ju jv hh ig b ih ii il im ip jw it jx ix jy jb jz ka kb kc bi translated">将数据直接从bucket加载到集群中。</li><li id="f42d" class="ju jv hh ig b ih kd il ke ip kf it kg ix kh jb jz ka kb kc bi translated">并行加载多个数据文件。</li><li id="be43" class="ju jv hh ig b ih kd il ke ip kf it kg ix kh jb jz ka kb kc bi translated">将集群中的数据卸载到存储桶中。</li></ul><p id="1f91" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，您可以使用简单的复制命令将数据从S3加载到redshift中。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ki"><img src="../Images/d2c4f2634fb48244019548220d0412ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*Z9NkCXu5_zsc8_r8OxUM_g.png"/></div></figure><p id="0313" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">AWS还允许您在使用AWS Glue将数据加载到redshift之前进行一些ETL过程。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kj"><img src="../Images/97fb73aaa53b5d91bb6cdc84bdcc55a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*3Uutkr2LP9KHnLrvJAvhWw.png"/></div></figure><p id="5e50" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可以用AWS Glue和AWS Lambda运行一个无服务器、事件驱动的ETL管道来红移。一旦新数据在亚马逊S3可用，您就可以通过从Lambda函数调用Glue APIs来运行AWS Glue ETL作业。您还可以在AWS Glue数据目录中注册这个新数据集，作为ETL作业的一部分。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ki"><img src="../Images/b8d825bb66219af4a1cca4f4897217cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*faiHMvbINALK7X3cnYRVlw.png"/></div></figure><p id="3994" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">AWS胶水有3个主要成分。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kk"><img src="../Images/130524a8708df4ea939a050826a61202.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*XK7aA3VxByHgiiU7IW22IA.png"/></div><figcaption class="kl km et er es kn ko bd b be z dx translated">AWS胶水组件</figcaption></figure><h2 id="fb58" class="kp kq hh bd kr ks kt ku kv kw kx ky kz ip la lb lc it ld le lf ix lg lh li lj bi translated">准备数据</h2><p id="e9f8" class="pw-post-body-paragraph ie if hh ig b ih lk ij ik il ll in io ip lm ir is it ln iv iw ix lo iz ja jb ha bi translated">准备好你的数据很重要，这里有一些准备数据加载到亚马逊红移的技巧，你可以在这里看到详细信息<a class="ae lp" href="http://docs.aws.amazon.com/redshift/latest/dg/t_preparing-input-data.html" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ki"><img src="../Images/205765824dc76fdbd242a407150e5947.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*YI57s14oAaSkUJLyxGujoQ.png"/></div><figcaption class="kl km et er es kn ko bd b be z dx translated">准备数据</figcaption></figure><p id="b67a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你把数据分成几个片段，你也可以使用一个清单文件。manifest files是JSON格式的文本，它列出了运行COPY命令时要加载的每个文件。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lq"><img src="../Images/56cef1ab75126bb14aba9272b982844e.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*JR7Qq5bit0wv03vY8YCr1A.png"/></div></figure><p id="f88e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你的数据需要特殊处理，这里有一些提示。</p><p id="e8df" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你的数据是用<strong class="ig hi">字符分隔的</strong>。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lr"><img src="../Images/2292c2b6a67f5980833bff73d0568ba8.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*kUTaoSEeIJHzkHF8tb7Xzg.png"/></div></figure><p id="074f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果要将数据指定到固定宽度的列中</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ls"><img src="../Images/1b5e8f2311dcaaa78b8d02f1351e038e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*h4Xrjiq1-j_IbeM2DR53SA.png"/></div></figure><p id="9780" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此外，红移不会强制您创建主键和外键约束。</p><h2 id="512c" class="kp kq hh bd kr ks kt ku kv kw kx ky kz ip la lb lc it ld le lf ix lg lh li lj bi translated">使用复制命令加载数据</h2><p id="8de6" class="pw-post-body-paragraph ie if hh ig b ih lk ij ik il ll in io ip lm ir is it ln iv iw ix lo iz ja jb ha bi translated">建议使用COPY命令将数据源中的数据加载到Redshift中。你可以在这里看到关于复制命令<a class="ae lp" href="http://docs.aws.amazon.com/redshift/latest/dg/t_Loading_tables_with_the_COPY_command.html" rel="noopener ugc nofollow" target="_blank">的详细信息。</a></p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lt"><img src="../Images/932c8d7f0bbb01144195defa97608bf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*yCvgggiATR4631QRJe9mSw.png"/></div></figure><p id="e23a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所需的复制参数包括:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lu"><img src="../Images/fc682adbbdc31f81c93c27bee6fbb15d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*xbteZrMNX0vLwZ4F8RvI0w.png"/></div></figure><p id="50e7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">从CSV文件加载数据</strong></p><p id="5fc8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">CSV是用于在电子表格中导入和导出数据的常用格式。借助CSV，您可以:</p><ul class=""><li id="d635" class="ju jv hh ig b ih ii il im ip jw it jx ix jy jb jz ka kb kc bi translated">使用IGNOREHEADERS AS选项跳过标题，并指定要忽略的行数。</li><li id="5105" class="ju jv hh ig b ih kd il ke ip kf it kg ix kh jb jz ka kb kc bi translated">如果不想加载所有列，请使用列映射或JSONpaths文件来指定映射。</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kk"><img src="../Images/1c1ea12ce21ead5a31dc2bf5ae35a9d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*bmvha3COVxu498rhjDqPXw.png"/></div><figcaption class="kl km et er es kn ko bd b be z dx translated">加载CSV文件的复制命令</figcaption></figure><p id="7627" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">从JSON文件加载数据</strong></p><p id="5962" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Redshift使用JSONPaths文件来解析JSON格式的源数据。</p><ul class=""><li id="a390" class="ju jv hh ig b ih ii il im ip jw it jx ix jy jb jz ka kb kc bi translated">JSONPaths文件包含一个或多个JSONPaths表达式。</li><li id="303b" class="ju jv hh ig b ih kd il ke ip kf it kg ix kh jb jz ka kb kc bi translated">JSONPath表达式对应于Redshift中目标表中的一列</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lv"><img src="../Images/fc9d8bfd7909767d54c5e5631ec724ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*ecugErxenF2axNmsNpiuaA.png"/></div></figure><p id="61a5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您可以在复制命令中使用列列表来指定列顺序。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lw"><img src="../Images/ca766195e882342497d661a6d8c8b2f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*9-_nBTpAHLvWsbEGV2ST8Q.png"/></div></figure><p id="5df9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">复制命令中有许多数据转换参数。你可以在这里找到详细信息<a class="ae lp" href="http://docs.aws.amazon.com/redshift/latest/dg/copy-parameters-data-conversion.html" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="abc6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">维护表格</strong></p><p id="1b72" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">维护表对于确保表仍然正确运行很重要。您可以使用分析和真空命令来帮助您维护表格。</p><p id="dc81" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> ANALYZE </strong>命令获取行的样本，进行一些计算，并保存得到的列统计信息。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lx"><img src="../Images/e97fe790c25310498ccc11253e26867e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*FjTmtBQJ6NpmPExUIqskgg.png"/></div></figure><p id="fa20" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用<strong class="ig hi"> VACUUM </strong>命令释放存储空间并提高性能，因为红移不会自动从已删除的项目中回收空间。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ly"><img src="../Images/0a94d9de79fef15630e9c4f7576fcc51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*VrcoOPUbEJavxiAic_KUUQ.png"/></div></figure><p id="5d0d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您在验证数据和对数据加载进行故障排除时遇到问题，使用以下系统表有助于在加载过程中验证数据和对问题进行故障排除:</p><ul class=""><li id="4458" class="ju jv hh ig b ih ii il im ip jw it jx ix jy jb jz ka kb kc bi translated">STL_LOAD_ERRORS包含在特定加载期间发生的错误。</li><li id="a65e" class="ju jv hh ig b ih kd il ke ip kf it kg ix kh jb jz ka kb kc bi translated">STL_FILE_SCAN提供了特定文件的加载时间。</li></ul><p id="11b8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有一些加载数据的最佳实践提示:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lz"><img src="../Images/cf536dc42a059f99ab032dc3527a3cc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*WZfO377bXUdPnMRl4MYG2w.png"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jt"><img src="../Images/367e04669feb023b76cc95c666b7982c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*f5xVwxk0PPaquGthcFl04g.png"/></div></figure><p id="eaad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这就是如何在AWS中创建数据仓库。希望这篇文章能对你有所帮助。稍后，您可以将Redshift连接到Amazon QuickSight，以创建数据的可视化。谢谢你😂</p></div><div class="ab cl ma mb go mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ha hb hc hd he"><p id="6944" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">来源:</p><ul class=""><li id="bb25" class="ju jv hh ig b ih ii il im ip jw it jx ix jy jb jz ka kb kc bi translated">亚马逊培训课程</li></ul></div></div>    
</body>
</html>