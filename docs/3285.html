<html>
<head>
<title>Understanding “convolution” operations in CNN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解CNN中的“卷积”运算</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/convolution-operations-in-cnn-deep-learning-compter-vision-128906ece7d3?source=collection_archive---------5-----------------------#2021-06-23">https://medium.com/analytics-vidhya/convolution-operations-in-cnn-deep-learning-compter-vision-128906ece7d3?source=collection_archive---------5-----------------------#2021-06-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="f8e6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">卷积神经网络是深度学习的主要构建模块，它有助于计算机视觉任务中的图像分类、目标检测、图像识别等。我们使用许多卷积运算技术，我们将在本文中讨论。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/ee6499de4d060d28e878f28b7881094f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1KEew1smVFM7AnA3"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated"><a class="ae js" href="https://developersbreach.com/convolution-neural-network-deep-learning/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="adf0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jt">你用过照片编辑工具吗？</em> </strong></p><p id="6647" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">哪一个使您的图像更清晰或删除了您想要删除的照片的一部分？</p><p id="4ada" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jt">如果是</em> </strong>，那么你已经对你的照片进行了隐含卷积运算。</p><h1 id="3b6f" class="ju jv hh bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">理解卷积运算</strong></h1><h2 id="8496" class="ks jv hh bd jw kt ku kv ka kw kx ky ke ip kz la ki it lb lc km ix ld le kq lf bi translated">什么是内核/过滤器？</h2><p id="3f8b" class="pw-post-body-paragraph ie if hh ig b ih lg ij ik il lh in io ip li ir is it lj iv iw ix lk iz ja jb ha bi translated">内核是一个长方形的小矩阵，从左到右，从上到下在图像上滑动。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ll"><img src="../Images/a1346cdc6caf1f1273f0015abde9a1e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:188/format:webp/1*ZzEMK3IUWdTwtfPKV55_UQ.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">内核/过滤器</figcaption></figure><h2 id="40ab" class="ks jv hh bd jw kt ku kv ka kw kx ky ke ip kz la ki it lb lc km ix ld le kq lf bi translated">什么是stride？</h2><p id="4477" class="pw-post-body-paragraph ie if hh ig b ih lg ij ik il lh in io ip li ir is it lj iv iw ix lk iz ja jb ha bi translated">内核在输入图像上滑动的像素数量称为一个步幅。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lm"><img src="../Images/e4596c9ab682132c3b8d7392edce1543.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/0*ft0xqDy5VBYTuchD.gif"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated"><a class="ae js" href="http://deeplearning.stanford.edu/wiki/index.php/Feature_extraction_using_convolution" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><h2 id="c63b" class="ks jv hh bd jw kt ku kv ka kw kx ky ke ip kz la ki it lb lc km ix ld le kq lf bi translated">什么是卷积运算？</h2><p id="cbdc" class="pw-post-body-paragraph ie if hh ig b ih lg ij ik il lh in io ip li ir is it lj iv iw ix lk iz ja jb ha bi translated">卷积运算是隐含两个函数的组合产生第三个函数的过程。结果，在整个输入图像上使用滤波器允许滤波器发现图像的该特征。也称为特征图。</p><p id="408d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们通过一个拼图游戏的简单类比来理解。拼图游戏是卷积运算的完美例子。</p><p id="7738" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在拼图游戏中，每块拼图都有一个图像的一部分，当它被组合在一起时，可以显示出整个画面的一些信息。</p><p id="5fc2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">就像卷积网络中的拼图游戏一样，多个滤波器被用来对图像进行切片，并逐个映射它们，从而学习输入图像的不同部分。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ln"><img src="../Images/d30955b6412f038033234f2c7db4e608.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BRRwq3dGFpMb7amW"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated"><a class="ae js" href="https://github.com/whitcrrd/puzzle-image-segmentation" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="4900" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如，我们将输入图像3x4作为I，将2x2内核K作为I，卷积是两个矩阵的逐元素乘法，之后是总和Sij。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lo"><img src="../Images/c33cb5907a26449852c9718e4530fad5.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/0*ZyvNIWwk7wXvyTqs"/></div></figure><p id="676b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们使用以下公式计算输出(当前像素的重新估计值):</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lp"><img src="../Images/7982edf6ca558f5834e2126c9fd2cdff.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/0*5Xd2OLzS4EqYRffp"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">这里m和n代表行数和列数</figcaption></figure><p id="336c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在原始图像I的每个像素处，我们重新估计位于图像核心中心的像素的邻域。然后，我们取这个像素邻域，将它们与核k进行卷积，并获得单个输出值Sij。对于较大图像，内核可以从左到右和从上到下滑动</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lq"><img src="../Images/668b0bba9219c0572b82966a8e086b7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/0*pLDf-l7wHvbmxHvS"/></div></figure><p id="7f91" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个操作的输出将是:(aw + bx + ey + fz)。然后，我们以步长1水平移动内核，这将给出权重和(bw + cx + fy + gz)</p><p id="8fc2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，在此之后，第一层的输出将如下所示:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lr"><img src="../Images/cab65e31bc064449ba46bf7ed23d6e8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/0*HeylSCCGvWMxKChz"/></div></figure><p id="c405" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们有不同的过滤器，如模糊(平均平滑，高斯平滑，中值平滑等。)、边缘检测(拉普拉斯、索贝尔、沙尔、普鲁伊特等。)，以及锐化—所有这些操作都是为了执行特定的功能而设计的。</p><p id="68c2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们以<strong class="ig hi">高斯平滑滤波器</strong>为例，如果我们取平均值(将加权和值除以9)，它将稀释该值/模糊图像，该值用于平滑和减少图像中的噪声。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ls"><img src="../Images/808d24d21719395f7539ec4ef53b954e.png" data-original-src="https://miro.medium.com/v2/resize:fit:172/0*djV_hneHUNkMBzJu"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">高斯平滑滤波器</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lt"><img src="../Images/7a3549578cf8923341304b3d42ebccd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lhKhwHDphGn6Y1xN"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">不同内核/过滤器的应用</figcaption></figure><h2 id="ef10" class="ks jv hh bd jw kt ku kv ka kw kx ky ke ip kz la ki it lb lc km ix ld le kq lf bi translated"><strong class="ak">使用3D滤波器的2D卷积运算</strong></h2><p id="f11f" class="pw-post-body-paragraph ie if hh ig b ih lg ij ik il lh in io ip li ir is it lj iv iw ix lk iz ja jb ha bi translated">在3D输入的情况下(RGB图像有3个通道，分别对应红、绿、蓝，所有这些通道都相互叠加，这就是我们获得最终图像的方式)，我们有3个通道(深度)，每个通道对应图像中的每种RGB。</p><p id="8131" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">所以我们在这里分别核算所有3个通道的卷积运算？</strong></p><p id="810a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们也在沿着深度滑动过滤器吗？T9】</p><p id="3369" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">不，我们使用与输入深度相同的过滤器，并将过滤器置于输入之上，计算所有3个维度的加权和。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es et"><img src="../Images/af86ff85aad16bcaf477624f3bab4828.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*H_6KDnWyFj_JDstS"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated"><a class="ae js" href="https://indoml.com/2018/03/07/student-notes-convolutional-neural-networks-cnn-introduction/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="ae04" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里我们输入图像和内核是3D的，但是我们正在做的操作是2D操作，因为我们在水平(从左到右)和垂直(从上到下)两个方向上移动内核。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lu"><img src="../Images/3b1f135b46be10b25da478a6ce47ad98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/0*QFXulBGTo6p4uO3i"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">3D图像上的3D滤镜</figcaption></figure><p id="8e67" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，我们已经知道，我们可以使用滤波器的卷积运算从图像中提取重要的特征。因此，我们可以使用多个过滤器从图像中提取不同的特征并产生多个特征图，而不是使用一个过滤器。每个滤波器负责提取不同的特征，如水平边缘、垂直边缘、非线性特征等。</p><h2 id="d898" class="ks jv hh bd jw kt ku kv ka kw kx ky ke ip kz la ki it lb lc km ix ld le kq lf bi translated"><strong class="ak">什么是填充？</strong></h2><p id="81f8" class="pw-post-body-paragraph ie if hh ig b ih lg ij ik il lh in io ip li ir is it lj iv iw ix lk iz ja jb ha bi translated">在拐角处，我们不能放置内核，因此很明显，卷积运算的输出小于输入图像。</p><p id="048c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jt">如果我们希望输出和输入一样大呢？或者</em> </strong></p><p id="7a37" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jt">如果滤镜不适合输入图像怎么办？</em> </strong></p><p id="72a4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这种情况下，我们根据所需的大小和内核大小在图像周围添加0的人工填充，如下图所示，也称为<strong class="ig hi">零</strong> - <strong class="ig hi">填充。</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lv"><img src="../Images/5342d4f6487f77c11d42c3b726452620.png" data-original-src="https://miro.medium.com/v2/resize:fit:432/0*m87O_-6S66DXIxM0"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated"><a class="ae js" href="https://stackoverflow.com/questions/60088496/i-wanted-to-implement-convolutional-neural-network-without-builtin-functions-so" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="ebc5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如，假设我们正在执行步长为2的卷积运算。当我们将过滤器移动两个像素时，有可能到达边界，过滤器不适合输入图像。我们使用零填充来保留图像边界。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lw"><img src="../Images/d9fee57c5f26efca294ea676d208dd58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jIGZUQ1Ath-6fhAg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated"><a class="ae js" href="http://datahacker.rs/what-is-padding-cnn/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="c608" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">结论</strong></p><ul class=""><li id="b8fe" class="lx ly hh ig b ih ii il im ip lz it ma ix mb jb mc md me mf bi translated">卷积神经网络将过滤器应用于输入图像以创建特征图，该特征图总结了输入中检测到的特征。</li><li id="c044" class="lx ly hh ig b ih mg il mh ip mi it mj ix mk jb mc md me mf bi translated">如何计算卷积神经网络中2D和三维卷积层的特征图？</li><li id="fe45" class="lx ly hh ig b ih mg il mh ip mi it mj ix mk jb mc md me mf bi translated">填充如何在使用不同大小的过滤器创建的特征图中添加边框效果。</li></ul><p id="649a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你有任何需要我改进的反馈，或者如果你想分享任何关于这方面的想法或经验，请随时发表评论。</p><p id="68b5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你想要更多吗？在<a class="ae js" href="https://www.linkedin.com/in/aditi-kothiya/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae js" href="https://github.com/Aditi81" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上关注我。</p></div></div>    
</body>
</html>