<html>
<head>
<title>Brain tumor detection and segmentation model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">脑肿瘤检测和分割模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/brain-tumor-detection-and-segmentation-model-fc5dc952f6fe?source=collection_archive---------15-----------------------#2021-01-08">https://medium.com/analytics-vidhya/brain-tumor-detection-and-segmentation-model-fc5dc952f6fe?source=collection_archive---------15-----------------------#2021-01-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="8414" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">背景:</p><p id="44d4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将人工智能引入医疗保健已经彻底改变了这个行业。在磁共振成像(MRI)方面，它通过分割和定位产生了更快和更好的肿瘤和癌症检测。</p><p id="8763" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">问题陈述:</p><p id="9c53" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">作为一名AI/ML顾问，一家医疗诊断公司让您负责提高基于MRI扫描检测和定位脑肿瘤的速度和准确性。提供的数据集包含3929个脑部MRI扫描及其肿瘤位置，供您开发一个检测和定位脑肿瘤的模型。</p><p id="01d0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">兴趣:</p><p id="44c8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该公司的目标是提高脑瘤的早期诊断，降低癌症诊断的成本。</p><p id="109a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">解决方案:</p><p id="6406" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了解决上述问题，建立了一个分类和分割模型。</p><p id="f3d3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据:</p><p id="3048" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">来源:数据来源于<a class="ae jc" href="https://www.kaggle.com/mateuszbuda/lgg-mri-segmentation" rel="noopener ugc nofollow" target="_blank">这里的</a></p><p id="9e49" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用。info函数，我打印了csv文件中的列</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/bec3688010576608492b32068a3e26dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vTvYt7RPDcBehdPiYk856Q.png"/></div></div></figure><p id="9228" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后用。head函数，我打印了数据集中的前30行</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jp"><img src="../Images/64a9196ae48d8815d3c8a638979f03d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E79S5gWeGdgdd3vk5Hh_WQ.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jq"><img src="../Images/021cc2299ee7fd4a6dd264d5ef7cc4b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FDlTfk61dIYVSQjRYU61oA.png"/></div></div></figure><p id="4b45" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如上所示，名为mask的列的值为0，表示没有肿瘤。</p><p id="413c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据可视化</p><p id="fc52" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用matplolib.pyplot，我可视化了数据集中的第723幅图像，它的最大值为255，最小值为0。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jr"><img src="../Images/e28f56c80ff82cf6a2c29113f1e2b633.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*Mlo4NlUptSAc58SYMnF5kQ.png"/></div></figure><p id="0513" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后使用随机函数，我可视化了六个脑部核磁共振成像，生成了有肿瘤和无肿瘤的核磁共振成像。</p><div class="je jf jg jh fd ab cb"><figure class="js ji jt ju jv jw jx paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/ead2d8877b957028afee98fd8c20682f.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*VlA2R3VcDPP2ETeqvNooEg.png"/></div></figure><figure class="js ji jy ju jv jw jx paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/dc7bf2cfeca575d82cad7e2541bbf58a.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*RWeQILF51A0OUfOfLsggsQ.png"/></div></figure><figure class="js ji jz ju jv jw jx paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/a234cb0d37d74e2ca18ad8233b571845.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*-ZDBKxeAjwAj-SfNQLAWkw.png"/></div></figure></div><p id="1cb7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">拆分:</p><p id="c5dc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用train_test_split函数，我将数据分为值为15%的训练和测试。然后使用来自keras的数据图像生成器，我重新调整了数据，并做了15%的验证数据分割。</p><p id="817e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据生成:</p><p id="fc3a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我生成了训练、验证和测试图像生成子集，批量大小为16，类模式等于分类，目标大小为(256，256)，混洗等于假。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ka"><img src="../Images/8904f7fcb3e1f5acec97efabba114b74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*S8eI1ZoGCzOh3wLRim1Sww.png"/></div></figure><p id="f4fb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我用resnet50创建了一个基本模型，权重来自预先训练的值imagenet。下面是基本模型的总结。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kb"><img src="../Images/803e1d4ed46a6ed001febb5c3ade9f8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uFacnBSxIV0X_ISgAWZ8sQ.png"/></div></div></figure><p id="4e69" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">建筑网络:</p><p id="5e21" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我使用两个激活relu的隐藏层构建了网络，密度为256，下降为0.3，输出层使用softmax激活。下面是模型总结。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kc"><img src="../Images/ef02fdf3adb53d054176b5284b949667.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hMkjNHxhzeGB5SZWoRGwPg.png"/></div></div></figure><p id="d31b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">编译:</p><p id="13c5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我使用损失分类交叉熵、adam优化器和“准确性”指标编译了这个模型。</p><p id="7421" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我还使用了耐心20后的早期停止，检查点将save_best_model设置为true。</p><p id="480e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">培训:</p><p id="6ada" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这就是反复试验的地方。用10个时期训练第一个模型，用这种可视化的混淆度量得到0.329的准确度。</p><div class="je jf jg jh fd ab cb"><figure class="js ji kd ju jv jw jx paragraph-image"><img src="../Images/abb18fc6bf591bc89a7ceb5c4cbaa7d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*pTnvBl9D8QrY5WhRszwBOg.png"/></figure><figure class="js ji ke ju jv jw jx paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/d4eb4c70c704530b9679274e34a15707.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*JwGQ6-NI2ohq6-ZDzUyAMQ.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx kj di kk kl translated">模型1</figcaption></figure></div><p id="2b30" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第二个模型用50个历元训练。训练没有达到50个时期，因为早期停止被触发，导致模型在33个时期停止。这个模型的准确度为0.866，无法对其可视化混淆指标进行操作。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es km"><img src="../Images/23fa6a1650dd0c07984e54f1b2fa1fa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*yhhxKfOh5Hh3GG7iEamZwQ.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">模型2</figcaption></figure><p id="8d6d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第三个模型用一个时期训练，改变一些超参数。验证分为20%而不是15%。使用这种可视化混淆度量，准确度为0.76。</p><div class="je jf jg jh fd ab cb"><figure class="js ji kn ju jv jw jx paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/6a1ac7f99fea429df591cab7436bcaea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1620/format:webp/1*a1uZ1lHjc1kJwAa7IVnrLQ.png"/></div></figure><figure class="js ji ko ju jv jw jx paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/45cd6cb078bc9acd00cc8c8df679e324.png" data-original-src="https://miro.medium.com/v2/resize:fit:382/format:webp/1*uFz7KWfAtlZt1eInS0_h4Q.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx kp di kq kl translated">模型3</figcaption></figure></div><p id="7572" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用25个时期训练最终模型，其具有0.946的准确度，并且这可视化了混淆度量。</p><div class="je jf jg jh fd ab cb"><figure class="js ji kr ju jv jw jx paragraph-image"><img src="../Images/f2ba227a395a325971dc674344de6d7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*muwoRQRP-RCBDJhbivsA8w.png"/></figure><figure class="js ji ks ju jv jw jx paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/5d4919f835039183bad65e5578401826.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/format:webp/1*_tZl55C9iXbQs5_5-hXndQ.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx kt di ku kl translated">模型4</figcaption></figure></div><p id="035b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">看看上面的模型，我们有我们的赢家，第四个模型。</p><p id="90be" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">分数:</p><p id="4185" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用sci kit learn classification _ report函数，下图是报告。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kv"><img src="../Images/2a10ab477aa5b9079da54fcc2d515937.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*PzKl_CR5ggCEwslAZBe35Q.png"/></div></figure><p id="02f6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">细分模型:</p><p id="1f47" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有助于定位的分割模型是使用掩模建立的，其目标是在像素级理解图像。</p><p id="cb65" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">方法:</p><p id="eaf5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据被分成训练、验证和测试子集。损失函数是使用定制的损失函数来完成的，该损失函数是Tversky损失函数。你可以在这里阅读更多关于它的内容<a class="ae jc" href="https://deepai.org/publication/a-novel-focal-tversky-loss-function-with-improved-attention-u-net-for-lesion-segmentation" rel="noopener ugc nofollow" target="_blank">并且可以在这里</a>找到<a class="ae jc" href="https://github.com/nabsabraham/focal-tversky-unet/blob/master/losses.py" rel="noopener ugc nofollow" target="_blank">关于这个函数的回购。</a></p><p id="c713" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用Adam optimizer，学习率为0.05，ε为0.1，损失函数为focal_tversky和“tversky”指标。早期停工和检查站也适用。</p><p id="a290" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">培训:</p><p id="4933" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用丢失和tversky为的10个时期来训练分割模型</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kw"><img src="../Images/ce7965d4116a4f6df0d14ac603c6a954.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xf_jOndjzqSwcC9Bijhb9g.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kx"><img src="../Images/0e33c7184b6d886cb371cefc4e3a9055.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xogueICNTp44JlTmGEAYhw.png"/></div></div></figure><p id="0d4b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上述结果不足以进行分割，因为出现了假阴性。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ky"><img src="../Images/39c381094102adc113822d537e35f354.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9pWXjIG_cyI3TBSZWheV7A.png"/></div></div></figure><p id="11bb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可视化:</p><p id="86ff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该模型被绘图以可视化具有扫描、原始屏蔽、预测屏蔽、地面实况和具有预测屏蔽的扫描的磁共振成像。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kz"><img src="../Images/894064867b3a8f37ce47ae1607568932.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DAYazmAxmT-4QNMo6mMNvQ.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es la"><img src="../Images/44466edd3972f43cb6ee42b8ca3964fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oYYuw-bD8n4ryaqUkX79DA.png"/></div></div></figure><p id="1231" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">讨论:</p><p id="d8c6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">训练不同模型的原因是为了获得更高的准确度，并消除假阳性和假阴性。这有助于消除误诊。</p><p id="da27" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">结论:</p><p id="0299" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所有模型加起来花了48小时训练，这是我第一次碰到特沃斯基函数。欢迎任何关于如何将该模型的准确性提高到至少99%的建议，您可以通过我的<a class="ae jc" href="https://www.linkedin.com/in/rosemary-nwosu-ihueze/" rel="noopener ugc nofollow" target="_blank"> LinkedIn个人资料</a>联系我。</p><p id="9957" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">PS:这是我在Udemy上的认证课程的一部分。</p></div></div>    
</body>
</html>