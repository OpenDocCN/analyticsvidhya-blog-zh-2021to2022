<html>
<head>
<title>Comparison of Multilinear Regression and Machine Learning I: MLR</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多线性回归和机器学习的比较I: MLR</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/comparison-of-multilinear-regression-and-machine-learning-i-mlr-48335d162054?source=collection_archive---------30-----------------------#2021-05-28">https://medium.com/analytics-vidhya/comparison-of-multilinear-regression-and-machine-learning-i-mlr-48335d162054?source=collection_archive---------30-----------------------#2021-05-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="d472" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">大家好，我最近在期末考试期间，当我复习一门关于线性回归的课程时，我发现如果我能写一篇关于MLR如何完成以及我们应该如何做一些诊断工作的博客会很有趣。更重要的是，与使用线性模型的机器学习相比，它的性能如何。我们开始吧！</p></div><div class="ab cl jc jd go je" role="separator"><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh ji"/><span class="jf bw bk jg jh"/></div><div class="ha hb hc hd he"><h1 id="858b" class="jj jk hh bd jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg bi translated">对数据的一瞥</h1><p id="341d" class="pw-post-body-paragraph ie if hh ig b ih kh ij ik il ki in io ip kj ir is it kk iv iw ix kl iz ja jb ha bi translated">我使用的数据集是2021年世界幸福报告，你可以在这里找到原始数据集<a class="ae km" href="https://www.kaggle.com/ajaypalsinghlo/world-happiness-report-2021" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/ajaypalsinghlo/World-Happiness-Report-2021</a>。在我们的数据中总共有六个参数经济生产、社会支持、预期寿命、自由、没有腐败和慷慨。它们一起被用于生成阶梯分数的预测，阶梯分数是幸福的指标。</p><p id="9aa9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们首先关注两个预测指标来了解这个数据集:人均GDP和预期寿命。</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div class="er es kn"><img src="../Images/703421cbc6d4124734a9b5a031789b4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*rt2OWNVJwfHA-nsN93zpyQ.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">图1阶梯分数与健康预期寿命</figcaption></figure><figure class="ko kp kq kr fd ks er es paragraph-image"><div class="er es kz"><img src="../Images/a4d525f45d8160784cf33eac3d7914d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*HooboLrjhuDqo4Xzl39iyg.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">图2阶梯得分与记录的人均GDP</figcaption></figure><p id="e6ad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们清楚地观察到阶梯分数、预期寿命和人均国内生产总值之间的强线性关系(但是人均国内生产总值和预期寿命之间也存在强线性关系。这将在本文的后面部分解释)。</p><figure class="ko kp kq kr fd ks er es paragraph-image"><div class="er es la"><img src="../Images/8f96f685b51c695f44c781361d37bb58.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*c6jR3nPk4OOdZWbgoG_mtw.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">图3阶梯得分、人均国内生产总值和健康预期寿命图</figcaption></figure><h1 id="6898" class="jj jk hh bd jl jm lb jo jp jq lc js jt ju ld jw jx jy le ka kb kc lf ke kf kg bi translated">建立我们的模型</h1><p id="8e3b" class="pw-post-body-paragraph ie if hh ig b ih kh ij ik il ki in io ip kj ir is it kk iv iw ix kl iz ja jb ha bi translated">在研究了这些数据之后，我们可以假设存在一个线性模型，可以用来预测某个国家的人们的幸福程度(阶梯分数)。首先，让我们从csv文件中提取数据，并把它放入R数据帧。</p><pre class="ko kp kq kr fd lg lh li lj aw lk bi"><span id="598f" class="ll jk hh lh b fi lm ln l lo lp">address = "MyBlog/World Happiness Report 2021/world-happiness-report-2021.csv"<br/>data &lt;- read.csv(address)<br/>col_names &lt;- colnames(data)<br/>lad &lt;- data[[col_names[3]]] #Ladder score<br/>gdp &lt;- data[[col_names[7]]] #Logged GDP per capita<br/>soc &lt;- data[[col_names[8]]] #Social sopport<br/>exp &lt;- data[[col_names[9]]] #Life Expectancy<br/>fre &lt;- data[[col_names[10]]]#Freedom to make life choices<br/>gen &lt;- data[[col_names[11]]]#Generosity<br/>corrup &lt;- data[[col_names[12]]]#Corruption<br/>df &lt;- data.frame(lad,gdp,soc,exp,fre,gen,corrup)</span></pre><p id="f332" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因为我们已经知道预测因子之间的相关性可能很高，我们将继续逐步回归。你可以在博客<a class="ae km" href="https://quantifyinghealth.com/stepwise-selection/" rel="noopener ugc nofollow" target="_blank">这里</a>找到更多关于它的信息。所以，我们先找出与阶梯评分相关度最高的预测因子。</p><pre class="ko kp kq kr fd lg lh li lj aw lk bi"><span id="960c" class="ll jk hh lh b fi lm ln l lo lp">cor(df) #print out the correlation matrix</span></pre><figure class="ko kp kq kr fd ks er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lq"><img src="../Images/6633f87cc4bae0b4659f9473572a2b3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UDFDqRWwm6fPAJffq4V_fQ.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">图4相关矩阵</figcaption></figure><pre class="ko kp kq kr fd lg lh li lj aw lk bi"><span id="75ef" class="ll jk hh lh b fi lm ln l lo lp">#First, let's do regression on Ladder~GDP since their correlation is the highest.</span><span id="d718" class="ll jk hh lh b fi lv ln l lo lp">model &lt;- lm(lad~gdp,data = df)<br/>history = list(summary(model)$adj.r.squared,summary(model)$fstatistic[[1]])<br/>names(history) &lt;- c("adj R", "F statistic")<br/><br/><br/>#Next, we shall check the correlation between the remaining predictors with repsonse after removing the effect of GDP<br/><br/>res &lt;- residuals(model)<br/>for(pre in c('soc','exp','fre','gen','corrup')){<br/>  temp &lt;- lm(df[[pre]]~df$gdp)<br/>  tempres &lt;- residuals(temp)<br/>  print(paste(pre,cor(res,tempres)))<br/>}</span><span id="f09c" class="ll jk hh lh b fi lv ln l lo lp">#We then get the following output: freedom of life choice has highest partial correlation</span><span id="6abe" class="ll jk hh lh b fi lv ln l lo lp">[1] "soc 0.359923210155012"<br/>[1] "exp 0.284878489476207"<br/>[1] "fre 0.48148160290262"<br/>[1] "gen 0.232218099226429"<br/>[1] "corrup -0.261603523662922"</span><span id="b1c6" class="ll jk hh lh b fi lv ln l lo lp">#From the result we find freedom of life choice has the highest partial correlation, so let's add it to ouur model<br/>model &lt;- lm(lad~gdp+fre,data = df)</span></pre><p id="798d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">就指定我们的停止点而言，通常的做法是查看F-stat或调整后的R平方。为了记录F-stat和Adj-R，我们将编写一个记录函数。</p><pre class="ko kp kq kr fd lg lh li lj aw lk bi"><span id="0dcc" class="ll jk hh lh b fi lm ln l lo lp">record &lt;- function(history,adjr,f){<br/>  history[[1]] = c(history[[1]],adjr)<br/>  history[[2]] = c(history[[2]],f)<br/>  return(history)<br/>}</span><span id="f7b6" class="ll jk hh lh b fi lv ln l lo lp">#The way of using it is:<br/>history &lt;- record(history,summary(model)$adj.r.squared,summary(model)$fstatistic[[1]])<br/>print(history) #The Adjusted R Squared increased, so we shall take freedom of life choice into our model and continue</span></pre><p id="2703" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当我们包括所有预测值时，历史的最终结果看起来像这样:</p><pre class="ko kp kq kr fd lg lh li lj aw lk bi"><span id="73db" class="ll jk hh lh b fi lm ln l lo lp">$`adj R`<br/>[1] 0.6211607 0.7069917 0.7279170 0.7381867 0.7450204 0.7455308<br/><br/>$`F statistic`<br/>[1] 243.66692 179.55253 132.98388 105.32206  87.48771  73.26714</span></pre><p id="cdff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">检查结果后，我发现F-统计量在不断减少，调整后的R平方实际上并没有增加太多。在F统计量和调整后的R平方之间取得平衡(实际上这不是最好的方法。如果想检查添加的预测值是否显著，可以做一组Ftest)。例如，我们可以测试模型中腐败的贡献是否显著。</p><pre class="ko kp kq kr fd lg lh li lj aw lk bi"><span id="755a" class="ll jk hh lh b fi lm ln l lo lp">model &lt;- lm(lad~gdp+fre+soc,data = df)<br/>ess_r &lt;- 1 - summary(model)$r.square<br/>model &lt;- lm(lad~gdp+fre+soc+corrup,data = df)<br/>ess_ur &lt;- 1 - summary(model)$r.square<br/>(ess_r - ess_ur)/(ess_ur/(149-1-4))<br/>qf(1-0.01,1,144)</span><span id="359b" class="ll jk hh lh b fi lv ln l lo lp">#Result<br/>[1] 6.687642 #F-stat<br/>[1] 6.814199 #F(1,144) 0.99 quantile, so corrup is not significant at 1% significance level.</span></pre><p id="65ca" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我最终选择了第三种模型，它考虑了国内生产总值、生活选择自由和社会支持。这个最终模型可以解释73%的总变化，这是相当不错的。</p><h1 id="3eb9" class="jj jk hh bd jl jm lb jo jp jq lc js jt ju ld jw jx jy le ka kb kc lf ke kf kg bi translated">模型诊断</h1><p id="7d74" class="pw-post-body-paragraph ie if hh ig b ih kh ij ik il ki in io ip kj ir is it kk iv iw ix kl iz ja jb ha bi translated">什么是多重共线性，我们为什么要关注它？这可能是一个相当复杂的问题，有许多详尽的文章解释了这一点，但我仍然想解释一下。为了进一步阅读，你可以看看Jim <a class="ae km" href="https://statisticsbyjim.com/regression/multicollinearity-in-regression-analysis/" rel="noopener ugc nofollow" target="_blank">写的这篇博客https://statisticsbyjim . com/regression/multi共线性-in-regression-analysis/ </a>。</p><p id="97c6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在最后一部分，我们将进行模型诊断检查。我们关心几个问题。</p><ol class=""><li id="60e7" class="lw lx hh ig b ih ii il im ip ly it lz ix ma jb mb mc md me bi translated">异方差</li><li id="cc27" class="lw lx hh ig b ih mf il mg ip mh it mi ix mj jb mb mc md me bi translated">残差正态性</li><li id="38cf" class="lw lx hh ig b ih mf il mg ip mh it mi ix mj jb mb mc md me bi translated">序列相关性(在这种情况下不合理)</li><li id="a94a" class="lw lx hh ig b ih mf il mg ip mh it mi ix mj jb mb mc md me bi translated">极端值</li></ol><pre class="ko kp kq kr fd lg lh li lj aw lk bi"><span id="2d37" class="ll jk hh lh b fi lm ln l lo lp">#We could simply use this two row of codes to do the diagnostic<br/>par(mfrow=c(2,2))<br/>plot(model)</span></pre><figure class="ko kp kq kr fd ks er es paragraph-image"><div class="er es mk"><img src="../Images/30d4612983c65f94d605c6f04bc6bad0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RVOuhbU-Fy5jV3iDvdAj4w.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">图5</figcaption></figure><figure class="ko kp kq kr fd ks er es paragraph-image"><div class="er es mk"><img src="../Images/0cca690027e44dcde8abf40248e13ddd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jkseiH9W3lILsu43_DVLLA.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">图6</figcaption></figure><figure class="ko kp kq kr fd ks er es paragraph-image"><div class="er es mk"><img src="../Images/01a9a7339c18dc350f8b1a251441ae3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GzxCEk_DKxFwWIBCvXzRow.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">图7</figcaption></figure><figure class="ko kp kq kr fd ks er es paragraph-image"><div class="er es mk"><img src="../Images/81bdf69e352f09f9f942f8b32feb76b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SRg25kn5utJR47czJUhXMA.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">图8</figcaption></figure><p id="547f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从图5和图7中，我们可以看到没有明显的异方差。从图6可以看出，MLR模型中残差的正态分布假设是合理的。关于图8，我们可以观察到相当多的有影响的数据点(但不一定是异常值。关于如何处理异常值，我发现这篇<a class="ae km" href="https://www.theanalysisfactor.com/outliers-to-drop-or-not-to-drop/" rel="noopener ugc nofollow" target="_blank">文章</a>非常有用)如果你想知道更多关于如何解读这些情节，你可以看看这个<a class="ae km" href="http://www.sthda.com/english/articles/39-regression-model-diagnostics/161-linear-regression-assumptions-and-diagnostics-in-r-essentials/" rel="noopener ugc nofollow" target="_blank">博客</a>。</p><h1 id="9423" class="jj jk hh bd jl jm lb jo jp jq lc js jt ju ld jw jx jy le ka kb kc lf ke kf kg bi translated">参考</h1><ol class=""><li id="9115" class="lw lx hh ig b ih kh il ki ip ml it mm ix mn jb mb mc md me bi translated"><a class="ae km" href="http://www.sthda.com/english/articles/39-regression-model-diagnostics/161-linear-regression-assumptions-and-diagnostics-in-r-essentials/" rel="noopener ugc nofollow" target="_blank">http://www . sth da . com/English/articles/39-regression-model-diagnostics/161-linear-regression-assumptions-and-diagnostics-in-r-essentials/</a></li><li id="5a4a" class="lw lx hh ig b ih mf il mg ip mh it mi ix mj jb mb mc md me bi translated"><a class="ae km" href="https://quantifyinghealth.com/stepwise-selection/" rel="noopener ugc nofollow" target="_blank">https://quantifyinghealth.com/stepwise-selection/</a></li><li id="3e55" class="lw lx hh ig b ih mf il mg ip mh it mi ix mj jb mb mc md me bi translated">教材:应用回归分析</li></ol></div></div>    
</body>
</html>