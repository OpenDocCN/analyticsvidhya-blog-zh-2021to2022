<html>
<head>
<title>Vaccine Slot Notifier using AWS &amp; Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用AWS和Python的疫苗槽通知程序</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/vaccine-slot-notifier-using-aws-python-bbfe7dd60e84?source=collection_archive---------20-----------------------#2021-05-14">https://medium.com/analytics-vidhya/vaccine-slot-notifier-using-aws-python-bbfe7dd60e84?source=collection_archive---------20-----------------------#2021-05-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="a8b7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">了解如何使用几个简单的步骤构建自己的通知系统！</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/be78852d2b2ecdab00fddf1a25f0a2f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ir4-al-cwk7xWYTf"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">戴安娜·波莱希娜在<a class="ae js" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="fc05" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">印度宣布，从2021年5月1日起，将开始为18-44岁年龄组的人群接种疫苗。此前，它只针对所有45岁以上的人。此外，在前来接种疫苗之前，必须在<a class="ae js" href="https://www.cowin.gov.in/home" rel="noopener ugc nofollow" target="_blank"> COWIN门户网站</a>上进行登记和预约。印度18-44岁年龄组的人口为5.946亿，只有一个单一的疫苗接种注册门户。因此，毫无疑问，这需要技术人员运用他们的技能，建立通知系统，将所有人从麻烦中解救出来。下面的推文很好地总结了这一点😜</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="75f4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有太多的通知系统，它们也非常有用。我想创造我自己的版本，只是想把它记录下来，因为同样的过程可以在许多其他事情上复制，不仅仅是COVID疫苗接种。</p><p id="efa3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">开门见山，以下是我用来想出自己的通知系统的步骤。稍后将详细说明每一步。</p><ol class=""><li id="84a7" class="jv jw hh ig b ih ii il im ip jx it jy ix jz jb ka kb kc kd bi translated">找到数据的来源。</li><li id="e702" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb ka kb kc kd bi translated">获取和操作数据。</li><li id="5fcd" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb ka kb kc kd bi translated">创建一个无限期实现步骤2并发送通知的管道。</li></ol><h1 id="947f" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated"><strong class="ak">第一步:找到数据源- </strong></h1><ul class=""><li id="57ad" class="jv jw hh ig b ih lh il li ip lj it lk ix ll jb lm kb kc kd bi translated">最好的事情是<strong class="ig hi">公共API</strong>已经可用，所以你可以直接检查<a class="ae js" href="https://apisetu.gov.in/public/marketplace/api/cowin" rel="noopener ugc nofollow" target="_blank">这个链接</a>并根据你的需要获取数据。</li><li id="4eba" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb lm kb kc kd bi translated">更通用的方法是使用<strong class="ig hi">开发者工具</strong>并通过<strong class="ig hi">网络</strong>选项卡找到API。如果有很多请求，最好按XHR请求过滤。</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ln"><img src="../Images/dcdc34810a1f171fdc3c1577eacdb697.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q_DI6ywpbgGqT4WdFz8bMw.png"/></div></div></figure><h1 id="5e27" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">步骤2:获取和操作数据-</h1><p id="db3d" class="pw-post-body-paragraph ie if hh ig b ih lh ij ik il li in io ip lo ir is it lp iv iw ix lq iz ja jb ha bi translated">既然您已经弄清楚了数据源，那么您只需要创建一个脚本，该脚本将从数据源获取数据并将其处理成您喜欢的格式。出于编写脚本的目的，我使用了Python，出于可读性考虑，我的首选格式是表格。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lr ju l"/></div></figure><p id="3f63" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">关于守则的几点</p><ul class=""><li id="2962" class="jv jw hh ig b ih ii il im ip jx it jy ix jz jb lm kb kc kd bi translated">因为我使用的是<strong class="ig hi"> AWS lambda </strong>，所以代码是针对lambda函数的。只是它被封装在函数<strong class="ig hi"> lambda_handler </strong>内部。</li><li id="54a4" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb lm kb kc kd bi translated">为了将<strong class="ig hi">熊猫</strong>和<strong class="ig hi">请求</strong>导入我的lambda函数，我使用了lambda图层。<a class="ae js" rel="noopener" href="/analytics-vidhya/aws-adding-python-libraries-to-lambda-layers-8c4eaf8fed80">跟随本文</a>向lambda添加非标准python库。</li><li id="9cae" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb lm kb kc kd bi translated">Lambda按照UTC时区运行代码。我忘了导入pytz，它也不是一个标准库。所以，这就是为什么手动改变第13行的时区。</li><li id="4c35" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb lm kb kc kd bi translated">我已经对第14行的地区进行了硬编码，因为我和我的朋友只想要德里NCR的更新。因此，逻辑可以根据您的需要来实现。</li><li id="f9c7" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb lm kb kc kd bi translated">当我为我的朋友和我自己构建服务时，我将接收者添加为一个<strong class="ig hi">环境变量</strong>。你可以根据自己的需要从你的数据库或S3中读取它们。</li><li id="4087" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb lm kb kc kd bi translated"><strong class="ig hi"> send_email </strong>函数在utils.py中，我把<a class="ae js" href="https://kuharan.medium.com/sending-emails-with-aws-lambda-aws-simple-email-service-ses-513839bc53ab" rel="noopener">这篇惊艳的文章</a>作为参考创建了这个函数。</li></ul><h1 id="c169" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">步骤3:创建一个无限期实现步骤2并发送通知的管道-</h1><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ls"><img src="../Images/05d1ebb6918d3b1fe208e67025ec07fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*maflAAxB-SXakl3fwOOQ6w.png"/></div></div></figure><p id="9539" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以上是用于疫苗通知程序的简单AWS架构。调度表达式使<strong class="ig hi"> EventBridge </strong>在每<strong class="ig hi"> 2分钟</strong>后触发步骤2中的<strong class="ig hi"> lambda </strong>功能。频率完全取决于你的需要。</p><p id="2d15" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">AWS提供2种通知服务:<strong class="ig hi"> SNS </strong> &amp; <strong class="ig hi"> SES </strong>。SNS使你能够以简单的文本格式发送信息或电子邮件。SES使你能够使用HTML发送格式化的电子邮件或文本信息。你甚至可以发送带有附件的电子邮件。由于<strong class="ig hi"> Pandas </strong>提供了一个函数<strong class="ig hi"> df.to_html() </strong>将<strong class="ig hi"> </strong> dataframe转换成html，这激励我使用SES。</p><ul class=""><li id="4680" class="jv jw hh ig b ih ii il im ip jx it jy ix jz jb lm kb kc kd bi translated">SES是一个非常容易使用的服务。您只需在AWS控制台中转至SES，并在那里添加电子邮件/身份。创建身份后，会向其发送一封验证邮件，在验证时，会添加一个带有绿色勾号的“已验证”作为身份状态。</li></ul><blockquote class="lt lu lv"><p id="9a25" class="ie if lw ig b ih ii ij ik il im in io lx iq ir is ly iu iv iw lz iy iz ja jb ha bi translated"><strong class="ig hi">请注意</strong> : SES邮件只能发送给沙箱中经过验证的邮件。此外，无论访问(沙盒/生产)如何，都需要验证发送者。</p></blockquote><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ma"><img src="../Images/1c0242471a36fe096f769331089b6eb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eyN92-_UO-yhfAvVKAHwyQ.png"/></div></div></figure><ul class=""><li id="69b5" class="jv jw hh ig b ih ii il im ip jx it jy ix jz jb lm kb kc kd bi translated">因为我是个人使用，所以我手动添加了电子邮件。要使整个过程自动化，你可以简单地使用<a class="ae js" href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/ses.html#SES.Client.verify_email_address" rel="noopener ugc nofollow" target="_blank"> boto3 </a>。</li><li id="5ae0" class="jv jw hh ig b ih ke il kf ip kg it kh ix ki jb lm kb kc kd bi translated">AWS最初向SES提供<strong class="ig hi">沙盒访问</strong>，并且对您可以发送的电子邮件数量有上限(200封/天)。但是，你可以用一个有效的理由请求<strong class="ig hi">生产访问权</strong>，AWS将很乐意批准。此外，一旦您拥有生产访问权限，您也可以对验证邮件模板进行更改。</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mb"><img src="../Images/7273a0c94dabe5725449bf2e711063a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6liOjfgFjFAsn5tWmMKRpg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">我的帐户仪表板的屏幕截图。我的帐户在沙盒里。</figcaption></figure></div><div class="ab cl mc md go me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ha hb hc hd he"><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mj"><img src="../Images/2127ab28bc61f366cf057b1a20313571.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RNn5TCHYEr4rnn9w1_ND5g.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">示例邮件</figcaption></figure><p id="e75d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">遵循所有的步骤将会给你你的疫苗槽通知程序，就像上面使用Python &amp; AWS一样。正如我之前所说，同样的过程也可以用于许多其他目的。</p><p id="005d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我希望这篇文章对你有用。如有任何疑问，请随时联系我:)</p><h1 id="28f4" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated"><a class="ae js" href="https://www.linkedin.com/in/anshuls235/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a><br/><a class="ae js" href="http://anshuls235@gmail.com/" rel="noopener ugc nofollow" target="_blank">Gmail</a></h1></div></div>    
</body>
</html>