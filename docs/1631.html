<html>
<head>
<title>Flying A Rocket, Numerically.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从数字上看，驾驶火箭。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/flying-a-rocket-numerically-404ed271ee23?source=collection_archive---------10-----------------------#2021-03-10">https://medium.com/analytics-vidhya/flying-a-rocket-numerically-404ed271ee23?source=collection_archive---------10-----------------------#2021-03-10</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="0144" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">简要介绍模拟和将离散化的常微分方程转换为python代码以模拟物理现象。</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/29003c0dc1f197ffe6c36311ee34b18f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bnZQe_slLZq5zlSL"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">照片由<a class="ae jm" href="https://unsplash.com/@philhearing?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">菲尔在<a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上听</a></figcaption></figure><p id="28c2" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi kj translated"><span class="l kk kl km bm kn ko kp kq kr di"> T </span>宇宙是连续的还是离散的正在争论中(希腊哲学家芝诺对两个巨人的一瞥:广义相对论&amp;量子论)。然而，一种物理现象，如无粘性流体的流动，即使从远处看似乎是连续的，我们仍然需要将它们离散化，以便定量地“测量”它的任何性质。当我们人类(在本文中我们将保持一个地球人的视角)测量一些东西时，我们总是在这个过程中失去一些准确性。是不是很意外？我们稍后将回到这一点。</p><p id="5585" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">借助传统的物理实验来研究一个物理现象可能极其困难(高能等离子体和放电)，有时也不可能(黑洞)。模拟使我们能够建立一个系统的模型，并允许我们做虚拟实验。</p><p id="19ea" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">那么，这个<strong class="jp hi">离散化</strong>、<strong class="jp hi"> </strong>的过程到底是什么意思呢？有人可能会问。在我们进一步讨论之前，我们需要用更专业的语言来描述整个故事，以便更好地理解其基本原理。我们前面已经看到，连续流是由连续函数描述的，比如说，质点的速度被转换成离散形式，可以在计算机的有限内存中表示出来。</p><p id="c802" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">下一个也是最重要的问题是我们如何做到这一点？这就是数值方法发挥作用的地方。当然，还有其他方法(谱元素法、格子玻尔兹曼法)，但为了简洁起见，我们将坚持用最简单的数值方法来求解常微分方程(ODEs)。那么，让我们开始这个美丽的模拟世界的旅程，在这里我们将了解一些关于数值积分方法和离散化的过程。然后，我们将用几行python代码模拟一次火箭飞行，绘制其纯垂直轨迹，以观察模拟的威力。</p><h1 id="dcef" class="ks kt hh bd ku kv kw kx ky kz la lb lc in ld io le iq lf ir lg it lh iu li lj bi translated"><strong class="ak">火箭科学</strong></h1><p id="b423" class="pw-post-body-paragraph jn jo hh jp b jq lk ii js jt ll il jv jw lm jy jz ka ln kc kd ke lo kg kh ki ha bi translated">火箭在纯垂直飞行中的运动由一组一阶微分方程控制，如下所示。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es lp"><img src="../Images/c96e4fd9240eccdbeb72742059e5789d.png" data-original-src="https://miro.medium.com/v2/resize:fit:108/format:webp/1*vtwz-JvB7juALSw8pV1wsw.png"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es lq"><img src="../Images/744d9cf6c8ca8e501f844630c65d2c4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*S9IZHukCeq9R_lpaJHxgsw.png"/></div></figure><p id="0337" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">其中v是火箭的速度，h是火箭的高度。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="e55c" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">剩余推进剂的质量由下式给出:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es lt"><img src="../Images/fa44efb75598a5fd76aad08ec62d522d.png" data-original-src="https://miro.medium.com/v2/resize:fit:334/format:webp/1*iuaopvEJw5hJOlHWRr_IZA.png"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es lu"><img src="../Images/ca138cb2f200340a52fdc3b7be0a89db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*eKngBO83EYhtLrF-SOOqtA.png"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es lv"><img src="../Images/0900632f28473d39893b6c8dedbbe702.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*lQXhn0XIELRW1-m8cQY9Yw.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">该图描述了火箭燃料消耗随时间的变化</figcaption></figure><p id="a0e0" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">有人可能已经注意到，由于我们的第三个方程也是依赖于时间的，我们现在实际上有三个方程要解。我们需要求解三个变量，即推进剂的速度(v)、高度(h)和质量(Mp)。</p><p id="f155" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">请注意，这些变量也出现在其他方程中。这被称为方程耦合，因为变量在每个时间步也依赖于其他变量。</p><h1 id="107d" class="ks kt hh bd ku kv kw kx ky kz la lb lc in ld io le iq lf ir lg it lh iu li lj bi translated"><strong class="ak">时间积分</strong></h1><p id="a0b0" class="pw-post-body-paragraph jn jo hh jp b jq lk ii js jt ll il jv jw lm jy jz ka ln kc kd ke lo kg kh ki ha bi translated">我们想找出火箭的轨迹。这可以通过对微分方程进行时间积分来实现。这些微分方程的时间解可以分两步获得:</p><ol class=""><li id="e1c7" class="lw lx hh jp b jq jr jt ju jw ly ka lz ke ma ki mb mc md me bi translated">找出所有变量在某一时刻的导数。</li><li id="4c0a" class="lw lx hh jp b jq mf jt mg jw mh ka mi ke mj ki mb mc md me bi translated">将这些解决方案与时间结合起来。</li></ol><p id="4915" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">注意，这些微分方程组有一个解析解。然而，由于我们没有验证我们的数值解的准确性，我们将只关注方程的数值分析方面。</p><p id="47e1" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">让我们用质数重写时间导数。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mk"><img src="../Images/7f247f9f3061f9ee36a69e6df445cd83.png" data-original-src="https://miro.medium.com/v2/resize:fit:92/format:webp/1*sT1J7PsjUOd399v7jqJAbw.png"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ml"><img src="../Images/0d2db2990294505f98c7c9914b4ed117.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*MRO_oMxlmfGmMJj273p7Ww.png"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mm"><img src="../Images/e8dc595ee13f2c23c97521e4b7f5ac03.png" data-original-src="https://miro.medium.com/v2/resize:fit:160/format:webp/1*2ZkuNmyvsokGgftV5LX0rw.png"/></div></figure><p id="60be" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">看待这些一阶微分方程的另一种方式是使用向量符号。我们可以用这三个变量做一个向量。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mn"><img src="../Images/5cd7c752f60dccf1938f8eaa5b3a4835.png" data-original-src="https://miro.medium.com/v2/resize:fit:162/format:webp/1*dPYGF1ptSDp0O7E0Qk-wJQ.png"/></div></figure><p id="d74a" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">那么微分系统可以写成</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mo"><img src="../Images/63ee464447b65d701843bf665a0a9c2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*TSGsIRKe4AwApUNyYm-GYA.png"/></div></figure><p id="641c" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">如果右手边被称为<strong class="jp hi"> f(u) </strong>，我们可以将全向量系写成<strong class="jp hi">u′(t)= f(u)</strong>。注意，为了清楚起见，我们去掉了矢量符号。从今以后，我们将经常使用这种符号来描述完整的向量方程组。</p><p id="5dbc" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我们可以在python中定义一个函数来写右边这个。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lr ls l"/></div></figure><h1 id="9e61" class="ks kt hh bd ku kv kw kx ky kz la lb lc in ld io le iq lf ir lg it lh iu li lj bi translated"><strong class="ak">初值问题</strong></h1><p id="1a9b" class="pw-post-body-paragraph jn jo hh jp b jq lk ii js jt ll il jv jw lm jy jz ka ln kc kd ke lo kg kh ki ha bi translated">因为我们在时间维度上移动，所以我们需要一个在<strong class="jp hi"> u(t=0)=u_0 </strong>的起点。我们需要方程中所有变量的初始值。这叫初值问题。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lr ls l"/></div></figure><h1 id="6be4" class="ks kt hh bd ku kv kw kx ky kz la lb lc in ld io le iq lf ir lg it lh iu li lj bi translated"><strong class="ak">离散化</strong></h1><p id="93bf" class="pw-post-body-paragraph jn jo hh jp b jq lk ii js jt ll il jv jw lm jy jz ka ln kc kd ke lo kg kh ki ha bi translated">我们使用了含有时间导数的微分方程。但是到底什么是衍生品呢？对于<strong class="jp hi"> u = u(t) </strong>的曲线，导数代表该曲线上一点处切线的斜率。导数u’的定义如下</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mp"><img src="../Images/f73e3717983ece3d320ce666b14cab16.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/format:webp/1*OYhcSO4AJQTRxRseT-EgBQ.png"/></div></figure><p id="28b5" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">如果步长δt非常小，我们可以通过降低极限来逼近导数，</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mq"><img src="../Images/e56e04d8da5796487ff3a8bc7ff58bf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/1*WkLAuSiJ3RnKKLbIYIVBWA.png"/></div></figure><p id="b8a3" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这个近似值意味着什么？这意味着在确定实际值时，我们损失了一定的精度。有印象吗？我在一开始就谈到了失去准确性！这是其中一个例子，我们会因为导数的阶次而失去精度。这里，我们使用一阶导数。</p><p id="d8bf" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">上面的等式到底是什么意思？我们可以通过使用一个我们已经知道的在时间<strong class="jp hi"> t </strong>和<strong class="jp hi">u′</strong>的初始值<strong class="jp hi">u(t+δt)</strong>并步进<strong class="jp hi">δt</strong>来找到新的值。同样，我们可以找到<strong class="jp hi">u(t+2δt)</strong>等等。这实际上是第二步，即解决方案与时间的整合。</p><p id="80cc" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我们实际上已经将时域离散为小的时间步长<strong class="jp hi">δt</strong>。我们找到一系列时间值的变量的数值解，每个时间值由<strong class="jp hi">δt</strong>分隔。这些时间值构成了我们的时间网格。这个时间网格的第一个点是初始时间<strong class="jp hi"> t=0 </strong>。</p><h1 id="1d77" class="ks kt hh bd ku kv kw kx ky kz la lb lc in ld io le iq lf ir lg it lh iu li lj bi translated"><strong class="ak">欧拉方法</strong></h1><p id="4ea9" class="pw-post-body-paragraph jn jo hh jp b jq lk ii js jt ll il jv jw lm jy jz ka ln kc kd ke lo kg kh ki ha bi translated">基于确定上述<strong class="jp hi">u(t+δt)</strong>的近似方程，该方程的数值解包括使用以下方程计算一系列近似解:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mr"><img src="../Images/23cf1477940ffcc54ab8ab843a5ae25b.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*8LcCn-B125V0bA7-idsHNg.png"/></div></figure><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lr ls l"/></div></figure><h1 id="d95f" class="ks kt hh bd ku kv kw kx ky kz la lb lc in ld io le iq lf ir lg it lh iu li lj bi translated"><strong class="ak">数值解</strong></h1><p id="b087" class="pw-post-body-paragraph jn jo hh jp b jq lk ii js jt ll il jv jw lm jy jz ka ln kc kd ke lo kg kh ki ha bi translated">现在我们已经有了我们需要的所有理论，我们可以使用python和它的高效库来解决这些微分方程。</p><p id="647f" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">首先，我们将导入一些重要的库。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="73d3" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我们定义一个任意的时间间隔。我们创建一个数组<code class="du ms mt mu mv b">u</code>来保存所有变量的向量。对于初始步骤，我们用上面定义的所有变量的初始值填充<code class="du ms mt mu mv b">u</code>。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lr ls l"/></div></figure><p id="ef0e" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">接下来，我们画出火箭的轨迹，它是作为T3的函数的T2。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="lr ls l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mw"><img src="../Images/9ad63fc8f4020001b0d66e7ad870513b.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*E_BGhSXE1dY5DJed_wFLPQ.png"/></div></figure><p id="97d4" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">正如我们所观察到的，火箭上升到大约1300米的最高高度需要15.7秒。这时，火箭内部的燃料已经空了，火箭开始下降。</p><h1 id="2bb4" class="ks kt hh bd ku kv kw kx ky kz la lb lc in ld io le iq lf ir lg it lh iu li lj bi translated"><strong class="ak">结论</strong></h1><p id="7d70" class="pw-post-body-paragraph jn jo hh jp b jq lk ii js jt ll il jv jw lm jy jz ka ln kc kd ke lo kg kh ki ha bi translated">这是对使用python模拟物理现象的简单介绍，可以在笔记本电脑上完成。模拟的美妙之处在于我们可以用近似的方法来研究许多复杂的现象。然而，正如我们在上面看到的，当我们对导数进行近似时，我们会损失一些精度。</p><p id="31b7" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我们可以进一步计算火箭的速度，以及火箭耗尽燃料后到达地面所需的时间。最后，我们可以比较结果与解析解，以检查我们的数值解的准确性。完整的代码可以在这里的<a class="ae jm" href="https://github.com/sidhantjain90/Numerical-Methods/blob/master/Module%201%20Rocket%20Flight%20(Assignment).ipynb" rel="noopener ugc nofollow" target="_blank">链接中找到。</a></p></div></div>    
</body>
</html>