<html>
<head>
<title>Forecasting Google’s Stock Price with ARIMA Modeling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用ARIMA模型预测谷歌的股价</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/forecasting-googles-stock-price-with-arima-modeling-1148cd8496c8?source=collection_archive---------4-----------------------#2021-02-16">https://medium.com/analytics-vidhya/forecasting-googles-stock-price-with-arima-modeling-1148cd8496c8?source=collection_archive---------4-----------------------#2021-02-16</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6afc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Github repo for this can发现<a class="ae jd" href="https://github.com/mdominguez2010/predict-stock-price-arima" rel="noopener ugc nofollow" target="_blank">此处</a></p><p id="b2b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在Gamestop在subreddit r/wallstreetbets的惨败之后，我对股票市场产生了浓厚的兴趣。它预示着极度富有的机会。如果你只能对一只股票，你可以永远改变你的生活。很多人追求这个梦想，然而也有很多人的梦想被粉碎，就像汤姆·布拉迪对堪萨斯城酋长队所做的那样。</p><p id="0467" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为什么？</p><p id="ee51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">影响股票价格的变量数不胜数。普通人不可能完全理解所有这些是如何工作的。处理数以万计的数据点是人脑无法处理的。但是也许一台机器可以…</p><p id="93d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">免责声明:在我开始之前，必须声明—本文绝不是任何形式的交易建议，而仅仅是一个简单的数据科学项目。准确预测股票价格变动需要高度复杂的模型，但事实并非如此。</p><p id="38f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目的:创建一个简单的时间序列模型来预测谷歌的股票价格。</p><p id="d9a0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">方法论:</strong></p><ol class=""><li id="2ee2" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc jj jk jl jm bi translated">使用TD Ameritrade的API检索数据</li><li id="25ac" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">清理并可视化数据</li><li id="933d" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">计算回报</li><li id="e8bd" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">平稳性检验:迪基-富勒检验</li><li id="6994" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">使用ACF和PACF图表选择参数</li><li id="9beb" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">建立ARIMA时间序列模型</li><li id="41f6" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">用实际值绘制预测值</li><li id="9707" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">做检测</li><li id="5dfc" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc jj jk jl jm bi translated">分析结果</li></ol><p id="82b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">导入库</strong></p><p id="4240" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我将使用以下python库来执行我的分析:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="e96d" class="kb kc hi jx b fi kd ke l kf kg"># Libraries for handling data<br/>from information import client_id<br/>import requests<br/>import numpy as np<br/>import pandas as pd<br/>from datetime import datetime<br/>import random</span><span id="ce9a" class="kb kc hi jx b fi kh ke l kf kg"># For visualizations<br/>import plotly.graph_objects as go<br/>import matplotlib.pyplot as plt</span><span id="15a3" class="kb kc hi jx b fi kh ke l kf kg"># For time series modeling<br/>import statsmodels.api as sm<br/>from statsmodels.tsa.stattools import adfuller<br/>from statsmodels.graphics.tsaplots import plot_acf, plot_pacf<br/>from statsmodels.tsa.arima_model import ARMA</span></pre><p id="53fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">使用TD Ameritrade的API检索数据</strong></p><p id="e4a5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">TD Ameritrade有一个像样的股票价格API，它不是超级健壮，但足以获得我们需要的数据。有关如何开始使用TD Ameritrade的API的好教程，请查看:</p><figure class="js jt ju jv fd ki"><div class="bz dy l di"><div class="kj kk l"/></div></figure><p id="5bfd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我的自定义函数从TD Ameritrade的API请求和提取数据:</p><figure class="js jt ju jv fd ki"><div class="bz dy l di"><div class="kl kk l"/></div></figure><p id="b6e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">清理并可视化数据</strong></p><p id="0831" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">检查未知值或NaN(非数字)值:</p><pre class="js jt ju jv fd jw jx jy jz aw ka bi"><span id="4f8d" class="kb kc hi jx b fi kd ke l kf kg">dataframe[dataframe.isna().any(<em class="km">axis</em>=1)]</span></pre><p id="b34d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">绘制数据:</p><figure class="js jt ju jv fd ki er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kn"><img src="../Images/a1010c2ca11c3ad399279ca0d74b5e05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*55dUjfxaC0qrZZ8Kmr6mrw.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">从TD Ameritrade API检索</figcaption></figure><p id="56ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">计算收益</strong></p><p id="a589" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">适当的时间序列要求数据是平稳的。这意味着均值和标准差与时间无关。为此，我们对数据进行一阶差分(计算日收益率)。</p><figure class="js jt ju jv fd ki"><div class="bz dy l di"><div class="kl kk l"/></div></figure><p id="f591" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">绘图回报:</p><figure class="js jt ju jv fd ki er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kn"><img src="../Images/df6a896eea9076635616a3a9c7683f60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qBLOP32QOYTNmTuwG6dehQ.png"/></div></div></figure><p id="b43a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">平稳性测试:迪基-富勒测试</strong></p><p id="cf2f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">平稳性意味着收益的均值和标准差与时间无关。这一点很重要，因为它考虑到了预测模型的稳定性和某种程度的确定性。</p><p id="d63c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为此，我们必须首先计算滚动平均值和标准偏差</p><figure class="js jt ju jv fd ki"><div class="bz dy l di"><div class="kl kk l"/></div></figure><p id="9c6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">绘制滚动平均值和标准偏差的回报</p><figure class="js jt ju jv fd ki er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kn"><img src="../Images/f78d84eb2ae839a5da8db2d21e22ee00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AumP8Qy5DImwtOaVRIIavQ.png"/></div></div></figure><p id="e42e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们可以进行迪基-富勒测试了:</p><figure class="js jt ju jv fd ki"><div class="bz dy l di"><div class="kl kk l"/></div></figure><p id="b2a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用p值&lt; 0.05, we can reject the null hypothesis that there is a unit root, which is a fancy way of saying there is a discernible patter. Since we reject the null hypothesis, the data is therefore stationary! We can now proceed with the time-series modeling process.</p><p id="f886" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">选择参数使用ACF和PACF图表</strong></p><p id="99c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">anARIMA模型的参数定义如下:</p><ul class=""><li id="3c1f" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc ky jk jl jm bi translated"><strong class="ih hj"> p </strong>:模型中包含的滞后观测值的个数，也称为滞后阶数。</li><li id="3ba1" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc ky jk jl jm bi translated"><strong class="ih hj"> d </strong>:原始观测值被差分的次数，也叫差分程度。我们的数据有一次差异(每日回报)</li><li id="3776" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc ky jk jl jm bi translated"><strong class="ih hj"> q </strong>:移动平均线窗口的大小，也叫移动平均线的顺序。</li></ul><p id="8e52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">制作自相关和偏自相关图表有助于我们选择ARIMA模型的参数。</p><p id="4209" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ACF为我们提供了每个“y”值与前n个“y”值相关程度的度量。</p><p id="eb75" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">PACF是部分相关函数，它给出了由n个滞后分隔的两个“y”值之间的相关量(样本),排除了它们之间所有“y”值的影响。</p><p id="1bfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">advancedcommunicationsfunction高级通信功能</p><figure class="js jt ju jv fd ki"><div class="bz dy l di"><div class="kl kk l"/></div></figure><figure class="js jt ju jv fd ki er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kz"><img src="../Images/6ccec4b79e5cb65518d238c343042999.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Anmx2i4nAKZLzAaQ6NEu0g.png"/></div></div></figure><p id="d437" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">PACF</p><figure class="js jt ju jv fd ki"><div class="bz dy l di"><div class="kl kk l"/></div></figure><figure class="js jt ju jv fd ki er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kz"><img src="../Images/bbbd6c1f5ce0208d3bea876871d7ea09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ppYKRH64n4EwXPGlBK2mAw.png"/></div></div></figure><p id="396c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">上面的图表显示ACF和PACF的读数给了我们6的滞后“p”和6的滞后“q”</p><p id="90e9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">建立ARIMA时间序列模型</strong></p><figure class="js jt ju jv fd ki"><div class="bz dy l di"><div class="kl kk l"/></div></figure><p id="d62f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">绘制预测与实际</strong></p><figure class="js jt ju jv fd ki"><div class="bz dy l di"><div class="kl kk l"/></div></figure><figure class="js jt ju jv fd ki er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kn"><img src="../Images/f8a0ebd36f9cc14f21f2156a69e14d78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lkwxp1E6u8E13mjmh6J45w.png"/></div></div></figure><p id="4f92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">进行预测</strong></p><p id="dc35" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在是我们期待已久的时刻…</p><figure class="js jt ju jv fd ki"><div class="bz dy l di"><div class="kl kk l"/></div></figure><figure class="js jt ju jv fd ki er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es la"><img src="../Images/84ef381908868cacd0f19ddb80a2f804.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OvdYFRAJwl9zQBqPEH2dNg.png"/></div></div></figure><p id="5836" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">分析结果</strong></p><p id="835d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看我们的预测。我们离实际股价有多近？让我们画出残差(误差)的分布图</p><figure class="js jt ju jv fd ki"><div class="bz dy l di"><div class="kl kk l"/></div></figure><figure class="js jt ju jv fd ki er es paragraph-image"><div class="er es lb"><img src="../Images/fbe5e1ae3be4843cf3cba81bbbedd1e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*NBr4DpUatMFDMC3BL1m_eA.png"/></div></figure><p id="995f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">尽管大部分误差接近于零，但其中太多误差远离零，这意味着许多预测与实际相差甚远。这可能意味着巨大的损失(这就是为什么你不应该把这个模型用于交易目的，而只能用于教育目的)。</p><ul class=""><li id="32b4" class="je jf hi ih b ii ij im in iq jg iu jh iy ji jc ky jk jl jm bi translated">我们模式的AIC很小，为-20964.701。但是这就等同于一个好的模型吗？大概不会。</li><li id="9b3d" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc ky jk jl jm bi translated">如果我们检查误差(预测-收盘价)，平均绝对误差约为6.8，这可能会导致重大损失。</li><li id="349d" class="je jf hi ih b ii jn im jo iq jp iu jq iy jr jc ky jk jl jm bi translated">模型预测的误差一度达到144，这些交易会导致巨大的损失。</li></ul><p id="d126" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有问题吗？评论？联系我:</p><p id="171a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">电子邮件:<a class="ae jd" href="mailto:md.ghsd@gmail.com" rel="noopener ugc nofollow" target="_blank">md.ghsd@gmail.com</a></p><p id="c229" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">领英:<a class="ae jd" href="https://www.linkedin.com/in/marcosdominguez2018/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/marcosdominguez2018/</a></p><p id="beaf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">推特:<a class="ae jd" href="https://twitter.com/mdcruz2010" rel="noopener ugc nofollow" target="_blank">https://twitter.com/mdcruz2010</a></p></div></div>    
</body>
</html>