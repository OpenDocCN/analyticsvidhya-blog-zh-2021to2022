<html>
<head>
<title>The True Beauty of Extended Kalman Filters</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">扩展卡尔曼滤波器的真正魅力</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/the-true-beauty-of-extended-kalman-filters-32e0c08d9258?source=collection_archive---------3-----------------------#2021-04-08">https://medium.com/analytics-vidhya/the-true-beauty-of-extended-kalman-filters-32e0c08d9258?source=collection_archive---------3-----------------------#2021-04-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="19d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我已经为成为一名自动驾驶工程师努力了一段时间。最近，作为传感器融合模块的一部分，我的任务是建立一个算法，在给定先前输入和不确定性的情况下，可以预测移动汽车的轨迹和位置。</p><h1 id="48a9" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">卡尔曼滤波器是什么？</h1><p id="3530" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">卡尔曼滤波器是一种特殊类型的算法，用于在给定不确定测量值的情况下进行估计。对算法进行硬编码听起来很容易，而且更实用，但是使诸如卡尔曼滤波器之类的估计算法对于这样的任务来说是最佳的，因为它需要间接的和不确定的测量来进行这样的预测。</p><p id="da11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">激光雷达和雷达等传感器容易受到噪声和漂移的影响。卡尔曼滤波器可以将这些传感器合并(融合)在一起，以帮助优化对位置/检测的估计。这正是传感器融合的意义所在。卡尔曼滤波器在其中起着不可或缺的作用。</p><p id="d284" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在自主车辆的情况下，卡尔曼滤波器广泛用于预测其他车辆和行人的运动。计算物体的轨迹和位置对于自动驾驶至关重要，特别是因为直接穿过会(并将)导致其他车辆/行人死亡。</p><h1 id="6ae0" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">卡尔曼滤波器如何工作</h1><p id="e9b9" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">卡尔曼滤波器遵循两步迭代过程:测量更新，然后预测。它通过一系列高斯分布来表示。</p><p id="d76d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面我们来看一个一维高斯的例子。假设这是我们汽车的位置:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kg"><img src="../Images/b1fdd0711285a122af2323bd689ca326.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RAF8gXdQPNgk_E7U.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated"><a class="ae kw" href="https://www.youtube.com/watch?v=VFXf1lIZ3p8&amp;list=PLn8PRpmsu08pzi6EMiYnR-076Mh-q3tWr&amp;index=5" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="901a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我们在时间<strong class="ih hj"> xₖ-₁ </strong>对汽车位置的初始高斯估计。请注意，有一点方差σ，但估计值似乎相当有把握。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kx"><img src="../Images/50940ac933774c9f4048f47653200bb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Q6i2i9sZtee4UUie.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated"><a class="ae kw" href="https://www.youtube.com/watch?v=VFXf1lIZ3p8&amp;list=PLn8PRpmsu08pzi6EMiYnR-076Mh-q3tWr&amp;index=5" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="1d21" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们预测一下xₖ的时间<strong class="ih hj"/>。注意下图，我们的方差σ实际上比以前更高了。现在让我们来看看最新的测量结果，<strong class="ih hj"> yₖ </strong>:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es ky"><img src="../Images/0bba3884ce1709b8cbdc176a5a711d2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uof3UIDyOTOEsLx-.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated"><a class="ae kw" href="https://www.youtube.com/watch?v=VFXf1lIZ3p8&amp;list=PLn8PRpmsu08pzi6EMiYnR-076Mh-q3tWr&amp;index=5" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="420e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">yₖ现在是我们从传感器获得的测量更新输入。测量值更新的方差并不太大，尽管其根本原因主要是因为来自传感器的噪声。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kx"><img src="../Images/936beef7576496a657c305dd5e6f41bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uZmcSlO4UTAGjKzK.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated"><a class="ae kw" href="https://www.youtube.com/watch?v=VFXf1lIZ3p8&amp;list=PLn8PRpmsu08pzi6EMiYnR-076Mh-q3tWr&amp;index=5" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="536a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，卡尔曼滤波器所做的是，它试图通过将在<strong class="ih hj"> xₖ </strong>的预测与在yₖ的更新测量相结合来做出<strong class="ih hj">光学状态估计</strong>，因此，当方差比以前更低时，产生高斯。</p><p id="20c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们通过两个主要步骤来分解卡尔曼滤波算法——预测然后测量更新:</p><h1 id="4dc6" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">预言</h1><p id="9be7" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">给定一个物体的当前位置和速度，让我们将其存储到向量x中。因此，在一维世界中，<strong class="ih hj">x =【xₚ,vₚ】</strong>其中xₚ是汽车在一维世界中的位置，vₚ是汽车的速度。</p><p id="9d2d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后我们会有一个状态转移矩阵，F，把时间加入到方程中。假设<strong class="ih hj"> vₚ </strong>是常数，我们的状态转移矩阵看起来像:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es kz"><img src="../Images/589e28d9e6a00aebcc9e2b3150bec433.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*k_uZymJGU9uadJ0tnd7dHw.png"/></div></figure><p id="07ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于我们的测量向量z，我们将只包含测量值，而不包含速度。这看起来像是，</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es la"><img src="../Images/2679ae1ce454e27b66a67c81bf78a552.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*oIlOW-8cCrkjSJS4cDbazg.png"/></div></figure><p id="8257" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个[1，0]矩阵称为h，乘以我们的输入位置xₚ和速度vₚ.</p><p id="ecaa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经定义并指定了输入矩阵，下面是我们的位置更新的样子:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lb"><img src="../Images/7e498d1d63e350ef78a3440e6641a350.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*SajgMKmoZGaHL5FbYsNdRQ.png"/></div></figure><p id="6713" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中u是我们的外部运动矢量。</p><p id="d323" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们用于预测的另一个矩阵是P，它是我们的估计协方差矩阵，有助于描述我们的不确定性。这看起来会像</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lc"><img src="../Images/4575cd7f71d827a346f7e6b6ae4e42f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*SNnBTTTK2ciVsNqWEKwj3w.png"/></div></figure><p id="1196" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">记住F是状态转移矩阵，我们取它的转置，乘以F和初始协方差矩阵p。</p><p id="fad3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然我们已经做出了最初的预测，那么是时候更新测量值以更好地预测x和p了。</p><h1 id="a1fe" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">更新测量值</h1><p id="5df2" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">我们可以通过定义误差向量y来开始进行测量更新，其定义为</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ld"><img src="../Images/823d233752cba36105b2824618c22079.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*JrNx1yRXvW4wn_AepP9i-A.png"/></div></figure><p id="ae58" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">记住，z是我们的测量输入，H是测量函数(矩阵)，它消除了输入向量x的速度分量。</p><p id="c8d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们将把我们的系统不确定性投影到测量空间中，使用我们现有的测量函数投影，定义为矩阵s。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es le"><img src="../Images/ec38973a67884f416766b6cfb051b664.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*cjTDBBvwjB9kZeJQDQ_pvw.png"/></div></figure><p id="e1af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">r定义为考虑输入传感器噪声的测量噪声。</p><p id="1aa8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有这些实际上都被映射到另一个称为K的矩阵中，也称为卡尔曼增益。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lf"><img src="../Images/5244750a3f9132bd9786ef36b2328495.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*b-tWnbJUIcdiN7QBfaNq6Q.png"/></div></figure><p id="c2df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然我们已经定义了卡尔曼增益，我们可以使用以下等式简单地更新我们的预测变量x和P:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lg"><img src="../Images/056da72bad9606c21e50abfb4a53d79f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*RG3IpkYsGCHj42hTv0R6YA.png"/></div></figure><p id="ac83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">并更新我们的估计协方差矩阵P，</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lh"><img src="../Images/879a62a69486f91a022a91018df31024.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*uTDVAjNYKL9va9acZvS7OQ.png"/></div></figure><p id="2cf3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这正是我们如何编写一个卡尔曼滤波器，在给定所有这些输入的情况下，在自动驾驶汽车领域检测汽车和车辆。</p><p id="eb1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在扩展卡尔曼滤波器中，我们将通过融合激光雷达和雷达输入来执行传感器融合，以帮助做出比简单地使用其中一个更好的预测。</p><p id="9d9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过结合每个传感器(具有高分辨率输入的激光雷达和提供速度输入的雷达)的强度，可以更好地预测物体(汽车/行人)的位置和速度，因此，允许在真实世界情况下进行准确的估计和有限的死亡/干预。</p><h1 id="c9b3" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">真正的乐趣开始了——扩展卡尔曼滤波器</h1><p id="a24f" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">扩展卡尔曼滤波器(EKF)使用我们上面描述的基本卡尔曼滤波器的主要方程/逻辑。我们使用EKF的原因主要是因为预测状态x被映射到一个非线性函数(来自雷达输入)。EKF的目标是解决这个问题，同时能够将输入融合在一起。</p><p id="23a4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">融合流程的整个过程将如下所示:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es li"><img src="../Images/a27f5a759b54699835c3641480b878ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MnruxF39w9pARC0i.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">来源:<a class="ae kw" href="https://www.udacity.com/" rel="noopener ugc nofollow" target="_blank"> Udacity </a></figcaption></figure><p id="7bb2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要点是，如果我们对任何传感器进行初始测量，我们首先要初始化所有的状态和协方差矩阵。从那里，我们必须建立矩阵，并执行新的预测+更新。我们会重复这个过程，直到达到预期的结果(理想情况下，避开现实世界中的行人和其他物体)。我们将对雷达和激光雷达重复这一过程。</p><p id="f4ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">激光雷达实际上非常容易使用和编程(在卡尔曼滤波器的意义上)，因为它直接给我们所需的坐标，我们可以输入到x向量。</p><p id="6b30" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">雷达和激光雷达完全不同。让我们再细分一下。</p><h1 id="4cef" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">雷达</h1><p id="0fe4" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">雷达使用的坐标系与传统的笛卡尔坐标系完全不同。雷达使用<a class="ae kw" href="https://en.wikipedia.org/wiki/Polar_coordinate_system" rel="noopener ugc nofollow" target="_blank">极坐标系统</a>，该系统具有不同的测量功能。这是z的样子:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lj"><img src="../Images/f46daafdaadc91e9f93621fcc1a847bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*1RKm25K7JZU2DRPLhLwucw.png"/></div></figure><p id="4567" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">p是从物体到行人的径向距离。这基本上是物体的大小，假设我们画出物体的位置，并取其矢量。</p><p id="7d98" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">φ(ρ)是射线(矢量线)和x轴之间的测量角度。更多信息请看下图</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es lk"><img src="../Images/1ea79221e973bf58cc1fdd93fc8e4e22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tSiV9--9_sTk2aWQyHIaVg.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">来源:<a class="ae kw" href="https://www.udacity.com/" rel="noopener ugc nofollow" target="_blank"> Udacity </a>。注意，我们总是把对象的位置放在x轴上，而不是y轴上。</figcaption></figure><p id="c78d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ṗ是沿射线的距离变化率(速度)。<a class="ae kw" href="https://glossary.ametsoc.org/wiki/Doppler_velocity#:~:text=The%20radial%20component%20of%20the,Doppler%20radar%20or%20Doppler%20lidar.&amp;text=%2C%20where%20r%20is%20a%20unit,motion%20away%20from%20the%20radar." rel="noopener ugc nofollow" target="_blank">这里有更多关于速度的信息</a>(多普勒/径向速度)。</p><p id="68da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的雷达噪声模型如下所示:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ll"><img src="../Images/b8d7abc639cf891fc409954d83a21fec.png" data-original-src="https://miro.medium.com/v2/resize:fit:484/format:webp/0*YACKOTJBkEiE4Au_.png"/></div></figure><p id="4284" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，我们正在为输入的雷达测量值计算每个“坐标点”的方差。</p><p id="cb3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在出现的问题是:“我如何从笛卡尔空间映射到极坐标系统，在那里我们可以使用雷达并获得角度、速度和星等的精确测量值？”我们可以通过定义一个函数h(x)来解决这个问题:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es lm"><img src="../Images/15447569a791f905e450e828a8df1214.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/0*3SGuRIgRBBwsrHtL.png"/></div></div></figure><p id="8fbc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们用这样一个函数从坐标映射到雷达空间(记住:那是我们的测量向量z)得到的问题是，<em class="ln"> h(x) </em>是一个非线性函数的事实。</p><p id="af0f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于没有使用非线性函数，这导致输出不是高斯型的。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es lo"><img src="../Images/bb386cecf45b857c85582a0b25f4c82c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PNisQr7i3yerp4iyndwblw.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">来源:<a class="ae kw" href="https://www.udacity.com/" rel="noopener ugc nofollow" target="_blank"> Udacity </a></figcaption></figure><p id="88ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是通过非线性函数<em class="ln"> h(x) = atan(x)从均值为0的正态分布中抽取10，000个随机值后的样子。</em>看看下图:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es lp"><img src="../Images/3b52b6d5db579a6cb625f7650c832128.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YWQq7TMG9_Z70H7N.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">来源:<a class="ae kw" href="https://www.udacity.com/" rel="noopener ugc nofollow" target="_blank"> Udacity </a></figcaption></figure><p id="c168" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请注意，右边的图形不是高斯型的。这样做的主要问题是，卡尔曼滤波器不再适用，因为我们使用的是非线性函数<em class="ln"> atan(x) </em>，所以输出不是高斯型的。</p><p id="ee7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们如何解决这个问题？让我们考虑非线性函数的一阶导数(一阶泰勒级数展开)。下面是输出的样子:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es lq"><img src="../Images/5e3eea1bcd820d9bb5fa9f7304b53393.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WvKBUBNrawAw4Mt4.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">来源:<a class="ae kw" href="https://www.udacity.com/" rel="noopener ugc nofollow" target="_blank"> Udacity </a>好多了！</figcaption></figure><h1 id="a3cf" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">泰勒级数展开</h1><p id="a479" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">让我们谈谈泰勒级数展开和它是如何工作的。下面是一般等式的样子:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lr"><img src="../Images/ea4e1cde54758d0501f8fdb43764903c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/0*JK4gCCBSkynGcWaL.png"/></div></figure><p id="8f0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以简单地将<em class="ln"> f(x) </em>替换为我们的函数<em class="ln"> h(x) </em>，并应用相同的逻辑。假设我们将一阶泰勒表达式应用于非线性函数<em class="ln"> arctan(x)。它的导数(线性函数)是什么？</em></p><p id="10a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">假设μ = 0，<em class="ln"> σ </em> =3。</p><p id="4091" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，将<em class="ln"> x </em>投影到<em class="ln"> z </em>(测量空间)的函数为</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ls"><img src="../Images/8a7b4b908c17276f37285f545f9d3fc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/0*IAJMPg3SR7AtQ-sL.png"/></div></figure><p id="364b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个的偏导数是</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lt"><img src="../Images/60d64a2f09fd3dca0984299398c2290a.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/0*YnD-o11c-qJ2lRTi.png"/></div></figure><p id="c170" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当我们采用泰勒级数方程时，我们的线性近似函数输出将是</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es lu"><img src="../Images/8ae5f9d89f52886319836f1f2f5a6c1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xWssc-uSuCIjiLUsW983UQ.png"/></div></div></figure><p id="1924" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就相当于</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lv"><img src="../Images/7f544795f723f9a2ebbab486f37d0bee.png" data-original-src="https://miro.medium.com/v2/resize:fit:398/format:webp/0*8-0E7U91FudkzIuh.png"/></div></figure><p id="aa88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这正是我们执行一阶泰勒级数方程的方式。记住，雷达测量是多维方程。我们怎么能这样工作呢？</p><h1 id="ea60" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">多元泰勒级数</h1><p id="3ad2" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">多维泰勒级数展开的一般方程为</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es lw"><img src="../Images/533bc94320cdc29e39f4c06cfd24de94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zwoEO_yMn4jlwiH7dAQsog.png"/></div></div></figure><p id="ac70" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中<em class="ln"> Df </em> ( <em class="ln"> a </em>)称为雅可比矩阵，<em class="ln"> D f </em> ( <em class="ln"> a </em>)称为<a class="ae kw" href="https://en.wikipedia.org/wiki/Hessian_matrix" rel="noopener ugc nofollow" target="_blank">海森矩阵</a>其中前者代表多维方程组的一阶导数，阶梯部分代表多维方程组的二阶导数。</p><p id="b90c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完整的泰勒级数表达式实际上也包括高阶项(三阶、四阶、五阶导数……)。</p><p id="cd31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了导出h(x)的线性近似，我们可以简单地使用雅可比矩阵(<em class="ln"> Df(a) </em>)，因为我们将假设<em class="ln">(x-a)</em>是一个小值。</p><p id="060a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们再多谈谈雅可比矩阵:</p><h1 id="34b4" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">雅可比矩阵</h1><p id="f59f" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">雅可比矩阵的要点是:取2个<em class="ln">变量的所有偏导数，并将它们存储在一个矩阵Hj中。</em></p><p id="9383" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是我们案例中Hj的样子:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es lx"><img src="../Images/b5c9e3db2a3efa9e26b68d756dfb2181.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xUnFSZZCYSCbitP-yAUdGA.png"/></div></div></figure><p id="42ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是我们的情况下雅可比矩阵的样子——我们将对p、φ和ṗ求关于pₓ、pᵧ、vₓ和vᵧ的导数，因为我们的<em class="ln"> x </em>向量由这4个测量值组成，我们希望将它们转换到我们的测量空间，<em class="ln"> z </em>(这将是雷达坐标)。这正是矩阵为3x4的原因——3行是测量空间<em class="ln"> z </em>的一部分，4列是x向量。</p><p id="3254" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是计算出<em class="ln"> Hj </em>的雅可比矩阵(偏导数)后<em class="ln"> Hj </em>的样子:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es ly"><img src="../Images/06f9e9da2dd68712fd40b527c0088561.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DKs80YB1blM7VbeCYo6PMg.png"/></div></div></figure><h1 id="2a07" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">计算扩展卡尔曼滤波器的最终方程</h1><p id="c131" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">现在，我们已经定义了所有的矩阵，并为进行预测和更新我们的测量设置了一切，现在我们可以将方程放在一起。</p><h1 id="23b4" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">预测方程</h1><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lz"><img src="../Images/4d3b25f69a331da3c6c5a71ecf1b453e.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*NHzf8SJnGiFu9l_u.png"/></div></figure><p id="7564" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请记住，<em class="ln"> f(x，u) </em>是泰勒级数展开的函数，其中x是pₓ、pᵧ、vₓ和vᵧ的输入，<em class="ln"> u </em>是传感器模型中的噪声。</p><p id="9ad5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">p '将是我们对不确定性估计协方差矩阵。</p><h1 id="5e5f" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">测量校正</h1><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ma"><img src="../Images/667d283a6b04c3dcee5eb084f0bf7db6.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/0*9qeb9mRQ5Emw85Sp.png"/></div></figure><p id="2681" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">记住，在计算系统不确定性投影和卡尔曼增益时，我们必须使用雅可比矩阵Hj，而不是标准的H矩阵。</p><p id="c1b7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另外，请注意R是输入测量噪声。我们还使用上面定义的h函数来帮助计算误差。</p><h1 id="6c47" class="jd je hi bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">评估EKF模式——RMSE</h1><p id="0325" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated">既然我们已经定义了一个扩展卡尔曼滤波器，那么就需要一个有效的比较标准来观察我们的EKF模型的表现。我们可以使用均方根误差(RMSE)来帮助完成这项任务。</p><p id="a503" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">RMSE可以帮助测量估计状态与真实状态的偏差。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es mb"><img src="../Images/8f6ff1d25845cf652aa83d802ad2a0e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/0*Ei4PENgUGgq9YLB0.png"/></div></figure><p id="2c7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">地面真实状态(表示为yᵢ)和预测状态之间的差异给出了称为残差的输出。然后对其求平方、平均值，然后求平方根，得到误差度量。注意:误差越小，精度越高。</p></div><div class="ab cl mc md gp me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="hb hc hd he hf"><p id="a0a3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我用C++在Udacity的模拟器中完成并运行了这一切。看看下面提供的Github库和视频，看看运行中的代码。</p><div class="mj mk ez fb ml mm"><a href="https://github.com/srianumakonda/Become-a-Self-Driving-Car-Engineer-Term-1/tree/main/CarND-Extended-Kalman-Filter-Project" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab dw"><div class="mo ab mp cl cj mq"><h2 class="bd hj fi z dy mr ea eb ms ed ef hh bi translated">srianumakonda/成为自动驾驶汽车工程师-Term-1/扩展卡尔曼滤波器</h2><div class="mt l"><h3 class="bd b fi z dy mr ea eb ms ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mu l"><p class="bd b fp z dy mr ea eb ms ed ef dx translated">github.com</p></div></div></div></a></div><p id="f000" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Udacity模拟器结果:</p><figure class="kh ki kj kk fd kl"><div class="bz dy l di"><div class="mv mw l"/></div></figure></div><div class="ab cl mc md gp me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="hb hc hd he hf"><h1 id="fb60" class="jd je hi bd jf jg mx ji jj jk my jm jn jo mz jq jr js na ju jv jw nb jy jz ka bi translated">与我联系</h1><p id="1a6d" class="pw-post-body-paragraph if ig hi ih b ii kb ik il im kc io ip iq kd is it iu ke iw ix iy kf ja jb jc hb bi translated"><a class="ae kw" href="mailto:sri.anumakonda06@gmail.com" rel="noopener ugc nofollow" target="_blank">电子邮件</a></p><p id="3595" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kw" href="https://www.linkedin.com/in/srianumakonda/" rel="noopener ugc nofollow" target="_blank">领英</a></p><p id="7558" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kw" href="https://twitter.com/srianumakonda" rel="noopener ugc nofollow" target="_blank">推特</a></p><p id="2ca3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><a class="ae kw" href="http://srianumakonda.com/" rel="noopener ugc nofollow" target="_blank">网站</a></p><p id="0514" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢<a class="nc nd ge" href="https://medium.com/u/2929690a28fb?source=post_page-----32e0c08d9258--------------------------------" rel="noopener" target="_blank"> Udacity </a> …</p></div></div>    
</body>
</html>