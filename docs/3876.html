<html>
<head>
<title>Image Augmentation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图像增强</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/image-augmentation-9b7be3972e27?source=collection_archive---------1-----------------------#2021-08-04">https://medium.com/analytics-vidhya/image-augmentation-9b7be3972e27?source=collection_archive---------1-----------------------#2021-08-04</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="31fc" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">改进深度学习模型</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/6999121a08a97e8fc17eb4cef73f9059.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G7AOG4ivciLI6y1wYFx-sQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><a class="ae jn" href="https://miro.medium.com/max/1400/0*0Je9h2iT9m7ribFJ.png" rel="noopener">https://miro.medium.com/max/1400/0*0Je9h2iT9m7ribFJ.png</a></figcaption></figure><p id="9678" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">这篇博客是关于图像增强的<strong class="jq hj"> 2部分博客系列</strong>的一部分。它分为:-</p><p id="a925" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">A部分</strong>:介绍图像增强，各种增强技术，以及通过可用库的实现。</p><p id="809c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">B部分</strong>:建立并训练PyTorch模型，分析使用图像增强对性能的影响。</p><p id="def9" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果你是深度学习领域的新手，在某个时间点你可能听说过图像增强的话题。本文将讨论什么是图像增强，并在三个不同的python库中实现它，即Keras、PyTorch和augmentation(专门用于图像增强)。因此，第一个问题出现了什么是图像增强或一般的数据增强。</p><h1 id="aae7" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">什么是图像增强？</h1><blockquote class="lc ld le"><p id="d79f" class="jo jp lf jq b jr js ij jt ju jv im jw lg jy jz ka lh kc kd ke li kg kh ki kj hb bi translated">增加是在尺寸或数量上变得更大的行为或过程。</p></blockquote><p id="8dbc" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在深度学习中，深度网络需要大量的训练数据才能很好地泛化，达到很好的准确率。但在某些情况下，图像数据不够大。在这种情况下，我们使用一些技术来增加我们的训练数据。它人工创建训练数据，使用随机旋转、移位、剪切和翻转(我们将在后面讨论其中一些)等技术处理给定的数据。</p><blockquote class="lc ld le"><p id="d43d" class="jo jp lf jq b jr js ij jt ju jv im jw lg jy jz ka lh kc kd ke li kg kh ki kj hb bi translated">图像增强是为训练我们的深度学习模型生成新图像的过程。这些新图像是使用现有的训练图像生成的，因此我们不必手动收集它们。</p></blockquote><h1 id="d823" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">不同的图像增强技术</h1><p id="fb31" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">各种技术可用于图像增强以输入模型，例如:</p><p id="b0c6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">空间增强</strong></p><ul class=""><li id="9148" class="lo lp hi jq b jr js ju jv jx lq kb lr kf ls kj lt lu lv lw bi translated">缩放比例</li><li id="14a0" class="lo lp hi jq b jr lx ju ly jx lz kb ma kf mb kj lt lu lv lw bi translated">种植</li><li id="5029" class="lo lp hi jq b jr lx ju ly jx lz kb ma kf mb kj lt lu lv lw bi translated">轻弹</li><li id="1139" class="lo lp hi jq b jr lx ju ly jx lz kb ma kf mb kj lt lu lv lw bi translated">旋转</li><li id="dc12" class="lo lp hi jq b jr lx ju ly jx lz kb ma kf mb kj lt lu lv lw bi translated">翻译</li></ul><p id="1289" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">像素增强</strong></p><ul class=""><li id="cdce" class="lo lp hi jq b jr js ju jv jx lq kb lr kf ls kj lt lu lv lw bi translated">聪明</li><li id="586b" class="lo lp hi jq b jr lx ju ly jx lz kb ma kf mb kj lt lu lv lw bi translated">对比</li><li id="5643" class="lo lp hi jq b jr lx ju ly jx lz kb ma kf mb kj lt lu lv lw bi translated">浸透</li><li id="150e" class="lo lp hi jq b jr lx ju ly jx lz kb ma kf mb kj lt lu lv lw bi translated">顺化(越南城市)</li></ul><h1 id="3a9d" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">深度学习中的数据增强</h1><p id="6921" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">在深度学习中，数据增强是一种常见的做法。所以每个深度学习框架都有自己的增强方法，甚至是一个完整的库。例如，让我们看看如何使用Keras、PyTorch和Albumentations中的内置方法来应用图像增强。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mc"><img src="../Images/fab5a868e41d50e75755ba8186076c13.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*1qfgp9BTpM_WWd9fYn9USA.jpeg"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated"><a class="ae jn" href="https://www.kreedon.com/wp-content/uploads/2018/07/sunil.jpg" rel="noopener ugc nofollow" target="_blank">https://www . kreedon . com/WP-content/uploads/2018/07/sunil . jpg</a></figcaption></figure><h1 id="f4b0" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">1.喀拉斯。</h1><p id="42f7" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">Keras ImageDataGenerator类提供了一种快速简单的方法来增加您的图像。它提供了许多不同的增强技术，如标准化、旋转、移动、翻转、亮度变化等等。您可以在它的官方文档页面上找到更多信息。然而，使用Keras ImageDataGenerator类的主要好处是它被设计成提供实时数据扩充。这意味着当你的模型处于训练阶段时，它会生成增强图像。</p><p id="7d1c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">使用ImageDataGenerator </strong>进行图像增强<br/> ImageDataGenerator类确保模型在每个时期接收图像的新变化。但是它只返回转换后的图像，而不将它们添加到原始图像库中。事实上，如果是这样的话，那么模型将会多次看到原始图像，这肯定会超出我们的模型。<br/>imagedata generator的另一个优点是它需要更少的内存使用。这是因为没有使用这个类，我们一次加载所有的图像。但是在使用它的时候，我们是批量加载图片的，这样可以节省很多内存。</p><p id="ca37" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">支持一系列技术和像素缩放方法。我们将集中讨论图像数据的五种主要类型的数据增强技术；具体来说:</p><ul class=""><li id="5fb5" class="lo lp hi jq b jr js ju jv jx lq kb lr kf ls kj lt lu lv lw bi translated">图像通过<em class="lf"> width_shift_range </em>和<em class="lf"> height_shift_range </em>参数移动。</li><li id="5bbf" class="lo lp hi jq b jr lx ju ly jx lz kb ma kf mb kj lt lu lv lw bi translated">图像通过<em class="lf">水平翻转</em>和<em class="lf">垂直翻转</em>参数翻转。</li><li id="4c19" class="lo lp hi jq b jr lx ju ly jx lz kb ma kf mb kj lt lu lv lw bi translated">通过<em class="lf"> rotation_range </em>参数进行图像旋转</li><li id="572a" class="lo lp hi jq b jr lx ju ly jx lz kb ma kf mb kj lt lu lv lw bi translated">通过<em class="lf"> brightness_range </em>参数的图像亮度。</li><li id="8d11" class="lo lp hi jq b jr lx ju ly jx lz kb ma kf mb kj lt lu lv lw bi translated">通过<em class="lf"> zoom_range </em>参数进行图像缩放。</li></ul><p id="ee22" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">例如，可以构造ImageDataGenerator类的实例。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="md me l"/></div></figure><p id="0a3d" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><em class="lf">将生成如下所示的随机增强图像，然后将其提供给模型。</em></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mf"><img src="../Images/8b861148e44086f5b35fa4bbb4a32296.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1M6C3JDHvPz4oK-q2Q5W4g.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">使用ImageDataGenerator生成的随机图像增强</figcaption></figure><h1 id="a2a2" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">2.Pytorch</h1><p id="ec99" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">PyTorch是一个基于Python的库，有助于构建深度学习模型并在各种应用程序中使用它们。但这不仅仅是另一个深度学习库。这是一个科学计算包。</p><p id="c060" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">使用PyTorch的主要优势是我们可以对选定的图像单独应用图像增强技术。</p><p id="1523" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">从导入图像开始，我们将定义一个imshow()函数来可视化一个实际的和转换后的图像</p><p id="7f5b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> <em class="lf">缩放:</em> </strong>在缩放或调整大小时，图像被调整到给定的尺寸(例如图像的宽度可以增加一倍。)</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="md me l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mg"><img src="../Images/21e8a1fddd93ee8df925b94943da639e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jylG7v9V9TZcwXXasm_5WA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">缩放图像</figcaption></figure><p id="1cbd" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> <em class="lf">裁剪:</em> </strong>在裁剪中，选择图像的一部分，例如，在给定的例子中，返回中间裁剪的图像。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="md me l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mg"><img src="../Images/af94b54a472be906c19e83e68a17dbb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vwGEYpCMWGd9Uph-PIDC4Q.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">裁剪图像</figcaption></figure><p id="27fe" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> <em class="lf">翻转</em> : </strong>翻转时，图像水平或垂直翻转。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="md me l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mh"><img src="../Images/588622dbd8e941147edfa881c3c660b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*51pvKsqz4yHqpPJvty0X4g.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">水平翻转图像</figcaption></figure><h1 id="bf13" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">像素扩增</h1><p id="3869" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">像素增强或颜色抖动通过改变图像的像素值来改变图像的颜色属性。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="md me l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mi"><img src="../Images/b289cf3d01b7ed11ad69653924c6313c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AQlrKMZOO0C_EgljsoL8Mg.png"/></div></div></figure><h2 id="7447" class="mj kl hi bd km mk ml mm kq mn mo mp ku jx mq mr kw kb ms mt ky kf mu mv la mw bi translated">变换的合成</h2><p id="b14e" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">一起组成几个变换。此转换不支持touchscript。它只是将提供给它的所有变换组合在一起。所以所有的变换。一个接一个地应用于输入。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="md me l"/></div></figure><h1 id="24aa" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">3.蛋白沉积</h1><p id="7be0" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">Albumentations是一种计算机视觉工具，可以提高深度卷积神经网络的性能。Albumentations是一个Python库，用于快速灵活的图像增强。它有效地实现了各种各样的图像变换操作，这些操作针对性能进行了优化，同时为不同的计算机视觉任务提供了简洁而强大的图像增强接口，包括对象分类、分割和检测。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="md me l"/></div></figure><p id="0293" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"> <em class="lf">翻转</em> : </strong>翻转时，图像可以水平翻转，也可以垂直翻转。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="md me l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mx"><img src="../Images/366aaef6c74063a7fc86c976bb2a12af.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*siFaNDzq4dAwP66SjLqxWg.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">水平翻转的图像。</figcaption></figure><p id="8c34" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"><em class="lf">shift scale rotate</em>:</strong>翻转时，图像可以在给定范围内任意缩放和旋转。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="md me l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mx"><img src="../Images/c14e53ef4939b6bacd35596d1d0cfb42.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*0w6SApbHsWmRiwoQPatwOg.png"/></div></figure><h2 id="a13f" class="mj kl hi bd km mk ml mm kq mn mo mp ku jx mq mr kw kb ms mt ky kf mu mv la mw bi translated">在白蛋白中合成增强剂</h2><p id="21ab" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">Compose接收到一个列表，其中包含多个增强，例如:A.RandomCrop、A.HorizontalFlip、A.RandomBrightnessContrast等，在这些增强的帮助下，我们可以在一次运行中执行各种增强技术。让我们看一个使用白蛋白库构建增强例子。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="md me l"/></div></figure><p id="c9d8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在上面的代码中，我们使用了使用随机裁剪和随机颜色抖动的合成增强。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es my"><img src="../Images/a44ca02b554231d2b8f7b0d26c91eb30.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*qDKgQeGMO39HptWkJ7RF5Q.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">使用合成增强创建的图像</figcaption></figure><h1 id="5159" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">摘要</h1><p id="c116" class="pw-post-body-paragraph jo jp hi jq b jr lj ij jt ju lk im jw jx ll jz ka kb lm kd ke kf ln kh ki kj hb bi translated">在本教程中，您发现了如何在训练深度学习神经网络时使用图像数据增强。</p><p id="b89c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">具体来说，我们了解到:</p><ul class=""><li id="4806" class="lo lp hi jq b jr js ju jv jx lq kb lr kf ls kj lt lu lv lw bi translated">图像数据扩充用于扩展训练数据集，以提高模型的性能和泛化能力。</li><li id="1c6b" class="lo lp hi jq b jr lx ju ly jx lz kb ma kf mb kj lt lu lv lw bi translated">Keras、PyTorch、Albumentation深度学习库中支持图像数据增强。</li></ul><p id="6acc" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">感谢您的贡献。</p><h1 id="4711" class="kk kl hi bd km kn ko kp kq kr ks kt ku io kv ip kw ir kx is ky iu kz iv la lb bi translated">参考</h1><ol class=""><li id="2712" class="lo lp hi jq b jr lj ju lk jx mz kb na kf nb kj nc lu lv lw bi translated"><a class="ae jn" href="https://keras.io/api/preprocessing/image/" rel="noopener ugc nofollow" target="_blank">https://keras.io/api/preprocessing/image/</a></li><li id="c0be" class="lo lp hi jq b jr lx ju ly jx lz kb ma kf mb kj nc lu lv lw bi translated"><a class="ae jn" href="https://machinelearningmastery.com/how-to-configure-image-data-augmentation-when-training-deep-learning-neural-networks/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/how-to-configure-image-data-augmentation-when-training-deep-learning-neural-networks/</a></li><li id="8094" class="lo lp hi jq b jr lx ju ly jx lz kb ma kf mb kj nc lu lv lw bi translated"><a class="ae jn" href="https://iq.opengenus.org/data-augmentation/" rel="noopener ugc nofollow" target="_blank">https://iq.opengenus.org/data-augmentation/</a></li><li id="615e" class="lo lp hi jq b jr lx ju ly jx lz kb ma kf mb kj nc lu lv lw bi translated"><a class="ae jn" href="https://albumentations.ai/" rel="noopener ugc nofollow" target="_blank">https://albumentations.ai/</a></li></ol></div></div>    
</body>
</html>