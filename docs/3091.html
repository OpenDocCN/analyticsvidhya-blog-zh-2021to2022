<html>
<head>
<title>Data Augmentation for Text [with code]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">文本的数据扩充[带代码]</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-augmentation-for-text-with-code-6da46aad443d?source=collection_archive---------3-----------------------#2021-06-06">https://medium.com/analytics-vidhya/data-augmentation-for-text-with-code-6da46aad443d?source=collection_archive---------3-----------------------#2021-06-06</a></blockquote><div><div class="es gk gl gm gn go"/><div class="gp gq gr gs gt"><div class=""/><figure class="ec ee hu hv hw hx dy dz paragraph-image"><div role="button" tabindex="0" class="hy hz di ia bf ib"><div class="dy dz ht"><img src="../Images/673a08f2dec8b295cd7891fed8f74fa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1lM_z3cZjAN-Vm3qAijfIQ.jpeg"/></div></div><figcaption class="ie if ea dy dz ig ih bd b be z ft translated">图片来自<a class="ae ii" href="https://unsplash.com/@randyfath" rel="noopener ugc nofollow" target="_blank"> unsplash </a></figcaption></figure><p id="f76f" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated">本文将展示如何在PyTorch中编码，数据增强技术用于深度学习问题，如文本分类、文本生成等。</p><p id="d8d1" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated">对于与图像相关的数据增强问题，可以在这里 找到实现<a class="ae ii" rel="noopener" href="/analytics-vidhya/learn-to-code-in-tensorflow2-fe735ad46826?source=friends_link&amp;sk=e112de37ddacbf54982daf7eb803f1fe"> <strong class="il gx">。</strong></a></p><h1 id="7302" class="jh ji gw bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke bi translated">数据扩充技术</h1><h2 id="07c5" class="kf ji gw bd jj kg kh ki jn kj kk kl jr iu km kn jv iy ko kp jz jc kq kr kd ks bi translated">1.回译</h2><h2 id="346a" class="kf ji gw bd jj kg kh ki jn kj kk kl jr iu km kn jv iy ko kp jz jc kq kr kd ks bi translated">2.随机插入</h2><h2 id="ee02" class="kf ji gw bd jj kg kh ki jn kj kk kl jr iu km kn jv iy ko kp jz jc kq kr kd ks bi translated">3.随机删除</h2><h2 id="5655" class="kf ji gw bd jj kg kh ki jn kj kk kl jr iu km kn jv iy ko kp jz jc kq kr kd ks bi translated">4.随机交换</h2><p id="ca74" class="pw-post-body-paragraph ij ik gw il b im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc kx je jf jg gp bi translated"><strong class="il gx">注</strong>:文本的数据扩充是一个代价很高的操作，如果我们试图在训练循环中使用它，将会显著增加训练时间。与图像不同，对于文本增强，首先，我们需要替换单词，然后对该单词使用相关单词嵌入。因此，我们将事先创建一个增强，并在训练中使用它。</p><p id="2ac9" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated">我已经为英语做了数据扩充，但是这些技术是语言不可知的。</p><h1 id="7eef" class="jh ji gw bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke bi translated">回译</h1><p id="a620" class="pw-post-body-paragraph ij ik gw il b im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc kx je jf jg gp bi translated">这个想法是让不同的句子表达相同的意思来进行训练。</p><p id="015a" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated"><strong class="il gx">第一步</strong>:选择英文句子。</p><pre class="ky kz la lb ek lc ld le lf aw lg bi"><span id="026f" class="kf ji gw ld b ev lh li l lj lk">The Best Way To Get Started Is To Quit Talking And Begin Doing.</span></pre><p id="4c62" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated"><strong class="il gx">步骤2 </strong>:选择一种随机语言(朝鲜语)，并使用语言翻译将句子转换成该语言。</p><pre class="ky kz la lb ek lc ld le lf aw lg bi"><span id="58bb" class="kf ji gw ld b ev lh li l lj lk">시작하는 가장 좋은 방법은 말하기를 그만두고 시작하는 것입니다.</span></pre><p id="f27e" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated"><strong class="il gx">第三步:</strong>现在把它翻译回英文。</p><pre class="ky kz la lb ek lc ld le lf aw lg bi"><span id="32d2" class="kf ji gw ld b ev lh li l lj lk">The best way to start is to stop talking and start.</span></pre><p id="65ce" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated">现在，你可以看到你的句子意思相同，但结构不同。</p><p id="e8e0" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated">为了实现这一点，我们不需要训练语言翻译模型，但我们可以利用<strong class="il gx">谷歌翻译</strong>。</p><p id="2f02" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated">让我们安装所需的库:</p><pre class="ky kz la lb ek lc ld le lf aw lg bi"><span id="dcf8" class="kf ji gw ld b ev lh li l lj lk">sudo pip install google_trans_new</span></pre><p id="941f" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated">让我们编码:</p><figure class="ky kz la lb ek hx"><div class="bz ll l di"><div class="lm ln l"/></div></figure><p id="476b" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated">请记住，在使用谷歌翻译API时，你可以转换的句子数量是有限制的。所以有2种处理方式:<br/> 1。获取API <br/> 2的付费订阅。多次对数据集进行数据扩充。比方说如果800个电话是极限，那么就对800个句子进行数据扩充并保存它。过一段时间后，再对接下来的800个句子进行扩充，以此类推。</p><h1 id="bb34" class="jh ji gw bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke bi translated">随机插入</h1><p id="efb9" class="pw-post-body-paragraph ij ik gw il b im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc kx je jf jg gp bi translated">这里的想法是找到句子中的非停用词，并随机用它们的同义词替换几个词。</p><p id="fc3b" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated"><strong class="il gx">第一步</strong>:选择英文句子。</p><pre class="ky kz la lb ek lc ld le lf aw lg bi"><span id="c890" class="kf ji gw ld b ev lh li l lj lk">The Best Way To Get Started Is To Quit Talking And Begin Doing.</span></pre><p id="4e86" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated">第二步:过滤掉停用词。</p><pre class="ky kz la lb ek lc ld le lf aw lg bi"><span id="78b8" class="kf ji gw ld b ev lh li l lj lk">["Best", "Way", "Started", "Quit", "Talking", "Begin", "Doing"]</span></pre><p id="b44d" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated"><strong class="il gx">第三步</strong>:随机选择3个单词，找出它们最接近的同义词。</p><pre class="ky kz la lb ek lc ld le lf aw lg bi"><span id="7c81" class="kf ji gw ld b ev lh li l lj lk">words = ["Way", "Quit", "Talking"]<br/>synonyms = ["Method", "Leave", "Speaking"]</span></pre><p id="96e0" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated"><strong class="il gx">第四步</strong>:替换原句中的那些词。</p><pre class="ky kz la lb ek lc ld le lf aw lg bi"><span id="ec89" class="kf ji gw ld b ev lh li l lj lk">The Best <strong class="ld gx">Method</strong> To Get Started Is To <strong class="ld gx">Leave</strong> <strong class="ld gx">Speaking </strong>And Begin Doing.</span></pre><p id="3e19" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated">为了实现这一点，我们可以使用现有的预训练单词嵌入。然而，为了获得更好的结果，您应该使用定制的单词嵌入或语言模型。</p><p id="be28" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated">下载并提取300维的Google word2vec。</p><pre class="ky kz la lb ek lc ld le lf aw lg bi"><span id="a589" class="kf ji gw ld b ev lh li l lj lk">wget -c "https://s3.amazonaws.com/dl4j-distribution/GoogleNews-vectors-negative300.bin.gz"<br/>gzip -d GoogleNews-vectors-negative300.bin.gz</span></pre><p id="e53a" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated">让我们编码:</p><figure class="ky kz la lb ek hx"><div class="bz ll l di"><div class="lm ln l"/></div></figure><p id="9868" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated">这可以一次性完成，但仍需要时间来生成所有数据集。</p><h1 id="d39b" class="jh ji gw bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke bi translated">随机删除</h1><p id="3a84" class="pw-post-body-paragraph ij ik gw il b im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc kx je jf jg gp bi translated">这里的想法是从句子中随机删除几个单词。</p><p id="209a" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated"><strong class="il gx">第一步</strong>:选择一个句子</p><pre class="ky kz la lb ek lc ld le lf aw lg bi"><span id="7ec6" class="kf ji gw ld b ev lh li l lj lk">The Best Way To Get Started Is To Quit Talking And Begin Doing.</span></pre><p id="dc59" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated"><strong class="il gx">第二步</strong>:给所有单词分配随机概率</p><pre class="ky kz la lb ek lc ld le lf aw lg bi"><span id="19b0" class="kf ji gw ld b ev lh li l lj lk">0.3 The <br/><strong class="ld gx">0.2 Best <br/></strong>0.3 Way <br/>0.8 To <br/>0.8 Get <br/>0.3 Started <br/>0.7 Is <br/><strong class="ld gx">0.2 To <br/></strong>0.3 Quit <br/>0.9 Talking <br/>0.4 And <br/>0.4 Begin <br/>0.9 Doing.</span></pre><p id="a536" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated"><strong class="il gx">第三步</strong>:去掉所有得分低于0.3的单词</p><pre class="ky kz la lb ek lc ld le lf aw lg bi"><span id="ca88" class="kf ji gw ld b ev lh li l lj lk">The Way To Get Started Is Quit Talking And Begin Doing.</span></pre><p id="de3e" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated">让我们编码:</p><figure class="ky kz la lb ek hx"><div class="bz ll l di"><div class="lm ln l"/></div></figure><h1 id="cdc4" class="jh ji gw bd jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke bi translated">随机交换</h1><p id="696f" class="pw-post-body-paragraph ij ik gw il b im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc kx je jf jg gp bi translated">这里的想法是一次随机选择两个单词，并交换它们在句子中的位置。这可以做n次。</p><p id="027a" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated"><strong class="il gx">第一步</strong>:选择句子</p><pre class="ky kz la lb ek lc ld le lf aw lg bi"><span id="a2a7" class="kf ji gw ld b ev lh li l lj lk">The Best Way To Get Started Is To Quit Talking And Begin Doing.</span></pre><p id="5f93" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated"><strong class="il gx">第二步</strong>:选择单词并交换</p><pre class="ky kz la lb ek lc ld le lf aw lg bi"><span id="0c11" class="kf ji gw ld b ev lh li l lj lk">The Started Way To Get Quit Is To Best Talking And Begin Doing.</span></pre><p id="ac1d" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated">让我们编码:</p><figure class="ky kz la lb ek hx"><div class="bz ll l di"><div class="lm ln l"/></div></figure><p id="88a8" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated">一旦我们准备好了所有的数据，我们就可以开始训练了。上面定义的所有方法都是通用方法。要将其应用于数据集，首先需要了解数据集，然后应用定制的增强技术。</p><p id="ece8" class="pw-post-body-paragraph ij ik gw il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg gp bi translated">这些技术也可以混合使用。</p></div></div>    
</body>
</html>