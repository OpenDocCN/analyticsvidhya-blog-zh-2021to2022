<html>
<head>
<title>Step-by-Step: Web Scraping Every Line from “The Office” in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">循序渐进:用Python从“办公室”中抓取每一行</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/step-by-step-web-scraping-every-line-from-the-office-in-python-3b28768c56f4?source=collection_archive---------5-----------------------#2021-07-28">https://medium.com/analytics-vidhya/step-by-step-web-scraping-every-line-from-the-office-in-python-3b28768c56f4?source=collection_archive---------5-----------------------#2021-07-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="7a38" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">网络抓取有助于自动提取网站上的数据。虽然通过API收集数据是首选，但当API不可用时，web抓取可能是一种可能的解决方案。</p><p id="f455" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面，我们将演练使用Python从热播电视剧《办公室》中抓取每一行的步骤。如果这篇文章对你有帮助，如果你有问题，或者有错误，请在下面的评论区告诉我！</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/7dcf34ee101c2581fe0116c395883269.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cGXkpmIfF3_Dv4kewfPm7Q.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">图片来自:<a class="ae js" href="https://www.gannett-cdn.com/presto/2020/03/23/USAT/4d323821-630c-4af2-81aa-6daab94a1213-Ryan_then.jpeg" rel="noopener ugc nofollow" target="_blank">https://www . Gannett-cdn . com/presto/2020/03/23/USAT/4d 323821-630 c-4a F2-81aa-6 daab 94 a 1213-Ryan _ then . JPEG</a></figcaption></figure><h1 id="2bb1" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">第一步:浏览网站</h1><p id="d7bc" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">首先，让我们回顾一下我们要刮的网站:【https://www.officequotes.net/<a class="ae js" href="https://www.officequotes.net/" rel="noopener ugc nofollow" target="_blank">。在网站的左边，你会看到一个专栏，里面有第1-9季的每一集。</a></p><p id="d3e6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，让我们点击<a class="ae js" href="https://www.officequotes.net/no1-01.php" rel="noopener ugc nofollow" target="_blank">第一集:先导</a>。然后回去点开<a class="ae js" href="https://www.officequotes.net/no1-02.php" rel="noopener ugc nofollow" target="_blank">第二集:多样性日</a>。<strong class="ig hi">注意网址如何从</strong><a class="ae js" href="https://www.officequotes.net/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">officequotes.net/</strong></a><a class="ae js" href="https://www.officequotes.net/no1-01.php" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">no1-01.php</strong></a><strong class="ig hi">到</strong><a class="ae js" href="https://www.officequotes.net/" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">officequotes.net/</strong></a><a class="ae js" href="https://www.officequotes.net/no1-02.php" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">no1-02.php</strong></a><strong class="ig hi">。我把它加粗是因为它很重要。注意相似和不同之处。现在回到第一集。在这一页的中间，你会看到我们正在寻找的数据:第一集的每一行以及哪个角色说的。</strong></p><p id="6f1d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们可以物理地<em class="kw">看到</em>数据，让我们看看网站如何使用开发者工具(Dev Tools)呈现数据！</p><p id="1a73" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在<a class="ae js" href="https://www.officequotes.net/no1-01.php" rel="noopener ugc nofollow" target="_blank">第1集:Pilot </a>中，如果你在Windows上键入:Ctrl + Shift + J。如果你在Mac上键入:Cmd+Shift+c。Up应该弹出开发工具。为了确保我们在同一个地方，让我们点击“元素”选项卡(这显示了网站上的HTML和JavaScript)。现在，单击光标所在的方块，并找到一些引号所在的HTML div/class。</p><p id="1545" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你迷失了这些指示，你可以跟随这个gif:</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="kx ky l"/></div></figure><p id="bb01" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当我们使用Dev工具进一步查看页面时，<strong class="ig hi">您会看到每一行的演讲者都是加粗的(HTML中有&lt;b&gt;T6】Character _ Name&lt;/b&gt;),然后每个引用都有纯文本。这是我们要收集的数据。</strong></p><h1 id="c66a" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">第二步:清理办公室的第一至第四季</h1><p id="f6e6" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">对于这个例子，我们将去掉办公室的前四个季节(当然，如果你愿意的话，包含所有九个季节会相对容易些)。</p><p id="858a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我会解释每一行的目的，然后向您展示完整的程序。</p><p id="658e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">get _ all _ lines _ from _ the _ office . py:</strong></p><ul class=""><li id="d2c2" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb le lf lg lh bi translated"><code class="du li lj lk ll b">line 1–5</code>我们导入<a class="ae js" href="https://stackoverflow.com/questions/6908143/should-i-put-shebang-in-python-scripts-and-what-form-should-it-take" rel="noopener ugc nofollow" target="_blank"> shebang </a>和我们的库:<a class="ae js" href="https://docs.python-requests.org/en/master/" rel="noopener ugc nofollow" target="_blank"> requests </a>、<a class="ae js" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" rel="noopener ugc nofollow" target="_blank"> BeautifulSoup </a>和<a class="ae js" href="https://pandas.pydata.org/docs/user_guide/index.html" rel="noopener ugc nofollow" target="_blank"> Pandas </a>。</li><li id="036c" class="kz la hh ig b ih lm il ln ip lo it lp ix lq jb le lf lg lh bi translated"><code class="du li lj lk ll b">line 7–41</code>实际抓取数据并以列表形式返回。特别注意我们是如何根据季节和剧集制作base_url、half_of_url和full_url的。我们还包括了一些错误检查来忽略任何404错误消息。最后，您会注意到我们使用BeautifulSoup来查找每个“b”标签，并使用一个临时字典来存储角色、台词、季节和剧集编号。</li><li id="41e9" class="kz la hh ig b ih lm il ln ip lo it lp ix lq jb le lf lg lh bi translated"><code class="du li lj lk ll b">line 43–46</code>简单地把数据列表改成熊猫数据框，以便于清理。</li><li id="8c4a" class="kz la hh ig b ih lm il ln ip lo it lp ix lq jb le lf lg lh bi translated"><code class="du li lj lk ll b">line 48–70</code>尝试清除每一行和任何拼写错误的字符。</li><li id="24f5" class="kz la hh ig b ih lm il ln ip lo it lp ix lq jb le lf lg lh bi translated"><code class="du li lj lk ll b">line 72–79</code>实际上运行所有的功能并打印出我们清理过的熊猫数据帧，包括《办公室》第一季到第四季的每一行(包括删除的场景)！</li></ul><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="lr ky l"/></div></figure><h1 id="f414" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">轮到您探索更多了！</h1><ul class=""><li id="35bd" class="kz la hh ig b ih kr il ks ip ls it lt ix lu jb le lf lg lh bi translated">你最喜欢的电视节目或电影是什么？我相信你可以找到一个网站，让你合法地刮每一行</li><li id="aa40" class="kz la hh ig b ih lm il ln ip lo it lp ix lq jb le lf lg lh bi translated">刮干净办公室的所有9个季节，进行更深层次的清洁</li><li id="d55f" class="kz la hh ig b ih lm il ln ip lo it lp ix lq jb le lf lg lh bi translated">这些数据对于数据分析和NLP项目非常有用</li><li id="5c59" class="kz la hh ig b ih lm il ln ip lo it lp ix lq jb le lf lg lh bi translated">将这些数据放在一个SQL表中，并从那里查询结果</li></ul><p id="1eb9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">感谢阅读！欢迎评论，如果你想要YouTube教程，请告诉我。你可以在GitHub repo 上了解这个项目的更多信息。</p><p id="654a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">想保持联系吗？在<a class="ae js" href="https://www.linkedin.com/in/dan-blevins/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上和我联系！</p></div></div>    
</body>
</html>