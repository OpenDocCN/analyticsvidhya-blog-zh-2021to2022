<html>
<head>
<title>Linear Regression A-Z (Using Car Price Prediction dataset)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">线性回归A-Z(使用汽车价格预测数据集)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/linear-regression-a-z-using-car-price-prediction-dataset-e32b50c7a561?source=collection_archive---------2-----------------------#2021-03-23">https://medium.com/analytics-vidhya/linear-regression-a-z-using-car-price-prediction-dataset-e32b50c7a561?source=collection_archive---------2-----------------------#2021-03-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b57c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">线性回归是一种用直线解释因变量(Y)和一个或多个解释变量(X)之间关系的方法。这是回归分析的一个特例。线性回归是第一种被严格研究的回归分析。</p><p id="a20b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果用于正确的问题，这是一个最简单但非常强大的算法。</p><p id="f58a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们会看看这个算法的方方面面:<br/> 1。<strong class="ih hj">使用线性回归的条件</strong><br/>2。<strong class="ih hj">假设</strong> <br/> 3。<strong class="ih hj">目标</strong>目标<br/> 4。<strong class="ih hj">方程</strong>为<strong class="ih hj"> </strong>线性回归<br/> 5。<strong class="ih hj">推断</strong>不同型号<strong class="ih hj">输出</strong> <br/> 6。<strong class="ih hj">评估</strong>模型</p><p id="f021" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将使用“<strong class="ih hj">汽车价格预测</strong>”数据集来研究所有这些概念<strong class="ih hj">(实际上是</strong>)。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/37c55a0595c072ff7a8634e9bfe07c37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dIjI46w5LEGwddzY4yi8fw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">线性回归</figcaption></figure><blockquote class="jt ju jv"><p id="b9a7" class="if ig jw ih b ii ij ik il im in io ip jx ir is it jy iv iw ix jz iz ja jb jc hb bi translated">1.<strong class="ih hj">使用线性回归的强制条件</strong>。</p></blockquote><ul class=""><li id="2be3" class="ka kb hi ih b ii ij im in iq kc iu kd iy ke jc kf kg kh ki bi translated">目标变量“Y”应该是连续的数字。</li></ul><blockquote class="jt ju jv"><p id="43d6" class="if ig jw ih b ii ij ik il im in io ip jx ir is it jy iv iw ix jz iz ja jb jc hb bi translated">2.<strong class="ih hj">假设</strong>为线性回归。<br/> * <strong class="ih hj">注意</strong> *:这些并不是硬性的规则，只是一些假设，这些假设将表明模型的一切都很好。</p></blockquote><ul class=""><li id="c128" class="ka kb hi ih b ii ij im in iq kc iu kd iy ke jc kf kg kh ki bi translated"><strong class="ih hj">假设1 : </strong>自变量“X”与因变量“Y”之间存在线性关系。</li><li id="e2d6" class="ka kb hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated"><strong class="ih hj">假设2 : </strong>自变量“X”之间的最小共线性。</li><li id="a777" class="ka kb hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated"><strong class="ih hj">假设3 : </strong>误差项呈正态分布，它们之间没有模式。</li><li id="fd92" class="ka kb hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated"><strong class="ih hj">假设4 : </strong>同方差:-回归线周围的方差对于所有自变量“X”都是相同的。</li></ul><p id="9fb4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一旦我们根据我们的数据建立了模型，我们将检查所有这些假设。现在让我们从数据集开始。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ko"><img src="../Images/198b820868fda2632b58b0476b80f7cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wsur75CIrH4fpFSoGLA2og.png"/></div></div></figure><ul class=""><li id="b66b" class="ka kb hi ih b ii ij im in iq kc iu kd iy ke jc kf kg kh ki bi translated">正如我们所见，数据集由205行和26列组成。 <br/>列“<strong class="ih hj">价格</strong>”是我们的<strong class="ih hj">目标变量(Y) </strong>和25列，如燃料类型、轴距、发动机类型等，它们给出了汽车各种属性的信息。</li></ul><blockquote class="jt ju jv"><p id="b5a0" class="if ig jw ih b ii ij ik il im in io ip jx ir is it jy iv iw ix jz iz ja jb jc hb bi translated"><strong class="ih hj">这样我们的初始条件就满足了，因为我们的目标变量是数值型的、连续的</strong>我们可以向前推进，对它进行线性回归。</p></blockquote></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><blockquote class="jt ju jv"><p id="2e7d" class="if ig jw ih b ii ij ik il im in io ip jx ir is it jy iv iw ix jz iz ja jb jc hb bi translated"><strong class="ih hj">准备数据</strong></p></blockquote><p id="4be2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">执行数据清理和准备，为线性回归准备数据。数据有一些问题，例如:有过一些<strong class="ih hj">古怪的性格“？”</strong>在某些栏目中，需要查找和删除。<br/> 2。处理<strong class="ih hj">缺失值</strong> :-使用中位数估算数字列，使用Mode估算分类列。<br/> 3。<strong class="ih hj">将</strong>列转换为<strong class="ih hj">正确的数据类型</strong> :-具有“？”的列最初是int，但是由于这个奇怪的字符，它们被作为Object出现。<br/> 4。<strong class="ih hj">标记编码器</strong> :-使数据数值化。<br/> 5。<strong class="ih hj">训练和测试中的取样</strong></p><p id="f9ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">我不会在这里解释它们，我们将只关注线性回归。但是，请找到该笔记本的链接，其中解释了所有这些步骤。</strong></p></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><p id="2925" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于我们的数据已经过预处理并为模型做好了准备，让我们检查一些<strong class="ih hj">假设</strong>:</p><blockquote class="jt ju jv"><p id="6d6a" class="if ig jw ih b ii ij ik il im in io ip jx ir is it jy iv iw ix jz iz ja jb jc hb bi translated"><strong class="ih hj">假设1 </strong>:自变量“<strong class="ih hj"> X </strong>”与因变量“<strong class="ih hj"> Y </strong>”之间存在<strong class="ih hj">线性关系</strong>。我们将使用Python提供的Corr()方法来检查这一点。</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kw"><img src="../Images/d09ad6d9abf669fcf6369c8689ee3077.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*Jd7oi8jma9V-4IkANBPJ_w.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">X和Y之间的相关性</figcaption></figure><p id="d186" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里突出显示的单元格显示了引擎大小和价格之间的关系。同样，我们可以看到不同X变量与Y变量之间的相关性，即价格。我们可以看到，大部分X与Y相关，即它们具有线性关系，所以我们可以认为这个假设是满足的。</p><blockquote class="jt ju jv"><p id="ceba" class="if ig jw ih b ii ij ik il im in io ip jx ir is it jy iv iw ix jz iz ja jb jc hb bi translated"><strong class="ih hj">假设2 </strong>:自变量“X”间最小<strong class="ih hj">多重共线性</strong>。</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kx"><img src="../Images/ee7951c90054a737ba4c637a76e865af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6rLe2VTudZMxUWWbnJnh8Q.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">所有变量的相关矩阵。</figcaption></figure><p id="61d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从图中我们可以得出结论，在我们的X变量中不存在多重共线性的问题。所以这个假设也成立。</p></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><p id="1db8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">假设3和4可以在我们建立模型后检查，所以让我们继续建立模型。现在让我们只计算误差并检查假设。在此之后，我们将研究模型性能验证。</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ky"><img src="../Images/8af5d5372ad0aa070b0860040048d0cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*x9cisThrKNXL67BE5y3j2A.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">训练模型、预测和计算误差的标准步骤。</figcaption></figure></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><blockquote class="jt ju jv"><p id="0d29" class="if ig jw ih b ii ij ik il im in io ip jx ir is it jy iv iw ix jz iz ja jb jc hb bi translated"><strong class="ih hj">假设3 </strong> : <strong class="ih hj">错误项呈正态分布</strong>且其中没有<strong class="ih hj">模式</strong>。</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kz"><img src="../Images/82ccf6f6b072166635f6e40979f4a485.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*DkpXuIZJXBJdDEcNDV2hSg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">检查误差分布。</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es la"><img src="../Images/31aa9ea33d5b69ba78cb201e7c57cda7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*Z1OMjCS-iSs4e5ImWaREdw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">检查错误中的任何模式。</figcaption></figure><p id="e2a8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个分布看起来是正态的，不完美，但是足够好了。<br/>错误中似乎也没有任何模式。有一些异常值，但我已经在笔记本中处理了它们，如果有兴趣，请参考相同的内容。<br/>所以我们可以说<strong class="ih hj">假设3是满足的。</strong></p><blockquote class="jt ju jv"><p id="96d6" class="if ig jw ih b ii ij ik il im in io ip jx ir is it jy iv iw ix jz iz ja jb jc hb bi translated"><strong class="ih hj">假设4 </strong> : <strong class="ih hj">同方差</strong>:回归线周围的方差对所有自变量“X”都相同。</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lb"><img src="../Images/4f760ea6b3112e2aa0f3061c0c63d511.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*yr-IFWF-N7UbykN-hs8XZw.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">检查回归线周围的方差。</figcaption></figure><p id="babb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">蓝色高亮显示的是线周围的差异，有一些差异，但这是很好的，因为模型不会是完美的。所以，我们可以说<strong class="ih hj">假设4 </strong>得到了满足。</p><p id="fd7e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于所有的假设现在都是真的，我们可以自信地说，线性回归将在给定的数据集上表现良好！！</p></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><blockquote class="jt ju jv"><p id="6403" class="if ig jw ih b ii ij ik il im in io ip jx ir is it jy iv iw ix jz iz ja jb jc hb bi translated">现在，让我们后退一步，看看线性回归到底是什么，方程<strong class="ih hj">、<strong class="ih hj">目标</strong>以及如何推断模型输出。</strong></p></blockquote><p id="1f69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">我一直等到现在，而不是更早，因为现在我们的模型已经准备好了，我们可以研究我们模型的理论和实际输出，并真正理解正在发生的事情。</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lc"><img src="../Images/b0a5f1205bffacf32814cab278e23ca7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K12PthJyCK-lsdDYvPMNHw.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">多元线性回归方程</figcaption></figure><ul class=""><li id="3377" class="ka kb hi ih b ii ij im in iq kc iu kd iy ke jc kf kg kh ki bi translated"><strong class="ih hj"> - Y </strong>:目标变量。<br/>-<strong class="ih hj">0</strong>:线的截距。<br/>-<strong class="ih hj">0</strong>:回归系数。<br/> - <strong class="ih hj"> Xi </strong>:输入特征。</li><li id="80c7" class="ka kb hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated"><strong class="ih hj">“I”表示“Xi”的1个单位的变化对目标变量“Y”的影响有多大。</strong></li></ul><p id="75b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">主要<strong class="ih hj">目标</strong>如果找到<strong class="ih hj">0，i </strong>即<strong class="ih hj">最佳拟合回归线</strong>。<br/>最佳拟合回归线就是误差最小的<strong class="ih hj">线</strong>。</p><p id="68c6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里使用的<strong class="ih hj">误差函数</strong>是<strong class="ih hj"> MSE(均方误差):</strong> - <br/>(误差=实际-预测)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ld"><img src="../Images/7bc26ba4983ac1a5cbf05ab2c430d1c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*LByb1oTSQoYFUazdHLpoMA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">从模型中查找<strong class="bd le">0，i </strong>。</figcaption></figure><p id="da51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经使用了我们的模型，并得到了最佳拟合线。并且从中可以看出:-<br/><strong class="ih hj">0</strong>:-55465.16338267594<br/><strong class="ih hj">1</strong>:1.94262470 e+02σ2:-1.78293505 e+01σ3:-3.11714543 e+03…n</p><p id="1c6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以用这条回归线:<br/><strong class="ih hj">y =-55465.16338267594+1.94262470 e+02 * x1+-1.78293505 e+01 * x2<strong class="ih hj">预测</strong>新值<strong class="ih hj">..+ 5.44607468e+01*xn。</strong> <br/>同:<strong class="ih hj">y = 0+1 . x1+2 . x2+…..+n . xn</strong></strong></p></div><div class="ab cl kp kq gp kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="hb hc hd he hf"><blockquote class="jt ju jv"><p id="4d9e" class="if ig jw ih b ii ij ik il im in io ip jx ir is it jy iv iw ix jz iz ja jb jc hb bi translated">我们现在处于最后一步，即<strong class="ih hj">评估</strong>模型。</p><p id="3a3d" class="if ig jw ih b ii ij ik il im in io ip jx ir is it jy iv iw ix jz iz ja jb jc hb bi translated"><strong class="ih hj"> R </strong> - <strong class="ih hj">平方:- </strong>评价车型最重要的一个方面<strong class="ih hj">。</strong></p></blockquote><p id="ba0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> R </strong> - <strong class="ih hj">平方:</strong>它<strong class="ih hj"> </strong>度量的是一个线性回归模型中你的因变量(Y) <strong class="ih hj">由你的自变量(X)解释</strong>的变化比例。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lf"><img src="../Images/67b513f1b0c9bd904a274af4b6f09217.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*2St0j5XfN1OQEpgDZfWW2A.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated"><strong class="bd le"> R </strong> - <strong class="bd le">广场为我们的模型。</strong></figcaption></figure><p id="12b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的<strong class="ih hj">R</strong>-<strong class="ih hj">square =</strong>0.9090492008852977。我们这样理解是因为我们的模型能够解释“Y”变量引起的90%的变化。</p><p id="017f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">关于R-square的问题</strong>:即使我们在模型中加入无关紧要的“X”变量，R-square的得分也会增加。<br/> <strong class="ih hj">举例</strong>:如果增加一个变量“<strong class="ih hj"> Colour_of_car </strong>”，预测一辆车的<strong class="ih hj">里程</strong>。理想情况下，这不会对<strong class="ih hj">里程</strong>产生任何影响，但在添加该变量后，R平方得分仍会增加。使用<strong class="ih hj">调整后的R </strong> - <strong class="ih hj">平方</strong>来克服这个问题。</p><blockquote class="jt ju jv"><p id="b1ad" class="if ig jw ih b ii ij ik il im in io ip jx ir is it jy iv iw ix jz iz ja jb jc hb bi translated"><strong class="ih hj">调整后的R </strong> - <strong class="ih hj">平方:- </strong>基于模型中自变量数量的得分。</p></blockquote><p id="453a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">调整后的R </strong> - <strong class="ih hj">方形</strong>与<strong class="ih hj"> R </strong> - <strong class="ih hj">方形</strong>讲述的是同样的事情，但是<strong class="ih hj"> </strong>会对模型进行惩罚，如果有无关紧要的特征添加到模型中。因此克服了<strong class="ih hj"> R </strong> - <strong class="ih hj">方面临的问题。</strong></p><pre class="je jf jg jh fd lg lh li lj aw lk bi"><span id="c050" class="ll lm hi lh b fi ln lo l lp lq">Adjusted R-Square :  0.8920807682146443</span></pre><p id="3c03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于<strong class="ih hj"> R </strong> - <strong class="ih hj">正方形和调整后的R </strong> - <strong class="ih hj">正方形</strong>非常接近，这意味着我们的模型实际上没有任何无关紧要的特征。所以这是一件好事。</p><blockquote class="jt ju jv"><p id="1439" class="if ig jw ih b ii ij ik il im in io ip jx ir is it jy iv iw ix jz iz ja jb jc hb bi translated"><strong class="ih hj">结论</strong></p></blockquote><ul class=""><li id="7963" class="ka kb hi ih b ii ij im in iq kc iu kd iy ke jc kf kg kh ki bi translated">我在这里的主要目的是解释线性回归的不同方面，从模型构建的角度来看，还涉及到更多的步骤。你可以在这里的笔记本上查阅它们。</li><li id="7b72" class="ka kb hi ih b ii kj im kk iq kl iu km iy kn jc kf kg kh ki bi translated">如有任何疑问/反馈，请给我写信:darekarabhishek@gmail.com</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lr"><img src="../Images/bea00514346c7a9d8ffacbbf8a2a2845.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kd7fFD4170T4mjI5MVF6kA.jpeg"/></div></div></figure></div></div>    
</body>
</html>