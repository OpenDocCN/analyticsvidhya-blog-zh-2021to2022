<html>
<head>
<title>Tabular Data Augmentation with Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用深度学习的表格数据扩充</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/tabular-data-augmentation-with-deep-learning-7270584e7ff?source=collection_archive---------2-----------------------#2021-04-10">https://medium.com/analytics-vidhya/tabular-data-augmentation-with-deep-learning-7270584e7ff?source=collection_archive---------2-----------------------#2021-04-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/251b4719ea7a51c1e1ae4965784bddb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aMNwqNRSMXeU1ckI"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">米卡·鲍梅斯特在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="3e52" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">说到深度学习，我们拥有的数据越多，获得优秀性能模型的机会就越大。在像图像识别这样的领域，研究人员已经想出了很多聪明的主意，如何利用现有的数据来创造更多的数据。这被称为数据扩充。</p><p id="b782" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然而，当我们在表格数据上下文中查看深度学习时，仍然缺少许多概念。我想在这篇博文中展示的是一种增加表格数据的方法，我们可以使用它来在更多的表格数据上训练深度学习模型，或者可以用来创建代表性不足的类别的数据。</p><p id="bbcd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我想以图形方式展示这些新创建的数据是如何从底层数据的分布中采样的，以及这些数据如何帮助建立更好的深度学习模型。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jt"><img src="../Images/505841c27d2b1e4c75ffe010701ac41b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tPrS1qbGS8GPX0o_c5o55A.png"/></div></div></figure><p id="691e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以首先，我们需要得到一些数据。这里，我有一些关于臭名昭著的葡萄酒数据集的数据。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jy"><img src="../Images/1e7381ede0044fa9f50cb32884140878.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oy6Jt415r-43LaSONDDkHg.png"/></div></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jz"><img src="../Images/40be8bd062dc3c2a74485a57a039b4b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X0VRBNmtG0gMk5Bem_UpgQ.png"/></div></div></figure><p id="8bf8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，我们构建一个数据加载器，在其中我们还标准化了我们的数据。我们将缩放器保存在数据集中，以便在以后反转缩放时使用。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ka"><img src="../Images/4bc7bf791166c036b758d772c4307214.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*smlijRwUfkLcOjenxM5hLw.png"/></div></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kb"><img src="../Images/2ac4ec580fadf794dbe6fc48584b6d27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*he3k5-Hg-WpMa0J0JG0G6w.png"/></div></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kc"><img src="../Images/7ea3e44614c819e065f852761b385914.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1f3MFg6QDcBWY6PJZ-7QZA.png"/></div></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kb"><img src="../Images/016b117dcec110339943e63d9da5402c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SP5JIsdePjjWmorATaoWfA.png"/></div></div></figure><p id="9ab4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们已经建立了我们的训练和测试数据集，在数据加载器的帮助下，我们还将它们转化为张量。所以，现在就用deep_tabular_augmentation吧。该类需要七个输入:trainloader、testloader、运行训练的设备、输入维度(在本例中为14)以及第一个和第二个隐藏层应该有多少个节点。最后，我们还可以指定潜在因素的数量。这些潜在因素将包含所有浓缩的信息，这意味着我们可以使用这些潜在因素来重新创建原始的14个输入维度(例如，我们的数据)。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kd"><img src="../Images/2f44c5b26f049ac9e68a3176984e1a00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-SwUht1bdZ1rEmlC81tVyQ.png"/></div></div></figure><p id="7c90" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我们成功地启动了我们的模型之后，让我们对它进行训练，并将训练好的模型称为“autoenc_model_fit”。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kb"><img src="../Images/4eb5a02dda25e503c1355db988791063.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1mdL_4CM95bUrXTfFYknjA.png"/></div></div></figure><p id="9100" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们只需要根据训练好的模型创建一些假数据。工作原理如下:我们知道潜在因素的均值和方差的学习参数。然后，我们使用具有每个潜在因素的平均值和方差的正态分布，对潜在因素1、2和3的值进行采样(因为在这种情况下我们有三个潜在因素)。这些为我们的潜在因素生成的起点然后被用于向14个真实输入变量膨胀。让我们看看它是如何做到的:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ke"><img src="../Images/37e87761e040b438ff3f1544b969a1e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qora5foyLPcDTDc0bwtHAQ.png"/></div></div></figure><p id="34e3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">deep_tabular_augmentation库还有另一个方法:predict_with_noise。它的作用如下，从正态分布中取样每个元素(独立于其他元素)将乘以1加上取样数。为什么要这样做？答案是，变分自动编码器的工作方式类似于PCA，导致变量之间的关系更加明确。因此，变分自动编码器将平均值和标准偏差保持在变量内，然而，模型的训练参数已经找出变量之间的“隐藏”关系。当这些关系是线性时，变分自动编码器实际上执行PCA。我们一会儿就来看看。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="kf kg l"/></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kh"><img src="../Images/7b4759bd01d4d9759ed5c1905a00a6fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GLCi_DjofvQMPH8YIitS6g.png"/></div></div></figure><p id="67d2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们来看一下描述词，尤其是意思。你能看出真实数据和虚假数据之间的区别吗？</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es jz"><img src="../Images/b5c969625203dfa60ca205d1788a1a34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vEm7WJ6kn4NLmfW9wioajA.png"/></div></div></figure><p id="99b5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，让我们用图表来看看假数据与真实数据的对比。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ki"><img src="../Images/ce1894c2f3f0dde15cd5f94f64043713.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UjC02vhCZD2wSrTxFOHO7Q.png"/></div></div></figure><p id="6bcf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是我所说的“执行PCA”的含义。人们可以清楚地看到变分自动编码器如何给出酒精和色调关系的结构。如果我们给它加上噪声，这种关系就消失了。但是，如果我们使用3个以上的潜在因素，会发生什么呢？这是14个(=输入变量)潜在因素的结果:</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kj"><img src="../Images/4ad54b5d0b93362c6273cba9be772393.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NVOFxa5A4DjrrejA5WQOzg.png"/></div></div></figure><p id="4f3b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">同样的模式出现了。然而，当对其应用随机噪声时，结果数据看起来非常像真实数据。</p><p id="5f3e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们来看看一些分布。第一个图像总是用3个潜在因素表示结果，第二个图像用14个潜在因素表示结果。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kk"><img src="../Images/1ad23d83b2b9c8c2dffdfc17b2ec47d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*osStVxenKBSuj-_NjJplWQ.png"/></div></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kl"><img src="../Images/2caa2d651edd4ae988e4ea8c6fe4b7c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t74fb1eZQYub90ap_cTWJg.png"/></div></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es km"><img src="../Images/a142fdb75f48fcb6f893137bfed47ccf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aCYbFSRw3ItYNBqKZGsH3g.png"/></div></div></figure><p id="2bcf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们看到，当使用变分自动编码器对表格数据进行数据扩充时，它实际上已经找到了变量之间的关系。如果我们想消除这种影响，并在数据中加入随机噪声，得到的分布看起来就非常像原始的真实数据点。我们如何利用这些见解来改进机器学习/深度学习模型？我在<a class="ae iu" rel="noopener" href="/analytics-vidhya/data-augmentation-for-tabular-data-f75c94398c3e">这篇博文</a>中提到的。</p><p id="6335" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在那之前，敬请期待更多！</p><p id="4325" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">拉塞</p></div><div class="ab cl kn ko gp kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="hb hc hd he hf"><p id="8fd4" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><em class="ku">原载于2021年4月10日</em><a class="ae iu" href="https://lschmiddey.github.io/fastpages_/2021/04/10/DeepLearning_TabularDataAugmentation.html" rel="noopener ugc nofollow" target="_blank"><em class="ku">https://lschmiddey . github . io</em></a><em class="ku">。</em></p></div></div>    
</body>
</html>