<html>
<head>
<title>Beginners’ journey to machine learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">初学者的机器学习之旅</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/beginners-journey-to-machine-learning-cab614ad6ba9?source=collection_archive---------4-----------------------#2021-11-08">https://medium.com/analytics-vidhya/beginners-journey-to-machine-learning-cab614ad6ba9?source=collection_archive---------4-----------------------#2021-11-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/a3f21729ec857ac67685249d933182b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gpbm6FywG-QwrD6w.jpeg"/></div></div></figure><p id="7efe" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你好，数据科学猫回来了。</p><p id="91e5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在凯蒂通过机器学习(<a class="ae jn" href="https://dev.to/orthymarjan/data-science-for-cats-1d7k" rel="noopener ugc nofollow" target="_blank">https://dev.to/orthymarjan/data-science-for-cats-1d7k</a>)成功做出决策后，许多胡曼的朋友一直在问他这样的问题</p><ul class=""><li id="ec90" class="jo jp hh ir b is it iw ix ja jq je jr ji js jm jt ju jv jw bi translated">我了解基本知识，但是我从哪里开始编码呢？</li><li id="3105" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">从网上看懂了代码，但是怎么开始自己写代码呢？</li><li id="ceef" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">我如何组织我的项目？</li><li id="9c2d" class="jo jp hh ir b is jx iw jy ja jz je ka ji kb jm jt ju jv jw bi translated">我如何想象一个现实生活问题的解决方案？</li></ul><p id="996e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">凯蒂现在试图用现实生活中的例子来解释答案。</p><p id="fd65" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">首先，想到‘学习’这个词。Kitty希望你记住你们都是如何开始正式学习的，以及后来你是如何在现实世界中实施你的知识的。想象自己是一所学校的老师。一个新学生来了，并且注册了一个班级。你为班级准备一门课程，并相应地开始教学。你参加一些课堂测试来评估孩子们的表现。在年末，你要根据一年来所学的知识准备一次期末考试。你把试卷分发给孩子们，他们回答问题，你验证答案，看看他们学得有多好。如果他们的答案高于一定水平，他们就通过了。否则他们会失败。后来通过的人获得工作，并利用他们在学校学到的知识完成任务。例如，如果你是一名英语教师，你教孩子们语法和文学，在以后的现实生活中，他们可能不必写诗或用正确的动词形式填空，但他们会运用英语语言知识来写报告或产品文档。</p><figure class="kd ke kf kg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kc"><img src="../Images/9df34e1fb536946b292b55993b66f685.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K3oLpVij1DorYnADpgPY7g.png"/></div></div></figure><p id="fae8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">记住机器学习也是一个学习的过程。现在我们来对比一下一个学校的程序和机器学习。在我们的例子中，我们将处理一个非常小的数据集(【https://www.kaggle.com/ronitf/heart-disease-uci】T2)，其中机器学习模型将尝试根据python的一些测试报告来预测患者是否有心脏病的高风险。你也可以在R中进行类似的工作。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="bd86" class="km kn hh ki b fi ko kp l kq kr">import pandas as pd<br/>df = pd.read_csv('Heart Disease Dataset.csv')<br/>df.head()</span></pre><figure class="kd ke kf kg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ks"><img src="../Images/32f4cd775194ae9917464f0e37204d10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nHkq7Oawu51G8z9ByTZ3aQ.png"/></div></div></figure><p id="2c3b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">制定课程:</strong> <br/>首先，你要决定全年你想教学生哪些话题。你必须决定你的学生必须理解哪些主题(在这种情况下，专栏或专题)，以便学习你试图教给他的任何东西(在这种情况下，如果病人有心脏病的高风险)。你还要决定你要教他多少数据，以及你在课程的后面如何考试。您将从实际数据集中定义全年教学的“训练数据”和考试的“测试数据”。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="10d2" class="km kn hh ki b fi ko kp l kq kr">from sklearn.model_selection import train_test_split<br/><br/>feature_cols = ['age',  'sex',  'cp', 'trestbps', 'chol', 'fbs',  'restecg',  'thalach',  'exang',  'oldpeak',  'slope',  'ca', 'thal']<br/>X = df[feature_cols]<br/>y = df['target']<br/><br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.10)</span></pre><p id="de31" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里，在X_train中有训练特征，在X_test中有测试集的特征，在y_train中有训练集的目标，在y_test中有测试集的目标。这里的训考比是90%-10%。</p><p id="73c1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">学生报名:</strong> <br/>机器学习过程中的学生就是你的模型。起初，它什么都不知道。你的工作是为它制定一个合适的学习程序，以便它以后能在现实世界中表演。假设在这种情况下，我们的教学程序是SVM模式。我们声明一个名为svm的变量，并调整它的参数(就像我们采用一个线性核一样，在文档中还可以找到更多)。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="7964" class="km kn hh ki b fi ko kp l kq kr">from sklearn.svm import SVC #SVM classifier<br/>svm = SVC(kernel="linear")</span></pre><p id="421f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">教学:</strong> <br/>在我们的例子中，教学就是将数据‘拟合’到模型中。当您将训练集与模型相匹配时，它会“学习”。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="d257" class="km kn hh ki b fi ko kp l kq kr">svm.fit(X_train, y_train)</span></pre><p id="1ed7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">考试:</strong> <br/>在考试的情况下，我们的试卷是X_test。你手里已经有y_test这份试卷的正确答案了。学生将把他的答案写在另一个变量中，比如说y_pred。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="2e0f" class="km kn hh ki b fi ko kp l kq kr">y_pred = svm.predict(X_test)</span></pre><p id="5685" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">评价试卷:</strong> <br/>你已经可以理解为，可以通过比较y_test和y_pred来验证一个学生的答案，决定他是通过还是不及格。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="de40" class="km kn hh ki b fi ko kp l kq kr">from sklearn import metrics<br/>print("Accuracy:",metrics.accuracy_score(y_test, y_pred))</span></pre><p id="8e98" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">课堂测试的重要性:如果你发现你的学生期末考试没有考好，可能会发生两件事。这个学生可能一整年都没有好好学习，或者可能他学得很好，但由于某种原因，他在期末考试中表现不好。参加班级考试的重要性来了。如果这个学生一整年都没有好好学习，他的班级考试成绩就不会令人满意。如果他在课堂测试中表现良好，期末考试失败将表明其他一些问题。如果我们的准确性不令人满意，让我们使用k-fold交叉验证来检查他们的类测试性能(这有点像从训练集中抽取一些测试)。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="4b2c" class="km kn hh ki b fi ko kp l kq kr">from sklearn import model_selection<br/><br/>kfold = model_selection.KFold(n_splits=10, random_state=31)<br/>model =  SVC(kernel="linear")<br/><br/>results = model_selection.cross_val_score(model, X_train, y_train, cv=kfold)<br/>results</span></pre><p id="885b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果交叉验证结果也很差，这意味着我们“拟合不足”，意味着我们无法为我们的模型提供足够的数据来进行研究(这在我们的案例中发生了，因为我们的准确性相当一般，交叉验证结果也不是那么好)。如果不是，可能的原因是“过度拟合”，这意味着模型学习数据有点太好了(包括噪音和坏东西)。这里有一个链接，告诉你在这种情况下你可以做什么(比如改变参数什么的):<a class="ae jn" href="https://adityarohilla.com/2018/11/02/a-brief-introduction-to-support-vector-machine/" rel="noopener ugc nofollow" target="_blank">https://adityarohilla . com/2018/11/02/a-brief-introduction-to-support-vector-machine/</a>。<br/>你也可以测试同一个python库中的其他模型，如决策树、随机森林或朴素贝叶斯，看看哪一个最适合你。<br/> <strong class="ir hi">在工作中运用这些知识:</strong> <br/>你的学生在学校生活中学到的东西，他也将能够在工作中表现出来。为了让他记住他的训练，我们可以将这个训练过的模型导出到某种文件中，然后将该文件加载到系统中进行预测。通过导入模型文件，您可以轻松地将您的模型集成到使用python框架(如Flask)构建的系统中。<br/>导出、</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="24ab" class="km kn hh ki b fi ko kp l kq kr">from joblib import dump<br/><br/># dump the pipeline model<br/>dump(svm, filename="classification.joblib")</span></pre><p id="44ec" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要导入，</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="6f13" class="km kn hh ki b fi ko kp l kq kr">from joblib import load<br/><br/># load the pipeline model<br/>pipeline = load("classification.joblib")<br/>pipeline.predict([[35,  0,  2,  115,  245,  0,  0,  147,  0,  0.4,  2,  0,  2]])</span></pre><p id="d8b8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里你可以看到我们的模型预测了一个新患者的心脏病风险，这个新患者不是我们训练集的一部分，预测是[1]。以下是如何将此类文件与Flask集成的示例:<a class="ae jn" href="https://www.analyticsvidhya.com/blog/2020/04/how-to-deploy-machine-learning-model-flask/" rel="noopener ugc nofollow" target="_blank">https://www . analyticsvidhya . com/blog/2020/04/how-to-deploy-machine-learning-model-Flask/</a></p><figure class="kd ke kf kg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kt"><img src="../Images/34d7a67953862655d9f170930f961b57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9CRuxNSS-1vRCfYWCoh6-A.png"/></div></div></figure><p id="dfd1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这里，我将按顺序重写代码，这样，如果你是新手，它会变得更加清晰。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="7e9d" class="km kn hh ki b fi ko kp l kq kr">from sklearn.model_selection import train_test_split<br/>from sklearn.svm import SVC #SVM classifier<br/>from sklearn import metrics<br/><br/>feature_cols = ['age',  'sex',  'cp', 'trestbps', 'chol', 'fbs',  'restecg',  'thalach',  'exang',  'oldpeak',  'slope',  'ca', 'thal']<br/>X = df[feature_cols]<br/>y = df['target']<br/><br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.10)<br/>svm = SVC(kernel="linear")<br/>svm.fit(X_train, y_train)<br/>y_pred = svm.predict(X_test)<br/>print("Accuracy:",metrics.accuracy_score(y_test, y_pred))</span></pre></div><div class="ab cl ku kv go kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ha hb hc hd he"><p id="5f0a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="lb">原载于2021年11月8日</em><a class="ae jn" href="https://dev.to/orthymarjan/beginners-journey-in-machine-learning-3ei9" rel="noopener ugc nofollow" target="_blank"><em class="lb">https://dev . to</em></a><em class="lb">。</em></p></div></div>    
</body>
</html>