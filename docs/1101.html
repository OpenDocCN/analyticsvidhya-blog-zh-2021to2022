<html>
<head>
<title>Face Mask Detection In Real Time By Using Open CV and CNN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于开放CV和CNN的实时人脸检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/face-mask-detection-in-real-time-by-using-open-cv-and-cnn-a176755ba885?source=collection_archive---------11-----------------------#2021-02-14">https://medium.com/analytics-vidhya/face-mask-detection-in-real-time-by-using-open-cv-and-cnn-a176755ba885?source=collection_archive---------11-----------------------#2021-02-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><blockquote class="ie if ig"><p id="7393" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">人类的眼睛有575百万像素，让我们评估一下拥有1/100百万像素的机器视频摄像头，它的检测速度有多快</p></blockquote><p id="cc92" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">本项目中使用的数据集总共有1376幅图像，分为两类，即带遮罩和不带遮罩。目标是通过使用Open CV和Harr Cascade以及深度学习CNN模型来训练这些图像，以便它可以在实时场景中检测视频中的人是否戴着面具。</p><p id="b25a" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">让我们看看我们将遵循的面具检测步骤。</p><ol class=""><li id="dd84" class="jj jk hh ik b il im ip iq jg jl jh jm ji jn jf jo jp jq jr bi translated">从保存图像的文件夹中读取日期设置图像</li></ol><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es js"><img src="../Images/5c5c0e929d5cc56185e39b24a659ef63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g7ky_NVfCGOXnNT7SZjIXw.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">存储面罩分类图像的路径</figcaption></figure><p id="5acc" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">2.让我们看看贴有标签的图片</p><p id="13b6" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">这些数据包含了世界上大多数种族的图像</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ki"><img src="../Images/6e3b79408fa4a82d182f8336a983b25b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j1HojU4TuLQ0oj7r8PRztQ.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">带有遮罩图像</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kj"><img src="../Images/a4c2d526b39033fed2a02f77faf52f10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EE4F50uNt6r1wboEGe1zIw.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">没有遮罩图像</figcaption></figure><p id="fab3" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">3.从描述的路径中读取所有图像，并执行灰度缩放和标签分类。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kk"><img src="../Images/0a5b1038fe1205e363e267e9f21c0afd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y4ZaaTNy8gTpdZ5HzOBJAw.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">来自基于标签类别指定的路径的图像的灰度</figcaption></figure><p id="d01f" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">4.以数组-1D的形式重塑数据，使范围从0到255。</p><p id="e068" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">我们已经将RGB图像转换为灰度图像，用于训练我们需要将图像转换为数组矩阵的图像，以使列和行表示一个数字。对于1D数组，范围是从0到255，所以让我们将图像划分到一个数组中。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kl"><img src="../Images/57d2d089d7c90b81cd688b066da9434e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*AGY85zr5GVHNGGvclxWICg.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">使用numpy将灰度图像转换成从0到255的数组</figcaption></figure><p id="91a4" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">5.为神经网络模型准备卷积层</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es km"><img src="../Images/27123a16a4fae886d7094ed8447a1ed1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g4Zqs1g9V3uIzKcbxlxXSQ.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">将图像转换为数组后，数据和目标来自其存储位置</figcaption></figure><p id="c166" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">它有以下几层</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kn"><img src="../Images/1f96665a4d7b790bd7521e9108891680.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*bzVb3rJBC6m1Qy_CBPYRgg.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">顺序模型和CNN模型中使用的各种层次。</figcaption></figure><p id="2495" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">6.将数据分为训练和测试，10%的数据用于测试，90%的数据用于训练。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ko"><img src="../Images/4b39cf8bdd36d38f11a6dca67fa975d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FHAWWKrOG1jvGZyxzmgFwQ.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">训练和测试数据分割。</figcaption></figure><p id="b2eb" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">7.使用之前设计的CNN模型对模型进行训练。</p><p id="c3f5" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">发现模型精确度超过97%。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kp"><img src="../Images/188f78bd2856e20d088cd5bc816b5692.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zUuSai5Le3l9RxhgktDjcQ.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">根据大小为20的纪元进行模型准备和训练。</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kp"><img src="../Images/bab1bacdf75b91f925438056b87c0abb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yei-DuMXkNMMooTfL7AWAA.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">发现模型精确度超过97%-模型16</figcaption></figure><p id="a7d4" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">8.绘制培训和验证准确度图。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kq"><img src="../Images/5dfe65f99b07993f6892940861b66757.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*MccFSSOXiWvmp9glhYczdQ.png"/></div></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kr"><img src="../Images/85f9a45b17978ef91e4570a5e1b6057a.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*gD8wX6wbjXc1kINZVTSZ1A.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">训练准确性</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kr"><img src="../Images/22567ccc30f59421686d03c2178ea2e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*yKvLaqNPDaAZPuXRY5nVFA.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">列车验证损失</figcaption></figure><p id="374d" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">9.打印评估结果</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ks"><img src="../Images/74ad4d8cb746bc5dd922a0155daba5ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*15qb8ukkg5wa86uCS4Lh2w.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">评估结果显示准确率为92%</figcaption></figure><p id="e007" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">10.加载训练结果中获得的最佳模型，启动摄像机进行检测</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es kn"><img src="../Images/9660ba5fa246bdfbac8105e3c292e066.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*iBaRBTiymyedmXEQMFbyPg.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">使用模型16，因为它是培训期间看到的最好的模型之一，也使用harr cascade xml</figcaption></figure><p id="a907" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">哈尔喀斯喀特正面脸。xml由OpenCV库中用于图像检测的预训练分类器组成。在这里，我们用它来检测正面人脸。更多关于哈卡斯卡德的信息，请点击此处</p><p id="e408" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated"><a class="ae kt" href="https://github.com/opencv/opencv/blob/master/data/haarcascades/haarcascade_frontalface_default.xml" rel="noopener ugc nofollow" target="_blank">https://github . com/opencv/opencv/blob/master/data/haarcascades/haarcascade _ frontal face _ default . XML</a></p><p id="5a58" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">哈尔喀斯喀特正面脸。xml文件可以从这里下载:-</p><p id="1adc" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated"><a class="ae kt" href="https://github.com/opencv/opencv/blob/master/data/haarcascades/haarcascade_frontalface_default.xml" rel="noopener ugc nofollow" target="_blank">https://github . com/opencv/opencv/blob/master/data/haarcascades/haarcascade _ frontal face _ default . XML</a></p><p id="bcf4" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">11.实时人脸面具检测。</p><p id="d97b" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">这里的主要思想是，我们已经训练了带有和不带有蒙版的图像的神经网络，记忆是以模型的形式存储的。我们使用型号16，因为它在上面显示的所有型号中精度最高。</p><p id="dea1" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">步骤:-</p><ol class=""><li id="a34f" class="jj jk hh ik b il im ip iq jg jl jh jm ji jn jf jo jp jq jr bi translated">通过打开cv读取视频捕获，并对图像帧进行灰度缩放。</li><li id="30d9" class="jj jk hh ik b il ku ip kv jg kw jh kx ji ky jf jo jp jq jr bi translated">将图像大小调整为数组</li><li id="55c4" class="jj jk hh ik b il ku ip kv jg kw jh kx ji ky jf jo jp jq jr bi translated">使用该模型来预测来自视频捕获的图像</li><li id="96b4" class="jj jk hh ik b il ku ip kv jg kw jh kx ji ky jf jo jp jq jr bi translated">使用已定义的标签，无论是“遮罩”还是“无遮罩”,分别以轮廓“绿色”或“红色”显示。</li><li id="d5b7" class="jj jk hh ik b il ku ip kv jg kw jh kx ji ky jf jo jp jq jr bi translated">根据场景实时显示视频和面部轮廓的标签..</li></ol><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kz"><img src="../Images/fc398148849eed6bb222eda646dd3dc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FxC9K3K_j2n7U95s3-xs9w.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">用于实时面罩检测。</figcaption></figure><p id="2bdf" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">12.实时评估结果。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es la"><img src="../Images/d5cbe00fbd497d7fba09f16f96050395.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*NgsnAOHsbgQKlxzmm3C-zw.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">没有面具的时候</figcaption></figure><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es lb"><img src="../Images/dac19f05ddf2dd8dbda6d4c948e9ae3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*86uj4zDXVedunyrPPrleow.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">带面具</figcaption></figure><p id="509e" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated">【https://youtu.be/t0bf3pFzCZk】视频链接:-<a class="ae kt" href="https://youtu.be/t0bf3pFzCZk" rel="noopener ugc nofollow" target="_blank"/></p><p id="8164" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated"><strong class="ik hi">结论:- </strong>使用开放CV和CNN可以真正用于实时的人脸面具检测。</p><p id="e821" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is jg iu iv iw jh iy iz ja ji jc jd je jf ha bi translated"><strong class="ik hi">参考文献:- </strong></p><ol class=""><li id="e9f7" class="jj jk hh ik b il im ip iq jg jl jh jm ji jn jf jo jp jq jr bi translated">关于面具检测的论文-<a class="ae kt" href="https://www.irjet.net/archives/V7/i8/IRJET-V7I8530.pdf" rel="noopener ugc nofollow" target="_blank">https://www.irjet.net/archives/V7/i8/IRJET-V7I8530.pdf</a></li><li id="4dc6" class="jj jk hh ik b il ku ip kv jg kw jh kx ji ky jf jo jp jq jr bi translated">关于CNN-<a class="ae kt" href="https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53" rel="noopener" target="_blank">https://towards data science . com/a-comprehensive-guide-to-convolutionary-neural-networks-the-Eli 5-way-3bd2b 1164 a53</a></li><li id="2769" class="jj jk hh ik b il ku ip kv jg kw jh kx ji ky jf jo jp jq jr bi translated">关于Harr cascade-<a class="ae kt" href="https://github.com/opencv/opencv/blob/master/data/haarcascades/haarcascade_frontalface_default.xml" rel="noopener ugc nofollow" target="_blank">https://github . com/opencv/opencv/blob/master/data/Haar cascades/Haar cascade _ frontal face _ default . XML</a></li><li id="3636" class="jj jk hh ik b il ku ip kv jg kw jh kx ji ky jf jo jp jq jr bi translated">完整代码:-<a class="ae kt" href="https://github.com/saish15/Machine-Learning/blob/master/Face_mask_detection.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/saish 15/Machine-Learning/blob/master/Face _ mask _ detection . ipynb</a></li></ol></div></div>    
</body>
</html>