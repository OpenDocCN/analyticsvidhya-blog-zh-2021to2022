<html>
<head>
<title>Pixels: The Foundation of Computer Vision</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">像素:计算机视觉的基础</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pixels-the-foundation-of-computer-vision-89ef72f31cfa?source=collection_archive---------11-----------------------#2021-09-10">https://medium.com/analytics-vidhya/pixels-the-foundation-of-computer-vision-89ef72f31cfa?source=collection_archive---------11-----------------------#2021-09-10</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="5383" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">使用fast.ai训练数字分类器</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es iw"><img src="../Images/da22aa2aa63e5904da53c5b8e366fa48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*-TktKs_yQqEhPpqVofOpJA.jpeg"/></div><figcaption class="je jf et er es jg jh bd b be z dx translated">该图像是使用《fastai和PyTorch程序员的深度学习》一书中提供的代码创建的</figcaption></figure><p id="3a72" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi ke translated">像素是计算机视觉的基础，MNIST数据集被用作图像识别问题的hello world程序。MNIST数据集包含由国家标准和技术研究所收集的手写数字图像。几乎每个深度学习图书馆都有这个数据集作为他们玩具数据集的一部分。fastai还提供了MNIST数据集的样本。让我们在fastai提供的MNIST样本上试一试，创建一个分类为3或7的模型。如需完整代码，请查看Github链接:<a class="ae kn" href="https://github.com/Adeelzafar/My-Version-of-Fastai-Course/blob/main/Pixel_Similarity.ipynb" rel="noopener ugc nofollow" target="_blank">https://Github . com/Adeelzafar/My-Version-of-Fastai-Course/blob/main/Pixel _ similarity . ipynb</a></p><h1 id="a3d9" class="ko kp hh bd kq kr ks kt ku kv kw kx ky in kz io la iq lb ir lc it ld iu le lf bi translated">步骤1:导入必要的库</h1><pre class="ix iy iz ja fd lg lh li lj aw lk bi"><span id="0cb2" class="ll kp hh lh b fi lm ln l lo lp">import pandas as pd<br/>from fastbook import *<br/>from fastai.vision import *</span></pre><h1 id="e639" class="ko kp hh bd kq kr ks kt ku kv kw kx ky in kz io la iq lb ir lc it ld iu le lf bi translated">步骤2:检索MNIST样本数据集</h1><pre class="ix iy iz ja fd lg lh li lj aw lk bi"><span id="8382" class="ll kp hh lh b fi lm ln l lo lp">#Takes URL and compresses it<br/>path = untar_data(URLs.MNIST_SAMPLE)</span></pre><h1 id="29ef" class="ko kp hh bd kq kr ks kt ku kv kw kx ky in kz io la iq lb ir lc it ld iu le lf bi translated">步骤3:签出文件列表</h1><pre class="ix iy iz ja fd lg lh li lj aw lk bi"><span id="acfe" class="ll kp hh lh b fi lm ln l lo lp">path.ls()</span></pre><p id="2588" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">ls方法返回一个返回文件列表的对象。像fastai中的任何其他数据集一样，MNIST样本有一个单独的训练和测试文件夹。现在让我们看看数据集中有多少个3和7的样本。</p><pre class="ix iy iz ja fd lg lh li lj aw lk bi"><span id="897b" class="ll kp hh lh b fi lm ln l lo lp">threes = (path/"train"/'3').ls().sorted()<br/>threes</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="er es lq"><img src="../Images/dbe136ea17e9fc65812a200856c3c042.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W2CUuoymYw-nUuoW5Mv9mw.png"/></div></div><figcaption class="je jf et er es jg jh bd b be z dx translated">图像总数及其路径</figcaption></figure><h1 id="0aaa" class="ko kp hh bd kq kr ks kt ku kv kw kx ky in kz io la iq lb ir lc it ld iu le lf bi translated">步骤4:可视化数据集中的图像</h1><p id="aa92" class="pw-post-body-paragraph ji jj hh jk b jl lv ii jn jo lw il jq jr lx jt ju jv ly jx jy jz lz kb kc kd ha bi translated">你可以做同样的事情来检查7的数量。这是一个手写数字7的图像。</p><pre class="ix iy iz ja fd lg lh li lj aw lk bi"><span id="5ed7" class="ll kp hh lh b fi lm ln l lo lp">#visualizing an image of 7<br/>im7_path = sevens[1]<br/>im7 = Image.open(im7_path)<br/>im7</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ma"><img src="../Images/dd66d1f87859daacef15896a9f842014.png" data-original-src="https://miro.medium.com/v2/resize:fit:94/format:webp/1*KeNn5qj814F5uLbI9OEdNw.jpeg"/></div></figure><h1 id="7259" class="ko kp hh bd kq kr ks kt ku kv kw kx ky in kz io la iq lb ir lc it ld iu le lf bi translated">步骤5:将图像转换成张量</h1><p id="b9ad" class="pw-post-body-paragraph ji jj hh jk b jl lv ii jn jo lw il jq jr lx jt ju jv ly jx jy jz lz kb kc kd ha bi translated">图像是一串数字。下面的代码得到一个PyTorch张量，并使用渐变对这些值进行颜色编码。</p><pre class="ix iy iz ja fd lg lh li lj aw lk bi"><span id="5c7d" class="ll kp hh lh b fi lm ln l lo lp">tensor(im3)[4:10,4:10]<br/>im3_t= tensor(im3)<br/>df = pd.DataFrame(im3_t[4:10,4:10])<br/>df.style.set_properties(**{'font-size': '6pt'}).background_gradient('Greys')</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mb"><img src="../Images/f26511afe7f5fc347c2f9047afc293e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:416/format:webp/1*1ypMZIKSQX9QPRqpB-v5kg.png"/></div><figcaption class="je jf et er es jg jh bd b be z dx translated">该图像是使用《fastai和PyTorch程序员的深度学习》一书中提供的代码创建的</figcaption></figure><h1 id="e889" class="ko kp hh bd kq kr ks kt ku kv kw kx ky in kz io la iq lb ir lc it ld iu le lf bi translated">步骤6:使用列表理解计算3s和7s的平均像素</h1><pre class="ix iy iz ja fd lg lh li lj aw lk bi"><span id="1cc8" class="ll kp hh lh b fi lm ln l lo lp">#Getting average pixels of 3's and 7's<br/>seven_tensors = [tensor(Image.open(o)) for o in sevens]<br/>three_tensors = [tensor(Image.open(o)) for o in threes]<br/>len(three_tensors), len(seven_tensors)</span><span id="bd90" class="ll kp hh lh b fi mc ln l lo lp">#(6131, 6265)</span></pre><h1 id="b033" class="ko kp hh bd kq kr ks kt ku kv kw kx ky in kz io la iq lb ir lc it ld iu le lf bi translated">步骤7:将图像堆叠在一起</h1><p id="cb5e" class="pw-post-body-paragraph ji jj hh jk b jl lv ii jn jo lw il jq jr lx jt ju jv ly jx jy jz lz kb kc kd ha bi translated">图像相互叠加时具有三维空间。这意味着我们有6252张28*28像素的图像。</p><pre class="ix iy iz ja fd lg lh li lj aw lk bi"><span id="6b60" class="ll kp hh lh b fi lm ln l lo lp">stacked_sevens = torch.stack(seven_tensors).float()/255<br/>stacked_threes = torch.stack(three_tensors).float()/255<br/>stacked_sevens.shape<br/>#torch.Size([6265, 28, 28])</span></pre><h1 id="7521" class="ko kp hh bd kq kr ks kt ku kv kw kx ky in kz io la iq lb ir lc it ld iu le lf bi translated">第八步:计算平均值</h1><pre class="ix iy iz ja fd lg lh li lj aw lk bi"><span id="4ebe" class="ll kp hh lh b fi lm ln l lo lp">#calculating mean of all 3s and 7s<br/>mean3 = stacked_threes.mean(0)<br/>mean7= stacked_sevens.mean(0)<br/>show_image(mean7);</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es md"><img src="../Images/040ddbffdbe152dd635ddc0c73506592.png" data-original-src="https://miro.medium.com/v2/resize:fit:136/format:webp/1*q10TUHtzXe0qlSb959EY1w.png"/></div></figure><h1 id="6a88" class="ko kp hh bd kq kr ks kt ku kv kw kx ky in kz io la iq lb ir lc it ld iu le lf bi translated">步骤9:计算L1和L2的距离</h1><p id="655b" class="pw-post-body-paragraph ji jj hh jk b jl lv ii jn jo lw il jq jr lx jt ju jv ly jx jy jz lz kb kc kd ha bi translated">为了测量像素相似性，我们将使用两种不同的方法，即L1和L2规范。L1是平均绝对差，而L2是均方误差。这两个我们都要尝尝。</p><pre class="ix iy iz ja fd lg lh li lj aw lk bi"><span id="cdf5" class="ll kp hh lh b fi lm ln l lo lp">dist_3_abs = (stacked_threes[1] - mean3).abs().mean()<br/>dist_3_sqr = ((stacked_threes[1] - mean3)**2).mean().sqrt()<br/>dist_3_abs, dist_3_sqr<br/>#(tensor(0.1114), tensor(0.2021))</span><span id="c013" class="ll kp hh lh b fi mc ln l lo lp">dist_7_abs = (stacked_threes[1] - mean7).abs().mean()<br/>dist_7_sqr = ((stacked_threes[1] - mean7)**2).mean().sqrt()<br/>dist_7_abs, dist_7_sqr<br/>#(tensor(0.1586), tensor(0.3021))</span><span id="0a9e" class="ll kp hh lh b fi mc ln l lo lp">F.l1_loss(stacked_sevens[1].float(), mean7)<br/>#tensor(0.1304)<br/>F.mse_loss(stacked_sevens[1], mean7).sqrt()<br/>#tensor(0.2585)</span></pre><p id="1d37" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">我们可以看到，我们的7和理想的7之间的L1和L2距离都小于理想的3。这意味着像素相似性可以以合理的方式对数字进行分类。我们可以使用这个方法作为基础方法，并且可以用它来比较我们的复杂方法。</p><p id="9f1b" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">原来如此。用fastai训练一个数字分类器既简单又有趣。下次见…编码快乐…</p></div></div>    
</body>
</html>