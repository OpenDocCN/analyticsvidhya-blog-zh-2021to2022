<html>
<head>
<title>R-style Visualizations in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的r风格可视化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/r-style-visualizations-in-python-560c6bbfb14a?source=collection_archive---------18-----------------------#2021-02-11">https://medium.com/analytics-vidhya/r-style-visualizations-in-python-560c6bbfb14a?source=collection_archive---------18-----------------------#2021-02-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/6e93870117d2b1917cc1194e5b171b86.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*eVo3GQQPffUt3QnZ2Og3OA.jpeg"/></div></figure><p id="163a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">可视化是快速理解新数据集的好方法。它们使得识别不同列之间的相关性以及识别数据中的信息模式变得更加容易。有几个<a class="ae jj" href="https://blog.ine.com/python-visualization-libraries-you-should-know-in-2020-and-how-to-use-them" rel="noopener ugc nofollow" target="_blank">可视化库</a>可供Python用户使用，比如matplotlib、seaborn、plotly和graphiz。由于R和Python都常用于数据科学和分析，您可能会发现自己在这两种语言之间徘徊。也许您的组织正在将项目从R转换为Python，或者您是一个R用户，加入了一个专门使用Python的团队。或者你可能遇到过用R做的一些事情，只是想知道它是否可以用Python实现。</p><p id="4e00" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">Ggplot是R中用于数据可视化的常用库。Python的等价物是plotnine。本文将探讨如何使用plotnine进行基本的可视化，并总结实现的优缺点。这个探索还假设了Python及其常用库的基础知识，比如用于数据操作的<a class="ae jj" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> pandas </a>。</p><h1 id="2843" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak">理解并加载数据</strong></h1><p id="9391" class="pw-post-body-paragraph il im hh in b io ki iq ir is kj iu iv iw kk iy iz ja kl jc jd je km jg jh ji ha bi translated">这一探索基于托管在<a class="ae jj" href="https://www.kaggle.com/fivethirtyeight/uber-pickups-in-new-york-city?select=uber-raw-data-apr14.csv" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上的2014年优步数据集。数据中的四列是:</p><ul class=""><li id="744a" class="kn ko hh in b io ip is it iw kp ja kq je kr ji ks kt ku kv bi translated"><code class="du kw kx ky kz b">Date/Time</code>:优步取件的日期和时间</li><li id="7996" class="kn ko hh in b io la is lb iw lc ja ld je le ji ks kt ku kv bi translated"><code class="du kw kx ky kz b">Lat</code>:优步皮卡的纬度</li><li id="4850" class="kn ko hh in b io la is lb iw lc ja ld je le ji ks kt ku kv bi translated"><code class="du kw kx ky kz b">Lon</code>:优步皮卡的经度</li><li id="9a14" class="kn ko hh in b io la is lb iw lc ja ld je le ji ks kt ku kv bi translated"><code class="du kw kx ky kz b">Base</code>:隶属于优步皮卡的TLC(出租车&amp;豪华轿车佣金)基本公司代码</li></ul><p id="47b6" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">为了演示plotnine，我们将关注数据/时间列。首先，将数据加载到pandas数据框中，并将它们连接成一个数据框。我们还需要将日期/时间列转换为datetime数据类型，以便从中提取有用的信息。</p><figure class="lf lg lh li fd ii"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="77ff" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">下一步是创建几个与时间相关的列和一个行程计数列，以便更容易地按不同的时间单位对数据进行分组。</p><figure class="lf lg lh li fd ii"><div class="bz dy l di"><div class="lj lk l"/></div></figure><h1 id="8d82" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak">创建可视化效果</strong></h1><p id="d735" class="pw-post-body-paragraph il im hh in b io ki iq ir is kj iu iv iw kk iy iz ja kl jc jd je km jg jh ji ha bi translated">现在是时候创建一些图表了。对于创建的所有地块，需要使用Pandas groupby方法对原始数据框进行一些操作。为ggplot提供一个仅包含必要列的较小数据框会更干净。</p><figure class="lf lg lh li fd ii"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="a124" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">上面代码块的输出如下图所示，它显示了6个月期间每天每小时的出行情况。</p><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es ll"><img src="../Images/00f824f4a484336e2dece0c7de69ad5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*O7SUpmJCbKvBo6Um8ibd-g.png"/></div></figure><p id="1ce6" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">图表清楚地显示了更多的游乐设施何时完成，从晚上高峰时间开始。易于解释的可视化的酷之处在于它们会导致更多的问题，尤其是在数据探索阶段。第一个图表可能会让你好奇这个信息是否依赖于月份、月份中的某一天、星期几等等。那么我们来看看另一个配置。</p><figure class="lf lg lh li fd ii"><div class="bz dy l di"><div class="lj lk l"/></div></figure><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es lm"><img src="../Images/2641992a9f5f3f0c0fc1f5102ed71c42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*S-EoajGIztNPviG98bqCAw.png"/></div></figure><p id="c109" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">九月似乎有更多的旅行，尤其是在晚上，但是在这种格式下有点难以分辨。热图会让我们更容易看到关系。</p><figure class="lf lg lh li fd ii"><div class="bz dy l di"><div class="lj lk l"/></div></figure><figure class="lf lg lh li fd ii er es paragraph-image"><div class="er es ln"><img src="../Images/da9074d04a0e04c2e868a19c40ddbbca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*rPMkC7HQPHT9nAZ07WW2Rw.png"/></div></figure><p id="3d27" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">热图证实了9月份傍晚时段的乘车次数较多，这应该会引发超出该数据集范围的进一步调查。</p><p id="9f15" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">只需稍作修改，上面提供的代码片段就可以用来研究人们感兴趣的任何其他配置。</p><div class="lf lg lh li fd ab cb"><figure class="lo ii lp lq lr ls lt paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><img src="../Images/3e541be1eb3818648f7bf2e984fe8668.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*ExX3-rqyah8LrN-aAKDFWQ.png"/></div></figure><figure class="lo ii ly lq lr ls lt paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><img src="../Images/cb0653166227ededf112d8fb7d2d7f10.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*QwUKQ7hrsXIEGhOgoKUaDA.png"/></div></figure></div><div class="ab cb"><figure class="lo ii lz lq lr ls lt paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><img src="../Images/0548e92d090d591d2e091f604b9da79c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*pQJnYWDzgNlDK87nbvq6PA.png"/></div></figure><figure class="lo ii ma lq lr ls lt paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><img src="../Images/055b2657c7967f57cefcb19f113dff7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*3d_hZkLokuND5E1E9hGFyg.png"/></div></figure></div></div><div class="ab cl mb mc go md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ha hb hc hd he"><h1 id="fd19" class="jk jl hh bd jm jn mi jp jq jr mj jt ju jv mk jx jy jz ml kb kc kd mm kf kg kh bi translated"><strong class="ak">结论</strong></h1><p id="38fb" class="pw-post-body-paragraph il im hh in b io ki iq ir is kj iu iv iw kk iy iz ja kl jc jd je km jg jh ji ha bi translated">虽然可以使用更常用的Python库来创建这些可视化效果，但在寻求类似ggplot的体验时，使用plotnine的优缺点如下:</p><p id="9e7c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">优点</strong></p><ol class=""><li id="b389" class="kn ko hh in b io ip is it iw kp ja kq je kr ji mn kt ku kv bi translated">plotnine文档很容易理解和实现。</li><li id="eebf" class="kn ko hh in b io la is lb iw lc ja ld je le ji mn kt ku kv bi translated">如果您从R进入Python，或者将R转换成Python，使用plotnine可能比尝试在不同的库中做同样的事情更容易。</li><li id="931b" class="kn ko hh in b io la is lb iw lc ja ld je le ji mn kt ku kv bi translated">如果您需要展示您的绘图或与合作者分享发现，plotnine提供了一种保存方法。</li></ol><p id="a185" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">缺点</strong></p><ol class=""><li id="15cb" class="kn ko hh in b io ip is it iw kp ja kq je kr ji mn kt ku kv bi translated">ggplot中可用的一些功能在plotnine中不可用，例如使用theme_map创建地图。</li><li id="4482" class="kn ko hh in b io la is lb iw lc ja ld je le ji mn kt ku kv bi translated">对于常见的功能，实现并不总是直接从R转换到Python，所以要准备好花时间钻研plotnine文档(但从学习的角度来看，这可以被认为是专业的)。</li><li id="ab26" class="kn ko hh in b io la is lb iw lc ja ld je le ji mn kt ku kv bi translated">r提供了一个数据框操作库(dplyr ),可以在可视化之前轻松地对数据框执行操作。Python的对等物dfply不太直观。不过，对于这个项目中所需的几个步骤，使用pandas方法工作得很好。</li></ol><p id="c6cb" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这个项目的完整实现可以在<a class="ae jj" href="https://github.com/ngachago/uber_analysis" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div></div>    
</body>
</html>