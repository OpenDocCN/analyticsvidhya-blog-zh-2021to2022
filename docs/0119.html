<html>
<head>
<title>Python Selenium all mouse actions using ActionChains</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python Selenium使用动作链的所有鼠标动作</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/python-selenium-all-mouse-actions-using-actionchains-197530cf75df?source=collection_archive---------2-----------------------#2021-01-05">https://medium.com/analytics-vidhya/python-selenium-all-mouse-actions-using-actionchains-197530cf75df?source=collection_archive---------2-----------------------#2021-01-05</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/157d88b2282db32ab4cdf87bb83b8027.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sPhWhojXSQVlnmgYJBT5aA.jpeg"/></div></div></figure><p id="12ca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">什么是动作链？<br/> ActionChains是Selenium提供的方法，用于自动化与网站的低级交互，类似于鼠标移动、鼠标按钮操作、按键和上下文菜单(右键菜单)交互。这些特殊的策略有助于完成额外的复杂操作，比如鼠标悬停和拖放，而这些操作是直接的web驱动程序所做不到的。</p><p id="272f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">利用ActionChains对象，我们命名一个接一个按顺序执行特定动作的策略。selenium教练操作被直接推入队列。当performing()方法被调用时，事件按照它们排队的顺序被触发。</p><p id="8e2b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要使用ActionsChains，您必须从lib导入:</p><figure class="jo jp jq jr fd ij"><div class="bz dy l di"><div class="js jt l"/></div></figure><p id="294b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ActionChains = action chains(driver)#初始化action chain对象</p><p id="6853" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">创建ActionChains对象时应传递WebDriver实例。</p><p id="1862" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">ActionChains可以在链模式中使用，在同一行中添加所有方法。</p><p id="7627" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如何将驱动程序移动到一个元素？</p><figure class="jo jp jq jr fd ij"><div class="bz dy l di"><div class="js jt l"/></div></figure><p id="9db4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">动作将被一个接一个地添加到队列中，然后被执行。</p><figure class="jo jp jq jr fd ij"><div class="bz dy l di"><div class="js jt l"/></div></figure><p id="1606" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在每一种方式中，动作都是按照它们被添加的顺序一个接一个地执行或实施的。</p><p id="50ba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所有可用的ActionChains方法:</p><figure class="jo jp jq jr fd ij"><div class="bz dy l di"><div class="js jt l"/></div></figure><h1 id="e749" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">。点击()</strong></h1><p id="a0b0" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">。单击(on_element)</p><p id="1906" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">单击传递给此方法的元素。如果没有任何东西传递给click()，默认情况下单击鼠标的当前位置。</p><p id="805e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> on_element: </strong>点击左键点击WebElement对象。</p><h1 id="3dfb" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">。点击_并_保持()</strong></h1><p id="5c04" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">。单击并按住(在元素上)</p><p id="e66b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在传递给此方法的元素上按住鼠标左键。如果什么都没有传递，默认点击鼠标的当前位置。</p><p id="477a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> on_element: </strong>鼠标左键所在的WebElement对象。</p><h1 id="ea6d" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">。context_click() </strong></h1><p id="4d00" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">。上下文点击(on_element)</p><p id="b989" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在传递给此方法的元素上执行上下文单击(右键单击)操作。如果什么都没有传递，默认点击鼠标的当前位置。</p><p id="0b51" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> on_element: </strong> WebElement对象</p><h1 id="c6da" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">。双击()</strong></h1><p id="813a" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">。双击(在元素上)</p><p id="7125" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">双击传递给此方法的元素。如果没有传递任何东西，默认情况下双击鼠标的当前位置。</p><p id="890d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> on_element: </strong> WebElement对象在哪里执行双击。</p><h1 id="9ea2" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">。拖放()</strong></h1><p id="d57e" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">。拖放(源，目标)</p><p id="f793" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在源元素上按住鼠标左键，然后移动到目标元素并释放鼠标按钮。</p><p id="4285" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">来源:</strong>鼠标按下的WebElement对象。</p><p id="63e3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">目标:</strong>web driver元素中鼠标向上移动的对象。</p><h1 id="eb17" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">。drag_and_drop_by_offset() </strong></h1><p id="9177" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">。拖放偏移(<em class="kx">源</em>、<em class="kx"> xoffset </em>、<em class="kx"> yoffset </em>)</p><p id="b61a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在源元素上按住鼠标左键，然后移动到目标偏移并释放鼠标按钮。</p><p id="0080" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> source: </strong>鼠标按下的WebElement对象。</p><p id="4cf0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> xoffset: </strong>要移动到的X偏移量。</p><p id="fe18" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> yoffset: </strong>要移动到的Y轴偏移量。</p><h1 id="578c" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">。key_down() </strong></h1><p id="529d" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">。key_down( <em class="kx">值</em>，<em class="kx">元素</em>)</p><p id="b609" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">只发送按键，不释放。应仅与修饰键(Control、Alt和Shift)一起使用。</p><p id="788c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">值:</strong>要发送的修改键。值在Keys类中定义。</p><p id="7560" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">元素:</strong>发送键的元素。如果没有，则向当前获得焦点的元素发送一个键。</p><p id="e396" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">示例:“CTRL+A”—[全选]</p><figure class="jo jp jq jr fd ij"><div class="bz dy l di"><div class="js jt l"/></div></figure><h1 id="776a" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">。key_up() </strong></h1><p id="ccfe" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">。key_up( <em class="kx">值</em>，<em class="kx">元素</em></p><p id="bdc1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">释放修饰键。</p><p id="a1fc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">值:</strong>修改键发送。值在Keys类中定义。</p><p id="bf6a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">元素:</strong>发送按键的元素。如果没有，则向当前获得焦点的元素发送一个键。</p><h1 id="1b0c" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">。<strong class="ak"> move_by_offset() </strong></h1><p id="f050" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">。move _ by _ offset(<em class="kx">x offset</em>，<em class="kx"> yoffset </em>)</p><p id="998a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将鼠标移动到偏离浏览器屏幕当前鼠标位置的位置。</p><p id="4359" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> xoffset: </strong>要移动到的X偏移量，为正整数或负整数。</p><p id="3d37" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> yoffset: </strong>要移动到的Y偏移量，为正整数或负整数。</p><h1 id="cc0b" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">。<strong class="ak"> move_to_element() </strong></h1><p id="18a6" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">。移动到元素</p><p id="1610" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将鼠标移动到元素的中间</p><p id="75a2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> to_element: </strong>要移动到的WebElement对象。</p><h1 id="2f2d" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">。move_to_element_with_offset()</h1><p id="2411" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">。move _ to _ element _ with _ offset(<em class="kx">to _ element</em>，<em class="kx"> xoffset </em>，<em class="kx"> yoffset) </em></p><p id="703a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将鼠标移动指定元素的偏移量。偏移量相对于元素的左上角。</p><p id="a690" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> to_element: </strong>要移动到的WebElement对象。</p><p id="c4d6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">X偏移:</strong>要移动到的X偏移。</p><p id="a748" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> yoffset: </strong>要移动到的Y偏移。</p><h1 id="5ed8" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated"><strong class="ak">。暂停()</strong></h1><p id="7660" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">。暂停(秒)</p><p id="a323" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将所有输入暂停指定的秒数。</p><p id="d696" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">秒:</strong>暂停输入动作的持续时间</p><h1 id="ecc0" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">。<strong class="ak">执行()</strong></h1><p id="c328" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">。执行()</p><p id="446c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在ActionsChains()中执行所有存储的操作。</p><h1 id="b2d2" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">。<strong class="ak">发布()</strong></h1><p id="5d37" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">。释放(on_element)</p><p id="a0b2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在元素上释放按住的鼠标按钮。</p><p id="0dc8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> on_element: </strong> WebElement对象</p><h1 id="5063" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">。<strong class="ak"> reset_actions() </strong></h1><p id="8d08" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">。重置_操作()</p><p id="0054" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">清除已经存储的操作。</p><h1 id="ebf5" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">。<strong class="ak"> send_keys() </strong></h1><p id="f030" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">。发送密钥(发送密钥)</p><p id="9993" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">向当前聚焦的web元素发送文本或键。</p><p id="3cca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">按键发送:</strong>按键发送。修饰键常量可以在“keys”类中找到。</p><h1 id="f184" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">。<strong class="ak"> send_keys_to_element() </strong></h1><p id="5a1c" class="pw-post-body-paragraph iq ir hi is b it ks iv iw ix kt iz ja jb ku jd je jf kv jh ji jj kw jl jm jn hb bi translated">。发送密钥至元素(元素，密钥至发送)</p><p id="9f1f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">向特定元素发送键。</p><p id="e6b6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">元素:</strong>发送按键的元素。</p><p id="47f7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">按键发送:</strong>按键发送。修饰键常量可以在“keys”类中找到。</p></div></div>    
</body>
</html>