<html>
<head>
<title>Building a Chat Bot using AI with movie scripts dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用人工智能和电影脚本数据集构建聊天机器人</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/building-a-chat-bot-using-ai-with-movie-scripts-dataset-f18fc1f9629e?source=collection_archive---------7-----------------------#2021-01-08">https://medium.com/analytics-vidhya/building-a-chat-bot-using-ai-with-movie-scripts-dataset-f18fc1f9629e?source=collection_archive---------7-----------------------#2021-01-08</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/df1f2217309af6aee1400a2f6d9ad6f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gn29jayos-fgrnT6ADeEMQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://pixabay.com/illustrations/chatbot-bot-assistant-support-icon-4071274/" rel="noopener ugc nofollow" target="_blank">https://pix abay . com/illustrations/chatbot-bot-assistant-support-icon-4071274/</a></figcaption></figure><h1 id="557e" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">动机</h1><p id="c5a0" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">最近，我不得不购买一项新的互联网服务，所以我尝试使用该公司现有的聊天机器人。我注意到与聊天机器人的对话是基于规则和条件的。因此，对于我向机器人提出的每个问题，它都向我发送了一个选项列表，我需要选择这些选项来进行下一步的对话。这次经历对我来说并不好，也没有解决我的问题。所以，我开始搜索可能的解决方案，只是出于好奇，我在互联网上找到了一些内容，谈论使用自然语言处理(NLP)训练一个聊天机器人。读完这篇文章后，我决定接受挑战，训练我的聊天机器人进行自然对话。</p><p id="20fd" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">我对结果非常满意，因为我可以使用人工智能概念在python中构建一个完整的解决方案，对它进行覆盖98%源代码的单元测试，并且我还可以在Heroku中部署它。阅读文本，了解如何基于人工智能构建自己的聊天机器人。</p><p id="6457" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">在接下来的部分中，我将解释:</p><ul class=""><li id="f9d2" class="kw kx hi jv b jw kr ka ks ke ky ki kz km la kq lb lc ld le bi translated">人工智能是如何被训练的；</li><li id="04d5" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">使用的文本相似性技术；</li><li id="a293" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">数据集的处理；</li><li id="2b95" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">聊天机器人的业务流程；</li><li id="9ac5" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">如何用不同的数据集重新训练聊天机器人？</li></ul><h1 id="687a" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">这是如何做到的</h1><ol class=""><li id="a1c4" class="kw kx hi jv b jw jx ka kb ke lk ki ll km lm kq ln lc ld le bi translated">我用了一个数据集，里面有关于电影的虚构对话；</li><li id="d2be" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq ln lc ld le bi translated">处理数据以建立对话序列(对话)；</li><li id="6acf" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq ln lc ld le bi translated">应用大写、词汇化和词干化来减少单词的变化；</li><li id="7b12" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq ln lc ld le bi translated">用更多的特征(句子的相似性)丰富了数据集；</li><li id="5e66" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq ln lc ld le bi translated">使用神经网络训练每个消息及其对应的答案；</li><li id="9e87" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq ln lc ld le bi translated">建立了一个用户界面，允许与聊天机器人的互动；</li><li id="1cf1" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq ln lc ld le bi translated">在一个免费的公共领域部署了聊天机器人(Heroku)。</li></ol><h1 id="4b93" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">概念</h1><h1 id="22d2" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">预处理数据</h1><p id="da30" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">数据集在成对的输入-输出消息中进行预处理，例如输入消息“这是什么？”可以有一个输出消息“一只狗”。这些消息用于将最接近的答案映射到来自用户的给定消息。</p><h1 id="9e98" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">页面等级</h1><p id="27b1" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">相似消息的图表被提供给页面排名算法，因此最相关的消息被排在列表的顶部。</p><p id="c4ab" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">消息被认为是图的顶点，并且消息之间的相似性被认为是这些顶点的关联(边)。将每条消息与所有其他消息进行比较，消息之间的相似性数量越多，这些消息的关联(边)数量就越多。例如，给定消息“aaa”、“abcx”、“acd”、“bef”、“axy”。因此，我们会有下面的相似性图，因为‘abcx’类似于'<strong class="jv hj"> aaa </strong>'、'<strong class="jv hj"> ac </strong> d '、'<strong class="jv hj"> ax </strong> y '和'<strong class="jv hj"> b </strong> ef '。</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/4d30c0f4bbe09877b34a3da0801fa5df.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*YUPtglrKmbbma5TfnAwGDQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">图1 —信息相似度图</figcaption></figure><p id="e4bf" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">因此，聊天机器人中的每个传入消息通过余弦相似性与预先分类的消息进行比较。该比较的结果被添加到预先分类的消息的权重中，并且具有最高关联值的消息被返回给用户。</p><h1 id="50cb" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">Cossine相似性</h1><p id="824f" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">Cossine相似性用于将用户的输入消息与数据集中最相似的消息进行匹配。该值与消息的页面等级相加。对所有消息进行这种处理，并将具有最高值(页面排名+相似性)的消息返回给用户。</p><h1 id="407d" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">用过的库</h1><ul class=""><li id="4c29" class="kw kx hi jv b jw jx ka kb ke lk ki ll km lm kq lb lc ld le bi translated">熊猫</li><li id="9a4a" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">关于</li><li id="7e48" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">克拉斯</li><li id="238d" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">numpy</li><li id="2d18" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">sklearn</li><li id="80c6" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">Scipy</li><li id="9f9b" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">训练_测试_分割</li><li id="1fd3" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">数学</li></ul><h1 id="50c7" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">聊天机器人的工作方式如下:</h1><ol class=""><li id="decb" class="kw kx hi jv b jw jx ka kb ke lk ki ll km lm kq ln lc ld le bi translated">用户提供输入消息；</li><li id="2a66" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq ln lc ld le bi translated">聊天机器人接收到该消息，并将其保存在数据文件中，以供将来改进；</li><li id="7514" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq ln lc ld le bi translated">该消息被预处理以服务于神经网络，并被标记为问题(1)或答案(0)。</li><li id="b806" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq ln lc ld le bi translated">相同的原始消息也被预处理以服务于相似性算法。在任何预处理中，在消息不能被使用的情况下，只作为数字，只作为特殊字符，等等。标准紧急消息被返回给用户。该标准消息是从标准消息列表中提取的；</li><li id="ab43" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq ln lc ld le bi translated">对预处理后的消息进行标记，并且根据标记，将其与具有相同标记的消息列表进行比较。例如，如果邮件被标记为问题，则将其与问题数据集进行比较；</li><li id="b180" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq ln lc ld le bi translated">如果发现类似的消息，聊天机器人将返回该消息的相关响应。</li><li id="6383" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq ln lc ld le bi translated">如果没有类似的消息，则向用户返回标准的kind消息。</li></ol><h1 id="c951" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">连接</h1><p id="fae8" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">聊天机器人部署在<a class="ae iu" href="https://chatbotnaive.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://chatbotnaive.herokuapp.com/</a>，所以试试这个:)</p><figure class="lp lq lr ls fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/8e3e182a389458ef10c82f18387e6fda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*K2kMWMa21lgzvy8f"/></div></div></figure><h1 id="493c" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">使用您自己的数据集进行再培训</h1><ul class=""><li id="ab4b" class="kw kx hi jv b jw jx ka kb ke lk ki ll km lm kq lb lc ld le bi translated">为了重新训练聊天机器人，有必要按照文件001，002的顺序使用Git Hub中的Jupyter笔记本…也许笔记本需要根据你的数据集进行调整。</li><li id="7d1a" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">笔记本生成聊天机器人使用的3个数据集:“movie _ lines _ pre _ processed _ for _ test . TVs”、“page_rank_questions.txt”和“page_rank_answers.txt”。如果是再培训，把生成的文件放在笔记本/聊天数据里，放在src/聊天数据里。</li><li id="b906" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">model.h5和tokenizer.pickle也是由笔记本生成的，需要在src/chatdata中复制这两个文件。</li><li id="e24a" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">由于性能问题，这个聊天机器人是使用30000条消息开发的，所以如果您正在重新训练聊天机器人，请注意您的数据集。</li></ul><h1 id="5bc6" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">源代码</h1><p id="f467" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">源代码放在<a class="ae iu" href="https://github.com/douglasdcm/chatbot_for_movies" rel="noopener ugc nofollow" target="_blank">https://github.com/douglasdcm/chatbot_for_movies</a>中，所以欢迎拉取请求。</p><p id="71cd" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">如果你喜欢的话，用一颗星来标记存储库:)</p><h1 id="ace7" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">结论</h1><p id="8ee4" class="pw-post-body-paragraph jt ju hi jv b jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq hb bi translated">聊天机器人是使用电影对话数据集设计的，根据用户发送的消息类型(问题或答案)，聊天机器人使用神经网络来标记这条消息，并返回更相关的答案。因此，我可以建造一个不是基于规则，而是基于人工智能的聊天机器人。</p><p id="7a23" class="pw-post-body-paragraph jt ju hi jv b jw kr jy jz ka ks kc kd ke kt kg kh ki ku kk kl km kv ko kp kq hb bi translated">谢谢你的阅读。好好学习！</p><h1 id="67a8" class="iv iw hi bd ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js bi translated">参考</h1><ul class=""><li id="025a" class="kw kx hi jv b jw jx ka kb ke lk ki ll km lm kq lb lc ld le bi translated">数据集<a class="ae iu" href="https://www.kaggle.com/Cornell-University/movie-dialog-corpus?select=movie_lines.tsv" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/Cornell-University/movie-dialog-corpus？select=movie_lines.tsv </a></li><li id="aae6" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated">【https://shanebarker.com/blog/deep-learning-chatbot/ T4】</li><li id="4a11" class="kw kx hi jv b jw lf ka lg ke lh ki li km lj kq lb lc ld le bi translated"><a class="ae iu" href="https://towardsdatascience.com/how-to-create-a-chatbot-with-python-deep-learning-in-less-than-an-hour-56a063bdfc44" rel="noopener" target="_blank">https://towards data science . com/how-to-create-a-a-chatbot-with-python-deep-learning-in-less-hour-56a 063 bdfc 44</a></li></ul></div></div>    
</body>
</html>