<html>
<head>
<title>Mercedes Benz Greener Manufacturing — A Machine Learning Case study (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">奔驰绿色制造——机器学习案例研究(上)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/mercedes-benz-greener-manufacturing-a-machine-learning-case-study-part-1-f6a5ddb60394?source=collection_archive---------1-----------------------#2021-12-23">https://medium.com/analytics-vidhya/mercedes-benz-greener-manufacturing-a-machine-learning-case-study-part-1-f6a5ddb60394?source=collection_archive---------1-----------------------#2021-12-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/2b888e41d3892620b435f1e304345e13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pRQYGPWpswNS5-3GAudQMA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来源:<a class="ae iu" href="https://www.rad-ab.com/2016/12/23/mercedes-benz-auf-dem-pruefstand/" rel="noopener ugc nofollow" target="_blank">https://www . rad-ab . com/2016/12/23/Mercedes-benz-auf-DEM-pruefstand/</a></figcaption></figure><p id="2217" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><strong class="ix hi">内容概述— </strong></p><p id="abed" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">第1部分—抽象→业务问题→ ML公式→数据→现有解决方案→性能指标→ EDA→第一步方法→特征工程</p><p id="3c72" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">第2部分— ML模型选择/训练/评分→实验→观察→预测系统→结论→未来工作</p><h1 id="1c21" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">摘要</h1><p id="7c84" class="pw-post-body-paragraph iv iw hh ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js ha bi translated">梅赛德斯·奔驰是高档汽车的制造商。戴姆勒的梅赛德斯-奔驰是欧洲高档汽车制造商中的佼佼者。这在质量研究、工程、制造和测试中已经成为可能。他们还为客户提供各种功能来定制他们的梅赛德斯-奔驰。现在，所有这些汽车都必须测试车内设备的功能。它们还必须满足质量标准和安全要求，以在上路时实现最佳性能。这就要求工厂内的测试线具有通用性，能够处理每一辆独特的汽车。</p><p id="e470" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">为了解决各种汽车的测试，公司工程师建立了一个强大的测试系统，可以处理汽车的每一个独特的配置。测试线必须高效运行，因为汽车花在测试上的时间越多，产生的碳排放就越多。优化测试速度保持生产线环保。对于公司来说，为如此多的可能特性组合优化测试系统的速度是一个相当大的挑战。如果没有智能的数值方法，这将是复杂和耗时的。作为世界上最大的汽车制造商，拥有一条高效且能控制温室气体排放的生产线至关重要。</p><p id="8744" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">一篇在奔驰进行测试的文章:<a class="ae iu" href="https://www.rad-ab.com/2016/12/23/mercedes-benz-auf-dem-pruefstand/" rel="noopener ugc nofollow" target="_blank">https://www . rad-ab . com/2016/12/23/Mercedes-Benz-auf-DEM-pruefstand/</a></p><h1 id="bf15" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">商业问题</h1><p id="ba22" class="pw-post-body-paragraph iv iw hh ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js ha bi translated">公司需要控制生产时间，因为这样可以减少碳排放。汽车测试时间是最重要的，因为它对公司的碳足迹有影响。因此控制它为绿色制造让路。为了帮助提高测试系统的速度，了解汽车配置如何影响处理时间以及影响的程度非常重要。</p><p id="30bc" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">在这里，我们需要了解有许多汽车配置是可能的，它们可能是独特的，这取决于客户的选择。为每一种可能的配置配置一个测试系统是不经济的。因此，必须有更少的或者如果可能的话，一个测试系统能够处理所有汽车配置的测试。根据市场需求，工厂生产的汽车排队通过装配线。</p><p id="63a4" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">组装结束后，汽车进入测试台。但是如果前一辆车具有不同的配置，则该车必须等待测试系统为其配置进行设置。因此，我们可以看到试验台必须经历这样的循环:</p><p id="7308" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">为独特的汽车设置试验台&gt;&gt;测试汽车&gt;&gt;设置&gt;&gt;测试&gt;&gt;设置&gt;&gt;测试&gt;&gt;设置&gt;&gt;测试&gt;&gt;测试&gt; &gt;…..</p><p id="54a0" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">花费时间来设置测试台，以处理即将进行测试的特定独特汽车。然后，汽车会在测试台上花一定的时间，这是它的配置所特有的。因此，总测试时间=设置时间+实际汽车测试时间。为了优化总测试时间，我们需要考虑两个方面:</p><p id="eddb" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">设置—这将取决于选择和组织测试独特汽车配置所需的工具。</p><p id="e410" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">实际测试——这将取决于工具在测试台上获得汽车特定测试结果的速度。</p><p id="28d1" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">(注意:对于当前的问题，测试的自动化水平是未知的)</p><p id="7012" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">如果我们知道配置如何影响测试时间，那么可以修改以上两个方面来优化测试时间。这将有助于测试团队相应地计划和重组测试平台。因此，我们需要根据汽车配置来评估/预测测试时间。可以将测量的测试时间与预测的时间进行比较，以查看是否存在延迟。这可以监视测试台的性能。</p><p id="3da8" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">如果为汽车提供的每个功能的测试时间是固定的，那么汽车的总测试时间就是所选功能的测试时间的总和。但事实并非如此。我们有的只是每辆车的一套配置和整体测试时间。(我们将在数据部分研究数据)</p><p id="eb50" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">现在，该公司向客户提供了数百种配置。预测每种可能配置的测试时间并不是一件容易的事情。</p></div><div class="ab cl kw kx go ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ha hb hc hd he"><p id="5805" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">让我们考虑一个简单的例子:假设我们有50个特性可以提供，而一个人只能选择他/她选择的10个特性。可能的组合数为10，272，278，170 (50C10)。这是一个很大的数字。</p><p id="0bbe" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">现在，当提供的功能数量不仅仅是50个并且选择不受限制时，考虑一个总的组合。可能的组合数量将急剧增加。</p></div><div class="ab cl kw kx go ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ha hb hc hd he"><p id="0ed9" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们需要一种系统的、更智能的方法来快速预测任何功能/配置组合的时间。机器学习(ML)是一种最先进的技术，可以洞察汽车配置对测试时间的影响。</p><p id="41e7" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">因此，我们手头的业务问题是想出一种方法来预测汽车通过给定配置的测试所需的时间。因此，该公司举办了一场kaggle比赛来解决这个问题，这可以在链接-<a class="ae iu" href="https://www.kaggle.com/c/mercedes-benz-greener-manufacturing/overview." rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/Mercedes-benz-greener-manufacturing/overview中找到。</a></p><p id="23b6" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">竞赛排行榜注意事项:</p><p id="39f0" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">公共排行榜是用大约19%的测试数据计算出来的。</p><p id="a9e9" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">私人排行榜是用剩下的81%的测试数据计算出来的。</p><h1 id="1a5b" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">商业问题的ML公式</h1><p id="e9f4" class="pw-post-body-paragraph iv iw hh ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js ha bi translated">公司提供具有特定配置的多辆汽车的测试时间信息。我们必须训练机器学习模型，该模型必须预测给定标记特征的汽车测试时间的真实值输出，该给定标记特征代表一组汽车配置。这是一个回归问题。必须使用决定系数(R值)来测量模型的性能。模型应该是可解释的，这样就可以提取出影响测试时间的特征。</p><p id="e7e5" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">机器学习模型对于预测的测试时间应该具有高的度量分数。当模型性能提高时，预测时间更加准确，这使得汽车测试更加有组织，测试速度也得到提高。从而减少汽车测试过程中的碳排放。</p><h1 id="83fb" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">业务限制</h1><ul class=""><li id="a2da" class="ld le hh ix b iy kr jc ks jg lf jk lg jo lh js li lj lk ll bi translated">预测在具有高R值的汽车上花费的测试时间。</li><li id="ca8e" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">没有严格的延迟限制。</li></ul><h1 id="7345" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">数据</h1><p id="9af6" class="pw-post-body-paragraph iv iw hh ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js ha bi translated">来源:<a class="ae iu" href="https://www.kaggle.com/c/mercedes-benz-greener-manufacturing/overview." rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/梅赛德斯-奔驰-更绿色-制造/概述。</a></p><p id="cb34" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">提供以下文件用于分析:</p><ul class=""><li id="27b1" class="ld le hh ix b iy iz jc jd jg lr jk ls jo lt js li lj lk ll bi translated">train.csv</li><li id="f6cf" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">test.csv</li><li id="9d61" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">sample_submission.csv</li></ul><p id="95f7" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><strong class="ix hi"> train.csv </strong>文件由4209行，378列组成。每行代表汽车，每列代表其配置和时间。配置被编码为标签下的类别，其中一个功能具有标签ID，其他功能具有“X”后跟一个数字作为标签。地面实况标记为“y ”,代表汽车通过特定功能配置测试所用的时间(秒)。</p><p id="ade9" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><strong class="ix hi"> test.csv </strong>包含大小为(4210，377)的数据，具有列ID和特性X0到X385。该文件中未提供时间。我们训练的模型必须预测test.csv中配置的时间。这将用于评估kaggle中的模型，以将最佳模型放在领先板上。这些数据不能用来提高我们的绩效，因为我们没有y数据。</p><p id="8a5c" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><strong class="ix hi"> sample_submission.csv </strong>捕获提交竞赛的测试数据预测的格式。</p><h1 id="189f" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">现有解决方案和要点</h1><p id="971e" class="pw-post-body-paragraph iv iw hh ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js ha bi translated">因为我所考虑的问题是一场智力竞赛，所以有一些解决方案赢得了这场竞赛。第一名获奖者和少数其他人采用的方法的关键思想要点如下:</p><p id="7529" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><a class="ae iu" href="https://www.kaggle.com/c/mercedes-benz-greener-manufacturing/discussion/37700" rel="noopener ugc nofollow" target="_blank"> Kaggle第一名解决方案</a></p><p id="6a43" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><a class="ae iu" href="https://www.kaggle.com/c/mercedes-benz-greener-manufacturing/discussion/36390" rel="noopener ugc nofollow" target="_blank"> Kaggle第二名解决方案</a></p><p id="af87" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><a class="ae iu" href="https://www.kaggle.com/c/mercedes-benz-greener-manufacturing/discussion/36126" rel="noopener ugc nofollow" target="_blank"> Kaggle季军解</a></p><p id="86e7" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><a class="ae iu" rel="noopener" href="/swlh/greener-manufacturing-with-machine-learning-6ec77d0e7a91"> Harshwardhan Jadhav的博客</a></p><p id="ad1e" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><a class="ae iu" rel="noopener" href="/analytics-vidhya/detailed-solution-to-mercedes-benz-green-manufacturing-competition-on-kaggle-7b85c84a3ff5"> Nitish Sawants博客</a></p><p id="ba90" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><a class="ae iu" rel="noopener" href="/analytics-vidhya/mercedes-benz-greener-manufacturing-74a932ae0693">阿迪蒂亚·潘迪的博客</a></p><p id="5ef9" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">以上解决问题的要点:</p><ul class=""><li id="0129" class="ld le hh ix b iy iz jc jd jg lr jk ls jo lt js li lj lk ll bi translated">基于特征重要性的树模型特征约简过滤技术。</li><li id="df41" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">双向和三向特征交互是有帮助的</li><li id="8604" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">基于决策树的模型，如随机森林、梯度推进、XGBoost回归等，能够得到较好的R值。</li><li id="e1e2" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">降维特性很有帮助。</li><li id="cfeb" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">具有K倍交叉验证的堆叠回归模型有助于获得良好的R值。</li><li id="8dab" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">一个热编码和标签编码用于分类特征</li></ul><p id="9b5f" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们必须单独使用4209行(train.csv)来训练和测试。我们拥有的数据量很小。获得良好模型性能的最佳方法是进行交叉验证。</p><h1 id="d73e" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">探索解决问题的其他途径</h1><p id="50dc" class="pw-post-body-paragraph iv iw hh ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js ha bi translated">在我们的分析中，我们将考虑分类特征的二进制编码和目标编码。在上述解决方案中没有考虑这些。降维特征基于目标编码特征。</p><p id="68eb" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们将根据与目标变量y的相关性来识别双向和三向交互特征</p><p id="5efa" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们将考虑弹性网模型。我们将考虑基于局部异常因子值移除异常值。</p><h1 id="5a5f" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">绩效指标:</h1><p id="9cd5" class="pw-post-body-paragraph iv iw hh ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js ha bi translated">为了衡量模型的性能，我们需要将其预测与实际情况进行比较。在给定的数据集中，我们有连续的目标变量“y”。对于连续值预测，我们可以评估均方差/RMSE、平均绝对误差或R平方(决定系数)来检查模型的性能。作为kaggle竞赛的一部分，我们需要评估Rsquared分数。在研究中，我们将考虑额外的度量RMSE来检查模型性能和比较不同的模型。</p><p id="3a95" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">研究中考虑的指标:</p><ul class=""><li id="ed8c" class="ld le hh ix b iy iz jc jd jg lr jk ls jo lt js li lj lk ll bi translated">r平方分数</li></ul><figure class="lu lv lw lx fd ij"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="16f9" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">从这个分数，我们可以很快判断出这个模型有多好。我们不必与其他模型分数相比较。这里，分数本身是通过将模型的误差与始终预测平均值的模型进行比较来评估的。</p><p id="f3ca" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">因此我们有，</p><p id="25af" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">R = 1 -&gt;最佳模型</p><p id="2d0d" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">R = 0 -&gt;最差模型，最差模型将有SS_r = SS_t，这意味着我们的模型等价于均值预测模型。</p><ul class=""><li id="65bf" class="ld le hh ix b iy iz jc jd jg lr jk ls jo lt js li lj lk ll bi translated">均方根误差</li></ul><figure class="lu lv lw lx fd ij"><div class="bz dy l di"><div class="ma lz l"/></div></figure><p id="99e7" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">RMSE = 0 -&gt;最佳模特</p><p id="5309" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">RMSE =高价值-&gt;最差模型</p><p id="1cd3" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">与Rsquared value不同，我们无法通过查看RMSE值来判断模型有多差。</p><h1 id="ce61" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">EDA —探索性数据分析</h1><p id="e169" class="pw-post-body-paragraph iv iw hh ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js ha bi translated">在这里，我们将研究给定的数据，并试图理解特征及其与目标变量的关系。</p><p id="87d0" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">用于EDA的Python模块</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="6448" class="mg ju hh mc b fi mh mi l mj mk"><strong class="mc hi">import</strong> pandas <strong class="mc hi">as</strong> pd<br/><strong class="mc hi">import</strong> numpy <strong class="mc hi">as</strong> np<br/><strong class="mc hi">import</strong> matplotlib.pyplot <strong class="mc hi">as</strong> plt<br/><strong class="mc hi">import</strong> seaborn <strong class="mc hi">as</strong> sb<br/><strong class="mc hi">import</strong> category_encoders <strong class="mc hi">as</strong> ce</span></pre><p id="a3a4" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">正如前面在“数据”一节中提到的，我们得到了由4209行× 378列组成的汽车数据</p><figure class="lu lv lw lx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/9ee1427e4d7c7a24b7eed3bc0bb0d389.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3rt-bK662gZ8uLeqq6Uf9g.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">来自train.csv的数据</figcaption></figure><p id="3a36" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">4209是汽车的数量</p><p id="2b96" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">378是与汽车相关的信息</p><p id="079b" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">没有重复的行。</p><p id="e4c3" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">给定数据的列描述-</p><ul class=""><li id="3902" class="ld le hh ix b iy iz jc jd jg lr jk ls jo lt js li lj lk ll bi translated">ID-对于每一行都是唯一的-类型:整数</li><li id="9113" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">y —它捕获测试时间—类型:float</li><li id="af53" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">X0、X1、X2、X3、X4、X5、X6和X8的类型是:object。这些特征是绝对的。</li><li id="ee96" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">X10到X385是368个整数类型的特征。</li></ul><figure class="lu lv lw lx fd ij er es paragraph-image"><div class="er es mm"><img src="../Images/ea363a72aaff7d2d358971d1a105a4de.png" data-original-src="https://miro.medium.com/v2/resize:fit:482/format:webp/1*vU1OD5OS2O41v89bUWKqVQ.jpeg"/></div></figure><figure class="lu lv lw lx fd ij er es paragraph-image"><div class="er es mn"><img src="../Images/e10a50cae350d55ca67037e535e23b26.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*YQhenUf0WdD-H6t-AF9JWA.jpeg"/></div></figure><p id="8158" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">左侧的表格显示了要素的唯一值计数。</p><p id="97fb" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">378列中的12列具有单一值并且等于零。已识别的特征如下所列:X11、X93、X107、X233、X235、X268、X289、X290、X293、X297、X330、X347</p><p id="68e5" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">这12个特征是没有用的，因为它们不会因每辆车而异。在训练ML模型时，我们可以忽略这些特征。</p><p id="e509" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">剩余的356个特征是占用值0或1的二进制。它可以表示特定特征对于特定汽车是否存在</p><p id="335b" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">现在，我们将探究每个特性栏。</p><p id="5440" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><strong class="ix hi"> 1。目标变量—‘y’</strong></p><p id="a555" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">y的值是实数值。我们将研究数据行中值的分布。</p><figure class="lu lv lw lx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mo"><img src="../Images/9bd2cb37f0cb178d23588ccb516e6052.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x3ipkuF7wdR_Y_ZwSgh9uQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">目标变量的直方图和PDF图。</figcaption></figure><p id="0b1a" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">观察结果:</p><ul class=""><li id="5306" class="ld le hh ix b iy iz jc jd jg lr jk ls jo lt js li lj lk ll bi translated">分布不正常。</li><li id="0e00" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">密度有多个峰值。</li><li id="21c7" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">平均值分布约为100秒</li><li id="f06b" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">在75、90和110秒左右有峰值</li><li id="aed2" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">最小值为72秒</li><li id="ea61" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">最大值为265秒</li><li id="e7af" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">50%的数据的测试时间在[90.82，109]秒范围内(四分位数范围内)</li></ul><p id="b0be" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">现在，我们将开始研究其他特性列，它们如何随目标变量而变化。</p><p id="3efb" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><strong class="ix hi"> 2。特征' ID' </strong></p><p id="c8e0" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">ID特征是唯一整数的集合。因此，我们将检查y与ID的scater图</p><figure class="lu lv lw lx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mp"><img src="../Images/21fd394b3710059ecb58853216d31cbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-nyPQ67okf1qnme9GTMO9w.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">特征ID与目标变量的散点图</figcaption></figure><p id="2862" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">从上图我们可以看出，ID和y之间没有关系。</p><p id="6ef1" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">比较train.csv和test.csv数据中的ID列，我们观察到train数据中ID列缺失的序列值在test数据中可用。由此我们可以推断，ID是观察数据的行号序列，它被随机拆分以进行训练和测试。因此，特征ID在预测y值时没有用。</p><p id="ec25" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><strong class="ix hi"> 3。分类特征</strong></p><p id="056c" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">X0、X1、X2、X3、X4、X5、X6和X8是绝对的。</p><p id="7c8a" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们将绘制箱线图，以了解一个分类特征列中的每个类别如何影响“y”</p><p id="f401" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">箱线图:</p><div class="lu lv lw lx fd ab cb"><figure class="mq ij mr ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/80ab38968dd0b66b45c01cbadd74e0f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*kDLvPXfXrQpXt_bYXMxz8w.jpeg"/></div></figure><figure class="mq ij mw ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/c53fe7a8465fa7780402587ed0d90aa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*3pl5DReLOs-yL0IoSjDOSg.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx mx di my mz translated">特征X0和X1的曲线</figcaption></figure></div><div class="ab cb"><figure class="mq ij na ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/c81b779b44253ddf832bbf511e93b8aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*S8iK7HtZwKKb8tMmrz4qLA.jpeg"/></div></figure><figure class="mq ij nb ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/12f6a2f34b1bcb92db5a8f013a46383e.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*QXLEN6zKqILeXPppmb_uWA.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx mx di my mz translated">特写X2和X3的情节</figcaption></figure></div><div class="ab cb"><figure class="mq ij nc ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/c6f4934904ffce6c686725480fb58e24.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*wim1277Qzy95-bRTx7vFZQ.jpeg"/></div></figure><figure class="mq ij nd ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/656688b8df1e4b5162ba60b023afe601.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*tJ7RZCYZ26vpAO_C9PJQww.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx ne di nf mz translated">特征X4和X5的曲线图</figcaption></figure></div><div class="ab cb"><figure class="mq ij ng ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/a0cddd8c906d5f308d3aa96a3259028d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*z-t_usXDO7qZIaHKYfsWKg.jpeg"/></div></figure><figure class="mq ij nh ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/29448991afa530ef4271b9b4205a7eb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*OrTw-ZuH3TqnZxHhA8vruw.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx mx di my mz translated">特征X6和X8的图</figcaption></figure></div><p id="ae0d" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">箱线图观察:</p><ul class=""><li id="ded8" class="ld le hh ix b iy iz jc jd jg lr jk ls jo lt js li lj lk ll bi translated">从上面的图中我们可以看出，分类特征下的每个类别都有不同的目标值分布。IQR山脉占据了不同地区的多个类别。我们可以看到哪些类别可能是y值分布中3个峰值的原因。</li><li id="1d9e" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">X0、X1和X2:对于y(测试时间)值，每一类特征都有其自己的分布</li><li id="935e" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">X3:不同类别的IQR价值观非常接近。但是中间值是变化的。</li><li id="145b" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">X4:只有一个类别有箱线图。该特征可以被认为是跨行的常数，其仅具有类别“d”的分布，而其他类别没有分布。类别“a”仅适用于两行数据，而“b”和“c”仅适用于一行数据。</li></ul><figure class="lu lv lw lx fd ij er es paragraph-image"><div class="er es ni"><img src="../Images/25ab5c37cd14a3bcc2f891f15ba72780.png" data-original-src="https://miro.medium.com/v2/resize:fit:310/format:webp/1*3OLVDccFEU3TyIw-6YYYXQ.jpeg"/></div></figure><ul class=""><li id="e76e" class="ld le hh ix b iy iz jc jd jg lr jk ls jo lt js li lj lk ll bi translated">X5:大多数图的IQR在同一范围内。</li><li id="2c95" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">与其他类别相比，X6: 2类别(“e”和“f”)的IQR范围较小。</li><li id="061b" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">X8:不同类别的IQR值非常接近。但是中间值是变化的。</li></ul><p id="b1fe" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">现在，我们将检查与每个类别相关联的中值对于给定特征是如何变化的。</p><figure class="lu lv lw lx fd ij"><div class="bz dy l di"><div class="nj lz l"/></div></figure><p id="cee5" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">中值图:</p><div class="lu lv lw lx fd ab cb"><figure class="mq ij nk ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/a527afe14c144270637b4b07ba224fc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*EdthNRD4kVcwpeIgDZKqfQ.jpeg"/></div></figure><figure class="mq ij nl ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/04dac81bf13b7b3bb6cac0bd35434579.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*CQ3B8it2zflGFGFk4iFp6Q.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx mx di my mz translated">特征X0和X1的中值图</figcaption></figure></div><div class="ab cb"><figure class="mq ij nm ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/5dee0516aa56f009b3a265b5166625d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*KA2w30zUHlsfUMtCY8x5BA.jpeg"/></div></figure><figure class="mq ij nn ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/7a5d06d4cf25e08db2b3127af26fc721.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*tB7TlGQtPOJnssLmpld73A.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx ne di nf mz translated">特征X2和X3的中间图</figcaption></figure></div><div class="ab cb"><figure class="mq ij no ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/a23c3266e8e437ad8d9b6cc990e2e7aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*yOY3M1MxWyckPj2hH7jubg.jpeg"/></div></figure><figure class="mq ij np ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/9be7d32250b06b525c759f3662c0a341.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*_lp36whTJ6Ebt5kvYQ-oLg.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx mx di my mz translated">特征X5和X6的中值图</figcaption></figure></div><figure class="lu lv lw lx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nq"><img src="../Images/e5caa0f811786b09852cb11c9a7b3dd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8vKIcai4q6FCxm70a7pa5Q.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">特征X8的中值图</figcaption></figure><p id="bc48" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">观察结果:</p><ul class=""><li id="f30b" class="ld le hh ix b iy iz jc jd jg lr jk ls jo lt js li lj lk ll bi translated">X0，X2:标识与“y”分布中不同峰值相关联的特征类别</li><li id="d2ba" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">X1，X3，X6，X8:以中值的递增顺序标识类别</li><li id="e048" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">X5:与特征X0和X2不同，在X5中，大多数类别的中位数集中在100左右。它似乎在不同的类别中保持不变。但是我们考虑的是分布的中值，所以我们不能断定在这个特性中使用任何类别都会预测相同的值</li><li id="36ee" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">基于上述观察，我们可以认为目标编码是分类特征的有用转换</li></ul><p id="c6ef" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">在目标编码后，我们将检查分类特征之间是否存在相关性。</p><figure class="lu lv lw lx fd ij"><div class="bz dy l di"><div class="nj lz l"/></div></figure><figure class="lu lv lw lx fd ij er es paragraph-image"><div class="er es nr"><img src="../Images/d6f0cdead846ae9f2aad77bc6f796f06.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*Yh-EY38bCi4XiC0aDjEdyA.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">特征相关热图</figcaption></figure><p id="ddbf" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">该图像捕捉了两个特征之间的皮尔逊相关性。“0”表示没有相关性。‘1’表示高度相关。我们看到特征X0和X2具有0.61的相关性。特征X1、X3和X8与X0和X2具有低的值相关性。</p><p id="0f0b" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们将检查多变量图，以查看两个特征如何针对特征集X0、X1、X2、X3和X8进行交互。</p><figure class="lu lv lw lx fd ij"><div class="bz dy l di"><div class="nj lz l"/></div></figure><figure class="lu lv lw lx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ns"><img src="../Images/a6abe88791aae713e1b0fdc560c7ebc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2L9dkJvyHRAPJzOOqamszw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">目标编码特征的多元图</figcaption></figure><p id="5c95" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">从上面的等高线图中，我们看到选择的特征分离出y的峰值区域</p><p id="79d8" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">在所有特性中，X2 vs X0捕捉到了沿45度线分布的关系。</p><ul class=""><li id="17e2" class="ld le hh ix b iy iz jc jd jg lr jk ls jo lt js li lj lk ll bi translated">特征X2平均值更多地集中在95和105秒左右。</li><li id="2512" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">而特征X0的平均值分布在3个区域:大约90°、105°和110°以上</li></ul><p id="c681" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">除了X0和X2这两个特征之外，其他特征都在XY平面上展开。特性之间没有太多的交互。</p><p id="86bf" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">虽然特征X0和X2具有0.61的相关性，但是我们不会忽略它们中的任何一个。因为相关性不是太高，并且两者都可能有助于预测目标值。</p><p id="5a9a" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">除X4之外的所有分类特征都被认为是重要的。</p><p id="0ffe" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><strong class="ix hi"> 4。二元特征</strong></p><p id="05ec" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">X10到X385是二进制特征。</p><p id="bba5" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们将检查随机二元特征的方框图。</p><div class="lu lv lw lx fd ab cb"><figure class="mq ij nt ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/de58f2a6172449f62c5681888d68128e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*Y7W9ndby-jlNQJ9LtM7o2w.jpeg"/></div></figure><figure class="mq ij nu ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/ed9e336191234f8c0c313001a92ec937.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*Z9TjcxaoFK-FT7XJ_BX9hQ.jpeg"/></div></figure></div><div class="ab cb"><figure class="mq ij nv ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/67711f89355313920c890d5ea04f9f12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*sDlT3lVOtoXEBYOMYarudw.jpeg"/></div></figure><figure class="mq ij nw ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/024d19dc011717adf82dc36d045cd1c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*hDNTOhkQ2YghrcNBafzgvA.jpeg"/></div></figure></div><div class="ab cb"><figure class="mq ij nx ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/eee53c9a822bf54658619abbf0bfc13c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*w2kfKn3aF00bZ-d9TQ2qew.jpeg"/></div></figure><figure class="mq ij ny ms mt mu mv paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/44f3d469d25ae1b92f5100b61757f22f.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*Eumh8WnMvGVNOdnee8M9sA.jpeg"/></div></figure></div><p id="409e" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">绘制箱线图以了解每个特征对目标变量的影响是很麻烦的。我们需要提出一个特征过滤器来选择一个对目标变量有影响的过滤器。</p><p id="dc6c" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们需要了解给定特征的1和0的分布。</p><p id="bf4b" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">如果大多数行具有相同的值，即0或1，那么该特定特征可以被认为是整个数据的常数。</p><p id="0dc7" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们将绘制条形图来显示特定功能的0和1的计数。</p><figure class="lu lv lw lx fd ij"><div class="bz dy l di"><div class="nj lz l"/></div></figure><figure class="lu lv lw lx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es nz"><img src="../Images/c8a772d1cf2533f9e65cbed0c231ca13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YG9ZhP8lg6wMuLEY63GHbg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">二进制特征的零和一的计数</figcaption></figure><p id="2ad4" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">观察结果:</p><ul class=""><li id="0400" class="ld le hh ix b iy iz jc jd jg lr jk ls jo lt js li lj lk ll bi translated">在这里，我们观察到有许多特征的多数计数为零。这些特征在预测目标变量时没有用，因为它们在大多数行中保持不变。</li><li id="8326" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">我们将检查这些特征的方差，并拒绝那些低价值的特征。</li></ul><h1 id="829f" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">首次切割方法</h1><p id="8292" class="pw-post-body-paragraph iv iw hh ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js ha bi translated">基于之前的解决方案，在完成EDA之后，我计划遵循以下步骤:</p><ol class=""><li id="50a0" class="ld le hh ix b iy iz jc jd jg lr jk ls jo lt js oa lj lk ll bi translated">移除重复要素。</li><li id="356a" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js oa lj lk ll bi translated">检查具有二进制值的要素的方差，并移除值非常低的要素。</li><li id="68c8" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js oa lj lk ll bi translated">移除相关特征。</li><li id="8f44" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js oa lj lk ll bi translated">根据二元特征对随机森林回归模型R分数的影响向下选择二元特征。我们将根据kaggle第二篇文章中提到的方法进行前向特征选择。</li><li id="6e7e" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js oa lj lk ll bi translated">输入到ML模型中的分类特征编码。</li><li id="37ea" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js oa lj lk ll bi translated">我们将考虑过滤后的特征集，并进行降维以获得新的特征</li><li id="8f12" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js oa lj lk ll bi translated">基于与目标变量的相关性(相关性&gt; 0.65)选择的双向和三向交互的新特征</li><li id="e373" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js oa lj lk ll bi translated">识别异常值。</li></ol><ul class=""><li id="9934" class="ld le hh ix b iy iz jc jd jg lr jk ls jo lt js li lj lk ll bi translated">对用于分析的要素进行分组:</li></ul><p id="69d9" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">特征集1 (F1) -二进制编码分类特征+过滤特征</p><p id="e11f" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">特征集2 (F2) -目标编码分类特征+过滤特征</p><p id="4da0" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">特征集3(F3)-目标编码分类特征+过滤特征+ 2/3向特征交互</p><p id="8df5" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">特征集4 (F4)-目标编码分类特征的降维特征</p><p id="c0a5" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">特征集5(F5)-目标编码分类特征的降维特征+ 2/3向特征交互</p><ul class=""><li id="94d5" class="ld le hh ix b iy iz jc jd jg lr jk ls jo lt js li lj lk ll bi translated">我们将考虑对以下列出的模型进行上述各项功能的培训(F1至F5):</li></ul><p id="8cf7" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">随机森林，</p><p id="8bcb" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">梯度推进决策树，</p><p id="fafe" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">树外和</p><p id="63cb" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">弹性网</p><p id="e31f" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">上述模型的堆叠模型</p></div><div class="ab cl kw kx go ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ha hb hc hd he"><h1 id="2d3c" class="jt ju hh bd jv jw ob jy jz ka oc kc kd ke od kg kh ki oe kk kl km of ko kp kq bi translated">特征工程</h1><p id="1df9" class="pw-post-body-paragraph iv iw hh ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js ha bi translated">正如Firstcut中指出的，我们将过滤和修改特征—</p><ol class=""><li id="5e51" class="ld le hh ix b iy iz jc jd jg lr jk ls jo lt js oa lj lk ll bi translated"><strong class="ix hi">掉落特征</strong></li></ol><p id="68f9" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">在EDA中，我们确定了某些无用的特征——“ID”和“X4”。</p><p id="8235" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们将删除重复的功能。</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="56a2" class="mg ju hh mc b fi mh mi l mj mk"><em class="og"># Identifying the duplicate feature names and storing them in numpy array<br/></em>duplicate_feat <strong class="mc hi">=</strong> car_data_new_X<strong class="mc hi">.</strong>T[car_data_new_X<strong class="mc hi">.</strong>T<strong class="mc hi">.</strong>duplicated()]<strong class="mc hi">.</strong>index<strong class="mc hi">.</strong>to_numpy()</span><span id="995f" class="mg ju hh mc b fi oh mi l mj mk"><em class="og"># Dropping Duplicate features from dataset</em><br/>car_data_new_X <strong class="mc hi">=</strong> car_data_new_X<strong class="mc hi">.</strong>drop(duplicate_feat,axis<strong class="mc hi">=</strong>1)</span></pre><p id="afc3" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">以下特征是重复的—</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="c128" class="mg ju hh mc b fi mh mi l mj mk">‘X35’, ‘X37’, ‘X39’, ‘X76’, ‘X84’, ‘X93’, ‘X94’, ‘X102’, ‘X107’, ‘X113’, ‘X119’, ‘X122’, ‘X134’, ‘X146’, ‘X147’, ‘X172’, ‘X199’, ‘X213’, ‘X214’, ‘X216’, ‘X222’, ‘X226’, ‘X227’, ‘X232’, ‘X233’, ‘X235’, ‘X239’, ‘X242’, ‘X243’, ‘X244’, ‘X245’, ‘X247’, ‘X248’, ‘X253’, ‘X254’, ‘X262’, ‘X266’, ‘X268’, ‘X279’, ‘X289’, ‘X290’, ‘X293’, ‘X296’, ‘X297’, ‘X299’, ‘X302’, ‘X320’, ‘X324’, ‘X326’, ‘X330’, ‘X347’, ‘X360’, ‘X364’, ‘X365’, ‘X382’, ‘X385’</span></pre><p id="4af7" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">现在，我们的模型需要在提供给我们的测试数据(test.csv)上表现良好。我们需要用所有的训练数据来训练我们的模型。只有在kaggle上提交测试数据的模型预测，才能知道模型性能。</p><p id="e638" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">但是，为了亲自检查一个训练好的模型的性能，我们需要在具有目标变量的看不见的数据上测试该模型。为此，我们将利用训练数据本身。</p><p id="e8b6" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">因此，在对功能进行进一步修改之前，我们将把train.csv中的数据拆分为训练和测试数据。我们将把提供给我们的10%的训练数据视为测试数据。</p><p id="1444" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">特征工程将在列车数据上完成。测试数据将是我们的模型看不见的数据，我们可以检查模型的性能。</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="de7f" class="mg ju hh mc b fi mh mi l mj mk"><strong class="mc hi">from</strong> sklearn.model_selection <strong class="mc hi">import</strong> train_test_split</span><span id="a8e3" class="mg ju hh mc b fi oh mi l mj mk"><em class="og"># Train test split of data after duplicate feature removal</em><br/>X_train, X_test, y_train, y_test <strong class="mc hi">=</strong> train_test_split(car_data_new_X, <br/>                                                    car_data_new_y, <br/>                                                    test_size<strong class="mc hi">=</strong>0.1, <br/>                                                    random_state<strong class="mc hi">=</strong>42)</span></pre><p id="4b39" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">为了进一步处理，我们将考虑X_train。</p><p id="739b" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><strong class="ix hi"> 2。丢弃具有低方差的二进制特征</strong></p><p id="5893" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们检查所有二元特征的方差。</p><figure class="lu lv lw lx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es oi"><img src="../Images/aebac4b3ba20659ba961789b9ec798a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*afQYdny3-zuN6MvIrSVmDA.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">二元特征方差。(x轴是特征列表)</figcaption></figure><p id="9e0c" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">从图中我们可以观察到，有许多特征的方差接近于零(我们在柱状图中的推断)。我们将丢弃方差接近于零的特征</p><p id="a42a" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">让我们将最大方差(0.25)的5%(任意)视为低方差阈值，即0.0125</p><p id="fe3b" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">当我们选择方差&gt; 0.05*0.25的特征时，我们有以下具有新的低方差值的特征。</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="a19f" class="mg ju hh mc b fi mh mi l mj mk">Feature Variance<br/>X47     0.013029<br/>X106    0.013029<br/>X211    0.013543<br/>X159    0.013543<br/>X371    0.013799</span></pre><p id="4b9a" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">让我们看看0和1在最小和最大方差特征中的分布情况。</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="8714" class="mg ju hh mc b fi mh mi l mj mk"><em class="og"># Following two features were identified to have minimum and maximum variance </em></span><span id="a71f" class="mg ju hh mc b fi oh mi l mj mk"><em class="og"># value count of least variance feature</em><br/>X_train['X106'].value_counts()</span><span id="7fc7" class="mg ju hh mc b fi oh mi l mj mk">output:</span><span id="9b63" class="mg ju hh mc b fi oh mi l mj mk">0    3738<br/>1      50</span><span id="e646" class="mg ju hh mc b fi oh mi l mj mk"><em class="og"># value count of max variance feature</em><br/>X_train['X127'].value_counts()</span><span id="f2b0" class="mg ju hh mc b fi oh mi l mj mk">output:</span><span id="ed79" class="mg ju hh mc b fi oh mi l mj mk">0    1907<br/>1    1881</span></pre><p id="1dda" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们可以确保要素类别(0/1)的人口数至少为50。具有最大方差的一个将具有几乎相等的0和1类别的数字。</p><p id="a004" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">以下121个特征由于低方差而被拒绝。</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="87b9" class="mg ju hh mc b fi mh mi l mj mk">'X10', 'X11', 'X15', 'X16', 'X17', 'X18', 'X21', 'X24', 'X26', 'X30', 'X32', 'X33', 'X34', 'X36', 'X40', 'X41', 'X42', 'X44', 'X53', 'X55', 'X57', 'X59', 'X60', 'X62', 'X63', 'X65', 'X67', 'X74', 'X77', 'X78', 'X83', 'X86', 'X87', 'X88', 'X89', 'X90', 'X91', 'X92', 'X95', 'X97', 'X99', 'X104', 'X105', 'X110', 'X112', 'X123', 'X124', 'X125', 'X145', 'X153', 'X160', 'X165', 'X167', 'X169', 'X173', 'X183', 'X184', 'X190', 'X192', 'X195', 'X196', 'X200', 'X204', 'X205', 'X207', 'X210', 'X212', 'X217', 'X221', 'X230', 'X236', 'X237', 'X240', 'X249', 'X252', 'X257', 'X258', 'X259', 'X260', 'X267', 'X269', 'X270', 'X271', 'X274', 'X277', 'X278', 'X280', 'X281', 'X282', 'X288', 'X291', 'X292', 'X295', 'X298', 'X305', 'X307', 'X308', 'X309', 'X310', 'X312', 'X317', 'X318', 'X319', 'X323', 'X325', 'X332', 'X335', 'X338', 'X339', 'X341', 'X344', 'X353', 'X357', 'X366', 'X369', 'X370', 'X372', 'X379', 'X380', 'X383', 'X384'</span><span id="e347" class="mg ju hh mc b fi oh mi l mj mk"><em class="og"># Droping Rejected from Train data</em><br/>car_data_X_train = X_train.drop(Feature_Bi_reject,axis =1)</span></pre><p id="e50d" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><strong class="ix hi"> 3。特征关联</strong></p><p id="f641" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们需要检查彼此相关的特征，因为其中一个是冗余特征。检查两个特征之间关系的一种方法是找出它们的相关性。我们将评估大熊猫特征的皮尔逊相关性。</p><p id="1b07" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">如果相关性在范围[0，1]内，则两个特征以正斜率彼此线性相关，否则，如果相关性在范围[-1，0]内，则两个特征以负斜率彼此线性相关，如果斜率为零，则没有相关性。</p><p id="e607" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">这是使用seaborn得到的热图</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="a879" class="mg ju hh mc b fi mh mi l mj mk"><em class="og"># correlation evaluation of filtered dataset</em><br/>Correlation_mat = car_data_X_train.corr('pearson')</span><span id="ca67" class="mg ju hh mc b fi oh mi l mj mk"><em class="og"># Correlation heatmap on subset of features. Example plot as the feature size is large.</em><br/>plt.figure(figsize=(8,6))<br/>sb.heatmap(abs(Correlation_mat.iloc[120:130,120:130]),annot=<strong class="mc hi">True</strong>)<br/>plt.title('Correlation plot of selected features')<br/>plt.show()</span></pre><figure class="lu lv lw lx fd ij er es paragraph-image"><div class="er es oj"><img src="../Images/efde295c1217e32504c98a7aa21ba9df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*mexw81VPhpZbgyrj8E5IgQ.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">二元特征相关矩阵的热图</figcaption></figure><p id="f7d0" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">上面的图只捕捉到几个特征。为了得到相关性高于0.9的特征列表，我们可以扫描完整相关性矩阵的下三角矩阵。</p><p id="f37a" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">例如，在上面的图中，我们将考虑在下三角形中有0.99的“X229”，并将其从特性列表中删除，同时保留特性“X228”。类似地，功能“X251”将被删除。</p><figure class="lu lv lw lx fd ij"><div class="bz dy l di"><div class="nj lz l"/></div></figure><p id="2c66" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">以下34个特征被识别为与其他特征相关。我们将拒绝这些功能。</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="1a2a" class="mg ju hh mc b fi mh mi l mj mk">'X54', 'X66', 'X101', 'X120', 'X129', 'X137', 'X140', 'X150', 'X162', 'X166', 'X194', 'X198', 'X215', 'X238', 'X250', 'X251', 'X263', 'X264', 'X265', 'X272', 'X276', 'X311', 'X314', 'X328', 'X346', 'X348', 'X352', 'X358', 'X362', 'X363', 'X367', 'X368',<br/>'X371', 'X378'</span></pre><p id="a726" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">经过上述步骤，我们在数据中有164个特征，其中有7个分类特征和157个二元特征。</p><p id="8748" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><strong class="ix hi"> 4。特征过滤</strong></p><p id="56f5" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">给定数据可能包含对预测影响不大/没有贡献的二元特征。移除这样的特征加速了计算。但是我们不能简单地放弃功能。我们将考虑通过选择有助于提高ML模型的R值的特征来减少特征的数量。我们将考虑随机森林回归模型进行过滤。我们将在Randomforest中使用100棵树作为估计值，最大深度为10，最小样本分裂计数为5。树的分裂标准是均方误差。</p><p id="06e0" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">所采用的过滤方法—</p><ul class=""><li id="2256" class="ld le hh ix b iy iz jc jd jg lr jk ls jo lt js li lj lk ll bi translated">特征最初被赋予统一的权重。对于前25个时期，用随机选择的10个特征(统一权重= 1/157 = 0.00636)训练模型，并记录分数。在25个时期后，我们开始将每个时期的分数与前25个时期的平均分数进行比较，并观察该特定时期的分数是否有提高。</li><li id="63e7" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">如上所述，所选特征的权重值基于其在每个时期对模型分数的影响而增加或减少0.2倍。分数是3倍交叉验证r2分数的平均值。在每个历元中的权重修改之后，权重被归一化。随着权重的修改，在接下来的迭代中基于其权重选择特征。</li><li id="afc1" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">多次迭代后，当权重超过阈值(0.1)时，该特征被选为最佳特征，并将从特征列表中移除，从而为选择其他重要特征腾出空间。这些特征经历了2000个时代。如果在2000个纪元完成之前选择了100个特征，我们将结束迭代。</li></ul><p id="2916" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">注:使用的模型不是数据的最佳模型。在这里，我们通过比较随机选择的特征集得分之间的差异来识别特征。诸如时期数、增量因子、阈值等参数是任意选择。</p><p id="86f5" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">这种正向特征选择的方法参考:<a class="ae iu" href="https://www.kaggle.com/c/mercedes-benz-greener-manufacturing/discussion/36390" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/Mercedes-benz-greener-manufacturing/discussion/36390</a></p><figure class="lu lv lw lx fd ij"><div class="bz dy l di"><div class="nj lz l"/></div></figure><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="1882" class="mg ju hh mc b fi mh mi l mj mk"><em class="og"># Getting the best binary features from car_data_X_train using feature filter which is run for 2000 epochs</em><br/>best_features,scores = feature_filter(car_data_X_train.iloc[:,7:],y_train,2000)</span></pre><p id="a614" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">2000个纪元后选择的特征数量为:95(如下所列)</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="b69e" class="mg ju hh mc b fi mh mi l mj mk">'X189', 'X261', 'X127', 'X313', 'X316', 'X29', 'X136', 'X128', 'X191', 'X350', 'X157', 'X159', 'X234', 'X275', 'X171', 'X156', 'X178', 'X31', 'X315', 'X118', 'X48', 'X148', 'X223', 'X103', 'X185', 'X28', 'X43', 'X334', 'X186', 'X224', 'X187', 'X14', 'X132', 'X51', 'X80', 'X256', 'X46', 'X108', 'X300', 'X286', 'X47', 'X218', 'X180', 'X337', 'X100', 'X64', 'X377', 'X354', 'X168', 'X158', 'X163', 'X273', 'X114', 'X246', 'X304', 'X351', 'X179', 'X45', 'X115', 'X155', 'X19', 'X202', 'X12', 'X126', 'X49', 'X355', 'X349', 'X336', 'X151', 'X98', 'X331', 'X81', 'X142', 'X130', 'X306', 'X22', 'X69', 'X96', 'X111', 'X220', 'X376', 'X68', 'X13', 'X75', 'X85', 'X343', 'X255', 'X203', 'X71', 'X197', 'X61', 'X301', 'X285', 'X27', 'X208'</span></pre><p id="0813" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">让我们画出每个时期的分数</p><figure class="lu lv lw lx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ok"><img src="../Images/77f409cf683c7f138175bec46d5bab41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lK8w-yNUKXU5OD8uIspL9A.jpeg"/></div></div></figure><p id="0610" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">这里我们看到r2分数随着时期数增加超过200而降低。我们可以推断，对分数具有高影响的特征随着时期的数量而减少。因此，我们可以得出结论，过滤工作符合预期。</p><p id="856f" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">在250个时期内选择得分高于0.3特征。</p><p id="1d76" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">因此，过滤后我们有7个分类特征和95个最佳二进制特征。总共102个特征。</p><p id="9076" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><strong class="ix hi"> 5。特征编码</strong></p><p id="ad9c" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">现在我们将修改分类特征。分类要素具有文本格式的变量。这些文本必须转换成数值，以便由ML模型处理。在将特征类别转换为数字时，我们需要保持特征的含义。我们可以使用二进制编码或目标编码。我们将使用这两种编码并检查模型的性能。</p><p id="6a81" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">二进制编码:</p><p id="ddc5" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">在这种编码中，要素的类别被转换为二进制值，其中值对于类别是唯一的。长度将等于表示要素中唯一值总数的最大二进制值长度。</p><p id="8994" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">例如，我们可以考虑具有总共47个独特类别的特征X0。在下图中，我们可以看到第一行训练数据中的类别被转换为二进制值1，第二行是二进制值2，依此类推。这些二进制数被转换成多个二进制特征。这里我们看到特征X0由6个新特征表示。这需要代表47个独特的类别。以类似的方式，其他特征被转换。</p><p id="4ff4" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">下面的代码显示了编码器的定义</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="032a" class="mg ju hh mc b fi mh mi l mj mk"><em class="og"># Binary Encoder Definition for categorical feature. </em><br/><em class="og"># drop_invariant set to true to avoid generating columns with no variance</em><br/>Bi_encoder_X0 <strong class="mc hi">=</strong> ce<strong class="mc hi">.</strong>BinaryEncoder(drop_invariant<strong class="mc hi">=True</strong>)</span><span id="e0cc" class="mg ju hh mc b fi oh mi l mj mk"><em class="og"># Fitting encoder and Transforming the categorical feature in train data</em><br/>X0_bi <strong class="mc hi">=</strong> Bi_encoder_X0<strong class="mc hi">.</strong>fit_transform(car_data_X_train['X0'])</span><span id="96b6" class="mg ju hh mc b fi oh mi l mj mk"># Similarly for other features seperate encoders are defined to fit particular feature</span></pre><div class="lu lv lw lx fd ab cb"><figure class="mq ij ol ms mt mu mv paragraph-image"><img src="../Images/59eb1fbf7921cfd8fc0ebf3fa0fd9a67.png" data-original-src="https://miro.medium.com/v2/resize:fit:202/format:webp/1*xRaTgTB7HBceju_31jxTYw.jpeg"/></figure><figure class="mq ij om ms mt mu mv paragraph-image"><img src="../Images/09ee350420f728e07fb40d95f53d870c.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*PF7CDfnaITDpaD9Vo3nu8w.jpeg"/></figure></div><p id="8bfe" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">目标编码:</p><p id="0d35" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">这种编码将特征的类别转换为值，该值是给定目标值属于该类别的目标变量的平均值。考虑特征X1，该特征的类别“aa”被替换为平均目标值99.9451(这是被选择的属于组“aa”的那些目标变量的平均值)。</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="5ba0" class="mg ju hh mc b fi mh mi l mj mk"><em class="og"># Target Encoder definition</em><br/>X0_encdr <strong class="mc hi">=</strong> ce<strong class="mc hi">.</strong>TargetEncoder()</span><span id="ec4a" class="mg ju hh mc b fi oh mi l mj mk"><em class="og"># Fit and Transform train data using the above encoder</em><br/>X0_enc_ft <strong class="mc hi">=</strong> X0_encdr<strong class="mc hi">.</strong>fit_transform(X_train['X0'],y_train)</span><span id="2fae" class="mg ju hh mc b fi oh mi l mj mk"># Similarly for other features seperate encoders are defined to fit particular feature</span></pre><div class="lu lv lw lx fd ab cb"><figure class="mq ij on ms mt mu mv paragraph-image"><img src="../Images/2ed4e0409f19f60f7e294a819e0e1250.png" data-original-src="https://miro.medium.com/v2/resize:fit:270/format:webp/1*KwG1KYWwmGbz67fa1vrjfw.jpeg"/></figure><figure class="mq ij oo ms mt mu mv paragraph-image"><img src="../Images/a6f068b218528622e08f4ab3629676e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*4agNotREYZG5z6s9G1BA4Q.jpeg"/></figure></div><p id="fda2" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><strong class="ix hi"> 6。维度缩减</strong></p><p id="69f5" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们将考虑使用PCA、SVD和ICA技术对特征矩阵进行降维。</p><p id="9451" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">这些技术将数据转换为一组新的维度，这些维度具有相互正交/独立的基向量。</p><p id="c5c5" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们将为每种缩减技术选择20个组件，因为它们捕获总方差的95%以上，并对过滤的特征和目标编码特征进行拟合和变换。</p><p id="f61a" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">最后将所有60个特征(20x3)组合起来作为我们数据的新特征。我们将检查并移除相关特征。这些过滤后特征集将用于模型训练。</p><figure class="lu lv lw lx fd ij"><div class="bz dy l di"><div class="nj lz l"/></div></figure><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="41a4" class="mg ju hh mc b fi mh mi l mj mk"><em class="og"># Percentage of total variance of original data explained by 20 tSVD components</em><br/>sum(tSVD.explained_variance_ratio_)</span><span id="e9ae" class="mg ju hh mc b fi oh mi l mj mk">output: 0.9799840598582905</span></pre><p id="e135" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">使用'<em class="og"> get_corr_features' </em>函数识别相关特征。以下特征的相关性高于0.9。因此它们被拒绝。</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="8cdf" class="mg ju hh mc b fi mh mi l mj mk">'tSVD_0','tSVD_1','tSVD_2','tSVD_3','tSVD_7','tSVD_9',                      'tSVD_10','tSVD_11','tSVD_12','tSVD_14','tSVD_15','tSVD_17',                      'tSVD_18','tSVD_19'</span></pre><p id="ada0" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><strong class="ix hi"> 7。二元特征的双向和三向交互</strong></p><p id="93c9" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">为了找到最佳的双向和三向特征交互，我们将使用itertools模块，以元组的形式列出两个和三个特征的可能组合，如下所示。</p><p id="e29f" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">[('X10 '，' X11 ')，(' X10 '，' X12')]，<br/> [('X10 '，' X11 '，' X12 ')，(' X10 '，' X11 '，' X13')])</p><p id="4ee3" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">总数如下所示。</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="5489" class="mg ju hh mc b fi mh mi l mj mk"><strong class="mc hi">from</strong> <strong class="mc hi">itertools</strong> <strong class="mc hi">import</strong> combinations</span><span id="7822" class="mg ju hh mc b fi oh mi l mj mk"><em class="og"># Generating tuples of two and three feature combination using column names </em></span><span id="b714" class="mg ju hh mc b fi oh mi l mj mk">two_feat_combi = list(combinations(Binary_ft,2))<br/>three_feat_combi = list(combinations(Binary_ft,3))</span></pre><p id="1079" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">可能的两个特征组合的数量:48516 <br/>可能的三个特征组合的数量:5013320</p><p id="e75f" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">对于每个组合，特征值被加总，并且其与目标变量的相关性被评估。相关性&gt; 0.65的组合被视为新特征。</p><figure class="lu lv lw lx fd ij"><div class="bz dy l di"><div class="nj lz l"/></div></figure><p id="ac7b" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">确定了以下两个特征组合</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="16a5" class="mg ju hh mc b fi mh mi l mj mk">X136_X314 <br/>X263_X314<br/>X314_X315</span></pre><p id="300f" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">对于三个特征相互作用，识别出334个组合。当我们增加现有的维度时，我们不能考虑所有的组合。我们将考虑三种功能交互的前10种组合。这个数字是任意选择的。</p><p id="886e" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">该列表如下所示。</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="9663" class="mg ju hh mc b fi mh mi l mj mk">X47_X263_X314<br/>X62_X263_X314<br/>X136_X221_X314<br/>X136_X261_X315<br/>X136_X314_X315<br/>X221_X263_X314<br/>X261_X263_X315<br/>X263_X267_X314<br/>X263_X314_X315<br/>X263_X314_X344</span></pre><p id="c0d2" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><strong class="ix hi"> 8。局部异常因素</strong></p><p id="81e0" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">为了避免在离群数据上拟合模型，我们需要识别离群数据。识别异常值的方法是评估给定数据的LOF值。</p><p id="d4ec" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">Xi的LOF =(Xi邻居的平均LRD)/(Xi的LRD)</p><p id="3763" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">在哪里，</p><p id="74d2" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">LRD =局部可达性密度=(给定点的邻域数/可达性距离之和)</p><p id="b0db" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">可达性距离=从给定点到邻居的最大距离。</p><p id="f7f6" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">LRD表示所选点附近的拥挤程度。当LRD对于邻居来说很高而对于给定点来说相对较小时，那么该给定点可能是异常值。</p><p id="6c45" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们将考虑给定数据点的10个邻居来评估LOF值</p><p id="d3b9" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">评估每一行的局部异常值因子，其中一个具有远离一个的值(LOF≥|1.5|)</p><p id="add9" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们将分别检查目标编码数据和二进制编码数据中的异常值。</p><p id="f7df" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">对于目标编码数据—</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="55a7" class="mg ju hh mc b fi mh mi l mj mk"><strong class="mc hi">from</strong> <strong class="mc hi">sklearn.neighbors</strong> <strong class="mc hi">import</strong> LocalOutlierFactor</span><span id="9638" class="mg ju hh mc b fi oh mi l mj mk"><em class="og"># defining LOF evaluator function and predicting outliers</em><br/>LOF_clf = LocalOutlierFactor(n_neighbors=10)<br/>LOF_pred = LOF_clf.fit_predict(car_data_X_train_enc,y_train)</span><span id="eb56" class="mg ju hh mc b fi oh mi l mj mk"><em class="og"># Storing identified outlier rows by the LOF classifier</em><br/>outlier_car_row = []<br/><strong class="mc hi">for</strong> i <strong class="mc hi">in</strong> range(len(car_data_X_train_enc)):<br/>    <strong class="mc hi">if</strong> LOF_pred[i] == -1 :<br/>        outlier_car_row.append(i)</span><span id="9f51" class="mg ju hh mc b fi oh mi l mj mk">print('Outliers index identified by model fit_predict :<strong class="mc hi">\n</strong>',outlier_car_row)</span></pre><p id="393a" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">285行被识别为目标编码+最佳特征数据集的异常值</p><p id="8219" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">对于二进制编码的数据—</p><pre class="lu lv lw lx fd mb mc md me aw mf bi"><span id="c34e" class="mg ju hh mc b fi mh mi l mj mk">LOF_clf_bi = LocalOutlierFactor(n_neighbors=10,) <br/>LOF_pred_bi = LOF_clf_bi.fit_predict(car_data_X_train,y_train)</span><span id="d573" class="mg ju hh mc b fi oh mi l mj mk"><em class="og"># Storing identified outlier rows by the LOF classifier</em><br/>outlier_car_row_bi = []<br/><strong class="mc hi">for</strong> i <strong class="mc hi">in</strong> range(len(car_data_X_train)):<br/>    <strong class="mc hi">if</strong> LOF_pred_bi[i] == -1 :<br/>        outlier_car_row_bi.append(i)</span><span id="0fdd" class="mg ju hh mc b fi oh mi l mj mk">print('Outliers index identified by model fit_predict :<strong class="mc hi">\n</strong>',outlier_car_row_bi)</span></pre><p id="0497" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">对于二进制编码+最佳特征数据集，96行被识别为异常值</p><p id="a607" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">异常值预测器识别异常值的行号。我们需要获取这些行的索引来删除pandas train数据集中的特定行。</p><p id="169a" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们可以研究带有异常值的模型性能，然后我们可以移除异常值以检查其对性能的影响。</p><p id="3f98" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我们将以此结束特征工程部分。</p><p id="3f1b" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated"><strong class="ix hi">我们将在本研究的第二部分深入探讨ML模型的培训及其表现……</strong></p><p id="6d60" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">转到第二部分(<a class="ae iu" href="https://sachinbu.medium.com/mercedes-benz-greener-manufacturing-a-machine-learning-case-study-part-2-1f4e7a1ef8a8" rel="noopener">T5】链接T7)</a></p><h1 id="06b0" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">参考</h1><ul class=""><li id="59b1" class="ld le hh ix b iy kr jc ks jg lf jk lg jo lh js li lj lk ll bi translated">应用人工智能课程—<a class="ae iu" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">https://www.appliedaicourse.com/</a></li><li id="8c27" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated"><a class="ae iu" href="https://www.kaggle.com/c/mercedes-benz-greener-manufacturing/data" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/Mercedes-benz-greener-manufacturing/data</a></li><li id="7f61" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated"><a class="ae iu" href="https://www.kaggle.com/c/mercedes-benz-greener-manufacturing/discussion/37700" rel="noopener ugc nofollow" target="_blank"> Kaggle第一名解决方案</a></li><li id="6320" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated"><a class="ae iu" href="https://www.kaggle.com/c/mercedes-benz-greener-manufacturing/discussion/36390" rel="noopener ugc nofollow" target="_blank"> Kaggle第二名解决方案</a></li><li id="3356" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated"><a class="ae iu" href="https://www.kaggle.com/c/mercedes-benz-greener-manufacturing/discussion/36126" rel="noopener ugc nofollow" target="_blank"> Kaggle第三名解决方案</a></li><li id="8b3e" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated"><a class="ae iu" rel="noopener" href="/swlh/greener-manufacturing-with-machine-learning-6ec77d0e7a91"> Harshwardhan Jadhav的博客</a></li><li id="baa0" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated"><a class="ae iu" rel="noopener" href="/analytics-vidhya/detailed-solution-to-mercedes-benz-green-manufacturing-competition-on-kaggle-7b85c84a3ff5"> Nitish Sawants博客</a></li><li id="e473" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated"><a class="ae iu" rel="noopener" href="/analytics-vidhya/mercedes-benz-greener-manufacturing-74a932ae0693">阿迪蒂亚·潘迪的博客</a></li><li id="ba3a" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">r _ squared—<a class="ae iu" href="https://en.wikipedia.org/wiki/Coefficient_of_determination" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Coefficient_of_determination</a></li><li id="8a7a" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">方差—<a class="ae iu" href="https://en.wikipedia.org/wiki/Variance" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Variance</a></li><li id="bf48" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">相关性—<a class="ae iu" href="https://en.wikipedia.org/wiki/Correlation" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Correlation</a></li><li id="2e3e" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">PCA-<a class="ae iu" href="https://www.youtube.com/watch?v=fkf4IBRSeEc" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=fkf4IBRSeEc</a></li><li id="0dc0" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">奇异值分解—<a class="ae iu" href="https://www.youtube.com/watch?v=nbBvuuNVfco" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=nbBvuuNVfco</a>，<a class="ae iu" href="https://www.youtube.com/watch?v=9vJDjkx825k&amp;t=81s" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=9vJDjkx825k&amp;t = 81s</a><a class="ae iu" href="https://www.youtube.com/watch?v=epoHE2rex0g" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=epoHE2rex0g</a></li><li id="e085" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">ICA—<a class="ae iu" href="https://en.wikipedia.org/wiki/Independent_component_analysis" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/Independent _ component _ analysis</a></li><li id="8054" class="ld le hh ix b iy lm jc ln jg lo jk lp jo lq js li lj lk ll bi translated">https://en.wikipedia.org/wiki/Local_outlier_factor-<a class="ae iu" href="https://en.wikipedia.org/wiki/Local_outlier_factor" rel="noopener ugc nofollow" target="_blank">LOF</a></li></ul><p id="1722" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">我感谢应用人工智能课程团队和导师Amar Sharma在案例研究中对我的指导。</p><h1 id="414e" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">开源代码库</h1><p id="128b" class="pw-post-body-paragraph iv iw hh ix b iy kr ja jb jc ks je jf jg kt ji jj jk ku jm jn jo kv jq jr js ha bi translated">本案例研究的第1部分和第2部分的完整分析详情记录在我的Github页面上的Jupyter笔记本中。</p><div class="op oq ez fb or os"><a href="https://github.com/sain1905/ML_Case_Study_Merc_Benz_Green_Mfg" rel="noopener  ugc nofollow" target="_blank"><div class="ot ab dw"><div class="ou ab ov cl cj ow"><h2 class="bd hi fi z dy ox ea eb oy ed ef hg bi translated">GitHub-sain 1905/ML _ Case _ Study _ Merc _ Benz _ Green _ Mfg:机器学习笔记本</h2><div class="oz l"><h3 class="bd b fi z dy ox ea eb oy ed ef dx translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="pa l"><p class="bd b fp z dy ox ea eb oy ed ef dx translated">github.com</p></div></div><div class="pb l"><div class="pc l pd pe pf pb pg io os"/></div></div></a></div><p id="2ee3" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">支持文件:</p><p id="e8e1" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">上述所有EDA和特征工程都包含在Case _ Study _ 1 _ EDA _ FE _ Sachin _ BU _ 1 . ipynb中</p><p id="5ea8" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">要旨—<a class="ae iu" href="https://gist.github.com/sain1905" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/sain1905</a></p><h1 id="0ca0" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">商务化人际关系网</h1><div class="op oq ez fb or os"><a href="https://www.linkedin.com/in/sachin-b-u-9075a57b/" rel="noopener  ugc nofollow" target="_blank"><div class="ot ab dw"><div class="ou ab ov cl cj ow"><h2 class="bd hi fi z dy ox ea eb oy ed ef hg bi translated">Sachin B U -产品开发工程师-外科硕士| LinkedIn</h2><div class="oz l"><h3 class="bd b fi z dy ox ea eb oy ed ef dx translated">查看Sachin B U在全球最大的职业社区LinkedIn上的个人资料。Sachin有3份工作列在他们的…</h3></div><div class="pa l"><p class="bd b fp z dy ox ea eb oy ed ef dx translated">www.linkedin.com</p></div></div><div class="pb l"><div class="ph l pd pe pf pb pg io os"/></div></div></a></div><p id="3a71" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">请分享你的评论。</p><p id="545d" class="pw-post-body-paragraph iv iw hh ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js ha bi translated">你可以通过邮件联系到我——sain1905@gmail.com</p></div></div>    
</body>
</html>