<html>
<head>
<title>Using Data Science to Analyze the Premier League</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用数据科学分析英超</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/using-data-science-to-analyze-the-premier-league-b468c5b836ba?source=collection_archive---------16-----------------------#2021-03-07">https://medium.com/analytics-vidhya/using-data-science-to-analyze-the-premier-league-b468c5b836ba?source=collection_archive---------16-----------------------#2021-03-07</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/3554fd698c3e4db86e5ca7c66cc6717e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XuFycdZNI0IWx9ZQgQ0LjQ.jpeg"/></div></div></figure><p id="dfe6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">想要一个更技术性的方法来赢得你的体育赌注？这里有一些创建数据可视化的方法来帮助你实现这一点。我们将使用来自http://www.football-data.co.uk/data.php的数据集。足球-数据有各种不同的足球联赛，你可以使用。对于这篇文章，我们将使用2020-21赛季的初级联赛数据集。这是一个免费的数据集，可以通过CSV文件下载。它拥有本赛季英超联赛的最新数据。本文的数据可视化是截至2021年3月7日的最新数据。我们将使用Pandas和Matplotlib在Python中编码。</p></div><div class="ab cl jo jp go jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="ha hb hc hd he"><p id="2841" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">首先，直接从网站上读入数据。我们可以通过编写以下代码来实现这一点:</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="5047" class="ke kf hh ka b fi kg kh l ki kj"><em class="kk">import pandas as pd<br/>import matplotlib.pyplot as plt<br/>from matplotlib import cm</em></span><span id="cb29" class="ke kf hh ka b fi kl kh l ki kj">df =pd.read_csv('http://www.footballdata.co.uk/mmz4281/2021/E0.csv')<br/>print(df)</span></pre><p id="4af9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">接下来，我们想看看主场和客场的进球数。来自footballdata.co.uk的数据并没有汇总，而是按游戏排序。为了找出谁是主场得分最高的球队，我们可以使用下面的代码对主场球队进行分组，并对他们在主场的进球数进行求和。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="01ca" class="ke kf hh ka b fi kg kh l ki kj"><strong class="ka hi"># slicing the df so we can find the number of goals from a Home Team<br/># FTHG = Full Time Home Goals</strong></span><span id="91de" class="ke kf hh ka b fi kl kh l ki kj">hometeam = df.loc[:,['HomeTeam','FTHG']]</span><span id="d7f3" class="ke kf hh ka b fi kl kh l ki kj">hometeam = hometeam.groupby('HomeTeam',as_index = False)['FTHG'].sum().sort_values(by = 'FTHG', ascending=True)</span></pre><p id="5fe0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在数据已经可以绘制了，我们可以使用Matplotlib。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="a6d5" class="ke kf hh ka b fi kg kh l ki kj"><strong class="ka hi"># Plotting the DF </strong></span><span id="e110" class="ke kf hh ka b fi kl kh l ki kj">hometeam.plot(kind= 'bar', x = 'HomeTeam', y='FTHG',alpha =0.6)<br/>plt.style.use('fivethirtyeight')<br/>plt.ylabel('Home Team Goals')<br/>plt.xticks(rotation=90)<br/>plt.legend('')<br/>plt.xlabel('')<br/>plt.title('Home Team Goals by Premier League Teams 2020-2021',fontsize=15)<br/>plt.legend('')<br/>plt.rcParams.update({'font.size':10})<br/>plt.show()</span></pre><figure class="jv jw jx jy fd ii er es paragraph-image"><div class="er es km"><img src="../Images/eaab10eb40786ddd524115591f7a5803.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*AqQwjJh73yriqvNzaSmyLA.png"/></div></figure><p id="ed58" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里没有惊喜。曼城是本赛季球门前最具杀伤力的主队。接下来可以看一支客场球队的进球数。我们可以应用类似的方法。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="1107" class="ke kf hh ka b fi kg kh l ki kj"><strong class="ka hi"># Slicing the data</strong><br/>awayteam = df.loc[:,['AwayTeam','FTAG']]</span><span id="1681" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi"># Finding the number of away team goals</strong><br/>awayteam = awayteam.groupby('AwayTeam',as_index = False)['FTAG'].sum().sort_values(by = 'FTAG', ascending=True)</span></pre><p id="b713" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，客队的数据已经可以绘制出来了。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="aa49" class="ke kf hh ka b fi kg kh l ki kj"><strong class="ka hi"># plotting the DF</strong></span><span id="57e4" class="ke kf hh ka b fi kl kh l ki kj">awayteam.plot(kind= 'bar', x = 'AwayTeam', y='FTAG',alpha = 0.6)<br/>plt.style.use('fivethirtyeight')<br/>plt.ylabel('Away Team Goals')<br/>plt.xticks(rotation=90)<br/>plt.title('Away Team Goals by Premier League Teams 2020-2021',fontsize=15)<br/>plt.legend('')<br/>plt.xlabel('')<br/>plt.rcParams.update({'font.size':10})<br/>plt.show()</span></pre><figure class="jv jw jx jy fd ii er es paragraph-image"><div class="er es kn"><img src="../Images/30de5e72e295fabf1cbc4da6fb11b9a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*HKAlKtY7WxU0nddUlVgOIQ.png"/></div></figure><p id="6d5c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">有趣的是，就进球数而言，莱斯特城是最好的客场球队。接下来，我们来看看最有效的团队。我们会用两个指标来判断球队的效力:进球数和失球数。最有效率的球队会有最多的进球和最少的失球。为此，我们需要两个数据框架——进球数和失球数。然后我们可以使用。join()将两个数据帧连接在一起。我们先来算一下球队的总进球数。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="f6d3" class="ke kf hh ka b fi kg kh l ki kj"><strong class="ka hi"># Cleaning the data to find the number of goals scored<br/># FTHG = Full Time Home Goals<br/># FTAG = Full Time Away Goals</strong></span><span id="fc0d" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi"># Finding out number of goals scored by home and away and sorting </strong>numberofgoalscoredaway= awayteam.sort_values(by = 'AwayTeam', ascending=True)<br/>numberofgoalscoredhome = hometeam.sort_values(by = 'HomeTeam', ascending=True)</span><span id="6999" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi"># Merging the two dataframes together</strong>  <br/>numberofgoalscored = numberofgoalscoredhome.join(numberofgoalscoredaway)</span><span id="7d17" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi"># Finding out the total number of goals</strong><br/>numberofgoalscored['Total Goals Scored'] = numberofgoalscored.FTHG + numberofgoalscored.FTAG</span><span id="06e0" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi"># Cleaning the data<br/></strong>numberofgoalscored = numberofgoalscored.drop(columns= ['HomeTeam'])<br/>numberofgoalscored['Team']  = numberofgoalscored['AwayTeam']<br/>numberofgoalscored = numberofgoalscored.drop(columns = 'AwayTeam')</span><span id="826c" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi"># Reordering columns</strong><br/>numberofgoalscored = numberofgoalscored[['Team','FTAG','FTHG','Total Goals Scored']]</span></pre><p id="5d46" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">用类似的方法，我们来计算一下球队的总失球数。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="d9f0" class="ke kf hh ka b fi kg kh l ki kj"><strong class="ka hi"># Starting another dataframe to find the number of goals conceded </strong><br/>concededmostgoalsconceded = df.loc[:,['HomeTeam', 'AwayTeam', 'FTHG', 'FTAG']]</span><span id="bee9" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi"># Finding the number of goals conceded by summing the total # of goals conceded at home and away<br/></strong>hometeamconceded = mostgoalsconceded.groupby('HomeTeam',as_index = False)['FTAG'].sum().sort_values(by = 'FTAG', ascending=True)<br/>awayteamconceded = mostgoalsconceded.groupby('AwayTeam',as_index = False)['FTHG'].sum().sort_values(by = 'FTHG', ascending=True)</span><span id="581d" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi"># Merging the two dataframes together<br/></strong>totalgoalsconceded = awayteamconceded.join(hometeamconceded)</span><span id="a5d5" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi">#finding out the total number of goals conceded</strong><br/>totalgoalsconceded['Total Goals Conceded'] = totalgoalsconceded.FTHG + totalgoalsconceded.FTAG</span><span id="bee5" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi"># Cleaning the data</strong><br/>totalgoalsconceded['Team'] = totalgoalsconceded['AwayTeam']<br/>totalgoalsconceded = totalgoalsconceded.drop(columns= ['HomeTeam','AwayTeam'])<br/>totalgoalsconceded = totalgoalsconceded[['Team','FTHG','FTAG','Total Goals Conceded']]</span></pre><p id="1063" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最后，合并失球总数和进球数数据框。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="063f" class="ke kf hh ka b fi kg kh l ki kj"><strong class="ka hi"># Merging the two dataframes</strong><br/>mosteffectiveteam = totalgoalsconceded.join(numberofgoalscored['Total Goals Scored'])</span><span id="4916" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi"># Cleaning the data </strong><br/>mosteffectiveteam = mosteffectiveteam.reset_index()<br/>mosteffectiveteam = mosteffectiveteam.drop(columns='index')<br/>mosteffectiveteam = mosteffectiveteam.drop(columns= ['FTAG','FTHG'])</span><span id="23aa" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi"># Creating an acronym for Tottenham's name so it's easier to plot</strong><br/>mosteffectiveteam.iloc[7,0] = 'T.H.'</span><span id="2c5e" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi"># Creating a ratio of goals/conceded goals to find out how effective the team is</strong><br/>mosteffectiveteam['Goals/Conceded Goals'] = mosteffectiveteam['Total Goals Scored']/ mosteffectiveteam['Total Goals Conceded']</span><span id="5b2b" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi"># Sorting values to get data ready to plot on Matplotlib's scatter plot</strong><br/>mosteffectiveteam = mosteffectiveteam.sort_values(by='Goals/Conceded Goals',ascending=True)</span></pre><p id="1295" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，让我们来看看谁是最有效的团队。</p><pre class="jv jw jx jy fd jz ka kb kc aw kd bi"><span id="22d8" class="ke kf hh ka b fi kg kh l ki kj"><strong class="ka hi"># Creating a color map for the scatterplot<br/></strong>colors = cm.Blues(np.linspace(0,1,len(mosteffectiveteam)))</span><span id="2432" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi"># Plotting the most effective team<br/></strong>ax = mosteffectiveteam.plot(x = 'Total Goals Conceded', y = 'Total Goals Scored', kind = 'scatter', s = 150, figsize = (15,10),color = colors)</span><span id="d89d" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi"># Plotting the labels for the scatter plot<br/></strong>mosteffectiveteam[['Total Goals Conceded','Total Goals Scored','Team']].apply(lambda x: ax.text(*x),axis=1)</span><span id="8977" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi"># Making the labels bigger<br/></strong>plt.rcParams.update({'font.size': 14})<br/>plt.tick_params(axis='x', labelsize=14)<br/>plt.tick_params(axis='y', labelsize=14)</span><span id="2e56" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi"># Inverting x axis so the least number of goals is on the right side instead of left<br/></strong>plt.gca().invert_xaxis()</span><span id="7531" class="ke kf hh ka b fi kl kh l ki kj"><strong class="ka hi"># Labeling the data<br/></strong>plt.xlabel('Total Goals Conceded', fontsize=18)<br/>plt.ylabel('Total Goals Scored', fontsize=16)<br/>cmap = cm.get_cmap('Spectral')<br/>plt.title('Who is the most effective team in the Premier League?', fontsize= 20)<br/>plt.show()</span></pre><figure class="jv jw jx jy fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ko"><img src="../Images/de2bfcebb0d7a052ddbb3bfc4f9019c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RRXBq7gSLKfTDmuNmMtX3A.png"/></div></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">蓝色越深，团队越有效。曼城是迄今为止最有效率的球队。</figcaption></figure><p id="bd0a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">正如你所看到的，有许多方法来操作英超联赛数据集。这是另一个例子，我使用了列名FTR(全职结果)和HTR(半职结果)。我们现在可以使用这些列名来查看结果(赢、输、平)在半场结束后是否发生了变化。例如，如果结果在中场休息时打平，那么在全职后结果是否保持打平？</p><figure class="jv jw jx jy fd ii er es paragraph-image"><div class="er es kt"><img src="../Images/a4694ea280939b6e2c663324a7104d45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*JT6FFpYCpq6X7pfk5MYMpw.png"/></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">英超联赛的大多数结果在半场结束后并没有改变。如果你想看这段代码，请访问我在文章底部的Github链接。</figcaption></figure><p id="5b1d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">该数据集还包括Bet365等欧洲热门体育博彩网站的数据。我们可以看看365猜多少次赢的队伍。请记住，这只考虑了主队赔率和客队赔率。出于解释的目的，我决定忽略平局的可能性。</p><figure class="jv jw jx jy fd ii er es paragraph-image"><div class="er es kt"><img src="../Images/213010f8300048d5f82b1515cecb4a5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*NQkNcCrF47pcyAR1OehlfQ.png"/></div><figcaption class="kp kq et er es kr ks bd b be z dx translated">Bet365在大约2/3的时间里对结果是正确的。如果你想看代码，请访问我在文章底部的github链接。</figcaption></figure><p id="62db" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在<a class="ae jn" href="http://www.linkedin.com/in/andrewlmoore2020" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>上关注我</p><p id="02eb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如果你想深入了解代码，这里有<a class="ae jn" href="https://github.com/drewm8080/Analyzing-the-Premier-League.git" rel="noopener ugc nofollow" target="_blank"> Github库</a></p></div></div>    
</body>
</html>