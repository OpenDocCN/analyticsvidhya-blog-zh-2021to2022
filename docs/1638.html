<html>
<head>
<title>Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">线性回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/linear-regression-6b642119533a?source=collection_archive---------17-----------------------#2021-03-10">https://medium.com/analytics-vidhya/linear-regression-6b642119533a?source=collection_archive---------17-----------------------#2021-03-10</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><h1 id="22b7" class="if ig hi bd ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc bi translated">什么是线性回归，它是如何工作的？</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/5fafcfab6af6a47a83cef4755f967797.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D7jWS0mzTArhnjHI8DTpVg.jpeg"/></div></div></figure><p id="7f97" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jr hj">线性回归</strong>是一种有监督的机器学习算法，其中预测的输出是连续的，并且具有恒定的斜率。线性回归模型在因变量和自变量之间具有线性关系。</p><p id="cbc2" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">设x为自变量，y为因变量。我们将定义这两个变量之间的线性关系如下:</p><pre class="je jf jg jh fd kn ko kp kq aw kr bi"><span id="755c" class="ks ig hi ko b fi kt ku l kv kw">y = a_0 + a_1*x</span></pre><p id="8495" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">其中a_1是直线的斜率，a_0是y轴截距。该等式将用于预测y的值。在继续学习算法之前，让我们先来看两个重要概念，以了解线性回归。</p><ul class=""><li id="a013" class="kx ky hi jr b js jt jw jx ka kz ke la ki lb km lc ld le lf bi translated"><strong class="jr hj">损失函数:</strong>是用来求a_1和a_0的最佳值的函数。我们将通过以下步骤使用均方误差:</li></ul><ol class=""><li id="6120" class="kx ky hi jr b js jt jw jx ka kz ke la ki lb km lg ld le lf bi translated">对于给定的x，求y的实际值和预测值之差。</li><li id="adfd" class="kx ky hi jr b js lh jw li ka lj ke lk ki ll km lg ld le lf bi translated">求差额的平方</li><li id="e8b6" class="kx ky hi jr b js lh jw li ka lj ke lk ki ll km lg ld le lf bi translated">求x的每一个值的平方的平均值。</li></ol><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lm"><img src="../Images/6c897cb88ac374aa00b4f94cf8c57c2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*iXSaTk2VeR-izOqkHcch8Q.png"/></div></figure><ul class=""><li id="fac2" class="kx ky hi jr b js jt jw jx ka kz ke la ki lb km lc ld le lf bi translated"><strong class="jr hj">梯度下降算法:</strong>是一种用于寻找函数最小值的优化算法。在线性回归中，通过更新a_1和a_0的值来最小化成本函数。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ln"><img src="../Images/61a6135f89161ab8808f2b3c2e71bfe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*TbI6IVw6tJnPpy5otCvOmA.png"/></div></figure><p id="4e80" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">想象一个U形山谷。假设我们的目标是到达最底部的位置。我们从最高的位置开始。有一个难题，你只能走不连续的几步才能到达底部。如果你决定一次迈出一步，你最终会到达谷底，但这需要更长的时间。如果你每次都选择走更长的路，你会更快到达，但是，有可能你会越过谷底，而不是正好在谷底。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lo"><img src="../Images/42c34bbd102f8db571a9e0478d3d592a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*UfBHJC8dyf6beDDnzCt6gg.png"/></div></figure><p id="b57e" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">在梯度下降算法中，你走的步数就是学习率。这决定了算法多快收敛到最小值。为了更新a_1和a_0，我们从损失函数中取梯度。为了找到这些梯度，我们对a_1和a_0求偏导数。</p><p id="e746" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">偏导数是梯度，它们用于更新a_1和a_0的值。α是学习率，它是一个超参数。较小的学习率可以让你更接近最小值，但需要更多的时间来达到最小值，较大的学习率收敛更快，但有可能超过最小值。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lp"><img src="../Images/12175d9c526e0fe9e84db66ef5e3251b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W8sxCSS6GYLqYTVMvI2Csw.png"/></div></div></figure><p id="286f" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jr hj">线性回归选择标准:</strong></p><ul class=""><li id="dcf5" class="kx ky hi jr b js jt jw jx ka kz ke la ki lb km lc ld le lf bi translated">分类和回归能力</li><li id="4996" class="kx ky hi jr b js lh jw li ka lj ke lk ki ll km lc ld le lf bi translated">数据质量(异常值会影响)</li><li id="5c9b" class="kx ky hi jr b js lh jw li ka lj ke lk ki ll km lc ld le lf bi translated">计算的复杂性</li></ul><p id="3d13" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jr hj">实现:</strong>我已经使用了这个<a class="ae lq" href="http://bit.ly/w-data" rel="noopener ugc nofollow" target="_blank">数据集</a>，它由学生的分数和学生学习的小时数组成。我们的目的是预测学生的分数。</p><ul class=""><li id="d997" class="kx ky hi jr b js jt jw jx ka kz ke la ki lb km lc ld le lf bi translated"><strong class="jr hj">代码使用上面讨论的损失函数和梯度下降。</strong></li></ul><pre class="je jf jg jh fd kn ko kp kq aw kr bi"><span id="016e" class="ks ig hi ko b fi kt ku l kv kw">#import required libraries<br/>import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt  <br/>%matplotlib inline<br/><br/>#reading data from given link<br/>url = "http://bit.ly/w-data"<br/>df = pd.read_csv(url)<br/><br/>X = df.iloc[:, 0]<br/>Y = df.iloc[:, 1]<br/>plt.scatter(X, Y)<br/>plt.show()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lr"><img src="../Images/da8e7dbe111d4d4c8c00d91cb160acf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*XUJAPlABXjGlgGZF5y6HTg.png"/></div></figure><pre class="je jf jg jh fd kn ko kp kq aw kr bi"><span id="b3f9" class="ks ig hi ko b fi kt ku l kv kw"># Building the model<br/>m = 0<br/>c = 0<br/><br/>L = 0.0001  # The learning Rate<br/>epochs = 1000  # The number of iterations to perform gradient descent<br/><br/>n = float(len(X)) # Number of elements in X<br/><br/># Performing Gradient Descent <br/>for i in range(epochs): <br/>    Y_pred = m*X + c  # The current predicted value of Y<br/>    D_m = (-2/n) * sum(X * (Y - Y_pred))  # Derivative wrt m<br/>    D_c = (-2/n) * sum(Y - Y_pred)  # Derivative wrt c<br/>    m = m - L * D_m  # Update m<br/>    c = c - L * D_c  # Update c<br/><br/>print (m, c)</span></pre><p id="2d83" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi">9.896964110671043 1.6314708810783134</p><pre class="je jf jg jh fd kn ko kp kq aw kr bi"><span id="53ce" class="ks ig hi ko b fi kt ku l kv kw">Y_pred = m*X + c<br/><br/>plt.scatter(X, Y)<br/>plt.plot([min(X), max(X)], [min(Y_pred), max(Y_pred)], color='red') # predicted<br/>plt.show()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ls"><img src="../Images/3d02d944c8cb10149dbd0f9cd80b5f3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*ZKiSwfb7Xv6hBUyPBReBDQ.png"/></div></div></figure><ul class=""><li id="976b" class="kx ky hi jr b js jt jw jx ka kz ke la ki lb km lc ld le lf bi translated"><strong class="jr hj">代码使用sci-kit学习库可以在这里找到</strong><a class="ae lq" href="https://github.com/prachi-agrawal1179/TSF-internship/blob/master/TSF%20Task1.ipynb" rel="noopener ugc nofollow" target="_blank"><strong class="jr hj"/></a><strong class="jr hj">。</strong></li></ul><p id="7752" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">线性回归用于评估和分析趋势和销售估计，评估金融部门和保险领域的风险等。</p><p id="8947" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated"><strong class="jr hj">结论:</strong>线性回归是一种非常有用且简单的机器学习算法。</p><p id="bf79" class="pw-post-body-paragraph jp jq hi jr b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km hb bi translated">希望这篇文章对你有所帮助。继续学习！</p></div></div>    
</body>
</html>