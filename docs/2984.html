<html>
<head>
<title>What is an Imbalanced Data? How to handle imbalanced data in python?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是不平衡数据？python中如何处理不平衡数据？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/what-is-an-imbalanced-data-how-to-handle-imbalanced-data-in-python-e6067792950f?source=collection_archive---------9-----------------------#2021-05-28">https://medium.com/analytics-vidhya/what-is-an-imbalanced-data-how-to-handle-imbalanced-data-in-python-e6067792950f?source=collection_archive---------9-----------------------#2021-05-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="2e84" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在机器学习中，有时当我们解决分类类型的问题时，我们会看到一个类别的准确率为95%(类别1)，而另一个类别的准确率仅为7.5%(类别0)。我们可能会想，为什么在我们的项目中会出现这种不相称的精确度呢？为了理解这种比例失调背后的原因，我们需要首先理解以下几点</p><ol class=""><li id="1204" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">什么是不平衡数据集？</li><li id="9db1" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">不平衡分类和不平衡分类(数据集)之间有什么区别？</li><li id="d94a" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">为什么不平衡数据集是一个问题？</li></ol></div><div class="ab cl jq jr go js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="ha hb hc hd he"><figure class="jy jz ka kb fd kc er es paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="er es jx"><img src="../Images/de7e68c6e66efb1f1a346aa8940cc198.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8luJnK6NmrMWTmG34Kejfw.jpeg"/></div></div></figure><h1 id="0651" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">什么是不平衡数据集？</h1><p id="02a8" class="pw-post-body-paragraph ie if hh ig b ih lh ij ik il li in io ip lj ir is it lk iv iw ix ll iz ja jb ha bi translated">不平衡数据集可以定义为“分类预测建模问题，其中样本在类中的分布不相等。”即，等级分布不相等或接近相等，而是有偏差或偏斜的。为了更容易理解，让我们举个例子。</p><figure class="jy jz ka kb fd kc er es paragraph-image"><div class="er es lm"><img src="../Images/b49d156d819913fe7299c03001f6fa2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*b0SO6SwFXy-EGkH2JBR6oQ.png"/></div></figure><p id="5264" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是H1-B签证数据集。在该数据集中，已认证的案例状态接近280万，即96.2%，而被拒绝的案例为94364，即数据集的3.2%。这种类型的数据不均匀分布被称为不平衡。</p><p id="f70b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个问题在异常检测至关重要的情况下尤为突出，例如:-</p><ul class=""><li id="8223" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb ln ji jj jk bi translated">癌症等罕见疾病的识别；肿瘤等，</li><li id="12f8" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ln ji jj jk bi translated">银行中的欺诈交易</li><li id="b305" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ln ji jj jk bi translated">确定客户流失率(即继续使用某项服务的客户比例)</li><li id="a586" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ln ji jj jk bi translated">垃圾邮件等。</li></ul><h1 id="b65d" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">不平衡分类和不平衡分类的区别</h1><ul class=""><li id="d469" class="jc jd hh ig b ih lh il li ip lo it lp ix lq jb ln ji jj jk bi translated">不平衡指的是曾经平衡而现在不再平衡的阶级分布。</li><li id="2441" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb ln ji jj jk bi translated">不平衡是指一个阶层分布本来就不平衡。</li></ul><h1 id="acd3" class="kj kk hh bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">为什么不平衡数据集是一个问题？</h1><p id="3268" class="pw-post-body-paragraph ie if hh ig b ih lh ij ik il li in io ip lj ir is it lk iv iw ix ll iz ja jb ha bi translated">在我们有不平衡数据集的情况下，使用传统机器学习模型开发的预测模型可能有偏差、不准确，并且倾向于产生不令人满意的分类器。</p><p id="1c52" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">像决策树和逻辑回归这样的标准分类算法偏向于有几个实例的类。他们倾向于只预测大部分的类数据。少数类的特征被当作噪音，常常被忽略。因此，与多数阶级相比，少数阶级被错误分类的可能性很高。</p><p id="527e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是因为机器学习算法通常旨在通过减少错误来提高准确性。因此，它们没有考虑到阶级分布/比例或阶级平衡。</p><p id="d02e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于大多数案例或任何业务问题，我们主要关注的是少数群体。我们希望模型关注少数阶级，但同时不忽视多数阶级。</p></div><div class="ab cl jq jr go js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="ha hb hc hd he"><h1 id="56c8" class="kj kk hh bd kl km lr ko kp kq ls ks kt ku lt kw kx ky lu la lb lc lv le lf lg bi translated">如何修复数据集不平衡？</h1><p id="465b" class="pw-post-body-paragraph ie if hh ig b ih lh ij ik il li in io ip lj ir is it lk iv iw ix ll iz ja jb ha bi translated">可用于修复数据集不平衡的技术有:-</p><p id="22ed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 1。对数据集进行重采样:- </strong></p><p id="93aa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这种策略中，我们专注于在将数据作为输入提供给机器学习算法之前，平衡训练数据中的类(数据预处理)。</p><p id="4b19" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">平衡班级的主要目的是增加少数班级的频率或减少多数班级的频率。这样做是为了获得两个类大约相同数量的实例。从不平衡的数据集生成平衡数据集的两种方法是欠采样和过采样。</p><p id="06b4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 1.1。欠采样</strong></p><p id="a9aa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">欠采样通过减少丰富类的大小来平衡数据集。当数据量足够时，使用这种方法。通过将所有样本保存在稀有类中，并在丰富类中随机选择相同数量的样本，可以检索一个平衡的新数据集用于进一步建模。</p><p id="501f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 1.2。过采样</strong></p><p id="c3d5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">相反，当数据量不足时，使用过采样。它试图通过增加稀有样本的大小来平衡数据集。不是去除大量样本，而是通过使用例如重复、引导或SMOTE(合成少数过采样技术)来生成新的稀有样本。</p><p id="a083" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意，一种重采样方法相对于另一种方法没有绝对优势。这两种方法的应用取决于它所应用的用例以及数据集本身。过采样和欠采样的组合通常也是成功的。</p><p id="ee94" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 2。使用K倍交叉验证:- </strong></p><p id="85a6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">值得注意的是，在使用过采样方法解决不平衡问题时，应适当应用交叉验证。</p><p id="ee89" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请记住，过采样获取观察到的稀有样本，并应用于bootstrap以基于分布函数生成新的随机数据。如果在过采样之后应用交叉验证，基本上我们所做的就是使我们的模型过度适应特定的人工引导结果。这就是为什么交叉验证应该总是在过采样数据之前进行，就像应该如何实现特征选择一样。只有通过重复重采样数据，才能将随机性引入数据集中，以确保不会出现过拟合问题。</p><p id="5bfd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> 3。聚类多数类:- </strong></p><p id="56d9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">不是依赖随机样本来覆盖训练样本的多样性，而是将丰富的类聚类成r个组，其中r是r中的病例数。对于每个组，仅保留medoid(聚类的中心)。然后只使用稀有类和medoids训练模型。</p></div><div class="ab cl jq jr go js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="ha hb hc hd he"><h1 id="f9ea" class="kj kk hh bd kl km lr ko kp kq ls ks kt ku lt kw kx ky lu la lb lc lv le lf lg bi translated">结论</h1><p id="95a6" class="pw-post-body-paragraph ie if hh ig b ih lh ij ik il li in io ip lj ir is it lk iv iw ix ll iz ja jb ha bi translated">我们现在终于理解了不平衡数据的含义。不平衡数据集和不平衡数据集之间的区别。由于不平衡数据而出现的问题，以及如何克服或修复这种类型的数据。如果您对本文有任何疑问或建议，请随时通过电子邮件与我联系。快乐学习！</p></div></div>    
</body>
</html>