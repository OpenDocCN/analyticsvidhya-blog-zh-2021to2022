<html>
<head>
<title>The maths behind linear regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">线性回归背后的数学</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/the-maths-behind-linear-regression-12bb72431b00?source=collection_archive---------5-----------------------#2021-05-16">https://medium.com/analytics-vidhya/the-maths-behind-linear-regression-12bb72431b00?source=collection_archive---------5-----------------------#2021-05-16</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="aa42" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">考虑一个由两个变量<strong class="ig hi"> x </strong>和<strong class="ig hi"> y </strong>表征的现象。</p><p id="dbdf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">观察完这一现象后，我们现在处理一个样本数据集。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/4a772b73d2f82fa54e160f82d44af5a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*Dldc10LKZO-bmR8JbDj_IQ.png"/></div></figure><h1 id="020a" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak">目标:我们想找到一个将x和y联系起来的数学公式</strong></h1><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ki"><img src="../Images/3f5120542d254de007c78ac05cf656e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:226/format:webp/1*BHlTH536S993MOIVlyGlcQ.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">这个公式将允许我们预测<strong class="bd jm"> x </strong>的未观测值的<strong class="bd jm"> y </strong>的值</figcaption></figure><p id="4359" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">合理的开始是创建数据集的散点图，以了解<strong class="ig hi"> y </strong>相对于<strong class="ig hi"> x. </strong>如何变化</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kn"><img src="../Images/41a4e2c75fa7e6a8813220f5d5f4c7ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*COQDJz6UYt1vd-K7f21BCw.png"/></div></div></figure><p id="f838" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">散点图表明<strong class="ig hi"> x </strong>和<strong class="ig hi"> y </strong>之间的关系几乎是<strong class="ig hi">线性的，因此，我们假设:</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ks"><img src="../Images/b2a90fc5a416ccfbeb0e424d264effe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:280/format:webp/1*ivjwsNpDCrWBR75obQzVKw.png"/></div></figure><p id="e165" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">其中<strong class="ig hi"> a </strong>和<strong class="ig hi"> b </strong>为待定常数。</p><p id="2ce6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">问题:</strong>这个公式可以根据<strong class="ig hi"> a </strong>和<strong class="ig hi"> b. </strong>的值表示无限多条线</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kn"><img src="../Images/8e3e4cb87f814223a7c88604cd153da5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_vhVl3O35BJfbCuBXuyfXQ.png"/></div></div></figure><p id="483c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">解</strong>:找出<strong class="ig hi"> a </strong>和<strong class="ig hi"> b </strong>的值，其中<strong class="ig hi"> y(x) </strong>最符合数据集。</p><p id="c860" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这就是线性回归发挥作用的地方。</p><p id="15c2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">线性回归是一种模型，用于在自变量<strong class="ig hi"> x </strong>和因变量<strong class="ig hi"> y </strong>之间建立线性关系。</p><blockquote class="kt ku kv"><p id="aea7" class="ie if kw ig b ih ii ij ik il im in io kx iq ir is ky iu iv iw kz iy iz ja jb ha bi translated"><strong class="ig hi">我们可以认为线性回归是一种优化方法。</strong></p></blockquote><h1 id="8ffb" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak">最小二乘法:</strong></h1><p id="2690" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">最小二乘法是可用于根据数据集确定两个参数<strong class="ig hi"> a </strong>和<strong class="ig hi"> b </strong>值的几种方法之一。</p><p id="35af" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个想法是计算<strong class="ig hi"> a </strong>和<strong class="ig hi"> b </strong>的值，它们对应于<strong class="ig hi">误差平方和</strong>的最小值。</p><p id="8739" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">错误的定义如下:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lf"><img src="../Images/809d330630d6ea990b8d580e5a818deb.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*XeTmAJS1YyfXIa0xKjSHOA.png"/></div></figure><p id="f74f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">其中:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lg"><img src="../Images/64f009bba1b44ece06925be9cb6c608f.png" data-original-src="https://miro.medium.com/v2/resize:fit:44/format:webp/1*5WjR0TrQeTYtrLZv1eO9dg.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">y的精确值</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lh"><img src="../Images/fe1998240d252b4ef438b34b0260baeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:124/format:webp/1*XBCnm8ZGdNgfxk-GLHWjyw.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">y的预测值</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kn"><img src="../Images/ab7f7394b3c7824b46888629a7f13928.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qc_-CWQnLMjBcLDrCBi0zg.png"/></div></div></figure><p id="8595" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">误差平方和定义为:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es li"><img src="../Images/221607b6f096ab84ae567520a7e30995.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*paMwMkqIuuaKQAKkP1aNjw.png"/></div></figure><p id="a017" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">其中<strong class="ig hi"> n </strong>是数据集中样本的<strong class="ig hi">数量，在我们的例子中是4。</strong></p><p id="03b2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们想找出函数S(a，b)最小的a和b的值。</p><p id="17be" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">函数的极值(最小值或最大值)可以通过将导数设置为0来找到。<em class="kw">(只要函数在</em> <strong class="ig hi"> <em class="kw"> R </em> </strong> <em class="kw">数集中可微)</em>。</p><p id="b137" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我们的例子中，误差函数S(a，b)是一个多项式，因此在<strong class="ig hi"> R </strong>中可微，所以我们写为:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lj"><img src="../Images/f7d8ad98e03118ec0db96fd1088ec972.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*lrzsfNO5kaGCy6gBmuz6jA.png"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lk"><img src="../Images/a4171ed021d0994e42cd01df611d91d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*VOU4oGt0h2NSWi2uxZhxug.png"/></div></figure><p id="8b95" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们最终得到一个齐次方程组。</p><p id="69db" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">求解这些方程得到:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ll"><img src="../Images/65c255158142b09536d1126e236f7927.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*VE1PPyZpkNRiqLXMO09MKg.png"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ks"><img src="../Images/472a9c1936032a8e89ec72c095e972a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:280/format:webp/1*KXto8WDBw9ekwgnB5Mt7Ag.png"/></div></figure><p id="4d25" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">其中:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lm"><img src="../Images/64be57afe3214a02fcfe12080c6d6c94.png" data-original-src="https://miro.medium.com/v2/resize:fit:320/format:webp/1*4UhvEnPm16nAiv63zdVZLg.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">x的平均值</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ln"><img src="../Images/cce1948a32e0d4dadb074bdb5d70685d.png" data-original-src="https://miro.medium.com/v2/resize:fit:312/format:webp/1*gDnyafMSt64tfwDoyIKc7g.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">y的平均值</figcaption></figure><p id="5a6f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用我们分析得出的那些结果，我们计算出<strong class="ig hi"> a </strong>和<strong class="ig hi"> b </strong>的最佳值:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lo"><img src="../Images/5e6b25662b2cd8189633a4f1c4418c15.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*GgUD8DnMMGoLzehLlge_dQ.png"/></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lp"><img src="../Images/25763b76f84dd4ee46ed741236a03691.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*Vq2VvClK-8evh-5YvY6HfQ.png"/></div></figure><p id="d068" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，我们的回归模型看起来像这样:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kn"><img src="../Images/06bc85aca6a1165cc2e467cef7f7ab38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9NvZrZQnUKwrUOtDAbXUTg.png"/></div></div><figcaption class="kj kk et er es kl km bd b be z dx translated">根据数据集绘制的回归模型</figcaption></figure><h1 id="577a" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak">为什么是最小二乘法？</strong></h1><p id="b521" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">为什么要在最小化误差函数之前先平方误差？为什么不把所有的误差加起来呢？</p><p id="5c6e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">直接对误差求和的问题是误差可能是正的，也可能是负的。正数和负数往往会相互抵消。</p><p id="09b4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">假设我们有一个误差<strong class="ig hi"> e1=100 </strong>和另一个误差<strong class="ig hi">E2 =-100；</strong>两个误差之和<strong class="ig hi"> (e1+e2=0) </strong>表明我们的模型是100%准确的，但事实显然并非如此，因为误差太大了。</p><p id="b347" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，在创建误差函数之前，我们需要假设所有的误差都是正的，因此，将误差函数定义为误差的总和是行不通的。</p><p id="c6f8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要把负数转换成正数，我们一般取数的绝对值，或者我们就平方。那么为什么不取误差的绝对值呢？</p><p id="4632" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可以使用这种方法，称为<strong class="ig hi">最小绝对偏差</strong>方法。尽管如此，由于绝对值微分带来的复杂性，我们往往倾向于在回归分析中使用最小二乘法。</p><p id="a5d4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如，看一下下面的函数:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kn"><img src="../Images/b586d13ea40478b6c6c19edaa9e3d3bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nDkrMc6mXXKvKpzGWfLC3Q.png"/></div></div></figure><p id="a65f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个函数在<strong class="ig hi"> x=0 </strong>中显然是不可微的。</p><p id="f878" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用最小二乘法只是让这个过程更容易。</p><h1 id="f389" class="jk jl hh bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak">就是这样，这就是线性回归的工作原理。</strong></h1></div></div>    
</body>
</html>