<html>
<head>
<title>Novel techniques to win an Image Classification hackathon (Part-4)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">赢得图像分类黑客马拉松的新技术(第四部分)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/novel-techniques-to-win-an-image-classification-hackathon-part-4-844a14104043?source=collection_archive---------9-----------------------#2021-03-30">https://medium.com/analytics-vidhya/novel-techniques-to-win-an-image-classification-hackathon-part-4-844a14104043?source=collection_archive---------9-----------------------#2021-03-30</a></blockquote><div><div class="dt gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ew ey ig ih ii ij es et paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="es et if"><img src="../Images/b9dbf1834e0f59da0895c388e38131c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UbHg1Jf6DLX-lececnIIdg.jpeg"/></div></div></figure><p id="f53f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">欢迎来到“图像分类新技术”系列的第四部分，也是最后一部分。到目前为止，我们已经讨论了CNN模型中的迁移学习、渐进图像缩放和注意机制。以下是相同的参考链接，以防需要复习。</p><div class="jo jp fa fc jq jr"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/novel-techniques-to-win-an-image-classification-hackathon-part-1-64929dd696b7"><div class="js ab dx"><div class="jt ab ju cl cj jv"><h2 class="bd hj fj z dz jw eb ec jx ee eg hh bi translated">赢得图像分类黑客马拉松的新技术(第一部分)</h2><div class="jy l"><h3 class="bd b fj z dz jw eb ec jx ee eg dy translated">在这一系列的文章中，我将讨论一些最近开发的现代黑客技术，以赢得一个形象…</h3></div><div class="jz l"><p class="bd b fq z dz jw eb ec jx ee eg dy translated">medium.com</p></div></div><div class="ka l"><div class="kb l kc kd ke ka kf io jr"/></div></div></a></div><div class="jo jp fa fc jq jr"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/novel-techniques-to-win-an-image-classification-hackathon-part-2-e33bf0ad5fe6"><div class="js ab dx"><div class="jt ab ju cl cj jv"><h2 class="bd hj fj z dz jw eb ec jx ee eg hh bi translated">赢得图像分类黑客马拉松的新技术(下)</h2><div class="jy l"><h3 class="bd b fj z dz jw eb ec jx ee eg dy translated">欢迎来到“图像分类新技术”系列的第二部分。在第一篇文章中，我们讨论了…</h3></div><div class="jz l"><p class="bd b fq z dz jw eb ec jx ee eg dy translated">medium.com</p></div></div><div class="ka l"><div class="kg l kc kd ke ka kf io jr"/></div></div></a></div><div class="jo jp fa fc jq jr"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/novel-techniques-to-win-an-image-classification-hackathon-part-3-e45900f8ca30"><div class="js ab dx"><div class="jt ab ju cl cj jv"><h2 class="bd hj fj z dz jw eb ec jx ee eg hh bi translated">赢得图像分类黑客马拉松的新技术(第三部分)</h2><div class="jy l"><h3 class="bd b fj z dz jw eb ec jx ee eg dy translated">欢迎来到“图像分类新技术”系列的第三部分。在第一个帖子和第二个帖子中，我们…</h3></div><div class="jz l"><p class="bd b fq z dz jw eb ec jx ee eg dy translated">medium.com</p></div></div><div class="ka l"><div class="kh l kc kd ke ka kf io jr"/></div></div></a></div><p id="39e1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇文章中，我将谈到集合模型和测试时间增强，以及它们在使模型预测更加稳健方面的重要性。</p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="3f89" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">集合建模</h1><p id="338e" class="pw-post-body-paragraph iq ir hi is b it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj lr jl jm jn hb bi translated">集成建模是一个过程，其中通过使用许多不同的建模算法或使用不同的训练数据集，创建多个不同的模型来预测结果。然后，集合模型聚集每个基础模型的预测，并产生对未知数据的一次最终预测。</p><p id="b75a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用集合模型的动机是减少预测的泛化误差。只要基本模型是多样和独立的，当使用集合方法时，模型的预测误差降低。</p><p id="8e49" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这种方法在做预测时寻求大众的智慧。即使集合模型在模型中具有多个基础模型，它也作为单个模型来行动和执行。</p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="2fe9" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">测试时间增加</h1><p id="0ffe" class="pw-post-body-paragraph iq ir hi is b it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj lr jl jm jn hb bi translated">测试时数据增强(TTA)是一种可以通过在推理过程中应用增强来提高模型性能的技术，是一种用于深度学习模型的流行策略。</p><p id="a81c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对同一幅图像的多个修改版本进行推断，然后<br/>将预测结果汇总，以获得更高的整体准确性。</p><blockquote class="ls lt lu"><p id="9ddc" class="iq ir lv is b it iu iv iw ix iy iz ja lw jc jd je lx jg jh ji ly jk jl jm jn hb bi translated">与训练时间数据扩充不同，我们不需要对模型进行任何更改，因此它可以应用于已经训练好的模型！</p></blockquote><p id="fbff" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设我们有一个CNN分类器，它做出了下面的预测。</p><p id="dae1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="dv lz ma mb mc b">[0.08 0.00 <strong class="is hj">0.54</strong> 0.01 0.37 0.00 0.00 0.00 0.00 0.00]</code></p><p id="fe23" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是这张图片的真实标签:</p><p id="29b6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><code class="dv lz ma mb mc b">[0.0 0.0 0.0 0.0 <strong class="is hj">1.0</strong> 0.0 0.0 0.0 0.0 0.0]</code></p><p id="2262" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这种情况下，图像会被错误分类，因为<strong class="is hj">5级</strong>被分类为<strong class="is hj">3级</strong>。为了改善这个结果，我们可以尝试通过分类器运行不同版本的图像，看看会出现什么。让我们通过网络运行原始图像和水平翻转的图像。网络的输出现在将是两个向量:</p><pre class="md me mf mg fe mh mc mi mj aw mk bi"><span id="d234" class="ml kq hi mc b fj mm mn l mo mp">[[0.08 0.00 <strong class="mc hj">0.54</strong> 0.01 0.37 0.00 0.00 0.00 0.00 0.00]<br/> [<strong class="mc hj">0.43</strong> 0.00 0.11 0.00 0.39 0.01 0.00 0.01 0.04 0.00]]</span></pre><p id="b106" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">当我们平均这两个向量时，我们得到下面的向量:<br/> <code class="dv lz ma mb mc b">[[0.25 0.00 0.33 0.01 <strong class="is hj">0.38</strong> 0.01 0.00 0.01 0.02 0.00]]</code></p><p id="f59c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">太好了！现在最大的概率给了<strong class="is hj">5级</strong>。</p><p id="e364" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">实际上，我们不能指望测试时间的增加能解决我们所有的问题。但是，我们可以预期，当我们使用多个扩充样本而不是仅使用单个输入样本时，平均来说，我们会获得更好的性能。</p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="1593" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated"><strong class="ak">实现(系综模式)</strong></h1><p id="5ea2" class="pw-post-body-paragraph iq ir hi is b it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj lr jl jm jn hb bi translated">我们将从导入预训练的基础模型开始。</p><figure class="md me mf mg fe ij es et paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="es et mq"><img src="../Images/c48bf72963189d26bef60cd37eede95a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UMSf5KFcxVOIp6A5o-CErA.png"/></div></div></figure><p id="9acc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里，我们已经加载了基本CNN模型，并冻结了基本模型中的所有层。此外，我们还重命名了模型层，以避免名称冲突。</p><p id="7b37" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我们将定义系综模型。</p><figure class="md me mf mg fe ij es et paragraph-image"><div class="es et mr"><img src="../Images/16ada419fa71ee10188cac749bebc490.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HsdYp2lBFQu7IIg6W7JAUg.png"/></div></figure><p id="4fb9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如上图所示，来自所有3个基本模型的输入和输出被用于集合最终模型。</p><p id="328d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，模型已准备好进行训练和预测。</p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="e422" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">实现(测试时间增加)</h1><p id="e0f3" class="pw-post-body-paragraph iq ir hi is b it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj lr jl jm jn hb bi translated">我们将从定义一个定制的数据生成器开始，它将输出测试图像的增强版本。</p><figure class="md me mf mg fe ij es et paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="es et ms"><img src="../Images/b72fd7b1450629d4e66eb7cd05bd3fc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7yMj9li7pGLL13RMNeOynA.png"/></div></div></figure><p id="0037" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以参考下面的链接，了解更多关于Tensorflow和Keras中自定义数据生成器的信息。</p><div class="jo jp fa fc jq jr"><a rel="noopener follow" target="_blank" href="/@anuj_shah/creating-custom-data-generator-for-training-deep-learning-models-part-2-be9ad08f3f0e"><div class="js ab dx"><div class="jt ab ju cl cj jv"><h2 class="bd hj fj z dz jw eb ec jx ee eg hh bi translated">为训练深度学习模型创建自定义数据生成器-第2部分</h2><div class="jy l"><h3 class="bd b fj z dz jw eb ec jx ee eg dy translated">第1章:什么是python中的生成器函数以及yield和return之间的区别</h3></div><div class="jz l"><p class="bd b fq z dz jw eb ec jx ee eg dy translated">medium.com</p></div></div><div class="ka l"><div class="mt l kc kd ke ka kf io jr"/></div></div></a></div><p id="6eb3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我们将运行每组增强测试图像的模型预测，并取预测的平均值以获得最终值。</p><figure class="md me mf mg fe ij es et paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="es et mu"><img src="../Images/00f4e71e062c0d9f5534237b7e094134.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dVLVxzCfXlSHvTyqewZXyw.png"/></div></div></figure></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="c371" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">最终模型架构</h1><p id="e3b4" class="pw-post-body-paragraph iq ir hi is b it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj lr jl jm jn hb bi translated">下图显示了最终的CNN模型架构，它结合了本系列中详细介绍的所有主题。</p><figure class="md me mf mg fe ij es et paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="es et mv"><img src="../Images/d160e07c918e81382f94faa8d5ea727b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UmNHBDKoYYaAQYmm_opBtg.png"/></div></div></figure></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="318f" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">结束语</h1><p id="7e45" class="pw-post-body-paragraph iq ir hi is b it ln iv iw ix lo iz ja jb lp jd je jf lq jh ji jj lr jl jm jn hb bi translated">这是图像分类小说技巧系列文章的最后一部分。我强烈建议获得您自己的数据集(从Kaggle或使用web抓取),并尝试本系列中详细介绍的不同技术。</p><p id="e0d7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请给我留下您的意见、反馈和挑战(如果您面临任何挑战),我将与您单独联系，共同合作。</p><p id="9761" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以在下面的链接中参考本系列的代码库。</p><div class="jo jp fa fc jq jr"><a href="https://github.com/dlaststark/machine-learning-projects/tree/master/HackerEarth%20Competitions/Holiday%20Season%20Image%20Classification" rel="noopener  ugc nofollow" target="_blank"><div class="js ab dx"><div class="jt ab ju cl cj jv"><h2 class="bd hj fj z dz jw eb ec jx ee eg hh bi translated">dlaststark/机器学习项目</h2><div class="jy l"><h3 class="bd b fj z dz jw eb ec jx ee eg dy translated">集中存储库来存储和处理我所有的机器学习项目-dlaststark/machine-learning-projects</h3></div><div class="jz l"><p class="bd b fq z dz jw eb ec jx ee eg dy translated">github.com</p></div></div><div class="ka l"><div class="mw l kc kd ke ka kf io jr"/></div></div></a></div></div></div>    
</body>
</html>