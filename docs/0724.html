<html>
<head>
<title>Web Traffic Time Series Forecasting Part-2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">网络流量时间序列预测(二)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/web-traffic-time-series-forecasting-part-2-400b3e0e539b?source=collection_archive---------8-----------------------#2021-01-28">https://medium.com/analytics-vidhya/web-traffic-time-series-forecasting-part-2-400b3e0e539b?source=collection_archive---------8-----------------------#2021-01-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="7f70" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是我们系列的第二部分，系列包括-</p><ol class=""><li id="e8e7" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated"><a class="ae jl" href="https://namangupta-cs.medium.com/web-traffic-time-series-forecasting-part-1-a819b65013ec" rel="noopener">介绍和探索性数据分析</a></li><li id="a35c" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated"><a class="ae jl" href="https://namangupta-cs.medium.com/web-traffic-time-series-forecasting-part-2-400b3e0e539b" rel="noopener">功能工程、建模和部署</a></li></ol><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es jr"><img src="../Images/a3ad5d1d983ce96f3025f5ff068c69db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*4htzB81y86AG53PjcSzFjw.png"/></div></figure><p id="5a6a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在之前的博客中，我们看到了对数据的详细分析。现在，是时候开始一些功能工程和构建模型了。</p><h1 id="f65b" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">目录-</h1><ol class=""><li id="5434" class="jc jd hh ig b ih kx il ky ip kz it la ix lb jb jh ji jj jk bi translated">基线模型</li><li id="598c" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated">特征工程</li><li id="3c05" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated">建模</li><li id="24bb" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated">部署</li><li id="4d05" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated">未来的工作</li><li id="1966" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated">参考</li></ol><h1 id="9d20" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">1.基线模型-</h1><p id="9a29" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">首先，我们将仅基于数据的中位数进行预测，并将它用作我们的基线模型。</p><p id="31ce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我们将使用数据的中位数来进行预测，对于每一页，我们已经采用了每个工作日的中位数，并使用它来相应地预测接下来的62天。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="bb39" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们已经计算了每个工作日每个页面的中位数，现在我们将对Kaggle进行预测，并根据sample_submission文件的格式制作一个CSV文件。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="ebc0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在Kaggle上提交了上述预测后，下面是我们的结果。</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lh"><img src="../Images/6ec58c9a6930c3d88af58578d9a14e77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mexB3Rzgtr7R82h2FvzYKg.png"/></div></div></figure><p id="cd7b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于本次提交，我们目前在1095个团队中排名第310位</p><h1 id="c844" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">2.特征工程-</h1><p id="4a6a" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">先说一些特色工程吧！。我们将为过去15天的数据创建特征，并通过特征工程技术，我们将尝试使用其余的数据来创建过去15天的特征。正如我们看到的，7天的滞后有很高的相关性，所以我们创建的第一个特征是周-日特征。除此之外，我们将创建3个特征，这些特征具有前3天的总访问者，三天1将具有(d-1)+(d-2)+(d-3)天的流量，三天2将具有(d-4)+(d-5)+(d-6)天的流量，类似于三天3。另一个特性是weekday，顾名思义就是一周中的某一天。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="88c0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">正如我们所知，语言、访问类型和客户端类型确实会对流量产生影响，因此将这些作为特征会很有用。</p><p id="6920" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">lang_feat —它将包含语言特性。</p><p id="9309" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">agent_feat —我们为蜘蛛数据增加1，为非蜘蛛数据增加0。</p><p id="705a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">access_feat —我们将为全访问添加0个，为桌面添加1个，为移动添加2个。</p><p id="6387" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于我们正在创建过去15天的数据，所以对于上述每个页面的功能将重复15次。</p><p id="d4fb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我们将基于傅立叶变换创建特征。正如我们在分析过程中看到的，开始时有一些不必要的峰，因此，在移除一些初始值后，将取前3个峰并将其用作特征。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="8774" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">创建了我们到目前为止讨论的所有功能，将使用这些来训练模型。</p><h1 id="da67" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">迄今为止我们工作的总结和主要收获</h1><p id="0285" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">首先，我们加载了所需的库和文件。处理缺失值:</p><p id="a63f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们使用线性插值来填充连续多天没有丢失的丢失值。为了填补连续缺失值，我们使用了180天后的数据。</p><h2 id="24ff" class="lm ka hh bd kb ln lo lp kf lq lr ls kj ip lt lu kn it lv lw kr ix lx ly kv lz bi translated"><strong class="ak">数据分析:</strong></h2><ul class=""><li id="999d" class="jc jd hh ig b ih kx il ky ip kz it la ix lb jb ma ji jj jk bi translated">我发现大部分流量都在英文网页上。</li><li id="79e2" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb ma ji jj jk bi translated">与真人相比，机器人的流量很小。</li><li id="2c8b" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb ma ji jj jk bi translated">五月有最多的游客。</li><li id="7ebe" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb ma ji jj jk bi translated">工作日和周末其实没多大区别。</li><li id="04c8" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb ma ji jj jk bi translated">一年的最后三个月比一年中的其他月份平均有更多的游客。</li><li id="8fd1" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb ma ji jj jk bi translated">平均来说，英语拥有最多的访问者。</li></ul><h2 id="b46a" class="lm ka hh bd kb ln lo lp kf lq lr ls kj ip lt lu kn it lv lw kr ix lx ly kv lz bi translated">特征工程:</h2><p id="d70b" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">使用滚动窗口技术生成特征，从每个时间序列我们使用15天的数据。这些是我们在一周中的某一天生成的特征</p><ul class=""><li id="2e16" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb ma ji jj jk bi translated">第7天的访客人数</li><li id="06c8" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb ma ji jj jk bi translated">3天内最后3个时段的访客总数。</li><li id="94b3" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb ma ji jj jk bi translated">页面的语言</li><li id="2028" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb ma ji jj jk bi translated">页面的客户端(全访问、移动、桌面)</li><li id="b14b" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb ma ji jj jk bi translated">蜘蛛或真实的人流量</li><li id="5e46" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb ma ji jj jk bi translated">傅立叶变换数据的前三个峰值。</li></ul><p id="e9de" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">准备好数据模型- </strong></p><p id="cff6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，将开始基于已创建的特征构建模型。首先，将把所有的分类特征转换成一次性编码特征，并对所有的连续特征进行归一化。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="1a87" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，将我们的数据分为训练和测试。我们将把数据分成75份和25份。</p><p id="36fc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">正如我们已经讨论过的，为了评估我们的模型，我们将使用SMAPE，因为python中没有内置的函数，我们必须实现它，并且我们将使用自定义指标来评估我们的模型。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="9af3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">先说建模。</p><h1 id="02e6" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">3.模特-</h1><p id="3702" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated"><strong class="ig hi">线性回归- </strong></p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="6f3c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这些都不是好结果，应该尝试一个更强大的算法，看看这些如何执行。</p><p id="bfcf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">决策树- </strong></p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="b309" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">与线性回归相比，结果是好的，但总的来说，这些似乎不能让我们在排行榜上取得好位置。</p><p id="40e6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">随机森林- </strong></p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="078f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这些结果比决策树好得多，但请记住，我们正在使用某些特征进行预测，我们没有未来的数据，我们必须按顺序进行预测，以便进行预测并将这些预测用作未来预测的特征，因为我们将尝试预测更远的日期，所以预测中的误差将呈指数增长。因此，我们必须从排行榜上的预期分数中获得更好的分数，因为排行榜分数会比这更高。</p><p id="0a64" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> XgBoost- </strong></p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="f407" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">分数甚至超过了随机森林和决策树算法</p><h1 id="4fa5" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">所有型号的性能总结</h1><p id="bfca" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">线性回归- 0.79</p><p id="dfb3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">决策树- 0.40</p><p id="fd31" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">随机森林- 0.37</p><p id="78c6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">XgBoost — 0.43</p><p id="91ce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里表现最好的模型是随机森林，所以我们将使用它来预测Kaggle，希望它也能在排行榜上表现良好。</p><h1 id="c644" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">对Kaggle的预测</h1><p id="dd59" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">将为我们在要素工程期间创建的预测创建所有要素。现在，将结合所有特征并开始对Kaggle进行预测。尝试提交与Xgboost算法，尽管最高分，然后随机森林，xgb的表现优于随机森林在Kaggle。</p><p id="9c73" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是结果-</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mb"><img src="../Images/82981abb1eaf6dedfaf9d3b447e75071.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qwGxMpBfHAVXzfFYjyUltA.png"/></div></div></figure><p id="9a51" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这正是我所担心的，随着我们对未来日期的预测，误差确实呈指数增长，这个分数比我们提交的中值还要糟糕。现在，我们得想点别的。</p><p id="0449" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">深度学习拯救- </strong></p><p id="b756" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我也要试试LSTM。像以前一样，不会使用任何使用预测数据的功能，因为它会产生问题。</p><p id="9426" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于我们有超过145，000个时间序列，我们仅使用50%的数据来训练模型。</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="ad5b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了评估我们的模型，将使用log1p数据的平均绝对误差(MAE)。这与原始数据上的SMAPE非常相似。在最终预测之后，将对数据使用expm1将其转换回原始形式。</p><p id="d3a1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">随着时间序列，将使用三个特征，以及可以从页面名称中提取</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="0ec1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上面的代码创建了我们的模型所需的所有特征，现在我们将对所有分类特征进行标签编码，将它们整形为适当的形状以提供给模型，并将数据分为训练和测试。</p><p id="7f19" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们的数据准备好了，我们可以开始构建我们的模型架构。模型将有4个输入层(每个要素一个)，时间序列数据将通过LSTM层，所有标签编码的要素将通过嵌入层，然后我们将展平输出，以便我们可以连接所有这些层。之后，我们将使用一个密集层和一个输出层。</p><p id="a221" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该架构如下所示:</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="8c80" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，让我们看看我们模型的建筑图-</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mc"><img src="../Images/16ebf7372cf8b963069ec06aa0d239df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4a0SEC4ZNay1NyxSEX35TA.png"/></div></div></figure><p id="05d5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">正如我们已经讨论过的，log1p数据上的MAE有点类似于SMAPE，所以我们应该在排行榜上也能获得不错的分数。</p><p id="a99b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在做了预测并提交了Kaggle上的文件后，这里是我们的结果</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es md"><img src="../Images/10a0f2b4a013816717916e8e1ffd90cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F_2LVS7ELf3sG_pWSG_RHw.png"/></div></div></figure><p id="20ba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">分数很高，我们进入了排行榜的前10%和92/1095的位置。</p><p id="62bd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">试图添加一个Conv1d层来提高准确性，但似乎Kaggle得分增加。也增加了一些更多的LSTM层，但分数还是增加了。由于模型的过度拟合，可能会克服这种增加的脱落层，但它不会对分数产生太大影响，分数仍不会进一步降低。</p><h1 id="b7a2" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">对所有尝试过的模型进行比较研究</h1><figure class="js jt ju jv fd jw er es paragraph-image"><div class="er es me"><img src="../Images/1372a0c138e43066a681776625245db3.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*k7HJXRtX3xWlD77Vzps_AA.png"/></div></figure><p id="28e6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">基于树的模型不能很好地执行，它们的分数比中位数模型差，但是LSTM被证明是一个好的选择，可能原因是它们擅长于序列-序列预测。</p><h1 id="1154" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">4.部署-</h1><p id="af09" class="pw-post-body-paragraph ie if hh ig b ih kx ij ik il ky in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">如果一个模型不能到达客户手中，那么这个模型有什么用。大多数案例研究博客都跳过这一部分，但是会不遗余力。将使用flask进行部署，使用Heroku进行服务。</p><p id="5c87" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在建模部分，我们以这样一种方式训练模型，它们将预测未来64天，但这里我们只需要预测一个指定的日期。所以，我训练了LSTM，让它将过去5天的数据作为输入，而不是200天的数据，并预测第二天的数据。代码会非常相似，但如果你还想看我的代码，你可以查看我的GitHub库。现在，我们必须为预处理、特征工程和预测建立一个管道。我们不能要求用户输入最近5天的流量和页面名称本身来做一个预测。因此，我们将索引和日期作为输入，索引将对应于数据集中提到的特定页面名称，并根据日期从CSV文件中获取他想要的预测数据。Heroku给了我们500 MB的限制，仅Tensorflow模块就需要300 MB以上，因此我们无法使用完整的数据集。因此，我们将仅使用10k页面进行模型部署，而不是145k页面。</p><p id="ee40" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们从管道开始吧！</p><figure class="js jt ju jv fd jw"><div class="bz dy l di"><div class="lf lg l"/></div></figure><p id="0580" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">输出会是这样的-</p><figure class="js jt ju jv fd jw er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mf"><img src="../Images/40494488c5cb09f9ccab200e0efd5dde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NlarDXX2WVvynfCjAGLE7A.png"/></div></div></figure><p id="09f1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">好了，现在我们完成了管道，现在是使用Flask进行部署的时候了，我们还必须构建HTML页面(我会让它非常简单)。</p><p id="9571" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我们去赫罗库。因此，Heroku是免费的并且非常容易使用，我们将使用Github在Heroku上部署我们的模型。所以基本上有两个额外的文件，我们必须创建<em class="mg"> Procfile </em>(没有任何扩展名)和<em class="mg"> Requirements.txt </em></p><p id="a876" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Procfile包含需要首先运行的文件的名称，requirements.txt包含需要安装的所有模块的名称。现在，我们只需在Heroku上选择“连接到GitHub ”,搜索我们的GitHub库，然后点击“部署”。如果所有代码都正确，模型将被部署，并为您的应用程序生成一个链接。</p><p id="68bf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">完成以上所有步骤后，这里的<a class="ae jl" href="https://web-traffic-forecasting.herokuapp.com/" rel="noopener ugc nofollow" target="_blank"/>就是我们的app了。打开链接可能需要一些时间，请耐心等待。</p><h1 id="03f8" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">5.未来的工作-</h1><ol class=""><li id="8056" class="jc jd hh ig b ih kx il ky ip kz it la ix lb jb jh ji jj jk bi translated">可以尝试基于注意机制的模型，以便使用来自遥远过去的信息来改进结果。</li><li id="23ca" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated">为了改善结果，可以尝试不同类型的数据平滑和变换。</li><li id="8ea1" class="jc jd hh ig b ih jm il jn ip jo it jp ix jq jb jh ji jj jk bi translated">正如我们在现有方法中所讨论的，很少有简单的基于统计的方法被证明是相当好的，这些方法可以用来为模型提供额外的特征以改善结果。</li></ol><h1 id="77fb" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">6.参考文献-</h1><ol class=""><li id="d11b" class="jc jd hh ig b ih kx il ky ip kz it la ix lb jb jh ji jj jk bi translated"><a class="ae jl" href="https://www.kaggle.com/c/web-traffic-time-series-forecasting/discussion/43795" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/we B- traffic-time-series-forecasting/discussion/43795</a></li></ol><p id="eaf5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.<a class="ae jl" href="https://towardsdatascience.com/web-traffic-forecasting-f6152ca240cb" rel="noopener" target="_blank">https://towards data science . com/we b-traffic-forecasting-f 6152 ca 240 CB</a></p><p id="19b2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.https://cs.adelaide.edu.au/~zbyszek/Papers/p51.pdf<a class="ae jl" href="https://cs.adelaide.edu.au/~zbyszek/Papers/p51.pdf" rel="noopener ugc nofollow" target="_blank"/></p><p id="7dcc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4.<a class="ae jl" href="https://blog.octo.com/en/time-series-features-extraction-using-fourier-and-wavelet-transforms-on-ecg-data/" rel="noopener ugc nofollow" target="_blank">https://blog . octo . com/en/time-series-features-extraction-using-Fourier-and-wavelet-transforms-on-ECG-data/</a></p><p id="c799" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">5.<a class="ae jl" href="https://www.youtube.com/watch?v=mrExsjcvF4o&amp;t=830s" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=mrExsjcvF4o&amp;t = 830s</a></p><p id="ec42" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">6.<a class="ae jl" href="https://www.appliedaicourse.com/course/11/Applied-Machine-learning-course" rel="noopener ugc nofollow" target="_blank">https://www . Applied ai course . com/course/11/Applied-Machine-learning-course</a></p><p id="fb94" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您有任何疑问，请随时发表评论，或者您也可以通过<a class="ae jl" href="https://www.linkedin.com/in/naman-gupta-ds/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>联系我。你可以在这里找到我的完整项目<a class="ae jl" href="https://github.com/NamanGuptacs/web-traffic-time-series-forecasting" rel="noopener ugc nofollow" target="_blank"/>。</p></div></div>    
</body>
</html>