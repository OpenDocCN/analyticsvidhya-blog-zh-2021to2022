<html>
<head>
<title>Trade with cointegration</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">协整贸易</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/trade-with-cointegration-f1116dfc42?source=collection_archive---------2-----------------------#2021-06-17">https://medium.com/analytics-vidhya/trade-with-cointegration-f1116dfc42?source=collection_archive---------2-----------------------#2021-06-17</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="4bb5" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">介绍</h1><p id="324d" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">金融衍生品的价格将取决于其基础资产，因此具有相同基础资产的两个金融衍生品应该表现相似，即相关。在本文中，我将研究两个黄金交易所交易基金的相关性:(GLD和IAU)，然后利用它们的相关性制定交易策略。</p><h1 id="9107" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">黄金交易所交易基金</h1><p id="75de" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">要了解更多什么是ETF和黄金ETF，请参考<a class="ae ka" href="https://www.investopedia.com/articles/investing/032116/what-relationship-between-gold-and-gold-etfs-gld-iau.asp" rel="noopener ugc nofollow" target="_blank">https://www . investopedia . com/articles/investing/032116/what-relationship-between-Gold-Gold-ETFs-gld-IAU . ASP</a></p><p id="3c5d" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">GLD和IAU是两个受欢迎的黄金交易所交易基金，由不同的信托公司持有。两者都将密切跟踪黄金价格。因此，我们预计它们的回报率将遵循类似的模式。</p><h1 id="0c25" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">分布分析</h1><ol class=""><li id="b917" class="kg kh hh je b jf jg jj jk jn ki jr kj jv kk jz kl km kn ko bi translated">使用<a class="ae ka" href="https://alpaca.markets/docs/api-documentation/api-v2/" rel="noopener ugc nofollow" target="_blank">羊驼API </a>下载每日收盘价。</li><li id="b1f4" class="kg kh hh je b jf kp jj kq jn kr jr ks jv kt jz kl km kn ko bi translated">计算前一天的百分比回报</li><li id="682c" class="kg kh hh je b jf kp jj kq jn kr jr ks jv kt jz kl km kn ko bi translated">散点图(图1中)</li><li id="a953" class="kg kh hh je b jf kp jj kq jn kr jr ks jv kt jz kl km kn ko bi translated">从IAU减去GLD的每日收益</li><li id="c51f" class="kg kh hh je b jf kp jj kq jn kr jr ks jv kt jz kl km kn ko bi translated">按分位数过滤掉异常值</li><li id="9461" class="kg kh hh je b jf kp jj kq jn kr jr ks jv kt jz kl km kn ko bi translated">绘制直方图(见图2)</li></ol><p id="4860" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated"><strong class="je hi">观察</strong>:非常接近均值为零的正态分布。</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es ku"><img src="../Images/80e7c97da5a789fedf18ae613e95508b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4_5Ukpfu-3QRMtN-LmuY2A.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx translated">图一</figcaption></figure><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es lk"><img src="../Images/c21c96a869925f551ede5dd5872649a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UvtWA2sqY_M4EfPaPJYklg.png"/></div></div><figcaption class="lg lh et er es li lj bd b be z dx translated">图2</figcaption></figure><p id="9669" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">使用分布拟合函数“拟合”来验证数据是否符合正态分布。下面是Julia代码，用于绘制直方图和数据的正态分布拟合。</p><pre class="kv kw kx ky fd ll lm ln lo aw lp bi"><span id="e760" class="lq if hh lm b fi lr ls l lt lu">using Random, Distributions<br/>using StatsBase<br/>df = DataFrame(data)</span><span id="c3c3" class="lq if hh lm b fi lv ls l lt lu">lower = quantile(df[:,:Diff], 0.01)<br/>upper = quantile(df[:,:Diff], 0.99)<br/>df = filter(:Diff =&gt; x -&gt; x &gt; lower, df)<br/>df = filter(:Diff =&gt; x -&gt; x &lt; upper, df)<br/><a class="ae ka" href="http://twitter.com/show" rel="noopener ugc nofollow" target="_blank">@show</a> mean(df[!,:Diff])<br/><a class="ae ka" href="http://twitter.com/show" rel="noopener ugc nofollow" target="_blank">@show</a> std(df[!,:Diff])<br/>histogram(df[!,:Diff], labels="Data Samples")<br/>d=fit(Normal, df[!,:Diff])<br/>n = length(df[:,:Diff])<br/>plot!(rand(d, n), seriestype=:scatterhist, linestyle=:solid, size=(600,150),labels="Normal Distribution")</span></pre><h1 id="c0f1" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">平稳性</h1><p id="7cfd" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">平稳时间序列是指其统计特性，如均值、方差、自相关等。都是不变的。</p><p id="b882" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">使用<a class="ae ka" href="https://en.wikipedia.org/wiki/Augmented_Dickey–Fuller_test" rel="noopener ugc nofollow" target="_blank">扩展的Dickey–Fuller(ADF)测试</a>来测试时间序列是否平稳。测试结果的<em class="lw"> p值</em>是一种常用的检查方式。</p><blockquote class="lx ly lz"><p id="3ab3" class="jc jd lw je b jf kb jh ji jj kc jl jm ma kd jp jq mb ke jt ju mc kf jx jy jz ha bi translated">如果p值&gt; 0.05，则它是非平稳的。如果p值≤ 0.05，则为静态。</p></blockquote><ol class=""><li id="8e78" class="kg kh hh je b jf kb jj kc jn md jr me jv mf jz kl km kn ko bi translated">GLD和IAU的价格不是一成不变的。(GLD p值= 0.8521，IAU p值= 0.9077)</li><li id="693a" class="kg kh hh je b jf kp jj kq jn kr jr ks jv kt jz kl km kn ko bi translated">GLD和IAU的每日收益是稳定的。(GLD收益p值&lt; 1e-25，IAU收益p值&lt; 1e-25)</li><li id="96fd" class="kg kh hh je b jf kp jj kq jn kr jr ks jv kt jz kl km kn ko bi translated">GLD和IAU的日收益率之差是固定的。(p值&lt; 1e-99)</li></ol><p id="49d1" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">下面是测试平稳性的Julia代码。</p><pre class="kv kw kx ky fd ll lm ln lo aw lp bi"><span id="cc8e" class="lq if hh lm b fi lr ls l lt lu">using Plots<br/>function testStationary(df)<br/>    y = autocor(df,1:20)<br/>    display(bar(y))<br/>    y = pacf(df,1:20)<br/>    display(bar(y))<br/>    ADFTest(df,:none,1)<br/>end</span></pre><h1 id="ea30" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">共整合现象</h1><p id="0bef" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">事实上，基于上述性质，我们可以说GLD和IAU是协整的，并且我们可以用Engle-Granger检验来检验这种协整性。有关协整的更多信息，请参考其<a class="ae ka" href="https://en.wikipedia.org/wiki/Cointegration" rel="noopener ugc nofollow" target="_blank"> Wiki </a>页面。关于如何实施恩格尔-格兰杰检验，请参考<a class="ae ka" href="https://www.real-statistics.com/time-series-analysis/time-series-miscellaneous/engle-granger-test/" rel="noopener ugc nofollow" target="_blank">这本实用指南</a>。</p><h1 id="dc31" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">交易策略</h1><p id="1fba" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">两个ETF的收益率之差服从均值为零的正态分布。它也是一个平稳的时间序列，所以它将恢复到它的均值零。</p><p id="71bf" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">由于两个ETF回报的差异将恢复到零，如果差异超过一个标准差，我们预计差异将减少到零，这意味着第一个ETF的回报将下降，第二个将上升。所以我们的交易信号是卖出第一只ETF，买入第二只ETF。</p><p id="76f8" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">类似地，如果差值小于一个标准差，我们预计差值将增加到零，这意味着第一个ETF的回报将增加，第二个将下降。所以我们的交易信号是买第一个，卖第二个。</p><h1 id="26a6" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">回溯测试</h1><p id="87a0" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我使用2019年7月12日至2021年6月17日的收盘价数据进行后验测试。</p><ol class=""><li id="cc7a" class="kg kh hh je b jf kb jj kc jn md jr me jv mf jz kl km kn ko bi translated">如果我收到买入信号，我的头寸是0，我将买入1股，并从账户余额中扣除收盘价。</li><li id="a96c" class="kg kh hh je b jf kp jj kq jn kr jr ks jv kt jz kl km kn ko bi translated">如果我收到买入信号，我的仓位是1，我仍然会持有这1股。</li><li id="19c0" class="kg kh hh je b jf kp jj kq jn kr jr ks jv kt jz kl km kn ko bi translated">如果我收到卖出信号，我的头寸是1，我将卖出这1股，并将收盘价加到账户余额中。</li><li id="97a5" class="kg kh hh je b jf kp jj kq jn kr jr ks jv kt jz kl km kn ko bi translated">如果我收到卖出信号，而我的仓位是0，那就什么都不会做。</li></ol><p id="1f70" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">由于GLD的价格大约是IAU的5倍，当我与IAU交易时，我将使用5单位份额而不是GLD的1单位份额。</p><p id="b38d" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">以下是最终结果。</p><ol class=""><li id="4e66" class="kg kh hh je b jf kb jj kc jn md jr me jv mf jz kl km kn ko bi translated">在GLD进行了53次交易，在IAU进行了52次交易。</li><li id="e1a0" class="kg kh hh je b jf kp jj kq jn kr jr ks jv kt jz kl km kn ko bi translated">GLD的28笔交易和IAU的32笔交易都获得了收益。平均而言，57%的交易获利。</li><li id="1679" class="kg kh hh je b jf kp jj kq jn kr jr ks jv kt jz kl km kn ko bi translated">GLD和IAU分别盈利31.8美元和3.9美元</li></ol><p id="42ba" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">这里显示了一段时间内的平衡:</p><figure class="kv kw kx ky fd kz er es paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="er es mg"><img src="../Images/11c862c6c6760fb14eea5ba743fd9bba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JZri1RxEbQIwzEJYSCOIUg.png"/></div></div></figure><p id="08b7" class="pw-post-body-paragraph jc jd hh je b jf kb jh ji jj kc jl jm jn kd jp jq jr ke jt ju jv kf jx jy jz ha bi translated">GLD天平的最大损耗(缺点)是0.7，IAU是3.6。</p><h1 id="4454" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">与布林线的对比</h1><p id="6728" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">为了便于比较，我用布林线对交易策略做了同样的回溯测试。</p><ol class=""><li id="a8b9" class="kg kh hh je b jf kb jj kc jn md jr me jv mf jz kl km kn ko bi translated">在GLD做了13笔交易，在IAU做了13笔交易。</li><li id="d68e" class="kg kh hh je b jf kp jj kq jn kr jr ks jv kt jz kl km kn ko bi translated">GLD有6笔交易和IAU有8笔交易是盈利的。平均而言，54%的交易获利。</li><li id="a1fe" class="kg kh hh je b jf kp jj kq jn kr jr ks jv kt jz kl km kn ko bi translated">GLD亏损8.7美元，IAU盈利4.3美元</li></ol><h1 id="ce23" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">结论</h1><ol class=""><li id="8d8d" class="kg kh hh je b jf jg jj jk jn ki jr kj jv kk jz kl km kn ko bi translated">使用协整的交易策略可以产生更高的利润。</li><li id="e43d" class="kg kh hh je b jf kp jj kq jn kr jr ks jv kt jz kl km kn ko bi translated">捕捉更多的交易信号。</li><li id="a6c2" class="kg kh hh je b jf kp jj kq jn kr jr ks jv kt jz kl km kn ko bi translated">更高的盈利交易百分比。</li></ol></div></div>    
</body>
</html>