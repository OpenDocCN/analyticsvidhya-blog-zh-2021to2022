<html>
<head>
<title>Hello World to Data Lakehouse with Azure Synapse Analytics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">hello World to Data lake house with Azure Synapse Analytics</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/hello-world-to-data-lakehouse-with-azure-synapse-analytics-dbd7a753195c?source=collection_archive---------7-----------------------#2021-06-18">https://medium.com/analytics-vidhya/hello-world-to-data-lakehouse-with-azure-synapse-analytics-dbd7a753195c?source=collection_archive---------7-----------------------#2021-06-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="a3d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Data Lakehouse是一种新的数据架构范例，结合了数据仓库(事务支持、模式实施、BI支持)和数据湖(存储与计算分离、数据类型多样、工作负载多样、流)的优势，并提供了额外的优势(无需ETL/ELT即可直接查询原始数据)。这里有一些关于data lakehouse的好文章。</p><div class="jd je ez fb jf jg"><a href="https://databricks.com/blog/2020/01/30/what-is-a-data-lakehouse.html" rel="noopener  ugc nofollow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">什么是湖边小屋？-数据砖博客</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">在过去的几年里，我们在Databricks看到了一种新的数据管理架构，它独立地出现在…</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">databricks.com</p></div></div><div class="jp l"><div class="jq l jr js jt jp ju jv jg"/></div></div></a></div><div class="jd je ez fb jf jg"><a rel="noopener follow" target="_blank" href="/adfolks/data-lakehouse-paradigm-of-decade-caa286f5b7a1"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">数据仓库——十年典范</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">结合了数据湖和数据仓库优点的现代数据平台范例。</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">medium.com</p></div></div><div class="jp l"><div class="jw l jr js jt jp ju jv jg"/></div></div></a></div><p id="4a51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Azure和AWS现在都在说data lakehouse。Azure有Azure data lake，Azure Databricks和以前的Azure SQL DW，但微软试图用Azure Synapse Analytics提供更多的集成体验。</p><div class="jd je ez fb jf jg"><a rel="noopener follow" target="_blank" href="/microsoftazure/data-lake-or-data-warehouse-or-a-combination-of-both-choices-in-azure-and-azure-synapse-6b99cd072f99"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">数据湖或数据仓库或两者的组合—Azure和Azure Synapse中的选择</h2><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">medium.com</p></div></div><div class="jp l"><div class="jx l jr js jt jp ju jv jg"/></div></div></a></div><div class="jd je ez fb jf jg"><a href="https://aws.amazon.com/blogs/big-data/build-a-lake-house-architecture-on-aws/" rel="noopener  ugc nofollow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">在AWS | Amazon Web Services上构建湖边小屋架构</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">当组织汇集所有结构的所有相关数据时，他们可以获得更深入、更丰富的洞察力…</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">aws.amazon.com</p></div></div><div class="jp l"><div class="jy l jr js jt jp ju jv jg"/></div></div></a></div><p id="20a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇文章中，我将使用Azure Synapse Analytics体验数据湖屋，尤其是在</p><ul class=""><li id="48ca" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">无服务器SQL</li><li id="558a" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">Synapse管道</li><li id="c5a4" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">火花池</li></ul><h1 id="d49c" class="kn ko hi bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">创建Azure Synapse工作区</h1><div class="jd je ez fb jf jg"><a href="https://docs.microsoft.com/en-us/azure/synapse-analytics/quickstart-create-workspace" rel="noopener  ugc nofollow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">快速入门:创建Synapse工作区- Azure Synapse Analytics</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">该快速入门介绍了使用Azure门户创建Azure Synapse工作区的步骤。打开蔚蓝…</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">docs.microsoft.com</p></div></div><div class="jp l"><div class="ll l jr js jt jp ju jv jg"/></div></div></a></div><ul class=""><li id="950d" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">在Azure门户中，搜索Azure Synapse。在搜索结果中的服务下，选择Azure Synapse Analytics。</li><li id="9803" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">选择添加以创建新的工作区。</li><li id="2786" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">在“基本”选项卡中，为工作区指定一个唯一的名称。在“基本”标签中创建新的ADLS Gen2帐户。在“选择Data Lake Storage Gen2”下，单击“新建”并为帐户选择一个名称。在选择Data Lake Storage Gen2下，单击文件系统并将其命名为users。</li></ul><figure class="ln lo lp lq fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es lm"><img src="../Images/61550021720611b6e4670b98763f0165.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gAWGgqAK-7SCT2N_YD9aaA.png"/></div></div></figure><p id="c2de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">提供资源后，转到Synapse workspace，将有一个URL供您访问workspace(类似web . azure syncapse . net)。点按它(或打开Synapse Studio)并鉴定。</p><h2 id="ce7b" class="lx ko hi bd kp ly lz ma kt mb mc md kx iq me mf lb iu mg mh lf iy mi mj lj mk bi translated">常规用户界面</h2><figure class="ln lo lp lq fd lr er es paragraph-image"><div class="er es ml"><img src="../Images/42789f64b4f98d6406090be872a236bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:212/format:webp/1*ezI0Gbb_4Godz44iG0jhug.png"/></div></figure><p id="5a09" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">主页:主屏幕</p><p id="0d52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据:管理数据库、数据集等。</p><p id="bcc9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">开发:创建SQL脚本、笔记本、数据流</p><p id="ede2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">集成:管理管道，访问复制数据工具</p><p id="8ceb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">监视器:管道、SQL请求、spark应用程序</p><p id="dc6a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">管理:管理分析池(SQL、spark)、外部连接、访问控制等。</p><h1 id="ef44" class="kn ko hi bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">使用Azure Synapse Analytics进行无代码ETL</h1><div class="jd je ez fb jf jg"><a href="https://docs.microsoft.com/en-us/azure/data-factory/load-azure-sql-data-warehouse" rel="noopener  ugc nofollow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">将数据加载到Azure Synapse Analytics - Azure数据工厂</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">适用于:Azure数据工厂Azure Synapse Analytics Azure Synapse Analytics是一个基于云的横向扩展数据库…</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">docs.microsoft.com</p></div></div><div class="jp l"><div class="mm l jr js jt jp ju jv jg"/></div></div></a></div><p id="b2f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从<a class="ae mn" href="https://azure.microsoft.com/en-us/services/open-datasets/" rel="noopener ugc nofollow" target="_blank"> Azure开放数据集</a>复制到我们的数据湖存储。</p><ul class=""><li id="12c9" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">通过转到管理中心，单击链接服务，然后单击+新建，设置新的链接服务。在搜索框中键入Azure Blob Storage，然后选择服务。</li><li id="edcf" class="jz ka hi ih b ii ki im kj iq kk iu kl iy km jc ke kf kg kh bi translated">命名您链接的服务，将“认证方法”更改为“SAS URI”，将“SAS URL”更改为<a class="ae mn" href="https://azureopendatastorage.blob.core.windows.net/" rel="noopener ugc nofollow" target="_blank">https://azureopendatastorage.blob.core.windows.net/</a>，对于“SAS令牌”，输入任意字符，例如“aa”。点击“测试连接”，你应该看到“连接成功”。单击创建。</li></ul><figure class="ln lo lp lq fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mo"><img src="../Images/df939781984ba7b68f2a1bf45b225fc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TP4_W7mwDdA8H1Sey7ATOQ.png"/></div></div></figure><ul class=""><li id="275e" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">在集成中心创建一个新管道，并添加一个复制数据活动。将源数据集指向上面步骤2中设置的Azure Open数据集。选择Azure Blob Storage作为数据源，选择Parquet作为格式。在屏幕截图中设置数据源属性。</li></ul><figure class="ln lo lp lq fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mp"><img src="../Images/4a91f78cbf3936e23c6c84aa802a859b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bovHmF-3jV6dg_N8tckNfw.png"/></div></div></figure><ul class=""><li id="5b76" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">将数据接收器指向数据湖存储帐户。选择Azure Data Lake Storage作为数据接收器，并选择Parquet作为格式。填写类似于屏幕截图中所示的数据接收器属性</li></ul><figure class="ln lo lp lq fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mq"><img src="../Images/8f1a78fc21df8b261475db9f575cc679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eNenmXEMk-T8oovDzBoj7Q.png"/></div></div></figure><ul class=""><li id="07bb" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">选择“通配符文件路径”</li></ul><figure class="ln lo lp lq fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mr"><img src="../Images/ac2947fa43fcfc96dc4591c3fa1cc346.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C9mR-ehfDP0wF0w1yl84uQ.png"/></div></div></figure><ul class=""><li id="94f9" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">立即发布管道和触发器</li></ul><figure class="ln lo lp lq fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es ms"><img src="../Images/d54b377713fef6b06e77124b41919880.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V-XxIYLU6HoZyhg-wBiOYQ.png"/></div></div></figure><ul class=""><li id="fac1" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">您可以转到“监控|管道运行”来检查管道进度</li></ul><figure class="ln lo lp lq fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mt"><img src="../Images/1fb2736cfbdbe9867c91bba893da2df3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x_Ek-hR9tdXmp6ImhqB19g.png"/></div></div></figure><ul class=""><li id="cf35" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">管道完成后，您可以转到数据中心|链接|您的存储帐户，使用无服务器SQL进行查询</li></ul><figure class="ln lo lp lq fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mu"><img src="../Images/2ff1c1e5541e73f95634787804cdd283.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ONp81_Krt59WLG6CkDKvZA.png"/></div></div></figure><figure class="ln lo lp lq fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mv"><img src="../Images/886d4f1e72cfd9b95814c1206a32c6c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*igSoTlCUiSL2leHVBdHTbQ.png"/></div></div></figure><p id="e68b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我把无服务器SQL视为<a class="ae mn" href="https://aws.amazon.com/athena" rel="noopener ugc nofollow" target="_blank">亚马逊雅典娜</a>查询即服务。然而，到目前为止，创建带有分区外部表似乎并不简单直观。这里是支持的“创建外部表”与分区文件夹。</p><pre class="ln lo lp lq fd mw mx my mz aw na bi"><span id="0013" class="lx ko hi mx b fi nb nc l nd ne">CREATE EXTERNAL TABLE Taxi (<br/>     vendor_id VARCHAR(100) COLLATE Latin1_General_BIN2, <br/>     pickup_datetime DATETIME2, <br/>     dropoff_datetime DATETIME2,<br/>     passenger_count INT,<br/>     trip_distance FLOAT,<br/>     fare_amount FLOAT,<br/>     tip_amount FLOAT,<br/>     tolls_amount FLOAT,<br/>     total_amount FLOAT<br/>) WITH (<br/>         LOCATION = 'yellow/puYear=*/puMonth=*/*.parquet',<br/>         DATA_SOURCE = nyctlc,<br/>         FILE_FORMAT = ParquetFormat<br/>);</span></pre><p id="9875" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您不能利用分区消除。分区视图可以支持，但是语法感觉不直观。</p><pre class="ln lo lp lq fd mw mx my mz aw na bi"><span id="0707" class="lx ko hi mx b fi nb nc l nd ne">CREATE VIEW TaxiView<br/>AS SELECT *, nyc.filepath(1) AS [year], nyc.filepath(2) AS [month]<br/>FROM<br/>    OPENROWSET(<br/>        BULK 'parquet/taxi/year=*/month=*/*.parquet',<br/>        DATA_SOURCE = 'sqlondemanddemo',<br/>        FORMAT='PARQUET'<br/>    ) AS nyc</span></pre><p id="5582" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">相比亚马逊Athena支持的HiveQL，下面的感觉更自然。</p><pre class="ln lo lp lq fd mw mx my mz aw na bi"><span id="bbf7" class="lx ko hi mx b fi nb nc l nd ne">CREATE EXTERNAL TABLE users (<br/>first string,<br/>last string,<br/>username string<br/>)<br/>PARTITIONED BY (id string)<br/>STORED AS parquet<br/>LOCATION 's3://bucket/folder/'</span></pre><div class="jd je ez fb jf jg"><a href="https://docs.microsoft.com/en-us/azure/synapse-analytics/sql/create-use-external-tables" rel="noopener  ugc nofollow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">在Synapse SQL池中创建和使用外部表- Azure Synapse Analytics</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">在本节中，您将学习如何在Synapse SQL池中创建和使用本机外部表。本机外部表…</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">docs.microsoft.com</p></div></div><div class="jp l"><div class="nf l jr js jt jp ju jv jg"/></div></div></a></div><div class="jd je ez fb jf jg"><a href="https://docs.microsoft.com/en-us/azure/synapse-analytics/sql/create-use-views#partitioned-views" rel="noopener  ugc nofollow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">在无服务器SQL池中创建和使用视图- Azure Synapse Analytics</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">在本节中，您将学习如何创建和使用视图来包装无服务器SQL池查询。视图将允许您…</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">docs.microsoft.com</p></div></div><div class="jp l"><div class="ng l jr js jt jp ju jv jg"/></div></div></a></div><p id="8aab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与三角洲湖的融合是一大优势。Delta lake是开源存储层，为data lake带来了ACID功能。</p><div class="jd je ez fb jf jg"><a href="https://billtcheng2013.medium.com/on-transactional-data-lake-cdda17d9c0d" rel="noopener follow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">论事务数据湖</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">随着大数据技术的成熟，大数据处理正在成为一种常态。数据湖已经被许多…</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">billtcheng2013.medium.com</p></div></div></div></a></div><div class="jd je ez fb jf jg"><a href="https://docs.microsoft.com/en-us/azure/synapse-analytics/sql/query-delta-lake-format" rel="noopener  ugc nofollow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">使用无服务器SQL池查询三角洲湖格式(预览)- Azure Synapse Analytics</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">在本文中，您将了解如何使用无服务器Synapse SQL池编写查询来读取Apache Delta Lake文件…</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">docs.microsoft.com</p></div></div><div class="jp l"><div class="nh l jr js jt jp ju jv jg"/></div></div></a></div><h1 id="a3b2" class="kn ko hi bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">用火花笔记本分析</h1><ul class=""><li id="8cc3" class="jz ka hi ih b ii ni im nj iq nk iu nl iy nm jc ke kf kg kh bi translated">创建火花池，给火花池命名，选择节点大小之间的小，中，大，xlarge，xxlarge，选择“自动缩放”，节点数量。选择“自动暂停”，火花版本</li></ul><figure class="ln lo lp lq fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es nn"><img src="../Images/ea6f1d3ed21a54a9800fd2c84a5dd9c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W8w3RgykZHXEc66LWtRU5w.png"/></div></div></figure><div class="jd je ez fb jf jg"><a href="https://docs.microsoft.com/en-us/azure/synapse-analytics/quickstart-create-apache-spark-pool-studio" rel="noopener  ugc nofollow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">快速入门:使用Synapse Studio-Azure Synapse Analytics创建一个无服务器Apache Spark pool</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">Azure Synapse Analytics提供各种分析引擎来帮助您获取、转换、建模、分析和服务您的…</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">docs.microsoft.com</p></div></div><div class="jp l"><div class="no l jr js jt jp ju jv jg"/></div></div></a></div><ul class=""><li id="4bc6" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">选择数据，选择“新笔记本”，“加载到数据框”</li></ul><figure class="ln lo lp lq fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es np"><img src="../Images/c7f43311ada6ebd7b3d38deaaf04c9f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N6-pTUAlEAqOb-7uGsRdow.png"/></div></div></figure><ul class=""><li id="a110" class="jz ka hi ih b ii ij im in iq kb iu kc iy kd jc ke kf kg kh bi translated">Synapse生成启动代码(手动删除黄色后的路径/以访问所有数据)，选择spark pool并执行代码。</li></ul><figure class="ln lo lp lq fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es nq"><img src="../Images/e5ae4853dd79063967b700406d3a7b12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yr4nSQYumEPuPpTq8i2nvA.png"/></div></div></figure><p id="e2e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">开放数据集包括1571671152条记录</p><h2 id="4f85" class="lx ko hi bd kp ly lz ma kt mb mc md kx iq me mf lb iu mg mh lf iy mi mj lj mk bi translated">从笔记本直接访问Azure open dataset</h2><figure class="ln lo lp lq fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es nr"><img src="../Images/566a7e69524a7ec8c04f30143135b100.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EYBvtK0M_xHMOZ_KHui7Nw.png"/></div></div></figure><figure class="ln lo lp lq fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es ns"><img src="../Images/8d8a3eba26f87a14c57ba6ea30cf909d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*33AAZcNC7IzkMW-uz87UdQ.png"/></div></div></figure><h1 id="5dee" class="kn ko hi bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">。净火花</h1><p id="60e3" class="pw-post-body-paragraph if ig hi ih b ii ni ik il im nj io ip iq nt is it iu nu iw ix iy nv ja jb jc hb bi translated">。NET spark是迎合Csharp开发者的。主要的例子如下</p><div class="jd je ez fb jf jg"><a href="https://github.com/dotnet/spark/blob/main/examples/Microsoft.Spark.CSharp.Examples/Sql/Batch/Basic.cs" rel="noopener  ugc nofollow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">点网/火花</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">NET for Apache Spark使Apache Spark很容易被。NET开发人员。-点网/火花</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">github.com</p></div></div><div class="jp l"><div class="nw l jr js jt jp ju jv jg"/></div></div></a></div><pre class="ln lo lp lq fd mw mx my mz aw na bi"><span id="35e8" class="lx ko hi mx b fi nb nc l nd ne">%%csharp<br/>var df = spark.Read().Parquet("abfss://nyctlc@&lt;adls account&gt;.dfs.core.windows.net/yellow/puYear=2001/puMonth=1/");<br/>df.Show();</span></pre><p id="8faa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出相当原始</p><pre class="ln lo lp lq fd mw mx my mz aw na bi"><span id="87e5" class="lx ko hi mx b fi nb nc l nd ne">+--------+--------+------+------+----------+---------------+-----------+----------+-----+------+--------------------+---------+-----------+-----------+ |       2|2001-01-01 22:55:43|2001-01-02 00:05:43|             1|        4.67|         234|         162|    null|    null|  null|  null|         1|              N|          2|      31.5|  0.0|   0.5|                 0.3|      0.0|        0.0|       32.3| |       2|2001-01-06 06:03:30|2001-01-06 14:08:58|             1|         0.0|         193|         193|    null|    null|  null|  null|         1|              N|          2|       2.5|  0.0|   0.5|                 0.3|      0.0|        0.0|        3.3|</span></pre><p id="9892" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">转换</p><pre class="ln lo lp lq fd mw mx my mz aw na bi"><span id="5fb2" class="lx ko hi mx b fi nb nc l nd ne">var newDF = df.SelectExpr("replace(left(tpepPickupDateTime,7), \"-\",\"_\") as yearMonth", $"tipAmount/totalAmount as tipPct");<br/>newDF.Show();</span></pre><h1 id="e38b" class="kn ko hi bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">Spark UI监控</h1><figure class="ln lo lp lq fd lr er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es nx"><img src="../Images/a64e2236a2e3f0b3821d6d101b24b262.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UmoveUUzivHt_ooOKGy-bQ.png"/></div></div></figure><p id="bc26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完成后停止会话(设置按钮左侧)</p><p id="04cc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本文基于微软提供的Azure Synapse分析工具包。</p><div class="jd je ez fb jf jg"><a href="https://azure.microsoft.com/en-us/resources/azure-synapse-analytics-toolkit/" rel="noopener  ugc nofollow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">Azure Synapse分析工具包</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">在几分钟内获得开始使用Azure Synapse Analytics所需的一切，并开始获得有价值的…</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">azure.microsoft.com</p></div></div><div class="jp l"><div class="ny l jr js jt jp ju jv jg"/></div></div></a></div><h1 id="8d1b" class="kn ko hi bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">参考架构</h1><div class="jd je ez fb jf jg"><a href="https://docs.microsoft.com/en-us/azure/architecture/example-scenario/dataplate2e/data-platform-end-to-end" rel="noopener  ugc nofollow" target="_blank"><div class="jh ab dw"><div class="ji ab jj cl cj jk"><h2 class="bd hj fi z dy jl ea eb jm ed ef hh bi translated">使用Azure Synapse进行端到端分析- Azure示例场景</h2><div class="jn l"><h3 class="bd b fi z dy jl ea eb jm ed ef dx translated">这个示例场景演示了如何使用Azure数据服务的大家族来构建一个现代数据…</h3></div><div class="jo l"><p class="bd b fp z dy jl ea eb jm ed ef dx translated">docs.microsoft.com</p></div></div><div class="jp l"><div class="nz l jr js jt jp ju jv jg"/></div></div></a></div></div></div>    
</body>
</html>