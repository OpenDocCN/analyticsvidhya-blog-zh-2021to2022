<html>
<head>
<title>Docker crash course (1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">码头工人速成班(1)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/docker-crash-course-1-754d9cea7a77?source=collection_archive---------9-----------------------#2021-02-06">https://medium.com/analytics-vidhya/docker-crash-course-1-754d9cea7a77?source=collection_archive---------9-----------------------#2021-02-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="cea1" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">10分钟内理解docker中的主要概念</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/79311bbad503ac3a0a3836b16cecd7be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QWUyXjHBbyZcgWpOMIqS0w.jpeg"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">德国新天鹅堡</figcaption></figure><p id="d4fa" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><strong class="jo hi"><em class="ki">docker是什么？</em>T3】</strong></p><p id="ce33" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">管理容器的工具是一个独立的环境，包含一些代码或软件及其依赖项，因此它独立运行，无论其宿主如何，并且总是产生相同的结果。</p><p id="5f5d" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><strong class="jo hi"> <em class="ki">难道虚拟机也能达到同样的效果吗？</em> </strong></p><p id="9994" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">是的，他们可以达到相似的结果，但是他们之间有很大的不同</p><ol class=""><li id="1f62" class="kj kk hh jo b jp jq js jt jv kl jz km kd kn kh ko kp kq kr bi translated"><em class="ki">资源消耗</em>因此，虚拟机比docker需要更多的资源。</li><li id="6de8" class="kj kk hh jo b jp ks js kt jv ku jz kv kd kw kh ko kp kq kr bi translated"><em class="ki">基础架构如代码</em> <br/> Docker映像是根据Docker文件构建的——它是一个包含人类可读脚本的文件，相同的脚本意味着相同的映像。就像其他编码一样，开发团队可以有效地协作。相比之下，不同的虚拟机就像不同的计算机一样，不容易对它们进行比较和故障排除</li><li id="528f" class="kj kk hh jo b jp ks js kt jv ku jz kv kd kw kh ko kp kq kr bi translated"><em class="ki">可共享</em> <br/>有内置的docker hub支持，您可以轻松地将您的docker图像上传到存储库，并与您的团队或公众共享。当然，你可以共享other文件，然后另一方可以用它建立完全相同的图像。<br/>但是，如果您想要共享虚拟机，您必须导出它并物理复制文件，因为它包括操作系统，通常文件大小非常大。</li><li id="3a81" class="kj kk hh jo b jp ks js kt jv ku jz kv kd kw kh ko kp kq kr bi translated"><em class="ki">社区支持</em> <br/> Docker提供了很多基础镜像，像Java，mongodb，nodejs。它们已经过官方验证，我们可以在这些基础映像的基础上构建我们的产品，这样可以节省大量时间和精力</li></ol><p id="3104" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><strong class="jo hi"> <em class="ki">一些基本概念和术语</em> </strong></p><p id="9593" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><em class="ki">图像</em> <br/>它是容器的蓝图/模板，它包含一些代码片段或一个软件及其依赖关系。一旦建立了映像，它就是只读的。如果有任何改变，就必须重建。</p><p id="53ff" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><em class="ki">基于层的架构</em> <br/>映像是根据dockerfile构建的，里面的每一行命令都是新的顶层。所有的层都被缓存，但是如果修改了any命令，那么在重建过程中，后面的层不能再使用缓存。</p><p id="9848" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><em class="ki">容器</em>运行<br/>镜像的实例，它在镜像之上构建了一个层，与镜像不同，这个额外的层允许读写。每当我们在容器中运行代码时，结果都会反映在这一层中</p><p id="fb95" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><strong class="jo hi"> <em class="ki">码头工人储存</em> </strong></p><p id="f8a3" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">通常，在我们移除容器后，运行容器产生的那些数据将会丢失。因此docker引入了“卷”——它允许容器访问主机上的文件夹</p><ol class=""><li id="ea01" class="kj kk hh jo b jp jq js jt jv kl jz km kd kn kh ko kp kq kr bi translated"><em class="ki">匿名卷</em> <br/>主机中的存储空间与特定容器相链接，在主机中对我们不可见。如果容器被移除，它也将被移除。</li><li id="15c1" class="kj kk hh jo b jp ks js kt jv ku jz kv kd kw kh ko kp kq kr bi translated"><em class="ki">命名卷</em>与<br/>匿名卷相似，也不可见，但它不会被移除，即使将链接的容器移除，也可以在不同的容器间共享</li><li id="6ece" class="kj kk hh jo b jp ks js kt jv ku jz kv kd kw kh ko kp kq kr bi translated"><em class="ki">绑定挂载<br/> </em>可以将主机中的任何文件夹/文件绑定到容器中。因为这是主机中的文件夹/文件，所以除非我们明确删除主机中的这些文件夹/文件，否则该卷是存在的。</li></ol><p id="6b51" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><strong class="jo hi"> <em class="ki"> Docker联网</em> </strong></p><p id="abd0" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">默认情况下，docker会为每个容器分配IP，您可以通过“inspect”命令了解容器的IP</p><ol class=""><li id="ee7d" class="kj kk hh jo b jp jq js jt jv kl jz km kd kn kh ko kp kq kr bi translated">连接到web <br/>只需提供IP或主机名和端口号，与您在主机中所做的一样</li><li id="c707" class="kj kk hh jo b jp ks js kt jv ku jz kv kd kw kh ko kp kq kr bi translated">使用特殊的域名“host.docker.internal”连接到主机<br/>，docker会为您完成剩下的工作</li><li id="9ae0" class="kj kk hh jo b jp ks js kt jv ku jz kv kd kw kh ko kp kq kr bi translated">连接到coz的另一个docker <br/>上，因为我们可以使用每个容器的IP地址，但是在大多数情况下，我们不想硬编码IP地址。<br/>我们可以创建一个“码头网络”,并将我们的集装箱分配给“码头网络”。在docker网络中，容器可以通过容器名相互通信</li></ol><p id="78d1" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><strong class="jo hi"> <em class="ki">样本Docker文件</em> </strong></p><pre class="ix iy iz ja fd kx ky kz la aw lb bi"><span id="65eb" class="lc ld hh ky b fi le lf l lg lh">FROM java:8<br/>#Try to retrieve the Java 8 base image from local, if not found in #local, it will retrieve Java 8 base image from docker hub </span><span id="f49b" class="lc ld hh ky b fi li lf l lg lh">COPY . /app/java<br/>#Copy the files in folder (in host machine) to /app/java in the     #container file system. "." means the current folder,  the folder #contains this dockerfile</span><span id="4e94" class="lc ld hh ky b fi li lf l lg lh">WORKDIR /app/java<br/>#Change the work folder(in the container) for the following commands</span><span id="7d33" class="lc ld hh ky b fi li lf l lg lh">RUN javac Hello.java<br/>#execute java compile command, and the result will be including in #the image, it is part of the process in building the image</span><span id="a0fd" class="lc ld hh ky b fi li lf l lg lh">CMD ["java", "Hello"]<br/>#default command of the container, can be override when we run the #container</span></pre><p id="a455" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><strong class="jo hi"> <em class="ki">关于缓存机制</em> </strong></p><p id="91ea" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">如前所述，dockerfile中的每一行都将是一个新的层，并由缓存提供支持，从而加快映像重建过程。但是，如果编辑了任何行，该行和后续行在重建期间将不受缓存支持。<br/>例如，如果" WORKDIR /app/java "更新为" WORKDIR /exe/java" <br/>，那么" WORKDIR /exe/java "、<br/> "RUN javac Hello.java "、<br/> "CMD ["java "、" Hello"]" <br/>将在没有缓存支持的情况下重建，这意味着需要更长的时间。</p><p id="c90b" class="pw-post-body-paragraph jm jn hh jo b jp jq ii jr js jt il ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated"><strong class="jo hi"> <em class="ki"> Docker命令备忘单</em> </strong></p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lj"><img src="../Images/4fbb4c6f52a319163b328a21e9b359e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sYllRUq0p3h8BJUH8R8w4A.jpeg"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated"><a class="ae lk" href="https://www.docker.com/sites/default/files/d8/2019-09/docker-cheat-sheet.pdf" rel="noopener ugc nofollow" target="_blank">https://www . docker . com/sites/default/files/D8/2019-09/docker-cheat-sheet . pdf</a></figcaption></figure></div></div>    
</body>
</html>