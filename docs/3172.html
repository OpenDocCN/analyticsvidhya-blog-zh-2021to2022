<html>
<head>
<title>Create an AI to Play Chrome Dino Game with CNN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建一个人工智能来玩CNN的Chrome Dino游戏</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/create-an-ai-to-play-chrome-dino-game-with-cnn-b769e58bb14c?source=collection_archive---------11-----------------------#2021-06-14">https://medium.com/analytics-vidhya/create-an-ai-to-play-chrome-dino-game-with-cnn-b769e58bb14c?source=collection_archive---------11-----------------------#2021-06-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="600b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我们将实现一个卷积神经网络(CNN)模型来玩Chrome Dino游戏，这是Google Chrome的一个扩展。当一切完成后，我们将看到如下所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/5277b968d7d93e8f4b10a31807edd64b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*mv9DuHcCcpm-6AUDjFQPMA.gif"/></div></figure><p id="973e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了实现CNN模型，我们将按顺序执行以下操作:</p><ul class=""><li id="1b6d" class="jl jm hh ig b ih ii il im ip jn it jo ix jp jb jq jr js jt bi translated">首先，我们将通过玩一会儿游戏来创建一个数据集。</li><li id="47fa" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">为了创建数据集，我们将在玩游戏时抓取屏幕，并记录当时按下了哪个键。</li><li id="7c60" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">创建数据集后，我们将训练一个使用CNN准备的分类模型。</li><li id="f5d6" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">在分类模型训练完成后，我们将通过一个测试软件来测试模型，并根据结果来获得更好的模型。</li></ul></div><div class="ab cl jz ka go kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="ha hb hc hd he"><h1 id="7d97" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">数据准备</h1><p id="b011" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">在准备数据集之前，已经决定了数据集中包含的内容。为了在这种情况下准备分类模型，决定了以下事项:</p><ul class=""><li id="0646" class="jl jm hh ig b ih ii il im ip jn it jo ix jp jb jq jr js jt bi translated">模型的输入将是从游戏的特定部分截取的截图的矩阵转换。</li><li id="9ff7" class="jl jm hh ig b ih ju il jv ip jw it jx ix jy jb jq jr js jt bi translated">要分类的类别有:</li></ul><blockquote class="lj lk ll"><p id="756b" class="ie if jc ig b ih ii ij ik il im in io lm iq ir is ln iu iv iw lo iy iz ja jb ha bi translated"><strong class="ig hi"> Up: </strong>这个类将用于在游戏中跳跃恐龙。<br/> <strong class="ig hi">滑下:<em class="hh"> </em> </strong>这个类将用于在游戏中滑下恐龙。<br/> <strong class="ig hi">右:</strong>这个类将用于让游戏中的恐龙保持直线行进。</p></blockquote><p id="5222" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">根据分类模型的结构，一边玩游戏一边截图。在拍摄这些截图时，无论按下了什么按钮(上、下、右),该按钮信息也被用在截图的名称中，以存储为一个类。在截图的同时，在游戏中的恐龙面前取一个用边框确定的正方形区域作为基础。</p><p id="ec54" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以在下图中看到实现模型的过程。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lp"><img src="../Images/fad1c3081eb1643cb7416bada324099e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*2yZxjWdv8FEbamp0JYSbww.png"/></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">实现模型的过程</figcaption></figure></div><div class="ab cl jz ka go kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="ha hb hc hd he"><h1 id="6518" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">数据预处理</h1><p id="eb86" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">有时，由于玩游戏时截图的速度，截图和班级信息不一致。由于数据集中的这种不兼容性会对模型的训练过程产生不利影响，因此检查并删除了不一致的数据。</p><p id="db0e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">创建数据集时，屏幕截图以RGB格式保存。然而，由于图像中没有太多的颜色信息(通常有黑白色调)，数据在作为输入提供给模型之前被转换为“灰度”。由于RGB图像是三维的，如果用这样的数据训练模型，训练过程将花费很长时间。因此，通过执行转换过程减少了模型的训练时间，并且在玩游戏时增加了FPS(每秒帧数)。</p></div><div class="ab cl jz ka go kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="ha hb hc hd he"><h1 id="a569" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">数据可视化</h1><p id="ae05" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">如前所述，数据集中有3个类(上、下和右)。所以我们可以在下图中看到这些类的一些例子。数据集中这样的例子太多了。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="er es lu"><img src="../Images/ca4eef5c346c4bd7ce2dc9b1a4193b12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2E_HCUrAv6jUy5oDdk_LaA.png"/></div></div></figure><p id="5d61" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">图像总数为1032的数据集中的类分布如下图所示。由于游戏中“向上”键按的比较多，所以数据最多的就是这个类。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lz"><img src="../Images/b2c3c15b450d8ba3f0c0801ad2cedf63.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*LEXvgDqAQPX7qM50SNExHA.png"/></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">数据集中每个类的数据数量</figcaption></figure><p id="cd66" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在开始训练之前，数据集被分成90% — 10%的“训练集”和“测试集”。在这个过程之后，数据集的分布如下。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ma"><img src="../Images/e176bbe90741eeaff811ebc89a899239.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*qIg4AGtd3yYtJyfeUvowrg.png"/></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">数据集中训练集和测试集的数据数量</figcaption></figure></div><div class="ab cl jz ka go kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="ha hb hc hd he"><h1 id="6314" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">创建CNN模型</h1><p id="1a5f" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated"><em class="jc">逻辑回归</em>，<em class="jc">人工神经网络</em>或者<em class="jc">卷积神经网络</em>说到用深度学习分类可能会想到。在这三种结构中，<em class="jc">卷积神经网络(CNN) </em>通常是图像分类的主导结构。因此，决定使用CNN模型，因为玩游戏需要图像分类。为此，下图中的CNN模型是使用Keras库创建的。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mb"><img src="../Images/979427469f86ad338ba8cb2987b104ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*0iJlqOZqAdtfJioOumR18A.png"/></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">用于图像分类的CNN模型</figcaption></figure><p id="623d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在上面的CNN模型中，我们看到有482，563个参数需要训练。另外，<em class="jc"> dropout </em>层用在分类层之前，防止训练时过拟合。</p></div><div class="ab cl jz ka go kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="ha hb hc hd he"><h1 id="582e" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">训练CNN模型</h1><p id="99ee" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">在上述章节中创建CNN模型后，开始了针对<em class="jc"> 5个时期</em>的训练过程。为了在训练期间获得更好的结果，手动改变超参数，执行微调，并选择给出最佳结果的模型。培训的结果是:</p><blockquote class="lj lk ll"><p id="b30a" class="ie if jc ig b ih ii ij ik il im in io lm iq ir is ln iu iv iw lo iy iz ja jb ha bi translated">T <strong class="ig hi"> rain准确率(训练数据成功):</strong> 100%</p><p id="c642" class="ie if jc ig b ih ii ij ik il im in io lm iq ir is ln iu iv iw lo iy iz ja jb ha bi translated"><strong class="ig hi">测试准确度(测试数据成功):</strong> 100%</p></blockquote><p id="a4fb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下图显示了训练过程中模型的准确性和损失的变化。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ma"><img src="../Images/666db0102e8d15b6c3afc60c0ea02123.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*XkUZWF3Q57GlyeGNcBJXxA.png"/></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">培训过程中的培训准确性</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mc"><img src="../Images/19f67133c4295c9d49dea23cad22575b.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*3tJ5TeNWcTb8ojpJBSxkSw.png"/></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">培训过程中的培训损失</figcaption></figure><p id="a6ad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于训练后模型对测试数据的准确性为100%，显示类别如何相互混合的<em class="jc">混淆矩阵</em>显示为无混淆，如下所示。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es md"><img src="../Images/8d90692986024678ccb982bd19137b88.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*P73EjhezDJiFW0KOG_xpUw.png"/></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">模型的混淆矩阵</figcaption></figure></div><div class="ab cl jz ka go kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="ha hb hc hd he"><h1 id="7640" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">测试CNN模型</h1><p id="cbec" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">在创建了CNN模型并对数据进行了训练之后，测试阶段开始了。在测试阶段，使用训练过程后获得的权重。</p><p id="3943" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个阶段，运行一个为测试创建的软件，并截取游戏中相关区域的截图。然后，使用模型权重进行预测。这个预测将是<em class="jc">上、下、右</em>类之一。如果这个预测是:</p><blockquote class="lj lk ll"><p id="1cf2" class="ie if jc ig b ih ii ij ik il im in io lm iq ir is ln iu iv iw lo iy iz ja jb ha bi translated"><strong class="ig hi"> Up: </strong>创建的测试软件通过按键盘的“Up”键继续游戏。</p><p id="108f" class="ie if jc ig b ih ii ij ik il im in io lm iq ir is ln iu iv iw lo iy iz ja jb ha bi translated"><strong class="ig hi"> Down: </strong>创建的测试软件通过按键盘的“Down”键继续游戏。</p><p id="36ee" class="ie if jc ig b ih ii ij ik il im in io lm iq ir is ln iu iv iw lo iy iz ja jb ha bi translated"><strong class="ig hi">右:</strong>创建的测试软件按键盘的“右”键继续游戏。</p></blockquote></div><div class="ab cl jz ka go kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="ha hb hc hd he"><h1 id="c864" class="kg kh hh bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">摘要</h1><p id="6f21" class="pw-post-body-paragraph ie if hh ig b ih le ij ik il lf in io ip lg ir is it lh iv iw ix li iz ja jb ha bi translated">在本文中，我们首先准备了一个玩游戏的数据集。然后，我们简单地创建一个CNN模型，用数据集进行训练。最后，我们创建并启动了一个测试软件，现在我们的AI正在玩Chrome Dino游戏:)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/12ca390effd4705bb532e1dc3a91c94b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*KC_uIZWQSRmkPkosL9jzBA.gif"/></div><figcaption class="lq lr et er es ls lt bd b be z dx translated">AI在玩Chrome Dino游戏</figcaption></figure><p id="6510" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可以在这个<a class="ae me" href="https://github.com/frhtas/AI-Dino" rel="noopener ugc nofollow" target="_blank"> GitHub </a>库中看到所有的代码和模型权重。</p></div></div>    
</body>
</html>