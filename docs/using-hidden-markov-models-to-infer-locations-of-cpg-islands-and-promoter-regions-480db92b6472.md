# 使用隐马尔可夫模型推断 CpG 岛和启动子区域的位置

> 原文：<https://medium.com/analytics-vidhya/using-hidden-markov-models-to-infer-locations-of-cpg-islands-and-promoter-regions-480db92b6472?source=collection_archive---------12----------------------->

![](img/29646246b3e9a40cc0cab8cdb3c7c3fc.png)

人类基因组中一小段彩色编码的含氮碱基。信用: [Pinterest](https://www.google.com/url?sa=i&url=https%3A%2F%2Fwww.pinterest.com%2Faalliancesaid%2Fautoinflammatory-disease-images-logo-ideas-board%2F&psig=AOvVaw08Ywjo0UafIMbaQ_FMWSFU&ust=1618940002919000&source=images&cd=vfe&ved=0CAMQjB1qFwoTCMjdgeLrivACFQAAAAAdAAAAABAJ)

对于希望从人体接收到的信息中得出合理结论的计算研究人员来说，人类基因组的巨大规模是一个紧迫的问题。人体内有数万亿个细胞,每个细胞都包含对人类活动至关重要的遗传信息。

目前特别感兴趣的一个领域是**寻找模拟启动子或 CpG 岛的保守子序列或核苷酸片段**。因为人类基因组中有多少信息，所以很难推断哪些区域在进化中保持了保守性，或者哪些区域在体内进行了重要的过程，如 DNA 甲基化。

该领域的计算生物学家正在努力通过像隐马尔可夫模型这样的机器学习技术来解决这个问题。通过这些模型，我们可以找到这些核苷酸序列的潜在结构，并加深对人体内发生的过程的理解。

# DNA 建模框架

![](img/f6534d807c2acd15e34f6776b88756ea.png)

DNA 的复杂性留下了许多有待发现的东西；然而，出于本文的目的，我们将主要关注含氮碱基以及它们如何用于推断功能。

当一个核苷酸序列被提供给一组研究人员来计算该序列本身的功能(例如，它是否是启动子，是否与蛋白质编码区相关等)时，通常有三种方法可以遵循。):**对齐，可视化，建模。**

*   **比对**——对人类基因组的已知部分进行数据库搜索(使用 BLAST 算法寻找局部序列)，或者利用 k-means 或层次聚类等聚类算法来组装人体内未知的 DNA 片段
*   **可视化** —通常通过分析开放阅读框、终止密码子和不同的 k-mer 频率，简单检查核苷酸序列内部的差异和非标准组成。
*   **建模** —通过生成模型做出假设，通过过去的知识推断序列的功能。

通过 HMMs，我们将处理后一种策略，减少计算运行时间并更快地交付输出。我们不仅要看这些序列是什么，还要认识产生观察的状态。

# 贝耶法则与概率建模

隐马尔可夫模型严格依赖**贝耶法则和概率公式**来运行其计算并推断出正确的序列。因此，在更深入地探讨这个主题之前，了解基本原理是恰当的。

![](img/95abc035a3f0347850e3e2ee205adfc6.png)

贝叶法则公式。信用:[中等](https://www.google.com/url?sa=i&url=https%3A%2F%2Fseeve.medium.com%2Fmachine-learning-bayes-theorem-2f48c33d51e5&psig=AOvVaw3Hbv7evmVXKT07PIhkrjm4&ust=1618861442854000&source=images&cd=vfe&ved=0CAMQjB1qFwoTCKj--vzGiPACFQAAAAAdAAAAABAP)

上面显示的公式对于理解在给定一些新信息的情况下事件的概率如何变化是至关重要的。符号 P(A|B)基于事件 B 已经发生的假设来讨论事件 A 发生的概率。

公式的精确推导与本文的用途无关；然而，理解这个规则和它是如何工作的是必要的，因为它在隐马尔可夫模型本身中起着很大的作用。请注意，Baye 规则可以根据给定的新信息不断复合。

# 马尔可夫链和 hmm 背后的直觉

![](img/6358087750552bd522f1bf2b1a3acab7.png)

我们 HMMs 的目标——预测核苷酸序列的功能。

HMMs 可以通过两种状态来描述:隐藏的状态**和观察到的状态**。隐藏状态是导致这些发射的原因，并导致上面显示的上述观察结果。

一个例子可以通过季节如何影响天气来说明。在这种情况下，观察到的状态是晴天还是下雨，而隐藏的状态是季节本身。注意，季节会有一个预定义的下雨或不下雨的概率。像秋天这样的季节比夏天这样的季节更有可能下雨。

在上面的例子中，将发射/观测定义为太阳、雨、云和雪的集合，而隐藏状态是季节(夏天、秋天、冬天和春天)。如下所示，它们可以分别由矢量 pi 和 x 定义。也表示了转移概率(意味着一个隐藏状态到另一个隐藏状态的概率)。

![](img/c1a822f50b85c030de9b2714a1bf2ebc.png)

天气预报模型示例的简化马尔可夫链。资料来源:[麻省理工学院](https://ocw.mit.edu/ans7870/6/6.047/f15/MIT6_047F15_Compiled.pdf)

这些转移概率通常也是基于用户的预定义输入来生成的。它被定义为在给定前一状态为隐藏状态 *k* 的概率的情况下进入该隐藏状态的概率。

这些**马尔可夫链**是整个 HMM 内部的一个步骤，它们通常被定义为一个**三元组(Q，p，A)** ，其中 Q 代表状态集，A 是转移概率矩阵，p 是初始概率的向量。稍后我们会深入探讨初始概率。

使马尔可夫链如此受计算生物学家欢迎的是它的**无记忆状态，它的计算只依赖于前一个状态**，与其他传统算法相比，导致了极小的空间复杂度。

## 马尔可夫链和 hmm 的区别

![](img/4e49e69897b4e093c7b7535092dd72de.png)

隐马尔可夫模型的例子。信用:[中等](https://www.google.com/url?sa=i&url=https%3A%2F%2Fmedium.com%2F%40kangeugine%2Fhidden-markov-model-7681c22f5b9&psig=AOvVaw2IC6YXVbl1GFO2fdHQteVm&ust=1618940289143000&source=images&cd=vfe&ved=0CAMQjB1qFwoTCND4l9nsivACFQAAAAAdAAAAABAM)

在天气的例子中，所谓的“隐藏”状态是研究人员已经知道的状态。每个人都知道一个季节在特定天气模式下的排放概率，因为气象数据已经给了我们这些数据。

在隐马尔可夫模型中，这些观察结果或辐射将来自一组特定的概率。这些状态对观察者来说是隐藏的，并且在每个状态中会有以一定概率产生的观察值(通常称为**发射概率**)。

简而言之，当观察/发射来自于**我们无法观察到的系统的一组状态**时，使用 hmm。这不同于马尔可夫链，马尔可夫链已经预先定义了状态。

# HMMs 的数学符号

与三元组马尔可夫链相比，隐马尔可夫模型被正式定义为 **5 元组(Q，A，p，V，E)** ，其中 V 是观察符号的集合(通常是核苷酸碱基或氨基酸的集合)，E 是发射概率的矩阵，通常定义为:

![](img/bba0b157c853e72b28cc272a63446cb4.png)

给定状态 s 时观察符号 k 的发射概率(在矩阵中为行 s 和列 k)。

## hmm 示例

![](img/685cdadb039dbceaab92d25a5fa5a0f8.png)

隐马尔可夫模型的图形表示。学分:[麻省理工学院](https://ocw.mit.edu/ans7870/6/6.047/f15/MIT6_047F15_Compiled.pdf)

预定义的 HMM 模型通常看起来像上面看到的那样。对于每一个含氮碱基，都有一个相关的概率关系，它显示了隐藏态释放特定含氮碱基的可能性。

利用某些序列(例如 ACCCATAC)，我们可以确定自身和病毒隐藏状态的概率，并查看在给定发射序列的情况下哪个隐藏状态最有可能发生。

注意有三种可能:隐藏状态**不从自身状态**改变，隐藏状态**不从病毒状态**改变，隐藏状态**从自身和病毒状态**改变。

然而，最后一种概率通常不被推荐，因为不同状态之间的转移概率通常低于简单循环回到相同状态的转移概率(例如，自我→病毒转移概率是 0.05，而自我→自我转移概率是 0.95)。

为了计算上述这些状态和观察到的排放的概率，我们需要取三项的乘积:

*   从自我/病毒隐藏状态开始的概率
*   如果我们有一个预先定义的特定状态，有这些特定发射概率的概率
*   转移概率(保持相同状态或切换)

它通常被定义为 **P(x，pi) = P(x|pi)P(pi)** 正如我们的 Baye 法则所指出的，其中 x 是发射向量，pi 是隐藏向量。

简而言之，具有给定特定状态(即 P(x，pi))的发射概率的概率是初始状态概率与取决于发射向量的发射和跃迁概率的乘积。

## 概率计算示例

以 pi = {S，S，S，S，S}和 x = {A，T，C，G，A}为例，其中 S 表示正在使用自状态，那么我们可以计算 pi 和 x 都为的联合概率:

P (x，pi)=(0.5)x(0.25)⁵x(0.95)⁴= 3.977 x 10^(-4)

请注意，这只是前述初始概率、跃迁概率和发射概率的**乘积。**

这些概率计算通常很小，因为有许多小数字在相互相乘。我们经常只看概率最高的一个，认为那是我们最有可能的状态。

![](img/a8ea8e81e9334a72392f819a6882ae12.png)

另一个常见的例子是，计算{F，F，F，F，F，L，L，L，F，F}的 pi 向量和{1，2，1，5，6，2，1，6，2，4}的发射向量的概率。

## 解释 HMM 概率

看上面的例子，对于五个核苷酸序列，在自身和病毒状态之间存在 2⁵隐藏状态集。

因此，HMM 遍历所有 32 个组合，以便找到最可能的状态(即具有最高联合概率的状态)。注意，这 32 种组合还包括在不同状态之间转移的转移概率。

因此，根据长度为 *n* 的发射序列，需要运行 2^n 隐藏状态集的**广义假设。如前所述，即使是只有 100 个碱基对的序列，这也会使计算变得繁重。因此，更强的分析方法是必要的。**

![](img/bb1fc84c078b5ee28376a2896c5fab72.png)

时间复杂度图。我们想要多项式或对数运行时间，而不是指数运行时间。

# 含 hmm 的 GC 富集区

既然已经理解了 hmm 的基本直觉，就可以讨论如何用它们来解决生物学问题了。

hmm 是革命性的，因为它们可以预测潜在的内含子、外显子、转录因子等。就在一个 DNA 片段上。具体来说，出于我们的目的，我们将着眼于 GC 丰富的区域来模拟这些序列。

## 富含 GC 的区域和 CpG 岛

![](img/ac68fe174c84c63c184e324445da42b8.png)

CpG 网站的图片。鸣谢:[维基百科](https://www.google.com/url?sa=i&url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCpG_site&psig=AOvVaw3KWibee1IEBSQb2FDrXJZu&ust=1618940611577000&source=images&cd=vfe&ved=0CAMQjB1qFwoTCIjbhP7tivACFQAAAAAdAAAAABAJ)

如果这些区域充满了胞嘧啶和鸟嘌呤(两个互补的含氮碱基)，通常被称为富含 GC。

这些区域通常被定义为**少于 200 个碱基对，GC 百分比高于 50%，观察到的与预期的 CpG 比率大于 60%的区域。**请注意，这些数字可以实现到我们的 HMM 模型中，以检查特定的 CpG 岛。

利用我们对 HMMs 的了解，我们可以说，在这些富含 GC 的区域中，胞嘧啶和鸟嘌呤比腺嘌呤和胸腺嘧啶具有更高的发射概率。通常，这些启动子区域对于 G 和 C 有 30%和 42%的概率，而对于 A 和 t 只有 15%和 13%的概率。

基于发射概率，我们现在想要找到最佳状态(由启动子或 CpG 区域和非启动子或背景区域组成),其最大化隐藏状态和发射状态的总联合概率。

这可以通过**动态编程**来完成，这将在本文后面讨论。

![](img/b22c5bf14b6fbb34abe04b6c940f0eca.png)

具有所有背景状态的任意序列路径的概率。

![](img/5dd20aa82ca17fff33656bcfdc63feb3.png)

背景和启动子状态混合的任意序列路径的概率。

再次讨论之前讨论的问题，随着序列长度的增加，最大联合概率变得越来越难以计算，因此有必要**使用动态编程来减少 HMM 的计算运行时间。**

# 解码最可能路径—维特比算法

由于**必须检查的路径的指数数量**，寻找这种联合概率的强力方法不会有什么结果，这使得它非常不切实际和耗时。然而，通过动态编程，我们可以最小化这个时间复杂度，并得到一个更好的解决方案。

**动态编程**旨在将问题分解成更小的子类别，就像递归循环一样。它们通常用于**优化问题**，利用了问题的最优解也依赖于子问题本身的最优解这一事实。

像 Needleman-Wunsch 算法这样的算法使用动态编程来寻找相似的核苷酸序列(考虑插入、删除和突变)；欲了解更多信息，请查看这篇文章。

我们解决这个问题的主要目标是**尝试根据观察或发射概率**找到最可能的状态。注意，在这个问题中，发射概率(E)、转移概率(a)和发射序列(x)都是给定的。我们试图找到隐藏状态(pi)的序列，使得**最大化给定这些发射**的联合概率，或者找到

![](img/5dd4945062fbe40579db404a442e4199.png)

注意，动态规划可用于此问题，因为最佳路径可从先前状态的最佳路径中获得；我们只需**形成一个递归关系就可以找到最优路径**。设 v(i)为特定状态下在位置 *i* 处结束的最可能路径的已知概率。这种循环被定义为:

![](img/9908817eb8caac6822673fabe63b9257.png)

这只是说最可能状态的下一个已知概率由跃迁概率和前一个状态之间的**最大概率和当前状态的发射概率给出。**

本质上，最大化的主要事情是从所有可能的先前状态到另一个特定状态的跃迁，然后乘以发射概率本身。这种最大化可以通过向后指针来检查，可以通过回溯来找到最佳路径。

以下是维特比算法的四个主要步骤(数学上):

![](img/3a3863fb542a0567c283cb591991d650.png)

第一步，**初始化**，为起始列分配概率 1(因为没有发射或跃迁概率在其上相乘)，而所有其他列 *k* 的概率为零。

第二步，**递归**，遍历之前讨论过的递归关系，并简单地将它存储在一个指针中，该指针将在稍后通过我们的动态编程算法进行回溯时被访问。

第三步，**终止**，通过回溯找到最佳路径，直到找到最优路径序列路径；这是最大概率最高的一个，一直到第一列。

最后一步， **traceback** ，简单地分配那些任意路径指针，这取决于它们在隐藏矩阵中的值。

![](img/9bbca6509c11cdaea80a474c3ee31309.png)

动态维特比算法的可视化表示。

有了 K 个态和 N 个发射态，我们可以说有 O(KN)的空间复杂度和 O(K ^ N)的时间复杂度，比蛮力算法的指数运行时间要好得多。

## 在所有路径上解码

在对所有路径进行解码的领域中已经进行了进一步的研究，其中我们找到了状态 pi*的路径，该路径包含每个时间点最可能的状态。这意味着具有最低**乘法概率**(包括先前概率和跃迁及发射概率)的状态。

这是通过**后验解码**的过程来完成的，该过程试图找到各个位置的潜在状态的概率，而不是整个位置序列的概率。通过动态编程进行后验解码的主要递归公式是:

![](img/4c25dfa31ad865859f82efee1ad02970.png)

**注意:**后验解码可能给出无效的状态序列，因为它没有考虑状态之间转换的可能性，而是对每个位置独立地进行。

![](img/5743719e33ee7891bc37b6e31f921d42.png)

后验解码算法的空间表示。

后验解码和维特比算法都有各自的优点和缺点；然而，维特比算法**最常用于根据核苷酸序列推断功能。**

后验解码与我们论文的目的无关，所以不做讨论；但是，更多信息可以在这里找到[。](https://ocw.mit.edu/ans7870/6/6.047/f15/MIT6_047F15_Compiled.pdf)

# 多路径评分

我们已经知道如何使用上面解释的联合概率计算来计算一个路径的概率，利用对初始、发射和跃迁概率的理解。

对于多条路径上的评分，也可以采用类似的方法。如果我们对**知道给定隐马尔可夫模型的特定序列的可能性特别感兴趣，我们经常使用这个分数。**

它不是关注隐藏状态，而是通过简单地将所有的 2^n 隐藏集相加来关注观察到的状态。给定观察序列的隐藏状态的所有路径 pi 的概率由以下公式给出:

![](img/fdfcb7b77f78346e2b3c6091afd8984c.png)

使用强力方法，这是一个指数运行时，但动态编程可以用来解决这个问题，通过向前算法。

![](img/febcfd0e171ac75451e436939d9861fa.png)

这遵循与维特比算法类似的**初始化过程和迭代过程；然而，它不是取先前概率和转移概率的最大值，而是取总和。**

这个迭代过程**通过将所有相遇**中的跃迁和发射概率相乘来计算所有的概率。最后，它通过对所有元素概率求和以得出最终的联合概率而终止。它由同一个空间给出:

![](img/a3a9e4aec479f317c9e7d09fc562440f.png)

# 算法比较

![](img/75ac0d6dbebf35bae9dedc47ee4cb22f.png)

对所讨论的不同算法的全面概述。

这些算法通过这些隐马尔可夫模型在评分和解码中发挥着重要作用。可以考虑进一步的监督和非监督模型，以便使该过程更具生成性；然而，在本文中不会讨论这个问题。

有关推断核苷酸序列功能的监督和非监督学习策略的更多信息，请参考 **Baum-Welch 算法和 Viterbi 训练**。更多信息可在[这里](https://ocw.mit.edu/ans7870/6/6.047/f15/MIT6_047F15_Compiled.pdf)找到。

# 基因组应用

隐马尔可夫模型可以用于各种不同的场景，包括蛋白质编码保守区的检测，染色质状态的检测，蛋白质编码基因结构的检测。

![](img/838bc5d5d266de27360abfedec6d0704.png)

显示马尔可夫模型的不同基因组应用的表格。

## CpG 岛和 HMMs

CpG 岛，或在链上有成对的 C 和 G 核苷酸的区域，是这篇论文的主要焦点。当它出现在基因组中时，它通常会甲基化，胞嘧啶的脱氨基作用会导致胸腺嘧啶(引起 C 到 T 的突变)。

由于这种甲基化，这些 CpG 岛随着进化时间的推移而减少，并且由于胞嘧啶的高突变频率，它们通常很罕见。然而，当它们靠近活性启动子时，这种甲基化功能可以被抑制，CpG 岛通常存活。

![](img/6f66a3b7a7a6a53e748f26ea28e93150.png)

CpG 岛的演化过程及其如何随时间退化。信用:[维基百科](https://en.wikipedia.org/wiki/File:Cpg_island_evolution.svg)

因此，**检测这些 CpG 岛可以突出人类基因组内部的特定启动子区域**。使用阅读框检测高水平 Cs 和 Gs 的传统应用已经过时，因为太小的窗口可能无法捕获 CpG 岛，而太大的窗口可能导致 CpG 岛被遗漏。因此，hmm 是对此建模的关键。

这些马尔可夫模型经常存在的一个问题是随着这些参数的增加而过度拟合的**问题，这可能会过度拟合数据并导致精确度降低。因此，减少参数是必要的，或者通过使所有的转移概率为相同的值，或者简单地在我们关注的状态上进行转移。**

# 摘要

hmm 正在发展成为生物信息学领域中通过 Baye 规则和概率计算推断核苷酸序列功能的新方法。hmm 通常具有隐藏状态和观察状态，其中特定隐藏状态具有发射特定观察状态的概率，通常表示为发射概率。

给定隐藏状态的整个观察状态的联合概率通过将初始概率与发射和转移概率(一个隐藏状态到另一个隐藏状态的概率)相乘来计算。为了找到某个序列的所有隐藏路径上的分数，可以通过动态规划和正向算法来计算这些联合概率的总和。

反其道而行之，通过基于核苷酸序列解码功能:可以有两种方法。维特比算法可用于寻找核苷酸序列之间最可能的隐藏路径，而后验解码可用于寻找在任何时间点包含最可能状态的路径(非路径)。

通过 Viterbi 和 Baum-Welch 训练，可以进行进一步的机器学习技术，以使该方法更具生成性，并且更少预定义。

# 额外资源

*   **文章:**[GHMMs 简介](http://www.cs.tau.ac.il/~rshamir/algmb/00/scribe00/html/lec07/node28.html)
*   **教科书(第 8/9 章):** [计算生物学:基因组、网络和进化(麻省理工学院课程 6.047/6.878)](https://ocw.mit.edu/ans7870/6/6.047/f15/MIT6_047F15_Compiled.pdf)
*   **研究论文:** [生物序列分析](http://www.mcb111.org/w06/durbin_book.pdf)
*   **研究论文:** [寻找基因组 DNA 中的基因](https://www.sciencedirect.com/science/article/abs/pii/S0959440X98800699)
*   **研究论文:** [什么是隐马尔可夫模型？](https://www.nature.com/articles/nbt1004-1315)
*   **研究论文:** [CpG 岛和基因](https://www.sciencedirect.com/science/article/abs/pii/0959437X95800441)
*   **研究论文:** [利用隐马尔可夫模型重新定义 CpG 岛](https://scholar.google.com/scholar?hl=en&as_sdt=0%2C5&q=cpg+islands+hmms&btnG=)
*   **研究论文:** [利用隐马尔可夫模型算法预测牛 CpG 岛及其与基因组特征的关系](http://journals.iau.ir/article_524563.html)
*   **研究论文:** [高阶隐马尔可夫模型及其在 DNA 序列中的应用](https://link.springer.com/chapter/10.1007/978-3-540-45080-1_73)
*   **研究论文:** [维特比算法](https://ieeexplore.ieee.org/abstract/document/1450960/)
*   **研究论文:**
*   **研究论文:** [多观测空间隐马尔可夫模型的改进 Baum-Welch 算法](https://ieeexplore.ieee.org/abstract/document/917686)
*   **研究论文:** [桥接 Viterbi 和后验解码:基于 HMMs 的隐藏路径推断的广义风险方法](https://www.jmlr.org/papers/volume15/lember14a/lember14a.pdf)

你好！我今年 16 岁，目前对机器学习和生物技术领域感兴趣。如果你有兴趣看到更多我的内容和我发布的内容，可以考虑订阅我的 [*简讯*](https://forms.gle/gdCammxd628UTQ9j9) *！查看我的三月简讯* [*这里*](https://preview.mailerlite.com/n3t1o8) *！还有，看看我的*[*LinkedIn*](https://www.linkedin.com/in/karthikmittal/)*和*[*Github*](https://github.com/karthikm15)*页面。如果你对个人心态感兴趣，或者只是一般的东西，使用我的* [*日历*](https://calendly.com/karthikmittal306) *注册聊天。*