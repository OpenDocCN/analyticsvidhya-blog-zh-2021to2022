<html>
<head>
<title>Sentiment Analysis —How to estimate the rating from movie review</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">情感分析——如何评估电影评论的评分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sentiment-analysis-how-to-estimate-the-rating-from-movie-review-62044a49c52?source=collection_archive---------25-----------------------#2021-05-28">https://medium.com/analytics-vidhya/sentiment-analysis-how-to-estimate-the-rating-from-movie-review-62044a49c52?source=collection_archive---------25-----------------------#2021-05-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="ff2c" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">对一篇文章中表达的观点进行计算机识别和分类的过程</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/7826a3f7633909c1ae9776f5ce909395.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yqhdgVURaRKH1nemeAp7Kw.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">提交的电影评论的预测评级示例</figcaption></figure><h2 id="21c0" class="jm jn hh bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated"><span class="l kk kl km bm kn ko kp kq kr di">我</span> <strong class="ak">简介</strong>:</h2><p id="8bbe" class="pw-post-body-paragraph ks kt hh ku b kv kw ii kx ky kz il la jx lb lc ld kb le lf lg kf lh li lj lk ha bi translated">你上一次看电影并提交评论是什么时候？或者在一家不错的餐厅享用了一顿丰盛的晚餐并提交了反馈？这个怎么样？您提交您的评估，评级就会以电子方式生成。酷吧！</p><p id="fc0d" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">欢迎来到自然语言处理(NLP)领域，更具体地说是“情感分析”。情感分析又称为<strong class="ku hi">意见挖掘</strong>或<strong class="ku hi">情感AI </strong>，是指利用自然语言处理、文本分析来系统地识别、提取、量化主观信息[1]。在本文中，我们将尝试实现同样的目标，即从提交的评论中生成电影评级。</p><h2 id="9914" class="jm jn hh bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">先决条件:</h2><ol class=""><li id="8ee3" class="lq lr hh ku b kv kw ky kz jx ls kb lt kf lu lk lv lw lx ly bi translated">情感分析的理论知识和概念，如RNN，LSTM，GRU，词嵌入等。所有这些都包含在吴恩达的<a class="ae lz" href="https://www.coursera.org/learn/nlp-sequence-models#syllabus" rel="noopener ugc nofollow" target="_blank">序列模型</a>的奇妙历程中</li><li id="2f8e" class="lq lr hh ku b kv ma ky mb jx mc kb md kf me lk lv lw lx ly bi translated">Python +任意代码编辑器的知识(这里我们会用到Jupyter笔记本)</li></ol><h2 id="7aea" class="jm jn hh bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">编码:</h2><p id="d1d4" class="pw-post-body-paragraph ks kt hh ku b kv kw ii kx ky kz il la jx lb lc ld kb le lf lg kf lh li lj lk ha bi translated">假设关于主题的先决知识，我们的动机是首先在具有短语/单个单词(size=#100000)和相应情感(评级)的字典上训练模型。训练后，我们将使用评论中提交的新的未见过的短语/单词来测试它，并观察它给出的评级！就这么简单。我将尝试描述一步一步的编码。<br/>首先，让我们创建一个新的Jupyter笔记本文件。在我们的文件所在的根目录下，创建一个名为“input”的文件夹。现在下载培训数据和文件。即train.tsv，test.tsv .和sampleSubmission.csv是我们的输出文件。我们的文件夹结构如下所示。<br/>-sentient analysis . py<br/>-input<br/>-train . tsv<br/>-test . tsv<br/>-sample submission . CSV</p><p id="d476" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">让我们开始编码。首先，我们将导入所需的库。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mf"><img src="../Images/a5c7d508937773ec698d0225681e90b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6qcuZwsepsBhxGzWiT0XzA.png"/></div></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mg"><img src="../Images/acd7319bd36f1516cb9a663fa077dec7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*60fRY9kDFjSPssf_i6ZW0w.png"/></div></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mh"><img src="../Images/5229211b700f3c2efd83d7ee7b5d8fed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*110oHTrfArUCJQ5ZXYxpWw.png"/></div></div></figure><p id="5049" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">自然语言工具包，或更常见的NLTK，是一套用于用Python编程语言编写的英语的符号和统计自然语言处理的库和程序。TQDM是一个进度条库，对嵌套循环和Jupyter/IPython笔记本有很好的支持。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mi"><img src="../Images/cf08e2e32446d9cf141239b80ce57043.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TAQYb8_srv_r1RWBOeLIhA.png"/></div></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mg"><img src="../Images/b15f0988c82b42f3879a002e747192dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KDOiinPvn95ZUvCrcelfZQ.png"/></div></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mj"><img src="../Images/eded6456efe19f4ee15a4ec64e70cf27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mXLDpTx5bnvSY-Hwu8GVnA.png"/></div></div></figure><p id="4a54" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">如果您观察这里的输出(这是我们的训练数据)，评论句子被分解为每个名为短语的单词，用PhraseId表示，情感被分配给每个单词。对训练数据中的所有复习句子都这样做。这构成了我们的字典。下面的函数将迭代地获取每个短语，它将删除html内容，删除非字母字符，标记句子，将每个单词按其词条分类，然后在名为“reviews”的列表中返回结果</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mi"><img src="../Images/d849a07bd1e0765b7771f79cc5234b6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zkZBlqA6KCBoqg9tm5vwkw.png"/></div></div></figure><p id="9922" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">接下来，检索训练集和测试集的干净评论</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mk"><img src="../Images/3f74f6b25bb3d26f484c125060b89ac2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RTnVJR0hR9-AiDbcZE-hKA.png"/></div></div></figure><p id="6c5a" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">使用下面的代码，我们将输出值按类的数量进行分类。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ml"><img src="../Images/3c53448826b2b5f476a626b55bad8357.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A7k8MlMTxDWr0vBTaPn0wg.png"/></div></div></figure><p id="192b" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">我们已经为训练准备好了所有的数据。让我们分成训练组和验证组。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mm"><img src="../Images/da9c7be7f33ac2b1d4b2f99905df710b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZQdzTrPEifh5gLmsG292xA.png"/></div></div></figure><p id="2644" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">此外，我们将在清理评论列表中获得唯一单词的数量和评论的最大长度。它是初始化Keras的标记器和后续填充所需要的。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mn"><img src="../Images/513cd39d6bb823bab932554a674df292.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cUay6ukMuZ5rfVsuDYvmTw.png"/></div></div></figure><p id="be52" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">下面是Keras和convert to sequences的实际标记器。这将参数作为要转换为序列的文本列表。并返回—序列列表(每个文本输入一个)。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mn"><img src="../Images/c496da5d43ad25410ba73e3b39d7150f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-3NAbBhY6b4CRXM8BflgMA.png"/></div></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mo"><img src="../Images/441ab309a791144ba002f7366d9fbeca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8anrb90zRXFlrw5zMyz02w.png"/></div></div></figure><p id="ca6b" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">接下来进行填充，以均衡所有输入评论的长度。LSTM网络要求所有输入长度相同。因此，小于最大长度的评论将在末尾使用额外的零来表示相等。这是填料。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ml"><img src="../Images/99372e926569851c35d336a05376d510.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0ydzNaJ2KIecTuB5stH-NQ.png"/></div></div></figure><p id="9277" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">为了防止过度拟合，我们将使用提前停止作为模型拟合函数调用中的回调。我们来定义一下。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mn"><img src="../Images/7420754d3deca107b48f6fc3f01f4873.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pRPt_ZvZnI1FY2vC7HvIRw.png"/></div></div></figure><p id="276a" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">让我们使用LSTM定义模型，即Keras。此外，我们将使用多层感知器(MLP)进行多类softmax分类。这个体系结构是专门为处理序列数据而设计的。它非常适合许多NLP任务，如标记和文本分类。它将文本视为一个序列，而不是一堆单词或语法。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mp"><img src="../Images/73f07d8047e54a228534268c784664f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xheF_Sn-qPNvGqEHFiysvg.png"/></div></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mq"><img src="../Images/ffccdf7f1a1b800e89f41ff2b801e3b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*39zYQVLv2XRF-OFy7Q9BAQ.png"/></div></div></figure><p id="aaf5" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">让我们在训练好的模型上做预测。并提交输出。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mr"><img src="../Images/20a3120746aa86628bcd56c171ab6764.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yU5Snzl7QlWLeK8vFlLA5w.png"/></div></div></figure><p id="f031" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">在这里，我们已经创建了一个示例输出，用于根据测试数据编写我们的预测。这是我们的样本输出。这个文件代表了我们的输出应该是什么样子。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ms"><img src="../Images/b2197a5d028a18c4b219c4efa10e85b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*X7-ECa0lwE0g9Pn8wKCAGw.png"/></div></figure><p id="8d65" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">最后，我们将把实际输出写入output.csv文件。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mt"><img src="../Images/f447bbef2f4b6926f13533c3890477f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hdoSSXuQb_x6Ci0mpl9P-g.png"/></div></div></figure><p id="ef37" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated"><strong class="ku hi">结论</strong>:</p><p id="56b1" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">我们已经观察到，使用NLP方法，情感预测是相当准确的。模型训练依赖于训练字典。准确度取决于时期数、丢失率、批量大小、层数、优化器、单词长度。因此，最佳精度来自某个组合，人们可能会尝试看看这个组合是什么。在我们的例子中，使用128层LSTM模型、50%的漏失和Adam优化器获得了最佳精度。</p><p id="c5f8" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">感谢您朗读这篇文章。希望有帮助。<br/>你可以在这个<a class="ae lz" href="https://github.com/darshanadakane/sentimentAnalysis_usingPython" rel="noopener ugc nofollow" target="_blank">链接</a>找到Github回购。</p><p id="ae1a" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated"><strong class="ku hi">参考文献:</strong></p><p id="6156" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">[1]情绪分析，<a class="ae lz" href="https://en.wikipedia.org/wiki/Sentiment_analysis" rel="noopener ugc nofollow" target="_blank">维基百科</a></p><p id="9611" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">[2] <a class="ae lz" href="https://www.youtube.com/watch?v=DqqWTubHEaA&amp;list=PLZnyIsit9AM7yeTZuBmezKNc6hFHUPImh&amp;index=3" rel="noopener ugc nofollow" target="_blank"> RNN模式</a>吴恩达l</p><p id="044e" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated">[3] <a class="ae lz" href="https://www.youtube.com/watch?v=Fnk4Z-muD5A&amp;list=PLZnyIsit9AM7yeTZuBmezKNc6hFHUPImh&amp;index=5" rel="noopener ugc nofollow" target="_blank"> RNN建筑事务所</a>，吴恩达</p><p id="47a9" class="pw-post-body-paragraph ks kt hh ku b kv ll ii kx ky lm il la jx ln lc ld kb lo lf lg kf lp li lj lk ha bi translated"><a class="ae lz" href="https://www.youtube.com/watch?v=PjMcA_NlB_8&amp;list=PLZnyIsit9AM7yeTZuBmezKNc6hFHUPImh&amp;index=9" rel="noopener ugc nofollow" target="_blank"> GRU </a></p></div></div>    
</body>
</html>