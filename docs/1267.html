<html>
<head>
<title>Predicting Stock Prices Using Facebook’s Prophet Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用脸书的先知模型预测股票价格</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predicting-stock-prices-using-facebooks-prophet-model-b1716c733ea6?source=collection_archive---------1-----------------------#2021-02-22">https://medium.com/analytics-vidhya/predicting-stock-prices-using-facebooks-prophet-model-b1716c733ea6?source=collection_archive---------1-----------------------#2021-02-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="b4e5" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">脸书的先知</h1><p id="f8c0" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">Prophet是一种基于加法模型预测时间序列数据的过程，在该模型中，非线性趋势与每年、每周和每天的季节性以及假日影响相适应。它最适用于具有强烈季节效应的时间序列和几个季节的历史数据。Prophet对缺失数据和趋势变化非常稳健，通常能够很好地处理异常值。</p><p id="77e7" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">最常用的预测模型是<a class="ae kf" href="https://en.wikipedia.org/wiki/Autoregressive_model" rel="noopener ugc nofollow" target="_blank"> <strong class="je hi">自回归</strong> </a>模型。简而言之，自回归模型规定输出变量线性依赖于它自己以前的值和一个随机项(一个不完全可预测的项)。</p><p id="f2f6" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">Prophet模型背后的数学方程式定义为:</p><blockquote class="kg kh ki"><p id="e4f6" class="jc jd kj je b jf ka jh ji jj kb jl jm kk kc jp jq kl kd jt ju km ke jx jy jz ha bi translated"><em class="hh"> y(t) = g(t) + s(t) + h(t) + e(t) </em></p></blockquote><ul class=""><li id="7723" class="kn ko hh je b jf ka jj kb jn kp jr kq jv kr jz ks kt ku kv bi translated">其中，g(t)代表趋势。Prophet使用分段线性模型进行趋势预测。</li><li id="3d55" class="kn ko hh je b jf kw jj kx jn ky jr kz jv la jz ks kt ku kv bi translated">s(t)代表周期性变化(每周、每月、每年)。</li><li id="ad42" class="kn ko hh je b jf kw jj kx jn ky jr kz jv la jz ks kt ku kv bi translated">h(t)代表假期的影响(回想一下:假期影响业务)。</li><li id="6e18" class="kn ko hh je b jf kw jj kx jn ky jr kz jv la jz ks kt ku kv bi translated">e(t)是误差项。</li></ul><p id="eb6c" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">Prophet模型拟合过程通常非常快(即使对于成千上万的观察)，并且不需要任何数据预处理。它还处理缺失数据和异常值。</p><p id="c89c" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">Prophet是由<a class="ae kf" href="https://research.fb.com/category/data-science/" rel="noopener ugc nofollow" target="_blank">脸书的核心数据科学团队</a>发布的<a class="ae kf" href="https://code.facebook.com/projects/%3E" rel="noopener ugc nofollow" target="_blank">开源软件</a>。</p><p id="b537" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">完整的文档和示例可在主页上找到:<a class="ae kf" href="https://facebook.github.io/prophet/" rel="noopener ugc nofollow" target="_blank">https://facebook.github.io/prophet/</a></p></div><div class="ab cl lb lc go ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ha hb hc hd he"><h1 id="b868" class="ie if hh bd ig ih li ij ik il lj in io ip lk ir is it ll iv iw ix lm iz ja jb bi translated">开始编码吧！</h1><p id="2e51" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我们将使用Python来做这个例子。</p><h1 id="9a08" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated"><strong class="ak">加载数据</strong></h1><p id="6865" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我们将使用英特尔1980年至2020年的数据，预测2021年的数值。</p><figure class="ln lo lp lq fd lr"><div class="bz dy l di"><div class="ls lt l"/></div></figure><figure class="ln lo lp lq fd lr er es paragraph-image"><div class="er es lu"><img src="../Images/c49213578760d3287807524a9bb3998f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*uWZyyGT0SWbj4nlbCzoswg.png"/></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">数据头</figcaption></figure><h1 id="9265" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">选择特定数据</h1><p id="c872" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">因为我们将预测“Close”值，所以我们将只选择“Date”和“Close”列。</p><figure class="ln lo lp lq fd lr"><div class="bz dy l di"><div class="ls lt l"/></div></figure><figure class="ln lo lp lq fd lr er es paragraph-image"><div class="er es mb"><img src="../Images/9585e6ba116ed136a25eb8938ed57760.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*Ipm86k34Ap8UQpQIxxUKcw.png"/></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">新数据框架符合型号</figcaption></figure><p id="ab59" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">Prophet的输入总是一个包含两列的data frame:<code class="du mc md me mf b">ds</code>和<code class="du mc md me mf b">y</code>。<code class="du mc md me mf b">ds</code>(日期戳)列应该是熊猫所期望的格式，理想情况下，日期应该是YYYY-MM-DD，时间戳应该是YYYY-MM-DD HH:MM:SS。<code class="du mc md me mf b">y</code>栏必须是数字，代表我们希望预测的测量值。</p><h1 id="4ff4" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">构建模型</h1><p id="56fd" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">Prophet遵循<code class="du mc md me mf b">sklearn</code>模型API。我们创建了一个<code class="du mc md me mf b">Prophet</code>类的实例，然后调用它的<code class="du mc md me mf b">fit</code>和<code class="du mc md me mf b">predict</code>方法。</p><figure class="ln lo lp lq fd lr"><div class="bz dy l di"><div class="ls lt l"/></div></figure><h1 id="18d0" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">预测时间</h1><p id="b20c" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">现在，对于最后一步，我们将要求模型预测未来值，然后将预测可视化。</p><figure class="ln lo lp lq fd lr"><div class="bz dy l di"><div class="ls lt l"/></div></figure><figure class="ln lo lp lq fd lr er es paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="er es mg"><img src="../Images/f12ed8b27fe34e813e14a535ab273dd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SFVH0nXTJ5TQ5-Y00k3I2A.png"/></div></div></figure><p id="0f25" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><strong class="je hi">结论</strong>:根据模型预测，2021年2月，英特尔股价似乎在57.04左右。</p><h1 id="e8bd" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">验证时间</h1><figure class="ln lo lp lq fd lr er es paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="er es ml"><img src="../Images/9d5699325f04413a07f6855af7f02d62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Eh3624WoPuaXaxl9HP6Bww.png"/></div></div></figure><h1 id="a3d8" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">嗯，我们已经中头彩了！！让我们希望它对未来的预测也是正确的！</h1><h1 id="02c7" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">我想让你们试一下这个模型，然后让我知道预测结果如何。</h1><p id="7da2" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated"><strong class="je hi">免责声明</strong>已经有人尝试使用时间序列分析算法来预测股票价格，尽管它们仍然不能用于在真实市场中下注。这只是一篇教程文章，并不打算以任何方式“指导”人们购买股票。</p><h1 id="6ddd" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">也试试我的股票预测模型:</h1><p id="bbe1" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated"><a class="ae kf" rel="noopener" href="/analytics-vidhya/time-series-forecasting-predicting-apple-stock-price-using-an-lstm-model-f1bb73bd8a80"> LSTM模式</a></p><p id="e423" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated"><a class="ae kf" rel="noopener" href="/analytics-vidhya/time-series-forecasting-predicting-microsoft-msft-stock-prices-using-arima-model-be1c45961739"> ARIMA模式</a></p><p id="19e1" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">给我一个<a class="ae kf" href="https://rohan09.medium.com/" rel="noopener">关注</a>如果你喜欢更多的技术博客！</p><p id="01ab" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">再见了。</p></div></div>    
</body>
</html>