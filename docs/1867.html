<html>
<head>
<title>Azure Data bricks query Google Big Query</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Azure数据砖块查询谷歌大查询</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/azure-data-bricks-query-google-big-query-6e3de4ef2ef5?source=collection_archive---------6-----------------------#2021-03-23">https://medium.com/analytics-vidhya/azure-data-bricks-query-google-big-query-6e3de4ef2ef5?source=collection_archive---------6-----------------------#2021-03-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="7620" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">Azure数据砖访问大查询</h1><h1 id="cc09" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">用例</h1><ul class=""><li id="0426" class="jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">从azure数据块访问大查询数据以进行分析</li><li id="ede2" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">用于数据工程</li><li id="8c59" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">用于机器学习</li></ul><h1 id="d978" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">先决条件</h1><ul class=""><li id="f66f" class="jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">Azure帐户</li><li id="7281" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">Azure存储帐户</li><li id="8194" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">Azure数据块</li><li id="d298" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">GCP账户</li><li id="040d" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">GCP项目</li><li id="fcd8" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">GCP大质问</li><li id="165e" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">创建一个样本数据集</li><li id="1cc8" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">提供访问和查询权限</li><li id="e879" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">创建权限JSON文件并下载它</li></ul><h1 id="7136" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">步伐</h1><ul class=""><li id="1e52" class="jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt bi translated">首先创建一个存储帐户</li><li id="116a" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">创建名为gcp的容器</li><li id="4226" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">使用存储资源管理器创建配置文件夹</li><li id="7558" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">上传用于GCP访问的权限json文件</li><li id="94cd" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">保存文件service-access.json</li><li id="46cc" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">现在让我们去数据砖开始编码</li><li id="9443" class="jc jd hh je b jf ju jh jv jj jw jl jx jn jy jp jq jr js jt bi translated">配置集群</li></ul><figure class="ka kb kc kd fd ke er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es jz"><img src="../Images/7faf2bbc62529260399b5874a124b0be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1GFbF-soPZchl4Ec1FlP8g.jpeg"/></div></div></figure><ul class=""><li id="36cb" class="jc jd hh je b jf kl jh km jj kn jl ko jn kp jp jq jr js jt bi translated">让我们创建笔记本</li></ul><pre class="ka kb kc kd fd kq kr ks kt aw ku bi"><span id="552e" class="kv if hh kr b fi kw kx l ky kz">val accbbstorekey = dbutils.secrets.get(scope = "allsecrects", key = "accbbstore")</span><span id="5135" class="kv if hh kr b fi la kx l ky kz">spark.conf.set(<br/>  "fs.azure.account.key.storagename.blob.core.windows.net",<br/>  accbbstorekey)</span></pre><p id="945b" class="pw-post-body-paragraph lb lc hh je b jf kl ld le jh km lf lg jj lh li lj jl lk ll lm jn ln lo lp jp ha bi translated">将驱动器挂载到dbfs</p><pre class="ka kb kc kd fd kq kr ks kt aw ku bi"><span id="3d20" class="kv if hh kr b fi kw kx l ky kz">dbutils.fs.mount(<br/>  source = "wasbs://containername@storagename.blob.core.windows.net/conf",<br/>  mountPoint = "/mnt/gcp",<br/>  extraConfigs = Map("fs.azure.account.key.accbbstore.blob.core.windows.net" -&gt; dbutils.secrets.get(scope = "allsecrects", key = "accbbstore")))</span></pre><p id="3bd5" class="pw-post-body-paragraph lb lc hh je b jf kl ld le jh km lf lg jj lh li lj jl lk ll lm jn ln lo lp jp ha bi translated">列出并查看</p><pre class="ka kb kc kd fd kq kr ks kt aw ku bi"><span id="8b36" class="kv if hh kr b fi kw kx l ky kz">dbutils.fs.ls("dbfs:/mnt/gcp")</span></pre><p id="f6d7" class="pw-post-body-paragraph lb lc hh je b jf kl ld le jh km lf lg jj lh li lj jl lk ll lm jn ln lo lp jp ha bi translated">打印env变量并检查我们是否有授权json</p><pre class="ka kb kc kd fd kq kr ks kt aw ku bi"><span id="7ad1" class="kv if hh kr b fi kw kx l ky kz">%sh printenv</span></pre><p id="b439" class="pw-post-body-paragraph lb lc hh je b jf kl ld le jh km lf lg jj lh li lj jl lk ll lm jn ln lo lp jp ha bi translated">配置bigquery表名</p><pre class="ka kb kc kd fd kq kr ks kt aw ku bi"><span id="fe76" class="kv if hh kr b fi kw kx l ky kz">val table = "projectname.dataset.tablename"<br/>// load data from BigQuery<br/>val df = spark.read.format("bigquery").option("table", table).load()</span></pre><p id="ec52" class="pw-post-body-paragraph lb lc hh je b jf kl ld le jh km lf lg jj lh li lj jl lk ll lm jn ln lo lp jp ha bi translated">显示数据</p><pre class="ka kb kc kd fd kq kr ks kt aw ku bi"><span id="13cb" class="kv if hh kr b fi kw kx l ky kz">display(df)</span></pre><figure class="ka kb kc kd fd ke er es paragraph-image"><div role="button" tabindex="0" class="kf kg di kh bf ki"><div class="er es lq"><img src="../Images/8148170d58d8fdb4aed499e15224b7f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OfhR_MiyhQ71jio4fB6nSA.jpeg"/></div></div></figure><p id="9700" class="pw-post-body-paragraph lb lc hh je b jf kl ld le jh km lf lg jj lh li lj jl lk ll lm jn ln lo lp jp ha bi translated">最后卸载dbfs</p><pre class="ka kb kc kd fd kq kr ks kt aw ku bi"><span id="f3f3" class="kv if hh kr b fi kw kx l ky kz">dbutils.fs.unmount("/mnt/gcp")</span></pre><p id="7307" class="pw-post-body-paragraph lb lc hh je b jf kl ld le jh km lf lg jj lh li lj jl lk ll lm jn ln lo lp jp ha bi translated"><a class="ae lr" href="https://github.com/balakreshnan/Samples2021/blob/main/adb/gcpbigqueryadb.md" rel="noopener ugc nofollow" target="_blank">位于主巴拉克雷什南的samples 2021/gcpbigqueryadb . MD/samples 2021(github.com)</a></p></div></div>    
</body>
</html>