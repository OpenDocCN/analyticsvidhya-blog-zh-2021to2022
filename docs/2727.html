<html>
<head>
<title>Pandas — Zero to Hero — Part 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫——从零到英雄——第三部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pandas-zero-to-hero-part-3-129c417fabaf?source=collection_archive---------24-----------------------#2021-05-14">https://medium.com/analytics-vidhya/pandas-zero-to-hero-part-3-129c417fabaf?source=collection_archive---------24-----------------------#2021-05-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="7651" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">欢迎回到熊猫零到英雄第三部，如果你喜欢从头开始我会推荐你去浏览博客</em> <a class="ae jd" rel="noopener" href="/analytics-vidhya/pandas-zero-to-hero-series-1-5f6ee546dc53?sk=9b8db77d53907295c4a8423b0d8a3a0b"> <em class="jc">第一部</em> </a> <em class="jc"> &amp; </em> <a class="ae jd" rel="noopener" href="/analytics-vidhya/pandas-zero-to-hero-part-2-9af4fe28cd65?sk=81987bd7d593626e8bf76a66ba000842"> <em class="jc">第二部</em> </a> <em class="jc">。在本文中，我将介绍一些帮助我们实现数据管理的活动</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/dd8b5766b5d3d73a9f14d0fe8408be85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wy4wenEKRf4TGr4zxgEPog.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">史蒂文·比诺托在<a class="ae jd" href="https://unsplash.com/s/photos/coding?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="dee7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你是数据工程的新手，那么你一定会说我从未听说过数据操纵或争论？</p><p id="c9c2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">嗯，这是一种将原始数据转换成所需形状以便使用的艺术。很多时候，我们使用excel或使用取决于数据大小的代码来执行这些操作。</p><p id="99f6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是每个数据问题中重要的一步，所以我们必须学习新的数据操作方法。让我们开始吧，因为现在我们对我们正在做的事情有了一个公平的想法。</p><p id="43b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">加入</strong> — <a class="ae jd" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.join.html" rel="noopener ugc nofollow" target="_blank">正式文件</a>或<strong class="ig hi">合并</strong> — <a class="ae jd" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html#pandas.DataFrame.merge" rel="noopener ugc nofollow" target="_blank">正式文件</a></p><p id="e2ab" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">SQL join是如何工作的？我们都知道join是一个SQL子句，用于根据键将一个或多个表连接在一起。</p><p id="7206" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们如此习惯于执行SQL连接，以至于我们认为它在编程中以同样的方式工作，但事实并非如此。然而，为了使其兼容，以便执行类似连接的SQL，我们使用pandas merge，但让我们慢慢理解这些复杂的事情</p><p id="c73b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在SQL表中，主键列必须是唯一的，也就是说，它唯一地定义了表中的一行，但是在数据框中，我们有标识行的索引，它可能是也可能不是唯一的。我们在数据帧索引上使用loc和iloc来访问一行。</p><p id="4297" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，当熊猫想要基于数据帧的索引加入时，即当索引相同时加入，熊猫加入被有效地使用。让我们用一个例子来理解这一点:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ju"><img src="../Images/fbdf96350366a0635900a5bc64f9e463.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*p5B0TLyskJvw9Cxnxog1yA.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">标记_数据帧</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jv"><img src="../Images/1aab4c59ff2cc986b27c647983dcc5cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*zZixlBfX6akxADqbpEgp6g.png"/></div></figure><p id="45c2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有两个数据框<strong class="ig hi">标记</strong>(包含每个学生的所有标记)和科目(包含每个学生的所有科目)。注意，在这个例子中，我们假设一个学生有一个科目。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es jw"><img src="../Images/8562ac11e9890b658abf04ed2deace53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*XReL8NpDz0bh4yQ1OWftHw.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">主题_数据框架</figcaption></figure><h1 id="b79c" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><em class="kv">如果你仔细检查，你会发现这两个数据框有共同点——名字和索引。对于连接，我们使用索引。让我们看看，如果我们应用连接，会输出什么</em></h1><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kw"><img src="../Images/24838febb10ae305b036d5c36b1293d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*zYTz0MoqmJM_tflN_cahOA.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">索引_范围</figcaption></figure><p id="6835" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">两个数据帧具有两个不同的索引范围(0到6)表示7个值，而另一个具有(0到5)表示6个值。将根据索引中的值执行连接操作</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es kx"><img src="../Images/ee7d002ec5a5c30cdd788ac5f94257f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*pSgx9oqBwhsU4Qce86wYiQ.png"/></div></figure><div class="jf jg jh ji fd ab cb"><figure class="ky jj kz la lb lc ld paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><img src="../Images/609c0ddb0df1de998c42631d6dec4d2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*IyID5L91q7DocojBPCGeuQ.png"/></div></figure><figure class="ky jj le la lb lc ld paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><img src="../Images/5f9acf6055ae1e95995dcd86bfc0639e.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*zZixlBfX6akxADqbpEgp6g.png"/></div></figure><figure class="ky jj lf la lb lc ld paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><img src="../Images/54515f7591e555c3edbd75146f82afff.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*tKEq35hHdq_kW6excFjHmw.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx lg di lh li translated">连接类型</figcaption></figure></div><blockquote class="lj lk ll"><p id="1904" class="ie if jc ig b ih ii ij ik il im in io lm iq ir is ln iu iv iw lo iy iz ja jb ha bi translated">如果你仔细观察，基于索引的连接并没有给出我们想要的结果，即每个学生的分数和科目。在上面的快照中，我用黄色突出显示了结果数据框中给出的错误信息。使用pandas <strong class="ig hi"> merge </strong>解决了这个问题，它的表现类似于SQL join(基于列的连接)。</p></blockquote><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lp"><img src="../Images/26ddb8896c11e12dcade9819a7a1c32d.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*xdIuDjVBAzUkhKJ-5ddW7Q.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx translated">使用merge的内部联接</figcaption></figure><p id="c2c5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在检查“使用合并的内部连接”图片，我们现在能够得到想要的结果。每个学生都有自己的分数和科目。</p><div class="jf jg jh ji fd ab cb"><figure class="ky jj lq la lb lc ld paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><img src="../Images/d12bd61ef40cb362d0b914910ecd8b1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/format:webp/1*cQO4iF8n5XDrFFpWCmWmtQ.png"/></div></figure><figure class="ky jj lr la lb lc ld paragraph-image"><img src="../Images/cb4cc4bb1b484c78dc3f0aa3614dd7c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*Jvk1ZhzWXK5IhiGGiTlR5Q.png"/></figure><figure class="ky jj ls la lb lc ld paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><img src="../Images/cbbbddcd61643a95034f107fc87f98fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*VA2ajgXClBFdeqfY7M5BMw.png"/></div><figcaption class="jq jr et er es js jt bd b be z dx lt di lu li translated"><strong class="bd jz">熊猫种类合并</strong></figcaption></figure></div><p id="fb87" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">大多数时候，开发人员、数据工程师和数据科学家在不知道方法用法的情况下使用方法。如果join不起作用，请使用merge。根据上面的解释，你可以根据你的需求决定使用哪一个。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lv"><img src="../Images/297411f1a84dbde2c57170ce36c2a39b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Na5TbCa-tT0U1h_8xWk5wA.jpeg"/></div></div><figcaption class="jq jr et er es js jt bd b be z dx translated">照片由<a class="ae jd" href="https://unsplash.com/@krakenimages?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> krakenimages </a>在<a class="ae jd" href="https://unsplash.com/s/photos/high-five?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="5a37" class="jx jy hh bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">感谢你阅读这篇文章直到最后。在接下来的日子里，我会分享更多的文章。</h1><p id="1d55" class="pw-post-body-paragraph ie if hh ig b ih lw ij ik il lx in io ip ly ir is it lz iv iw ix ma iz ja jb ha bi translated">请给我关于这篇文章的反馈，如果你想知道更多，请评论！！快乐编码和订阅:)</p></div></div>    
</body>
</html>