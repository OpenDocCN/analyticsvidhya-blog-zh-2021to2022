<html>
<head>
<title>The Amazon Stock vs Twitter in 2019</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">2019年亚马逊股票vs Twitter</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/the-amazon-stock-vs-twitter-in-2019-931c88831fc1?source=collection_archive---------13-----------------------#2021-01-16">https://medium.com/analytics-vidhya/the-amazon-stock-vs-twitter-in-2019-931c88831fc1?source=collection_archive---------13-----------------------#2021-01-16</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/d53cb270d7d1d0f28092c49b61c75c7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hSZuQKjVygiyq7nU"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">在<a class="ae hu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae hu" href="https://unsplash.com/@austindistel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Austin Distel </a>拍摄的照片</figcaption></figure><div class=""/><p id="ff49" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">作为一名金融学毕业生和数据科学的在校生，我决定看看金融学中一个并不超级著名的领域，叫做“行为金融学”。<br/>这个领域试图理解和解释为什么投资者会根据不同的情况做出不同的行为。这一领域的主要目标是表明，基于金融个体从理性角度作出决策这一事实的金融标准理论不是我们所能看到的。</p><p id="4e29" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我将重点讨论的假设是对投资者情绪的“大众行为效应”。投资者受大众影响吗？他们都在做同样的决定吗？来自一些“大众媒体”的影响能改变投资者的行为吗？</p><p id="9fd0" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我决定用我的分析来看待这些问题。为此，我选择Twitter来反映投资者的想法。通过推文，你可以了解人们对某个主题或他们的生活的感受和体验。<br/>机器学习和数据科学使得从统计和数学理论中创建的众多算法成为可能。</p><p id="320d" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我将首先介绍我选择的数据和我选择的从推文中获得感觉的方法。然后，我会分析数据，输出里面的内容，最后做情感分析。</p><h1 id="8c4a" class="js jt hx bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">数据</strong></h1><p id="31b1" class="pw-post-body-paragraph iu iv hx iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">我决定获得我自己的数据来创建我自己的分析，并且可以自由地用正确的信息查看我想要的东西。我的分析旨在了解亚马逊在Twitter上的财务情绪。我所说的金融情绪是指对亚马逊股票价值的感觉。为此，我用关键词“$AMZN”取消了2019年全年的推文，这就像一只股票的标签。</p><p id="6c82" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我每月都这样做，以获得更小的文件，这导致了2019年1月导入的代码示例。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="7b18" class="le jt hx la b fi lf lg l lh li">import pandas as pd<br/>import json</span><span id="34cc" class="le jt hx la b fi lj lg l lh li">jan2019 = pd.DataFrame([json.loads(line) for line in open(r'../Amazon Tweets/AMZNjan2019.json', 'r')])</span><span id="354a" class="le jt hx la b fi lj lg l lh li">jan2019.head(5)</span></pre><figure class="kv kw kx ky fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es lk"><img src="../Images/825e47200183a23b669da04f87cdadf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*40ue68IKk9Q3h7Tob8yemQ.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">表1</figcaption></figure><p id="93b7" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">每个数据框架都有许多无用的分析栏，我都删除了，比如“id”，与推文相关的不同链接……我还决定将每个月合并成一个大的数据框架，以便能够以最佳方式进行分析。我得到了2019年<strong class="iw hy"> 185 303条推文的数量</strong>。</p><p id="3bb3" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我得到的数据的一个特点是，来自每条tweet的用户信息存储在主数据帧的一个列中(列“user”)。然后我根据这些信息创建了另外12个表格，这些信息将在后面进行分析。</p><h1 id="525c" class="js jt hx bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">方法</strong></h1><p id="be05" class="pw-post-body-paragraph iu iv hx iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">我想做一个情感分析，这是一个确定一篇文章是积极、消极还是中性的过程，它使用自然语言处理和机器学习来识别句子的极性。</p><p id="f764" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">由于我的语料库是基于金融推文的，使用从远离金融词汇的文本创建的NLP模型会是一个问题。然后，我寻找一个将从大型金融语料库中构建的模型，我找到了<strong class="iw hy"> FinBERT </strong>。</p><div class="hg hh ez fb hi lm"><a rel="noopener follow" target="_blank" href="/prosus-ai-tech-blog/finbert-financial-sentiment-analysis-with-bert-b277a3607101"><div class="ln ab dw"><div class="lo ab lp cl cj lq"><h2 class="bd hy fi z dy lr ea eb ls ed ef hw bi translated">芬伯特:用伯特进行金融情绪分析</h2><div class="lt l"><h3 class="bd b fi z dy lr ea eb ls ed ef dx translated">祖尔库夫·根茨·多乌·坦·阿拉桑</h3></div><div class="lu l"><p class="bd b fp z dy lr ea eb ls ed ef dx translated">medium.com</p></div></div><div class="lv l"><div class="lw l lx ly lz lv ma ho lm"/></div></div></a></div><p id="1b49" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hy"> FinBERT </strong>是一个用于金融情绪分析的预训练模型，由名为BERT的语言表示模型创建。BERT允许对预训练模型进行微调和训练。FinBERT背后的团队使用了BERT预训练模型，并在金融语料库上对其进行了训练:<a class="ae hu" href="https://trec.nist.gov/data/reuters/reuters.html" rel="noopener ugc nofollow" target="_blank"> Reuters TRC2 </a>。</p><p id="73d6" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="ll">现在让我们来看看推文并进行分析… </em></p><h1 id="9312" class="js jt hx bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">2019年I - Amazon推文</strong></h1><p id="67ac" class="pw-post-body-paragraph iu iv hx iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">正如我之前所说，我只看$AMZN的推文，以保持与我想做的事情相关。如果我们注意每天的推文数量，我们就会得到这个结果。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="c8fe" class="le jt hx la b fi lf lg l lh li">import plotly.express as px</span><span id="1a5a" class="le jt hx la b fi lj lg l lh li">AMZN2019_tweets = AMZN2019.groupby(['date', 'month']['username'].count().reset_index()<br/>AMZN2019_tweets.columns = ["Date", "Month", "Number"]</span><span id="54b6" class="le jt hx la b fi lj lg l lh li">fig = px.bar(AMZN2019_tweets, x="Date", y="Number", color="Month", title="Tweets on AMZN per day in 2019", facet_col="Month", color_discrete_sequence=px.colors.qualitative.Antique)<br/>fig.update_xaxes(matches=None)<br/>fig.update_layout(showlegend=False, plot_bgcolor='white', yaxis=dict(title=''), margin=dict(autoexpand=False, l=100, r=20, t=110,))<br/>fig.update(layout=dict(title=dict(x=0.5)))<br/>fig.update_xaxes(visible=False)<br/>fig.show()</span></pre><figure class="kv kw kx ky fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mb"><img src="../Images/a904350195ad55d9347d389f96161004.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w7Zw1BZnWvakwGK1rUMubw.jpeg"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">图1</figcaption></figure><p id="188b" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们可以看到每个月的趋势，推特最少的一天是周末，因为证券交易所关门了。然而，有些日子明显不同于其他拥有超过1500条推文的日子。</p><p id="45c4" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果我们查看第十大推文日，我们会发现:</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="30b2" class="le jt hx la b fi lf lg l lh li">#A Dataframe sorting days by tweets<br/>Ten_mosttweetsdays = pd.DataFrame(AMZN2019_most_tweets.head(10))<br/>Ten_mosttweetsdays.sort_values(by="Number", inplace=True, ascending=True)</span></pre><figure class="kv kw kx ky fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mc"><img src="../Images/e70361ccbe8731697475ee8ecbf9b4a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c1CCMfLiEQ9b-w6GCYjNnQ.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">图2</figcaption></figure><p id="3490" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">2019年$AMZN上推文最多的一天是10月24日。很容易理解为什么。那天，亚马逊召开了一次电话会议，讨论其2019年第三季度的财务业绩(来源1:<em class="ll">press.aboutamazon.com</em>和<em class="ll">纽约时报</em>)。第二个是第二天。推文最多的第三天(2月1日)也可以通过公告来解释。事实上，就在前一天，1月31日，亚马逊公布了第四季度销售额的增长(来源:【press.aboutamazon.com】T21)。</p><p id="3a81" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hy">现在我们来看看谁发推文？</strong></p><p id="b1fd" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果我们关注一年中推文的点赞数量，我们会得到下面的数据帧，显示“<em class="ll"> fillbeforeshill </em>”是第一名。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="aecb" class="le jt hx la b fi lf lg l lh li">AMZN2019_rt = pd.DataFrame(AMZN2019[["username", "retweetCount", "likeCount"]])<br/>AMZN2019_rt.sort_values(by="likeCount", inplace=True, ascending=False)<br/>AMZN2019_rt[:10]</span></pre><figure class="kv kw kx ky fd hj er es paragraph-image"><div class="er es md"><img src="../Images/d5ef868367b9bb817fd713e6e839265a.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*HxzKcfcXB4snp_4jPXa5nQ.png"/></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">表2</figcaption></figure><p id="2eea" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">他的推文并不是真正的金融推文，这可以解释为什么它有这么多喜欢。</p><figure class="kv kw kx ky fd hj er es paragraph-image"><div class="er es me"><img src="../Images/d912a9cd351f2bbb8913fc8728870ad7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*rgXL5xoBT35QF4UOIoH4JA.jpeg"/></div></figure><p id="17d4" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这一年中，在推特上发布了大约$AMZN的最受关注的用户中，“<em class="ll">fillbeforeshill”</em>不存在，这是有意义的，因为谁主宰了前10名的排名，媒体。</p><p id="5589" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为了进行这个排名，我不得不使用关于用户名的信息，正如我在开始的数据演示中所说的。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="b318" class="le jt hx la b fi lf lg l lh li">userframes = [userJan, userFeb, userMar, userApr, userMay, userJun, userJul, userAug, userSept, userOct, userNov, userDec]</span><span id="1719" class="le jt hx la b fi lj lg l lh li">AMZN2019_user = pd.concat(userframes)<br/>AMZN2019_user.reset_index(inplace=True)<br/>AMZN2019_user.drop(columns=['index'], inplace=True)<br/>AMZN2019_user.sort_values(by=['followersCount'], inplace=True, ascending=True)</span></pre><figure class="kv kw kx ky fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mc"><img src="../Images/9fbfcf8536a24fd364e1163c16918c85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p4sUkYPFmeC4QQLPk8ihRQ.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">图3</figcaption></figure><p id="888a" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">路透社以22，813，881的关注者排名第一，接下来是所有媒体，除了Jim Cramer和@OM。</p><p id="1d2e" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在我其余的分析中，我必须只关注英语推文，所以我查看了语料库中使用的语言。我做了一个数据图表，按照一整年使用的语言来统计推文。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="537b" class="le jt hx la b fi lf lg l lh li">tweetsperlang = pd.DataFrame(AMZN2019['lang'].value_counts())<br/>tweetsperlang.reset_index(inplace=True)<br/>tweetsperlang.columns = ["Language", "Number"]<br/>tweetsperlang.loc[len(tweetsperlang.index)] = ['other', tweetsperlang.iloc[6:37, 1].sum()]<br/>tweetsperlang.drop(tweetsperlang.loc[6:37].index, inplace=True)</span></pre><figure class="kv kw kx ky fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mc"><img src="../Images/eb1a1ee929b197f64b7f0aa7b2ed2f66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mSI1bG9yIqwOGikw4m_xRg.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">图4</figcaption></figure><p id="368e" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们注意到，在整个一年中，英语是关于这个主题使用最多的语言。</p><h1 id="a450" class="js jt hx bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak"> II -推文中有什么</strong></h1><p id="d60f" class="pw-post-body-paragraph iu iv hx iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">首先让我们使用著名的库<a class="ae hu" href="https://www.nltk.org/" rel="noopener ugc nofollow" target="_blank"><strong class="iw hy">【NLTK】</strong></a><strong class="iw hy"/>来看看他们自己的推文。这个库用于处理人类语言数据。它允许文本处理，如分类、标记化、词干化… <br/>开始，我必须清除tweets中的特殊字符、链接、表情符号等，所以我使用了带有库<em class="ll"> "re" </em>的<strong class="iw hy">正则表达式</strong> (regex)来为所有的语料库做这件事。我创建了一个应用于“内容”列的函数，并使用了它。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="7c60" class="le jt hx la b fi lf lg l lh li">import re<br/>import nltk<br/>nltk.download('stopwords')<br/>nltk.download('punkt')<br/>from nltk.corpus import stopwords<br/>from nltk import word_tokenize<br/>stop = stopwords.words('english')</span><span id="8fb2" class="le jt hx la b fi lj lg l lh li">def cleaning_tweets(text):<br/>   text = str(text)<br/>   text = text.lower()<br/>   text = re.sub(r'http\S+', ' ', text)<br/>   text = re.sub(r'\b[a-zA-Z]\b', ' ', text)<br/>   text = re.sub(r'\d+', ' ', text)<br/>   text = re.sub(r'[^a-zA-Z0-9]+', ' ', text)<br/>   text = re.sub(r'\s+', ' ', text)</span><span id="eb5e" class="le jt hx la b fi lj lg l lh li">   text = text.split()</span><span id="165e" class="le jt hx la b fi lj lg l lh li">   return text</span><span id="cf81" class="le jt hx la b fi lj lg l lh li">AMZN2019_eng["content_modified"] = AMZN2019_eng['content'].apply(lambda x: cleaning_tweets(x))</span><span id="59ff" class="le jt hx la b fi lj lg l lh li">AMZN2019_eng["content_modified"] = AMZN2019_eng["content_modified"].apply(lambda x: ' '.join([word for word in x if word not in (stop)]))</span></pre><p id="02db" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为了展示它的输出，我们来看一条推文，看看有什么不同:</p><blockquote class="mf mg mh"><p id="5ca2" class="iu iv ll iw b ix iy iz ja jb jc jd je mi jg jh ji mj jk jl jm mk jo jp jq jr ha bi translated">原推文:“孟被捕Vs法治$ QQQ $ AAPL $ AMZN<a class="ae hu" href="https://t.co/AnCqdd8cuq" rel="noopener ugc nofollow" target="_blank">https://t.co/AnCqdd8cuq</a>”</p><p id="422f" class="iu iv ll iw b ix iy iz ja jb jc jd je mi jg jh ji mj jk jl jm mk jo jp jq jr ha bi translated">已清理的推文:“孟被捕vs法治qqq aapl amzn”</p></blockquote><p id="f8cb" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">既然我们有了合适的tweets，我们就能够用NLTK对其进行标记，并从中获取统计数据。单词标记化是将句子拆分成单词的任务。<br/>我用它来<strong class="iw hy">统计整个推特语料库中的每个单词</strong>并找出最常见的。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="c9aa" class="le jt hx la b fi lf lg l lh li">tweets =  AMZN2019_eng['content_modified'].str.lower()<br/>word_counts = Counter(word_tokenize('\n'.join(tweets)))</span><span id="41d2" class="le jt hx la b fi lj lg l lh li">amzn_freq = pd.DataFrame.from_dict(word_counts, orient='index').reset_index()<br/>amzn_freq.columns=["Word", "Frequency"]<br/>amzn_freq.sort_values(by=['Frequency'], inplace=True, ascending=True)</span></pre><figure class="kv kw kx ky fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mc"><img src="../Images/a16d27897e7964231d6912f36a4f50bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1nITZVvealM2WbNSRtIrTg.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">图5</figcaption></figure><p id="9dad" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">由于输出导致许多股票指数，我决定删除主要的，并创建一个新结果的单词云。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="7665" class="le jt hx la b fi lf lg l lh li">from wordcloud import ImageColorGenerator</span><span id="acab" class="le jt hx la b fi lj lg l lh li">wc = WordCloud(mask=mask,max_words=2000, color_func=image_colours, background_color='white')<br/>wc.generate_from_frequencies(word_counts)<br/>wc.to_image()</span></pre><figure class="kv kw kx ky fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es ml"><img src="../Images/4eb91589c0ba35ca47180ff7d39953cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yhpg6QXvPuA4XaQ5nf2mIA.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">词云1</figcaption></figure><p id="6f4a" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">金融的词汇是清晰而明显的。重要词汇可以是现货，如<strong class="iw hy">【买入】</strong><strong class="iw hy">【期权】</strong>或<strong class="iw hy">【看涨】</strong>。</p><p id="aedd" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我对这一年中发推特的所有用户的<strong class="iw hy">描述</strong>做了同样的处理，我得到了这个词云:</p><figure class="kv kw kx ky fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es ml"><img src="../Images/7a6616aa5366b2107384e89bf63793e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pQCSXFLbxnjcOv7MQJQBfg.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">词云2</figcaption></figure><p id="e062" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在Twitter对所有在2019年期间发布关于AMZN的用户的描述中，最常见的词是单词<strong class="iw hy">“Trader”</strong>。这意味着，即使你可以在Twitter上随心所欲地描述自己，这个词出现频率最高也意味着推文关注的是金融市场，而不是其他事情。我们也能发现像“顾问”、“投资者”、“资助者”、“投资”这样的词…</p><h1 id="8c96" class="js jt hx bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">情绪分析和市场</h1><p id="d55d" class="pw-post-body-paragraph iu iv hx iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">我分析的目标是，一方面比较twitter上对$AMZN的感觉，另一方面比较市场的演变。<br/>正如我在开头介绍的，我使用FinBERT对推文进行分类，并得到一个标签(正面、负面或中性)。为了使用这个模型，我使用了HuggingFace的<a class="ae hu" href="https://huggingface.co/transformers/" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hy">变形金刚</strong> </a>库。该库允许使用预训练的模型来完成不同的NLP任务，如分类、文本生成……正如HuggingFace在其平台上所说，它由两个最受欢迎的深度学习库支持，<a class="ae hu" href="https://pytorch.org/" rel="noopener ugc nofollow" target="_blank"> PyTorch </a>和<a class="ae hu" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> TensorFlow </a>，允许用一个训练你的模型，然后用另一个加载它进行推理。</p><p id="670b" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在我的作品中，我使用了我之前介绍过的“普罗苏赛/芬伯特”模型，可以在HuggingFace.co上找到。为了设置它，我使用了AutoTokenizer和库中的AutoModelForSequenceClassification。有了这些类，就可以用他构建的权重和配置来建立模型。由于表格的大小，我在每个月都应用了分类器。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="a5aa" class="le jt hx la b fi lf lg l lh li">from transformers import AutoTokenizer, AutoModelForSequenceClassification<br/>from transformers import pipeline</span><span id="cc83" class="le jt hx la b fi lj lg l lh li">model_name = "ProsusAI/finbert"<br/>model = AutoModelForSequenceClassification.from_pretrained(model_name)<br/>tokenizer = AutoTokenizer.from_pretrained(model_name)<br/>classifier = pipeline('sentiment-analysis', model=model, tokenizer=tokenizer)</span><span id="6338" class="le jt hx la b fi lj lg l lh li">aprSentiment = (aprSentiment.assign(sentiment = lambda x: x['content_modified'].apply(lambda s: classifier(s))).assign(label = lambda x: x['sentiment'].apply(lambda s: (s[0]['label'])),score = lambda x: x['sentiment'].apply(lambda s: (s[0]['score']))))</span></pre><p id="7553" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">以下是四月份的一个示例:</p><figure class="kv kw kx ky fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mm"><img src="../Images/82dcf3f7b16dafd8af9b2e69296a712e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZcXzazvZDIZrXqp5Ab0w5A.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">表3</figcaption></figure><p id="9b5b" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">分类器给出标签和与该标签相关联的分数。分数意味着分类器对于给定标签的确定性水平。</p><p id="e366" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">由于中性情绪主导了一年和每个月，我决定只保留积极和消极的情绪。重要的是要记住，中性情绪比其他情绪更频繁，因为许多推文只是广告、价格信息等，并没有给出任何关于美元AMZN的真实情绪。</p><p id="e0fe" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在查看每个月的情绪之前，我们先用库<em class="ll"> yfinance </em>(来自雅虎财经)<em class="ll">观察一下股票的收盘价格演变。</em></p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="20e1" class="le jt hx la b fi lf lg l lh li">import yfinance as yf</span><span id="cd16" class="le jt hx la b fi lj lg l lh li">amzn_df = yf.download('AMZN',start='2019-01-01',<br/>                      end='2019-12-31',progress=False)</span></pre><figure class="kv kw kx ky fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mc"><img src="../Images/2182506aafe1f37fa569ef1d9108a0c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PQglNMz9MtVi1rvc2JeNFg.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">图6</figcaption></figure><p id="6bee" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">股票价格全面上涨，从一月份的1539美元涨到年底的1846美元。有趣的是观察每月的百分比变化，并将其与之前获得的情绪进行比较。</p><p id="4da8" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">月度百分比变化图如下所示:</p><figure class="kv kw kx ky fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mc"><img src="../Images/18cb80dcde86b873be26c4b8c81d7552.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WEQsJu9zjBpW9BPif12FrQ.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">图7</figcaption></figure><p id="ad01" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">整个数据集中的每月情绪是:</p><figure class="kv kw kx ky fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mc"><img src="../Images/9599f62a051e75d6967ccd4a1ae13355.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZKNtlCi7Z5_CNsbodFiwNg.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">图8</figcaption></figure><p id="460f" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">正如我们所观察到的，大多数月份在推特上被贴上了积极情绪多于消极情绪的标签。这可以通过亚马逊在2019年全年增长20%的事实来理解。该公司每个季度的业绩都非常好。</p><p id="755b" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为了完成我的分析，我决定看看数据集中最有影响力的Twitter账户的情绪。我让从<em class="ll">美国消费者新闻与商业频道</em>到<em class="ll">的20名用户面对全国</em>，观察他们在推特上的情绪。显然，结果导致情绪数据减少，因为$AMZN推文是特定的。</p><pre class="kv kw kx ky fd kz la lb lc aw ld bi"><span id="ff90" class="le jt hx la b fi lf lg l lh li">top20 = AMZNsent.loc[AMZNsent['username'].isin(["CNBC", "Reuters", "ANCALERTS", "MarketWatch", "ReuterBiz", "NYSE", "jimcramer", "om", "YahooFinance", "themotleyfool", "TheStreet", "Stocktwits", "Varneyco","CBOE", "Nasdaq","CNBCnow", "ReutersIndia", "cvpayne", "ValaAshar", "FaceTheNation"])]</span><span id="c11d" class="le jt hx la b fi lj lg l lh li">AMZNsent_b = top20.groupby(['month', 'label', 'month_digit'])['username'].count().reset_index()<br/>AMZNsent_b.columns = ["Month", "Label", 'Month_digit', 'Number']<br/>AMZNsent_b.sort_values(by=['Month_digit'], inplace=True)</span></pre><figure class="kv kw kx ky fd hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es mc"><img src="../Images/142dd75c2225851ef727d15e0ac8d306.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qu3GP2c3WzXg4fg4Ism3zQ.png"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">图9</figcaption></figure><p id="cd77" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">有些月份在积极和消极之间有真正的差别。以4月份为例，看起来这个月，前20名确实看好AMZN。这个月股票上涨了6.19%。相反，在2019年7月，前20名也非常乐观，而股票下跌了2.88%。</p><p id="758f" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们来看看这几个月前20名的推文的一些例子，以了解这一趋势(只有积极的推文)。</p><p id="0f52" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">对于<strong class="iw hy">四月</strong>:</p><blockquote class="mf mg mh"><p id="f4f3" class="iu iv ll iw b ix iy iz ja jb jc jd je mi jg jh ji mj jk jl jm mk jo jp jq jr ha bi translated"><strong class="iw hy"><em class="hx"/></strong>“方股票自12月以来获利6000亿美元，‘涨停’两说，专家(via @ trading nation)$ FB $ AMZN $ NFLX $ GOOGL”</p><p id="7de0" class="iu iv ll iw b ix iy iz ja jb jc jd je mi jg jh ji mj jk jl jm mk jo jp jq jr ha bi translated"><strong class="iw hy"><em class="hx">the street:</em></strong>“Amazon $ AMZN感觉国际增长不错”</p></blockquote><p id="d8b6" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">七月<strong class="iw hy"/>:</p><blockquote class="mf mg mh"><p id="f0cd" class="iu iv ll iw b ix iy iz ja jb jc jd je mi jg jh ji mj jk jl jm mk jo jp jq jr ha bi translated"><strong class="iw hy"> <em class="hx">路透社:</em></strong>“@ Reuters biz亚马逊运营费用激增21%第二季度投入8亿美元一日送达计划$AMZN”</p><p id="6e3f" class="iu iv ll iw b ix iy iz ja jb jc jd je mi jg jh ji mj jk jl jm mk jo jp jq jr ha bi translated"><strong class="iw hy"> <em class="hx"> TheStreet: </em> </strong>“这个称呼似乎让投资者安心。盘后股价下跌约0.5%。美元锌"</p></blockquote><h1 id="aaaa" class="js jt hx bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">结论</strong></h1><p id="25e1" class="pw-post-body-paragraph iu iv hx iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">这个项目试图将股票市场和投资者联系起来。显然很难清楚地看到情绪对市场的影响，特别是我使用的数据，因为它只是市场的一小部分，AMZN。每个投资者都不会用twitter账户谈论股票，他们也不会在推文中用$AMZN来谈论股票，所以很明显，我创建的数据集只是开始查看，并不真的期望高质量的分析会带来很好的结果。然而，我能够观察到一些好的东西，如用户描述中最常用的词和推文中最常用的词，这在很大程度上反映了金融市场和这一年中发推的人(“交易员”、“投资者”、“顾问”…)。用一个训练有素的模型来观察金融句子的情感也是一件有趣的事情。这导致观察到整个一年中占主导地位的积极情绪，以及一些消极方面，特别是来自一年中最受关注的客户。</p><p id="9b44" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">将Twitter或Reddit数据与NLP模型或其他行为金融学的机器学习算法结合使用，试图了解投资者如何做出决策，这可能会有很多有趣的分析。</p><p id="3462" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">整个分析可在<a class="ae hu" href="https://github.com/npogeant/amzn2019" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上获得。</p><p id="7c57" class="pw-post-body-paragraph iu iv hx iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">感谢你阅读这篇文章，希望你喜欢！</p></div></div>    
</body>
</html>