<html>
<head>
<title>Code Diaries: Sentiment Analysis (naive bayes)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">代码日记:情感分析(朴素贝叶斯)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/code-diaries-sentiment-analysis-naive-bayes-827cda7c0808?source=collection_archive---------9-----------------------#2021-04-17">https://medium.com/analytics-vidhya/code-diaries-sentiment-analysis-naive-bayes-827cda7c0808?source=collection_archive---------9-----------------------#2021-04-17</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="94e9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当搜索我下一个最喜欢的素食餐馆时，谷歌评论是我上车前首先查看的地方。我的韩剧选择也是如此。在五颗星中，你认为这位用户对《迫降在你身上的k剧<a class="ae jc" href="https://en.wikipedia.org/wiki/Crash_Landing_on_You" rel="noopener ugc nofollow" target="_blank"><em class="jd"/></a>的评价是多少？</p><blockquote class="je jf jg"><p id="7a98" class="ie if jd ig b ih ii ij ik il im in io jh iq ir is ji iu iv iw jj iy iz ja jb ha bi translated">“毫无疑问，这是我见过的最好的kdrama之一。这是独一无二的，这部剧非常贴近我的心。”</p><p id="014c" class="ie if jd ig b ih ii ij ik il im in io jh iq ir is ji iu iv iw jj iy iz ja jb ha bi translated">-极光星云，谷歌评论</p></blockquote><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es jk"><img src="../Images/a61cf211577c2bb7e6496d4c6b37e80e.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*ZChfk227O4MDgyzIsdXOJA.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">CLOY = <strong class="bd jw"> C </strong>皮疹<strong class="bd jw"> L </strong>安定<strong class="bd jw"> O </strong> n <strong class="bd jw"> Y </strong> ou</figcaption></figure><p id="1e7e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">安娜索菲亚·罗伯的耻辱...这是五颗星，我完全同意；)</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es jx"><img src="../Images/44fa92fe53535dd9f55ff01f08fea970.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*qEcuTkZYd8cTOV7hdpplFA.png"/></div></figure><blockquote class="jy"><p id="e3f0" class="jz ka hh bd kb kc kd ke kf kg kh jb dx translated">好了，关于CLOY，让我们继续另一个有趣的缩写:NLP！！！</p></blockquote><p id="3f0f" class="pw-post-body-paragraph ie if hh ig b ih ki ij ik il kj in io ip kk ir is it kl iv iw ix km iz ja jb ha bi translated">作为我探索学习NLP的一部分，我编写了一个<a class="ae jc" href="https://github.com/jadessechan/Sentiment-Analysis" rel="noopener ugc nofollow" target="_blank">项目</a>，它使用朴素贝叶斯分类器来执行情感分析。与上面的CLOY评论类似，我根据来自<a class="ae jc" href="https://www.kaggle.com/lakshmi25npathi/imdb-dataset-of-50k-movie-reviews" rel="noopener ugc nofollow" target="_blank"> imdb数据集</a>的电影评论训练了我的分类器。这是情绪分析最常见的例子之一，但其他用例包括预测选举结果和市场趋势。在为我的项目做准备时，我了解到情绪被归入<strong class="ig hi">舍雷尔的情感状态类型学:</strong></p><p id="1e8d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">情绪</strong>(如愤怒、悲伤、喜悦)</p><p id="26ab" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">心情(例如，阴郁、愉快、沮丧)</p><p id="b06e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">人际姿态</strong>(如友好、调情、疏远)</p><p id="ea74" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">态度</strong>(例如，喜欢、爱、恨)</p><p id="6a5b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">个性特征(例如傲慢、鲁莽、自信)</p><p id="02a5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于k-drama评论，我们分析了用户的<em class="jd">态度</em>，因为它反映了对一个对象和/或人的倾向。同样，我的程序分析电影评论的态度来预测积极或消极的极性。</p><p id="10d0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">人类的语言充满了细微差别，这使得情感分析——以及一般的NLP充满了挑战。我在<a class="ae jc" href="https://medium.com/p/e3aa4d5325a2/edit" rel="noopener">上一篇关于崩溃开花的文章</a>中提到了这一点。这些细微差别包括——但不限于——<strong class="ig hi">微妙</strong>和<strong class="ig hi">受挫的期望</strong>。例如，imdb数据集中的一些电影评论是:</p><pre class="jl jm jn jo fd kn ko kp kq aw kr bi"><span id="e9ad" class="ks kt hh ko b fi ku kv l kw kx">"The 33 percent of the nations nitwits that still support W. Bush would do well to see this movie, which shows the aftermath of the French Revolution and the terror of 1794 as strikingly similar to the post 9/11 socio-political landscape."</span></pre><p id="bc6f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这篇评论节选是微妙的，因为没有多少关键词表明积极或消极的强烈两极分化。像这样的评论需要关于法国大革命和911的背景政治和历史知识。你不仅要训练你的情感极性分类器，还要训练公众情感。最终，imdb数据集将该审查列为负面。</p><pre class="jl jm jn jo fd kn ko kp kq aw kr bi"><span id="edb5" class="ks kt hh ko b fi ku kv l kw kx">"This show was an <strong class="ko hi">amazing</strong>, <strong class="ko hi">fresh</strong> &amp; <strong class="ko hi">innovative</strong> idea in the 70's when it first aired. The first 7 or 8 years were <strong class="ko hi">brilliant</strong>, but things dropped off after that. By 1990, the show was <strong class="ko hi">not really funny</strong> anymore and it [has] continued its <strong class="ko hi">decline</strong> further to the complete <strong class="ko hi">waste of time</strong> it is today."</span></pre><p id="46e6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">乍一看，这篇评论似乎是积极的，因为它包括了一些积极的联想词:“惊人的”、“新鲜的”等。然而，当你进一步阅读时，真实的情感就会显露出来。这篇评论利用了电影制作的背景；90年代。</p><p id="222f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">幸运的是，imdb数据集预先确定了每个评论的极性。我选择我的程序基于庞和李的<strong class="ig hi">基线方法。</strong>我将代码分为4个步骤，包括标记化、特征提取和分类。</p><p id="d345" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是，基线算法假设数据集中的类频率相等。大多数真实世界的场景并不适合这种场景，但我仍然决定遵循基线方法，因为我的项目的目的是获得情绪分析的入门实践。当处理不平衡的类频率时，会出现许多额外的计算，例如对训练数据进行重新采样、成本敏感学习以及获得F分数以准确训练分类器。</p><p id="4788" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，为了检查我选择的数据集是否平衡，我执行了<strong class="ig hi">探索性数据分析</strong>，以获得每个数据集的摘要。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es ky"><img src="../Images/8e978db32af930ced4820a7ff3d10e7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SPNGDrDrIAaflcpW7UVztQ.png"/></div></div></figure><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es ld"><img src="../Images/d91f8ea66e4d37b0077039c3d9376afb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oPPX9hbtgPkcuBNR8hDNbg.png"/></div></div></figure><p id="035f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里我们可以看到imdb数据集有相等的类频率！耶！我倾向于分析<a class="ae jc" href="https://www.kaggle.com/ankurzing/sentiment-analysis-for-financial-news" rel="noopener ugc nofollow" target="_blank">财经新闻数据集</a>，但是我会把它留到下一天；)在处理数据集之前，我会继续做EDA，以确保我知道我在处理什么！</p><p id="ed42" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在朴素贝叶斯、最大熵和SVM分类器中，我选择了朴素贝叶斯，因为它适用于大型数据集(imdb有50，000条评论)，并且像我这样的NLP新手很容易理解。</p><p id="2858" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">朴素贝叶斯</strong>是一个线性分类器，它扩展了贝叶斯定理，假设所有数据点都是独立的。</p><p id="f439" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">线性分类器做出如下线性决策边界:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es le"><img src="../Images/97952227baabbca75f953fc7a308504c.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*xjuvwN2PFIrUWXU5FgABfQ.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">学分:<a class="ae jc" href="http://web.stanford.edu/class/cs224n/readings/cs224n-2019-notes02-wordvecs2.pdf" rel="noopener ugc nofollow" target="_blank">http://web . Stanford . edu/class/cs 224n/readings/cs 224n-2019-notes 02-word vecs 2 . pdf</a></figcaption></figure><p id="1f75" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该模型的一个限制是，它可能会对一些数据点进行错误分类(注意红色空间中的绿点)，这与非线性决策边界不同:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es lf"><img src="../Images/17623e8efb01bc7518a2eb425fcbb300.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*ZcVwhm1Dwff_YyQ12U6eEw.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">学分:<a class="ae jc" href="http://web.stanford.edu/class/cs224n/readings/cs224n-2019-notes02-wordvecs2.pdf" rel="noopener ugc nofollow" target="_blank">http://web . Stanford . edu/class/cs 224n/readings/cs 224n-2019-notes 02-word vecs 2 . pdf</a></figcaption></figure><p id="2e0d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是贝叶斯定理:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lg"><img src="../Images/ec53d67607f463e8575fea1e3f567194.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WmkC37Hqbu1kTZgRHLVshA.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">信用:<a class="ae jc" href="https://www.kdnuggets.com/2020/06/naive-bayes-algorithm-everything.html" rel="noopener ugc nofollow" target="_blank">https://www . kdnugges . com/2020/06/naive-Bayes-algorithm-everything . html</a></figcaption></figure><p id="5a8f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，这是朴素贝叶斯算法:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lh"><img src="../Images/37b6b2040879bf639618f0cbc6da6d55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3gJuiJqzhiWcBKcV3RH6JQ.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">鸣谢:<a class="ae jc" href="http://spark-public.s3.amazonaws.com/nlp/slides/sentiment.pdf" rel="noopener ugc nofollow" target="_blank">http://spark-public . S3 . Amazon AWS . com/NLP/slides/perspective . pdf</a></figcaption></figure><h1 id="5675" class="li kt hh bd jw lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">现在谈谈技术问题:</h1><pre class="jl jm jn jo fd kn ko kp kq aw kr bi"><span id="a397" class="ks kt hh ko b fi ku kv l kw kx"><a class="ae jc" href="https://github.com/jadessechan/Sentiment-Analysis" rel="noopener ugc nofollow" target="_blank">https://github.com/jadessechan/Sentiment-Analysis</a></span></pre><p id="5935" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">imdb数据集是我第一次使用csv文件。我使用<em class="jd">熊猫库</em>将csv文件中的内容读取到数据帧中。因此，我也学会了如何访问数据帧中的元素。我之前的文本预测项目使用的是txt文件，所以我通过迭代来访问单词。这次我使用熊猫文档来了解</p><pre class="jl jm jn jo fd kn ko kp kq aw kr bi"><span id="45ee" class="ks kt hh ko b fi ku kv l kw kx">.loc(), .at(), .iloc(), .iat()</span></pre><p id="8e77" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">访问特定的元素。最终，我找到了<strong class="ig hi">。at() </strong>最有用，因为我想访问单个元素，而不是用<strong class="ig hi">访问行/列中的一系列元素。loc() </strong></p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es me"><img src="../Images/a6b61babb8fa23707a27ec3aa6619342.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7o0ZyVmRWZhE4b05658E5A.png"/></div></div><figcaption class="js jt et er es ju jv bd b be z dx translated">if语句检查“情绪”列中每一行(索引)的元素是正数还是负数</figcaption></figure><p id="a348" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后但同样重要的是，我实现了带add-1平滑的朴素贝叶斯算法，以解决在训练集中看不到的单词。首先，我计算了测试数据中每一类(正或负)出现一个“令牌”的概率。然后我用这个概率除以班上的总单词数，并用班级人数平滑分母。Add-1平滑确保了我不会得到一个没有出现在我的训练集中的单词的“零”值。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es mf"><img src="../Images/a8f7e5a5f6ef0e724258e0dbcd23ac0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GcC3tVDYstCxeUhH2WuL7g.png"/></div></div></figure><p id="0bc8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最终，程序会根据哪个类别的概率更大来预测一种情绪。这是我的朴素贝叶斯算法的最终结果和百分误差:</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es mg"><img src="../Images/142ca0eec3863fe1362fb41f081662ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*3QpC37PLxMheLxEcryCAFg.png"/></div><figcaption class="js jt et er es ju jv bd b be z dx translated">预测和实际是保存每个测试评审的分类决定(前者)和实际分类(后者)的列表</figcaption></figure><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es mh"><img src="../Images/73d4c60821bfc1b95dea2eb1dea10b48.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*i7N1TRAPuPr2L-fffoktnA.png"/></div></figure><p id="b3fa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">就是这样！未来的改进将是使用交叉验证进行培训。然而，使用<a class="ae jc" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sample.html" rel="noopener ugc nofollow" target="_blank"> pandas的<strong class="ig hi"> df.sample() </strong> </a>非常方便，因为它每次运行都会选择一个随机的数据块。现在，我要休息一下，看下一部我最喜欢的韩剧《文森佐》😍</p><p id="18de" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">非常感谢你一直读到最后！编码快乐！</p></div></div>    
</body>
</html>