<html>
<head>
<title>Detecting Objects in Video or Camera Images using ImageAI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用ImageAI检测视频或相机图像中的对象</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/detecting-objects-in-video-or-camera-images-using-imageai-8b7a7d541c72?source=collection_archive---------5-----------------------#2021-05-22">https://medium.com/analytics-vidhya/detecting-objects-in-video-or-camera-images-using-imageai-8b7a7d541c72?source=collection_archive---------5-----------------------#2021-05-22</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/0afdfb524069f8f57db8c6429cd7ba68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3FlVjmvxgnrtiKBJ"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">查尔斯·德鲁维奥在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="d564" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">视频中的对象检测是为了定位对象的存在，根据我们的深度学习模型将它们放在某些类别下，并在它们周围放置边界框。</p><p id="2416" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">简单地说，我们的输入是具有多个对象的视频或图像，输出是相同的视频或图像，在对象+类名和它们所属的概率周围有边界框(具有一定的高度和宽度)。</p><p id="5b61" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这里，我们将使用一个预先训练好的<strong class="ix hj"> YOLO </strong>(你只看一次)模型，该模型使用高性能资源为大约<em class="jt"> 80个对象类</em>的大型数据集训练了很长时间。这篇文章，将不会更深入地研究<em class="jt"> YOLO架构</em>，而是更多地关注<strong class="ix hj"> ImageAI </strong> <strong class="ix hj">库</strong>来对我们的视频进行对象检测并获得结果。</p><p id="a3c6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要深入了解YOLO的内部运作，你可以参考这篇伟大的文章:<a class="ae iu" href="https://towardsdatascience.com/yolo-v3-object-detection-53fb7d3bfe6b" rel="noopener" target="_blank">链接到文章</a></p><p id="f0df" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从头开始构建这些模型需要对数学及其架构以及数千行代码有大量的理解。因此，我们总是可以利用<strong class="ix hj">迁移学习</strong>的概念，并使用其他人训练的权重，这些人已经足够善良，用非常昂贵的资源训练他们的模型，并将其公之于众。</p></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><p id="a8e8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这就是ImageAI出现的地方，它使任何具有Python基础知识的人都有可能只使用几行编程代码来构建可以检测视频中对象的应用程序和系统。</p><p id="d6dc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在我们开始使用ImageAI之前，我们必须安装一些依赖项。我使用Jupyter笔记本来执行以下代码:</p><ol class=""><li id="f328" class="kb kc hi ix b iy iz jc jd jg kd jk ke jo kf js kg kh ki kj bi translated">张量流</li></ol><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="c809" class="kt ku hi kp b fi kv kw l kx ky"><strong class="kp hj">!pip3 install tensorflow==2.4.0</strong></span></pre><p id="f9ee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">2.其他依赖关系</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="49d0" class="kt ku hi kp b fi kv kw l kx ky"><strong class="kp hj">!pip install keras==2.4.3 numpy==1.19.3 pillow==7.0.0 scipy==1.4.1 h5py==2.10.0 matplotlib==3.3.2 opencv-python keras-resnet==0.2.0</strong></span></pre><p id="82bb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">3.ImageAI</p><p id="f7ee" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><code class="du kz la lb kp b"><strong class="ix hj">!pip install imageai --upgrade</strong></code></p><p id="834b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们已经安装了所有需要的工具，我们需要得到一个预先训练的YOLOv3模型。你可以从这里得到一个:<a class="ae iu" href="https://github.com/OlafenwaMoses/ImageAI/releases/download/1.0/yolo.h5" rel="noopener ugc nofollow" target="_blank">链接到模型</a></p><p id="33d5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">该模型已经被训练为检测大约80类物体，如下所述:</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="fa35" class="kt ku hi kp b fi kv kw l kx ky">person, bicycle, car, motorcycle, airplane,<br/>bus, train, truck, boat, traffic light, fire hydrant, stop_sign,<br/>parking meter, bench, bird, cat, dog, horse, sheep, cow, elephant, bear, zebra,<br/>giraffe, backpack, umbrella, handbag, tie, suitcase, frisbee, skis, snowboard,<br/>sports ball, kite, baseball bat, baseball glove, skateboard, surfboard, tennis racket,<br/>bottle, wine glass, cup, fork, knife, spoon, bowl, banana, apple, sandwich, orange,<br/>broccoli, carrot, hot dog, pizza, donot, cake, chair, couch, potted plant, bed,<br/>dining table, toilet, tv, laptop, mouse, remote, keyboard, cell phone, microwave,<br/>oven, toaster, sink, refrigerator, book, clock, vase, scissors, teddy bear, hair dryer,<br/>toothbrush.</span></pre><p id="6ddd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">你可以从youtube上下载任何带有这些对象的视频，也可以自己抓拍一个。</p><p id="a5e5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我用了一个街头视频，展示了一堆人和车。下面是视频截图。</p><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/c92055f87cae17fc2e87fed298fc7a20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t9UQ1PZxjca_ttZGG1tfnA.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">从我的街头视频中捕获的图像，将在其上进行对象检测</figcaption></figure><p id="1460" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">执行下面的代码，它将开始处理你的视频帧。</p><p id="3bf3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你有足够好的NVIDIA GPU，你可以随时使用tensorflow-gpu依赖，这个检测过程应该在一分钟内完成，这取决于你的视频大小。否则，可能需要<strong class="ix hj">几分钟</strong>。</p><p id="263f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">检测将针对检测到的视频的每一帧的<strong class="ix hj">进行，并且保存的检测到的视频将针对检测到的每一帧自动更新。</strong></p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="3df3" class="kt ku hi kp b fi kv kw l kx ky">from imageai.Detection import VideoObjectDetection<br/>import os</span><span id="1495" class="kt ku hi kp b fi ld kw l kx ky">path = os.getcwd()</span><span id="9ed0" class="kt ku hi kp b fi ld kw l kx ky">det = VideoObjectDetection()<br/>det.setModelTypeAsYOLOv3()<br/>det.setModelPath(os.path.join(path, "yolo.h5"))<br/>det.loadModel()</span><span id="eb41" class="kt ku hi kp b fi ld kw l kx ky">video_path = det.detectObjectsFromVideo(input_file_path=os.path.join(path,"your_video_file.mp4"),<br/>                                     output_file_path=os.path.join(path, "your_video_file_detected"),<br/>                         display_percentage_probability = False,                        <br/>                        frames_per_second=20, log_progress=True)</span><span id="9702" class="kt ku hi kp b fi ld kw l kx ky">print(video_path)</span></pre><p id="cd30" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">输出:</strong></p><figure class="kk kl km kn fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es le"><img src="../Images/0eade8dc86495281bd9d9033b8280cd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8OE6oz_3J0Wp0p9IjLGpNg.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">从我的已处理视频中捕获的图像，检测到包围类的边界框和名称</figcaption></figure><p id="df71" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">输出显示用边界框检测到的对象及其周围的名称。为了简单起见，我使用了<strong class="ix hj">display _ percentage _ probability = False。</strong></p><p id="33ed" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你从这篇文章中获得了一些概念，请鼓掌。如果你有任何问题或建议，可以在评论区联系我。</p></div></div>    
</body>
</html>