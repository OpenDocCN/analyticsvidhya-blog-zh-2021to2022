<html>
<head>
<title>Face recognition login using ReactJS And OpenCV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用ReactJS和OpenCV进行人脸识别登录</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/face-recognition-login-using-reactjs-and-computer-vision-e98a892fd4ef?source=collection_archive---------1-----------------------#2021-04-12">https://medium.com/analytics-vidhya/face-recognition-login-using-reactjs-and-computer-vision-e98a892fd4ef?source=collection_archive---------1-----------------------#2021-04-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/4af86240fb0264a2064bf9c595a73910.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WgmDN7NH_-nnUmkl"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">约翰·努南在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="a2c8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">作为一名开发人员，首先想到的是我们系统的认证。因为存在运行在不同平台上的各种应用程序，例如web应用程序、桌面应用程序、移动应用程序，其中的每一个都需要某种安全机制。本文介绍了一个适用于web应用的人脸识别登录系统。</p><p id="c7af" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在您的系统上必须有两个基本的框架配置，即ReactJS和Python Flask。这里ReactJS将用于前端部分，Flask将用作python后端的轻量级后端API。</p><p id="d1fb" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">跟随我的<a class="ae iu" href="https://github.com/IndianCoder25/Face_recognition_login" rel="noopener ugc nofollow" target="_blank"> GitHub链接</a>阅读这篇文章。让我们先来看看我们系统的架构。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es jt"><img src="../Images/a333b94fc2bec153046e720814c43e39.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*DgJ9T9xxyPwtm4VyWKVtJA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">作者图片:系统架构</figcaption></figure><h1 id="fc0f" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak">创建后端应用程序</strong></h1><p id="1e5f" class="pw-post-body-paragraph iv iw hi ix b iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">首先，你需要在MySQL数据库中创建一个表，并给它一个名称注册。</p><p id="5d08" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，在您的本地系统中克隆我的GitHub repo，并使用node命令安装必要的前端依赖项，使用python安装程序安装后端依赖项。</p><p id="364e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在启动终端并运行后端文件夹中的script.py文件。这将启动flask服务器，并等待来自客户端的请求。现在，通过运行npm start命令启动react应用程序，该命令将开始在默认端口上为web应用程序提供服务。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es lb"><img src="../Images/ebf8cd0dfdcfdce393050e4f72f341ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*oK6yFNgNHkD0Ben1JZQuxA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><em class="lc">作者图片:</em> Flask服务器启动</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es ld"><img src="../Images/b5732bc0496bea03f33adf24f8e3bfb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:614/format:webp/1*mp83Otzi8f-Xfyiwp-cHpA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><em class="lc">作者图片:</em> ReactJS服务器启动</figcaption></figure><p id="8fed" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们了解我们系统的流程。首先，让我们为Flask服务器导入重要的模块。</p><pre class="ju jv jw jx fd le lf lg lh aw li bi"><span id="a1c9" class="lj jz hi lf b fi lk ll l lm ln">#importing all the modules<br/>import cv2<br/>import numpy as np<br/>import os<br/>from flask import *<br/>import face_recognition<br/>from flask_cors import CORS<br/>import mysql.connector as conn</span></pre><p id="5937" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，我们的API需要遵循一些重要的步骤。</p><pre class="ju jv jw jx fd le lf lg lh aw li bi"><span id="b586" class="lj jz hi lf b fi lk ll l lm ln">app = Flask(__name__)<br/>CORS(app)<br/>db = []<br/>known_path = os.path.join(os.getcwd(),"Images/Known_faces/")<br/>unknown_path = os.path.join(os.getcwd(), "Images/Unknown_faces/")</span></pre><p id="e4bd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，我们将创建一个函数，该函数将从数据库中获取数据，即此人的编码及其姓名。</p><pre class="ju jv jw jx fd le lf lg lh aw li bi"><span id="92c4" class="lj jz hi lf b fi lk ll l lm ln">def get_data():<br/>    global db   <br/>    con = conn.connect(host='yourhost', database='yourdb',user='youruesrname', password='yourpassword', charset='utf8', port=yourportnumber)    <br/>    cursor = con.cursor()<br/>    sql = 'select * from register'<br/>    cursor.execute(sql)<br/>    result = cursor.fetchall()    <br/>    for i in result:        <br/>        l = []        <br/>        l.append(i[0])        <br/>        string = i[1][1:-2]        <br/>        nums = []        <br/>        for x in string.split():<br/>            nums.append(float(x.strip()))        <br/>        l.append(nums)        <br/>        db.append(l)    <br/>    cursor.close()    <br/>    con.close()</span></pre><p id="14c0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们有flask API注册和登录如下。</p><pre class="ju jv jw jx fd le lf lg lh aw li bi"><span id="791f" class="lj jz hi lf b fi lk ll l lm ln">@app.route('/register', methods=['GET'])<br/>def register():    <br/>    con = conn.connect(host='yourhost', database='yourdb',user='youruesrname', password='yourpassword', charset='utf8', port=yourportnumber)    <br/>    cursor = con.cursor()    <br/>    sql = 'insert into register values(%s,%s)'    <br/>    name = request.args.get("name")    <br/>    video_capture = cv2.VideoCapture(0)    <br/>    ret, frame = video_capture.read()    <br/>    small_frame = cv2.resize(frame, (0, 0), fx=0.25, fy=0.25)<br/>    rgb_small_frame = small_frame[:, :, ::-1]<br/>    face_locations =face_recognition.face_locations(rgb_small_frame)<br/>    face_encodings =face_recognition.face_encodings(rgb_small_frame, face_locations)    <br/>    dir = os.path.join(known_path,name)    <br/>    if(not os.path.isdir(dir)):        <br/>        os.mkdir(dir)    <br/>    os.chdir(dir)     <br/>    rand_no = np.random.random_sample()<br/>    cv2.imwrite(str(rand_no)+".jpg", frame)<br/>    video_capture.release()<br/>    cv2.destroyAllWindows()<br/>    encoding = ""    <br/>    for i in face_encodings:        <br/>        encoding += str(i)+","    <br/>    li = [name, encoding]    <br/>    value = tuple(li)    <br/>    cursor.execute(sql, value)    <br/>    con.commit()    <br/>    cursor.close()    <br/>    con.close()    <br/>    return "Done"</span><span id="11df" class="lj jz hi lf b fi lo ll l lm ln">@app.route("/login")<br/>def login():    <br/>    get_data()    <br/>    global db    <br/>    if(db == []):<br/>        msg = "You are unknown first register your self"    <br/>    else:        <br/>        known_face_encodings = [i[1] for i in db]<br/>        known_face_names = [i[0] for i in db]<br/>        face_locations = []        <br/>        face_encodings = []        <br/>        face_names = []<br/>        video_capture = cv2.VideoCapture(0)<br/>        ret, frame = video_capture.read()<br/>        small_frame = cv2.resize(frame, (0, 0), fx=0.25, fy=0.25)<br/>        rgb_small_frame = small_frame[:, :, ::-1]<br/>        face_locations = face_recognition.face_locations(rgb_small_frame)     <br/>        face_encodings = face_recognition.face_encodings(rgb_small_frame, face_locations)<br/>        face_names = []        <br/>        if(face_encodings == []):            <br/>            msg = "You are unknown first register your self"<br/>        else:            <br/>            for face_encoding in face_encodings:   <br/>                matches = face_recognition.compare_faces(known_face_encodings, face_encoding)  <br/>                name = "Unknown"                <br/>                face_distances = face_recognition.face_distance(known_face_encodings, face_encoding)<br/>                best_match_index = np.argmin(face_distances)<br/>                if matches[best_match_index]: <br/>                    name = known_face_names[best_match_index]<br/>                if(name == "Unknown"):                    <br/>                    msg = "You are unknown first register your self"                <br/>                else:                    <br/>                    msg = name             <br/>                face_names.append(name)            <br/>            for (top, right, bottom, left), name in zip(face_locations, face_names):<br/>                top *= 4                <br/>                right *= 4                <br/>                bottom *= 4                <br/>                left *= 4                <br/>                cv2.rectangle(frame, (left, top), (right, bottom), (0, 0, 255), 2)                <br/>                cv2.rectangle(frame, (left, bottom - 35), (right, bottom), (0, 0, 255), cv2.FILLED)                <br/>                font = cv2.FONT_HERSHEY_DUPLEX<br/>                cv2.putText(frame, name, (left + 6, bottom - 6), font, 1.0, (255, 255, 255), 1)            <br/>            os.chdir(unknown_path)            <br/>            rand_no = np.random.random_sample()<br/>            cv2.imwrite(str(rand_no)+".jpg", frame)    <br/>        return msg</span></pre></div><div class="ab cl lp lq gp lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="hb hc hd he hf"><h1 id="412a" class="jy jz hi bd ka kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv bi translated">正在创建ReactJS应用程序</h1><p id="d9b2" class="pw-post-body-paragraph iv iw hi ix b iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">这里我使用ReactJS作为前端，代码可以在我的GitHub repo中找到，你可以下载并运行这个应用程序。在这里，您可以从导航栏转到注册或登录选项，然后继续操作。</p><p id="b42b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果用户没有注册，并试图登录，然后它会提示信息“你是未知的，首先注册你自己”。并将此人标记为未知并保存在目录中以供将来参考。</p><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/54bcc35e2818c539ac0f6bd18fed0df4.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*036N5r8WkBg3PyZRdxZ53w.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><em class="lc">作者图片:</em>识别为未知人物</figcaption></figure><p id="c111" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，用户可以进行注册，他/她必须提供他/她的姓名，该姓名将用于在登录时识别该人，他/她的照片也将被拍摄，并将被转换为大小为128的编码向量。让我们先进行注册。<Register/>组件的代码如下</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es me"><img src="../Images/4d25a6b58fcc11bd0e617e7c550156df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7C2ir7xJOu1hPSD7AztQ5g.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><em class="lc">图片作者:</em>预注册界面</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/dfd35ed65c9d45a59f6156c425af10a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZI38EbYAxlVnQETwwNhD5w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><em class="lc">图片作者:</em>帖子注册界面</figcaption></figure><p id="0ff0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以，注册完成后，我们再登录一次。现在照片应该是一个注册了名字的人。<Login/>组件的代码如下。</p><figure class="ju jv jw jx fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/87a787ef08af571741f99756f5c0d867.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*bERcqhAPpDfV09pNOXqcpQ.jpeg"/></div><figcaption class="iq ir et er es is it bd b be z dx translated"><em class="lc">作者图片:</em>人物识别</figcaption></figure><figure class="ju jv jw jx fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/f4745dd9a54783bed63ba62c687cf170.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rkinP-vVHY9ECQv4ATwA-w.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><em class="lc">图片作者:</em>发布登录画面</figcaption></figure><h1 id="7511" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">结论</h1><p id="dffd" class="pw-post-body-paragraph iv iw hi ix b iy kw ja jb jc kx je jf jg ky ji jj jk kz jm jn jo la jq jr js hb bi translated">在本文中，我们看到我们可以将ReactJS与计算机视觉相集成，以创建一个人脸识别登录应用程序。这个应用程序可以集成到您的系统中，登录阶段将是这个应用程序，登录后的应用程序可以从您这边定制。</p><p id="2ae2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这里，您还可以训练自己的深度学习模型，并获得编码，以提高模型的准确性。为此，你可能需要花费一些资源，这些资源可能会转化为巨大的成果。</p><p id="01e1" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">总之，图像识别领域发展非常迅速，本文展示了一种非常简单的方法。人脸识别也可以作为基于人脸的情感检测。</p><h1 id="b2ea" class="jy jz hi bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">参考</h1><ol class=""><li id="0def" class="mh mi hi ix b iy kw jc kx jg mj jk mk jo ml js mm mn mo mp bi translated"><a class="ae iu" href="https://github.com/ageitgey/face_recognition" rel="noopener ugc nofollow" target="_blank">https://github.com/ageitgey/face_recognition</a></li></ol></div></div>    
</body>
</html>