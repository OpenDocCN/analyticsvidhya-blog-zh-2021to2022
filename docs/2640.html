<html>
<head>
<title>Customer Segmentation with RFM Analysis, using Python and Power BI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和Power BI，通过RFM分析进行客户细分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/customer-segmentation-analysis-with-rfm-using-python-and-power-bi-1a93e7938053?source=collection_archive---------1-----------------------#2021-05-10">https://medium.com/analytics-vidhya/customer-segmentation-analysis-with-rfm-using-python-and-power-bi-1a93e7938053?source=collection_archive---------1-----------------------#2021-05-10</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/577752f83b09cb1f50f7012e95484be0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6nzDGy6R7bbX8_Sy.jpg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">插图由<a class="ae it" href="http://www.freepik.com" rel="noopener ugc nofollow" target="_blank"> vectorjuice / Freepik </a>提供</figcaption></figure><p id="7819" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这个项目的Github库可以在<a class="ae it" href="https://github.com/daniel-isidro/customer_segmentation" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="ccb5" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">目录</h1><ul class=""><li id="5f4d" class="kq kr hh iw b ix ks jb kt jf ku jj kv jn kw jr kx ky kz la bi translated">介绍</li><li id="9035" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">方法学</li><li id="9765" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">要求</li><li id="620b" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">执行指南</li><li id="ecbf" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">数据采集</li><li id="3522" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">数据准备</li><li id="6b00" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">原始数据描述</li><li id="5aed" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">数据探索</li><li id="c69a" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">建模</li><li id="8fdc" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">摘要</li><li id="7a88" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">前端</li><li id="8989" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">结论</li><li id="ce82" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">参考</li><li id="d9d2" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">关于我</li></ul><h1 id="0765" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">介绍</h1><p id="c63c" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">在一家为几个国家成千上万的客户提供商品的公司工作时，我想<strong class="iw hi">创造一个工具</strong>，通过快速展示下一个要联系的客户，对这些国家的销售经理有用，以便<strong class="iw hi">增加销售</strong>和<strong class="iw hi">客户保持</strong>。这就是我对RFM分析的了解。</p><p id="e63e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> RFM </strong>是一种用于分析客户价值的方法。它通常用于数据库营销和直接营销，在零售和专业服务行业受到特别关注。</p><p id="ee06" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这个项目的重点是对公司销售进行RFM分析，并创建一个<strong class="iw hi">数据可视化仪表板</strong>，展示<strong class="iw hi">客户细分</strong>，我可以与各国的同事分享。</p><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lj"><img src="../Images/f6fbcd93b8d60a49ad023fb32c5ec23d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ka6WstNGhe6vpBs5"/></div></div></figure><h1 id="3d7b" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">方法学</h1><p id="5478" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">使用包含一段时间内的<strong class="iw hi">销售订单</strong>的数据集，我们将使用<strong class="iw hi"> Python </strong>来获取每个客户在过去365天内的<strong class="iw hi">频率、最近度</strong>和<strong class="iw hi">货币</strong>值。稍后，我们将根据这些值为每个客户给出<strong class="iw hi"> R、F和M分数</strong>，这将允许我们将他们聚集在不同的<strong class="iw hi">细分领域</strong>。</p><h1 id="4733" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">要求</h1><p id="1dfc" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">我们将使用<a class="ae it" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌联合实验室</a> Jupyter笔记本环境(免费)，Python 3.7或更高版本，以及<a class="ae it" href="https://powerbi.microsoft.com/en-us/downloads/" rel="noopener ugc nofollow" target="_blank">微软Power BI桌面</a>应用程序(免费下载，仅限Windows)。</p><h2 id="c16a" class="lo jt hh bd ju lp lq lr jy ls lt lu kc jf lv lw kg jj lx ly kk jn lz ma ko mb bi translated">Python包</h2><ul class=""><li id="fa98" class="kq kr hh iw b ix ks jb kt jf ku jj kv jn kw jr kx ky kz la bi translated">numpy</li><li id="ffc2" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">熊猫</li><li id="bf99" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">数学</li><li id="7eb9" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">日期时间</li><li id="37f4" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">数据准备</li><li id="b4ac" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">matplotlib</li></ul><h1 id="3eb8" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">执行指南</h1><p id="f73f" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">要复制项目，请按顺序执行以下步骤:</p><ol class=""><li id="8905" class="kq kr hh iw b ix iy jb jc jf mc jj md jn me jr mf ky kz la bi translated"><a class="ae it" href="https://github.com/daniel-isidro/customer_segmentation/blob/main/code/customer_segmentation_asia.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hi"> Jupyter笔记本</strong> </a>。运行此笔记本，将探索、准备数据，并执行RFM细分。输出将是一个<a class="ae it" href="https://github.com/daniel-isidro/customer_segmentation/blob/main/output/rfm_asia.csv" rel="noopener ugc nofollow" target="_blank"> CSV文件</a>。</li><li id="66c7" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr mf ky kz la bi translated"><a class="ae it" href="https://github.com/daniel-isidro/customer_segmentation/blob/main/output/customer_segmentation.pbix" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hi">动力匕档</strong> </a>。这是一个文件，它处理在上一步中获得的CSV文件，并将其显示为一个仪表板，以便可以在国家/地区的业务活动中加以利用。</li></ol><h1 id="9613" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">数据采集</h1><p id="613a" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">数据来源于大约两年时间内在18个国家的<strong class="iw hi">实际销售订单</strong>。为了保护隐私，一些功能(国家名称、客户id和收入)已被修改。订单数量、单位和日期未被修改。它被采集为一个<a class="ae it" href="https://raw.githubusercontent.com/daniel-isidro/customer_segmentation/main/data/sales_asia.csv" rel="noopener ugc nofollow" target="_blank"> CSV文件</a>。</p><h1 id="d7ab" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">数据准备</h1><p id="3e42" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">我们导入CSV，并将其放入有熊猫的数据框中。根据领域知识，我们知道数据集的每一行都是不同的顺序。</p><p id="0a77" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">df1.head()</code></p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="e9a6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">此外，我们注意到日期被表示为一年中的第<strong class="iw hi">周</strong>，因此为了更好地分析，我们用datetime包将其转换为<strong class="iw hi">年-月-日</strong>格式。此外，根据RFM分析中的惯例，我们将“收入”重命名为“货币”。</p><p id="808b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">df2.head()</code></p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="mk ml l"/></div></figure><h1 id="8a70" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">原始数据描述</h1><p id="401b" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated"><code class="du mg mh mi mj b">df2.info()</code></p><pre class="lk ll lm ln fd mm mj mn mo aw mp bi"><span id="2c2e" class="lo jt hh mj b fi mq mr l ms mt">class 'pandas.core.frame.DataFrame';<br/>RangeIndex: 235574 entries, 0 to 235573<br/>Data columns (total 5 columns):<br/> #   Column    Non-Null Count   Dtype         <br/>---  ------    --------------   -----         <br/> 0   country   235574 non-null  object        <br/> 1   id        235574 non-null  int64         <br/> 2   monetary  235574 non-null  float64       <br/> 3   units     235574 non-null  int64         <br/> 4   date      235574 non-null  datetime64[ns]<br/>dtypes: datetime64[ns](1), float64(1), int64(2), object(1)<br/>memory usage: 9.0+ MB</span></pre><p id="9260" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">df2.describe()</code></p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="mu ml l"/></div></figure><p id="e9c4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们看到，在数据集中包含的时间段内，我们有235，574个交易和5列。最大成交15万台。但似乎也有同样数量的退货-150，000件。最贵的一次购买是241万。</p><p id="62c7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们查看数据集中包含的时间段:</p><p id="b0be" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">df2['date'].min()</code></p><pre class="lk ll lm ln fd mm mj mn mo aw mp bi"><span id="3449" class="lo jt hh mj b fi mq mr l ms mt">Timestamp('2019-01-07 00:00:00')</span></pre><p id="5235" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">df2['date'].max()</code></p><pre class="lk ll lm ln fd mm mj mn mo aw mp bi"><span id="6e6a" class="lo jt hh mj b fi mq mr l ms mt">Timestamp('2020-11-30 00:00:00')</span></pre><p id="0452" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们来看看这段时间我们在多少不同的国家有销售:</p><p id="b883" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">df2['country'].unique()</code></p><pre class="lk ll lm ln fd mm mj mn mo aw mp bi"><span id="2dae" class="lo jt hh mj b fi mq mr l ms mt">array(['KR', 'PK', 'MM', 'VN', 'IN', 'SA', 'PH', 'AF', 'CN', 'BD', 'ID', 'TH', 'IQ', 'MY', 'JP', 'IR', 'TR', 'UZ'], dtype=object)</span></pre><p id="683c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">使用dataprep.clean包，我们可以获得完整的国家名称:</p><p id="d97a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">clean_country(df2, "country")['country_clean'].unique()</code></p><pre class="lk ll lm ln fd mm mj mn mo aw mp bi"><span id="0ab8" class="lo jt hh mj b fi mq mr l ms mt">array(['South Korea', 'Pakistan', 'Myanmar', 'Vietnam', 'India', 'Saudi Arabia', 'Philippines', 'Afghanistan', 'China', 'Bangladesh', 'Indonesia', 'Thailand', 'Iraq', 'Malaysia', 'Japan', 'Iran', 'Turkey', 'Uzbekistan'], dtype=object)</span></pre><p id="9d7f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">所有国家的客户总数:</p><p id="cf98" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">df2['id'].nunique()</code></p><pre class="lk ll lm ln fd mm mj mn mo aw mp bi"><span id="8f26" class="lo jt hh mj b fi mq mr l ms mt">21837</span></pre><h1 id="7e7d" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">数据探索</h1><p id="aa12" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">为了提高图中的可见性，我们将日期转换为月周期:</p><p id="b787" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">df2c = df2b.to_period("M")</code></p><p id="fa85" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">df2c.head()</code></p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="mv ml l"/></div></figure><p id="4dce" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们合计同期的单位和收入。</p><p id="4fd4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">单位图表:</p><p id="bb5a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">df2c['units'].groupby('date').agg(sum).plot(figsize=(20,5));</code></p><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mw"><img src="../Images/95d3e88ee69209a2f494a28795ce65c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S3_DrR6p66Pp7IWt7tfI1w.png"/></div></div></figure><p id="e698" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">收入图表:</p><p id="c290" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">df2c['monetary'].groupby('date').agg(sum).plot(figsize=(20,5));</code></p><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mx"><img src="../Images/3874445a217f5329e05c6ba3249a6700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J5St8_-vhUL5k0LX8zHWvQ.png"/></div></div></figure><h1 id="2dff" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">建模</h1><h2 id="adfb" class="lo jt hh bd ju lp lq lr jy ls lt lu kc jf lv lw kg jj lx ly kk jn lz ma ko mb bi translated"><strong class="ak">转换数据以获得RFM值</strong></h2><p id="27c8" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">我们将转换数据，根据每位顾客的购买行为给他们打分。在此之前，我们将创建一些新的功能'新近'，'频率'，只要先前创建的'货币'功能。</p><p id="3320" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">最近度</strong>将是每个客户的最小“自上次购买以来的天数”。</p><p id="c8c7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">频率</strong>将是每个客户在此期间的订单总数。</p><p id="9deb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">货币</strong>，将是每个客户在该期间的购买总值。</p><p id="d232" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将关注最近365天以来的销售额。</p><p id="168c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">提示:</strong>在几个国家/地区有相同“id”的客户。这导致货币价值的错误。我们将通过创建一个新特性来解决这个问题:一个结合了国家代码和客户id的唯一的“id+”标识符。</p><p id="7f2d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">df3['id+'] = df3['country'].map(str) + df3['id'].map(str)</code></p><p id="d63f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">df3.head()</code></p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="2f3a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">结果将是包含两个新列的data frame:“recency”和“frequency”。</p><p id="c100" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">rfm.head()</code></p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="mk ml l"/></div></figure><h1 id="a47e" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">计算R、F和M分数</h1><p id="573c" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">不，我们将根据近期、货币和频率参数指定一个介于1和5之间的比率。我们将使用五分法，将每个要素分成包含20 %样本的组。</p><p id="d8e2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">较高的值更适合频率和货币，而较低的值更适合最近。这些将是分配给每个客户的R、F和M分数。</p><p id="4f12" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">然后，我们连接R、F和M值，以获得每个客户的综合RFM得分。</p><p id="39bf" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">rfm.head()</code></p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="928f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">有了这个rfm分数，我们将拥有<strong class="iw hi"> 125个客户群</strong>，这对任何实际分析来说都太多了。为了获得更简单的分割，我们选择创建一个新的特征“fm ”,它是“f”和“m”分数的下舍入平均值。</p><p id="1a74" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">def truncate(x): return math.trunc(x)</code></p><p id="05cc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">rfm['fm'] = ((rfm['f'] + rfm['m'])/2).apply(lambda x: truncate(x))</code></p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="0f16" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">然后，我们仅基于两个分数“r”和“fm”创建一个仅包含<strong class="iw hi"> 11个片段</strong>的片段图。我们为每个客户分配不同的细分市场。</p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="mk ml l"/></div></figure><h1 id="8b8e" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">摘要</h1><p id="7d30" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">在合计每个客户的销售额、频率和最近值，并根据这些值分配“r”、“f”和“m”分数后，我们给每个客户一个不同的细分标签。让我们来看看这些片段是什么意思。</p><h2 id="5a06" class="lo jt hh bd ju lp lq lr jy ls lt lu kc jf lv lw kg jj lx ly kk jn lz ma ko mb bi translated"><strong class="ak">分段描述</strong></h2><ul class=""><li id="9fb7" class="kq kr hh iw b ix ks jb kt jf ku jj kv jn kw jr kx ky kz la bi translated"><strong class="iw hi">冠军</strong>最近买的，经常买，花的最多</li><li id="0f08" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated"><strong class="iw hi">忠诚的顾客</strong>定期购买。对促销有反应。</li><li id="15a1" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated"><strong class="iw hi">潜在忠诚客户</strong>平均频率的近期客户。</li><li id="7711" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated"><strong class="iw hi">最近客户</strong>最近购买，但不经常购买。</li><li id="aaeb" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated"><strong class="iw hi">前途光明</strong>最近的购物者，但还没花多少钱。</li><li id="382b" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated"><strong class="iw hi">需要关注的客户</strong>高于平均近期、频率和货币价值。可能不是最近才买的。</li><li id="602b" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated"><strong class="iw hi">即将入睡</strong>低于平均新近度和频率。如果不重新激活，将会丢失它们。</li><li id="95fe" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated"><strong class="iw hi">有风险</strong>经常购买，但时间久远。需要把他们带回来！</li><li id="c219" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated"><strong class="iw hi">不能丢</strong>以前经常购买但很久没回过。</li><li id="09c5" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated"><strong class="iw hi">冬眠</strong>上次采购是长退，订单数量少。</li><li id="2e45" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated"><strong class="iw hi">丢失了很久以前购买的</strong>再也没有回来。</li></ul><h2 id="c073" class="lo jt hh bd ju lp lq lr jy ls lt lu kc jf lv lw kg jj lx ly kk jn lz ma ko mb bi translated">探索客户群</h2><p id="9cee" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">我们可以在数据框中显示一些客户群。</p><p id="d18c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">不能输</strong></p><p id="4941" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">rfm[rfm['segment']=="can't lose"].sort_values(by='monetary', ascending=False).head()</code></p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="2866" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">忠实客户</strong></p><p id="2c8d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">rfm[rfm['segment']=='loyal customers'].sort_values(by='monetary', ascending=False).head()</code></p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="5350" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">冠军</strong></p><p id="2dc1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">rfm[rfm['segment']=='champions'].sort_values(by='monetary', ascending=False).head()</code></p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="66c9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">需要关注的货币超过平均值的客户</strong></p><p id="b53b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">rfm[(rfm['monetary']&gt;rfm['monetary'].mean()) &amp; (rfm['segment']=='need attention')].sort_values(by='monetary', ascending=False).head()</code></p><figure class="lk ll lm ln fd ii"><div class="bz dy l di"><div class="mk ml l"/></div></figure><p id="6431" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们做一个散点图来探索客户的分布，x轴是“最近”, y轴是“频率”。使用“货币”值作为积分的大小，我们看到大多数花费最多的顾客最近也购买了<strong class="iw hi"/>和<strong class="iw hi"/>。</p><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es my"><img src="../Images/a523ddfa0e9db59b2f3ece14de5df643.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yln9xNjpAJGOR1A9xO5WbQ.png"/></div></div></figure><p id="1592" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最后，我们将数据帧导出到一个CSV文件，以便稍后在Power BI中进行处理。</p><p id="efb8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><code class="du mg mh mi mj b">rfm.to_csv('rfm_asia.csv', encoding='utf-8', index=False, float_format='%.2f')</code></p><h1 id="bf87" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">前端</h1><p id="ca82" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">这个项目的前端由一个<strong class="iw hi"> Power BI仪表板</strong>组成，它处理执行前面的Python代码产生的CSV，并在一个令人满意的仪表板中可视化结果。然后，该仪表板可以作为web应用程序与公司不同国家的同事共享。你可以在这里访问文件<a class="ae it" href="https://github.com/daniel-isidro/customer_segmentation/blob/main/output/customer_segmentation.pbix" rel="noopener ugc nofollow" target="_blank">来探索它。</a></p><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lj"><img src="../Images/41179c255f4dd5c2e7d352c2713e2926.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fRSQHgJZh_C4a8jC"/></div></div></figure><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mz"><img src="../Images/db1b5c29708d01449804e157e6646b84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hwkuNq0gUAi0f5zj"/></div></div></figure><p id="5079" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们观察到，我们的许多客户(32 %)是<strong class="iw hi">失去</strong>或<strong class="iw hi">冬眠</strong>(他们有一些很久以前的订单)。然而，我们28 %的客户要么是<strong class="iw hi">冠军</strong>要么是<strong class="iw hi">忠实客户</strong>，这意味着他们花钱最多、最频繁。需要注意的一个细分市场是<strong class="iw hi">不能失去</strong>，这是收入最高的第二个细分市场，由过去花费很多但有一段时间没有回来的客户组成。</p><h1 id="14c4" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">用户手册</h1><p id="cb22" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">我们可以与我们的国家销售经理共享仪表板，这样他们就可以在不同的细分市场上找到客户id，并对其采取特定的行动。让我们来看一个例子:我的中国同事需要有人指导他接下来应该联系哪些客户，以<strong class="iw hi">提高客户保持率</strong>或<strong class="iw hi">增加销售额</strong>。他们只需打开这个控制面板，点击国家(右上方)，然后点击客户群<strong class="iw hi">需要关注</strong>或<strong class="iw hi">风险</strong>的<strong class="iw hi">，就可以获得一个特定的客户列表，按过去365天的收入支出排序。(未经编辑的数据集还将包括客户姓名和联系方式，出于隐私原因，此处省略了这些内容)。</strong></p><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es na"><img src="../Images/4f6c83017969bdf4ee753552ec50d948.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fY0qaGuobTWnPIDr"/></div></div></figure><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es na"><img src="../Images/73b5e6f3fa5dd98946ad780ca04ad3c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UdfGnGVm5mS0f0bZ"/></div></div></figure><p id="c755" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">仪表板的最后一个选项卡中包含了11个细分市场的<strong class="iw hi">参考指南</strong>和每个细分市场的建议行动。</p><figure class="lk ll lm ln fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nb"><img src="../Images/b6a8731e33a74f2776c8b35b4d2fd41a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ujJE8ZrEbZV39erC"/></div></div></figure><h1 id="f925" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">结论</h1><p id="a440" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated"><strong class="iw hi">在销售中使用<strong class="iw hi"> RFM </strong>方法的客户细分</strong>是帮助员工集中精力的有效方法，通过<strong class="iw hi">优先锁定客户</strong>并对他们采取不同的行动。</p><p id="b602" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这种项目<strong class="iw hi">灵活</strong>因为分段的数量可以适应业务需要，并且分析中的时间段也可以延长或缩短。</p><p id="1861" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">对于已经在微软生态系统中工作的公司来说，使用Power BI在企业环境中将仪表板作为web应用程序与同事共享非常方便。</p><h1 id="8c71" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">参考</h1><p id="b50f" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated"><a class="ae it" href="https://guillaume-martin.github.io/rfm-segmentation-with-python.html" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hi">纪尧姆·马丁</strong> — RFM用Python分段</a></p><p id="386d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae it" href="https://cloud.google.com/architecture/clv-prediction-with-offline-training-intro#overview" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hi">谷歌云</strong> —用AI平台预测客户终身价值</a></p><h1 id="933a" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">关于我</h1><p id="a5d1" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf lg jh ji jj lh jl jm jn li jp jq jr ha bi translated">在<a class="ae it" href="https://www.linkedin.com/in/daniel-isidro/" rel="noopener ugc nofollow" target="_blank">领英</a>更了解我。</p></div></div>    
</body>
</html>