<html>
<head>
<title>Random Forests — outline algorithmic principles, and detailed application of the RF function in R programming step by step: inputs, parameters, options, output, global accuracy, confusion matrix.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">随机森林——逐步概述算法原理和R编程中RF函数的详细应用:输入、参数、选项、输出、全局精度、混淆矩阵。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/random-forests-outline-algorithmic-principles-and-detailed-application-of-the-rf-function-in-r-7d2361f0b08a?source=collection_archive---------13-----------------------#2021-02-28">https://medium.com/analytics-vidhya/random-forests-outline-algorithmic-principles-and-detailed-application-of-the-rf-function-in-r-7d2361f0b08a?source=collection_archive---------13-----------------------#2021-02-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="c4ac" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">1.概述基本随机森林的算法原理。</h1><p id="333c" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">随机森林(RF)使用树作为构建块来构建强大的预测模型。它由大量决策树组成，可以应用于回归和分类问题。</p><p id="7419" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">对于回归树，观察的预测响应由属于同一终端节点的训练观察的平均响应给出。对于分类树，预测每个观察值属于其所属区域中最常出现的训练观察值类别。</p><p id="32b7" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在随机森林中，在自举训练样本中建立决策树的数目，并且分裂节点的算法考虑特征的随机子集。在树的每次分裂中，随机特征子集的一个特征被选择来分裂具有最佳阈值的节点，其目标是最小化分裂处节点的所有基尼系数。如果数据点满足阈值，它将进入一个分支，否则它将进入另一个分支。数据点继续在树的分支上向下移动，直到它位于包含给定观察的树的分类的节点处。这个最后的节点也被称为树的叶子。</p><p id="8c6b" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">在运行模型之前，用户选择创建的树的数量，因此上述过程继续，直到所有的树都完成。值得注意的是，每棵树都将使用随机的特征子集。因此，原始数据集中的某个要素可能不属于随机森林，而其他要素会被多次使用。还应该注意，该过程将在训练集上引导。随机森林建立多个决策树，并将它们合并在一起，以获得更稳定和准确的预测。</p><p id="483a" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">当一个新的观察通过随机森林时，它将通过所有的决策树。模型中的每棵树都将为观察值分配一个类别，并选择这些树中最常出现的类别。当一个新的观察值到达树叶时，它的类别被定义。</p><h1 id="04a5" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">2.R程序设计中的RF函数</h1><p id="6c22" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">在R中，randomForest()函数用于训练训练数据，可用于调整RF模型的两个参数是决策树的数量(ntree)和在每个阶段随机采样的特征的数量(mtry)。</p><p id="b348" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">用作每次分割的潜在候选的特征数量(mtry)通常被设置为sqrt(p)。p是数据集中特征的总数，而决策树的数目(ntree)是随机选择的。</p><h2 id="0a45" class="kf if hh bd ig kg kh ki ik kj kk kl io jn km kn is jr ko kp iw jv kq kr ja ks bi translated">r𝑎𝑛𝑑𝑜𝑚𝐹𝑜𝑟𝑒𝑠𝑡(𝑓𝑜𝑟𝑚𝑢𝑙𝑎、𝑑𝑎𝑡𝑎、𝑛𝑡𝑟𝑒𝑒、𝑚𝑡𝑟𝑦、𝑖𝑚𝑝𝑜𝑟𝑡𝑎𝑛𝑐𝑒=𝐹𝐴𝐿𝑆𝐸)</h2><h2 id="dad5" class="kf if hh bd ig kg kh ki ik kj kk kl io jn km kn is jr ko kp iw jv kq kr ja ks bi translated">输入:</h2><p id="5054" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">𝐹𝑜𝑟𝑚𝑢𝑙𝑎:描述要安装的模型。</p><p id="10fa" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">𝐷𝑎𝑡𝑎:包含模型中变量的数据框，通常是训练数据集。</p><p id="7119" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">𝑁𝑡𝑟𝑒𝑒:要种多少棵树。</p><p id="7246" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">𝑀𝑡𝑟𝑦::每次分裂时随机抽样作为候选变量的变量数。(sqrt(变量数))</p><p id="5728" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">𝐼𝑚𝑝𝑜𝑟𝑡𝑎𝑛𝑐𝑒:应该评估预测因子的重要性吗？</p><h2 id="0559" class="kf if hh bd ig kg kh ki ik kj kk kl io jn km kn is jr ko kp iw jv kq kr ja ks bi translated">输出:</h2><p id="23f8" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">数据的𝑇𝑦𝑝𝑒 𝑜𝑓 𝑟𝑎𝑛𝑑𝑜𝑚 𝑓𝑜𝑟𝑒𝑠𝑡:分类</p><p id="7945" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">𝑁𝑢𝑚𝑏𝑒𝑟 𝑜𝑓 𝑡𝑟𝑒𝑒𝑠:输入中选择的Ntree</p><p id="de88" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">𝑁𝑜.输入中选择的𝑂𝑓 𝑣𝑎𝑟𝑖𝑎𝑏𝑙𝑒𝑠 𝑡𝑟𝑖𝑒𝑑 𝑎𝑡 𝑒𝑎𝑐ℎ 𝑠𝑝𝑙𝑖𝑡:</p><p id="9b07" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">𝑂𝑂𝐵 𝑒𝑠𝑡𝑖𝑚𝑎𝑡𝑒 𝑜𝑓 𝑒𝑟𝑟𝑜𝑟 𝑟𝑎𝑡𝑒:全球训练集错误分类百分比</p><p id="1222" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">混淆矩阵-通过3类数据集的袋外技术(OOB)计算。</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es kt"><img src="../Images/20f4ad4f83d07bec0fdb7c0006bd6695.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b3VFPVHf9qbEtwOGFxtWpw.png"/></div></div></figure><p id="32a7" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">其中:</p><p id="2ac6" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">正确分类的病例数= K11 + K22 + K33</p><p id="2843" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">误差百分比seto = (K12 + K13) / (K11 + K12 + K13)</p><p id="2b4b" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">混淆矩阵的百分比值Pij = Kij / (Ki1 + Ki2 + Ki3)</p><h2 id="a783" class="kf if hh bd ig kg kh ki ik kj kk kl io jn km kn is jr ko kp iw jv kq kr ja ks bi translated">3.展示与射频功能相关的预测功能</h2><p id="03d1" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">在将RF函数应用于训练数据以构建模型之后，使用predict()来预测测试数据中所有案例的类别。</p><h2 id="4374" class="kf if hh bd ig kg kh ki ik kj kk kl io jn km kn is jr ko kp iw jv kq kr ja ks bi">𝑃𝑟𝑒𝑑𝑖𝑐𝑡(𝑜𝑏𝑗𝑒𝑐𝑡,𝑛𝑒𝑤𝑑𝑎𝑡𝑎)</h2><h2 id="93fb" class="kf if hh bd ig kg kh ki ik kj kk kl io jn km kn is jr ko kp iw jv kq kr ja ks bi translated">投入</h2><p id="8482" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">𝑂𝑏𝑗𝑒𝑐𝑡:类随机森林对象，训练数据的射频训练模型</p><p id="dd99" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">𝑁𝑒𝑤𝑑𝑎𝑡𝑎:测试数据集。</p><p id="4d1d" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">输出</p><p id="8e68" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">基于车列射频模型的测试数据集中每个观察值的预测类别的因素向量。它被称为预测测试标签。</p><h2 id="8e74" class="kf if hh bd ig kg kh ki ik kj kk kl io jn km kn is jr ko kp iw jv kq kr ja ks bi translated">4.评估模型</h2><p id="d570" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">在获得测试集中每个观察值的预测类之后，应该应用函数表()来根据案例数创建测试集的混淆矩阵。</p><h2 id="efaf" class="kf if hh bd ig kg kh ki ik kj kk kl io jn km kn is jr ko kp iw jv kq kr ja ks bi translated">4.1案例混淆矩阵</h2><h2 id="bd7c" class="kf if hh bd ig kg kh ki ik kj kk kl io jn km kn is jr ko kp iw jv kq kr ja ks bi translated">t𝑎𝑏𝑙𝑒(test数据标签、预测测试标签)</h2><h2 id="23bb" class="kf if hh bd ig kg kh ki ik kj kk kl io jn km kn is jr ko kp iw jv kq kr ja ks bi translated">输出:</h2><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lf"><img src="../Images/40b4f263d354cb75cfb58b9443ae611c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7hpj2A7MZwGnZVDgP7M3nw.png"/></div></div></figure><h2 id="cd10" class="kf if hh bd ig kg kh ki ik kj kk kl io jn km kn is jr ko kp iw jv kq kr ja ks bi translated">4.2百分比混淆矩阵</h2><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lg"><img src="../Images/81d6d9d197f1a456069c68fbcc22834d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kfkHyojDnbPqm9B0hq2ang.png"/></div></div></figure><h2 id="54d4" class="kf if hh bd ig kg kh ki ik kj kk kl io jn km kn is jr ko kp iw jv kq kr ja ks bi translated">4.3测试集的全局精度性能</h2><p id="021a" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">通过函数计算测试集的全局精度性能:</p><p id="4802" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi">𝑚𝑒𝑎𝑛(𝑡𝑒𝑠𝑡 𝑑𝑎𝑡𝑎 𝑙𝑎𝑏𝑒𝑙== 𝑝𝑟𝑒𝑑𝑖𝑐𝑡 𝑡𝑒𝑠𝑡 𝑠𝑒𝑡)</p><p id="0d3b" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">其输出是正确预测的案例总数与测试集中案例总数的比率。该函数可以计算如下:</p><figure class="ku kv kw kx fd ky er es paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="er es lh"><img src="../Images/81feab9910db8675b47a7507c788abdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5-IBS0LQjqdCViPlrGM00A.png"/></div></div></figure><p id="cd42" class="pw-post-body-paragraph jc jd hh je b jf ka jh ji jj kb jl jm jn kc jp jq jr kd jt ju jv ke jx jy jz ha bi translated">注意:</p><ul class=""><li id="7184" class="li lj hh je b jf ka jj kb jn lk jr ll jv lm jz ln lo lp lq bi translated">*一个集群的基尼系数是用来衡量其杂质的。目标是让集群尽可能的纯净。</li></ul></div></div>    
</body>
</html>