<html>
<head>
<title>3 Ways to Ensure Kubernetes Pod Security</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">确保Kubernetes Pod安全性的3种方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/3-ways-to-ensure-kubernetes-pod-security-be34f21a23a7?source=collection_archive---------20-----------------------#2022-02-25">https://medium.com/analytics-vidhya/3-ways-to-ensure-kubernetes-pod-security-be34f21a23a7?source=collection_archive---------20-----------------------#2022-02-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/6fdb3735746e6eee136c36575f3c0271.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3EDKLdpXkFXjT493"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">穆罕默德·拉赫马尼在<a class="ae it" href="https://unsplash.com/s/photos/docker?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="019f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最近，Kubernetes已经成为软件开发生命周期的重要组成部分，特别是对于持续集成和持续部署。一旦应用程序开始获得牵引力，更多的用户注册，就需要一个负载平衡器来管理和优化流量。如果您想要一个高度可伸缩的应用程序，能够自动伸缩、加速和保护构建和部署生命周期的每个级别，那么Kubernetes就是您的答案。</p><p id="4fbc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae it" href="https://kubernetes.io/" rel="noopener ugc nofollow" target="_blank"> Kubernetes </a>用于管理容器化的应用和松散耦合的系统。通过支持有状态、无服务器和软件加速器，您可以创建各种各样的应用。Kubernetes pod代表集群中正在运行的进程的一个实例。本文讨论了Kubernetes pod的最佳安全措施，使您的应用程序免受网络威胁。</p><p id="cda0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">pod是Kubernetes中最简单和最基本的可部署对象。一个或多个容器包含在容器中。当一个pod运行许多容器时，它们被视为共享pod资源的单个实体。对于他们的容器，pod还具有集成的网络和存储基础设施。</p><h1 id="0441" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">为什么需要Kubernetes Pod安全？</h1><p id="8202" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">Pod security的总体目标是允许您分离工作负载。您可以运行具有不同工作负载的集群，并建立限制，要求每个工作负载的pod将自己的权限限制到特定的边界集，而无需使用第三方软件。通过拒绝违反规则的资源，pod安全性符合声明式对象管理的最佳实践。</p><p id="30e0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在部署到Kubernetes之前，这需要更新源存储库和工具中的资源。集群管理员可以配置预定义的pod安全级别，以适应适当的安全状态。</p><h1 id="4116" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">确保Kubernetes Pod安全性的方法</h1><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kv"><img src="../Images/8b50dd143bda923829df387cfbbe2f2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*obYgMs-KT5k53Jeb"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated"><a class="ae it" href="https://www.suse.com/c/rancher_blog/enhancing-kubernetes-security-with-pod-security-policies-part-2/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="6204" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">Pod security是一个内置的准入控制器，尽管它也可以用作一个单独的webhook。准入控制器的工作原理是在将请求保存到磁盘之前，在Kubernetes API服务器中拦截请求。他们可以选择接受或拒绝请求。在Pod安全的情况下，pod规格将以pod安全标准的形式根据指定的策略进行审查。这意味着在一个pod定义中，安全敏感字段将只允许具有某些值。以下是配置Kubernetes pod安全性的方法:</p><h2 id="69a5" class="la jt hh bd ju lb lc ld jy le lf lg kc jf lh li kg jj lj lk kk jn ll lm ko ln bi translated">1.Pod安全标准:</h2><p id="b9b9" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">pod安全标准指定了三个策略，涵盖了广泛的安全问题。这些法规是累积性的，从极度宽松到极度严格。每项政策的要求概述如下。</p><p id="6a12" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">特权政策</strong>是有意宽泛且不受控制的。这种类型的监管通常适用于由受信任的特权用户在系统和基础架构级别管理的工作负载。没有约束是特权政策的特点。</p><p id="4be6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">特权策略可能是没有应用限制，而不是默认允许实施方法的实例化配置文件(例如<a class="ae it" href="https://open-policy-agent.github.io/gatekeeper/website/docs/" rel="noopener ugc nofollow" target="_blank">网守</a>)。另一方面，特权策略应该启用默认拒绝方法的所有控制(如pod安全策略)。</p><p id="170b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">基准策略</strong>旨在针对常见的容器化工作负载实现简单，同时避免已知的权限提升。非关键应用操作员和开发人员是这一战略的目标。</p><p id="4f25" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">受限策略</strong>旨在实施当前的pod保护最佳实践，同时牺牲一些兼容性。它的目标是安全关键的应用程序操作人员和开发人员，以及信任度较低的用户。</p><p id="ec86" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这些策略级别中的每一个都指定了pod规范中的哪些字段是受限制的，以及可以使用的值。以下是受这些策略限制的一些字段:</p><p id="9525" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="lo">spec . security context . sysctls</em></p><p id="0974" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="lo"> spec.hostNetwork </em></p><p id="cc56" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="lo">规格卷[*]。主机路径</em></p><p id="09cf" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="lo">spec . containers[*]. security context . privileged</em></p><p id="d5f5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">策略级别通过标签应用于命名空间资源，允许对每个命名空间进行粒度策略选择。API服务器的AdmissionConfiguration还可以用于指定集群范围的默认级别和豁免。</p><h2 id="3d59" class="la jt hh bd ju lb lc ld jy le lf lg kc jf lh li kg jj lj lk kk jn ll lm ko ln bi translated">2.Pod安全许可:</h2><p id="bc78" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">Kubernetes有一个内置的pod安全准入控制器，作为测试版功能，它取代了PodSecurityPolicies。准入控制器是一段代码，它在对象持久化之前拦截到Kubernetes API服务器的连接，但是在请求被认证和允许之后。建立、删除、更改或连接到代理的请求受到准入控制器的限制。它们不会对读取对象的请求施加任何限制。</p><p id="600f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">录取程序分为两个阶段。在初始阶段使用变异准入控制。验证入口控制器用于第二步。</p><h2 id="cb43" class="la jt hh bd ju lb lc ld jy le lf lg kc jf lh li kg jj lj lk kk jn ll lm ko ln bi translated">3.配置Pod安全上下文:</h2><p id="7d9c" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">对于pod或容器，安全上下文定义了权限和访问控制设置。自由访问控制(DAC)根据用户ID和组ID授予对项目(如文件)的访问权限。SELinux(安全性增强的Linux)为对象分配安全标签，如特权用户和非特权用户。此外，您可以使用<a class="ae it" href="https://kubernetes.io/docs/tutorials/security/seccomp/" rel="noopener ugc nofollow" target="_blank"> Seccomp </a>过滤进程发出的系统调用，或者将容器的根文件系统挂载为只读。最后，您可以使用<em class="lo">allowprivilegescalation</em>来决定一个进程是否可以获得比它的父进程更高的特权。这个布尔值决定了容器进程的no <em class="lo"> new privs </em>标志是否被置位。当容器以特权或CAP SYS ADMIN身份执行时，<em class="lo">allowprivilegescalation</em>始终为真。</p><h1 id="2de8" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">结论</h1><p id="bf1a" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">Pod security是一项出色的新功能，可让您立即增强工作负载的防御能力。强烈建议您在Kubernetes pod中使用此功能。有关解决集群和名称空间配置需求的专门教程，请参考这个Kubernetes <a class="ae it" href="https://kubernetes.io/docs/tutorials/security/" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><p id="a47f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">感谢您的阅读。</p></div></div>    
</body>
</html>