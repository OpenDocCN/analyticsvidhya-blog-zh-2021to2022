<html>
<head>
<title>ETL Processing With Python &amp; SQLAlchemy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和SQLAlchemy进行ETL处理</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/etl-processing-with-python-sqlalchemy-3f8700c4b4cd?source=collection_archive---------30-----------------------#2021-05-27">https://medium.com/analytics-vidhya/etl-processing-with-python-sqlalchemy-3f8700c4b4cd?source=collection_archive---------30-----------------------#2021-05-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div class="er es hf"><img src="../Images/151a021483333f7fff0ee70830c6fb59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*lJRUmIH9ik40pjMnb80Dng.jpeg"/></div><figcaption class="hm hn et er es ho hp bd b be z dx translated">侯赛因·埃尔希设计</figcaption></figure><div class=""/><h1 id="6fae" class="ip iq hs bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">以Python和SQLAlchemy代码为例，了解数据驱动世界中的提取、转换和加载(ETL)。</h1><p id="100a" class="pw-post-body-paragraph jn jo hs jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">数据驱动的人，无论是程序员、业务分析师、数据科学家还是数据库开发人员，都在直接或间接地开发<strong class="jp ht"> ETL管道</strong>。对于数据驱动的业务，<em class="kl"> ETL是必须的</em>。</p><h1 id="0b19" class="ip iq hs bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">什么是ETL？</h1><p id="d52f" class="pw-post-body-paragraph jn jo hs jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">在计算中，提取、转换、加载(ETL)是将数据从一个或多个源复制到目标系统的一般过程，该目标系统以不同于源的方式或在不同于源的上下文中表示数据。ETL过程在20世纪70年代成为一个流行的概念，经常用于数据仓库。<a class="ae km" href="https://pandao.github.io/editor.md/en.html#1" rel="noopener ugc nofollow" target="_blank"> 1 </a></p><p id="4d38" class="pw-post-body-paragraph jn jo hs jp b jq kn js jt ju ko jw jx jy kp ka kb kc kq ke kf kg kr ki kj kk ha bi translated">您可以<strong class="jp ht">从任何数据源提取</strong>数据，例如文件、任何RDBMS或NoSql数据库、网站(使用scrabing)或实时用户或机器活动(来自Kafka)。<strong class="jp ht">转换</strong>获取的数据，然后<strong class="jp ht">将转换后的数据加载</strong>到数据仓库中，供您的业务使用，如报告、分析或可视化。</p><p id="d89c" class="pw-post-body-paragraph jn jo hs jp b jq kn js jt ju ko jw jx jy kp ka kb kc kq ke kf kg kr ki kj kk ha bi translated">ETL是一个包含3个主要步骤的过程:</p><ol class=""><li id="6149" class="ks kt hs jp b jq kn ju ko jy ku kc kv kg kw kk kx ky kz la bi translated"><strong class="jp ht">从单个或多个数据源提取</strong> ing数据。根据业务逻辑转换数据。</li><li id="e775" class="ks kt hs jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated"><strong class="jp ht">转换</strong>本身是一个两步过程。数据清理和数据操作。</li><li id="8a08" class="ks kt hs jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated"><strong class="jp ht">将</strong>转换后的数据加载到目标数据源、数据仓库或数据集市。</li></ol><h1 id="9a88" class="ip iq hs bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">提取</h1><p id="d074" class="pw-post-body-paragraph jn jo hs jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">ETL过程的第一部分包括从源系统中提取数据。在许多情况下，这代表了ETL最重要的方面，因为正确地提取数据为后续过程的成功奠定了基础。大多数数据仓库项目结合了来自不同源系统的数据。</p><h1 id="175b" class="ip iq hs bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">转换</h1><p id="ab15" class="pw-post-body-paragraph jn jo hs jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">在这一阶段，一系列规则或函数被应用到提取的数据，以便为加载到最终目标做准备。</p><p id="75a9" class="pw-post-body-paragraph jn jo hs jp b jq kn js jt ju ko jw jx jy kp ka kb kc kq ke kf kg kr ki kj kk ha bi translated">转换阶段的一个重要功能是数据清理，其目的是只将最“合适”的数据传递给目标。</p><p id="fd14" class="pw-post-body-paragraph jn jo hs jp b jq kn js jt ju ko jw jx jy kp ka kb kc kq ke kf kg kr ki kj kk ha bi translated">在这个阶段使用标签编码，清除空值，计算一些组或聚合，分裂或任何变换。</p><h1 id="0458" class="ip iq hs bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">装货</h1><p id="d48e" class="pw-post-body-paragraph jn jo hs jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">加载阶段将数据加载到最终目标中，最终目标可以是任何数据存储，包括简单分隔的平面文件或数据仓库。<a class="ae km" href="https://pandao.github.io/editor.md/en.html#2" rel="noopener ugc nofollow" target="_blank"> 2 </a>根据组织的要求，这一过程会有很大的不同。一些数据仓库可能会用累积信息覆盖现有信息；每天、每周或每月经常更新提取的数据。</p><blockquote class="lg"><p id="c26c" class="lh li hs bd lj lk ll lm ln lo lp kk dx translated">ETL不应该与Informatica、DataBricks或Airflow等工具混淆。它是一个数据处理概念，可以通过编程语言和各种工具的帮助来创建。</p></blockquote><h1 id="3233" class="ip iq hs bd ir is it iu iv iw ix iy iz ja lr jc jd je ls jg jh ji lt jk jl jm bi translated">创建ETL管道</h1><p id="f8ba" class="pw-post-body-paragraph jn jo hs jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">让我们建立ETL管道。数据工程师、数据科学家、机器学习工程师、数据分析师大多使用数据。这些大多使用Python脚本语言。</p><p id="c547" class="pw-post-body-paragraph jn jo hs jp b jq kn js jt ju ko jw jx jy kp ka kb kc kq ke kf kg kr ki kj kk ha bi translated">因此，这里我们将通过使用Python编程语言和SQLAlchemy来建立我们的ETL管道。(您可以使用sqlite3等代替SQLAlchemy)不要忘记Python附带了许多不同的库，可以帮助建立数十种数据分析、数据可视化或数据科学解决方案。</p><p id="331a" class="pw-post-body-paragraph jn jo hs jp b jq kn js jt ju ko jw jx jy kp ka kb kc kq ke kf kg kr ki kj kk ha bi translated">下面是我简单的3个主要步骤的ETL过程:</p><ul class=""><li id="c938" class="ks kt hs jp b jq kn ju ko jy ku kc kv kg kw kk lu ky kz la bi translated">从<strong class="jp ht">中提取数据。sqlite </strong>文件与<strong class="jp ht"> SQLAlchemy </strong></li><li id="fbaf" class="ks kt hs jp b jq lb ju lc jy ld kc le kg lf kk lu ky kz la bi translated">用<strong class="jp ht">熊猫</strong>转换/操作数据</li><li id="fe5c" class="ks kt hs jp b jq lb ju lc jy ld kc le kg lf kk lu ky kz la bi translated">将数据载入<strong class="jp ht">。带有<strong class="jp ht"> SQLAlchemy </strong>的sqlite </strong>数据库</li></ul><h1 id="24f2" class="ip iq hs bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">代码源</h1><p id="8d7d" class="pw-post-body-paragraph jn jo hs jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">python代码源代码可以在<a class="ae km" href="https://github.com/huseyinelci/DE-ETLProcessingWithPython" rel="noopener ugc nofollow" target="_blank"> my Github repository </a>中找到。可以自由查看。<a class="ae km" href="https://github.com/huseyinelci/DE-ETLProcessingWithPython" rel="noopener ugc nofollow" target="_blank">点击它</a></p><h1 id="d753" class="ip iq hs bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">数据源</h1><p id="9327" class="pw-post-body-paragraph jn jo hs jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">源码所有者是<a class="ae km" href="https://github.com/lerocha" rel="noopener ugc nofollow" target="_blank"> Luis Rocha </a> <a class="ae km" href="https://github.com/lerocha/chinook-database/blob/master/ChinookDatabase/DataSources/Chinook_Sqlite.sqlite" rel="noopener ugc nofollow" target="_blank">下载文件</a> Chinook是一个可供SQL Server、Oracle、MySQL等使用的示例数据库。它可以通过运行一个SQL脚本来创建。Chinook数据库是Northwind数据库的替代产品，是演示和测试针对单个和多个数据库服务器的ORM工具的理想选择。</p><h1 id="b9ce" class="ip iq hs bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">批准</h1><p id="0947" class="pw-post-body-paragraph jn jo hs jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">这个项目中的<strong class="jp ht">是开源</strong>，所有者是<a class="ae km" href="https://github.com/lerocha" rel="noopener ugc nofollow" target="_blank">路易斯·罗查</a>。此外，如果你计划在你的文章研究中使用这个数据库，或者你必须在路易斯·罗查知识库中找到并阅读主要资料。</p><h1 id="778f" class="ip iq hs bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">作者</h1><p id="ca35" class="pw-post-body-paragraph jn jo hs jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">侯赛因·ELCI |<a class="ae km" href="https://github.com/huseyinelci" rel="noopener ugc nofollow" target="_blank">Github</a>|<a class="ae km" href="https://www.kaggle.com/huseyinelci" rel="noopener ugc nofollow" target="_blank">Kaggle</a>|<a class="ae km" href="https://www.linkedin.com/in/huseyinelci/" rel="noopener ugc nofollow" target="_blank">Linkedin</a>| Medium |</p><h1 id="180f" class="ip iq hs bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">承认</h1><p id="37ec" class="pw-post-body-paragraph jn jo hs jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">感谢<a class="ae km" href="https://github.com/lerocha" rel="noopener ugc nofollow" target="_blank"> Luis Rocha </a>提供的酷数据，我们可以创建一个前沿项目。</p></div><div class="ab cl lv lw go lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ha hb hc hd he"><p id="f8ca" class="pw-post-body-paragraph jn jo hs jp b jq kn js jt ju ko jw jx jy kp ka kb kc kq ke kf kg kr ki kj kk ha bi translated"><em class="kl">最初发表于</em><a class="ae km" href="https://www.linkedin.com/pulse/etl-processing-python-sqlalchemy-huseyin-elci/" rel="noopener ugc nofollow" target="_blank">T5【https://www.linkedin.com】</a><em class="kl">。</em></p></div></div>    
</body>
</html>