<html>
<head>
<title>Multiple Linear Regression from scratch using only numpy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">仅使用numpy从头开始多元线性回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/multiple-linear-regression-from-scratch-using-only-numpy-98fc010a1926?source=collection_archive---------2-----------------------#2021-02-09">https://medium.com/analytics-vidhya/multiple-linear-regression-from-scratch-using-only-numpy-98fc010a1926?source=collection_archive---------2-----------------------#2021-02-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/517f55ffb6c6df16866eaeae57d3f515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a3HFulvxQQM32dHOY_Dtqw.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">图片来源:<a class="ae iu" href="https://morioh.com/p/0d9b2bedf683" rel="noopener ugc nofollow" target="_blank">https://morioh.com/p/0d9b2bedf683</a></figcaption></figure><p id="bd9f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">线性回归是机器学习的起始算法。在scikit learn等库的帮助下，实现多元线性回归几乎不需要两三行代码。数据集也可以在熊猫的帮助下轻松处理，但我尽量避免这种方法。在这篇文章中，我解释了如何用python实现矩阵的经典方法。这种方法着重于直接从书本到代码实现算法！我用过的唯一一个包是numpy，因为我们的数据集处理矩阵，而numpy有许多函数可以有效地处理它们，如果没有这些函数，我们就必须编写大量的循环，这可能仍然没有numpy有效。所以让我们马上开始吧！</p><p id="bf8d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">有一个以上输入的线性回归称为多元线性回归或多元回归。在这个实现中，我使用了<a class="ae iu" href="https://www.kaggle.com/quantbruce/real-estate-price-prediction" rel="noopener ugc nofollow" target="_blank">房地产数据集</a>，它有几个特征，算法试图预测价格，这是预测器。</p><p id="87f6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们必须首先进行一些导入，这些导入将在我们的代码中使用。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="d9f9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正如承诺的那样，我不会用熊猫。因此，我们必须努力编写一个函数来加载数据集。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="105b" class="ke kf hi ka b fi kg kh l ki kj">HEADERS<br/>['No', 'X1 transaction date', 'X2 house age', 'X3 distance to the nearest MRT station', 'X4 number of convenience stores', 'X5 latitude', 'X6 longitude', 'Y house price of unit area']</span></pre><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="de63" class="ke kf hi ka b fi kg kh l ki kj">Dataset Size<br/>414 X 8</span></pre><p id="899b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们从这个数据集中选择我们的特征和目标变量。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="9601" class="ke kf hi ka b fi kg kh l ki kj">Size of X<br/>(414, 5)<br/>Size of Y<br/>(414,)</span></pre><p id="ce68" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">设置好我们的数据后，让我们对算法如何工作以及我们到底要编码什么有一个大致的了解，而不用深入所有数学背后的证明细节。为了更容易理解，我将尽力把算法与我们正在使用的房地产数据集联系起来。</p><h2 id="1a85" class="ke kf hi bd kk kl km kn ko kp kq kr ks jg kt ku kv jk kw kx ky jo kz la lb lc bi translated"><strong class="ak">入门</strong></h2><p id="efb3" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">在这个阶段，我们有N个数据样本，并且我们已经把它分成我们的特征矩阵和目标矩阵。除了第一列(“否”)和目标列(“单位面积的Y房价”)之外，我们的数据集中总共有六个特征(“X1交易日期”、“X2房屋年龄”、“X3到最近的MRT站的距离”、“X4便利店数量”、“X5纬度”、“X6经度”)。我们必须找到一种关系来生成目标Y，并将其公式化为一个方程，该方程是不同特征的函数。为了方便起见，我还排除了第一个特性(“X1交易日期”)，因为数据在数据集中的格式不正确。这里我们有N = 414个样本，当我们将数据分成训练集和测试集时，这些样本也会减少。因此，此时N = 414，特征数量(假设p)= 5</p><p id="e899" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于单个特征，我们有以下形式的线性方程</p><p id="763f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">y = 𝛽0+𝛽x，</p><p id="83c7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">其在扩展到单个样本的多个特征时采取以下形式</p><p id="8008" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi">𝑦=𝛽0+𝛽1𝑥1+𝛽2𝑥2+…𝛽𝑝𝑥𝑝</p><p id="73e0" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对于N个样本，我们可以将其概括为</p><p id="024f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi">𝑦1=𝛽0+𝛽1𝑥11+𝛽2𝑥12+…𝛽𝑝𝑥1𝑝</p><p id="0f6d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi">𝑦2=𝛽0+𝛽1𝑥21+𝛽2𝑥22+…𝛽𝑝𝑥2𝑝</p><p id="11e9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi">⋮</p><p id="7cc5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi">𝑦𝑖=𝛽0+𝛽1𝑥𝑖1+𝛽2𝑥𝑖2+…𝛽𝑝𝑥𝑖𝑝</p><p id="df29" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi">⋮</p><p id="4059" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi">𝑦𝑁=𝛽0+𝛽1𝑥𝑁1+𝛽2𝑥𝑁2+…𝛽𝑝𝑥𝑁𝑝</p><p id="aaf5" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果我们以矩阵的形式表示上述方程，我们分别有(N <em class="li"> X </em> p)，(1 <em class="li"> X </em> (p+1))和(N <em class="li"> X </em> 1)阶的x、𝛽和y矩阵。</p><p id="1667" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">用矩阵形式表示这个方程组，我们有</p><p id="6195" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">Y = X * transpose(𝛽)</p><p id="90b2" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是要进行这个矩阵乘法，我们得让X为(N <em class="li"> X </em> (p+1))。我们从上面的等式中观察到，在每个等式中,<em class="li"> x </em> 0项都是1。我们现在正在处理的数据集到目前为止有N = 414和p = 5，这使得我们的X为(414 <em class="li"> X </em> 5)的阶。但是对于矩阵乘法，我们必须通过首先添加一列1(bias(<em class="li">X</em>0)项)来使其为(414 <em class="li"> X </em> 6)阶。同样，我们的Y应该是一个列向量(414 <em class="li"> X </em> 1 ),它现在是行向量的形式。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="9fe7" class="ke kf hi ka b fi kg kh l ki kj">Size of X<br/>(414, 6)<br/>Size of Y<br/>(414, 1)</span></pre><p id="46e8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">让我们也看看我们的X和Y矩阵，检查是否一切正常。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="5dfa" class="ke kf hi ka b fi kg kh l ki kj">X head</span><span id="4dad" class="ke kf hi ka b fi lj kh l ki kj">array([[  1. , 32. , 84.87882, 10. ,  24.98298, 121.54024],<br/>       [  1. , 19.5, 306.5947, 9.  ,  24.98034, 121.53951],<br/>       [  1. , 13.3, 561.9845, 5.  ,  24.98746, 121.54391],<br/>       [  1. , 13.3, 561.9845, 5.  ,  24.98746, 121.54391],<br/>       [  1. , 5.  , 390.5684, 5.  ,  24.97937, 121.54245]])</span><span id="97d2" class="ke kf hi ka b fi lj kh l ki kj">Y head</span><span id="1a28" class="ke kf hi ka b fi lj kh l ki kj">array([[37.9],<br/>       [42.2],<br/>       [47.3],<br/>       [54.8],<br/>       [43.1]])</span></pre><p id="50d7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">到目前为止一切顺利！</p><h2 id="0925" class="ke kf hi bd kk kl km kn ko kp kq kr ks jg kt ku kv jk kw kx ky jo kz la lb lc bi translated">随机分割数据集</h2><p id="eb32" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">现在，我们遵循传统的方法，将数据集分为训练集和测试集，训练集占数据集的70%。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="f974" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在让我们来看看我们的训练和测试集的形状。</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="276b" class="ke kf hi ka b fi kg kh l ki kj">TRAINING SET<br/>X_train.shape:  (290, 6)<br/>Y_train.shape:  (290, 1)<br/><br/>TESTING SET<br/>X_test.shape:  (124, 6)<br/>Y_test.shape:  (124, 1)</span></pre><p id="b9bf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将仅将该算法应用于我们的训练集，并使用测试集来检查该算法的性能。因此，我们的N从414减少到现在的290(70%)。</p><p id="9b4f" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">从我们的矩阵方程中，我们已经准备好了x矩阵和y矩阵，我们的目标是找到𝛽矩阵(或者更准确地说是特征系数，但是从现在开始让我们把𝛽转置矩阵称为𝛽)，使得从矩阵乘法中获得的y(y =x𝛽)最接近我们实际的y矩阵。换句话说，我们必须找到贝塔(𝛽)矩阵，使误差最小。</p><p id="7d4b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为此，我们有两种方法:</p><ol class=""><li id="20a1" class="lk ll hi ix b iy iz jc jd jg lm jk ln jo lo js lp lq lr ls bi translated">梯度下降法</li><li id="f071" class="lk ll hi ix b iy lt jc lu jg lv jk lw jo lx js lp lq lr ls bi translated">正规方程法</li></ol><p id="eea6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这篇文章中，我们将遵循正常方程的方法。正规方程是一种无需迭代就能找到最佳beta(𝛽的方法。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c4bd900cf5c9b634908bca7d36e60a79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*enOBye6mM_pN7JnGAITQDw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">这个对比摘自吴恩达在Coursera上的机器学习课程</figcaption></figure><p id="c74d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在正规方程法中，最佳β值由下式给出:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es ly"><img src="../Images/3b25f9bd096357ade191147b959d8a8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:280/format:webp/1*xMoP9IyWFSJn2D0JfU-ZQw.png"/></div></figure><p id="9478" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">正规方程的数学证明需要线性代数知识，但感兴趣的人可以将<a class="ae iu" href="https://eli.thegreenplace.net/2014/derivation-of-the-normal-equation-for-linear-regression" rel="noopener ugc nofollow" target="_blank">移到这里</a>。</p><h2 id="9f68" class="ke kf hi bd kk kl km kn ko kp kq kr ks jg kt ku kv jk kw kx ky jo kz la lb lc bi translated">β值和预测</h2><p id="f074" class="pw-post-body-paragraph iv iw hi ix b iy ld ja jb jc le je jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">接下来，我们实现一个函数来查找𝛽的值，并开始使用计算出的𝛽.进行预测</p><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="321f" class="ke kf hi ka b fi kg kh l ki kj">(124, 1)</span></pre><p id="cd12" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以看到，到目前为止，我们的代码已经预测了所有测试样本的Y值。是时候检验我们模型的准确性了。</p><h2 id="1add" class="ke kf hi bd kk kl km kn ko kp kq kr ks jg kt ku kv jk kw kx ky jo kz la lb lc bi translated">检查准确性</h2><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><figure class="jt ju jv jw fd ij"><div class="bz dy l di"><div class="jx jy l"/></div></figure><pre class="jt ju jv jw fd jz ka kb kc aw kd bi"><span id="5688" class="ke kf hi ka b fi kg kh l ki kj">Mean Absolute Error:  5.484897442452742<br/>Root Mean Square Error:  7.038888303432659<br/>R square:  0.6927055239131656</span></pre><p id="8d44" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，这个模型看起来还不错，但仍有改进的余地。至于我，就交给你了！:-)</p></div><div class="ab cl lz ma gp mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="hb hc hd he hf"><p id="23e7" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">参考文献和致谢:</p><ol class=""><li id="12c2" class="lk ll hi ix b iy iz jc jd jg lm jk ln jo lo js lp lq lr ls bi translated">数据集:<a class="ae iu" href="https://www.kaggle.com/quantbruce/real-estate-price-prediction" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/quant Bruce/real-estate-price-prediction</a></li><li id="f0cb" class="lk ll hi ix b iy lt jc lu jg lv jk lw jo lx js lp lq lr ls bi translated">深入数学正规方程证明:<a class="ae iu" href="https://eli.thegreenplace.net/2014/derivation-of-the-normal-equation-for-linear-regression" rel="noopener ugc nofollow" target="_blank">https://Eli . the green place . net/2014/线性回归的正规方程推导</a></li><li id="b34e" class="lk ll hi ix b iy lt jc lu jg lv jk lw jo lx js lp lq lr ls bi translated">图片来自:【https://morioh.com/p/0d9b2bedf683 T4】</li><li id="8d3a" class="lk ll hi ix b iy lt jc lu jg lv jk lw jo lx js lp lq lr ls bi translated">感谢我的朋友Ashish sureka(LinkedIn:<a class="ae iu" href="https://www.linkedin.com/in/ashish-sureka/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/ashish-sureka/</a>)在概念和代码方面帮助了我。</li></ol></div><div class="ab cl lz ma gp mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="hb hc hd he hf"><blockquote class="mi mj mk"><p id="5a5d" class="iv iw li ix b iy iz ja jb jc jd je jf ml jh ji jj mm jl jm jn mn jp jq jr js hb bi translated">有疑问吗？在LinkedIn上找到我:<a class="ae iu" href="https://www.linkedin.com/in/dddash11/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/dddash11/</a></p></blockquote><p id="a973" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在此获取完整代码:<a class="ae iu" href="https://github.com/dddash11/ML/blob/main/notebooks/ML%20Algorithm%20implementations/Linear%20Regression/multiple_lin_reg_implementation.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/dddash 11/ML/blob/main/notebooks/ML % 20 algorithm % 20 implementations/Linear % 20 regression/multiple _ Lin _ reg _ implementation . ipynb</a></p></div></div>    
</body>
</html>