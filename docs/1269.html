<html>
<head>
<title>JupyterLab on AWS EC2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS EC2上的JupyterLab</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/jupyterlab-on-aws-ec2-d6b2cb945e54?source=collection_archive---------3-----------------------#2021-02-22">https://medium.com/analytics-vidhya/jupyterlab-on-aws-ec2-d6b2cb945e54?source=collection_archive---------3-----------------------#2021-02-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="4ffc" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">在AWS EC2机器上设置和运行JupyterLab的详细步骤。</h2></div><div class="iw ix iy iz fd ab cb"><figure class="ja jb jc jd je jf jg paragraph-image"><div role="button" tabindex="0" class="jh ji di jj bf jk"><img src="../Images/9cd6336d9afc39d0d412af1ec5f8ceb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/0*hLz1yzmBh7XX4Upb.png"/></div></figure><figure class="ja jb jn jd je jf jg paragraph-image"><div role="button" tabindex="0" class="jh ji di jj bf jk"><img src="../Images/dd0a2e18bfab6a2ab9d59227f629d6f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/0*OrJpV_MLpas4mxEb.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx js di jt ju translated">图片来自维基百科(<a class="ae jv" href="https://en.wikipedia.org/wiki/Amazon_Elastic_Compute_Cloud" rel="noopener ugc nofollow" target="_blank">左</a> ) ( <a class="ae jv" href="https://en.wikipedia.org/wiki/Project_Jupyter" rel="noopener ugc nofollow" target="_blank">右</a>)</figcaption></figure></div><p id="4a6e" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">本教程记录了从AWS EC2提供JupyterLab所需的步骤。这对于运行需要连续网络访问的程序特别有用，比如网络抓取。我个人经常使用这种设置来测试和调试日内交易算法。</p><p id="43d7" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated"><a class="ae jv" href="https://jupyter.org/" rel="noopener ugc nofollow" target="_blank"> JupyterLab </a>是一个基于web的Python IDE(交互式开发环境)。EC2 是亚马逊提供的一项服务，在云上提供虚拟机。</p><p id="1e8c" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated"><strong class="jy hi"> <em class="ks">注意:- </em> </strong> <em class="ks">为了完整和简洁起见，常见的做法如SSH密钥设置、虚拟环境创建等。不包括在本教程中。</em></p><h2 id="a014" class="kt ku hh bd kv kw kx ky kz la lb lc ld kf le lf lg kj lh li lj kn lk ll lm ln bi translated">启动EC2实例并连接</h2><ol class=""><li id="e2e2" class="lo lp hh jy b jz lq kc lr kf ls kj lt kn lu kr lv lw lx ly bi translated">从<a class="ae jv" href="https://aws.amazon.com/" rel="noopener ugc nofollow" target="_blank">这里</a>创建一个AWS账户(或登录到现有账户)。</li><li id="535e" class="lo lp hh jy b jz lz kc ma kf mb kj mc kn md kr lv lw lx ly bi translated">转到<em class="ks">服务</em>下的<em class="ks"> EC2 </em>，然后点击<em class="ks">实例</em>。</li></ol><figure class="iw ix iy iz fd jb er es paragraph-image"><div role="button" tabindex="0" class="jh ji di jj bf jk"><div class="er es me"><img src="../Images/83038135fa9bfbdca6f09daac16f82c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1fT-al4tXoEd-1qfy52_0A.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">作者图片</figcaption></figure><figure class="iw ix iy iz fd jb er es paragraph-image"><div role="button" tabindex="0" class="jh ji di jj bf jk"><div class="er es mf"><img src="../Images/4f7f98fff4929e9ca96aa6219aba4a85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jssCkCESSABS0Gd8q4Flgg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">作者图片</figcaption></figure><p id="b57d" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">3.点击<em class="ks">启动实例</em>。</p><figure class="iw ix iy iz fd jb er es paragraph-image"><div role="button" tabindex="0" class="jh ji di jj bf jk"><div class="er es mg"><img src="../Images/4b770c592e6c5072f7c9ffc9d4ee3dd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKWqRPhiJEQGiuoIC4wEfA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">作者图片</figcaption></figure><p id="54a7" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">4.选择<em class="ks"> Ubuntu Server 20.04 (64位)。(或任何其他Linux发行版)</em></p><figure class="iw ix iy iz fd jb er es paragraph-image"><div role="button" tabindex="0" class="jh ji di jj bf jk"><div class="er es mh"><img src="../Images/691b65cb23a117e719326b8046eef987.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2pgwFvcYlNeXER3Tk3PhPA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">作者图片</figcaption></figure><p id="4a04" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">5.选择<em class="ks"> t2.micro ( </em> <a class="ae jv" href="https://aws.amazon.com/ec2/instance-types/" rel="noopener ugc nofollow" target="_blank"> <em class="ks">或根据项目需求选择不同的实例类型</em> </a> <em class="ks"> ) </em>，然后转到安全组配置。</p><figure class="iw ix iy iz fd jb er es paragraph-image"><div role="button" tabindex="0" class="jh ji di jj bf jk"><div class="er es mi"><img src="../Images/9ab856bbc92fb1b0e02d6a0bf41125b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lnr7JBeFECwNS0h3AWO2-A.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">作者图片</figcaption></figure><p id="8a19" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">6.为JupyterLab服务添加具有以下参数的入站规则。</p><pre class="iw ix iy iz fd mj mk ml mm aw mn bi"><span id="e604" class="kt ku hh mk b fi mo mp l mq mr">╔═════════════════╦══════════╦════════════╦═══════════════════════╗<br/>║      Type       ║ Protocol ║ Port Range ║       Source          ║<br/>╠═════════════════╬══════════╬════════════╬═══════════════════════╣<br/>║ Custom TCP Rule ║   TCP    ║    8888    ║ Custom 0.0.0.0/0,::/0 ║<br/>╚═════════════════╩══════════╩════════════╩═══════════════════════╝</span></pre><p id="3a27" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">点击<em class="ks">查看并启动</em>。</p><figure class="iw ix iy iz fd jb er es paragraph-image"><div role="button" tabindex="0" class="jh ji di jj bf jk"><div class="er es ms"><img src="../Images/2cf9123461233c5975d890d38b263389.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C-k8GO2C4Mpt1NX4HWmnyQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">作者图片</figcaption></figure><figure class="iw ix iy iz fd jb er es paragraph-image"><div role="button" tabindex="0" class="jh ji di jj bf jk"><div class="er es mt"><img src="../Images/d15540987454933b573f2297db75262e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nTk5eZUVPFQWMSOP40AkwQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">作者图片</figcaption></figure><p id="fad1" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">7.选择<em class="ks">在没有密钥对的情况下继续</em>，然后点击<em class="ks">启动实例</em>。</p><figure class="iw ix iy iz fd jb er es paragraph-image"><div role="button" tabindex="0" class="jh ji di jj bf jk"><div class="er es mu"><img src="../Images/2ace0c7d08df50b4dde4d5b257ba8f96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j-o5dl4V21ulRkX3_CQObA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">作者图片</figcaption></figure><p id="acc5" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">实例现在准备就绪。</p><p id="41a1" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">8.转到running instances部分，并在它启动并运行时连接到它。</p><figure class="iw ix iy iz fd jb er es paragraph-image"><div role="button" tabindex="0" class="jh ji di jj bf jk"><div class="er es mf"><img src="../Images/bd068168a6439c1bfbb86dd7ed300549.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jkQR3OO8_P3bPux6mYSobw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">作者图片</figcaption></figure><figure class="iw ix iy iz fd jb er es paragraph-image"><div role="button" tabindex="0" class="jh ji di jj bf jk"><div class="er es mf"><img src="../Images/84f25f502d10f0a604ef4cf056494865.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3m0sQPuW4mU3i6M2mG7Dig.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">作者图片</figcaption></figure><figure class="iw ix iy iz fd jb er es paragraph-image"><div role="button" tabindex="0" class="jh ji di jj bf jk"><div class="er es mu"><img src="../Images/bdc52f09fc26cfa888d09bf0ddb04805.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d6Ga_-Y_KrN6nfwDa681fA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">作者图片</figcaption></figure><h2 id="cf4e" class="kt ku hh bd kv kw kx ky kz la lb lc ld kf le lf lg kj lh li lj kn lk ll lm ln bi translated">安装pip和JupyterLab</h2><p id="b38b" class="pw-post-body-paragraph jw jx hh jy b jz lq ii kb kc lr il ke kf mv kh ki kj mw kl km kn mx kp kq kr ha bi translated">Ubuntu Server 20.04 LTS版包含Python 3。运行以下命令来安装pip3。<a class="ae jv" href="https://pypi.org/project/pip/" rel="noopener ugc nofollow" target="_blank"> pip </a>是用python写的包管理器。<em class="ks">(此时可以选择安装</em><a class="ae jv" href="https://www.anaconda.com/" rel="noopener ugc nofollow" target="_blank"><em class="ks">conda</em></a><em class="ks">并创建一个环境)</em></p><pre class="iw ix iy iz fd mj mk ml mm aw mn bi"><span id="6bb9" class="kt ku hh mk b fi mo mp l mq mr">sudo apt update<br/>sudo apt install python3-pip</span></pre><p id="373e" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">使用pip3安装JupyterLab。</p><pre class="iw ix iy iz fd mj mk ml mm aw mn bi"><span id="c433" class="kt ku hh mk b fi mo mp l mq mr">pip3 install jupyterlab</span></pre><p id="78e3" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated"><em class="ks">注意:-建议在安装JupyterLab后关闭并重新连接到服务器，因为某些命令可能无法运行，除非您重新启动终端。</em></p><h2 id="0953" class="kt ku hh bd kv kw kx ky kz la lb lc ld kf le lf lg kj lh li lj kn lk ll lm ln bi translated">用密码保护JupyterLab</h2><p id="a51a" class="pw-post-body-paragraph jw jx hh jy b jz lq ii kb kc lr il ke kf mv kh ki kj mw kl km kn mx kp kq kr ha bi translated">由于IDE可以公开访问，因此最好用密码来保护它。使用IPython准备密码哈希。</p><pre class="iw ix iy iz fd mj mk ml mm aw mn bi"><span id="0c08" class="kt ku hh mk b fi mo mp l mq mr">ipython</span><span id="acca" class="kt ku hh mk b fi my mp l mq mr">from IPython.lib import passwd<br/>passwd()</span><span id="2e03" class="kt ku hh mk b fi my mp l mq mr">quit()</span></pre><figure class="iw ix iy iz fd jb er es paragraph-image"><div role="button" tabindex="0" class="jh ji di jj bf jk"><div class="er es mz"><img src="../Images/d7a144eaceedfd7ec1ecf27353f929d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fa6PIEISIFGAY8tBN04wtg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">作者图片</figcaption></figure><p id="6baf" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">为了避免发送未加密的密码，让我们使用SSL。创建自签名证书，并使当前用户成为文件所有者。</p><pre class="iw ix iy iz fd mj mk ml mm aw mn bi"><span id="c026" class="kt ku hh mk b fi mo mp l mq mr">mkdir certs<br/>cd certs</span><span id="4a62" class="kt ku hh mk b fi my mp l mq mr">sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout mycert.pem -out mycert.pem</span><span id="a676" class="kt ku hh mk b fi my mp l mq mr">sudo chown $USER:$USER mycert.pem</span><span id="e657" class="kt ku hh mk b fi my mp l mq mr">cd ..</span></pre><p id="f792" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">生成jupyter服务器配置文件，并使用密码哈希和证书路径对其进行更新。</p><pre class="iw ix iy iz fd mj mk ml mm aw mn bi"><span id="fa21" class="kt ku hh mk b fi mo mp l mq mr">jupyter server --generate-config<br/>nano .jupyter/jupyter_server_config.py</span></pre><p id="ceb6" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">如下所示更新配置文件。</p><pre class="iw ix iy iz fd mj mk ml mm aw mn bi"><span id="9c3e" class="kt ku hh mk b fi mo mp l mq mr">c = get_config()<br/>c.ServerApp.certfile = u'/home/ubuntu/certs/mycert.pem'<br/>c.ServerApp.ip = '*'<br/>c.ServerApp.password = u'sha1:e261d4617d68:3d1a307b7bcc279a6ac72b4dd5fb5a067c52b3c8'<br/>c.ServerApp.port = 8888</span></pre><figure class="iw ix iy iz fd jb er es paragraph-image"><div role="button" tabindex="0" class="jh ji di jj bf jk"><div class="er es na"><img src="../Images/87e5db6b27652578079568f748bb5283.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*upYrQF2yaWwTZXWXBJpp8g.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">作者图片</figcaption></figure><p id="9bb0" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">用您的密码哈希替换密码，如果不同，更新SSL证书路径。</p><p id="6e20" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">按下<code class="du nb nc nd mk b">ctrl-x<br/></code>按下<code class="du nb nc nd mk b">y<br/></code>按下<code class="du nb nc nd mk b">Enter</code></p><h2 id="dc62" class="kt ku hh bd kv kw kx ky kz la lb lc ld kf le lf lg kj lh li lj kn lk ll lm ln bi translated">运行JupyterLab</h2><p id="c17f" class="pw-post-body-paragraph jw jx hh jy b jz lq ii kb kc lr il ke kf mv kh ki kj mw kl km kn mx kp kq kr ha bi translated">为了在SSH连接断开时保持jupyter服务器进程运行，该进程应该在<a class="ae jv" href="https://en.wikipedia.org/wiki/Terminal_multiplexer" rel="noopener ugc nofollow" target="_blank">终端多路复用器</a>中启动。为此，让我们使用一个简单的多路复用器<a class="ae jv" href="https://www.gnu.org/software/screen/" rel="noopener ugc nofollow" target="_blank"> GNU屏幕</a>。大多数Linux发行版都预装了GNU Screen。</p><p id="4e40" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">只需键入<code class="du nb nc nd mk b">screen</code>即可开始新的会话。</p><pre class="iw ix iy iz fd mj mk ml mm aw mn bi"><span id="b7e4" class="kt ku hh mk b fi mo mp l mq mr">screen</span></pre><p id="f629" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">现在在无浏览器模式下启动jupyter进程。</p><pre class="iw ix iy iz fd mj mk ml mm aw mn bi"><span id="5f2e" class="kt ku hh mk b fi mo mp l mq mr">jupyter-lab --no-browser</span></pre><figure class="iw ix iy iz fd jb er es paragraph-image"><div role="button" tabindex="0" class="jh ji di jj bf jk"><div class="er es ne"><img src="../Images/7f4cfcfb44e8ce08233d303eea247d90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qvc5Zgcvktkj01L1NXx4uA.png"/></div></div></figure><p id="06b1" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">IDE将可以在<code class="du nb nc nd mk b">https://&lt;public-ip&gt;:8888</code>访问。实例的公共IP地址可以在实例摘要页面上找到。浏览器可能会发出有关自签名证书的警告，这可以忽略。</p><figure class="iw ix iy iz fd jb er es paragraph-image"><div role="button" tabindex="0" class="jh ji di jj bf jk"><div class="er es mh"><img src="../Images/248623a9ce826a2661291106f5ce092b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l2Ld5meOpp6irpa0dOSd0A.png"/></div></div></figure><p id="5fbf" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">按<code class="du nb nc nd mk b">ctrl-a ctrl-d</code>脱离屏幕会话</p><p id="e635" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">运行<code class="du nb nc nd mk b">screen -r</code>重新连接到会话。</p><p id="4481" class="pw-post-body-paragraph jw jx hh jy b jz ka ii kb kc kd il ke kf kg kh ki kj kk kl km kn ko kp kq kr ha bi translated">如果我犯了什么错误，请留下评论。希望这有所帮助！</p></div></div>    
</body>
</html>