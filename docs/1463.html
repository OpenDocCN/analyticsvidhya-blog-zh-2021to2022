<html>
<head>
<title>Image Classification Using Machine Learning-Support Vector Machine(SVM)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习-支持向量机(SVM)的图像分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/image-classification-using-machine-learning-support-vector-machine-svm-dc7a0ec92e01?source=collection_archive---------0-----------------------#2021-03-03">https://medium.com/analytics-vidhya/image-classification-using-machine-learning-support-vector-machine-svm-dc7a0ec92e01?source=collection_archive---------0-----------------------#2021-03-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="f0a6" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">计算机编程语言</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/171dcd652b92b21dd2aa676198761049.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*MyGC1A2sRgOiDoEVpD7nmg.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">照片来源:分析Vidhya</figcaption></figure><h1 id="ffd9" class="jn jo hi bd jp jq jr js jt ju jv jw jx io jy ip jz ir ka is kb iu kc iv kd ke bi translated">介绍</h1><p id="93ee" class="pw-post-body-paragraph kf kg hi kh b ki kj ij kk kl km im kn ko kp kq kr ks kt ku kv kw kx ky kz la hb bi translated"><strong class="kh hj">机器学习</strong>是人工智能的一种应用，它允许计算机以自我学习的模式运行，而无需显式编程。这是一个非常有趣和复杂的话题，可能会推动技术的未来。</p><p id="0091" class="pw-post-body-paragraph kf kg hi kh b ki lb ij kk kl lc im kn ko ld kq kr ks le ku kv kw lf ky kz la hb bi translated">机器学习有很多应用，图像分类就是其中之一。为了分类图像，这里我们使用SVM。Scikit-learn是一个用于Python编程语言的免费软件机器学习库，支持向量机(SVM)包含在Scikit-learn中。</p><h1 id="e131" class="jn jo hi bd jp jq jr js jt ju jv jw jx io jy ip jz ir ka is kb iu kc iv kd ke bi translated">使用的工具</h1><p id="68dc" class="pw-post-body-paragraph kf kg hi kh b ki kj ij kk kl km im kn ko kp kq kr ks kt ku kv kw kx ky kz la hb bi translated">→ Python语法<br/> →用于数据帧的熊猫库<br/> →来自sklearn(又名scikit-learn)库的支持向量机(SVM)<br/>→GridSearchCV<br/>→用于读取图像的浏览库<br/> →用于可视化目的的matplotlib</p><p id="de62" class="pw-post-body-paragraph kf kg hi kh b ki lb ij kk kl lc im kn ko ld kq kr ks le ku kv kw lf ky kz la hb bi translated">首先，让我们理解概念并深入编码部分😉</p><h1 id="b491" class="jn jo hi bd jp jq jr js jt ju jv jw jx io jy ip jz ir ka is kb iu kc iv kd ke bi translated"><strong class="ak">支持向量机(SVM) </strong></h1><p id="04a5" class="pw-post-body-paragraph kf kg hi kh b ki kj ij kk kl km im kn ko kp kq kr ks kt ku kv kw kx ky kz la hb bi translated">“支持向量机”(SVM)是一种受监督的机器学习算法，可用于分类或回归挑战。但多用于分类问题。在这个SVM算法中，我们将每个数据项绘制为n维空间中的一个点(其中n是您拥有的要素的数量)，每个要素的值是特定坐标的值。然后，我们通过找到能够很好地区分这两类的超平面来执行分类。</p><p id="99bb" class="pw-post-body-paragraph kf kg hi kh b ki lb ij kk kl lc im kn ko ld kq kr ks le ku kv kw lf ky kz la hb bi translated">SVM中的一些关键参数是:<br/> → <strong class="kh hj"> Gamma </strong>:定义单个训练样本的影响达到导致有偏差结果的值的程度。</p><p id="8204" class="pw-post-body-paragraph kf kg hi kh b ki lb ij kk kl lc im kn ko ld kq kr ks le ku kv kw lf ky kz la hb bi translated"><strong class="kh hj"> → C : </strong>控制误算成本<br/>小C —使误分类成本低<br/>大C —使误分类成本高</p><p id="04e4" class="pw-post-body-paragraph kf kg hi kh b ki lb ij kk kl lc im kn ko ld kq kr ks le ku kv kw lf ky kz la hb bi translated">→ <strong class="kh hj">内核:</strong> SVM算法使用一组被定义为内核的数学函数。<br/>核的类型有:线性、RBF(径向基函数)、多项式核</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lg"><img src="../Images/53c18bef9262c09508891fa9436407f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8gHyI87HnqkFlJss"/></div></div></figure><p id="6941" class="pw-post-body-paragraph kf kg hi kh b ki lb ij kk kl lc im kn ko ld kq kr ks le ku kv kw lf ky kz la hb bi translated">更多关于SVM的信息可以从<a class="ae lh" href="https://scikit-learn.org/stable/modules/svm.html" rel="noopener ugc nofollow" target="_blank">这里</a>了解。</p><h1 id="19f8" class="jn jo hi bd jp jq jr js jt ju jv jw jx io jy ip jz ir ka is kb iu kc iv kd ke bi translated"><strong class="ak">电脑是如何读取图像的？🤔</strong></h1><p id="9df5" class="pw-post-body-paragraph kf kg hi kh b ki kj ij kk kl km im kn ko kp kq kr ks kt ku kv kw kx ky kz la hb bi translated">图像分类的主要任务是读取输入图像，计算机看到的图像完全不同:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es li"><img src="../Images/7d45dd173da28f4f45cf7b892d4c72d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*ttEmWuGZmMYmnuChbuN4oA.png"/></div></figure><p id="6a54" class="pw-post-body-paragraph kf kg hi kh b ki lb ij kk kl lc im kn ko ld kq kr ks le ku kv kw lf ky kz la hb bi translated">计算机将图像视为像素阵列，如果图像的大小为200 X 200，则阵列的大小将为200 X 200 X 3，其中第一个200是宽度，第二个200是高度，接下来的3个是RGB通道值。数组中的值范围从0到255，描述了每个点的像素亮度。</p><h1 id="8d9e" class="jn jo hi bd jp jq jr js jt ju jv jw jx io jy ip jz ir ka is kb iu kc iv kd ke bi translated"><strong class="ak"> GridSearchCV </strong></h1><p id="79b4" class="pw-post-body-paragraph kf kg hi kh b ki kj ij kk kl km im kn ko kp kq kr ks kt ku kv kw kx ky kz la hb bi translated">它是一个库函数，是sklearn的model_selection包的成员。它有助于遍历预定义的超参数，并使您的估计器(模型)适合您的训练集。因此，最后，您可以从列出的超参数中选择最佳参数。</p><p id="2e51" class="pw-post-body-paragraph kf kg hi kh b ki lb ij kk kl lc im kn ko ld kq kr ks le ku kv kw lf ky kz la hb bi translated">理论讲够了，我们从编码部分开始。</p><h1 id="9ee8" class="jn jo hi bd jp jq jr js jt ju jv jw jx io jy ip jz ir ka is kb iu kc iv kd ke bi translated"><strong class="ak">流程</strong></h1><p id="2a4b" class="pw-post-body-paragraph kf kg hi kh b ki kj ij kk kl km im kn ko kp kq kr ks kt ku kv kw kx ky kz la hb bi translated">通过输入数据和期望输出数据训练模型是机器学习的方式之一。<br/>要创建这样一个模型，必须经历以下几个阶段:</p><p id="c76f" class="pw-post-body-paragraph kf kg hi kh b ki lb ij kk kl lc im kn ko ld kq kr ks le ku kv kw lf ky kz la hb bi translated">1.取输入<br/> 2。模型构造<br/> 3。模特培训<br/> 4。模型测试<br/> 5。模型评估</p><p id="8ca2" class="pw-post-body-paragraph kf kg hi kh b ki lb ij kk kl lc im kn ko ld kq kr ks le ku kv kw lf ky kz la hb bi translated"><strong class="kh hj">输入:</strong>读取3种不同类别的图像(汽车、冰淇淋蛋筒、板球),并按以下方式标记为0、1、2:</p><pre class="iy iz ja jb fd lj lk ll lm aw ln bi"><span id="05a0" class="lo jo hi lk b fi lp lq l lr ls">import pandas as pd<br/>import os<br/>from skimage.transform import resize<br/>from skimage.io import imread<br/>import numpy as np<br/>import matplotlib.pyplot as plt</span><span id="5f03" class="lo jo hi lk b fi lt lq l lr ls">Categories=['Cars','Ice cream cone','Cricket ball']</span><span id="1b11" class="lo jo hi lk b fi lt lq l lr ls">flat_data_arr=[] #input array</span><span id="c5cc" class="lo jo hi lk b fi lt lq l lr ls">target_arr=[] #output array</span><span id="8055" class="lo jo hi lk b fi lt lq l lr ls">datadir='/content/drive/MyDrive/ML' <br/>#path which contains all the categories of images</span><span id="af8d" class="lo jo hi lk b fi lt lq l lr ls">for i in Categories:<br/>    <br/>    print(f'loading... category : {i}')</span><span id="452d" class="lo jo hi lk b fi lt lq l lr ls">    path=os.path.join(datadir,i)</span><span id="623d" class="lo jo hi lk b fi lt lq l lr ls">    for img in os.listdir(path):</span><span id="e5eb" class="lo jo hi lk b fi lt lq l lr ls">        img_array=imread(os.path.join(path,img))</span><span id="67bf" class="lo jo hi lk b fi lt lq l lr ls">        img_resized=resize(img_array,(150,150,3))</span><span id="0616" class="lo jo hi lk b fi lt lq l lr ls">        flat_data_arr.append(img_resized.flatten())</span><span id="7e2b" class="lo jo hi lk b fi lt lq l lr ls">        target_arr.append(Categories.index(i))</span><span id="9785" class="lo jo hi lk b fi lt lq l lr ls">    print(f'loaded category:{i} successfully')</span><span id="8b67" class="lo jo hi lk b fi lt lq l lr ls">flat_data=np.array(flat_data_arr)</span><span id="4356" class="lo jo hi lk b fi lt lq l lr ls">target=np.array(target_arr)</span><span id="7915" class="lo jo hi lk b fi lt lq l lr ls">df=pd.DataFrame(flat_data) #dataframe</span><span id="d84a" class="lo jo hi lk b fi lt lq l lr ls">df['Target']=target</span><span id="8491" class="lo jo hi lk b fi lt lq l lr ls">x=df.iloc[:,:-1] #input data </span><span id="ef2b" class="lo jo hi lk b fi lt lq l lr ls">y=df.iloc[:,-1] #output data</span></pre><p id="5005" class="pw-post-body-paragraph kf kg hi kh b ki lb ij kk kl lc im kn ko ld kq kr ks le ku kv kw lf ky kz la hb bi translated">由于SVM接收相同大小的输入，所有图像在输入到SVM之前都需要<strong class="kh hj">调整</strong>到固定大小。df是使用pandas创建的数据帧，x和y分别是输入和输出数据</p><p id="06cf" class="pw-post-body-paragraph kf kg hi kh b ki lb ij kk kl lc im kn ko ld kq kr ks le ku kv kw lf ky kz la hb bi translated"><strong class="kh hj">模型构建:</strong>本项目案例中，模型为支持向量机。<br/>模型构建的算法是这样的:<br/> 1。创建支持向量分类器:<br/> → svc=svm。SVC() <br/> 2。借助GridSearchCV和参数网格，创建一个模型:→model=GridSearchCV(svc，parameters_grid)</p><pre class="iy iz ja jb fd lj lk ll lm aw ln bi"><span id="7925" class="lo jo hi lk b fi lp lq l lr ls">from sklearn import svm</span><span id="4c60" class="lo jo hi lk b fi lt lq l lr ls">from sklearn.model_selection import GridSearchCV</span><span id="61a8" class="lo jo hi lk b fi lt lq l lr ls">param_grid={'C':[0.1,1,10,100],'gamma':[0.0001,0.001,0.1,1],'kernel':['rbf','poly']}</span><span id="3ee8" class="lo jo hi lk b fi lt lq l lr ls">svc=svm.SVC(probability=True)</span><span id="cbd5" class="lo jo hi lk b fi lt lq l lr ls">model=GridSearchCV(svc,param_grid)</span></pre><p id="335c" class="pw-post-body-paragraph kf kg hi kh b ki lb ij kk kl lc im kn ko ld kq kr ks le ku kv kw lf ky kz la hb bi translated"><strong class="kh hj">模型训练:</strong>数据分为两类:训练数据和测试数据。训练数据用于训练模型，而测试数据用于测试训练好的模型。<br/>为了将数据分割成训练和测试，使用来自sklearn库的<strong class="kh hj"> train_test_split() </strong>。<br/>使用训练数据训练模型，方式如下<br/> → model.fit(training_data，expected_output)</p><pre class="iy iz ja jb fd lj lk ll lm aw ln bi"><span id="ffb7" class="lo jo hi lk b fi lp lq l lr ls">from sklearn.model_selection import train_test_split</span><span id="ab2f" class="lo jo hi lk b fi lt lq l lr ls">x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.20,random_state=77,stratify=y)</span><span id="40dc" class="lo jo hi lk b fi lt lq l lr ls">print('Splitted Successfully')</span><span id="c3f0" class="lo jo hi lk b fi lt lq l lr ls">model.fit(x_train,y_train)</span><span id="cf96" class="lo jo hi lk b fi lt lq l lr ls">print('The Model is trained well with the given images')</span><span id="9759" class="lo jo hi lk b fi lt lq l lr ls"># model.best_params_ contains the best parameters obtained from GridSearchCV</span></pre><p id="2400" class="pw-post-body-paragraph kf kg hi kh b ki lb ij kk kl lc im kn ko ld kq kr ks le ku kv kw lf ky kz la hb bi translated"><strong class="kh hj">模型测试:</strong>现在使用测试数据以这种方式测试模型<br/>→Model . predict(testing _ data)</p><p id="41e8" class="pw-post-body-paragraph kf kg hi kh b ki lb ij kk kl lc im kn ko ld kq kr ks le ku kv kw lf ky kz la hb bi translated">可以使用来自sklearn.metrics的<strong class="kh hj"> accuracy_score() </strong>方法来计算模型的准确性</p><pre class="iy iz ja jb fd lj lk ll lm aw ln bi"><span id="7f89" class="lo jo hi lk b fi lp lq l lr ls">y_pred=model.predict(x_test)</span><span id="01fe" class="lo jo hi lk b fi lt lq l lr ls">print("The predicted Data is :")</span><span id="c966" class="lo jo hi lk b fi lt lq l lr ls">print(y_pred)</span><span id="209f" class="lo jo hi lk b fi lt lq l lr ls">print("The actual data is:")</span><span id="cc82" class="lo jo hi lk b fi lt lq l lr ls">print(np.array(y_test))</span><span id="b9a9" class="lo jo hi lk b fi lt lq l lr ls">print(f"The model is {accuracy_score(y_pred,y_test)*100}% accurate")</span></pre><p id="cab0" class="pw-post-body-paragraph kf kg hi kh b ki lb ij kk kl lc im kn ko ld kq kr ks le ku kv kw lf ky kz la hb bi translated">最后，在<strong class="kh hj">模型评估</strong>阶段，生成的模型可用于评估新数据。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lu"><img src="../Images/8eae1c6aa5ebfeb2b08e741e63e16578.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*rAbCk0T4rksShBcPQjWC0A.gif"/></div></div></figure><pre class="iy iz ja jb fd lj lk ll lm aw ln bi"><span id="8415" class="lo jo hi lk b fi lp lq l lr ls">url=input('Enter URL of Image :')</span><span id="e9c6" class="lo jo hi lk b fi lt lq l lr ls">img=imread(url)</span><span id="25f9" class="lo jo hi lk b fi lt lq l lr ls">plt.imshow(img)</span><span id="a290" class="lo jo hi lk b fi lt lq l lr ls">plt.show()</span><span id="62fa" class="lo jo hi lk b fi lt lq l lr ls">img_resize=resize(img,(150,150,3))</span><span id="4f89" class="lo jo hi lk b fi lt lq l lr ls">l=[img_resize.flatten()]</span><span id="3dc2" class="lo jo hi lk b fi lt lq l lr ls">probability=model.predict_proba(l)</span><span id="c91a" class="lo jo hi lk b fi lt lq l lr ls">for ind,val in enumerate(Categories):</span><span id="2761" class="lo jo hi lk b fi lt lq l lr ls">    print(f'{val} = {probability[0][ind]*100}%')</span><span id="a4ad" class="lo jo hi lk b fi lt lq l lr ls">print("The predicted image is : "+Categories[model.predict(l)[0]])</span></pre><p id="0ee4" class="pw-post-body-paragraph kf kg hi kh b ki lb ij kk kl lc im kn ko ld kq kr ks le ku kv kw lf ky kz la hb bi translated">最终输出将是这样的:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lv"><img src="../Images/7c44ab4f5d166634734cd1f8364ba7c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*MwoVOO8PkAKBHrR7uIyoBg.png"/></div></figure><p id="f3b5" class="pw-post-body-paragraph kf kg hi kh b ki lb ij kk kl lc im kn ko ld kq kr ks le ku kv kw lf ky kz la hb bi translated">这个项目的全部代码可以在:<br/><a class="ae lh" href="https://github.com/ShanmukhVegi/Image-Classification" rel="noopener ugc nofollow" target="_blank">https://github.com/ShanmukhVegi/Image-Classification</a>找到</p><h1 id="6ad3" class="jn jo hi bd jp jq jr js jt ju jv jw jx io jy ip jz ir ka is kb iu kc iv kd ke bi translated"><strong class="ak">结论:</strong></h1><p id="add6" class="pw-post-body-paragraph kf kg hi kh b ki kj ij kk kl km im kn ko kp kq kr ks kt ku kv kw kx ky kz la hb bi translated">在这项工作中，我组装并训练了SVM模型来分类冰淇淋甜筒、板球和汽车的图像。我使用GridSearchCV找出了SVM分类图像的最佳参数，并测量了模型的准确性。</p><h1 id="e4ec" class="jn jo hi bd jp jq jr js jt ju jv jw jx io jy ip jz ir ka is kb iu kc iv kd ke bi translated"><strong class="ak">资源:</strong></h1><div class="lw lx ez fb ly lz"><a href="https://scikit-learn.org/stable/modules/svm.html" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab dw"><div class="mb ab mc cl cj md"><h2 class="bd hj fi z dy me ea eb mf ed ef hh bi translated">1.4.支持向量机-sci kit-学习0.24.1文档</h2><div class="mg l"><h3 class="bd b fi z dy me ea eb mf ed ef dx translated">在高维空间有效。在维数大于…的情况下仍然有效</h3></div><div class="mh l"><p class="bd b fp z dy me ea eb mf ed ef dx translated">scikit-learn.org</p></div></div><div class="mi l"><div class="mj l mk ml mm mi mn jh lz"/></div></div></a></div><div class="lw lx ez fb ly lz"><a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab dw"><div class="mb ab mc cl cj md"><h2 class="bd hj fi z dy me ea eb mf ed ef hh bi translated">sklearn.model_selection。GridSearchCV-scikit-学习0.24.1文档</h2><div class="mg l"><h3 class="bd b fi z dy me ea eb mf ed ef dx translated">对估计量的特定参数值进行穷举搜索。重要成员是适合的，预测。GridSearchCV…</h3></div><div class="mh l"><p class="bd b fp z dy me ea eb mf ed ef dx translated">scikit-learn.org</p></div></div><div class="mi l"><div class="mo l mk ml mm mi mn jh lz"/></div></div></a></div><div class="lw lx ez fb ly lz"><a href="https://scikit-learn.org/stable/modules/grid_search.html" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab dw"><div class="mb ab mc cl cj md"><h2 class="bd hj fi z dy me ea eb mf ed ef hh bi translated">3.2.调整估计器的超参数-sci kit-了解0.24.1文档</h2><div class="mg l"><h3 class="bd b fi z dy me ea eb mf ed ef dx translated">超参数是在估计器中不直接学习的参数。在scikit-learn中，它们被作为…</h3></div><div class="mh l"><p class="bd b fp z dy me ea eb mf ed ef dx translated">scikit-learn.org</p></div></div><div class="mi l"><div class="mp l mk ml mm mi mn jh lz"/></div></div></a></div></div></div>    
</body>
</html>