<html>
<head>
<title>Building a Recommendation System with Turi Create</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Turi Create构建推荐系统</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/building-a-recommendation-system-with-turi-create-938be5fea671?source=collection_archive---------2-----------------------#2021-05-23">https://medium.com/analytics-vidhya/building-a-recommendation-system-with-turi-create-938be5fea671?source=collection_archive---------2-----------------------#2021-05-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/604a16ca9df4e93e1bd62a94efcf2b6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*F9Cb_7u4X5RXVbwM.png"/></div></div></figure><p id="9781" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在你的机器学习/数据科学之旅中，你会希望(或被要求)使用数据来提出建议。在当今世界，推荐无处不在——看什么，买什么，甚至去哪里度假。像网飞和亚马逊这样的公司有几个人致力于确保你在他们的网站上增加时间或购买量，准确地推荐你会喜欢的产品。但是，如果你想在你的应用或网站中加入推荐，但没有资源来构建复杂的算法或雇佣大量的数据科学家，该怎么办呢？这就是<a class="ae jo" href="https://apple.github.io/turicreate/docs/userguide/" rel="noopener ugc nofollow" target="_blank">图里创造</a>的用武之地。</p><p id="5053" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Turi Create是一个开源解决方案，简化了机器学习模型的开发。Turi提供了<a class="ae jo" href="https://apple.github.io/turicreate/docs/userguide/applications/" rel="noopener ugc nofollow" target="_blank">工具包</a>，用于图像分类、对象检测、文本分类和其他一些工具。这篇文章将重点介绍如何实现<a class="ae jo" href="https://apple.github.io/turicreate/docs/userguide/applications/" rel="noopener ugc nofollow" target="_blank">推荐系统</a>。Turi Create是为Python构建的。r用户可以查看<a class="ae jo" href="https://data-flair.training/blogs/data-science-r-movie-recommendation/" rel="noopener ugc nofollow" target="_blank">这篇</a>教程。</p><h1 id="75c8" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">入门指南</h1><p id="8381" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">Turi Create可通过<a class="ae jo" href="https://pypi.org/project/turicreate/" rel="noopener ugc nofollow" target="_blank"> PyPI </a>进行安装。目前支持MacOS和Linux。Windows用户必须安装WSL才能使用Turi Create(查看<a class="ae jo" href="https://blog.usejournal.com/installing-turicreate-on-windows-10-534e147a4792" rel="noopener ugc nofollow" target="_blank">这篇</a>帖子获取指导)。如果你不想安装WSL(或者如果你只想使用基于云的笔记本)，使用<a class="ae jo" href="https://colab.research.google.com/notebooks/intro.ipynb" rel="noopener ugc nofollow" target="_blank"> Google Colab </a>是一个很好的选择。如果您使用的是MacOS、Linux或WSL，请在您的终端中运行<code class="du ks kt ku kv b">pip install turicreate</code>。如果你在Google Colab工作，在代码单元格中运行<code class="du ks kt ku kv b">!pip install turicreate</code>。现在，您可以运行一些推荐了。</p><h1 id="cb2d" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">初始推荐者</h1><p id="1800" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">在这个练习中，我们将使用Kaggle上的<a class="ae jo" href="https://www.kaggle.com/grouplens/movielens-20m-dataset" rel="noopener ugc nofollow" target="_blank"> MovieLens 20M </a>数据集。将电影和分级文件合并成一个数据帧。将合并后的数据帧转换为csv格式可以轻松地在多个笔记本会话中重新加载数据，而不必每次都重新运行合并代码。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="1b04" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">导入Turi创建并加载数据。数据存储在<a class="ae jo" href="https://apple.github.io/turicreate/docs/api/generated/turicreate.SFrame.html#turicreate.SFrame" rel="noopener ugc nofollow" target="_blank"> SFrames </a>中，可扩展的数据帧可以扩展到大数据。建议将数据分为训练数据集和测试数据集。这在比较模型时会很有帮助，因为我们希望用新数据来衡量性能，而这些数据在训练期间是看不到的。<a class="ae jo" href="https://apple.github.io/turicreate/docs/api/turicreate.toolkits.recommender.html" rel="noopener ugc nofollow" target="_blank">推荐工具包</a>包含创建、训练和评估模型性能所需的所有方法和实用程序。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="15e7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，您可以使用训练数据集运行您的初始推荐模型了。该模型被设置为根据用户对他们所看过的电影的评级来预测每个用户的电影标题。默认情况下，<code class="du ks kt ku kv b">recommender.create</code>为所有用户提供前10个推荐，不包括用户已评价的电影。该默认模式还根据提供的数据(显式数据和隐式数据)选择在后台使用的模型和指标(RMSE和精确召回)。因为提供了目标值，所以我们使用的数据是明确的。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/503f6c166f5245c8ccb69a87ef33856f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PeoqHsMi0gGkeHFQqJXMVA.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">对一个用户的建议</figcaption></figure><h1 id="12f8" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">做预测</h1><p id="83ab" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">运行<code class="du ks kt ku kv b">model.recommend()</code>将为所有用户提供推荐。然而，我们也可以对特定用户进行预测。Turi Create默认只打印SFrame的头部。<code class="du ks kt ku kv b">print_rows</code>实用程序允许你选择打印多少行和列。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><figure class="kw kx ky kz fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lh"><img src="../Images/e3b3a1385ad5f68d298279a5528622b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4ABbr5-QLNsgSAlxqcIyQQ.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">对3名用户的建议</figcaption></figure><p id="ecce" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您还可以通过提供数据集中不包含的用户ID来预测新用户。在这种情况下，Turi Create将推荐最受欢迎的电影，因为它没有新用户的评级作为推荐的基础。如果您想要多于或少于缺省值10，您还可以指定显示多少个推荐。此外，您还可以选择包含用户已经评分的项目。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><p id="5bc4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦您对模型的预测感到满意，就可以保存它。这将允许您在应用程序中使用它，或者重新加载它以供进一步研究。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure></div><div class="ab cl li lj gp lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hb hc hd he hf"><h1 id="fbac" class="jp jq hi bd jr js lp ju jv jw lq jy jz ka lr kc kd ke ls kg kh ki lt kk kl km bi translated">选择模型</h1><p id="3b7a" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">默认的<code class="du ks kt ku kv b">recommender.create</code>方法为您选择一个模型，并且是实现Turi Create的最简单的方法。但是，对于那些想自己选择型号的人，我们提供了一些选项。我将提供一些模型选择的例子，但是在<a class="ae jo" href="https://apple.github.io/turicreate/docs/userguide/recommender/choosing-a-model.html" rel="noopener ugc nofollow" target="_blank">文档</a>中可以找到关于实施和边数据使用的全部细节。</p><p id="b8ba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们应该根据用户对电影《T3》的评价预测来推荐，还是根据用户是否会给电影一个高评价来推荐《T4》？这两种情况看起来非常相似，但一种本质上是回归，而另一种是分类，每种情况都需要选择不同的模型。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><div class="kw kx ky kz fd ab cb"><figure class="lv ij lw lx ly lz ma paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/ed064d5ffeabd80b62c6293c6694146f.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*wN6NY7dsusjPR9bUlIDsRg.png"/></div></figure><figure class="lv ij mb lx ly lz ma paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/6016c0767d3701b581a94b712b2836b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*IDKw7U-eTACXkxpsXa7OsQ.png"/></div><figcaption class="ld le et er es lf lg bd b be z dx mc di md me translated">左图显示了因式分解的结果。右图显示了相同用户的项目相似性建议。</figcaption></figure></div><p id="abb3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">也可以选择排名因式分解。该模型还旨在预测用户是否会对电影给予高度评价。然而，它的预测是基于用户给予高评级的相似项目<strong class="is hj">和</strong>电影。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure><figure class="kw kx ky kz fd ij er es paragraph-image"><div class="er es mf"><img src="../Images/b413c9d56b4f6568076c9352c5063ac6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*Ve7vz4sNB9dG6OaNvbeRgA.png"/></div><figcaption class="ld le et er es lf lg bd b be z dx translated">排名因子分解模型的建议</figcaption></figure><h1 id="bbec" class="jp jq hi bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">比较模型</h1><p id="38f6" class="pw-post-body-paragraph iq ir hi is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hb bi translated">那么，你应该为你的推荐应用选择哪种模式呢？谢天谢地，Turi Create提供了一个方便的<a class="ae jo" href="https://apple.github.io/turicreate/docs/api/generated/turicreate.recommender.util.compare_models.html#turicreate.recommender.util.compare_models" rel="noopener ugc nofollow" target="_blank">实用程序</a>来帮助你做决定。由于我们的数据包括目标值(评级)，我们的模型将根据均方根误差(<a class="ae jo" href="https://www.statisticshowto.com/probability-and-statistics/regression-analysis/rmse-root-mean-square-error/" rel="noopener ugc nofollow" target="_blank"> RMSE </a>)进行评分。目标是最小化RMSE。在我们的例子中，因式分解的RMSE最低(0.9701)，排名因式分解次之，为0.9963。项目相似性模型的总体RMSE为3.6175。虽然排名因子分解模型没有最低的RMSE，但它仍然是一个可行的选择，因为它同时考虑了相似性和用户评级。您的选择将取决于您的具体应用和用于预测的数据。</p><figure class="kw kx ky kz fd ij"><div class="bz dy l di"><div class="la lb l"/></div></figure></div><div class="ab cl li lj gp lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="hb hc hd he hf"><p id="5eb1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这大概就是Turi创建推荐的快速实现。<a class="ae jo" href="https://apple.github.io/turicreate/docs/userguide/recommender/coreml-deployment.html" rel="noopener ugc nofollow" target="_blank">有关如何将Turi Create添加到MacOS或iOS应用程序的说明</a>。让我们总结一下Turi Create的优缺点。</p><p id="20f1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">优点:</strong></p><ol class=""><li id="cd1c" class="mg mh hi is b it iu ix iy jb mi jf mj jj mk jn ml mm mn mo bi translated">非常适合将机器学习解决方案添加到您的项目中，而无需从头开始。</li><li id="70a6" class="mg mh hi is b it mp ix mq jb mr jf ms jj mt jn ml mm mn mo bi translated">文档布局清晰，易于理解和实施。</li><li id="6ec0" class="mg mh hi is b it mp ix mq jb mr jf ms jj mt jn ml mm mn mo bi translated">它为最常见的机器学习需求提供解决方案。</li></ol><p id="5064" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">缺点:</strong></p><ol class=""><li id="532f" class="mg mh hi is b it iu ix iy jb mi jf mj jj mk jn ml mm mn mo bi translated">您无法控制模型的定制。</li><li id="0806" class="mg mh hi is b it mp ix mq jb mr jf ms jj mt jn ml mm mn mo bi translated">需要WSL安装才能在Windows上使用(使用Google Colab来解决这个问题)。</li><li id="794e" class="mg mh hi is b it mp ix mq jb mr jf ms jj mt jn ml mm mn mo bi translated">目前不支持Python的R或最新版本(MacOS最高3.7，其他3.6)。</li><li id="6357" class="mg mh hi is b it mp ix mq jb mr jf ms jj mt jn ml mm mn mo bi translated">在应用程序中部署模型目前仅适用于MacOS和iOS。</li></ol><p id="9682" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">总之，Turi Create是一个易于使用的ML解决方案，但是和其他工具一样，你需要权衡利弊，确定它是否适合你。这次探险的笔记本可以在<a class="ae jo" href="https://github.com/ngachago/movie_recs" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p></div></div>    
</body>
</html>