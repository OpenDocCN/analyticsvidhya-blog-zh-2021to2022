<html>
<head>
<title>Using t-SNE for Data Visualisation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用t-SNE进行数据可视化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/using-t-sne-for-data-visualisation-8a83f46fbad3?source=collection_archive---------1-----------------------#2021-09-13">https://medium.com/analytics-vidhya/using-t-sne-for-data-visualisation-8a83f46fbad3?source=collection_archive---------1-----------------------#2021-09-13</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f4a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个简单的例子，说明如何使用t-SNE来可视化数据。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/89378eed74059658c2f23eda86f69e2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Hr9azw6Yhp3YC_Hh"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">照片由<a class="ae jt" href="https://unsplash.com/@diana_h?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">戴安娜H </a>在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure></div><div class="ab cl ju jv gp jw" role="separator"><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz ka"/><span class="jx bw bk jy jz"/></div><div class="hb hc hd he hf"><p id="2cd6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi kb translated"><span class="l kc kd ke bm kf kg kh ki kj di"> T </span>这篇文章的目的不是教你如何<strong class="ih hj"/><a class="ae jt" href="https://en.wikipedia.org/wiki/T-distributed_stochastic_neighbor_embedding" rel="noopener ugc nofollow" target="_blank"><strong class="ih hj">T-SNE(T-分布式随机邻居嵌入)</strong> </a> <strong class="ih hj"> </strong>工作，而是教你如何使用它来帮助你可视化数据。t-SNE背后的主要思想是，在降低维数的过程中，它试图保持相似的观察值接近，而不相似的观察值分开。让我们看看这种降维技术如何帮助我们看到实例的集群。</p><h2 id="5782" class="kk kl hi bd km kn ko kp kq kr ks kt ku iq kv kw kx iu ky kz la iy lb lc ld le bi translated"><strong class="ak">所需库</strong></h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="8180" class="kk kl hi lg b fi lk ll l lm ln">import matplotlib.pyplot as plt<br/>import numpy as np<br/>import pandas as pd<br/>import seaborn as sns</span><span id="1421" class="kk kl hi lg b fi lo ll l lm ln">from sklearn import datasets<br/>from sklearn import manifold</span></pre><h1 id="ddfe" class="lp kl hi bd km lq lr ls kq lt lu lv ku lw lx ly kx lz ma mb la mc md me ld mf bi translated">资料组</h1><p id="8b8f" class="pw-post-body-paragraph if ig hi ih b ii mg ik il im mh io ip iq mi is it iu mj iw ix iy mk ja jb jc hb bi translated">对于这个例子，我们将使用时尚MNIST数据集。该数据集由70，000幅(28x28)灰度图像组成，与来自10个不同类别的标签相关联。</p><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="772c" class="kk kl hi lg b fi lk ll l lm ln"># load dataset<br/>data = datasets.fetch_openml(<br/>    'Fashion-MNIST',<br/>    version=1,<br/>    return_X_y=True<br/>)</span><span id="67bf" class="kk kl hi lg b fi lo ll l lm ln"># data returns a tuple (features, target)<br/>features, target = data<br/>target = target.astype(int)</span></pre><h2 id="2e3e" class="kk kl hi bd km kn ko kp kq kr ks kt ku iq kv kw kx iu ky kz la iy lb lc ld le bi translated"><strong class="ak"> <em class="ml">绘制样本图像</em> </strong></h2><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="6294" class="kk kl hi lg b fi lk ll l lm ln"># reshape the features for plotting image<br/>image = features.iloc[0].values.reshape(28, 28)<br/>plt.imshow(image, cmap='gray')</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mm"><img src="../Images/c6aa066d88f27e24278de094ee4d325f.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*vgD__fNus95EiosEyRXzPA.png"/></div></figure><h1 id="c6ba" class="lp kl hi bd km lq lr ls kq lt lu lv ku lw lx ly kx lz ma mb la mc md me ld mf bi translated">应用t-SNE</h1><p id="b7e0" class="pw-post-body-paragraph if ig hi ih b ii mg ik il im mh io ip iq mi is it iu mj iw ix iy mk ja jb jc hb bi translated">我们将减少特征的维度，并在最终的绘图上使用目标进行以后的识别。有784个特征代表(28 x 28)图像上的每个像素。在这种情况下，降维就派上了用场。基本上，我们将使用的功能作为一个无人监管的数据集。</p><p id="2bcc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以使用t-SNE将特征简化为两个部分。注意，在这个例子中只选择了30，000行。</p><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="4b93" class="kk kl hi lg b fi lk ll l lm ln"># dimensionality reduction using t-SNE<br/>tsne = manifold.TSNE(n_components=2, random_state=42)</span><span id="5f8a" class="kk kl hi lg b fi lo ll l lm ln"># fit and transform<br/>mnist_tr = tsne.fit_transform(features[:30000])</span><span id="216c" class="kk kl hi lg b fi lo ll l lm ln"># transformed_data is a 2D numpy array of shape (30000, 2)</span></pre><p id="39e8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了更好地操作数据并使用Seaborn绘制数据，让我们使用transformed_data和目标创建一个数据框架:</p><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="c1bf" class="kk kl hi lg b fi lk ll l lm ln"># create dataframe<br/>cps_df = pd.DataFrame(columns=['CP1', 'CP2', 'target'],<br/>                       data=np.column_stack((mnist_tr, <br/>                                            target.iloc[:30000])))</span><span id="17fb" class="kk kl hi lg b fi lo ll l lm ln"># cast targets column to int<br/>cps_df.loc[:, 'target'] = cps_df.target.astype(int)</span><span id="7d0b" class="kk kl hi lg b fi lo ll l lm ln">cps_df.head()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mn"><img src="../Images/fc9a1599a06ae0b2c8aa48ad20c6cdfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*nS5Ad15BFvN_bvIJMJt9qA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">t-SNE组件</figcaption></figure><p id="7e29" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们可以将目标标签映射到它们所代表的实际服装上，以便进行绘制</p><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="3670" class="kk kl hi lg b fi lk ll l lm ln">clothes_map = {0:'T-shirt/top',<br/>               1: 'Trouser',<br/>               2: 'Pullover',<br/>               3: 'Dress',<br/>               4: 'Coat',<br/>               5: 'Sandal',<br/>               6: 'Shirt',<br/>               7: 'Sneaker',<br/>               8: 'Bag',<br/>               9: 'Ankle Boot'}</span><span id="1b30" class="kk kl hi lg b fi lo ll l lm ln"># map targets to actual clothes for plotting<br/>cps_df.loc[:, 'target'] = cps_df.target.map(clothes_map)</span></pre><p id="f6f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们检查一下目标的分布:</p><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="2b18" class="kk kl hi lg b fi lk ll l lm ln">cps_df.target.value_counts().plot(kind='bar')</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mo"><img src="../Images/8a2513f33d77eafb879f27ea59b75a59.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*S_LT5cTM_KoeeIV9BuXIOw.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mp"><img src="../Images/8e3bd5f953fc2c1b5d1468563bc3a297.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*Ms1KXUCLfiFtzRqk2cjDWg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">条形图时尚-MNIST目标类</figcaption></figure><h1 id="a263" class="lp kl hi bd km lq lr ls kq lt lu lv ku lw lx ly kx lz ma mb la mc md me ld mf bi translated">最终情节</h1><p id="3994" class="pw-post-body-paragraph if ig hi ih b ii mg ik il im mh io ip iq mi is it iu mj iw ix iy mk ja jb jc hb bi translated">最后，让我们画出组件并对目标进行颜色编码:</p><pre class="je jf jg jh fd lf lg lh li aw lj bi"><span id="0d94" class="kk kl hi lg b fi lk ll l lm ln">grid = sns.FacetGrid(cps_df, hue="target", size=8)</span><span id="ccdc" class="kk kl hi lg b fi lo ll l lm ln">grid.map(plt.scatter, 'CP1', 'CP2').add_legend()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mq"><img src="../Images/a8f9cb19f61d9e2023bd7550a8244599.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9sY2OOhoIodE3b_3y_CJ8A.png"/></div></div></figure><p id="f403" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当它们更相似时(t恤和衬衫和外套和套头衫)，我们可以看到形成的主要簇和一些类相互重叠。此外，可以观察到大多数裤子类有更明显的区别。请注意鞋子如何更紧密地组合在一起，例如运动鞋和凉鞋。</p><p id="99c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">抓住机会，进一步探索这个伟大的学习数据集！尝试一些分类算法，并检查哪一个给你最好的准确性。</p><p id="de92" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读！</p></div></div>    
</body>
</html>