<html>
<head>
<title>Pandas For Beginners: Reshaping Dataframes (Part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">初学者的熊猫:重塑数据框架(第2部分)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pandas-for-beginners-reshaping-dataframes-part-2-e8ac212c0aec?source=collection_archive---------9-----------------------#2021-02-27">https://medium.com/analytics-vidhya/pandas-for-beginners-reshaping-dataframes-part-2-e8ac212c0aec?source=collection_archive---------9-----------------------#2021-02-27</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="ac92" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">将数据从长格式转换为宽格式</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/f051fb934aed124fff41af4dabbb1c57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*D-IxOH7bvqYa3eZk"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae jn" href="https://unsplash.com/@billow926?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">翻滚926 </a>拍照</figcaption></figure><p id="97ea" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在上一个教程中，我们演示了Pandas <strong class="jq hj"> <em class="kk"> melt </em> </strong>函数来将宽数据表单重塑为长表单。本教程将关注相反的过程。让所有人都站在同一立场上，展示我们试图解决的问题:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kl"><img src="../Images/dc8dfdc689d4d8255e3b6476f67c4f6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vq0s87-rxKho5jecDnN1TQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">从长到宽的形式(图片由用户提供)</figcaption></figure><p id="fed5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们大多数人在使用Microsoft excel时都经历过这样的场景。是的，宽大的桌子类似于著名的数据透视表。我们通常使用它们根据特定的维度(在我们的例子中是费用类别)来总结我们的数据。为了执行这些汇总任务，Pandas提供了一个现成的函数<strong class="jq hj"><em class="kk">【pivot _ table】</em></strong><em class="kk">。</em>实施该功能的逐步方法详述如下:</p><h1 id="8f5c" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">假设和建议</h1><p id="b52e" class="pw-post-body-paragraph jo jp hi jq b jr le ij jt ju lf im jw jx lg jz ka kb lh kd ke kf li kh ki kj hb bi translated">动手是掌握编程的关键。我们建议您在完成教程的过程中继续实现这些代码。<strong class="jq hj">样本数据</strong>和<strong class="jq hj">关联的木星笔记本</strong>在<a class="ae jn" href="https://github.com/dalmiaujjwal/Data_Wrangling_Tips_Tricks" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj">的<strong class="jq hj"> Scenario_3文件夹</strong>这个GitHub链接</strong> </a>中。</p><p id="91e1" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果你是GitHub新手，想学习它，请通过<a class="ae jn" href="https://towardsdatascience.com/must-know-tools-for-data-scientists-114d0b52b0a9" rel="noopener" target="_blank"> <strong class="jq hj"> <em class="kk">这篇</em> </strong> </a>教程。要在您的系统上建立一个新的Python环境，请阅读本教程。</p><p id="1bbc" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">以下是本教程中使用的Python概念和pandas函数/方法的列表:</p><h2 id="5d86" class="lj kn hi bd ko lk ll lm ks ln lo lp kw jx lq lr ky kb ls lt la kf lu lv lc lw bi translated">熊猫功能</h2><ul class=""><li id="0522" class="lx ly hi jq b jr le ju lf jx lz kb ma kf mb kj mc md me mf bi translated">阅读_csv</li><li id="a9f9" class="lx ly hi jq b jr mg ju mh jx mi kb mj kf mk kj mc md me mf bi translated">数据透视表_表格</li></ul><h1 id="fed3" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">我们开始吧</h1><h2 id="43ce" class="lj kn hi bd ko lk ll lm ks ln lo lp kw jx lq lr ky kb ls lt la kf lu lv lc lw bi translated">步骤1 —准备好数据</h2><p id="2f88" class="pw-post-body-paragraph jo jp hi jq b jr le ij jt ju lf im jw jx lg jz ka kb lh kd ke kf li kh ki kj hb bi translated">在本教程中，我们创建了一个虚拟数据集，其中包含一个家庭在2018年、2019年和2020年不同费用类别中发生的每月费用。这个数据集和样本数据快照的字典如下:</p><ul class=""><li id="d202" class="lx ly hi jq b jr js ju jv jx ml kb mm kf mn kj mc md me mf bi translated">年份—日历年</li><li id="e389" class="lx ly hi jq b jr mg ju mh jx mi kb mj kf mk kj mc md me mf bi translated">月份—一年中的月份</li><li id="6214" class="lx ly hi jq b jr mg ju mh jx mi kb mj kf mk kj mc md me mf bi translated">费用类别——家庭发生费用的类别</li><li id="3fba" class="lx ly hi jq b jr mg ju mh jx mi kb mj kf mk kj mc md me mf bi translated">费用值——家庭发生的费用值</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mo"><img src="../Images/f024ead76bd7ef13a44bb84f220c6f3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/1*fXE5m6YgyrzGejqnCFaBsw.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">样本数据(用户提供的图像)</figcaption></figure><h2 id="f1db" class="lj kn hi bd ko lk ll lm ks ln lo lp kw jx lq lr ky kb ls lt la kf lu lv lc lw bi translated">步骤2——用Python导入pandas包和数据集。</h2><p id="6d5c" class="pw-post-body-paragraph jo jp hi jq b jr le ij jt ju lf im jw jx lg jz ka kb lh kd ke kf li kh ki kj hb bi translated">一旦有了可用的数据，下一步就是将其导入到Python环境中。</p><pre class="iy iz ja jb fd mp mq mr ms aw mt bi"><span id="f1f9" class="lj kn hi mq b fi mu mv l mw mx"><strong class="mq hj">#### Sample Code<br/>#### Importing Pandas<br/></strong>import pandas as pd</span><span id="7aae" class="lj kn hi mq b fi my mv l mw mx"><strong class="mq hj">#### Importing Data File - Change the Windows Folder Location<br/></strong>imp_data = pd.read_csv("C:\\Ujjwal\\Analytics\\Git\\Scenario_3\\Expenses_Long.csv")</span></pre><p id="985c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们使用了Pandas <strong class="jq hj"> <em class="kk"> read_csv </em> </strong>函数来读取Python中的数据。</p><h2 id="bf9e" class="lj kn hi bd ko lk ll lm ks ln lo lp kw jx lq lr ky kb ls lt la kf lu lv lc lw bi translated">第3步—创建宽格式的费用表(没有汇总)。</h2><p id="8b39" class="pw-post-body-paragraph jo jp hi jq b jr le ij jt ju lf im jw jx lg jz ka kb lh kd ke kf li kh ki kj hb bi translated">一旦我们读取了数据，应用Pandas<strong class="jq hj"><em class="kk">pivot _ table</em></strong>函数来创建宽格式的输入数据帧。</p><pre class="iy iz ja jb fd mp mq mr ms aw mt bi"><span id="92a3" class="lj kn hi mq b fi mu mv l mw mx"><strong class="mq hj">#### Create the wide-form</strong><br/>Wide_data = pd.pivot_table(imp_data,index=["Year","Expense Category"], columns="Month",values = "Expense Value").reset_index()</span><span id="492d" class="lj kn hi mq b fi my mv l mw mx"><strong class="mq hj">#### Sample Output<br/></strong>Wide_data.head()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mz"><img src="../Images/bf7c089d524949b1d7de13d63fa94060.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZnAE3pWkgAwyTWhyIc4vUw.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">示例输出(图片由作者提供)</figcaption></figure><p id="c720" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">解释</strong></p><p id="497f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj"><em class="kk">pivot _ table</em></strong><em class="kk"/>函数需要以下参数作为输入:</p><ul class=""><li id="5e45" class="lx ly hi jq b jr js ju jv jx ml kb mm kf mn kj mc md me mf bi translated"><strong class="jq hj">数据帧名称</strong>—<em class="kk">pivot _ table</em>函数的第一个参数是我们必须应用操作的数据帧。</li><li id="3687" class="lx ly hi jq b jr mg ju mh jx mi kb mj kf mk kj mc md me mf bi translated"><strong class="jq hj">索引</strong> —与excel数据透视表的<strong class="jq hj">行部分同义。传递给<em class="kk">索引参数</em>的列名将构成最终数据帧的行。</strong></li><li id="1a39" class="lx ly hi jq b jr mg ju mh jx mi kb mj kf mk kj mc md me mf bi translated"><strong class="jq hj">列</strong> —这与excel数据透视表的<strong class="jq hj">列部分同义。传递给<em class="kk">列参数</em>的列名将构成最终数据帧的新列。</strong></li><li id="306d" class="lx ly hi jq b jr mg ju mh jx mi kb mj kf mk kj mc md me mf bi translated"><strong class="jq hj">值</strong> —与excel数据透视表的<strong class="jq hj">值部分同义。传递给<em class="kk">值参数</em>的列名将用于填充最终数据帧的单元格</strong></li></ul><p id="8750" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">点注</strong></p><ul class=""><li id="1222" class="lx ly hi jq b jr js ju jv jx ml kb mm kf mn kj mc md me mf bi translated"><strong class="jq hj"> reset_index() </strong> —我们已经使用了<strong class="jq hj"> <em class="kk"> reset_index </em> </strong>函数来删除pivot_table创建的多级索引。</li><li id="3f1f" class="lx ly hi jq b jr mg ju mh jx mi kb mj kf mk kj mc md me mf bi translated">为了<strong class="jq hj">将多个列</strong>传递给索引、列或值参数，<strong class="jq hj">以列表的形式使用它们</strong>。</li><li id="400c" class="lx ly hi jq b jr mg ju mh jx mi kb mj kf mk kj mc md me mf bi translated">就像<strong class="jq hj"> <em class="kk">融化</em> </strong>函数一样，<strong class="jq hj"> <em class="kk"> pivot_table </em> </strong>也返回一个新的旋转数据帧作为输出。将这个输出捕获到一个新的变量中(在我们的例子中是Wide_data ),以供将来使用。</li></ul><h1 id="2a74" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">结束语</h1><p id="b529" class="pw-post-body-paragraph jo jp hi jq b jr le ij jt ju lf im jw jx lg jz ka kb lh kd ke kf li kh ki kj hb bi translated">您知道数据透视表是Microsoft excel最常见的功能之一吗？在Python中快速实现数据争论步骤可以大大缩短我们的模型构建生命周期。我希望上面介绍的解决方案是有帮助的。</p><p id="753b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">你知道如何将数据转换成长格式时进行汇总吗？能否跨不同费用类别计算2018、2019、2020年每月平均费用？答案请查看<a class="ae jn" href="https://github.com/dalmiaujjwal/Data_Wrangling_Tips_Tricks" rel="noopener ugc nofollow" target="_blank"><strong class="jq hj"><em class="kk">GitHub</em></strong></a>资源库中提供的代码。</p><p id="98a8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">快乐学习！！！！</p></div></div>    
</body>
</html>