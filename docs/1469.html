<html>
<head>
<title>Attaching sensors and visualizing sensor data in Carla-viz</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Carla-viz中连接传感器并可视化传感器数据</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/attaching-sensors-and-visualizing-sensor-data-in-carla-viz-aa66af359caa?source=collection_archive---------6-----------------------#2021-03-03">https://medium.com/analytics-vidhya/attaching-sensors-and-visualizing-sensor-data-in-carla-viz-aa66af359caa?source=collection_archive---------6-----------------------#2021-03-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b1df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个博客是我之前的<a class="ae jd" rel="noopener" href="/analytics-vidhya/spawning-vehicles-in-carla-86429f767040">一个</a>的延续，我之前的博客是关于如何在卡拉的理想地点制造一辆车。我的目的只是帮助那些试图研究自动驾驶汽车的人，因为网上没有足够的资源。</p><p id="624b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，在这篇博客中，我们将在我们的车辆上安装不同的传感器，并在Carla-Viz中可视化这些传感器的输出。Carla-viz为Carla提供了一个可视化工具。你可以在这里从<a class="ae jd" href="https://carla.readthedocs.io/en/latest/plugins_carlaviz/" rel="noopener ugc nofollow" target="_blank">下载并阅读关于Carla-viz的内容。</a></p><p id="fd38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，你必须启动我之前文章中解释的卡拉模拟器。</p><p id="2a04" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们现在编码</p><pre class="je jf jg jh fd ji jj jk jl aw jm bi"><span id="7540" class="jn jo hi jj b fi jp jq l jr js">import glob<br/>import os<br/>import sys<br/>import time</span><span id="5ef7" class="jn jo hi jj b fi jt jq l jr js">try:<br/>    sys.path.append(glob.glob('./PythonAPI/carla/dist/carla-*%d.%d-%s.egg' % (<br/>        sys.version_info.major,<br/>        sys.version_info.minor,<br/>        'win-amd64' if os.name == 'nt' else 'linux-x86_64'))[0])<br/>except IndexError:<br/>    pass</span><span id="b04e" class="jn jo hi jj b fi jt jq l jr js">import carla</span><span id="129a" class="jn jo hi jj b fi jt jq l jr js">client = carla.Client('localhost', 2000)<br/>client.set_timeout(2.0)<br/>world = client.get_world()</span><span id="f439" class="jn jo hi jj b fi jt jq l jr js">blueprint_library = world.get_blueprint_library()<br/>bp = blueprint_library.filter('vehicle.*')[4]<br/>bp.set_attribute('role_name','ego')<br/>world = client.get_world()<br/>spawnPoint=carla.Transform(carla.Location(x=38.6,y=5.8, z=0.598),carla.Rotation(pitch=0.0, yaw=0.0, roll=0.000000))<br/>vehicle = world.spawn_actor(bp, spawnPoint)</span><span id="24bc" class="jn jo hi jj b fi jt jq l jr js">cam_bp = None<br/>cam_bp = world.get_blueprint_library().find('sensor.camera.rgb')<br/>cam_bp.set_attribute("image_size_x",str(180))<br/>cam_bp.set_attribute("image_size_y",str(180))<br/>cam_bp.set_attribute("fov",str(105))<br/>cam_location = carla.Location(2,0,2)<br/>cam_rotation = carla.Rotation(0,0,0)<br/>cam_transform = carla.Transform(cam_location,cam_rotation)<br/>ego_cam = world.spawn_actor(cam_bp,cam_transform,attach_to=vehicle, attachment_type=carla.AttachmentType.Rigid)<br/>#ego_cam.listen(lambda image: image.save_to_disk('tutorial/output/%.6d.jpg' % image.frame))</span><span id="c0dc" class="jn jo hi jj b fi jt jq l jr js">gnss_bp = world.get_blueprint_library().find('sensor.other.gnss')<br/>gnss_location = carla.Location(1,0,2)<br/>gnss_rotation = carla.Rotation(0,0,0)<br/>gnss_transform = carla.Transform(gnss_location,gnss_rotation)<br/>gnss = world.spawn_actor(gnss_bp,gnss_transform,attach_to=vehicle, attachment_type=carla.AttachmentType.Rigid)</span><span id="9c43" class="jn jo hi jj b fi jt jq l jr js">#Attaching Lidar</span><span id="8606" class="jn jo hi jj b fi jt jq l jr js">lidar_bp = world.get_blueprint_library().find('sensor.lidar.ray_cast')<br/>lidar_location = carla.Location(0,0,2.4)<br/>lidar_rotation = carla.Rotation(0,0,0)<br/>lidar_transform = carla.Transform(lidar_location,lidar_rotation)<br/>lidar =world.spawn_actor(lidar_bp,lidar_transform,attach_to=vehicle, attachment_type=carla.AttachmentType.Rigid)</span><span id="949b" class="jn jo hi jj b fi jt jq l jr js">time.sleep(40)<br/>vehicle.destroy()</span></pre><p id="ceca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将此脚本保存在计算机上的任意位置。然后启动卡拉模拟器。然后使用这个命令打开一个新的终端并启动Carla-viz</p><figure class="je jf jg jh fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es ju"><img src="../Images/b0d43d449a9ca4867a06c523fcaf8845.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pzUC6Uj2f6x1-1tjQAjeUw.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx translated">产卵后车辆</figcaption></figure><blockquote class="kg kh ki"><p id="886b" class="if ig kj ih b ii ij ik il im in io ip kk ir is it kl iv iw ix km iz ja jb jc hb bi translated"><em class="hi">docker run-it—network = " HOST "-e CARLA viz _ HOST _ IP = localhost-e CARLA _ SERVER _ IP = localhost-e CARLA _ SERVER _ PORT = 2000 mjxu 96/CARLA viz:最新</em></p></blockquote><p id="0fa6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意，我使用的是Carla-viz docker版本。到你的浏览器粘贴这个<a class="ae jd" href="http://0.0.0.0:8080/" rel="noopener ugc nofollow" target="_blank"> http://0.0.0.0:8080/ </a>。因为Carla-viz运行在端口8080上。您将从运行Carla-viz的终端获得这个链接。</p><figure class="je jf jg jh fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kn"><img src="../Images/d37d17f91db28c4589b7ec4b7f2f4521.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*405XQETre6p_ImKDlMt1wg.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx translated">使用Carla Viz的可视化</figcaption></figure><p id="a297" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在图片中，我们可以看到Carla-viz中RGB相机和激光雷达点云的输出</p></div></div>    
</body>
</html>