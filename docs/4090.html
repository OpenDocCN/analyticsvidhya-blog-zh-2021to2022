<html>
<head>
<title>R data.table Joins</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ræ•°æ®è¡¨è¿æ¥</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/r-data-table-joins-48f00b46ce29?source=collection_archive---------0-----------------------#2021-08-26">https://medium.com/analytics-vidhya/r-data-table-joins-48f00b46ce29?source=collection_archive---------0-----------------------#2021-08-26</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/a77fe3f9877a61f3a1311bc497e278e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IaIVFs7WhwCrumrq"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">ç…§ç‰‡ç”±<a class="ae it" href="https://unsplash.com/@sammoqadam?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Sam Moqadam </a>åœ¨<a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>æ‹æ‘„</figcaption></figure><h1 id="a571" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">ä»‹ç»</h1><p id="dcec" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated"><code class="du kq kr ks kt b">Data.table</code>æ˜¯å¤è€çš„<code class="du kq kr ks kt b">data.frame</code>çš„å¼ºå¤§ç°ä»£æ›´æ–°ã€‚åœ¨å¼•æ“ç›–ä¸‹ï¼Œè¯¥åŒ…å·²ç»è¿‡è°ƒæ•´ï¼Œä»¥æƒŠäººçš„é€Ÿåº¦å’Œæœ€å°çš„å†…å­˜ä½¿ç”¨é‡ä¸ä¸€ä¸ªåœ†æ»‘å’Œå¤‡ç”¨çš„è¯­æ³•ã€‚å¯¹äºåˆå­¦è€…æ¥è¯´ï¼Œç®€æ´çš„è¯­æ³•æ˜¯ä¸€ç§ç¦æ°”ï¼Œä½†å¯¹äºæ–°ç”¨æˆ·æ¥è¯´ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªéšœç¢ã€‚</p><p id="98f0" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">å¯¹æˆ‘æ¥è¯´ï¼Œå…¶ä¸­ä¸€ä¸ªé¢†åŸŸæ˜¯è¿æ¥å¤šä¸ª<code class="du kq kr ks kt b">data.table</code>ã€‚è¿™ä¸ªåŒ…çš„è®¾è®¡ä½¿å¾—<code class="du kq kr ks kt b">data.table</code>ç‰¹åˆ«æ“…é•¿è¿æ¥ï¼Œæ‰€ä»¥æˆ‘å‘ç°åŠªåŠ›æŒæ¡è¯­æ³•æ˜¯éå¸¸å€¼å¾—çš„ã€‚æ®æˆ‘æ‰€çŸ¥ï¼Œæˆ‘æ‰¾ä¸åˆ°ä»»ä½•èµ„æºå¯ä»¥å°†æˆ‘æƒ³è¦çš„æ‰€æœ‰ä¿¡æ¯æ”¶é›†åˆ°ä¸€ä¸ªåœ°æ–¹ã€‚è¿™æ˜¯æˆ‘å¸Œæœ›èƒ½æ‰¾åˆ°çš„æ–‡ä»¶ã€‚æˆ‘å¸Œæœ›å®ƒèƒ½å¸®åŠ©ä½ æŒæ¡è¿™ä¸ªæœ€å¼ºå¤§çš„RåŒ…çš„å¼ºå¤§ç‰¹æ€§ã€‚</p><h1 id="3f16" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">å…¥é—¨æŒ‡å—</h1><p id="113a" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">è¦å¿«é€Ÿäº†è§£<code class="du kq kr ks kt b">data.table</code>åŒ…æœ¬èº«ï¼Œä½ çœŸçš„æ²¡æœ‰æ¯”é˜…è¯»è¯¥é¡¹ç›®çš„å®˜æ–¹ä¸»é¡µ<a class="ae it" href="https://rdatatable.gitlab.io/data.table/index.html" rel="noopener ugc nofollow" target="_blank">ä¸Šçš„ä»‹ç»æ€§ç®€ä»‹æ›´å¥½çš„äº†ã€‚</a></p><p id="494a" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">åœ¨è¿™é‡Œï¼Œæˆ‘å°†å¯¹ä»å•ä¸ª<code class="du kq kr ks kt b">data.table</code>ä¸­è¯»å–å’Œæ“ä½œæ•°æ®çš„åŸºç¡€çŸ¥è¯†åšä¸€ä¸ªæœ€ç®€çŸ­çš„æ¦‚è¿°ï¼Œä¾›é‚£äº›å¯èƒ½æ˜¯è½¯ä»¶åŒ…æ–°æ‰‹æˆ–è€…åªæ˜¯ç”Ÿç–çš„äººä½¿ç”¨ã€‚å·²ç»å…·å¤‡åŸºæœ¬çŸ¥è¯†çš„è¯»è€…åº”è¯¥è·³åˆ°ä¸‹ä¸€èŠ‚ã€‚</p><p id="25d9" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">æ­£å¦‚æ‚¨åœ¨é˜…è¯»å®˜æ–¹æ–‡æ¡£æ—¶å°†ä¼šçœ‹åˆ°çš„ï¼Œ<code class="du kq kr ks kt b">data.table</code>åŒ…çš„åˆ›å»ºè€…é¼“åŠ±ç”¨æˆ·è€ƒè™‘å¯¹å•ä¸ªè¡¨è¿›è¡Œæ“ä½œï¼Œå°±åƒæ‚¨è€ƒè™‘æŸ¥è¯¢å…³ç³»æ•°æ®åº“ä¸€æ ·ã€‚<code class="du kq kr ks kt b">data.table</code>ã€<em class="kz"> DT </em>çš„é€—å·åˆ†éš”å­—æ®µå¯ä»¥æ˜ å°„åˆ°SQLæŸ¥è¯¢çš„ç›¸åº”ç‰¹æ€§ã€‚</p><figure class="lb lc ld le fd ii er es paragraph-image"><div class="er es la"><img src="../Images/7ca0cdbeb3871349b41755b97d3805ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*wwyy-bA_xCz8H1Rc8pzQBg.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">ä½œè€…å›¾ç‰‡</figcaption></figure><p id="9161" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">ç¬¬ä¸€ä¸ªå­—æ®µ<em class="kz"> i </em>ï¼Œå¯¹è¡¨æ ¼æ•°æ®è¡Œè¿›è¡Œæ’åºæˆ–ç­›é€‰ã€‚ç¬¬äºŒä¸ª<br/>å­—æ®µ<em class="kz"> j </em>é€‰æ‹©ç”¨äºè®¡ç®—æˆ–æ˜¾ç¤ºçš„æ•°æ®åˆ—ï¼Œè€Œæœ€åä¸€ä¸ª<br/> <em class="kz"> by </em>å­—æ®µèµ·åˆ°<em class="kz"> group-by </em>çš„ä½œç”¨ã€‚</p><p id="bdf8" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">åœ¨ç»§ç»­è®¨è®ºè¿æ¥ä¹‹å‰ï¼Œè¿æ¥çš„è¯­æ³•ä¸è¿™ä¸ªæŸ¥è¯¢è¯­æ³•ä¸åŒï¼Œè®©æˆ‘ä»¬æ„å»ºä¸€ä¸ªå•ç‹¬çš„æŸ¥è¯¢æ¥ç»ƒä¹ æ‰€æœ‰è¿™äº›ç±»ä¼¼SQLçš„å­å¥ã€‚</p><p id="4898" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">é¦–å…ˆï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€äº›è¦å¤„ç†çš„æ•°æ®ã€‚</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="24cd" class="lj iv hh kt b fi lk ll l lm ln"># Create a data.table to work with<br/>library(data.table)</span><span id="7fbc" class="lj iv hh kt b fi lo ll l lm ln">set.seed(42)<br/>x &lt;- data.table( <br/>  id = sample(LETTERS[1:3], 10, replace = TRUE),<br/>  value = sample(1:5, 10, replace = TRUE)<br/>)</span><span id="d08f" class="lj iv hh kt b fi lo ll l lm ln">x</span><span id="34e4" class="lj iv hh kt b fi lo ll l lm ln">##         id value<br/>##     &lt;char&gt; &lt;int&gt;<br/>##  1:      A     4<br/>##  2:      A     1<br/>##  3:      A     5<br/>##  4:      A     4<br/>##  5:      B     2<br/>##  6:      B     2<br/>##  7:      B     3<br/>##  8:      A     1<br/>##  9:      C     1<br/>## 10:      C     3</span></pre><p id="e9fe" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">ä¸ºäº†è¯´æ˜ä¸€ä¸ªä½¿ç”¨æ‰€æœ‰ç±»ä¼¼SQLçš„ä¸»è¦æ“ä½œçš„æŸ¥è¯¢ï¼Œè®©æˆ‘ä»¬æ‰¾åˆ°(<em class="kz"> select </em>)æ‰€æœ‰(<em class="kz">where</em>)Bå’ŒCçš„å€¼å­—æ®µçš„å¹³å‡å€¼ï¼Œç”¨äºæ¯ä¸ª<br/> ( <em class="kz"> group by </em> ) idã€‚</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="c49f" class="lj iv hh kt b fi lk ll l lm ln">x[ id &gt; 'A', .(mean_value = mean(value)), by = .(id)]</span><span id="5d4a" class="lj iv hh kt b fi lo ll l lm ln">##        id mean_value<br/>##    &lt;char&gt;      &lt;num&gt;<br/>## 1:      B   2.333333<br/>## 2:      C   2.000000</span></pre><p id="d147" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">æˆ‘ä»¬è¿‡æ»¤äº†<em class="kz"> x </em>çš„è¡Œï¼Œåªç»™å‡ºäº†<em class="kz"> id </em>å¤§äºAçš„è¡Œï¼Œå¹¶ä¸”<br/>å°†è¿™äº›è¡Œä¼ é€’ç»™é€‰æ‹©æ­¥éª¤ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å–<em class="kz">å€¼</em> <br/>å­—æ®µçš„å¹³å‡å€¼ï¼ŒæŒ‰<em class="kz"> id </em>å­—æ®µåˆ†ç»„ï¼Œå¹¶å°†è®¡ç®—å€¼å‘½åä¸º<br/> <em class="kz"> mean_value </em>ã€‚</p><p id="d4b8" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">è¿™æ˜¯æŸ¥è¯¢ä¸€ä¸ª<code class="du kq kr ks kt b">data.table</code>çš„åŸºæœ¬é€»è¾‘å’Œè¯­æ³•çš„(è¶…çº§å‹ç¼©)æ¼”ç»ƒã€‚ç¨åï¼Œå½“æˆ‘ä»¬å¯¹å°†è¦ç”Ÿæˆçš„åˆå¹¶çš„<code class="du kq kr ks kt b">data.table</code>æ‰§è¡Œä¸€äº›åŸºæœ¬æ“ä½œæ—¶ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€äº›æŸ¥è¯¢é€»è¾‘ã€‚å¦‚æœè¿™ä¸€éƒ¨åˆ†çš„ä¸€äº›ææ–™è¢«ä½ å¿½ç•¥äº†ï¼Œä½ ä¸åº”è¯¥æ„Ÿåˆ°éš¾è¿‡ã€‚æˆ‘åªæ˜¯è¯•å›¾ä¸ºæ‚¨æä¾›ä¸€äº›å¿…è¦çš„åŸºæœ¬çŸ¥è¯†ï¼Œè®©æ‚¨èƒ½å¤Ÿç†è§£æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†ï¼Œè€Œä¸ä¼šè®©é‚£äº›æƒ³è·³åˆ°è¡¨è¿æ¥çš„è¯»è€…æ„Ÿåˆ°åŒçƒ¦ã€‚å¦‚æœä½ è§‰å¾—è¿™ä¸€éƒ¨åˆ†å¾ˆéš¾ç†è§£ï¼Œé‚£ä¹ˆè¿™ä¸ªåŒ…çš„å®˜æ–¹ä»‹ç»ä¼šè®©ä½ å¾ˆå¿«ä¸Šæ‰‹ã€‚</p><h1 id="94dc" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">ç®€å•ç­‰å€¼è”æ¥</h1><p id="d6a3" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">ä¸ºäº†æ¼”ç¤ºåŸºäºè¡¨ä¹‹é—´å˜é‡ç›¸ç­‰(æˆ–å…¶<br/>å¦å®š)çš„è¡¨ä¹‹é—´çš„è¿æ¥ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªæ•°æ®è¡¨æ¥<br/>å¤„ç†ã€‚</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="9729" class="lj iv hh kt b fi lk ll l lm ln">set.seed(42)</span><span id="a7a4" class="lj iv hh kt b fi lo ll l lm ln">big &lt;- data.table( <br/>  id = LETTERS[2:11],<br/>  a = sample(101:105, 10, replace = TRUE),<br/>  b = sample(200:300, 10)<br/>)</span><span id="d781" class="lj iv hh kt b fi lo ll l lm ln">small &lt;- data.table(<br/>  id = LETTERS[1:5],<br/>  y = sample(1:5, 5, replace = TRUE),<br/>  z = sample(10:20, 5) <br/>)</span><span id="0b97" class="lj iv hh kt b fi lo ll l lm ln">big</span><span id="5a7b" class="lj iv hh kt b fi lo ll l lm ln">##         id     a     b<br/>##     &lt;char&gt; &lt;int&gt; &lt;int&gt;<br/>##  1:      B   101   288<br/>##  2:      C   105   236<br/>##  3:      D   101   219<br/>##  4:      E   101   225<br/>##  5:      F   102   202<br/>##  6:      G   104   240<br/>##  7:      H   102   300<br/>##  8:      I   102   226<br/>##  9:      J   101   235<br/>## 10:      K   104   204</span><span id="288e" class="lj iv hh kt b fi lo ll l lm ln">small</span><span id="a505" class="lj iv hh kt b fi lo ll l lm ln">##        id     y     z<br/>##    &lt;char&gt; &lt;int&gt; &lt;int&gt;<br/>## 1:      A     4    10<br/>## 2:      B     2    19<br/>## 3:      C     4    17<br/>## 4:      D     3    15<br/>## 5:      E     2    12</span></pre><p id="b52a" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">æˆ‘ä»¬å°†ä»ä¸€ä¸ªå¸¦æœ‰é»˜è®¤å‚æ•°çš„éå¸¸ç®€å•çš„è¿æ¥å¼€å§‹ã€‚</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="5cc2" class="lj iv hh kt b fi lk ll l lm ln"># Right outer join<br/>big[small, on = .(id)]</span><span id="df25" class="lj iv hh kt b fi lo ll l lm ln">##        id     a     b     y     z<br/>##    &lt;char&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;<br/>## 1:      A    NA    NA     4    10<br/>## 2:      B   101   288     2    19<br/>## 3:      C   105   236     4    17<br/>## 4:      D   101   219     3    15<br/>## 5:      E   101   225     2    12</span></pre><p id="b609" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">æˆ‘ä»¬é€šè¿‡å°†<em class="kz">å°</em>æ”¾å…¥<em class="kz">å¤§</em>çš„ç¬¬ä¸€ä¸ª<br/>æ§½ä¸­ï¼Œå¹¶å‘Šè¯‰<code class="du kq kr ks kt b">data.table</code>ç”¨å…³é”®å­—<code class="du kq kr ks kt b">on</code>è¿æ¥å“ªä¸ªå­—æ®µï¼Œä»è€Œè¿æ¥äº†<em class="kz">å¤§</em>å’Œ<em class="kz">å°</em>è¡¨æ ¼ã€‚</p><p id="5f54" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">å¦‚æœä½ ä¹ æƒ¯äº†<code class="du kq kr ks kt b">merge.data.frame()</code>çš„é»˜è®¤è¡Œä¸ºï¼Œè¿™ä¸ªåŠ å…¥çš„ç»“æœå¯èƒ½ä¼šè®©ä½ å¤§åƒä¸€æƒŠã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç”¨è¿™ä¸ª<strong class="ju hi"> X[Y] </strong>è¯­æ³•è¿æ¥<code class="du kq kr ks kt b">data.table</code> sä¼šäº§ç”Ÿä¸€ä¸ª<strong class="ju hi">å³å¤–è¿æ¥</strong>ï¼Œå…¶ä¸­<em class="kz">å¤§</em>ä½œä¸ºå·¦è¡¨ï¼Œè€Œ<em class="kz">å°</em>ä½œä¸ºå³è¡¨ã€‚è¿™é‡Œï¼Œ<em class="kz"> small </em>ä¸­å¸¦æœ‰<em class="kz"> id </em> == 'A 'çš„è¡Œå‡ºç°åœ¨ç»“æœé›†ä¸­ã€‚ç”±äºåœ¨<em class="kz">å¤§</em>ä¸­æ²¡æœ‰ç›¸åº”çš„è®°å½•ï¼Œå› æ­¤è¯¥<br/>è®°å½•çš„å­—æ®µæ˜¾ç¤ºä¸º<code class="du kq kr ks kt b">NA</code>ã€‚æ­¤æ—¶ï¼Œå”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç»“æœè¡¨ä¸­çš„<br/>åˆ—åæ˜ äº†è¿‡ç¨‹è°ƒç”¨ä¸­è¡¨ä»å·¦åˆ°å³çš„é¡ºåº(å³<em class="kz">å³</em>ï¼Œ<em class="kz">å¤§</em>åˆ—åé¢è·Ÿç€<em class="kz">å°</em>)ã€‚</p><p id="afc5" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">å¦‚æœæˆ‘ä»¬æ”¹å˜è¦è¿æ¥çš„è¡¨çš„å‘½åé¡ºåºï¼Œç»“æœè¿æ¥çš„æ€§è´¨å¯èƒ½ä¼šæ›´åŠ æ˜æ˜¾ã€‚</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="b7ef" class="lj iv hh kt b fi lk ll l lm ln"># Right outer join<br/>small[big, on = .(id)]</span><span id="4583" class="lj iv hh kt b fi lo ll l lm ln">##         id     y     z     a     b<br/>##     &lt;char&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;<br/>##  1:      B     2    19   101   288<br/>##  2:      C     4    17   105   236<br/>##  3:      D     3    15   101   219<br/>##  4:      E     2    12   101   225<br/>##  5:      F    NA    NA   102   202<br/>##  6:      G    NA    NA   104   240<br/>##  7:      H    NA    NA   102   300<br/>##  8:      I    NA    NA   102   226<br/>##  9:      J    NA    NA   101   235<br/>## 10:      K    NA    NA   104   204</span></pre><p id="4e70" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">æ­£å¦‚æˆ‘ä»¬å·²ç»çœ‹åˆ°çš„ï¼Œåœ¨è¿™ä¸ª<strong class="ju hi">left _ table[right _ table]</strong>è¯­æ³•ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰è¿æ¥éƒ½æ˜¯å³å¤–è¿æ¥ã€‚æˆ‘ä»¬éœ€è¦è®¾ç½®å‚æ•°<code class="du kq kr ks kt b">nomatch</code>æ¥æ”¹å˜è¿™ç§è¡Œä¸ºã€‚è¦è·å¾—ä¸€ä¸ª<strong class="ju hi">å†…éƒ¨è¿æ¥</strong>ï¼Œæ‚¨éœ€è¦å°†<code class="du kq kr ks kt b">nomatch</code>å‚æ•°è®¾ç½®ä¸ºNULLæˆ–0ã€‚</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="4d43" class="lj iv hh kt b fi lk ll l lm ln"># Inner join<br/>small[big, on = .(id), <strong class="kt hi">nomatch = NULL</strong>]</span><span id="3e85" class="lj iv hh kt b fi lo ll l lm ln">##        id     y     z     a     b<br/>##    &lt;char&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;<br/>## 1:      B     2    19   101   288<br/>## 2:      C     4    17   105   236<br/>## 3:      D     3    15   101   219<br/>## 4:      E     2    12   101   225</span></pre><p id="6321" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">å†…éƒ¨è¿æ¥æ˜¯è°ƒç”¨<code class="du kq kr ks kt b">merge.data.frame()</code>çš„é»˜è®¤ç»“æœã€‚ä¸ºäº†å…¼å®¹ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œ<code class="du kq kr ks kt b">merge.data.table()</code>ä¹Ÿæ‰§è¡Œå†…éƒ¨è¿æ¥ã€‚</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="afca" class="lj iv hh kt b fi lk ll l lm ln"># X[Y, nomatch = NULL] == merge(X,Y)<br/>all(small[big, on = .(id), nomatch = NULL] == merge(small, big))</span><span id="163e" class="lj iv hh kt b fi lo ll l lm ln">## [1] TRUE</span></pre><p id="cfc8" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">æ—¢ç„¶<code class="du kq kr ks kt b">data.table</code>å·²ç»å®ç°äº†è‡ªå·±çš„<code class="du kq kr ks kt b">merge()</code>å‡½æ•°ï¼Œä½ å¯èƒ½ä¼šé—®è‡ªå·±ä¸ºä»€ä¹ˆè¦æ”¾å¼ƒç†Ÿæ‚‰çš„<code class="du kq kr ks kt b">merge()</code>æ¥ä½¿ç”¨è¿™ç§æ›´ç®€å•çš„è¯­æ³•ã€‚è¿™æ˜¯ä¸ªå¾ˆå¥½çš„é—®é¢˜ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œéåˆå¹¶<strong class="ju hi"> X[Y] </strong>è¯­æ³•æ˜¯é¦–é€‰çš„ã€æ›´åƒ<code class="du kq kr ks kt b">data.table</code>çš„è¿æ¥æ–¹å¼ã€‚åŸå› æ˜¯<code class="du kq kr ks kt b">data.table</code>è‡ªåŠ¨è¯¢é—®<em class="kz"> j </em>å­—æ®µï¼Œä»¥æ£€æµ‹å®Œæˆ<em class="kz"> j </em>ä¸­æŒ‡å®šçš„è®¡ç®—æ‰€éœ€çš„æœ€å°åˆ—é›†åˆã€‚å¦ä¸€æ–¹é¢ï¼Œä½¿ç”¨<code class="du kq kr ks kt b">merge()</code>è¦ä¹ˆåˆå¹¶RHSè¡¨ä¸­çš„æ‰€æœ‰åˆ—ï¼Œä¸ç®¡å®ƒä»¬æ˜¯å¦éœ€è¦(æµªè´¹)ï¼Œè¦ä¹ˆè¦æ±‚ç”¨æˆ·æ‰‹åŠ¨å°†RHSè¡¨ä¸­çš„åˆ—å‡å°‘åˆ°æœ€å°‘çš„å¿…è¦åˆ—(å†—é•¿ä¸”ä¸å¿…è¦)ã€‚</p><p id="e6e3" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">å› æ­¤ï¼Œä¾‹å¦‚ï¼Œä¸‹é¢çš„è¿æ¥/æŸ¥è¯¢åªåˆå¹¶æ¥è‡ª<em class="kz"> big </em>çš„åˆ—<em class="kz"> a </em>ï¼Œå› ä¸º<em class="kz"> a </em>æ˜¯RHSè¡¨ä¸­åç»­è®¡ç®—æ‰€éœ€çš„å”¯ä¸€åˆ—ã€‚</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="981b" class="lj iv hh kt b fi lk ll l lm ln"># data.table takes care of minimizing the number of <br/># joined columns<br/>small[big, on = .(id), .('a + z' = a + z)]</span><span id="a685" class="lj iv hh kt b fi lo ll l lm ln">##     a + z<br/>##     &lt;int&gt;<br/>##  1:   120<br/>##  2:   122<br/>##  3:   116<br/>##  4:   113<br/>##  5:    NA<br/>##  6:    NA<br/>##  7:    NA<br/>##  8:    NA<br/>##  9:    NA<br/>## 10:    NA</span></pre><p id="7d5d" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">æ˜¾ç„¶ï¼Œå¯¹äºè¿™ä¸ªç©å…·ç¤ºä¾‹æ¥è¯´ï¼Œæ•ˆç‡å¢ç›Šæ˜¯æœ€å°çš„ï¼Œä½†æ˜¯<code class="du kq kr ks kt b">data.table</code>åŒ…æ˜¯å…³äºé«˜æ•ˆå¤„ç†å¤§å‹æ•°æ®é›†çš„ï¼Œè¿™ç§ä¼˜åŒ–å¯èƒ½æ„å‘³ç€æ˜¯å¦èƒ½å¤Ÿåœ¨å†…å­˜ä¸­è¿è¡Œåˆ†æã€‚</p><p id="a274" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">æœ‰ä¸¤ç§æ‰€è°“çš„è¿æ¥ï¼Œå³<strong class="ju hi">åè¿æ¥</strong>å’Œ<strong class="ju hi">åŠè¿æ¥</strong>ï¼Œå®ƒä»¬å¹¶ä¸çœŸæ­£ä»ä¸¤ä¸ªè¡¨ä¸­è¿”å›åˆ—çš„ç»„åˆã€‚åªè¿”å›<em class="kz">å¤§</em>ä¸­ä¸<em class="kz">å°</em>ä¸­çš„<em class="kz"> id </em>ä¸åŒ¹é…çš„è¡Œå¾ˆç®€å•ã€‚è¦è·å¾—è¿™ç§åè¿æ¥è¡Œä¸ºï¼Œåªéœ€å¯¹RHSè¡¨æ±‚åå³å¯ã€‚</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="512a" class="lj iv hh kt b fi lk ll l lm ln"># Anti-join <br/># (return rows of big with no match in small)<br/>big[!small, on = .(id)]</span><span id="45a0" class="lj iv hh kt b fi lo ll l lm ln">##        id     a     b<br/>##    &lt;char&gt; &lt;int&gt; &lt;int&gt;<br/>## 1:      F   102   202<br/>## 2:      G   104   240<br/>## 3:      H   102   300<br/>## 4:      I   102   226<br/>## 5:      J   101   235<br/>## 6:      K   104   204</span></pre><p id="83cc" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">åŠè¿æ¥æœ‰ç‚¹åƒååè¿æ¥ã€‚å®ƒåªè¿”å›LHSè¡¨ä¸­ä¸RHSè¡¨åŒ¹é…çš„è¡Œã€‚è¿™æ ·åšçš„è¯­æ³•æœ‰ç‚¹ç¬¨æ‹™ï¼Œä½†æ˜¯å¯ä»¥å¦‚ä¸‹æ‰€ç¤ºè·å¾—ä¸<em class="kz">å°</em>ä¸­çš„<em class="kz"> id </em> såŒ¹é…çš„<em class="kz">å¤§</em>çš„å…ƒç´ ã€‚</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="790e" class="lj iv hh kt b fi lk ll l lm ln"># Semi-join <br/># (return only rows of big that have a <br/># match in small)<br/>big[na.omit(big[small, on = .(id), which=TRUE])]</span><span id="6828" class="lj iv hh kt b fi lo ll l lm ln">##        id     a     b<br/>##    &lt;char&gt; &lt;int&gt; &lt;int&gt;<br/>## 1:      B   101   288<br/>## 2:      C   105   236<br/>## 3:      D   101   219<br/>## 4:      E   101   225</span></pre><p id="0c9c" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated"><code class="du kq kr ks kt b">which</code>å‚æ•°åªæ˜¯æŒ‡ç¤º<code class="du kq kr ks kt b">data.table</code>è¿”å›<em class="kz">å¤§</em>ä¸­ä¸<em class="kz">å°</em>åŒ¹é…çš„è¡Œçš„ç´¢å¼•ï¼Œè¿”å›<code class="du kq kr ks kt b">NA</code>ä¸­ä¸<em class="kz">å¤§<em class="kz">å°</em>ä¸åŒ¹é…çš„è¡Œçš„ç´¢å¼•ã€‚</em>ç„¶åï¼Œæˆ‘ä»¬å°†è¿™äº›è¡Œç´¢å¼•å‡å»<code class="du kq kr ks kt b">NA</code>å€¼ï¼Œè¾“å…¥åˆ°<em class="kz"> big </em>çš„å¤–éƒ¨æŸ¥è¯¢çš„<em class="kz"> i </em>å­—æ®µä¸­ã€‚</p><p id="5beb" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">æœ€åï¼Œå¦‚æœæƒ³è¿æ¥ä¸¤ä¸ªè¡¨ä¸­çš„æ‰€æœ‰å¯ç”¨æ•°æ®ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿä¸€ä¸ªèªæ˜çš„æƒ³æ³•æ˜¯ç”¨X[Y] è¯­æ³•å®ç°<strong class="ju hi">å…¨å¤–éƒ¨</strong>è¿æ¥ï¼Œè¿™ä¸ªæƒ³æ³•æ¥è‡ªäº<a class="ae it" href="https://stackoverflow.com/questions/12773822/why-does-xy-join-of-data-tables-not-allow-a-full-outer-join-or-a-left-join?rq=1&amp;newreg=c55095bfee4e4d67a6f52576549c939b" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ª</a>ç»å…¸çš„Stackoverflowäº¤æ¢ã€‚</p><p id="9fe9" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">å®ç°Stackoverflowçš„æƒ³æ³•éœ€è¦æˆ‘ä»¬ç¨å¾®ç»•é“ä»‹ç»ä¸€ä¸‹<strong class="ju hi">é”®</strong>çš„æƒ³æ³•ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»ç”¨<code class="du kq kr ks kt b">on</code>å‚æ•°æŒ‡å®šäº†æ¯æ¬¡åŠ å…¥çš„å˜é‡ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†id<em class="kz">è®¾ç½®ä¸ºä¸¤ä¸ªè¡¨ä¸­çš„é”®ï¼Œä½¿å…¶æˆä¸ºæ‰€æœ‰åç»­è¿æ¥ä¸­çš„éšå¼è¿æ¥å˜é‡ã€‚è¿™ä½¿å¾—è¿æ¥é€Ÿåº¦éå¸¸å¿«ï¼Œä»£ä»·æ˜¯å˜é‡çš„å‰æœŸå¼•ç”¨æ’åºéå¸¸å°ã€‚å®ƒè¿˜ç®€åŒ–äº†åŸºäºé”®é€‰æ‹©è¡Œçš„è¯­æ³•ã€‚è®©æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è¿™ä¸ªç‰¹æ€§ã€‚</em></p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="de71" class="lj iv hh kt b fi lk ll l lm ln">setkey(small, id)<br/>setkey(big, id)</span><span id="f371" class="lj iv hh kt b fi lo ll l lm ln"># With keys set, we don't need to specify <br/># columns to join on<br/>big[c('A','C', 'E' )]</span><span id="3390" class="lj iv hh kt b fi lo ll l lm ln">##        id     a     b<br/>##    &lt;char&gt; &lt;int&gt; &lt;int&gt;<br/>## 1:      A    NA    NA<br/>## 2:      C   105   236<br/>## 3:      E   101   225</span></pre><p id="56b9" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">ä¸Šé¢ï¼Œ<code class="du kq kr ks kt b">data.table</code>â€œçŸ¥é“â€æˆ‘ä»¬æƒ³è¦å¯¹åº”äº<em class="kz"> id </em> s Aã€Cå’Œeçš„<em class="kz"> big </em>çš„è¡Œã€‚è¿™ç§ç±»å‹çš„è¡Œç´¢å¼•åœ¨ä¸‹é¢çš„å…¨å¤–è¿æ¥ä¸­èµ·ä½œç”¨ã€‚</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="1e57" class="lj iv hh kt b fi lk ll l lm ln"># Full outer join<br/>unique_ids = unique(c(big[, id], small[, id]))<br/>big[small[unique_ids]]</span><span id="b7de" class="lj iv hh kt b fi lo ll l lm ln">##         id     a     b     y     z<br/>##     &lt;char&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;<br/>##  1:      B   101   288     2    19<br/>##  2:      C   105   236     4    17<br/>##  3:      D   101   219     3    15<br/>##  4:      E   101   225     2    12<br/>##  5:      F   102   202    NA    NA<br/>##  6:      G   104   240    NA    NA<br/>##  7:      H   102   300    NA    NA<br/>##  8:      I   102   226    NA    NA<br/>##  9:      J   101   235    NA    NA<br/>## 10:      K   104   204    NA    NA<br/>## 11:      A    NA    NA     4    10</span></pre><p id="c86c" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">æ˜¾ç„¶ï¼Œæ— è®º<em class="kz"> big </em>æ˜¯LHSè¡¨è¿˜æ˜¯RHSè¡¨ï¼Œéƒ½åªä¼šåœ¨æˆ‘ä»¬æ‰§è¡Œå®Œå…¨å¤–éƒ¨è¿æ¥æ—¶å½±å“è¿æ¥è¡¨ä¸­åˆ—çš„é¡ºåºã€‚</p><p id="46c4" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">åœ¨æˆ‘ä»¬ç¦»å¼€è¿™ä¸€éƒ¨åˆ†ä¹‹å‰ï¼Œè®©æˆ‘ä»¬æ˜ç¡®åœ°æ¼”ç¤ºä¸€ä¸ª<strong class="ju hi">è‡ªè¿æ¥</strong>ï¼Œä¸€ä¸ªè¡¨å¯¹å®ƒè‡ªå·±çš„è¿æ¥æ¥å®ç°ä¸€äº›è½¬æ¢ã€‚æˆ‘ä»¬åœ¨æœ¬æ•™ç¨‹ä¸­åˆ›å»ºçš„ç¬¬ä¸€ä¸ª<code class="du kq kr ks kt b">data.table</code>ï¼Œ<em class="kz"> x </em>ï¼Œåœ¨<em class="kz"> id </em>å­—æ®µä¸­æœ‰é‡å¤çš„å€¼ã€‚å‡è®¾æˆ‘ä»¬åªæƒ³æŒ‘é€‰å‡ºæ¯ä¸ª<em class="kz"> id </em>å€¼ç¬¬ä¸€æ¬¡å‡ºç°çš„è®°å½•ã€‚è¿™å¯ä»¥é€šè¿‡å°†<code class="du kq kr ks kt b">mult</code>(é’ˆå¯¹å¤šä¸ªåŒ¹é…)å‚æ•°è®¾ç½®ä¸ºâ€˜firstâ€™æ¥å®ç°ã€‚<code class="du kq kr ks kt b">mult</code>çš„å…¶ä»–åˆæ³•å€¼ä¸ºâ€˜allâ€™(é»˜è®¤å€¼)å’Œâ€˜lastâ€™ã€‚</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="8584" class="lj iv hh kt b fi lk ll l lm ln"># Self-join<br/>setkey(x, id)<br/>x[unique(id), mult = 'first']</span><span id="dd1d" class="lj iv hh kt b fi lo ll l lm ln">##        id value<br/>##    &lt;char&gt; &lt;int&gt;<br/>## 1:      A     4<br/>## 2:      B     2<br/>## 3:      C     1</span></pre><p id="ecfd" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">ä¸ºäº†è¯´æ˜è¿™æ˜¯å¦‚ä½•åšåˆ°çš„ï¼Œä¹Ÿå› ä¸ºå‡ºäºæ•™å­¦ç›®çš„ï¼Œæˆ‘æ›´å–œæ¬¢<code class="du kq kr ks kt b">on </code>è¯­æ³•çš„æ˜ç¡®æ€§ï¼Œæ‰€ä»¥æˆ‘å°†ä»è¿™äº›è¡¨ä¸­åˆ é™¤è¿™äº›é”®ã€‚ä¸è¿‡ï¼Œåœ¨çœŸæ­£çš„ç ”ç©¶ä¸­ï¼Œæˆ‘å‡ ä¹æ€»æ˜¯ä¼šä½¿ç”¨æŒ‰é”®ã€‚</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="34eb" class="lj iv hh kt b fi lk ll l lm ln">setkey(x, NULL)<br/>setkey(small, NULL)<br/>setkey(big, NULL)</span><span id="cc64" class="lj iv hh kt b fi lo ll l lm ln"># Now when we try to access rows as we did when<br/>#  id was a key, we get an error ...<br/>big[c('A','C', 'E' )]</span><span id="317b" class="lj iv hh kt b fi lo ll l lm ln">## Error in `[.data.table`(big, c("A", "C", "E")): When i is a data.table (or character vector), the columns to join by must be specified using 'on=' argument (see ?data.table), by keying x (i.e. sorted, and, marked as sorted, see ?setkey), or by sharing column names between x and i (i.e., a natural join). Keyed joins might have further speed benefits on very large data due to x being sorted in RAM.</span></pre><p id="b25f" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">åœ¨è¿›å…¥ä¸‹ä¸€éƒ¨åˆ†ä¹‹å‰ï¼Œä¸Šé¢è¿™ä¸ªçœŸæ­£ç²¾å¿ƒåˆ¶ä½œçš„é”™è¯¯æ¶ˆæ¯å€¼å¾—æ‚¨çš„å°Šæ•¬ã€‚</p><h1 id="5fd1" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">éå¯¹ç­‰è¿æ¥</h1><p id="3a90" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„æ‰€æœ‰è¿æ¥éƒ½æ¶‰åŠåˆ°è¿æ¥åˆ—ä¹‹é—´çš„ç›¸ç­‰æ€§(æˆ–è€…ç›¸ç­‰æ€§çš„å¦å®š)ã€‚åŸºäºä¸ç­‰å¼çš„è¿æ¥ä¹Ÿå—<code class="du kq kr ks kt b">data.table</code>çš„æœ¬åœ°æ”¯æŒã€‚</p><p id="d2b8" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">è®©æˆ‘ä»¬å¼€å§‹æ¢ç´¢è¿™ä¸ªå¼ºå¤§çš„åŠŸèƒ½ï¼Œå°†çº¢è¢œé˜Ÿ2021å¹´9æœˆçš„ä¸»åœºæ—¶é—´è¡¨åŠ è½½åˆ°ä¸€ä¸ªå¸¦æœ‰<code class="du kq kr ks kt b">fread()</code>çš„<code class="du kq kr ks kt b">data.table</code>ä¸­ï¼Œè¿™ä¸ªåŒ…æ˜¯ä¸€ä¸ªå¼‚å¸¸å¿«é€Ÿã€å¼‚å¸¸æ™ºèƒ½çš„æ–‡ä»¶é˜…è¯»å™¨ã€‚åœ¨ä¸‹é¢çš„ä»£ç ç‰‡æ®µä¸­ï¼ŒèŠ±ç‚¹æ—¶é—´æ¥æ¬£èµä¸€ä¸‹<code class="du kq kr ks kt b">fread()</code>çš„æ•°æ®ç±»å‹è¯†åˆ«ã€‚æ¯æ¬¡éƒ½è®©æˆ‘ä¼šå¿ƒä¸€ç¬‘ã€‚ğŸ˜„</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="f26e" class="lj iv hh kt b fi lk ll l lm ln"># Red Sox home schedule<br/>fenway &lt;- fread(<br/>    "Visitor, Start, End<br/>    Cleveland, 2021-09-03, 2021-09-05<br/>    Tampa Bay, 2021-09-06, 2021-09-08<br/>    Baltimore, 2021-09-17, 2021-09-19<br/>    NY Mets, 2021-09-21, 2021-09-22<br/>    NY Yankees, 2021-09-24, 2021-09-26")</span><span id="1185" class="lj iv hh kt b fi lo ll l lm ln">fenway</span><span id="9409" class="lj iv hh kt b fi lo ll l lm ln">##       Visitor      Start        End<br/>##        &lt;char&gt;     &lt;IDat&gt;     &lt;IDat&gt;<br/>## 1:  Cleveland 2021-09-03 2021-09-05<br/>## 2:  Tampa Bay 2021-09-06 2021-09-08<br/>## 3:  Baltimore 2021-09-17 2021-09-19<br/>## 4:    NY Mets 2021-09-21 2021-09-22<br/>## 5: NY Yankees 2021-09-24 2021-09-26</span></pre><p id="e997" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">è®©æˆ‘ä»¬ç”¨2021å¹´9æœˆçš„æ‰€æœ‰æ—¥æœŸç”Ÿæˆä¸€ä¸ª<code class="du kq kr ks kt b">data.table</code>ã€‚</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="a2b5" class="lj iv hh kt b fi lk ll l lm ln"># All the days of September 2021<br/>september &lt;- <br/>   data.table(date = seq(as.Date('2021-09-01'), <br/>   as.Date('2021-09-30'), 'days'))</span><span id="fded" class="lj iv hh kt b fi lo ll l lm ln">head(september)</span><span id="399d" class="lj iv hh kt b fi lo ll l lm ln">##          date<br/>##        &lt;Date&gt;<br/>## 1: 2021-09-01<br/>## 2: 2021-09-02<br/>## 3: 2021-09-03<br/>## 4: 2021-09-04<br/>## 5: 2021-09-05<br/>## 6: 2021-09-06</span></pre><p id="9766" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">é€šè¿‡ä½¿ç”¨æ¯ä¸ªä¸»åœºçš„å¼€å§‹å’Œç»“æŸæ—¥æœŸçš„èŒƒå›´å°†<em class="kz"> fenway </em>è¡¨è¿æ¥åˆ°æ¯æœˆçš„æ—¥æœŸï¼Œå¹¶æ‰§è¡Œä¸€ç‚¹æ¸…ç†ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—çº¢è¢œä¸»åœºæ¯”èµ›çš„å®Œæ•´åˆ—è¡¨ï¼</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="1c48" class="lj iv hh kt b fi lk ll l lm ln"># The dates of all Red Sox home games in September 2021<br/>home_games &lt;- <br/>  fenway[september, on = .(Start &lt;= date, End &gt;= date), <br/>  .(Visitor, Date = Start)][!is.na(Visitor)]</span><span id="d76d" class="lj iv hh kt b fi lo ll l lm ln">home_games</span><span id="904f" class="lj iv hh kt b fi lo ll l lm ln">##        Visitor       Date<br/>##         &lt;char&gt;     &lt;Date&gt;<br/>##  1:  Cleveland 2021-09-03<br/>##  2:  Cleveland 2021-09-04<br/>##  3:  Cleveland 2021-09-05<br/>##  4:  Tampa Bay 2021-09-06<br/>##  5:  Tampa Bay 2021-09-07<br/>##  6:  Tampa Bay 2021-09-08<br/>##  7:  Baltimore 2021-09-17<br/>##  8:  Baltimore 2021-09-18<br/>##  9:  Baltimore 2021-09-19<br/>## 10:    NY Mets 2021-09-21<br/>## 11:    NY Mets 2021-09-22<br/>## 12: NY Yankees 2021-09-24<br/>## 13: NY Yankees 2021-09-25<br/>## 14: NY Yankees 2021-09-26</span></pre><p id="d291" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">å¯¹äºé‚£äº›ä»¥å‰å¯èƒ½æ²¡æœ‰è§è¿‡å®ƒçš„äººï¼Œæˆ‘åº”è¯¥æ³¨æ„åˆ°æœ€åä¸¤ä¸ªæ–¹æ‹¬å·(<code class="du kq kr ks kt b">[!is.na(Visitor)]</code>)ä¹‹é—´çš„ä»£ç æ®µæ˜¯ä¸€ç§æ“ä½œé“¾å½¢å¼ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨å‰é¢çš„æ“ä½œä¸­ç»†åŒ–ç»“æœï¼Œè¿™é‡Œåˆ é™¤äº†<em class="kz"> Visitor </em>å­—æ®µä¸ºç©ºçš„è¡Œã€‚</p><p id="7677" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">åœ¨ç»§ç»­è®¨è®ºæ»šåŠ¨è¿æ¥ä¹‹å‰ï¼Œæˆ‘éœ€è¦æ³¨æ„ä¸€ä¸ªå¾ˆå¤§çš„è¯­æ³•é—®é¢˜:ä¸ç­‰å¼(æˆ–ç­‰å¼ï¼Œå°±æ­¤è€Œè¨€)ä¸­å„é¡¹çš„é¡ºåºéå¸¸é‡è¦ã€‚è¿™ç§é€»è¾‘ä¸Šç­‰ä»·çš„â€”â€”åœ¨æˆ‘çœ‹æ¥ï¼Œæ›´ç›´è§‚çš„â€”â€”æ‰§è¡Œæ“ä½œçš„å°è¯•å°†ä¼šå¤±è´¥ã€‚</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="a364" class="lj iv hh kt b fi lk ll l lm ln"># The dates of all Red Sox home games in September 2021<br/>fenway[september, on = .(date &gt;= Start, date &lt;= End), <br/>       .(Visitor, Date = Start)][!is.na(Visitor)]</span><span id="a4fc" class="lj iv hh kt b fi lo ll l lm ln">## Error in colnamesInt(x, names(on), check_dups = FALSE): argument specifying columns specify non existing column(s): cols[1]='date'</span></pre><p id="98c7" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">å¥½äº†ï¼Œ<em class="kz">é”™è¯¯æ¶ˆæ¯</em>æœ‰ç‚¹éš¾ä»¥ç†è§£ï¼Œä½†æ˜¯joinè¯­å¥ä¸­å…³ç³»å·¦ä¾§å¿…é¡»å¯¹åº”äºLHSè¡¨ï¼Œåä¹‹äº¦ç„¶ã€‚<em class="kz">å¼€å§‹</em>æ˜¯ä¸€ä¸ªLHSå­—æ®µï¼Œ<em class="kz">æ—¥æœŸ</em>æ˜¯ä¸€ä¸ªRHSå­—æ®µï¼Œæ‰€ä»¥æ’åºå¿…é¡»æ˜¯<em class="kz">å¼€å§‹</em> &lt;æ“ä½œç¬¦&gt; <em class="kz">æ—¥æœŸ</em>ï¼Œä¾‹å¦‚ï¼Œä»”ç»†æƒ³æƒ³ï¼Œè¿™ç§è¡Œä¸ºæ˜¯å®Œå…¨åˆç†çš„ã€‚è¿™ä¸¤ä¸ªè¡¨å¯èƒ½æœ‰åç§°å†²çªçš„åˆ—ï¼Œè¿™ç§æœ¯è¯­æ’åºæ–¹å¼ä¾¿äºæ¶ˆé™¤æ­§ä¹‰ã€‚</p><h1 id="1efc" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">æ»šåŠ¨è¿æ¥</h1><p id="cf40" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">ä¸€ä¸ª<strong class="ju hi">æ»šåŠ¨è¿æ¥</strong>åœ¨è¡¨ä¹‹é—´åŒ¹é…ï¼Œå‘å‰ç»“è½¬æˆ–å‘å‰çœ‹ä¸‹ä¸€ä¸ªåŒ¹é…ï¼Œç›´åˆ°åŒ¹é…æ¡ä»¶å‘ç”Ÿå˜åŒ–ã€‚è®©æˆ‘ä»¬ç»§ç»­ä½¿ç”¨æˆ‘ä»¬çš„<em class="kz"> home_games </em>å’Œ<em class="kz"> september </em>è¡¨æ¥çœ‹ä¸€ä¸ªå…¬è®¤çš„äººä¸ºä¾‹å­ã€‚æˆ‘ä»¬å°†å»ºç«‹ä¸€ä¸ª9æœˆä»½æ‰€æœ‰æ—¥æœŸçš„åˆ—è¡¨ï¼Œå¯¹äºæ¯ä¸ªæ—¥æœŸï¼Œæˆ‘ä»¬å°†è·Ÿè¸ªæœ€åä¸€æ¬¡é¢å¯¹çš„ä¸»åœºå¯¹æ‰‹ã€‚å¾ˆéš¾æƒ³è±¡ä¸ºä»€ä¹ˆè¿™å¯èƒ½æœ‰ç”¨ï¼Œä½†æ˜¯å®ƒé”»ç‚¼äº†åŠŸèƒ½ã€‚</p><p id="115b" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">æé†’ä¸€ä¸‹ï¼Œä¸¤ä¸ªè¡¨ä¹‹é—´ç®€å•çš„å³å¤–è¿æ¥ä¼šåœ¨Visitorå­—æ®µä¸­äº§ç”Ÿé—´éš™ï¼Œè¿™äº›é—´éš™æ˜¯æˆ‘åœ¨ä¸Šä¸€èŠ‚ä¸­é€šè¿‡å°†<code class="du kq kr ks kt b">[!is.na(Visitor)]</code>æ·»åŠ åˆ°ä¸ç­‰å¼è¿æ¥çš„æœ«å°¾è€Œæ¶ˆé™¤çš„ã€‚æˆ‘ä»¬ç°åœ¨å¸Œæœ›ç”¨æœ€åå¡«å……çš„å€¼æ¥å¡«è¡¥è¿™äº›ç©ºç™½ã€‚</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="a977" class="lj iv hh kt b fi lk ll l lm ln"># Without !is.na(Visitor)</span><span id="86a5" class="lj iv hh kt b fi lo ll l lm ln">home_games[september, on = .(Date == date)]</span><span id="a61f" class="lj iv hh kt b fi lo ll l lm ln">##        Visitor       Date<br/>##         &lt;char&gt;     &lt;Date&gt;<br/>##  1:       &lt;NA&gt; 2021-09-01<br/>##  2:       &lt;NA&gt; 2021-09-02<br/>##  3:  Cleveland 2021-09-03<br/>##  4:  Cleveland 2021-09-04<br/>##  5:  Cleveland 2021-09-05<br/>##  6:  Tampa Bay 2021-09-06<br/>##  7:  Tampa Bay 2021-09-07<br/>##  8:  Tampa Bay 2021-09-08<br/>##  9:       &lt;NA&gt; 2021-09-09<br/>## 10:       &lt;NA&gt; 2021-09-10<br/>## 11:       &lt;NA&gt; 2021-09-11<br/>## 12:       &lt;NA&gt; 2021-09-12<br/>## 13:       &lt;NA&gt; 2021-09-13<br/>## 14:       &lt;NA&gt; 2021-09-14<br/>## 15:       &lt;NA&gt; 2021-09-15<br/>## 16:       &lt;NA&gt; 2021-09-16<br/>## 17:  Baltimore 2021-09-17<br/>## 18:  Baltimore 2021-09-18<br/>## 19:  Baltimore 2021-09-19<br/>## 20:       &lt;NA&gt; 2021-09-20<br/>## 21:    NY Mets 2021-09-21<br/>## 22:    NY Mets 2021-09-22<br/>## 23:       &lt;NA&gt; 2021-09-23<br/>## 24: NY Yankees 2021-09-24<br/>## 25: NY Yankees 2021-09-25<br/>## 26: NY Yankees 2021-09-26<br/>## 27:       &lt;NA&gt; 2021-09-27<br/>## 28:       &lt;NA&gt; 2021-09-28<br/>## 29:       &lt;NA&gt; 2021-09-29<br/>## 30:       &lt;NA&gt; 2021-09-30<br/>##        Visitor       Date</span></pre><p id="7f37" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">æˆ‘ä»¬åªè¦åœ¨ä¹‹å‰åŠ å…¥çš„åŸºç¡€ä¸ŠåŠ ä¸Š<code class="du kq kr ks kt b">roll = TRUE</code>å°±å¯ä»¥æŠŠä¸Šä¸€ä¸ªä¸»åœºå¯¹æ‰‹çš„åå­—å‘æ‰¬å…‰å¤§ã€‚</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="adfb" class="lj iv hh kt b fi lk ll l lm ln"># Roll the name of the last home opponent forward</span><span id="7fdd" class="lj iv hh kt b fi lo ll l lm ln">home_games[september, <br/>           on = .(Date == date), <strong class="kt hi">roll = TRUE</strong>]</span><span id="6519" class="lj iv hh kt b fi lo ll l lm ln">##        Visitor       Date<br/>##         &lt;char&gt;     &lt;Date&gt;<br/>##  1:       &lt;NA&gt; 2021-09-01<br/>##  2:       &lt;NA&gt; 2021-09-02<br/>##  3:  Cleveland 2021-09-03<br/>##  4:  Cleveland 2021-09-04<br/>##  5:  Cleveland 2021-09-05<br/>##  6:  Tampa Bay 2021-09-06<br/>##  7:  Tampa Bay 2021-09-07<br/>##  8:  Tampa Bay 2021-09-08<br/>##  9:  Tampa Bay 2021-09-09<br/>## 10:  Tampa Bay 2021-09-10<br/>## 11:  Tampa Bay 2021-09-11<br/>## 12:  Tampa Bay 2021-09-12<br/>## 13:  Tampa Bay 2021-09-13<br/>## 14:  Tampa Bay 2021-09-14<br/>## 15:  Tampa Bay 2021-09-15<br/>## 16:  Tampa Bay 2021-09-16<br/>## 17:  Baltimore 2021-09-17<br/>## 18:  Baltimore 2021-09-18<br/>## 19:  Baltimore 2021-09-19<br/>## 20:  Baltimore 2021-09-20<br/>## 21:    NY Mets 2021-09-21<br/>## 22:    NY Mets 2021-09-22<br/>## 23:    NY Mets 2021-09-23<br/>## 24: NY Yankees 2021-09-24<br/>## 25: NY Yankees 2021-09-25<br/>## 26: NY Yankees 2021-09-26<br/>## 27: NY Yankees 2021-09-27<br/>## 28: NY Yankees 2021-09-28<br/>## 29: NY Yankees 2021-09-29<br/>## 30: NY Yankees 2021-09-30<br/>##        Visitor       Date</span></pre><p id="33b0" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">é€šè¿‡æŒ‡å®š<code class="du kq kr ks kt b">roll = -Inf</code>å¯ä»¥åè½¬è¾Šçš„æ–¹å‘ã€‚</p><h1 id="ab0f" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">é‡å èŒƒå›´è¿æ¥</h1><p id="0a70" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å¸¦æœ‰èŒƒå›´å½¢å¼æ•°æ®çš„<code class="du kq kr ks kt b">data.table</code>ã€‚èŠ¬å¨çƒå°æŒ‰æ—¥æœŸèŒƒå›´åˆ—å‡ºäº†çº¢è¢œé˜Ÿçš„ä¸»åœºæ¯”èµ›ã€‚æ¯”æ–¹è¯´ï¼Œæˆ‘ä»¬æƒ³åœ¨ä¸»åœºæ¯”èµ›ä¸­å…³æ³¨æ‰¬åŸºé˜Ÿçš„å¯¹æ‰‹ã€‚<code class="du kq kr ks kt b">data.table</code>åŒ…æä¾›äº†<code class="du kq kr ks kt b">foverlaps()</code>å‡½æ•°æ¥é€šè¿‡é‡å èŒƒå›´è¿æ¥è¡¨ã€‚(å‡½æ•°åä¸­çš„â€˜fâ€™ä»£è¡¨å¿«é€Ÿã€‚å¯¹äº<code class="du kq kr ks kt b">fread()</code>ã€<code class="du kq kr ks kt b">fwrite()</code>ä»¥åŠè¿™ä¸ªåŒ…ä¸­å‡ ä¹æ‰€æœ‰å…¶ä»–ä»¥få¼€å¤´çš„å‡½æ•°ä¹Ÿæ˜¯å¦‚æ­¤ã€‚é€Ÿåº¦æ˜¯è¿™ä¸ªåŒ…çš„æ¸¸æˆåç§°ã€‚)</p><p id="6ffd" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">è®©æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªä¹æœˆæ´‹åŸºé˜Ÿå‰å‡ åœºæ¯”èµ›çš„è¡¨æ ¼ã€‚</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="1916" class="lj iv hh kt b fi lk ll l lm ln">yankees &lt;- fread(<br/>  "NYY Opponent, Start, End<br/>  Anaheim, 2021-09-01, 2021-09-01<br/>  Baltimore, 2021-09-03, 2021-09-05<br/>  Toronto, 2021-09-06, 2021-09-09"<br/>)</span><span id="01b7" class="lj iv hh kt b fi lo ll l lm ln">setkey(yankees, Start, End)</span></pre><p id="686f" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">é€šè¿‡é‡å æ—¥æœŸè¿æ¥è¿™ä¸¤ä¸ªè¡¨å†ç®€å•ä¸è¿‡äº†ã€‚(å›°éš¾çš„æ˜¯å°†è¾“å‡ºæ ¼å¼åŒ–ï¼Œä»¥ä¾¿åœ¨ä»‹è´¨ä¸Šè‰¯å¥½æ‰“å°ï¼Œä½†è¿™æ˜¯å¦ä¸€ä¸ªæ•…äº‹äº†ã€‚)</p><pre class="lb lc ld le fd lf kt lg lh aw li bi"><span id="3ced" class="lj iv hh kt b fi lk ll l lm ln">foverlaps(fenway, yankees)</span><span id="c403" class="lj iv hh kt b fi lo ll l lm ln">NYY Opponent  Start   End        Visitor    i.Start    i.End<br/>&lt;char&gt;     &lt;IDat&gt;     &lt;IDat&gt;     &lt;char&gt;     &lt;IDat&gt;     &lt;IDat&gt;<br/>Baltimore  2021-09-03 2021-09-05 Cleveland  2021-09-03 2021-09-05<br/>Toronto    2021-09-06 2021-09-09 Tampa Bay  2021-09-06 2021-09-08<br/>&lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       Baltimore  2021-09-17 2021-09-19<br/>&lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       NY Mets    2021-09-21 2021-09-22<br/>&lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       NY Yankees 2021-09-24 2021-09-26</span></pre><h1 id="c7d9" class="iu iv hh bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">ç»“è®º</h1><p id="9d71" class="pw-post-body-paragraph js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp ha bi translated">æ‰€ä»¥è¿™å°±æ˜¯æˆ‘æ‰€çŸ¥é“çš„(æˆ–è®¤ä¸ºæˆ‘çŸ¥é“çš„)å…³äºåŠ å…¥<code class="du kq kr ks kt b">data.table</code> sçš„å…¨éƒ¨æƒ…å†µã€‚</p><p id="c879" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">å°±åƒå®ƒä¹‹å‰çš„æ°å‡ºå‰è¾ˆRçš„<code class="du kq kr ks kt b">data.frame</code>ï¼Œ<code class="du kq kr ks kt b">data.table</code>åŒ…æ¿€å‘äº†Pythonä¸–ç•Œçš„æ¨¡ä»¿ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¿™é‡Œè®¨è®ºçš„ä¸€äº›å†…å®¹å¯èƒ½ä¼šå¯¹ä½ çš„Pythonå·¥ä½œæœ‰æ‰€å¸®åŠ©ã€‚</p><p id="6308" class="pw-post-body-paragraph js jt hh ju b jv ku jx jy jz kv kb kc kd kw kf kg kh kx kj kk kl ky kn ko kp ha bi translated">ä¸ç®¡æ˜¯ç”¨Rè¿˜æ˜¯ç”¨Pythonï¼Œå¸Œæœ›è¿™ç¯‡æ•™ç¨‹æœ‰æ‰€å¸®åŠ©ã€‚</p></div></div>    
</body>
</html>