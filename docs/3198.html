<html>
<head>
<title>Beating soccer odds using Machine Learning — Project Walkthrough</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习击败足球赔率——项目演练</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/beating-soccer-odds-using-machine-learning-project-walkthrough-a1c3445b285a?source=collection_archive---------1-----------------------#2021-06-18">https://medium.com/analytics-vidhya/beating-soccer-odds-using-machine-learning-project-walkthrough-a1c3445b285a?source=collection_archive---------1-----------------------#2021-06-18</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/2cc3892d63715c5d1cfe7a945aaa2800.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZJL5rneLzlyrv0gWlwepEQ.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">托马斯·塞勒在<a class="ae hv" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><div class=""/></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><p id="2d75" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">预测足球比赛是一项艰巨的任务，这对任何人来说都不是新闻。毕竟，你怎么能预测像足球这样不可预测的事情呢？基于这一挑战，我决定利用我的数据科学知识创建一个项目，以便不仅有令人满意的预测结果，而且还能击败庄家从我的预测中获利。</p></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><h1 id="df19" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">网页抓取</h1><p id="e80c" class="pw-post-body-paragraph jc jd hy je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hb bi translated">首先，我必须从足球比赛中获取尽可能多的数据。幸运的是，<a class="ae hv" href="https://www.oddsportal.com/" rel="noopener ugc nofollow" target="_blank">赔率门户</a>有近16年英超联赛赛季的比赛信息。</p><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ld"><img src="../Images/31b5a69964e636c403e7c59965679835.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wRSSri_HeTKMgVlGxCV60A.jpeg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">来源:<a class="ae hv" href="https://www.oddsportal.com/soccer/england/premier-league-2020-2021/results/" rel="noopener ugc nofollow" target="_blank"> Oddsportal </a></figcaption></figure><p id="f47f" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我是用两个Python库进行网页抓取从网站上得到数据的，<a class="ae hv" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" rel="noopener ugc nofollow" target="_blank"> <strong class="je hz"> BeautifulSoup </strong> </a>和<a class="ae hv" href="https://www.selenium.dev/docs/" rel="noopener ugc nofollow" target="_blank"> <strong class="je hz"> Selenium </strong> </a>。基本上，我在BeautifulSoup中完成了整个抓取结构，并使用Selenium点击下一页，因为这个库允许您像人一样在网页上执行操作。</p><p id="b185" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">经过搜集，我获得了从2005/2006赛季到2020/2021赛季的6077场英超联赛的数据，共有7列信息:</p><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es li"><img src="../Images/6ae9d849997d4b108039ac897b583edc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mVOLmDTO0C0MoNdJ4dqQUg.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">来源:<a class="ae hv" href="https://github.com/Caldass/pl-matches-predictor" rel="noopener ugc nofollow" target="_blank">我的Github代码</a></figcaption></figure><ul class=""><li id="6949" class="lj lk hy je b jf jg jj jk jn ll jr lm jv ln jz lo lp lq lr bi translated"><strong class="je hz">赛季</strong>:比赛的赛季。</li><li id="1786" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">日期:比赛日期。</li><li id="8717" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz"> match_name </strong>:“主队vs客场”字符串。</li><li id="807b" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz">结果</strong>:匹配结果。</li><li id="98d0" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz"> h_odd </strong>:主队的胜奇。</li><li id="0ef1" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz"> d_odd </strong>:画奇数。</li><li id="f5b9" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz"> a_odd </strong>:客场球队的赢球奇数。</li></ul></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><h1 id="3b62" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">数据清理</h1><p id="bee2" class="pw-post-body-paragraph jc jd hy je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hb bi translated">我已经有了一个非常干净的数据集，所以我只需要为下一步执行更加健壮的特征工程准备数据。在这一步中，我:</p><ul class=""><li id="fd89" class="lj lk hy je b jf jg jj jk jn ll jr lm jv ln jz lo lp lq lr bi translated">已将日期转换为日期时间。</li><li id="f759" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">改变奇数列浮动。</li><li id="eee0" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">获得一个季节的开始年份。</li><li id="dc41" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">将比赛名称分为主队和客场队。</li><li id="aa7a" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">将分数分为主客场分数。</li><li id="ddf3" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">使用匹配结果创建了特征。</li></ul><p id="c829" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">经过这些转换后，数据集看起来是这样的:</p><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lx"><img src="../Images/7a79982cfeb1791cad0f516dd0b9fc75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DAVc7HMLvY1cMC2_YOnSpQ.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">来源:<a class="ae hv" href="https://github.com/Caldass/pl-matches-predictor" rel="noopener ugc nofollow" target="_blank">我的Github代码</a></figcaption></figure></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><h1 id="405a" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">特征工程</h1><p id="a702" class="pw-post-body-paragraph jc jd hy je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hb bi translated">这是项目中最有影响力的部分之一。人们可以创建尽可能最好、最复杂的机器学习算法，随心所欲地堆叠和调整模型，但归根结底，一个简单的模型，其功能能够充分解释因变量和自变量之间的关系，将会更加高效。</p><p id="17ee" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">因为只有在比赛后才能获得比赛统计数据，所以要创建的特征必须基于比赛前获得的信息。</p><p id="b078" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">首先，我创建了常规的统计数据，比如在各个赛季的各个比赛日之前的胜场、输球、进球和球队排名。我还创建了一些功能，如最近3场比赛的平均进球和得分以及球队目前的胜败和平局。我最想尝试的功能是加权指数平均，根据这篇文章的说法，这可能很适合足球预测。</p><p id="0249" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">以下是特征工程过程后的数据集列信息:</p><figure class="le lf lg lh fd hk"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="af78" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">请注意，有些列包含空值。我将在稍后的模型构建阶段讨论它们。</p><p id="f2d9" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">所有的特性描述都在项目的<a class="ae hv" href="https://github.com/Caldass/pl-matches-predictor/blob/master/model_building/model.py" rel="noopener ugc nofollow" target="_blank"> Github repo </a>中一个名为<em class="ma"> "features.txt" </em>的文件中。</p></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><h1 id="90c5" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">电子设计自动化(Electronic Design Automation)</h1><p id="89c9" class="pw-post-body-paragraph jc jd hy je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hb bi translated">这里的目标是执行一个简短的数据探索，以便更好地理解因变量和自变量之间的关系。</p><p id="c868" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">数据集在目标变量中包含3个可能的类别，主队获胜、客场获胜和平局。这些班级的比例如下:</p><figure class="le lf lg lh fd hk er es paragraph-image"><div class="er es mb"><img src="../Images/23f7f5e14553e5b77c5c17b1d47141d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:458/format:webp/1*qcB3EwmBnDaGoSiVgCEPBQ.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">来源:<a class="ae hv" href="https://github.com/Caldass/pl-matches-predictor" rel="noopener ugc nofollow" target="_blank">我的Github回购</a></figcaption></figure><p id="70a4" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">有可能看到主导阶层是主队获胜，这是有道理的，因为众所周知，在足球比赛中，主队通常更有优势。</p><p id="e8fd" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">由此可以假设，预测平局比预测两支球队中的一支获胜更困难，因为75.45%的数据集包含两支球队中的一支获胜的比赛。</p><figure class="le lf lg lh fd hk er es paragraph-image"><div class="er es mc"><img src="../Images/c74bacf8182e298af00074d93d742277.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*qxqCx3hqFUgt_CyZwgRUBw.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">来源:<a class="ae hv" href="https://github.com/Caldass/pl-matches-predictor" rel="noopener ugc nofollow" target="_blank">我的Github回购</a></figcaption></figure><p id="2f81" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">在上图中，可以在单独的数据框架中看到与每个类相关的最高5个特征。我们可以通过假设如果一个变量上升，那么与它正相关的类发生的概率也上升来解释这些正相关。</p><p id="f964" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我们可以看到，在<em class="ma"> winner_h </em>和<em class="ma"> winner_a </em>数据帧(主场胜利和客场胜利)中，似乎影响班级发生的是另一个队的表现有多差。比如对方球队的赔率和排名就是相关度最高的。</p><p id="91ab" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">同时，在与其他两个数据帧相比相关性非常低的<em class="ma"> winner_d </em>数据帧(平局)中，可以看到与平局结果相关性更高的特征是表明主队表现如何的特征。</p><p id="47c0" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">在建模阶段，我使用了一个特征选择工具，稍后我会谈到它，并对该工具选择的13个特征的分布和散点图进行了简要分析。</p><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es md"><img src="../Images/dc614ccea81c0221c5b5efd9a82caee1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bLpN02Ml4iO9xdjAoEPA7w.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">来源:<a class="ae hv" href="https://github.com/Caldass/pl-matches-predictor" rel="noopener ugc nofollow" target="_blank">我的Github回购</a></figcaption></figure><p id="5344" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">在上面显示的直方图中，我们可以看到这些特征并不是正态分布的，而且比例也不同。这就是为什么我在建模阶段对它们应用了MinMaxScaler变换。</p><p id="792e" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">还可以通过配对图来查看特征之间的关系:</p><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es me"><img src="../Images/772838bb1856c5c4e328c7dfb20fe0bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*miilJFLnBoE4uU82a_4NGg.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">来源:<a class="ae hv" href="https://github.com/Caldass/pl-matches-predictor" rel="noopener ugc nofollow" target="_blank">我的Github回购</a></figcaption></figure><p id="9f10" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我们可以从这个图中观察到一些线性关系:</p><ul class=""><li id="b860" class="lj lk hy je b jf jg jj jk jn ll jr lm jv ln jz lo lp lq lr bi translated">w.e.a .分数与w.e.a .目标度量呈正相关，与w.e.a .目标遭受度量呈负相关，这非常合理。如果一支球队得分多，它就会进更多的球，遭受更少的球。</li><li id="1fa4" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">主队的赔率随着w.e.a .的积分而上升，客场队的w.e.a .进球也随之上升。也就是说客队得分越多，主队获胜的几率就越小。</li><li id="a25c" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">平局赔率也与两个队的赔率相关，可能是因为每场比赛都会有一个队的赔率更高，而平局赔率往往接近这个更高的赔率。</li><li id="8cf1" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">我们还可以看到一些明显的线性关系，比如主队odd随着客队排名的上升而下降。也就是说，客队在积分榜上的位置越低，主队获胜的几率就越高。</li></ul></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><h1 id="5a4f" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">模型结构</h1><p id="1372" class="pw-post-body-paragraph jc jd hy je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hb bi translated">首先，我删除了所有在比赛前不可用的功能，这些功能只是用来创建其他功能。</p><figure class="le lf lg lh fd hk"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="2167" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">对于具有空值的列，我用“-33”值填充它们，以帮助我们的模型解释它们。这样，我允许模型理解这些值为空是有原因的。例如，在“_rank”列中，如果一支球队没有最后一个排名，这要么是因为该比赛属于数据集中出现的第一个赛季，要么是因为该特定球队在上一个赛季中不在英超联赛中。</p><p id="427b" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">使用的型号:</p><ul class=""><li id="b2bc" class="lj lk hy je b jf jg jj jk jn ll jr lm jv ln jz lo lp lq lr bi translated"><strong class="je hz">逻辑回归</strong> —由于特征之间的线性关系，线性模型预期有效。</li><li id="b392" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz">随机森林分类器</strong> —由于数据的稀疏性，基于树的集成模型预期工作良好。</li><li id="609e" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz">梯度推进分类器</strong> —就像随机森林一样，由于数据的稀疏性，基于树的集成模型预计会工作得很好。</li><li id="6a9a" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz">K-最近邻分类器</strong> —非监督学习算法，通过对象的K个最近邻的多个投票对其进行分类。</li></ul><p id="fd7f" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">在训练模型之前，我将数据分为训练集和测试集，测试规模为20%，为“ls_winner”列创建虚拟列，并使用<a class="ae hv" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html" rel="noopener ugc nofollow" target="_blank"> sklearn MinMaxScaler </a>缩放所有功能。</p><p id="9f09" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">为了评估这些模型，我选择了准确性度量，因为模型的工作是预测精确的匹配结果，不管它属于哪个类。</p><p id="4e6f" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">准确度是正确预测的总数除以总预测数。它是我们模型中正确预测的比例。</p><p id="1afc" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">以下是经过训练的模型及其训练结果:</p><figure class="le lf lg lh fd hk er es paragraph-image"><div class="er es mf"><img src="../Images/bb417f0bf911fb6d26d9c0aa04bacb95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*gilITNSyUUABX6D88aJqGg.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">来源:<a class="ae hv" href="https://github.com/Caldass/pl-matches-predictor" rel="noopener ugc nofollow" target="_blank">我的Github回购</a></figcaption></figure><p id="e779" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">尽管准确性水平不是太高，但重要的是要注意到，最好的模型比随机预测或“<em class="ma">主队总是赢</em>”预测表现得更好，这意味着我们的模型能够解释一些数据。</p><figure class="le lf lg lh fd hk er es paragraph-image"><div class="er es mg"><img src="../Images/228dcca3cb1bf3f0683ce51171f7492e.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*rN827lTzeRdcRWmB9727_w.jpeg"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">来源:<a class="ae hv" href="https://github.com/Caldass/pl-matches-predictor" rel="noopener ugc nofollow" target="_blank">我的Github回购</a></figcaption></figure><p id="5586" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">鉴于逻辑回归具有最佳的训练结果，它是建模阶段的重点模型。</p><p id="d093" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">由于总共有40多个特征，我使用<a class="ae hv" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.RFE.html" rel="noopener ugc nofollow" target="_blank">递归特征消除(RFE) </a>方法进行了特征选择。</p><p id="77bf" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">功能选择对以下方面很重要:</p><ul class=""><li id="a57d" class="lj lk hy je b jf jg jj jk jn ll jr lm jv ln jz lo lp lq lr bi translated">增加模型的可解释性。</li><li id="ca18" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">减少训练时间。</li><li id="7699" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">避免<a class="ae hv" href="https://en.wikipedia.org/wiki/Curse_of_dimensionality" rel="noopener ugc nofollow" target="_blank">维数灾难</a>。</li><li id="b1ed" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">减少过度拟合。</li></ul><p id="fd0b" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">所使用的方法通过递归地考虑越来越小的特征集来选择特征。在该图中，可以看到所使用的特征数量与逻辑回归的准确度之间的关系:</p><figure class="le lf lg lh fd hk er es paragraph-image"><div class="er es mh"><img src="../Images/8cae9ac7956886d58883e9175a12fd7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*4q3gcRnzTT3EGcpQrnithQ.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated"><a class="ae hv" href="https://github.com/Caldass/pl-matches-predictor" rel="noopener ugc nofollow" target="_blank">来源:我的Github回购</a></figcaption></figure><p id="945f" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">不仅有可能将准确度保持在令人满意的水平，而且甚至有可能提高某些特征的准确度。我选择了13个作为理想的特征数，这样我们可以有更多的可解释性，并且与使用所有特征相比，精确度差异最小。</p><p id="d36b" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">这些是选择的功能:</p><ul class=""><li id="6478" class="lj lk hy je b jf jg jj jk jn ll jr lm jv ln jz lo lp lq lr bi translated">h _奇数</li><li id="c7a9" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">d _奇数</li><li id="c7a6" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">奇怪的</li><li id="fd90" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">ht_rank</li><li id="943f" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">排名</li><li id="e808" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">高温点</li><li id="84fe" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">在l点</li><li id="c063" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">at_l_wavg_points</li><li id="4cee" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">at _ l _ wavg _目标</li><li id="cc96" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">at_l_wavg_goals_sf</li><li id="b3a9" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">连胜</li><li id="bb1c" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">ls_winner_-33</li><li id="021d" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated">ls _赢家_主场_球队</li></ul><p id="c8d7" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">我们可以观察到所有的赔率特征都被选择了。这凸显了它们的重要性。这是可以理解的，因为博彩公司在创造赔率和预测比赛方面做得很好。我们还可以注意到，在最近3场比赛的平均分数旁边，显示了带有排名信息的特征。</p><p id="c56a" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">加权指数平均特性也进入了前13名，但只是在客场球队方面。</p><p id="7936" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">请注意,“ls_winner_-33”意味着两支球队之间没有最后一场比赛，这显然对陈述比赛结果也很重要。</p></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><h1 id="c379" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated"><strong class="ak">模拟投资</strong></h1><p id="faf8" class="pw-post-body-paragraph jc jd hy je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hb bi translated">在这里，我使用测试数据，通过模型的预测和比赛的赔率来模拟对博彩市场的投资。</p><p id="db8b" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">该模拟包含1216个匹配的测试数据。我达成了每场比赛100美元的虚构投资，总投资为121，600美元。</p><p id="d0b8" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">下面是模型的执行方式:</p><figure class="le lf lg lh fd hk er es paragraph-image"><div class="er es mi"><img src="../Images/e0c042c75e123b4a41eb7dacba03c41b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*NWxkuzJsdV-_yj4_O2oa_Q.jpeg"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">来源:<a class="ae hv" href="https://github.com/Caldass/pl-matches-predictor" rel="noopener ugc nofollow" target="_blank">我的Github回购</a></figcaption></figure><p id="8ba0" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">值得注意的是，KNN算法也有收益，尽管它在训练阶段的准确性是4种算法中最差的。</p><p id="1c45" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">为了理解为什么KNN模型有利润而其他两个模型没有，我们需要澄清什么是精度、召回和F1分数:</p><ul class=""><li id="1e78" class="lj lk hy je b jf jg jj jk jn ll jr lm jv ln jz lo lp lq lr bi translated"><strong class="je hz">精度</strong>:在所有预测的阳性中，有多少是实际阳性？</li><li id="ed52" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz">回忆</strong>:在所有的阳性结果中，模型说它是阳性的有多少？</li><li id="724d" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz"> F1-score </strong>:精度和召回率的调和平均值。</li></ul><p id="6dea" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">请注意，这些度量是为每个类计算的，因此度量考虑了引用的类1(正类)和其他两个类0(负类)。</p><p id="4720" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">以下是各型号的<a class="ae hv" href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html" rel="noopener ugc nofollow" target="_blank">分类报告</a>:</p><figure class="le lf lg lh fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es mj"><img src="../Images/0bf57614daa5f948fb421530bf2fb724.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EoMYuD9osUE1BtnGAbV0FQ.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">来源:<a class="ae hv" href="https://github.com/Caldass/pl-matches-predictor" rel="noopener ugc nofollow" target="_blank">我的Github回购</a></figcaption></figure><p id="90d3" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">0类是平局，1类是客队获胜，2类是主队获胜。</p><p id="e16b" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">可以看出，尽管KNN模型的准确性最低，但在所有模型中，它在绘图类中的F1得分最高。除此之外，它几乎有50%的准确性，在获奖类别中的F1分数与其他型号相差不远。这就是为什么这个模型在预测中仍然有利润。</p><p id="0eaf" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">逻辑回归没有正确预测任何平局类的出现，可能是因为没有太多的线性关系指出平局结果。但是它仍然有利润，因为它很好地预测了获胜的类。</p></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><h1 id="5f3d" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">生产化</h1><p id="2409" class="pw-post-body-paragraph jc jd hy je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hb bi translated">这里，我构建了一个Flask API端点，并将其部署到一个Heroku应用程序中。</p><p id="e555" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">该应用可在<a class="ae hv" href="https://pl-matches-predictor.herokuapp.com/predict" rel="noopener ugc nofollow" target="_blank">https://pl-matches-predictor.herokuapp.com/predict</a>获得并托管。输入应该如下所示:</p><ul class=""><li id="a037" class="lj lk hy je b jf jg jj jk jn ll jr lm jv ln jz lo lp lq lr bi translated"><strong class="je hz"> h_odd </strong> —代表主队中奖奇数的浮点数。</li><li id="7435" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz"> a_odd </strong> —代表客队中奖奇数的浮点数。</li><li id="8bee" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz"> d_odd </strong> —代表抽签奇数的浮点数。</li><li id="565e" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz"> ht_rank </strong> —代表主队当前排名的整数。</li><li id="1c6a" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz"> at_rank </strong> —代表客队当前排名的整数。</li><li id="339d" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz"> ht_l_points </strong> —最近3场比赛主队平均积分。</li><li id="840a" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz"> at_l_points </strong> —最近3场比赛的平均客场球队积分。</li><li id="43fe" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz"> at_l_wavg_points </strong> —加权指数平均客场球队最近3场比赛的积分。</li><li id="d04a" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz"> at_l_wavg_goals </strong> —近3场比赛加权指数平均客场进球。</li><li id="fcb2" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz"> at_l_wavg_goals_sf </strong> —加权指数平均近3场比赛客场进球。</li><li id="4cce" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz"> at_win_streak </strong> —代表客场球队当前连胜的整数。</li><li id="38f4" class="lj lk hy je b jf ls jj lt jn lu jr lv jv lw jz lo lp lq lr bi translated"><strong class="je hz"> ls_winner </strong> —两队之间最后一场比赛的胜者(“主队”、“客场队”、“平局”)。如果没有最后一个匹配，请不要填写此输入。</li></ul><p id="a0c1" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">请求的输出是包含“预测”列的数据帧，该列具有匹配的预测结果。</p><p id="9d7f" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">下面是请求的Python示例:</p><figure class="le lf lg lh fd hk"><div class="bz dy l di"><div class="ly lz l"/></div></figure></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><h1 id="4db4" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">丰富</h1><p id="a97a" class="pw-post-body-paragraph jc jd hy je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hb bi translated">在未来，如果我试图在利润和准确性水平上实现改进，我可能不会使用逻辑回归。尽管这个项目中的其他模型没有L.R .的利润，但它们显示出预测所有3类结果的更大潜力。</p><p id="b21c" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">此外，创建新的功能和添加外部数据，如有多少球迷在场，以及游戏统计，如投篮命中率和犯规，可能有助于提高准确性和利润水平。</p></div><div class="ab cl iv iw gp ix" role="separator"><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja jb"/><span class="iy bw bk iz ja"/></div><div class="hb hc hd he hf"><h1 id="63a8" class="ka kb hy bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">结论</h1><p id="e89a" class="pw-post-body-paragraph jc jd hy je b jf ky jh ji jj kz jl jm jn la jp jq jr lb jt ju jv lc jx jy jz hb bi translated">尽管预测足球比赛不是一件容易的事情，但我发现这个项目的结果非常令人满意，因为它不仅有可能比随机预测或“<em class="ma">主队总是赢</em>”预测更好的准确度。但也有可能战胜困难，根据模型预测，投资模拟的利润率约为4.81%。</p><p id="2112" class="pw-post-body-paragraph jc jd hy je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz hb bi translated">如果你想看到更多关于这个项目的细节或者为它做贡献，请查看它的<a class="ae hv" href="https://github.com/Caldass/pl-matches-predictor" rel="noopener ugc nofollow" target="_blank"> Github repo！</a></p></div></div>    
</body>
</html>