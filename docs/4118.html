<html>
<head>
<title>Math Behind Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逻辑回归背后的数学</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/math-behind-logistic-regression-4c8ecb106fb2?source=collection_archive---------8-----------------------#2021-08-28">https://medium.com/analytics-vidhya/math-behind-logistic-regression-4c8ecb106fb2?source=collection_archive---------8-----------------------#2021-08-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="67b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我们理解逻辑回归中使用的奇怪符号之前，让我们回忆一下这种技术的基本思想。</p><blockquote class="jc jd je"><p id="7dff" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">逻辑回归是一种广泛用于分类问题的机器学习技术。</p></blockquote><p id="934c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上面的定义表明该算法对于除分类之外的问题也是有用的，例如回归。但是本文将只围绕分类展开。</p><blockquote class="jc jd je"><p id="a3fb" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">一个分类问题是什么样子的？</p></blockquote><p id="a860" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">假设我们做了一项调查，询问印度男性的年龄和婚姻状况。令我们惊讶的是，我们随机选择的男性要么已婚，要么未婚——没有离婚者或鳏夫。</p><p id="a8dd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，我们将数据编译成表格形式，如表1所示。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es jj"><img src="../Images/22918a62343692097846153a5a773856.png" data-original-src="https://miro.medium.com/v2/resize:fit:322/format:webp/1*e7SkCJG3DP1wjchBKSiCjw.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">表1:印度男性的婚姻状况</figcaption></figure><p id="8fd8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">显然，这项调查包括了16岁至36岁的男性。年龄条目的零(' 0 ')表示该男子“未婚”。同样，1表示相关的男人已经“结婚”了。</p><blockquote class="jc jd je"><p id="2f0d" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">你会如何看待一个29岁的男人？已婚还是未婚？</p></blockquote><p id="1145" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上面问的问题是一个典型的分类问题，逻辑回归有望解决。</p><blockquote class="jc jd je"><p id="c301" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">逻辑回归对分类问题没有直接的答案。</p></blockquote><p id="f946" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">是的，不要指望逻辑回归会以一种直截了当的方式回答问题。相反，逻辑回归说:</p><blockquote class="jc jd je"><p id="4cd4" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">假设一个男人29岁“结婚”的概率是<strong class="ig hi"> <em class="hh"> p </em> </strong>，其中<strong class="ig hi"> <em class="hh"> p </em> </strong>是介于0和1之间的数，包括0和1。</p></blockquote><p id="3e85" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在数学语言中，上面引用的语句可以表示为:</p><p id="a9a8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Pr(status= '已婚' |age=29)或者简而言之就是<strong class="ig hi"> p </strong> (age=29)，其中<strong class="ig hi"> p </strong>是一个概率值，基本上位于0和1之间(包括0和1)。</p><p id="79b8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我们将表1中的数据绘制成X轴上的年龄和Y轴上的状态，然后在这些数据上拟合一条线，我们将得到如图1所示的结果。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es jv"><img src="../Images/8a08ac371fc31b3a5bb5dc5dbf808c88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*7BXO9V_9TPxsDA9vQ98o3Q.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">图1:地位与年龄(线性回归和逻辑回归)</figcaption></figure><p id="f1b6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">图1中显示的红色虚线标记了概率值0.5。棕色线与X轴成45度角(大约),是通过普通最小二乘法(OLS)将状态回归到年龄后得到的拟合线。棕色线提供了一个吸引人的方法，根据年龄对印度男性的地位进行分类。例如，要找到一个25岁男子的类别，我们在X轴上画一条穿过标记25的垂线。垂线可能会在状态值为0.3的点处接触棕色线。因此，对于一个25岁的男人来说，他结婚的概率是0.3。现在这取决于我们，我们认为0.3的概率值足以将一个男人归类为已婚或未婚。最合理的阈值是0.5，即如果<strong class="ig hi"> p </strong>(年龄=25)值大于0.5，我们就把一个男人归为已婚；否则，未婚。</p><blockquote class="jc jd je"><p id="1c77" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">这种基于线性回归的分类方法存在问题。</p></blockquote><ol class=""><li id="fa51" class="jw jx hh ig b ih ii il im ip jy it jz ix ka jb kb kc kd ke bi translated">对于年龄值16和18，相应的状态值为负，这是不可接受的，因为概率值永远不会为负(或大于1)。</li><li id="e928" class="jw jx hh ig b ih kf il kg ip kh it ki ix kj jb kb kc kd ke bi translated">你可能会说，如果我们用0代替负值，用1代替大于1的值，那么问题就解决了。不，问题不会得到解决。在这种情况下，误差值不会呈正态分布，因为只有两个响应值。为了执行线性回归，假设误差项必须是正态分布的。这种假设是违反的。</li></ol><p id="397e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这种数学上的尴尬局面是可以避免的，如果我们对任何实数域使用一个保证其范围限制在0和1(包括0和1)之间的函数。</p><p id="5e94" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">其中一个功能是“逻辑功能”。逻辑函数有其签名的“S”曲线，如图1中绿色所示。可以看出，对于较小的年龄值，棕色线给出负值，但绿色曲线从未侵入负区。逻辑函数的形式如图2所示。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es kk"><img src="../Images/03aabdf9b9f00565eb4425730db8784f.png" data-original-src="https://miro.medium.com/v2/resize:fit:302/format:webp/1*XYtUTTTbQOHez5rRGh-mgQ.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">图2:逻辑功能</figcaption></figure><p id="3a46" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">类似于图1所示棕色线的候选线将具有以下形式的方程:</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es kl"><img src="../Images/227115a56a04a5d07f271144fc604c8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:334/format:webp/1*jCfLkrKDCAJXmjsi51oGgg.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">图3:地位和年龄之间的线性方程</figcaption></figure><p id="efd3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于图2中的RHS总是给出一个在[0，1]范围内的数字，因此，我们可以认为f(X)是概率值。从图1中，我们可以看到逻辑曲线提供了每个年龄值的概率(或状态值)。根据这些信息以及图2和图3中的等式，我们写出</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es km"><img src="../Images/d4b8a9a23270f2e9732ffc247176a9a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*ym1WMoP0WGdacFhS5a_QbA.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">图4:主方程</figcaption></figure><p id="489c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在剩下的唯一任务是估计图4所示等式中的参数β0和β1。在逻辑回归中，估计参数最常用的方法是“最大似然”法。</p><blockquote class="jc jd je"><p id="f403" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">最大似然法的工作原理是找到两个参数β0和β1，使主方程(图4)中的概率值尽可能接近实际状态值。</p></blockquote><p id="1e97" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">应用最大似然法后，我们得到的两个值是β0=-9.8和β1=0.33。将这些参数值放入表1中不同年龄值的主方程中，我们得到表2。我们使用0.5的阈值，即任何大于0.5的概率值将意味着预测的状态是1(已婚)；否则男方未婚。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es kn"><img src="../Images/763768c91bc7f0d46a6784d228bdc330.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*VbyfPZJ4tYJNibjRw-KlxQ.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">表2:使用阈值0.5预测的概率和状态</figcaption></figure><p id="cdcb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们观察到预测的状态值非常类似于实际的状态值，并且对于给定的数据，训练的模型具有(10/12)*100=83.3 %的准确度。我们绘制了表2中的概率值，以获得图1中的绿色曲线。</p><blockquote class="jc jd je"><p id="7cbd" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">计算决策边界</p></blockquote><p id="b928" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">超过0.5的概率值，我们将男性归类为已婚(或1)，在0.5或以下，我们将其归类为未婚；所以我们把p(年龄)=0.5放在主方程里。我们得到，年龄=-β0/β1。对于，β0=-9.8，β1=0.33，我们得到年龄=29.7，即对于给定的问题，决策边界在年龄=29.7，这从图1(黑线)中可以明显看出。请注意，这里的决策边界只是一个点，因为只有一个预测值，如果预测值是二维的，则同样是一条线，等等。</p><blockquote class="jc jd je"><p id="5cbe" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">模型解释</p></blockquote><p id="8afc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从图4中的主方程，我们可以得到</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es ko"><img src="../Images/ad3a1f4b0712322f962603d25806a1a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*ZsoCLGpxQZnE64yWxbQlQA.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">图5:奇怪的形式</figcaption></figure><p id="90c3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在图5给出的等式两边取自然对数，我们得到:</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es kp"><img src="../Images/c18695053907ebadc2180923766c6592.png" data-original-src="https://miro.medium.com/v2/resize:fit:506/format:webp/1*mhwzann_857mAIzTXih2aw.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">图6:对数奇数形式</figcaption></figure><p id="40ee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">图5中的LHS称为赔率。这些赔率提供了一种赌博式的方法来表示成功的可能性。举个例子，如果我说我的马有2/1的赔率赞成赢得当前的比赛，你的解读应该是在三场比赛中，这匹马会赢两场，输一场。图6的LHS给出了比值的对数或对数-比值(或logit)。我们看到，逻辑回归模型(图4)的logit在年龄上是线性的。</p><p id="68d8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jf">推导图6中方程的目的是，该方程为我们提供了一条符合logit的直线；这比针对概率拟合非线性“S”形曲线更方便。</em></p><blockquote class="jc jd je"><p id="2591" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">如果年龄改变一个单位，logit将改变β1个单位。</p></blockquote><p id="980f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于，β1可以表示为log(e^β1)，我们说年龄的一个单位变化将几率乘以e^β1(图7)。</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es kq"><img src="../Images/09a23f9bb0738c3097fa82265744d1db.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*BzNnHz3wL1Rd5aNrs2d5Ag.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">图7:年龄的一个单位变化乘以e^β1的几率</figcaption></figure><blockquote class="jc jd je"><p id="a180" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">如果有两个或两个以上的预测者呢？</p></blockquote><p id="c2e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您的数据集中有多个预测值，您将调整线性方程并相应地添加参数和预测值。例如，如果你的数据集中有三个预测因素(年龄、工资和性别)，线性方程将采用以下形式:</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es kq"><img src="../Images/12002df52ca6b75051163ed3d7432bd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*mH_a6qxvnrq8p4DLgGBl6Q.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">图8:三个预测因子的线性方程</figcaption></figure><p id="707f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">图4中的主方程也将相应地改变。</p><blockquote class="jc jd je"><p id="d4bd" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">如果有两个以上的响应类怎么办？</p></blockquote><p id="8e97" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">虽然逻辑回归中的两类分类机制可以扩展到多类分类，但在这种情况下模型的参数估计往往是不稳定的。因此，我们求助于其他分类技术，如线性判别分析。</p><blockquote class="jc jd je"><p id="7cdb" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">在逻辑回归的情况下，成本函数是什么？</p></blockquote><p id="d499" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们进行逻辑回归的目的是从图4的等式中找出参数β0和β1。</p><p id="0665" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">虽然β0和β1可以取无穷多个值，但我们应该估计参数的最佳可能值。为此，我们需要将一些寻找最佳可能值的标准映射到数学函数中。我们进一步优化该函数，以获得β0和β1的最佳可能值。</p><p id="81b2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里的标准是“β0和β1应该是这样的:对于响应为1的所有观测数据，主方程中的LHS应该尽可能接近1，对于响应为0的所有观测数据，主方程中的应该尽可能接近0”。</p><p id="68dd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们理解并细化我们刚刚讨论过的部分标准:</p><p id="98a4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第1部分:对于我们数据中所有响应为1的实例，如果我们将概率值(图4中的LHS)相乘，乘积应该尽可能接近1。</p><p id="1cd8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第2部分:对于我们数据中的所有响应为0的实例，如果我们将概率值(图4中的LHS)相乘，乘积应该尽可能接近0。或者，如果我们将1个概率值相乘，乘积应该尽可能接近1。</p><p id="06bc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第3部分:第1部分和第2部分的乘积应尽可能接近1。</p><p id="448d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第3部分在数学上可以表示为:</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es kr"><img src="../Images/589a6a4a3f93b8e698b1f7263a0ba97c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*ORV-1g83qP5ycvdP0WkBiQ.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">图9:可能性函数</figcaption></figure><p id="25a5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里，“L”代表似然函数。</p><p id="784a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">图9中的等式可以更方便地写成:</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es ks"><img src="../Images/c21387927036e245119ebe0bc895456d.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*E20_K_c8yVN8ZwsCoPI_6g.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">图10:似然函数(方便的形式)</figcaption></figure><p id="a511" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们也取图10中等式两边的对数，我们得到:</p><figure class="jk jl jm jn fd jo er es paragraph-image"><div class="er es kt"><img src="../Images/8fbda6a19c76bb680e06d443bd7dd041.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*G-xAXzzNFEEtfN3AVQly8A.png"/></div><figcaption class="jr js et er es jt ju bd b be z dx translated">图11:图10中等式的对数似然版本</figcaption></figure><p id="350f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里，'ℓ'是对数似然函数，统计学家更喜欢用它来优化。</p><p id="8967" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">{ <strong class="ig hi">注意</strong>ℓ是β0和β1的函数，从图4的等式中放入p(age)就可以出现在图11的等式中。}</p><p id="da82" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，'ℓ'代表收益函数(与成本函数相反)，为了获得参数β0和β1的值，收益函数必须最大化。</p></div></div>    
</body>
</html>