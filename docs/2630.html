<html>
<head>
<title>Paper Explained — DeepTrax: Embedding Graphs of Financial Transactions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">论文解释— DeepTrax:嵌入金融交易图</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/paper-explained-deeptrax-embedding-graphs-of-financial-transactions-3a9b6f5df1c0?source=collection_archive---------1-----------------------#2021-05-09">https://medium.com/analytics-vidhya/paper-explained-deeptrax-embedding-graphs-of-financial-transactions-3a9b6f5df1c0?source=collection_archive---------1-----------------------#2021-05-09</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="2ee3" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">嵌入在源自事务的二分图上训练，用于下游任务和可视化</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/b425292475100ab00adbf737d313d5a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b8FULvzwhGUIKSxwXzVrvQ.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">来源:向量空间中单词表示的有效估计(<a class="ae jm" href="https://arxiv.org/pdf/1301.3781.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1301.3781.pdf</a>)</figcaption></figure><h1 id="8960" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">在本文中</h1><ul class=""><li id="1518" class="kf kg hh kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">二分图来源于信用卡交易。如果在特定时间窗口内，一个账户的两笔交易被表示为{商家，账户，商家}，那么这两个商家构成了二分图中的一条边。</li><li id="f070" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">该图用于训练跳格嵌入。</li><li id="f8d3" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">嵌入被发现将相似的商家聚集在一起。</li><li id="a336" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">对于下游任务，基于品牌的嵌入比原始的商家嵌入表现得更好。</li></ul><p id="c9ec" class="pw-post-body-paragraph lc ld hh kh b ki le ii lf kk lg il lh km li lj lk ko ll lm ln kq lo lp lq ks ha bi translated">这项研究是在第一资本完成的，全文可以在https://arxiv.org/abs/1907.07225的T2找到。</p><h1 id="151d" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">概述</h1><ul class=""><li id="d494" class="kf kg hh kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">介绍</li><li id="af4c" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">数据</li><li id="ba73" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">嵌入的DeepTrax方法</li><li id="e6d4" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">损失函数</li><li id="114a" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">性能指标</li><li id="35ef" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">结果</li></ul><h1 id="ec5c" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">介绍</h1><p id="4b45" class="pw-post-body-paragraph lc ld hh kh b ki kj ii lf kk kl il lh km lr lj lk ko ls lm ln kq lt lp lq ks ha bi translated">客户和商家之间的交易创建了两个组的二分图；每条边代表一次交易。</p><p id="9b4f" class="pw-post-body-paragraph lc ld hh kh b ki le ii lf kk lg il lh km li lj lk ko ll lm ln kq lo lp lq ks ha bi translated">一般来说，一个帐户或客户会在一段时间内与不同的商家进行多次交易。在合理的时间窗口内与多个商家的交易可能揭示这些商家之间的有意义的关系，或者揭示关于顾客本身的一些情况。这是使用事务派生嵌入的基本思想。</p><h1 id="feeb" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">数据</h1><p id="69bd" class="pw-post-body-paragraph lc ld hh kh b ki kj ii lf kk kl il lh km lr lj lk ko ls lm ln kq lt lp lq ks ha bi translated">按照上述思路，最简单的单位是一个账户在特定时间窗口内的一对交易。这可以表示为{Merchant_x，Account，Merchant_y}。在交易图中，这种序列可以通过从商家开始的两次跳跃来生成。从这些序列中的每一个，现在你可以得到一个同质的商人二分图，{Merchant_x，Merchant_y}代表一条边。</p><p id="a823" class="pw-post-body-paragraph lc ld hh kh b ki le ii lf kk lg il lh km li lj lk ko ll lm ln kq lo lp lq ks ha bi translated">在实践中，您可以查询数据库中某个帐户在指定时间窗口内的所有交易，并创建与某个帐户交易的商户对。这是用于训练论文中的嵌入的数据。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lu"><img src="../Images/ee91509ac4b2c392197d85312a4807a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VJoZ00DuneELqvH9wrAyWA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">DeepTrax模型管道</figcaption></figure><h1 id="22f0" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">嵌入的DeepTrax方法</h1><p id="745c" class="pw-post-body-paragraph lc ld hh kh b ki kj ii lf kk kl il lh km lr lj lk ko ls lm ln kq lt lp lq ks ha bi translated">如果您熟悉经典的Word2Vec技术，那么本文的其余部分就很简单了。上述数据用于训练跳格模型。训练两种类型的嵌入</p><ol class=""><li id="142d" class="kf kg hh kh b ki le kk lg km lv ko lw kq lx ks ly ku kv kw bi translated">原始商户名称附加邮政编码</li><li id="9708" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ly ku kv kw bi translated">品牌级别的商家名称，将所有特许经营汇总到同一名称</li></ol><p id="67f7" class="pw-post-body-paragraph lc ld hh kh b ki le ii lf kk lg il lh km li lj lk ko ll lm ln kq lo lp lq ks ha bi translated">经过训练的跳格模型的亮点:</p><ul class=""><li id="8d07" class="kf kg hh kh b ki le kk lg km lv ko lw kq lx ks kt ku kv kw bi translated">每天交易少于50笔的商户将被删除</li><li id="9049" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">针对线下和线上商家分别培训模型。这是合乎逻辑的，因为在线商家不受地理位置的限制，而线下商家则受地理位置的限制，因此线下购物在本质上可能会有很大的不同。</li><li id="b2be" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">负样本是随机选取的，同时确保实际节点不存在采样案例。</li><li id="f0e2" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">该模型将捕捉商家之间的一阶邻近关系。如果仔细推导出较大的序列，就可以推导出更高阶的关系。</li></ul><h1 id="4eff" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">损失函数</h1><p id="49b0" class="pw-post-body-paragraph lc ld hh kh b ki kj ii lf kk kl il lh km lr lj lk ko ls lm ln kq lt lp lq ks ha bi translated">优化问题和损失函数由下式给出</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es lz"><img src="../Images/2f01e90766c9139c3264710a7f6b28af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*OismQ6Ff5dYXWOmxk2cMWg.png"/></div></figure><p id="9633" class="pw-post-body-paragraph lc ld hh kh b ki le ii lf kk lg il lh km li lj lk ko ll lm ln kq lo lp lq ks ha bi translated">注意，这类似于交叉熵损失。<em class="ma"> k </em>为阴性样本数。</p><h1 id="277e" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">性能指标</h1><ul class=""><li id="2539" class="kf kg hh kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">AUC和F1分数被用作链路预测下游任务的性能度量。</li><li id="f6d7" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks kt ku kv kw bi translated">嵌入通过二维t-SNE图进行定性分析</li></ul><h1 id="140e" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">结果</h1><h2 id="06fd" class="mb jo hh bd jp mc md me jt mf mg mh jx km mi mj jz ko mk ml kb kq mm mn kd mo bi translated">数量的</h2><ul class=""><li id="ac2e" class="kf kg hh kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">基于品牌的嵌入性能在链接预测的下游任务中是优越的。</li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mp"><img src="../Images/ff9a18d8db9b591f4fb69629535da8eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*4OiVqwnv5RHgFUOo8bZL_A.png"/></div></figure><ul class=""><li id="280b" class="kf kg hh kh b ki le kk lg km lv ko lw kq lx ks kt ku kv kw bi translated">另一个有趣的观察结果是，对大量时期的训练可能会导致过度拟合和由下游任务定量建立的嵌入质量下降。</li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mq"><img src="../Images/d3be2d34baf803d139bb9a9f91166a0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*x0AHhagaxcCCtp1OGmxoRg.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">注意，对于更大的时期，链路预测AUC降低</figcaption></figure><ul class=""><li id="fb3e" class="kf kg hh kh b ki le kk lg km lv ko lw kq lx ks kt ku kv kw bi translated">随着嵌入维数的增加，可以更清楚地观察到嵌入维数的类似过拟合。</li></ul><h2 id="fd94" class="mb jo hh bd jp mc md me jt mf mg mh jx km mi mj jz ko mk ml kb kq mm mn kd mo bi translated">定性的</h2><ul class=""><li id="7fab" class="kf kg hh kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">发现训练的嵌入将相似的商家聚集在一起。下面是一些例子</li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mr"><img src="../Images/b1032d5efe899aa727755f8fba88eca3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*_8M8bhhxcguu0sdThU0z8w.png"/></div></figure><ul class=""><li id="35fb" class="kf kg hh kh b ki le kk lg km lv ko lw kq lx ks kt ku kv kw bi translated">作者还发现，嵌入物在其中编码了价格信息，高端和低端品牌通过价格方向相关联。</li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ms"><img src="../Images/bb95961b3a2d6f05a59b13231ca33d64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*tbl1hFt0zRIKMnMXcIa-DQ.png"/></div></figure><h1 id="e198" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">参考</h1><ol class=""><li id="45d7" class="kf kg hh kh b ki kj kk kl km kn ko kp kq kr ks ly ku kv kw bi translated">DeepTrax:嵌入金融交易图(【https://arxiv.org/abs/1907.07225】T2)</li><li id="e002" class="kf kg hh kh b ki kx kk ky km kz ko la kq lb ks ly ku kv kw bi translated">向量空间中单词表示的有效估计(【https://arxiv.org/abs/1301.3781】T4</li></ol></div></div>    
</body>
</html>