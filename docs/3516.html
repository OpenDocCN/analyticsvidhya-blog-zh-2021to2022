<html>
<head>
<title>Data Visualization using FastAPI and EasyCharts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用FastAPI和EasyCharts实现数据可视化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-visualization-using-fastapi-and-easycharts-493eda3b1f3d?source=collection_archive---------1-----------------------#2021-07-06">https://medium.com/analytics-vidhya/data-visualization-using-fastapi-and-easycharts-493eda3b1f3d?source=collection_archive---------1-----------------------#2021-07-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/1724741be79689f35f01c52e6ae80ddf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*acHzWca8y08SEVz1.png"/></div></figure><figure class="in io ip iq fd ij er es paragraph-image"><div class="er es im"><img src="../Images/f9f6fc8ff99b8f15ab512ca44abdc783.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/0*DAqh51EVPW-pA12G.png"/></div></figure><p id="4ae4" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">如果可视化消费，可以从数据中获得许多有用的见解。</p><p id="66a0" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在有很多工具可以提供数据可视化，但是很少有工具可以通过一个易于使用和消费的API实现动态更新——进入FastAPI &amp; EasyCharts。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h2 id="87d0" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jc kh ki kj jg kk kl km jk kn ko kp kq bi translated"><strong class="ak"> FastAPI </strong></h2><p id="843b" class="pw-post-body-paragraph ir is hi it b iu kr iw ix iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo hb bi translated">对于那些还没有发现这个网络框架的人来说，<a class="ae kw" href="https://fastapi.tiangolo.com/" rel="noopener ugc nofollow" target="_blank"> FastAPI </a>是开发人员用来创建丰富的、自我记录的、易于使用的API的增长最快的工具之一，它遵循<a class="ae kw" href="https://swagger.io/specification/" rel="noopener ugc nofollow" target="_blank"> OpenAPI </a>规范，又名swagger。</p><h2 id="ff64" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jc kh ki kj jg kk kl km jk kn ko kp kq bi translated"><strong class="ak">简易图表</strong></h2><p id="3f8f" class="pw-post-body-paragraph ir is hi it b iu kr iw ix iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo hb bi translated">一个FastAPI“插件”,可用于通过RestAPI在web浏览器中创建动态更新的数据可视化。</p><figure class="in io ip iq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es kx"><img src="../Images/22f25754fc02636946ee4991bb899947.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e-zH_S1EyKtZ-DU2jgahWA.png"/></div></div></figure></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="7439" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">入门</strong></p><p id="1ea2" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">让我们看看如何使用EasyCharts创建一个跟踪主机/容器/ pod的CPU和内存利用率的基本图表。</p><h1 id="1be1" class="lc jx hi bd jy ld le lf kc lg lh li kg lj lk ll kj lm ln lo km lp lq lr kp ls bi translated"><strong class="ak">安装</strong></h1><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="e4b4" class="jw jx hi lu b fi ly lz l ma mb">$ pip install easycharts</span></pre><p id="bce1" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">计划和收集资源利用率的附加相关性</p><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="02e4" class="jw jx hi lu b fi ly lz l ma mb">$ pip install psutils<br/>$ pip install easyschedule</span></pre><h2 id="745b" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jc kh ki kj jg kk kl km jk kn ko kp kq bi translated"><strong class="ak">导入依赖关系</strong></h2><figure class="in io ip iq fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="0bc9" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">除了easycharts和fastapi之外，还导入了<a class="ae kw" href="https://github.com/codemation/easyschedule" rel="noopener ugc nofollow" target="_blank"> easyschedule </a>来提供收集统计数据的常规节奏。</p><h1 id="fe3f" class="lc jx hi bd jy ld le lf kc lg lh li kg lj lk ll kj lm ln lo km lp lq lr kp ls bi translated"><strong class="ak">设置调度器&amp; EasyCharts </strong></h1><figure class="in io ip iq fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="d6dc" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">这里我们定义了一个名为<strong class="it hj"> every_minute </strong>的cron调度，稍后在设置我们的监控方法时将会用到它。</p><p id="7e56" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在fastapi应用程序<strong class="it hj">服务器</strong>启动动作中，启动<strong class="it hj">调度程序</strong>，并创建<strong class="it hj">图表服务器</strong>。</p><p id="7f8e" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj"> ChartServer </strong>接受FastAPI <strong class="it hj">服务器</strong>，存储图表数据的数据库名称，以及访问图表的默认路径。</p><h2 id="c9e3" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jc kh ki kj jg kk kl km jk kn ko kp kq bi translated"><strong class="ak">启动图表服务器</strong></h2><pre class="in io ip iq fd lt lu lv lw aw lx bi"><span id="31ca" class="jw jx hi lu b fi ly lz l ma mb">$ uvicorn --host 0.0.0.0 --port 8220 monitor:server</span></pre><figure class="in io ip iq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es me"><img src="../Images/85e53d26ba810d87b4684082aa1f175c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BhhL1qZgVt8UqxDtl-GSag.png"/></div></div></figure><p id="a26c" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">API立即提供了通过API查看、创建、更新和删除图表的能力。</p><h1 id="fcea" class="lc jx hi bd jy ld le lf kc lg lh li kg lj lk ll kj lm ln lo km lp lq lr kp ls bi translated"><strong class="ak">创建图表</strong></h1><p id="8001" class="pw-post-body-paragraph ir is hi it b iu kr iw ix iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo hb bi translated">图表可以通过API创建，也可以在应用程序启动时创建。任何以前创建的图表都会自动可用。</p><figure class="in io ip iq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mf"><img src="../Images/2b8b9d40c4e89717e0534e9cb31bcfdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f0WQqoUIRF81nocnKDUG-Q.png"/></div></div></figure><p id="3f38" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">创建图表时，应该用标签(y)和数据(x)值对其进行初始化。</p><figure class="in io ip iq fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="871c" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">如果图表已经存在，<strong class="it hj"> create_dataset() </strong>不会影响现有的图表数据。</p><p id="72d5" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">查看图表</strong></p><figure class="in io ip iq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mg"><img src="../Images/d3c0bcba11fb28a86b80d4f89a2dcabe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MJPfG3-asgvrva1Z_8ef-Q.png"/></div></div></figure><p id="4de8" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在只存在一个数据点(x，y ),因为这是在创建图表时添加的。</p><h1 id="8fa6" class="lc jx hi bd jy ld le lf kc lg lh li kg lj lk ll kj lm ln lo km lp lq lr kp ls bi translated"><strong class="ak">更新图表</strong></h1><figure class="in io ip iq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mh"><img src="../Images/44884185cf7681a265309ee1799473f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vcv7omFDXHXl3wmju1weng.png"/></div></div></figure><p id="610d" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">与创建表一样，可以通过API或服务器上的后台任务向图表添加数据。</p><figure class="in io ip iq fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="2ce3" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">首先，我们定义了一个<strong class="it hj"> resource_monitor() </strong>任务，按照我们在上面<strong class="it hj">中定义的<strong class="it hj"> every_minute </strong>计划，这个任务被我们修饰为每分钟运行一次。</strong></p><p id="cb92" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">这个更新任务与创建任务非常相似，我们收集当前时间的标签(y)和CPU /内存使用情况(x ),同时使用<strong class="it hj"> update_dataset() </strong>按名称定位现有图表。</p><p id="3e05" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><strong class="it hj">重启图表服务器</strong></p><p id="5dd1" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我们的完整代码应该类似于下面这样。</p><figure class="in io ip iq fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><figure class="in io ip iq fd ij"><div class="bz dy l di"><div class="mc md l"/></div></figure><p id="d5e8" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">现在，调度程序应该开始每分钟为主机的cpu和内存利用率添加数据点。观察图形的动态更新。</p><figure class="in io ip iq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mi"><img src="../Images/35e51cdcc229f880f00a73ad8992a29a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YMgfFWcl2VJYZp4o21uWAA.png"/></div></div></figure><h2 id="e155" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jc kh ki kj jg kk kl km jk kn ko kp kq bi translated"><strong class="ak">并排查看CPU和内存</strong></h2><figure class="in io ip iq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mj"><img src="../Images/ca2172fc5cae5bba0be1526bf4c0a7c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ut8SifzvATntzfW3Y4GisQ.png"/></div></div></figure><figure class="in io ip iq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mj"><img src="../Images/ca2172fc5cae5bba0be1526bf4c0a7c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ut8SifzvATntzfW3Y4GisQ.png"/></div></div></figure><h2 id="a764" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jc kh ki kj jg kk kl km jk kn ko kp kq bi translated"><strong class="ak">选择图表类型</strong></h2><p id="54dd" class="pw-post-body-paragraph ir is hi it b iu kr iw ix iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo hb bi translated">EasyCharts支持线形和条形图形，可以选择。</p><figure class="in io ip iq fd ij er es paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="er es mj"><img src="../Images/606161eb13a0815a563e4bbb41c0b5c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mk8YW2AijDzM5SEGhfKReg.png"/></div></div></figure><h2 id="054b" class="jw jx hi bd jy jz ka kb kc kd ke kf kg jc kh ki kj jg kk kl km jk kn ko kp kq bi translated"><strong class="ak">结论</strong></h2><p id="99e4" class="pw-post-body-paragraph ir is hi it b iu kr iw ix iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo hb bi translated">EasyCharts提供了一种简单的方法来可视化数据，尤其是(但不限于)随时间变化的数据。</p><h1 id="fef1" class="lc jx hi bd jy ld le lf kc lg lh li kg lj lk ll kj lm ln lo km lp lq lr kp ls bi translated"><strong class="ak">资源</strong></h1><p id="672f" class="pw-post-body-paragraph ir is hi it b iu kr iw ix iy ks ja jb jc kt je jf jg ku ji jj jk kv jm jn jo hb bi translated"><a class="ae kw" href="https://fastapi.tiangolo.com/" rel="noopener ugc nofollow" target="_blank"><strong class="it hj">FastAPI</strong></a><strong class="it hj">—快来加入成长中的社区</strong></p><p id="b970" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><a class="ae kw" href="https://github.com/codemation/easycharts" rel="noopener ugc nofollow" target="_blank"><strong class="it hj">easy charts</strong></a><strong class="it hj">—想法、评论或建议？在Github上制造一个问题。觉得有用？留下一颗星星。</strong></p><p id="7c11" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated"><a class="ae kw" href="https://github.com/codemation/easyschedule" rel="noopener ugc nofollow" target="_blank"><strong class="it hj">easy schedule</strong></a><strong class="it hj">—用于同步/异步任务的类似cron的调度程序</strong></p></div></div>    
</body>
</html>