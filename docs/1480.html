<html>
<head>
<title>Import CSV Sample (Exoplanets!) Data into PostgreSQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">导入CSV样本(系外行星！)数据导入PostgreSQL</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/import-csv-sample-exoplanets-data-into-postgresql-d57aac30518d?source=collection_archive---------17-----------------------#2021-03-03">https://medium.com/analytics-vidhya/import-csv-sample-exoplanets-data-into-postgresql-d57aac30518d?source=collection_archive---------17-----------------------#2021-03-03</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/ddba8ceca8ce170c9c974ea339383773.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*X7rro7uVt4Bg5wu_"/></div></div></figure><p id="06c3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae jn" href="https://aiven.io/postgresql" rel="noopener ugc nofollow" target="_blank"> PostgreSQL </a>现在是而且仍然是我们最受欢迎且不断增长的存储平台之一；其他存储技术来来去去，但现代Postgres是许多应用程序的可靠选择。当您启动您的第一个Aiven PostgreSQL时，您会希望花一些时间来体验这些特性……但是有一个问题。你新的闪亮数据库是空的。</p><p id="949c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">寻找和使用一些开放的数据集是填补这一空白的一个很好的方法，一个选择是去尝试<a class="ae jn" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>平台。它是一个寻找开放数据、关于数据科学的建议以及一些可以参加以磨练技能的比赛的地方。有相当多的数据集可供选择，但今天我们将使用来自开普勒任务的<a class="ae jn" href="https://www.kaggle.com/nasa/kepler-exoplanet-search-results" rel="noopener ugc nofollow" target="_blank">系外行星数据</a>。你需要一个(免费)帐户登录并下载数据。继续解压缩zip文件，我们将在本文中使用<code class="du jo jp jq jr b">cumulative.csv</code>作为例子。</p><h1 id="519d" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">开始使用Aiven</h1><p id="915c" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">如果你还不是一个Aiven用户，你可以<a class="ae jn" href="https://console.aiven.io/signup" rel="noopener ugc nofollow" target="_blank">注册一个Aiven账户</a>来遵循这篇文章中的步骤——我们会等你的！</p><p id="7baa" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们还将使用<a class="ae jn" href="https://github.com/aiven/aiven-client" rel="noopener ugc nofollow" target="_blank">虚拟命令行界面</a>。该工具需要Python 3.6或更高版本，可以从PyPI安装:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="9e08" class="ld jt hh jr b fi le lf l lg lh">pip install aiven-client</span></pre><p id="526d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您还需要使用CLI工具验证您的Aiven帐户。在下面的命令中替换您自己的详细信息:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="8a89" class="ld jt hh jr b fi le lf l lg lh">avn user login &lt;email@example.com&gt;</span></pre><p id="ef88" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您已经拥有了在云中创建一个虚拟数据库所需的一切。</p><h1 id="ef23" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">创建PostgreSQL服务</h1><p id="4f87" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">新项目的第一步是创建一个项目来保存服务。它只需要一个名字:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="a4d8" class="ld jt hh jr b fi le lf l lg lh">avn project create exoplanets</span></pre><p id="bba1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Aiven在创建服务时提供了许多选项，但为了让我们快速进行，我们将使用最新的postgres和最小的软件包，称为hobbyist。不过最有趣的事情之一是能够选择任何你喜欢的云平台，所以花点时间检查列表并复制你最喜欢的<code class="du jo jp jq jr b">CLOUD_NAME</code>字段:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="122c" class="ld jt hh jr b fi le lf l lg lh">avn cloud list</span></pre><p id="54ed" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我选择了<code class="du jo jp jq jr b">google-europe-west1</code>作为我的例子，但是你可以用你选择的云来代替它。下面是创建postgres数据库要运行的命令:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="08d2" class="ld jt hh jr b fi le lf l lg lh">avn service create -t pg -p hobbyist --cloud google-europe-west1 pg-exoplanets</span></pre><p id="60ba" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">节点准备就绪需要几分钟时间，但是Aiven CLI有一个方便的“wait”命令，直到服务准备好与我们对话时才返回。当我们像这里一样手动运行命令时，这不太重要，但是当您的CI系统自己启动数据平台时，这非常有用！</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="87c8" class="ld jt hh jr b fi le lf l lg lh">avn service wait</span></pre><p id="76e5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">当命令返回时，我们的PostgreSQL集群就可以使用了。让我们创建一个数据库来保存样本数据；下面的命令创建一个名为“系外行星”的行星:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="2992" class="ld jt hh jr b fi le lf l lg lh">avn service database-create --dbname exoplanets pg-exoplanets</span></pre><p id="dd63" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我们有了自己的sad和空数据库，让我们看看示例数据并将其导入。</p><h1 id="9f2c" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">将CSV数据添加到PostgreSQL</h1><p id="ad23" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">PostgreSQL内置了将CSV数据导入现有表的支持，但是我们没有表结构，只有一个CSV。幸运的是，有一个工具可以解决这个问题— <a class="ae jn" href="https://github.com/catherinedevlin/ddl-generator" rel="noopener ugc nofollow" target="_blank"> ddlgenerator </a>是另一个Python命令行工具。</p><p id="e1a8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下面是如何安装<code class="du jo jp jq jr b">ddlgenerator</code>工具，然后从我们之前下载的CSV文件中生成<code class="du jo jp jq jr b">CREATE TABLE</code>语句:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="2a93" class="ld jt hh jr b fi le lf l lg lh">pip install ddlgenerator ddlgenerator postgres cumulative.csv &gt; create.sql</span></pre><p id="3fc3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">看一下文件内部，您会发现我们有了向PostgreSQL解释如何保存数据所需的结构。<code class="du jo jp jq jr b">avn service cli</code>命令将在新数据库上给我们一个<code class="du jo jp jq jr b">psql</code>提示:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="ef95" class="ld jt hh jr b fi le lf l lg lh">avn service cli pg-exoplanets</span></pre><p id="a971" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">从<code class="du jo jp jq jr b">psql</code>内部，我们可以连接到我们创建的数据库，然后运行SQL文件来创建表结构:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="013b" class="ld jt hh jr b fi le lf l lg lh">\c exoplanets \i create.sql</span></pre><p id="e9cf" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">添加最后一块拼图，仍然从<code class="du jo jp jq jr b">psql</code>提示符开始，下一个命令带来CSV数据:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="5e54" class="ld jt hh jr b fi le lf l lg lh">\copy cumulative from data/cumulative.csv csv header</span></pre><p id="038b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">干得好！<code class="du jo jp jq jr b">cumulative</code>表现在应该有一些数据供您使用了！</p><h1 id="86a0" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">梦见系外行星</h1><p id="6823" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">现在你有了一个开普勒太空望远镜拍摄的外行星测量数据的数据库。如果你还不熟悉这个项目，NASA的任务页面<a class="ae jn" href="https://www.nasa.gov/mission_pages/kepler/overview/index.html" rel="noopener ugc nofollow" target="_blank">值得一读。当其中一个控制失灵时，任务进入了第二阶段，这提醒我们，我们可以看到和触摸的工程系统，或者至少ssh进入，比在太空中操作要容易得多！</a></p><p id="bd88" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您可以探索该数据集，它描述了观测结果，并将每个系外行星的开普勒评估与其在现有文献中的官方地位进行了比较。例如，试试看开普勒发现的假阳性:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="42da" class="ld jt hh jr b fi le lf l lg lh">select kepler_name, koi_pdisposition from cumulative where koi_disposition = 'CONFIRMED' and koi_pdisposition = 'FALSE POSITIVE';</span></pre><p id="bed9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您还可以将此数据连接到其他工具，以进一步使用数据集。要么从web控制台获取连接细节，要么使用带有<code class="du jo jp jq jr b">avn</code>的<a class="ae jn" href="https://stedolan.github.io/jq/" rel="noopener ugc nofollow" target="_blank"> jq </a>作为一行程序:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="3f5b" class="ld jt hh jr b fi le lf l lg lh">avn service get pg-exoplanets --json | jq ".service_uri"</span></pre><h1 id="aeeb" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">包扎</h1><p id="d503" class="pw-post-body-paragraph ip iq hh ir b is kq iu iv iw kr iy iz ja ks jc jd je kt jg jh ji ku jk jl jm ha bi translated">良好的云实验实践表明，如果你已经完成了系外行星数据库，你可以删除它:</p><pre class="kv kw kx ky fd kz jr la lb aw lc bi"><span id="c1db" class="ld jt hh jr b fi le lf l lg lh">avn service terminate pg-exoplanets</span></pre><p id="2cab" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要获得更多乐趣和知识，以下资源怎么样:</p><ul class=""><li id="aedf" class="li lj hh ir b is it iw ix ja lk je ll ji lm jm ln lo lp lq bi translated"><a class="ae jn" href="https://www.kaggle.com/datasets" rel="noopener ugc nofollow" target="_blank"> Kaggle开放数据集</a>——如果你不喜欢系外行星，这里有一些很好的选择</li><li id="2f9b" class="li lj hh ir b is lr iw ls ja lt je lu ji lv jm ln lo lp lq bi translated">在我们的文档中，您可以找到将您现有的PostgreSQL迁移到Aiven 的<a class="ae jn" href="https://help.aiven.io/en/articles/4358591-postgresql-migration-to-aiven" rel="noopener ugc nofollow" target="_blank">说明</a></li><li id="6984" class="li lj hh ir b is lr iw ls ja lt je lu ji lv jm ln lo lp lq bi translated">更多关于<a class="ae jn" href="https://github.com/aiven/aiven-client#aiven-client-" rel="noopener ugc nofollow" target="_blank"> Aiven CLI，</a>T0】</li><li id="b21d" class="li lj hh ir b is lr iw ls ja lt je lu ji lv jm ln lo lp lq bi translated"><a class="ae jn" href="https://aiven.io/blog/aiven-for-postgresql-13-is-now-available" rel="noopener ugc nofollow" target="_blank">针对Postgres13的Aiven现已推出</a></li></ul><p id="da40" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">还没有使用Aiven服务？在https://console.aiven.io/signup<a class="ae jn" href="https://console.aiven.io/signup" rel="noopener ugc nofollow" target="_blank">获得免费试用</a></p></div><div class="ab cl lw lx go ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ha hb hc hd he"><p id="5984" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="md">最初发布于</em><a class="ae jn" href="https://aiven.io/blog/discover-exoplanets-with-postgresql" rel="noopener ugc nofollow" target="_blank"><em class="md">https://aiven . io</em></a><em class="md">。</em></p></div></div>    
</body>
</html>