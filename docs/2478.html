<html>
<head>
<title>Using Deep Learning to Organize Your Pictures</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习来组织您的图片</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/using-deep-learning-to-organize-your-pictures-f472bd07ef14?source=collection_archive---------10-----------------------#2021-04-26">https://medium.com/analytics-vidhya/using-deep-learning-to-organize-your-pictures-f472bd07ef14?source=collection_archive---------10-----------------------#2021-04-26</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="5c41" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如何使用TensorFlow中经过训练的卷积神经网络，根据图片的预测类别轻松重命名图片。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/e31875a9e9c5498c6140598a18cd4a75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gM7-Y1Yo1zc0ZxKN4OtSkA.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated"><a class="ae js" href="http://www.freepik.com" rel="noopener ugc nofollow" target="_blank">由starline / Freepik设计</a></figcaption></figure><p id="6f2a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">深度学习是机器学习的一个子领域，它使用多层神经网络从数据中提取模式。通常情况下，建立和训练一个高精度的模型需要很长时间。然而，如果您可以获得一个由专家构建和训练的模型，并应用它来解决您的问题，会怎么样呢？你可以的！这可能只需要几行代码。</p><p id="0e6f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这被称为迁移学习，这是一种重用机器学习专家创建的模型的技术，该模型已经在大型数据集上进行了训练。</p><p id="e2e3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我在这个项目中的目标是介绍如何轻松地应用迁移学习来帮助你组织你的图片，方法是使用Python中的TensorFlow，使用来自训练好的卷积神经网络的预测类来重命名它们。</p><p id="5c7c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你对这个项目的源代码感兴趣，请查看我的<a class="ae js" href="https://github.com/hugoplm/computer-vision/blob/main/Organizing_Pictures_Transfer_Learning/Organizing_Pictures.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>。</p></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="67ed" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">获取模型</h1><p id="9d38" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">在这个项目中，我们将使用移动V2模型，这是一个训练有素的图像分类模型。它是使用ImageNet数据集训练的，它有1001个类。MobileNet V2模型在<a class="ae js" href="https://www.tensorflow.org/hub" rel="noopener ugc nofollow" target="_blank"> TensorFlow Hub </a>中可用，这是一个存储库，我们可以在其中找到经过训练的机器学习模型。我不会在本文中涵盖该模型的所有细节，但是如果您有兴趣了解更多，我推荐您看一下<a class="ae js" href="https://tfhub.dev/google/tf2-preview/mobilenet_v2/classification/4" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><p id="de7e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该模型是TensorFlow 2格式的SavedModel。我们可以使用KerasLayer方法获得它，证明URL和input_shape参数。这些信息可以在模型的文档中找到。</p><pre class="jd je jf jg fd ld le lf lg aw lh bi"><span id="4295" class="li kb hh le b fi lj lk l ll lm">url = "https://tfhub.dev/google/tf2preview/mobilenet_v2/classification/4"</span><span id="2c4e" class="li kb hh le b fi ln lk l ll lm">model = tf.keras.Sequential([<br/>   hub.KerasLayer(url, input_shape=(224, 224, 3))<br/>])</span></pre><p id="18ca" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此外，我们需要获得ImageNet数据集的1001个类。我们可以通过下载包含这些信息的TXT文件并将其保存为numpy数组来实现。</p><pre class="jd je jf jg fd ld le lf lg aw lh bi"><span id="b998" class="li kb hh le b fi lj lk l ll lm">labels_path = tf.keras.utils.get_file('ImageNetLabels.txt', 'https://storage.googleapis.com/download.tensorflow.org/data/ImageNetLabels.txt')</span><span id="5967" class="li kb hh le b fi ln lk l ll lm">imagenet_labels = np.array(open(labels_path).read().splitlines())</span></pre></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="2ab1" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">做预测</h1><p id="c06c" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">这里的第一步是创建一个包含目录中图像文件名的列表。对于这个项目，我将使用20个不同的图片，我在我的手机上改名为“ImageXX”。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lo"><img src="../Images/f73c9a502708965e534e34bdfb864ca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:288/format:webp/1*M6Sacut6TiDyB4AMpOxMog.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">按作者列出目录中的图像列表。</figcaption></figure><p id="0784" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们定义一个接收图像路径并返回预测类和图像数组的函数。在这个函数中，在进行预测之前，图像将以正确的大小加载、归一化并转换为一个numpy数组。</p><pre class="jd je jf jg fd ld le lf lg aw lh bi"><span id="2d16" class="li kb hh le b fi lj lk l ll lm">def pred_class(img):<br/>   loaded_image =  tf.keras.preprocessing.image.load_img(img,<br/>   color_mode='rgb', target_size=(224,224),interpolation='nearest')<br/>   <br/>   image_arr = np.array(loaded_image)/255.</span><span id="b8e1" class="li kb hh le b fi ln lk l ll lm">   pred = model.predict(image_arr[np.newaxis, :])</span><span id="1568" class="li kb hh le b fi ln lk l ll lm">   predicted_class = imagenet_labels[np.argmax(pred)]</span><span id="c22f" class="li kb hh le b fi ln lk l ll lm">   return predicted_class, image_arr</span></pre><p id="9f4e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我们可以循环遍历我们的图像列表，并预测每个图像的类别。我们将把预测的类和图像数组保存在列表中，以便在接下来的步骤中使用。</p><pre class="jd je jf jg fd ld le lf lg aw lh bi"><span id="07e2" class="li kb hh le b fi lj lk l ll lm">predicted_classes = []</span><span id="f551" class="li kb hh le b fi ln lk l ll lm">images_arr = []</span><span id="fed5" class="li kb hh le b fi ln lk l ll lm">for image in image_dir:<br/>   image_path = dir + image<br/>   predicted_class, image_arr = pred_class(image_path)<br/>   predicted_classes.append(predicted_class)<br/>   images_arr.append(image_arr)</span></pre><p id="bee4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后，我们可以绘制我们的图像和各自的预测类。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lp"><img src="../Images/7e4c6cbc2ffbdea0ca965f3815b9202a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*to8Ax5D4DI1uJ0fTt5N7tA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">按作者分类的图片。</figcaption></figure><h1 id="09b1" class="ka kb hh bd kc kd lq kf kg kh lr kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx bi translated">重命名图像</h1><p id="76d5" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">用各自的类可视化图像后，让我们重命名我们的文件。它将使用预测的类作为文件名，保留原来的扩展名。</p><pre class="jd je jf jg fd ld le lf lg aw lh bi"><span id="0460" class="li kb hh le b fi lj lk l ll lm">for i, image in enumerate(image_dir):<br/>   old_name = dir + image<br/>   new_name = dir + predicted_classes[i] + image[7:]<br/>   os.rename(old_name, new_name)</span></pre><p id="a7ce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们的最后一步将是创建一个包含所有20个重命名图像的ZIP文件，并从Google Colab下载它。你可以在这个<a class="ae js" href="https://github.com/hugoplm/computer-vision/tree/main/Organizing_Pictures_Transfer_Learning/renamed-pictures" rel="noopener ugc nofollow" target="_blank">库</a>里找到重命名后的图片。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lv"><img src="../Images/3903b2342b4882d2b7bc928d07f6885b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0v-k1YFQxReXPVszxvjc9Q.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">由作者重命名的图片。</figcaption></figure></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="3216" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">结论</h1><p id="adfd" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">这个项目介绍了如何使用移动V2模型来预测随机图片的类别。使用迁移学习可以节省我们很多时间，并达到一个非常好的准确性。正如我们所看到的，该模型预测了一些图像的正确类别，如背包、笔记本电脑、摩托车和海滨。而对于其他情况，即使它没有预测到正确的类别，我们也得到了一个非常接近的类别，如运动衫、木屐和垃圾车。</p><p id="92b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您对学习如何使用TensorFlow训练自己的卷积神经网络感兴趣，我建议您看看我以前的项目:</p><p id="cac2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae js" rel="noopener" href="/analytics-vidhya/classifying-images-of-clothing-using-tensorflow-39ec3c1cb8b7">使用TensorFlow对服装图像进行分类</a></p><p id="a5f6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您对这个项目有任何问题或反馈，请随时通过<a class="ae js" href="https://www.linkedin.com/in/hugoplm/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p></div></div>    
</body>
</html>