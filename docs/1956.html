<html>
<head>
<title>Machine Learning # 3 — Linear Regression (Ridge &amp; Lasso Functions)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习# 3 —线性回归(山脊和套索函数)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/machine-learning-3-linear-regression-ridge-lasso-functions-2fa7fda624a0?source=collection_archive---------16-----------------------#2021-03-28">https://medium.com/analytics-vidhya/machine-learning-3-linear-regression-ridge-lasso-functions-2fa7fda624a0?source=collection_archive---------16-----------------------#2021-03-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="202b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这篇文章是我的机器学习系列的第三篇文章，旨在巩固和分享我所学到的知识。对于发表在Analytics Vidhya上的系列文章的第二篇: <a class="ae jd" rel="noopener" href="/analytics-vidhya/machine-learning-2-correlation-matrix-feature-selection-class-imbalance-decision-trees-9a447fdb825"> <em class="jc">链接</em> </a></p></div><div class="ab cl je jf go jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="ha hb hc hd he"><p id="9242" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你对这篇文章的土耳其语不感兴趣，可以跳过这一段。</p><p id="9954" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc"> Bu yaz，orendklerimi peki TIR MEK ve paylamak I in kale me ALD m机器学习yaz diziminüüNCüyaz SDR . serin in yaynlanan ikin ci yaz is in:</em><a class="ae jd" rel="noopener" href="/deep-learning-turkiye/machine-learning-2-korelasyon-matrisi-özellik-seçimi-sınıfların-dengesizliği-karar-ağaçları-af993bd8ea66"><em class="jc">链接</em> </a></p><p id="909f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">bu yazūn n türke si isi in:<a class="ae jd" href="https://gokerguner.medium.com/makine-%C3%B6%C4%9Frenmesi-3-lineer-regresyon-ridge-lasso-fonksiyonlar%C4%B1-9dbf6036e29e" rel="noopener">链接</a></p></div><div class="ab cl je jf go jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="ha hb hc hd he"><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/078ae1375a7eafc29ff6db4c0fe2720e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kjcQKoVhKzS5JLX2ygJ7yQ.jpeg"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">来源:<a class="ae jd" href="https://unsplash.com/photos/oc9Mi40XY-0?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditShareLink" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/oc9Mi40XY-0?utm_source=unsplash&amp;UTM _ medium = referral&amp;UTM _ content = creditShareLink</a></figcaption></figure><p id="c51d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你好，在我的机器学习系列的第三个笔记本里，我们会学习；</p><ul class=""><li id="9f03" class="kb kc hh ig b ih ii il im ip kd it ke ix kf jb kg kh ki kj bi translated">线性回归的概念，</li><li id="8c68" class="kb kc hh ig b ih kk il kl ip km it kn ix ko jb kg kh ki kj bi translated">损失账户的概念和计量方法，</li><li id="21cc" class="kb kc hh ig b ih kk il kl ip km it kn ix ko jb kg kh ki kj bi translated">线性回归的子类型。</li></ul><p id="19e8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">与之前的文章类似，我们从<strong class="ig hi">导入</strong>我们将再次使用的库并检查数据开始。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="0245" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">除了我们在以前的文章中提到的方法，我们还导入了一些库，这些库允许我们调用本文中遇到的<strong class="ig hi"> LinearRegression、Ridge、Lasso </strong>函数，以及我们将用于误差计算的mean_squared_error方法。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="095e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将使用您可以通过<a class="ae jd" href="https://www.kaggle.com/vikrishnan/boston-house-prices" rel="noopener ugc nofollow" target="_blank">链接</a>访问的数据集来检查回归问题。“波士顿房价”数据集是一个非常有用的数据集，你可以在初级教育中经常看到。</p><p id="8430" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">注:</strong>我还会推荐您更详细地检查一下<strong class="ig hi"/><a class="ae jd" href="https://www.kaggle.com" rel="noopener ugc nofollow" target="_blank"><strong class="ig hi">ka ggle</strong></a>平台，我们从该平台收到了本文中的数据集。这是一个非常丰富的数据科学&amp;机器学习平台，有培训，数据集，竞赛，样本笔记本。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es kr"><img src="../Images/c239bb3c07a3b7bba75c98aeb49e1020.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Nu_Bv3QiC07QtUu3RUnoA.png"/></div></div></figure><p id="b663" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们看到我们的数据集总共由404个元素组成，所有这些值都是数值并且<strong class="ig hi">非空</strong>。换句话说，我们可以继续了解我们的数据集，而无需任何预处理步骤。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es ks"><img src="../Images/c9545db4c929bd313609b8efcb16d18a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s8Xp1ati172BKomy0vxvWg.png"/></div></div></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es kt"><img src="../Images/20f687e1b617b34bcce2ea33b143cbfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kGz-466Si5ATT6AkX6x4Yw.png"/></div></div></figure><p id="c905" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们的主要目标是使用我们拥有的所有特征来估计房价，但是让我们首先通过检查仅房间数量特征对房价的影响来熟悉<strong class="ig hi">线性回归</strong>概念。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es ku"><img src="../Images/9242141c0960cdf8868bc5ce29db4f38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0eEPYbJ7WabYzY_zoB0Clg.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">数据集内变量的描述。</figcaption></figure><p id="a1fb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从我们接收数据集的<strong class="ig hi"> Kaggle </strong>中，我们可以检查数据集的列名是什么意思。medv 变量，我们目标上的房价变量。在这一步中，分别；</p><ul class=""><li id="2653" class="kb kc hh ig b ih ii il im ip kd it ke ix kf jb kg kh ki kj bi translated">我们从数据集的<strong class="ig hi">输入(X) </strong>变量中删除目标变量，</li><li id="eab7" class="kb kc hh ig b ih kk il kl ip km it kn ix ko jb kg kh ki kj bi translated">我们将这个目标变量分配给<strong class="ig hi">输出(y) </strong>变量，</li><li id="7f78" class="kb kc hh ig b ih kk il kl ip km it kn ix ko jb kg kh ki kj bi translated">为了检查房间数和房价之间的关系，我们将房间数列定义为一个变量。</li></ul><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es kv"><img src="../Images/71ef351f2cf98388d1b55e36bcdea21b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z9H6m7ZyrQ7YNQW03-heMg.png"/></div></div></figure><p id="6970" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当我们检查房间数量的大小时，我们看到大小是缺失的。它应该是一个由404行和1列组成的数据帧，这样我们就可以对它进行处理。为此，我们从如下的整形函数中获得帮助。<strong class="ig hi"> <em class="jc">重塑</em> </strong>过程至关重要，尤其是在<strong class="ig hi">深度学习</strong>研究中。当我们来到文章系列的这些部分时，我们将更多地讨论这个过程。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es kw"><img src="../Images/30aeb11ac0f164bb2f094b87a6a7ca1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IxUy1D7IaMQmZZZ2TCTZIA.png"/></div></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kp kq l"/></div></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es kx"><img src="../Images/fc4fc5c18f014c8dfbe3ead2813c5200.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*Fwm57Z8zQWjYfpzuw9oi2g.png"/></div></figure><p id="b85b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们观察到，在我们的数据集中，房子大多是6个房间，一般是<strong class="ig hi"/>，随着房间数量的增加，房子的价格也会增加。</p><h1 id="f773" class="ky kz hh bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">最小二乘法</h1><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kp kq l"/></div></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es lw"><img src="../Images/eb18da858b666fb25c8301c6fe1f84af.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*IuWtixBAhkNpAYvGEaitFA.png"/></div></figure><p id="b21d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们画了一条线来表示这两个变量之间的关系。我们在回归问题中的全部目的是最小化数据集中的点与直线的距离，从而获得最接近事实的直线。在这个例子中，我们的变量是房间的数量，我们的目标是房子的价格。我们可以用一个变量线函数来模拟。</p><p id="db87" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我们将该等式表示为<strong class="ig hi"> y = ax + b </strong>，<strong class="ig hi">，我们将线性回归模型的数学目的定义为确定a和b的值，这将绘制最接近数据点的直线</strong>。</p><p id="6cda" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这被称为<strong class="ig hi">最小二乘法</strong>。</p><p id="8c4b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，让我们包括所有的功能，而不是房间的数量，并重新编写我们在以前的笔记本中看到的猜测过程。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="5f6c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">均方根误差</strong>是用于测量模型(或估计器/预测器)预测值和实际(观察)值之间差异的指标之一。如果该指标为0，则意味着模型没有出错。简单地将误差(损失)的平方相加，首先是平均值，然后是平方根。</p><p id="9363" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们通过交叉验证分离我们的聚类并取我们获得的结果的平均值来完成文章的这一部分。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lx"><img src="../Images/32d35730fe6d98d72bb1f651e3559bd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fRonph5aDKFdFvIAlzGkAA.png"/></div></div></figure><h1 id="4ab2" class="ky kz hh bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">脊函数</h1><p id="ec55" class="pw-post-body-paragraph ie if hh ig b ih ly ij ik il lz in io ip ma ir is it mb iv iw ix mc iz ja jb ha bi translated">岭回归是使用<strong class="ig hi"> L2正则化</strong>的回归变量。在我们继续之前，如果我们简要地谈一下为什么我们需要这个；</p><p id="dd25" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">记住，我们的主要目标是最优地确定方程的系数(具有最小的RMSE值)。我们的模型将分别确定每个<strong class="ig hi">输入变量</strong>的系数。这些系数有时会非常大，导致我们的模型过拟合。为了避免这样的情况，我们需要实现一个<strong class="ig hi">正则化</strong>。</p><p id="52e3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们需要确定的超参数是用于<strong class="ig hi">脊</strong>和<strong class="ig hi">套索</strong>功能的<strong class="ig hi"> alpha </strong>值，我们稍后会提到。</p><p id="09fc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">虽然alp <strong class="ig hi"> h </strong> a值为0不能解决我们的问题，但它会导致模型过拟合，反之，过高会导致欠拟合。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es md"><img src="../Images/380d171462a61b60f218834f572519f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:404/format:webp/1*oqrwBRGjhPORDZdIfhqSzg.png"/></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">在损失计算中，山脊效应就是这样显示的。</figcaption></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kp kq l"/></div></figure><h1 id="f70c" class="ky kz hh bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">Lasso(最小绝对收缩和选择算子)函数</h1><p id="8ac6" class="pw-post-body-paragraph ie if hh ig b ih ly ij ik il lz in io ip ma ir is it mb iv iw ix mc iz ja jb ha bi translated"><strong class="ig hi">2</strong>与<strong class="ig hi">脊</strong>功能的主要区别。它使用<strong class="ig hi"> L1正则化</strong>来排列系数，<strong class="ig hi">另一个更重要的区别是，它可以完全忽略一些属性，因为它采用系数的绝对值而不是平方。</strong></p><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es me"><img src="../Images/ad22337ad9146b944aa64692832e18db.png" data-original-src="https://miro.medium.com/v2/resize:fit:312/format:webp/1*_cSYkXiXFqsI6NN53Gz98Q.png"/></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">损失计算中的套索效应就是这样显示的。</figcaption></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kp kq l"/></div></figure><figure class="jm jn jo jp fd jq er es paragraph-image"><div class="er es mf"><img src="../Images/f262da616b4f27b6cca2109a12363ed3.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*5zdia1mNQaA3okQjUF96Ew.png"/></div></figure><p id="7092" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">虽然我们在文章开始时用来采样的<strong class="ig hi">房间号变量</strong>的效果很明显，但是我们看到模型发现不重要的一些特征的系数也等于零。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kp kq l"/></div></figure><p id="a939" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，我们通过包含我们在以前的文章中使用的<strong class="ig hi"> GridSearch </strong>和<strong class="ig hi"> pipeline </strong>并观察结果来结束我们的文章。下一篇文章再见。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kp kq l"/></div></figure><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="kp kq l"/></div></figure><div class="mg mh ez fb mi mj"><a href="https://github.com/gokerguner/notebooks/tree/main/ml03" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab dw"><div class="ml ab mm cl cj mn"><h2 class="bd hi fi z dy mo ea eb mp ed ef hg bi translated">gokerguner/笔记本</h2><div class="mq l"><h3 class="bd b fi z dy mo ea eb mp ed ef dx translated">恩]:媒体的文章和我写的笔记本的主题是我对机器的了解和疑惑…</h3></div><div class="mr l"><p class="bd b fp z dy mo ea eb mp ed ef dx translated">github.com</p></div></div><div class="ms l"><div class="mt l mu mv mw ms mx jv mj"/></div></div></a></div></div></div>    
</body>
</html>