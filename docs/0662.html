<html>
<head>
<title>EMOTION-BASED MUSIC RECOMMENDATION SYSTEM USING A DEEP REINFORCEMENT LEARNING APPROACH</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度强化学习方法的基于情感的音乐推荐系统</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/emotion-based-music-recommendation-system-using-a-deep-reinforcement-learning-approach-6d23a24d3044?source=collection_archive---------2-----------------------#2021-01-26">https://medium.com/analytics-vidhya/emotion-based-music-recommendation-system-using-a-deep-reinforcement-learning-approach-6d23a24d3044?source=collection_archive---------2-----------------------#2021-01-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/23eb787a58beb8dfb1265782e5b4273a.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*VzAhj5PHGuJg2Uy0csN-Ug.png"/></div></figure><p id="35ef" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你知道声音和音乐与我们的情感大脑沟通吗？很神奇，不是吗？</p><p id="7ee7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">事实上，几种类型的研究表明，听声音和音乐对我们的感觉和情绪有着重要的作用和影响[ <a class="ae jl" href="https://www.researchgate.net/publication/11040897_%27Emotional_Sounds_and_the_Brain_the_Neuro-affective_Foundations_of_Musical_Appreciation%27" rel="noopener ugc nofollow" target="_blank"> 1 </a> ] [ <a class="ae jl" href="https://www.researchgate.net/publication/228389838_The_Science_and_Psychology_Behind_Music_and_Emotion" rel="noopener ugc nofollow" target="_blank"> 2 </a> ]。至于我们的情绪，在推荐[ <a class="ae jl" href="https://medium.com/r?url=https%3A%2F%2Fwww.researchgate.net%2Fpublication%2F323143572_Affective_recommender_systems_the_role_of_emotions_in_recommender_systems" rel="noopener"> 3 </a>中起着重要的作用。</p><p id="d18a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">大多数现有的推荐系统是基于用户提供的评级。<em class="jk">嗯，有一个圈套！这些系统只允许您体验静态的用户体验，因为系统将根据评级历史给出推荐，而不考虑可能影响预测的其他参数，如用户反应、行为、感觉或情绪[ <a class="ae jl" href="https://link.springer.com/chapter/10.1007%2F978-3-642-15208-5_19" rel="noopener ugc nofollow" target="_blank"> 4 </a> ]。</em></p><p id="1f29" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><em class="jk">诀窍在于</em>通过考虑这些行为和情感特征，用户可以从更动态、定制和定制的体验中受益。<em class="jk">还有更好的</em>，情绪是非常有趣的隐性指标，利用它们的一种方式是在深度强化学习方法的奖励系统中使用它们。</p><h1 id="0ae7" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">一个情感推荐系统</h1><p id="dd72" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix km iz ja jb kn jd je jf ko jh ji jj hb bi translated"><em class="jk">你有没有想象过一个结合了音乐和情感的推荐系统？一个可以根据你的感觉和情绪提出定制播放列表，并可以根据你过去的经验适应你的行为的系统？那个好奇的问题促使我开发了一个基于情感的音乐推荐系统项目。</em></p><p id="9bec" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">该项目是一个基于深度强化学习的项目，它使用添加到用户信息(主要是他的年龄、情绪和性别)中的音乐情感和流派作为状态特征，以及基于用户感觉的奖励系统，即从他的心率变异性(HRV)中检测到的他的压力水平。它的目标是<strong class="io hj"> <em class="jk">根据用户以前录制的感受</em> </strong> <em class="jk">，从给定的播放列表中向用户推荐最适合和定制的顶级k歌。</em></p><h2 id="572f" class="kp jn hi bd jo kq kr ks js kt ku kv jw ix kw kx ka jb ky kz ke jf la lb ki lc bi translated">下面是它的工作原理</h2><p id="8c6e" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix km iz ja jb kn jd je jf ko jh ji jj hb bi translated">假设我们之前已经通过他们的HRV观察了几个用户每次听给定播放列表时的反应，以及他们在听每首歌曲时的情绪。然后，我们有历史观察和反馈数据，这些数据可用于提供强化学习环境，以便:</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es ld"><img src="../Images/2926638fd26cde4b4a797bec7a5bdbdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i09NxBzQLNfFBlXR5gGJVA.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">深度强化学习环境结构</figcaption></figure><ul class=""><li id="78a5" class="lq lr hi io b ip iq it iu ix ls jb lt jf lu jj lv lw lx ly bi translated">该状态由音乐特征(主要是流派和情感)和用户信息(即他的年龄、性别和他的情绪)组成，以1到5的标度来测量，使得1表示<strong class="io hj"><em class="jk"/></strong>悲伤，5表示<strong class="io hj"> <em class="jk">快乐，</em> </strong></li><li id="1e08" class="lq lr hi io b ip lz it ma ix mb jb mc jf md jj lv lw lx ly bi translated">奖励是用户在听完一首特定歌曲后的反应(无论这首歌让他感觉更平静还是更有压力)，主要是从他的HRV中识别的他的压力水平。</li></ul><h2 id="d6b1" class="kp jn hi bd jo kq kr ks js kt ku kv jw ix kw kx ka jb ky kz ke jf la lb ki lc bi translated">音乐流派和情感特征的处理和提取</h2><p id="61ab" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix km iz ja jb kn jd je jf ko jh ji jj hb bi translated">因为用户将输入原始音频文件，所以在它们可以被用作状态特征之前，有必要识别流派和情感特征。为此，我建立了一个分析音乐流派和情感的模型，一个适合多标签分类问题的<strong class="io hj">神经网络</strong>。该模型可以识别用户可能感觉到的一组目标情绪<strong class="io hj"> <em class="jk">(温柔、平静、力量、快乐、悲伤、紧张)</em> </strong>，并且能够识别<strong class="io hj"> <em class="jk">古典、流行、摇滚和电子</em> </strong>音乐流派。</p><p id="739a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用用于音频和音乐处理的python模块<strong class="io hj"> <em class="jk"> librosa对音频文件进行处理:</em> </strong>在timbral之前使用预加重方法对高频信号进行增强，并提取温度图特征以馈入分类器模型。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es me"><img src="../Images/0a13b37d2f7061ab5350a6f73446ff75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oM4DJrxWUdtuuzXT6nVvng.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">使用librosa进行高频信号预加重(来源:作者)</figcaption></figure><h2 id="7cd3" class="kp jn hi bd jo kq kr ks js kt ku kv jw ix kw kx ka jb ky kz ke jf la lb ki lc bi translated">根据心率变异性识别压力水平(HRV)</h2><p id="70d6" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix km iz ja jb kn jd je jf ko jh ji jj hb bi translated">你一定想知道什么是心率变异性。我来澄清一下！</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mf"><img src="../Images/38f5a1e11a4e2ff68b027afddb8bec6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*txN9k-ky7oN5d0sUjzOULw.jpeg"/></div></div></figure><p id="ed07" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">HRV是对每次心跳之间时间变化的测量，通常用于评估一个人的身体状况，最终评估他的生产力、精力和压力水平。您可以使用任何可穿戴设备或任何心脏监测应用来测量HRV，并且可以轻松地将数据导出为csv文件[ <a class="ae jl" href="https://www.firstbeat.com/en/blog/what-is-heart-rate-variability-hrv/" rel="noopener ugc nofollow" target="_blank"> 5 </a> ]。</p><p id="1c00" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">你是最新的！让我们继续前进。</p><p id="5fc7" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了支持DRL的奖励系统，我建造了一个位于HRV的压力水平分析器。这是一款<strong class="io hj"> CatBoost型号</strong>，能够使用HRV检测高、中、低应力水平。以下度量用于预测用户的压力水平:<strong class="io hj"> <em class="jk">他的心率，4个时域度量(SDNN、均值-RR、pNN50和RMSSD)，以及3个频域度量(甚低频、低频和高频)。</em> </strong>这些都是HRV测量中最常用的指标。</p><h1 id="843a" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">这是底线！</h1><p id="d6ef" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix km iz ja jb kn jd je jf ko jh ji jj hb bi translated">我知道我几乎可以听到你在想:“压力水平分析仪和模型的奖励系统有什么关系？”。别离开我，我会解释的。</p><p id="7d05" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">DRL模型的奖励系统是基于用户给出的反馈，这里是从他的压力水平来衡量的。因此，高水平的压力，被解释为不满意的标志，将被转换为对模型零收益的奖励。相反，更合理或相对较低的压力水平被解释为满意的标志，并将转化为对模型的积极奖励。</p><p id="50c1" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了构建我的基于DRL的系统，我想出了一种基于A2C(优势行动者-批评家)模型的<strong class="io hj"> <em class="jk"> PyTorch实现的方法，在使用<strong class="io hj"> <em class="jk"> gym库开发的定制环境上训练</em></strong>，这是一个专门用于强化算法开发的OpenAI工具包</em> </strong>。DRL模型得分<strong class="io hj"> 0.80，运行10000个学习步骤</strong>。</p><h1 id="8a4e" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">检索来自用户的反馈</h1><p id="6d55" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix km iz ja jb kn jd je jf ko jh ji jj hb bi translated">为了保持系统的动态性，我建立了一个数据库作为回复缓冲区，用来保存新提供的反馈和观察结果。为了提高未来推荐的质量并使系统更好地适应用户的行为，稍后可以在离线生产环境中使用这些反馈数据来重新训练该模型。</p><h1 id="72ff" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">所有这些中的数据集呢？</h1><p id="9c87" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix km iz ja jb kn jd je jf ko jh ji jj hb bi translated">我使用以下两种不同的数据源来开发项目:</p><p id="bedc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">1- <strong class="io hj"> <em class="jk">数据集，关于从带有目的情绪化</em> </strong>的游戏中诱发的音乐情绪，此处<a class="ae jl" href="http://www2.projects.science.uu.nl/memotion/emotifydata/" rel="noopener ugc nofollow" target="_blank">可用</a>。这个数据集由400首歌曲的摘录组成，分别标注了它们各自的流派和参与者在听每首歌曲时强烈感受到的情绪注释[6]。</p><p id="0d23" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">2- <strong class="io hj"> <em class="jk">用于应力监测的生物特征kaggle数据集</em> </strong>，此处可用<a class="ae jl" href="https://www.kaggle.com/qiriro/stress" rel="noopener ugc nofollow" target="_blank"/>【7】。该数据集包含从SWELL [8][9]和WESAD数据集[10]计算的心率变异性(HRV)和皮肤电活动(EDA)数据。</p><h1 id="f6c5" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">现在，演示时间！</h1><p id="9bfe" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix km iz ja jb kn jd je jf ko jh ji jj hb bi translated">该系统已使用streamlit框架及其内置的共享功能进行部署。要与系统交互:</p><p id="ddfa" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">1-输入您选择的播放列表和您的信息(年龄、心情和性别)，</p><p id="4015" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">2-系统将从您的播放列表中推荐最合适的前2首歌曲，</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mg"><img src="../Images/43d2998c3aa3779c304e19d728ba8c51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*HL_nnHg6n7K5k0RPS9j5Vw.gif"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">音乐推荐</figcaption></figure><p id="a0a4" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">从上图中可以看出，系统推荐的歌曲有着共同的特点:它们都唤起了温柔、平静和悲伤的情绪，而且可信度很高。</p><p id="2a03" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">3-听歌，</p><p id="a853" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">4-上传您的HRV指标进行反馈分析，</p><p id="762b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">5-保存您的反馈。</p><figure class="le lf lg lh fd ij er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mg"><img src="../Images/a300557a247ed625aa17325e49bc8241.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*c5_RXjv-k91wM3NqSccMcQ.gif"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">应力水平分析</figcaption></figure><p id="53e6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">就这么简单！👌</p><h1 id="6e64" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">承认</h1><p id="2068" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix km iz ja jb kn jd je jf ko jh ji jj hb bi translated">我非常感谢非洲2020数据科学密集型(DSI)项目为我提供了开发这个项目的绝佳机会。衷心感谢DSI导师在本项目实现过程中给予的宝贵支持。</p><h1 id="3b63" class="jm jn hi bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">参考</h1><p id="1bda" class="pw-post-body-paragraph im in hi io b ip kk ir is it kl iv iw ix km iz ja jb kn jd je jf ko jh ji jj hb bi translated">[1] <a class="ae jl" href="https://www.researchgate.net/publication/11040897_'Emotional_Sounds_and_the_Brain_the_Neuro-affective_Foundations_of_Musical_Appreciation'" rel="noopener ugc nofollow" target="_blank">潘克塞普，贾克&amp;伯纳茨基，京特。(2002).情感声音和大脑:音乐欣赏的神经情感基础。行为过程。60.133–155.10.1016/s 0376–6357(02)00080–3</a></p><p id="a5f5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">[2] <a class="ae jl" href="https://www.researchgate.net/publication/228389838_The_Science_and_Psychology_Behind_Music_and_Emotion" rel="noopener ugc nofollow" target="_blank">沙夫隆，加文。(2010).音乐和情感背后的科学和心理学。</a></p><p id="7ef5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">[3] <a class="ae jl" href="https://www.researchgate.net/publication/323143572_Affective_recommender_systems_the_role_of_emotions_in_recommender_systems" rel="noopener ugc nofollow" target="_blank">特卡尔夫西维奇，马尔科&amp;科西尔，安德烈&amp;塔西维奇，尤里&amp;库纳维尔，马特夫日。(2011).情感推荐系统:情感在推荐系统中的作用。9–13.</a></p><p id="46b0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">[4] <a class="ae jl" href="https://link.springer.com/chapter/10.1007%2F978-3-642-15208-5_19" rel="noopener ugc nofollow" target="_blank">接受推荐并提供反馈:推荐系统的用户体验，电子商务和网络技术，2010年，第61卷，ISBN:978–3–642–15207–8，Bart P. Knijnenburg，Martijn C. Willemsen，Stefan Hirtbach </a></p><p id="a4cb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">[5] <a class="ae jl" href="https://www.firstbeat.com/en/blog/what-is-heart-rate-variability-hrv/" rel="noopener ugc nofollow" target="_blank">什么是心率变异性(HRV) &amp;为什么很重要？</a></p><p id="e1a6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">[6] A .阿尔贾纳基，f .威灵，R. C .韦尔特坎普。通过一个众包游戏研究音乐诱发的情绪。信息处理与管理，2015。</p><p id="6be6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">[7] S. Koldijk，M. A. Neerincx和W. Kraaij，“通过结合不引人注目的传感器检测办公室的工作压力”，IEEE Trans .影响。计算机。，第9卷第2期，第227–239页，2018年。</p><p id="c8d0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">[8] S. Koldijk、M. Sappelli、S. Verberne、M. A. Neerincx和W. Kraaij，“压力和用户建模研究的膨胀知识工作数据集”，Proc .第16国际。糖膏剂多模态交互。——ICMI 2014年，第291–298页，2014年。</p><p id="7972" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">[9] Kraaij，ir. W .教授博士(拉德布大学&amp; TNO)；Koldijk，理学硕士。TNO和拉德布大学；Sappelli，理学硕士(TNO &amp;拉德布大学)(2014年):用于压力和用户建模研究的膨胀知识工作数据集。DANS。<a class="ae jl" href="https://doi.org/10.17026/dans-x55-69zp" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.17026/dans-x55-69zp</a></p><p id="82fb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">[10] Schmidt，p .，Reiss，a .，Duerichen，r .，Marberger，c .，和Van Laerhoven，K. (2018年)。介绍WESAD，一个用于可穿戴压力和影响检测的多模态数据集。2018年ICMI国际多式联运会议论文集。【https://doi.org/10.1145/3242969.3242985 T2】号</p></div></div>    
</body>
</html>