<html>
<head>
<title>Analyzing machine learning model errors on Santander Customer Transaction Prediction problem</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">桑坦德银行客户交易预测问题的机器学习模型误差分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/analyzing-machine-learning-model-errors-on-santander-customer-transaction-prediction-problem-d59cad403e7c?source=collection_archive---------5-----------------------#2021-10-20">https://medium.com/analytics-vidhya/analyzing-machine-learning-model-errors-on-santander-customer-transaction-prediction-problem-d59cad403e7c?source=collection_archive---------5-----------------------#2021-10-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="a68d" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">LinkedIn <a class="ae iw" href="https://www.linkedin.com/in/ankit-shah-643ab3217" rel="noopener ugc nofollow" target="_blank">简介</a> &amp; <a class="ae iw" href="https://github.com/ankitshah-dev/Analyzing-machine-learning-model-errors" rel="noopener ugc nofollow" target="_blank"> GitHub </a>简介</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/ed7ebc6fb7c6d52857e1af650c29e89d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9TTWIrSuK2hhLi_kY5jQKQ.png"/></div></div></figure><p id="20ca" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">你有没有想过为什么你的一些机器学习模型预测是不正确的，尽管准确性很高，其他性能指标？</p><blockquote class="kf kg kh"><p id="2a1e" class="jj jk ki jl b jm jn ii jo jp jq il jr kj jt ju jv kk jx jy jz kl kb kc kd ke ha bi translated">获得良好的准确性就像在比赛前赢得掷硬币比赛一样。很好，但是还有很多工作要做。</p></blockquote><p id="0e42" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">一般来说，当你得到低准确度分数时，你可以尝试调整模型超参数，看看这是否有助于提高你的准确度，这里我们将更多地关注<strong class="jl hi">数据驱动方法</strong>。</p><p id="ff77" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">在本文中，我们将重点关注<strong class="jl hi">分析机器学习模型产生的错误，找出数据中的错误。然后，对您的数据进行一些更改并重新训练您的模型。</strong></p><p id="6a79" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">下面是我们将要经历的部分:</p><ol class=""><li id="b9f5" class="km kn hh jl b jm jn jp jq js ko jw kp ka kq ke kr ks kt ku bi translated">问题的介绍和概述</li><li id="d0d3" class="km kn hh jl b jm kv jp kw js kx jw ky ka kz ke kr ks kt ku bi translated">数据概述</li><li id="0ad0" class="km kn hh jl b jm kv jp kw js kx jw ky ka kz ke kr ks kt ku bi translated">将现实世界的问题映射到最大似然问题</li><li id="29f0" class="km kn hh jl b jm kv jp kw js kx jw ky ka kz ke kr ks kt ku bi translated">电子设计自动化(Electronic Design Automation)</li><li id="4938" class="km kn hh jl b jm kv jp kw js kx jw ky ka kz ke kr ks kt ku bi translated">特征工程</li><li id="ef5a" class="km kn hh jl b jm kv jp kw js kx jw ky ka kz ke kr ks kt ku bi translated">机器学习建模</li><li id="ba81" class="km kn hh jl b jm kv jp kw js kx jw ky ka kz ke kr ks kt ku bi translated">分析模型产生的错误</li></ol></div><div class="ab cl la lb go lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ha hb hc hd he"><h1 id="5f42" class="lh li hh bd lj lk ll lm ln lo lp lq lr in ls io lt iq lu ir lv it lw iu lx ly bi translated">1.问题的介绍和概述</h1><h2 id="ce0b" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated"><strong class="ak"> 1.1。概述</strong></h2><p id="a857" class="pw-post-body-paragraph jj jk hh jl b jm mn ii jo jp mo il jr js mp ju jv jw mq jy jz ka mr kc kd ke ha bi translated">我们将使用Kaggle的<strong class="jl hi">桑坦德银行客户交易预测</strong>问题。</p><p id="4f77" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">桑坦德银行是西班牙的一家银行，但自2013年以来一直为东北部的客户提供服务，在东北部和佛罗里达州设有分行和2000多台ATM。</p><p id="80e2" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">桑坦德银行过去曾举办过4次Kaggle比赛，其中“桑坦德银行客户交易预测”是2019年的最新一次。竞争是关于<strong class="jl hi">识别哪些客户将在未来进行特定的交易，而不考虑交易的金额。</strong></p><h2 id="5824" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">1.2.ML公式</h2><p id="385c" class="pw-post-body-paragraph jj jk hh jl b jm mn ii jo jp mo il jr js mp ju jv jw mq jy jz ka mr kc kd ke ha bi translated">我们在这里的任务是对客户是否会在未来进行交易进行分类。</p><h2 id="6146" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">1.3.业务限制</h2><ul class=""><li id="f8cd" class="km kn hh jl b jm mn jp mo js ms jw mt ka mu ke mv ks kt ku bi translated">没有提到延迟限制</li><li id="dbcb" class="km kn hh jl b jm kv jp kw js kx jw ky ka kz ke mv ks kt ku bi translated">我们假设可解释性并不重要，因为在Kaggle提交页面上并没有将其作为一个约束条件</li></ul></div><div class="ab cl la lb go lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ha hb hc hd he"><h1 id="1a57" class="lh li hh bd lj lk ll lm ln lo lp lq lr in ls io lt iq lu ir lv it lw iu lx ly bi translated">2.数据概述</h1><p id="5c70" class="pw-post-body-paragraph jj jk hh jl b jm mn ii jo jp mo il jr js mp ju jv jw mq jy jz ka mr kc kd ke ha bi translated">您将获得一个匿名数据集，其中包含<strong class="jl hi"> 200个数字特征变量</strong>、<strong class="jl hi">二进制</strong> <code class="du mw mx my mz b"><strong class="jl hi">target</strong></code> <strong class="jl hi">列</strong>和<strong class="jl hi">字符串</strong> <code class="du mw mx my mz b"><strong class="jl hi">ID_code</strong></code> <strong class="jl hi">列</strong>。</p><h2 id="1bb9" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">文件描述</h2><ul class=""><li id="5978" class="km kn hh jl b jm mn jp mo js ms jw mt ka mu ke mv ks kt ku bi translated"><strong class="jl hi"> train.csv </strong> —训练集。</li><li id="18f7" class="km kn hh jl b jm kv jp kw js kx jw ky ka kz ke mv ks kt ku bi translated"><strong class="jl hi"> test.csv </strong> —测试集。测试集包含一些不包括在评分中的行。</li></ul><p id="b088" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated"><strong class="jl hi">链接到数据集:</strong><a class="ae iw" href="https://www.kaggle.com/c/santander-customer-transaction-prediction/data" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/Santander-customer-transaction-prediction/data</a></p></div><div class="ab cl la lb go lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ha hb hc hd he"><h1 id="ee48" class="lh li hh bd lj lk ll lm ln lo lp lq lr in ls io lt iq lu ir lv it lw iu lx ly bi translated">3.将现实世界的问题映射到最大似然问题</h1><h2 id="d4a4" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">3.1.机器学习问题的类型</h2><p id="cbfe" class="pw-post-body-paragraph jj jk hh jl b jm mn ii jo jp mo il jr js mp ju jv jw mq jy jz ka mr kc kd ke ha bi translated">这是一个二元分类问题。</p><h2 id="ced2" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">3.2.评估指标</h2><p id="2ca1" class="pw-post-body-paragraph jj jk hh jl b jm mn ii jo jp mo il jr js mp ju jv jw mq jy jz ka mr kc kd ke ha bi translated">根据这个Kaggle竞赛的规则，我们将使用预测概率和观察目标之间的ROC曲线  <strong class="jl hi"> </strong>下的<a class="ae iw" href="http://en.wikipedia.org/wiki/Receiver_operating_characteristic" rel="noopener ugc nofollow" target="_blank"> <strong class="jl hi">区域。</strong></a></p></div><div class="ab cl la lb go lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ha hb hc hd he"><h1 id="721d" class="lh li hh bd lj lk ll lm ln lo lp lq lr in ls io lt iq lu ir lv it lw iu lx ly bi translated">4.探索性数据分析</h1><p id="01d8" class="pw-post-body-paragraph jj jk hh jl b jm mn ii jo jp mo il jr js mp ju jv jw mq jy jz ka mr kc kd ke ha bi translated"><strong class="jl hi">我刚刚在这里添加了所需的代码片段。您应该可以找到我的GitHub repo的链接，了解详细的代码实现。</strong></p><h1 id="3a4b" class="lh li hh bd lj lk na lm ln lo nb lq lr in nc io lt iq nd ir lv it ne iu lx ly bi translated">4.1.数据集基本分析</h1><h2 id="bc9a" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">4.1.1.首先让我们导入所有必要的库</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/c0bde29daf68e6fe9acd136337aed8b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rVrwbwaz7vYRMIhHMtxyZA.png"/></div></div></figure><h2 id="13d9" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">4.1.2.读取训练和测试csv文件</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/d411821654048f3d520b5b4c829de61b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YCY2X40MOVm4IYMHPyesNA.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ng"><img src="../Images/f4489bfa3e49b6be185f855f0d760d29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*084pDE_DXf5DKIXfFWN4BA.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/7c825cedce60ab09573ac9f6b4088907.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VKFkAdznNwRGUd0tdvA3iQ.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nh"><img src="../Images/95497e2790373a58744765b93a5eb238.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lutQHD5Kh0PtCaHuM97ldA.png"/></div></div><figcaption class="ni nj et er es nk nl bd b be z dx translated"><strong class="bd lj">“我们有20万行用于训练和测试集。“目标”是训练集中的附加列，因此有202列“</strong></figcaption></figure><h2 id="09ff" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">4.1.3.检查训练和测试数据集中的重复项</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/ea50b76869588c38ef291ec2f829a239.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*48AJkycE9g-inAeqnS_bcA.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nm"><img src="../Images/de996dc6740c75c03fd93457c3bed15b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MOxQKrcnB-YqJ5Q-IC2KkQ.png"/></div></div><figcaption class="ni nj et er es nk nl bd b be z dx translated"><strong class="bd lj">“训练集和测试集中没有重复的行”</strong></figcaption></figure><h2 id="1c89" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">4.1.4.检查训练和测试数据集中的空值</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/1f0c169d4e1ba0b092fac63a01f300e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fu1g-GtdfnPow-GfDBa1VA.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nn"><img src="../Images/5ae49752dca429bc4382f8831b7ab7fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R_vYck6L9KWj-UF7lDrmlw.png"/></div></div><figcaption class="ni nj et er es nk nl bd b be z dx translated"><strong class="bd lj">“训练集和测试集中均无‘空’”</strong></figcaption></figure><h2 id="e344" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">4.1.5.训练和测试数据观察:</h2><ul class=""><li id="e7ee" class="km kn hh jl b jm mn jp mo js ms jw mt ka mu ke mv ks kt ku bi translated">训练数据包含200k*202个形状。</li><li id="9fe8" class="km kn hh jl b jm kv jp kw js kx jw ky ka kz ke mv ks kt ku bi translated">测试数据包含200k*201形状。目标是这里缺失的列</li><li id="c896" class="km kn hh jl b jm kv jp kw js kx jw ky ka kz ke mv ks kt ku bi translated">在训练和测试数据中都“没有重复和缺失的值”</li></ul><h1 id="52b5" class="lh li hh bd lj lk na lm ln lo nb lq lr in nc io lt iq nd ir lv it ne iu lx ly bi translated">4.2.单变量分析</h1><h2 id="1a30" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">4.2.1.目标在训练数据中的分布</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/76761cb1c7026d6de137ed52f8a15963.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dfwB8kWEa4yGH6_gW3kYZQ.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es no"><img src="../Images/034d1879950a0299b7827e7fc306967c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*sIb661bP0VeVss9ANgz-Lw.png"/></div><figcaption class="ni nj et er es nk nl bd b be z dx translated"><strong class="bd lj">“目标明显不平衡”</strong></figcaption></figure><h2 id="78f2" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">4.2.2.按目标划分的所有200个特征的分布图</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/973b728e19dbafefe5072abfc7138973.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-BtNFaOsGaMNZ1pIc20LPQ.png"/></div></div></figure><div class="iy iz ja jb fd ab cb"><figure class="np jc nq nr ns nt nu paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/405fbc978b50429d6ea0af5e272710e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*47amMULA1SwZxFTdJL_PRg.png"/></div></figure><figure class="np jc nv nr ns nt nu paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/9741deeb3dd6bd5ffdbf793bf77b8087.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Wajgbr9rc3d6tGx836MEwQ.png"/></div><figcaption class="ni nj et er es nk nl bd b be z dx nw di nx ny translated"><strong class="bd lj">左:</strong>前100个特征的分布，<strong class="bd lj">右:</strong>后100个特征的分布</figcaption></figure></div><h2 id="2ce9" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">4.2.3.单变量分析观察值</h2><ul class=""><li id="d1fb" class="km kn hh jl b jm mn jp mo js ms jw mt ka mu ke mv ks kt ku bi translated">目标明显不平衡，约10%的客户进行了交易，其余的没有</li><li id="bb45" class="km kn hh jl b jm kv jp kw js kx jw ky ka kz ke mv ks kt ku bi translated">如果我们观察分布图，两个类别之间的分布图大部分重叠，有几个特征，如var0、var2、var6、var9等。这可能是我们区分阶级的重要特征之一</li></ul><h1 id="23a6" class="lh li hh bd lj lk na lm ln lo nb lq lr in nc io lt iq nd ir lv it ne iu lx ly bi translated">4.3.多变量分析</h1><h2 id="b98b" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">4.3.1.特征之间的相关性</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/bfef6f1f3143007d68730ab333bb2b6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5O3jEAUNUXM6IWmSC730wQ.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nz"><img src="../Images/35b3032de304abfe445d9c24f1372f1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*AKl-i7btDdaL4yYC6HBs0g.png"/></div><figcaption class="ni nj et er es nk nl bd b be z dx translated">“正如我们所见，特征之间没有关联”</figcaption></figure><h2 id="c982" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">4.3.2.多元分析观察值</h2><ul class=""><li id="0fd1" class="km kn hh jl b jm mn jp mo js ms jw mt ka mu ke mv ks kt ku bi translated">没有一个特征(X)是相互关联的，这就是为什么要模拟训练数据的原因</li></ul><h1 id="720b" class="lh li hh bd lj lk na lm ln lo nb lq lr in nc io lt iq nd ir lv it ne iu lx ly bi translated">4.4.训练集和测试集是否属于同一分布？</h1><p id="e646" class="pw-post-body-paragraph jj jk hh jl b jm mn ii jo jp mo il jr js mp ju jv jw mq jy jz ka mr kc kd ke ha bi translated">为了实现这一点，我们将对训练集使用伪目标1，对测试集使用伪目标0，然后使用逻辑回归来分割伪目标。如果我们获得了良好的AUC分数，那么我们的训练和测试分布是不同的，否则它们是相同的。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/cb01f195f21e4f29255e068f3c6a1a48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xQqCDnT2_rGPFdwzNNvTQQ.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es oa"><img src="../Images/fb1422e4872fc9de7d82acbe84ead32c.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*kcK5VVBgdzE8K3O_vbPKsw.png"/></div><figcaption class="ni nj et er es nk nl bd b be z dx translated">“正如我们所见，<strong class="bd lj"> AUC得分为0.51 </strong>，这很糟糕。因此<strong class="bd lj">训练和测试装置具有相同的分布</strong></figcaption></figure></div><div class="ab cl la lb go lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ha hb hc hd he"><h1 id="e526" class="lh li hh bd lj lk ll lm ln lo lp lq lr in ls io lt iq lu ir lv it lw iu lx ly bi translated">5.特征工程</h1><p id="48d6" class="pw-post-body-paragraph jj jk hh jl b jm mn ii jo jp mo il jr js mp ju jv jw mq jy jz ka mr kc kd ke ha bi translated">我尝试了几个特性，试图生成新的特性。<strong class="jl hi">我刚刚在这里添加了所需的代码片段。您应该可以找到我的GitHub repo的链接，以获得特性工程的详细代码实现。</strong></p><h2 id="e95e" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">5.1.数字特征的频率编码</h2><p id="dc0b" class="pw-post-body-paragraph jj jk hh jl b jm mn ii jo jp mo il jr js mp ju jv jw mq jy jz ka mr kc kd ke ha bi translated">我们将在现有的200个特征上增加200个新的频率编码特征。因此，我们将用于培训的<strong class="jl hi">总功能是400 </strong>。</p><p id="383a" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated">演职员表:<a class="ae iw" href="https://www.kaggle.com/cdeotte/200-magical-models-santander-0-920" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/cdeotte/200-magic-models-Santander-0-920</a></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/91b3f5a72d6921744ee3b947ebd1bfe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y0YacXz0iK66zXt4JssV2w.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ob"><img src="../Images/1355a1f78155948186d39ee7d8a0a44f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*5Rz9Zml4_08xCzl96KHxXA.png"/></div><figcaption class="ni nj et er es nk nl bd b be z dx translated"><strong class="bd lj">“我们的培训和测试集的最终形状”</strong></figcaption></figure></div><div class="ab cl la lb go lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ha hb hc hd he"><h1 id="7856" class="lh li hh bd lj lk ll lm ln lo lp lq lr in ls io lt iq lu ir lv it lw iu lx ly bi translated">6.机器学习建模</h1><p id="8a9a" class="pw-post-body-paragraph jj jk hh jl b jm mn ii jo jp mo il jr js mp ju jv jw mq jy jz ka mr kc kd ke ha bi translated"><strong class="jl hi">你可以查看我的GitHub repo所有的模型实验。在这里，我将展示我们的二元分类问题的最佳模型结果。</strong></p><h2 id="f871" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">6.1.LGBM模型</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/19f1971e1758f1737b658199ebf2a6d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*khjOfmzJ8TnsDxy6sBmosg.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es oc"><img src="../Images/d3dc48ce4988fc1ed5f768727f5c6cbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*TOE4fd39szAn_Bj8y4NjJA.png"/></div><figcaption class="ni nj et er es nk nl bd b be z dx translated">“如您所见，我们成功实现了0.90 的<strong class="bd lj">交叉验证AUC分数。”</strong></figcaption></figure><p id="aeb6" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated"><strong class="jl hi">使用Kaggle上的上述提交，我设法获得了0.90383的AUC分数，这是提交中的前10%。</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es od"><img src="../Images/ac6d2e36ed6e4139457a7474961bc449.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MbTxtMv3p9OH0s2kp5KwTg.png"/></div></div><figcaption class="ni nj et er es nk nl bd b be z dx translated">" Kaggle提交分数"</figcaption></figure></div><div class="ab cl la lb go lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ha hb hc hd he"><h1 id="6885" class="lh li hh bd lj lk ll lm ln lo lp lq lr in ls io lt iq lu ir lv it lw iu lx ly bi translated">7.分析模型产生的错误</h1><p id="3aa2" class="pw-post-body-paragraph jj jk hh jl b jm mn ii jo jp mo il jr js mp ju jv jw mq jy jz ka mr kc kd ke ha bi translated">在本节中，我们将查看由模型产生的<strong class="jl hi">错误，并尝试找出<strong class="jl hi">为什么会产生</strong>错误，以及是否有方法<strong class="jl hi">通过使用EDA </strong>获得洞察力来纠正错误。</strong></p><h2 id="f14d" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">7.1.导入必要的库</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/553d01768bfd63556cf330068900817e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z_MevSpznGxIiYkgNu0T9w.png"/></div></div></figure><h2 id="db75" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">7.2.读取带LGBM预测的csv</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/9d8d0e436dbe66806617a78a5983e44f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rD-PbZn89HJwJa6jv-5Xsg.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es oe"><img src="../Images/bd63d144699441881dffe685efe56402.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R3QIIXS-pSgmxsCZ2KROtA.png"/></div></div><figcaption class="ni nj et er es nk nl bd b be z dx translated">"新列<strong class="bd lj"> lgbm_predictions </strong>已添加到定型数据集中"</figcaption></figure><h2 id="ac55" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">7.3.预测概率的分布</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/43d4abecc5c7550510c9d76b7e5a358d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5kxSY-0OR5Pt8r_96SXEeA.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es of"><img src="../Images/6bf894ce9d5e804ca0fcaa5fb977033b.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*qezzP40flkcwQmmQoVuHHQ.png"/></div></figure><p id="dd8b" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated"><strong class="jl hi">观察:</strong>看下面的图，我们可以使用阈值，而不是使用0.5来决定等级0或1，我们可以使用0.4，因为我们可以看到等级0(蓝色)在大约0.4之后呈指数下降。</p><h2 id="7cc6" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">7.4.混淆矩阵</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/5a93742e31ed5825728cad9354da67e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z_dR2WeGGlfLt4zJn0Bt7w.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es of"><img src="../Images/4107a5536cb5c002cc56e907047bd58b.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*7tVF2Le744M_V18AudefaA.png"/></div></figure><p id="b5a9" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated"><strong class="jl hi">观察:</strong>由于数据集不平衡，我们可以看到占少数的<strong class="jl hi">类1(进行交易的客户)</strong>表现不佳。需要看“假阴性”。</p><h2 id="6ce7" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">7.5.最错误分类的类别</h2><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/bfbf70e8e183a689621fd61dc268ac38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cw9x6T8gd7diyOe7YqYQ_w.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es og"><img src="../Images/1485308fa7cd3a0f89e4b56ddb4d80c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*M8ct_v60EewaxqaQTxPFCQ.png"/></div></figure><p id="b4f4" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated"><strong class="jl hi">观察:</strong>正如我们在上面看到的，类别1是分类错误最多的类别，一个原因是类别1的训练数据点很少。</p><h2 id="ba77" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">7.6.深入了解1类</h2><p id="d5a3" class="pw-post-body-paragraph jj jk hh jl b jm mn ii jo jp mo il jr js mp ju jv jw mq jy jz ka mr kc kd ke ha bi translated">在这里，我们试图在错误分类的类1中找到一个模式，看看我们是否可以纠正数据，使模型表现得更好。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/9d9deb86461ab66cb2f51f1da0fa9e33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HeBjr1QLwASsQQkoWWh4Sg.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es oh"><img src="../Images/a71886d933d5b40eb4a4d87ba173207e.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*vp7fR0_A35syDsZ_mdGD5g.png"/></div></figure><p id="bce0" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated"><strong class="jl hi">观察:</strong>正如我们在上面<strong class="jl hi">看到的，超过50%的1类被错误分类。</strong></p><h2 id="6ca3" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">7.7.使用降维技术</h2><p id="0de6" class="pw-post-body-paragraph jj jk hh jl b jm mn ii jo jp mo il jr js mp ju jv jw mq jy jz ka mr kc kd ke ha bi translated">在这里，我们首先使用<strong class="jl hi"> PCA来解释约95%的差异</strong>，因为有400个特征，使用T-SNE会缓慢减少，然后使用<strong class="jl hi"> T-SNE进一步减少到2维</strong>并可视化。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/12b4fb5ac67f700c16b798405514a512.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BnIejjOxtP0UzZgr2nKvag.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es oi"><img src="../Images/04720da0f098afc861ba9896fffa753d.png" data-original-src="https://miro.medium.com/v2/resize:fit:204/format:webp/1*foxDm3guhfxb3G7ieUcf2Q.png"/></div><figcaption class="ni nj et er es nk nl bd b be z dx translated">“使用PCA，我们可以减少到4个特征，解释95%的差异”</figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/b28f5ddb2fdd2f2c0b1fe609e6e28b2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1WzrmYNiLf49pkznBbsFEw.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es oj"><img src="../Images/26a9cc3f53bac54825aee9d480cc127f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2y5kwXWVK-cVqr3VOMxoDw.png"/></div></div><figcaption class="ni nj et er es nk nl bd b be z dx translated"><strong class="bd lj">“此处蓝色代表分类错误的1级”</strong></figcaption></figure><p id="fc7c" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated"><strong class="jl hi">观察:</strong>不幸的是，这个训练数据集在放到Kaggle上之前已经进行了很好的特征设计，以至于错误分类均匀分布，没有显示出太多的模式。</p><h2 id="812d" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">7.8.“正确分类的1级分”和“错误分类的1级分”是同一个分布吗？</h2><p id="9058" class="pw-post-body-paragraph jj jk hh jl b jm mn ii jo jp mo il jr js mp ju jv jw mq jy jz ka mr kc kd ke ha bi translated">在本节中，我们将<strong class="jl hi">将伪目标</strong>添加到“正确分类的1级点”和“错误分类的1级点”中，并通过逻辑回归对它们进行运行，检查它们是否具有相同的分布。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/46d5bd3f77262d9fe4a9684996cacb1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LweyIXeaI5IqB99DxXYe_w.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ok"><img src="../Images/8aa6f1e70c9a7e57bfb72c3955fed0cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*yUtorEsKGnCvj1q1AHIK6Q.png"/></div><figcaption class="ni nj et er es nk nl bd b be z dx translated">" AUC分数= 0.7588 "</figcaption></figure><p id="566b" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated"><strong class="jl hi">观察结果:</strong>由于我们得到的AUC分数为0.75，因此“正确分类的类别1点”和“错误分类的类别1点”的分布是不同的— <strong class="jl hi"> <em class="ki">这是一个重要的观察结果，因为它告诉我们为什么模型错误分类了类别1。</em></strong></p><h2 id="fbe6" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">7.9.获取“前n名”功能以供进一步分析</h2><p id="fd77" class="pw-post-body-paragraph jj jk hh jl b jm mn ii jo jp mo il jr js mp ju jv jw mq jy jz ka mr kc kd ke ha bi translated">在本节中，我们将使用XGboost来帮助我们了解可以用于进一步分析的前15个特性。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/711cfa32c64b37e36cadb9e2851ea27d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xFI4bNLRe_J2uyqfqHwdQg.png"/></div></div></figure><h2 id="1aba" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">7.10.绘制分布图</h2><p id="b8de" class="pw-post-body-paragraph jj jk hh jl b jm mn ii jo jp mo il jr js mp ju jv jw mq jy jz ka mr kc kd ke ha bi translated">在本节中，我们将针对上述导出的前15个特征，绘制<strong class="jl hi">“0级”</strong>和<strong class="jl hi">“错误分类1级点”的分布图。</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nf"><img src="../Images/54354ddbe2b6cae94f7b8b39dff6e4b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QNSsughY4yLE8dGKhi5nKw.png"/></div></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ol"><img src="../Images/7bb82a179db6343dad8355a794c47685.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-JY-idnp7iMwCWI1IjMcAA.png"/></div></div><figcaption class="ni nj et er es nk nl bd b be z dx translated"><strong class="bd lj">“前15个特征分布图”</strong></figcaption></figure><p id="7107" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated"><strong class="jl hi">观察:</strong>正如我们在下面看到的，“错误分类的1类”和“0类”的分布基本相同，因此模型将一些数据点的1类错误分类为0类— <strong class="jl hi"> <em class="ki">这是一个重要的观察结果。</em> </strong></p><h1 id="07ab" class="lh li hh bd lj lk na lm ln lo nb lq lr in nc io lt iq nd ir lv it ne iu lx ly bi translated">最后意见</h1><h2 id="8276" class="lz li hh bd lj ma mb mc ln md me mf lr js mg mh lt jw mi mj lv ka mk ml lx mm bi translated">使用基本统计和一些可视化，我们可以得出以下结论:</h2><ul class=""><li id="96ba" class="km kn hh jl b jm mn jp mo js ms jw mt ka mu ke mv ks kt ku bi translated">使用降维PCA和T-SNE，我们可以得出结论，错误分类和正确分类的第1类没有显示任何模式，并且均匀分布，因此对于错误分类的第1类点没有检测到异常值</li><li id="ee30" class="km kn hh jl b jm kv jp kw js kx jw ky ka kz ke mv ks kt ku bi translated">更深入地观察前15个特征的分布，我们可以看到错误分类的第1类点与第0类分布非常相似，因此出现了错误分类。为了纠正这一点，我们需要查看错误分类的点或将其从数据集中移除，然后检查分数是否提高— <strong class="jl hi"> <em class="ki">。在移除数据点策略的情况下，我们需要小心不要过度拟合训练数据</em> </strong>。或者，我们可以检查这些错误分类的点的地面真实类标签是否不正确，以及当它们被标记时是否有错误</li></ul><h1 id="6f27" class="lh li hh bd lj lk na lm ln lo nb lq lr in nc io lt iq nd ir lv it ne iu lx ly bi translated">参考</h1><ol class=""><li id="0afe" class="km kn hh jl b jm mn jp mo js ms jw mt ka mu ke kr ks kt ku bi translated">【https://www.kaggle.com/gpreda/santander-eda-and-prediction T4】</li><li id="030f" class="km kn hh jl b jm kv jp kw js kx jw ky ka kz ke kr ks kt ku bi translated"><a class="ae iw" href="https://www.kaggle.com/cdeotte/200-magical-models-santander-0-920" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/cdeotte/200-magic-models-Santander-0-920</a></li></ol><h1 id="5e3c" class="lh li hh bd lj lk na lm ln lo nb lq lr in nc io lt iq nd ir lv it ne iu lx ly bi translated">个人资料链接</h1><p id="9647" class="pw-post-body-paragraph jj jk hh jl b jm mn ii jo jp mo il jr js mp ju jv jw mq jy jz ka mr kc kd ke ha bi translated"><strong class="jl hi">GitHub:</strong><a class="ae iw" href="https://github.com/ankitshah-dev/Analyzing-machine-learning-model-errors" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/ankitshah-dev/Analyzing-machine-learning-model-errors</a></p><p id="8513" class="pw-post-body-paragraph jj jk hh jl b jm jn ii jo jp jq il jr js jt ju jv jw jx jy jz ka kb kc kd ke ha bi translated"><strong class="jl hi">领英:</strong><a class="ae iw" href="http://www.linkedin.com/in/ankitshah91" rel="noopener ugc nofollow" target="_blank">www.linkedin.com/in/ankitshah91</a></p></div></div>    
</body>
</html>