<html>
<head>
<title>Collaborative Filtering with Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">神经网络协同过滤</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/collaborative-filtering-with-neural-networks-e9691683701f?source=collection_archive---------19-----------------------#2021-01-24">https://medium.com/analytics-vidhya/collaborative-filtering-with-neural-networks-e9691683701f?source=collection_archive---------19-----------------------#2021-01-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><pre class="ie if ig ih fd ii ij ik il aw im bi"><span id="dd33" class="in io hh ij b fi ip iq l ir is">How to model Recommendation(Collaborative Filtering) as a Neural Network?</span></pre><p id="70ef" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在这篇文章中，我将尝试用神经网络来建模一个推荐系统(协同过滤)。我将使用Jester数据集。由于Jester是一个主观的东西，所以我们试图对个人的喜欢进行建模。所以我们的意图是找到有相似爱好的人。</p><p id="032e" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">代码在github。(<a class="ae jr" href="https://github.com/mcelikkaya/medium_articles/blob/main/collaborative_filtering_jester_by_mlp.ipynb" rel="noopener ugc nofollow" target="_blank">链接</a></p><p id="e8e8" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">让我们先简化问题。想想我有5个jester和4个人，我有jester的用户评级。你可以看到有些人对同样的项目给出了相似的评价。这使得jester的用户向量。所以喜欢相似的人会有相似的向量。(它们在欧几里得空间中会彼此靠近)</p><figure class="ie if ig ih fd jt er es paragraph-image"><div class="er es js"><img src="../Images/6ea28775610d396712372e74633b1cec.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*eX76wk5MvUNmHuqemrBP5g.png"/></div></figure><p id="e4dc" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">现在转置矩阵。现在我们有了用户喜欢的jester向量。我们可以在我们的神经网络中使用这些向量作为特征，并训练一个网络。你可以认为这些是潜在的特征。也许Jester1是一个政治笑话，所以中年人喜欢它，但年轻人不喜欢。这些是我们代表潜在关系的数据。我们使用神经网络来模拟由于高维而无法理解的潜在关系。</p><figure class="ie if ig ih fd jt er es paragraph-image"><div class="er es jw"><img src="../Images/16989e08a7da8dcd69a31cfbc2cc1d36.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/format:webp/1*hExK6CJYANLmHp93qABEgw.png"/></div></figure><p id="93f6" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated"><strong class="iv hi">我们怎样才能塑造一个小丑？</strong></p><p id="5a8e" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">事实上，这些都是我们不知道的Jester的潜在特征。Jester可以是政治性的，也可以是关于婚姻、日常生活的…所以我们必须找到一种方法来矢量化Jester。</p><p id="e80a" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">Jester数据集有100列和近25K个用户。每一列都代表该jester的用户评级。可能缺少值。对于我假设的缺失值，我可以用每个用户的平均值来代替它们。(在生产质量系统中，我们必须检查用户或jester遗漏的值……)。下面我列出了数据文件的格式。</p><ol class=""><li id="dbc7" class="jx jy hh iv b iw ix ja jb je jz ji ka jm kb jq kc kd ke kf bi translated">评级是范围从-10.00到+10.00的真实值(值“99”对应于“空值”=“未评级”)。</li><li id="400f" class="jx jy hh iv b iw kg ja kh je ki ji kj jm kk jq kc kd ke kf bi translated">每个用户一行</li><li id="abaf" class="jx jy hh iv b iw kg ja kh je ki ji kj jm kk jq kc kd ke kf bi translated">第一列给出了该用户评价的笑话数量。接下来的100列给出了笑话01-100的评分。</li></ol><p id="34fd" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">下面我删除了第一列，使其成为[user x jester]表。如果您想使用数据，可以查看原始页面。(<a class="ae jr" href="https://goldberg.berkeley.edu/jester-data/" rel="noopener ugc nofollow" target="_blank">链接</a>)我只使用这个链接的第一个文件。我将范围[-10，10]到范围[-1，1]的数据归一化</p><figure class="ie if ig ih fd jt er es paragraph-image"><div class="er es kl"><img src="../Images/33a1a4e314d0ab41678fccb7c82ed68d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*UX3jJ-5eYttzWdiYVc-1Zw.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx translated"><strong class="bd kq"> Jester数据集，行用户，列Jester</strong></figcaption></figure><p id="8b34" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">现在我有25K(人)x 100 jester数据集。现在我们需要为我们的jesters和用户生成向量作为特性。所以把这个数据集当做jesters代表用户喜好。所以用户喜欢成为jester的一个特征向量。还要转置数据。这一次jesters成为用户的特征向量。</p><p id="fda1" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">如果我想创建一个用户向量，它的维度将是100。(用户对jester的喜欢)我现在想为jester创建一个嵌入。自然jester向量是25k。但是这个维度这么高。这样我就能造出一个更好的。我得到杰斯特的余弦，得到一个100x100的矩阵怎么样？这个矩阵显示了小丑之间的相似性。所以我也可以用它作为向量。</p><figure class="ie if ig ih fd jt er es paragraph-image"><div class="er es kr"><img src="../Images/32404945827ba834aa764e7b4e4b5984.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*GcisWx0JrWSoa5j_dOXoyA.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx translated"><strong class="bd kq"> Jester x Jester相似度表，可以用这个作为Jester的特征向量。</strong></figcaption></figure><p id="f6a2" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我将按照[user，jester]对准备我的输入，并按照评级输出。<br/>杰斯特嵌入+用户嵌入- &gt;评级</p><figure class="ie if ig ih fd jt"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="7088" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">现在我可以建立我的模型了。我将连接jester和用户向量，使其成为输入，并给出评级作为输出。这个模型很简单，我可以尝试更深层次的架构。</p><figure class="ie if ig ih fd jt"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="35d5" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">根据上面的模型，我们尝试了一个像MLP一样的简单建筑。网络得到200维(jester+user)的输入，输出1个数值(rating)。网络以<strong class="iv hi">val _ mean _ absolute _ error</strong>0.1226结束。由于我们的评级在-1和1之间标准化，这意味着%5的误差。</p><p id="324c" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">现在，我的模型能够预测给定用户<strong class="iv hi">和给定小丑的评分。现在，我将使用我的模型对所有user-jester对进行预测。我将添加一列来显示原始集合(np.na)中是否缺少这个值。因此，如果不存在(“新”)，这意味着完全预测。如果它是存在的，这意味着，我们的网络会猜测这个评级与什么是实际的评级。<br/>在这里我还计算了实际值和网络预测值之间的差异。假设实际值为3.01，而我们预测值为4.09，两者之间的差异接近1。但是我们的价值观在-10到10之间，所以我们的差距是20。这就产生了1/20 - &gt; %5的误差。所以我也可以给出每个用户的预测误差率。</strong></p><figure class="ie if ig ih fd jt er es paragraph-image"><div class="er es ku"><img src="../Images/4454d31b040e5816e97fd2c6d241c7c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*0fdkerCuA95BuycHpXChJA.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx translated"><strong class="bd kq">用户预测与实际评分</strong></figcaption></figure><p id="4f69" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在第二个架构中，我将使用<strong class="iv hi"> PCA、TSNE、Isomap </strong> ( <strong class="iv hi"> Isomap </strong>是一种非线性降维方法)进行降维，并创建一个带有正则化漏失的网络。在以前的架构中，我取jesters的余弦，并将其用作Jest向量。现在我将使用25K的向量来代替余弦。但这是如此之高，所以我会做一个降维，使其为50。所以我的新输入形状将是100(用户)+50(jester)</p><figure class="ie if ig ih fd jt"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="2ef6" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">我尝试了多种降维方法。如果你想玩这个代码，找到“取消对PCA的注释，尝试使用PCA”这一行，并把它改为PCA。(或者随便加什么方法。)您可以尝试其他方法，我们正在尝试将维数从25k降低到任何有意义的值。</p><p id="2bdb" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">PCA和Isomap面积的结果如下。它们的表现并不比余弦函数好。我认为余弦是一个显示潜在关系的实向量，这是降维，所以它损失了一些能量。</p><figure class="ie if ig ih fd jt er es paragraph-image"><div class="er es kv"><img src="../Images/12d739fedb7388304da30ddc53533222.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*Tv5CrUDONI9_Y38ha-yTtA.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx translated"><strong class="bd kq"> PCA预测</strong></figcaption></figure><figure class="ie if ig ih fd jt er es paragraph-image"><div class="er es kw"><img src="../Images/0629cf2e5161ac13f00ee28637dafc41.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*s_s3duRRUwUVbJcmciZ3Vw.png"/></div><figcaption class="km kn et er es ko kp bd b be z dx translated"><strong class="bd kq"> Isomap预测</strong></figcaption></figure><p id="fc2e" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">现在让我们尝试一个k倍交叉验证。我们将把数据分成子集，为每个子集训练一个模型，并对其进行评估。因此，我们将对我们的生产验证有更好的了解。k倍绝对误差为0.2。我们的目标值介于-1和1之间。所以每次预测都有10%的误差。</p><figure class="ie if ig ih fd jt"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="7af6" class="pw-post-body-paragraph it iu hh iv b iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq ha bi translated">在这篇文章中，我们将介绍一种利用神经网络进行协同过滤的方法。这种方法可能比传统方法有更大的方差误差，但也是建模深层潜在关系的更好的候选方法。我认为在我们的问题上值得一试。</p></div></div>    
</body>
</html>