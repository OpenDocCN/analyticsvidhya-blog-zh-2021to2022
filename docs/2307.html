<html>
<head>
<title>Image Segmentation using K-means clustering algorithm | Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用K-means聚类算法的图像分割| Python</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/image-segmentation-using-k-means-clustering-algorithm-python-cef588a79a63?source=collection_archive---------1-----------------------#2021-04-18">https://medium.com/analytics-vidhya/image-segmentation-using-k-means-clustering-algorithm-python-cef588a79a63?source=collection_archive---------1-----------------------#2021-04-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/03e3780b013b082a463ec17acdf3f308.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UkjmpV9ydwxyBgJSyKpkEA.png"/></div></div></figure><p id="694c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi jn translated"><span class="l jo jp jq bm jr js jt ju jv di">在</span>上一篇文章中，我们看到了如何用python从头实现K均值算法。我们深入研究了算法的工作原理，并讨论了一些可能的实际应用。在本教程中，我们将看到一个这样的应用。在本教程中，我们将了解如何使用K-means聚类来根据像素值将图像分割成多个片段。</p><p id="8f91" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">如果你是机器学习或者K-means新手，可以在这里</strong>  <strong class="ir hi">阅读原文</strong> <a class="ae jw" href="https://writersbyte.com/datascience/implementing-k-means-clustering-with-k-means-initialization-in-python/" rel="noopener ugc nofollow" target="_blank">。</a></p><div class="jx jy ez fb jz ka"><a href="https://writersbyte.com/datascience/implementing-k-means-clustering-with-k-means-initialization-in-python/" rel="noopener  ugc nofollow" target="_blank"><div class="kb ab dw"><div class="kc ab kd cl cj ke"><h2 class="bd hi fi z dy kf ea eb kg ed ef hg bi translated">实现K意味着用K Means++初始化| Python进行聚类。- WritersByte</h2><div class="kh l"><h3 class="bd b fi z dy kf ea eb kg ed ef dx translated">K-Means聚类是一种无监督的机器学习算法。无人监管意味着它不需要标签或…</h3></div><div class="ki l"><p class="bd b fp z dy kf ea eb kg ed ef dx translated">writersbyte.com</p></div></div><div class="kj l"><div class="kk l kl km kn kj ko in ka"/></div></div></a></div><p id="8ed1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">本文使用的完整代码可以在</strong> <a class="ae jw" href="https://github.com/Moosa-Ali/K-Means-Image-Clustering/blob/master/K-means%20for%20image%20classification.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">这里</strong> </a> <strong class="ir hi">找到。</strong></p><p id="2b8f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">更多AI相关文章，点击下方；</p><div class="jx jy ez fb jz ka"><a href="https://writersbyte.com/" rel="noopener  ugc nofollow" target="_blank"><div class="kb ab dw"><div class="kc ab kd cl cj ke"><h2 class="bd hi fi z dy kf ea eb kg ed ef hg bi translated">▤作家字节</h2><div class="kh l"><h3 class="bd b fi z dy kf ea eb kg ed ef dx translated">思想，故事和想法。</h3></div><div class="ki l"><p class="bd b fp z dy kf ea eb kg ed ef dx translated">writersbyte.com</p></div></div><div class="kj l"><div class="kp l kl km kn kj ko in ka"/></div></div></a></div><p id="6cec" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因为我们已经在原始文章中讨论了所有的本质细节，所以我将保持这篇文章相当简短。</p><p id="6d02" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">本教程将分为3个简短的部分。</p><p id="b91e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">图像文件的预处理步骤。</strong></p><p id="de42" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">算法的工作原理。</strong></p><p id="62db" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">结果。</strong></p><p id="80eb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们开始吧！！</p><p id="16ea" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">加载我们的图像将是我们的第一步。</p><p id="b33a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将使用以下从unsplash.com下载的图片</p><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kq"><img src="../Images/2debab133aeb917006e101cd8f03cf53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5wQfcpm0hL7ksT2ZMVCMzQ.jpeg"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">图片来源:乔希·里纳德(<a class="ae jw" href="https://unsplash.com/@joshrinard" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/@joshrinard</a>)</figcaption></figure><figure class="kr ks kt ku fd ii"><div class="bz dy l di"><div class="kz la l"/></div></figure><figure class="kr ks kt ku fd ii"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="9f0a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在继续前进之前，如果你喜欢这个内容，考虑给我买一个。</p><figure class="kr ks kt ku fd ii er es paragraph-image"><a href="http://ko-fi.com/moosaali9906"><div class="er es lb"><img src="../Images/a9b75b9a2d9b6bf73b23151d0a95f04f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RAVsw7Mcvsh8aJL3LuG6bg.png"/></div></a></figure><p id="c109" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们不能像处理正常数据点一样处理图像，这是因为彩色图像是一个三维矩阵(第三维是RGB颜色通道，不增加透视，但这对我们的数学工作很重要)。</p><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lc"><img src="../Images/a382d33d2f2b39ebe44c817c6b8567ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9VXFIpqouuS4L-G2axj-UQ.png"/></div></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">图像的维度表示</figcaption></figure><p id="26ce" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">每个通道由包含通道颜色(红色、绿色或蓝色)信息的像素组成</p><p id="4b56" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们需要把它转换成二维数据。</p><figure class="kr ks kt ku fd ii"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="f9ad" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们现在在数据框中有了展平的数据。是时候写算法了。该算法将与之前的原始算法保持一致，要深入了解K-means聚类，请阅读原始文章<a class="ae jw" rel="noopener" href="/geekculture/implementing-k-means-clustering-with-k-means-initialization-in-python-7ca5a859d63a">此处</a>。</p><figure class="kr ks kt ku fd ii"><div class="bz dy l di"><div class="kz la l"/></div></figure><p id="a4a0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">该算法针对<strong class="ir hi"> 5个集群</strong>运行；如变量<em class="ld">‘k’</em>所示。这一次，我们没有等待质心达到稳定值，而是设置了一个阈值来确保我们有最佳的质心。</p><p id="5697" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这样做是因为，对于图像数据，该算法需要很长时间来找到完美的质心，所以我们给它一个小的余量，也就是说，如果新旧质心之间的差在某个范围内，则退出循环并保留最后找到的质心。</p><blockquote class="le lf lg"><p id="a81c" class="ip iq ld ir b is it iu iv iw ix iy iz lh jb jc jd li jf jg jh lj jj jk jl jm ha bi translated">在这一点上需要注意的是，我们上面写的算法工作起来非常慢，因为速度和效率不是本教程的目标，这里我们只看K-means算法的工作。提高算法速度的一种方法是使用“itertuples”函数，而不是“iterrows ”,因为<strong class="ir hi">元组由于其静态内存分配而在遍历中至少快十倍。如果你知道任何其他方法来提高这个算法的效率，请在下面评论。</strong></p></blockquote><p id="84b9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">稍作等待后，算法已经完成了它的工作，让我们看看最终结果中有哪些质心。</p><pre class="kr ks kt ku fd lk ll lm ln aw lo bi"><span id="65f0" class="lp lq hh ll b fi lr ls l lt lu">centroids = centroids.to_numpy()<br/>print(centroids)</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div class="er es lv"><img src="../Images/f671315e28e1c26e72a38973e0125ff9.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*3dqRQYDZ6rF3UYW2KsFCOA.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">找到最终质心</figcaption></figure><p id="4e47" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在我们有了质心，我们需要做的就是画出结果。<strong class="ir hi">绘制以这样的方式完成，即特定簇中的所有像素都被该簇的质心覆盖。</strong></p><div class="jx jy ez fb jz ka"><a href="https://writersbyte.com/datascience/ai-for-beginners/" rel="noopener  ugc nofollow" target="_blank"><div class="kb ab dw"><div class="kc ab kd cl cj ke"><h2 class="bd hi fi z dy kf ea eb kg ed ef hg bi translated">人工智能初学者:人工智能基础- WritersByte</h2><div class="kh l"><h3 class="bd b fi z dy kf ea eb kg ed ef dx translated">你正在浏览你的脸书页面。你看到一则广告“我们的人工智能解决方案将改变你的…</h3></div><div class="ki l"><p class="bd b fp z dy kf ea eb kg ed ef dx translated">writersbyte.com</p></div></div><div class="kj l"><div class="lw l kl km kn kj ko in ka"/></div></div></a></div><div class="jx jy ez fb jz ka"><a href="https://writersbyte.com/datascience/ai-for-beginners-2/" rel="noopener  ugc nofollow" target="_blank"><div class="kb ab dw"><div class="kc ab kd cl cj ke"><h2 class="bd hi fi z dy kf ea eb kg ed ef hg bi translated">面向初学者的人工智能:机器学习VS深度学习</h2><div class="kh l"><h3 class="bd b fi z dy kf ea eb kg ed ef dx translated">在本系列的前一篇文章“人工智能基础”中，我解释了人工智能这个术语</h3></div><div class="ki l"><p class="bd b fp z dy kf ea eb kg ed ef dx translated">writersbyte.com</p></div></div><div class="kj l"><div class="lx l kl km kn kj ko in ka"/></div></div></a></div><p id="be42" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们看看最终的图像是什么样的。</p><figure class="kr ks kt ku fd ii"><div class="bz dy l di"><div class="kz la l"/></div></figure><figure class="kr ks kt ku fd ii er es paragraph-image"><div class="er es ly"><img src="../Images/e0ac0aaa076a952f79dee356ec72a681.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*FZaP2CtNotdCPNZTFlS5NQ.png"/></div><figcaption class="kv kw et er es kx ky bd b be z dx translated">最终图像</figcaption></figure><h1 id="e008" class="lz lq hh bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">结论</h1><p id="5ca1" class="pw-post-body-paragraph ip iq hh ir b is mw iu iv iw mx iy iz ja my jc jd je mz jg jh ji na jk jl jm ha bi translated">最终图像总共只有5种颜色(由于5个聚类)，这5种颜色代表原始图像中存在的主要颜色。</p><p id="e7bc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最终的图像看起来像是来自Instagram滤镜的东西。我们可以使用所获得的质心和聚类来为图像创建多个遮罩，并将其分成多个部分，例如，我们可以看到汽车的车身是红色的，但被分成两个不同的色调，我们可以为更少数量的聚类训练算法，然后将汽车的红色车身完全分开，因为它是单个聚类的一部分。</p><p id="e282" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">类似地，我们可以通过这种方式找到图像分割的多个用例。</p><figure class="kr ks kt ku fd ii er es paragraph-image"><a href="http://ko-fi.com/moosaali9906"><div class="er es lb"><img src="../Images/a9b75b9a2d9b6bf73b23151d0a95f04f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RAVsw7Mcvsh8aJL3LuG6bg.png"/></div></a></figure></div></div>    
</body>
</html>