<html>
<head>
<title>Parsing HTTP Params in Python Heroku Starter App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解析Python Heroku Starter应用程序中的HTTP参数</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/parsing-http-params-in-python-heroku-starter-app-2b7810a32e4?source=collection_archive---------4-----------------------#2021-09-14">https://medium.com/analytics-vidhya/parsing-http-params-in-python-heroku-starter-app-2b7810a32e4?source=collection_archive---------4-----------------------#2021-09-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/b8243b0592fb01a9823c8cce419be690.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*0zbW9krkadYJd0t9m_pGxg.jpeg"/></div></figure><p id="10f5" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我在这里写的很多故事(如果不是全部的话)都是因为我花了太多时间去寻找一个简单问题的解决方案。这是其中的一次。</p><p id="341d" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我正在做一个项目，在这个项目中，我要构建一个服务器来响应简单的GET API请求。Heroku是一个推荐的解决方案，由于我能够启动并运行这个项目，我感觉很好。</p><p id="32dd" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">接下来，是修改代码和接受参数的时候了，格式是</p><pre class="jj jk jl jm fd jn jo jp jq aw jr bi"><span id="43bb" class="js jt hh jo b fi ju jv l jw jx">curl -s <a class="ae jy" href="https://url.com?var=value" rel="noopener ugc nofollow" target="_blank">https://url.com?var=value</a></span></pre><p id="b6c6" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这是我溜进栈溢出兔子洞的地方。我在您的代码中看到了许多发送GET请求的方法(不是我想要的)和解析非url格式请求的方法(不幸的是，我被命令格式束缚住了手脚)。</p><p id="d7af" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">然而，最终我通过仔细查看启动项目发现了这个问题，并且，带着一点点运气，我发现了一个非常简单的方法来修改<a class="ae jy" href="https://devcenter.heroku.com/articles/getting-started-with-python#prepare-the-app" rel="noopener ugc nofollow" target="_blank">启动项目</a>以接受一个参数。</p><p id="f94c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">默认情况下，您用<strong class="in hi"> </strong> <code class="du jz ka kb jo b"><strong class="in hi">heroku create</strong></code>生成的URL会显示一个基本的登陆页面。让我们删除它。在hello/views.py中，注释掉<code class="du jz ka kb jo b"> def index(request):</code>函数中的代码行<code class="du jz ka kb jo b">return render(request, “index.html”)</code>。然后，如果您取消对<code class="du jz ka kb jo b">return HttpResponse(‘Hello from Python!’)</code>的注释并将您的更改推送到heroku main，当您转到URL时，您将会看到“Hello from Python”字符串。</p><p id="f3d1" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们知道如何发送HttpResponse，但是现在让我们解析http请求。我开始这个项目是为了一个智能井字游戏服务器，所以我想做的是接受一个游戏棋盘状态的X、O和+(空格)的字符串表示。所以从现在开始，我将通过添加一个参数来测试我的url，例如https://<myserver>.herokuapp.com/？board = xoxox ++ x .注意，如果你只是带着一个参数去url，它不会影响返回的响应。</myserver></p><p id="0a0c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在来解析url参数。您可以使用以下命令获取Http请求的参数:</p><pre class="jj jk jl jm fd jn jo jp jq aw jr bi"><span id="ee8f" class="js jt hh jo b fi ju jv l jw jx">board = request.GET.get('board')</span></pre><p id="e3e6" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">然后将可变板作为字符串处理:</p><pre class="jj jk jl jm fd jn jo jp jq aw jr bi"><span id="3e03" class="js jt hh jo b fi ju jv l jw jx">from django.http import HttpResponse, HttpResponseBadRequest</span><span id="9551" class="js jt hh jo b fi kc jv l jw jx">...</span><span id="816c" class="js jt hh jo b fi kc jv l jw jx">if board is None:</span><span id="96ef" class="js jt hh jo b fi kc jv l jw jx">    return HttpResponseBadRequest("no board parameter received")</span><span id="0e58" class="js jt hh jo b fi kc jv l jw jx">if len(board)!=9:</span><span id="c61d" class="js jt hh jo b fi kc jv l jw jx">    return HttpResponseBadRequest("incorrect number of spaces")</span><span id="6cb8" class="js jt hh jo b fi kc jv l jw jx">#TO-DO: game logic</span><span id="e0a8" class="js jt hh jo b fi kc jv l jw jx">return HttpResponse(board)</span></pre><p id="4b1d" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，如果您不带参数地访问链接或<code class="du jz ka kb jo b">curl -s &lt;URL&gt; </code>，将会显示一条HttpResponseBadRequest消息(无论您使用什么作为HttpResponseBadRequest()的输入)。同样，如果board参数的字符数不正确，则会发送错误的请求。否则，“游戏”继续进行，并返回一个棋盘。</p><p id="3e09" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">编码快乐！<br/>科琳</p></div></div>    
</body>
</html>