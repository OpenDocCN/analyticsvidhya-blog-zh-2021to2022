<html>
<head>
<title>Logistic Regression Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python进行逻辑回归</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/logistic-regression-using-python-a5044843a504?source=collection_archive---------0-----------------------#2021-09-30">https://medium.com/analytics-vidhya/logistic-regression-using-python-a5044843a504?source=collection_archive---------0-----------------------#2021-09-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9619c463ed7bfcd4da3a2e97b863ceab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eMgJSdCcerlh__Ip.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">线性回归和逻辑回归</figcaption></figure><h1 id="61cc" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">介绍</h1><p id="67ca" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">在有监督的机器学习世界中，有两种类型的算法任务经常被执行。一个叫回归(预测连续值)，一个叫分类(预测离散值)。在这篇博客中，我展示了一个叫做“二元逻辑回归”的二元分类算法的例子，它属于带有logit链接函数的二项式家族。二元逻辑回归用于预测二元类。例如，在您想要预测是/否、赢/输、负/正、真/假等等的情况下。为生产和研究出版物训练/拟合模型之间存在相当大的差异。这个博客将引导你通过一个以研究为导向的建模和解释的实践概述，也就是说，一个人如何能够建模一个二元逻辑回归并解释它，以便在期刊/文章中发表。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es kq"><img src="../Images/8b2a0369bc4aa06dadefd14244567b94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*O_-IWjD6-EuxVfPZ.gif"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">s形曲线</figcaption></figure><h1 id="d625" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">内容大纲</h1><ul class=""><li id="46b8" class="kv kw hi ju b jv jw jz ka kd kx kh ky kl kz kp la lb lc ld bi translated">数据背景</li><li id="1a08" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">建模的目的</li><li id="9a2f" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">数据加载</li><li id="de32" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">基本探索性分析</li><li id="fc79" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">数据准备</li><li id="646e" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">模型拟合/培训</li><li id="1d33" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">模型摘要的解释</li><li id="f92a" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">测试数据集上的模型评估</li><li id="f1ff" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">参考</li></ul><h1 id="adee" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">数据背景</h1><p id="aff5" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">在这个例子中，我们将使用从机器学习数据库的UCI储存库中获得的<a class="ae lj" href="https://github.com/nadeemoffl/Medium-Blogs/tree/main/Logistic%20Regression%20Using%20Python" rel="noopener ugc nofollow" target="_blank"> <strong class="ju hj"> <em class="lk">皮马印度糖尿病2 </em> </strong> </a>数据集(<strong class="ju hj"> <em class="lk">纽曼等人1998 </em> </strong>)。</p><p id="3e25" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">该数据集最初来自国家糖尿病、消化和肾脏疾病研究所。数据集的目的是基于数据集中包含的某些诊断测量结果，诊断性地预测患者是否患有糖尿病。从一个较大的数据库中选择这些实例有几个限制。特别是，这里的所有患者都是至少21岁的皮马印第安血统的女性。</p><p id="e6df" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">Pima Indian Diabetes 2数据集是Pima Indian Diabetes数据的细化版本(所有NA或缺失值均被移除)。数据集包含以下自变量和因变量。</p><p id="3c57" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated"><strong class="ju hj"> <em class="lk">自变量(符号:I) </em> </strong></p><ul class=""><li id="eb28" class="kv kw hi ju b jv ll jz lm kd lq kh lr kl ls kp la lb lc ld bi translated">I1: <strong class="ju hj"> <em class="lk">怀孕</em> </strong>:怀孕次数</li><li id="3154" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">I2: <strong class="ju hj"> <em class="lk">葡萄糖</em> </strong>:血浆葡萄糖浓度(葡萄糖耐量试验)</li><li id="a61a" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">I3: <strong class="ju hj"> <em class="lk">压力</em> </strong>:舒张压(毫米汞柱)</li><li id="fd62" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">I4: <strong class="ju hj"> <em class="lk">三头肌</em> </strong>:三头肌皮褶厚度(mm)</li><li id="71bd" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">I5: <strong class="ju hj"> <em class="lk">胰岛素</em> </strong> : 2小时血清胰岛素(μU/ml)</li><li id="112f" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">I6: <strong class="ju hj"> <em class="lk">质量</em> </strong>:身体质量指数(体重kg/(身高m)\)</li><li id="7cd0" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">I7: <strong class="ju hj"> <em class="lk">谱系</em> </strong>:糖尿病谱系功能</li><li id="2b96" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">I8: <strong class="ju hj"> <em class="lk">年龄</em> </strong>:年龄(年)</li></ul><p id="754f" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated"><strong class="ju hj"> <em class="lk">【因变量(符号:D) </em> </strong></p><ul class=""><li id="8ec4" class="kv kw hi ju b jv ll jz lm kd lq kh lr kl ls kp la lb lc ld bi translated">D1: <strong class="ju hj"> <em class="lk">糖尿病</em> </strong>:糖尿病病例(阳性/阴性)</li></ul><h1 id="12c8" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">建模的目的</h1><p id="45de" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">本博客的目的是拟合一个二元逻辑回归机器学习模型，该模型可以准确预测数据集中的患者是否患有糖尿病，然后了解真正影响他们的重要因素的影响。接下来，在看不见的数据集上测试训练模型的泛化(模型评估)强度。</p><h1 id="709f" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">加载库和数据集</h1><p id="2303" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated"><strong class="ju hj"> <em class="lk">第一步:</em> </strong>第一步是加载相关的库，比如熊猫(数据加载和操纵)，以及<strong class="ju hj"> matplotlib、</strong>和<strong class="ju hj"> seaborn </strong>(绘图)。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lt"><img src="../Images/f00e3e7c402e0fec79d854f43b791074.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_8g4unzM12f885Z5.png"/></div></div></figure><p id="83f4" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated"><strong class="ju hj"> <em class="lk">第二步:</em> </strong>下一步是使用pandas<strong class="ju hj"><em class="lk">read _ CSV()</em></strong>函数从本地存储中读取数据，并保存在一个名为<strong class="ju hj"> diabetes </strong>的变量中。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es lu"><img src="../Images/9f033316280bda658b443a12fc0cc64b.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/0*_8PvXDbOBCFoCXuz.png"/></div></figure><h1 id="90dd" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">探索性数据分析</h1><p id="1a68" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated"><strong class="ju hj"> <em class="lk">步骤1: </em> </strong>数据加载后，下一个重要步骤是执行探索性数据分析，这有助于熟悉数据。使用<strong class="ju hj"> <em class="lk"> head( ) </em> </strong>函数查看前五行数据。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/a3f7b189d613d043dbe69e6b99d1133e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*N_0OYD9aW7p5H3bw.png"/></div></div></figure><p id="3d53" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated"><strong class="ju hj"> <em class="lk">第二步:</em> </strong>了解列数据类型以及是否有数据缺失往往是必不可少的。<strong class="ju hj"> <em class="lk">。info( ) </em> </strong>方法有助于识别数据类型和缺失值的存在。</p><p id="33c0" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">下表显示<strong class="ju hj">糖尿病</strong>数据集包括<strong class="ju hj"> 392个观察值</strong>和<strong class="ju hj"> 9个列/变量</strong>。自变量包括整数64和浮点64数据类型，而因变量/响应变量(糖尿病)是字符串(负数/正数)数据类型，也称为<strong class="ju hj">对象</strong>。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es lw"><img src="../Images/d1775e98927aee3be5ba19c144bb6263.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/0*2gxpuMtxuz2R-ndn.png"/></div></figure><p id="3cce" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated"><strong class="ju hj"> <em class="lk">第三步</em> </strong>:我们可以使用seaborn的<strong class="ju hj"> <em class="lk"> regplot( ) </em> </strong>函数初步拟合一条逻辑回归直线，以可视化患糖尿病的概率如何随谱系标签而变化。使用<strong class="ju hj"> <em class="lk"> regplot( ) </em> </strong>将“<strong class="ju hj">谱系</strong>”绘制在x轴上，将“<strong class="ju hj">糖尿病</strong>”绘制在y轴上。以类似的方式，我们可以检查其他变量的逻辑回归图。只有在使用单个独立变量拟合逻辑回归时，这种类型的图才是可能的。当前图让您直观地了解逻辑模型如何拟合“S”曲线，以及概率如何随着观察值从0变化到1。在即将到来的模型拟合中，我们将训练/拟合包括多个独立变量的多元逻辑回归模型。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/b901cbe8234f14f88b4440de07e94bab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*t0_FmrLlKh55mV0E.png"/></div></div></figure><h1 id="6cc5" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">数据准备</h1><p id="6a74" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">在进行模型拟合之前，通常有必要确保数据类型与您将要使用的库/包一致。在糖尿病中，数据集因变量(糖尿病)由字符串/字符组成，即<strong class="ju hj"> <em class="lk"> neg/pos </em> </strong>，需要使用<strong class="ju hj"> <em class="lk">映射<strong class="ju hj"> neg: 0 </strong>和<strong class="ju hj"> pos: 1 </strong>将其转换为整数。</em>地图()</strong>方法。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/b073506d5bdba17a0559cbbd9dc3771f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mPrq-gNuN45ZFeJ-.png"/></div></div></figure><p id="ada0" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">现在可以看到因变量“<strong class="ju hj"> <em class="lk">糖尿病</em> </strong>”从<strong class="ju hj">对象</strong>转换为<strong class="ju hj">整数64 </strong>类型。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/557279e56a577b34b2e624088a77347a.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/0*UIsIZbCtad8LDFgv.png"/></div></figure><p id="0eb2" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">下一步是使用<strong class="ju hj">获得关于基本数据汇总统计的知识。describe( ) </strong>方法，计算计数、平均值、标准差、最小值、最大值和百分位(第25、50和75)值。这有助于您检测数据集中的任何异常。例如具有高方差的变量或极度扭曲的数据。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/8518de240ffc5a7bbe97402b394390a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*f_989vJzzwhwpYmE.png"/></div></div></figure><h1 id="78ed" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">模型拟合(二元逻辑回归)</h1><p id="4246" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">下一步是使用<strong class="ju hj"><em class="lk">sk learn . model _ selection</em></strong>模块的<strong class="ju hj"> train_test_split </strong>将糖尿病数据集拆分为训练和测试拆分，并使用<strong class="ju hj"> statsmodels </strong>包/库拟合逻辑回归模型。</p><h1 id="29b8" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">训练和测试分割</h1><p id="fe24" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">整个数据集通常分为80%训练数据集和20%测试数据集(一般经验法则)。80%的训练数据用于模型训练，而剩余的20%用于检查模型如何在看不见的数据集上推广。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/fb11ba8bf2930271052c28dc03c56d60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*80Kz_N1szuMZmcsO.png"/></div></div></figure><h1 id="e421" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">拟合逻辑回归</h1><p id="17c0" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">为了拟合逻辑回归模型，首先需要安装<strong class="ju hj"> <em class="lk"> statsmodels </em> </strong>包/库，然后需要从<strong class="ju hj"><em class="lk">stats models formula . API</em></strong>中导入<strong class="ju hj"> <em class="lk"> statsmodels.api </em> </strong>作为<strong class="ju hj"> <em class="lk"> sm </em> </strong>和<strong class="ju hj"> <em class="lk"> logit函数</em></strong></p><p id="5b2a" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">这里，我们将使用以下公式符号来拟合模型:</p><blockquote class="mb mc md"><p id="24fd" class="js jt lk ju b jv ll jx jy jz lm kb kc me ln kf kg mf lo kj kk mg lp kn ko kp hb bi translated"><em class="hi">公式=(' dep _ variable ~ ind _ variable 1+ind _ variable 2+……。如此类推)</em></p></blockquote><p id="e202" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">使用<strong class="ju hj"> <em class="lk"> logit( ) </em> </strong>函数拟合模型，同样可以使用<strong class="ju hj"> <em class="lk"> glm( ) </em> </strong>实现。这里，使用<strong class="ju hj"> <em class="lk"> logit( ) </em> </strong>函数，因为这提供了附加的模型拟合统计，例如<strong class="ju hj">伪R平方</strong>值。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mh"><img src="../Images/fd8e1fd0b2e2de85748394a14d904ce5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Oz_QHC5eAhUQR3p1.png"/></div></div></figure><h1 id="0b1d" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">模型摘要的解释</h1><p id="2299" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">模型拟合后，下一步是生成模型汇总表并解释模型系数。模型摘要包括两个部分。第一部分提供模型拟合统计，第二部分提供模型系数、其显著性和95%置信区间值。在出版物或文章写作中，你经常需要从汇总表中解释变量的系数。</p><p id="12dd" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">模型拟合统计显示，模型是使用<a class="ae lj" href="https://towardsdatascience.com/understanding-maximum-likelihood-estimation-mle-7e184d3444bd" rel="noopener" target="_blank"> <strong class="ju hj">最大似然估计</strong></a>(<strong class="ju hj"><em class="lk">MLE</em></strong>)技术拟合的。模型已正确收敛，显示没有错误。<strong class="ju hj"> <em class="lk">麦克法登伪R平方</em> </strong>值为0.327，表明模型拟合良好。</p><p id="795c" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">此外，该表还提供了一个<strong class="ju hj"> <em class="lk">对数似然比检验</em> </strong>。似然比检验(通常称为LR检验)是一种用于比较两个模型的拟合优度检验；零模型和最终模型。测试显示，当模型仅拟合截距(零模型)时，对数似然为-198.29，当拟合所有独立变量时，其显著改善(对数似然= -133.48)。合身性改善也很显著(p值&lt; 0.05)。</p><div class="kr ks kt ku fd ab cb"><figure class="mi ij mj mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/8a58494ed574537963f52a2867fa3c20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/0*vwQY4GecsNyGtXgt.png"/></div></figure><figure class="mi ij mo mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><img src="../Images/1c5dee68b728365a55b873d8a18ec477.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/0*eAPIxJB_L6_DLZUU.png"/></div></figure></div><p id="04c2" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">系数表显示，只有葡萄糖和系谱标签具有显著影响(p值&lt; 0.05) on diabetes. The coefficients are in log-odds terms. The interpretation of the model coefficients could be as follows:<br/>)葡萄糖的每一个单位变化将增加患糖尿病的对数几率0.038，其p值表明其在确定糖尿病方面具有显著性。类似地，家系中每增加一个单位，患糖尿病的对数几率增加1.231，p值也很显著。<br/>如果您需要在文章或出版物中报告，对数优势项中系数的解释没有多大意义。这就是为什么比值比的概念被引入。</p><h1 id="d6d2" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">让步比</h1><p id="5c06" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">几率是事件发生的概率与事件不发生的概率之比。当我们取两个这样的比值时，它被称为比值比。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/cc0555db2dcdf1c50b825ceda927c649.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/0*cY1uDXMiHhbbkt9V.png"/></div></figure><p id="28a8" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">在数学上，我们可以通过估计系数的指数来计算比值比。例如，在下面的比值比表中，您可以观察到谱系的比值比是3.427，这表明谱系标签中每增加一个单位，患糖尿病的几率就增加3.427倍。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es mq"><img src="../Images/89dbe7941a63c883864629ca496900b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/0*Hq71DCjPxQB5xtOf.png"/></div></figure><h1 id="19f0" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">边际效应计算</h1><p id="b7ad" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">边际效应是一种替代性的度量，可以用来描述预测因子对结果变量的影响。边际效应可以描述为在模型中所有其他变量保持不变的情况下，作为治疗(或感兴趣的独立变量)变化的函数的结果变化。在线性回归中，估计的回归系数是边际效应，更容易解释。</p><p id="9f13" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">研究人员报道的边际效应有三种类型:<strong class="ju hj">在代表值处的边际效应</strong>(MERs)<strong class="ju hj">在均值处的边际效应</strong> (MEMs)，以及<strong class="ju hj">在x的每个观测值处的平均边际效应</strong>以及跨结果的平均值(AMEs)，(<strong class="ju hj"> <em class="lk"> Leeper，2017 </em> </strong>)。对于分类变量，计算与参考水平相对应的每个离散变化的平均边际效应。</p><p id="3562" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated"><strong class="ju hj"> statsmodels </strong>库提供以下<strong class="ju hj">边际效应</strong>计算:</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/ea8f58f7fb9b1621b4fc65489aef0606.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/0*7MaYKMoWKGo7wHZC.png"/></div></figure><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/b7fb0a6af390679fa85cb12d61a48508.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xeZVhhCYiLqwectA.png"/></div></div></figure><p id="4c04" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">在STEM研究领域，平均边际效应是非常流行的，并且经常被研究人员报道。在我们的例子中，我们已经使用<strong class="ju hj"> <em class="lk">估计了预测变量的AMEs。</em>get _ marge ff()</strong>函数并打印报告摘要。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/ce2dca5e26828b4384fef207a5b9bef6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YW92A55MKVX7S8vO.png"/></div></div></figure><p id="5b26" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">平均边际效应表报告了AMEs、标准误差、z值、p值和95%置信区间。AMEs的解释类似于线性模型。例如，系谱的AME值是0.1677，这可以解释为系谱值增加一个单位，患糖尿病的概率增加16.77%。</p><h1 id="dbe5" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">测试数据集上的模型评估</h1><p id="93ed" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">在拟合二元逻辑回归模型后，下一步是检查拟合的模型在看不见的数据(即20%的测试数据)上表现如何。</p><p id="a44d" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">因此，下一步是预测测试数据集中的类，并生成混淆矩阵。这些步骤包括以下内容:</p><ul class=""><li id="cb89" class="kv kw hi ju b jv ll jz lm kd lq kh lr kl ls kp la lb lc ld bi translated">第一步将<strong class="ju hj"> NumPy </strong>库导入为<strong class="ju hj"> np </strong>并导入<strong class="ju hj">T5】分类_报告 </strong>和<strong class="ju hj"> <em class="lk">准确性_得分</em></strong>from<strong class="ju hj"><em class="lk">sk learn . metrics .</em></strong></li><li id="56f9" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">接下来使用<strong class="ju hj"><em class="lk">model . predict()</em></strong>函数预测糖尿病概率</li><li id="03d9" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">设定一个<strong class="ju hj"> <em class="lk">截止值</em> </strong> (0.5为二元分类)。低于0.5的概率将糖尿病治疗为阴性(0)，高于阳性(1)</li><li id="8fea" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp la lb lc ld bi translated">使用pandas<strong class="ju hj"><em class="lk">crosstab()</em></strong>创建实际(负:0，位置:1)和预测(负:0，位置:1)之间的混淆矩阵</li></ul><h1 id="173f" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">混淆矩阵</h1><p id="5561" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">混淆矩阵揭示了测试数据集具有52个阴性(0)和27个阳性(1)的样本情况。训练的模型准确地分类了44个阴性(阴性:0)和16个阳性(阳性:1)类。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/0f08ac0a82eba3ca7225a6abdae96698.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wvXBTxlJ_Iuu6_cU.png"/></div></div></figure><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es mv"><img src="../Images/165dba3c2b4c02d50d80ea867d302f5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:566/format:webp/0*WyR9CbW5P4mdxH3H.png"/></div></figure><h1 id="5410" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">分类准确度</h1><p id="4c69" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">分类精度可以计算如下:</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es mw"><img src="../Images/421d809585f5f9441a56c5d903b3eede.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/0*JTZKN9Qn6cTbz13C.png"/></div></figure><p id="c584" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">使用<strong class="ju hj"><em class="lk">accuracy _ score()</em></strong>函数可以估算出相同的精度。结果表明，该分类器对未知数据的分类准确率约为76%。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es mx"><img src="../Images/fc60fc453a1c23170e9ac03c3ff66403.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/0*mXuUqUNMfNmr7hRJ.png"/></div></figure><h1 id="f1e1" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">分类报告</h1><p id="96f5" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">分类报告用于衡量分类算法的预测质量。有多少预测是真的，有多少是假的。分类报告在生成分类报告时使用真阳性、真阴性、假阳性和假阴性。</p><ol class=""><li id="cb78" class="kv kw hi ju b jv ll jz lm kd lq kh lr kl ls kp my lb lc ld bi translated"><strong class="ju hj"> TP /真阳性:</strong>当实际观察结果为阳性且模型预测也为阳性时</li><li id="4083" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp my lb lc ld bi translated"><strong class="ju hj"> TN /真负值:</strong>当实际观察值为负值且模型预测值也为负值时</li><li id="64f3" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp my lb lc ld bi translated"><strong class="ju hj"> FP /假阳性:</strong>当实际观察结果为阴性但模型预测为阳性时</li><li id="a630" class="kv kw hi ju b jv le jz lf kd lg kh lh kl li kp my lb lc ld bi translated"><strong class="ju hj"> FN /假阴性:</strong>当实际观察为阳性，但模型预测为阴性时</li></ol><p id="e142" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">分类报告提供了关于精确度、召回率和F1分数的信息。</p><p id="ab21" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">我们已经计算了分类精度，那么明显的问题是，对精度、召回率和F1值的需求是什么？<strong class="ju hj"> <em class="lk">答案是当数据集</em> </strong>中存在类别不平衡时，准确性不是一个好的衡量标准。如果因变量包括大约相等比例的两个类别(在二进制分类情况下)，则称数据集是平衡的。例如，如果糖尿病数据集包括50%的糖尿病患者样本和50%的非糖尿病患者样本，那么数据集被认为是平衡的，在这种情况下，我们可以使用准确性作为评估指标。但在现实世界中，实际情况往往并非如此。</p><p id="7065" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">让我们用一个例子使它更具体。假设您收集了一个有1000个样本的糖尿病数据集。您将数据集传递给训练好的模型，模型预测所有样本都是非糖尿病患者。但是后来当你浏览你的数据集时，你在1000个样本数据中观察到3名患者患有糖尿病。因此，我们的模型错误地将3名患者分类为非糖尿病患者(假阴性)。即使在3次错误分类之后，如果我们计算预测精度，那么我们仍然得到99.7%的高精度。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es mz"><img src="../Images/15dfc7f0e889cb547ef74eccdf77f603.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/0*y4dQol0tUTW5sHQp.png"/></div></figure><p id="0ddf" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">但是实际上，该模型没有达到目的，即，不能准确地对糖尿病患者进行分类，因此对于不平衡的数据集，准确性不是一个好的评估度量。</p><p id="d651" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">为了解决这个问题，引入了精确度和召回率的概念。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es na"><img src="../Images/c99cad29b63b64f5a2f40b5c6537f21a.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/0*84g1_bLKScr-6xkI.png"/></div></figure><p id="7966" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated"><strong class="ju hj">精度:</strong>决定正面预测的准确性。</p><p id="719b" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated"><strong class="ju hj">回忆</strong>:确定正确识别的阳性率。</p><p id="f662" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated"><strong class="ju hj"> F1得分</strong>是精度和召回的加权调和平均值，最佳得分为1，最差得分为0。F1分数传达了精确度和召回率之间的平衡。</p><p id="f2e8" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">分类报告显示F1分数的微观平均值约为0.72，这表明训练的模型具有72%的分类强度。</p><figure class="kr ks kt ku fd ij er es paragraph-image"><div class="er es nb"><img src="../Images/d5a4a6568abb5be26ad088a2461dc54d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/0*w3C6hJBqfFAvEjQd.png"/></div></figure><p id="6b73" class="pw-post-body-paragraph js jt hi ju b jv ll jx jy jz lm kb kc kd ln kf kg kh lo kj kk kl lp kn ko kp hb bi translated">二元逻辑回归仍然是STEM研究领域中非常流行的ML算法(用于二元分类)。与许多复杂的黑盒模型相比，它仍然非常容易训练和解释。</p><h1 id="44f6" class="iu iv hi bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">数据集和代码</h1><p id="75ce" class="pw-post-body-paragraph js jt hi ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated"><a class="ae lj" href="https://github.com/nadeemoffl/Medium-Blogs/tree/main/Logistic%20Regression%20Using%20Python" rel="noopener ugc nofollow" target="_blank"> <em class="lk">点击此处查看糖尿病数据和代码</em> </a></p></div></div>    
</body>
</html>