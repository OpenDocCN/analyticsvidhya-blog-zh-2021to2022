<html>
<head>
<title>F-statistic: Understanding model significance using python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">f统计量:使用python理解模型的重要性</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/f-statistic-understanding-model-significance-using-python-c1371980b796?source=collection_archive---------0-----------------------#2021-09-12">https://medium.com/analytics-vidhya/f-statistic-understanding-model-significance-using-python-c1371980b796?source=collection_archive---------0-----------------------#2021-09-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/76eefadb720ee3fda0876c6e7aa2e128.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TZCWfdsfcBIxMGtFphzzVg.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated"><a class="ae iu" href="https://unsplash.com/@andrewtneel?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">安德鲁·尼尔</a>在<a class="ae iu" href="https://unsplash.com/s/photos/decision?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><p id="92ec" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在统计学中，<strong class="ix hj">显著性检验</strong>是一种根据数据得出拒绝或接受某些主张的结论的方法。在回归分析的情况下，它用于确定自变量在解释因变量的方差时是否显著。假设我们有回归方程:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="56e5" class="kc kd hi jy b fi ke kf l kg kh">y = intercept + β*x</span><span id="63c9" class="kc kd hi jy b fi ki kf l kg kh">y: independent variable<br/>β: regression co-efficient<br/>x: dependent variable</span></pre><p id="1659" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这种情况下，</p><ul class=""><li id="687e" class="kj kk hi ix b iy iz jc jd jg kl jk km jo kn js ko kp kq kr bi translated">零假设H0将是:<em class="ks"> β </em> = 0，即预测值<em class="ks"> x </em>不能解释自变量<em class="ks"> y </em>的方差。</li><li id="c167" class="kj kk hi ix b iy kt jc ku jg kv jk kw jo kx js ko kp kq kr bi translated">另一个假设H1将是:<em class="ks"> β </em> ≠ 0，即<em class="ks"> x </em>在预测<em class="ks"> y </em>的值时是有意义的。</li></ul><p id="0a27" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因为这里我们只有一个预测器，T检验应该足够了。然而，在现实中，我们的模型将包括<strong class="ix hj">个独立变量</strong>。这就是F统计量发挥作用的地方。</p><p id="6976" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">f统计量可用于寻找多个自变量的<strong class="ix hj">联合显著性</strong>。它用于比较两个模型解释因变量方差的能力。换句话说，它可以帮助确定是使用复杂的模型还是简单的版本。无效假设和替代假设类似于T检验中的假设。所以对于给定的回归方程:</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="9029" class="kc kd hi jy b fi ke kf l kg kh">y = intercept + β1*x1 + β2*x2 + ... + βn*xn</span></pre><ul class=""><li id="a579" class="kj kk hi ix b iy iz jc jd jg kl jk km jo kn js ko kp kq kr bi translated">零假设H0将是:<em class="ks">β1</em>=<em class="ks">β2</em>=…=<em class="ks">βn</em>= 0</li><li id="9521" class="kj kk hi ix b iy kt jc ku jg kv jk kw jo kx js ko kp kq kr bi translated">另一个假设H1会是:<em class="ks"> βi </em> ≠ 0</li></ul><p id="e65d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">因此，如果甚至一个系数是重要的，那么很有可能拒绝零假设，因为系数不再是<strong class="ix hj">共同不重要的</strong>。这里，这两个模型可以是包含所有预测变量的<strong class="ix hj">非限制模型</strong>，或者是限制预测变量数量的限制模型。对于本文，我将使用一个只拦截的<strong class="ix hj">模型作为受限模型。</strong></p><p id="0950" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">每个模型都有一些<strong class="ix hj">剩余</strong>与之相关联。残差只不过是从数据点到回归线的距离的度量。在我们的例子中，我们有两种类型的残差:</p><ul class=""><li id="76cb" class="kj kk hi ix b iy iz jc jd jg kl jk km jo kn js ko kp kq kr bi translated">SSRr:受限模型的残差平方和</li><li id="4f0c" class="kj kk hi ix b iy kt jc ku jg kv jk kw jo kx js ko kp kq kr bi translated">SSRu:无限制模型的残差平方和</li></ul><p id="aefd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">SSRr将总是大于SSRu，因为受限模型不能很好地捕捉因变量的方差。添加变量有助于减少误差，不管我们添加的是重要变量还是噪声。</p><p id="e1ab" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是如果无限制模型总是比限制模型有更小的误差，那么我们为什么需要F-统计量呢？因为我们要问的问题是，它是否比无限制模型大得多。</p><p id="0a01" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">F统计量的等式为:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es ky"><img src="../Images/6a12a540838006efee8c42bdec691d3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*g4Yln2hFqrx54uRGgTIJlw.png"/></div></figure><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es kz"><img src="../Images/9b774433c7c0893a14ff260bbf6d9f67.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/format:webp/1*jAhxWM2UyIw_wZrGVanIlw.png"/></div></figure><p id="9451" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">由于残差平方和(SSR)是无单位的，除以分子中的<em class="ks"> P </em>和分母中的<em class="ks"> N-P-1 </em>让我们形成一个可比较的分布。这两个也正好是我们的<strong class="ix hj">自由度</strong>。所以，</p><ul class=""><li id="68cd" class="kj kk hi ix b iy iz jc jd jg kl jk km jo kn js ko kp kq kr bi translated">df1 = <em class="ks"> P </em>:自由度1</li><li id="fc70" class="kj kk hi ix b iy kt jc ku jg kv jk kw jo kx js ko kp kq kr bi translated">df2 = <em class="ks"> N-P-1 </em>:自由度2</li></ul><p id="ff3a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们要与之比较的分布叫做<strong class="ix hj"> F分布</strong>。我们通常采用95% 的<strong class="ix hj">置信区间，即转化为0.05 </strong>的<strong class="ix hj"> alpha值。基于两个自由度的值和alpha值，我们可以在F分布上找到<strong class="ix hj"> F临界</strong>值。如果F-统计值大于F-临界，我们拒绝零假设，换句话说，我们有足够的证据表明给定的自变量在解释因变量的方差方面是显著的。</strong></p><p id="bf3d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了在python上展示这一点，我使用了一个汽车数据集。问题陈述只是基于一些特征/独立变量来寻找车辆的价格。这些参数包括<em class="ks">马力、峰值转速、缸径和冲程</em>。</p><p id="0e46" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">所以我们先从导入熊猫开始，读取CSV文件。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="4249" class="kc kd hi jy b fi ke kf l kg kh">import pandas as pd<br/>df = pd.read_csv('Automobile_data.csv')</span><span id="e19b" class="kc kd hi jy b fi ki kf l kg kh">print(df.head())</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es la"><img src="../Images/07e4944b9f0b8017dc316a85ee285812.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*5lgBYxWxaLjGMIxkw9w8Lg.png"/></div></figure><p id="098b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将自变量和因变量分别赋给<em class="ks"> X </em>和<em class="ks"> y </em>变量。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="30fa" class="kc kd hi jy b fi ke kf l kg kh">X = df.drop(['price'], 1)<br/>y = df['price']</span></pre><p id="4040" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了计算F统计量，我将导入一个名为<strong class="ix hj"> statsmodels </strong>的库。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="6bf5" class="kc kd hi jy b fi ke kf l kg kh">import statsmodels.api as sm</span></pre><p id="1981" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">默认情况下不会添加截距，因此必须手动添加。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="a688" class="kc kd hi jy b fi ke kf l kg kh">X = sm.add_constant(x)<br/>print(X)</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lb"><img src="../Images/9a75c95ce31e8b130335930622dbd77e.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*dhaAuGNuW5RFn9SHV89LpA.png"/></div></figure><p id="11af" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，我们可以使用statsmodels的OLS(普通最小二乘法)方法来拟合数据。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="9c76" class="kc kd hi jy b fi ke kf l kg kh">results = sm.OLS(y, X).fit()</span><span id="386f" class="kc kd hi jy b fi ki kf l kg kh">A = np.identity(len(results.params))<br/>A = A[1:,:]</span><span id="a974" class="kc kd hi jy b fi ki kf l kg kh">print(results.f_test(A))</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lc"><img src="../Images/fd7329c205318585154145809b1a1bbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FHRsiQYSS-Etqn-ThlL6bA.png"/></div></div></figure><p id="8d83" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">结果显示，与仅截距模型相比，给定模型的F统计值为108.272。它还显示了两个自由度:df1 = 4°和df2 = 190。为了找到F临界值，我们可以在F分布表中查找α值0.05。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ld"><img src="../Images/0baa51499eafc78a1dfd6bf5b2327681.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kyOjs1lwICMWnwrExlRWDg.png"/></div></div></figure><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es le"><img src="../Images/07e793e5040a66b4ed5863871123c193.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*2H9A-3HFNcGGbiWQMirHWw.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">来源:<a class="ae iu" href="http://www.socr.ucla.edu/Applets.dir/F_Table.html" rel="noopener ugc nofollow" target="_blank">http://www.socr.ucla.edu/Applets.dir/F_Table.html</a></figcaption></figure><p id="6b06" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">比较自由度的值以获得F临界值。我们的df1是4，df2是190，所以我们必须查找第4列，因为df2大于120，所以我们必须检查最后一行。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lf"><img src="../Images/0b96c0707c38f89669d284efa6aadd16.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*_sGsDkFe9yn368l371UKsQ.png"/></div></figure><p id="dc62" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们得到的F临界值为2.3719，远低于我们的F统计值108.272。由于F-统计&gt; F-临界，我们拒绝零假设，这意味着自变量在解释因变量的方差时是共同显著的。</p><p id="8110" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">相反，您也可以打印显示回归结果的OLS模型的摘要。</p><pre class="jt ju jv jw fd jx jy jz ka aw kb bi"><span id="98ae" class="kc kd hi jy b fi ke kf l kg kh">print(results.summary())</span></pre><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lg"><img src="../Images/631aa14fcfb2e6e7bab8491ddce476e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*38fir0yPKW5ZZ_2UKbU6Yw.png"/></div></div></figure><p id="bf06" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在这种情况下，我们可以检查汇总中的p值(列为Prob F-statistic ),以确定是拒绝还是接受零假设。这里的p值是完整模型的零假设为真的概率(即所有回归系数为零)。由于p值近似为零，我们拒绝零假设。换句话说，有证据表明价格和预测变量之间存在线性关系。</p><p id="4893" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">总结</strong></p><ul class=""><li id="3dce" class="kj kk hi ix b iy iz jc jd jg kl jk km jo kn js ko kp kq kr bi translated">显著性测试可以帮助我们决定是应该采用复杂的模型还是简单的模型。</li><li id="328b" class="kj kk hi ix b iy kt jc ku jg kv jk kw jo kx js ko kp kq kr bi translated">f统计量可用于了解给定的预测变量集在解释因变量的方差方面是否显著。</li><li id="6f46" class="kj kk hi ix b iy kt jc ku jg kv jk kw jo kx js ko kp kq kr bi translated">如果F-统计量&gt; F-临界，或者如果概率(F-统计量)约为0，那么我们拒绝零假设。换句话说，给定的回归是有意义的。</li></ul><p id="015a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">快乐造型！</p><p id="37d6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">数据:<a class="ae iu" href="https://www.kaggle.com/toramky/automobile-dataset" rel="noopener ugc nofollow" target="_blank">来源</a></p></div></div>    
</body>
</html>