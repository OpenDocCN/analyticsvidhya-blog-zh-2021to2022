<html>
<head>
<title>Cloud Computing Applications Series: Restaurant Suggestion Chatbot with AWS Lex, API Gateway and DynamoDB/Elasticsearch — 1.1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">云计算应用系列:带有AWS Lex、API Gateway和DynamoDB/Elasticsearch的餐馆建议聊天机器人— 1.1</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/cloud-computing-applications-series-restaurant-suggestion-chatbot-with-aws-lex-api-gateway-and-81ca7e616e6e?source=collection_archive---------4-----------------------#2021-01-23">https://medium.com/analytics-vidhya/cloud-computing-applications-series-restaurant-suggestion-chatbot-with-aws-lex-api-gateway-and-81ca7e616e6e?source=collection_archive---------4-----------------------#2021-01-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/31402e56ee1d7b8f4f2e3f342d22c375.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*PoeHrdtewHacxBvTgwTwgA.jpeg"/></div></figure><p id="6edb" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">你好中等社区！</p><p id="e256" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">今天，我们将开始探索将云计算服务用于端到端应用。本系列的主题基于我在2020年秋季在哥伦比亚大学Sambit Sahu教授指导下作为云计算课程(COMS6998)的一部分承担的任务/小型项目。<strong class="in hi">(因此，类似AWS的lambda函数中使用的逻辑流代码将不会完整提供，而是根据教程上传重要部分的片段。)</strong></p><p id="88f3" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在我们开始我们的旅程之前，我想借此机会向所有读者致辞，并欢迎他们来到我的页面。这是我的第一篇文章，试图回馈给充满活力和令人惊叹的数据科学家、工程师和狂热的学习者社区，即媒体和未来数据科学社区。2017年9月，我第一次开始了我的数据科学之旅，并且一直非常崇拜大量的在线文章、博客帖子和资源，这些都使自学和技能提升成为可能。</p><p id="966f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">多年来，每当我陷入一个问题时，数据科学一直是我的求助资源，但每当我希望探索一个新的主题/领域时，它也是一个极好的起点。通过这篇文章和接下来的其他文章，我希望在数据科学/机器学习之旅中回馈和帮助个人，并希望我的文章可以帮助他们走向成功。</p><p id="fb41" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">本文是一个三部分系列的开始，该系列将带您了解利用机器学习和云计算资源创建端到端应用程序的不同项目。由于每个项目都很复杂，涉及到许多活动的部分，我将把每个项目分解成更小的部分，一次解决一个。今天，我们将从第一个应用程序的第一部分开始，它根据您的位置、菜肴选择、用餐时间和聚会人数为您提供用餐/餐馆建议。说到这里，让我们开始着手手头的工作吧。</p></div><div class="ab cl jj jk go jl" role="separator"><span class="jm bw bk jn jo jp"/><span class="jm bw bk jn jo jp"/><span class="jm bw bk jn jo"/></div><div class="ha hb hc hd he"><h1 id="f5a8" class="jq jr hh bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">先决条件和AWS服务</h1><p id="4ba8" class="pw-post-body-paragraph il im hh in b io ko iq ir is kp iu iv iw kq iy iz ja kr jc jd je ks jg jh ji ha bi translated">在我们开始这个项目之前，我想对完成这个项目所需的技能和资源作出免责声明。因为我不会为项目的一些重要部分提供完整的代码，所以阅读本教程的人必须至少具备他们所选择的语言的基础到中级水平的编码专业知识。至于我，我<strong class="in hi">将使用Python </strong>的大部分项目，但是，我也将使用Javascript和HTML/CSS的前端/网页的一部分。这是我们将在这个项目中使用的先决条件和资源的列表，以简洁明了的方式列出。</p><p id="ebc7" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">编程语言:</p><ul class=""><li id="93c8" class="kt ku hh in b io ip is it iw kv ja kw je kx ji ky kz la lb bi translated">计算机编程语言</li><li id="4e46" class="kt ku hh in b io lc is ld iw le ja lf je lg ji ky kz la lb bi translated">HTML/CSS(基本)</li><li id="042c" class="kt ku hh in b io lc is ld iw le ja lf je lg ji ky kz la lb bi translated">Javascript(基本)</li><li id="150f" class="kt ku hh in b io lc is ld iw le ja lf je lg ji ky kz la lb bi translated">YAML(使用Swagger框架)</li></ul><p id="0eb5" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">AWS/云服务:</p><ul class=""><li id="ea72" class="kt ku hh in b io ip is it iw kv ja kw je kx ji ky kz la lb bi translated"><a class="ae lh" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/welcome.html" rel="noopener ugc nofollow" target="_blank"> API网关</a> (API交互)</li><li id="40b2" class="kt ku hh in b io lc is ld iw le ja lf je lg ji ky kz la lb bi translated"><a class="ae lh" href="https://aws.amazon.com/lambda/" rel="noopener ugc nofollow" target="_blank">λ</a>(函数)</li><li id="f36d" class="kt ku hh in b io lc is ld iw le ja lf je lg ji ky kz la lb bi translated"><a class="ae lh" href="https://aws.amazon.com/elasticsearch-service/" rel="noopener ugc nofollow" target="_blank">弹性搜索服务</a>(弹性搜索数据库)</li><li id="672c" class="kt ku hh in b io lc is ld iw le ja lf je lg ji ky kz la lb bi translated"><a class="ae lh" href="https://aws.amazon.com/dynamodb/" rel="noopener ugc nofollow" target="_blank"> DynamoDB </a> (NoSQL DB)</li><li id="1cb4" class="kt ku hh in b io lc is ld iw le ja lf je lg ji ky kz la lb bi translated"><a class="ae lh" href="https://aws.amazon.com/lex/" rel="noopener ugc nofollow" target="_blank">亚马逊Lex </a>(对话代理)或任何其他类似Lex的对话代理(Google DialogFlow，IBM Watson等。)</li></ul><h1 id="9f37" class="jq jr hh bd js jt li jv jw jx lj jz ka kb lk kd ke kf ll kh ki kj lm kl km kn bi translated">项目介绍</h1><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es ln"><img src="../Images/509ead29c5b9faae7da763bb5ed6de47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*eqF74s2P9XhtBDCnZDffZw.gif"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">最终聊天机器人，我们将建立(是的，这实际上是我输入到前端)</figcaption></figure><p id="ecfb" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在这个项目中，我们将实现一个无服务器、微服务驱动的web应用程序。具体来说，我们将构建一个餐饮礼宾聊天机器人，根据您通过对话提供给聊天机器人的一组偏好，向您发送餐厅建议。偏好包括诸如你的位置、你选择的菜肴、你想去餐馆的时间等细节。上面显示的是应用程序的前端，它将用于与用户进行对话，并获得<strong class="in hi"> <em class="ma">意图</em> </strong>和<strong class="in hi"> <em class="ma">插槽</em> </strong>(稍后当我们讨论<strong class="in hi"> AWS Lex </strong>时，我们将深入研究其中的每一个细节)，它将用于查询我们的数据库并返回一个餐馆推荐。我们使用Amazon Lex进行对话理解，使用Yelp API收集关于餐馆的信息，并保存在DynamoDB和/或Elasticsearch中。为了简单起见，我们将把项目分成5个部分。今天我将浏览这个项目的第1部分、第2部分和第3部分的一半，然后在下周发布后续帖子来完成其余部分。</p><ol class=""><li id="386b" class="kt ku hh in b io ip is it iw kv ja kw je kx ji mb kz la lb bi translated">前端和网站托管在<a class="ae lh" href="https://docs.aws.amazon.com/AmazonS3/latest/dev/Welcome.html" rel="noopener ugc nofollow" target="_blank"> S3 </a></li><li id="3221" class="kt ku hh in b io lc is ld iw le ja lf je lg ji mb kz la lb bi translated"><a class="ae lh" href="https://docs.aws.amazon.com/apigateway/latest/developerguide/welcome.html" rel="noopener ugc nofollow" target="_blank"> API网关</a>和<a class="ae lh" href="https://aws.amazon.com/lambda/" rel="noopener ugc nofollow" target="_blank"> AWS Lambda </a></li><li id="6da4" class="kt ku hh in b io lc is ld iw le ja lf je lg ji mb kz la lb bi translated"><a class="ae lh" href="https://aws.amazon.com/lex/" rel="noopener ugc nofollow" target="_blank">亚马逊Lex </a>(意向、插槽和定制)</li><li id="b5bc" class="kt ku hh in b io lc is ld iw le ja lf je lg ji mb kz la lb bi translated"><a class="ae lh" href="https://www.yelp.com/fusion" rel="noopener ugc nofollow" target="_blank">餐馆刮痧的Yelp API </a>和<a class="ae lh" href="https://aws.amazon.com/dynamodb/" rel="noopener ugc nofollow" target="_blank">DynamoDB</a>/<a class="ae lh" href="https://aws.amazon.com/elasticsearch-service/" rel="noopener ugc nofollow" target="_blank">elastic search</a></li><li id="e7c0" class="kt ku hh in b io lc is ld iw le ja lf je lg ji mb kz la lb bi translated"><a class="ae lh" href="https://aws.amazon.com/sqs/" rel="noopener ugc nofollow" target="_blank"> AWS SQS </a>(简单排队服务)和<a class="ae lh" href="https://aws.amazon.com/sns/?whats-new-cards.sort-by=item.additionalFields.postDateTime&amp;whats-new-cards.sort-order=desc" rel="noopener ugc nofollow" target="_blank"> AWS SNS </a>(简单通知服务)，用于分离的餐厅建议交付。</li></ol><h1 id="c160" class="jq jr hh bd js jt li jv jw jx lj jz ka kb lk kd ke kf ll kh ki kj lm kl km kn bi translated">1.S3的前端和网站托管</h1><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mc"><img src="../Images/18fe56d0a8c153af1291e1379d623114.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G0qOkekg0nndefo4UGcSBg.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">HTML，CSS，JavaScript前端的三个主要组件</figcaption></figure><h2 id="a4ed" class="md jr hh bd js me mf mg jw mh mi mj ka iw mk ml ke ja mm mn ki je mo mp km mq bi translated">开发前端代码:</h2><p id="6c15" class="pw-post-body-paragraph il im hh in b io ko iq ir is kp iu iv iw kq iy iz ja kr jc jd je ks jg jh ji ha bi translated">我们从使用HTML/CSS构建网页的前端开始。出于参考目的，这里有一段用于前端的代码(这段代码来自我们的课堂主持人/客座讲师<a class="ae lh" href="https://www.linkedin.com/in/andreipapancea/" rel="noopener ugc nofollow" target="_blank">Andrei Papancea</a>先生，不是我编写的。)</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mr"><img src="../Images/aa0dcb738d43f21ebb288d7e7b73fc62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GnnQs1H9uVOViIfmVYGEsA.png"/></div></div></figure><p id="2bf2" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">您可以自由使用您自己的前端else <a class="ae lh" href="https://github.com/Royston2708/Cloud_Computing_Course_Projects/blob/main/restaurant-chatbot-lex/chat.html" rel="noopener ugc nofollow" target="_blank">这里的</a>是指向本项目中使用的前端代码的链接<strong class="in hi">(为了使前端代码完全按照简介部分中显示的那样出现和运行，需要访问带有前端逻辑的javascript文件，但是，由于该代码是哥伦比亚大学活动类的一部分，所以没有提供这个链接</strong>。一旦我们有了想要使用的HTML页面，我们就可以开始设置我们的S3桶并托管我们的网页。</p><h2 id="e747" class="md jr hh bd js me mf mg jw mh mi mj ka iw mk ml ke ja mm mn ki je mo mp km mq bi translated">S3静态网页托管:</h2><p id="1eba" class="pw-post-body-paragraph il im hh in b io ko iq ir is kp iu iv iw kq iy iz ja kr jc jd je ks jg jh ji ha bi translated">现在我们已经准备好了我们的前端网页，我们需要托管它，以便公众可以访问它。我们可以很容易地用亚马逊的S3水桶做到这一点。什么是S3？ S3代表简单存储服务，是亚马逊的存储服务，允许我们在任何时间从网络上的任何地方存储和检索任何数量的数据。通常，当处理机器学习项目时，我们需要存储和使用大量数据，这些数据应该易于访问、存储成本低廉并且高度可伸缩/灵活。亚马逊的S3在一个名为S3的简洁而强大的解决方案中为我们提供了所有这些功能(免费层允许我们每月存储5GB免费空间，并且<a class="ae lh" href="https://aws.amazon.com/s3/pricing/" rel="noopener ugc nofollow" target="_blank">成本</a>一般非常低)。使用S3存储桶，我们可以在网络上存储大量的数据，然后可以从我们的工作环境(IDE，Jupyter Notebook等)中以编程方式<a class="ae lh" href="https://stackoverflow.com/questions/48564598/load-csv-data-into-jupyter-notebook-from-s3" rel="noopener ugc nofollow" target="_blank">访问这些数据。)使用类似</a><a class="ae lh" href="https://boto3.amazonaws.com/v1/documentation/api/latest/index.html" rel="noopener ugc nofollow" target="_blank"> boto3 </a> (Python)的工具。有关S3及其优势的更多信息，请点击<a class="ae lh" href="https://docs.aws.amazon.com/AmazonS3/latest/dev/Introduction.html" rel="noopener ugc nofollow" target="_blank">此处！</a></p><p id="27e6" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">好了，现在让我们设置我们的桶，并为主机配置它。为了创建一个桶，我们遵循一个相当简单的过程。<a class="ae lh" href="https://docs.aws.amazon.com/AmazonS3/latest/gsg/CreatingABucket.html" rel="noopener ugc nofollow" target="_blank">这里的</a>是创建一个桶的指南，下面是相同的截图。</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es ms"><img src="../Images/88743b560700bf31b3e149af3c8253b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sl1n-c02Za6dX2yr56Vo6g.png"/></div></div></figure><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mt"><img src="../Images/a3be2a7aa731372aa6175c6397b833d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BCm6uCL-dvTcQbuhqGamCA.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">创建存储桶的步骤</figcaption></figure><p id="cbcc" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在上述过程<strong class="in hi">中，我们将取消选中此框</strong>，而不是在步骤5中阻止公共访问，以确保我们可以从任何设备访问我们的网站，并将其余设置保留为默认设置。现在，我们可以点击创建桶，我们应该有一个S3桶准备在短短几秒钟内使用。(截图附后)</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mu"><img src="../Images/4be970cd386205446b673233663a77b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z8gScsZrM2jYA5HiiOZj5Q.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">确保“允许”公众访问存储桶</figcaption></figure><p id="6ec5" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">一旦我们创建了我们的桶，我们将为网站托管配置桶。为此，在<a class="ae lh" href="https://docs.aws.amazon.com/AmazonS3/latest/dev/HostingWebsiteOnS3Setup.html" rel="noopener ugc nofollow" target="_blank">跟随链接</a>处遵循步骤2至步骤6。我们基本上需要配置这个桶，使它允许公众访问这个桶。</p><p id="16c7" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">要点:</strong></p><ul class=""><li id="70f5" class="kt ku hh in b io ip is it iw kv ja kw je kx ji ky kz la lb bi translated">在<strong class="in hi">步骤4 </strong>中，当<strong class="in hi">复制-粘贴策略时，请确保将“arn:aws:s3::: </strong> <code class="du mv mw mx my b"><strong class="in hi"><em class="ma">example.com</em></strong></code> <strong class="in hi"> /*”替换为您的bucket arn，例如，在我的例子中，我的bucket称为restaurant-chatbot-demo，因此ARN将是“arn:AWS:S3:::restaurant-chatbot-demo/* ”,这可以在您的bucket的properties选项卡上找到</strong>。</li><li id="7580" class="kt ku hh in b io lc is ld iw le ja lf je lg ji ky kz la lb bi translated">在<strong class="in hi">步骤2中，我们需要指定索引文件</strong>，它将作为网站的前端代码。在我的例子中，我上传了作为前端的HTML文件，并将其重命名为index.html。</li><li id="642a" class="kt ku hh in b io lc is ld iw le ja lf je lg ji ky kz la lb bi translated">在我的例子中，我还将上传<strong class="in hi"> assets文件夹</strong>，其中包含我的前端运行所需的javascript文件。(如前所述，对资产文件夹的访问尚未公开，因为代码不归我所有。)</li></ul><p id="2bac" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">完成上述所有步骤后，我们现在有了一个S3桶，它将在一个特定的URL上托管index.html页面，这个URL可以被公众访问。下面附上我桶里的内容截图。</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es mz"><img src="../Images/5dbfdcc98117da40cf60fdbf6a00778c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LZN44J4Z3FHmU0THAdoxyQ.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">我的前端存储桶中对象的屏幕截图</figcaption></figure><h1 id="b4dc" class="jq jr hh bd js jt li jv jw jx lj jz ka kb lk kd ke kf ll kh ki kj lm kl km kn bi translated">2.API网关和AWS Lambda</h1><h2 id="2489" class="md jr hh bd js me mf mg jw mh mi mj ka iw mk ml ke ja mm mn ki je mo mp km mq bi translated">API网关</h2><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es na"><img src="../Images/0b0cfe3825b5a34de8fa6be982e75697.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*mh2-GGgoZ-ng_ZOrUmmmXA.gif"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">GIF由<a class="ae lh" rel="noopener" href="/@JanisGraubins"> JanisGraubins </a>在<a class="ae lh" rel="noopener" href="/@JanisGraubins/open-banking-api-explained-in-3-gifs-b806f14ca2ca">介质</a>上生成</figcaption></figure><p id="0a3b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在本节中，我们将讨论AWS API Gatewate和AWS lambda。API是现代应用和服务中极其重要的部分。API充当看门人的角色，将外部世界与我们所有的应用程序、服务和业务逻辑连接起来，并处理用户请求和交互以显示适当的结果。就AWS而言，API Gateway是他们的API服务，使我们能够将后端逻辑连接到前端。</p><p id="c1c6" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">API网关不是特定HTTP请求的最终目的地。相反，它是发出请求的客户机和客户机使用的服务之间的中介。我们可以把API看作是连接用户和最重要的元素(即集成)的纽带。一旦您的请求通过了授权和验证，API Gateway就会将它路由到集成中。有关AWS API网关的详细信息，请参考<a class="ae lh" href="https://www.alexdebrie.com/posts/api-gateway-elements/#roadmap-the-three-basic-parts" rel="noopener ugc nofollow" target="_blank">这篇博客！</a></p><p id="ee65" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们可以从零开始或者通过导入包含API定义和文档的YAML文件来构建API网关。当我们登录到AWS API Gateway时，我们会看到以下页面。</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es nb"><img src="../Images/f9554711bd24f1229da893e915a5955a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nZQoanLKv1VlufSJ47ndFQ.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">步骤1:导入或构建REST API</figcaption></figure><p id="6eb8" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们将通过导入课程主持人提供给我们的YAML文件之后的<a class="ae lh" href="https://github.com/001000001/aics-columbia-s2018/blob/master/aics-swagger.yaml" rel="noopener ugc nofollow" target="_blank">来创建一个普通的RestAPI。</a></p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es nc"><img src="../Images/2682d306431234a6211674f7690f1e6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DpvCnz7kSP1P_XxrHCuAOw.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">步骤2:选择带有API定义的Swagger文件</figcaption></figure><p id="c031" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">完成这些步骤后，我们就完成了API基本设置。我们还需要完成几个步骤，如部署API和使用调用URL，启用CORS(跨源资源共享)和其他一些事情，以使系统有效地工作。所以让我们开始吧。</p><h2 id="9ae9" class="md jr hh bd js me mf mg jw mh mi mj ka iw mk ml ke ja mm mn ki je mo mp km mq bi translated">CORS(跨产地资源共享):</h2><p id="09f5" class="pw-post-body-paragraph il im hh in b io ko iq ir is kp iu iv iw kq iy iz ja kr jc jd je ks jg jh ji ha bi translated"><strong class="in hi">跨来源资源共享</strong> (CORS)是一种基于HTTP报头的机制，允许服务器指示除其自身以外的任何其他来源(域、方案或端口)，浏览器应该允许从这些来源加载资源。它的基本目标是允许代表您发出的请求，同时阻止一些恶意JavaScript发出的请求。这里有几个可以提出请求的例子。</p><ul class=""><li id="02ca" class="kt ku hh in b io ip is it iw kv ja kw je kx ji ky kz la lb bi translated">不同的域(例如位于example.com<strong class="in hi">的站点</strong>调用api.com<strong class="in hi">的站点</strong></li><li id="5515" class="kt ku hh in b io lc is ld iw le ja lf je lg ji ky kz la lb bi translated">不同的子域(例如位于example.com<strong class="in hi">的站点</strong>调用api.example.com<strong class="in hi">的站点</strong></li><li id="e4ff" class="kt ku hh in b io lc is ld iw le ja lf je lg ji ky kz la lb bi translated">不同的港口(例如example.com<strong class="in hi">的站点</strong>呼叫example.com:3001<strong class="in hi">)</strong></li><li id="7dbd" class="kt ku hh in b io lc is ld iw le ja lf je lg ji ky kz la lb bi translated">不同的协议(例如位于https://example.com<strong class="in hi">的站点</strong>呼叫http://example.com<strong class="in hi">)</strong></li></ul><p id="4c2f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这种机制可以防止攻击者在各种网站上植入脚本(例如在通过谷歌广告显示的广告中),向www.yourbank.com T21发出Ajax调用，以防你使用自己的凭证登录进行交易。因此，CORS是维护安全的重要组成部分，它只提供对网络上所需实体的访问。<a class="ae lh" rel="noopener" href="/@baphemot/understanding-cors-18ad6b478e2b#:~:text=An%20common%20example%20of%20%E2%80%9Cnon,make%20will%20not%20be%20sent.">点击这里</a>！通过另一篇伟大的媒体文章来了解CORS。</p><p id="48c0" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在我们的例子中，我们需要为我们的API启用CORS，以允许用户访问我们的S3桶，并允许通过AWS lambda函数实现我们的业务逻辑。在启用CORS之前，我们希望API的POST方法由AWS lambda函数来完成。为了做到这一点，我们选择Lambda函数作为集成类型。然后，我们可以在下面屏幕截图的Lambda function字段中选择require AWS Lambda function。然后，我们单击“保存”,进入CORS设置。</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es nd"><img src="../Images/247d580b09abe8faeda5a7e4e1056fab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3eINslF9taPeOoycNcc2tw.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">步骤API的Lambda集成</figcaption></figure><p id="bbef" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">为了启用CORS，我们遵循以下步骤。</p><ol class=""><li id="48aa" class="kt ku hh in b io ip is it iw kv ja kw je kx ji mb kz la lb bi translated">选择发布方法，然后单击上图中可见的操作下拉菜单</li><li id="e3e9" class="kt ku hh in b io lc is ld iw le ja lf je lg ji mb kz la lb bi translated">单击启用CORS</li><li id="8c30" class="kt ku hh in b io lc is ld iw le ja lf je lg ji mb kz la lb bi translated">选择POST和OPTIONS方法，同时确保选中默认4XX和5XX</li><li id="b39e" class="kt ku hh in b io lc is ld iw le ja lf je lg ji mb kz la lb bi translated">对于选项方法，我们可能会得到一些错误，如下所示。</li></ol><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es nd"><img src="../Images/ea3e2141c50580dbbbc0a0bfa24584ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mb3lbn5HbIdoev3BJF4REw.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">步骤4:启用CORS并收到响应</figcaption></figure><p id="d64b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">为了解决这个问题，我们需要点击聊天机器人下的选项。然后单击method response并添加200作为标题，如下所示。</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es nd"><img src="../Images/7834340d000b6e18d46f87c738ad189c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bMcC3jtSSfVeFYEsk92Txg.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">步骤5.1:单击选项方法并添加方法响应</figcaption></figure><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es nd"><img src="../Images/e47622a0b49a278346315aaf32d47ad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h1K8uImhmvFlznFUdbUxIQ.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">步骤5.2:添加CORS所需的HTTP 200响应和报头</figcaption></figure><p id="412f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">完成这些步骤后，我们就完成了API的配置，现在可以继续进行部署了。为了<strong class="in hi">部署API </strong>,再次点击actions下拉菜单并选择Deploy API。我们为名为test/dev的部署选择一个新的阶段，并部署API来<strong class="in hi">检索我们的调用URL。</strong></p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es ne"><img src="../Images/ac80d9d79f6b5dc285b081a8f46441e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RJB_-St6QoZGn3HRDwbZ0A.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">步骤6:部署API</figcaption></figure><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es ne"><img src="../Images/f9b116125715813dac7072bb85be68a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z0sqcFKaIckzcID57LNgHA.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">步骤7:使用调用URL与前端集成。</figcaption></figure><p id="aa6f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">一旦我们使用上面的步骤部署了API，我们现在就有了调用URL，我们可以使用它来集成我们的前端和API。在我的例子中，这个URL被用作javascript文件的一部分，该文件将POST请求链接到我的S3桶中的前端HTML。在我的javascript文件中使用了这个URL后，我将文件重新上传到我的<strong class="in hi">餐馆-聊天机器人-演示S3桶</strong>中。至此，我们已经完成了涉及API网关集成的教程的第2部分。</p><h1 id="b0df" class="jq jr hh bd js jt li jv jw jx lj jz ka kb lk kd ke kf ll kh ki kj lm kl km kn bi translated">3.亚马逊Lex</h1><p id="b238" class="pw-post-body-paragraph il im hh in b io ko iq ir is kp iu iv iw kq iy iz ja kr jc jd je ks jg jh ji ha bi translated">今天的最后一个话题是亚马逊Lex的介绍。我们将在下一篇文章中深入探讨设置的细节，但是这一部分将试图让你更好地理解Lex能做什么或不能做什么。</p><p id="e1af" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">Lex是亚马逊的对话/聊天机器人服务，使我们能够轻松快速地为我们的应用程序构建对话界面。简而言之，它使我们能够构建一个语音或文本控制的聊天机器人，它可以作为任何应用程序的一部分或作为一个独立的服务本身进行部署。人们可以使用Lex来回答客户服务问题、订购比萨饼、询问订单和其他物流的细节以及许多其他用例。</p><p id="3dbf" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">lex的基本构件</p><h2 id="7cb8" class="md jr hh bd js me mf mg jw mh mi mj ka iw mk ml ke ja mm mn ki je mo mp km mq bi translated">A.意图:</h2><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es nf"><img src="../Images/c1cc288e4ede5e86b6f100b59b6441a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CbTXuZ0_IzMPi8dUyxGQEg.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">创建意图</figcaption></figure><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es ng"><img src="../Images/b9bcae17dfd98015a63288a3df1729cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bf9Yv7kxeFx_G0PhivIjTA.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">可以传递给意图的参数(示例话语、时段、履行)</figcaption></figure><p id="ba48" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">意图表示用户想要执行的动作。您创建一个bot来支持一个或多个相关的意图。例如，您可以创建一个订购披萨和饮料的机器人。聊天机器人需要能够不同地处理每种情况。当这个人说他们想点一份比萨饼时，我们需要开始显示比萨饼菜单，包括酱料、配料等选项。当这个人想要点饮料时，我们的聊天机器人需要理解他的意图并做出相应的调整，显示菜单上各种各样的模仿品和鸡尾酒。因此，意图描述了用户/客户希望做什么。对于每个意向，您需要提供以下必需信息:</p><ul class=""><li id="65e3" class="kt ku hh in b io ip is it iw kv ja kw je kx ji ky kz la lb bi translated"><strong class="in hi">意图名称</strong>–意图的描述性名称。比如<strong class="in hi"> <em class="ma"> OrderPizza </em> </strong>或者<strong class="in hi"> <em class="ma"> OrderDrinks </em> </strong>。意向名称在您的帐户中必须是唯一的。</li><li id="e1e9" class="kt ku hh in b io lc is ld iw le ja lf je lg ji ky kz la lb bi translated"><strong class="in hi">示例话语</strong> —用户可能如何传达意图。例如，用户可能会说“我可以点一份比萨饼吗？”或者“我想订个披萨”。类似的示例话语和句子有助于聊天机器人理解用户的意图。因此，当客户说“我想订一个比萨饼”时，Lex需要理解我们现在需要从数据库中检索比萨饼菜单，并在前端显示它。因此，样本话语是一种告诉Lex为了执行与特定意图相关的代码/逻辑，应该注意哪些句子的方式。这有点像“Alexa”或“嘿谷歌”告诉我们的语音助手开始听我们希望他们为我们做什么。</li><li id="635f" class="kt ku hh in b io lc is ld iw le ja lf je lg ji ky kz la lb bi translated"><strong class="in hi">如何实现意图</strong> —在这一部分中，我们需要指定在用户提供必要的信息后，您希望如何实现意图(例如，一旦客户选择了她/他想要的比萨饼，我们需要我们的应用程序将订单细节发送到比萨饼店，因此我们需要添加一个可以完成循环的实现功能)。建议创建一个Lambda函数来实现这个目的。</li></ul><h2 id="825b" class="md jr hh bd js me mf mg jw mh mi mj ka iw mk ml ke ja mm mn ki je mo mp km mq bi translated">B.插槽:</h2><p id="0ebd" class="pw-post-body-paragraph il im hh in b io ko iq ir is kp iu iv iw kq iy iz ja kr jc jd je ks jg jh ji ha bi translated">插槽可以比作函数中的参数。它们基本上是用户在与聊天机器人的交互中可能指定也可能不指定的变量。一个意向可能需要零个或多个槽，或者为了满足业务逻辑。</p><p id="c9b8" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">例如，为了创建一个比萨饼，您需要有一个底部/外壳，因此在<strong class="in hi"> <em class="ma"> OrderPizza </em> </strong>意图中的一个槽将是<strong class="in hi">外壳</strong>。添加插槽作为意图配置的一部分。在运行时，Amazon Lex提示用户输入这些特定的槽值，并检索相应的条目。用户必须提供所有<strong class="in hi"> <em class="ma">所需槽位</em> </strong>的值，亚马逊Lex才能满足意图。</p><p id="7981" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">对于每个插槽，还必须提供插槽类型和提示，以便Amazon Lex发送给客户端，从用户那里获取数据。槽类型告诉聊天机器人预期的响应类型，应该是数字、字母数字、纯文本、特定的时间格式，如DD-MM-YYYY等。</p><p id="c57f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">使用我们上面的例子，<strong class="in hi">外壳</strong>插槽将具有“字母数字”插槽类型，并且可以如下工作。提示会是<em class="ma">“你想要什么样的面包皮？”</em>并且提供的选项有<em class="ma">“全麦”、“普通薄”或“普通厚”</em>。用户可以回复一个包括额外单词的槽值，如“全麦请”或“让我们坚持常规瘦”，Amazon Lex仍将理解预期的槽值。</p><p id="6497" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">因此，使用插槽和意图可以完成几乎任何所需的逻辑。Amazon Lex还提供了内置的插槽类型。例如，<code class="du mv mw mx my b"><strong class="in hi">AMAZON.NUMBER</strong></code>是一个内置的插槽类型，您可以使用它来表示订购的比萨饼的数量。同样<code class="du mv mw mx my b"><strong class="in hi">AMAZON.CITY</strong></code>是美国的城市。有关Lex如何工作以及如何更好地使用它的更多信息，请点击<a class="ae lh" href="https://docs.aws.amazon.com/lex/latest/dg/how-it-works.html" rel="noopener ugc nofollow" target="_blank">此链接！</a></p><p id="86fc" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">下面附上几张我们用于聊天机器人的设置截图，以及每个意图的位置和话语。我们有一个用餐意图和一个问候意图，问候用于确定用户何时只是问候我们，用餐意图用于告诉聊天机器人何时应该开始从我们的客户那里获得所需的信息，以提出所需的餐厅建议。</p><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es nh"><img src="../Images/4ed2b0f667b11c6381522620b2aefb0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Oh-oyRrqSbs4aXx0zNAcGQ.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">问候意图和相同的示例话语(可以看出，我们没有用于此意图的任何槽)</figcaption></figure><figure class="lo lp lq lr fd ii er es paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="er es nh"><img src="../Images/9ec8bd7ff85220b657d39b0577dfa1ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_sX3uwKKTHP0ZGEeEWaxOw.png"/></div></div><figcaption class="lw lx et er es ly lz bd b be z dx translated">用餐意图以及实现意图所需的示例话语和时段</figcaption></figure><h1 id="a8e1" class="jq jr hh bd js jt li jv jw jx lj jz ka kb lk kd ke kf ll kh ki kj lm kl km kn bi translated">4.结论和对第二部分的补充</h1><p id="d3c8" class="pw-post-body-paragraph il im hh in b io ko iq ir is kp iu iv iw kq iy iz ja kr jc jd je ks jg jh ji ha bi translated">有了上面的截图，我们现在已经到了这个项目的第一部分的结尾。我们已经成功地构建了我们的前端，并将其连接到API网关。我们还了解了亚马逊S3桶、API网关和亚马逊Lex的功能，以及它们在我们的餐厅chatbot中的使用。</p><p id="e789" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">下一次，我们将深入研究建立聊天机器人的一步一步的过程，以及一些我们可以用来实现目的的lambda函数的细节。我们还将学习DynamoDB、ElasticSearch和YelpAPI，我们可以使用这些工具通过所需的参数从yelp的数据库中获取餐馆信息。最后，我们还将了解AWS简单排队服务(SQS)和AWS简单通知服务(SNS ),一旦我们获得了顾客的所有偏好，这将使我们能够将餐厅建议直接发送到顾客的手机上。</p><blockquote class="ni nj nk"><p id="3cb6" class="il im ma in b io ip iq ir is it iu iv nl ix iy iz nm jb jc jd nn jf jg jh ji ha bi translated">如果你已经读到这里，我希望你在阅读这篇文章的时候过得愉快。虽然它有点长，但我希望它相对简单，并帮助您迈出进入大数据、云计算和无服务器应用程序世界的第一步。如果你喜欢这篇文章，请关注我，关注未来的文章。我将在下周发布这篇文章的第二部分！一如既往，我会喜欢任何关于帖子的反馈，并将尽我所能尽快纳入要求的更改。</p><p id="ac0d" class="il im ma in b io ip iq ir is it iu iv nl ix iy iz nm jb jc jd nn jf jg jh ji ha bi translated">如果你想关注我，你可以在<a class="ae lh" href="https://www.linkedin.com/in/roystonsoares/" rel="noopener ugc nofollow" target="_blank"> <strong class="in hi"> Linkedin </strong> </a>上找到我。</p></blockquote></div></div>    
</body>
</html>