<html>
<head>
<title>Building Machine Learning model to predict if the patient will be readmitted within 30 days</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">建立机器学习模型来预测患者是否会在30天内再次入院</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/building-machine-learning-model-to-predict-if-the-patient-will-be-readmitted-within-30-days-2eaed2d3669d?source=collection_archive---------10-----------------------#2021-02-23">https://medium.com/analytics-vidhya/building-machine-learning-model-to-predict-if-the-patient-will-be-readmitted-within-30-days-2eaed2d3669d?source=collection_archive---------10-----------------------#2021-02-23</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7ada" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在美国，大约10%的病人在出院后30天内再次入院。如果我们事先知道自己是否会成为那10%中的一员，那该有多好？；)</p><p id="7c57" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇博客中，我解释了我建立的机器学习模型，以预测完全相同的情况，即给定患者的病史，患者是否需要再次入院。</p><p id="0654" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">目录:</strong></p><ol class=""><li id="9a91" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><strong class="ih hj">机器学习问题公式化</strong></li></ol><p id="23da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jm"> — </em> 1.1简介<br/> — 1.2业务问题<br/> — 1.3业务约束<br/> — 1.4数据集分析<br/> — 1.5绩效指标</p><p id="976c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。数据清理和预处理</strong></p><p id="0bb0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">— 2.1数据清理<br/> — 2.2数据预处理</p><p id="549b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。探索性数据分析</strong></p><p id="27a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jm">—</em>3.1 A1C试验结果的单变量分析<br/> — 3.2实验室程序数量的单变量分析<br/> — 3.3程序数量的单变量分析<br/> — 3.4住院史数量的单变量分析<br/> — 3.5处方药物数量的单变量分析<br/> — 3.6年龄的单变量分析<br/> — 3.7性别的单变量分析<br/> — 3.8年龄和住院时间的双变量分析【3.8 性别和诊断数量<br/> — 3.10种族和诊断数量的双变量分析<br/> — 3.11年龄和性别的双变量分析</p><p id="eb83" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 4。特征工程</strong></p><p id="e48c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">— 4.1检查数据不平衡<br/> — 4.2正向特征选择<br/> — 4.3实施SMOTE进行过采样以补偿数据不平衡</p><p id="49e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 5。实现ML算法并查找和比较它们的性能</strong> <br/> — 5.1实现Boosting算法<br/> — 5.2创建定制集成模型<br/> — 5.3比较所有ML模型</p><p id="7926" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 6。最终模型培训和保存相同的</strong> <br/> — 6.1模型部署<br/> — 6.2进一步改进的范围<br/> — 6.3参考资料</p><h1 id="869c" class="jn jo hi bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated"><strong class="ak"> 1。机器学习问题公式化</strong></h1><h2 id="43a8" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated"><strong class="ak"> 1.1简介:</strong></h2><p id="adce" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">利用从1999年到2008年的10年间从美国130家医院收集的数据，我试图建立一个预测性ML模型，该模型将预测患者再次入院的可能性。为了做出这一预测，我考虑了住院人数、诊断人数、急诊人数以及患者病史的类似属性等因素。除此之外，我还考虑了进行的医疗检查、检查结果和开出的药物。利用这些数据，我能够建立一个ML模型来预测患者是否会在出院后30天内再次入院。</p><h2 id="f0f9" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated"><strong class="ak"> 1.2业务问题:</strong></h2><p id="622a" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">作为医疗保险和医疗补助服务中心(CMD)-减少医院再入院计划(HRRP)的一部分，考虑到医院再入院率，医院为患者提供的医疗护理可获得报销。也就是说，再入院率高于预期(平均水平)的医院会受到惩罚，减少给予它们的财政补偿。</p><p id="f0ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">但是，对于这种受到处罚的医院来说，保持患者的低再入院率是一个挑战，因为没有办法确定哪个患者将被再入院或其他。因此，那些在HRRP下受到处罚的医院需要一种预测模型来帮助他们确定哪个患者可能会再次入院，从而相应地，他们可以提供额外的保健设施和修改的处方来防止患者再次入院，从而保持较低的再次入院率。在本案例研究中，我们将使用数据科学创建一个模型来做同样的事情，即预测患者再次入院的可能性。</p><h2 id="69b7" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated"><strong class="ak"> 1.3业务约束:</strong></h2><ol class=""><li id="6b97" class="jd je hi ih b ii kz im la iq le iu lf iy lg jc ji jj jk jl bi translated"><strong class="ih hj">可解释性:</strong>由于业务问题来自医疗领域，因此对错误的容忍度几乎为零，因此在某些情况下，建立的模型可能需要人工干预或手动审查。</li><li id="4b22" class="jd je hi ih b ii lh im li iq lj iu lk iy ll jc ji jj jk jl bi translated"><strong class="ih hj">需要类别概率:</strong>类别概率将使我们能够确定模型能够在多大程度上区分需要再次入院的患者和其他患者。</li><li id="4324" class="jd je hi ih b ii lh im li iq lj iu lk iy ll jc ji jj jk jl bi translated"><strong class="ih hj">无延迟需求:</strong>由于模型将离线运行，并将有充足的时间来执行和提供结果，因此不需要极低的延迟。</li></ol><p id="2cc2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">目的:</strong>确定患者在确诊后的前30天内再次入院的概率，以便医生能够额外照顾患者，防止再次入院。</p><h2 id="dbc3" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated"><strong class="ak"> 1.4数据集分析:</strong></h2><p id="6a80" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">数据收集者:弗吉尼亚联邦大学临床和转化研究中心</p><p id="e526" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">描述:</strong></p><p id="1e0c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jm">来源:</em>此数据集可用<a class="ae lm" href="https://archive.ics.uci.edu/ml/datasets/diabetes+130-us+hospitals+for+years+1999-2008" rel="noopener ugc nofollow" target="_blank"> <em class="jm">此处</em> </a>。</p><p id="9229" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该数据集代表了130家美国医院和综合交付网络10年(1999-2008)的临床护理。它包括50多个代表患者和医院结果的特征。从数据库中提取满足以下条件的信息。</p><p id="b239" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(1)是住院患者遭遇(住院)。</p><p id="17f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(2)它是糖尿病患者，也就是说，在此期间，任何种类的糖尿病作为诊断被输入到系统中。</p><p id="9a1a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(3)停留时间至少为1天，最多为14天。</p><p id="0493" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(4)在遭遇期间进行了实验室测试。</p><p id="8773" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(5)在遭遇期间给予药物治疗。</p><p id="7f3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该数据包含诸如患者编号、种族、性别、年龄、入院类型、住院时间、入院医生的医学专业、执行的实验室测试次数、HbA1c测试结果、诊断、药物治疗次数、糖尿病药物治疗、住院前一年的门诊、住院和急诊次数等属性。</p><h2 id="fb37" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated"><strong class="ak">特征信息:</strong></h2><p id="0523" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated"><strong class="ih hj">遭遇ID: </strong>遭遇的唯一标识符</p><p id="472a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">患者编号:</strong>患者的唯一标识符</p><p id="091e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">种族值:</strong>白种人、亚洲人、非裔美国人、西班牙人和其他</p><p id="8e52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">性别值:</strong>男性、女性、未知/无效</p><p id="85bd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">年龄:以10年为间隔分组:</strong> [0，10]，[10，20]，…，[90，100)</p><p id="cf8b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">重量:</strong>以磅为单位的重量，以25磅为间隔分组[0–25]，[25–50)，…，&gt; 200</p><p id="9ef3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">入院类型:</strong>对应于8个不同值的整数标识符，例如，急诊、紧急、择期、新生儿和不可用</p><p id="4242" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">出院处置:</strong>对应26个不同值的整数标识，例如出院回家、过期、不可用</p><p id="43b0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">入院来源:</strong>对应于17个不同值的整数标识符，例如，医生转诊、急诊室和转院</p><p id="40d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">住院时间:</strong>从入院到出院的整数天，范围为[1–14]</p><p id="b63a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">付款人代码:</strong>对应18个不同值的整数标识符，例如，蓝十字/蓝盾、医疗保险和自费医疗保险</p><p id="6cb0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">医学专业:</strong>入院医生专业的整数标识符，对应73个不同的值，例如，心脏病学、内科、家庭/全科和外科医生</p><p id="5658" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">实验室程序的数量:</strong>遭遇期间进行的实验室测试的数量</p><p id="d3e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">程序数量:</strong>在[0–6]范围内的遭遇期间执行的程序(除实验室测试之外)的数字数量</p><p id="ee11" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">药物数量:</strong>遭遇期间使用的不同通用名的数量</p><p id="1f8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">门诊人次:</strong>患者在就诊前一年的门诊人次</p><p id="3951" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">急诊次数:</strong>患者在就诊前一年的急诊次数</p><p id="458e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">住院人次:</strong>患者在就诊前一年的住院人次</p><p id="0f96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">诊断1: </strong>主要诊断(编码为ICD9的前三位)；717种不同的价值观</p><p id="8184" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">诊断二:</strong>二级诊断(编码为ICD9的前三位)；749种不同的价值观</p><p id="c964" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">诊断3: </strong>附加二级诊断(编码为ICD9的前三位)；790种不同的价值观</p><p id="8c96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">诊断数量:</strong>输入系统的诊断数量，范围为[1–16]</p><p id="114d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">葡萄糖血清测试:</strong>结果表示结果的范围或是否未进行测试。值:"&gt; 200 "、" 300 "、"正常"和"无"，如果没有测量</p><p id="bb9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> A1c测试结果:</strong>表示结果的范围或是否未进行测试。值:如果结果大于8%，则为“&gt;8”；如果结果大于7%但小于8%，则为“&gt;7”；如果结果小于7%，则为“正常”；如果未测量，则为“无”。</p><p id="960f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">药物变更:</strong>表示糖尿病药物(剂量或通用名)是否有变更。值:“Ch”和“No”</p><p id="3834" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">糖尿病药物:</strong>表示是否开有任何糖尿病药物。值:通用名称药物的“是”和“否”24个特征:</p><p id="5478" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">用药:</strong>'二甲双胍'，'瑞格列奈'，'那格列奈'，'氯丙胺'，'格列美脲'，'乙酰己胺'，'格列本脲'，'甲苯磺丁脲'，'吡格列酮'，'罗格列酮'，'阿卡波糖'，'米格列醇'，'曲格列酮'，'妥拉酰胺'，'甲明达'，'西托格列酮'，'胰岛素'，'格列本脲-二甲双胍'，'格列美脲-吡格列酮'，'二甲双胍-罗格列酮'，'二甲双胍-吡格列酮'。这些药物用一列表示，每一列的值为“上升”、“稳定”、“否”或“下降”，分别表示药物是否增加、保持不变、停止或减少。</p><p id="539c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">再次入院:</strong>住院患者再次入院的天数。值:如果患者在30天以内再次入院，则为“0”；如果患者在30天以上再次入院，则为“30”；如果没有再次入院记录，则为“否”</p><h2 id="807a" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated">1.5绩效指标:</h2><ol class=""><li id="bb15" class="jd je hi ih b ii kz im la iq le iu lf iy lg jc ji jj jk jl bi translated">主要绩效指标:<strong class="ih hj"> AUC </strong></li><li id="1fac" class="jd je hi ih b ii lh im li iq lj iu lk iy ll jc ji jj jk jl bi translated">次要绩效指标:<strong class="ih hj">混淆矩阵和召回</strong></li></ol><p id="e640" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">为什么是AUC？</strong></p><p id="2f0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于我们的模型输出概率分数，AUC帮助我们确定模型能够区分目标标签的程度，特别是当目标标签是概率值时。</p><p id="185f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">为什么回忆和混淆矩阵？</strong></p><p id="e615" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的目标是预测患者是否会再次入院。如果模型预测不会再次入院的患者会再次入院，也就是说，如果假阳性率很高，也是可以的。然而，FN率必须很低，这是因为，将再次入院的患者不应被忽视，因为这将最终导致医院受到处罚。我们的目标是防止医院受到处罚。召回指标正确地总结了我们的目标，因为它基于真阳性和假阴性。因此，高召回率是意料之中的。另一方面，混淆矩阵帮助我们检查高FN率和FP率之间的权衡。</p><h1 id="553b" class="jn jo hi bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">2.数据清理和预处理</h1><h2 id="c228" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated"><strong class="ak"> 2.1数据清理:</strong></h2><p id="e867" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">在使用数据之前，有必要清理数据以去除冗余数据。功能“就诊id”和“患者id”分别对应于医疗就诊id和患者id的id。同一个患者可能已经多次访问医院，因此，每次遇到的id都是唯一的，但是患者id可以出现多次。无论如何，我们将删除这两列，因为它们仅仅是个人信息的标识符，没有其他用途。但是，在此之前，我们将检查patient_id以相同的重新入院状态重复出现的行，我们将删除这样的行。因为这些行在大多数方面是相同的，因此是多余的。</p><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es ln"><img src="../Images/9e9a88f1365589615f52b9a4b8a65474.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*j9VA3wHE0tzFyzQYZDtJMw.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">使用encounter _ id和patient_nbr检查冗余行</figcaption></figure><p id="0aa5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">列“examide”、“格列美脲-吡格列酮”和“citogliption”只有一个唯一值，这意味着这些列中的所有值都相同，且方差为0，因此对发现数据中任何有意义的模式没有任何作用。所以我们会放弃他们。在类似的行中，列“二甲双胍-罗格列酮”、“二甲双胍-吡格列酮”和“乙酰己胺”各有2个值，但少数值只有1或2行，这不足以让ML模型找到任何有用的模式。因此，这些列也将被删除。</p><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es lz"><img src="../Images/52fb7ba7f7287c3f05722d8c11b62e5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*gy0mjbqftmAB03Z79JPu-w.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">检查要素的值计数</figcaption></figure><p id="3a13" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">出院处置ids、19、20、21表示患者已经过期，不用说，这些患者将永远不会再次入院，因此最好从数据集中删除。</p><p id="361f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">性别特征有3个值，即男性、女性和未知/无效，第三个值只有3行，因此我们将删除性别未知或无效的这3行。</p><p id="262e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">特征‘出院_处置_标识’、‘入院_来源_标识’和‘入院_类型_标识’有几个不同的值，它们实际上代表‘不可用’、‘空’或‘无效’数据，所以我们将它们组合在一起。</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="ma mb l"/></div></figure><h2 id="e4e5" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated"><strong class="ak"> 2.2数据预处理:</strong></h2><p id="963b" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">特征年龄表示为分类特征值，每个桶的大小为10。这些可以更好地用每个组的年龄中值来表示。</p><figure class="lo lp lq lr fd ls er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es mc"><img src="../Images/fcd64f46ddb393ad532576c28f79ac66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UApnOSEr7PeiiEqLZm8j6g.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">年龄分布——以10个为一组，表示为分类特征</figcaption></figure><p id="7aa9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">目标特征“再次入院”有3个值，即30天后、30天前再次入院的患者和根本没有再次入院的患者。因为我们的目标是确定患者是否在30天内再次入院，所以让我们将其转换为具有2个值的二元特征，即在30天之前是否再次入院。</p><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es mh"><img src="../Images/f4ed77eb341f138336075a7b466fe170.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*ZCDOcyfQQq9myaTZ_slAkg.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">目标变量“重新接纳”的值计数条形图</figcaption></figure><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="ma mb l"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">数据预处理阶段的代码实现</figcaption></figure><h1 id="6db3" class="jn jo hi bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">3.探索性数据分析</h1><h2 id="ce3d" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated">3.1试验结果的单变量分析:</h2><p id="bdc5" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">一篇关于A1C试验的研究论文发表在《<a class="ae lm" href="https://www.hindawi.com/journals/bmri/2014/781670/" rel="noopener ugc nofollow" target="_blank">》上，结论是接受A1C试验结果的患者不太可能再次入院。让我们检查相同的。</a></p><div class="lo lp lq lr fd ab cb"><figure class="mi ls mj mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/f8152f3560a58a79e74f9cf5ad5c85c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*PAyxNETQQVz_Y0kqG3NmGA.png"/></div></figure><figure class="mi ls mj mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/510b7ee307720f602cc6d7a5a5899407.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*4BqfZqw61twqsfKAh1jp_A.png"/></div></figure><figure class="mi ls mo mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/1ff7f1fc7b7ea11ae7ddff33399f2d3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*PhUuO9xl4DvoeB71o77_8w.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx mp di mq mr translated">分析A1C试验结果分布及其与目标变量“再入院”的关系</figcaption></figure></div><p id="92a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">查询:</strong> <em class="jm">接受A1C试验的患者更不容易再次入院，这是真的吗？</em></p><p id="4b05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上图可以看出，进行了检测的患者和未进行检测的患者的分布几乎相同。因此，我们不能断定进行A1C试验意味着更少的再入院机会。</p><h2 id="210b" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated">3.2实验室程序数量的单变量分析</h2><div class="lo lp lq lr fd ab cb"><figure class="mi ls ms mk ml mm mn paragraph-image"><img src="../Images/28283d5d97207564a0669cb9d2026321.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*tq7bDA4fqAr71GkkSRYDBQ.png"/></figure><figure class="mi ls mt mk ml mm mn paragraph-image"><img src="../Images/adfef7a183c51dab9b853e18b2133356.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*npFl3wGV5jQznvF95_Ve_A.png"/><figcaption class="lv lw et er es lx ly bd b be z dx mu di mv mr translated">实验室程序数量的单变量分析</figcaption></figure></div><p id="e5c9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">查询:</strong> <em class="jm">平均来说，一名患者要经历多少次实验室检查？</em></p><p id="de37" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面的pdf曲线可以看出，大多数患者进行了40到70次实验室检查，平均为43次，中位数为44次。对于number_lab_procedures，再次入院和未再次入院患者的图表遵循类似的正态分布。</p><h2 id="afa9" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated">3.3程序数量的单变量分析</h2><div class="lo lp lq lr fd ab cb"><figure class="mi ls mw mk ml mm mn paragraph-image"><img src="../Images/3a4193b588328f35fe50b98031321c7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*Hbb6XeGmCZ0-LLM9WEsLzg.png"/></figure><figure class="mi ls mx mk ml mm mn paragraph-image"><img src="../Images/e480ad6f45fca1423e08bbbc7f869412.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*_7TlA8uM9iy0jn--0AnXLA.png"/></figure></div><p id="91a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">询问:</strong> <em class="jm">手术数量多是否预示着更容易再次入院？</em></p><p id="880d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种关系并不存在，因为几乎一半再次入院的患者都经历了许多医疗程序。那些没有被重新接纳的人也是如此。</p><h2 id="a69d" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated">3.4住院病历数量的单变量分析</h2><div class="lo lp lq lr fd ab cb"><figure class="mi ls my mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><img src="../Images/7420c69d107cbcae097ab822eaab336c.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*3n8KgVDAYghAfKDJiG5Mmg.png"/></div></figure><figure class="mi ls mz mk ml mm mn paragraph-image"><img src="../Images/73cb82c5b1257b50ecbcf2f34e7ecc2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*1WqRrbaVtqqBLQ2ttZKg6g.png"/><figcaption class="lv lw et er es lx ly bd b be z dx na di nb mr translated">住院人次的单变量分析</figcaption></figure></div><p id="6314" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">查询:</strong> <em class="jm">是住院患者的就诊史(住院！= 0)更容易再次住院，因为住院频率高表示健康状况不佳？</em></p><figure class="lo lp lq lr fd ls er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es nc"><img src="../Images/a9fc3d77d8f62243434a0a9a37addd3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lTNQEfC12tKoHPIk12rHgQ.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">计算有住院史和再次入院的患者百分比</figcaption></figure><p id="f7bb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">是的，从上述图表和百分比计算中可以明显看出，15%之前入院的患者(住院患者&gt; 0)再次入院，高于无住院史患者的百分比(8%)。因此，我们可以得出结论，有住院史的患者更有可能再次入院。</p><h2 id="af6b" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated">3.5处方药物数量的单变量分析</h2><div class="lo lp lq lr fd ab cb"><figure class="mi ls nd mk ml mm mn paragraph-image"><img src="../Images/67191e3dcca64fbbe9b1785c57eb7921.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*3qhj70v11Rya7JuDfVi6BQ.png"/></figure><figure class="mi ls ne mk ml mm mn paragraph-image"><img src="../Images/5b861b70ce5890aab35d844b51be1a82.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*cTHDo9mhBzISvYdPhvbrHA.png"/></figure></div><p id="1e32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">查询:</strong> <em class="jm">药物数量多是否意味着患者再次入院的机会更大，因为药物数量多意味着健康状况不佳？</em></p><p id="3bd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如我们所见，再次入院和未再次入院患者的药物数量分布是相同的。药物的数量大多在1-30之间。这对于再次入院和未再次入院的患者都是一样的。因此，我们可以得出结论，大量的药物并不一定意味着健康状况不佳或有更多的机会再次入院。</p><h2 id="10bc" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated">3.6年龄的单变量分析</h2><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es nf"><img src="../Images/efbeafe87afd89df68a2b16838dd8a19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*LfYbiCQlMA1Y9TWWPLqJdw.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">年龄的单变量分析</figcaption></figure><p id="cbd3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">查询:</strong> <em class="jm">有没有哪个年龄段的人更容易患病，更容易被重新接纳？</em></p><p id="12d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，年龄在60-80岁之间的患者更有可能生病住院。然而，我们不能对再入院状态做出任何结论，因为再入院和其他情况下的患者分布是相同的。</p><h2 id="3841" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated">3.7性别的单变量分析</h2><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es ng"><img src="../Images/31be665fc0310a23bd15fddd9032f5c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*vqaSlDhY_4WzBBCgUydaDg.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">性别的单变量分析</figcaption></figure><p id="670a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">查询:</strong> <em class="jm">有没有哪个性别更容易被重新接纳？</em></p><p id="be49" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不，如我们所见，这里男女患者的分布几乎相同。此外，10%的男性再次入院，与女性相同，即10%的女性再次入院。</p><h2 id="4ec5" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated">3.8年龄和住院时间的双变量分析</h2><figure class="lo lp lq lr fd ls er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es nh"><img src="../Images/ab31324976b6124d0aa951e5433a3bde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VkX4H--K4Y3GQbleuDmk7Q.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">年龄和住院时间(天数)的双变量分析</figcaption></figure><p id="17da" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">查询:</strong> <em class="jm">年龄和医疗停留之间有什么有意义的规律吗？</em></p><p id="3dde" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于50-70岁年龄组(以“55”和“65”为代表)的人，我们可以清楚地看到一种模式，即住院时间越长的患者越有可能再次入院。这一点从violin图中箱线图内白点代表的停留值中可以明显看出。</p><p id="6fee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同样，55岁以上的人停留时间越长，就越有可能再次入院。</p><p id="1422" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">查询:</strong> <em class="jm">老年患者是否需要更多的关注和更长的治疗时间？</em></p><p id="88d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上图可以明显看出，35岁以下的患者入院时间几乎不到4-5天，年龄大于或等于35岁的老年患者往往需要6-7天的较长住院时间，在极少数情况下甚至需要12-13天。</p><h2 id="67c4" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated">3.9性别和诊断数量的双变量分析</h2><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es ni"><img src="../Images/ba23e42c002975a212c939d9eb326c33.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*N9Q0lZpAFk-Usl3RQS0uJw.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">性别和诊断数量的双变量分析</figcaption></figure><p id="93d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">查询:</strong> <em class="jm">性别与患者患病数量有关系吗？如果是，哪种性别更健康？</em></p><p id="468a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不。正如这里看到的，男性和女性被诊断患有几乎相同数量的疾病/障碍，没有任何特定的模式会让我们得出一种性别比另一种性别更健康的结论。然而，我们可以看到，再次入院的男性大多经历了7-9次诊断，而女性则经历了6-9次诊断。</p><p id="8a14" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">男性和女性再入院患者的诊断中值高于非再入院患者。因此，无论性别如何，有更多诊断的患者更有可能再次入院。</p><h2 id="f0b6" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated">3.10种族和诊断数量的双变量分析</h2><figure class="lo lp lq lr fd ls er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es nh"><img src="../Images/cbfdf640e0e123d975763235281d33a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ghu1Bk5EqtEbrii3YoXLEg.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">种族和诊断数量的双变量分析</figcaption></figure><p id="d435" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">查询:</strong> <em class="jm">种族和患者患病数量有关系吗？如果是，哪个种族更健康？</em></p><p id="d8cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">不。正如这里看到的，不同种族的人被诊断患有几乎相同数量的疾病/障碍，没有任何特定的模式会让我们得出一个种族比另一个种族更健康的结论。</p><h2 id="25e6" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated">3.11年龄和性别的双变量分析</h2><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es nj"><img src="../Images/ebe27c7787fc10362fb3d2d56e32b9cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*bqB9elWUTV3gyHFaDqdJIg.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">年龄和性别的双变量分析</figcaption></figure><p id="9730" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">查询:</strong> <em class="jm">从年龄的单变量分析，我们知道年纪大的人更容易被重新接纳。男女都一样吗？</em></p><p id="95e4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面的方框图可以看出，年龄大于70岁的老年女性更有可能再次入院，而男性则不是这样。因此，我们可以得出结论，老年女性需要更多的照顾，以防止她们再次入院。</p><h1 id="add8" class="jn jo hi bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated"><strong class="ak"> 4。特征工程</strong></h1><figure class="lo lp lq lr fd ls er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es nk"><img src="../Images/0c76374ebdd7b6043737399476085d2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o-aUKSR2vTSKfX_0BMJc5Q.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">数据集中缺少值</figcaption></figure><p id="ef67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">列“diag_1”、“diag_2”和“diag_3”中，缺失值的百分比小于1%,因此这些值可以很容易地使用模式插补进行插补，因为它们是分类特征。此外，我们可以观察到这些列中不同值的数量大约为700。如果行数对于不同值的每个组合来说都不够大，那么由于维数灾难，这肯定会导致低性能模型。然而，在这里，大多数值具有小于100的值计数，许多具有一位数的值计数。因此，所有计数小于100的值将被归入一个类别。</p><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es nl"><img src="../Images/c208d89c77793991b3c078b62950f273.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*MCgOsF3UzmsBQ_9MJ_kTzg.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">特征“诊断1”、“诊断2”和“诊断3”中唯一值的数量</figcaption></figure><p id="71c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于特征竞赛，总值的2%缺失。由于‘高加索人’是美国和我们数据集中最大的种族，让我们用同样的方法估算那些缺失值，让我们执行模式估算。</p><figure class="lo lp lq lr fd ls er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es mc"><img src="../Images/86951745043b39f0a6b4ac9a50c6491c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h569tAMzCTo_QLK78ZMdnw.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">患者种族分布</figcaption></figure><p id="ab73" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于功能“付款人代码”，缺少41%的数据。让我们将所有缺失值命名为“UK ”,这是“unknown”的缩写。那些丢失的值背后一定有某种模式。也许保险公司或基金提供商不愿意透露他们的细节。特征值' OT '，' MP '，' SI '和' FR '计数小于100，ML模型无法找到具有这些值有意义模式，因为它们计数太低。让我们用“MN”代替“minor”作为值。</p><figure class="lo lp lq lr fd ls er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es mc"><img src="../Images/fecaa5c7016528b6df6a7df178d88210.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bd5A_A4Oi-rcEdQwa582YA.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">付款人代码的分配</figcaption></figure><p id="c9fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于“权重”列，97%的数据缺失，因此我们无法执行模式插补或模型插补，也无法实施任何其他常规缺失值插补方法。丢失数据背后可能有某种原因。让我们尝试通过将其转换为二进制特征来捕获该值，这样缺失的值将被赋予值“0 ”,而存在该值的值将被赋予值“1”</p><p id="7541" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于“医疗专业”功能，49%的数据丢失。让我们为这些缺失值创建一个单独的类别，并将它们归入“未知”标签下。医学专业的许多分类值的计数小于100。让我们将它们的分类值改为“少数”</p><figure class="lo lp lq lr fd ls er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es nm"><img src="../Images/a5bd694f5a9357d95aa9086624af1129.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qmQXUbtGrR6I7yG16U0Trw.png"/></div></div></figure><p id="d3ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于诊断数量、住院患者就诊数量、急诊就诊数量、入院来源ID和出院来源ID等特征，存在数量非常少的异常值。对于所有这些特性，让我们将这些小的计数值分组在一起，并将其标记为另一个类别。</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="ma mb l"/></div></figure><h2 id="a389" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated">4.1检查数据不平衡</h2><p id="3f95" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">让我们检查一下数据不平衡。</p><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es nn"><img src="../Images/3b093503c970f7a107507e3f7ccc29a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*ZI3xldWCYSsJsIond3gYxg.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">目标变量“重新允许”的值计数条形图</figcaption></figure><p id="f52f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">只有1/10的患者在30天内再次入院，因此，我们的数据非常不平衡。我们将在训练测试分割后处理数据集中的不平衡，因为我们只需要对训练数据而不是测试数据执行过采样。</p><h2 id="69af" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated"><strong class="ak"> 4.2正向特征选择:</strong></h2><p id="54b4" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">大约有41列，但是，我们不确定它们是否都有用。因此，让我们执行正向特征选择，并且只选择那些实际上有助于提高模型性能的特征。</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="ma mb l"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">正向特征选择的代码</figcaption></figure><figure class="lo lp lq lr fd ls er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es no"><img src="../Images/cbcc4a4f75e083fdc440b4b377088ea8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tPj8ESVClkR-M7ZKQpBftQ.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">在验证数据上打印获得的8个最佳特征以及可能的最高AUC分数</figcaption></figure><p id="f745" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们得到了8个实际上有用的特征，它们将有助于确定目标变量。</p><h2 id="26df" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated">4.3为过采样实现SMOTE以补偿数据不平衡</h2><p id="09f4" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">正如我们所看到的，数据是高度不平衡的，对于像逻辑回归、决策树和随机森林分类器这样的模型，我们可以使用参数“class_weight”(由sklearn提供)并将其设置为“balanced”来处理数据不平衡。然而，对于朴素贝叶斯和KNN，我们没有这个参数。因此，我们将使用SMOTE技术执行过采样，以补偿数据集中的不平衡</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="ma mb l"/></div></figure><h1 id="0d00" class="jn jo hi bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated"><strong class="ak"> 5。实施ML算法并比较其性能</strong></h1><p id="b195" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">既然我们已经准备好了数据并选择了最佳特征，让我们实现满足我们业务约束的经典机器学习算法。我们将实现逻辑回归，决策树分类器，随机森林分类器，朴素贝叶斯和K-最近邻。</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="ma mb l"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">实现经典的ML模型</figcaption></figure><p id="d73d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是混淆矩阵以及训练的ML模型的AUC和回忆分数。</p><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es np"><img src="../Images/8b4d1777208ccaa062bbda0ecc7af431.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*58jw5IYYL9Y9DJ3rxEtcVg.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">逻辑回归的性能度量</figcaption></figure><p id="469c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">逻辑回归似乎表现得相当好，因为TP的数量高于其他模型，同时，FN的数量也低于其他模型。</p><div class="lo lp lq lr fd ab cb"><figure class="mi ls nq mk ml mm mn paragraph-image"><img src="../Images/aeb365b08ad6c7dc613d23581be93f25.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*tNT9IQS6lw02oy4nyilUiw.png"/></figure><figure class="mi ls nq mk ml mm mn paragraph-image"><img src="../Images/7a3293de3c68abee1ece33fdee0903c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*TPHZqSRFIXfpDGX4P_eH5Q.png"/><figcaption class="lv lw et er es lx ly bd b be z dx nr di ns mr translated">决策树(左)和K近邻(右)的性能指标</figcaption></figure></div><p id="3a94" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">决策树似乎也表现得很好。然而，KNN表现不佳。</p><div class="lo lp lq lr fd ab cb"><figure class="mi ls nq mk ml mm mn paragraph-image"><img src="../Images/6a22c003372ab369974a681bc1b02125.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*3ky3DRY54t_q9vdqWg_oQg.png"/></figure><figure class="mi ls nq mk ml mm mn paragraph-image"><img src="../Images/c7192390b4cce49442da293b37dfed16.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*-X5ZlWzkBqJK_8rcnme2ZA.png"/><figcaption class="lv lw et er es lx ly bd b be z dx nr di ns mr translated">朴素贝叶斯和随机森林分类器模型的性能度量</figcaption></figure></div><p id="b91f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">随机森林和朴素贝叶斯具有几乎相同的auc分数，但在回忆分数上有所不同，从回忆分数的角度来看，先验似乎表现得更好。</p><h2 id="19cb" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated"><strong class="ak"> 5.1实现升压算法</strong></h2><p id="0c43" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">使用boosting的算法往往比简单的ML算法执行得更好。让我们实现XGBoost分类器和AdaBoost分类器，以检查它们是否能比其他模型执行得更好。</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="ma mb l"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">XGBoost和AdaBoost分类器的代码实现</figcaption></figure><p id="2ade" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们来看看他们的表现。</p><div class="lo lp lq lr fd ab cb"><figure class="mi ls nq mk ml mm mn paragraph-image"><img src="../Images/05ec9dbfee65c3a08e4dfb931cbf63e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*Gkp0Hm7pRknvKQlWxzCGrw.png"/></figure><figure class="mi ls nq mk ml mm mn paragraph-image"><img src="../Images/f80f84c6e3ae7626dcd30fb1c010798f.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*4eW9De4D0Fajbtwrq19SMg.png"/><figcaption class="lv lw et er es lx ly bd b be z dx nr di ns mr translated">XGBoost分类器和AdaBoost分类器的性能指标</figcaption></figure></div><p id="9416" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">AdaBoost表现不佳，但XGBoost表现似乎与逻辑回归模型一样好。</p><h2 id="d812" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated"><strong class="ak"> 5.2创建定制集合模型</strong></h2><p id="3a2f" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">让我们更进一步，创建如下定制集合模型:</p><ol class=""><li id="7315" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">将数据集分为训练集和测试集。</li><li id="5fa7" class="jd je hi ih b ii lh im li iq lj iu lk iy ll jc ji jj jk jl bi translated">将训练数据集分成两个相等不相交的子集- D1和D2</li><li id="5813" class="jd je hi ih b ii lh im li iq lj iu lk iy ll jc ji jj jk jl bi translated">创建D1的k个子样本，并为每个子样本数据集构建基础模型。根据D1相应的二次抽样数据训练这些基本模型。</li><li id="f7ea" class="jd je hi ih b ii lh im li iq lj iu lk iy ll jc ji jj jk jl bi translated">将D2数据作为测试数据集，对所有基础模型进行预测。水平连接所有这些k基础模型的预测，以创建一个新的数据集，比如说元数据集。使用D2的标签作为其目标变量。</li><li id="603a" class="jd je hi ih b ii lh im li iq lj iu lk iy ll jc ji jj jk jl bi translated">在此元数据集上训练元模型</li><li id="6c81" class="jd je hi ih b ii lh im li iq lj iu lk iy ll jc ji jj jk jl bi translated">通过将测试数据集提供给基础模型，然后堆叠基础模型的预测以创建将作为元模型输入的元数据集，来检查此元模型在测试数据集上的性能。</li><li id="34e5" class="jd je hi ih b ii lh im li iq lj iu lk iy ll jc ji jj jk jl bi translated">这种基础模型和元模型的组合就是我们的定制集合模型。</li></ol><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="ma mb l"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">实现自定义集成模型</figcaption></figure><p id="82ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是定制合奏模型的分数。</p><figure class="lo lp lq lr fd ls er es paragraph-image"><div class="er es np"><img src="../Images/b3c792b6dade86431ef6fcfc82330e84.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*c4hIEUxitlNkAQi8kP4M9g.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">集合模型的性能度量</figcaption></figure><p id="fb1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">定制的集合模型表现良好，但未能超过XGBoost或逻辑回归的性能。</p><h2 id="1ed9" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated">5.3比较所有ML模型</h2><figure class="lo lp lq lr fd ls er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es nt"><img src="../Images/f0789877e7203c239d8d301682f916f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lp65QG-s4CklkWzUPAAAtw.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">比较迄今为止构建的所有ML模型</figcaption></figure><p id="b561" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">XGBoost分类器和逻辑回归都表现良好，让我们选择逻辑回归，因为它的召回分数明显高于AUC在逻辑回归相同范围内的任何其他模型。</p><figure class="lo lp lq lr fd ls er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es nu"><img src="../Images/805325d69398d3d064ba6717c77efb88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jxjr7EywJgTQ0ncMz6ruHA.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">打印最佳参数以及选定的特征，以训练最终模型</figcaption></figure><h1 id="c302" class="jn jo hi bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">6.最终模型训练和保存</h1><p id="4d27" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">现在，我们已经完成了模型，即逻辑回归和最佳选择特征。让我们继续训练我们的最终模型，在测试数据集上测试它的性能，并保存它以供将来评估。</p><figure class="lo lp lq lr fd ls"><div class="bz dy l di"><div class="ma mb l"/></div></figure><p id="8e5c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由逻辑回归模型对测试数据给出的AUC分数是. 65，回忆分数是0.61。让我们继续部署模型。</p><h2 id="f24b" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated"><strong class="ak"> 6.1车型部署</strong></h2><p id="78d5" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">我已经在AWS EC2实例上部署了该模型。你可以在这里使用它。我已经使用Flask API部署了模型。目前注册在免费层下，但可以扩展到付费层进行大规模生产的层面。</p><figure class="lo lp lq lr fd ls er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es nv"><img src="../Images/420aa172d88ac988faf4ca1bb39db28c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bq-FxF4FRuuxjv7spcT8Xg.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">Web应用程序—再入院状态预测器</figcaption></figure><p id="10c1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如何使用再入院状态预测器？</p><ol class=""><li id="418e" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated">为8个下拉字段输入所有值。</li><li id="5046" class="jd je hi ih b ii lh im li iq lj iu lk iy ll jc ji jj jk jl bi translated">点击“提交”按钮。页面将在几秒钟内自动重新加载。</li><li id="c827" class="jd je hi ih b ii lh im li iq lj iu lk iy ll jc ji jj jk jl bi translated">按下“获取报告”按钮。一个弹出框将向您显示报告。</li></ol><figure class="lo lp lq lr fd ls er es paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="er es nw"><img src="../Images/52799fa2bca3cc7246456c695653ed46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kThIgUGr4WN2h029mFL5vA.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">再入院状态预测器给出的输出</figcaption></figure><h2 id="4308" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated"><strong class="ak"> 6.2进一步改进的范围:</strong></h2><p id="6c70" class="pw-post-body-paragraph if ig hi ih b ii kz ik il im la io ip iq lb is it iu lc iw ix iy ld ja jb jc hb bi translated">目前，该模型是在大约50，000个观察值的非常有限的数据上训练的。为了进一步改善模型性能，我们可以在数据收集方面投入精力，以尽量减少数据的不平衡。这肯定会导致更好的执行模型。如果我们获得了大量的数据，我们可以使用更先进的深度学习算法来进一步提高分类器的AUC分数。</p><h2 id="7c81" class="kl jo hi bd jp km kn ko jt kp kq kr jx iq ks kt kb iu ku kv kf iy kw kx kj ky bi translated"><strong class="ak"> 6.3参考文献:</strong></h2><ol class=""><li id="c8af" class="jd je hi ih b ii kz im la iq le iu lf iy lg jc ji jj jk jl bi translated"><a class="ae lm" rel="noopener" href="/@dtuk81/confusion-matrix-visualization-fc31e3f30fea">混乱矩阵可视化博客</a></li><li id="ff67" class="jd je hi ih b ii lh im li iq lj iu lk iy ll jc ji jj jk jl bi translated"><a class="ae lm" href="https://machinelearningmastery.com/smote-oversampling-for-imbalanced-classification/" rel="noopener ugc nofollow" target="_blank">使用SMOTE进行过采样</a></li><li id="c6e4" class="jd je hi ih b ii lh im li iq lj iu lk iy ll jc ji jj jk jl bi translated"><a class="ae lm" href="https://www.kaggle.com/iabhishekofficial/prediction-on-hospital-readmission" rel="noopener ugc nofollow" target="_blank"> Kaggle数据集描述</a></li><li id="2c9a" class="jd je hi ih b ii lh im li iq lj iu lk iy ll jc ji jj jk jl bi translated"><a class="ae lm" href="http://www.appliedroots.com" rel="noopener ugc nofollow" target="_blank">应用人工智能课程</a></li></ol><p id="8ea9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">完整的代码和模型实现可以在我的GitHub库中找到。你可以在这里查看<a class="ae lm" href="https://github.com/rishikeshF/Diabetic_patient_readmission_rate_predictor/blob/main/Model_construction.ipynb" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="384b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你可以在LinkedIn <a class="ae lm" href="https://www.linkedin.com/in/rishikesh-fulari-277002129/" rel="noopener ugc nofollow" target="_blank">这里和我联系。</a></p></div></div>    
</body>
</html>