<html>
<head>
<title>KNN- Implementation from scratch (96.6% Accuracy)| Python | Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">KNN-从零开始实现(96.6%的准确率)| Python |机器学习</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/knn-implementation-from-scratch-96-6-accuracy-python-machine-learning-31ba66958644?source=collection_archive---------2-----------------------#2021-04-30">https://medium.com/analytics-vidhya/knn-implementation-from-scratch-96-6-accuracy-python-machine-learning-31ba66958644?source=collection_archive---------2-----------------------#2021-04-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/8294499e329726dc6734c48a0c6b1e32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V215KxTkp-apVnqsA9yeog.png"/></div></div></figure><p id="ab3f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi jo translated">对于初学者来说，术语“<em class="jx">机器学习</em>似乎是一件非常复杂和困难的事情。毫无疑问，它是发展最快的领域之一，但这并不意味着它必须太复杂。在本教程中，我们将会看到一个非常简单，但是非常有用的算法，叫做“<strong class="is hj"><em class="jx">K-最近邻算法</em> </strong>”。</p><p id="07cc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们都听说过这句话:</p><blockquote class="jy"><p id="cd54" class="jz ka hi bd kb kc kd ke kf kg kh jn dx translated"><em class="ki">“你是由你结交的朋友定义的”</em></p></blockquote><p id="8bed" class="pw-post-body-paragraph iq ir hi is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hb bi translated">KNN从字面上理解😁。这在我们看算法的时候会更清晰。</p><p id="3fcf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">本教程中使用的全部代码可以在<a class="ae ko" href="https://github.com/Moosa-Ali/KNN-Implementation.git" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="e9db" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">更多机器学习文章，点击下方；</p><div class="kp kq ez fb kr ks"><a href="https://writersbyte.com/" rel="noopener  ugc nofollow" target="_blank"><div class="kt ab dw"><div class="ku ab kv cl cj kw"><h2 class="bd hj fi z dy kx ea eb ky ed ef hh bi translated">▤作家字节</h2><div class="kz l"><h3 class="bd b fi z dy kx ea eb ky ed ef dx translated">思想，故事和想法。</h3></div><div class="la l"><p class="bd b fp z dy kx ea eb ky ed ef dx translated">writersbyte.com</p></div></div><div class="lb l"><div class="lc l ld le lf lb lg io ks"/></div></div></a></div><h1 id="6d64" class="lh li hi bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated"><strong class="ak">理解算法:</strong></h1><p id="a4f5" class="pw-post-body-paragraph iq ir hi is b it mf iv iw ix mg iz ja jb mh jd je jf mi jh ji jj mj jl jm jn hb bi translated">KNN是一种监督算法，即它需要一个带标签的训练数据集才能工作。为了便于理解，让我们创建一个故事。下面我们可以看到，我们有3个不同的定居点(3个不同的数据点；红色、绿色、紫色)。</p><figure class="ml mm mn mo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/ccc47d5aedd37de9f83c19a009a0b298.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kbPsvR1qhiuKr-TQbrMihw.png"/></div></div><figcaption class="mp mq et er es mr ms bd b be z dx translated">精细聚类数据点的表示</figcaption></figure><p id="9290" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">OMG一个狂野的斑点出现了！！(一个测试数据点)。它看起来迷路了，我们现在该怎么办？😲</p><figure class="ml mm mn mo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/b477a8ba6f71f02b8cfe69f1ef8c81e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CVcFTGsIZ-sj_Z_CY5X0Ew.png"/></div></div><figcaption class="mp mq et er es mr ms bd b be z dx translated">野外的一个斑点</figcaption></figure><p id="3b68" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">不要害怕，因为我们知道KNN算法。</p><p id="3ca8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们只需计算每个定居点中每栋房屋与野生斑点之间的距离(数学术语中的欧几里德距离)。</p><figure class="ml mm mn mo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/59479b8459229eb82cfa58e7ff84949b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0ObiRFulLMuXQ5aj6dO7BQ.png"/></div></div></figure><p id="a62b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">！！请记住，我们需要计算每隔一个数据点的距离，插图显示的线条较少，因为插图绘制者可能有点懒🙃！！</strong></p><p id="042e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们所做的就是选择N个离我们的斑点最近的点。(<em class="jx"> N这里是一个超参数，即一个我们必须自己最佳决定的数字</em></p><figure class="ml mm mn mo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mv"><img src="../Images/715b0a282a53cc8b148ffba8cd437873.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*El2DdaYNYaBficIL7EXwxg.png"/></div></div></figure><p id="80c0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在让我们看看最近的N个点中哪个定居点存在的最多。红色定居点在我们的野生斑点附近有更多的点，因此野生斑点现在成为红色定居点的一部分(它被赋予标签；红色)。</p><figure class="ml mm mn mo fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/774018140bde61ad2b4d4de802b9b185.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TyqUebB-B9MN-XhcKmVGWA.png"/></div></div></figure><p id="9408" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们对每个测试数据点都这样做。就是这样，这就是算法。</p><p id="47fa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">好了，故事时间结束了，让我们开始编码吧。</p><p id="c650" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在继续之前，如果你觉得这篇文章有帮助，请考虑在《T21》上支持我。</p><figure class="ml mm mn mo fd ij er es paragraph-image"><a href="http://ko-fi.com/moosaali9906"><div class="er es mx"><img src="../Images/a9b75b9a2d9b6bf73b23151d0a95f04f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RAVsw7Mcvsh8aJL3LuG6bg.png"/></div></a></figure><p id="fea9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们导入必要的库。</p><figure class="ml mm mn mo fd ij"><div class="bz dy l di"><div class="my mz l"/></div></figure><div class="kp kq ez fb kr ks"><a href="https://writersbyte.com/technology/tpu-on-a-phone-the-pixel-6-by-google/" rel="noopener  ugc nofollow" target="_blank"><div class="kt ab dw"><div class="ku ab kv cl cj kw"><h2 class="bd hj fi z dy kx ea eb ky ed ef hh bi translated">手机上的TPU-谷歌的Pixel 6。- WritersByte</h2><div class="kz l"><h3 class="bd b fi z dy kx ea eb ky ed ef dx translated">当谷歌本月宣布他们的新Pixel手机Pixel 6时，看到了一个非常有趣的公告。谷歌…</h3></div><div class="la l"><p class="bd b fp z dy kx ea eb ky ed ef dx translated">writersbyte.com</p></div></div><div class="lb l"><div class="na l ld le lf lb lg io ks"/></div></div></a></div><p id="37ef" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们将在本演示中使用的数据集称为<strong class="is hj"> <em class="jx">虹膜</em> </strong>数据集。这是一个开源数据集，可以在下面的链接中找到:<a class="ae ko" href="https://www.kaggle.com/arshid/iris-flower-dataset" rel="noopener ugc nofollow" target="_blank">鸢尾花数据集| Kaggle </a></p><p id="b4b3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们来探索这个数据集。</p><p id="cb74" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们总共有4个输入特征和花卉类别的名称作为输出标签。</p><figure class="ml mm mn mo fd ij"><div class="bz dy l di"><div class="my mz l"/></div></figure><figure class="ml mm mn mo fd ij er es paragraph-image"><div class="er es nb"><img src="../Images/fc235f83eb0e94d7a865d9ee786c2b8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*rc7N8pw9Qih-BFyugqDilQ.png"/></div><figcaption class="mp mq et er es mr ms bd b be z dx translated">数据样本</figcaption></figure><p id="8cd1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将输出文本标签转换为数字表示。</p><pre class="ml mm mn mo fd nc nd ne nf aw ng bi"><span id="f401" class="nh li hi nd b fi ni nj l nk nl"><em class="jx">#Seperating the input features and output labels</em><br/>X = dataset.iloc[:, :-1].values<br/>y = dataset.iloc[:, 4].values</span><span id="ec51" class="nh li hi nd b fi nm nj l nk nl"><em class="jx">#converting text labels to numeric form</em><br/>labels, unique = pd.factorize(y)</span></pre><p id="1f9a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们编写简单的算法。</p><p id="a518" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">和往常一样，我们需要将数据分成测试样本和训练样本。</p><pre class="ml mm mn mo fd nc nd ne nf aw ng bi"><span id="656a" class="nh li hi nd b fi ni nj l nk nl"><em class="jx">#splitting data in test and train segments</em><br/><strong class="nd hj">from</strong> <strong class="nd hj">sklearn.model_selection</strong> <strong class="nd hj">import</strong> train_test_split<br/>X_train, X_test, y_train, y_test = train_test_split(X, labels, test_size = 0.40)</span></pre><p id="a977" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们对总数据使用了60-40的分割。</p><p id="aa2f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所有步骤就绪后，就该测试准确性了。</p><figure class="ml mm mn mo fd ij"><div class="bz dy l di"><div class="my mz l"/></div></figure><p id="0ab5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们在下面的代码中使用了一个助手函数。</p><pre class="ml mm mn mo fd nc nd ne nf aw ng bi"><span id="0e08" class="nh li hi nd b fi ni nj l nk nl"><em class="jx">#Creating a helper function</em> <br/><strong class="nd hj">def</strong> takeSecond(elem):     <br/>   <strong class="nd hj">return</strong> elem[1]</span></pre><p id="f940" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所有步骤就绪后，就该测试准确性了。</p><pre class="ml mm mn mo fd nc nd ne nf aw ng bi"><span id="f073" class="nh li hi nd b fi ni nj l nk nl">#getting predicted values using our algorithm<br/>predictions = list(map(KNNClassify, X_test))</span></pre><figure class="ml mm mn mo fd ij"><div class="bz dy l di"><div class="my mz l"/></div></figure><pre class="ml mm mn mo fd nc nd ne nf aw ng bi"><span id="1b29" class="nh li hi nd b fi ni nj l nk nl">#calling the accuracy function<br/>accuracy(predictions, y_test)</span></pre><figure class="ml mm mn mo fd ij er es paragraph-image"><div class="er es nn"><img src="../Images/a610f797cda51e91a63bb50f1bd15c2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*AELIvGOp8P_TJvQf4iYacA.png"/></div></figure><p id="2861" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">96.67%!！这是一个非常好的数字。</p><div class="kp kq ez fb kr ks"><a href="https://writersbyte.com/datascience/ai-for-beginners-3/" rel="noopener  ugc nofollow" target="_blank"><div class="kt ab dw"><div class="ku ab kv cl cj kw"><h2 class="bd hj fi z dy kx ea eb ky ed ef hh bi translated">面向初学者的人工智能:计算机视觉和自然语言处理</h2><div class="kz l"><h3 class="bd b fi z dy kx ea eb ky ed ef dx translated">我们已经谈了很多关于人工智能的一般意义以及它对我们世界的影响。在以前的文章中，我们…</h3></div><div class="la l"><p class="bd b fp z dy kx ea eb ky ed ef dx translated">writersbyte.com</p></div></div><div class="lb l"><div class="no l ld le lf lb lg io ks"/></div></div></a></div><h1 id="3c9e" class="lh li hi bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated"><strong class="ak">结论</strong></h1><p id="a375" class="pw-post-body-paragraph iq ir hi is b it mf iv iw ix mg iz ja jb mh jd je jf mi jh ji jj mj jl jm jn hb bi translated">这可能只是我们为机器学习算法编写的最小代码，但它的准确率高达96.67%。我们最初的说法是，最大似然算法不需要复杂，它们可以像我们刚刚在本文中学习的KNN一样简单。在多个数据集上尝试这种算法，看看它在这些数据集上的表现会很有趣。</p><p id="bfc8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">感谢您的阅读。</p><p id="bd5f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果这篇文章对你有帮助，可以考虑给我买一个。</p><figure class="ml mm mn mo fd ij er es paragraph-image"><a href="http://ko-fi.com/moosaali9906"><div class="er es mx"><img src="../Images/a9b75b9a2d9b6bf73b23151d0a95f04f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RAVsw7Mcvsh8aJL3LuG6bg.png"/></div></a></figure></div></div>    
</body>
</html>