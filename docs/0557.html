<html>
<head>
<title>Time Series Forecasting: Tools and Techniques. Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时间序列预测:工具和技术。第一部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/time-series-forecasting-tools-and-techniques-part-1-2e580e190f09?source=collection_archive---------10-----------------------#2021-01-21">https://medium.com/analytics-vidhya/time-series-forecasting-tools-and-techniques-part-1-2e580e190f09?source=collection_archive---------10-----------------------#2021-01-21</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="7a98" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇文章中，我将讨论用于时间序列预测的各种方法。首先，我将触及与时间序列数据和预测相关的基本术语。然后我将讨论用于时间序列预测的方法。接下来，我将逐一详细讨论每一种方法。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/1bf8bbd276a98440436753db3caf7c9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tfo2nzkzwlKSrdxnfS3qiw.png"/></div></div></figure><h1 id="cdc0" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><em class="kn">与时间序列数据相关的术语。</em></h1><p id="d201" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi kt translated"><span class="l ku kv kw bm kx ky kz la lb di"> T </span>时间序列:<em class="jc">时间序列数据是按时间顺序索引的一系列数据点。时间序列预测的目标是根据数据点的过去行为预测未来值。只有一个y变量的时间序列称为单变量。而具有一个以上y变量的时间序列称为多元。</em></p><p id="fed4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi kt translated"><span class="l ku kv kw bm kx ky kz la lb di"> T </span> rend: <em class="jc">系列上增加或减少的值。(全系列中整体)。当数据长期增加或减少时，趋势就存在。</em></p><p id="05d7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi kt translated"><span class="l ku kv kw bm kx ky kz la lb di">S</span>easuality:<em class="jc">系列中重复的短期循环。当时间序列受季节因素(如一年中的某个时间或一周中的某一天)影响时，就会出现季节性模式。</em></p><p id="8be5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi kt translated">误差或噪声:<em class="jc">序列中无法用趋势和季节性解释的随机变化。</em></p><p id="4c60" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如，如果你看下图，第一个图代表实际数据绘制。观测数据有三个组成部分，即趋势、季节和残差(误差)。趋势显示，在观察期间，y变量总体呈上升趋势。季节性因素表明，在每一年中，数据都有一些季节性行为，即有时达到峰值，有时下降。残差分量显示了数据中的噪声，它是趋势和季节分量中没有捕捉到的随机行为。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lc"><img src="../Images/bee8fff9ab1728a800e49a461f183ce7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*j1FMkcvctyKklE0pjop64A.png"/></div></figure><h1 id="fa1a" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">用于时间序列预测的库</h1><p id="e344" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">下面列出了用于时间序列预测的一些主要方法/库。</p><ol class=""><li id="6e0b" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">ARIMA</li><li id="f0f0" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">萨里玛(属于ARIMA家族)</li><li id="3bca" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">先知(脸书)</li><li id="8556" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">向量自回归(VAR)和VARMA</li><li id="f613" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">LSTM (RNN)</li></ol><p id="7155" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们从ARIMA开始讨论吧！</p><h1 id="2419" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">ARIMA:自回归综合移动平均数。</h1><p id="23d7" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">ARIMA有三个部分。(AR+I+MA=ARIMA)。</p><p id="6c85" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">AR(自回归):利用一个观察值和一些滞后观察值之间的依赖关系的模型。</p><p id="6206" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">I (integrated):这样做基本上是为了让数据保持不变。如果数据已经是稳定的，那么这个分量为零。</p><p id="cdf5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">MA(移动平均线):它利用观测值和应用于滞后观测值的移动平均模型的残差之间的相关性。</p><p id="72f7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里，“AR”用“p”表示，“I”用“d”表示，“MA”用“q”表示。</p><p id="257a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">注:ARIMA只能用于非季节性数据。对于季节性数据，我们使用SARIMA，我们将在后面讨论。</p><h2 id="3ae1" class="lr jq hh bd jr ls lt lu jv lv lw lx jz ip ly lz kd it ma mb kh ix mc md kl me bi translated">应用ARIMA的步骤:</h2><p id="5182" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi kt translated">整理数据:对数据有一个概念和概述。</p><p id="fd94" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi kt translated"><span class="l ku kv kw bm kx ky kz la lb di"> R </span> un an ETS分解:这样做是为了查看数据的趋势、季节性和误差部分。看季节成分对整体数据的贡献有多大。相应地，我们决定数据是否是季节性的。然而，还有其他方法来检查数据是否是季节性的，但ETS是最简单的检查方法。</p><blockquote class="mf mg mh"><p id="a1d6" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">代码:</p><p id="d26d" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">来自stats models . TSA . seasonal import seasonal _ decompose #</p><p id="2cd5" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">ets = seasonal_decompose(df['A']，model = ' additive ')<br/>ets . plot()；</p></blockquote><p id="8116" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi kt translated">使用“pmdarima”确定ARIMA (p，D，q)的顺序:pmdarima是一个库，它直接给出p，D，q的值，以便您可以使用这些值来拟合实际的ARIMA模型。</p><blockquote class="mf mg mh"><p id="64b0" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">从pmdarima导入auto_arima</p><p id="28a1" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">auto_arima(df['A']，季节性=False)。摘要()</p></blockquote><p id="2e6a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi kt translated">增强的dickey-fuller(adfuller)测试[可选]:这样做是为了检查经过多少次差分后，我们的数据变得稳定。它基本上找到了d的值。我们可以使用adfuller测试来验证在pmdarima上获得的“d”值。</p><blockquote class="mf mg mh"><p id="b34a" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">你可以访问这个<a class="ae ml" href="https://machinelearningmastery.com/time-series-data-stationary-python/" rel="noopener ugc nofollow" target="_blank">链接</a>来阅读更多关于adfuller test的内容。知道如何检查数据是否平稳以及平稳性的类型是有益的。</p></blockquote><p id="ba73" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi kt translated"><span class="l ku kv kw bm kx ky kz la lb di"> A </span> CF和PACF图[可选]: ACF图用于找出‘q’的值，PACF图用于找出‘p’的值。我们可以使用ACF和PACF图来验证从pmdarima获得的p和q值。</p><blockquote class="mf mg mh"><p id="5a44" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">代码:</p><p id="d779" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">从statsmodels.graphics.tsaplots导入plot_acf，plot_pacf</p><p id="4940" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">title = ' ACB '<br/>lags = 40<br/>plot _ ACF(df[' A ']，title=title，lags = lags)；</p><p id="bd79" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">title = ' ABC '<br/>lags = 40<br/>plot _ pacf(df[' A ']，title=title，lags = lags)；</p><p id="5fc9" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">要了解如何解读ACF和PACF的剧情，请访问<a class="ae ml" href="https://towardsdatascience.com/significance-of-acf-and-pacf-plots-in-time-series-analysis-2fa11a5d10a8" rel="noopener" target="_blank">这里</a>。我将在以后写另一篇文章，只讨论ACF和PACF的阴谋。</p></blockquote><p id="c11b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi kt translated">逐步pmdarima[可选]:它非常类似于我们过去在机器学习中使用的网格搜索。基本上，我们给它一个不同的p，d，q值的范围，给我们最好的值。这也用于交叉验证从步骤3获得的p、d、q值。</p><blockquote class="mf mg mh"><p id="94bb" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">代码:</p><p id="6bea" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">stepwise _ fit = auto _ ARIMA(df[' A ']，start_p=0，start_q=0，max_p=2，max_q=2，m=12，seasonal=False，d=None，trace=True，error_action='ignore '，<br/> suppress_warnings=True，stepwise=True)</p><p id="d58c" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">stepwise_fit.summary()</p></blockquote><p id="215c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi kt translated">将数据拆分成训练集和测试集:我们将部分可用数据剪切出来作为测试集(注意，测试集必须是按时间排序的最后几行数据。我们不能像使用Sklearn那样分割数据，因为在时间序列中，我们总是预测未来。我们不能回到过去并预测一些事情)。</p><blockquote class="mf mg mh"><p id="ff49" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">代码:</p><p id="ea77" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">train = df . iloc[:280]<br/>test = df . iloc[280:]</p></blockquote><p id="3636" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi kt translated"><span class="l ku kv kw bm kx ky kz la lb di"> F </span>将ARIMA模型投入列车测试。</p><blockquote class="mf mg mh"><p id="ccac" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">模型= ARIMA(火车['A']，订单=(p，d，q)) <br/>结果=模型.拟合()<br/>结果.总结()</p><p id="2f9e" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">这里用你在第3步中得到的值代替p，d，q。</p></blockquote><p id="3428" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi kt translated">在测试集上进行预测。</p><blockquote class="mf mg mh"><p id="ecd5" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">代码:</p><p id="d508" class="ie if jc ig b ih ii ij ik il im in io mi iq ir is mj iu iv iw mk iy iz ja jb ha bi translated">start = len(train)<br/>end = len(train)+len(test)-1<br/>predictions = results . predict(start = start，end=end，dynamic=False，typ='levels ')。重命名(“ARIMA(p，d，q)预测”)</p></blockquote><p id="a566" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi kt translated">将实际测试设定值与预测值进行比较。您可以根据需要使用一些MSE或其他指标。你也可以绘制对比图。</p><p id="06e3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi kt translated"><span class="l ku kv kw bm kx ky kz la lb di"> T </span>对整个数据下模型雨，预测未来！！！</p><p id="21e2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这一切都与ARIMA有关。如果你有任何问题，请在评论区提出。我将在接下来的部分写关于萨里玛，先知等。</p><p id="f086" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">考虑点击这篇文章的鼓掌按钮对你有所帮助...快乐学习。</em></p><h2 id="6666" class="lr jq hh bd jr ls lt lu jv lv lw lx jz ip ly lz kd it ma mb kh ix mc md kl me bi translated">参考资料:</h2><ol class=""><li id="cf6a" class="ld le hh ig b ih ko il kp ip mm it mn ix mo jb li lj lk ll bi translated"><a class="ae ml" href="https://otexts.com/fpp2/index.html" rel="noopener ugc nofollow" target="_blank">https://otexts.com/fpp2/index.html</a></li><li id="86c5" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><a class="ae ml" href="https://machinelearningmastery.com/arima-for-time-series-forecasting-with-python/#:~:text=ARIMA%20is%20an%20acronym%20that,structures%20in%20time%20series%20data" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/ARIMA-for-time-series-forecasting-with-python/#:~:text = ARIMA % 20 is % 20 an % 20缩写%20that，structures % 20 in % 20 time % 20 series % 20 data</a>。</li><li id="e640" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><a class="ae ml" href="https://www.statsmodels.org/stable/user-guide.html#time-series-analysis" rel="noopener ugc nofollow" target="_blank">https://www . stats models . org/stable/user-guide . html #时序分析</a></li><li id="44b3" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><a class="ae ml" href="https://www.udemy.com/course/python-for-time-series-data-analysis/" rel="noopener ugc nofollow" target="_blank">https://www . udemy . com/course/python-for-time-series-data-analysis/</a></li></ol></div></div>    
</body>
</html>