<html>
<head>
<title>Neural Networks — RNN’s and Music Generation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">神经网络——RNN和音乐的产生</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/neural-networks-rnns-and-music-generation-a1838dfa6472?source=collection_archive---------8-----------------------#2021-03-29">https://medium.com/analytics-vidhya/neural-networks-rnns-and-music-generation-a1838dfa6472?source=collection_archive---------8-----------------------#2021-03-29</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="f9a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">深度学习是人工智能和机器学习的子集。它专注于使用“神经网络”来自动提取原始数据中的有用模式，然后使用这些模式来学习和执行特定的任务。</p><p id="e7f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有神经网络的变体或选项之一是RNN氏症。RNN模型(递归神经网络模型)是一种大部分时间用于自然语言处理、语音识别和合成的神经网络。</p><p id="2196" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在一个普通的神经网络中，一个输入经过多层处理，产生一个输出，并假设两个连续的输入相互独立，但RNN增加了另一个参数:记忆。</p><blockquote class="jd je jf"><p id="bf34" class="if ig jg ih b ii ij ik il im in io ip jh ir is it ji iv iw ix jj iz ja jb jc hb bi translated">rnn被称为递归的，因为它们对序列的每个元素执行相同的任务，输出依赖于先前的计算。考虑rnn的另一种方式是，它们有一个“存储器”，可以捕获到目前为止已经计算过的信息。理论上，rnn可以利用任意长序列中的信息，但实际上，它们仅限于回顾几个步骤。[1]</p></blockquote><p id="a331" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">RNN检查网络在特定时间点正在做什么，以检查历史，并具有前瞻性，能够将信息传递到未来的时间点。它引入了作为单元状态“内部存储器”。这种记忆是由神经元维持的，它可以跨时间传递。然后我们有了神经元记忆和序列的递归关系。输出取决于过去的计算和学习过程(过去的记忆)。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es jk"><img src="../Images/306d5a91bc99a096440c800e798cb64f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*xoWLX8apLlpdEEWwmTNOYw.png"/></div></figure><p id="aef6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这种RNN保持这种内部状态，随着序列的处理，这种内部状态在每个时间步被更新。递归关系定义了如何在时间步长上更新状态。单元状态由一组权重、输入和先前状态来定义。RNN在处理序列的每个时间步都使用这个函数。</p><p id="49b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个项目中，我们创建了一个RNN模型，目标是创作一首音乐作品。我们训练了一个模型来学习ABC乐谱中的原始乐谱模式，然后使用这个模型来生成新的音乐。</p><p id="2359" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ABC符号是一种简写形式的音乐符号。它分为两部分:标题和注释。需要考虑的一件重要事情是，这种音乐符号不仅仅包含正在播放的音符的信息，还包含元信息，如歌曲名称、音调和速度。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es js"><img src="../Images/8785df667a3b46c792e9945437a28bba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*JlyZhcw-NvHeIIyJEbd_DA.png"/></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">ABC符号中的歌曲示例</figcaption></figure><p id="5a76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，请注意标题的每一行都以不同的字母开头，告诉您它包含的信息——第一行“X:1”只是一个参考数字(见下文),然后T:开头的一行包含曲调的<strong class="ih hj"> T </strong>标题，C:开头的一行包含<strong class="ih hj"> C </strong>作曲家(在这种情况下，这是一个传统的名称——作曲家的名字已经在时间的迷雾中消失了)。在abc-speak中，这些线有时被称为<strong class="ih hj">场</strong>——你可能会听到人们谈论“T场”或“C场”——它们只是指<strong class="ih hj">标题</strong>或<strong class="ih hj">作曲家。</strong></p><p id="0dcb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">每个音符都被写成一个单独的字母，令人惊讶的是，字母C代表音符C，D代表D，以此类推。大写字母CDEFGAB用于表示底部八度音阶(C代表中间C，在高音五线谱下方的第一个leger线上)，接着是顶部八度音阶的小写字母cdefgab (b是五线谱上方第一个leger线上的字母)。[2]</p><p id="a91d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了创建和训练RNN模型来生成新歌，我们使用Tensorflow和Keras库。使用三层来定义模型:嵌入层(输入层)、LSTM层和稠密层(输出层)</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es jx"><img src="../Images/74b2eea3dbc49fa51c0905f22bc23605.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*l6RqE096qVWkXpKM.png"/></div></div></figure><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kc"><img src="../Images/9b2c5bb8479084d65984106404e35816.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*kva4vbSeFAOGqmo0wvRtJg.png"/></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">LSTM网络的定义</figcaption></figure><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es kd"><img src="../Images/0cb1b5650d0a0ad6f2a7b782ecc7dab7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Q0uc7hIVp_UGPI4crSrWw.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">RNN模式</figcaption></figure><p id="a068" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在是训练模型的时候了。我们可以看出这是一个标准的分类问题。给定RNN的先前状态，以及给定时间步长的输入，我们希望预测下一个字符的类别，也就是说，实际预测下一个字符。</p><p id="b70a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了在这个分类任务上训练我们的模型，我们可以使用一种形式的<code class="du ke kf kg kh b">crossentropy</code>损失(负对数似然损失)。我们将使用真实目标值<code class="du ke kf kg kh b">labels</code>和预测目标值<code class="du ke kf kg kh b">logits</code>来计算损失。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ki"><img src="../Images/726dddaa23cc0f4b7f6bc2878bf9fd5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*seAscWgEpBPt_R6_bDNdDA.png"/></div></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">损失函数</figcaption></figure><p id="9ba2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了使用经过训练的RNN模型生成一些音乐，我们必须给这个模型一些种子来启动它。一旦我们有了一个生成的种子，我们就可以使用训练好的RNN迭代地预测每个连续的字符。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kj"><img src="../Images/04fceab0b044c7d6e90e474f53c6fca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*hncvh99tBUliEhg3d52Fkg.png"/></div><figcaption class="jt ju et er es jv jw bd b be z dx translated">2500次迭代后的最终结果</figcaption></figure><h2 id="1f80" class="kk kl hi bd km kn ko kp kq kr ks kt ku iq kv kw kx iu ky kz la iy lb lc ld le bi translated">预测程序</h2><p id="30d9" class="pw-post-body-paragraph if ig hi ih b ii lf ik il im lg io ip iq lh is it iu li iw ix iy lj ja jb jc hb bi translated">现在，我们准备编写代码来生成ABC音乐格式的文本:</p><ul class=""><li id="484d" class="lk ll hi ih b ii ij im in iq lm iu ln iy lo jc lp lq lr ls bi translated">初始化一个“种子”开始字符串和RNN状态，并设置我们想要生成的字符数。</li><li id="3ae4" class="lk ll hi ih b ii lt im lu iq lv iu lw iy lx jc lp lq lr ls bi translated">使用起始字符串和RNN状态获得下一个预测字符的概率分布。</li><li id="87a7" class="lk ll hi ih b ii lt im lu iq lv iu lw iy lx jc lp lq lr ls bi translated">从多项式分布中抽取样本来计算预测字符的指数。这个预测的字符然后被用作模型的下一个输入。</li><li id="123e" class="lk ll hi ih b ii lt im lu iq lv iu lw iy lx jc lp lq lr ls bi translated">在每个时间步，更新的RNN状态被反馈到模型中，因此它现在在进行下一次预测时有更多的上下文。在预测下一个字符后，更新的RNN状态再次反馈到模型中，这就是它如何学习数据中的序列依赖性，因为它从以前的预测中获得了更多信息。</li></ul><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es jx"><img src="../Images/996dad6dfa4248330d70f2751a9e7d54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6GVo7TSRw4dNZ2fU.png"/></div></div></figure><p id="9948" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用于训练模型的数据集是来自诺丁汉音乐数据库的一组圣诞歌曲，其中有诸如“野猪头”、“钟声颂歌”和“平安夜”的颂歌。</p><h2 id="bbe1" class="kk kl hi bd km kn ko kp kq kr ks kt ku iq kv kw kx iu ky kz la iy lb lc ld le bi translated">歌曲生成</h2><figure class="jl jm jn jo fd jp"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="9c51" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是MIT深度学习课程和Alexander Amini的一个项目，原始数据集来自爱尔兰民歌。</p><p id="0a5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.<a class="ae ma" href="http://www.wildml.com/2015/09/recurrent-neural-networks-tutorial-part-1-introduction-to-rnns/" rel="noopener ugc nofollow" target="_blank">http://www . wild ml . com/2015/09/recurrent-neural-networks-tutorial-part-1-introduction-to-rnns/</a></p><p id="7fef" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.<a class="ae ma" href="http://abcnotation.com/blog/2010/01/31/how-to-understand-abc-the-basics/" rel="noopener ugc nofollow" target="_blank">http://ABC notation . com/blog/2010/01/31/how-to-understand-ABC-the-basics/</a></p></div></div>    
</body>
</html>