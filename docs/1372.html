<html>
<head>
<title>M5 Forecasting — Accuracy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">M5预测—准确性</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/m5-forecasting-accuracy-c5580c7883a?source=collection_archive---------4-----------------------#2021-02-26">https://medium.com/analytics-vidhya/m5-forecasting-accuracy-c5580c7883a?source=collection_archive---------4-----------------------#2021-02-26</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="81a3" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated"><em class="iw">估算沃尔玛零售商品的单位销售额</em></h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/13b85ea0c27d19c8f3779358d6c8babe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*elaoU-DL1Mj4SC_LbhGnsg.png"/></div></div></figure><h1 id="544f" class="jj jk hh bd jl jm jn jo jp jq jr js jt in ju io jv iq jw ir jx it jy iu jz ka bi translated">目录:</h1><ol class=""><li id="c559" class="kb kc hh kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><em class="kt">商业问题</em></li><li id="0577" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated"><em class="kt">数据来源</em></li><li id="1395" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated"><em class="kt">机器学习问题</em></li><li id="5138" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated"><em class="kt">探索性数据分析</em></li><li id="5431" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated"><em class="kt">特征工程&amp;数据预处理</em></li><li id="2533" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated"><em class="kt">模型接近</em></li><li id="aee6" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated"><em class="kt"> Kaggle提交</em></li><li id="af02" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated"><em class="kt">部署</em></li><li id="d3cd" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated"><em class="kt">未来工作</em></li><li id="23cb" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated"><em class="kt">参考文献</em></li></ol><h1 id="e649" class="jj jk hh bd jl jm jn jo jp jq jr js jt in ju io jv iq jw ir jx it jy iu jz ka bi translated"><strong class="ak"> 1。商务问题:</strong></h1><p id="1115" class="pw-post-body-paragraph kz la hh kd b ke kf ii lb kg kh il lc ki ld le lf kk lg lh li km lj lk ll ko ha bi translated"><strong class="kd hi"> 1.1概述:</strong></p><p id="ffe7" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">在今天竞争异常激烈的商业环境中，每个人都想增加收入/销售额。作为一个整体，我们听说过招聘新员工时的战略规划，但你真的知道你到底什么时候需要扩大你的团队，开始你的下一个促销活动或推出你的新产品吗？对于所有这些事情，销售预测已经完成。</p><blockquote class="lr ls lt"><p id="b97a" class="kz la kt kd b ke lm ii lb kg ln il lc lu lo le lf lv lp lh li lw lq lk ll ko ha bi translated">那么我们是在预测未来吗？是啊！！但不那么准确。这是通过采用机器学习技术来完成的。</p></blockquote><p id="b651" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated"><strong class="kd hi">预测</strong>提供关于未来条件性质的知识。销售预测有助于每个企业做出更好的商业决策。它有助于整体业务规划、预算和风险管理。它允许公司有效地为未来增长分配资源，并管理其现金流。它还帮助企业准确地估计他们的成本和收入，并在此基础上预测他们的短期和长期业绩。</p><p id="561f" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">过去的销售业绩是未来销售业绩的良好先行指标。商务部因其Makridakis竞赛而闻名，在这个问题中，第五次迭代(M5预测)给出了世界上最大的零售公司沃尔玛的历史销售(过去的销售)数据。</p><p id="08fc" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated"><strong class="kd hi"> 1.2目标:</strong></p><p id="8058" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">主要目的是尽可能精确地估计沃尔玛在美国销售的各种产品的单位销售预测，从而帮助不同的沃尔玛商店增加收入。</p></div><div class="ab cl lx ly go lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ha hb hc hd he"><h1 id="bb35" class="jj jk hh bd jl jm me jo jp jq mf js jt in mg io jv iq mh ir jx it mi iu jz ka bi translated">2.数据来源</h1><p id="99bc" class="pw-post-body-paragraph kz la hh kd b ke kf ii lb kg kh il lc ki ld le lf kk lg lh li km lj lk ll ko ha bi translated">本次比赛提供了沃尔玛的分层销售数据<a class="ae mj" href="https://www.kaggle.com/c/m5-forecasting-accuracy" rel="noopener ugc nofollow" target="_blank"> M5预测-准确性</a>。</p><p id="fbe7" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated"><strong class="kd hi"> 2.1数据概述:</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mk"><img src="../Images/3265fa90faf7a1fbc80ff042e853cf9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eO9KkvgBEGbi2vsQ.jpeg"/></div></div><figcaption class="ml mm et er es mn mo bd b be z dx translated"><strong class="bd jl">数据组织方式概述。</strong></figcaption></figure><p id="deec" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">沃尔玛提供的销售数据涵盖了美国三个州(加利福尼亚州、德克萨斯州和威斯康星州)的商店，包括商品级别、部门、产品类别和商店详细信息。此外，它还有解释变量，如价格、促销、星期几和特殊事件。</p><ol class=""><li id="7e55" class="kb kc hh kd b ke lm kg ln ki mp kk mq km mr ko kp kq kr ks bi translated"><strong class="kd hi"> Calendar.csv: </strong>它包含关于产品销售日期以及当天举行的活动和节目的信息。</li><li id="1eda" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated"><strong class="kd hi">Sales _ train _ evaluation . CSV:</strong>它包含了从1941年第1天到第2天每家商店每种产品的历史每日单位销售额。</li><li id="c20a" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated"><strong class="kd hi"> Sell_prices.csv: </strong>它包含每个商店每周的产品价格信息。</li></ol></div><div class="ab cl lx ly go lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ha hb hc hd he"><h1 id="37ec" class="jj jk hh bd jl jm me jo jp jq mf js jt in mg io jv iq mh ir jx it mi iu jz ka bi translated">3.机器学习问题</h1><p id="c7ef" class="pw-post-body-paragraph kz la hh kd b ke kf ii lb kg kh il lc ki ld le lf kk lg lh li km lj lk ll ko ha bi translated">上述问题是一个时间序列数据问题，可以使用经典的机器学习技术来解决，通过使用历史销售数据来估计特定日期的单位销售。通过使用特征工程技术，给定的时间序列数据可以被重新构造为监督学习数据集，然后可以对其应用机器学习算法。它可以使用机器学习回归模型来解决，因为输入变量是在特定日期生成的功能和售出的项目，而输出变量属于实数。</p></div><div class="ab cl lx ly go lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ha hb hc hd he"><h1 id="f57d" class="jj jk hh bd jl jm me jo jp jq mf js jt in mg io jv iq mh ir jx it mi iu jz ka bi translated">4.探索性数据分析</h1><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ms"><img src="../Images/04dc4434ce56b51f4ea2f8129ef694e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*rcoT-dOYRFq_wUXR0BIK9g.png"/></div></figure><p id="f7f1" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">在3049种独特产品中，约47%(1437种)的产品属于食品类，34%(1047种)属于家用类，剩余的18.5%(565种)产品属于爱好类。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es mt"><img src="../Images/8dd25155b515ec26d67fe361883850d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l-4mfuY6oC8IHyfO090hTg.png"/></div></div></figure><p id="ee64" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">销售额平稳增长。(上升趋势)具有重复的季节性模式。每年的12月份销售额下降。</p><div class="iy iz ja jb fd ab cb"><figure class="mu jc mv mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/93c02d7a47468e1838b5bee5cc6003cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*xpRmco2C8uT_3pibhuX7hQ.png"/></div></figure><figure class="mu jc na mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/3b829c7c3f22123981e4e14748c975c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*E8JzDpl9-CoQz7T9mknaMw.png"/></div></figure></div><p id="17c2" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">我们可以清楚地看到，位于加州的商店表现良好，呈上升趋势(总销售额为2910万英镑)。直到2012年10月，WI商店的月销售额低于其他商店。但在2012年10月之后，月销售额有所提高，表现与TX门店相似。WI的销售额约为1850万，相对来说最少。</p><div class="iy iz ja jb fd ab cb"><figure class="mu jc nb mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/5bb0471483e750289be99806a5601453.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*He0fUQzejicIwe4un-RNsg.png"/></div></figure><figure class="mu jc nc mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/eacce63eda8aa5186699b1a3853041f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*oPMvqQRTmoUWLPc0sA8sqw.png"/></div></figure></div><p id="05e6" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">ca3商店销售额最高，总销售额为1130万。尽管WI_2和WI_3的人口较少，但它们的销量相当不错。CA_4销量最少，410万。</p><div class="iy iz ja jb fd ab cb"><figure class="mu jc nd mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/f3f01111ab9582d2323e171eeaa870c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*vWAKIix9dp4lH9kzMH1HlQ.png"/></div></figure><figure class="mu jc ne mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/0f70e1821729dd61ef1abcb1cd2300a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*QxqZC3JL4CW_pzWsaMpW3Q.png"/></div></figure></div><p id="95ce" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">显而易见，随着多年来销售额的逐渐增加，食品的需求量最大。大约68%的销售额来自食品。通过这张图，我们可以看出，在其他类别中，食品类别的需求最高。爱好类产品的销售比例最低。(即约9%)</p><div class="iy iz ja jb fd ab cb"><figure class="mu jc nf mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/d4f89c442b00714f01dc59b5bb425070.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*F2o4gY92koW7IZu-Pj2KTg.png"/></div></figure><figure class="mu jc ng mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/8786b1fefe964b447f045b9fa5df21a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*YLxqAJNR3Uq0sGuNQx9cRQ.png"/></div></figure></div><p id="990d" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">FOOD_3部门产品脱颖而出，成为需求量最高的产品部门，销售额呈上升趋势，并具有反复的季节性。从2012年6月起，HOUSEHOLD_1的销售额有所增加，并呈现小幅上升趋势。食品部的产品占总销售额的49%左右，售出3290万件产品。爱好_2部门产品销量最少，总销量50万。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nh"><img src="../Images/875b29f087d52f0850d4675c034fb591.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oZe3-FI8jl4xUdwiDvcoSw.png"/></div></div></figure><p id="b6bd" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">FOODS_3_090产品在3049个产品中需求最高，总销售额为101.79万。需求第二高的产品是FOODS_3_586，总销售额为93.2万英镑。家用_2_101产品是总销量最少的产品，为593。</p><div class="iy iz ja jb fd ab cb"><figure class="mu jc ni mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/61714a08251658eb14fb184514e4e867.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*wRk_He1m69UG71nihPKUDQ.png"/></div></figure><figure class="mu jc nj mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/923547b855e626a3c1c5446a1e77f4d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*TFRlVk1hcR87wbgOA98sKg.png"/></div></figure><figure class="mu jc nk mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/2bab2da5256a09f684cbf406136a0176.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*X7-It3JTALxxlcUTc_sMng.png"/></div></figure></div><p id="e9a6" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">FOODS_3_090产品在3049个产品中需求最高，总销售额为493k销售和爱好_1_052产品是加州总销售额最少的产品，为239。在3049种产品中，食品_3_226产品的需求最高，总销售额为250.7千英镑，家庭_2_130产品是威斯康星州总销售额最少的产品，为109英镑。</p><div class="iy iz ja jb fd ab cb"><figure class="mu jc nl mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/c6ea06e433871a192834c7a62244a468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*Yo2ceVIrJ9qVGifHfWuzpA.png"/></div></figure><figure class="mu jc nm mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/f48b35283d88a272520fce05a5d4fb66.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*zPQhFEE9oklZZTypHC1bcg.png"/></div></figure></div><p id="39a0" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">我们可以清楚地注意到，与其他日子相比，星期六和星期天的平均销售额较高，约为41.7万英镑。八月份的销售额最高，约为36万英镑。12月销量最少，平均销量为32.9k</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nn"><img src="../Images/43e5f5b402dccdc2f8a9fceb6caac621.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RR2jDrUcRZ7MBt5X4Z3uAg.png"/></div></div></figure><p id="d014" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">通常每月的销售额每年都在增加。如果对比2013年和2014年的月销量，2014年的月销量略有下降。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es no"><img src="../Images/1e9f7fe2620d95f4143122d4b3219f8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OGrt6uP56lzQ8Wz2-wPHeg.png"/></div></div></figure><p id="172f" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">劳动节的平均销售额最高，达到42154英镑。圣诞节的销售额很低，平均只有15英镑。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es np"><img src="../Images/a1a71c39acca863865b923afb95cce54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uAPbo9Wf_n10xgfROjZAAQ.png"/></div></div></figure><p id="9a68" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">我们可以清楚地注意到，销售价格不是恒定的。不同商店在几周内的售价不同。(有固定价格)CA_3的销量波动。通常CA_1和CA_2的商店价格是相似的。通常位于德克萨斯州的商店的价格是相似的。我们发现过去25周的销售价格没有变化。</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es nq"><img src="../Images/ecee79709173aaefec76e8ea1e2f3d30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GZmM06YbNmnV7KBcY0-Wew.png"/></div></div></figure><p id="1286" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">我们可以观察到,“wm_yr_wk”和“year”是影响销售的最显著特征。“月”特征也具有0.022的正相关性。</p></div><div class="ab cl lx ly go lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ha hb hc hd he"><h1 id="26d7" class="jj jk hh bd jl jm me jo jp jq mf js jt in mg io jv iq mh ir jx it mi iu jz ka bi translated">5.特征工程和数据预处理</h1><ul class=""><li id="44bf" class="kb kc hh kd b ke kf kg kh ki kj kk kl km kn ko nr kq kr ks bi translated">由于数据集由时间序列数据组成，因此数据被重构为监督学习的单个数据集。销售数据集被融合(将宽数据格式转换为长数据格式)并合并所有其他数据集。</li><li id="edef" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko nr kq kr ks bi translated">通过均值插补技术处理来自销售价格数据的缺失值。</li></ul><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ns nt l"/></div></figure><ul class=""><li id="6a62" class="kb kc hh kd b ke lm kg ln ki mp kk mq km mr ko nr kq kr ks bi translated">通过用它们的分类代码替换它们来转换所有的分类特征。</li></ul><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ns nt l"/></div></figure><ul class=""><li id="6a47" class="kb kc hh kd b ke lm kg ln ki mp kk mq km mr ko nr kq kr ks bi translated">采用特征工程来提取各种特征，例如滞后特征和滚动中值特征。</li></ul><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ns nt l"/></div></figure><ul class=""><li id="8bbd" class="kb kc hh kd b ke lm kg ln ki mp kk mq km mr ko nr kq kr ks bi translated">选择最近15个月的数据(1500天后的数据)只是为了加快处理速度。</li></ul><h1 id="71b6" class="jj jk hh bd jl jm jn jo jp jq jr js jt in ju io jv iq jw ir jx it jy iu jz ka bi translated"><strong class="ak"> 6。模型方法</strong></h1><p id="ce2d" class="pw-post-body-paragraph kz la hh kd b ke kf ii lb kg kh il lc ki ld le lf kk lg lh li km lj lk ll ko ha bi translated"><strong class="kd hi"> 6.1首切车型</strong></p><ul class=""><li id="a2e5" class="kb kc hh kd b ke lm kg ln ki mp kk mq km mr ko nr kq kr ks bi translated">在应用不同的算法来创建模型之前，我们需要将数据分成训练、测试和验证数据。</li></ul><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ns nt l"/></div></figure><ul class=""><li id="66b2" class="kb kc hh kd b ke lm kg ln ki mp kk mq km mr ko nr kq kr ks bi translated">在训练模型和测量性能指标后，我们需要预测未知数据的销售额。最后，我们需要生成一个适合Kaggle提交的CSV文件。</li></ul><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ns nt l"/></div></figure><ul class=""><li id="c8fd" class="kb kc hh kd b ke lm kg ln ki mp kk mq km mr ko nr kq kr ks bi translated">在创建了用于数据分割和提交文件生成的函数之后，现在我们可以尝试不同的算法并测量性能指标来比较构建的模型。</li><li id="7267" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko nr kq kr ks bi translated">作为第一个切割模型，尝试了线性回归、岭回归、贝叶斯岭回归和弹性网络等基本回归模型。</li><li id="15dc" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko nr kq kr ks bi translated">不包括滚动中值要素的输入要素通常表现更好。</li><li id="cd5c" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko nr kq kr ks bi translated">Lightgbm Regressor和Catboost Regressor等增强算法的性能优于基本模型。</li><li id="5c1e" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko nr kq kr ks bi translated">收到的所有模型的最终得分如下</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nu"><img src="../Images/6c094abfa9032ba1c774971854e17a8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*xfv_6QwTqPEuoNSD7blupw.png"/></div></figure><p id="9ae9" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated"><strong class="kd hi"> 6.2 Kaggle提交文件</strong></p><div class="iy iz ja jb fd ab cb"><figure class="mu jc nv mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/a630d327a6b1aa1b5e2b80fa3f1f3de1.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*AS7CP11j-XAv0zmRO9hFqg.png"/></div></figure><figure class="mu jc nw mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/da5fba903521b2a44fcf70c0353caa45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*IQaYm7XCX26n-NaI_NBcbw.png"/></div></figure></div><div class="ab cb"><figure class="mu jc nx mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/efd2400eed5284d11ebc32704ba275b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*d840ViteNM-5EloUkdPNow.png"/></div></figure><figure class="mu jc ny mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/f96bd3dd2aa6156559b5366cfd1074fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*iowHsA3yvrIvTRdAAAOW3A.png"/></div></figure></div><div class="ab cb"><figure class="mu jc nz mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/e2fbebf1e9d4cbb9eb21a6c85f850040.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*HT_986LvJQhZp-u3U_aAOg.png"/></div></figure><figure class="mu jc oa mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/9273d6b10ea1158d0302a9400e7e9c99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*AvDSggj3Kc39ak9lcvHcQQ.png"/></div></figure></div><div class="ab cb"><figure class="mu jc ob mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/ce47e7427cb4a786eb15aabfa47b66cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*dcq_rdar0f3aATx-l_keCA.png"/></div></figure><figure class="mu jc oc mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/108cf3ddba01b3c1defe014323cf5944.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*8rnvYFNd9mHmHoXAxRRBEQ.png"/></div></figure></div><p id="e80b" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated"><strong class="kd hi"> 6.3最佳模特</strong></p><p id="2b25" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated"><strong class="kd hi">定制合奏模型</strong></p><ol class=""><li id="b7d1" class="kb kc hh kd b ke lm kg ln ki mp kk mq km mr ko kp kq kr ks bi translated">将数据集分为训练集和测试集。</li><li id="4b04" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated">将训练数据集分割成两个相等且不相交的子集-D1和D2</li><li id="bcd6" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated">创建D1的k个子样本，并为每个子样本数据集构建基础模型。根据D1相应的二次抽样数据训练这些基本模型。</li><li id="1f9e" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated">将D2数据作为测试数据集，对所有基础模型进行预测。水平连接所有这些k基础模型的预测，以创建一个新的数据集，比如说元数据集。使用D2的标签作为其目标变量。</li><li id="6bde" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated">在此元数据集上训练元模型</li><li id="98b1" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated">通过将测试数据集提供给基础模型，然后堆叠基础模型的预测以创建将作为元模型输入的元数据集，来检查此元模型在测试数据集上的性能。</li><li id="dbe5" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated">这种基础模型和元模型的组合就是我们的定制集合模型。</li></ol><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ns nt l"/></div></figure><ul class=""><li id="4c7b" class="kb kc hh kd b ke lm kg ln ki mp kk mq km mr ko nr kq kr ks bi translated">创建实现自定义集成模型所需的自定义函数后。</li></ul><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ns nt l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es od"><img src="../Images/4dfc1230770a5388d63344fb9e516f06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*mpbb-o4f2Jo2DCfl5yxXlQ.png"/></div></figure><p id="13d8" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">最佳基础学习者在10个左右，但我们不知道最佳基础学习者的确切数量。所以再次找到6到14岁之间的最佳基础学习者。</p><figure class="iy iz ja jb fd jc"><div class="bz dy l di"><div class="ns nt l"/></div></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es oe"><img src="../Images/ae7913a1e445555ed26ad145d8b37a8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*Og3LS4-_5U0cp6GZQCx5Xg.png"/></div></figure><h1 id="9b68" class="jj jk hh bd jl jm jn jo jp jq jr js jt in ju io jv iq jw ir jx it jy iu jz ka bi translated">7.Kaggle提交</h1><p id="61bf" class="pw-post-body-paragraph kz la hh kd b ke kf ii lb kg kh il lc ki ld le lf kk lg lh li km lj lk ll ko ha bi translated">在用最优的<strong class="kd hi">基础学习者训练模型之后，即8个</strong>得到了最好的分数<strong class="kd hi"> 0.65766 </strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es of"><img src="../Images/19cfa66aaa4f31bb729c1c8328ade0f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mqpOV3Di8_G-sSMlnMA9BA.png"/></div></div></figure><ol class=""><li id="8e70" class="kb kc hh kd b ke lm kg ln ki mp kk mq km mr ko kp kq kr ks bi translated">从上面的私人排行榜得分中，我们观察到，在所有模型中，Custom ensemble模型表现良好，因为它能够以较低的得分(WRMSSE)=0.65766的私人得分预测销售。</li><li id="0785" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated">一旦我们从最终的最佳定制套装模型中获得验证日(1914-1941)销售额和评估日(1942-1969)销售额，并以给定的格式提交，我们将获得排行榜分数<strong class="kd hi"> 0.65766 </strong>，在<strong class="kd hi"> 5558 </strong>名参与者中排名<strong class="kd hi"> 331 </strong>，位列<strong class="kd hi">前6% </strong>。</li></ol><h1 id="8d1a" class="jj jk hh bd jl jm jn jo jp jq jr js jt in ju io jv iq jw ir jx it jy iu jz ka bi translated">8.部署</h1><ol class=""><li id="1bac" class="kb kc hh kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">在使用最佳超参数训练定制集合模型后，我们将基础模型和元模型存储在pickle文件中，并将它们与围绕最终管道构建的flask API一起部署到AWS EC2中，最终管道将ITEM_ID和STORE_ID作为输入，并将绘制的预测销售额作为输出返回。</li><li id="2953" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated">创建一个Html页面，将<strong class="kd hi"> ITEM_ID </strong>和<strong class="kd hi"> STORE_ID </strong>作为输入，并给出特定商品未来28天(即2016年5月23日至2016年6月19日)的<strong class="kd hi">预测销售额</strong>。</li></ol><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es og"><img src="../Images/f74c86ca5708a53a1290d396e2e1f081.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9LMH8EEu1UtOI8rS4QVCGA.png"/></div></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">估计商店<strong class="bd jl"> CA_3中id为<strong class="bd jl"> FOODS_3_090 </strong>的商品的销售额。</strong></figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es oh"><img src="../Images/9a945dc6a29cc1cbc35541785284efa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zlelWyT4kh7nvEzSI28VWw.png"/></div></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">商店<strong class="bd jl"> CA_3中id为<strong class="bd jl"> FOODS_3_090 </strong>的商品的预测销售额。</strong></figcaption></figure><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es oi"><img src="../Images/003f66c8ca19d1089f5cac21aaf9944b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hloWrJ6ydkmF7O0A-_bG7g.png"/></div></div><figcaption class="ml mm et er es mn mo bd b be z dx translated">估计所有商店中id为<strong class="bd jl"> FOODS_3_090 </strong>的商品的销售额。</figcaption></figure><div class="iy iz ja jb fd ab cb"><figure class="mu jc oj mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/439e435883a7f108122f0057ea14b1ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*uSFpA1m6E_DUUHl-oQgk6Q.png"/></div></figure><figure class="mu jc ok mw mx my mz paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><img src="../Images/5553701696b0bd751506a749c2c57d66.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*XyfufYaWv5TYCRHeLPb5wg.png"/></div><figcaption class="ml mm et er es mn mo bd b be z dx ol di om on translated">id为<strong class="bd jl"> FOODS_3_090 </strong>的商品在所有商店的预测销售额。</figcaption></figure></div><h2 id="3f3f" class="oo jk hh bd jl op oq or jp os ot ou jt ki ov ow jv kk ox oy jx km oz pa jz pb bi translated"><strong class="ak">部署的应用链接是</strong> <a class="ae mj" href="http://ec2-18-218-69-164.us-east-2.compute.amazonaws.com:8080/" rel="noopener ugc nofollow" target="_blank"> <strong class="ak">这里是</strong> </a> <strong class="ak">。</strong></h2><h1 id="0f86" class="jj jk hh bd jl jm jn jo jp jq jr js jt in ju io jv iq jw ir jx it jy iu jz ka bi translated">9.未来工作:</h1><ol class=""><li id="453c" class="kb kc hh kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">尝试使用神经网络方法，因为它提供了损失函数的灵活性。</li><li id="ed38" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated">用LSTM模型进行时间序列预测的尝试。</li></ol><h1 id="fb18" class="jj jk hh bd jl jm jn jo jp jq jr js jt in ju io jv iq jw ir jx it jy iu jz ka bi translated">10.参考资料:</h1><ol class=""><li id="3a66" class="kb kc hh kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated"><a class="ae mj" href="https://mofc.unic.ac.cy/m5-competition/" rel="noopener ugc nofollow" target="_blank">https://mofc.unic.ac.cy/m5-competition/</a></li><li id="4f65" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated"><a class="ae mj" href="https://www.researchgate.net/publication/344487258_The_M5_Accuracy_competition_Results_findings_and_conclusions" rel="noopener ugc nofollow" target="_blank">https://www . research gate . net/publication/344487258 _ The _ M5 _准确性_竞争_结果_调查结果_和_结论</a></li><li id="c7c6" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated"><a class="ae mj" rel="noopener" href="/analytics-vidhya/m5-forecasting-accuracy-time-series-forecasting-using-walmart-sales-data-374765d3f1f7">https://medium . com/analytics-vid hya/M5-预测-准确性-时间序列-预测-使用-沃尔玛-销售-数据-374765d3f1f7 </a></li><li id="85bc" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated"><a class="ae mj" rel="noopener" href="/thecyphy/m5-forecasting-accuracy-af6c45fb7d58">https://medium . com/the cyphy/M5-预测-准确性-af6c45fb7d58 </a></li><li id="d87b" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated"><a class="ae mj" href="https://www.kaggle.com/tarunpaparaju/m5-competition-eda-models" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/tarunparaju/M5-competition-EDA-models</a></li><li id="0bad" class="kb kc hh kd b ke ku kg kv ki kw kk kx km ky ko kp kq kr ks bi translated"><a class="ae mj" href="https://www.appliedaicourse.com/course/11/Applied-Machine-learning-course" rel="noopener ugc nofollow" target="_blank">https://www . Applied ai course . com/course/11/Applied-Machine-learning-course</a></li></ol><p id="a375" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">完整的代码和模型实现可以在我的GitHub库中找到。你可以在这里查看<a class="ae mj" href="https://github.com/AmithPVernekar/M5-Forecasting-Accuracy" rel="noopener ugc nofollow" target="_blank"><strong class="kd hi"><em class="kt"/></strong></a></p><p id="058f" class="pw-post-body-paragraph kz la hh kd b ke lm ii lb kg ln il lc ki lo le lf kk lp lh li km lq lk ll ko ha bi translated">你可以在LinkedIn <a class="ae mj" href="https://www.linkedin.com/in/amith-p-vernekar-56b137177/" rel="noopener ugc nofollow" target="_blank"> <strong class="kd hi"> <em class="kt">这里</em> </strong> </a>和我联系</p></div></div>    
</body>
</html>