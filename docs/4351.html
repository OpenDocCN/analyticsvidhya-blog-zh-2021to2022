<html>
<head>
<title>What is Item-Based Filtering? An Applied Example In Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是基于项目的过滤？Python中的一个应用实例</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/what-is-item-based-filtering-an-applied-example-in-python-70746737e5b1?source=collection_archive---------3-----------------------#2021-09-27">https://medium.com/analytics-vidhya/what-is-item-based-filtering-an-applied-example-in-python-70746737e5b1?source=collection_archive---------3-----------------------#2021-09-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="ed3c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">创建电影推荐器</p><p id="fab1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你好。在这个故事中，我们将尝试理解什么是基于项目的过滤，并且我们将看到Python中的一个应用示例。</p><p id="2600" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可以从<a class="ae jc" href="https://www.kaggle.com/enesbaysan/item-based-filtering-basic" rel="noopener ugc nofollow" target="_blank">这里</a>访问我为这个故事创建的Kaggle笔记本。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/bfceee7bb60cfc24456d3f263bc6a302.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JMYjRrXqFAgOUN5-ZoJxEA.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">马库斯·温克勒在<a class="ae jc" href="https://unsplash.com/s/photos/item?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="3af2" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">基于项目的过滤</h1><p id="d3a4" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">实际上，基于项目的过滤是一种协作过滤技术。有时候我们可以把这种技术看做“基于记忆”。推荐与X项目具有相似“喜欢”结构的项目是基本的心态。</p><p id="b69d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将创建一个如下的矩阵。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kw"><img src="../Images/7e33458a821fc222be21347c9a35cfb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*95fTENSVSXVZrgnjFYk3Xw.png"/></div></figure><p id="5a6d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个矩阵中，行代表用户，列代表项目，交叉单元格代表喜欢的计数。例如，用户1不喜欢项目4，项目1被喜欢10次。但是在这种技术中，我们将更关注项目而不是用户。</p><h1 id="5128" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">应用示例</h1><p id="87aa" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">我们将使用<a class="ae jc" href="https://www.kaggle.com/grouplens/movielens-20m-dataset" rel="noopener ugc nofollow" target="_blank">这个</a>数据集。我已经把它导入到我的工作区了。</p><p id="af0b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我要导入<code class="du kx ky kz la b">pandas</code>并读取数据。之后，我将合并这两个数据集。如上所述，我们需要使用项目(电影)名称和项目喜欢计数。因为这种过滤技术使用了这两个特征，并通过使用项目的喜好结构来创建推荐。因此我合并了这些数据集。</p><pre class="je jf jg jh fd lb la lc ld aw le bi"><span id="630b" class="lf ju hh la b fi lg lh l li lj">import pandas as pd</span><span id="c6be" class="lf ju hh la b fi lk lh l li lj">movie = pd.read_csv('movie_lens_dataset/movie.csv')</span><span id="ad71" class="lf ju hh la b fi lk lh l li lj">rating = pd.read_csv('movie_lens_dataset/rating.csv')</span><span id="39b6" class="lf ju hh la b fi lk lh l li lj">df = movie.merge(rating, how="left", on="movieId")</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ll"><img src="../Images/a1604af0be100ec47209e96c27776d25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GFsbSIJnWXaauL-_3tZVBg.png"/></div></div></figure><h2 id="9e9c" class="lf ju hh bd jv lm ln lo jz lp lq lr kd ip ls lt kh it lu lv kl ix lw lx kp ly bi translated">创建用户-项目矩阵</h2><p id="d40e" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">实际上，重点是基于项目的过滤。我们需要创建过滤技术将使用的矩阵。</p><p id="defe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我会选择评论数超过1000的电影。</p><pre class="je jf jg jh fd lb la lc ld aw le bi"><span id="054a" class="lf ju hh la b fi lg lh l li lj">comment_counts = pd.DataFrame(df["title"].value_counts())</span><span id="4832" class="lf ju hh la b fi lk lh l li lj">rare_movies = comment_counts[comment_counts["title"] &lt;= 1000].index</span><span id="0237" class="lf ju hh la b fi lk lh l li lj">common_movies = df[~df["title"].isin(rare_movies)]</span></pre><p id="bb15" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我不希望过滤技术受到评价较低的电影的影响。</p><p id="99b2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我可以创建用户-项目矩阵。其实就是个数据透视表。此表按行保存用户id；列中的项目标题和交叉点单元格中的评分计数(喜欢计数)。</p><pre class="je jf jg jh fd lb la lc ld aw le bi"><span id="b121" class="lf ju hh la b fi lg lh l li lj">user_movie_df = common_movies.pivot_table(index=["userId"], columns=["title"], values="rating")</span><span id="8c3e" class="lf ju hh la b fi lk lh l li lj">user_movie_df.shape</span><span id="eba4" class="lf ju hh la b fi lk lh l li lj">&gt;&gt;&gt; (138493, 3159)</span><span id="505a" class="lf ju hh la b fi lk lh l li lj">user_movie_df.head(10)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lz"><img src="../Images/06066a22d8dfb6354321cd3cf8b48423.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DJQRj_lkM9TSlD62KAMQ0g.png"/></div></div></figure><p id="0305" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">其实我们完成了最大的挑战点。其他的东西就是几行代码而已。</p><h2 id="133e" class="lf ju hh bd jv lm ln lo jz lp lq lr kd ip ls lt kh it lu lv kl ix lw lx kp ly bi translated">推荐电影</h2><p id="68fd" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">我将选择一部电影，并从我们的数据透视表中选择其评级值。</p><pre class="je jf jg jh fd lb la lc ld aw le bi"><span id="f1cb" class="lf ju hh la b fi lg lh l li lj">movie_name = "Matrix, The (1999)"</span><span id="5aa5" class="lf ju hh la b fi lk lh l li lj"># getting the ratings of the choosed movie<br/>movie_name = user_movie_df[movie_name]</span><span id="ccc5" class="lf ju hh la b fi lk lh l li lj">movie_name</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ma"><img src="../Images/66fb350776044a30234bfb3136cc1d42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MVHHPxg6kHitHoer07NuMg.png"/></div></div></figure><p id="b86a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">正如我们上面所说的，这种过滤技术计算所选项目(电影)与其他项目(电影)的喜欢(评级)结构。因此，我需要计算与他人的<code class="du kx ky kz la b">moive_name</code>相关性。<code class="du kx ky kz la b">movie_name</code>变量保存的是所选电影的点赞结构。所以我可以用这个变量来计算相关性。</p><pre class="je jf jg jh fd lb la lc ld aw le bi"><span id="d9b8" class="lf ju hh la b fi lg lh l li lj">movie_name = "Matrix, The (1999)"</span><span id="56de" class="lf ju hh la b fi lk lh l li lj">movie_name = user_movie_df[movie_name]</span><span id="0709" class="lf ju hh la b fi lk lh l li lj">user_movie_df.corrwith(movie_name).sort_values(ascending=False).head(10)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mb"><img src="../Images/248326e36bf02ddc9d4b0ae4d288765c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*TfMGXl3Xf9iQdUcsVu3NqA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">推荐电影</figcaption></figure><p id="d799" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">是的，我们完成了基于项目的过滤。我们看到了上面推荐的电影《黑客帝国(1999)》。</p><p id="09c8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你去Kaggle笔记本，可以看到一些有帮助的推荐电影的功能。</p><p id="45ec" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">希望你喜欢这个。关于其他推荐技巧的阅读，你可以访问我的个人资料。</p><p id="9ee4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">亲切的问候。</p></div></div>    
</body>
</html>