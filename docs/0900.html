<html>
<head>
<title>How to Generate Anything</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何生成任何东西</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-generated-anything-276fbf8c95e8?source=collection_archive---------10-----------------------#2021-02-05">https://medium.com/analytics-vidhya/how-to-generated-anything-276fbf8c95e8?source=collection_archive---------10-----------------------#2021-02-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="9ff9" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">为赶时间的人准备的甘斯</h1><blockquote class="jc jd je"><p id="277e" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">“生成对手网络是过去十年机器学习中最有趣的想法”</p><p id="dc0f" class="jf jg jh ji b jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">Yann LeCun，脸书人工智能研究主任。</p></blockquote><p id="7990" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">GANs是机器学习(ML)中一个令人敬畏的相对新概念。在这篇文章中，我将解释什么是gan，gan的类型和它们的好处，展示一些公司用gan做的惊人的事情，我将解释如何自己做一个。</p></div><div class="ab cl kh ki go kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="ha hb hc hd he"><h1 id="e375" class="ie if hh bd ig ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb bi translated">什么是甘？</h1><p id="d08d" class="pw-post-body-paragraph jf jg hh ji b jj kt jl jm jn ku jp jq ke kv jt ju kf kw jx jy kg kx kb kc kd ha bi translated">那么这些神奇的算法是什么呢？GANs(Generative adversial Networks)通常是两个<a class="ae ky" href="https://towardsdatascience.com/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53" rel="noopener" target="_blank">CNN</a>(卷积神经网络)，由一个<strong class="ji hi">生成器</strong>和一个<strong class="ji hi">鉴别器</strong>组成，两者互为对手。最简单的解释方法是类比，所以我们开始吧！你可以把一个甘想象成<strong class="ji hi">警察</strong>和<strong class="ji hi">打假人。</strong>造假者造假币，但一开始，他什么都不懂，就造出了这样的东西:</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es kz"><img src="../Images/cebde76afe86905d1c24bfc8d6add443.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*_eRPh1zlNourvvJ0KHjjTA.png"/></div></figure><p id="debd" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">但是警察告诉伪造者和他自己有什么问题，导致伪造者和警察都变得更好。在实践中，我们把造假者称为生产者，把警察称为鉴别者。</p><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es lh"><img src="../Images/6c15873ffd174e136511db5ceceb1bb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XKanAdkjQbg1eDDMF2-4ow.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">显示gan如何工作的概念图</figcaption></figure></div><div class="ab cl kh ki go kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="ha hb hc hd he"><h1 id="327f" class="ie if hh bd ig ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb bi translated"><strong class="ak">甘的种类</strong></h1><p id="5656" class="pw-post-body-paragraph jf jg hh ji b jj kt jl jm jn ku jp jq ke kv jt ju kf kw jx jy kg kx kb kc kd ha bi translated">那么现在我们知道了什么是甘，有哪些类型呢？</p><h2 id="35aa" class="lq if hh bd ig lr ls lt ik lu lv lw io ke lx ly is kf lz ma iw kg mb mc ja md bi translated"><strong class="ak">基地</strong></h2><p id="5415" class="pw-post-body-paragraph jf jg hh ji b jj kt jl jm jn ku jp jq ke kv jt ju kf kw jx jy kg kx kb kc kd ha bi translated">任何GAN都需要这两个GAN中的一个来启动:</p><p id="e60a" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated"><strong class="ji hi">奥格甘</strong></p><p id="9f02" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">这是2014年Ian Goodfellow在<a class="ae ky" href="https://arxiv.org/abs/1406.2661" rel="noopener ugc nofollow" target="_blank">论文</a>中首次引用的GAN原文。</p><p id="0dd9" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated"><strong class="ji hi">DCGAN(深度卷积生成对抗网络)</strong></p><p id="22c7" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">DCGAN是常规GAN的改进版本，通常用于GAN之上，因为它更稳定，通常也更好。</p></div><div class="ab cl kh ki go kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="ha hb hc hd he"><h2 id="caa8" class="lq if hh bd ig lr ls lt ik lu lv lw io ke lx ly is kf lz ma iw kg mb mc ja md bi translated"><strong class="ak">扩展</strong></h2><p id="c19b" class="pw-post-body-paragraph jf jg hh ji b jj kt jl jm jn ku jp jq ke kv jt ju kf kw jx jy kg kx kb kc kd ha bi translated">在我们有了基本集合之后，我们可以通过特殊化来改进我们的GAN以满足特定的需求。有数百种方法可以改变我们的GAN，但我将只涵盖最常见的方法。查看更多请看<a class="ae ky" href="https://github.com/hindupuravinash/the-gan-zoo" rel="noopener ugc nofollow" target="_blank">甘动物园</a>。</p><p id="bc90" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated"><strong class="ji hi"> WGAN </strong></p><p id="123d" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">WGAN或Wasserstein GAN是一种GAN，它将鉴别器改为鉴别器，并使用Wasserstein损耗，其中损耗现在不再局限于0和1之间，而是可以是任何实数。这解决了消失梯度问题和模式崩溃问题，这基本上意味着GAN不会陷入局部最小值，并且如果生成具有多个组的对象，则不会陷入仅生成一个组。</p><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es me"><img src="../Images/06556515f830416ee4c870f09af7bad4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YNozYj0gtX36YyglcY8LFA.jpeg"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">显示WGAN的功率的图，其中GAN是常规GAN，WGAN是具有重量削波的WGAN，WGAN-GP是具有梯度损失的WGAN</figcaption></figure><p id="2652" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated"><strong class="ji hi"> CGAN </strong></p><p id="d729" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">CGAN或有条件GAN是一种防止模式崩溃并允许您从GAN中采样特定图像的GAN。CGAN通过将数据集的标签输入到GAN中来做到这一点。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es mf"><img src="../Images/04eb1a37e807dc87bd054ad78b17ea85.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*b5dFHEPU3nZgqvI50u-rSw.png"/></div></figure><p id="d984" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated"><strong class="ji hi"> Pix2Pix甘</strong></p><p id="ac13" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">Pix2Pix GAN是您的一般图像到图像转换GAN，可以做一些事情，如恢复丢失部分的旧图像，给没有颜色的图像添加颜色，以及<a class="ae ky" href="https://zaidalyafeai.github.io/pix2pix/pokemon.html" rel="noopener ugc nofollow" target="_blank">将</a> <a class="ae ky" href="https://affinelayer.com/pixsrv/" rel="noopener ugc nofollow" target="_blank">绘图转换为图像</a>。Pix2Pix GAN的工作有点像一个更复杂的图像转换模型(如循环GAN)的起点。Pix2Pix GAN使用有条件的GAN来比较好的输出和差的输出，以产生好的输出。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es mg"><img src="../Images/35d2f9cd313b39a22d7d6eab3793e489.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*SxpgwX35z4kplsI-hd_Zeg.jpeg"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">Pix2Pix GAN的一些结果</figcaption></figure><p id="87f8" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated"><strong class="ji hi">轮回甘</strong></p><p id="51e0" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">循环GAN允许在没有匹配数据集的情况下进行模式转换，例如，如果您想让一匹马成为斑马，或者让一张照片看起来像梵高的画。自行车甘工作，但有两个甘。一个GAN接收一匹马(输入1)并试图将它变成斑马(输出1)，然后一个鉴别器评估被变成斑马的那匹马有多像斑马(损失1)。之后，马-斑马(输入2)现在被放入另一个生成器，试图使它看起来尽可能接近原始马(输出2)。最后，第二个鉴别器计算那匹马-斑马-马的损失(损失2)。我知道这听起来非常复杂，但基本上是马对斑马对马。</p><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mh"><img src="../Images/e484e19f0f2ed764352c772dd07b804a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EWWm148aWAh7IX-9k2aS9g.jpeg"/></div></div></figure><p id="b98d" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated"><strong class="ji hi">递进式甘</strong></p><p id="93b9" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">渐进GAN是在训练期间生长的GAN，从低分辨率到高分辨率。GAN通过在训练期间向模型添加层来生长。这样做使这个甘真正稳定，加速训练，让你得到更好的结果。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es mi"><img src="../Images/e94a9c101f06cdba60383092e6281f8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*ZZe8rf6Q__bEBcCCAzlGsA.png"/></div></figure><p id="1392" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated"><strong class="ji hi">信息甘</strong></p><p id="17cb" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">info GAN是一个GAN，允许你按照宽度、旋转等属性对输出进行分类。info GAN通过按照噪声和潜在代码对输出进行分类来实现这一点。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es mj"><img src="../Images/5bc539d18c95cd6b4d29acddedf075da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*sPsAnZJsgSCiBJ5Vl6TA7Q.png"/></div></figure></div><div class="ab cl kh ki go kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="ha hb hc hd he"><h1 id="d457" class="ie if hh bd ig ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb bi translated"><strong class="ak">公司</strong></h1><p id="0049" class="pw-post-body-paragraph jf jg hh ji b jj kt jl jm jn ku jp jq ke kv jt ju kf kw jx jy kg kx kb kc kd ha bi translated">基于GAN的公司不多，也就是说，基于GAN的公司主要有两种类型。</p><h2 id="ff3a" class="lq if hh bd ig lr ls lt ik lu lv lw io ke lx ly is kf lz ma iw kg mb mc ja md bi translated"><strong class="ak">内容创建</strong></h2><p id="0e85" class="pw-post-body-paragraph jf jg hh ji b jj kt jl jm jn ku jp jq ke kv jt ju kf kw jx jy kg kx kb kc kd ha bi translated">拍摄照片和支付人们制作广告的工资是昂贵的。所以让甘斯为我们做这件事。GANs非常擅长创造性工作，因此任何工作，如设计、图像编辑、图像/视频制作都可以使用GANs自动完成。一些公司使用GANs进行创意的例子有<a class="ae ky" href="https://www.rosebud.ai/" rel="noopener ugc nofollow" target="_blank"> RoseBud.ai </a>、<a class="ae ky" href="https://datagrid.co.jp/en/" rel="noopener ugc nofollow" target="_blank"> DataGrid </a>等等。这是RoseBud的一段视频，展示了他们的工作。</p><figure class="la lb lc ld fd le"><div class="bz dy l di"><div class="mk ml l"/></div></figure><h2 id="cad6" class="lq if hh bd ig lr ls lt ik lu lv lw io ke lx ly is kf lz ma iw kg mb mc ja md bi translated"><strong class="ak">产品优化</strong></h2><p id="2510" class="pw-post-body-paragraph jf jg hh ji b jj kt jl jm jn ku jp jq ke kv jt ju kf kw jx jy kg kx kb kc kd ha bi translated">当然，我说的是甘斯的圣杯，生成式设计。生成式设计是一项神奇的技术，可以改变整个世界。生成式设计是GANs的一个应用，它允许我们通过迭代过程优化建筑、交通、家具等。使用创成式设计的公司有<a class="ae ky" href="https://www.aispacefactory.com/" rel="noopener ugc nofollow" target="_blank">太空工厂</a>、<a class="ae ky" href="https://www.autodesk.ca/en/products/fusion-360/personal" rel="noopener ugc nofollow" target="_blank"> Fusion 360 </a>等等。</p><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es mm"><img src="../Images/0a9194eb05c9ca937cdee5a845783e17.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*JU8o2sEQ5LF019iJ5waFkg.jpeg"/></div></figure></div><div class="ab cl kh ki go kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="ha hb hc hd he"><h1 id="d537" class="ie if hh bd ig ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb bi translated"><strong class="ak">如何制作GAN </strong></h1><p id="156d" class="pw-post-body-paragraph jf jg hh ji b jj kt jl jm jn ku jp jq ke kv jt ju kf kw jx jy kg kx kb kc kd ha bi translated">这听起来很棒，那我们怎么做呢？我将向你展示如何使用Keras和TensorFlow制作DCGAN。链接到更多我在最后做的甘。</p><h2 id="e165" class="lq if hh bd ig lr ls lt ik lu lv lw io ke lx ly is kf lz ma iw kg mb mc ja md bi translated"><strong class="ak">导入库</strong></h2><pre class="la lb lc ld fd mn mo mp mq aw mr bi"><span id="0350" class="lq if hh mo b fi ms mt l mu mv">import tqdm<br/>import os<br/>import cv2<br/>import matplotlib.pyplot as plt<br/>import tensorflow as tf<br/>import numpy as np<br/>from glob import glob<br/>import keras</span></pre><p id="8c9e" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">这一部分非常简单明了，但是我们导入了代码中将要使用的任何库。一般来说，这些是我推荐的库，但是你可能需要导入不同的库。</p><h2 id="82aa" class="lq if hh bd ig lr ls lt ik lu lv lw io ke lx ly is kf lz ma iw kg mb mc ja md bi translated"><strong class="ak">定义变量</strong></h2><pre class="la lb lc ld fd mn mo mp mq aw mr bi"><span id="bca5" class="lq if hh mo b fi ms mt l mu mv">IMG_WIDTH = 100<br/>IMG_HEIGHT = 100</span><span id="1d97" class="lq if hh mo b fi mw mt l mu mv">random_dim = 100 <br/>np.random.seed(512) <br/>datadir = "" #path goes here</span></pre><p id="921c" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">定义图像归一化的变量(宽度和高度)、潜在空间(random_dim和种子)以及定义数据集的路径。</p><h2 id="15b6" class="lq if hh bd ig lr ls lt ik lu lv lw io ke lx ly is kf lz ma iw kg mb mc ja md bi translated"><strong class="ak">图像归一化/设置流水线</strong></h2><pre class="la lb lc ld fd mn mo mp mq aw mr bi"><span id="da6b" class="lq if hh mo b fi ms mt l mu mv">from tqdm import tqdm<br/>data = []</span><span id="b96a" class="lq if hh mo b fi mw mt l mu mv">def create_data():<br/>    path = datadir<br/>    for img in tqdm(os.listdir(path)):<br/>      img_array = cv2.imread(os.path.join(path,img))<br/>      new_array = cv2.resize(img_array, (IMG_SIZE, IMG_SIZE), interpolation = cv2.INTER_NEAREST)<br/>      drawings_data.append(new_array)<br/>    plt.imshow(drawings_data[0])<br/>    plt.show()<br/>    print(new_array)</span><span id="cbd3" class="lq if hh mo b fi mw mt l mu mv">create_data()</span></pre><p id="49cc" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">在这里，我们正在做一些基本的图像规范化，如调整图像大小，然后将它们转换为数组，以便模型可以使用数据。</p><pre class="la lb lc ld fd mn mo mp mq aw mr bi"><span id="c027" class="lq if hh mo b fi ms mt l mu mv">def load_data():<br/>  x_train = data<br/>  x_train = (np.asarray(x_train).astype(np.float32) - 127.5)/127.5<br/>  return x_train</span></pre><p id="2ccf" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">在这里，我们正在为模型重塑数组。</p><h2 id="8597" class="lq if hh bd ig lr ls lt ik lu lv lw io ke lx ly is kf lz ma iw kg mb mc ja md bi translated"><strong class="ak">定义模型</strong></h2><pre class="la lb lc ld fd mn mo mp mq aw mr bi"><span id="4e72" class="lq if hh mo b fi ms mt l mu mv">def get_optimizer():<br/>  return Adam(lr=0.0002, beta_1=0.9)</span></pre><p id="583a" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">这里我们定义了模型的学习率和beta，一般来说，我建议大多数模型的学习率为0.0002，大多数模型的beta为0.9。</p><pre class="la lb lc ld fd mn mo mp mq aw mr bi"><span id="17a9" class="lq if hh mo b fi ms mt l mu mv">def get_generator(optimizer):<br/>  generator = Sequential()</span><span id="6da0" class="lq if hh mo b fi mw mt l mu mv">generator.add(Dense(13*13*40, input_dim = random_dim,kernel_initializer=initializers.RandomNormal(stddev=0.02)))<br/>  generator.add(BatchNormalization())<br/>  generator.add(LeakyReLU())</span><span id="abff" class="lq if hh mo b fi mw mt l mu mv">generator.add(Reshape((13, 13, 40)))</span><span id="6ba0" class="lq if hh mo b fi mw mt l mu mv">generator.add(Conv2DTranspose(256, (3, 3), strides=(1, 1), padding='same'))<br/>  generator.add(BatchNormalization())<br/>  generator.add(LeakyReLU())</span><span id="e5f6" class="lq if hh mo b fi mw mt l mu mv">generator.add(Conv2DTranspose(128, (3, 3), strides=(2, 2), padding='same'))<br/>  generator.add(BatchNormalization())<br/>  generator.add(LeakyReLU())</span><span id="b535" class="lq if hh mo b fi mw mt l mu mv">generator.add(Conv2DTranspose(64, (3, 3), strides=(2, 2), padding='same'))<br/>  generator.add(BatchNormalization())<br/>  generator.add(LeakyReLU())</span><span id="0232" class="lq if hh mo b fi mw mt l mu mv">generator.add(Conv2DTranspose(3, (3, 3), strides=(2, 2), padding='same', activation='tanh'))</span><span id="801e" class="lq if hh mo b fi mw mt l mu mv">generator.add(Cropping2D(cropping=((2,2),(2,2))))</span><span id="a5fa" class="lq if hh mo b fi mw mt l mu mv">return generator</span></pre><p id="ffde" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">这里我们定义发电机模型。</p><pre class="la lb lc ld fd mn mo mp mq aw mr bi"><span id="6922" class="lq if hh mo b fi ms mt l mu mv">def get_discriminator(optimizer):</span><span id="063d" class="lq if hh mo b fi mw mt l mu mv">discriminator = Sequential()</span><span id="50a0" class="lq if hh mo b fi mw mt l mu mv">discriminator.add(Conv2D(64, (5, 5), strides=(2, 2), padding='same', input_shape=(100,100, 3)))<br/>  discriminator.add(LeakyReLU())<br/>  discriminator.add(Dropout(0.02))<br/>  <br/>  discriminator.add(Conv2D(128, (5, 5), strides=(2, 2), padding='same'))<br/>  discriminator.add(LeakyReLU())<br/>  discriminator.add(Dropout(0.02))<br/>  <br/>  discriminator.add(Flatten())<br/>  discriminator.add(Dense(1, activation= "sigmoid",))<br/>  discriminator.compile(loss="BinaryCrossentropy", optimizer=optimizer)</span><span id="627f" class="lq if hh mo b fi mw mt l mu mv">return discriminator</span></pre><p id="31b7" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">这里我们定义了鉴别器模型。</p><pre class="la lb lc ld fd mn mo mp mq aw mr bi"><span id="fbc8" class="lq if hh mo b fi ms mt l mu mv">def get_gan_network(discriminator, random_dim, generator, optimizer):<br/>  discriminator.trainable = False<br/>  gan_input = Input(shape=(random_dim,))<br/>  x = generator(gan_input)<br/>  gan_output = discriminator(x)<br/>  gan = Model(inputs=gan_input, outputs=gan_output)<br/>  gan.compile(loss="binary_crossentropy", optimizer=optimizer)<br/>  return gan</span></pre><p id="81d2" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">最后，我们在这里定义GAN。</p><h2 id="37f3" class="lq if hh bd ig lr ls lt ik lu lv lw io ke lx ly is kf lz ma iw kg mb mc ja md bi translated"><strong class="ak">训练模特</strong></h2><pre class="la lb lc ld fd mn mo mp mq aw mr bi"><span id="0b05" class="lq if hh mo b fi ms mt l mu mv">def plot_generated_images(epoch, generator, examples=100, dim=(10, 10), figsize=(5, 5)):<br/>  noise = np.random.normal(0, 1, size=[examples, random_dim])<br/>  generated_images = generator.predict(noise)<br/>  generated_images = generated_images.reshape(examples, 100, 100, 3)<br/>  generated_images += 1<br/>  generated_images /= 2</span><span id="9148" class="lq if hh mo b fi mw mt l mu mv">plt.figure(figsize=figsize)<br/>  for i in range(generated_images.shape[0]):<br/>    plt.subplot(dim[0], dim[1], i+1)<br/>    plt.imshow(generated_images[i], interpolation="nearest")<br/>    plt.axis("off")<br/>  plt.tight_layout()<br/>  plt.savefig("gan_generated_image_epoch_%d.png" % epoch)</span></pre><p id="1703" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">这里我们设置了一个函数来绘制我们的图像。</p><pre class="la lb lc ld fd mn mo mp mq aw mr bi"><span id="d7a4" class="lq if hh mo b fi ms mt l mu mv">def train(epochs=1, batch_size=50):<br/>  x_train = load_data()<br/>  batch_count = x_train.shape[0] / batch_size<br/>  adam = get_optimizer()<br/>  generator = get_generator(adam)<br/>  discriminator = get_discriminator(adam)<br/>  gan = get_gan_network(discriminator, random_dim, generator, adam)<br/>  #random noise and images<br/>  for e in range(1, epochs+1):<br/>    print("-"*15,"Epoch %d" % e, "-"*15)<br/>    for _ in tqdm(range(int(batch_count))):<br/>      noise = np.random.normal(0, 1, size=[batch_size, random_dim])<br/>      image_batch = x_train[np.random.randint(0, x_train.shape[0], size=batch_size)]</span><span id="1835" class="lq if hh mo b fi mw mt l mu mv">#generate fake images<br/>      generated_images = generator.predict(noise)<br/>      X = np.concatenate([image_batch, generated_images])</span><span id="b610" class="lq if hh mo b fi mw mt l mu mv">#labels for fake + real<br/>      y_dis = np.zeros(2*batch_size)<br/>      y_dis[:batch_size] = 0.9</span><span id="b020" class="lq if hh mo b fi mw mt l mu mv">discriminator.trainable = True <br/>      discriminator.train_on_batch(X, y_dis)</span><span id="dc49" class="lq if hh mo b fi mw mt l mu mv">noise = np.random.normal(0, 1, size=[batch_size, random_dim])<br/>      y_gen = np.ones(batch_size)<br/>      discriminator.trainable = False<br/>      gan.train_on_batch(noise, y_gen)</span><span id="ace7" class="lq if hh mo b fi mw mt l mu mv">if e == 1 or e % 5 == 0:<br/>      plot_generated_images(e, generator)</span></pre><p id="d8d1" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">现在我们要定义训练函数，然后最后我们可以训练我们的模型。</p><pre class="la lb lc ld fd mn mo mp mq aw mr bi"><span id="125e" class="lq if hh mo b fi ms mt l mu mv">train(100,50)</span></pre><p id="b874" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">在这里，它被设置为运行100个时期，批量大小为50，但可以很容易地改变。</p></div><div class="ab cl kh ki go kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="ha hb hc hd he"><p id="3f4e" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">现在你知道如何制作GAN和不同类型的GAN，以及它们的用途。</p><p id="5e33" class="pw-post-body-paragraph jf jg hh ji b jj jk jl jm jn jo jp jq ke js jt ju kf jw jx jy kg ka kb kc kd ha bi translated">以下是我从GANs中得到的一些结果</p><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es mx"><img src="../Images/83b0504afd1dd3911de7d8c8feefbdd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MZd9Sg-a1vQ_qtDk9-tdIA.png"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">MNIST数据集(第一个GAN) 28 x 28</figcaption></figure><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es my"><img src="../Images/0831c370ee28b630ab347bb9283346f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*0Fn1E6bGTwDuxzRMfHR_uQ.gif"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">名人_A 100 x 100</figcaption></figure><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es mz"><img src="../Images/ff8a75b8f022f596cd64f8da023b10f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:298/format:webp/1*ssxIOCqOLe9nhjXSVjA7kg.png"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">时尚MNIST WGAN 28 x 28</figcaption></figure><div class="la lb lc ld fd ab cb"><figure class="na le nb nc nd ne nf paragraph-image"><img src="../Images/55332d97849c1c14e14eb0fd588cc057.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*tRyJSORfOJCQfM1J9oqQ1g.png"/></figure><figure class="na le nb nc nd ne nf paragraph-image"><img src="../Images/af61cda7e6da3b059e3afd48012411c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*J7qsMYCzM2ON7ZU9n-zryA.png"/></figure><figure class="na le nb nc nd ne nf paragraph-image"><img src="../Images/a13001e85b7a2cde472a25ee9b544868.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*OODGWm1trMS9RJdlkKJtxQ.png"/><figcaption class="lm ln et er es lo lp bd b be z dx ng di nh ni translated">口袋妖怪128 x 128</figcaption></figure></div><div class="ab cb"><figure class="na le nb nc nd ne nf paragraph-image"><img src="../Images/72000ceb1faa7e88e23f22c9b8dbd922.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*5dAcJHFQYtaYiGOMJDH-BA.png"/></figure><figure class="na le nb nc nd ne nf paragraph-image"><img src="../Images/26ffe9daf1a424b0c74852c7afd440b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*rPXwStpgjRbmBQA8nT65Ug.png"/></figure><figure class="na le nb nc nd ne nf paragraph-image"><img src="../Images/4c26424da6c327d5a3da5c13debaf5ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*e5PpqJXVOxqK1LmB5VLm6g.png"/><figcaption class="lm ln et er es lo lp bd b be z dx ng di nh ni translated">肺炎图像128 x 128</figcaption></figure></div><div class="ab cb"><figure class="na le nb nc nd ne nf paragraph-image"><img src="../Images/9e327ea4fde8d2e9374d28ab7a9c156a.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*Hfoo9t5sgPMWzfcdNh4-Ig.png"/></figure><figure class="na le nb nc nd ne nf paragraph-image"><img src="../Images/109f9290c0c0ff820a2303a700d4bfd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*rz72QvTVLf4-o4OOO1v7AA.png"/></figure><figure class="na le nb nc nd ne nf paragraph-image"><img src="../Images/7723b51b4c6e6cb43e8509fb19682cc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*5FLKhR-2AGFhpqTtC2x3tA.png"/><figcaption class="lm ln et er es lo lp bd b be z dx ng di nh ni translated">医学眼球图像(它变成了蓝色🤷‍♂️) 128 x 128</figcaption></figure></div><figure class="la lb lc ld fd le er es paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="er es nj"><img src="../Images/3f1dddca7cba3268327284d510079a4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*KSmKq8vl9o8jCdqfsU9ELg.gif"/></div></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">生成“艺术”100 x 100</figcaption></figure><figure class="la lb lc ld fd le er es paragraph-image"><div class="er es nk"><img src="../Images/a4de0b031e506853468ab958f1820339.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/1*d4pkEUELw7WqwZS0Iv6lCg.gif"/></div><figcaption class="lm ln et er es lo lp bd b be z dx translated">血细胞128 x 128</figcaption></figure></div><div class="ab cl kh ki go kj" role="separator"><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km kn"/><span class="kk bw bk kl km"/></div><div class="ha hb hc hd he"><blockquote class="nl"><p id="c609" class="nm nn hh bd no np nq nr ns nt nu kd dx translated">这里是Github链接来查看我所有GANs的代码</p></blockquote><blockquote class="jc jd je"><p id="4b92" class="jf jg jh ji b jj nv jl jm jn nw jp jq jr nx jt ju jv ny jx jy jz nz kb kc kd ha bi translated">如果你喜欢这篇文章，你可能会喜欢我的其他文章，所以考虑在<a class="ae ky" rel="noopener" href="/@thomaslawrence642">媒体</a>上关注我，你正在做的很好在<a class="ae ky" href="https://twitter.com/@Thomas6422" rel="noopener ugc nofollow" target="_blank">推特</a>、<a class="ae ky" href="https://www.linkedin.com/in/thomas-lawrence-7725291b6/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>上关注我，并注册我的<a class="ae ky" href="https://thomas-newsletters.mailchimpsites.com/" rel="noopener ugc nofollow" target="_blank">时事通讯</a>。</p></blockquote></div></div>    
</body>
</html>