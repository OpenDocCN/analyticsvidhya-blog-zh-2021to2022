<html>
<head>
<title>Build Your First Machine Learning Web App Painlessly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">轻松构建您的第一个机器学习Web应用程序</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/build-your-first-machine-learning-web-app-painlessly-ea24f8bbef94?source=collection_archive---------18-----------------------#2021-03-29">https://medium.com/analytics-vidhya/build-your-first-machine-learning-web-app-painlessly-ea24f8bbef94?source=collection_archive---------18-----------------------#2021-03-29</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="e806" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">通过实现OLS简单线性回归模型和使用Flask，用不到20行代码构建一个基于机器学习的web应用程序</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/338d45e5322c9639f5a7e466527fa3c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bYCqE773wb9pxlkRxLqMZg.jpeg"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">作者图片📸</figcaption></figure><h1 id="d21c" class="jm jn hh bd jo jp jq jr js jt ju jv jw in jx io jy iq jz ir ka it kb iu kc kd bi translated">目录</h1><ol class=""><li id="88ce" class="ke kf hh kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="kg hi">去取一些简单的数据</strong></li><li id="fb85" class="ke kf hh kg b kh kw kj kx kl ky kn kz kp la kr ks kt ku kv bi translated"><strong class="kg hi">建立简单的线性回归模型</strong></li><li id="331a" class="ke kf hh kg b kh kw kj kx kl ky kn kz kp la kr ks kt ku kv bi translated"><strong class="kg hi">是时候创建我们的网络应用了</strong></li><li id="583f" class="ke kf hh kg b kh kw kj kx kl ky kn kz kp la kr ks kt ku kv bi translated"><strong class="kg hi">运行web应用程序！</strong></li><li id="6077" class="ke kf hh kg b kh kw kj kx kl ky kn kz kp la kr ks kt ku kv bi translated"><strong class="kg hi">结论</strong></li></ol></div><div class="ab cl lb lc go ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ha hb hc hd he"><p id="d694" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">简单。开始时保持简单。通常，尝试完成一个简单的任务比处理一个复杂的任务更好，原因有几个:这将有助于你进一步理解主题的基础，防止你太快感到不知所措，并帮助你在进入下一步之前建立必要的信心。最重要的是，一旦完成，它会让你体验到兴奋！至少，这是我过去几天的感觉。</p><p id="e210" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">我是一名数据科学家，在一家深度学习专业公司实习，我认为自己是一名不断学习的人(嗯，在科技领域，你必须永远是这样的人)，对我所做的事情充满好奇、热情和激情。每当我发现一个新功能、摆弄一个新工具或完成一个新项目时，我都有一种像个孩子的感觉。我知道我每周都在对工具和过程有一个很好的理解(从满是错误的屏幕中)。</p><p id="a8d3" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">今天，我想谈谈我用Flask创建的第一个机器学习web应用程序。在我写这几行的那天，我成功地在云上部署了模型(太棒了！)，尽管我不想在本文中讨论这个问题，但它可能是下一次讨论的好话题。我想重点分享如何编写几行Python代码，并让您的第一个预测模型在您的web浏览器上运行。</p><h1 id="40c3" class="jm jn hh bd jo jp jq jr js jt ju jv jw in jx io jy iq jz ir ka it kb iu kc kd bi translated">去取一些简单的数据</h1><p id="e535" class="pw-post-body-paragraph li lj hh kg b kh ki ii ll kj kk il ln kl lx lp lq kn ly ls lt kp lz lv lw kr ha bi translated">让我们遵循文章开头提到的原则。当我被分配到现在的任务时，我就是这样做的。重点不在于拥有一流的模型，而在于学会如何将该模型部署为web应用程序。我知道，当你第一次面对这个任务(作为一个初学者)时，这听起来有点吓人，我希望这些句子能帮助你完成这个任务！</p><p id="b89e" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">我去Kaggle下载了一个很小的CSV文件，其中包含几个条目，只有两个特征:多年经验和薪水。就在这里可以找到:<a class="ae ma" href="https://www.kaggle.com/karthickveerakumar/salary-data-simple-linear-regression" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/karthickveerakumar/salary-data-simple-linear-regression</a></p><h1 id="31dd" class="jm jn hh bd jo jp jq jr js jt ju jv jw in jx io jy iq jz ir ka it kb iu kc kd bi translated">构建简单的线性回归模型</h1><p id="f6d4" class="pw-post-body-paragraph li lj hh kg b kh ki ii ll kj kk il ln kl lx lp lq kn ly ls lt kp lz lv lw kr ha bi translated">首先，我们将创建一个新的Python脚本(命名为“model.py ”,以便于理解),导入相关的库，加载数据并快速可视化。</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="aaff" class="mg jn hh mc b fi mh mi l mj mk"># Import the relevant libraries<br/>import matplotlib.pyplot as plt<br/>import statsmodels.api as sm<br/>from sklearn.metrics import mean_absolute_error, mean_squared_error<br/>import pickle<br/>import numpy as np</span><span id="07cf" class="mg jn hh mc b fi ml mi l mj mk"># Load the data<br/>data = pd.read_csv('Salary_Data.csv')<br/>data</span><span id="00d0" class="mg jn hh mc b fi ml mi l mj mk"># Plot it<br/>plt.scatter(data.YearsExperience, data.Salary)<br/>plt.show()</span></pre><p id="6663" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">为了加载回归算法，在本例中我们将使用Statsmodels，不过如果您愿意，也可以使用Scikit-learn。Scikit-learn中的几个指标将会很有用，模块Pickle。是的，也许你没有听说过后者，但它在这个项目中是必不可少的。</p><p id="d393" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">然后，我们读取CSV文件并显示数据帧。最后，我们用这两个变量做一个散点图，这样你就可以快速掌握它们之间的关系。正如多年的经验和薪水所预期的那样，这是一种线性的正相关关系。一个增加，另一个也增加。</p><p id="c694" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">现在，我们将数据集分为训练集和验证集，并将特征向量分配给目标变量和解释变量(分别为Y和X)。</p><p id="ef76" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">之后，我们加载模型(OLS)，训练它，并使用验证集进行一些预测。</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="87f5" class="mg jn hh mc b fi mh mi l mj mk"># Split data into train and validation<br/>train = data[:int(0.7*len(data))]<br/>valid = data[int(0.7*len(data)):]</span><span id="904f" class="mg jn hh mc b fi ml mi l mj mk"># Assigning feature vectors to target and explanatory variable<br/>Y_train = train.Salary<br/>X_train = train.YearsExperience<br/>X_train = sm.add_constant(X_train)</span><span id="2f9c" class="mg jn hh mc b fi ml mi l mj mk">Y_valid = valid.Salary<br/>X_valid = valid.YearsExperience<br/>X_valid = sm.add_constant(X_valid)</span><span id="a382" class="mg jn hh mc b fi ml mi l mj mk"># Building a Simple Linear Regression model<br/>model = sm.OLS(Y_train, X_train)<br/>results = model.fit()<br/>results.params</span><span id="0e87" class="mg jn hh mc b fi ml mi l mj mk"># Predict with validation data<br/>predicted = results.predict(X_valid)</span></pre><p id="00e6" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">作为一个小数据集，我发现70/30是一个很好的数据分割比例。然后，在训练和验证这两个集合中，我们将<code class="du mm mn mo mc b">salary</code>特征分配给Y，将<code class="du mm mn mo mc b">years of experience</code>特征分配给X。关于Statsmodels库，这里需要注意一点:我们必须添加常数项。基本上，它向数据集添加一列1。</p><p id="a4a9" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">之后，我们有机会使用<code class="du mm mn mo mc b">.params</code>方法查看回归模型的参数，并根据验证数据进行预测。这是我们存储在<code class="du mm mn mo mc b">predicted</code>变量中的内容。</p><p id="03fb" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">我们的模型表现如何？好，我们来唱。</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="6a2f" class="mg jn hh mc b fi mh mi l mj mk"># Model performance<br/>print(f'The MAE is {mean_absolute_error(Y_valid, predicted)}')<br/>print(f'The RMSE is {np.sqrt(mean_squared_error(Y_valid, predicted))}')</span><span id="a6e1" class="mg jn hh mc b fi ml mi l mj mk"># Visualizing predictions and actual values<br/>plt.scatter(Y_valid, predicted)<br/>plt.show()</span><span id="2c46" class="mg jn hh mc b fi ml mi l mj mk"># Visualizing the model<br/>plt.scatter(X_valid.YearsExperience, Y_valid)<br/>plt.plot(X_valid.YearsExperience, predicted, color='orange')<br/>plt.show()</span></pre><p id="b791" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">我们使用两个指标来衡量模型性能，并绘制出这种衡量的可视化表示。</p><p id="b48d" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">最大可能是300000美元。53807.68638686667</p><p id="01ed" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">RMSE是第二大城市。46862 . 66866868661</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mq"><img src="../Images/999a70b66d860f650eb27b906f497779.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*SZ4apsYQLZQkA-FDmS5niw.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">实际值(蓝点)与预测值(橙线)-作者图片</figcaption></figure><p id="b3df" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">最后，我们将把我们的模型对象(一个Python对象)保存在一个二进制文件中，这就是Pickle模块发挥作用的时候。它允许我们在其他地方使用训练好的模型，比如在另一个脚本或笔记本中。在我们的例子中，我们将在应用程序中使用这个模型。它存储在一个名为“model.pkl”的文件中。</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="c379" class="mg jn hh mc b fi mh mi l mj mk">with open('model.pkl', 'wb') as f:<br/>    pickle.dump(results, f)<br/>    print('Pickling completed')</span></pre><p id="80c6" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">我们训练的模型在<code class="du mm mn mo mc b">results</code>变量中，不在<code class="du mm mn mo mc b">model</code>也不在<code class="du mm mn mo mc b">predicted</code>中。<code class="du mm mn mo mc b">model</code>变量包含我们加载的OLS模型，而<code class="du mm mn mo mc b">predicted </code>变量包含我们在验证集上运行后的预测值。</p><h1 id="8161" class="jm jn hh bd jo jp jq jr js jt ju jv jw in jx io jy iq jz ir ka it kb iu kc kd bi translated">是时候创建我们的web应用程序了</h1><p id="73da" class="pw-post-body-paragraph li lj hh kg b kh ki ii ll kj kk il ln kl lx lp lq kn ly ls lt kp lz lv lw kr ha bi translated">让我们创建一个新的Python脚本，并将其命名为“app.py”，这只是为了保持一致。除非您的机器上已经安装了Flask，否则我们必须先这样做(不要担心Pickle，因为它是Python的内置模块，您已经有了)。我还建议创建一个虚拟环境来处理这个项目，以及在其他项目中这样做，而不影响您已经安装的软件包和您运行的当前版本。这很像创造一个新的空间，用你需要的特定包来做特定的工作，或者像准备一个新房间来做一些事情，同时保持你的主工作间整洁。您可以保留它以备后用，也可以在工作完成后将其删除。</p><p id="ee5c" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">如果您正在使用Anaconda，请进入终端并运行命令<code class="du mm mn mo mc b">$ conda create -n your_env_name python flask</code>，其中<code class="du mm mn mo mc b">your_env_name</code>代表您希望使用的环境名称。这个命令也会安装Python和Flask。然后，运行<code class="du mm mn mo mc b">$ conda activate your_env_name</code>来激活环境。接下来，我运行<code class="du mm mn mo mc b">$ spyder</code>来启动IDE。显然，您可以运行您喜欢的另一个IDE或文本编辑器，甚至从那里激活环境。</p><p id="66ce" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated"><em class="mp">注意:我在Mac上，所以请搜索与Windows或Linux系统相关的文档，以防有一些差异。</em></p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="6bee" class="mg jn hh mc b fi mh mi l mj mk">from flask import Flask, request, render_template<br/>import pickle<br/> <br/># Create a Flask object<br/>app = Flask(__name__)</span><span id="24b0" class="mg jn hh mc b fi ml mi l mj mk"># Read our trained model<br/>model = pickle.load(open('model.pkl', 'rb'))</span></pre><p id="ed4e" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">我们只是导入了相关的库和模块，在<code class="du mm mn mo mc b">app</code>中创建了一个Flask对象，并将我们之前拟合的训练模型存储在变量<code class="du mm mn mo mc b">model</code>中，反序列化二进制文件(使用Pickle)。</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="ac97" class="mg jn hh mc b fi mh mi l mj mk"><a class="ae ma" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.route('/')<br/>def home():<br/>    return render_template('experienceform.html')</span><span id="05eb" class="mg jn hh mc b fi ml mi l mj mk"><a class="ae ma" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.route('/', methods=['POST'])<br/>def predict():<br/>    user_input = float(request.form['text'])<br/>    prediction = model.predict([1.0, user_input])<br/>    <br/>    output = round(prediction[0], 2)<br/>    <br/>    return str(output)</span><span id="d70f" class="mg jn hh mc b fi ml mi l mj mk">if __name__ == '__main__':<br/>    app.run(port=5000, debug=True)</span></pre><p id="49fa" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">装饰者定义了我们想要使用的路径和我们想要在每个路径中调用的函数。<code class="du mm mn mo mc b">home()</code>函数直接呈现一个非常简单的HTML表单，其中用户输入一个代表<code class="du mm mn mo mc b">years of experience</code>(我们的解释变量)的数字(整数或浮点数)。我们稍后会看到HTML文件。</p><p id="32c4" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated"><code class="du mm mn mo mc b">predict()</code>函数获取我们在表单中输入的数字，将其传递给<code class="du mm mn mo mc b">model.predict</code>，并将结果存储在一个名为<code class="du mm mn mo mc b">prediction</code>的变量中。然后，它格式化输出，从一个数组中提取预测的薪水(<code class="du mm mn mo mc b">prediction</code>包含一个数组)并四舍五入到两位小数。函数返回一个字符串是很重要的，否则它会引发一个错误。您看到的POST方法是一个HTTP方法，它允许向服务器发送请求以接受输入数据(在本例中，就是我们在表单中输入的数据)。</p><p id="df04" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">最后，我们设置<code class="du mm mn mo mc b">app.run</code>在端口5000上运行并激活调试。</p><p id="386c" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">我们需要的HTML文件包含以下内容:</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="51b6" class="mg jn hh mc b fi mh mi l mj mk">&lt;form method="POST"&gt;<br/>    &lt;input name="text"&gt;<br/>    &lt;input type="submit"&gt;<br/>&lt;/form&gt;</span></pre><p id="a825" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">使用上面的代码创建“form.html”文件，并将其保存在工作目录中名为“templates”的文件夹中。</p><h1 id="90d3" class="jm jn hh bd jo jp jq jr js jt ju jv jw in jx io jy iq jz ir ka it kb iu kc kd bi translated">运行web应用程序！</h1><p id="1481" class="pw-post-body-paragraph li lj hh kg b kh ki ii ll kj kk il ln kl lx lp lq kn ly ls lt kp lz lv lw kr ha bi translated">你保存脚本文件了吗？好吧，继续读下去，因为我会告诉你如何运行应用程序，以及如何安排目录，以使所有设置。</p><p id="3631" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">您正在工作的目录应该具有以下结构:</p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="e213" class="mg jn hh mc b fi mh mi l mj mk">Salary_Data.csv <em class="mp"># Data file from Kaggle</em><br/>model.pkl <em class="mp"># Our trained model in a binary file</em><br/>salary_model.py <em class="mp"># The regression model script</em><br/>app.py <em class="mp"># Our web app script</em><br/>templates / form.html <em class="mp"># The folder containing the HTML file</em></span></pre><p id="0e13" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">一切正常吗？很好！打开终端，导航到工作目录<code class="du mm mn mo mc b">$ cd ./your_working_directory/</code>并运行<code class="du mm mn mo mc b">$ python app.py</code>。你应该在你的终端上看到几条消息，其中一条写着“运行在<a class="ae ma" href="http://127.0.0.1:5000/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:5000/ </a>。将地址复制并粘贴到你的浏览器中……你应该会在主页上看到一个文本框和一个“发送”按钮。输入一个数字(无论你希望模型预测多少年的工资),它将返回一个数值！</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mr"><img src="../Images/2506a8e68ff966d672d768c4fe6abb70.png" data-original-src="https://miro.medium.com/v2/resize:fit:494/format:webp/1*eWnIGE240zgk9NRAL78t5g.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">在表格框中输入10-作者图片</figcaption></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ms"><img src="../Images/4054bd72e5205fa01d7cbe5b4f04bc1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*ctQqd8V38SU0yjyu7RMIjg.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">返回预测工资-按作者排序的图片</figcaption></figure><h1 id="1c5a" class="jm jn hh bd jo jp jq jr js jt ju jv jw in jx io jy iq jz ir ka it kb iu kc kd bi translated">结论</h1><p id="8d1b" class="pw-post-body-paragraph li lj hh kg b kh ki ii ll kj kk il ln kl lx lp lq kn ly ls lt kp lz lv lw kr ha bi translated">我真的希望这篇教程能引导你构建你的第一个基于机器学习的web应用程序，并正确地运行它，没有任何复杂之处。从数据到应用程序开发，一切都非常简单，容易理解(至少我希望如此)，这样你也可以在你的数据科学投资组合中拥有这个小项目。如果这也让你感到兴奋，就像我第一次运行这个应用程序时的感觉一样，我会非常高兴！作为初学者，从头开始，对事物建立牢固的理解，然后一步一步地学习更复杂的东西，这总是一个好主意。你有足够的时间，不要着急。</p><p id="501f" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">在这里，你有几个想法可以让你的工作更上一层楼:</p><ul class=""><li id="c67c" class="ke kf hh kg b kh lk kj lm kl mt kn mu kp mv kr mw kt ku kv bi translated">实现具有更多功能的模型。</li><li id="ed84" class="ke kf hh kg b kh kw kj kx kl ky kn kz kp la kr mw kt ku kv bi translated">给web app主页增加一些美感。</li><li id="d79c" class="ke kf hh kg b kh kw kj kx kl ky kn kz kp la kr mw kt ku kv bi translated">在应用程序中定义其他路径以添加更多功能。</li><li id="6f85" class="ke kf hh kg b kh kw kj kx kl ky kn kz kp la kr mw kt ku kv bi translated">测试并了解端点和API。</li><li id="9532" class="ke kf hh kg b kh kw kj kx kl ky kn kz kp la kr mw kt ku kv bi translated">在云上部署模型(例如，部署到Heroku)。</li></ul><p id="7c69" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">此外，在下面找到整个脚本，以防您遗漏了什么:</p><p id="9bbc" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated"><strong class="kg hi"> model.py </strong></p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="8f6c" class="mg jn hh mc b fi mh mi l mj mk">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import statsmodels.api as sm<br/>from sklearn.metrics import mean_absolute_error, mean_squared_error<br/>import pickle<br/>import numpy as np</span><span id="fc0d" class="mg jn hh mc b fi ml mi l mj mk">data = pd.read_csv('Salary_Data.csv')<br/>data</span><span id="479e" class="mg jn hh mc b fi ml mi l mj mk">plt.scatter(data.YearsExperience, data.Salary)<br/>plt.show()</span><span id="96eb" class="mg jn hh mc b fi ml mi l mj mk"># Split data into train and validation<br/>train = data[:int(0.7*len(data))]<br/>valid = data[int(0.7*len(data)):]</span><span id="f2c5" class="mg jn hh mc b fi ml mi l mj mk"># Assigning feature vectors to target and explanatory variable<br/>Y_train = train.Salary<br/>X_train = train.YearsExperience<br/>X_train = sm.add_constant(X_train)</span><span id="f2e1" class="mg jn hh mc b fi ml mi l mj mk">Y_valid = valid.Salary<br/>X_valid = valid.YearsExperience<br/>X_valid = sm.add_constant(X_valid)</span><span id="ec9a" class="mg jn hh mc b fi ml mi l mj mk"># Building a Simple Linear Regression model<br/>model = sm.OLS(Y_train, X_train)<br/>results = model.fit()<br/>results.params</span><span id="b0e9" class="mg jn hh mc b fi ml mi l mj mk"># Predict with validation data<br/>predicted = results.predict(X_valid)</span><span id="f3f5" class="mg jn hh mc b fi ml mi l mj mk"># Model performance<br/>print(f'The MAE is {mean_absolute_error(Y_valid, predicted)}')<br/>print(f'The RMSE is {np.sqrt(mean_squared_error(Y_valid, predicted))}')</span><span id="d0e2" class="mg jn hh mc b fi ml mi l mj mk"># Visualizing predictions and actual values<br/>plt.scatter(Y_valid, predicted)<br/>plt.show()</span><span id="2364" class="mg jn hh mc b fi ml mi l mj mk"># Visualizing the model<br/>plt.scatter(X_valid.YearsExperience, Y_valid)<br/>plt.plot(X_valid.YearsExperience, predicted, color='orange')<br/>plt.show()</span><span id="b1d8" class="mg jn hh mc b fi ml mi l mj mk">with open('model.pkl', 'wb') as f:<br/>    pickle.dump(results, f)<br/>    print('Pickling completed')</span></pre><p id="04a5" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated"><strong class="kg hi"> app.py </strong></p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="4c7b" class="mg jn hh mc b fi mh mi l mj mk">from flask import Flask, request, render_template<br/>import pickle</span><span id="23be" class="mg jn hh mc b fi ml mi l mj mk">app = Flask(__name__)<br/>model = pickle.load(open('model.pkl', 'rb'))</span><span id="4194" class="mg jn hh mc b fi ml mi l mj mk"><a class="ae ma" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.route('/')<br/>def home():<br/>    return render_template('form.html')</span><span id="db37" class="mg jn hh mc b fi ml mi l mj mk"><a class="ae ma" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.route('/', methods=['POST'])<br/>def predict():<br/>    user_input = float(request.form['text'])<br/>    prediction = model.predict([1.0, user_input])<br/>    <br/>    output = round(prediction[0], 2)<br/>    <br/>    return str(output)</span><span id="eb5f" class="mg jn hh mc b fi ml mi l mj mk">if __name__ == '__main__':<br/>    app.run(port=5000, debug=True)</span></pre><p id="f953" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated"><strong class="kg hi">form.html</strong></p><pre class="ix iy iz ja fd mb mc md me aw mf bi"><span id="9af5" class="mg jn hh mc b fi mh mi l mj mk">&lt;form method="POST"&gt;<br/>    &lt;input name="text"&gt;<br/>    &lt;input type="submit"&gt;<br/>&lt;/form&gt;</span></pre><p id="59d7" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">如果你愿意，可以点击这里<a class="ae ma" href="https://github.com/jaycee-ds/Salary_ModelDeployment_Flask" rel="noopener ugc nofollow" target="_blank">https://github.com/jaycee-ds/Salary_ModelDeployment_Flask</a>访问GitHub上的知识库页面</p></div><div class="ab cl lb lc go ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ha hb hc hd he"><p id="1ee3" class="pw-post-body-paragraph li lj hh kg b kh lk ii ll kj lm il ln kl lo lp lq kn lr ls lt kp lu lv lw kr ha bi translated">资源:</p><div class="mx my ez fb mz na"><a href="https://www.kaggle.com/karthickveerakumar/salary-data-simple-linear-regression" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab dw"><div class="nc ab nd cl cj ne"><h2 class="bd hi fi z dy nf ea eb ng ed ef hg bi translated">工资数据-简单线性回归</h2><div class="nh l"><h3 class="bd b fi z dy nf ea eb ng ed ef dx translated">机器学习A - Z</h3></div><div class="ni l"><p class="bd b fp z dy nf ea eb ng ed ef dx translated">www.kaggle.com</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no jg na"/></div></div></a></div><div class="mx my ez fb mz na"><a href="https://stackoverflow.com/questions/12277933/send-data-from-a-textbox-into-flask" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab dw"><div class="nc ab nd cl cj ne"><h2 class="bd hi fi z dy nf ea eb ng ed ef hg bi translated">将文本框中的数据发送到Flask？</h2><div class="nh l"><h3 class="bd b fi z dy nf ea eb ng ed ef dx translated">我想知道是否有一种方法可以从HTML的文本框中取出一些东西，放入flask，然后解析它…</h3></div><div class="ni l"><p class="bd b fp z dy nf ea eb ng ed ef dx translated">stackoverflow.com</p></div></div><div class="nj l"><div class="np l nl nm nn nj no jg na"/></div></div></a></div><div class="mx my ez fb mz na"><a href="https://www.statsmodels.org/stable/generated/statsmodels.regression.linear_model.OLS.html" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab dw"><div class="nc ab nd cl cj ne"><h2 class="bd hi fi z dy nf ea eb ng ed ef hg bi translated">stats models . regression . linear _ model。OLS -统计模型</h2><div class="ni l"><p class="bd b fp z dy nf ea eb ng ed ef dx translated">www.statsmodels.org</p></div></div></div></a></div></div></div>    
</body>
</html>