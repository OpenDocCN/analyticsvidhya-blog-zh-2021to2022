<html>
<head>
<title>Building Multi-Label Text Classifiers for arXiv Paper Abstract Dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为arXiv论文摘要数据集构建多标签文本分类器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/building-multi-label-text-classifiers-for-arxiv-paper-abstract-dataset-1cc5353b3e96?source=collection_archive---------6-----------------------#2021-10-04">https://medium.com/analytics-vidhya/building-multi-label-text-classifiers-for-arxiv-paper-abstract-dataset-1cc5353b3e96?source=collection_archive---------6-----------------------#2021-10-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="d736" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">改进论文提交系统</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/f69db6edb9474aacdc0419ace4762699.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mS6ZQ4IaGri-DVf1"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">安妮·斯普拉特在<a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="f98a" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">论文提交系统(<a class="ae jm" href="https://cmt3.research.microsoft.com/" rel="noopener ugc nofollow" target="_blank"> CMT </a>、<a class="ae jm" href="https://openreview.net/" rel="noopener ugc nofollow" target="_blank"> OpenReview </a>等)。)要求用户上传他们的论文标题和论文摘要，然后指定他们的论文最适合的主题领域。arXiv是一项免费分发服务，是1，950，165篇学术文章的开放访问档案，涉及<em class="kj">物理、数学、计算机科学、定量生物学、定量金融学、统计学、电气工程和系统科学以及经济学</em>等领域。多用于院士上传论文。<a class="ae jm" href="https://www.kaggle.com/spsayakpaul/arxiv-paper-abstracts" rel="noopener ugc nofollow" target="_blank"> Kaggle arXiv论文摘要数据集</a>提供了超过38000篇独特的论文标题及其摘要和主题领域。数据集是几天前上传的(截至撰写这篇博客时)，收集过程可在<a class="ae jm" href="https://github.com/soumik12345/multi-label-text-classification/blob/master/arxiv_scrape.ipynb" rel="noopener ugc nofollow" target="_blank">本笔记本</a>中找到。</p><p id="11c2" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">如果像arXiv这样的提交系统能够提供可行的主题领域建议，比如相应的论文可以与哪里最好地相关联，这将是非常有趣的。我们的任务是建立一个文本分类器模型，它可以预测给定论文摘要和标题的主题领域。</p><p id="2b7f" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">你可以从<a class="ae jm" href="https://github.com/Adeelzafar/Kaggle/blob/main/predictions-using-ml-and-dl-methods.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>或者<a class="ae jm" href="https://www.kaggle.com/adizafar/predictions-using-ml-and-dl-methods" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>下载完整的代码。</p><p id="7e3b" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">说够了，让我们开始编码吧…</p><h1 id="4a2a" class="kk kl hh bd km kn ko kp kq kr ks kt ku in kv io kw iq kx ir ky it kz iu la lb bi translated">数据争论</h1><p id="4b01" class="pw-post-body-paragraph jn jo hh jp b jq lc ii js jt ld il jv jw le jy jz ka lf kc kd ke lg kg kh ki ha bi translated">首先，让我们导入必要的库和数据集。</p><pre class="ix iy iz ja fd lh li lj lk aw ll bi"><span id="6ccb" class="lm kl hh li b fi ln lo l lp lq">import numpy as np # linear algebra<br/>import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)<br/>import seaborn as sns<br/>import ast<br/>import matplotlib.pyplot as plt<br/>import nltk<br/>from nltk.corpus import stopwords<br/>from nltk.stem.snowball import SnowballStemmer<br/>import re<br/>import sys<br/>import warnings<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.feature_extraction.text import TfidfVectorizer</span></pre></div><div class="ab cl lr ls go lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ha hb hc hd he"><pre class="lh li lj lk aw ll bi"><span id="f062" class="lm kl hh li b fi ly lz ma mb mc lo l lp lq">papers = pd.read_csv('/kaggle/input/arxiv-paper-abstracts/arxiv_data.csv')<br/>papers.head()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es md"><img src="../Images/44ff0166b30346756fd6ca8b64b7b84b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ji_J3eURy0nJHn0Jc12H1w.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图1:数据集的前五列</figcaption></figure><p id="60bf" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">标题和摘要是自变量，术语是因变量。这是一个多标签分类问题，因此术语有多个值，即cs、AI等。我们将首先删除每个术语的单引号。为此，我们将使用<strong class="jp hi">literal _ eval函数</strong>。<strong class="jp hi"> literal_eval </strong>安全地计算包含Python文本或容器显示的表达式节点或字符串。</p><pre class="ix iy iz ja fd lh li lj lk aw ll bi"><span id="1aee" class="lm kl hh li b fi ln lo l lp lq">description_category = papers[['terms','summaries','titles']]<br/>description_category['terms'] = description_category['terms'].apply(lambda x: ast.literal_eval(x))<br/>#description_category['terms'] =  description_category['terms'].apply(lambda x: re.sub(r'([^)]*)', '',x)<br/>description_category.head()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es me"><img src="../Images/abfb314b348d4e6fdd2c6f443a617855.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CUP_bo2v5Hi1kGMBzL7YHA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图2:数据集视图</figcaption></figure><p id="67ee" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">经过初步探索，我们得出结论，在我们的数据集中有11个标签/术语。我们将把每个标签转换成一个单独的列。</p><pre class="ix iy iz ja fd lh li lj lk aw ll bi"><span id="8015" class="lm kl hh li b fi ln lo l lp lq">columns = ['category_1', 'category_2', 'category_3',<br/>          'category_4', 'category_5', 'category_6',<br/>          'category_7', 'category_8', 'category_9',<br/>          'category_10', 'category_11']<br/>cat = pd.DataFrame(description_category['terms'].to_list(), columns = columns)<br/>cat</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mf"><img src="../Images/be8bfa4f39c23cbd5bf8b5ef91615596.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PfYpt9vq2Ch9DD3ry_Gdyw.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图3:将标签转换成列</figcaption></figure><p id="9da6" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">现在让我们将这些值转换成数值。我们将为所有无值插入0，为所有标签插入1。</p><pre class="ix iy iz ja fd lh li lj lk aw ll bi"><span id="b6b5" class="lm kl hh li b fi ln lo l lp lq">category_1_genres = cat.category_1.unique()<br/>category_2_genres = cat.category_2.unique()<br/>category_3_genres = cat.category_3.unique()<br/>category_4_genres = cat.category_4.unique()<br/>category_5_genres = cat.category_5.unique()<br/>category_6_genres = cat.category_6.unique()<br/>category_7_genres = cat.category_7.unique()<br/>category_8_genres = cat.category_8.unique()<br/>category_9_genres = cat.category_9.unique()<br/>category_10_genres = cat.category_10.unique()<br/>category_11_genres = cat.category_11.unique()<br/><br/><br/>genres = np.concatenate([category_1_genres, category_2_genres, category_3_genres,<br/>                         category_4_genres, category_5_genres, category_6_genres,<br/>                         category_7_genres, category_8_genres, category_9_genres,<br/>                         category_10_genres, category_11_genres<br/>                        ])<br/>genres = list(dict.fromkeys(genres))<br/>genres = [x for x in genres if x is not None]<br/><br/>cat = pd.concat([cat,pd.DataFrame(columns = list(genres))])<br/>cat.fillna(0, inplace = True)<br/>cat.head()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mg"><img src="../Images/95cbe785fa1dfa6a0d69fe84624f2b98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uc8uMGSRvhL2wGZUtDH5Vw.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图4:标签转换为零</figcaption></figure><p id="4ea5" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">下面的代码应该为所有类别/标签。你可以从<a class="ae jm" href="https://github.com/Adeelzafar/Kaggle/blob/main/predictions-using-ml-and-dl-methods.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>或者<a class="ae jm" href="https://www.kaggle.com/adizafar/predictions-using-ml-and-dl-methods" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>下载完整的代码。</p><pre class="ix iy iz ja fd lh li lj lk aw ll bi"><span id="a6a1" class="lm kl hh li b fi ln lo l lp lq">row = 0<br/>for genre in cat['category_1']:<br/>    if genre != 0:<br/>        cat.loc[row, genre] = 1<br/>    row = row + 1</span></pre></div><div class="ab cl lr ls go lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ha hb hc hd he"><pre class="lh li lj lk aw ll bi"><span id="64dd" class="lm kl hh li b fi ly lz ma mb mc lo l lp lq">description_category_new = pd.concat([description_category['titles'],description_category['summaries'],  <br/>                                     cat.loc[:,"cs.CV":]],<br/>                                    axis=1)<br/>description_category_new.head()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mh"><img src="../Images/0ac175a5c081de755de761f0b6b86880.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ar5buFYOf2VcT7dcB9SBQQ.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图5:转换为零和一的标签</figcaption></figure><h1 id="2df9" class="kk kl hh bd km kn ko kp kq kr ks kt ku in kv io kw iq kx ir ky it kz iu la lb bi translated">数据可视化</h1><p id="b269" class="pw-post-body-paragraph jn jo hh jp b jq lc ii js jt ld il jv jw le jy jz ka lf kc kd ke lg kg kh ki ha bi translated">在最初的数据争论之后，我们继续进行数据可视化。</p><pre class="ix iy iz ja fd lh li lj lk aw ll bi"><span id="33e1" class="lm kl hh li b fi ln lo l lp lq">bar_plot = pd.DataFrame()<br/>bar_plot['cat'] = description_category_new.columns[2:]<br/>bar_plot['count'] = description_category_new.iloc[:,2:].sum().values<br/>bar_plot.sort_values(['count'], inplace=True, ascending=False)<br/>bar_plot.reset_index(inplace=True, drop=True)<br/>bar_plot.head()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mi"><img src="../Images/dcd06a75a6b6633b66727c928afdc4d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:380/format:webp/1*vn9h3YNyCLHzOdhEpYdsxQ.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图6:类别与计数</figcaption></figure><pre class="ix iy iz ja fd lh li lj lk aw ll bi"><span id="0836" class="lm kl hh li b fi ln lo l lp lq">threshold = 1000<br/>main_categories = pd.DataFrame()<br/>main_categories = bar_plot[bar_plot['count']&gt;1000]<br/>categories = main_categories['cat'].values<br/>categories = np.append(categories,'Others')<br/>not_category = []<br/>description_category_new['Others'] = 0<br/><br/>for i in description_category_new.columns[2:]:<br/>    if i not in categories:<br/>        description_category_new['Others'][description_category_new[i] == 1] = 1<br/>        not_category.append(i)<br/><br/>description_category_new.drop(not_category, axis=1, inplace=True)</span></pre><p id="6bb5" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我们将保留前四个类别或标签，并将所有其他标签放在<strong class="jp hi"> <em class="kj">其他</em> </strong>计数中。</p><pre class="ix iy iz ja fd lh li lj lk aw ll bi"><span id="f6fd" class="lm kl hh li b fi ln lo l lp lq">most_common_cat = pd.DataFrame()<br/>most_common_cat['cat'] = description_category_new.columns[2:]<br/>most_common_cat['count'] = description_category_new.iloc[:,2:].sum().values<br/>most_common_cat.sort_values(['count'], inplace=True, ascending=False)<br/>most_common_cat.reset_index(inplace=True, drop=True)<br/>most_common_cat.head()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mj"><img src="../Images/1f0b0fbb53adc462104506893f1aab94.png" data-original-src="https://miro.medium.com/v2/resize:fit:368/format:webp/1*dNQOnYhxLVWHPZrhJnu7Yw.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图7:类别与计数</figcaption></figure><pre class="ix iy iz ja fd lh li lj lk aw ll bi"><span id="5869" class="lm kl hh li b fi ln lo l lp lq">plt.figure(figsize=(15,8))<br/>sns.set(font_scale = 1.5)<br/>sns.set_style('whitegrid') <br/><br/><br/>pal = sns.color_palette("Blues_r", len(most_common_cat))<br/>rank = most_common_cat['count'].argsort().argsort()  <br/><br/>sns.barplot(most_common_cat['cat'], most_common_cat['count'], palette=np.array(pal[::-1])[rank])<br/>plt.axhline(threshold, ls='--', c='red')<br/>plt.title("Most commons categories", fontsize=24)<br/>plt.ylabel('Number of papers', fontsize=18)<br/>plt.xlabel('terms', fontsize=18)<br/>plt.xticks(rotation='vertical')<br/><br/>plt.show()</span></pre><p id="ed24" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">该图显示了最常见的论文类别以及论文数量。我们可以看到cs。CV在类别中占主导地位。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mk"><img src="../Images/fd74dcd3cfd405721f3601b08e7c9831.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RU44aKULQzZZTUBV.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图8:最常见的类别</figcaption></figure><pre class="ix iy iz ja fd lh li lj lk aw ll bi"><span id="e89c" class="lm kl hh li b fi ln lo l lp lq">rowSums = description_category_new.iloc[:,2:].sum(axis=1)<br/>multiLabel_counts = rowSums.value_counts()<br/>sns.set(font_scale = 1.5)<br/>sns.set_style('whitegrid') <br/>plt.figure(figsize=(10,6))<br/><br/>sns.barplot(multiLabel_counts.index, multiLabel_counts.values)<br/>plt.title("Number of terms per paper", fontsize=24)<br/>plt.ylabel('Number of terms', fontsize=18)<br/>plt.xlabel('Number of categories', fontsize=18)<br/><br/>plt.show()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ml"><img src="../Images/49298abb14be5c478f6f3fef579638f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/0*DIgbc3jbOOiYWPL0.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图9:每篇论文的术语数量</figcaption></figure><h1 id="70d8" class="kk kl hh bd km kn ko kp kq kr ks kt ku in kv io kw iq kx ir ky it kz iu la lb bi translated">数据预处理</h1><p id="f96d" class="pw-post-body-paragraph jn jo hh jp b jq lc ii js jt ld il jv jw le jy jz ka lf kc kd ke lg kg kh ki ha bi translated">在这一步中，我们将把摘要/摘要转换成小写字母，删除其中的停用词，并进一步对它们进行词干处理。每个函数的细节可以在完整代码部分找到。</p><pre class="ix iy iz ja fd lh li lj lk aw ll bi"><span id="f222" class="lm kl hh li b fi ln lo l lp lq">description_category_new['summaries'] = description_category_new['summaries'].str.lower()<br/>description_category_new['summaries'] = description_category_new['summaries'].apply(decontract)<br/>description_category_new['summaries'] = description_category_new['summaries'].apply(cleanPunc)<br/>description_category_new['summaries'] = description_category_new['summaries'].apply(keepAlpha)<br/>description_category_new['summaries'] = description_category_new['summaries'].apply(removeStopWords)<br/>description_category_new['summaries'] = description_category_new['summaries'].apply(stemming)<br/>description_category_new.head()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mm"><img src="../Images/f30ee40a51c3f10b515e9bf075b671f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NaNBKmqvjal7YthsOLMuaw.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图10:数据集视图</figcaption></figure><h1 id="a219" class="kk kl hh bd km kn ko kp kq kr ks kt ku in kv io kw iq kx ir ky it kz iu la lb bi translated"><strong class="ak">深度学习模型</strong></h1><p id="db69" class="pw-post-body-paragraph jn jo hh jp b jq lc ii js jt ld il jv jw le jy jz ka lf kc kd ke lg kg kh ki ha bi translated">我们现在将应用基本的深度学习模型。机器学习部分不在本博客讨论。不过在<a class="ae jm" href="https://github.com/Adeelzafar/Kaggle/blob/main/predictions-using-ml-and-dl-methods.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>或者<a class="ae jm" href="https://www.kaggle.com/adizafar/predictions-using-ml-and-dl-methods" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上传的完整代码中可以看到。</p><pre class="ix iy iz ja fd lh li lj lk aw ll bi"><span id="afdc" class="lm kl hh li b fi ln lo l lp lq">from tensorflow.keras.preprocessing.text import Tokenizer<br/>from tensorflow.keras.preprocessing.sequence import pad_sequences<br/><br/>tokenizer = Tokenizer(num_words=5000, lower=True)<br/>tokenizer.fit_on_texts(description_category_new['summaries'])<br/>sequences = tokenizer.texts_to_sequences(description_category_new['summaries'])<br/>x = pad_sequences(sequences, maxlen=200)<br/></span></pre><p id="7fb2" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">在导入深度学习所需的库并标记我们的抽象之后。我们将把数据分成训练集和测试集。</p><pre class="ix iy iz ja fd lh li lj lk aw ll bi"><span id="7717" class="lm kl hh li b fi ln lo l lp lq">X_train, X_test, y_train, y_test = train_test_split(x, <br/>                                                    description_category_new[description_category_new.columns[2:]], <br/>                                                    test_size=0.3, <br/>                                                    random_state=seeds[4])</span></pre><p id="06e6" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我们应用了一个基本的深度神经网络模型和一个卷积神经网络模型。下表列出了AUC和验证准确性。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mn"><img src="../Images/704a9d6ead44a054f3eb7910b65b1427.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eupRxNPXfZ4oEGbNrxLOIQ.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">图11: AUC和验证准确性</figcaption></figure><p id="0162" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">最初的结果是相当压倒性的。这个数据集在几天前刚刚上传(在我写这篇博客的时候)，为学习NLP技能提供了一个很好的机会。</p><p id="5a43" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我希望你能从这篇博客中学到一些有价值的东西。<br/>下次见，编码快乐…</p></div></div>    
</body>
</html>