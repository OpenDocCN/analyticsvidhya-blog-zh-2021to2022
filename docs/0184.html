<html>
<head>
<title>How not to Finetune GPT-2 ( on Google Colab )</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何不微调GPT-2(在谷歌实验室)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-not-to-finetune-gpt-2-on-google-colab-f782cdbe0f0a?source=collection_archive---------13-----------------------#2021-01-07">https://medium.com/analytics-vidhya/how-not-to-finetune-gpt-2-on-google-colab-f782cdbe0f0a?source=collection_archive---------13-----------------------#2021-01-07</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="58ed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2021年1月6日</p><p id="2ceb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">再次大家好，我在这里的最后一个帖子是GPT-2的简单入门指南，我正在寻找微调该模型的方法，以创建自定义的东西。我目前正在上一门名为“语义网”的课，它的内容对我来说感觉很小众，然而由于讲座的范围在某些方面有点抽象，我有时很难理解概念。</p><p id="a645" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于GPT模型“神奇地”工作得很好，:D，我想也许我可以抛出15000行从一些主要网站收集的关于语义网和语义网概念的原始文本，它可以帮助我理解一些基础知识，同时指导我回答简单的语义网相关问题。嗯，嗯，嗯…它没有…:)</p><p id="8628" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我的意思是，这并不奇怪，这可能不是你应该如何微调一个模型，因为我是一个完全的新手，我说为什么不。</p><p id="9483" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，这种体验还不错，我可以帮助你只在谷歌实验室上微调GPT-2，所以如果你不像我一样使用它，你可能会得到更好的结果作为回报。让我们开始吧。</p><p id="393c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" href="https://github.com/eren23/gpt2-colab-finetune/blob/main/gpt2_finetune.ipynb" rel="noopener ugc nofollow" target="_blank">示例代码</a>在此，但<a class="ae jc" href="https://github.com/nshepperd/gpt-2" rel="noopener ugc nofollow" target="_blank"> Github </a>和<a class="ae jc" rel="noopener" href="/ai-innovation/beginners-guide-to-retrain-gpt-2-117m-to-generate-custom-text-content-8bb5363d8b7f"> Medium </a>上这两个回购的所有信用。这种过程真的很难，在这两个回购的帮助下，这就像是一个阳光明媚的周日下午:)</p><p id="a03c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上一个教程完全是为了收集所有的图片和材料，我会把它们放在一张图片上，然后把结果放在另一张上。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/35ddddd96894774bb0049c57000b7539.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*y1AR9jybZoj-7r1H.png"/></div></div></figure><p id="4c3d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第一步，我们需要安装GPT-2和一些额外的库，以便更容易微调。下一步是安装TensorFlow，我无法找到一个像样的GPU版本，可以很好地与这个模型一起工作，所以这是我们使用的。</p><p id="9fb8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">之后，我们可以定位到gpt-2文件夹并运行需求安装命令。它应该工作得很顺利。在那之后，我们可以安全地下载我们的模型了，但是未来的改变将会在内部进行。</p><p id="3176" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这一点上，由于使用bash over colab是相当痛苦的，我们将使用files部分来进行安排。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jp"><img src="../Images/853c230419b7a55c1be240fccc65a9f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/0*KjZbag84ZbgRT9Ga.png"/></div></figure><p id="235c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们应该将“encode.py”、“train.py”和“train-horovod.py”从gpt-2主文件夹移动到/src文件夹。我们最新版本的文件夹结构已经在上面给出了。</p><p id="94b4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在运行优化模型之前，控制台上的最后2个步骤是对我们选择的文本进行编码，并训练新模型。为此，我们首先定位到/src文件夹，然后运行上面第一张图中的命令。在50次迭代之后，我停止了我的模型，因为，老实说，从一开始它就不那么有希望了，因为我知道我用什么来喂养模型:)</p><p id="c7a6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我们停止代码后，最后一步将是通过替换模型文件进行文件夹排列，我们可以改为复制模型并更改名称来保存前一个。调整后的模型位于/src/checkpoint/run1文件夹中，我们可以将所有内容复制并粘贴到/src/model/117M文件夹中。我把旧模型和检查点文件从旧模型中移走，并把它们保存在新模型的文件夹中，这完全没有必要。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jq"><img src="../Images/e3e55461e914057e329e5cc93bb9acf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/0*DAYYowW1Gyzmjua2.png"/></div></figure><p id="46a1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这大概就是我们的文件夹结构应该看起来的样子。</p><p id="9a65" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们可以安全地运行我们的交互式运行代码，看看会发生什么。我们可以创建一个新的单元来运行下面的命令。</p><p id="0473" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上一个教程我用的是Kora但是Kora和builtin都有！colab上的bash命令不知何故找不到我们的模型，切换背后的原因是。</p><p id="749d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我会在下面留下一些结果，这样你就可以看到当你用garbage :D对一个模型进行微调时会有什么样的结果。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jw"><img src="../Images/5ab438000ab451d10fa53401550d74a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qc-eV09m_9nLVjmN.png"/></div></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jx"><img src="../Images/54be78341cf2b977aefbec94a0b16880.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*my962G-2s2AeA8Uv.png"/></div></div></figure><p id="ae44" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">实际上，当看最后一个时，你会感觉到它开始理解正在发生的事情，但是特别是数据收集部分仍然是处理这种问题时要解决的最大问题。其实大多数情况下，都是ML相关的问题。</p><p id="a8ac" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">谢谢你陪我走了这么远，我们下次再见。:)</p></div><div class="ab cl jy jz go ka" role="separator"><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd ke"/><span class="kb bw bk kc kd"/></div><div class="ha hb hc hd he"><p id="49e4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jv">最初发表于</em><a class="ae jc" href="https://blog.akbuluteren.com/blog/how-not-to-finetune-gpt2" rel="noopener ugc nofollow" target="_blank"><em class="jv"/></a><em class="jv">。</em></p></div></div>    
</body>
</html>