<html>
<head>
<title>Random Forest Classifier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">éšæœºæ£®æ—åˆ†ç±»å™¨</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/random-forest-classifier-d8666aa34a55?source=collection_archive---------21-----------------------#2021-02-08">https://medium.com/analytics-vidhya/random-forest-classifier-d8666aa34a55?source=collection_archive---------21-----------------------#2021-02-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/12bf8b56a000c96a23da4877dc9566dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*R5zylsU8gVg2wAh5"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">æ£®æ—|ç…§ç‰‡ç”±<a class="ae it" href="https://unsplash.com/@jaymantri?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">æ°ä¼ŠÂ·æ›¼ç‰¹é‡Œ</a>åœ¨<a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</figcaption></figure><p id="b0ae" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æœ¬è¯¾ä½¿ç”¨çš„ç¬”è®°æœ¬:<a class="ae it" href="https://www.kaggle.com/tanishsawant2002/random-forest-classifier" rel="noopener ugc nofollow" target="_blank">ç‚¹å‡»æ­¤å¤„</a>(å¦‚æœä½ å–œæ¬¢ï¼Œè¯·æŠ•èµæˆç¥¨ğŸ˜‰)</p><blockquote class="js jt ju"><p id="58a1" class="iu iv jv iw b ix iy iz ja jb jc jd je jw jg jh ji jx jk jl jm jy jo jp jq jr ha bi translated">éšæœºæ£®æ—æ˜¯ä¸€ç§å…ƒä¼°è®¡å™¨ï¼Œå®ƒåœ¨æ•°æ®é›†çš„å„ä¸ªå­æ ·æœ¬ä¸Šæ‹Ÿåˆå¤šä¸ªå†³ç­–æ ‘åˆ†ç±»å™¨ï¼Œå¹¶ä½¿ç”¨å¹³å‡æ¥æé«˜é¢„æµ‹ç²¾åº¦å’Œæ§åˆ¶è¿‡æ‹Ÿåˆã€‚å¦‚æœ<code class="du jz ka kb kc b">bootstrap=True</code>(é»˜è®¤)ï¼Œå­æ ·æœ¬å¤§å°ç”±<code class="du jz ka kb kc b">max_samples</code>å‚æ•°æ§åˆ¶ï¼Œå¦åˆ™ä½¿ç”¨æ•´ä¸ªæ•°æ®é›†æ„å»ºæ¯æ£µæ ‘ã€‚~ <a class="ae it" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html" rel="noopener ugc nofollow" target="_blank"> sklearnæ–‡æ¡£</a></p></blockquote><p id="a9c3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä¸Šé¢çš„å®šä¹‰å¾ˆè´¹è§£ï¼Œæˆ‘ä»¬æ¥åˆ†è§£ä¸€ä¸‹ã€‚</p><p id="2ee2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæœ‰ä¸€ä¸ªæ¦‚å¿µå«åšå†³ç­–æ ‘ã€‚é€šè¿‡åŸºäºå±æ€§å€¼æµ‹è¯•å°†æºé›†åˆåˆ†å‰²æˆå­é›†ï¼Œå¯ä»¥<em class="jv">â€œå­¦ä¹ â€</em>ä¸€ä¸ªæ ‘ã€‚è¿™ä¸ªè¿‡ç¨‹ä»¥ä¸€ç§ç§°ä¸º<em class="jv">é€’å½’åˆ†å‰²</em>çš„é€’å½’æ–¹å¼åœ¨æ¯ä¸ªæ´¾ç”Ÿå­é›†ä¸Šé‡å¤ã€‚å½“æ‹†åˆ†æ²¡æœ‰ç»™é¢„æµ‹å¢åŠ ä»»ä½•å€¼æ—¶ï¼Œé€’å½’åœæ­¢ã€‚</p><p id="134c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è¿˜æœ‰â€¦..æ£®æ—æ˜¯æ ‘æœ¨çš„é›†åˆä½“ã€‚æ‰€ä»¥éšæœºæ£®æ—ç®—æ³•åŒ…å«äº†å¤§é‡çš„å†³ç­–æ ‘ã€‚å®ƒæ—¢å¯ä»¥ç”¨äºåˆ†ç±»ï¼Œä¹Ÿå¯ä»¥ç”¨äºå›å½’ã€‚è¿™ä¹Ÿæ˜¯æœ€çµæ´»å’Œæœ€å®¹æ˜“ä½¿ç”¨çš„ç®—æ³•ã€‚</p><p id="e6c7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">éšæœºæ£®æ—æœ‰å¤šç§åº”ç”¨ï¼Œä¾‹å¦‚æ¨èå¼•æ“ã€å›¾åƒåˆ†ç±»å’Œç‰¹å¾é€‰æ‹©ã€‚å®ƒå¯ä»¥ç”¨æ¥å¯¹å¿ è¯šçš„è´·æ¬¾ç”³è¯·äººè¿›è¡Œåˆ†ç±»ï¼Œè¯†åˆ«æ¬ºè¯ˆæ´»åŠ¨å’Œé¢„æµ‹ç–¾ç—…ã€‚</p><blockquote class="js jt ju"><p id="8409" class="iu iv jv iw b ix iy iz ja jb jc jd je jw jg jh ji jx jk jl jm jy jo jp jq jr ha bi translated">åœ¨è¿™èŠ‚è¯¾ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¾³å¤§åˆ©äºšæ•°æ®é›†ä¸­<a class="ae it" href="https://www.kaggle.com/#" rel="noopener ugc nofollow" target="_blank"> Kaggleçš„</a> <a class="ae it" href="https://www.kaggle.com/jsphyg/weather-dataset-rattle-package" rel="noopener ugc nofollow" target="_blank"> Rainã€‚</a></p></blockquote><p id="a9e7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">é¦–å…ˆæ˜¯åˆ†ç±»é—®é¢˜ã€‚å› æ­¤æˆ‘ä»¬å¿…é¡»ä½¿ç”¨<a class="ae it" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html" rel="noopener ugc nofollow" target="_blank"> RandomForestClassifier </a>æ¥è¾¾åˆ°è¿™ä¸ªç›®çš„ã€‚</p><p id="3896" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨æ­¤ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å¯¹æ•°æ®è¿›è¡Œä¸€äº›æ¸…ç†å’Œé¢„å¤„ç†ã€‚</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="a335" class="kl km hh kc b fi kn ko l kp kq">import numpy as np <em class="jv"># linear algebra</em><br/>import pandas as pd <em class="jv"># data processing, CSV file I/O (e.g. pd.read_csv)</em><br/><br/><em class="jv"># Input data files are available in the read-only "../input/" directory</em><br/><em class="jv"># For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory</em><br/><br/>import os<br/>for dirname, _, filenames <strong class="kc hi">in</strong> os.walk('/kaggle/input'):<br/>    for filename <strong class="kc hi">in</strong> filenames:<br/>        print(os.path.join(dirname, filename))<br/><br/><em class="jv"># You can write up to 20GB to the current directory (/kaggle/working/) that gets preserved as output when you create a version using "Save &amp; Run All" </em><br/><em class="jv"># You can also write temporary files to /kaggle/temp/, but they won't be saved outside of the current session<br/></em></span></pre><figure class="kd ke kf kg fd ii er es paragraph-image"><div class="er es kr"><img src="../Images/128575d2343dd8f7fc78a11761820ad9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*SVko32ngi0NSMN7h-WY4Gw.png"/></div></figure><p id="4d2a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è¿™å°†è¾“å‡ºæ•°æ®çš„ç›®å½•ã€‚</p><p id="6f91" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è®©æˆ‘ä»¬æŠŠè¿™äº›æ•°æ®è½¬æ¢æˆç†ŠçŒ«çš„æ•°æ®æ¡†æ¶ã€‚</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="6f96" class="kl km hh kc b fi kn ko l kp kq">df = pd.read_csv("/kaggle/input/weather-dataset-rattle-package/weatherAUS.csv")</span><span id="a854" class="kl km hh kc b fi ks ko l kp kq">df.head()</span></pre><figure class="kd ke kf kg fd ii er es paragraph-image"><div class="er es kr"><img src="../Images/dcb79398b33d8cbc47c6c0b9b37a3c80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*O0GGJyEFzlB62SHTLRKGQg.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">è¾“å‡º</figcaption></figure><p id="8fba" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åˆ«å¿˜äº†ï¼Œæˆ‘æ€»æ˜¯æŠŠæ•°æ®æ¡†çš„æ‰€æœ‰æ ç›®åˆ—æˆä¸€ä¸ªæ¸…å•ï¼Œä»¥åï¼Œå®ƒè‚¯å®šä¼šæ´¾ä¸Šç”¨åœºã€‚</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="7507" class="kl km hh kc b fi kn ko l kp kq">cols = list(df.columns)<br/>cols</span></pre><figure class="kd ke kf kg fd ii er es paragraph-image"><div class="er es kt"><img src="../Images/e0b38fe60bc80dcf3d203ed5e5d9b0fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*PM292e96-cWqZK5pnDYB2g.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">åˆ—åˆ—è¡¨</figcaption></figure><p id="e5b0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æè¿°è¡¨æ ¼:</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="cc2f" class="kl km hh kc b fi kn ko l kp kq">df.describe().T<br/></span></pre><figure class="kd ke kf kg fd ii er es paragraph-image"><div class="er es ku"><img src="../Images/162a5f19bd4f55f1f63751cd7ad444a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*uPSNj_ikEVJOrE1BDgVV4A.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">è‚¯å®šæ²¡å¿…è¦æ‹¿è½¬ç½®ï¼Œä½†æ˜¯å¥½çœ‹ã€‚</figcaption></figure><p id="556f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è¿™ä¸ªdescribe()æ–¹æ³•ç¡®å®æœ‰åŠ©äºè§£ææ•°æ®åº“çš„æ•°å­—æ•°æ®ã€‚</p><p id="9e0c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è®©æˆ‘ä»¬å¯¼å…¥ä¸€äº›åº“æ¥å¯è§†åŒ–æ•°æ®ã€‚</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="093e" class="kl km hh kc b fi kn ko l kp kq">import matplotlib.pyplot as plt<br/>import seaborn as sns</span></pre><p id="211a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ç°åœ¨åˆ°äº†ä¸€ä¸ªé‡è¦çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¿…é¡»æ£€æŸ¥ç‰¹å¾ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œå»æ‰é‚£äº›é«˜åº¦ç›¸å…³çš„ç‰¹å¾ã€‚</p><p id="5adb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆèšé›†ç‰¹å¾ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ†ç¦»ç›®æ ‡åˆ—(RainTomorrow)æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚)</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="959c" class="kl km hh kc b fi kn ko l kp kq">X = df.drop('RainTomorrow', axis=1)<br/>X.head()</span></pre><figure class="kd ke kf kg fd ii er es paragraph-image"><div class="er es kv"><img src="../Images/a311979ad2e8a63b0af93c7dcc6c510a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*f7YYZYUIpdJDkQhOcO5-8w.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">X</figcaption></figure><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="5620" class="kl km hh kc b fi kn ko l kp kq">y = df[["RainTomorrow"]]<br/>y.head()<br/></span></pre><figure class="kd ke kf kg fd ii er es paragraph-image"><div class="er es kw"><img src="../Images/37a7d8d59b2ac1354895cb34e915fb18.png" data-original-src="https://miro.medium.com/v2/resize:fit:250/format:webp/1*1bVopGl5IwM7IJse4YO0yA.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">Y</figcaption></figure><p id="85c6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æˆ‘ä»¬å‡†å¤‡å¥½æ£€æŸ¥ç›¸å…³æ€§äº†ã€‚å°†ç›¸å…³æ€§å¯è§†åŒ–çš„æœ€ä½³å·¥å…·æ˜¯Seabornçš„çƒ­å›¾ã€‚</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="c595" class="kl km hh kc b fi kn ko l kp kq">plt.figure(figsize=(20,20))<br/>sns.heatmap(X.corr())<br/>plt.show()<br/></span></pre><figure class="kd ke kf kg fd ii er es paragraph-image"><div class="er es kx"><img src="../Images/43acb8bed6aeb1f187c89d10fe7296b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*heDqNPLug9pRwl_aPUwPIQ.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">ä½ å¯ä»¥çœ‹åˆ°è¿™æ ·çš„çƒ­å›¾ã€‚</figcaption></figure><p id="44a1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å¯¹è§’çº¿æ˜¾ç„¶æ˜¯è¦å…³è”çš„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ·±è‰²æ–¹å—ä»£è¡¨æˆ‘ä»¬æƒ³è¦çš„è¾ƒå°ç›¸å…³æ€§ã€‚</p><p id="e084" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå¾ˆæ˜æ˜¾æœ‰äº›ç‰¹å¾æ˜¯ç»å¯¹ç›¸å…³çš„ã€‚è®©æˆ‘ä»¬æ”¾å¼ƒä»–ä»¬ã€‚</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="346b" class="kl km hh kc b fi kn ko l kp kq">cor_matrix = df.corr().abs()<br/>print(cor_matrix)</span></pre><figure class="kd ke kf kg fd ii er es paragraph-image"><div class="er es kv"><img src="../Images/d602ca9d409ffbf09b6397cdf66e6a8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*G3urxnb-jugv3kIRTPNZaQ.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">ç›¸å…³çŸ©é˜µ</figcaption></figure><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="c6f5" class="kl km hh kc b fi kn ko l kp kq">upper_tri = cor_matrix.where(np.triu(np.ones(cor_matrix.shape),k=1).astype(np.bool))<br/>print(upper_tri)</span></pre><figure class="kd ke kf kg fd ii er es paragraph-image"><div class="er es ky"><img src="../Images/b7c98c0bcb2e2da4b31f98e27a7f7fa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*sh2o1K5pql-FX2cUen1rDA.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">ä¸Šä¸‰è§’çŸ©é˜µã€‚</figcaption></figure><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="a661" class="kl km hh kc b fi kn ko l kp kq">to_drop = [column for column <strong class="kc hi">in</strong> upper_tri.columns if any(upper_tri[column] &gt; 0.95)]<br/>print(); print(to_drop)<br/></span></pre><figure class="kd ke kf kg fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/2d516a5fda3a7445a27d41ff584db676.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*l29cHHXaKjczW18prYTOUw.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">å–”å–”å–”ï¼ï¼æˆ‘ä»¬å¾—åˆ°äº†å¤šä½™çš„åŠŸèƒ½ï¼</figcaption></figure><p id="2503" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å¥½å§â€¦..ä»£ç å¤ªå¤šäº†ã€‚æˆ‘ä»¬æ‰€åšçš„æ˜¯éå¸¸æœ‰è¯´æœåŠ›çš„ï¼Œé¦–å…ˆï¼Œç›¸å…³çŸ©é˜µè¢«åˆ›å»ºï¼Œç„¶åå®ƒè¢«è½¬æ¢æˆä¸Šä¸‰è§’çŸ©é˜µã€‚ä»ä¸Šé¢è®­ç»ƒçŸ©é˜µä¸­ï¼Œæˆ‘ä»¬é€‰æ‹©æŒ‡æ•°å¤§äº0.95çš„ç‰¹å¾ã€‚</p><h1 id="a0cf" class="la km hh bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">æœ‰ä¸€ä»¶äº‹æ²¡æœ‰è¢«æ³¨æ„åˆ°ï¼</h1><p id="6426" class="pw-post-body-paragraph iu iv hh iw b ix lx iz ja jb ly jd je jf lz jh ji jj ma jl jm jn mb jp jq jr ha bi translated">æ—¥æœŸå’Œä½ç½®æ å¯¹äºç¡®å®šæ˜å¤©æ˜¯å¦ä¼šä¸‹é›¨ä¹Ÿæ²¡æœ‰å¤šå¤§å¸®åŠ©ã€‚(æŠŠå®ƒä»¬ä¹Ÿæ‰”æ‰)ã€‚</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="c133" class="kl km hh kc b fi kn ko l kp kq">df = df.drop(['Pressure3pm', 'Temp3pm', 'Date', 'Location'], axis=1)<br/>print(df.head())</span></pre><p id="e303" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æˆ‘ä»¬å°±è¦åšå‡ºæˆ‘ä»¬çš„æ¨¡å‹äº†ï¼</p><p id="026b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨è§£å†³åˆ†ç±»é—®é¢˜æ—¶è¦è®°ä½çš„ä¸€ç‚¹æ˜¯ï¼Œ</p><p id="34fb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æˆ‘ä»¬éœ€è¦é¢„å¤„ç†æˆ‘ä»¬çš„æ•°æ®ï¼Œä»¥ä¾¿ç®—æ³•å¯ä»¥æœ‰æ•ˆåœ°é¢„æµ‹å€¼ã€‚åˆ†ç±»å˜é‡å¿…é¡»è½¬æ¢æˆæŒ‡ç¤ºå˜é‡ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨pandasçš„get_dummies() æ–¹æ³•ã€‚</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="607a" class="kl km hh kc b fi kn ko l kp kq">ohe = pd.get_dummies(data=df, columns=['WindGustDir','WindDir9am','WindDir3pm'])<br/>ohe.info()</span></pre><figure class="kd ke kf kg fd ii er es paragraph-image"><div class="er es mc"><img src="../Images/793719b3ae96770f817567001a67630d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*cNAB8TNl2DZxVNiQ0j-VeQ.png"/></div></figure><p id="4ccd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æˆ‘ä»¬ç¼ºå°‘æ›´å¤šçš„é¢„å¤„ç†â€¦..</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="68cc" class="kl km hh kc b fi kn ko l kp kq">from sklearn import preprocessing<br/>from numpy import array<br/><br/>ohe['RainToday'] = df['RainToday'].astype(str)<br/>ohe['RainTomorrow'] = df['RainTomorrow'].astype(str)<br/><br/>lb = preprocessing.LabelBinarizer()<br/><br/>ohe['RainToday'] = lb.fit_transform(ohe['RainToday'])<br/>ohe['RainTomorrow'] = lb.fit_transform(ohe['RainTomorrow'])</span><span id="d6b4" class="kl km hh kc b fi ks ko l kp kq">y = ohe['RainTomorrow']<br/>X = ohe.drop(['RainTomorrow'], axis=1)</span></pre><p id="e705" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å¥½â€¦â€¦æŒ¯ä½œèµ·æ¥ï¼ï¼æˆ‘ä»¬å·²ç»èµ°äº†ä¸€åŠäº†ï¼ğŸ‰ğŸ‰</p><p id="8549" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æˆ‘ä»¬æ¥ä¸‹æ¥è¦åšçš„æ˜¯åˆ†å‰²æ•°æ®å¹¶å®šä¹‰æˆ‘ä»¬çš„æ¨¡å‹ã€‚</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="f872" class="kl km hh kc b fi kn ko l kp kq">from sklearn.model_selection import train_test_split<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=0)</span><span id="2582" class="kl km hh kc b fi ks ko l kp kq">from sklearn.impute import SimpleImputer<br/>imp = SimpleImputer(missing_values=np.nan, strategy='mean')<br/>imp.fit_transform(X_train)</span></pre><blockquote class="js jt ju"><p id="e4af" class="iu iv jv iw b ix iy iz ja jb jc jd je jw jg jh ji jx jk jl jm jy jo jp jq jr ha bi translated">ç®€å•çš„ä¼°ç®—å™¨å……å½“ç©ºå€¼å¡«å……å™¨ã€‚å®ƒç”¨æ•°æ®çš„å¹³å‡å€¼æ›¿æ¢ç©ºå€¼ã€‚</p></blockquote><p id="2f3b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åˆ›å»ºä¸€ä¸ªç®¡é“ï¼Œå¹¶å°†SimpleImputerå’ŒRandomForestClassifieræ·»åŠ åˆ°ç®¡é“ä¸­ã€‚</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="3025" class="kl km hh kc b fi kn ko l kp kq">from sklearn.ensemble import RandomForestClassifier<br/><br/>model = make_pipeline(<br/>    SimpleImputer(),<br/>    RandomForestClassifier(n_jobs=4, verbose=True, n_estimators=200, max_depth=10, criterion='gini', )<br/>)<br/><br/>model.fit(X_train, y_train)</span></pre><figure class="kd ke kf kg fd ii er es paragraph-image"><div class="er es md"><img src="../Images/031ac844c9ab96135d9ae36784de6236.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*dIBsa5EDzKNAy5N1wBWIbQ.png"/></div></figure><p id="9650" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">n_jobsæ˜¯ç”¨äºç¡®å®šæœ‰åŠ©äºæ‹Ÿåˆæ•°æ®çš„å†…æ ¸æ•°é‡çš„å‚æ•°ã€‚</p><p id="a056" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ç°åœ¨ï¼Œè¯„ä¼°æ¨¡å‹ã€‚</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="44b3" class="kl km hh kc b fi kn ko l kp kq">model.score(X_test, y_test)</span></pre><figure class="kd ke kf kg fd ii er es paragraph-image"><div class="er es kv"><img src="../Images/7d80614893b28a5aee7db8fdf24ab62a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*YKWseaAOMHDol6KNIThnsQ.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">åˆ†æ•°æ¥è¿‘83%</figcaption></figure><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="68d9" class="kl km hh kc b fi kn ko l kp kq">model.score(X_train, y_train)</span></pre><figure class="kd ke kf kg fd ii er es paragraph-image"><div class="er es me"><img src="../Images/fb21fab702f550105482df9c4df064f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*DP_YM3McScG1LTvOf9NQUQ.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">ä¸å‡ºæ‰€æ–™ï¼Œè®­ç»ƒåˆ†æ•°æ›´å¤šã€‚</figcaption></figure><p id="e8e5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è®¡ç®—F1åˆ†æ•°</p><pre class="kd ke kf kg fd kh kc ki kj aw kk bi"><span id="ee34" class="kl km hh kc b fi kn ko l kp kq">from sklearn.metrics import f1_score<br/><br/>pred = model.predict(X_test)<br/>print(f1_score(y_test, pred))</span></pre><figure class="kd ke kf kg fd ii er es paragraph-image"><div class="er es md"><img src="../Images/21665affec0f47f20224b6e8cdba6b7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*n3aCGxgTHTwl1mITosUPHQ.png"/></div></figure><p id="17fd" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å°±æ˜¯è¿™æ ·ï¼ï¼ï¼</p><p id="5172" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æˆ‘ä»¬å®Œäº†ã€‚</p><p id="36b1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æ­å–œä½ ï¼ï¼ğŸ‰ä½ è®¾è®¡äº†ä¸€ä¸ªé¢„æµ‹æ¾³å¤§åˆ©äºšé™é›¨é‡çš„æ¨¡å‹ã€‚</p><p id="8ef0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è¿™æ˜¾ç„¶ä¸æ˜¯ä½ èƒ½åšçš„å…¨éƒ¨ã€‚æ‚¨ç”šè‡³å¯ä»¥ä½¿ç”¨ç§°ä¸ºå‚æ•°è°ƒæ•´çš„æ¦‚å¿µæ¥äº‰å–æ›´å¥½çš„æ¨¡å‹ã€‚</p><p id="1eee" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·ç•™ä¸‹è¯„è®ºâ€¦</p><p id="7ee6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è°¢è°¢å¤§å®¶ï¼ï¼</p></div></div>    
</body>
</html>