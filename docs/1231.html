<html>
<head>
<title>MakeFile: Make Rules and Automate</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MakeFile:制定规则并实现自动化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/makefile-make-rules-and-automate-in-python-982a41c99275?source=collection_archive---------2-----------------------#2021-02-21">https://medium.com/analytics-vidhya/makefile-make-rules-and-automate-in-python-982a41c99275?source=collection_archive---------2-----------------------#2021-02-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="034e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更像是黑客和提示</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/32efe8db3aba7c28366cc676f4a5656c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ormgWW0RaYfBY8niZLSidA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">生成文件</figcaption></figure><p id="f17f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">四个月前我还不知道<strong class="ih hj"> <em class="jt"> MakeFile </em> </strong>，但随着我逐渐了解，我非常喜欢它，现在我用Python做的一切都是自动化的。这里有几个用例，我总是使用<strong class="ih hj"> <em class="jt"> Make </em> </strong>命令:</p><ul class=""><li id="3d3b" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc jz ka kb kc bi translated">如果你不想记住任何有多个参数的长命令，那么在MakeFile中创建一个Make命令。</li><li id="1475" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">如果您想<strong class="ih hj">一个接一个地运行一组命令</strong>但不想一次又一次地复制粘贴，请将代码放在<strong class="ih hj"> <em class="jt"> Make </em> </strong>命令的块中</li><li id="6608" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">如果有<strong class="ih hj">什么事情需要多个系统</strong>运行，不用给出命令列表，只需给<strong class="ih hj"> <em class="jt"> Make </em> </strong>命令即可。</li><li id="947e" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">对于非开发人员来说，<strong class="ih hj">不需要了解执行产品</strong>的技术细节，<strong class="ih hj"> <em class="jt"> Make </em> </strong>命令可以作为一个方便的执行命令</li><li id="a348" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">创建一个<strong class="ih hj">备忘单</strong>来记录指令并且不想放置可执行脚本块，然后创建<strong class="ih hj"> <em class="jt"> Make </em> </strong>命令并把它们写在备忘单中</li><li id="d838" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">想要<strong class="ih hj">向少数人提供安装步骤</strong>而不出错，使用<strong class="ih hj">命令<em class="jt">使</em>命令</strong></li></ul><p id="8c29" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我可以毫不夸张地继续下去，<strong class="ih hj">用例是无穷无尽的</strong>，如果你还没有尝试过<strong class="ih hj"><em class="jt">Make<strong class="ih hj"><em class="jt">MakeFile</em></strong>中的</em> </strong>命令，那么我坚持“<strong class="ih hj">继续，尝试并创造神奇的</strong>”</p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="b4e5" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">Make命令到底是什么:</h1><p id="4351" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated"><strong class="ih hj"> <em class="jt"> Make </em> </strong>命令是可以为一个脚本或命令块设置的规则。可以把它看作是一个由一个单词组成的规则，你可以设置它来连续执行一系列命令。</p><h2 id="7383" class="ls kq hi bd kr lt lu lv kv lw lx ly kz iq lz ma ld iu mb mc lh iy md me ll mf bi translated">设置规则的格式是</h2><blockquote class="mg"><p id="0fd6" class="mh mi hi bd mj mk ml mm mn mo mp jc dx translated"><strong class="ak">目标:先决条件</strong></p><p id="12ad" class="mh mi hi bd mj mk ml mm mn mo mp jc dx translated"><strong class="ak"> &lt;标签&gt;配方</strong></p></blockquote><figure class="mr ms mt mu mv ji er es paragraph-image"><div class="er es mq"><img src="../Images/da0b0d8a10a41c6d4ecc73daa62c6d12.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*P-8VEpRB3IQYxXmIwBqAkQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">制作规则的示例</figcaption></figure><p id="97ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jt">目标</em> </strong>是单字规则，或者多个字串接成一个字。<strong class="ih hj"> <em class="jt">目标</em> </strong>是用于调用该规则的名称。这里的一个例子是“再见”</p><p id="5c05" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jt">先决条件</em> </strong>是<strong class="ih hj">可选</strong>，这些都是依赖项，如果你想在这个目标之前运行任何文件或者其他make命令，那么就把它添加为先决条件。<strong class="ih hj"> <em class="jt">先决条件</em> </strong>将在目标规则运行之前首先运行。截图中的一个例子是“你好</p><p id="cf8d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jt">配方</em> </strong>是该规则的主配方，凡是计划添加到规则中执行的都应该添加到配方中。<strong class="ih hj"> <em class="jt">菜谱的一个例子是“</em> </strong>回显“再见，下次见”</p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="a4e5" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">什么是MakeFile，它只适用于Python吗:</h1><p id="072d" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated"><strong class="ih hj"><em class="jt"/></strong>MakeFile是一个文件，它包含了所有<strong class="ih hj"><em class="jt"/></strong>Make的规则，作为一组指令由<strong class="ih hj"> <em class="jt"> Make </em> </strong>构建工具来遵循。理想情况下，如果您只运行"<strong class="ih hj"> <em class="jt"> make" </em> </strong>到<strong class="ih hj"> <em class="jt"> CLI </em> </strong>，那么来自<strong class="ih hj"> <em class="jt"> MakeFile </em> </strong>的第一条规则将会运行。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mw"><img src="../Images/ab815d67178b90d080e369123fdd6772.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*Oo1p_qz2DVC-EN1EKRiQmA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">你好规则</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mx"><img src="../Images/3584c3e25f22c432e12f82cafe9324ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*pxuRUX8Ynx4Yt6XIG1t6fA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">仅运行make</figcaption></figure><p id="219d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果通过<strong class="ih hj"><em class="jt">【CLI】</em></strong>执行<strong class="ih hj"> <em class="jt"> make规则</em> </strong>，那么该特定规则将运行。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es my"><img src="../Images/61a899db6904b764e459fd6548845972.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*z6s0gHDYiYLlEDLrAnC_SA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated"><specific_rule_name>特定的</specific_rule_name></figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mz"><img src="../Images/ae1d955f8a7ec64b5eea184b50797ef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*JPqD5waW9lRaYj287cxf8w.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">运行make <rule_name/></figcaption></figure><p id="68d8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">它可以用于几乎所有类似于Python的语言。我看到的，大多是用来编译文件的<strong class="ih hj">。然而，我们通过<strong class="ih hj">创建规则来运行docker执行命令或安装命令，或者用一个规则在许多地方进行更改</strong>来使用它。基本上我们已经通过<strong class="ih hj"> <em class="jt"> MakeFile </em> </strong>中的<strong class="ih hj"> <em class="jt">目标</em> </strong>实现了所有人工终端工作的自动化。</strong></p></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="4c0e" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">MakeFile Make命令的提示和示例:</h1><h2 id="cef5" class="ls kq hi bd kr lt lu lv kv lw lx ly kz iq lz ma ld iu mb mc lh iy md me ll mf bi translated">1.<strong class="ak"> <em class="na"> MakeFile </em> </strong>中的变量:</h2><p id="5d1d" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated"><strong class="ih hj"> <em class="jt"> MakeFile </em> </strong>是多功能的，它允许你添加变量，这些变量可以在一个文件中被多次调用，与规则无关。作为一个例子，VENV在这里作为一个变量</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nb"><img src="../Images/c6f081f432629da054f6485ffbfc0ddc.png" data-original-src="https://miro.medium.com/v2/resize:fit:586/format:webp/1*jgvF2xhusYRLRt5XArsmGA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">VENV作为变量</figcaption></figure><h2 id="02a6" class="ls kq hi bd kr lt lu lv kv lw lx ly kz iq lz ma ld iu mb mc lh iy md me ll mf bi translated">2.通过<strong class="ak"> <em class="na"> CLI </em> </strong>传递的参数:</h2><p id="c085" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">如果你不想在<strong class="ih hj"> <em class="jt"> MakeFile </em> </strong>中添加硬编码的值，你可以在<strong class="ih hj"> <em class="jt"> Make </em> </strong>命令中将这些值作为参数传递。我建议，不要传递超过四个参数，因为它会使<strong class="ih hj"> <em class="jt"> Make </em> </strong>命令的意义消失，从而使执行变得容易。更多的参数意味着需要记住更多的东西来运行那个<strong class="ih hj"> <em class="jt"> Make </em> </strong>命令</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nc"><img src="../Images/14aff7ba8ce686621484a8064ddf26fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*4Eq1s6bur2hVe0xxs0Wn1w.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">从CLI作为参数传递的名称变量</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nd"><img src="../Images/bc2408ab8a6bea5ee6e1587ad8d26d74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*ywiD9c_QBKLm07GoNqErwQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">作为参数传递的名称表示命令受欢迎</figcaption></figure><p id="a080" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">例如，在上面的截图中，<strong class="ih hj">名称</strong>是通过CLI</p><h2 id="962b" class="ls kq hi bd kr lt lu lv kv lw lx ly kz iq lz ma ld iu mb mc lh iy md me ll mf bi translated">3.使用if的条件规则:</h2><p id="b0bb" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">可能会出现需要根据输入运行条件命令的情况。而<strong class="ih hj"> <em class="jt">如果</em> </strong>这句话在<strong class="ih hj"> <em class="jt">菜谱</em> </strong>的那些情况下就派上用场了</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ne"><img src="../Images/fd581f2cc678fda3ea48f0e2d3721534.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*bThyWBdYfPgtpRf0Rf7iOA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">如何在makefile中使用if条件</figcaption></figure><p id="3789" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我已经使用了<strong class="ih hj"> <em class="jt">嵌套if </em> </strong>语句来检查变量<strong class="ih hj"> <em class="jt"> file_name </em> </strong>的值，如果匹配的话遵循那些指令并触摸文件<strong class="ih hj"> <em class="jt"> else </em> </strong>只差一步</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nf"><img src="../Images/6f7c762c3c368494d2aef800403b0937.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*jrNPfSp5LipDmdKJeFXYNQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">从make conditional运行不同的if子句</figcaption></figure><div class="je jf jg jh fd ab cb"><figure class="ng ji nh ni nj nk nl paragraph-image"><img src="../Images/2c10172aa30324a7daa808570ad8340c.png" data-original-src="https://miro.medium.com/v2/resize:fit:488/format:webp/1*15tnOGoudxtTaZk2rJDGpw.png"/></figure><figure class="ng ji nm ni nj nk nl paragraph-image"><img src="../Images/41eb466703baaa4ecd31e47c0a2893f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*GAk2e9zRfoVFDDkVM2ZHmA.png"/></figure><figure class="ng ji nn ni nj nk nl paragraph-image"><img src="../Images/75df68a0ad4df79852b6f9d92d7d7101.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*zxcmt8Dx8UGQNbBojfV8Dg.png"/><figcaption class="jp jq et er es jr js bd b be z dx no di np nq translated">abc目录从模板复制，dee目录先摸dee.txt再从模板复制所有文件，friend目录从模板复制所有东西再摸friend.txt</figcaption></figure></div><p id="3314" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如上图所示，文件是按照<strong class="ih hj"> <em class="jt"> ifeq块</em> </strong>中的指令复制和创建的</p><h2 id="4da9" class="ls kq hi bd kr lt lu lv kv lw lx ly kz iq lz ma ld iu mb mc lh iy md me ll mf bi translated">4.运行依赖关系之前:</h2><p id="6e5d" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">可能有一些<strong class="ih hj"> <em class="jt">先决条件</em> </strong>来运行该命令，在这些情况下，在运行该命令之前处理任何依赖或检查变得非常容易。</p><p id="d080" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一个简单的例子:'<strong class="ih hj"> bye </strong>'对'<strong class="ih hj"> hello '，</strong>有依赖关系，所以在执行'<strong class="ih hj"> bye </strong>'时，<strong class="ih hj"> 'hello' </strong>在<strong class="ih hj"> 'bye' </strong>之前运行</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mw"><img src="../Images/8533760e15927d18feb6383e936a0819.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*dBj4SewYMhsmJv51G7o-XQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">再见规则依赖于你好规则</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nr"><img src="../Images/297573d1e82b8dfd687b4deb02322c72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*54i92474Y0IU_zTeQEHdAg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">你好规则在再见规则之前运行</figcaption></figure><h2 id="d8d2" class="ls kq hi bd kr lt lu lv kv lw lx ly kz iq lz ma ld iu mb mc lh iy md me ll mf bi translated">5.来自另一个的触发规则:</h2><p id="e3b6" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">如果根据任何规则的结果有需要执行的作业，那么通过需要触发的规则来触发那些<strong class="ih hj"> <em class="jt">制定</em> </strong>规则</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ns"><img src="../Images/758f14cd08868e9e8d55fe8f60c301f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j9zKZXX7Lmowz-ekC9j4-w.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">从安装规则触发了env_activate规则</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nt"><img src="../Images/a6e0fc9a94352bf4fc789b35f9a66315.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qErZE0uc43ncbu5ofDIWjg.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">在所有步骤之后，它运行env_activate规则</figcaption></figure><p id="0990" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如上所述，<strong class="ih hj"> env_activate </strong>规则由<strong class="ih hj">安装</strong>触发</p><h2 id="1f0d" class="ls kq hi bd kr lt lu lv kv lw lx ly kz iq lz ma ld iu mb mc lh iy md me ll mf bi translated">6.规则描述和示例:</h2><p id="fc8a" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">为每条规则提供描述和例子是有好处的，这有两个好处。首先，业务用户很容易理解<strong class="ih hj"> <em class="jt"> Make </em> </strong>规则是关于什么的，他们也可以轻松地使用它。第二，即使是技术人员也想从示例中快速复制<strong class="ih hj"> <em class="jt"> Make </em> </strong>命令，这样他们就不必记住任何内容。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nu"><img src="../Images/8fe921a645bc92ebbba54d762a7d8b0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9bWHzf2yUJiNfRfolEgKqQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">描述和示例</figcaption></figure><h2 id="5220" class="ls kq hi bd kr lt lu lv kv lw lx ly kz iq lz ma ld iu mb mc lh iy md me ll mf bi translated">7.在其他管道或作业中使用单行命令:</h2><p id="4aa0" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">在需要几个命令来运行任何作业的情况下，那么使用<strong class="ih hj"> <em class="jt"> Make </em> </strong>命令，而不是给出作业中的命令集。</p><p id="76ee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">下面是一个从<strong class="ih hj"> run_make.py </strong>调用<strong class="ih hj"> make random </strong>的例子</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nv"><img src="../Images/11ebe8cb0d989748dafc9126a1b4cdb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*Nw4E_EbBkqLXm3r9xubylQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">run_make.py调用随机生成</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nw"><img src="../Images/c659a54a2e2eb5dd2091b01692090579.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*EPERYheO0IK_2Up87tIa0w.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">Makefile中的随机规则</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nx"><img src="../Images/d4098ff6b89c0c72960d0137f6e11a0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*xl3xa-wCcpPcU4eCFAubKQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">运行run_make.py显示随机规则的结果</figcaption></figure><p id="0b9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">另一个例子</strong>:我们已经为docker构建、推送、拉取、运行、标记创建了<strong class="ih hj"> <em class="jt"> Make </em> </strong>规则。所有这些命令都是从Kube-Jenkins管道中直接调用的。</p><h2 id="033a" class="ls kq hi bd kr lt lu lv kv lw lx ly kz iq lz ma ld iu mb mc lh iy md me ll mf bi translated">8.用于备忘单或文档的一行命令:</h2><p id="f697" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">如果有解释，但代码较少，文档看起来很容易理解。而且<strong class="ih hj"> cheatsheet </strong>肯定是有很少的空间可以填写，避免用上百个命令来填写，而是用很少的<strong class="ih hj"> <em class="jt">来制作</em> </strong>命令。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ny"><img src="../Images/5d64b93089050fe547dfd765779de307.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v-E4bpFZwxf6Q27uLwHxiQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">Cheatsheet只需要小的单行命令</figcaption></figure></div><div class="ab cl ki kj gp kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="hb hc hd he hf"><h1 id="6833" class="kp kq hi bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">MakeFile的缺陷和不足:</h1><h2 id="31a6" class="ls kq hi bd kr lt lu lv kv lw lx ly kz iq lz ma ld iu mb mc lh iy md me ll mf bi translated">1.通过Mac使用制表符或空格:</h2><p id="7755" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">如果你曾经得到这个错误，当配方<strong class="ih hj">前有<strong class="ih hj">空格</strong>和<strong class="ih hj">而不是&lt;标签&gt; </strong>时，就会发生这种情况。</strong>当你系统的<strong class="ih hj"> &lt;页签&gt; </strong>关键字<strong class="ih hj"> </strong>把<strong class="ih hj">空格</strong>代替<strong class="ih hj"> &lt;页签&gt; </strong>时就会出现这种情况</p><blockquote class="nz oa ob"><p id="e5d7" class="if ig jt ih b ii ij ik il im in io ip oc ir is it od iv iw ix oe iz ja jb jc hb bi translated">makefile:78:* * * *缺少分隔符。停下来。</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es of"><img src="../Images/5a3059409cac6ebcde757d6770fef8bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*BrojE393Y-uc4YC0Pw8gsg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">***缺少分隔符。停止错误</figcaption></figure><p id="cfe5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案</strong>:</p><ul class=""><li id="0ed3" class="ju jv hi ih b ii ij im in iq jw iu jx iy jy jc jz ka kb kc bi translated">这个问题主要与您正在使用的IDE有关，请尝试Terminal/Putty</li><li id="40eb" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">在记事本中按下<strong class="ih hj"> &lt;标签&gt; </strong>并复制到<strong class="ih hj"> <em class="jt"> MakeFile </em> </strong>中。这真的有用。</li><li id="a737" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">安装<strong class="ih hj"> <em class="jt"> MakeFile </em> </strong>兼容插件</li></ul><h2 id="a04f" class="ls kq hi bd kr lt lu lv kv lw lx ly kz iq lz ma ld iu mb mc lh iy md me ll mf bi translated">2.编译后的命令还会显示</h2><p id="7b81" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">如果配方中的命令在执行<strong class="ih hj"> <em class="jt"> Make </em> </strong>命令后也得到显示，如截图中<strong class="ih hj"><em class="jt">echo“hello there”</em></strong>也得到打印</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es og"><img src="../Images/15a1bd85f8e3322593d0b5b54abc7f5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*xKIC7CMcBMP7E2R-E9xexA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">make命令中的多余行</figcaption></figure><p id="1103" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案:</strong>在每个配方前加上<strong class="ih hj"> @ </strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es oh"><img src="../Images/8c134b18f6cb5d80ef3f049306e199de.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*Qr5HWyi_MK70pG7b6Tm_eA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">在回显前添加了@</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es oi"><img src="../Images/59266001ff559837090077af754607fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*azLz8i3w90xrvHCQpGQigQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">不需要的线条消失了</figcaption></figure><h2 id="f20d" class="ls kq hi bd kr lt lu lv kv lw lx ly kz iq lz ma ld iu mb mc lh iy md me ll mf bi translated">3.太多的Make命令很难记住:</h2><p id="12ab" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">如果您觉得有太多的make命令需要记住，并且不可能在文档中维护它们</p><p id="6b16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解决方案:</strong>创建一个列出所有make命令的规则</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es oj"><img src="../Images/8bd3b790ca1908a7828588c5f40712ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*-Mnyvf9VM8nC1MmMB5jHcA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">记住所有规则的最佳规则</figcaption></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ok"><img src="../Images/1edb925bacddc52e344166888b808191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*zb36WUidp6PVAiD4atWcUQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">制作帮助_示例</figcaption></figure><h2 id="477c" class="ls kq hi bd kr lt lu lv kv lw lx ly kz iq lz ma ld iu mb mc lh iy md me ll mf bi translated">4.相同的规则和文件名</h2><p id="ffe0" class="pw-post-body-paragraph if ig hi ih b ii ln ik il im lo io ip iq lp is it iu lq iw ix iy lr ja jb jc hb bi translated">如果您曾经得到这个错误，当我们创建相同的<strong class="ih hj"> <em class="jt">目标</em> </strong>名称作为一个文件存在于这个位置时，就会发生这种情况。对于这种情况,“随机”文件已经存在，因此<strong class="ih hj"> <em class="jt"> MakeFile </em> </strong>只是检查该文件是否是最新的</p><blockquote class="nz oa ob"><p id="6fda" class="if ig jt ih b ii ij ik il im in io ip oc ir is it od iv iw ix oe iz ja jb jc hb bi translated">品牌:` random '是最新的。</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ol"><img src="../Images/299128b784ed2f5ed98f70bd33acb9f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*VUcNRA5N25dASpFJ5We6rA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">Makefile正在随机读取一个文件</figcaption></figure><p id="753b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">解:</strong>加<strong class="ih hj"> <em class="jt">。带有规则名称的假冒</em> </strong>语句，示例随机和帮助是两个具有相同名称文件的规则</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es om"><img src="../Images/6d8d6841b03aa5ac415a229f773827f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*l8Gm1z03yf8NnMiAQB7eeg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">。虚假添加和随机成为Makefile的规则</figcaption></figure><h1 id="527b" class="kp kq hi bd kr ks on ku kv kw oo ky kz la op lc ld le oq lg lh li or lk ll lm bi translated">如何在Python中使用MakeFile:</h1><ul class=""><li id="1211" class="ju jv hi ih b ii ln im lo iq os iu ot iy ou jc jz ka kb kc bi translated">运行复杂的docker exec、docker run命令</li><li id="2da1" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">运行Python虚拟环境指令</li><li id="2607" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">在所有系统上运行相同版本的pip安装</li><li id="523f" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">执行外壳命令/脚本</li><li id="3d9f" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">连接到不同的服务器</li><li id="6af5" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">复制/删除文件/目录</li><li id="cdb5" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">运行复杂的DBT命令</li><li id="1ae0" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">调用任何python文件来执行</li><li id="49aa" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">运行PyTest之类的测试命令</li><li id="ee8e" class="ju jv hi ih b ii kd im ke iq kf iu kg iy kh jc jz ka kb kc bi translated">检查文件是否已更改或最新</li></ul><p id="14e5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">基本上，无论通过Shell手动完成什么，都可以从MakeFile中调用。</p><p id="2166" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望这非常有帮助，希望听到你的评论。如果您想尝试，下面是Makefile:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ov ow l"/></div></figure><p id="ef82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">更多参考:</p><blockquote class="nz oa ob"><p id="26a4" class="if ig jt ih b ii ij ik il im in io ip oc ir is it od iv iw ix oe iz ja jb jc hb bi translated"><a class="ae ox" href="https://www.gnu.org/software/make/manual/make.html" rel="noopener ugc nofollow" target="_blank">https://www.gnu.org/software/make/manual/make.html</a></p></blockquote></div></div>    
</body>
</html>