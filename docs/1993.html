<html>
<head>
<title>Linear Regression explained with an Example</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">线性回归举例说明</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/simple-linear-regression-explained-with-an-example-2b088d6b874e?source=collection_archive---------10-----------------------#2021-03-30">https://medium.com/analytics-vidhya/simple-linear-regression-explained-with-an-example-2b088d6b874e?source=collection_archive---------10-----------------------#2021-03-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="7dbd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">大家好！</p><p id="5dbd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我将解释为特定数据集构建线性回归模型的过程。</p><h2 id="2be5" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">导入库</h2><p id="ca7f" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">首先，我导入了常用的库— NumPy、Pandas、Matplotlib和Seaborn。然后我导入LinearRegression构建线性回归模型，train_test_split将数据集分别划分为训练和测试数据。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="8e28" class="jd je hi ki b fi km kn l ko kp">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns</span><span id="abc0" class="jd je hi ki b fi kq kn l ko kp">from sklearn.linear_model import LinearRegression<br/>from sklearn.model_selection import train_test_split</span></pre><h2 id="2da1" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">资料组</h2><p id="bb64" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">在我继续这个过程之前，让我们先来看看数据集。数据集有以下几列，我们需要表达汽车的mpg和数据集中给出的其他属性之间的关系。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="090a" class="jd je hi ki b fi km kn l ko kp">Data</span></pre><figure class="kd ke kf kg fd ks er es paragraph-image"><div class="er es kr"><img src="../Images/4d054d7b7148d9109af0e13ee808139d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*QHBF5RfPRgw7VZLBi1DQJg.png"/></div></figure><p id="b9d5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">变量及其简短形式如下</p><p id="f34d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">mpg -&gt; MPG(每加仑英里数)</p><p id="d64b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">气缸-&gt;气缸</p><p id="8456" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">显示-&gt;发动机排量</p><p id="ac90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">马力-&gt;马力</p><p id="d468" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">重量-&gt;车辆重量</p><p id="0a08" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">加速-&gt;从0加速到60英里/小时的时间</p><p id="5276" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">yr -&gt;车型年</p><p id="e340" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">起源-&gt;汽车起源(1。美国人，2。欧洲人，3。日语)</p><p id="eaab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">汽车名称</p><h1 id="b334" class="kv je hi bd jf kw kx ky jj kz la lb jn lc ld le jq lf lg lh jt li lj lk jw ll bi translated">探索性数据分析</h1><h2 id="9b97" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">情节</h2><p id="d2f4" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">为了理解各种属性如何与目标变量相关联，我检查了目标变量和其他变量之间的关系。我用seaborn的线图在二维平面上画了线。</p><ol class=""><li id="13e5" class="lm ln hi ih b ii ij im in iq lo iu lp iy lq jc lr ls lt lu bi translated">mpg和加速度之间的关系</li></ol><p id="ed6c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在此图中，我们可以看到大多数点不在回归线附近，这意味着两个变量之间存在微弱的正相关。这可以通过使用corr()函数检查相关值来进一步确认。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="f5a9" class="jd je hi ki b fi km kn l ko kp">sns.lmplot(x=’mpg’,y=’accel’,data=Data)</span></pre><figure class="kd ke kf kg fd ks er es paragraph-image"><div class="er es lv"><img src="../Images/d7f7445ed746fb3b8a52d062229818fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*qxZ1ak9ksHKopkq9F5cgMA.png"/></div></figure><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="1c9b" class="jd je hi ki b fi km kn l ko kp">Data[‘mpg’].corr(Data[‘accel’])</span></pre><figure class="kd ke kf kg fd ks er es paragraph-image"><div class="er es lw"><img src="../Images/b34e181ef4ddc52c36b17235b7c85545.png" data-original-src="https://miro.medium.com/v2/resize:fit:418/format:webp/1*KGYwjDhRfEH-BER7Z5nfRQ.png"/></div></figure><p id="1db7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.mpg和hp之间的关系表明这两个变量之间有很强的正相关性。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="03ce" class="jd je hi ki b fi km kn l ko kp">sns.lmplot(x=’mpg’,y=’hp’,data=Data)</span></pre><figure class="kd ke kf kg fd ks er es paragraph-image"><div class="er es lx"><img src="../Images/ef6d354d889ce7a8a94a8e590c984c67.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*A4riHRbNyRj-3DNiBGjWog.png"/></div></figure><p id="3106" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以类似的方式，我绘制了图表来检查mpg和其他变量之间的关系，这里是表格形式的相同内容的摘要。</p><figure class="kd ke kf kg fd ks er es paragraph-image"><div class="er es ly"><img src="../Images/048daa052cbbb6da71fc26a705bb501b.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*rm3SGNVwowEXhXPXZt_CdA.png"/></div></figure><h2 id="2be7" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">删除不必要的列</h2><p id="ae29" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">接下来要检查的是所有的列在构建模型时是否有用。包含汽车名称的列不会在模型中使用，所以我删除了该列。数据集现在包含8列。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="d5b4" class="jd je hi ki b fi km kn l ko kp">df=Data.drop(‘name’,axis=1)<br/>df</span></pre><h2 id="c0eb" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">处理分类值</h2><p id="5fc2" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">“Origin”列以数字的形式包含汽车的产地，其中1代表美国，2代表欧洲，3代表日本。如果构建模型时没有考虑这些分类值，那么模型将获取这些数字，并按照它想要的方式对它们进行排序。例如，它可以这样排列- 1&lt;2&lt; 3，这意味着日本的汽车比欧洲的多，欧洲的汽车比美国的多。这根本说不通啊！因此，我用美国代替了1，用欧洲代替了2，用日本代替了3。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="9723" class="jd je hi ki b fi km kn l ko kp">df[‘origin’]=df[‘origin’].replace({1:’America’,2:’Europe’,3:’Asia’})<br/>df.head()</span></pre><figure class="kd ke kf kg fd ks er es paragraph-image"><div class="er es lz"><img src="../Images/4a3585146a5178b89be21fd8991b1d21.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*1VBZgiEiRoWL0Bel7wk-fw.png"/></div></figure><p id="b8f6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">嗯，还有一个问题！你能看出这是什么吗？</p><p id="1fa4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们只需要包含数字数据的列。列原点违反了这一点。因此，需要采取措施来解决这个问题。这就是'<em class="ma"> get_dummies </em>'函数发挥作用的地方。该函数将在感兴趣的列中选择不同的类别，并以“原始列名_类别”的格式创建一个列名。然后，一旦遇到特定的列，它会将该列标记为1，而其他两列将标记为0。看看下面代码的输出，函数的作用将会更加清晰。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="8a1e" class="jd je hi ki b fi km kn l ko kp">df=pd.get_dummies(df,columns=[‘origin’])<br/>df</span></pre><figure class="kd ke kf kg fd ks er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mb"><img src="../Images/afb72571b46886eb236af3b4a3490403.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*Kr3afhbfNl-yZS1GLpnYfg.png"/></div></div></figure><p id="83fb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Tadaaa，问题解决了！</p><p id="8b56" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们看看这个数据集中是否有任何缺失值</p><p id="4022" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">处理缺失值</strong></p><p id="b5c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可能有几列缺少值。处理这些真的很重要，因为缺少值会带来各种问题。首先，某些价值观的缺失会导致我们的结果出现偏差。它也可能导致完全错误或不可接受的结论。处理缺失值的一些方法包括-用平均值或众数填充缺失值，删除包含缺失值的行。丢弃任何数据点应该是我们最后的选择，因为这样做我们可能会丢失很多重要信息。</p><p id="bab7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我首先使用<em class="ma"> isna() </em>函数检查是否有丢失的值。除此之外，我还使用了<em class="ma"> sum </em>函数来计算nan的数量(如果有的话)。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="2016" class="jd je hi ki b fi km kn l ko kp">df.isna().sum()</span></pre><figure class="kd ke kf kg fd ks er es paragraph-image"><div class="er es mg"><img src="../Images/4aa646d372f5f0b81c6e54d6bef8047c.png" data-original-src="https://miro.medium.com/v2/resize:fit:386/format:webp/1*IPzTTW81k5qOvwEZU9jF9w.png"/></div></figure><p id="fb67" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从输出来看，很明显没有丢失值。然后，我检查了数据类型，以确认我所看到的是否正确。<em class="ma"> dtypes </em>函数可用于确定每一列的数据类型。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="d854" class="jd je hi ki b fi km kn l ko kp">df.dtypes</span></pre><figure class="kd ke kf kg fd ks er es paragraph-image"><div class="er es mh"><img src="../Images/6929c792d6e81f76df4491d6b47d6d58.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*NUQ7YX7pQd437-KYjuLy6A.png"/></div></figure><p id="fb4f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到每一列的值的种类，并用上面的输出进行确认。所有的数据类型似乎都没问题。</p><h2 id="7929" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">多元图</h2><p id="b287" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">我使用了<em class="ma"> pairplot </em>函数来解释数据集中变量之间的关系。仅使用前7列(因为绘制图形不需要后3列)，我得到以下pairplots。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="f99f" class="jd je hi ki b fi km kn l ko kp">attr_select=df.iloc[:,0:7]<br/>sns.pairplot(attr_select,diag_kind=’kde’)</span></pre><figure class="kd ke kf kg fd ks er es paragraph-image"><div class="er es mi"><img src="../Images/3c597e06ae16aad94a709df993e2b150.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*DlHUfkDPNzAs5ub53gHRsQ.png"/></div></figure><p id="989c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">注意:上面的截图没有显示完整的结果。</p><p id="2e20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，只需一行代码，seaborn就能够绘制多个图形来显示所有变量之间的关系。将'<em class="ma"> diag_kind </em>'设置为获取我们想要的对角线类型。如果它被设置为kde，我们会得到平滑的曲线，就像上面显示的那样。如果我们不指定diag_kind，我们将得到直方图来代替平滑图。</p><figure class="kd ke kf kg fd ks er es paragraph-image"><div class="er es mj"><img src="../Images/76f85c92e550ddf62a4b26526cfcbbb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*MxArwc0NeRAJ24BJUrTfqQ.png"/></div></figure><p id="b836" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另一个需要注意的要点是，在任何一个pairplot中，我们从曲线上半部分得到的任何推论都与从曲线下半部分得到的推论相同。因此，出于解释目的，您可以考虑对角线的任一侧。</p><p id="0d1f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了理解清楚，我拿起一些图表，试图解释</p><figure class="kd ke kf kg fd ks er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mk"><img src="../Images/d4ec481d200314d80221cc9c95b862cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*b_P8YOk-DyqXd0Kc6eAoOA.png"/></div></div></figure><p id="e365" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果我们看一下体重和mpg之间的图表，我们可以看到这是负相关的。重量和马力成正相关。以类似的方式，可以解释其他变量之间的关系。</p><p id="0cda" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经为构建模型准备好了数据。</p></div><div class="ab cl ml mm gp mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="hb hc hd he hf"><h1 id="c1e0" class="kv je hi bd jf kw ms ky jj kz mt lb jn lc mu le jq lf mv lh jt li mw lk jw ll bi translated">构建模型</h1><h2 id="af2d" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">将数据分为因变量和自变量</h2><p id="dbbf" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">要做的第一件事是把数据分成因变量和自变量。在我们的数据集中，我们希望预测“mpg”的值，该mpg取决于所有其他属性，如气缸、马力等。因此mpg是我们的因变量，而其他变量是独立的。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="32d1" class="jd je hi ki b fi km kn l ko kp">X= df.drop([‘mpg’],axis=1)<br/>y= df[[‘mpg’]]</span></pre><p id="2ee2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">“mpg”存储在y中，其他所有属性存储在自变量x中。</p><h2 id="b739" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">将数据集拆分为训练和测试数据</h2><p id="3c0e" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">然后，我将数据分为训练和测试数据，其中30%的数据在测试数据集中，其余的数据在测试数据集中。X中要用于训练的数据点存储在X_train中，要用于测试的数据点存储在X_test中。同样，我把Y的数据点存储在Y_train和Y_test中。我还设置了一个随机种子，以确保每次运行代码时，存储在训练和测试变量中的随机数据保持不变。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="18f2" class="jd je hi ki b fi km kn l ko kp">X_train , X_test , y_train , y_test = train_test_split(X, y , test_size=0.30, random_state=1)</span></pre><h2 id="e97b" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">让模型学习</h2><p id="6733" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">剩下要做的最后一件事是让我的模型从训练数据集中学习。在初始化模型时，我使用'<em class="ma"> fit' </em>函数使模型从X_train和y_train中学习。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="f2c7" class="jd je hi ki b fi km kn l ko kp">regression_model=LinearRegression()<br/>regression_model.fit(X_train,y_train)</span></pre><figure class="kd ke kf kg fd ks er es paragraph-image"><div class="er es mx"><img src="../Images/4f19a25386312fc1d9ea62d210cdf083.png" data-original-src="https://miro.medium.com/v2/resize:fit:380/format:webp/1*P5_UUaMq8qY7VLIG1GCUOQ.png"/></div></figure><p id="62e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集的方程是- Y=m1x1+m2x2+m3x3+的形式。….c(直到数据集的最后一列)。我使用了<em class="ma">‘coef _’</em>函数来获得各个列的系数的值。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="dd16" class="jd je hi ki b fi km kn l ko kp">regression_model.coef_</span></pre><figure class="kd ke kf kg fd ks er es paragraph-image"><div class="er es my"><img src="../Images/afded11b8ee79199c33352a0e7b3c2c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*sO7KYEW03kEmVg8XLAGimQ.png"/></div></figure><p id="4a90" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我使用了<em class="ma"> intercept_ </em>函数来计算y轴截距的值</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="8afc" class="jd je hi ki b fi km kn l ko kp">intercept=regression_model.intercept_[0]<br/>intercept</span></pre><figure class="kd ke kf kg fd ks er es paragraph-image"><div class="er es mz"><img src="../Images/6eec3656885dac903ed248b7b473c8bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:408/format:webp/1*Qt97KeFl82_-KEfcEiS8iw.png"/></div></figure><p id="528e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">方程是mpg =-0.23250(cyl)+0.0245(dis)-0.0014(HP)…-19.75一旦我们输入了变量的值，就会预测出目标变量——mpg。因此，建立了一个数学模型来建立目标变量“mpg”和其他变量之间的关系。</p><h2 id="0129" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">模型的分数</h2><p id="a240" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">检查模型的执行情况也很重要，所以我分别检查了训练和测试数据的得分。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="309a" class="jd je hi ki b fi km kn l ko kp">Training_data_score=regression_model.score(X_train,y_train)<br/>Testing_data_score=regression_model.score(X_test,y_test)<br/>print(“Score of training data is :” + str(Training_data_score))<br/>print(“Score of testing data is :” + str(Testing_data_score))</span></pre><figure class="kd ke kf kg fd ks er es paragraph-image"><div class="er es na"><img src="../Images/53f5089fab54df3dcaeef09eb9b1c1a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*QvSQpBTpxaDCi6zweEAMOw.png"/></div></figure><p id="cb54" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练数据有82%的分数，还算过得去。另一方面，测试数据的分数表明了数据从训练数据集中学习的程度。测试数据的得分为82.4%，这已经足够好了，但还可以再好一点。</p><h2 id="3d89" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">预测目标值</h2><p id="5f22" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">剩下要做的最后一件事是预测X_test中出现的数据点的“mpg”值。该模型已经从训练数据集中存在的几辆汽车中学习，现在是时候使用它所学习的任何东西来给出所需的预测结果。我使用predict函数做了同样的事情。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="06b5" class="jd je hi ki b fi km kn l ko kp">regression_model.predict(X_test)</span></pre><figure class="kd ke kf kg fd ks er es paragraph-image"><div class="er es nb"><img src="../Images/f545cf6c98d110816e93ad8b87e204be.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*nElAnenZP3AQSXUOWEaEOQ.png"/></div></figure><h2 id="78c9" class="jd je hi bd jf jg jh ji jj jk jl jm jn iq jo jp jq iu jr js jt iy ju jv jw jx bi translated">例子</h2><p id="203f" class="pw-post-body-paragraph if ig hi ih b ii jy ik il im jz io ip iq ka is it iu kb iw ix iy kc ja jb jc hb bi translated">在下面的快照中，让我们取第一行中的值。该车有4个气缸，发动机排量为8立方英寸，马力为97，车辆重量为2506磅，从0加速到60英里每小时需要14.5秒，72年款，原产地为亚洲。考虑到所有这些参数，该模型预测其mpg为23.83。同样，该模型预测了X_test中所有行的mpg。</p><pre class="kd ke kf kg fd kh ki kj kk aw kl bi"><span id="fe33" class="jd je hi ki b fi km kn l ko kp">X_test</span></pre><figure class="kd ke kf kg fd ks er es paragraph-image"><div class="er es nc"><img src="../Images/529029fa10b65a93e84305a67d6060ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*JcM-yVDZdeFs0behX1y1TA.png"/></div></figure></div></div>    
</body>
</html>