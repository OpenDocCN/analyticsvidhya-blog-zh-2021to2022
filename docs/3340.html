<html>
<head>
<title>Implement your own Mask RCNN model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实现您自己的掩码RCNN模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/implement-your-own-mask-rcnn-model-65c994a0175d?source=collection_archive---------1-----------------------#2021-06-26">https://medium.com/analytics-vidhya/implement-your-own-mask-rcnn-model-65c994a0175d?source=collection_archive---------1-----------------------#2021-06-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/86e02eaed8df4f2dcbd264c5b4bf1c01.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*q7VNcMligX_z5G8piTRyeQ.jpeg"/></div></figure><p id="182b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi jk translated"><span class="l jl jm jn bm jo jp jq jr js di">在</span>这篇文章中，我将一步一步地介绍如何实现和部署你自己的Mask RCNN模型。当我创建自己的部署模型时，我参考了许多在线博客，很少有博客使用带边框和单类分类的图像注释，一些使用带边框注释的图像和多类分类，其他使用带单类分类的多边形注释。这篇文章将为所有这些场景提供代码和解释。该员额的流程如下:</p><ol class=""><li id="a83d" class="jt ju hi io b ip iq it iu ix jv jb jw jf jx jj jy jz ka kb bi translated"><strong class="io hj"><em class="kc">Mask RCNN模式介绍</em> </strong> <em class="kc"> l </em></li><li id="298c" class="jt ju hi io b ip kd it ke ix kf jb kg jf kh jj jy jz ka kb bi translated"><strong class="io hj"> <em class="kc">关于我的面具RCNN型号</em> </strong></li><li id="3317" class="jt ju hi io b ip kd it ke ix kf jb kg jf kh jj jy jz ka kb bi translated"><strong class="io hj"> <em class="kc">第一步:数据收集和清理</em> </strong></li><li id="3b7d" class="jt ju hi io b ip kd it ke ix kf jb kg jf kh jj jy jz ka kb bi translated"><strong class="io hj"> <em class="kc">第二步:图像标注</em> </strong></li><li id="59fd" class="jt ju hi io b ip kd it ke ix kf jb kg jf kh jj jy jz ka kb bi translated"><strong class="io hj"> <em class="kc">第三步:下载要求</em> </strong></li><li id="ab5b" class="jt ju hi io b ip kd it ke ix kf jb kg jf kh jj jy jz ka kb bi translated"><strong class="io hj"> <em class="kc">步骤4 a:模型训练(包围盒标注和单类分类)</em> </strong></li><li id="7dd5" class="jt ju hi io b ip kd it ke ix kf jb kg jf kh jj jy jz ka kb bi translated"><strong class="io hj"> <em class="kc">步骤4 b:模型训练(包围盒标注和多类分类)</em> </strong></li><li id="e20c" class="jt ju hi io b ip kd it ke ix kf jb kg jf kh jj jy jz ka kb bi translated"><strong class="io hj"> <em class="kc">步骤4 c:模型训练(多边形标注和多类分类)</em> </strong></li><li id="e269" class="jt ju hi io b ip kd it ke ix kf jb kg jf kh jj jy jz ka kb bi translated"><strong class="io hj"> <em class="kc">图像增强</em> </strong></li><li id="a7a0" class="jt ju hi io b ip kd it ke ix kf jb kg jf kh jj jy jz ka kb bi translated"><strong class="io hj"> <em class="kc">第五步:模型评估</em> </strong></li><li id="5366" class="jt ju hi io b ip kd it ke ix kf jb kg jf kh jj jy jz ka kb bi translated"><strong class="io hj"> <em class="kc">第六步:单幅图像预测</em> </strong></li><li id="ef10" class="jt ju hi io b ip kd it ke ix kf jb kg jf kh jj jy jz ka kb bi translated"><strong class="io hj"> <em class="kc">第七步:本地使用Flask进行网站部署</em> </strong></li></ol><p id="87eb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">掩模RCNN模型总共有63，749，552个参数，63，638，064个可训练参数，和111，488个不可训练参数。这是一个很大的参数，不要担心，你不需要了解关于Mask RCNN模型的一切就可以实现它，也就是说，我强烈建议你在这里阅读Mask RCNN论文<a class="ae ki" href="https://arxiv.org/abs/1703.06870" rel="noopener ugc nofollow" target="_blank"/>。为了实现这个模型，我使用了<a class="ae ki" href="https://github.com/matterport/Mask_RCNN" rel="noopener ugc nofollow" target="_blank"> matterport Mask R-CNN </a>。</p></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="66fa" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">掩模RCNN模型简介</h1><p id="4359" class="pw-post-body-paragraph im in hi io b ip lo ir is it lp iv iw ix lq iz ja jb lr jd je jf ls jh ji jj hb bi translated">Mask RCNN是一种用于图像分割任务的深度学习模型。我将掩模RCNN模型可视化如下:</p><h2 id="9140" class="lt kr hi bd ks lu lv lw kw lx ly lz la ix ma mb le jb mc md li jf me mf lm mg bi translated">主干网络-实现为ResNet 101和特征金字塔网络(FPN)，该网络提取初始特征地图，该地图被向前传播到其他组件。</h2><h2 id="5171" class="lt kr hi bd ks lu lv lw kw lx ly lz la ix ma mb le jb mc md li jf me mf lm mg bi translated">区域建议网络(RPN)—用于从图像中提取感兴趣区域(ROI ),并应用非最大值抑制来选择从RPN生成的最合适的边界框或ROI。</h2><h2 id="6d88" class="lt kr hi bd ks lu lv lw kw lx ly lz la ix ma mb le jb mc md li jf me mf lm mg bi translated">ROI Align —将感兴趣区域(ROI)包裹成固定的尺寸。</h2><h2 id="3071" class="lt kr hi bd ks lu lv lw kw lx ly lz la ix ma mb le jb mc md li jf me mf lm mg bi translated">完全连接的图层-由两个平行图层组成，一个使用softmax进行分类，另一个使用回归进行边界框预测。</h2><h2 id="dd5a" class="lt kr hi bd ks lu lv lw kw lx ly lz la ix ma mb le jb mc md li jf me mf lm mg bi translated">遮罩分类器—为图像中的每个实例生成二进制遮罩。</h2><figure class="mi mj mk ml fd ij er es paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="er es mh"><img src="../Images/7db72a21f9d5b811192500fe92d75807.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x0gmsXkJwVfOCoD14wBFuA.png"/></div></div><figcaption class="mq mr et er es ms mt bd b be z dx translated">掩膜RCNN架构，图片来源:<a class="ae ki" href="https://arxiv.org/abs/1703.06870" rel="noopener ugc nofollow" target="_blank">掩膜RCNN论文</a></figcaption></figure><h1 id="58b8" class="kq kr hi bd ks kt mu kv kw kx mv kz la lb mw ld le lf mx lh li lj my ll lm ln bi translated">关于我的Mask RCNN模型</h1><p id="ec1f" class="pw-post-body-paragraph im in hi io b ip lo ir is it lp iv iw ix lq iz ja jb lr jd je jf ls jh ji jj hb bi translated">我开发了一个掩模RCNN模型来检测汽车的四种外部损伤，即划痕、凹痕、破碎和错位。我已经使用步骤4 a、4 b和4 c训练了我的模型。</p><p id="1263" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">我发现如果你想要一个生成精确遮罩的模型，你应该使用用多边形标注的图像，如果你只需要一个精确的边界框，你可以使用边界框标注。</p><h1 id="8893" class="kq kr hi bd ks kt mu kv kw kx mv kz la lb mw ld le lf mx lh li lj my ll lm ln bi translated">步骤1:数据收集和清理</h1><p id="92cc" class="pw-post-body-paragraph im in hi io b ip lo ir is it lp iv iw ix lq iz ja jb lr jd je jf ls jh ji jj hb bi translated">任何数据科学项目的第一步都是收集数据。你可以使用BeautifulSoup收集静态网页的图像数据，或者使用Selenium收集交互式网页的图像数据，也可以使用在<a class="ae ki" href="https://www.kaggle.com/datasets" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上提供的开源数据集。如果你想创建一个小数据集，你可以手动从Google Images下载图片。收集数据集后，您需要清理不适合您的任务的图像。一件重要的事情是确保你给每张图片命名时都有一个唯一的数字id例如:0001.jpg、0002.jpg等等。</p><p id="9884" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">对于边界框注记，数据集目录结构应为:</p><pre class="mi mj mk ml fd mz na nb nc aw nd bi"><span id="9a68" class="lt kr hi na b fi ne nf l ng nh">customImages<br/>    |__ annots (all .xml annotation)<br/>    |__ images (all images)</span></pre><p id="bdda" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">对于面注记，数据集目录结构应为:</p><pre class="mi mj mk ml fd mz na nb nc aw nd bi"><span id="893c" class="lt kr hi na b fi ne nf l ng nh">customImages<br/>    |__ train (all training images and annotation file)<br/>    |__ val (all validation images and annotation file)</span></pre><h1 id="1615" class="kq kr hi bd ks kt mu kv kw kx mv kz la lb mw ld le lf mx lh li lj my ll lm ln bi translated">步骤2:图像注释</h1><p id="f361" class="pw-post-body-paragraph im in hi io b ip lo ir is it lp iv iw ix lq iz ja jb lr jd je jf ls jh ji jj hb bi translated">正如你可能知道的，神经网络是监督学习算法，因此你需要用基本事实来注释你的图像，即在你想要检测的物体周围创建一个边界框或多边形。对于多边形注释，我推荐使用<a class="ae ki" href="https://www.robots.ox.ac.uk/~vgg/software/via/" rel="noopener ugc nofollow" target="_blank"> VGG图像注释器</a>，对于边界框注释使用<a class="ae ki" href="https://github.com/tzutalin/labelImg" rel="noopener ugc nofollow" target="_blank">label mg</a>。</p><figure class="mi mj mk ml fd ij er es paragraph-image"><div class="er es ni"><img src="../Images/6c258680c1158caa9ec31eec72a4ec7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*zXwt_-coJTvbCLuGCt8IxA.png"/></div><figcaption class="mq mr et er es ms mt bd b be z dx translated">用VGG图像注释器进行多边形注释</figcaption></figure><figure class="mi mj mk ml fd ij er es paragraph-image"><div class="er es nj"><img src="../Images/926d5b2d7721d72dc34528af1997d8ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*ZW650eoj_D9YBkPcjcf9_A.jpeg"/></div><figcaption class="mq mr et er es ms mt bd b be z dx translated">带标签的边框标注</figcaption></figure><h1 id="e384" class="kq kr hi bd ks kt mu kv kw kx mv kz la lb mw ld le lf mx lh li lj my ll lm ln bi translated">步骤3:下载需求</h1><p id="394b" class="pw-post-body-paragraph im in hi io b ip lo ir is it lp iv iw ix lq iz ja jb lr jd je jf ls jh ji jj hb bi translated">首先，您需要克隆matterport Mask RCNN存储库。</p><pre class="mi mj mk ml fd mz na nb nc aw nd bi"><span id="3e50" class="lt kr hi na b fi ne nf l ng nh"><em class="kc">git clone </em><a class="ae ki" href="https://github.com/matterport/Mask_RCNN.git" rel="noopener ugc nofollow" target="_blank">https://github.com/matterport/Mask_RCNN.git</a></span></pre><p id="3271" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">其次，从Matterport存储库中，需要安装Mask RCNN库。</p><pre class="mi mj mk ml fd mz na nb nc aw nd bi"><span id="d204" class="lt kr hi na b fi ne nf l ng nh">cd Mask_RCNN<br/>python setup.py install</span></pre><p id="7fae" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">对于Linux/ Mac OS，请使用sudo命令。</p><p id="11ab" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">第三，您需要安装以下软件包来训练模型。</p><blockquote class="nk nl nm"><p id="cff4" class="im in kc io b ip iq ir is it iu iv iw nn iy iz ja no jc jd je np jg jh ji jj hb bi translated"><em class="hi"> numpy </em></p><p id="5256" class="im in kc io b ip iq ir is it iu iv iw nn iy iz ja no jc jd je np jg jh ji jj hb bi translated"><em class="hi"> scipy </em></p><p id="3694" class="im in kc io b ip iq ir is it iu iv iw nn iy iz ja no jc jd je np jg jh ji jj hb bi translated"><em class="hi">枕头</em></p><p id="d6bb" class="im in kc io b ip iq ir is it iu iv iw nn iy iz ja no jc jd je np jg jh ji jj hb bi translated"><em class="hi"> cython </em></p><p id="95ab" class="im in kc io b ip iq ir is it iu iv iw nn iy iz ja no jc jd je np jg jh ji jj hb bi translated"><em class="hi"> matplotlib </em></p><p id="48b0" class="im in kc io b ip iq ir is it iu iv iw nn iy iz ja no jc jd je np jg jh ji jj hb bi translated"><em class="hi"> scikit-image </em></p><p id="f930" class="im in kc io b ip iq ir is it iu iv iw nn iy iz ja no jc jd je np jg jh ji jj hb bi translated"><em class="hi">张量流&gt; =1.3.0 </em></p><p id="bcb2" class="im in kc io b ip iq ir is it iu iv iw nn iy iz ja no jc jd je np jg jh ji jj hb bi translated"><em class="hi"> keras &gt; =2.0.8 </em></p><p id="12b1" class="im in kc io b ip iq ir is it iu iv iw nn iy iz ja no jc jd je np jg jh ji jj hb bi translated"><em class="hi"> opencv-python </em></p><p id="a0fc" class="im in kc io b ip iq ir is it iu iv iw nn iy iz ja no jc jd je np jg jh ji jj hb bi translated"><em class="hi"> h5py </em></p><p id="e577" class="im in kc io b ip iq ir is it iu iv iw nn iy iz ja no jc jd je np jg jh ji jj hb bi translated"><em class="hi">伊姆高格</em></p><p id="4726" class="im in kc io b ip iq ir is it iu iv iw nn iy iz ja no jc jd je np jg jh ji jj hb bi translated"><em class="hi">IPython[全部] </em></p></blockquote><p id="0def" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这可以通过安装requirements.txt文件来完成，该文件可以从matterport存储库中获得，也可以从我自己的Mask RCNN <a class="ae ki" href="https://github.com/EashanKaushik/car-damage-detecting-MaskRCNN" rel="noopener ugc nofollow" target="_blank">项目存储库</a>中获得。</p><pre class="mi mj mk ml fd mz na nb nc aw nd bi"><span id="8f9f" class="lt kr hi na b fi ne nf l ng nh">pip3 install -r requirements.txt</span></pre><p id="57d5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">最后，在这里下载MS COCO数据集<a class="ae ki" href="https://github.com/matterport/Mask_RCNN/releases" rel="noopener ugc nofollow" target="_blank">的掩膜RCNN权重。您将在这些预训练的权重上训练您的自定义数据集，并利用迁移学习。</a></p><p id="150a" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">既然你都准备好了！！让我们开始训练您的自定义数据集模型。</p><h1 id="fa6c" class="kq kr hi bd ks kt mu kv kw kx mv kz la lb mw ld le lf mx lh li lj my ll lm ln bi translated">模特培训</h1><p id="5bb9" class="pw-post-body-paragraph im in hi io b ip lo ir is it lp iv iw ix lq iz ja jb lr jd je jf ls jh ji jj hb bi translated">数据集类—我们将数据集类功能继承到我们的用户定义类CustomDataset中。这使我们能够创建自己的函数来提取边界框、加载遮罩和加载数据集。</p><p id="095b" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">load_dataset函数—此函数负责在数据集中训练我们的模型之前添加类和图像，这是通过使用self.add_image()添加图像和self.add_class()添加类来完成的。</p><pre class="mi mj mk ml fd mz na nb nc aw nd bi"><span id="6fb9" class="lt kr hi na b fi ne nf l ng nh">self.add_image(source, image_id, path, annotation) # bounding box<br/>self.add_image(source, image_id, path, width, height, polygons, num_ids)# polygon</span><span id="d198" class="lt kr hi na b fi nq nf l ng nh">self.add_class(source, class_id, class_name)</span></pre><p id="2ea5" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">extract_boxes函数——该函数仅在边界框注释的情况下使用，我们需要提取定义边界框的4个值，即xmin、ymin、xmax和ymax，以及图像的高度和宽度。</p><p id="3679" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">load_mask函数-该函数用于边界框注释和多边形注释图像，并用于加载遮罩。请注意，在边界框注释图像的情况下，遮罩将始终是一个框。</p><p id="c487" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">image_inference函数—该函数用于返回给定图像id的图像路径。</p><p id="386c" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">Config类——我们继承Config类来初始化我们的配置。我们需要一个单独的培训和测试配置。使用以下内容显示配置:</p><pre class="mi mj mk ml fd mz na nb nc aw nd bi"><span id="e368" class="lt kr hi na b fi ne nf l ng nh">config = CustomConfig()<br/>config.display()</span></pre><p id="ada6" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">evaluate_model函数-该函数在全局命名空间中声明，用于计算模型的平均精度(mAP)。</p><h2 id="4ce7" class="lt kr hi bd ks lu lv lw kw lx ly lz la ix ma mb le jb mc md li jf me mf lm mg bi translated">导入库</h2><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="nr ns l"/></div></figure><p id="d9bc" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">注意:您只需要使用步骤4中的一个子步骤(a、b或c)来训练模型。但是，请从步骤4 a开始理解代码。您可以在我的<a class="ae ki" href="https://github.com/EashanKaushik/car-damage-detecting-MaskRCNN" rel="noopener ugc nofollow" target="_blank">项目库</a>的模型训练目录中找到所有的模型训练代码。</p><h2 id="87ff" class="lt kr hi bd ks lu lv lw kw lx ly lz la ix ma mb le jb mc md li jf me mf lm mg bi translated">步骤4 a:模型训练(包围盒注释和单个类别分类)</h2><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="nr ns l"/></div></figure><h2 id="5eb1" class="lt kr hi bd ks lu lv lw kw lx ly lz la ix ma mb le jb mc md li jf me mf lm mg bi translated">步骤4 b:模型训练(边界框注释和多类分类)</h2><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="nr ns l"/></div></figure><h2 id="0d3f" class="lt kr hi bd ks lu lv lw kw lx ly lz la ix ma mb le jb mc md li jf me mf lm mg bi translated">步骤4 c:模型训练(多边形标注和多类分类)</h2><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="nr ns l"/></div></figure><p id="1fc2" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">既然您已经理解了所有三种场景的代码。你能自己为下面的场景修改上面的代码吗？</p><blockquote class="nk nl nm"><p id="6233" class="im in kc io b ip iq ir is it iu iv iw nn iy iz ja no jc jd je np jg jh ji jj hb bi translated"><strong class="io hj">多边形标注和单类分类</strong></p></blockquote><h1 id="b753" class="kq kr hi bd ks kt mu kv kw kx mv kz la lb mw ld le lf mx lh li lj my ll lm ln bi translated">图像增强</h1><p id="ce41" class="pw-post-body-paragraph im in hi io b ip lo ir is it lp iv iw ix lq iz ja jb lr jd je jf ls jh ji jj hb bi translated">图像数据扩充是一种可用于通过在数据集中创建图像的修改版本来人工扩展训练数据集的大小的技术。这可以通过上下左右翻转图像、旋转图像或缩放图像来实现。这可以通过以下方式实现:</p><pre class="mi mj mk ml fd mz na nb nc aw nd bi"><span id="3c48" class="lt kr hi na b fi ne nf l ng nh">import imgaug.augmenters as iaa</span><span id="67b9" class="lt kr hi na b fi nq nf l ng nh">model.train(train_set,<br/>            test_set,<br/>            learning_rate=config.LEARNING_RATE,<br/>            epochs=15,<br/>            layers='all',<br/>            augmentation = iaa.Sometimes(5/6,iaa.OneOf([<br/>            iaa.Fliplr(1),<br/>            iaa.Flipud(1),<br/>            iaa.Affine(rotate=(-45, 45)),<br/>            iaa.Affine(rotate=(-90, 90)),<br/>            iaa.Affine(scale=(0.5, 1.5))<br/>            ])))</span></pre><h1 id="045b" class="kq kr hi bd ks kt mu kv kw kx mv kz la lb mw ld le lf mx lh li lj my ll lm ln bi translated">第五步:模型评估</h1><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="nr ns l"/></div></figure><p id="4972" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果你不能完成TODO任务，参考我的<a class="ae ki" href="https://github.com/EashanKaushik/car-damage-detecting-MaskRCNN/blob/main/model-training/master.ipynb" rel="noopener ugc nofollow" target="_blank">训练笔记本</a>。</p><h1 id="dd31" class="kq kr hi bd ks kt mu kv kw kx mv kz la lb mw ld le lf mx lh li lj my ll lm ln bi translated">步骤6:单幅图像预测</h1><figure class="mi mj mk ml fd ij"><div class="bz dy l di"><div class="nr ns l"/></div></figure><h1 id="e52e" class="kq kr hi bd ks kt mu kv kw kx mv kz la lb mw ld le lf mx lh li lj my ll lm ln bi translated">步骤7:在本地使用Flask进行网站部署</h1><p id="10b1" class="pw-post-body-paragraph im in hi io b ip lo ir is it lp iv iw ix lq iz ja jb lr jd je jf ls jh ji jj hb bi translated">当你对你的模型的表现感到满意时，下一步就是为用户开发一个与模型互动的网站。本节不解释代码，只提供给你<a class="ae ki" href="https://github.com/EashanKaushik/car-damage-detecting-MaskRCNN" rel="noopener ugc nofollow" target="_blank">使用</a>。</p><ol class=""><li id="9a4e" class="jt ju hi io b ip iq it iu ix jv jb jw jf jx jj jy jz ka kb bi translated">将您的_trained_weights.m5文件放在模型目录中。</li><li id="e7af" class="jt ju hi io b ip kd it ke ix kf jb kg jf kh jj jy jz ka kb bi translated">将app/utils.py中的第22行更改为模型权重的名称。</li><li id="e7a7" class="jt ju hi io b ip kd it ke ix kf jb kg jf kh jj jy jz ka kb bi translated">运行main.py文件，网站将托管在<a class="ae ki" href="http://127.0.0.1:5000/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:5000/ </a>上。以下是我开发的URL规则，您可以根据自己的喜好添加或删除这些规则。</li></ol><pre class="mi mj mk ml fd mz na nb nc aw nd bi"><span id="cf24" class="lt kr hi na b fi ne nf l ng nh">app.add_url_rule('/base','base',views.base)<br/>app.add_url_rule('/','index',views.index)<br/>app.add_url_rule('/damageapp','damageapp',views.damageapp)<br/>app.add_url_rule('/damageapp/damage','damage',views.damage,methods=['GET','POST'])</span></pre><p id="ab5d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">如果不想使用成本评估功能，只需将app/views.py第45行的cost_for_damage变量更改为False。成本评估功能仅用于视觉目的，并根据蒙版尺寸与图像尺寸的比率来计算成本。</p><p id="ccac" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">注意:使用我的GitHub资源库中的mcrnn目录进行部署，因为我已经对原始库做了一些更改。</p></div><div class="ab cl kj kk gp kl" role="separator"><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko kp"/><span class="km bw bk kn ko"/></div><div class="hb hc hd he hf"><h1 id="4bba" class="kq kr hi bd ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">参考</h1><p id="77e8" class="pw-post-body-paragraph im in hi io b ip lo ir is it lp iv iw ix lq iz ja jb lr jd je jf ls jh ji jj hb bi translated">[1] <a class="ae ki" href="https://arxiv.org/abs/1703.06870" rel="noopener ugc nofollow" target="_blank"> He，k .，Gkioxari，g .，Dollár，p .，Girshick，R .，<em class="kc"> arXiv e-prints </em>，2017。</a></p><p id="3b79" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">[2] <a class="ae ki" href="https://github.com/matterport/Mask_RCNN" rel="noopener ugc nofollow" target="_blank">通过matterport屏蔽R-CNN进行对象检测和分割</a>。</p></div></div>    
</body>
</html>