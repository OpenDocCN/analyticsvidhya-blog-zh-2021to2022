<html>
<head>
<title>Bert For Question Answering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于问答的Bert</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/bert-for-question-answering-cd00741d1dab?source=collection_archive---------6-----------------------#2021-05-07">https://medium.com/analytics-vidhya/bert-for-question-answering-cd00741d1dab?source=collection_archive---------6-----------------------#2021-05-07</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="3070" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇文章中，我将展示“Bert问答”(<strong class="ig hi"> Bert QA </strong>)的基本用法，在接下来的文章中，我将展示如何微调。<br/>github代码:<a class="ae jc" href="https://github.com/mcelikkaya/medium_articles2/blob/main/bert_question_answer.ipynb" rel="noopener ugc nofollow" target="_blank">链接</a></p><p id="c1c7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">像所有的变压器一样，用法非常简单。我们给出两个参数上下文和问题。上下文是你的段落，问答将在其中搜索你的答案。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="ji jj l"/></div></figure><p id="b7d1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在第10行，你可以看到我们正在对上下文和问题进行编码。“inputs _ ids”是文本的标记化id。在下图中你可以看到结果。Tokenizer为我们返回3个张量。Bert QA在上下文前附加问题。如果你的上下文太长，你可以把它分成几部分，然后把问题附加到所有这些部分上。<strong class="ig hi">标记类型</strong> 0用于问题部分，1用于上下文。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es jk"><img src="../Images/e2d719e5801744df08ea177032c7defe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_3fZy03dLSQX72edKz-xug.png"/></div></div><figcaption class="jr js et er es jt ju bd b be z dx translated"><strong class="bd jv">encode _ plus方法的输出</strong></figcaption></figure><p id="9279" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您解码这些id，输出将如下所示。<br/> <strong class="ig hi"> CLS +问句+ SEP +语境</strong></p><pre class="jd je jf jg fd jw jx jy jz aw ka bi"><span id="de78" class="kb kc hh jx b fi kd ke l kf kg">tokenizer.decode( answer_map[“input_ids”] )</span><span id="cea0" class="kb kc hh jx b fi kh ke l kf kg">[CLS] where is most populous in the world? [SEP] japan is the eleventh - most populous country in the world, as well as one of the most densely populated and urbanized. about three - fourths of the country's terrain is mountainous, concentrating its population of 125. 57 million on narrow coastal plains. japan is divided into 47 administrative prefectures and eight traditional regions. osaka has a big population of 16 million. the greater tokyo area is the most populous metropolitan area in the world, with more than 37. 4 million residents. [SEP]</span></pre><p id="f8e3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将这一信息输入到模型中。(第14行)<br/>输出是上述编码输入中每个位置的多个分数的张量。"<strong class="ig hi"> start_logits </strong>"和"<strong class="ig hi"> end_logits </strong>"确定答案的开始和结束。因为这些是分数，所以它们在顺序中是可能的。(还要注意，文档说所有逻辑输出对都是候选答案。逻辑的意思是开始索引小于结束索引，并且开始索引不是0，也不是问题或CLS的开始)</p><p id="45f9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">模型将返回一个分数为所有令牌给我们，这有可能是正确的答案。我可以想象出如下的答案。如你所见，算法关注于回答开始的早期标记。同样，对于这个问题，第一个答案是日本，因此结束令牌仅在开始令牌之后1个令牌。你可以在橙色柱状图中看到。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="jl jm di jn bf jo"><div class="er es ki"><img src="../Images/b2c619816d1e9b27d38d8c5d0ab588d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a31xLeZAe8ebDuNseoiX_Q.png"/></div></div></figure><p id="b71f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们检查一些输入和输出对，以理解Bert在为我们做什么。我这里用的模型是<strong class="ig hi">“Bert-large-uncase-whole-word-masking-fine tuned-squad”</strong>。因此，问题和回答风格必须类似于班数据集，以获得更好的结果。测试时不要忘记这一点。</p><pre class="jd je jf jg fd jw jx jy jz aw ka bi"><span id="a553" class="kb kc hh jx b fi kd ke l kf kg"><strong class="jx hi">Question: Most populous city ?</strong><br/><strong class="jx hi">Answers:</strong><br/>1  )  greater tokyo<br/>2  )  osaka<br/>4  )  the greater tokyo area is the most populous metropolitan area in the world, with more than 37. 4 million residents.<br/>5  )  japan is the eleventh - most populous country in the world, as well as one of the most densely populated and urbanized. about three - fourths of the country's terrain is mountainous, concentrating its population of 125. 57 million on narrow coastal plains. japan is divided into 47 administrative prefectures and eight traditional regions. osaka has a big population of 16 million. the greater tokyo area is the most populous metropolitan area in the world<br/><strong class="jx hi">Question: Most populous city</strong><br/><strong class="jx hi">Answers:</strong><br/>1  )  japan is the eleventh - most populous country in the world<br/>2  )  greater tokyo<br/>3  )  eleventh - most populous country in the world, as well as one of the most densely populated and urbanized.<br/>4  )  the greater tokyo area is the most populous metropolitan area in the world, with more than 37. 4 million residents.</span></pre><p id="3dfd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上面你可以看到两个问题和它们可能的答案。例如，在第一个问题中，缺少第三个答案。这意味着答案的结束索引小于其开始索引，因此不是有效答案。你可以看到问题只有问号不同，但答案不同。所以我们可以理解BERT QA对标点符号比较敏感。</p><p id="56d3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">把更多的样品放在上面。你可以自己玩代码，写更好的问题，上下文并试图更好地理解。你可以看到前一个答案更有意义，第四个答案后，它们似乎有点不相关。</p><pre class="jd je jf jg fd jw jx jy jz aw ka bi"><span id="7708" class="kb kc hh jx b fi kd ke l kf kg"><strong class="jx hi">Question: Where is the most populous metropolitan area in the world ?</strong><br/><strong class="jx hi">Answers</strong>:<br/>1  )  greater tokyo area<br/>2  )  the greater tokyo<br/>3  )  tokyo area is the most populous metropolitan area in the world, with more than 37. 4 million residents.<br/>4  )  japan is the eleventh - most populous country in the world, as well as one of the most densely populated and urbanized. about three - fourths of the country's terrain is mountainous, concentrating its population of 125. 57 million on narrow coastal plains. japan is divided into 47 administrative prefectures and eight traditional regions. osaka has a big population of 16 million. the greater tokyo area is the most populous metropolitan area in the world<br/>5  )  japan is divided into 47 administrative prefectures and eight traditional regions. osaka has a big population of 16 million. the greater tokyo area is the most populous metropolitan area in the world,<br/><strong class="jx hi">Question: Where is the most populous city ?</strong><br/><strong class="jx hi">Answers</strong>:<br/>1  )  osaka<br/>2  )  greater tokyo<br/>4  )  japan<br/>5  )  the greater tokyo area<br/><strong class="jx hi">Question: What is the most populous city ?</strong><br/><strong class="jx hi">Answers</strong>:<br/>1  )  osaka has a big population of 16 million. the greater tokyo<br/>5  )  japan is the eleventh - most populous country in the world, as well as one of the most densely populated and urbanized. about three - fourths of the country's terrain is mountainous, concentrating its population of 125. 57 million on narrow coastal plains. japan is divided into 47 administrative prefectures and eight traditional regions. osaka has a big population of 16 million. the greater tokyo area<br/><strong class="jx hi">Question: Where is most populous in the world ?</strong><br/><strong class="jx hi">Answers</strong>:<br/>1  )  japan is the eleventh<br/>3  )  the eleventh - most populous country in the world<br/><strong class="jx hi">Question: Where is most populous?</strong><br/><strong class="jx hi">Answers</strong>:<br/>1  )  eleventh - most populous country in the world<br/>2  )  japan is the eleventh<br/><strong class="jx hi">Question: What is Population of Tokyo ?</strong><br/><strong class="jx hi">Answers</strong>:<br/>1  )  37. 4 million<br/>2  )  more than 37. 4 million residents<br/>3  )  the greater tokyo area is the most populous metropolitan area in the world, with more than 37. 4 million residents.<br/>4  )  tokyo area is the most populous metropolitan area in the world, with more than 37. 4<br/>5  )  greater tokyo area is the most populous metropolitan area in the world, with more than 37<br/>Question: Which city is most crowded in the world ?<br/>Answers:<br/>1  )  japan<br/>2  )  tokyo<br/>3  )  osaka<br/>5  )  the greater tokyo area is the most populous metropolitan area in the world, with more than 37. 4 million residents.<br/><strong class="jx hi">Question: Which city has biggest population ?</strong><br/><strong class="jx hi">Answers</strong>:<br/>1  )  osaka<br/>2  )  16 million<br/>4  )  japan is the eleventh - most populous country in the world, as well as one of the most densely populated and urbanized. about three - fourths of the country's terrain is mountainous, concentrating its population of 125. 57 million on narrow coastal plains. japan is divided into 47 administrative prefectures and eight traditional regions. osaka has a big population of 16 million. the greater tokyo<br/><strong class="jx hi">Question: Which city has most population ?</strong><br/><strong class="jx hi">Answers</strong>:<br/>1  )  osaka<br/>2  )  japan is the eleventh - most populous country in the world, as well as one of the most densely populated and urbanized. about three - fourths of the country's terrain is mountainous, concentrating its population of 125. 57 million on narrow coastal plains. japan is divided into 47 administrative prefectures and eight traditional regions. osaka has a big population of 16 million.<br/>4  )  greater tokyo</span></pre><p id="88c5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇文章中，我试图展示<strong class="ig hi">伯特问题回答</strong>的基本用法。在第二篇文章中，我会试着展示微调，然后我会试着想象伯特在学什么。您可以玩代码，生成更有意义的问题，并尝试您的测试用例。由于这是使用班数据集，上下文，问题和答案必须类似于班风格，以获得良好的结果。</p></div></div>    
</body>
</html>