# ä½¿ç”¨ Python ä¸­çš„äº‹ä»¶è®¢é˜… API å’Œ Slack åº”ç”¨ç¨‹åºæ¶ˆè´¹ Slack äº‹ä»¶

> åŽŸæ–‡ï¼š<https://medium.com/analytics-vidhya/consuming-slack-events-with-event-subscription-api-and-slack-app-in-python-681cab354571?source=collection_archive---------7----------------------->

Slack æ˜¯ä¸€ä¸ªé€šç”¨çš„å¹³å°ï¼Œæ¯ä¸ªç»„ç»‡éƒ½ä½¿ç”¨å®ƒåœ¨å‘˜å·¥ä¹‹é—´è¿›è¡Œäº¤æµã€‚

**ç­‰ç­‰ï¼Œslack åªç”¨äºŽå‘˜å·¥ä¹‹é—´çš„äº¤æµå—ï¼Ÿ**

ç­”æ¡ˆï¼Œåœ¨æˆ‘çœ‹æ¥æ˜¯å¦å®šçš„ï¼Œå› ä¸º slack æä¾›äº†å„ç§ APIã€å…¥å±€ webHooksã€Bots åˆ›å»ºç­‰ã€‚è¿™ä½¿å¾—å®ƒæœ‰å¤šç§ç”¨é€”ã€‚æˆ‘ä»¬å¯ä»¥å°†ä»»ä½•å…¶ä»–æœåŠ¡ç»‘å®šåˆ° Slackã€‚ä¸ä»…å¦‚æ­¤ï¼ŒSlack è¿˜å¯ä»¥ç”¨ä½œæœåŠ¡é—´é€šä¿¡çš„ç¼“å†²åŒºã€‚

å¦‚æžœæ‚¨å¸Œæœ›æž„å»ºä¸€ä¸ªäº‹ä»¶é©±åŠ¨çš„æœåŠ¡ï¼Œæ¯å½“ Slack é€šé“ä¸­å‘ç”Ÿå˜åŒ–æ—¶è¿è¡Œæ‚¨çš„ä¸šåŠ¡é€»è¾‘ã€‚å˜åŒ–å¯ä»¥æ˜¯ä»»ä½•äº‹æƒ…ï¼Œæ¯”å¦‚æ”¶åˆ°æ–°æ¶ˆæ¯ï¼Œå¯¹æ¶ˆæ¯çš„ä»»ä½•ååº”ï¼Œæ¯”å¦‚è¡¨æƒ…ç¬¦å·ï¼Œæˆ–è€…ä»»ä½•äº‹æƒ…ã€‚è¿™åªæ˜¯æˆ‘åœ¨ **SAP Labs Indiaï¼Œ**çš„å®žä¹ ç”Ÿé¡¹ç›®çš„ä¸€éƒ¨åˆ†ï¼Œåœ¨é‚£é‡Œæˆ‘çš„å¾®æœåŠ¡éœ€è¦å¤„ç† Slackã€‚å¬èµ·æ¥å¾ˆæœ‰è¶£ï¼Œå¯¹å§ï¼Ÿé‚£ä¹ˆï¼Œå¦‚ä½•ç”¨ Slack ç»‘å®šä½ çš„äº‘æœåŠ¡å‘¢ï¼Ÿæœ‰ä»€ä¹ˆåŠžæ³•å—ï¼Ÿåœ¨è½®è¯¢ä¸­ä¸æµªè´¹ç½‘ç»œè°ƒç”¨çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬èƒ½å¾—åˆ°æ¾å¼›ä¿¡é“çš„æ›´æ–°å—ï¼Ÿ

ç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œè¿™ä¸€åˆ‡éƒ½å¯ä»¥å€ŸåŠ© Slack Events API å’Œ Slack App/bot åœ¨ Slack ä¸­å®Œæˆã€‚

* *æ³¨ Slack bot ä¹Ÿæ˜¯ä¸€æ¬¾ Slack åº”ç”¨ï¼Œæ—¨åœ¨ä¸Žç”¨æˆ·äº’åŠ¨ã€‚æ‰€ä»¥ä¸è¦æžæ··æˆ‘åœ¨å“ªé‡Œå†™äº† slack App/botã€‚ä¸ºäº†ä¾¿äºŽç†è§£ï¼Œæ‚¨å¯ä»¥å‡è®¾ä¸¤è€…ç›¸åŒã€‚*

![](img/1046ae13518403bed70b6cbbe0a1d163.png)

è®©æˆ‘å¸¦ä½ çœ‹ä¸€ä¸‹ä½¿ç”¨ Slack Events API å’Œ Slack App/bot åˆ›å»ºçš„è¿‡ç¨‹ã€‚æˆ‘ä»¬å°†åˆ†ä¸¤æ­¥è¿›è¡Œï¼Œå¦‚ä¸‹æ‰€ç¤º:

**1ã€‚åˆ›å»º Slack åº”ç”¨ç¨‹åº/æœºå™¨äººå¹¶è®¢é˜…äº‹ä»¶ã€‚**

**2ã€‚ä»Žæˆ‘ä»¬çš„ python æœåŠ¡ä¸­æ¶ˆè´¹è¿™äº›äº‹ä»¶ã€‚**

> **æ­¥éª¤ 1:åˆ›å»º Slack App/bot å¹¶è®¢é˜…äº‹ä»¶:**

æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬çš„æœåŠ¡åœ¨æˆ‘ä»¬çš„ Slack å·¥ä½œç©ºé—´å‘ç”Ÿä»»ä½•å˜åŒ–æ—¶éƒ½èƒ½å¾—åˆ°é€šçŸ¥ã€‚å¯¹å—ï¼Ÿæˆ‘ä»¬ä¹Ÿå¿…é¡»æŠŠè¿™ä¸€åˆ‡å‘Šè¯‰æ–¯èŽ±å…‹ã€‚ä½†æ˜¯æˆ‘ä»¬å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼ŸSlack App/bot å°±æ˜¯è¿™æ ·åšçš„ã€‚æ‰€ä»¥è®©æˆ‘ä»¬åˆ›é€ ä¸€ä¸ª yooooâ€¦..

1.  [https://api.slack.com/](https://api.slack.com/)åœ¨å³ä¸Šæ–¹ä½ ä¼šçœ‹åˆ°**ä½ çš„åº”ç”¨**é€‰é¡¹

![](img/169d7da307df85234032df05f1114e5a.png)

2.ç‚¹å‡»ä½ çš„åº”ç”¨ç¨‹åºï¼Œä½ å¯ä»¥çœ‹åˆ°ä½ åˆ›å»ºçš„æ‰€æœ‰åº”ç”¨ç¨‹åºã€‚

![](img/bd2d9b0df4576884941c592cfddbabec.png)

3.ç‚¹å‡»åˆ›å»ºåº”ç”¨ç¨‹åºé€‰é¡¹ã€‚

![](img/21731caf1627087bdbdb144432ca90f3.png)

4.ç‚¹å‡»ä»Žå¤´å¼€å§‹ï¼Œç»™ä½ çš„åº”ç”¨ç¨‹åºå‘½åï¼Œå¹¶é€‰æ‹©å·¥ä½œåŒºã€‚ç‚¹å‡»åˆ›å»ºåº”ç”¨ç¨‹åºã€‚

![](img/62cb5198a859e75326543a07bb5d3ec5.png)

5.çŽ°åœ¨ï¼Œæ‚¨çš„åº”ç”¨ç¨‹åºå·²ç»åˆ›å»ºï¼Œå°±åƒæˆ‘ä»¬å·²ç»é›‡ç”¨äº†ä¸€ä¸ªäººï¼Œä½†æˆ‘ä»¬éœ€è¦ç»™ä»–åˆ†é…ä¸€ä»½å·¥ä½œã€‚æ‰€ä»¥è®©æˆ‘ä»¬æ¥åˆ†é…å®ƒã€‚ä½ ä¸€å®šä¼šçœ‹åˆ°å’Œä¸‹å›¾ä¸€æ ·çš„å±å¹•ã€‚

![](img/67ea86374e4bb9ad6b1e2aea55221351.png)

åœ¨æœ€å·¦æ çš„é¡¶éƒ¨ï¼Œä½ ä¼šçœ‹åˆ°ä½ çš„åº”ç”¨ç¨‹åºåç§°ï¼Œåœ¨æˆ‘çš„ä¾‹å­ä¸­æ˜¯ **For-article-demoã€‚**

6.ä»Žâ€œåŠŸèƒ½â€ä¸‹æœ€å·¦ä¾§çš„åˆ—ä¸­é€‰æ‹©äº‹ä»¶è®¢é˜…ã€‚

![](img/2da2e8f64e7c857786836973aec15137.png)

7.ä¸ºæ‚¨çš„ slack åº”ç”¨ç¨‹åºæ¿€æ´»æ´»åŠ¨è®¢é˜…

![](img/7079109f1c275feac2f10bbe39fbc6d0.png)

çŽ°åœ¨ï¼Œåœ¨è¯·æ±‚ URL ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç»™å‡ºæˆ‘ä»¬çš„æœåŠ¡çš„ URLï¼Œå®ƒåº”è¯¥åœ¨ web ä¸Šã€‚Slack å°†é€šè¿‡å‘è¿™ä¸ª URL å‘é€ POST è¯·æ±‚æ¥éªŒè¯è¿™ä¸ªç«¯ç‚¹ã€‚æˆ‘ä»¬çš„æœåŠ¡åº”è¯¥è¿”å›žè´¨è¯¢å‚æ•°ä½œä¸ºå“åº”æˆ–æ¾å¼›éªŒè¯ä»¤ç‰Œ(æ‚¨å¯ä»¥åœ¨åŸºæœ¬ä¿¡æ¯ä¸­æ‰¾åˆ°)ã€‚ä¸€æ—¦è¿™è¢«éªŒè¯ï¼ŒSlack åº”ç”¨ç¨‹åºå°†åªåœ¨è¿™ä¸ªç«¯ç‚¹ä¸Šå‘é€æ‰€æœ‰æœªæ¥çš„äº‹ä»¶ã€‚

* *æ³¨æ„ï¼Œå¦‚æžœæ‚¨çš„æœåŠ¡ä¸åœ¨ web ä¸Šï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ ngrok å·¥å…·ï¼Œå°†æµé‡ä»Ž ngrok è½¬å‘åˆ°æ‚¨çš„æœ¬åœ°ç«¯å£ã€‚*

ç»è¿‡éªŒè¯åº”è¯¥æ˜¯è¿™æ ·çš„:

![](img/c126b892775ad4e1237dbf4aaffa26eb.png)

æ‰€ä»¥åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»é›‡äº†ä¸€ä¸ªäººï¼Œå‘Šè¯‰ä»–ä»¬é€šè¿‡ç»™æˆ‘ä»¬çš„åœ°å€åœ¨æˆ‘ä»¬çš„åŠžå…¬å®¤æ›´æ–°æˆ‘ä»¬ã€‚

çŽ°åœ¨è®©æˆ‘ä»¬ç»™ä»–åˆ†é…ä¸€äº›å·¥ä½œï¼Œæ„å‘³ç€ä¸ºæˆ‘ä»¬çš„ Slack åº”ç”¨ç¨‹åºè®¢é˜…ä¸€äº›äº‹ä»¶ã€‚

![](img/abdcbc5282545b7dc81704f9aef0f1fd.png)

é€‰æ‹© bot äº‹ä»¶åŽï¼Œå•å‡»ä¿å­˜æ›´æ”¹ã€‚

éªŒè¯ç»ˆç‚¹çš„ä»£ç ã€‚

8.å•å‡» OAuth & Permissionï¼Œå°†åº”ç”¨ç¨‹åºå®‰è£…åˆ°æ‚¨çš„å·¥ä½œåŒºã€‚

![](img/38bbce72e43621f381272b35d3e80394.png)![](img/856997cb1e6826108edc18632abcf0e8.png)

ä¸€æ—¦ä½ æŠŠæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå®‰è£…åˆ°ä½ çš„å·¥ä½œåŒºï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ª**æœºå™¨äººç”¨æˆ· OAuth ä»¤ç‰Œ**ï¼Œç”¨äºŽ API éªŒè¯ã€‚

![](img/2a58d96813919f174416fdd3ad267446.png)

9.çŽ°åœ¨ï¼Œè®©æˆ‘ä»¬å°†æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ·»åŠ åˆ° slack é€šé“ä¸­ï¼Œä»¥èŽ·å–æ¶ˆæ¯ä½œä¸ºäº‹ä»¶ã€‚

1.åœ¨èŠå¤©æ¡†ä¸­é”®å…¥@app_nameï¼Œç„¶åŽæŒ‰å›žè½¦é”®

![](img/9c4f306d82c7610b18985ab147d95881.png)![](img/9c4f306d82c7610b18985ab147d95881.png)

2.è¿™é‡Œ**ä¸ºæ–‡ç« æ¼”ç¤º**æ˜¯ä¸€ä¸ªåº”ç”¨åç§°

![](img/fa079556305bcd49e5bc8d7feaf79eed.png)![](img/8b6f32d8f7dd72ed0eb26990cab8967a.png)

> **æ­¥éª¤ 2:çŽ°åœ¨è®©æˆ‘ä»¬ä»Ž python æœåŠ¡ä¸­æ¶ˆè´¹è¿™äº›äº‹ä»¶**:

è®©æˆ‘ä»¬åœ¨ç©ºé—²æ—¶å‘é€æ¶ˆæ¯ã€‚

![](img/def0487e295b152de6842647d74c6e0f.png)

æ‚¨å°†åœ¨ python æœåŠ¡ä¸­èŽ·å¾—åä¸º message çš„äº‹ä»¶ã€‚

æœ‰æ•ˆè´Ÿè½½å°†å¦‚ä¸‹æ‰€ç¤º:

*æ³¨æ„:æˆ‘å·²ç»ç”¨ xxxxxxxxx æ›¿æ¢äº†å…¶ä»–è¯¦ç»†ä¿¡æ¯

çŽ°åœ¨ï¼Œæ‚¨å°†æ”¶åˆ°æ‚¨çš„åº”ç”¨ç¨‹åºè®¢é˜…çš„æ‰€æœ‰ slack äº‹ä»¶ã€‚æœ€åŽï¼Œå…¨éƒ¨å®ŒæˆðŸ¤©ã€‚

ðŸ˜µè¿™ä¸ªè¿‡ç¨‹æœ‰ç‚¹é•¿ï¼Œæœ‰ç‚¹æ··ä¹±ï¼Œä½†æ˜¯è¿™ä¸ªç‰¹æ€§éžå¸¸æœ‰è¶£ã€‚

å¸Œæœ›ä½ å–œæ¬¢å®ƒï¼ï¼ï¼

> å‚è€ƒèµ„æ–™:
> 
> [https://api.slack.com/apis/connections/events-api](https://api.slack.com/apis/connections/events-api)ï¼Œ[https://www.youtube.com/watch?v=6gHvqXrfjuo](https://www.youtube.com/watch?v=6gHvqXrfjuo)