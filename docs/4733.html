<html>
<head>
<title>Car Brand Classification using VGG16-Transfer Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于vgg 16-迁移学习的汽车品牌分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/car-brand-classification-using-vgg16-transfer-learning-f219a0f09765?source=collection_archive---------0-----------------------#2022-01-25">https://medium.com/analytics-vidhya/car-brand-classification-using-vgg16-transfer-learning-f219a0f09765?source=collection_archive---------0-----------------------#2022-01-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/bbd62e3435cfad779eaf88381fd548d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:598/format:webp/1*m5Cs6ml23Z76sGgCV0Azbw.jpeg"/></div></figure><h1 id="215e" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">介绍</h1><p id="8a82" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">在本文中，我们将使用VGG16迁移学习模型完成一个汽车品牌分类的小型项目。我们将尝试创建一个模型，可以识别汽车的类别，即奥迪，奔驰和兰博基尼的图像为基础。</p><p id="8768" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">首先，我将简要介绍VGG16架构，然后我们将深入了解使用Keras的VGG16预训练模型的每一行。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es kn"><img src="../Images/35f00a134c01c9d86444f21f64ed2b06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WXaMQ_qR44zQJyQ1inGd6Q.png"/></div></div></figure><h1 id="7ef6" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">VGG16</h1><p id="d572" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">VGG16是一个16层的迁移学习架构，与早期的架构非常相似，因为它的基础仅基于CNN，但排列有点不同。</p><p id="8983" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">研究人员为该架构拍摄的标准输入图像大小为224*224*3，其中3代表RGB通道。这些图像通过两个主要层，即卷积层和池。</p><p id="2918" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">在卷积层中，滤波器大小为3*3，步长值为1，填充相同。Padding='same '意味着对于卷积层，输入图像的大小不应改变。</p><p id="5573" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">在池层中，过滤器大小为2*2，跨距值为2。每次我们将图像传递到池层，图像的大小将减少一半，内核/过滤器的数量将继续增加。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es kw"><img src="../Images/9cc8a40b4523366dd3737fd396656fd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:314/format:webp/1*p0BKlbhA5WZ0gjHxJgozeA.png"/></div></figure><h1 id="01ee" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">VGG网优于亚历克斯网</h1><ol class=""><li id="74f9" class="kx ky hi jm b jn jo jr js jv kz jz la kd lb kh lc ld le lf bi translated">与Alex Net(7层)相比，VGG Net使用深度神经网络(16层)，因此VGG可以从网络中提取更多信息，因为它处理多个参数。既然我们用的是RELU激活函数，就不会有消失梯度的问题。</li><li id="12d7" class="kx ky hi jm b jn lg jr lh jv li jz lj kd lk kh lc ld le lf bi translated">在Alex net中，经过大量实验后，他们选择了一个滤波器大小，并且没有层和内核的顺序，但在VGG，我们有一个通用架构，其中卷积层和池以系统的方式发生。</li></ol><h1 id="e7d5" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">VGG作为预训练模型(迁移学习)</h1><p id="b095" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">VGG16、VGG19、Resnet50、Inception-Net等是最先进的算法或预训练模型，我们可以使用这些算法的权重来创建自己的模型。</p><p id="5a72" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">这种将预训练模型的权重重新用于我们自己的模型的做法被称为迁移学习。</p><p id="c621" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">所有这些先进的算法会给你1000个类别的输出，因为它们是在图像网络数据集上训练的，但在我们的例子中，我们只需要3个类别。因此，我们削减了第一层和最后一层，并用3个节点(类)层替换该层。我们也将在代码中看到这一点。</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es ll"><img src="../Images/32e4183240597ad8db5d79e3ebaac4eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*QvUXumklwH8G84g36FVZig.png"/></div></figure><p id="2c63" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">上图展示了ImageNet的强大功能，ImageNet是一个数据库，包含大约1400万张计算机视觉研究人员使用的图像。</p><h1 id="c3a3" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">使用VGG16进行汽车品牌分类的步骤</h1><p id="6577" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">现在让我们来看一下使用Keras实现VGG16的过程。我们会逐一理解每一行代码。</p><h2 id="88eb" class="lm in hi bd io ln lo lp is lq lr ls iw jv lt lu ja jz lv lw je kd lx ly ji lz bi translated">A]导入库</h2><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es ma"><img src="../Images/cc358927198baefcdadc2607e56bde1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rcBmWZr3ZCarxS7akHB0yA.png"/></div></div></figure><h2 id="7e43" class="lm in hi bd io ln lo lp is lq lr ls iw jv lt lu ja jz lv lw je kd lx ly ji lz bi translated">B]根据VGG16的标准定义我们想要的图像尺寸</h2><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/9b54b08efefc53156457303d4a5e6823.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*9U7yw4NSk6-VR3hyBT6O6w.png"/></div></figure><p id="9bd2" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">输入图像的高度和宽度是224*224，RGB通道的高度和宽度是3，我们将在后面添加。</p><h2 id="71e3" class="lm in hi bd io ln lo lp is lq lr ls iw jv lt lu ja jz lv lw je kd lx ly ji lz bi translated">C]提供训练和测试数据集目录</h2><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/2f86b2d7836c0958db084d31747bc973.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*0loGkTEXpnvLAk3SViJLQw.png"/></div></figure><p id="ef5d" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">训练文件夹包含3辆汽车的64幅图像，测试文件夹包含3辆汽车的58幅图像。为了获得更好的性能，我们可以随时增加文件夹中的图像数量。</p><h2 id="24c7" class="lm in hi bd io ln lo lp is lq lr ls iw jv lt lu ja jz lv lw je kd lx ly ji lz bi translated">D]加载预训练模型并定义图像大小和参数</h2><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es md"><img src="../Images/2417578a34bab1a1fbf879c8c63bf1af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hSvk1Fo6LxM7RynJ1790YQ.png"/></div></div></figure><p id="b8f9" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">我们已经加载了模型并使用了3个重要参数。input _ shape =图像大小+[3]。那个[3]代表RGB通道。</p><p id="9719" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">weights='imagenet '很重要，因为这意味着我们使用模型的预训练权重，该模型最初是使用imagenet图像训练的。</p><p id="81a6" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">include_top= False意味着我们将切断VGG16预训练模型的最后一个密集层，因为它是为imagenet的1000个输出类别训练的，而我们只有3个类别。我们还切断了第一层，因为输入图像和大小可以由我选择。</p><h2 id="97e1" class="lm in hi bd io ln lo lp is lq lr ls iw jv lt lu ja jz lv lw je kd lx ly ji lz bi translated">E]不要训练现有的重量</h2><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es me"><img src="../Images/6928639f274f06595d10e5b3592069e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zSNDrjOpWdbBxT9uVj3ihQ.png"/></div></div></figure><p id="da7f" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">vgg.layers显示了已经形成的16个层对象。</p><p id="5a6e" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">layer.trainable = False意味着我们说不要为这些层训练现有权重。我们想按原样使用它们。我们可以控制重量，因为这是一个预先训练好的模型。我们可以控制哪一层应该预先训练权重，哪一层应该使用可训练权重。</p><h2 id="c8d0" class="lm in hi bd io ln lo lp is lq lr ls iw jv lt lu ja jz lv lw je kd lx ly ji lz bi translated">F]使用glob获取数据集中的类的数量</h2><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mf"><img src="../Images/dba621ba6bbc01b006bcd37d327cab12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mN-5IscZw3uCsnK8uxUlXw.png"/></div></div></figure><p id="e281" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">我之前提到过，我们切断了预训练模型的最后一层，因为我们想要用3个类别来替换1000个类别密集层。我们使用glob从文件夹中获取这3个类别。</p><p id="5b5d" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">vgg.output显示合并后最后一层的图像矩阵。现在我们把那层弄平，然后把它输入网络。</p><h2 id="15c5" class="lm in hi bd io ln lo lp is lq lr ls iw jv lt lu ja jz lv lw je kd lx ly ji lz bi translated">G]展平</h2><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/3726e4a1dd99bfebfa1b7d8ba7abd3f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/1*E1wOkFf9QJwtyrE8mdo-KA.png"/></div></figure><h2 id="3f9f" class="lm in hi bd io ln lo lp is lq lr ls iw jv lt lu ja jz lv lw je kd lx ly ji lz bi translated">H]现在将这个展平的阵列放到密集网络中</h2><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/b273fb900aa7a4d1b653ee92c2cf8292.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*wLPCr7l79V6cPMBG09phCw.png"/></div></figure><p id="9d23" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">我们使用Softmax激活函数，因为有3个节点。</p><h2 id="0db0" class="lm in hi bd io ln lo lp is lq lr ls iw jv lt lu ja jz lv lw je kd lx ly ji lz bi translated">I]定义以输入和输出为参数的模型</h2><figure class="ko kp kq kr fd ij er es paragraph-image"><div class="er es mi"><img src="../Images/040a3d013523df910854c142a1209059.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*h3KVXQHdaZT1SHrUWKfkVg.png"/></div></figure><h2 id="a907" class="lm in hi bd io ln lo lp is lq lr ls iw jv lt lu ja jz lv lw je kd lx ly ji lz bi translated">J]使用的成本和优化器</h2><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mj"><img src="../Images/68ee382a83f59f823d5e859f9c254d61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EYm12XigWxYqXmHoh7CheA.png"/></div></div></figure><h2 id="2c02" class="lm in hi bd io ln lo lp is lq lr ls iw jv lt lu ja jz lv lw je kd lx ly ji lz bi translated">K]现在，我们使用图像数据生成器从数据集导入图像，并对训练数据执行数据扩充。</h2><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mk"><img src="../Images/b96dc7ed2eb31ada265c453990f6d8e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iD3dMFbaGth07O8E84d0YQ.png"/></div></div></figure><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es ml"><img src="../Images/7a565b78261206a702968680f2b0c43b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7e4HKgay_7vFMh3HZVfo_Q.png"/></div></div></figure><p id="239c" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">收到的验证准确率为88%</p><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mm"><img src="../Images/3e76419bb6859147f61320a990b4eebf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h_yAA3juY8MswuM_0B_XVQ.png"/></div></div></figure><h2 id="a377" class="lm in hi bd io ln lo lp is lq lr ls iw jv lt lu ja jz lv lw je kd lx ly ji lz bi translated">L]演示</h2><figure class="ko kp kq kr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="er es mn"><img src="../Images/22039941dbec197a352a64291553fb3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mde_gDnojS7QqT7JQWVuhg.png"/></div></div></figure><h1 id="0c90" class="im in hi bd io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj bi translated">结论</h1><p id="ad0f" class="pw-post-body-paragraph jk jl hi jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh hb bi translated">这是通过汽车品牌分类的迷你深度学习项目对VGG16架构的简短概述。希望你们喜欢这个解释:)</p><p id="8261" class="pw-post-body-paragraph jk jl hi jm b jn ki jp jq jr kj jt ju jv kk jx jy jz kl kb kc kd km kf kg kh hb bi translated">有关机器学习和深度学习的其他令人兴奋的文章，请关注我的Medium！！</p><div class="mo mp ez fb mq mr"><a rel="noopener follow" target="_blank" href="/@sameerkumar21635/my-articles-on-data-science-1635f1df2c5c"><div class="ms ab dw"><div class="mt ab mu cl cj mv"><h2 class="bd hj fi z dy mw ea eb mx ed ef hh bi translated">我关于数据科学的文章</h2><div class="my l"><h3 class="bd b fi z dy mw ea eb mx ed ef dx translated">以下是我写的关于机器学习、深度学习、数据分析等各种主题的文章</h3></div><div class="mz l"><p class="bd b fp z dy mw ea eb mx ed ef dx translated">medium.com</p></div></div></div></a></div></div></div>    
</body>
</html>