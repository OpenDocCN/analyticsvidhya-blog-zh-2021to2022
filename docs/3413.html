<html>
<head>
<title>Create and distribute a slack bot with python and AWS in 1 hour</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用python和AWS在1小时内创建并发布一个slack bot</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/create-and-distribute-a-slack-bot-with-python-and-aws-in-1-hour-41c4a6c0f99d?source=collection_archive---------1-----------------------#2021-06-30">https://medium.com/analytics-vidhya/create-and-distribute-a-slack-bot-with-python-and-aws-in-1-hour-41c4a6c0f99d?source=collection_archive---------1-----------------------#2021-06-30</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2f07" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">了解如何在AWS的帮助下，在不到一个小时的时间内从头开始创建slack bot。然后，您可以根据自己的需要定制这个机器人。本文的所有代码都可以在我的<a class="ae jd" href="https://github.com/cazabec/slackbot-aws-lambda" rel="noopener ugc nofollow" target="_blank"> github </a>上检索到。</p><p id="5847" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在本文中，我将向您展示如何创建一个简单的机器人，当有人在频道中发布消息时，它会进行回复。您还将学习如何分发您的机器人，以便任何人都可以安装它。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/2dd3129938b119560c6d7fa23fe273af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tohvXA4153uH4U86KE01NA.png"/></div></div></figure></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h1 id="d0ec" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">1.设置松弛应用程序</h1><p id="d4fd" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">对于这一步，我们需要创建一个Slack应用程序，填写基本信息，订阅事件并为我们的新机器人设置权限。</p><ul class=""><li id="f9bc" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">前往https://api.slack.com/apps<a class="ae jd" href="https://api.slack.com/apps" rel="noopener ugc nofollow" target="_blank">的</a>，点击“<strong class="ih hj">创建新应用”</strong></li><li id="8878" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">输入应用程序的名称，并选择您的工作区</li><li id="7dac" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">您应该会被重定向到应用程序的“基本信息”部分</li><li id="a0ce" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">更新本页的“显示信息”部分</li><li id="4707" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">转到边栏上的“活动订阅”页面:</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lo"><img src="../Images/28bc3a8b2fd6f1db76ada090262e0b84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O4cDVxtfAREbvcwA6q7Swg.png"/></div></div></figure><ul class=""><li id="3b63" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">启用事件并点击<strong class="ih hj">订阅bot事件</strong>，添加以下权限:<em class="lp"> message.channels。</em>暂时将“<strong class="ih hj">请求url </strong>”字段留空，我们稍后会填充它。</li><li id="e1b0" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">然后，转到侧边栏中的“Oauth &amp; Permissions”选项卡，转到“<strong class="ih hj"> Scopes </strong>”部分，添加以下范围(有些范围已经预填充，您不能删除它们。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lq"><img src="../Images/098292c9cd381c0ff4c75e041a762dc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bMM507_5sDfxyxvZuXAdbA.png"/></div></div></figure><p id="859b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据你试图解决的问题，你必须定制你的范围。</p><h1 id="1e0c" class="jx jy hi bd jz ka lr kc kd ke ls kg kh ki lt kk kl km lu ko kp kq lv ks kt ku bi translated">2.设置AWS</h1><p id="72ad" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">在这一步中，我们将在AWS上创建创建我们的bot所需的所有组件。如果你还没有AWS账户，不用担心，你可以在https://aws.amazon.com/fr/free/免费创建。对于大多数使用情形，免费层已经足够了。</p><ul class=""><li id="5bed" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">登录您的AWS帐户，然后转到“服务”选项卡中的<strong class="ih hj"> lambda </strong>。</li><li id="cbc5" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">点击“<strong class="ih hj">创建功能</strong>，然后点击“从头开始创作”并填写姓名字段</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es lw"><img src="../Images/0b2d34d9d7a151b15ee27de5993a5e54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-KSl5zKxdDhYRPR0o7OkpA.png"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">自动气象站λ</figcaption></figure><ul class=""><li id="9b57" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">单击您的新lambda函数，然后单击“<strong class="ih hj">添加触发器</strong>”，我们将创建一个API网关，它将公开“暴露”我们的lambda，以便我们可以向它发送事件。</li><li id="7c3b" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">选择“<strong class="ih hj"> API网关</strong>，然后“<strong class="ih hj">创建API</strong>”(HTTP API)。将安全性设置为“开放”，以便slack可以向您发送请求，然后单击“<strong class="ih hj">创建</strong></li><li id="962f" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">你可以通过点击Api端点链接(见下图)来测试你的lambda，你应该会看到“<em class="lp"> Hello from lambda！</em></li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mb"><img src="../Images/3b7e2fbf3ae99c4e590dd747dfb7e786.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ncE3nDrxDlvDiMSppqZohA.png"/></div></div></figure><ul class=""><li id="464b" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">回到slack的“事件订阅”页面，粘贴您的API端点的链接。您应该会看到一个错误。这是因为slack正在尝试验证你的端点，你必须返回slack发送的“<em class="lp">挑战</em>值。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mc"><img src="../Images/7f512695b9a0eab8161bfa4b6066a5f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LjaA6OAIqyEAptuYf8ic3Q.png"/></div></div></figure><ul class=""><li id="d837" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">在AWS上，转到lambda函数编辑代码，并将代码放在下面，以返回挑战并验证您的URL。</li></ul><blockquote class="md me mf"><p id="5953" class="if ig lp ih b ii ij ik il im in io ip mg ir is it mh iv iw ix mi iz ja jb jc hb bi translated"><strong class="ih hj"> def lambda_handler(event，context) </strong>是每个lambda函数的入口点。event参数为您提供了关于触发该函数的事件的信息(在我们的例子中是slack API post请求)</p></blockquote><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mj mk l"/></div></figure><ul class=""><li id="6d70" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">回到Slack，点击“<strong class="ih hj">重试</strong>”来验证你的请求URL，现在应该可以正常工作了。</li><li id="90a8" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">你可以进入侧边栏的“基本信息”选项卡，点击“<strong class="ih hj">安装你的应用</strong>”，然后点击“<strong class="ih hj">安装到工作区</strong>”</li></ul><h1 id="c6ce" class="jx jy hi bd jz ka lr kc kd ke ls kg kh ki lt kk kl km lu ko kp kq lv ks kt ku bi translated">3.编写机器人代码</h1><p id="a522" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">您的bot现在已经安装在您的工作区中，您的AWS lambda已经准备好接收来自这个工作区的事件。现在是时候给lambda函数添加逻辑了。</p><ul class=""><li id="dc6d" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">在您的slack工作区，进入一个频道，通过键入<code class="du ml mm mn mo b">@name-of-your-bot</code>并按回车键将您的机器人添加到该频道</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mp"><img src="../Images/2e665e1dfcbcee6a38f24a9ee3a4c7a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jJwOnVVaC1RjVvNvACynJw.png"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">将机器人添加到频道</figcaption></figure><p id="bac8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">您现在可以接收lambda函数上的事件了！我们只需在我们的lambda函数中添加逻辑，这里有一个小示例，它检查消息中是否附加了文件，如果是，则进行回复。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mj mk l"/></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">恢复bot lambda代码</figcaption></figure><ul class=""><li id="03fe" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">对于本例，您需要添加<strong class="ih hj"> BOT_TOKEN </strong>环境变量，转到slack上的“<strong class="ih hj"> Oauth &amp; Permissions </strong>”来复制它并创建一个环境变量(见下图)</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mq"><img src="../Images/ddf95cd9b3b37ed2792c96c112c62527.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5XWwNQbFipxBdBps1rIY7A.png"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">添加环境变量</figcaption></figure><p id="bda4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果您使用这段代码，这就是您应该得到的结果👇</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mr"><img src="../Images/468cdaec5f666d826d3048f455cd7faf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Of_2UH0TpZUJdTL1OdUDAg.png"/></div></div><figcaption class="lx ly et er es lz ma bd b be z dx translated">基本时差机器人结果</figcaption></figure><p id="f4a7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="lp">如果你有问题或者它不工作，你想调试，你可以去看看AWS上的</em><a class="ae jd" href="https://aws.amazon.com/fr/cloudwatch/" rel="noopener ugc nofollow" target="_blank"><em class="lp">cloud watch</em></a><em class="lp">服务，它会在每个lambda调用上写日志。</em></p><h1 id="0674" class="jx jy hi bd jz ka lr kc kd ke ls kg kh ki lt kk kl km lu ko kp kq lv ks kt ku bi translated">4.将slash命令添加到slack应用程序中(可选)</h1><p id="62fd" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">Slack允许你创建斜线命令，像<code class="du ml mm mn mo b">/setreply hello world !</code>，这在很多情况下非常有用</p><ul class=""><li id="f7c8" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">转到slack侧边栏中的“<strong class="ih hj">斜线命令</strong>”标签，点击“创建新命令”</li><li id="7055" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">您可以创建第二个lambda函数来处理与slash命令相关的事件，您还必须创建另一个API网关，只需重复我之前描述的步骤。</li><li id="eb08" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">一旦完成，您就可以在创建slash命令时将API端点的链接复制到“<strong class="ih hj">请求URL </strong>”字段中。</li><li id="5f9f" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">转到您的新lambda函数，并根据您的需要扩展这个基本代码:</li></ul><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="5143" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当有人在频道中输入你的斜杠命令时，你的lambda将被触发。让逻辑适应你的需要。</p><h1 id="e1b6" class="jx jy hi bd jz ka lr kc kd ke ls kg kh ki lt kk kl km lu ko kp kq lv ks kt ku bi translated">5.使用dynamoDB存储数据</h1><p id="5426" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">你的机器人可能需要存储信息，做一些比回复短信更复杂的事情。我将向你展示如何将DynamoDB链接到你的任何一个lambdas上，这样你就可以构建任何类型的机器人。</p><p id="0cc5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当您想要分发slack应用程序以将其安装到新的工作空间时，您还需要一种存储令牌的方法(在下一步中)</p><ul class=""><li id="47c4" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">在你的AWS账户中找到<a class="ae jd" href="http://console.aws.amazon.com/dynamodb/home" rel="noopener ugc nofollow" target="_blank"> dynamoDB </a>服务，点击“<strong class="ih hj">创建表格</strong></li><li id="6ded" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">填写表名并设置主键，在我的例子中，表名是“token ”,主键也是“token”。我们将为我们的机器人添加到的每个新工作空间存储一个slack令牌。我们还将有一个名为“teamId”的字段，它是您的工作区的唯一Id。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es ms"><img src="../Images/9f011207b96bb3535fcf8b396e98dec7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QXFNTiunoOAsLsdtkQPodw.png"/></div></div></figure><p id="3a32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在需要让我们的lambda访问我们的dynamoDB服务。否则，当您试图从lambda访问数据库时，将出现“权限被拒绝错误”。</p><ul class=""><li id="c974" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">在AWS上进入你的<a class="ae jd" href="https://console.aws.amazon.com/iam/home" rel="noopener ugc nofollow" target="_blank"> IAM </a>服务，点击“<strong class="ih hj">角色</strong></li><li id="364d" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">找到与你的lambda函数对应的角色，对我来说是“oauthLambda-role-et3lslpe”然后点击它</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mt"><img src="../Images/609981dcea0d6bb465fdc869f09ec082.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3_DSYBqR0Fv5nVhfcM419Q.png"/></div></div></figure><ul class=""><li id="1261" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">点击权限标签中的“附加策略”并搜索“dynamoDB”</li><li id="b98e" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">添加符合您需求的策略，在我的例子中，我添加了完全访问(AmazonDynamoDBFullAccess)</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mu"><img src="../Images/2aac11a0eb55d02df2fe33d7cded5dd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dNnlz87zYyHdB6AhaSIUMw.png"/></div></div></figure><ul class=""><li id="2d88" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">如果您正在使用python，您可以使用强大的<a class="ae jd" href="https://boto3.amazonaws.com/v1/documentation/api/latest/index.html" rel="noopener ugc nofollow" target="_blank"> Boto3 </a>库并像这样查询您的表:</li></ul><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="9aaa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这个例子中，我使用了“reply”表，并更新了名为“default”的行的“content”字段。我邀请您阅读Boto3文档，了解如何查询您的数据库。</p><h1 id="351d" class="jx jy hi bd jz ka lr kc kd ke ls kg kh ki lt kk kl km lu ko kp kq lv ks kt ku bi translated">5.分发您的机器人</h1><p id="6dca" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">一旦你完成了新机器人的编码，就该分发它了。我将向您展示如何实现oauth2协议，这样任何人都可以将您的bot安装到它的工作区。</p><ul class=""><li id="c2ae" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">用API网关创建第三个lambda函数(oauthLambda )(如步骤2所示)</li><li id="c010" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">在slack上，转到侧边栏中的“<strong class="ih hj"> Oauth &amp;权限</strong>，然后点击“<strong class="ih hj">添加Oauth重定向URL</strong>”，然后点击“<strong class="ih hj">设置重定向URL</strong></li><li id="2bcf" class="la lb hi ih b ii lj im lk iq ll iu lm iy ln jc lf lg lh li bi translated">添加新API网关的URL作为新的重定向URL。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mv"><img src="../Images/30b4162d0f677164c1217ed62053afd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r7tKm9sa5yI8ojBl3kNt6Q.png"/></div></div></figure><ul class=""><li id="6968" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">转到侧边栏上的“<strong class="ih hj">管理发行版</strong>”选项卡，检查您的bot是否符合所有标准，然后单击“<strong class="ih hj">激活发行版</strong>”</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mw"><img src="../Images/9d32026b472abdcdf415b1d394750788.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4wB6HOhlscKUtYQZFYDrzQ.png"/></div></div></figure><ul class=""><li id="241a" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">一旦完成，你将从slack获得一个可共享的URL(见下图)，在测试它之前，你必须做最后一件事:编码你的lambda来执行oauth2过程。</li></ul><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mx"><img src="../Images/dc114ac9293d02e811472d4058c6be8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6NhGlwpNSrylWDQPDSfZ1Q.png"/></div></div></figure><ul class=""><li id="7be9" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">回到AWS，编辑最后一个AWS lambda函数(oauth函数)的代码。将代码<a class="ae jd" href="https://github.com/cazabec/slackbot-aws-lambda/blob/997dc5dbc070695110524b7d59f61ba9f5e0c153/lambda/oauth2.py" rel="noopener ugc nofollow" target="_blank">放在</a>下面:</li></ul><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="mj mk l"/></div></figure><p id="8586" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当有人试图在他们的工作空间上安装你的bot时，这个代码将被调用，它唯一做的事情是将oauth令牌保存在dynamoDB中slack teamId旁边。</p><ul class=""><li id="91ba" class="la lb hi ih b ii ij im in iq lc iu ld iy le jc lf lg lh li bi translated">现在，您可以修改步骤3中的示例代码，使用与从slack收到的事件中的teamId相对应的令牌(<a class="ae jd" href="https://github.com/cazabec/slackbot-aws-lambda/blob/997dc5dbc070695110524b7d59f61ba9f5e0c153/lambda/event_receiver.py#L6" rel="noopener ugc nofollow" target="_blank">这里是我的github上的一个例子</a>)。</li></ul><p id="ef7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当一个事件发生在安装了你的机器人的工作空间时，你会在你的lambda上收到一个事件，它的有效负载包含“<strong class="ih hj"> teamId </strong>”。每个teamId都与一个bot令牌一起存储在您的数据库中，这就是您如何根据接收到的事件知道必须使用哪个令牌的原因。</p><p id="a6dc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">瞧啊。现在你有了一个运行在AWS上的机器人，任何有你链接的人都可以把它安装到他的工作空间。</p><h1 id="a8ca" class="jx jy hi bd jz ka lr kc kd ke ls kg kh ki lt kk kl km lu ko kp kq lv ks kt ku bi translated">结论</h1><p id="eb20" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">如果你想用AWS立刻创建一个新的slack bot，我试图展示你如何开始的主要步骤。无论您的用例是什么，您都可以扩展基本示例。尽情发挥你的想象力，用神奇的机器人为slack社区做贡献。</p><p id="2385" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你有任何问题，评论这个帖子，我会尽快回答。</p></div></div>    
</body>
</html>