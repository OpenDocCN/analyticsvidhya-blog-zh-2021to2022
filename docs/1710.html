<html>
<head>
<title>Search automation in Google Translate using basic Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用基本Python在Google Translate中实现搜索自动化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/search-automation-in-google-translate-using-basic-python-aafde8040ec7?source=collection_archive---------13-----------------------#2021-03-14">https://medium.com/analytics-vidhya/search-automation-in-google-translate-using-basic-python-aafde8040ec7?source=collection_archive---------13-----------------------#2021-03-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/></div><div class="ab cl ie if go ig" role="separator"><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij"/></div><div class="ha hb hc hd he"><p id="7add" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">链接到这篇文章<a class="ae jj" href="https://fabriciusbr.medium.com/automatiza%C3%A7%C3%A3o-de-pesquisas-no-google-tradutor-com-python-b%C3%A1sico-3ce938f3a8f3" rel="noopener">葡萄牙语翻译在这里</a></p><p id="7a19" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">简介</strong></p><p id="a0e0" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">最近，当我需要编写Python代码将文本翻译成外语时，我求助于Googletrans库，它非常容易使用，由Google Translate API提供，没有任何限制。然而，这个库在过去的几个月里出现了一个严重的错误(你可以<a class="ae jj" href="http://github.com/ssut/py-googletrans/issues/234" rel="noopener ugc nofollow" target="_blank">在这个链接</a>上查看关于这个主题的更多信息)，这使得现在无法使用这样的库。</p><p id="65ba" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">尽管有其他Python包选项可以满足同样的需求，但我决定将这个小小的挫折作为一个学习机会。由于Googletrans不能正常工作，是否有可能编写一个网络抓取迷你程序，以便直接在Google Translate网站上自动搜索翻译？我很高兴地发现，这个问题的答案是肯定的，并且这种努力只使用内置模块webbrowser的open函数是可能的。</p><p id="4ed3" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">因此，这篇文章展示了我的这个web抓取工作的最终结果，它受到了伟大著作<em class="jk">的第12章中介绍的<em class="jk"> mapIt.py </em>程序的启发</em> ( <a class="ae jj" href="http://automatetheboringstuff.com/2e/chapter12" rel="noopener ugc nofollow" target="_blank">链接到此处的完整文本</a>)。其作者Al Sweigart提出了一个非常简单的解决方案来自动搜索谷歌地图上的地址。当然，由于我已经阅读了这本书并实践了它的例子(也由于我以前对Googletrans库的熟悉)，发现Google Translate URL模式并因此编写自己的代码相对容易。</p><p id="6321" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">如何使用网络浏览器库翻译文本</strong></p><p id="858a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们将访问谷歌翻译网站(<a class="ae jj" href="https://translate.google.com/" rel="noopener ugc nofollow" target="_blank">https://translate.google.com/</a>)来做一个从英语到葡萄牙语的简短翻译。接下来，我们将分析网页提供的信息，尤其是网站翻译我们的文本后呈现的新URL:</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/e4c96990d9e1878b4524f25da471505b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I7t3TzAhe8kalkkivDCp1A.png"/></div></div></figure><p id="000c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这里，一个(不那么)重要的警告:在“你好，世界！”出于教学目的，有意撤回该声明(尽管仍有关于是否需要使用该声明的讨论，如此处的<a class="ae jj" href="http://english.stackexchange.com/questions/74985/should-the-beginners-program-read-hello-world#:~:text=In the typical example you,and the thing being greeted" rel="noopener ugc nofollow" target="_blank">所示</a></p><p id="fce5" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">从上面复制的屏幕中可以看到，URL后面有四个参数，由三个&amp;符号分隔:</p><p id="676c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">sl=en</p><p id="8c63" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi">&amp;</p><p id="11f7" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">tl=pt</p><p id="66d3" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi">&amp;</p><p id="c6c3" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">text=Hello%20World！</p><p id="c5e3" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi">&amp;</p><p id="91de" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">op =翻译</p><p id="8951" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">另外，请注意第一个参数前的问号。</p><p id="f5ba" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">很有可能的是，首字母缩略词<em class="jk"> sl </em>和<em class="jk"> tl </em>分别表示源语言和目标语言。另一方面，<em class="jk">en</em>(<em class="jk">sl</em>参数值)是英语缩写，而<em class="jk"> pt </em>是葡萄牙语的缩写。<em class="jk">文本</em>参数值包含要翻译的文本。最后，<em class="jk"> op </em>(这可能意味着“操作”)将<em class="jk">翻译为其值。</em></p><p id="2ffd" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在分析URL结构时要考虑的另一个方面是单词“Hello”和“World！”之间的空格。可以注意到，它被序列%20所取代。事实上，这不是唯一一个在Google翻译URL中使用时以特殊方式翻译的字符。此外，例如，逗号在URL中由序列%2C转录，这使得逗号后跟空格被表示为%2C%20。你可以在翻译中尝试其他特殊字符，以检查它们是否被翻译。</p><p id="e200" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们现在准备分析下面的初始代码:</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="fe73" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">如前所述，代码的简单性是显而易见的:它仅由一个表示最终URL的f字符串组成，并在正确的位置插入了参数值。在这个序列中，这个URL由webbrowser模块中的open函数访问。</p><p id="7cb2" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">然而，当我们运行上面的代码时，会出现一些小问题，尤其是在Google Translate网站上，诗句中的文本格式无法复制到目标文本中。发生这种情况是因为当我们不对源文本进行处理而只是在URL中直接使用它时，换行字符(著名的\n)不会被自动识别。在这种情况下，只有空格会被转换。</p><p id="d3c8" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">为了解决这个问题，我创建了一个小的自定义函数，用URL中相应的符号替换某些字符。添加了此函数的完整代码如下所示:</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="d3fb" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">用来自. txt文件的输入概括代码</strong></p><p id="6cd8" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，让我们将代码的主体变成一个名为open_google_trans的函数，它将接收<em class="jk"> sl </em>、<em class="jk"> st </em>和<em class="jk"> text </em>参数。我们还将在文件末尾添加<em class="jk"> dunder名称</em>、<em class="jk"> dunder主</em>代码:</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="b55b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">就目前而言，我们将在代码中进行的最后一项修改是添加一个功能，允许我们上传一个包含待翻译文本的. txt文件。为了做到这一点，我们将使用textToTranslate.txt文件，<a class="ae jj" href="https://raw.githubusercontent.com/fabricius1/Google-Translate-Automation/master/textToTranslate.txt" rel="noopener ugc nofollow" target="_blank">,该文件可从我在Github </a>上的存储库中获得。这里的想法是将《罗密欧与朱丽叶》戏剧的原始序言翻译成七种语言:葡萄牙语(pt)、西班牙语(es)、世界语(eo)、拉丁语(la)、土耳其语(tr)、韩语(ko)和日语(ja)。对于这些语言中的每一种，将在浏览器中打开一个不同的选项卡，其中包含目标语言的相应翻译。</p><p id="76a4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">对于其他语言代码，您可以访问https://cloud.google.com/translate/docs/languages<a class="ae jj" href="https://cloud.google.com/translate/docs/languages" rel="noopener ugc nofollow" target="_blank">网站</a></p><p id="c6d4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">您可以下载。txt文件直接下载到您的机器上，或者您仍然可以修改来自Requests库的几行代码，这将直接从我在onGitHub上的存储库中下载文件。我将使用请求库(通过<em class="jk"> pip install requests </em>很容易安装)在代码中添加这种修改。我还修改了代码来翻译。txt文件翻译成上述七种语言，每个新的翻译之间有5秒钟的停顿。程序的最终版本如下所示。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="3f56" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这里有一个关于代码限制的重要观察:Google Translate将源语言文本限制为5k个字符。因此，如果需要翻译较大的文本，就应该为这一特定目的修改代码。</p><p id="3071" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">最后，我想在这里做一个额外的代码注释。应该注意的是，如果用户有能力的话，Google Translate提供的翻译应该由用户来审阅。事实上，不同语言的翻译质量差异很大。例如，关于拉丁语，翻译通常会带来严重的甚至是基本的问题，以至于在我看来，应该避免使用该语言的谷歌服务。作为巴西一所联邦大学的前拉丁语教授，我见过不止一个容易受骗的学生在试图给我提供一个不连贯的翻译作为他/她的作业时遇到麻烦，这个翻译是直接从谷歌翻译复制的。事实上，这些事件已经过去十年了，谷歌的拉丁语翻译仍然有很大的改进空间…</p><p id="4bdf" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在我的下一篇文章中，我将探索如何使用Selenium库保存Google Translate生成的翻译。</p><p id="2be1" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">非常感谢您阅读我的文章。</p><p id="2faf" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><em class="jk">快乐编码</em>！</p><p id="b94e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">附注(2021年3月23日):我今天刚刚发现googletrans发布了一个针对<em class="jk"> AttributeError的临时修复程序:“NoneType”对象没有属性“group”</em>。这是个好消息！我在这里测试过，效果很好。为了使用它，您需要卸载当前的googletrans版本，并安装带有临时补丁的特定版本，如下所示:</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="jx jy l"/></div></figure><p id="5e90" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">您可以在Github链接中找到更多相关信息:</p><p id="f263" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">https://github.com/ssut/py-googletrans/issues/280<a class="ae jj" href="https://github.com/ssut/py-googletrans/issues/280" rel="noopener ugc nofollow" target="_blank"/></p></div></div>    
</body>
</html>