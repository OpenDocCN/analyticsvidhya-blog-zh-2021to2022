<html>
<head>
<title>Once again, Beta Distribution</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">再一次，贝塔分布</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/once-again-beta-distribution-db467a7eded0?source=collection_archive---------2-----------------------#2021-07-19">https://medium.com/analytics-vidhya/once-again-beta-distribution-db467a7eded0?source=collection_archive---------2-----------------------#2021-07-19</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/fca22466b0e796229e13557b5845044e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EPRSpYR2pDFK0cwHS4DutQ.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">Haneul Kim摄</figcaption></figure><h1 id="41eb" class="it iu hh bd iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq bi translated">目录</h1><blockquote class="jr js jt"><p id="4824" class="ju jv jw jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ha bi translated">1.<a class="ae kt" href="#9646" rel="noopener ugc nofollow">简介</a></p><p id="0c33" class="ju jv jw jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ha bi translated">2.<a class="ae kt" href="#d71e" rel="noopener ugc nofollow">什么是贝塔分布？</a></p><p id="3f71" class="ju jv jw jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ha bi translated">3.<a class="ae kt" href="#9c89" rel="noopener ugc nofollow">举例</a></p></blockquote></div><div class="ab cl ku kv go kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ha hb hc hd he"><h1 id="9646" class="it iu hh bd iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm lf jo jp jq bi translated">介绍</h1><p id="c26b" class="pw-post-body-paragraph ju jv hh jx b jy lg ka kb kc lh ke kf li lj ki kj lk ll km kn lm ln kq kr ks ha bi translated">很久以前，在一次数据分析师职位的面试中，有人问我一个问题“为什么在贝叶斯定理中使用贝塔分布”。那时我从未听说过贝塔分布，所以我记得我说“我不知道”。最近在工作中，在开发汤普森采样和上下文土匪贝塔分布再次出现。所以现在我决定更深入地研究贝塔分布，真正彻底地理解它。</p><p id="088b" class="pw-post-body-paragraph ju jv hh jx b jy jz ka kb kc kd ke kf li kh ki kj lk kl km kn lm kp kq kr ks ha bi translated">我们将只关注统计观点，因此强化学习和汤普森抽样的知识是不必要的。</p></div><div class="ab cl ku kv go kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ha hb hc hd he"><h1 id="d71e" class="it iu hh bd iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm lf jo jp jq bi translated">什么是贝塔分布</h1><p id="bd16" class="pw-post-body-paragraph ju jv hh jx b jy lg ka kb kc lh ke kf li lj ki kj lk ll km kn lm ln kq kr ks ha bi translated">贝塔分布是表示概率的连续概率分布，<strong class="jx hi">随机变量是概率</strong>。</p><p id="ffc3" class="pw-post-body-paragraph ju jv hh jx b jy jz ka kb kc kd ke kf li kh ki kj lk kl km kn lm kp kq kr ks ha bi translated">常用于解决搜索概率的问题“拥有小于10%的缺陷的概率是多少？”“在掷硬币中获得少于20%正面的概率？”、“广告点击率在30%~40%之间的概率”等…</p><p id="86bd" class="pw-post-body-paragraph ju jv hh jx b jy jz ka kb kc kd ke kf li kh ki kj lk kl km kn lm kp kq kr ks ha bi translated">这里是概率密度函数、期望均值和方差的公式(不要担心，我们将通过一个例子来复习它们)。</p><figure class="lp lq lr ls fd ii er es paragraph-image"><div class="er es lo"><img src="../Images/5a0c6981a2f24581cf8ab828a9d0a83d.png" data-original-src="https://miro.medium.com/v2/resize:fit:690/format:webp/1*1igyti7Ll5SZg7JohACQ2Q.png"/></div></figure><p id="9b4d" class="pw-post-body-paragraph ju jv hh jx b jy jz ka kb kc kd ke kf li kh ki kj lk kl km kn lm kp kq kr ks ha bi translated">和贝塔分布的性质</p><figure class="lp lq lr ls fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lt"><img src="../Images/637f6741237c12fbcbb172c7e534e1c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2wNQWex96-R3QtjUXflIwg.png"/></div></div></figure></div><div class="ab cl ku kv go kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ha hb hc hd he"><h1 id="9c89" class="it iu hh bd iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm lf jo jp jq bi translated">例子</h1><p id="f7e0" class="pw-post-body-paragraph ju jv hh jx b jy lg ka kb kc lh ke kf li lj ki kj lk ll km kn lm ln kq kr ks ha bi translated">因为我在一家广告技术公司工作，所以让我们坚持“一个广告(真实点击率为34.3%)的点击率在30%-40%之间的概率”(希望我的老板看到这一点)。</p><p id="6e42" class="pw-post-body-paragraph ju jv hh jx b jy jz ka kb kc kd ke kf li kh ki kj lk kl km kn lm kp kq kr ks ha bi translated">广告上个月的点击率是34.3%，这个月还没有过去，因此我们必须在收集更多数据时更新我们的初始概率(先验)。</p><p id="8bf3" class="pw-post-body-paragraph ju jv hh jx b jy jz ka kb kc kd ke kf li kh ki kj lk kl km kn lm kp kq kr ks ha bi translated">使用CTR = 34.3%作为真实CTR，让我们进行模拟。因为我们处理的是点击率，所以可以用二项式分布来表示，1表示点击，0表示不点击。每当点击发生时，我们将α增加1，如果没有发生，我们将β增加1，这允许随着新数据进入而连续更新先前概率。</p><figure class="lp lq lr ls fd ii"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="6b40" class="pw-post-body-paragraph ju jv hh jx b jy jz ka kb kc kd ke kf li kh ki kj lk kl km kn lm kp kq kr ks ha bi translated">我们将实例化属于Ad类的Ad1对象，并向用户显示Ad1次，以查看它的执行情况。</p><figure class="lp lq lr ls fd ii"><div class="bz dy l di"><div class="lu lv l"/></div></figure><p id="50e0" class="pw-post-body-paragraph ju jv hh jx b jy jz ka kb kc kd ke kf li kh ki kj lk kl km kn lm kp kq kr ks ha bi translated">当我们的Ad1显示50次时，我们得到alpha=20和beta=30，结果ctr=0.4，随着我们显示更多的Ad1，其ctr越来越接近真实CTR 0.343。随着我们收集更多的数据，我们将越来越接近真实的CTR。为简单起见，我们假设CTR是稳定的，但请记住，在现实世界中，CTR是不稳定的，我们必须添加某种权重因子w.r.t .时间，以赋予更新的数据更多的重要性。此外，实际上真实的CTR是未知的，因此使用模型进行预测。</p><p id="f919" class="pw-post-body-paragraph ju jv hh jx b jy jz ka kb kc kd ke kf li kh ki kj lk kl km kn lm kp kq kr ks ha bi translated">现在我们用得到的α，β值来绘制β分布。</p><figure class="lp lq lr ls fd ii"><div class="bz dy l di"><div class="lu lv l"/></div></figure><figure class="lp lq lr ls fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lw"><img src="../Images/37ca9fb195f9caa43c00ee8de7eac5e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2s_DZUObUypQHg9Y0Znxtw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">α= 37，β= 63的β分布</figcaption></figure><p id="fa35" class="pw-post-body-paragraph ju jv hh jx b jy jz ka kb kc kd ke kf li kh ki kj lk kl km kn lm kp kq kr ks ha bi translated">所以要回答我们的问题，我们需要计算0.3~0.4之间的面积</p><figure class="lp lq lr ls fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lw"><img src="../Images/5ca0f67386c65b86d4c099a413460e6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HVIxu7hUHqJHxBXefg6FSw.png"/></div></div></figure><p id="ce71" class="pw-post-body-paragraph ju jv hh jx b jy jz ka kb kc kd ke kf li kh ki kj lk kl km kn lm kp kq kr ks ha bi translated">将数字代入公式，我们得到:</p><figure class="lp lq lr ls fd ii er es paragraph-image"><div class="er es lx"><img src="../Images/cb1360973b8b42941c22a85d723d41b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*NkK-wwpH5-Ah1ERgtRYhQg.png"/></div></figure><p id="1a22" class="pw-post-body-paragraph ju jv hh jx b jy jz ka kb kc kd ke kf li kh ki kj lk kl km kn lm kp kq kr ks ha bi translated">因此，真实点击率为34.3%的Ad1的点击率在30%~40%之间的概率为66.6%。</p><p id="823b" class="pw-post-body-paragraph ju jv hh jx b jy jz ka kb kc kd ke kf li kh ki kj lk kl km kn lm kp kq kr ks ha bi translated">随着我们收集越来越多的数据，我们的beta分布将变得更窄，这意味着我们对自己的估计更有把握。这也可能导致问题，因为随着试验(广告显示)数量的增加，需要更大的数据来影响先验概率，因此它在反映新趋势方面变得更慢。为避免此类问题，您需要在每个<code class="du ly lz ma mb b">n</code>显示中包含权重因子w.r.t .时间或重置beta分布参数。</p></div><div class="ab cl ku kv go kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ha hb hc hd he"><h1 id="2ca2" class="it iu hh bd iv iw lb iy iz ja lc jc jd je ld jg jh ji le jk jl jm lf jo jp jq bi translated">结论</h1><p id="7c94" class="pw-post-body-paragraph ju jv hh jx b jy lg ka kb kc lh ke kf li lj ki kj lk ll km kn lm ln kq kr ks ha bi translated">贝塔分布在贝叶斯定理中是一个重要且非常有用的分布，因为使用贝塔分布的先验输出贝塔分布作为后验分布，这给计算带来了巨大的好处。在下一篇博客中，我们将解释贝叶斯定理以及为什么选择贝塔分布作为它的先验分布。</p><p id="5f3e" class="pw-post-body-paragraph ju jv hh jx b jy jz ka kb kc kd ke kf li kh ki kj lk kl km kn lm kp kq kr ks ha bi translated">谢谢，如果有任何不正确的信息，请评论！</p></div><div class="ab cl ku kv go kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ha hb hc hd he"><p id="0c96" class="pw-post-body-paragraph ju jv hh jx b jy jz ka kb kc kd ke kf li kh ki kj lk kl km kn lm kp kq kr ks ha bi translated"><strong class="jx hi">参考文献:</strong></p><ul class=""><li id="e890" class="mc md hh jx b jy jz kc kd li me lk mf lm mg ks mh mi mj mk bi translated"><a class="ae kt" href="https://web.stanford.edu/class/archive/cs/cs109/cs109.1166/pdfs/22%20Beta.pdf" rel="noopener ugc nofollow" target="_blank"> Beta版——斯坦福CS109 </a></li><li id="8787" class="mc md hh jx b jy ml kc mm li mn lk mo lm mp ks mh mi mj mk bi translated"><a class="ae kt" href="https://stats.stackexchange.com/questions/47771/what-is-the-intuition-behind-beta-distribution" rel="noopener ugc nofollow" target="_blank">贝塔分布背后的直觉——栈交换</a></li><li id="d25f" class="mc md hh jx b jy ml kc mm li mn lk mo lm mp ks mh mi mj mk bi translated"><a class="ae kt" href="https://www.youtube.com/watch?v=RNkT4YG8B3A&amp;list=PLpIPLT0Pf7IqS4as3nefPyGv94r2aY6IT&amp;index=11" rel="noopener ugc nofollow" target="_blank">连续概率分布(γ，β)—高丽大学</a></li><li id="124f" class="mc md hh jx b jy ml kc mm li mn lk mo lm mp ks mh mi mj mk bi translated"><a class="ae kt" href="https://www.youtube.com/watch?v=bFZ-0FH5hfs" rel="noopener ugc nofollow" target="_blank">贝叶斯统计— MIT18.650 </a></li></ul></div></div>    
</body>
</html>