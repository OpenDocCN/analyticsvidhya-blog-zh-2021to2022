<html>
<head>
<title>Write Better Python Functions (Using Type Dispatch)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç¼–å†™æ›´å¥½çš„Pythonå‡½æ•°(ä½¿ç”¨ç±»å‹åˆ†æ´¾)</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/write-better-python-functions-using-type-dispatch-94b550f5dde8?source=collection_archive---------6-----------------------#2021-04-10">https://medium.com/analytics-vidhya/write-better-python-functions-using-type-dispatch-94b550f5dde8?source=collection_archive---------6-----------------------#2021-04-10</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="ae1e" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">ç”¨pythonå†™ä¸€ä¸ªå‡½æ•°å¾ˆå®¹æ˜“ï¼Œä½†æ˜¯å†™ä¸€ä¸ªå¥½çš„å‡½æ•°å´ä¸é‚£ä¹ˆå®¹æ˜“ã€‚å¤§å¤šæ•°pythonç¨‹åºå‘˜ç»å¸¸ä¸çŸ¥é“å¦‚ä½•ç¼–å†™æ¸…æ™°ç®€æ´çš„å‡½æ•°ï¼Œæ›´ä¸ç”¨è¯´ä½¿ç”¨ç±»å‹è°ƒåº¦äº†ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ç±»å‹è°ƒåº¦åœ¨pythonä¸­ç¼–å†™æ›´å¥½çš„å‡½æ•°ã€‚</h2></div><h1 id="ff1c" class="iw ix hh bd iy iz ja jb jc jd je jf jg in jh io ji iq jj ir jk it jl iu jm jn bi translated">å…¥é—¨æŒ‡å—</h1><p id="2a2b" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">åœ¨æˆ‘ä»¬è¿›å…¥ä»€ä¹ˆæ˜¯ç±»å‹è°ƒåº¦ä¹‹å‰ï¼Ÿæˆ–è€…ç±»å‹è°ƒåº¦å¦‚ä½•è®©ä½ æˆä¸ºæ›´å¥½çš„pythonç¨‹åºå‘˜ï¼Œè®©æˆ‘ä»¬å…ˆäº†è§£ä¸€äº›åŸºæœ¬çŸ¥è¯†ï¼Œæ¯”å¦‚<em class="kk">ä»€ä¹ˆæ˜¯å¥½çš„Pythonå‡½æ•°ï¼Ÿ</em>è€å®è¯´ï¼Œæˆ‘å®æ„¿è®©<a class="ae kl" rel="noopener" href="/hackernoon/write-better-python-functions-c3a9a36382a6">æ°å¤«Â·å…‹åŠªæ™®</a>æ¥è§£é‡Šã€‚</p><p id="eb35" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">æˆ‘çœŸçš„ç›¸ä¿¡ï¼ŒçœŸæ­£ç†è§£ä¸€ä¸ªä¸œè¥¿å¦‚ä½•å·¥ä½œçš„å”¯ä¸€æ–¹æ³•æ˜¯æŠŠå®ƒåˆ†æˆä¸€ä¸ªä¸ªå°å—ï¼Œç„¶åæŠŠå®ƒä»¬é‡æ–°ç»„åˆåœ¨ä¸€èµ·ï¼Œæˆ–è€…ä»å¤´å¼€å§‹æ„å»ºã€‚è®©æˆ‘ä»¬ä»¥ä¸€ä¸ªå®šä¹‰éå¸¸æ˜ç¡®çš„ç”¨ä¾‹ä¸ºä¾‹ï¼Œä»å¤´å¼€å§‹ä¸ºå®ƒç¼–å†™ä¸€ä¸ªå‡½æ•°ã€‚æˆ‘æ‰€è¯´çš„ä»å¤´å¼€å§‹ï¼Œæ˜¯æŒ‡ä»ä¼ªä»£ç åˆ°pythonä»£ç çš„ä¸€å¯¹ä¸€è½¬æ¢å¼€å§‹ï¼Œè€Œä¸è€ƒè™‘ä»»ä½•æœ€ä½³å®è·µã€‚</p><p id="1060" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">ç„¶åé€šè¿‡<em class="kk">åˆ†æä»€ä¹ˆå¯è¡Œ&amp;ä»€ä¹ˆä¸å¯è¡Œ</em>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œæ„å»ºã€‚æˆ‘ä»¬å°†é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°æˆ‘ä»¬ç”¨å°½æ”¹è¿›ä»£ç çš„æ–¹æ³•ã€‚æ‰€ä»¥è¿™ç¯‡æ–‡ç« ä¸æ˜¯ä¸€ä¸ªç‰ˆæœ¬ï¼Œè€Œæ˜¯åŒä¸€ä¸ªç”¨ä¾‹çš„å¤šä¸ªç‰ˆæœ¬ã€‚</p><p id="48cf" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">å¦‚æœä½ æƒ³çŸ¥é“ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºæˆ‘ä»¬å°†å¿˜è®°æˆ‘ä»¬æ‰€çŸ¥é“çš„å…³äºç¼–å†™å‡½æ•°çš„ä¸€åˆ‡ï¼Œå¹¶åœ¨ç¼–å†™æ—¶è´¨ç–‘æ¯ä¸€è¡Œä»£ç ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°æ¯ä¸€å—æ˜¯å¦‚ä½•è´´åˆçš„ã€‚æˆ‘ä»¬å°†åˆ›å»ºè‡ªå·±çš„æ¸…å•ï¼Œè€Œä¸æ˜¯ç›²ç›®åœ°éµå¾ªå…³äºç¼–å†™å‡½æ•°çš„é¡¹ç›®æ¸…å•ã€‚å¦‚æœè¿™ç¯‡æ–‡ç« é—æ¼äº†ä¸€äº›æœ‰ä»·å€¼çš„ä¸œè¥¿ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼Œæˆ‘ä¼šå¾ˆä¹æ„æ›´æ–°å®ƒã€‚</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es kr"><img src="../Images/c81444460e8843bb108e1d84f9cc2669.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*KVoWyha6VfWv8rPv.jpeg"/></div></div></figure><p id="664b" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">æˆ‘ä»¬å°†å°è¯•åœ¨4æ¬¡è¿­ä»£ä¸­ä¸ºç‰¹å®šç”¨ä¾‹ç¼–å†™æœ€å¥½çš„æˆ–è€…è‡³å°‘æ˜¯æˆ‘æœ€å¥½çš„pythonå‡½æ•°ã€‚æ¯ä¸€æ¬¡è¿­ä»£éƒ½å°†æ˜¯å¯¹ä¸Šä¸€æ¬¡çš„æ”¹è¿›ï¼Œå¹¶åœ¨å‰é¢å£°æ˜ä¸€ä¸ªæ˜ç¡®çš„ç›®æ ‡ã€‚å˜å¾—æ›´å¥½æ˜¯ä¸€ä¸ªè¿­ä»£çš„è¿‡ç¨‹ï¼Œå–å†³äºä½ åœ¨pythonç†Ÿç»ƒç¨‹åº¦è°±ä¸­çš„ä½ç½®ï¼Œ4ä¸ªè¿­ä»£ä¸­çš„ä¸€ä¸ªä¼šæ¯”å…¶ä»–çš„æ›´èƒ½å¼•èµ·ä½ çš„å…±é¸£ã€‚è¿™ç¯‡æ–‡ç« çš„ä¸‹ä¸€æ­¥æ˜¯ç†è§£ç”¨ä¾‹ã€‚ç³»å¥½å®‰å…¨å¸¦ï¼Œè¿™å°†æ˜¯ä¸€æ¬¡éå¸¸æœ‰è¶£çš„æ—…è¡Œã€‚</p></div><div class="ab cl ld le go lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ha hb hc hd he"><h1 id="041a" class="iw ix hh bd iy iz lk jb jc jd ll jf jg in lm io ji iq ln ir jk it lo iu jm jn bi translated">ç”¨ä¾‹</h1><h2 id="be9e" class="lp ix hh bd iy lq lr ls jc lt lu lv jg jx lw lx ji kb ly lz jk kf ma mb jm mc bi translated">ç®€æŠ¥</h2><p id="9a61" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">å°†ç»™å®šçš„å›¾åƒè¾“å…¥è½¬æ¢æˆPyTorchå¼ é‡ã€‚å¯¹ï¼Œå°±æ˜¯è¿™æ ·ã€‚å¾ˆç®€å•ï¼Œå¯¹å§ï¼Ÿ</p><p id="aeaa" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">å…·æœ‰æ•°æ®ç§‘å­¦èƒŒæ™¯çš„äººå¯ä»¥è·³è¿‡è¿™ä¸€éƒ¨åˆ†ï¼Œè·³åˆ°ä¸‹ä¸€èŠ‚ï¼Œå› ä¸ºæˆ‘å°†ç®€è¦ä»‹ç»è¿™ä¸ªç”¨ä¾‹æ‰€éœ€çš„pythonåº“ã€‚</p><ol class=""><li id="3541" class="md me hh jq b jr km ju kn jx mf kb mg kf mh kj mi mj mk ml bi translated"><a class="ae kl" href="https://pillow.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hi"> Pillow </strong> </a>æ˜¯ä¸€æ¬¾ï¼Œå¢åŠ äº†å¯¹æ‰“å¼€ã€æ“ä½œå’Œä¿å­˜å¤šç§ä¸åŒå›¾åƒæ–‡ä»¶æ ¼å¼çš„æ”¯æŒã€‚</li><li id="332f" class="md me hh jq b jr mm ju mn jx mo kb mp kf mq kj mi mj mk ml bi translated"><a class="ae kl" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hi"> Numpy </strong> </a>ä»£è¡¨æ•°å€¼Pythonã€‚Numpyæ˜¯Pythonä¸­ç§‘å­¦è®¡ç®—çš„æ ¸å¿ƒåº“ã€‚å®ƒä¸ºå¤„ç†è¿™äº›æ•°ç»„æä¾›äº†é«˜æ€§èƒ½çš„å¯¹è±¡å’Œå·¥å…·ã€‚</li><li id="be9a" class="md me hh jq b jr mm ju mn jx mo kb mp kf mq kj mi mj mk ml bi translated"><a class="ae kl" href="https://pytorch.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hi"> PyTorch </strong> </a>æ˜¯å¼€æºçš„ï¼Œå®ƒæä¾›äº†ä¸¤ä¸ªä¸»è¦çš„åŠŸèƒ½ï¼Œå³é€šè¿‡&amp;å»ºç«‹åœ¨åŸºäºç£å¸¦çš„è‡ªåŠ¨å¾®åˆ†ç³»ç»Ÿä¸Šçš„æ·±åº¦ç¥ç»ç½‘ç»œæä¾›å¼ºå¤§åŠ é€Ÿçš„è®¡ç®—(å¦‚NumPy)ã€‚å¦‚æœæ²¡æœ‰CUDAæ”¯æŒçš„GPUå¯ç”¨ï¼ŒPytorchå¯ä»¥ä½¿ç”¨CPUè¿è¡Œä»£ç ï¼Œä½†è¿™å¯¹äºè®­ç»ƒMLæ¨¡å‹æ¥è¯´ä¼šæ…¢å¾—å¤šã€‚</li></ol><p id="ab48" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">å¦‚æœæ‚¨æƒ³çŸ¥é“è¿™ä¸ªç”¨ä¾‹ä¸ºä»€ä¹ˆæœ‰ç”¨æˆ–è€…å¯¹è°æœ‰ç”¨ï¼Ÿå¤§å¤šæ•°ä»¥å›¾åƒæ•°æ®ä½œä¸ºè¾“å…¥çš„æœºå™¨å­¦ä¹ åº”ç”¨ç¨‹åº(äººè„¸æ£€æµ‹ï¼ŒOCR)éƒ½åœ¨ä½¿ç”¨è¿™äº›åº“ã€‚è¿™ä¸ªç”¨ä¾‹è¢«è®¤ä¸ºæ˜¯MLä¸–ç•Œä¸­çš„æ•°æ®é¢„å¤„ç†ã€‚</p><h2 id="cf5c" class="lp ix hh bd iy lq lr ls jc lt lu lv jg jx lw lx ji kb ly lz jk kf ma mb jm mc bi translated">æˆ‘ä»¬è¯¥æ€ä¹ˆåšï¼Ÿ</h2><p id="28e5" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">æ‰€æ¶‰åŠçš„æ­¥éª¤éå¸¸ç®€å•ã€‚ä½¿ç”¨Pillow libraryæ‰“å¼€å›¾åƒï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºNumPyæ•°ç»„&amp;åœ¨è½¬æ¢ä¸ºå¼ é‡ä¹‹å‰å¯¹å…¶è¿›è¡Œè½¬ç½®ã€‚é¡ºä¾¿æé†’ä¸€ä¸‹ï¼Œè¿™ç¯‡æ–‡ç« æ˜¯å…³äºç¼–å†™æ›´å¥½çš„pythonå‡½æ•°ï¼Œè€Œä¸æ˜¯æ·±åº¦å­¦ä¹ çš„æ•°æ®é¢„å¤„ç†æ•™ç¨‹ï¼Œæ‰€ä»¥å¦‚æœå®ƒä»¤äººç”Ÿç•ï¼Œä¸è¦æ‹…å¿ƒã€‚ä¸€æ—¦æˆ‘ä»¬å¼€å§‹ç¼–ç ï¼Œä½ ä¼šæ„Ÿè§‰æ›´èˆ’æœã€‚</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es mr"><img src="../Images/2daeb2f6af778f1d2d3bf159396cda8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kHmyI5138YEUPfEd.png"/></div></div></figure><p id="8d4b" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">åœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰ï¼Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ã€‚</p><ol class=""><li id="21f4" class="md me hh jq b jr km ju kn jx mf kb mg kf mh kj mi mj mk ml bi translated">PILå›¾åƒå½“è½¬æ¢ä¸ºNumpyæ•°ç»„æ—¶ï¼Œå®ƒä¼šæˆå½¢â€”(é«˜åº¦ã€å®½åº¦å’Œé€šé“æ•°)ã€‚åœ¨Pytorchä¸­ï¼Œå›¾åƒä¼ æ„Ÿå™¨çš„å½¢çŠ¶å¿…é¡»æ˜¯â€”â€”(é€šé“æ•°ã€é«˜åº¦ã€å®½åº¦)ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å°†æ•°ç»„è½¬æ¢ä¸ºå¼ é‡ä¹‹å‰ï¼Œå…ˆå¯¹å…¶è¿›è¡Œå¤„ç†ã€‚</li><li id="8ab8" class="md me hh jq b jr mm ju mn jx mo kb mp kf mq kj mi mj mk ml bi translated">å¯¹äºæœ‰ç»éªŒçš„Pytorchç”¨æˆ·æ¥è¯´ï¼Œä»–ä»¬æƒ³çŸ¥é“ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ä½¿ç”¨torchå‡½æ•°ï¼Œæ¯”å¦‚<code class="du ms mt mu mv b">ToTensor</code>æˆ–transformæ–¹æ³•ï¼Œè€Œè·³è¿‡Numpyï¼Ÿæ˜¯çš„ï¼Œä½ æ˜¯å¯¹çš„ï¼Œæˆ‘ä»¬ç»å¯¹å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œä½†ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ç¯‡æ–‡ç« çš„è§‚ç‚¹ï¼Œæˆ‘æœ‰æ„è¯†åœ°å†³å®šèµ°æ›´é•¿çš„è·¯çº¿ã€‚</li></ol><h2 id="6242" class="lp ix hh bd iy lq lr ls jc lt lu lv jg jx lw lx ji kb ly lz jk kf ma mb jm mc bi translated">æ‰“å—</h2><p id="5075" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">ä¸å¥½æ„æ€ï¼Œç”¨ä¾‹æ²¡é‚£ä¹ˆç®€å•ã€‚æœ‰ä¸ªå°å—å—ï¼Œå‡½æ•°è¦æ”¯æŒå¤šç§è¾“å…¥æ•°æ®ç±»å‹ï¼Œåˆ†åˆ«æ˜¯<code class="du ms mt mu mv b">str/Path</code>ã€<code class="du ms mt mu mv b">Pillow(Image)</code>å’Œ<code class="du ms mt mu mv b">Numpy(Ndarray)</code>ã€‚</p><p id="1a3a" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">ä¸Šå›¾ä¸­å®šä¹‰çš„æµç¨‹æ­¥éª¤ä»…æ”¯æŒæ•°æ®ç±»å‹<code class="du ms mt mu mv b">str/Path</code>ä½œä¸ºè¾“å…¥ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ å¯¹<code class="du ms mt mu mv b">Pillow(Image)</code>å’Œ<code class="du ms mt mu mv b">Numpy(Ndarray)</code>ç±»å‹çš„æ”¯æŒï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä»”ç»†æƒ³æƒ³ï¼Œè¿™äº›æ•°æ®ç±»å‹æ˜¯å°†å›¾åƒæ–‡ä»¶è½¬æ¢ä¸ºtorchå¼ é‡çš„ä¸­é—´æ­¥éª¤ã€‚å› æ­¤ï¼Œä¸Šå›¾ä¸­å®é™…ä¸Šæ²¡æœ‰é¢å¤–çš„æ­¥éª¤ï¼Œæˆ‘ä»¬åªéœ€é‡å¤ä¸º<code class="du ms mt mu mv b">str/Path</code>æ•°æ®ç±»å‹å®šä¹‰çš„æ­¥éª¤ï¼Œå¹¶ä¿®æ”¹ä¸€äº›åˆå§‹æ­¥éª¤ï¼Œä»¥æ”¯æŒ<code class="du ms mt mu mv b">Pillow(Image)</code>å’Œ<code class="du ms mt mu mv b">Numpy(Ndarray)</code>æ•°æ®ç±»å‹ä½œä¸ºæˆ‘ä»¬å‡½æ•°çš„è¾“å…¥ã€‚</p><p id="6f52" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">ä¸¤ä¸ªé¢å¤–å·¥ä½œæµç¨‹çš„æµç¨‹æ­¥éª¤å¦‚ä¸‹ã€‚</p><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es mr"><img src="../Images/182a31f97c51ae90d0dc4982b5cb7797.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cC6k9XtNwSvEFFK_.png"/></div></div></figure><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es mr"><img src="../Images/09b4484c424a3483bcff6d7e15fa7251.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_8ItlbUVoo0uQCci.png"/></div></div></figure><p id="624a" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">åœ¨æ¯”è¾ƒäº†3å¹…å›¾åƒåï¼Œå¾ˆæ˜æ˜¾:</p><ul class=""><li id="c0e9" class="md me hh jq b jr km ju kn jx mf kb mg kf mh kj mw mj mk ml bi translated">å›¾åƒæ•°æ®ç±»å‹çš„å¤„ç†æ­¥éª¤æ˜¯åŸå§‹å¤„ç†æ­¥éª¤çš„å­é›†ã€‚</li><li id="8588" class="md me hh jq b jr mm ju mn jx mo kb mp kf mq kj mw mj mk ml bi translated">æ•°ç»„æ•°æ®ç±»å‹çš„å¤„ç†æ­¥éª¤æ˜¯å›¾åƒæ•°æ®ç±»å‹å¤„ç†æ­¥éª¤çš„å­é›†ã€‚</li></ul><h1 id="ca02" class="iw ix hh bd iy iz ja jb jc jd je jf jg in jh io ji iq jj ir jk it jl iu jm jn bi translated">è§£å†³åŠæ³•</h1><p id="e61e" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">è¯¥å‡½æ•°çš„å‰ä¸¤æ¬¡è¿­ä»£å°†æ˜¯å…³äº<strong class="jq hi">è¡Œä¸ºå®ç°</strong>ï¼Œè€Œæœ€åä¸¤æ¬¡è¿­ä»£éƒ½æ˜¯å…³äºä»£ç <strong class="jq hi">è€ç«</strong>ã€‚å¦‚æœä½ æ˜¯é‚£ç§å–œæ¬¢å…ˆçœ‹ä¸€æœ¬ä¹¦çš„ç»“å±€çš„è¯»è€…(æˆ‘ä¸æ˜¯åœ¨è¯„åˆ¤)ï¼Œå¯ä»¥ç›´æ¥è·³åˆ°æœ‰æ ‡é¢˜çš„ç« èŠ‚â€”â€”<em class="kk">è¿­ä»£4 </em>ã€‚</p><h1 id="10c5" class="iw ix hh bd iy iz ja jb jc jd je jf jg in jh io ji iq jj ir jk it jl iu jm jn bi translated">è¿­ä»£1</h1><p id="0531" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated"><strong class="jq hi">ç›®æ ‡:</strong></p><p id="1276" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">è®©å®ƒå·¥ä½œã€‚å°±è¿™ä¹ˆç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯ä»é›¶å¼€å§‹ï¼Œæ‰€ä»¥æœ€å¥½åªå…³æ³¨åŸºæœ¬ç‰¹æ€§æˆ–åŠŸèƒ½çš„å·¥ä½œã€‚æˆ‘ä»¬ä¸éœ€è¦é‚£äº›èŠ±é‡Œèƒ¡å“¨çš„ä¸œè¥¿ã€‚å¯¹äºè¿™ä¸ªè¿­ä»£ï¼Œæˆ‘ä»¬å°†åªå…³æ³¨å®ç°<em class="kk">ä½¿ç”¨æµç¨‹æ­¥éª¤</em>ï¼Œè€Œä¸æ‹…å¿ƒ<em class="kk">çš„åœé¡¿ã€‚</em></p><p id="53f2" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated"><strong class="jq hi">ä»£å·:</strong></p><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="3cc0" class="lp ix hh mv b fi nb nc l nd ne"><em class="kk"># Import required libraries</em><br/><strong class="mv hi">import</strong> <strong class="mv hi">numpy</strong> <strong class="mv hi">as</strong> <strong class="mv hi">np</strong><br/><strong class="mv hi">import</strong> <strong class="mv hi">torch</strong><br/><strong class="mv hi">from</strong> <strong class="mv hi">PIL</strong> <strong class="mv hi">import</strong> Image <strong class="mv hi">as</strong> PILImage<br/><br/><em class="kk"># Set Torch device to GPU if CUDA supported GPU is available</em><br/>device = torch.device('cuda' <strong class="mv hi">if</strong> torch.cuda.is_available() <strong class="mv hi">else</strong> 'cpu')<br/><br/><em class="kk"># Function to convert image to Torch tensor</em><br/><strong class="mv hi">def</strong> Tensor(inp):<br/>    <br/>    <em class="kk"># Read image from disk using PIL Image</em><br/>    img = PILImage.open(inp).convert('RGB')<br/>    <br/>    <em class="kk"># Convert the image to numpy ndarray</em><br/>    imgArr = np.asarray(img, np.uint8)<br/>    <br/>    <em class="kk"># Rearrange the shape of the array so that it is pytorch compatible</em><br/>    imgArr = imgArr.transpose(2, 0, 1)<br/>    <br/>    <em class="kk"># Convert Numpy array to Torch Tensor and move it to device</em><br/>    <strong class="mv hi">return</strong> torch.from_numpy(imgArr).to(device)</span></pre><p id="30a7" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">æˆ‘ä»¬åšäº†ä»€ä¹ˆï¼Ÿ</p><p id="2915" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">æˆ‘ä»¬è®¾æ³•å°†<em class="kk">æµç¨‹æ­¥éª¤</em>ç¿»è¯‘æˆä»£ç ã€‚ä»£ç ä¸­çš„è¡Œæ•°å‡ ä¹ä¸å›¾ä¸­çš„æ–¹æ¡†æ•°ç›¸åŒ¹é…ã€‚</p><h2 id="4460" class="lp ix hh bd iy lq lr ls jc lt lu lv jg jx lw lx ji kb ly lz jk kf ma mb jm mc bi translated">å¿«é€Ÿæ£€æŸ¥:</h2><p id="5c6a" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ ·æœ¬å›¾åƒæ¥æµ‹è¯•æˆ‘ä»¬çš„åŠŸèƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ä¸‹è½½ä¸€ä¸ªã€‚</p><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="e5f4" class="lp ix hh mv b fi nb nc l nd ne"><em class="kk"># Download a sample image to disk</em><br/><strong class="mv hi">import</strong> <strong class="mv hi">urllib.request</strong> <br/><br/>url = "https://upload.wikimedia.org/wikipedia/commons/thumb/c/c3/Python-logo-notext.svg/200px-Python-logo-notext.svg.png"<br/>filename = "sample.png"<br/>urllib.request.urlretrieve(url, filename)</span></pre><p id="baf1" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹æˆ‘ä»¬çš„åŠŸèƒ½ã€‚</p><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="c748" class="lp ix hh mv b fi nb nc l nd ne"><em class="kk"># Pass the sample image through our function</em><br/>imgTensor = Tensor(filename)<br/><br/><em class="kk"># Check whether the output of the function is a Tensor</em><br/><strong class="mv hi">assert</strong> isinstance(imgTensor, torch.Tensor), "Not a Tensor"</span></pre><p id="f8be" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">çœ‹èµ·æ¥æˆ‘ä»¬æˆåŠŸåœ°å®ç°äº†åŸºæœ¬åŠŸèƒ½ã€‚å‰å®³ï¼</p><p id="51d1" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">æˆ‘ä»¬å¯ä»¥æ”¹è¿›ä»€ä¹ˆï¼Ÿ</p><ul class=""><li id="0519" class="md me hh jq b jr km ju kn jx mf kb mg kf mh kj mw mj mk ml bi translated">æˆ‘ä»¬è¿˜æ²¡æœ‰å®ç°å¤šç§æ•°æ®ç±»å‹è¾“å…¥åŠŸèƒ½ï¼Œå³æ”¯æŒåƒ<code class="du ms mt mu mv b">PIL Image</code>ï¼Œ<code class="du ms mt mu mv b">Ndarray</code>çš„æ•°æ®ç±»å‹ã€‚</li><li id="8dee" class="md me hh jq b jr mm ju mn jx mo kb mp kf mq kj mw mj mk ml bi translated">æ­¤å¤–ï¼Œæˆ‘ä»¬è‚¯å®šåº”è¯¥æ”¹è¿›å‡½æ•°çš„åç§°ï¼Œå®ƒå¹¶æ²¡æœ‰çœŸæ­£è¯´æ˜å‡½æ•°çš„ä»»ä½•å†…å®¹ã€‚</li></ul></div><div class="ab cl ld le go lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ha hb hc hd he"><h1 id="8dfe" class="iw ix hh bd iy iz lk jb jc jd ll jf jg in lm io ji iq ln ir jk it lo iu jm jn bi translated">è¿­ä»£2</h1><p id="39bb" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated"><strong class="jq hi">ç›®æ ‡:</strong></p><p id="5ffe" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">å½“æˆ‘ä»¬æ·»åŠ å¯¹å¤šç§æ•°æ®ç±»å‹çš„æ”¯æŒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦éå¸¸å°å¿ƒï¼Œå› ä¸ºå¦‚æœæ²¡æœ‰é€‚å½“çš„éªŒè¯ï¼Œäº‹æƒ…å¯èƒ½ä¼šå¾ˆå¿«å˜ç³Ÿï¼Œä»æœ€ç»ˆç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œé”™è¯¯æ¶ˆæ¯æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚å› æ­¤ï¼Œåœ¨è¿™æ¬¡è¿­ä»£ä¸­ï¼Œæˆ‘ä»¬å°†:</p><ol class=""><li id="a0a0" class="md me hh jq b jr km ju kn jx mf kb mg kf mh kj mi mj mk ml bi translated">ä¸ºè¿™äº›ç±»å‹å®ç°å¤šç§æ•°æ®ç±»å‹æ”¯æŒå’ŒéªŒè¯ã€‚</li><li id="fccd" class="md me hh jq b jr mm ju mn jx mo kb mp kf mq kj mi mj mk ml bi translated">è®©å‡½æ•°åæ›´æœ‰ç”¨ã€‚</li></ol><p id="f0ad" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated"><strong class="jq hi">ä»£ç :</strong></p><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="4e07" class="lp ix hh mv b fi nb nc l nd ne"><em class="kk"># Import Libraries</em><br/><strong class="mv hi">import</strong> <strong class="mv hi">numpy</strong> <strong class="mv hi">as</strong> <strong class="mv hi">np</strong><br/><strong class="mv hi">import</strong> <strong class="mv hi">torch</strong><br/><strong class="mv hi">from</strong> <strong class="mv hi">PIL</strong> <strong class="mv hi">import</strong> Image <strong class="mv hi">as</strong> PILImage<br/><strong class="mv hi">from</strong> <strong class="mv hi">pathlib</strong> <strong class="mv hi">import</strong> Path, PurePath</span><span id="2306" class="lp ix hh mv b fi nf nc l nd ne"><em class="kk"># Set Torch device to GPU if CUDA supported GPU is available</em><br/>device = torch.device('cuda' <strong class="mv hi">if</strong> torch.cuda.is_available() <strong class="mv hi">else</strong> 'cpu')<br/></span><span id="03c0" class="lp ix hh mv b fi nf nc l nd ne"><em class="kk"># Function to convert image to Torch tensor</em><br/><strong class="mv hi">def</strong> from_multiInput_toTensor(inp):<br/>    <br/>    <em class="kk"># Input type - str/ Path, then read from disk &amp; convert to array</em><br/>    <strong class="mv hi">if</strong> isinstance(inp, (str, PurePath)):<br/>        <strong class="mv hi">try</strong>: <br/>            image = PILImage.open(inp).convert('RGB')<br/>            imageArray = np.asarray(image.copy(), np.uint8)<br/>        <strong class="mv hi">except</strong> <strong class="mv hi">Exception</strong> <strong class="mv hi">as</strong> error:<br/>            <strong class="mv hi">raise</strong> error<br/>            <br/>    <em class="kk"># Input type - PIL Image, then we convert it to array      </em><br/>    <strong class="mv hi">elif</strong> isinstance(inp, PILImage.Image):<br/>        imageArray = np.asarray(inp, np.uint8)<br/>        <br/>    <em class="kk"># Input type - ndarray, then assign it to imageArray variable  </em><br/>    <strong class="mv hi">elif</strong> isinstance(inp, np.ndarray):<br/>        imageArray = inp<br/>        <br/>    <em class="kk"># Raise TypeError with input type is not supported</em><br/>    <strong class="mv hi">else</strong>: <br/>        <strong class="mv hi">raise</strong> <strong class="mv hi">TypeError</strong>("Input must be of Type - String or Path or PIL Image or Numpy array")<br/>        <br/>    <em class="kk"># Rearrange shape of the array so that it is pytorch compatible</em><br/>    <strong class="mv hi">if</strong> imageArray.ndim == 3: imageArray = imageArray.transpose(2, 0, 1)<br/>        <br/>    <em class="kk"># Convert Numpy array to Torch Tensor and move it to device</em><br/>    <strong class="mv hi">return</strong> torch.from_numpy(imageArray).to(device)</span></pre><p id="5b88" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated"><strong class="jq hi">æˆ‘ä»¬åšäº†ä»€ä¹ˆï¼Ÿ</strong></p><p id="de1e" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">æˆ‘ä»¬å·²ç»æˆåŠŸå®ç°äº†è¿™ä¸ªç”¨ä¾‹æ‰€éœ€çš„æ‰€æœ‰åŠŸèƒ½ã€‚ç”±äº<code class="du ms mt mu mv b">ndarray</code>æ˜¯è¾“å‡ºæ•°æ®ç±»å‹<code class="du ms mt mu mv b">tensor</code>ä¹‹å‰çš„æœ€åä¸€ä¸ªæ•°æ®ç±»å‹ï¼Œæˆ‘ä»¬é¦–å…ˆå°†è¾“å…¥è½¬æ¢ä¸ºæ¯ç§æ”¯æŒçš„æ•°æ®ç±»å‹çš„<code class="du ms mt mu mv b">ndarray</code>ï¼Œå¹¶åœ¨è½¬æ¢ä¸º<code class="du ms mt mu mv b">tensor</code>ä¹‹å‰è½¬ç½®å®ƒã€‚é€šè¿‡é‡‡ç”¨è¿™ç§ç¼–ç é£æ ¼ï¼Œæˆ‘ä»¬èƒ½å¤Ÿé¿å…å°†è¾“å…¥è½¬æ¢ä¸ºæ¯ç§æ”¯æŒçš„æ•°æ®ç±»å‹çš„å€¼<code class="du ms mt mu mv b">tensor</code> &amp; <code class="du ms mt mu mv b">return</code>ã€‚ç›¸åï¼Œæˆ‘ä»¬åªåœ¨æœ€ååšä¸€æ¬¡ã€‚</p><p id="6278" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">åœ¨<code class="du ms mt mu mv b">isinstance</code>å‡½æ•°çš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè¯†åˆ«è¾“å…¥çš„æ•°æ®ç±»å‹ï¼Œå¦‚æœä¼ é€’äº†ä»»ä½•ä¸æ”¯æŒçš„æ•°æ®ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‘å‡ºé€‚å½“çš„é”™è¯¯æ¶ˆæ¯<code class="du ms mt mu mv b">TypeError</code>æ¥é€šçŸ¥ç”¨æˆ·ã€‚ioæ“ä½œç»å¸¸å®¹æ˜“å‡ºé”™ï¼Œæ‰€ä»¥å¦‚æœæ•°æ®ç±»å‹æ˜¯<code class="du ms mt mu mv b">str</code>æˆ–<code class="du ms mt mu mv b">Path</code>ï¼Œæˆ‘ä»¬è¯»å–<code class="du ms mt mu mv b">try</code> &amp; <code class="du ms mt mu mv b">except</code>å—ä¸­çš„å›¾åƒæ–‡ä»¶ï¼Œè®©ç”¨æˆ·çŸ¥é“é”™è¯¯(å¦‚æœæœ‰çš„è¯)ã€‚</p><p id="05fb" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated"><strong class="jq hi">å¿«é€Ÿæ£€æŸ¥:</strong></p><p id="3db8" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">åœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰ï¼Œæˆ‘ä»¬å°†ç¼–å†™ä¸€ä¸ªåŠ©æ‰‹å‡½æ•°æ¥æ£€æŸ¥ä¸¤ä¸ªå¼ é‡æ˜¯å¦ç›¸åŒã€‚</p><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="7c61" class="lp ix hh mv b fi nb nc l nd ne"><em class="kk"># Test if two torch tensors are same or not</em><br/><strong class="mv hi">def</strong> is_same_tensor(tensor1, tensor2):<br/>    <strong class="mv hi">assert</strong> torch.eq(tensor1, tensor2).all(), "The Tensors are not equal!"<br/>    <strong class="mv hi">return</strong> <strong class="mv hi">True</strong></span></pre><p id="7f30" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">å½“ç¼–å†™ä¸€ä¸ªæµ‹è¯•å‡½æ•°æ—¶ï¼Œæœ€å¥½æŠ›å‡ºä¸€ä¸ªé€‚å½“çš„é”™è¯¯ï¼Œè€Œä¸æ˜¯ç®€å•çš„æ‰“å°å‡½æ•°ï¼Œå®ƒå¯èƒ½ä¼šéšè—åœ¨å…¶ä»–æ¶ˆæ¯ä¸­ã€‚æˆ‘ä»¬è¿˜å°†æ£€æŸ¥å‡ ä»¶äº‹æƒ…ï¼Œå¹¶ç¡®ä¿æ›´æ–°ç‰ˆæœ¬éƒ½æ˜¯å¥½çš„ã€‚</p><ol class=""><li id="7d4a" class="md me hh jq b jr km ju kn jx mf kb mg kf mh kj mi mj mk ml bi translated"><em class="kk">æœ€åä¸¤æ¬¡è¿­ä»£çš„å‡½æ•°è¾“å‡ºæ˜¯å¦ç›¸åŒï¼Ÿ</em></li></ol><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="7c2a" class="lp ix hh mv b fi nb nc l nd ne"><em class="kk"># Verify that the output of two versions are same or not</em><br/>is_same_tensor(Tensor(filename), from_multiInput_toTensor(filename))</span></pre><p id="9513" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated"><em class="kk"> 2ã€‚å¯¹å¤šç§æ•°æ®ç±»å‹çš„æ”¯æŒæœ‰æ•ˆå—ï¼Ÿ</em></p><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="1ce6" class="lp ix hh mv b fi nb nc l nd ne"><em class="kk"># Check the support for Path</em><br/>path = Path(Path.cwd(), filename).resolve()<br/>is_same_tensor(Tensor(filename), from_multiInput_toTensor(path))</span><span id="183f" class="lp ix hh mv b fi nf nc l nd ne"><em class="kk"># Check the support for PIL Image</em><br/>image = PILImage.open(filename).convert('RGB')<br/>is_same_tensor(Tensor(filename), from_multiInput_toTensor(image))</span><span id="0499" class="lp ix hh mv b fi nf nc l nd ne"><em class="kk"># Check the support for Ndarray</em><br/>imageArray = np.asarray(image, np.uint8)<br/>is_same_tensor(Tensor(filename), from_multiInput_toTensor(imageArray))</span></pre><p id="cf19" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated"><em class="kk"> 3ã€‚éªŒè¯æœ‰æ•ˆå—ï¼Ÿ</em></p><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="fc09" class="lp ix hh mv b fi nb nc l nd ne"><em class="kk"># Validate whether an error is thrown when user passes wrong file</em><br/>from_multiInput_toTensor('test.png')</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es ng"><img src="../Images/ddeb6ba23c05bc59f5811a2e5b819575.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*vv3sCO3krUCJYvVRJzBQMw.png"/></div></figure><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="7d7e" class="lp ix hh mv b fi nb nc l nd ne"><em class="kk"># Validate whether an error is thrown when input type is list</em><br/>from_multiInput_toTensor([filename])</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es nh"><img src="../Images/0e838f6e4ad0502a7e176833d41d0b69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*c3xLGWCVlpc3PQnW-J6BXw.png"/></div></figure><p id="2f57" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">å¤ªå¥½äº†ï¼æˆ‘ä»¬æ²¡æœ‰æ‰“ç¢ä»»ä½•ä¸œè¥¿ã€‚ç°åœ¨è®©æˆ‘ä»¬åƒå®Œæˆè¡Œä¸ºå®ç°ä¸€æ ·ç»§ç»­è¿›è¡Œè€ç«åŒ–ã€‚</p><p id="ef84" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">æˆ‘ä»¬å¯ä»¥æ”¹è¿›ä»€ä¹ˆï¼Ÿ</p><ul class=""><li id="c38d" class="md me hh jq b jr km ju kn jx mf kb mg kf mh kj mw mj mk ml bi translated">ä¸ºäº†å¢åŠ å¯¹å¤šç§æ•°æ®ç±»å‹çš„æ”¯æŒï¼Œæˆ‘ä»¬å†™äº†ä¸€æ®µç±»ä¼¼æ„å¤§åˆ©é¢æ¡çš„ä»£ç ã€‚è‡³å°‘å˜é‡<code class="du ms mt mu mv b">imageArray</code>çš„ç”Ÿå‘½å‘¨æœŸæ˜¯æ··ä¹±çš„ï¼Œè¿™ç§ç±»å‹çš„ä»£ç è®¾è®¡ä¸æ˜¯å¾ˆç›´è§‚ï¼Œä¼šè®©ç»´æŠ¤è¿™ä¸ªä»£ç åº“çš„äººç”Ÿæ´»åœ¨åœ°ç‹±é‡Œã€‚å½“ç„¶ï¼Œå¯¹äºæˆ‘ä»¬çš„ç®€å•ç”¨ä¾‹æ¥è¯´è¿™ä¸æ˜¯caseï¼Œä½†æœ¬ç€ç¼–å†™æ›´å¥½çš„å‡½æ•°çš„ç²¾ç¥ï¼Œè®©æˆ‘ä»¬é¿å…è¿™ç§ç±»å‹çš„ç¼–ç é£æ ¼ã€‚</li><li id="4b88" class="md me hh jq b jr mm ju mn jx mo kb mp kf mq kj mw mj mk ml bi translated">å‡½æ•°åå¥½äº†å¾ˆå¤šä½†è¿˜æ˜¯ä¸ç†æƒ³ã€‚ä¸ºä»€ä¹ˆï¼Ÿå› ä¸ºå®ƒä»ç„¶æ²¡æœ‰æ¸…æ¥šåœ°è¯´æ˜å‡½æ•°çš„è¾“å…¥ç±»å‹æ˜¯ä»€ä¹ˆã€‚è®©ç”¨æˆ·ç”¨<code class="du ms mt mu mv b">TypeError</code>ç©trail &amp; errorè‚¯å®šä¸æ˜¯æ­£ç¡®çš„ç¼–ç æ–¹å¼ã€‚</li><li id="46e0" class="md me hh jq b jr mm ju mn jx mo kb mp kf mq kj mw mj mk ml bi translated">æ­£å¦‚è¿™ä¸ªå‡½æ•°çš„åå­—æ‰€æš—ç¤ºçš„ï¼Œå®ƒéœ€è¦å¾ˆå¤šè¾“å…¥ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬åœ¨ä¸€ä¸ªå‡½æ•°ä¸­æœ‰å¾ˆå¤šæ´»åŠ¨çš„éƒ¨åˆ†ã€‚ä»é•¿è¿œæ¥çœ‹ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´è®¸å¤šæ„æƒ³ä¸åˆ°çš„å‰¯ä½œç”¨ã€‚</li></ul></div><div class="ab cl ld le go lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ha hb hc hd he"><h1 id="5525" class="iw ix hh bd iy iz lk jb jc jd ll jf jg in lm io ji iq ln ir jk it lo iu jm jn bi translated">è¿­ä»£3</h1><p id="0ee1" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated"><strong class="jq hi">ç›®æ ‡:</strong></p><p id="7d5a" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">ä»”ç»†ç ”ç©¶äº†ä¸Šä¸€èŠ‚çš„è¦ç‚¹åï¼Œå¾ˆæ˜æ˜¾æˆ‘ä»¬éœ€è¦å°†å‡½æ•°åˆ†æˆ3ä¸ªæ›´å°çš„å‡½æ•°ã€‚å³æ¯ç§æ•°æ®ç±»å‹ä¸€ä¸ªå‡½æ•°ã€‚</p><p id="eea4" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated"><strong class="jq hi">ä»£ç :</strong></p><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="cd06" class="lp ix hh mv b fi nb nc l nd ne"><em class="kk"># Import Libraries</em><br/><strong class="mv hi">import</strong> <strong class="mv hi">numpy</strong> <strong class="mv hi">as</strong> <strong class="mv hi">np</strong><br/><strong class="mv hi">import</strong> <strong class="mv hi">torch</strong><br/><strong class="mv hi">from</strong> <strong class="mv hi">PIL</strong> <strong class="mv hi">import</strong> Image <strong class="mv hi">as</strong> PILImage<br/><strong class="mv hi">from</strong> <strong class="mv hi">pathlib</strong> <strong class="mv hi">import</strong> Path, PurePath</span><span id="745c" class="lp ix hh mv b fi nf nc l nd ne"><em class="kk"># Change numpy array to torch tensor</em><br/><strong class="mv hi">def</strong> numpy_ToImageTensor(imageArray):<br/>    <br/>    <em class="kk"># if not type - ndarray then raise error</em><br/>    <strong class="mv hi">if</strong> <strong class="mv hi">not</strong> isinstance(imageArray, np.ndarray):<br/>        <strong class="mv hi">raise</strong> <strong class="mv hi">TypeError</strong>("Input must be of Type - Numpy array")<br/>    <br/>    <em class="kk"># Set Torch device to GPU if CUDA supported GPU is available</em><br/>    device = torch.device('cuda' <strong class="mv hi">if</strong> torch.cuda.is_available() <strong class="mv hi">else</strong> 'cpu')</span><span id="13ec" class="lp ix hh mv b fi nf nc l nd ne">    <em class="kk"># Transpose the numpy array before converting it to Tensor</em><br/>    <strong class="mv hi">if</strong> imageArray.ndim == 3: imageArray = imageArray.transpose(2, 0, 1)<br/>    <strong class="mv hi">return</strong> torch.from_numpy(imageArray).to(device)</span><span id="4bfb" class="lp ix hh mv b fi nf nc l nd ne"><em class="kk"># Change image to torch tensor</em><br/><strong class="mv hi">def</strong> pil_ToImageTensor(image):<br/>    <br/>    <em class="kk"># if not type - PIL Image then raise error</em><br/>    <strong class="mv hi">if</strong> <strong class="mv hi">not</strong> isinstance(image, PILImage.Image):<br/>        <strong class="mv hi">raise</strong> <strong class="mv hi">TypeError</strong>("Input must be of Type - PIL image")<br/>        <br/>    <em class="kk"># Convert the image to numpy </em><br/>    imageArray = np.array(image)<br/>    <br/>    <em class="kk"># Return output of numpy_ToImageTensor function</em><br/>    <strong class="mv hi">return</strong> numpy_ToImageTensor(imageArray)</span><span id="fea4" class="lp ix hh mv b fi nf nc l nd ne"><em class="kk"># Change image file to torch tensor</em><br/><strong class="mv hi">def</strong> file_ToImageTensor(file):<br/>    <br/>    <em class="kk"># if not input - string or Path then raise error</em><br/>    <strong class="mv hi">if</strong> <strong class="mv hi">not</strong> isinstance(file, (str, PurePath)):<br/>        <strong class="mv hi">raise</strong> <strong class="mv hi">TypeError</strong>("Input must be of Type - String or Path")<br/>        <br/>    <em class="kk"># Read the image from disk and raise error (if any)</em><br/>    <strong class="mv hi">try</strong>: <br/>        image = PILImage.open(file).convert('RGB')<br/>    <strong class="mv hi">except</strong> <strong class="mv hi">Exception</strong> <strong class="mv hi">as</strong> error:<br/>        <strong class="mv hi">raise</strong> error<br/>    <br/>    <em class="kk"># Return output of pil_ToImageTensor function</em><br/>    <strong class="mv hi">return</strong> pil_ToImageTensor(image)</span></pre><p id="3438" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">æˆ‘ä»¬åšäº†ä»€ä¹ˆï¼Ÿ</p><p id="2685" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è¿›æ­¥ï¼Œæˆ‘ä»¬å»æ‰äº†æ„å¤§åˆ©é¢æ¡å¼çš„ä»£ç ï¼Œå¢åŠ äº†æ¨¡å—åŒ–ã€‚ç°åœ¨å°±å¥½åƒæˆ‘ä»¬æœ‰ä¸€ä¸ªä¸‰ä¸ªå‡½æ•°çš„çº¿æ€§é“¾ï¼Œå…¶ä¸­ä¸¤ä¸ªå‡½æ•°è°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°ï¼Œè¿™æ ·æ›´å®¹æ˜“ç†è§£å’Œç»´æŠ¤ã€‚</p><p id="75d2" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated"><code class="du ms mt mu mv b">file_ToImageTensor</code>-&gt;-<code class="du ms mt mu mv b">pil_ToImageTensor</code>-&gt;-<code class="du ms mt mu mv b">numpy_ToImageTensor</code></p><p id="f534" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">æ¨¡å—åŒ–ä½¿å¾—æ·»åŠ æ–°åŠŸèƒ½å˜å¾—éå¸¸ç®€å•ï¼Œå¹¶ä¸”æ˜“äºæµ‹è¯•ï¼Œå› ä¸ºæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹ä¸€ä¸ªç‰¹å®šçš„åŠŸèƒ½ã€‚ä¸ºå‡è®¾ç‰¹å¾è¯·æ±‚ä¿®æ”¹çš„å‡½æ•°çš„ä¸€äº›ä¾‹å­:</p><ol class=""><li id="f94e" class="md me hh jq b jr km ju kn jx mf kb mg kf mh kj mi mj mk ml bi translated"><code class="du ms mt mu mv b">file_ToImageTensor</code> -ä¹Ÿèƒ½è¯»å–é»‘è‰²&amp;ç™½è‰²å›¾åƒã€‚</li><li id="ae0c" class="md me hh jq b jr mm ju mn jx mo kb mp kf mq kj mi mj mk ml bi translated"><code class="du ms mt mu mv b">pil_ToImageTensor</code> -åœ¨å°†å›¾åƒè½¬æ¢ä¸ºå¼ é‡ä¹‹å‰è°ƒæ•´å…¶å¤§å°ã€‚</li></ol><p id="e416" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">è¯·æ³¨æ„ï¼Œå³ä½¿æ‚¨æ²¡æœ‰æ¥è§¦ä¸Šè¿°ç¤ºä¾‹çš„å…¶ä½™ä»£ç ï¼Œä¹Ÿæœ€å¥½æµ‹è¯•å…¶ä»–å‡½æ•°ï¼Œä»¥é¿å…ä»»ä½•æ„å¤–ã€‚</p><p id="e960" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">éšç€è¾“å…¥ç±»å‹å˜å¾—æ›´åŠ å…·ä½“ï¼Œæ¨¡å—åŒ–è®¾è®¡ä¹Ÿä¸ºæ›´å¥½çš„å‡½æ•°åå’Œå‚æ•°åé“ºå¹³äº†é“è·¯ã€‚</p><p id="136d" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated"><code class="du ms mt mu mv b">from_multiInput_toTensor</code>-&gt;<code class="du ms mt mu mv b">file_ToImageTensor</code>-<br/><code class="du ms mt mu mv b">inp</code>-&gt;-<code class="du ms mt mu mv b">file</code></p><p id="4525" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">è¿™äº›ç»†å¾®çš„å˜åŒ–å¯ä»¥ä½¿ä»£ç æ›´åŠ ç”¨æˆ·å‹å¥½ã€‚è€å®è¯´ï¼Œåœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæˆ‘è§‰å¾—æˆ‘æ˜¯åœ¨è¯´æ•™ï¼Œæ‰€ä»¥æˆ‘ä¼šå°½å¿«ç»“æŸè¿™ä¸ªè¯é¢˜ã€‚</p><figure class="ks kt ku kv fd kw"><div class="bz dy l di"><div class="ni nj l"/></div></figure></div><div class="ab cl ld le go lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ha hb hc hd he"><p id="fa87" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated"><strong class="jq hi">å¿«é€Ÿæ£€æŸ¥:</strong></p><p id="beb0" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">è¿™ç¯‡æ–‡ç« å¯¹æˆ‘æ¥è¯´å¤ªé•¿äº†ï¼Œæ‰€ä»¥æˆ‘ä¸æ‰“ç®—å†æµ‹è¯•è´Ÿé¢çš„æˆ–ä¸åŒçš„æ•°æ®ç±»å‹åœºæ™¯ï¼Œåªæ£€æŸ¥åŸå§‹ç”¨ä¾‹ã€‚è€ç«åä½ çœŸçš„ä¸åº”è¯¥è·³è¿‡æµ‹è¯•ã€‚</p><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="acb4" class="lp ix hh mv b fi nb nc l nd ne">is_same_tensor(from_multiInput_toTensor(filename), file_ToImageTensor(filename))</span></pre><p id="2efd" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">æˆ‘ä»¬å¯ä»¥æ”¹è¿›ä»€ä¹ˆï¼Ÿ</p><ul class=""><li id="79f6" class="md me hh jq b jr km ju kn jx mf kb mg kf mh kj mw mj mk ml bi translated">çœ‹èµ·æ¥æˆ‘ä»¬æ­£åœ¨éµå¾ªç›¸åŒçš„æ¨¡å¼ï¼Œç”¨<code class="du ms mt mu mv b">isinstance</code>å‡½æ•°æ£€æŸ¥æ•°æ®ç±»å‹ï¼Œå¹¶ä¸ºæ¯ä¸ªå‡½æ•°å¼•å‘<code class="du ms mt mu mv b">TypeError</code>ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§ä»£ç é‡å¤ã€‚</li><li id="d8d2" class="md me hh jq b jr mm ju mn jx mo kb mp kf mq kj mw mj mk ml bi translated">å¥½çš„ï¼Œæˆ‘ä»¬å¿…é¡»å¯¹å‡½æ•°ååšäº›ä»€ä¹ˆã€‚æˆ‘å¾ˆç¡®å®šæ²¡æœ‰äººä¼šè®°å¾—è¿™äº›åå­—ï¼Œç»å¯¹ä¸æ˜¯æœªæ¥çš„æˆ‘ã€‚</li></ul></div><div class="ab cl ld le go lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ha hb hc hd he"><h1 id="a38e" class="iw ix hh bd iy iz lk jb jc jd ll jf jg in lm io ji iq ln ir jk it lo iu jm jn bi translated">è¿­ä»£4</h1><p id="a761" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated"><strong class="jq hi">ç›®æ ‡:</strong></p><p id="34bf" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">å€ŸåŠ©ç±»å‹è°ƒåº¦æ”¹è¿›æ–‡æ¡£å¹¶é¿å…ä»£ç é‡å¤ã€‚</p><p id="5069" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated"><strong class="jq hi">ç±»å‹è°ƒåº¦:</strong></p><p id="55d6" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">ç±»å‹è°ƒåº¦å…è®¸æ‚¨æ ¹æ®å‡½æ•°æ¥æ”¶çš„è¾“å…¥ç±»å‹æ¥æ”¹å˜å‡½æ•°çš„è¡Œä¸ºæ–¹å¼ã€‚è¿™æ˜¯Julia &amp; Swiftç­‰ä¸€äº›ç¼–ç¨‹è¯­è¨€çš„çªå‡ºç‰¹ç‚¹ã€‚æˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯åœ¨å‡½æ•°å‰æ·»åŠ ä¸€ä¸ªè£…é¥°å™¨<code class="du ms mt mu mv b">typedispatch</code>ã€‚å¤§æ¦‚ï¼Œè®ºè¯å®¹æ˜“è§£é‡Šéš¾ã€‚</p><p id="57d3" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated"><strong class="jq hi">ç±»å‹è°ƒåº¦ç¤ºä¾‹:</strong></p><p id="d8a0" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">å‡½æ•°å®šä¹‰:</p><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="ded1" class="lp ix hh mv b fi nb nc l nd ne"><strong class="mv hi">from</strong> <strong class="mv hi">fastcore.all</strong> <strong class="mv hi">import</strong> *<br/><strong class="mv hi">from</strong> <strong class="mv hi">typing</strong> <strong class="mv hi">import</strong> List</span><span id="da41" class="lp ix hh mv b fi nf nc l nd ne"><em class="kk"># Function to multiply two ndarrays</em><br/>@typedispatch<br/><strong class="mv hi">def</strong> multiple(x:np.ndarray, y:np.ndarray ): <br/>    <strong class="mv hi">return</strong> x * y</span><span id="31a0" class="lp ix hh mv b fi nf nc l nd ne"><em class="kk"># Function to multiply a List by an integer</em><br/>@typedispatch<br/><strong class="mv hi">def</strong> multiple(lst:List, x:int): <br/>    <strong class="mv hi">return</strong> [ x*val <strong class="mv hi">for</strong> val <strong class="mv hi">in</strong> lst]</span></pre><p id="e9d1" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">è°ƒç”¨ç¬¬ä¸€ä¸ªå‡½æ•°:</p><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="41ef" class="lp ix hh mv b fi nb nc l nd ne">x = np.arange(1,3)<br/>print(f'x is <strong class="mv hi">{</strong>x<strong class="mv hi">}</strong>')</span><span id="ad61" class="lp ix hh mv b fi nf nc l nd ne">y = np.array(10)<br/>print(f'y is <strong class="mv hi">{</strong>y<strong class="mv hi">}</strong>')</span><span id="f650" class="lp ix hh mv b fi nf nc l nd ne">print(f'Result of multiplying two numpy arrays: <strong class="mv hi">{</strong> multiple(x, y)<strong class="mv hi">}</strong>')</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="er es nk"><img src="../Images/b8400c5eecbce8f178cb2c328c06f63f.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*9RasySIQv3C98EeZYWU9Xw.png"/></div></div></figure><p id="3d68" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">è°ƒç”¨ç¬¬äºŒä¸ªå‡½æ•°:</p><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="7fa3" class="lp ix hh mv b fi nb nc l nd ne">x = [1, 2]<br/>print(f'x is <strong class="mv hi">{</strong>x<strong class="mv hi">}</strong>')</span><span id="881a" class="lp ix hh mv b fi nf nc l nd ne">y = 10<br/>print(f'y is <strong class="mv hi">{</strong>y<strong class="mv hi">}</strong>')</span><span id="6890" class="lp ix hh mv b fi nf nc l nd ne">print(f'Result of multiplying a List of integers by an integer: <strong class="mv hi">{</strong>multiple(x, y)<strong class="mv hi">}</strong>')</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es nl"><img src="../Images/bd1e51f5cd8e5cb3b7e4190d07067a1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*g7FDRFfmU4cFGfIkCoqVUQ.png"/></div></figure><p id="efa0" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">å¦‚æœç¨‹åºå‘˜ä¸å¿…åœ¨ç›®çš„ä¸å˜çš„æƒ…å†µä¸‹(é’ˆå¯¹å„ç§æ•°æ®ç±»å‹)æƒ³å‡ºä¸åŒçš„å‡½æ•°åï¼Œä»–ä»¬çš„ç”Ÿæ´»ä¼šå¥½å¾—å¤šã€‚å¦‚æœè¿™è¿˜ä¸èƒ½é¼“åŠ±ä½ å°½å¯èƒ½ä½¿ç”¨ç±»å‹è°ƒåº¦ï¼Œé‚£ä¹ˆæˆ‘ä¸çŸ¥é“è¿˜æœ‰ä»€ä¹ˆå¯ä»¥ğŸ¤·</p><p id="df1a" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">æˆ‘ä»¬å°†ä½¿ç”¨<a class="ae kl" href="https://fastcore.fast.ai/" rel="noopener ugc nofollow" target="_blank"> fastcore </a>åŒ…æ¥å®ç°<a class="ae kl" href="https://fastcore.fast.ai/dispatch.html#TypeDispatch" rel="noopener ugc nofollow" target="_blank">ç±»å‹çš„åˆ†æ´¾</a>åˆ°æˆ‘ä»¬çš„ç”¨ä¾‹ã€‚æœ‰å…³fastcoreå’ŒType Dispatchçš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹Hamel husa in<a class="ae kl" href="https://twitter.com/hamelhusain" rel="noopener ugc nofollow" target="_blank">çš„åšå®¢</a>ã€‚ä¹Ÿå¯ä»¥çœ‹çœ‹<a class="ae kl" href="https://docs.fast.ai/" rel="noopener ugc nofollow" target="_blank"> fastai </a>ï¼Œå®ƒå¯å‘äº†æˆ‘å†™è¿™ç¯‡æ–‡ç« ã€‚</p><p id="e68f" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated"><strong class="jq hi">ä»£ç :</strong></p><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="3f54" class="lp ix hh mv b fi nb nc l nd ne"><em class="kk"># Import Libraries</em><br/><strong class="mv hi">import</strong> <strong class="mv hi">numpy</strong> <strong class="mv hi">as</strong> <strong class="mv hi">np</strong><br/><strong class="mv hi">import</strong> <strong class="mv hi">torch</strong><br/><strong class="mv hi">from</strong> <strong class="mv hi">PIL</strong> <strong class="mv hi">import</strong> Image <strong class="mv hi">as</strong> PILImage<br/><strong class="mv hi">from</strong> <strong class="mv hi">pathlib</strong> <strong class="mv hi">import</strong> Path, PurePath<br/><strong class="mv hi">from</strong> <strong class="mv hi">fastcore.all</strong> <strong class="mv hi">import</strong> *<br/></span><span id="f516" class="lp ix hh mv b fi nf nc l nd ne">@typedispatch<br/><strong class="mv hi">def</strong> to_imageTensor(arr: np.ndarray) -&gt; torch.Tensor:<br/>    <em class="kk">"""Change ndarray to torch tensor.</em><br/><em class="kk">    </em><br/><em class="kk">    The ndarray would be of the shape (Height, Width, # of Channels)</em><br/><em class="kk">    but pytorch tensor expects the shape as </em><br/><em class="kk">    (# of Channels, Height, Width) before putting </em><br/><em class="kk">    the Tensor on GPU if it's available.</em><br/><em class="kk">    </em><br/><em class="kk">    Args:</em><br/><em class="kk">        arr[ndarray]: Ndarray which needs to be </em><br/><em class="kk">        converted to torch tensor</em><br/><em class="kk">    </em><br/><em class="kk">    Returns:</em><br/><em class="kk">        Torch tensor on GPU (if it's available)   </em><br/><em class="kk">    """</em><br/>    <br/>    <em class="kk"># Set Torch device to GPU if CUDA supported GPU is available</em><br/>    device = torch.device('cuda' <strong class="mv hi">if</strong> torch.cuda.is_available() <strong class="mv hi">else</strong> 'cpu')<br/>    <br/>    <em class="kk"># Transpose the array before converting to tensor</em><br/>    imgArr = arr.transpose(2, 0, 1) <strong class="mv hi">if</strong> arr.ndim == 3 <strong class="mv hi">else</strong> arr<br/>    <strong class="mv hi">return</strong> torch.Tensor(imgArr).to(device)<br/></span><span id="7a4c" class="lp ix hh mv b fi nf nc l nd ne">@typedispatch<br/><strong class="mv hi">def</strong> to_imageTensor(image: PILImage.Image) -&gt; torch.Tensor:<br/>    <em class="kk">"""Change image to torch tensor.</em><br/><em class="kk">    </em><br/><em class="kk">    The PIL image cast as numpy array with dtype as uint8,</em><br/><em class="kk">    and then passed to to_imageTensor(arr: np.ndarray) function</em><br/><em class="kk">    for converting numpy array to torch tensor.</em><br/><em class="kk">    </em><br/><em class="kk">    Args:</em><br/><em class="kk">        image[PILImage.Image]: PIL Image which </em><br/><em class="kk">        needs to be converted to torch tensor</em><br/><em class="kk">    </em><br/><em class="kk">    Returns:</em><br/><em class="kk">        Torch tensor on GPU (if it's available)   </em><br/><em class="kk">    </em><br/><em class="kk">    """</em><br/>    <strong class="mv hi">return</strong> to_imageTensor(np.asarray(image, np.uint8))<br/></span><span id="98c5" class="lp ix hh mv b fi nf nc l nd ne">@typedispatch<br/><strong class="mv hi">def</strong> to_imageTensor(file: (str, PurePath)) -&gt; torch.Tensor:<br/>    <em class="kk">"""Change image file to torch tensor.</em><br/><em class="kk">    </em><br/><em class="kk">    Read the image from disk as 3 channels (RGB) using PIL, </em><br/><em class="kk">    and passed on to to_imageTensor(image: PILImage.Image)</em><br/><em class="kk">    function for converting Image to torch tensor.</em><br/><em class="kk">    </em><br/><em class="kk">    Args:</em><br/><em class="kk">        file[str, PurePath]: Image file name which needs to</em><br/><em class="kk">        be converted to torch tensor</em><br/><em class="kk">    </em><br/><em class="kk">    Returns:</em><br/><em class="kk">        Torch tensor on GPU (if it's available)</em><br/><em class="kk">    </em><br/><em class="kk">    Raises:</em><br/><em class="kk">        Any error thrown while reading the image file,</em><br/><em class="kk">        Mostly FileNotFoundError will be raised.</em><br/><em class="kk">    </em><br/><em class="kk">    """</em><br/>    <strong class="mv hi">try</strong>: <br/>        img = PILImage.open(file).convert('RGB')<br/>    <strong class="mv hi">except</strong> <strong class="mv hi">Exception</strong> <strong class="mv hi">as</strong> error:<br/>        <strong class="mv hi">raise</strong> error<br/>    <strong class="mv hi">return</strong> to_imageTensor(img)<br/></span><span id="c9f6" class="lp ix hh mv b fi nf nc l nd ne">@typedispatch<br/><strong class="mv hi">def</strong> to_imageTensor(x:object) -&gt; <strong class="mv hi">None</strong>:<br/>    <em class="kk">"""For unsupported data types, raise TypeError. """</em><br/>    <strong class="mv hi">raise</strong> <strong class="mv hi">TypeError</strong>('Input must be of Type - String or Path or PIL Image or Numpy array')</span></pre><p id="0bc0" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated"><strong class="jq hi">æˆ‘ä»¬åšäº†ä»€ä¹ˆï¼Ÿ</strong></p><p id="95f4" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">é€šè¿‡åˆ©ç”¨ç±»å‹åˆ†æ´¾åŠŸèƒ½ï¼Œæˆ‘ä»¬æˆåŠŸåœ°å¯¹æ‰€æœ‰3ä¸ªå‡½æ•°ä½¿ç”¨äº†ç›¸åŒçš„åç§°ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªå‡½æ•°çš„è¡Œä¸ºéƒ½å› å…¶è¾“å…¥ç±»å‹è€Œæœ‰æ‰€ä¸åŒã€‚éšç€è¾“å…¥ç±»å‹çš„åˆ é™¤ï¼Œå‡½æ•°åä¹Ÿç¼©çŸ­äº†ã€‚è¿™ä½¿å¾—å‡½æ•°åæ›´å®¹æ˜“è®°ä½ã€‚</p><p id="b288" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">é€šè¿‡è°ƒç”¨å‡½æ•°åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¯¥å‡½æ•°æ”¯æŒå“ªäº›ä¸åŒçš„è¾“å…¥ç±»å‹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒFastcore éœ€è¦ä¸¤ä¸ªè¾“å…¥å‚æ•°ï¼Œå› ä¸ºæˆ‘ä»¬åªå°†ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šä¸ºå¯¹è±¡ã€‚ç¬¬äºŒä¸ªå‚æ•°å¯¹å‡½æ•°è¡Œä¸ºæ²¡æœ‰ä»»ä½•å½±å“ã€‚</p><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="843f" class="lp ix hh mv b fi nb nc l nd ne">to_imageTensor</span><span id="227e" class="lp ix hh mv b fi nf nc l nd ne"># OUTPUT<br/>(ndarray,object) -&gt; to_imageTensor<br/>(Image,object) -&gt; to_imageTensor<br/>(str,object) -&gt; to_imageTensor<br/>(PurePath,object) -&gt; to_imageTensor<br/>(object,object) -&gt; to_imageTensor</span></pre><p id="8cab" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">åœ¨inspectæ¨¡å—çš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®ç‰¹å®šå‡½æ•°çš„è¾“å…¥å’Œè¾“å‡ºç±»å‹ã€‚</p><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="0326" class="lp ix hh mv b fi nb nc l nd ne"><strong class="mv hi">import</strong> <strong class="mv hi">inspect</strong><br/>inspect.signature(to_imageTensor[np.ndarray])</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es nm"><img src="../Images/1d8b2623e88019bb26ab57d07efa17b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*KEYbtJU1owzFgKiEkS4-8A.png"/></div></figure><p id="4ac9" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">è¯¥è¿­ä»£ä¸­å®ç°çš„docstringsä½¿ä»£ç æ›´å…·å¯è¯»æ€§ã€‚ç‰¹å®šè¾“å…¥ç±»å‹çš„docstringå¯ä»¥é€šè¿‡è°ƒç”¨<strong class="jq hi"> doc </strong>å’Œè¾“å…¥ç±»å‹æ¥è®¿é—®ã€‚</p><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="3442" class="lp ix hh mv b fi nb nc l nd ne">print(to_imageTensor[np.ndarray].__doc__)</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es nn"><img src="../Images/7f0121c50e306ad35a064ee71efb2e04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*BViklpQzTP01a4Uqmj5Z5Q.png"/></div></figure><p id="cce3" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">æ­£å¦‚ä¸Šä¸€èŠ‚æ‰€è®¨è®ºçš„ï¼Œæˆ‘ä»¬è®¾æ³•å°†<code class="du ms mt mu mv b">TypeError</code>æ¶ˆæ¯ç§»åŠ¨åˆ°ä¸€ä¸ªå•ç‹¬çš„å‡½æ•°ä¸­ï¼Œå…¶è¾“å…¥ç±»å‹ä¸º<code class="du ms mt mu mv b">object</code>ã€‚</p><p id="2e8b" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated"><strong class="jq hi">å¿«é€Ÿæ£€æŸ¥:</strong></p><p id="050f" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">è¿˜åœ¨å·¥ä½œï¼</p><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="5861" class="lp ix hh mv b fi nb nc l nd ne">is_same_tensor(file_ToImageTensor(filename), to_imageTensor(filename))</span></pre><p id="abee" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">å°†ä¸æ”¯æŒçš„æ•°æ®ç±»å‹ä¼ é€’ç»™å‡½æ•°æ—¶éªŒè¯é”™è¯¯æ¶ˆæ¯ã€‚</p><pre class="ks kt ku kv fd mx mv my mz aw na bi"><span id="7282" class="lp ix hh mv b fi nb nc l nd ne">to_imageTensor([filename])</span></pre><figure class="ks kt ku kv fd kw er es paragraph-image"><div class="er es nh"><img src="../Images/0e838f6e4ad0502a7e176833d41d0b69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*c3xLGWCVlpc3PQnW-J6BXw.png"/></div></figure><p id="7089" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">æˆ‘ä»¬å¯ä»¥æ”¹è¿›ä»€ä¹ˆï¼Ÿ</p><p id="682e" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">è¿™å°±æ˜¯äº†ã€‚æˆ‘æƒ³æˆ‘ä»¬åˆ°æ­¤ä¸ºæ­¢äº†ã€‚</p></div><div class="ab cl ld le go lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ha hb hc hd he"><h1 id="cf5e" class="iw ix hh bd iy iz lk jb jc jd ll jf jg in lm io ji iq ln ir jk it lo iu jm jn bi translated">ç»“æŸè¯­</h1><p id="a04f" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">æˆ‘ä»¬çœŸçš„ä¸ºè¿™ä¸ªç”¨ä¾‹ç¼–å†™äº†<em class="kk">æœ€ä½³å‡½æ•°</em>å—ï¼Ÿæˆ‘æƒ³æ˜¯çš„ï¼Œä½†æ˜¯ä¸è¦ç›¸ä¿¡æˆ‘çš„è¯ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æœ¬å¸–<a class="ae kl" href="https://github.com/6aravind/tidbits/blob/main/base/Write%20better%20python%20functions%20using%20type%20dispatch.ipynb" rel="noopener ugc nofollow" target="_blank">çš„ç¬”è®°æœ¬ç‰ˆæœ¬</a>ã€‚å¦‚æœä½ æƒ³ç»™è¿™ç¯‡æ–‡ç« æ·»åŠ ä»€ä¹ˆï¼Œè¯·éšæ—¶é€šè¿‡<a class="ae kl" href="https://twitter.com/@6aravind" rel="noopener ugc nofollow" target="_blank">æ¨ç‰¹</a>æˆ–è¯„è®ºåŒºè”ç³»æˆ‘ã€‚æˆ‘å¾ˆä¹æ„æ ¹æ®ä½ çš„è¯„è®ºæ›´æ–°è¿™ç¯‡æ–‡ç« ã€‚</p><p id="283a" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated">å°½ç®¡å½“æˆ‘å¼€å§‹å†™è¿™ç¯‡æ–‡ç« æ—¶ï¼Œç±»å‹è°ƒåº¦æ˜¯é‡ç‚¹ï¼Œä½†å¾ˆå¿«æˆ‘æ„è¯†åˆ°ä»£ç è¿›åŒ–è¿‡ç¨‹ä¹ŸåŒæ ·é‡è¦ã€‚æ‰€ä»¥æˆ‘å†³å®šæŠŠå®ƒä¹ŸåŒ…æ‹¬è¿›å»ã€‚æˆ‘å¸Œæœ›æ‚¨å–œæ¬¢è¿™æ®µç¼–å†™pythonå‡½æ•°çš„æ—…ç¨‹ã€‚</p><h1 id="2997" class="iw ix hh bd iy iz ja jb jc jd je jf jg in jh io ji iq jj ir jk it jl iu jm jn bi translated">ä¿¡ç”¨</h1><ol class=""><li id="c3b7" class="md me hh jq b jr js ju jv jx no kb np kf nq kj mi mj mk ml bi translated"><a class="ae kl" href="https://www.iconbros.com/icons/ib-b-video-card" rel="noopener ugc nofollow" target="_blank">æ˜¾å¡</a>å›¾æ ‡ç”±<a class="ae kl" href="https://iconbros.com/" rel="noopener ugc nofollow" target="_blank"> IconBros </a></li><li id="b581" class="md me hh jq b jr mm ju mn jx mo kb mp kf mq kj mi mj mk ml bi translated"><a class="ae kl" href="https://www.zwicon.com/" rel="noopener ugc nofollow" target="_blank">å…¹ç»´åº·</a></li></ol></div><div class="ab cl ld le go lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ha hb hc hd he"><p id="d926" class="pw-post-body-paragraph jo jp hh jq b jr km ii jt ju kn il jw jx ko jz ka kb kp kd ke kf kq kh ki kj ha bi translated"><em class="kk">åŸè½½äº2021å¹´4æœˆ10æ—¥https://www.analyticsvidhya.com</em><a class="ae kl" href="https://www.analyticsvidhya.com/blog/2021/04/write-better-python-functions-using-type-dispatch/" rel="noopener ugc nofollow" target="_blank"><em class="kk"/></a><em class="kk">ã€‚</em></p></div></div>    
</body>
</html>