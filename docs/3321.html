<html>
<head>
<title>Setup CI for your Python Code with Travis CI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Travis CI为您的Python代码设置CI</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/python-code-to-know-for-test-automation-aef47d27428c?source=collection_archive---------16-----------------------#2021-06-24">https://medium.com/analytics-vidhya/python-code-to-know-for-test-automation-aef47d27428c?source=collection_archive---------16-----------------------#2021-06-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/5bbda1d7e599b52c7202be7d2d7d2bc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lOy1FmrCtH1MLM0p"/></div></div></figure><p id="cc9d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae jn" href="https://testsigma.com/blog/ai-driven-test-automation/" rel="noopener ugc nofollow" target="_blank">图像来源</a></p><h1 id="5d1a" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">介绍</h1><p id="daf9" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">测试在软件开发中是一个至关重要的话题，因为它可以节省时间，特别是在处理定期改进的软件时，以确保您的更改不会影响软件的其他部分。测试还有助于在交付生产之前识别缺陷。测试您的代码还有许多其他原因，但这不是本文要讨论的，所以我将留给您去研究。</p><p id="61f1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><a class="ae jn" href="https://www.perfecto.io/blog/what-is-test-automation" rel="noopener ugc nofollow" target="_blank">测试自动化</a>是使用软件来扮演角色，以我们想要的任何顺序运行我们编写的测试代码，并将结果与预期结果进行比较。</p><p id="75de" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在本文中，您将会学到很多关于自动化测试如何工作的知识；您将能够区分手动测试和自动化测试，如何使用pytest编写自动化测试，以及如何将手动测试转换为自动化测试。</p><h1 id="297c" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">先决条件</h1><ol class=""><li id="d21a" class="kr ks hh ir b is km iw kn ja kt je ku ji kv jm kw kx ky kz bi translated">Python基础</li><li id="7ee1" class="kr ks hh ir b is la iw lb ja lc je ld ji le jm kw kx ky kz bi translated">Git和GitHub的基础知识</li></ol><p id="4431" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Python是自动化测试的最佳语言之一。由于它的简单性和英语，它就像大自然一样，很容易上手。我们将使用Pytest来完成自动化测试的任务。我们将首先编写单元测试，然后用Travis CI自动化测试。如果你以前没有听说过特拉维斯CI，不要担心。在我们开始使用它之前，我会先谈一点。</p><h1 id="92ab" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">Pytest是什么？</h1><p id="9606" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">Pytest是一个框架，它使得构建简单且可伸缩的测试变得容易。Pytest还帮助您编写非常可伸缩的测试，并提供测试覆盖率来显示您的代码已经测试了多少。遗憾的是，我不会在这里详细介绍Pytest的内部工作原理。</p><p id="645b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">代码片段在<a class="ae jn" href="https://github.com/khabdrick/python_pytest" rel="noopener ugc nofollow" target="_blank">存储库</a>中，因此如果您对文件排列有问题，您可以查看一下。</p><h1 id="1bc2" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">如何在本地设备上设置Pytest</h1><p id="10ae" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">首先，为项目创建一个新的虚拟环境。</p><p id="d875" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du lf lg lh li b">$ virtualenv env</code></p><p id="f4ba" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">激活虚拟环境；<br/>在MacOS和Linux上:</p><p id="2e33" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du lf lg lh li b">$ source env/bin/activate</code></p><p id="a958" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在Windows上:</p><p id="165a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du lf lg lh li b">$ .\env\Scripts\activate</code></p><p id="b0cd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后，安装pytest。</p><p id="d152" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du lf lg lh li b">$ pip install pytest</code></p><p id="ed53" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在终端/命令行上运行<code class="du lf lg lh li b"> $ pip freeze </code>应该会提供以下输出。</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="6abc" class="lr jp hh li b fi ls lt l lu lv">$ pip freeze<br/>attrs==21.2.0<br/>coverage==5.5<br/>iniconfig==1.1.1<br/>packaging==20.9<br/>pluggy==0.13.1<br/>py==1.10.0<br/>pyparsing==2.4.7<br/>pytest==6.2.4<br/>toml==0.10.2</span></pre><h1 id="4780" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">单元测试</h1><p id="5162" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">首先，让我们先创建一个文件，并编写一些我们可以测试的python代码。下面是一个简单的加减法代码。</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="71d8" class="lr jp hh li b fi ls lt l lu lv"># arithmetic.py<br/>def sum(x, y):<br/> return x+y</span><span id="398d" class="lr jp hh li b fi lw lt l lu lv">def minus(x, y):<br/> return x-y</span></pre><p id="b0f5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在让我们为我们的测试创建一个新文件。<br/>注意:如果文件和函数以“test_”开头，pytest将识别包含要测试的代码的文件和函数</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="bfc0" class="lr jp hh li b fi ls lt l lu lv"># test_arithmetic.py<br/>import arithmetic<br/>def test_sum(): <br/> assert arithmetic.sum(5, 2)== 7<br/> assert arithmetic.sum(100, 200)==300<br/> assert type(arithmetic.sum(“Hi “, “there”)) is str<br/> assert arithmetic.sum(“Hi “, “there”) == “Hi there”</span><span id="8691" class="lr jp hh li b fi lw lt l lu lv">def test_minus():<br/> assert arithmetic.minus(5, 2) &gt;= 2<br/> assert arithmetic.minus(-5, -5)==0</span></pre><p id="e47a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">测试一般与断言有关。断言只是意味着您编写的代码在命令行运行时给出了期望的输出</p><p id="52f0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du lf lg lh li b">$ python -m pytest -v</code></p><p id="ed0e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对于windows用户</p><p id="1fea" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du lf lg lh li b">$ pytest -v</code></p><p id="0d3a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">运行上述程序后，您应该会看到类似这样的内容:</p><p id="5512" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><code class="du lf lg lh li b">$ python -m pytest -v</code></p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="a128" class="lr jp hh li b fi ls lt l lu lv">============================= test session starts ==============================<br/>platform linux — Python 3.8.5, pytest-6.2.4, py-1.10.0, pluggy-0.13.1 — /home/muhammed/Desktop/dev/blog-repo/python-pytest/my_env/bin/python</span><span id="621b" class="lr jp hh li b fi lw lt l lu lv">cachedir: .pytest_cache</span><span id="2c6f" class="lr jp hh li b fi lw lt l lu lv">rootdir: /home/muhammed/Desktop/dev/blog-repo/python-pytest</span><span id="7625" class="lr jp hh li b fi lw lt l lu lv">plugins: cov-2.12.0</span><span id="65ec" class="lr jp hh li b fi lw lt l lu lv">collected 2 items</span><span id="2890" class="lr jp hh li b fi lw lt l lu lv">test_arithmetic.py::test_sum PASSED [ 50%]</span><span id="3dc5" class="lr jp hh li b fi lw lt l lu lv">test_arithmetic.py::test_minus PASSED [100%]</span></pre><h1 id="9415" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">如何自动化您的测试</h1><p id="b8a7" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">现在，我们将进入会议的主菜。我们可以通过添加Travis CI来实现自动化。我们的例子是一个非常小的例子，但是假设我们有一个大的项目，我们不希望每次对代码库进行修改时都要运行测试。我们可以选择使用另一个软件来自动运行我们的测试过程！</p><p id="c3cb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Travis CI是一个<a class="ae jn" href="https://en.wikipedia.org/wiki/Continuous_integration" rel="noopener ugc nofollow" target="_blank">持续集成</a>工具。它与版本控制管理系统(如Git)一起工作，当变更被做出并提交到存储库时，根据分配给它的任务，自动运行测试。我们用一个. travis.yaml文件将任务分配给Travis CI，稍后我们会看到。你也可以在任何测试失败的时候收到电子邮件。</p><h1 id="f31a" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">设置Travis CI</h1><p id="ee51" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">在我们开始工作之前，您必须在本地设备上安装git。如果你没有，这个<a class="ae jn" href="https://git-scm.com/downloads" rel="noopener ugc nofollow" target="_blank">链接</a>应该可以帮你做到。</p><p id="cc4f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">要为您的项目设置Travis CI，假设您有一个GitHub帐户，请访问他们的网站，单击“登录”按钮，然后单击“使用GitHub登录”。从那开始应该很容易。之后，Travis CI会给出以下指令，让您按照这些指令来激活您的存储库，以便Travis CI可以对其进行操作。</p><p id="d486" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">接下来，您将在您的终端/命令提示符下运行<code class="du lf lg lh li b">$ pip freeze &gt; requirements.txt</code>,将requirements.txt文件中的所有依赖项列表存储到您的本地机器中。在根目录下创建<code class="du lf lg lh li b">.travis.yaml </code>文件，并放入以下代码:</p><pre class="lj lk ll lm fd ln li lo lp aw lq bi"><span id="ea97" class="lr jp hh li b fi ls lt l lu lv">language: python<br/>python:<br/> — “3.7”<br/>install:<br/> — pip install -r requirements.txt<br/>script:<br/> — python -m pytest -v</span></pre><p id="0a51" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">上面的代码非常容易理解。你陈述你想要使用的语言，然后是版本。</p><p id="b163" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后你在<code class="du lf lg lh li b">requirements.txt</code>文件中安装这些东西,“脚本”被用来运行测试。<br/>现在将您的代码推送到GitHub，它会显示在Travis CI上。</p><p id="68ff" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在Travis CI网站上，您会看到您的存储库列表。点击您想要检查的，然后点击branches选项卡，您将会看到Travis CI已经开始为您运行您的测试。</p><figure class="lj lk ll lm fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lx"><img src="../Images/a246a92f83e42d54be4f6dcc381e5cff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BbrAZoQSBBUjaiTk"/></div></div></figure><p id="1834" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">您可以单击复选标记查看详细信息。</p><h1 id="264c" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">结论</h1><p id="b389" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">在这篇文章中，我能够触及测试、自动化测试，以及在某种程度上，持续集成。我希望我已经令人满意地解释了它，所以你能理解和跟随。感谢阅读！</p></div></div>    
</body>
</html>