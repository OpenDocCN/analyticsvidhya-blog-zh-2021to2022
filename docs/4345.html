<html>
<head>
<title>Connecting to MongoDB Atlas with Python-PyMongo</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python-PyMongo连接到MongoDB Atlas</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/connecting-to-mongodb-atlas-with-python-pymongo-5b25dab3ac53?source=collection_archive---------0-----------------------#2021-09-26">https://medium.com/analytics-vidhya/connecting-to-mongodb-atlas-with-python-pymongo-5b25dab3ac53?source=collection_archive---------0-----------------------#2021-09-26</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="3814" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我们将使用python连接到一个简单的MongoDB数据库。我们将对数据执行简单的操作，如:</p><ul class=""><li id="6c50" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">添加</li><li id="6bc6" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">更新</li><li id="72e5" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">删除</li><li id="c03b" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">一次添加多条记录</li></ul><p id="1815" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这篇文章的视频版本可以在<a class="ae jq" href="https://youtu.be/M5zCRDPQbQE" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="45f3" class="jr js hh bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko bi translated"><strong class="ak"> MongoDB图集</strong></h1><blockquote class="kp kq kr"><p id="8fde" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">报名<strong class="ig hi"> MongoDB图集</strong>这里:<a class="ae jq" href="https://www.mongodb.com/atlas-signup-from-mlab" rel="noopener ugc nofollow" target="_blank">数据库访问|图集:MongoDB图集</a></p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/36717f1a7535bd9de5e2500f467cef65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*No6ASrH6QyyBvxGKjFUJrA.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">Img来源:<a class="ae jq" href="https://www.mongodb.com/atlas-signup-from-mlab" rel="noopener ugc nofollow" target="_blank">报名MongoDB图集|云MongoDB托管| MongoDB </a></figcaption></figure><blockquote class="kp kq kr"><p id="991b" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">选择一个<strong class="ig hi">展开选项</strong>:</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lm"><img src="../Images/54bf02b66e37c67649418c40c3ac5b04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N6hBOot96uDOxOAUkS5jqg.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">Img来源:<a class="ae jq" href="https://www.mongodb.com/atlas-signup-from-mlab" rel="noopener ugc nofollow" target="_blank">报名MongoDB图集|云MongoDB托管| MongoDB </a></figcaption></figure><blockquote class="kp kq kr"><p id="b880" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">选择所需的<strong class="ig hi">云提供商</strong>和最近的<strong class="ig hi">地区</strong>:</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lm"><img src="../Images/498a6d0ee1cd5916e46f76bc4b2e81c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aFF_C1crI9mPLcwmoXe1sg.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">作者Img</figcaption></figure><blockquote class="kp kq kr"><p id="e2da" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">在数据库访问选项卡中，转到“<strong class="ig hi">添加新的数据库用户</strong>”:</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es ln"><img src="../Images/4b912bb879ab78c15b2fef5d329988e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o91keC07hZulpOqi4OgyUg.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">作者Img</figcaption></figure><blockquote class="kp kq kr"><p id="7dc5" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">创建要测试的集群:</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/fa5ad5a616b7283798937b6cd7f718b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CxLjpPM0be41bLveoy8ABg.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">作者Img</figcaption></figure><blockquote class="kp kq kr"><p id="402f" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">您可以加载现有的样本数据集，也可以创建和添加您自己的数据。点击<strong class="ig hi">添加我自己的数据</strong>按钮:</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/c753b28e36cf4fad7e318df3adb1f20c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oRK9_bpi3sMwBLFQYmVnvQ.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">作者Img</figcaption></figure><blockquote class="kp kq kr"><p id="0a27" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">将打开此对话框，您必须在其中为新数据库输入新的数据库名称和集合名称:</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lo"><img src="../Images/78b1ddf6f3971de07133bd2a1937215e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2IN3-dnpj5QyMfCTQ0y5Iw.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">作者Img</figcaption></figure><blockquote class="kp kq kr"><p id="d00d" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">您将能够看到此屏幕:</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es kw"><img src="../Images/f2126e253808df871daf41df167229a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ea6AiruUVB9GAK1JBN3W4A.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">作者Img</figcaption></figure><blockquote class="kp kq kr"><p id="e773" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">现在转到<strong class="ig hi">网络访问</strong>来连接您的集群。在此添加您的<strong class="ig hi"> IP地址</strong>，因为您的数据库用户已经创建:</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lp"><img src="../Images/ef6c28dbe7b477d195868fbdc0b43860.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fyJ8tkyeQ74cLqT85JmQmw.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">作者Img</figcaption></figure><blockquote class="kp kq kr"><p id="0eb5" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">完成后，您可以选择<strong class="ig hi">连接方式</strong>。点击<strong class="ig hi">连接您的应用</strong>:</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lq"><img src="../Images/eb30eadd149e11707683c760f038e833.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VbDFkqGHmNGnkYSSyiJdjA.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">作者Img</figcaption></figure><blockquote class="kp kq kr"><p id="d1e3" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">分别选择<strong class="ig hi">驱动</strong>和<strong class="ig hi">版本</strong>为"<strong class="ig hi"> Python和3.6" </strong>或更高版本:</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lp"><img src="../Images/c6393c3d53aabd14067a972a9b07383a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IjcRpx7XsYhnNkXbHAn4Ug.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">作者Img</figcaption></figure><blockquote class="kp kq kr"><p id="5f4e" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">您将得到类似于以下内容的字符串:</p></blockquote><pre class="kx ky kz la fd lr ls lt lu aw lv bi"><span id="d1fc" class="lw js hh ls b fi lx ly l lz ma">mongodb+srv://SoumiBardhan:&lt;password&gt;<a class="ae jq" href="http://twitter.com/cluster" rel="noopener ugc nofollow" target="_blank">@cluster</a>-test.fndbj.mongodb.net/myFirstDatabase?retryWrites=true&amp;w=majority</span></pre><blockquote class="kp kq kr"><p id="e36d" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">复制并保存在某个地方。现在，您可以连接到您的数据库。首先在您的系统上创建一个新的python文件<code class="du mb mc md ls b">test_mongo_connection.py</code>。导入pymongo，它是python驱动程序，可以让我们连接到MongoDB数据库。</p></blockquote><pre class="kx ky kz la fd lr ls lt lu aw lv bi"><span id="1254" class="lw js hh ls b fi lx ly l lz ma">import pymongo<br/>from pymongo import MongoClient</span></pre><blockquote class="kp kq kr"><p id="484b" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">使用URL连接集群。在此URL中替换您的用户名和密码。</p></blockquote><pre class="kx ky kz la fd lr ls lt lu aw lv bi"><span id="21c2" class="lw js hh ls b fi lx ly l lz ma">cluster = MongoClient("mongodb+srv://&lt;USERNAME&gt;:&lt;PASSWORD&gt;@cluster-test.fndbj.mongodb.net/UserData?retryWrites=true&amp;w=majority")</span></pre><blockquote class="kp kq kr"><p id="23b8" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">通过提供您之前创建的数据库的名称，创建一个新的<strong class="ig hi">数据库</strong> <code class="du mb mc md ls b">db</code>。通过提供您创建的<strong class="ig hi">集合</strong>名称来初始化集合。</p></blockquote><pre class="kx ky kz la fd lr ls lt lu aw lv bi"><span id="0f74" class="lw js hh ls b fi lx ly l lz ma">db = cluster["UserData"]</span><span id="3ef8" class="lw js hh ls b fi me ly l lz ma">collection = db["Flask_mongo"]</span></pre><blockquote class="kp kq kr"><p id="e4ee" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">现在让我们看看如何插入一些数据。您可以通过在python文件中添加以下语句来实现:</p></blockquote><pre class="kx ky kz la fd lr ls lt lu aw lv bi"><span id="8905" class="lw js hh ls b fi lx ly l lz ma">collection.insert_one({"_id":0, "user_name":"Soumi"})<br/>collection.insert_one({"_id":100, "user_name":"Ravi"})</span></pre><blockquote class="kp kq kr"><p id="fe13" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">您还可以添加更多字段。接下来，用<code class="du mb mc md ls b">python3 test_mongo_connection.py</code>执行文件。</p></blockquote><p id="cc81" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您将能够在仪表板上看到更新的数据。</p><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es lm"><img src="../Images/e39d64e1cbb46941cc3f2a1f7c373be1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UN3hgMIcWOXxoDeth9GzGQ.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">作者Img</figcaption></figure><blockquote class="kp kq kr"><p id="a874" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">现在，让我们看看如何删除帖子:</p></blockquote><pre class="kx ky kz la fd lr ls lt lu aw lv bi"><span id="f2ee" class="lw js hh ls b fi lx ly l lz ma">collection.delete_one({"_id":0, "user_name":"Soumi"})</span></pre><blockquote class="kp kq kr"><p id="63e9" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">这篇文章将被删除，你将能够从数据库中查看。</p><p id="5122" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">您也可以像这样一起添加多个帖子:</p></blockquote><pre class="kx ky kz la fd lr ls lt lu aw lv bi"><span id="9c5c" class="lw js hh ls b fi lx ly l lz ma">post1 = {"_id":"0", "user_name":"Soumi"}</span><span id="2c4a" class="lw js hh ls b fi me ly l lz ma">post2 = {"_id":"100", "user_name":"Ravi"}</span><span id="a6b0" class="lw js hh ls b fi me ly l lz ma">collection.insert_many([post1,post2])</span></pre><blockquote class="kp kq kr"><p id="79a9" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">更新具有特定ID的帖子:</p></blockquote><pre class="kx ky kz la fd lr ls lt lu aw lv bi"><span id="1549" class="lw js hh ls b fi lx ly l lz ma">collection.find_one_and_update({"_id":"0"}, {"$set" : {"user_name" : updated_user_name}}, upsert = 0 )</span></pre><blockquote class="kp kq kr"><p id="a3c9" class="ie if ks ig b ih ii ij ik il im in io kt iq ir is ku iu iv iw kv iy iz ja jb ha bi translated">因此，根据需求，你可能需要<strong class="ig hi">将你当前的IP </strong>列入白名单，因为它会随着时间而变化。</p></blockquote><figure class="kx ky kz la fd lb er es paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="er es mf"><img src="../Images/8d165218425ad8739f1bfc241664080b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dIOEFwasyY153vyTuqUaqQ.png"/></div></div><figcaption class="li lj et er es lk ll bd b be z dx translated">作者Img</figcaption></figure><p id="4bf8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，我们连接了一个MongoDB数据库，并执行了一些基本操作。在下一篇文章中，我们使用Flask和MongoDB制作了一个简单的用户登录系统。</p></div><div class="ab cl mg mh go mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ha hb hc hd he"><h1 id="8781" class="jr js hh bd jt ju mn jw jx jy mo ka kb kc mp ke kf kg mq ki kj kk mr km kn ko bi translated">参考</h1><ul class=""><li id="d44e" class="jc jd hh ig b ih ms il mt ip mu it mv ix mw jb jh ji jj jk bi translated"><a class="ae jq" href="https://pymongo.readthedocs.io/en/stable/index.html" rel="noopener ugc nofollow" target="_blank"> PyMongo 3.12.0文档— PyMongo 3.12.0文档</a></li><li id="0808" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated"><a class="ae jq" href="https://www.mongodb.com/cloud/atlas/lp/try2-in?utm_source=bing&amp;utm_campaign=mdb_bs_apac_india_search_core_brand_atlas_desktop&amp;utm_term=mongodb%20atlas&amp;utm_medium=cpc_paid_search&amp;utm_ad=e&amp;utm_ad_campaign_id=415204524&amp;msclkid=fa888df91f3f192f6eebeca92fe7e575" rel="noopener ugc nofollow" target="_blank"> MongoDB图集:云文档数据库| MongoDB </a></li></ul></div></div>    
</body>
</html>