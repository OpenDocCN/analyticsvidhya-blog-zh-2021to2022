<html>
<head>
<title>ALL STATISTICAL TESTS IN R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R中的所有统计检验</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/all-statistical-tests-in-r-7a55ca5e46a2?source=collection_archive---------1-----------------------#2022-02-14">https://medium.com/analytics-vidhya/all-statistical-tests-in-r-7a55ca5e46a2?source=collection_archive---------1-----------------------#2022-02-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/cb4432a912d5ba54a1947b412af9dbbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D7_KKN5uhDcfW3DjRXp8NQ.jpeg"/></div></div></figure></div><div class="ab cl ip iq go ir" role="separator"><span class="is bw bk it iu iv"/><span class="is bw bk it iu iv"/><span class="is bw bk it iu"/></div><div class="ha hb hc hd he"><p id="e9d4" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi ju translated"><span class="l jv jw jx bm jy jz ka kb kc di"/>统计测试提供了一种对流程进行定量决策的机制。目标是确定是否有足够的证据来“拒绝”关于过程的假设或假说。要使用统计测试，过程必须满足一些条件(假设)。</p><p id="fb3a" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">有两种类型的测试，即参数测试和非参数测试。让我们首先从参数测试开始。</p></div><div class="ab cl ip iq go ir" role="separator"><span class="is bw bk it iu iv"/><span class="is bw bk it iu iv"/><span class="is bw bk it iu"/></div><div class="ha hb hc hd he"><h1 id="f5ad" class="kd ke hh bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated"><strong class="ak">测试总体均值</strong></h1><h1 id="4e69" class="kd ke hh bd kf kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la bi translated">R中的参数检验</h1><h2 id="9428" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">单样本T检验</h2><p id="0b28" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated">它测试总体均值是否等于(大于或小于)特定值。</p><h2 id="98fc" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">假设:</h2><ul class=""><li id="a0bb" class="lz ma hh iy b iz lu jd lv jh mb jl mc jp md jt me mf mg mh bi translated">观察的独立性</li><li id="cdb9" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">样本的正态性</li><li id="63b2" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">随机性</li></ul><p id="78b9" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">让我们用“钻石”数据集来展示如何使用统计测试。</p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="c9f6" class="lg ke hh ms b fi mw mx l my mz">library(ggplot2)<br/>library(kableExtra)<br/>library(knitr)<br/>library(rsample)<br/><br/>data(diamonds)<br/>kbl(head(diamonds), caption="Dataset", booktabs = T) %&gt;% kable_styling(latex_options = c("striped", "hold_position","scale_down"),font_size=12, stripe_index = c(1,3,5,7))</span></pre><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es na"><img src="../Images/caa75e3ed658da2c48f2229c2a30d14c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C1RHwh7BjYNIm2ai6SkXBg.png"/></div></div><figcaption class="nb nc et er es nd ne bd b be z dx translated">图一。钻石数据集</figcaption></figure><p id="a372" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">测试钻石的价格是否大于3500。</p><p id="4ba2" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">首先，我们用夏皮罗-威尔克正态性检验和qq图来检验正态性。</p><p id="9f46" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi"> Q-Q图:</strong> Q-Q图(或分位数-分位数图)绘制给定样本与正态分布之间的相关性。还绘制了45度参考线。</p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="08c9" class="lg ke hh ms b fi mw mx l my mz">library(ggpubr)<br/>ggqqplot(diamonds$price)</span></pre><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nf"><img src="../Images/94db6955e8a8656090cc6aeadb27feaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oViS0S7mdEE8mfY62gV1_g.png"/></div></div><figcaption class="nb nc et er es nd ne bd b be z dx translated">图二。带“ggpubr”包的QQPlot</figcaption></figure><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="4ccd" class="lg ke hh ms b fi mw mx l my mz">library("car")<br/>qqPlot(diamonds$price)</span></pre><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ng"><img src="../Images/ff94e94d5b92cc81ceb4e3d013a27002.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b9sZybyUPqjPaAQLlUNbaw.png"/></div></div><figcaption class="nb nc et er es nd ne bd b be z dx translated">图3。带“汽车”包的QQPlot</figcaption></figure><p id="1f3b" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">当我们查看<em class="nh">【价格】</em>变量的qqplot时，上尾部和下尾部存在巨大的偏差。此外，还有离群值。然后，用适当的检验来检验正态性。</p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="631b" class="lg ke hh ms b fi mw mx l my mz"><em class="nh">shapiro.test(diamonds$price)</em><br/><br/><strong class="ms hi"><em class="nh">Error in shapiro.test(diamonds$price) : sample size must be between 3 and 5000</em></strong></span></pre><ul class=""><li id="0495" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">正如所见，当样本量大于5000时，夏皮罗检验不起作用。在这种情况下，使用Kolmogorov-Smirnov检验或Jarque-Bera正态性检验。</li></ul><blockquote class="nl nm nn"><p id="e45f" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho:样本正态分布</p><p id="8bbd" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">H1:样本不服从正态分布</p></blockquote><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="b1b4" class="lg ke hh ms b fi mw mx l my mz">ks.test(x=diamonds$price,y='pnorm',alternative='two.sided')<br/>## <br/>##  One-sample Kolmogorov-Smirnov test<br/>## <br/>## data:  diamonds$price<br/>## D = 1, p-value &lt; 2.2e-16<br/>## alternative hypothesis: two-sided</span></pre><p id="cda6" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">Jarque-Bera检验是一种拟合优度检验，用于确定样本数据的偏斜度和峰度是否符合正态分布。</p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="9a21" class="lg ke hh ms b fi mw mx l my mz">library(tseries)<br/>jarque.bera.test(diamonds$price)<br/>## <br/>##  Jarque Bera Test<br/>## <br/>## data:  diamonds$price<br/>## X-squared = 34201, df = 2, p-value &lt; 2.2e-16</span></pre><p id="fed2" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">正如Jarque-Bera检验和Kolmogorov-Smirnov检验所示，p值小于0.05的显著性水平，因此拒绝零假设(Ho)。这意味着钻石的价格不是正态分布的。通常，在这种情况下，我们不能使用t-检验，但作为如何在R中进行t-检验的例子，假设满足正态性。</p><p id="9b9d" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">假设:</strong></p><blockquote class="nl nm nn"><p id="871f" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">何:μ=3500 vs H1: μ&gt;3500</p></blockquote><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="aded" class="lg ke hh ms b fi mw mx l my mz">t.test(diamonds$price,mu=3500,alternative = "greater")<br/>## <br/>##  One Sample t-test<br/>## <br/>## data:  diamonds$price<br/>## t = 25.196, df = 53939, p-value &lt; 2.2e-16<br/>## alternative hypothesis: true mean is greater than 3500<br/>## 95 percent confidence interval:<br/>##  3904.545      Inf<br/>## sample estimates:<br/>## mean of x <br/>##    3932.8</span></pre><p id="94c4" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">替代= </strong>指定替代假设的字符串，必须是<code class="du nr ns nt ms b">"two.sided"</code>(默认)、<code class="du nr ns nt ms b">"greater"</code>或<code class="du nr ns nt ms b">"less"</code>中的一个。</p><p id="a91f" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">当我们查看t检验结果时，p值小于0.05的显著性水平，因此我们拒绝零假设。这意味着真实人口平均数大于3500。实际人口平均值为3932.8。</p><h2 id="aa3a" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">双样本T检验</h2><p id="3db0" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated">它检验两个样本的总体均值是否等于(大于或小于)特定值。</p><p id="6ff5" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">假设:</strong></p><ul class=""><li id="1bb2" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">样本应该是相互独立的</li><li id="6374" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">样本的正态性</li><li id="853d" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">“样本方差”应该相等(同质)</li></ul><p id="8528" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">测试理想切工和高级切工的钻石价格是否相等。</strong></p><p id="d131" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">首先我们用shapiro-wilk正态性检验和qq图来检验正态性。</strong></p><p id="cbd0" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">首先，让我们使用“过滤”命令从数据中过滤理想切割和高级切割钻石。</p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="7892" class="lg ke hh ms b fi mw mx l my mz"><em class="nh">#select ideal and premium cuts from data</em><br/>library(dplyr)<br/>diamonds_cut&lt;- diamonds %&gt;% filter(cut=="Ideal" | cut=="Premium")</span><span id="3f9a" class="lg ke hh ms b fi nu mx l my mz">ggqqplot(diamonds$price[diamonds$cut=="Ideal"])<br/>ggqqplot(diamonds$price[diamonds$cut=="Premium"])</span></pre><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nv"><img src="../Images/d0a51b7966ea9a5e1753565ed20f81ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H5HrwuIR7q7RjGY7kYuzEg.png"/></div></div><figcaption class="nb nc et er es nd ne bd b be z dx translated">图4。两个样本的QQPlot</figcaption></figure><p id="617b" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">从理想切点和溢价切点的价格QQ图可以看出，两个样本的上下尾部都有很大的偏差，所以两个样本都不是正态分布。为了确保万无一失，让我们使用一个适当的正态性检验。</p><blockquote class="nl nm nn"><p id="d586" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho:样本呈正态分布。</p><p id="a20e" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">H1:样本不是正态分布的。</p></blockquote><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="8230" class="lg ke hh ms b fi mw mx l my mz">jarque.bera.test(diamonds$price[diamonds$cut=="Ideal"])<br/>## <br/>##  Jarque Bera Test<br/>## <br/>## data:  diamonds$price[diamonds$cut=="Ideal"]<br/>## X-squared = 22169, df = 2, p-value &lt; 2.2e-16<br/></span><span id="3540" class="lg ke hh ms b fi nu mx l my mz">jarque.bera.test(diamonds$price[diamonds$cut=="Premium"])<br/>## <br/>##  Jarque Bera Test<br/>## <br/>## data:  diamonds$price[diamonds$cut=="Premium"]<br/>## X-squared = 21398, df = 2, p-value &lt; 2.2e-16</span></pre><ul class=""><li id="2d7f" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">正如所见，两个样本不是正态分布的。</li></ul><h2 id="30ff" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">方差的同质性</h2><p id="3722" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated">文献中使用了两种检验来检验方差的同质性。这些是<strong class="iy hi">巴特利特测试</strong>和<strong class="iy hi">勒文测试</strong>。这两种测试之间差异将在后面说明。</p><p id="bc3e" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">让我们在这个例子中使用Bartlett测试。</p><blockquote class="nl nm nn"><p id="3b9d" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho:样本方差相等</p><p id="fca1" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">H1:样本方差不相等</p></blockquote><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="5a3c" class="lg ke hh ms b fi mw mx l my mz">bartlett.test(price ~ cut, data = diamonds_cut)<br/>## <br/>##  Bartlett test of homogeneity of variances<br/>## <br/>## data:  price by cut<br/>## Bartlett's K-squared = 301.5, df = 1, p-value &lt; 2.2e-16</span></pre><ul class=""><li id="5245" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">可以看出，两个样本的方差不相等(p值=0)。t检验不满足正态性和方差齐性假设，但让我们看看如何在R中进行t检验。</li></ul><p id="a797" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">假设:</strong></p><blockquote class="nl nm nn"><p id="898e" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho: μ(理想切割)=μ(溢价切割)</p><p id="cc74" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">H1: μ(理想切工)<strong class="iy hi"> ≠ </strong> μ(优质切工)</p></blockquote><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="997e" class="lg ke hh ms b fi mw mx l my mz">t.test(diamonds_cut$price ~ diamonds_cut$cut, alternative = "two.sided",conf.level = 0.95, var.equal = F)<br/>## <br/>##  Welch Two Sample t-test<br/>## <br/>## data:  diamonds_cut$price by diamonds_cut$cut<br/>## t = 24.918, df = 26552, p-value &lt; 2.2e-16<br/>## alternative hypothesis: true difference in means is not equal to 0<br/>## 95 percent confidence interval:<br/>##  1038.088 1215.344<br/>## sample estimates:<br/>## mean in group Premium   mean in group Ideal <br/>##              4584.258              3457.542</span></pre><p id="fb59" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">如果两个样本的方差相等，写出<strong class="iy hi"><em class="nh">“var . equal = T”。</em>T15】</strong></p><ul class=""><li id="5c9a" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">两个总体平均值不相等(p值=0)。超值组均价4584258，理想组均价3457542。</li></ul><h2 id="3e3c" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">相关样本的T检验(成对样本T检验)</h2><p id="a271" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated">配对样本t检验用于比较两组相关样本的平均值。</p><ul class=""><li id="1d6d" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">作为数据的例子，20名患者在6个月期间接受了糖尿病治疗。我们想知道糖尿病的治疗是否对患者的胰岛素水平有影响。</li></ul><p id="d796" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">为了回答这个问题，在治疗前后测量了20名患者的胰岛素水平。通过测量相同个体两倍的胰岛素水平，我们得到了治疗前的20组值和治疗后的20组值。</p><p id="fa55" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">在这种情况下，配对t检验可用于比较治疗前后的平均胰岛素水平。</p><p id="a232" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">成对t检验分析如下进行:</p><ol class=""><li id="9afc" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt nw mf mg mh bi translated">计算每对数值之间的差值(d)</li><li id="dcad" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt nw mf mg mh bi translated">计算d的平均值(m)和标准偏差(s)</li><li id="ff8f" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt nw mf mg mh bi translated">将平均差值与0进行比较。如果两对样本之间存在任何显著差异，则d (m)的均值预计将远离0。</li></ol><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="3f86" class="lg ke hh ms b fi mw mx l my mz"><em class="nh"># Insulin level of the patients before treatment</em><br/>before &lt;-c(200.1, 190.9, 192.7, 213, 241.4, 196.9, 172.2, 185.5, 205.2, 193.7)</span><span id="c85c" class="lg ke hh ms b fi nu mx l my mz"><em class="nh"># Insulin level of the patients before treatment</em><br/>after &lt;-c(392.9, 393.2, 345.1, 393, 434, 427.9, 422, 383.9, 392.3, 352.2)</span><span id="8f37" class="lg ke hh ms b fi nu mx l my mz"><em class="nh"># Create a data frame</em><br/>my_data &lt;- data.frame(group = rep(c("before", "after"), each = 10),<br/>                insulin = c(before,  after))</span><span id="80bb" class="lg ke hh ms b fi nu mx l my mz">head(my_data)<br/>##    group weight<br/>## 1 before  200.1<br/>## 2 before  190.9<br/>## 3 before  192.7<br/>## 4 before  213.0<br/>## 5 before  241.4<br/>## 6 before  196.9</span><span id="a1ae" class="lg ke hh ms b fi nu mx l my mz"><em class="nh"># Plot weight by group and color by group</em><br/>library("ggpubr")<br/>ggboxplot(my_data, x = "group", y = "insulin", <br/>          color = "group", palette = c("#00AFBB", "#E7B800"),<br/>          order = c("before", "after"),<br/>          ylab = "insulin", xlab = "Groups")</span></pre><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nx"><img src="../Images/22662869f93b85a0ab05c577ee3cf4ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7GSqy_BXYdJhz_2Ny3vEvA.png"/></div></div><figcaption class="nb nc et er es nd ne bd b be z dx translated">图5。治疗前后的箱线图</figcaption></figure><p id="4ecc" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">配对样本t检验的假设</strong></p><ul class=""><li id="ca27" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">样本应该是相关的</li><li id="90bc" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">样本量应该很大</li><li id="cebf" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">样本应呈正态分布。</li></ul><p id="62c3" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">在我们的案例中:</p><ol class=""><li id="06a2" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt nw mf mg mh bi translated">样本是相关的，因为数据是通过测量同一个人的两倍胰岛素水平收集的。</li><li id="8d07" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt nw mf mg mh bi translated">样本量小，因为n&lt; 30. Since the sample size is not large enough (less than 30), we need to check whether the differences of the pairs follow a normal distribution.</li></ol><p id="0f8f" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">That means we should look for normality distance(d) when sample is smaller than 30. (distance means difference between before and after)</p><p id="729d" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">Let print distance.</p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="22b6" class="lg ke hh ms b fi mw mx l my mz"><em class="nh"># compute the difference</em><br/>d &lt;-  my_data$insulin[my_data$group == "before"] - my_data$insulin[my_data$group == "after"]</span><span id="3055" class="lg ke hh ms b fi nu mx l my mz">print(d)</span><span id="8b55" class="lg ke hh ms b fi nu mx l my mz">## [1] -192.8 -202.3 -152.4 -180.0 -192.6 -231.0 -249.8 -198.4 -187.1 -158.5</span></pre><blockquote class="nl nm nn"><p id="efab" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho: Distance is normally distributed</p><p id="f8e2" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">H1: Distance is not normally distributed</p></blockquote><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="164a" class="lg ke hh ms b fi mw mx l my mz">shapiro.test(d)</span><span id="addf" class="lg ke hh ms b fi nu mx l my mz">## <br/>##  Shapiro-Wilk normality test<br/>## <br/>## data:  d<br/>## W = 0.94536, p-value = 0.6141</span></pre><ul class=""><li id="70ca" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">Since p-value is bigger than the significance level of 0.05, so distance is normally distributed.</li></ul><blockquote class="nl nm nn"><p id="dadb" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho: μ(after treatment)=μ(before treatment)</p><p id="2182" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">H1: μ(after treatment)<strong class="iy hi">≦</strong>μ(处理前)</p></blockquote><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="0a74" class="lg ke hh ms b fi mw mx l my mz"><em class="nh"># Compute t-test<br/># we write paired=T</em></span><span id="4013" class="lg ke hh ms b fi nu mx l my mz">t.test(insulin ~ group, data = my_data, paired = TRUE)</span><span id="9e40" class="lg ke hh ms b fi nu mx l my mz">## <br/>##  Paired t-test<br/>## <br/>## data:  weight by group<br/>## t = 20.883, df = 9, p-value = 6.2e-09<br/>## alternative hypothesis: true difference in means is not equal to 0<br/>## 95 percent confidence interval:<br/>##  173.4219 215.5581<br/>## sample estimates:<br/>## mean of the differences <br/>##                  194.49</span></pre><p id="da2f" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">正如所见，p值小于0.05的显著性水平，因此我们拒绝零假设。这意味着患者治疗前和治疗后的胰岛素水平不相等。因此，治疗是有用的。</p><h2 id="fbed" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">单向方差分析</h2><p id="e639" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated">单向方差分析(ANOVA)是独立双样本t检验的扩展，用于在有两个以上组的情况下比较平均值。在单因素方差分析中，根据一个分组变量(也称为因素变量)将数据组织成几组。</p><p id="ebeb" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">假设:</p><ul class=""><li id="ca05" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">这些观察值是从因子水平定义的总体中独立随机地获得的<strong class="iy hi"/></li><li id="6489" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">各因子水平的数据呈<strong class="iy hi">正态分布。</strong></li><li id="a3ab" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">这些正态总体有一个共同的方差。(可以用Levene氏试验或bartlett试验对此进行检查。)</li></ul><p id="19c5" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">测试所有切割组价格的平均值之间是否存在显著差异。记住有5个切割组，所以我们比较2个以上的平均值。这就是为什么我们使用单向方差分析。</strong></p><blockquote class="nl nm nn"><p id="64bd" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho: μ1=μ2=μ3=μ4=μ5</p><p id="a911" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">H1:至少有一个是不同的</p></blockquote><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="2f1d" class="lg ke hh ms b fi mw mx l my mz">library(ggplot2)<br/>ggplot(diamonds, aes(x=price, y=cut, fill=cut)) + geom_boxplot(outlier.colour="red", outlier.shape=18,<br/>             outlier.size=3, notch=F)+labs(title = "Boxplot of price by cut") + scale_fill_brewer(palette = "BuPu")</span></pre><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nf"><img src="../Images/5971eb9ca48da88025ed36323f518b55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Oq2Gh6NWVp6PkYroweIQ-A.png"/></div></div><figcaption class="nb nc et er es nd ne bd b be z dx translated">图6。按切割价格的箱线图</figcaption></figure><p id="ebb7" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">R函数aov()用于应用ANOVA。summary.aov()函数用于汇总方差分析模型。</p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="c04b" class="lg ke hh ms b fi mw mx l my mz">anova&lt;-aov(price ~ cut, data = diamonds)<br/>summary(anova)<br/>##                Df    Sum Sq   Mean Sq F value Pr(&gt;F)    <br/>## cut             4 1.104e+10 2.760e+09   175.7 &lt;2e-16 ***<br/>## Residuals   53935 8.474e+11 1.571e+07                   <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre><p id="a0de" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">由于p值小于显著性水平0.05，我们可以得出结论，在模型总结中用“*”突出显示的各组之间存在显著差异。</p><p id="dd46" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">多组两两比较——各组平均值之间的比较</strong></p><p id="11d2" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">在单因素方差分析检验中，显著的p值表明某些组均值不同，但我们不知道哪些组对不同。</p><p id="d201" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">可以进行多次成对比较，以确定特定组对之间的平均差异是否具有统计显著性。</p><p id="d459" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi"> Tukey多重成对比较</strong></p><p id="15ed" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">由于ANOVA检验非常重要，我们可以计算Tukey HSD (Tukey诚实显著差异，R函数:Tukey HSD())来执行组均值之间的多重成对比较。(如果方差分析检验不显著，则无需进行成对比较)</p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="e7a1" class="lg ke hh ms b fi mw mx l my mz">TukeyHSD(anova)<br/>##   Tukey multiple comparisons of means<br/>##     95% family-wise confidence level<br/>## <br/>## Fit: aov(formula = price ~ cut, data = diamonds)<br/>## <br/>## $cut<br/>##                          diff         lwr        upr     p adj<br/>## Good-Fair          -429.89331  -740.44880  -119.3378 0.0014980<br/>## Very Good-Fair     -376.99787  -663.86215   -90.1336 0.0031094<br/>## Premium-Fair        225.49994   -59.26664   510.2665 0.1950425<br/>## Ideal-Fair         -901.21579 -1180.57139  -621.8602 0.0000000<br/>## Very Good-Good       52.89544  -130.15186   235.9427 0.9341158<br/>## Premium-Good        655.39325   475.65120   835.1353 0.0000000<br/>## Ideal-Good         -471.32248  -642.36268  -300.2823 0.0000000<br/>## Premium-Very Good   602.49781   467.76249   737.2331 0.0000000<br/>## Ideal-Very Good    -524.21792  -647.10467  -401.3312 0.0000000<br/>## Ideal-Premium     -1126.71573 -1244.62267 -1008.8088 0.0000000</span></pre><ul class=""><li id="5a0c" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated"><em class="nh"> diff:两组平均值之间的差异</em></li><li id="b755" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated"><em class="nh"> lwr，UPR:95%置信区间的下限和上限(默认)</em></li><li id="c7e6" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated"><em class="nh"> p adj:多次比较调整后的p值</em>。</li></ul><p id="7053" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">我们可以说，p值低于0.05的组的均值显著不同。</p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="b5c4" class="lg ke hh ms b fi mw mx l my mz"><em class="nh">#we can use also this function to performn pairwise comparison</em><br/>pairwise.t.test(diamonds$price, diamonds$cut,<br/>                 p.adjust.method = "BH")</span><span id="ab68" class="lg ke hh ms b fi nu mx l my mz">## <br/>##  Pairwise comparisons using t tests with pooled SD <br/>## <br/>## data:  diamonds$price and diamonds$cut <br/>## <br/>##           Fair    Good    Very Good Premium<br/>## Good      0.00023 -       -         -      <br/>## Very Good 0.00042 0.43055 -         -      <br/>## Premium   0.03419 &lt; 2e-16 &lt; 2e-16   -      <br/>## Ideal     &lt; 2e-16 9.5e-14 &lt; 2e-16   &lt; 2e-16<br/>## <br/>## P value adjustment method: BH</span></pre><p id="98ea" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">检查检验有效性的ANOVA假设</strong></p><p id="c338" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">ANOVA检验假设数据是正态分布的，组间方差是齐次的。我们可以用一些诊断图来验证。</p><h2 id="1e66" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">方差的同质性</h2><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="163a" class="lg ke hh ms b fi mw mx l my mz"><em class="nh"># 1. Homogeneity of variances</em><br/>plot(anova, 1)</span></pre><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ny"><img src="../Images/7d54ca6043fefd2af66fa92bd0c1af62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zmQcsJOnO6bKpqeB0NIEAg.png"/></div></div><figcaption class="nb nc et er es nd ne bd b be z dx translated">图7。残差与拟合值</figcaption></figure><ul class=""><li id="0b96" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">对于等方差，图中的点应该在零线周围，但在我们的情况下，等方差假设似乎被打破了。让我们用测试来检查这个结果。我们使用Bartlett检验来检验t检验中方差的同质性，这次让我们使用Levene检验。</li></ul><p id="73e8" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi"> Levene的检验对正态分布的偏差不太敏感。换句话说，在没有提供正态性的情况下，使用Levenes检验比Bartlett检验更准确。</strong></p><blockquote class="nl nm nn"><p id="93eb" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho:各组之间的方差是相等的。</p><p id="4305" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">H1:各组之间的差异在统计学上有显著差异。</p></blockquote><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="5e04" class="lg ke hh ms b fi mw mx l my mz">library(car)<br/>leveneTest(price ~ cut, data = diamonds)</span><span id="f99a" class="lg ke hh ms b fi nu mx l my mz">## Levene's Test for Homogeneity of Variance (center = median)<br/>##          Df F value    Pr(&gt;F)    <br/>## group     4   123.6 &lt; 2.2e-16 ***<br/>##       53935                      <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span><span id="12f7" class="lg ke hh ms b fi nu mx l my mz">bartlett.test(price ~ cut, data = diamonds)<br/>## <br/>##  Bartlett test of homogeneity of variances<br/>## <br/>## data:  price by cut<br/>## Bartlett's K-squared = 406.7, df = 4, p-value &lt; 2.2e-16</span></pre><p id="4cb5" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">从上面的输出中，我们可以看到p值小于0.05的显著性水平。这意味着有证据表明不同组之间的差异显著不同。我们在巴特利特测试中得出了同样的结果。</p><p id="c4b6" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">无等方差假设的ANOVA检验</strong></p><p id="dcdd" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">一种替代过程(Welch单向测试)，它不要求在函数oneway.test()中实现假设。</p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="4e4a" class="lg ke hh ms b fi mw mx l my mz">oneway.test(price ~ cut, data = diamonds)<br/>## <br/>##  One-way analysis of means (not assuming equal variances)<br/>## <br/>## data:  price and cut<br/>## F = 166.04, num df = 4.0, denom df = 9398.6, p-value &lt; 2.2e-16</span><span id="06b8" class="lg ke hh ms b fi nu mx l my mz">pairwise.t.test(diamonds$price, diamonds$cut,<br/>                 p.adjust.method = "BH", pool.sd = FALSE)<br/>## <br/>##  Pairwise comparisons using t tests with non-pooled SD <br/>## <br/>## data:  diamonds$price and diamonds$cut <br/>## <br/>##           Fair    Good    Very Good Premium<br/>## Good      4.5e-05 -       -         -      <br/>## Very Good 0.00011 0.40560 -         -      <br/>## Premium   0.02122 &lt; 2e-16 &lt; 2e-16   -      <br/>## Ideal     &lt; 2e-16 1.7e-15 &lt; 2e-16   &lt; 2e-16<br/>## <br/>## P value adjustment method: BH</span></pre><h2 id="7e0e" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">常态</h2><ul class=""><li id="76b9" class="lz ma hh iy b iz lu jd lv jh mb jl mc jp md jt me mf mg mh bi translated">残差的正态图。在下图中，残差的分位数是相对于正态分布的分位数绘制的。还绘制了45度参考线。</li><li id="05f9" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">残差的正态概率图用于检查残差呈正态分布的假设。它应该大致沿着一条直线。</li></ul><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="5c59" class="lg ke hh ms b fi mw mx l my mz">plot(anova,2)</span></pre><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nz"><img src="../Images/31ca41ce527fe74e9c1c2b8a5de0f547.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vVAad4ohu8yfOT1FhmNolQ.png"/></div></div><figcaption class="nb nc et er es nd ne bd b be z dx translated">图8。残差的正态Q-Q图</figcaption></figure><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="5f43" class="lg ke hh ms b fi mw mx l my mz">aov_residuals &lt;- residuals(object = anova )<br/>jarque.bera.test(x = aov_residuals )<br/>## <br/>##  Jarque Bera Test<br/>## <br/>## data:  aov_residuals<br/>## X-squared = 34438, df = 2, p-value &lt; 2.2e-16</span></pre><ul class=""><li id="ff84" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">也不满足正态假设。在这种情况下，我们应该使用单向anova的非参数版本，即<em class="nh">“Kruskal-Wallis秩和检验”</em>。(在非参数测试部分提到)</li></ul><h2 id="7c07" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">双向方差分析</h2><p id="33c5" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated">双向ANOVA检验用于同时评估两个分组变量(A和B)对一个响应变量的影响。分组变量也称为因子。因子的不同类别(组)称为级别。因子之间的级别数可以不同。</p><ul class=""><li id="f82d" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">当细胞内的样本量相等时，我们有所谓的平衡设计。在这种情况下，可以应用标准的双向ANOVA检验。</li><li id="286d" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">当自变量各水平内的样本量不同时(不平衡设计的情况)，方差分析检验应区别对待。</li></ul><figure class="mn mo mp mq fd ii er es paragraph-image"><div class="er es oa"><img src="../Images/54d9b38a3ea04f963017e795c6d23052.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*C7ZvKUH5ZFm9QHDqy0OrRA.png"/></div><figcaption class="nb nc et er es nd ne bd b be z dx translated">图9。双向方差分析的表示</figcaption></figure><p id="cb17" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">双向方差分析检验的假设</strong></p><p id="8a3d" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">像所有方差分析检验一样，双向方差分析假设每个单元格内的观察值是正态分布的，并且具有相等的方差。</p><p id="87ed" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">双向方差分析检验假设</strong></p><p id="47a6" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">Ho:因子A的均值没有差异，因子B的均值没有差异，因子A和因子B之间没有交互作用</p><p id="347c" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">例如，我们根据钻石的颜色和切工对其价格进行分组，我们测试了以下两种情况:</p><ul class=""><li id="5d07" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">如果切割组的方法不同</li><li id="a021" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">如果颜色组的平均值存在差异</li></ul><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="7eb2" class="lg ke hh ms b fi mw mx l my mz">ggplot(diamonds, aes(x=price, y=cut, fill=color)) + geom_boxplot(outlier.colour="red", outlier.shape=18,<br/>             outlier.size=0.3, notch=F)+labs(title = "Boxplot of price by cut and color") + scale_fill_brewer(palette = "BuPu")</span></pre><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ob"><img src="../Images/a5a5177a4b19b84e9ce45892f591df82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GPKN9T4-LunOS1J4AiyD_g.png"/></div></div><figcaption class="nb nc et er es nd ne bd b be z dx translated">图10。按切割和颜色定价</figcaption></figure><p id="1757" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">我们想知道价格是否取决于切割和颜色。</p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="4462" class="lg ke hh ms b fi mw mx l my mz">res.aov2 &lt;- aov(price ~ cut +color , data =diamonds)<br/>summary(res.aov2)<br/>##                Df    Sum Sq   Mean Sq F value Pr(&gt;F)    <br/>## cut             4 1.104e+10 2.760e+09   181.1 &lt;2e-16 ***<br/>## color           6 2.551e+10 4.251e+09   278.9 &lt;2e-16 ***<br/>## Residuals   53929 8.219e+11 1.524e+07                   <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre><p id="655d" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">从方差分析表中，我们可以得出结论，切工和颜色都具有统计学意义。让我们在模型中包括切割和颜色之间的相互作用。</p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="e88f" class="lg ke hh ms b fi mw mx l my mz"><em class="nh"># Two-way ANOVA with interaction effect</em><br/>res.aov3 &lt;- aov(price ~ cut*color , data =diamonds)<br/>summary(res.aov3)<br/>##                Df    Sum Sq   Mean Sq F value Pr(&gt;F)    <br/>## cut             4 1.104e+10 2.760e+09 181.405 &lt;2e-16 ***<br/>## color           6 2.551e+10 4.251e+09 279.371 &lt;2e-16 ***<br/>## cut:color      24 1.653e+09 6.889e+07   4.527  1e-12 ***<br/>## Residuals   53905 8.203e+11 1.522e+07                   <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre><p id="c6e4" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">根据方差分析结果，基于p值和0.05的显著性水平，您可以得出以下结论:</p><ul class=""><li id="a257" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">cut的p值为~0(显著)，表明cut的水平与显著不同的价格相关。</li><li id="8a30" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">颜色的p值是&lt; 2e-16 (significant), which indicates that colors are associated with significant different price.</li><li id="236a" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">the p-value for the interaction between cut*color is ~0 (significant), which indicates that the relationships between color and price depends on the cut.</li></ul><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="ea6b" class="lg ke hh ms b fi mw mx l my mz"><em class="nh">#multiple comparison like in the ANOVA<br/></em>TukeyHSD(res.aov2)<br/>##   Tukey multiple comparisons of means<br/>##     95% family-wise confidence level<br/>## <br/>## Fit: aov(formula = price ~ cut + color, data = diamonds)<br/>## <br/>## $cut<br/>##                          diff         lwr         upr     p adj<br/>## Good-Fair          -429.89331  -735.75636  -124.03026 0.0011913<br/>## Very Good-Fair     -376.99787  -659.52768   -94.46806 0.0025302<br/>## Premium-Fair        225.49994   -54.96387   505.96375 0.1821643<br/>## Ideal-Fair         -901.21579 -1176.35038  -626.08121 0.0000000<br/>## Very Good-Good       52.89544  -127.38604   233.17692 0.9305749<br/>## Premium-Good        655.39325   478.36707   832.41943 0.0000000<br/>## Ideal-Good         -471.32248  -639.77829  -302.86667 0.0000000<br/>## Premium-Very Good   602.49781   469.79831   735.19731 0.0000000<br/>## Ideal-Very Good    -524.21792  -645.24787  -403.18797 0.0000000<br/>## Ideal-Premium     -1126.71573 -1242.84112 -1010.59035 0.0000000<br/>## <br/>## $color<br/>##          diff        lwr        upr     p adj<br/>## E-D -104.4894 -286.36133   77.38248 0.6201928<br/>## F-D  537.8278  354.96509  720.69052 0.0000000<br/>## G-D  820.6730  643.79152  997.55443 0.0000000<br/>## H-D 1260.0195 1071.58200 1448.45698 0.0000000<br/>## I-D 1885.6973 1675.96202 2095.43256 0.0000000<br/>## J-D 2064.7478 1806.41658 2323.07904 0.0000000<br/>## F-E  642.3172  476.76688  807.86758 0.0000000<br/>## G-E  925.1624  766.24356 1084.08123 0.0000000<br/>## H-E 1364.5089 1192.82072 1536.19711 0.0000000<br/>## I-E 1990.1867 1795.36107 2185.01235 0.0000000<br/>## J-E 2169.2372 1922.85710 2415.61737 0.0000000<br/>## G-F  282.8452  122.79337  442.89696 0.0000039<br/>## H-F  722.1917  549.45426  894.92911 0.0000000<br/>## I-F 1347.8695 1152.11859 1543.62038 0.0000000<br/>## J-F 1526.9200 1279.80758 1774.03243 0.0000000<br/>## H-G  439.3465  272.95393  605.73911 0.0000000<br/>## I-G 1065.0243  874.84890 1255.19973 0.0000000<br/>## J-G 1244.0748 1001.35519 1486.79449 0.0000000<br/>## I-H  625.6778  424.70932  826.64627 0.0000000<br/>## J-H  804.7283  553.46259 1055.99405 0.0000000<br/>## J-I  179.0505  -88.55864  446.65968 0.4322041</span></pre><p id="4fe8" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">检验ANOVA假设:检验有效性</strong></p><p id="6277" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">方差分析假设数据是正态分布的，组间方差是齐次的。我们可以用一些诊断图来验证。</p><p id="1422" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">检查方差假设的同质性</strong></p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="f4ec" class="lg ke hh ms b fi mw mx l my mz"><em class="nh"># 1. Homogeneity of variances</em><br/>plot(res.aov3, 1)</span></pre><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es oc"><img src="../Images/507f4a99c82c20107fd98b3644c9737c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4kogpheHJWrpXpzschna5A.png"/></div></div><figcaption class="nb nc et er es nd ne bd b be z dx translated">图11。残差与拟合值</figcaption></figure><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="0b0c" class="lg ke hh ms b fi mw mx l my mz">library(car)<br/>leveneTest(price ~ cut*color , data =diamonds)<br/>## Levene's Test for Homogeneity of Variance (center = median)<br/>##          Df F value    Pr(&gt;F)    <br/>## group    34  50.915 &lt; 2.2e-16 ***<br/>##       53905                      <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre><ul class=""><li id="8bb3" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">因为levene检验的p值小于0.05的显著性水平，所以拒绝零假设。因此，方差是不相等的。</li></ul><p id="f74f" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">常态</strong></p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="e040" class="lg ke hh ms b fi mw mx l my mz"><em class="nh"># 2. Normality</em><br/>plot(res.aov3, 2)</span></pre><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es od"><img src="../Images/8b67d23a308c72cab33596de1f60383b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NcfB1UlMqMPm1FJn6xoG7w.png"/></div></div><figcaption class="nb nc et er es nd ne bd b be z dx translated">图12。正常Q-Q图</figcaption></figure><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="fd4c" class="lg ke hh ms b fi mw mx l my mz"><em class="nh"># Extract the residuals</em><br/>aov_residuals &lt;- residuals(object = res.aov3)<br/><em class="nh"># Run Shapiro-Wilk test</em><br/>jarque.bera.test(x = aov_residuals )</span><span id="2f7d" class="lg ke hh ms b fi nu mx l my mz">## <br/>##  Jarque Bera Test<br/>## <br/>## data:  aov_residuals<br/>## X-squared = 33271, df = 2, p-value &lt; 2.2e-16</span></pre><ul class=""><li id="904f" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">上述结论得到了对ANOVA残差(X平方= 33271，p= 2.2e-16)的jarque.bera检验的支持，该检验发现了违反正态性的迹象。</li></ul><p id="2418" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">在R中计算不平衡设计的双向ANOVA检验</strong></p><p id="aa4f" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">不平衡设计包括每组受试者数量不等。当我们将双向方差分析中使用的2个因素(切割和颜色)分组时，让我们看看每个单元格中有多少个观察值。</p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="03ab" class="lg ke hh ms b fi mw mx l my mz">table(diamonds$cut,diamonds$color)</span><span id="b143" class="lg ke hh ms b fi nu mx l my mz">##            <br/>##                D    E    F    G    H    I    J<br/>##   Fair       163  224  312  314  303  175  119<br/>##   Good       662  933  909  871  702  522  307<br/>##   Very Good 1513 2400 2164 2299 1824 1204  678<br/>##   Premium   1603 2337 2331 2924 2360 1428  808<br/>##   Ideal     2834 3903 3826 4884 3115 2093  896</span></pre><ul class=""><li id="ccb6" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">正如在每个单元格中看到的，观察值的数量不相等。因此，我们有不平衡的设计。</li><li id="1e0b" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">要在双向ANOVA中设置不平衡设计，我们需要写<strong class="iy hi"> Anova(type = "III") </strong>。</li></ul><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="747b" class="lg ke hh ms b fi mw mx l my mz">library(car)<br/>my_anova &lt;- aov(price ~ cut*color , data =diamonds)<br/>Anova(my_anova, type = "III")</span><span id="2889" class="lg ke hh ms b fi nu mx l my mz">## Anova Table (Type III tests)<br/>## <br/>## Response: price<br/>##                 Sum Sq    Df    F value    Pr(&gt;F)    <br/>## (Intercept) 3.7606e+11     1 24713.0009 &lt; 2.2e-16 ***<br/>## cut         8.7891e+09     4   144.3969 &lt; 2.2e-16 ***<br/>## color       9.4602e+09     6   103.6142 &lt; 2.2e-16 ***<br/>## cut:color   1.6535e+09    24     4.5274 1.001e-12 ***<br/>## Residuals   8.2027e+11 53905                         <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre><h2 id="be02" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">马诺娃</h2><p id="233d" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated">在有多个响应变量的情况下，您可以使用多变量方差分析(MANOVA)同时测试它们。(我们有两个连续因变量和一个独立类别变量)</p><p id="a229" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">马诺娃的假设</strong></p><p id="69a3" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">MANOVA可在特定条件下使用:</p><ul class=""><li id="be58" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">因变量应在组内正常分布。R函数mshapiro . test()[在mvnormtest包中]可用于执行多元正态性的夏皮罗-维尔克检验。这在假设多元正态性的MANOVA的情况下是有用的。</li><li id="f6fe" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">预测值范围内方差的同质性。</li><li id="6e0e" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">每个单元格中所有因变量对、所有协变量对以及所有因变量-协变量对之间的线性</li></ul><p id="e566" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">假设:</strong></p><blockquote class="nl nm nn"><p id="6ab5" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho:治疗变量对两个连续变量没有显著影响</p></blockquote><p id="2ec9" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">我们想知道按切割分组时，价格和克拉是否有显著差异。</strong></p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="9740" class="lg ke hh ms b fi mw mx l my mz"><em class="nh"># MANOVA test</em><br/>res.man &lt;- manova(cbind(price, carat) ~ cut, data = diamonds)<br/>summary(res.man)</span><span id="670f" class="lg ke hh ms b fi nu mx l my mz">##              Df   Pillai approx F num Df den Df    Pr(&gt;F)    <br/>## cut           4 0.081688   574.18      8 107870 &lt; 2.2e-16 ***<br/>## Residuals 53935                                              <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre><ul class=""><li id="d9b9" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">我们看到p值小于0.05的显著性水平。这意味着，切工(处理)对钻石的价格和克拉有重大影响。</li></ul><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="9fe1" class="lg ke hh ms b fi mw mx l my mz"><em class="nh"># Look to see which differ</em><br/>summary.aov(res.man)</span><span id="a71a" class="lg ke hh ms b fi nu mx l my mz">##  Response price :<br/>##                Df     Sum Sq    Mean Sq F value    Pr(&gt;F)    <br/>## cut             4 1.1042e+10 2760436340  175.69 &lt; 2.2e-16 ***<br/>## Residuals   53935 8.4743e+11   15712087                      <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1<br/>## <br/>##  Response carat :<br/>##                Df  Sum Sq Mean Sq F value    Pr(&gt;F)    <br/>## cut             4   429.7 107.435  495.69 &lt; 2.2e-16 ***<br/>## Residuals   53935 11689.6   0.217                      <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span><span id="217a" class="lg ke hh ms b fi nu mx l my mz">## [1] 1996</span></pre><p id="f509" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">检查多元正态性:</strong></p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="986b" class="lg ke hh ms b fi mw mx l my mz">library(MVN)<br/>result &lt;- mvn(data = diamonds2[,c(1,7)], mvnTest = "royston")<br/>result$multivariateNormality</span><span id="c265" class="lg ke hh ms b fi nu mx l my mz">##      Test        H      p value MVN<br/>## 1 Royston 251.0394 6.571757e-56  NO</span><span id="9376" class="lg ke hh ms b fi nu mx l my mz"><em class="nh"># create univariate Q-Q plots</em><br/>result &lt;- mvn(data = diamonds2[,c(1,7)], mvnTest = "royston", univariatePlot = "qqplot")</span></pre><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es oe"><img src="../Images/7f6f0aea6b87ea56a82222c7247bd813.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VehaUtz_lRj_tpQwt9JLiw.png"/></div></div><figcaption class="nb nc et er es nd ne bd b be z dx translated">图13。多元正态Q-Q图</figcaption></figure><ul class=""><li id="c983" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">我们看到MVN=否，所以不满足多元正态性。</li></ul><h2 id="5c8e" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">拉丁方设计</h2><p id="a82e" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated">拉丁方设计用于研究人员希望控制与田间行和列相关的实验中的变化的情况。</p><p id="c011" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">假设:</strong></p><ul class=""><li id="c044" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">在行和列内随机分配处理，每行一次，每列一次。</li><li id="5266" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">行数、列数和处理数相等。</li><li id="ccb5" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">这在实验者希望控制两个不同方向的变化时是有用的</li></ul><p id="b228" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">用于这种三向方差分析的公式是:</p><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es of"><img src="../Images/7e83dd6397400a07547dbeab016f6148.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H9asqeh0TGhBZf3Qu_2SfA.png"/></div></div></figure><p id="46bc" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">例如:</p><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es og"><img src="../Images/740a611640bbd69e159adfa015dc1b28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mxrthfVp7yLrrD7b9Ekfqw.png"/></div></div></figure><ul class=""><li id="212c" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">我们有3个分类变量(行效应、列效应和处理效应)和1个连续变量(目标)。</li></ul><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="d456" class="lg ke hh ms b fi mw mx l my mz"><em class="nh">#create new dataset</em></span><span id="1c76" class="lg ke hh ms b fi nu mx l my mz">fertil &lt;- c(rep("fertil1",1), rep("fertil2",1), rep("fertil3",1), rep("fertil4",1), rep("fertil5",1))<br/>treat &lt;- c(rep("treatA",5), rep("treatB",5), rep("treatC",5), rep("treatD",5), rep("treatE",5))<br/>seed &lt;- c("A","E","C","B","D", "C","B","A","D","E", "B","C","D","E","A", "D","A","E","C","B", "E","D","B","A","C")<br/>freq &lt;- c(42,45,41,56,47, 47,54,46,52,49, 55,52,57,49,45, 51,44,47,50,54, 44,50,48,43,46)<br/> <br/>mydata &lt;- data.frame(treat, fertil, seed, freq)</span><span id="c347" class="lg ke hh ms b fi nu mx l my mz">kbl(head(mydata), caption="Dataset", booktabs = T) %&gt;% kable_styling(latex_options = c("striped", "hold_position","scale_down"),font_size=12, stripe_index = c(1,3,5,7))</span></pre><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es oh"><img src="../Images/1e4573d79e4d694e7f8987c4f155504f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hASqbTfQj1up9OPyatDA5Q.png"/></div></div></figure><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="d885" class="lg ke hh ms b fi mw mx l my mz"><em class="nh">#visualize data</em><br/>mydata %&gt;% <br/>  ggplot(aes(x= freq, y=treat, fill=fertil)) +<br/>  geom_boxplot() +<br/>  geom_jitter(width=0.1,alpha=0.2) +<br/>  xlab("freq")+ <br/>  facet_wrap(~seed) +<br/>  theme(axis.text.x = element_text(angle = 45, hjust = 1))</span></pre><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es oi"><img src="../Images/6a21e7d1f957118755514129786a140d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OE22ewGqFvSW7GIlZpbDiw.png"/></div></div><figcaption class="nb nc et er es nd ne bd b be z dx translated">图14。肥料数据箱线图</figcaption></figure><h2 id="d8c9" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated"><strong class="ak">假设:</strong></h2><blockquote class="nl nm nn"><p id="d081" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho: Row对响应没有影响</p><p id="b318" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho:列对响应没有影响</p><p id="31bb" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho:治疗对反应无影响</p></blockquote><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="d4e9" class="lg ke hh ms b fi mw mx l my mz">myfit &lt;- lm(freq ~ fertil+treat+seed, mydata)<br/>anova(myfit)</span><span id="bd1e" class="lg ke hh ms b fi nu mx l my mz">## Analysis of Variance Table<br/>## <br/>## Response: freq<br/>##           Df Sum Sq Mean Sq F value   Pr(&gt;F)    <br/>## fertil     4  17.76   4.440  0.7967 0.549839    <br/>## treat      4 109.36  27.340  4.9055 0.014105 *  <br/>## seed       4 286.16  71.540 12.8361 0.000271 ***<br/>## Residuals 12  66.88   5.573                     <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre><ul class=""><li id="ab45" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">考虑肥料的组间差异不显著(p值&gt; 0.1)。</li><li id="ee3f" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">考虑耕作的组间差异相当显著(p值&lt; 0.05).</li><li id="d45e" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">The difference between group considering the seed is very significant (p-value &lt; 0.001).</li></ul><h1 id="fbb8" class="kd ke hh bd kf kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la bi translated"><strong class="ak">R中的非参数检验</strong></h1><p id="dbdd" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated">当假设参数t检验时，使用非参数版本的检验。<strong class="iy hi">非参数检验中常见的假设是随机性和独立性。</strong>卡方检验是一种非参数检验，用于检验三种统计检验:拟合优度、独立性和同质性。在非参数分析中，Mann-Whitney U检验用于比较一个变量的两组病例。Kruskal-Wallis检验被视为参数单向方差分析(ANOVA)的替代检验，用于比较一个变量的两个以上的组。Wilcoxon符号秩检验是参数“成对样本T检验”的替代检验，用于检验两个相关/相依随机样本之间均值的统计差异。</p><h2 id="f82f" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">符号检验</h2><p id="6ffe" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated">符号检验用于检验样本的中值是否等于特定值。请记住，对于钻石数据集，不满足正态性假设，因此让我们使用非参数版本应用相同的测试。</p><p id="8a04" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">让我们用符号测试来测试钻石价格的中位数是否等于3900。</p><blockquote class="nl nm nn"><p id="2a34" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho:中位数=3900</p><p id="6323" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">H1:中位数≠3900</p></blockquote><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="2d4e" class="lg ke hh ms b fi mw mx l my mz">library(BSDA)<br/>SIGN.test(diamonds$price, md = 3500)</span><span id="2d27" class="lg ke hh ms b fi nu mx l my mz">## <br/>##  One-sample Sign-Test<br/>## <br/>## data:  diamonds$price<br/>## s = 21440, p-value &lt; 2.2e-16<br/>## alternative hypothesis: true median is not equal to 3500<br/>## 95 percent confidence interval:<br/>##  2376 2441<br/>## sample estimates:<br/>## median of x <br/>##        2401 <br/>## <br/>## Achieved and Interpolated Confidence Intervals: <br/>## <br/>##                   Conf.Level L.E.pt U.E.pt<br/>## Lower Achieved CI     0.9499   2376   2441<br/>## Interpolated CI       0.9500   2376   2441<br/>## Upper Achieved CI     0.9509   2376   2441</span></pre><ul class=""><li id="cd81" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">正如所见，钻石价格的中位数不是3500，而是2400。</li></ul><h2 id="f79e" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">Wilcoxon秩和检验</h2><p id="5928" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated">“Wilcoxon秩和检验”(也称为“Mann-Whitney检验”)是t检验(不假设正态性)的一种无分布替代方法，用于检验两组中的分布具有相同中位数的假设。</p><blockquote class="nl nm nn"><p id="7420" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho: Median1=Median2</p><p id="0dc1" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">H1:媒体1≠媒体2</p></blockquote><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="8658" class="lg ke hh ms b fi mw mx l my mz"><em class="nh"># independent 2-group Mann-Whitney U Test</em><br/>wilcox.test(diamonds_cut$price~diamonds_cut$cut)</span><span id="e16e" class="lg ke hh ms b fi nu mx l my mz">## <br/>##  Wilcoxon rank sum test with continuity correction<br/>## <br/>## data:  diamonds_cut$price by diamonds_cut$cut<br/>## W = 174286667, p-value &lt; 2.2e-16<br/>## alternative hypothesis: true location shift is not equal to 0</span><span id="2446" class="lg ke hh ms b fi nu mx l my mz"><em class="nh"># where y is numeric and A is A binary factor</em></span></pre><ul class=""><li id="815a" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">可以看出，实际位置偏移不等于0 (p值=0)。这意味着，中间值之间的差异不为0，因此中间值不相等。我们拒绝零假设，因为P值接近于0。如你所见，钻石价格的中位数是2400，而不是3500。我们也看到了钻石价格的上下置信区间。中位数的置信区间是(2376，2441)。</li></ul><h2 id="03b8" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">Wilcoxon符号秩检验</h2><p id="3124" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated">匹配对(相关样本)的t检验的非参数等价物是“Wilcoxon符号秩检验”。</p><blockquote class="nl nm nn"><p id="7818" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho:中值(之前)=中值(之后)</p><p id="680d" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">H1:中位数(之前)≠中位数(之后)</p></blockquote><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="b455" class="lg ke hh ms b fi mw mx l my mz"><em class="nh"># dependent 2-group Wilcoxon Signed Rank Test </em><br/>wilcox.test(insulin ~ group, data = my_data, paired=TRUE)</span><span id="18db" class="lg ke hh ms b fi nu mx l my mz">## <br/>##  Wilcoxon signed rank exact test<br/>## <br/>## data:  weight by group<br/>## V = 55, p-value = 0.001953<br/>## alternative hypothesis: true location shift is not equal to 0</span></pre><ul class=""><li id="48fb" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">如前所见，前后的中位数是不相等的(如在平均数中)。</li></ul><p id="f51d" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">注意:我们知道数据集中的异常值会破坏正态性，并且总体的“平均值”会受到异常值的严重影响。然而，中位数不受离群值的影响。这就是为什么在非参数测试中，中位数被比较和测试。</p><h2 id="c831" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">克鲁斯卡尔-沃利斯秩和检验</h2><p id="3675" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated">Kruskal-Wallis H检验(有时称为“秩的单向方差分析”)是一种基于秩的非参数检验，可用于确定两组或多组独立变量之间是否存在统计显著性差异。它被认为是单向方差分析的非参数替代方法，是Mann-Whitney U检验的扩展，允许对两个以上的独立组进行比较。</p><p id="4b0d" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">假设</strong></p><ul class=""><li id="8249" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">1:你的因变量应该以序数或连续水平来衡量。</li><li id="6bc8" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">2:你的论点必须由两个或两个以上明确的、独立的群体组成。</li><li id="b418" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">3:你必须独立于观察结果，也就是说，每个组中的观察结果之间或者组本身之间不应该有任何关系</li></ul><p id="519e" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">因为Kruskal-Wallis H检验不假设数据的正态性，并且对异常值的敏感度低得多，所以当这些假设被违反并且单因素方差分析的使用不合适时，可以使用该检验。。此外，如果您的数据是有序的，单向方差分析是不合适的，但克鲁斯卡尔-沃利斯H检验是。然而，克鲁斯卡尔-沃利斯H检验带有一个额外的假设。这个假设；</p><ul class=""><li id="d212" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">4:要了解如何解释Kruskal-Wallis H检验的结果，您必须确定每组中的分布是否具有相同的形状(即具有相同的可变性)。</li></ul><p id="313f" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">简要地；</p><p id="9396" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">假设</strong></p><ul class=""><li id="4034" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">样本内和样本间的观察是独立的。</li><li id="1d9f" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">所研究的变量是连续的</li><li id="e21d" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">人口相对于中位数是相同的。</li></ul><p id="6fc9" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">检验统计量近似分布为具有(k-1)个自由度的卡方分布。</p><blockquote class="nl nm nn"><p id="e1df" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho:所有组别的中位数相等(Ho: M1=M2=M3=M4=M5)</p><p id="73e9" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">H1:至少有一个中间值是不同的</p></blockquote><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="96c2" class="lg ke hh ms b fi mw mx l my mz">kruskal.test(price ~ cut, data=diamonds)</span><span id="9d4e" class="lg ke hh ms b fi nu mx l my mz">## <br/>##  Kruskal-Wallis rank sum test<br/>## <br/>## data:  price by cut<br/>## Kruskal-Wallis chi-squared = 978.62, df = 4, p-value &lt; 2.2e-16</span></pre><ul class=""><li id="6a63" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">由于p值小于显著性水平0.05，我们可以得出结论，治疗组之间存在显著差异。</li></ul><p id="c296" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">多组两两比较</strong></p><ul class=""><li id="9b2f" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">从Kruskal-Wallis检验的输出中，我们知道组之间存在显著差异，但我们不知道哪些组对是不同的。</li><li id="69ee" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">可以使用函数pairwise.wilcox.test()计算分组水平之间的成对比较，并对多重测试进行校正。</li></ul><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="5ca4" class="lg ke hh ms b fi mw mx l my mz">pairwise.wilcox.test(diamonds$price, diamonds$cut,<br/>                 p.adjust.method = "BH")</span><span id="b150" class="lg ke hh ms b fi nu mx l my mz">## <br/>##  Pairwise comparisons using Wilcoxon rank sum test with continuity correction <br/>## <br/>## data:  diamonds$price and diamonds$cut <br/>## <br/>##           Fair    Good    Very Good Premium<br/>## Good      7.9e-14 -       -         -      <br/>## Very Good &lt; 2e-16 0.023   -         -      <br/>## Premium   1.5e-05 1.6e-12 &lt; 2e-16   -      <br/>## Ideal     &lt; 2e-16 &lt; 2e-16 &lt; 2e-16   &lt; 2e-16<br/>## <br/>## P value adjustment method: BH</span></pre><h2 id="e7f5" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated"><strong class="ak">弗里德曼试验</strong></h2><p id="5202" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated">Friedman检验是单向重复测量ANOVA检验的非参数替代方法。它在有两个以上的组要比较的情况下扩展了符号检验。</p><p id="e057" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">Friedman检验用于评估三个或更多配对组的分布之间是否存在任何统计显著性差异。当不满足单向重复测量ANOVA检验的正态性假设时，或者当在有序尺度上测量因变量时，建议使用此方法。</p><p id="1d02" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">假设:</strong></p><ul class=""><li id="59c9" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">在无重复完全区组设计中排列的双向数据</li><li id="8d01" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">因变量是序数、区间或比率</li><li id="8dee" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">治疗或组自变量是具有两个或更多水平的因素。即两组或更多组</li><li id="1d17" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">阻塞变量是具有两个或更多级别的因素</li><li id="5528" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">块是相互独立的，与处理没有交互作用</li><li id="080f" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">为了检验中位数，每对组之间分数差异的分布都是对称的，或者每组值的分布具有相似的形状和分布。否则，该测试就是分布测试。</li></ul><p id="7fb8" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">假设:</strong>如果每对组之间的分数差的分布都是对称的，或者每组的值的分布具有相似的形状和分布:</p><blockquote class="nl nm nn"><p id="91e0" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">零假设:每组数值的中位数相等。</p><p id="969b" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">替代假设(双侧):每组值的中位数不相等。</p></blockquote><p id="4522" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">事后检验:</strong>弗里德曼检验的结果会告诉你各组之间是否存在差异，但不会告诉你哪些组与其他组不同。为了确定哪些组与其他组不同，可以进行事后测试。</p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="ffa9" class="lg ke hh ms b fi mw mx l my mz"><em class="nh">friedman.test(price~ cut|color, diamonds)<br/></em>Friedman rank sum test</span><span id="2e22" class="lg ke hh ms b fi nu mx l my mz">Friedman chi-squared = 23.139, df = 4, p-value = 0.0001188</span></pre><h1 id="ab8a" class="kd ke hh bd kf kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la bi translated">测试总体方差</h1><h2 id="0e28" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">方差的单样本检验</h2><p id="6753" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated">我们估计方差。使用卡方检验，其中方差等于用户指定的值，我们测试零假设并构建方差的置信区间。</p><p id="1ddf" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">让我们测试一下钻石价格的方差是否等于90。</p><blockquote class="nl nm nn"><p id="55ac" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho: σ2 = 90</p><p id="8d45" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">H1: σ2 ≠ 90</p></blockquote><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="44df" class="lg ke hh ms b fi mw mx l my mz">library(EnvStats)</span><span id="8c42" class="lg ke hh ms b fi nu mx l my mz">varTest(diamonds$price ,alternative = "two.sided", conf.level = 0.95,<br/>    sigma.squared = 90)</span><span id="934e" class="lg ke hh ms b fi nu mx l my mz">## <br/>##  Chi-Squared Test on Variance<br/>## <br/>## data:  diamonds$price<br/>## Chi-Squared = 9538590395, df = 53939, p-value &lt; 2.2e-16<br/>## alternative hypothesis: true variance is not equal to 90<br/>## 95 percent confidence interval:<br/>##  15727376 16107299<br/>## sample estimates:<br/>## variance <br/>## 15915629</span></pre><ul class=""><li id="a0e1" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">可以看出，方差的样本估计值是15915629，而不是90。(p值=0)</li></ul><h2 id="c96f" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">样本方差的双样本检验</h2><p id="605d" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated">什么时候应该使用f检验？</p><p id="139c" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">比较两个差异在许多情况下都很有用，包括:</p><ul class=""><li id="e22c" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">当我们想要运行双样本t检验来检查两个样本的方差相等时。</li><li id="d00b" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">当我们想要比较新测量方法和旧测量方法的可变性时。测试新方法是否减少了测量的可变性。</li></ul><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es oj"><img src="../Images/7e01de7f618d5356510d214a9f214fa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oji5Z15EVMcPSGojlT0SIg.png"/></div></div></figure><ul class=""><li id="083f" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">注意，这个比率偏离1越多，不相等总体方差的证据就越强。</li><li id="5136" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated"><strong class="iy hi">注意f检验需要两个样本的正态分布。</strong>(我们已经检查了这些变量的正态性)</li></ul><p id="95eb" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">让我们测试一下理想降价和溢价降价的方差是否相等。</p><blockquote class="nl nm nn"><p id="2ae6" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho: σ2(理想切割)=σ2(溢价切割)</p><p id="3062" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">H1: σ2(理想切割)≠ σ2(优质切割)</p></blockquote><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="6b33" class="lg ke hh ms b fi mw mx l my mz">var.test(price~cut, diamonds_cut, alternative = "two.sided",alpha=0.05)</span><span id="68dc" class="lg ke hh ms b fi nu mx l my mz">## <br/>##  F test to compare two variances<br/>## <br/>## data:  price by cut<br/>## F = 1.3042, num df = 13790, denom df = 21550, p-value &lt; 2.2e-16<br/>## alternative hypothesis: true ratio of variances is not equal to 1<br/>## 95 percent confidence interval:<br/>##  1.265403 1.344263<br/>## sample estimates:<br/>## ratio of variances <br/>##            1.30417</span></pre><ul class=""><li id="4d9e" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">可以看出，方差比大于1，这意味着方差不相等。(也在p值=0时指定)</li></ul><blockquote class="nl nm nn"><p id="967e" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated"><strong class="iy hi"> <em class="hh">重要提示</em> </strong></p></blockquote><p id="64a3" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">有不同类型的检验可以用来评估方差的相等性。</p><ol class=""><li id="0920" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt nw mf mg mh bi translated"><strong class="iy hi"> F检验:</strong>用于比较两组方差。数据应该是正态分布的。</li><li id="0863" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt nw mf mg mh bi translated"><strong class="iy hi"> Bartlett检验:</strong>用于两组或多组的方差比较。数据应该是正态分布的。</li><li id="0af6" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt nw mf mg mh bi translated"><strong class="iy hi"> Levene检验:</strong>对于非正态分布数据，它是Bartlett检验的替代方法。</li><li id="2a90" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt nw mf mg mh bi translated"><strong class="iy hi"> Figner-Killeen检验:</strong>对异常数据进行非参数检验。</li></ol><p id="844a" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">我们得出结论，f检验的非参数版本是<strong class="iy hi"> levene检验</strong>。我们已经展示了如何进行Levene测试。</p><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="b4ef" class="lg ke hh ms b fi mw mx l my mz">library(car)<br/>leveneTest(price ~ cut, data = diamonds_cut)</span><span id="3950" class="lg ke hh ms b fi nu mx l my mz">## Levene's Test for Homogeneity of Variance (center = median)<br/>##          Df F value    Pr(&gt;F)    <br/>## group     1  424.97 &lt; 2.2e-16 ***<br/>##       35340                      <br/>## ---<br/>## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre><p id="45d2" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">从上面的输出中，我们可以看到p值小于0.05的显著性水平。这意味着有证据表明各组之间的方差显著不同。</p><h1 id="8ee3" class="kd ke hh bd kf kg lb ki kj kk lc km kn ko ld kq kr ks le ku kv kw lf ky kz la bi translated">测试人口比例</h1><p id="786a" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated">“prop.test”可用于检验几个组中的赔率(成功概率)等于或等于某些给定值的假设。我们的主要目标是找出抽样率p̂和声称的人口比率值＄p _ 0＄之间是否存在差异。要执行此测试，采样率的采样分布必须近似为正态分布，其平均p̂和标准偏差为:</p><figure class="mn mo mp mq fd ii er es paragraph-image"><div class="er es ok"><img src="../Images/d01c606a97d94da2be20568e4bd7c3cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:508/format:webp/1*NerMeMRU5qOgr1t2HyasdQ.png"/></div></figure><p id="7a95" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">假设:</strong></p><p id="f92d" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">必须满足以下3个条件:</p><ul class=""><li id="f9f0" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">样本应通过简单的随机取样过程获得。(随机性)</li><li id="740d" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">n* p * (1 — p) ≥ 10</li><li id="4c13" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">n ≤ 0.05*N其中N为样本量，N为总体量。</li></ul><h2 id="1453" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">单样本比例检验</h2><p id="8eb0" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated"><strong class="iy hi">测试理想切割钻石的比例是否等于0.1。首先，我们来看看所有切割的数量和理想切割。</strong></p><blockquote class="nl nm nn"><p id="ecc5" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho: p=0.1</p><p id="5239" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">H1: p≠0.1</p></blockquote><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="6413" class="lg ke hh ms b fi mw mx l my mz">table(diamonds$cut)</span><span id="12e6" class="lg ke hh ms b fi nu mx l my mz">## <br/>##      Fair      Good Very Good   Premium     Ideal <br/>##      1610      4906     12082     13791     21551</span></pre><p id="2565" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">比例测试的语法；is <strong class="iy hi"> prop.test(x，n，p，alternative) </strong>。x是测试类别的数量，n是所有样本的数量，p是在零假设下测试的比率。</p><p id="d359" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">在我们的情况下；</p><ul class=""><li id="3305" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">x:理想切割数(21551)</li><li id="48c3" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">n:所有数字之和(1610+4906+12082+13791+21551 = 53940)</li><li id="07bd" class="lz ma hh iy b iz mi jd mj jh mk jl ml jp mm jt me mf mg mh bi translated">p: 0.1</li></ul><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="fed9" class="lg ke hh ms b fi mw mx l my mz">prop.test(x = 21551, n = 53940, p = 0.1, correct = FALSE,alternative = "two.sided")</span><span id="12ce" class="lg ke hh ms b fi nu mx l my mz">## <br/>##  1-sample proportions test without continuity correction<br/>## <br/>## data:  21551 out of 53940, null probability 0.1<br/>## X-squared = 53773, df = 1, p-value &lt; 2.2e-16<br/>## alternative hypothesis: true p is not equal to 0.1<br/>## 95 percent confidence interval:<br/>##  0.3954104 0.4036770<br/>## sample estimates:<br/>##         p <br/>## 0.3995365</span></pre><ul class=""><li id="f1ce" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">我们看到理想的切割比是0.4，而不是0.1。</li></ul><h2 id="2ac0" class="lg ke hh bd kf lh li lj kj lk ll lm kn jh ln lo kr jl lp lq kv jp lr ls kz lt bi translated">两个样本的比例比较</h2><p id="4d82" class="pw-post-body-paragraph iw ix hh iy b iz lu jb jc jd lv jf jg jh lw jj jk jl lx jn jo jp ly jr js jt ha bi translated">出于统计目的，当变量是分类变量(吸烟者/不吸烟者，民主党/共和党，支持/反对某个观点，等等)时，我们可以比较两个人口或群体。)或具有某一特定特质的个体比例(如吸烟者比例)。</p><p id="43d1" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated">为了进行这种比较，必须从每个群体中选择一个<strong class="iy hi">独立(单独)随机样本</strong>。</p><p id="2501" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">注意，只有当样本量(n)足够大时，Z统计公式才有效。</strong></p><p id="df4e" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">大样本情况</strong></p><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ol"><img src="../Images/c45ec84dfab7b065391e50357ac3089c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oiGSTteppXXmqTxq7FhdEA.png"/></div></div></figure><p id="ed06" class="pw-post-body-paragraph iw ix hh iy b iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ha bi translated"><strong class="iy hi">让我们测试一下理想切割钻石率和溢价切割钻石率之间是否存在显著差异。在第一部分，我们看到这些类别的数字。</strong></p><blockquote class="nl nm nn"><p id="e180" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">Ho: p1=p2</p><p id="af7f" class="iw ix nh iy b iz ja jb jc jd je jf jg no ji jj jk np jm jn jo nq jq jr js jt ha bi translated">H1: p1≠p2</p></blockquote><pre class="mn mo mp mq fd mr ms mt mu aw mv bi"><span id="d732" class="lg ke hh ms b fi mw mx l my mz">prop.test(x = c( 13791, 21551 ), n =c(53940, 53940),<br/>              alternative = "two.sided")</span><span id="0f6b" class="lg ke hh ms b fi nu mx l my mz">## <br/>##  2-sample test for equality of proportions with continuity correction<br/>## <br/>## data:  c(13791, 21551) out of c(53940, 53940)<br/>## X-squared = 2533.4, df = 1, p-value &lt; 2.2e-16<br/>## alternative hypothesis: two.sided<br/>## 95 percent confidence interval:<br/>##  -0.1494173 -0.1383098<br/>## sample estimates:<br/>##    prop 1    prop 2 <br/>## 0.2556730 0.3995365</span></pre><ul class=""><li id="48d6" class="lz ma hh iy b iz ja jd je jh ni jl nj jp nk jt me mf mg mh bi translated">我们看到保费削减率是0.26，理想的削减率是0.40。所以这两个样本的比例是不一样的。(p=0)</li></ul></div><div class="ab cl ip iq go ir" role="separator"><span class="is bw bk it iu iv"/><span class="is bw bk it iu iv"/><span class="is bw bk it iu"/></div><div class="ha hb hc hd he"><h1 id="11aa" class="kd ke hh bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">摘要</h1><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es om"><img src="../Images/0f6c48778b0ede1eb6eb3888284cac63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qBj-rdpqi3u-FKwSYWI19w.png"/></div></div></figure></div></div>    
</body>
</html>