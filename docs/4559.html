<html>
<head>
<title>Keras LSTM Forecasting Using Synthetic Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用合成数据的喀拉斯LSTM预报</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/keras-lstm-forecasting-using-synthetic-data-9e1ae4e07d47?source=collection_archive---------0-----------------------#2021-11-14">https://medium.com/analytics-vidhya/keras-lstm-forecasting-using-synthetic-data-9e1ae4e07d47?source=collection_archive---------0-----------------------#2021-11-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="fdde" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这篇文章最初发表在我的网站<a class="ae jc" href="https://adamnovotny.com/blog/lstm-forecast-synthetic-data.html" rel="noopener ugc nofollow" target="_blank">adamnovotny.com</a></p></div><div class="ab cl jd je go jf" role="separator"><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji jj"/><span class="jg bw bk jh ji"/></div><div class="ha hb hc hd he"><h2 id="8e04" class="jk jl hh bd jm jn jo jp jq jr js jt ju ip jv jw jx it jy jz ka ix kb kc kd ke bi translated">摘要</h2><p id="5e96" class="pw-post-body-paragraph ie if hh ig b ih kf ij ik il kg in io ip kh ir is it ki iv iw ix kj iz ja jb ha bi translated">Keras LSTM可以成为一个强有力的预测工具。下面是一个简单的模板笔记本，展示了如何设置数据科学预测实验。</p><p id="00a6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">数据集</strong></p><p id="43d0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用scikit-learn回归生成器<a class="ae jc" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_friedman1.html#sklearn.datasets.make_friedman1" rel="noopener ugc nofollow" target="_blank"> make_friedman1 </a>生成合成数据集。数据集是非线性的，有噪声，一些特征被手动缩放，使深度学习任务更具挑战性。通过使每个标签成为<em class="kk"> make_friedman1 </em>生成的值和先前标签的加权平均值来创建时间序列相关性。详见笔记本函数<em class="kk"> generate_data() </em>。</p><p id="6b34" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下图显示了生成的要素、为同一时间段生成的y标注以及我们尝试预测的实际future_label之间的相关性。特征x _ 0-x _ 4是唯一的信息特征，从底部一行可以验证，显示有意义但不是很强的相关性:</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kl"><img src="../Images/ec71500d5186f9d1362f8eb461e86b84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0ESY1EJqkwbBnGPF.png"/></div></div></figure><p id="63eb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">模特培训</strong></p><p id="ac76" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该模型是一个简单的神经网络，具有定义为<em class="kk"> keras.layers.LSTM(32) </em>的单个隐藏层。</p><p id="5d76" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">生成的数据集被分为训练集、验证集和测试集，每个数据集都遵循数据的时间序列特性。验证集用于提前停止训练，以防止过度拟合。然而，从下面的图表中可以看出，我们的合成数据集并不担心这一点。随着训练时期的继续，验证曲线从未开始增加:</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kx"><img src="../Images/8c2528f40898ed713f3f1d983e825585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xDtan961opj41O7q.png"/></div></div></figure><p id="0daa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">模型评估</strong></p><p id="0627" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">比较验证集的预测和实际标签显示了很强的性能，尽管在接近极值时可以进行明显的优化:</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es ky"><img src="../Images/34d5d2e00785d6de94952a0c77c2868b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PNjzHStFboLcaTSe.png"/></div></div></figure><p id="336a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，验证集已经在训练期间用于早期停止的目的。这就是为什么我们留出一个模型在训练中从未见过的测试数据集。测试数据集是模型预期性能的唯一真实评估，在这种情况下，它确认模型对于合成数据集表现良好:</p><figure class="km kn ko kp fd kq er es paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="er es kz"><img src="../Images/966c13ad2216dbc5260a4aea5a9244b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9YTEBSuju9XOzKum.png"/></div></div></figure><h2 id="c941" class="jk jl hh bd jm jn jo jp jq jr js jt ju ip jv jw jx it jy jz ka ix kb kc kd ke bi translated">笔记本</h2><ul class=""><li id="38a2" class="la lb hh ig b ih kf il kg ip lc it ld ix le jb lf lg lh li bi translated"><a class="ae jc" href="https://adamnovotny.com/blog/lstm-forecast-synthetic-data.html#notebook" rel="noopener ugc nofollow" target="_blank">嵌入博文</a></li><li id="d883" class="la lb hh ig b ih lj il lk ip ll it lm ix ln jb lf lg lh li bi translated"><a class="ae jc" href="https://adamnovotny.com/notebooks/lstm_synthetic_data.html" rel="noopener ugc nofollow" target="_blank">作为html </a></li><li id="ade3" class="la lb hh ig b ih lj il lk ip ll it lm ix ln jb lf lg lh li bi translated"><a class="ae jc" href="https://gist.github.com/adamnovotnycom/36af4c4400a7f970982685472661eba1" rel="noopener ugc nofollow" target="_blank">作为Github要诀</a></li></ul></div></div>    
</body>
</html>