<html>
<head>
<title>Defect Detection in Products using Image Segmentation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用图像分割的产品缺陷检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/defect-detection-in-products-using-image-segmentation-a87a8863a9e5?source=collection_archive---------0-----------------------#2021-05-07">https://medium.com/analytics-vidhya/defect-detection-in-products-using-image-segmentation-a87a8863a9e5?source=collection_archive---------0-----------------------#2021-05-07</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/073d101c76c6ab6b84ff3eed06bcb0c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gqEmmgS29EfU4DMh"/></div></div></figure><h1 id="5227" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">目录</h1><ol class=""><li id="8143" class="jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke bi translated">介绍</li><li id="6165" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">问题陈述</li><li id="676d" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">ML公式</li><li id="59f8" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">绩效指标</li><li id="0f12" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">理解数据</li><li id="fc99" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">数据准备</li><li id="33cf" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">建模</li><li id="3ad6" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">培养</li><li id="4e11" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">基于测试数据的分割图预测</li><li id="9e9a" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">未来作品</li><li id="7d66" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">参考</li></ol><h1 id="3968" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">1.介绍</h1><p id="49b6" class="pw-post-body-paragraph kk kl hh jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ha bi translated"><strong class="jp hi">什么是物体检测？</strong></p><p id="eded" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">给定一幅图像，我们人类可以识别该图像中存在的物体。例如，我们可以检测图像中是否有汽车、树木、人物等。<em class="le">如果我们能够分析图像并检测物体，我们是否也能教会机器做同样的事情？</em></p><p id="b2f6" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">答案是肯定的。随着深度学习和计算机视觉的兴起，我们可以自动进行物体检测。我们可以建立深度学习和计算机视觉模型，可以检测和定位对象，计算它们之间的距离，预测它们未来的阶段等。目标检测在计算机视觉和机器学习中有着广泛的应用。物体跟踪、闭路电视监控、人类活动识别，甚至自动驾驶汽车都利用了这项技术。为了更好地理解它，考虑下图。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lf"><img src="../Images/569209c289ccee0e4531ae404b3f9c74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VRFuo3R4l1E0-wYT"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">图1:道路交通物体检测</figcaption></figure><p id="f045" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">该图示出了从车辆看的道路交通图像的物体检测。这里我们可以看到它正在检测其他车辆、交通信号等。如果车辆是自动驾驶汽车，它应该能够检测行驶路径、其他车辆、行人、交通信号等，以便平稳和安全地驾驶。</p><p id="df71" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">如果你想知道更多关于物体检测的信息，你可以参考<a class="ae lo" href="https://www.fritz.ai/object-detection/#:~:text=Object%20detection%20is%20a%20computer,all%20while%20accurately%20labeling%20them." rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="0d9c" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">既然我们已经理解了对象检测，让我们转到一个稍微高级的技术，称为图像分割。</p><p id="ed0a" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">通过分析下图，我们很容易理解目标检测和图像分割的区别。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lp"><img src="../Images/62f9135b15c012c5a9f80cd75551921f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*xEiL2yRO5L8skyOp"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">图2:对象检测和图像分割</figcaption></figure><p id="7d4b" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">这两种方法都试图识别和定位图像中的对象。在对象检测中，这是通过使用边界框来实现的。算法或模型将通过在对象周围绘制矩形边界框来定位对象。在图像分割中，图像的每个像素都被标注。这意味着，给定一幅图像，分割模型试图通过将图像的所有像素分类为有意义的对象类别来进行像素分类。这也称为密集预测，因为它通过识别和理解每个像素属于什么对象来预测每个像素的意义。</p><p id="9660" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated"><em class="le">“图像分割的返回格式称为遮罩:一个与原始图像大小相同的图像，但对于每个像素，它只具有一个指示对象是否存在的布尔值。”</em></p><p id="3cf0" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">我们将在这个案例研究中使用这种技术。想了解更多关于图像分割的知识，可以参考<a class="ae lo" href="https://missinglink.ai/guides/computer-vision/image-segmentation-deep-learning-methods-applications/" rel="noopener ugc nofollow" target="_blank">这个</a>。</p><p id="4c41" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">现在我们有了一个关于物体检测和图像分割的想法。让我们进一步理解问题陈述。</p><h1 id="2775" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">2.问题陈述</h1><p id="ae04" class="pw-post-body-paragraph kk kl hh jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ha bi translated">我们得到了一些产品的图片。有些产品有缺陷，有些没有。给定一个产品的图像，我们需要检测它是否有缺陷。我们还需要定位这个缺陷。</p><h1 id="709c" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">3.ML公式</h1><p id="8637" class="pw-post-body-paragraph kk kl hh jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ha bi translated">这个问题可以表述为一个图像分割任务。给定一个产品的图像，我们需要为其绘制分割蒙版。如果产品有缺陷，分割图应该能够定位该缺陷。</p><h1 id="9560" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">4.绩效指标</h1><p id="85af" class="pw-post-body-paragraph kk kl hh jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ha bi translated">分割问题中最常用的度量之一是交集/并集(IoU)分数。参考下图，它清楚地显示了IoU分数是如何计算的。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lq"><img src="../Images/5ab1742c9d5cbb5aebf5020ccb47ec4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*_qJKRLpevTRISLqi"/></div></figure><p id="0f94" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated"><strong class="jp hi"> IoU是预测分割和真实分割之间的重叠面积除以预测分割和原始分割之间的合并面积。</strong></p><p id="f28f" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">我们也可以把欠条分数写成TPTP+FN+FP。你可以参考<a class="ae lo" href="https://stats.stackexchange.com/questions/273537/f1-dice-score-vs-iou/276144#276144" rel="noopener ugc nofollow" target="_blank">这里</a>了解更多信息</p><p id="b0fb" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">该指标的范围从0到1。Iou分数为1表示完全重叠，IoU分数为0表示完全没有重叠。</p><p id="1636" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">本案例研究中使用的损失函数是骰子损失。骰子损失可以被认为是1-骰子系数，其中骰子系数被定义为，</p><p id="e80e" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">骰子系数=2*相交重叠面积</p><p id="c219" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">您可以在此阅读更多关于这些指标的信息<a class="ae lo" href="https://towardsdatascience.com/metrics-to-evaluate-your-semantic-segmentation-model-6bcb99639aa2#:~:text=3.-,Dice%20Coefficient%20(F1%20Score),of%20pixels%20in%20both%20images." rel="noopener" target="_blank">。</a></p><h1 id="92ad" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">5.理解数据</h1><p id="02d1" class="pw-post-body-paragraph kk kl hh jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ha bi translated">数据集包含两个文件夹—培训和测试。训练集由六类图像组成。每类图像被分成两个文件夹，其中一个文件夹包含1000个无缺陷图像，另一个包含130个有缺陷图像。下图显示了train文件夹中的文件夹。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lr"><img src="../Images/5def3f3a8ef96b8ea6d6abfeca125219.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mOh6SlwUvOTsAQX1"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">图3:训练数据集</figcaption></figure><p id="de70" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">以“_def”结尾的文件夹名包含相应类别的缺陷图像，没有“_def”的代表无缺陷图像。</p><p id="f35c" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">测试文件夹包含一组120个缺陷图像，其分割图将被预测。</p><h1 id="6439" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">6.数据准备</h1><h1 id="d24d" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">6.1准备图像数据和分割掩模</h1><p id="6729" class="pw-post-body-paragraph kk kl hh jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ha bi translated">现在我们需要为每幅图像准备图像数据和相应的分割蒙版。我们把图像分成十二个文件夹。让我们看一些图片。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es ls"><img src="../Images/4e6268b8a4ca0af2e787cde130ab41aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/0*nWP-FquRNC4pNd9X"/></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es ls"><img src="../Images/7db44f4087590e245f99521d04f425bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/0*5aCbDA25BdVrCqT-"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">图4:产品的样本图像</figcaption></figure><p id="b691" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">第一个图像代表有缺陷的产品，第二个图像代表无缺陷的图像。现在我们需要为这些图像准备分割图。分割图应该检测图像中的缺陷部分。对于上面的图像，预期的分割图将是这样的。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es ls"><img src="../Images/d540f41d206b299715702d19d22d10ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/0*MFYWfpgjyc0NjFxB"/></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es ls"><img src="../Images/dc7b9962b844450b69d768f223b9282b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/0*PTjjddtyzmkx8zDF"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">图5:图4中图像的分段掩码</figcaption></figure><p id="3b62" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">我们可以看到，在第一个图像中，椭圆形区域代表检测部分。第二个图像是空白的，因为它没有缺陷。</p><p id="3ef3" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">让我们分析一些更有缺陷的图像。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es ls"><img src="../Images/8f92d52824128757ea2360fa35e94a9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/0*abx-D50xA1j96esp"/></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es ls"><img src="../Images/8e180353a8edd3f2838085b88bf28691.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/0*l_83X9_-mYnomhSC"/></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es ls"><img src="../Images/f385fb801c54e4aa0d9b5d971f38f817.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/0*Qx1rRSn4FcmqGuAG"/></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es ls"><img src="../Images/566244bacab8fb57af15b9a09e94d37c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/0*MC8uG31W2fEzsN4j"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">图6:一些有缺陷图像的例子</figcaption></figure><p id="457c" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">我们可以看到缺陷在图像中以曲线或直线的形式出现。因此，为了将这些区域标记为缺陷，我们可以使用椭圆。</p><p id="bafc" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">但是我们如何准备分割蒙版呢？需要人工标注吗？</p><p id="c10f" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">幸运的是，我们得到了另一个包含分段掩码信息的文件。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lt"><img src="../Images/d59be399311d474ebb1844f5efac7930.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/0*Nwvz-3xbgfNmF3WI"/></div></figure><p id="850e" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">每一行都包含有关图像被遮罩区域的信息。每列表示以下内容:图像的文件名、椭圆的半长轴、椭圆的半短轴、椭圆的旋转角度、椭球中心的x位置和椭球中心的y位置。</p><p id="294c" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">用于绘制椭圆的数据是使用get_data函数获得的，如下所示</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/edcf04c6e20add2ab0a350d70ad81253.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CEyaaXTie_j9kdaD"/></div></div></figure><p id="f2a6" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">我们可以使用这些信息，并使用<a class="ae lo" href="https://scikit-image.org/docs/dev/api/skimage.draw.html" rel="noopener ugc nofollow" target="_blank">撇除</a>功能绘制一个椭圆分割蒙版。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lv"><img src="../Images/585ada3f8eb18315e4f2b4e068fa6466.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*05iU9fnOAfmO8R4f"/></div></figure><p id="dbbf" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">应当注意，这仅适用于有缺陷的图像。对于无缺陷的图像，我们需要创建空白图像作为分段掩码。</p><h1 id="d3ec" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">6.2加载数据</h1><p id="d017" class="pw-post-body-paragraph kk kl hh jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ha bi translated">结构化数据以如下所示的形式获得。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lw"><img src="../Images/d6275bc1a73941e7045eaed12d7d7bf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2AfeMWlJCVc9LOsL"/></div></div></figure><p id="daad" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">“图像”列包含每个图像的完整文件路径,“遮罩”列包含相应的遮罩图像。</p><p id="c734" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">下一步是加载数据。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lv"><img src="../Images/34a7566d7d5245511d7ee74178eedc86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*Ku7BbkMU9bQqJD45"/></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lv"><img src="../Images/fa2c18bd07337d75ba0d8f010f6c7c96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*e-QEEQZQHmz5Kewi"/></div></figure><h1 id="4e3f" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">7.建模</h1><p id="f4f9" class="pw-post-body-paragraph kk kl hh jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ha bi translated">既然我们已经获得了所有的数据，下一步就是找到一个可以为图像生成分割蒙版的模型。我来介绍一下UNet模型，它非常流行于图像分割任务。</p><p id="248f" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">UNet架构包含两条路径——收缩路径和扩张路径。下图将有助于更好地理解Unet架构。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/f1bc2af90f59820748cf5a21800f671f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XvS_exFfykdlzhfz"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">图Unet架构</figcaption></figure><p id="927b" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">模型结构类似于英文字母“U ”,因此得名Unet。模型的左侧包含收缩路径(也称为编码器)，它有助于捕捉图像中的上下文。编码器只是传统的卷积层和最大池层的堆栈。在这里，我们可以看到池层减少了图像的高度和宽度，增加了深度或通道的数量。在收缩路径的末端，模型将理解图像中存在的形状、图案、边缘等，但是它丢失了它存在于“何处”的信息。</p><p id="b5fa" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">因为我们的问题是获得图像的分割图，所以我们仅从收缩路径获得的信息是不够的。我们需要一个高分辨率的图像作为输出，其中所有像素被分类。</p><p id="610f" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated"><em class="le">“如果我们使用一个有池层和密集层的规则卷积网络，我们会丢失“在哪里”的信息，只保留“是什么”的信息，而这些信息并不是我们想要的。在细分的情况下，我们既需要“什么”也需要“在哪里”的信息。</em></p><p id="fe96" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">因此，我们需要对图像进行上采样，以保留“位置”信息。这是在右侧的扩展路径中完成的。扩展路径(也称为解码器)用于使用上采样技术对捕获的上下文进行定位。有各种上采样技术，如双线性插值、最近邻法、转置卷积等。如果你有兴趣了解更多关于上采样技术的内容，可以参考<a class="ae lo" href="https://towardsdatascience.com/transposed-convolution-demystified-84ca81b4baba" rel="noopener" target="_blank">这个</a>。</p><h1 id="2ffd" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">8.培养</h1><p id="6a15" class="pw-post-body-paragraph kk kl hh jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ha bi translated">现在，我们已经准备好了训练的所有数据，模型也决定了。现在让我们训练模型。</p><p id="7b15" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">由于无缺陷图像的数量远高于有缺陷图像的数量，为了获得更好的结果，我们只从无缺陷图像中抽取一个样本。该模型是使用adam optimizer编译的，我们使用骰子损失作为损失函数。使用的性能指标是iou得分。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lu"><img src="../Images/8ec6f5bc6fa05dcab8a2bad1b1c85fe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5KquJVmBL59undqz"/></div></div></figure><p id="780c" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">经过10个时期后，我们能够实现0.98的iou分数和0.007的骰子损失，这已经相当不错了。让我们看看一些图像的分割图。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lx"><img src="../Images/17351684e7486fcefb91791d9e757430.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tshbeFOh1SkGDTF8"/></div></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ly"><img src="../Images/9a37988f9d3cf014502b0c9f71577a00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DoDvpPNq82UaRW2N"/></div></div></figure><p id="1719" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">我们可以看到，该模型能够预测与原始分割图相似的分割图。</p><h1 id="0525" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">9.基于测试数据的分割图预测</h1><p id="aca0" class="pw-post-body-paragraph kk kl hh jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ha bi translated">现在让我们尝试解决手头的问题，即预测和绘制测试图像的分割掩模。下图显示了一些测试图像的预测分割图。</p><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es lz"><img src="../Images/a6e3682d5aa99076f3528270604d037d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/0*y9J7hcCCCclzFPXg"/></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es ma"><img src="../Images/e644adec4c931443ab43f4f0fbfa4954.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/0*OJSzLvffX2Dv4xJ5"/></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es mb"><img src="../Images/c3cd56b90de91d3f9127b27521c0169f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/0*wDiRh65pMgC4ERHL"/></div></figure><figure class="lg lh li lj fd ii er es paragraph-image"><div class="er es mc"><img src="../Images/7715499eb4622d9a3f2324017bea05c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/0*DgXK5fo1ZrqmcQvH"/></div></figure><p id="fd0f" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">我们可以看到，该模型给出了良好的测试性能，并且能够检测测试图像中的缺陷。</p><p id="249d" class="pw-post-body-paragraph kk kl hh jp b jq kz km kn js la ko kp ju lb kr ks jw lc ku kv jy ld kx ky ka ha bi translated">如有任何疑问或建议，可通过<a class="ae lo" href="https://www.linkedin.com/in/vinitha-v-n-5a0560179/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp hi"> LinkedIn </strong> </a>联系我。</p><h1 id="efb6" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">10.未来作品</h1><p id="4ada" class="pw-post-body-paragraph kk kl hh jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ha bi translated">如上所述，与无缺陷图像相比，缺陷图像的数量非常低。因此，我们可以通过对有缺陷的图像应用上采样和增强技术来改进训练。</p><h1 id="d220" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">11.参考</h1><ol class=""><li id="5b8e" class="jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke bi translated"><a class="ae lo" href="https://towardsdatascience.com/understanding-semantic-segmentation-with-unet-6be4f42d4b47" rel="noopener" target="_blank">https://towards data science . com/understanding-semantic-segmentation-with-unet-6 be 4f 42 D4 b 47</a></li><li id="227b" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated"><a class="ae lo" href="https://towardsdatascience.com/metrics-to-evaluate-your-semantic-segmentation-model-6bcb99639aa2" rel="noopener" target="_blank">https://towards data science . com/metrics-to-evaluate-your-semantic-segmentation-model-6 BCB 99639 aa 2</a></li><li id="49b8" class="jn jo hh jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated"><a class="ae lo" href="https://towardsdatascience.com/transposed-convolution-demystified-84ca81b4baba" rel="noopener" target="_blank">https://towards data science . com/transposed-卷积-去神秘化-84ca81b4baba </a></li></ol></div></div>    
</body>
</html>