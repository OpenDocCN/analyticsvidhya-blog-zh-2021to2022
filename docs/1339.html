<html>
<head>
<title>ETL Using Luigi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Luigi进行ETL</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/etl-using-luigi-c8ff2bbf2ef3?source=collection_archive---------8-----------------------#2021-02-24">https://medium.com/analytics-vidhya/etl-using-luigi-c8ff2bbf2ef3?source=collection_archive---------8-----------------------#2021-02-24</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/ee3b544e5d75964b525b1f5b8d23632b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*0VlrUeqtc-6Ro9S0dGN8iQ.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">路易吉仪表板</figcaption></figure><p id="cdea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> E T L </strong></p><p id="dea1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在计算中，提取、转换、加载(ETL)是将数据从一个或多个源复制到目标系统的一般过程，该目标系统以不同于源的方式或在不同于源的上下文中表示数据。ETL过程在20世纪70年代成为一个流行的概念，经常用于数据仓库。</p><p id="c119" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">摘录</em></p><p id="58b4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在数据提取步骤中，数据从源位置复制或导出到临时区域。数据几乎可以来自任何结构化或非结构化的来源— SQL或NoSQL服务器、CRM和ERP系统、文本和文档文件、电子邮件、网页等等。</p><p id="8755" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">变换</em></p><p id="4a24" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在临时区域中，原始数据被转换为对分析有用的数据，并符合最终目标数据仓库的模式，该数据仓库通常由结构化在线分析处理(OLAP)或关系数据库提供支持。这可能涉及以下内容:</p><ul class=""><li id="4d1e" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated">过滤、清理、消除重复、验证和认证数据。</li><li id="1d75" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">基于原始数据进行计算、翻译或汇总。这包括从更改行标题和列标题以保持一致性，到转换货币或度量单位，到编辑文本字符串，再到对值求和或求平均值，满足组织特定BI或分析目的所需的一切。</li><li id="ea17" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">删除、加密、隐藏或以其他方式保护受政府或行业法规管辖的数据。</li><li id="b9a3" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">将数据格式化为表或连接表，以匹配目标数据仓库的模式</li></ul><p id="d65a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在临时区域执行这些转换——而不是在源系统内部——限制了对源系统的性能影响，并降低了数据损坏的可能性。</p><p id="20c4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="jo">加载</em></p><p id="6be0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在最后一步中，转换后的数据从临时区域转移到目标数据仓库中。通常，这涉及所有数据的初始加载，随后是增量数据更改的定期加载，以及不太常见的完全刷新，以擦除和替换仓库中的数据。</p><p id="6f1c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">什么是Luigi？</strong></p><p id="25de" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Luigi是一个Python模块，可以帮助您构建批处理作业的复杂管道。它处理依赖性解析、工作流管理、可视化等。</p><p id="fbe1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Luigi的目的是解决通常与长时间运行的批处理相关的所有问题。你想把很多任务链起来，自动化，失败就会发生。这些任务可以是任何事情，但通常是长时间运行的事情，如Hadoop作业、向/从数据库转储数据、运行机器学习算法或任何其他事情。</p><p id="eade" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">什么是psycopg2？</strong></p><p id="0f88" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Psycopg是Python编程语言最流行的PostgreSQL适配器。其核心是Python DB API 2.0规范的完整实现。几个扩展允许访问PostgreSQL提供的许多特性。</p><p id="201a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">什么是sqlalchemy？</strong></p><p id="30fb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">SQLAlchemy是Python SQL工具包和对象关系映射器，为应用程序开发人员提供了SQL的全部功能和灵活性。</p><p id="fc60" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">SQLAlchemy允许开发人员使用简单的SQL语句(与其他对象关系映射工具不同)，这些语句提供了一种有用的方法来连接数据库表和用户定义的Python类。SQLAlchemy对象关系映射工具主要集中于使用SQL表达式语言。</p><p id="34fc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">场景</strong></p><p id="fae5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们有一个非常简单的场景来演示这些库的组合来创建ETL，我们有两个不同的数据库dvdrental和iykra-sql，我们构建一个查询来获取每个员工处理的总量，并创建一个CSV，然后导入到iykra-sql数据库。</p><p id="f4b4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">准备</strong></p><p id="68c7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们需要创建查询并安装所需的python库，在本例中我们将使用PostgreSQL。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es kd"><img src="../Images/e5ae72d3a45a088fdfbba2e5182bc6e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*Q1-3ByCksGPy_5qB2JQdDw.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">Python库</figcaption></figure><p id="77b0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">解决方案</strong></p><p id="f90d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们有2个步骤来做这个例子，在这个例子中，我们不做转换过程。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es ki"><img src="../Images/657aa9c301e8c59ff6971f7b35f482f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*l-NmXMdw_R0G72CcFfY_yQ.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">提取和加载</figcaption></figure><p id="17c4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">摘录</strong></p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es kj"><img src="../Images/df833ff57cd7c17f1b343b3ae126fe64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*KKZUrVtjHXe7Os4vFwy6UQ.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">提取脚本</figcaption></figure><p id="99d6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">装载</strong></p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es kk"><img src="../Images/6301d7622fc7ab7ce9e66393633a2c59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*b7yWc-uRE388tcdsOriopA.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">用于加载的脚本</figcaption></figure><p id="8390" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">运行脚本</strong></p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/41a2291d27a56826bc637f7385adbefa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*lDYg1pbF8o8Pf1xuAZc7AA.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">运行脚本</figcaption></figure><p id="2c3b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">路易吉仪表盘</strong></p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/5982532514d5a68b9ad65f1eebbbd201.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*kUiRTRmDevKnRoMaYmEaJg.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">路易吉仪表板</figcaption></figure><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/c8bf62c026ccf48ab0303f0de19b6f56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*2sEyEYpTGjQLlU_bcDb74Q.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">从数据库创建Csv</figcaption></figure><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/63473eeda1c09c4a6fc4eb73338ed758.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*FzM9tv2mU4koBIzsGSwdsw.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">将Csv插入数据库</figcaption></figure><p id="05e8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">结果</strong></p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es kl"><img src="../Images/b0ca7f206a2e03169ca68adaa6e5e2e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*lam3fHba5dS55hG-gnvcdg.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">结果</figcaption></figure><p id="96ec" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">结论</strong></p><p id="91b7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Luigi 是一个基于Python的ETL<strong class="is hj">工具，由Spotify创建，但现在可以作为开源工具使用。它是一个比这个列表中的许多工具更复杂的工具，具有创建复杂的ETL管道的强大功能。</strong></p><p id="9a8e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，我们了解了Luigi如何使编写满足您需求的ETL变得更加容易。</p><p id="fcde" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">参考文献</strong></p><div class="km kn ez fb ko kp"><a href="https://en.wikipedia.org/wiki/Extract,_transform,_load" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab dw"><div class="kr ab ks cl cj kt"><h2 class="bd hj fi z dy ku ea eb kv ed ef hh bi translated">提取、转换、加载</h2><div class="kw l"><h3 class="bd b fi z dy ku ea eb kv ed ef dx translated">在计算中，提取、转换、加载(ETL)是将数据从一个或多个数据源复制到另一个数据源的一般过程</h3></div><div class="kx l"><p class="bd b fp z dy ku ea eb kv ed ef dx translated">en.wikipedia.org</p></div></div><div class="ky l"><div class="kz l la lb lc ky ld ik kp"/></div></div></a></div><div class="km kn ez fb ko kp"><a href="https://www.ibm.com/cloud/learn/etl" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab dw"><div class="kr ab ks cl cj kt"><h2 class="bd hj fi z dy ku ea eb kv ed ef hh bi translated">什么是ETL(提取、转换、加载)？</h2><div class="kw l"><h3 class="bd b fi z dy ku ea eb kv ed ef dx translated">ETL是一个从多个数据源提取、转换和加载数据到数据仓库或其他统一数据库的过程。</h3></div><div class="kx l"><p class="bd b fp z dy ku ea eb kv ed ef dx translated">www.ibm.com</p></div></div><div class="ky l"><div class="le l la lb lc ky ld ik kp"/></div></div></a></div><div class="km kn ez fb ko kp"><a href="https://luigi.readthedocs.io/en/stable" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab dw"><div class="kr ab ks cl cj kt"><h2 class="bd hj fi z dy ku ea eb kv ed ef hh bi translated">入门- Luigi 2.8.13文档</h2><div class="kw l"><h3 class="bd b fi z dy ku ea eb kv ed ef dx translated">Luigi是一个Python (2.7、3.6、3.7测试版)包，可以帮助您构建批处理作业的复杂管道。它处理…</h3></div><div class="kx l"><p class="bd b fp z dy ku ea eb kv ed ef dx translated">luigi.readthedocs.io</p></div></div><div class="ky l"><div class="lf l la lb lc ky ld ik kp"/></div></div></a></div><div class="km kn ez fb ko kp"><a href="https://www.psycopg.org" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab dw"><div class="kr ab ks cl cj kt"><h2 class="bd hj fi z dy ku ea eb kv ed ef hh bi translated">Python - Psycopg的PostgreSQL驱动程序</h2><div class="kw l"><h3 class="bd b fi z dy ku ea eb kv ed ef dx translated">psycopg2池是一个非常简单的对象，比...</h3></div><div class="kx l"><p class="bd b fp z dy ku ea eb kv ed ef dx translated">www.psycopg.org</p></div></div></div></a></div><p id="db78" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae lg" href="http://www.sqlalchemy.org" rel="noopener ugc nofollow" target="_blank">www.sqlalchemy.org</a></p><div class="km kn ez fb ko kp"><a href="https://www.liquidweb.com/kb/how-to-install-sqlalchemy" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab dw"><div class="kr ab ks cl cj kt"><h2 class="bd hj fi z dy ku ea eb kv ed ef hh bi translated">如何安装SQLAlchemy |灵动网络</h2><div class="kw l"><h3 class="bd b fi z dy ku ea eb kv ed ef dx translated">SQLAlchemy工具包和对象关系映射器是一套广泛的实用工具，用于处理Python和…</h3></div><div class="kx l"><p class="bd b fp z dy ku ea eb kv ed ef dx translated">www.liquidweb.com</p></div></div><div class="ky l"><div class="lh l la lb lc ky ld ik kp"/></div></div></a></div></div></div>    
</body>
</html>