<html>
<head>
<title>How to build a neural network playground from scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从零开始建立一个神经网络游乐场</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-build-a-neural-network-playground-from-scratch-6a91440b9ff?source=collection_archive---------3-----------------------#2021-07-25">https://medium.com/analytics-vidhya/how-to-build-a-neural-network-playground-from-scratch-6a91440b9ff?source=collection_archive---------3-----------------------#2021-07-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/></div><div class="ab cl ie if go ig" role="separator"><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij"/></div><div class="ha hb hc hd he"><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="ir is di it bf iu"><div class="er es il"><img src="../Images/9420df8d57d2ce684d32daa2eac70c21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j-oFZ2-cUWBPo8EMy058DQ.png"/></div></div></figure><p id="8d7e" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">最近几年的<a class="ae jv" href="https://www.kdnuggets.com/wp-content/uploads/Fig2-winning-machine-learning-competition.jpg" rel="noopener ugc nofollow" target="_blank">研究出版物主题</a>显示，神经网络变得越来越受欢迎。这些模型的主要优点是它们可以学习复杂的结构，并且高度可定制。然而，一个显著的缺点是它们的解释能力差。神经网络通常被归类为难以理解的所谓“黑盒模型”。</p></div><div class="ab cl ie if go ig" role="separator"><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij"/></div><div class="ha hb hc hd he"><p id="56aa" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">幸运的是，有一些非常好的教程来理解神经网络实际上是如何工作的。<a class="ae jv" href="https://www.coursera.org/learn/neural-networks-deep-learning" rel="noopener ugc nofollow" target="_blank">吴恩达</a>的教程是一些非常有用的在线资料的例子。</p></div><div class="ab cl ie if go ig" role="separator"><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij"/></div><div class="ha hb hc hd he"><p id="4523" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">我个人认为一层网络相对容易理解，但是当层数增加时就变得棘手了。本文试图通过建造一个小操场来详细了解2层神经网络。我们甚至会在网上发布操场<a class="ae jv" href="https://nn-playground-app.herokuapp.com/" rel="noopener ugc nofollow" target="_blank"/>！为了充分享受这篇文章，读者必须熟悉1层神经网络的工作。</p></div><div class="ab cl ie if go ig" role="separator"><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij"/></div><div class="ha hb hc hd he"><p id="4b12" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">一层网络和二层网络的区别取决于下图:</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="ir is di it bf iu"><div class="er es il"><img src="../Images/0e42fee93b5ce08837b542b39aadc4a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XmdSX2P-_H5RppHPmL1_PQ.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">单层与双层</figcaption></figure><p id="fac7" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">2层神经网络具有由隐藏单元(神经元)组成的隐藏层。请注意，在计算层数时，通常会忽略输入层。</p><p id="0f66" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">为了深入理解1层，我强烈推荐吴恩达的教程以获得更多的细节，或者这篇<a class="ae jv" href="https://towardsdatascience.com/everything-you-need-to-know-about-neural-networks-and-backpropagation-machine-learning-made-easy-e5285bc2be3a" rel="noopener" target="_blank">文章</a>作为总结。</p><p id="e8fb" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">现在让我们更深入地了解两层网络的工作细节。</p><h1 id="5d48" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">两层神经网络</h1><p id="3047" class="pw-post-body-paragraph ix iy hh iz b ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ha bi translated">关于神经网络背后的数学，已经有大量的文章和资源，所以我不会说太多细节，而是专注于我认为最重要的几点。</p><p id="0300" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">为了简单起见，我们将使用二元分类来构建操场。因此，标签属于{0，1}。成本函数是:</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="ir is di it bf iu"><div class="er es ld"><img src="../Images/3ad512e8b103f89acee3e2b653af8f50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UyRFa2q_2PlgAMN4QIIptQ.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">二元分类的损失函数</figcaption></figure><p id="f62a" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">其中y是真正的标签，y_hat是它的估计值(概率)。</p><p id="631c" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">我们注意到，当y不等于y_hat时，损失函数减小，这是我们希望惩罚错误分类时所期望的。</p><p id="342a" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">正向传播允许基于权重计算损失函数:</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="ir is di it bf iu"><div class="er es le"><img src="../Images/60121dc7074ba39a5b2175187167d3b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iZK7sZmaAeb6QnbmXZlj7Q.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">正向传播</figcaption></figure><p id="c35b" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">正如我们在这里看到的，我们使用两组权重和偏差:</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="ir is di it bf iu"><div class="er es lf"><img src="../Images/2f71aa9f633200519dbcec46543c6409.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jdOpGuFvwyAns3zLZvVNFA.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">要更新的参数</figcaption></figure><p id="5bb2" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">然后，反向传播允许找到如何更新权重以最小化损失:</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="ir is di it bf iu"><div class="er es lg"><img src="../Images/bd700284c96f3287c85773b6e1f9615f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ID7sdxBhfoOI0RAIbDiOkA.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">反向传播</figcaption></figure><p id="b381" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">从损失的导数开始，由于链式法则，我们最终得到了告诉我们如何更新权重以最小化损失的表达式。</p><p id="8761" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">关于导数计算的全部细节，我在我的<a class="ae jv" href="https://savoga.github.io/machinelearning/neural-network/" rel="noopener ugc nofollow" target="_blank">网站</a>上写下了一切(希望我没有犯太多错误)。</p><h1 id="4838" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">构建应用程序</h1><p id="eb43" class="pw-post-body-paragraph ix iy hh iz b ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ha bi translated">该应用程序将允许用户提供两种类型的输入:</p><p id="6e3c" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">-数据的形状:斑点、圆圈或卫星</p><p id="af08" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">-神经网络中隐藏单元的数量</p><p id="ca4f" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">当然，这只是用户和神经网络之间可以进行的交互类型的一个例子。但是正如本文结论中所解释的，您可以添加更多的参数！</p><p id="e52b" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">为操场选择的图形库是plotly-dash。我个人是这个框架的忠实粉丝，因为<a class="ae jv" href="https://dash.plotly.com/" rel="noopener ugc nofollow" target="_blank">文档</a>相当完整，<a class="ae jv" href="https://community.plotly.com/c/dash/16" rel="noopener ugc nofollow" target="_blank">社区</a>非常活跃。</p><p id="e23f" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">开发应用程序时，将建模部分与图形部分分开是一个很好的做法。我们还将创建一个特定的模块来生成数据。最后，这个应用程序中有3个python脚本:</p><ul class=""><li id="1d2f" class="lh li hh iz b ja jb je jf ji lj jm lk jq ll ju lm ln lo lp bi translated">app.py:这个脚本创建了服务器并包含了图形部分的所有内容(按钮、标题等)。)</li><li id="7eeb" class="lh li hh iz b ja lq je lr ji ls jm lt jq lu ju lm ln lo lp bi translated">model.py:这里我们实现了神经网络本身！</li><li id="4e30" class="lh li hh iz b ja lq je lr ji ls jm lt jq lu ju lm ln lo lp bi translated">在这个模块中，我们根据用户的偏好来模拟数据</li></ul><h2 id="075a" class="lv kb hh bd kc lw lx ly kg lz ma mb kk ji mc md ko jm me mf ks jq mg mh kw mi bi translated">app.py</h2><p id="ce82" class="pw-post-body-paragraph ix iy hh iz b ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ha bi translated">该模块创建服务器并处理所有图形组件。我们指定文本、按钮和图形的位置。需要注意的是，我们对两个按钮使用了相同的函数(也称为“回调函数”)。事实上，dash似乎不允许用相同的输出处理不同的按钮。</p><h2 id="9682" class="lv kb hh bd kc lw lx ly kg lz ma mb kk ji mc md ko jm me mf ks jq mg mh kw mi bi translated">model.py</h2><p id="9e18" class="pw-post-body-paragraph ix iy hh iz b ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ha bi translated">在本模块中，我们构建神经网络逻辑。如前所述，我们希望从零开始构建它，以便我们了解正在发生的一切。</p><p id="2d4c" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">这里棘手的部分是与维度保持一致，尤其是在导数计算期间:</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="ir is di it bf iu"><div class="er es mj"><img src="../Images/335fb4e95b0595d954fb975f3e83f67e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Claf_MbrEQOTKovP7fND-Q.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">导数计算(链式法则的结果)</figcaption></figure><p id="2134" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">完整的代码可以在我的<a class="ae jv" href="https://github.com/savoga/nn-playground-from-scratch/blob/main/model.py" rel="noopener ugc nofollow" target="_blank"> Github repo </a>上找到。</p><h2 id="0d59" class="lv kb hh bd kc lw lx ly kg lz ma mb kk ji mc md ko jm me mf ks jq mg mh kw mi bi translated">utils.py</h2><p id="8c83" class="pw-post-body-paragraph ix iy hh iz b ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ha bi translated">我们将允许用户选择三种类型的数据形状:斑点，圆形和月亮。</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="ir is di it bf iu"><div class="er es mk"><img src="../Images/5fa30f55dc14779523dae8d5c8a3f85e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oBvf1iDYhd8W_P5BXTGClg.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">不同类型的数据形状</figcaption></figure><h1 id="e9d3" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">部署</h1><p id="3d23" class="pw-post-body-paragraph ix iy hh iz b ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ha bi translated">部署是通过<a class="ae jv" href="https://www.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a>完成的。部署的清晰步骤在<a class="ae jv" href="https://dash.plotly.com/deployment" rel="noopener ugc nofollow" target="_blank">这里</a>解释。正如链接中提到的，“Heroku是部署和管理公共Flask应用程序的最简单的平台之一。”。</p><p id="45fc" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">总而言之，部署包括将代码托管在Github repo中，然后使用以下命令通过Heroku进行部署:</p><figure class="im in io ip fd iq er es paragraph-image"><div class="er es ml"><img src="../Images/463d777e82849f04cb40d6852faacbde.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*Pc6tPnOn4NYMmL3K6YTO7g.png"/></div></figure><h1 id="ef78" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">关键见解</h1><p id="c209" class="pw-post-body-paragraph ix iy hh iz b ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ha bi translated">玩这个应用程序时，我们已经可以得出一些有趣的见解:</p><p id="7853" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">- 1隐藏单元仅通过一条线提供线性分隔。这在选择圆时尤其明显。</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="ir is di it bf iu"><div class="er es mm"><img src="../Images/06821a6f967027fb5b1f14f48640597c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jyjBhgTgdYAda9XGFzfcMg.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">带1个隐藏单元的分离</figcaption></figure><p id="0660" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">- 2隐藏单元通过两条线提供线性分离，从而允许更好的分离。</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="ir is di it bf iu"><div class="er es mn"><img src="../Images/382b0cff8fde85dcb02b079f7a59bbaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wo050BDjP8EscvzT1Wcu3Q.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">带2个隐藏单元的分离</figcaption></figure><p id="6d51" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">- 3个隐藏单位在形状不是凸面(月亮)时完美地分离数据。</p><figure class="im in io ip fd iq er es paragraph-image"><div role="button" tabindex="0" class="ir is di it bf iu"><div class="er es mo"><img src="../Images/1f1602cb4668f9946fb248c5865e41f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VPjLDbvPqgjkjoyQDx6ezA.png"/></div></div><figcaption class="jw jx et er es jy jz bd b be z dx translated">带3个隐藏单元的分离</figcaption></figure><p id="a1af" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">这说明了神经网络的力量。我们可以想象他们在识别人脸或指纹时有多好！</p><h1 id="c7a8" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">扩展ˌ扩张</h1><p id="d9d9" class="pw-post-body-paragraph ix iy hh iz b ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ha bi translated">扩展的可能性是无限的！您可以考虑添加复选框/按钮，以便用户可以选择:</p><p id="fe0a" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">-与数据生成相关的噪声(标准偏差)</p><p id="2e43" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">-要生成的数据点的数量</p><p id="1aae" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">-参数更新期间使用的学习率</p><p id="0e14" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">-层数</p><p id="435e" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">然而，对于最后一点，我认为它需要大量的工作，尤其是如果你不像我们在这里一样使用任何神经网络库(如tensorflow或pytorch)。</p><h1 id="bb9a" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">结论</h1><p id="cb80" class="pw-post-body-paragraph ix iy hh iz b ja ky jc jd je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ha bi translated">对于游乐场的最终版本，请查看<a class="ae jv" href="https://nn-playground-app.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">这个链接</a> ( <strong class="iz hi">编辑</strong>:这个项目已经不再维护了——一些库可能已经过时，导致链接无法正常工作)。所有代码都可以在我的<a class="ae jv" href="https://github.com/savoga/nn-playground-from-scratch/" rel="noopener ugc nofollow" target="_blank"> github repo </a>上获得。</p><p id="d15a" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">玩得开心！</p><p id="8cae" class="pw-post-body-paragraph ix iy hh iz b ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju ha bi translated">PS:这是我的第一篇关于媒体的文章，我很高兴得到你的反馈和/或评论:)</p></div></div>    
</body>
</html>