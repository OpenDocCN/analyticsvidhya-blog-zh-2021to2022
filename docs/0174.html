<html>
<head>
<title>Applying Multiple Linear Regression in house price prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多元线性回归在房价预测中的应用</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/applying-multiple-linear-regression-in-house-price-prediction-47dacb42942b?source=collection_archive---------3-----------------------#2021-01-07">https://medium.com/analytics-vidhya/applying-multiple-linear-regression-in-house-price-prediction-47dacb42942b?source=collection_archive---------3-----------------------#2021-01-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="d5ce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">多元线性回归</strong>是指一种统计技术，用于根据两个或多个变量的值来预测一个变量的结果。它有时简称为多元回归，是线性回归的延伸。我们要预测的变量称为因变量，而我们用来预测因变量的值的变量称为自变量或解释变量。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/b6029ce5b9e820e45c4d822979bfec3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*C7Eplo98ycdsUnuf.png"/></div></div></figure><p id="4cf8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">多元线性回归</strong>用于估计<strong class="ih hj">两个或多个自变量</strong>与<strong class="ih hj">一个因变量</strong>之间的关系。当您想知道以下内容时，可以使用多元线性回归:</p><ol class=""><li id="1949" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc ju jv jw jx bi translated">两个或多个自变量和一个因变量之间的关系有多强(例如，降雨量、温度和施肥量如何影响作物生长)。</li><li id="7424" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc ju jv jw jx bi translated">自变量的某个值处的因变量的值(例如，在一定的降雨量、温度和施肥水平下，作物的预期产量)。</li></ol><h1 id="ae0e" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">多元线性回归公式</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lb"><img src="../Images/bb38f44806aacc94f444acc7d74451fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/0*4yeAkOTfzfpMlzWt.png"/></div></figure><p id="5d38" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中:</p><ul class=""><li id="4c5b" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc lc jv jw jx bi translated"><strong class="ih hj"> yi </strong>是因变量或预测变量</li><li id="7177" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc lc jv jw jx bi translated"><strong class="ih hj"> β0 </strong>为y截距，即xi和x2均为0时y的值。</li><li id="589b" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc lc jv jw jx bi translated"><strong class="ih hj"> β1 </strong>和<strong class="ih hj"> β2 </strong>是回归系数，分别代表相对于<strong class="ih hj"> xi1 </strong>和<strong class="ih hj"> xi2 </strong>中一个单位变化的y变化。</li><li id="c5bd" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc lc jv jw jx bi translated">βp 是每个独立变量的斜率</li><li id="7db4" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc lc jv jw jx bi translated"><strong class="ih hj"> ϵ </strong>是模型的随机误差(残差)项。</li></ul><h1 id="f4e1" class="kd ke hi bd kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">多元线性回归的假设</h1><p id="f9c7" class="pw-post-body-paragraph if ig hi ih b ii ld ik il im le io ip iq lf is it iu lg iw ix iy lh ja jb jc hb bi translated">多元线性回归基于以下假设:</p><p id="d919" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 1。因变量和自变量之间的线性关系</strong></p><p id="7e03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2。自变量之间相关性不高</strong></p><p id="4c7a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。残差的方差是常数</strong></p><p id="8a0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 4。观察的独立性</strong></p><p id="6caa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，让我们看看如何使用多元线性回归算法实现房价预测。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es li"><img src="../Images/f21b5866ea9c15f5ec4f2c5ba2900108.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*FNj95_hdb5UQ1H8-"/></div></figure><p id="c284" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">导入库</strong></p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="e5ff" class="lo ke hi lk b fi lp lq l lr ls"># Import numpy and pandas package </span><span id="2a37" class="lo ke hi lk b fi lt lq l lr ls">import pandas as pd<br/>import numpy as np </span><span id="e834" class="lo ke hi lk b fi lt lq l lr ls"># Data visualization</span><span id="56d0" class="lo ke hi lk b fi lt lq l lr ls">from matplotlib import pyplot as plot<br/>import statsmodels.api as sm<br/>import seaborn as sns</span></pre><p id="b329" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">读取数据集</strong></p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="43b9" class="lo ke hi lk b fi lp lq l lr ls">data = pd.read_csv(r'Housing.csv')</span></pre><p id="f417" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据检查</strong></p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="b64a" class="lo ke hi lk b fi lp lq l lr ls">data.head(5)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lu"><img src="../Images/07b374069c2b88d5a8148112e18b1ab2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yjwq7JbwZrpivNQSR7mmYg.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">显示前5条记录</figcaption></figure><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="8664" class="lo ke hi lk b fi lp lq l lr ls">data.info()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lz"><img src="../Images/6cd869b9c81017b50565b563d57ecd43.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*r7_1SeUM4OiJwUvKGl76yA.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">阐释了列的数据类型定义</figcaption></figure><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="4106" class="lo ke hi lk b fi lp lq l lr ls">data.describe()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ma"><img src="../Images/9b2fedb454aabdd637944a81c487126b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*gHsupuQORuQXr3g5p6IMaQ.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">描述数据集的描述性统计数据</figcaption></figure><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="a78d" class="lo ke hi lk b fi lp lq l lr ls">data.shape()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mb"><img src="../Images/67839349a0342a1723c923cd73662fc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:206/format:webp/1*BoDBdgKx-AfGfU50hyPvKw.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">行和列的总数</figcaption></figure><p id="98f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据清理</strong></p><p id="80a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">检查数据集中是否存在空数据</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="bf4d" class="lo ke hi lk b fi lp lq l lr ls">data.isnull().sum()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mc"><img src="../Images/afbf8aefd6ae524ee6187babab35e76c.png" data-original-src="https://miro.medium.com/v2/resize:fit:416/format:webp/1*UmzZHt64cCuP4y60Tp0gSA.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">空()检查</figcaption></figure><p id="3842" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，数据集中没有空数据。似乎没有必要替换0值。</p><p id="a41f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">检测异常值</strong></p><blockquote class="md me mf"><p id="f317" class="if ig mg ih b ii ij ik il im in io ip mh ir is it mi iv iw ix mj iz ja jb jc hb bi translated">异常值是远远超出其他观察值的极端值。</p></blockquote><p id="8c2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建了单独的函数来检测数据集的异常值。这里使用了使用Seaborn库的箱线图。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="a3cd" class="lo ke hi lk b fi lp lq l lr ls">def detectOutliers():<br/>    fig, axs = plot.subplots(2,3, figsize = (10,5))<br/>    plt1 = sns.boxplot(data['price'], ax = axs[0,0])<br/>    plt2 = sns.boxplot(data['area'], ax = axs[0,1])<br/>    plt3 = sns.boxplot(data['bedrooms'], ax = axs[0,2])<br/>    plt1 = sns.boxplot(data['bathrooms'], ax = axs[1,0])<br/>    plt2 = sns.boxplot(data['stories'], ax = axs[1,1])<br/>    plt3 = sns.boxplot(data['parking'], ax = axs[1,2])<br/>    plot.tight_layout()</span><span id="692b" class="lo ke hi lk b fi lt lq l lr ls">detectOutliers()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mk"><img src="../Images/2180247a09c4d0821337ec47580f920e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SJi8NufRmUCNyXYdsuDDSg.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">离群点检测</figcaption></figure><p id="40ad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">价格和面积有相当大的异常值。下一步是丢弃离群值。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="93ff" class="lo ke hi lk b fi lp lq l lr ls"># Outlier reduction for price</span><span id="93e1" class="lo ke hi lk b fi lt lq l lr ls">plot.boxplot(data.price)<br/>Q1 = data.price.quantile(0.25)<br/>Q3 = data.price.quantile(0.75)<br/>IQR = Q3 - Q1<br/>data = data[(data.price &gt;= Q1 - 1.5*IQR) &amp; (data.price &lt;= Q3 + 1.5*IQR)]</span><span id="517e" class="lo ke hi lk b fi lt lq l lr ls"># Outlier reduction for area</span><span id="da5c" class="lo ke hi lk b fi lt lq l lr ls">plot.boxplot(data.area)<br/>Q1 = data.area.quantile(0.25)<br/>Q3 = data.area.quantile(0.75)<br/>IQR = Q3 - Q1<br/>data = data[(data.area &gt;= Q1 - 1.5*IQR) &amp; (data.area &lt;= Q3 + 1.5*IQR)]</span></pre><p id="fcb3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了验证异常值仍然存在，</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="2cb5" class="lo ke hi lk b fi lp lq l lr ls">detectOutliers()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ml"><img src="../Images/cc61ae287138f0b57736512f1e73a6ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xaizoVRaaTg6UQIul6iYOA.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">价格和面积中的异常值已移除</figcaption></figure><p id="a0c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据可视化</strong></p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="c36e" class="lo ke hi lk b fi lp lq l lr ls">sns.pairplot(data)<br/>plot.show()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mm"><img src="../Images/4a47816d27b954663dbccd300910ae9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k5KRk_xFSDDDSKmhU3ogTA.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">配对图</figcaption></figure><p id="2e27" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下一步可视化分类变量</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="9265" class="lo ke hi lk b fi lp lq l lr ls">plot.figure(figsize=(20, 12))<br/>plot.subplot(3,3,1)<br/>sns.boxplot(x='mainroad', y='price', data=data)<br/>plot.subplot(3,3,2)<br/>sns.boxplot(x='guestroom', y='price', data=data)<br/>plot.subplot(3,3,3)<br/>sns.boxplot(x='basement', y='price', data=data)<br/>plot.subplot(3,3,4)<br/>sns.boxplot(x='hotwaterheating', y='price', data=data)<br/>plot.subplot(3,3,5)<br/>sns.boxplot(x='airconditioning', y='price', data=data)<br/>plot.subplot(3,3,6)<br/>sns.boxplot(x='furnishingstatus', y='price', data=data)<br/>plot.show()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mn"><img src="../Images/b38231456d193f8530828f6d6eccaef3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H92PsyT_nw0GX0ud2rtuog.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">箱线图</figcaption></figure><p id="a396" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据准备</strong></p><p id="85ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如您所见，分类变量的数据包含是/否、半提供/未提供/提供。</p><p id="c5e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了使数据符合回归线，我们需要数字数据而不是字符串。所以，需要把那些字符串值转换成int。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="780d" class="lo ke hi lk b fi lp lq l lr ls">def toNumeric(x):<br/>    return x.map({"no":0,"yes":1})</span><span id="4f39" class="lo ke hi lk b fi lt lq l lr ls">def convert_binary():     <br/>    for column in list(data.select_dtypes(['object']).columns):<br/>        if(column != 'furnishingstatus'):<br/>            data[[column]] = data[[column]].apply(toNumeric)</span><span id="9b59" class="lo ke hi lk b fi lt lq l lr ls">convert_binary()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mo"><img src="../Images/64635eca9638bf5fed70e00cdce70c77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9bexfhdUYSIBVlCiqt0QeA.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">映射的是/否值</figcaption></figure><p id="922b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">接下来，将furnishingstatus列拆分为三个级别，即家具/未家具/半家具。为了实现对虚拟变量的需求</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="e7da" class="lo ke hi lk b fi lp lq l lr ls">status = pd.get_dummies(data['furnishingstatus'])<br/>status</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mp"><img src="../Images/c717357162abef120ca04f81fa0e5393.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*3eXeWK3gAWxa_2G_7BD9vA.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">虚拟变量</figcaption></figure><p id="c56f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，你不需要三列。您可以删除<code class="du mq mr ms lk b">furnished</code>栏，因为只需最后两栏即可识别家具的类型，其中</p><ul class=""><li id="dcce" class="jp jq hi ih b ii ij im in iq jr iu js iy jt jc lc jv jw jx bi translated"><code class="du mq mr ms lk b">00</code>将对应<code class="du mq mr ms lk b">furnished</code></li><li id="3a45" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc lc jv jw jx bi translated"><code class="du mq mr ms lk b">01</code>将对应<code class="du mq mr ms lk b">unfurnished</code></li><li id="469d" class="jp jq hi ih b ii jy im jz iq ka iu kb iy kc jc lc jv jw jx bi translated"><code class="du mq mr ms lk b">10</code>将对应于<code class="du mq mr ms lk b">semi-furnished</code></li></ul><p id="e140" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">删除第一列家具</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="29c4" class="lo ke hi lk b fi lp lq l lr ls">status = pd.get_dummies(data['furnishingstatus'], drop_first=True)</span></pre><p id="bef4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如下连接状态和主数据帧，</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="cde8" class="lo ke hi lk b fi lp lq l lr ls">data = pd.concat([data, status], axis=1)</span></pre><p id="b281" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">取消不再需要的色谱柱配置状态。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="f78e" class="lo ke hi lk b fi lp lq l lr ls">data.drop(columns='furnishingstatus',inplace=True)</span></pre><p id="3c68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">经过所有更改后，数据框看起来像这样</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mt"><img src="../Images/610cdb17c1f1de2d1e46c24d3cba5612.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1In2kmhb5QK3jdtGxMqvPQ.png"/></div></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">数据清理后</figcaption></figure><p id="9aca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">包括X数据框中除价格以外的字段。对于Y，只包括价格字段。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="d341" class="lo ke hi lk b fi lp lq l lr ls">Y = data.price</span><span id="5a4f" class="lo ke hi lk b fi lt lq l lr ls"># includes the fields other than prices<br/>X = data.iloc[:,1:]</span></pre><p id="b8af" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">多重共线性</strong></p><p id="7e1d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="mg">当回归模型中的两个或多个独立变量高度相关时，会出现多重共线性。</em></p><blockquote class="md me mf"><p id="d74a" class="if ig mg ih b ii ij ik il im in io ip mh ir is it mi iv iw ix mj iz ja jb jc hb bi translated">让我从我们的日常生活中举一个简单的例子来解释这一点。科林喜欢边嚼薯片边看电视。他看的电视越多，吃的薯条就越多，就越开心！</p><p id="cf29" class="if ig mg ih b ii ij ik il im in io ip mh ir is it mi iv iw ix mj iz ja jb jc hb bi translated">现在，如果我们可以量化快乐，并在科林忙着做他最喜欢的活动时测量他的快乐，你认为哪个会对他的快乐产生更大的影响？吃薯片还是看电视？这很难确定，因为当我们试图通过吃薯片来衡量科林的快乐时，他开始看电视。当我们试图通过看电视来衡量他的快乐时，他开始吃薯片。</p><p id="7ef5" class="if ig mg ih b ii ij ik il im in io ip mh ir is it mi iv iw ix mj iz ja jb jc hb bi translated">对科林来说，吃薯片和看电视是高度相关的，我们无法单独确定这些活动对他的快乐的影响。这就是多重共线性问题！</p></blockquote><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="886e" class="lo ke hi lk b fi lp lq l lr ls">from sklearn.preprocessing import MinMaxScaler<br/>from statsmodels.stats.outliers_influence import variance_inflation_factor<br/>def preprocessing(X):    <br/>    scaler = MinMaxScaler()<br/>    X_scaled = scaler.fit_transform(X)<br/>    variables = X_scaled<br/>    vif = pd.DataFrame()<br/>    vif["VIF"] = [variance_inflation_factor(variables, i) for i in range(variables.shape[1])]<br/>    vif["Features"] = X.columns<br/>    print(vif)</span></pre><p id="35f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过变量检查多重共线性是否存在，</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="ccd8" class="lo ke hi lk b fi lp lq l lr ls">preprocessing(X)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mu"><img src="../Images/8e57c7b18d07339717a0807e2c8cfe92.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*X4pdxoMFKlY32jf4VqXD3Q.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">多重共线性-I</figcaption></figure><p id="48f5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据经验，大于5的VIF值意味着非常严重的多重共线性。从以上结果来看，区域和卧室具有严重的共线性。</p><p id="1f9c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们需要删除这些列，并确认共线性仍然存在。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="e670" class="lo ke hi lk b fi lp lq l lr ls">X.drop(['area','bedrooms'], axis=1, inplace=True)<br/>preprocessing(X)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mv"><img src="../Images/a75f9ffada65a14400b49d6ab9514275.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*3lG00ir2E2FN9vM1zMRJWg.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">多重共线性-II</figcaption></figure><p id="9a32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最后，数据集中不存在多重共线性。因此，我们可以继续下一步，拆分训练集和测试集。</p><p id="3030" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">将数据分成训练集和测试集</strong></p><p id="adce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将X和Y应用于训练和测试数据集，各自的坐标为x_train &amp; x_test。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="d3d8" class="lo ke hi lk b fi lp lq l lr ls">from sklearn.model_selection import train_test_split<br/>x_train,x_test,y_train,y_test = train_test_split(X,Y,test_size = 0.25,random_state=355)</span></pre><p id="8fce" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建线性回归模型参考。使用参考值，用训练数据拟合直线。现在，为了提供训练，我们已经准备好了数据集，这意味着我们将使我们的回归模型适合训练集。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="a031" class="lo ke hi lk b fi lp lq l lr ls">from sklearn.linear_model import LinearRegression<br/>regression = LinearRegression()<br/>regression.fit(x_train,y_train)</span></pre><p id="dd9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作出预测</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="a63d" class="lo ke hi lk b fi lp lq l lr ls">y_predict = regression.predict(x_test)</span></pre><p id="9fe9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">绘制y_test和y_pred以了解价差。</p><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="ac0f" class="lo ke hi lk b fi lp lq l lr ls">plot.scatter(y_test,y_predict)<br/>fig.suptitle('y_test vs y_pred', fontsize=20)             <br/>plot.xlabel('y_test', fontsize=18)                        <br/>plot.ylabel('y_pred', fontsize=16)</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mw"><img src="../Images/0a4eea0f2477bc4cabfc2d7150579f14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*loDr-NrBk4TKOLotbxERnA.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">y_test vs y_pred</figcaption></figure><pre class="je jf jg jh fd lj lk ll lm aw ln bi"><span id="c5a3" class="lo ke hi lk b fi lp lq l lr ls">import statsmodels.api as sms<br/>model_1 = sms.OLS(y_train, x_train).fit()<br/>model_1.summary()</span></pre><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mx"><img src="../Images/e484705601444eb534cbb3030a3fc190.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*I2R5WQxOsli3XyqruBGeUg.png"/></div><figcaption class="lv lw et er es lx ly bd b be z dx translated">统计汇总</figcaption></figure><p id="302c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该模型具有更高的R平方值(0.954)，这意味着该模型解释了更多的方差，并为数据提供了更好的拟合。</p><p id="d2b6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望大家对如何实现多个自变量的线性回归模型有所了解。</p><p id="c953" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将在接下来的几天里赶上另一个有趣的话题。</p><p id="5825" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">快乐学习:)</p></div></div>    
</body>
</html>