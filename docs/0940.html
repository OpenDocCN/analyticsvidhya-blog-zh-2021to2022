<html>
<head>
<title>Analyze Global Air Pollution Using Apache Spark &amp; BigQuery</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Apache Spark &amp; BigQuery分析全球空气污染</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-analyze-global-air-quality-using-apache-spark-bigquery-7743fd54e634?source=collection_archive---------10-----------------------#2021-02-07">https://medium.com/analytics-vidhya/how-to-analyze-global-air-quality-using-apache-spark-bigquery-7743fd54e634?source=collection_archive---------10-----------------------#2021-02-07</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="3c83" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">如何在云上分析全球空气污染数据</h2></div><p id="b7b8" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">据世卫组织报道，每年有700万人死于接触污染空气中的细颗粒物，导致中风、心脏病、肺癌、慢性阻塞性肺病和包括肺炎在内的呼吸道感染。</p><p id="eed6" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">世界上91%的人口生活在空气质量超过世卫组织标准的地方。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es jt"><img src="../Images/a4a7466d344cb97186981177214b1410.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*OLuETKxNFYOX0KUuYKGmSA.png"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">2020年世界污染最严重国家(pm2.5)树形图</figcaption></figure><p id="162e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这里我们分析来自<a class="ae js" href="https://openaq.org/#/" rel="noopener ugc nofollow" target="_blank"> openaq </a>的全球空气质量数据:</p><ul class=""><li id="55d4" class="kf kg hh iy b iz ja jc jd jf kh jj ki jn kj jr kk kl km kn bi translated"><strong class="iy hi">使用<strong class="iy hi"> Apache Spark </strong>从openaq <a class="ae js" href="https://openaq-fetches.s3.amazonaws.com/index.html" rel="noopener ugc nofollow" target="_blank"> s3 </a>桶中提取</strong>并汇总全球历史空气污染数据</li><li id="7a30" class="kf kg hh iy b iz ko jc kp jf kq jj kr jn ks jr kk kl km kn bi translated"><strong class="iy hi">找出</strong>世界上污染最严重的城市和国家(以<a class="ae js" href="https://www.epa.gov/pm-pollution/particulate-matter-pm-basics" rel="noopener ugc nofollow" target="_blank"> PM2.5 </a>水平衡量)</li><li id="55c9" class="kf kg hh iy b iz ko jc kp jf kq jj kr jn ks jr kk kl km kn bi translated"><strong class="iy hi">计算</strong>空气质量指标的月、年平均值</li><li id="de0c" class="kf kg hh iy b iz ko jc kp jf kq jj kr jn ks jr kk kl km kn bi translated"><strong class="iy hi">可视化</strong>使用谷歌数据工作室，创建树形图和地理图</li><li id="8f05" class="kf kg hh iy b iz ko jc kp jf kq jj kr jn ks jr kk kl km kn bi translated">将所有openaq数据加载到<strong class="iy hi"> Bigquery </strong>中，并查找细节</li></ul><p id="3ba7" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iy hi">数据集</strong></p><p id="47ef" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这里我们使用的数据集来自<strong class="iy hi"/><a class="ae js" href="https://openaq.org/#/about" rel="noopener ugc nofollow" target="_blank"><strong class="iy hi">OpenAQ</strong></a>，在AWS <a class="ae js" href="https://openaq-fetches.s3.amazonaws.com/index.html" rel="noopener ugc nofollow" target="_blank"> s3 </a>上公开。</p><p id="5312" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">OpenAQ是一个非营利组织，通过协调、共享和使用OpenAQ数据，使全球社区能够净化空气。</p><div class="kt ku ez fb kv kw"><a href="https://registry.opendata.aws/openaq/" rel="noopener  ugc nofollow" target="_blank"><div class="kx ab dw"><div class="ky ab kz cl cj la"><h2 class="bd hi fi z dy lb ea eb lc ed ef hg bi translated">OpenAQ</h2><div class="ld l"><h3 class="bd b fi z dy lb ea eb lc ed ef dx translated">空气质量城市环境地理空间可持续性全球，从公共…</h3></div><div class="le l"><p class="bd b fp z dy lb ea eb lc ed ef dx translated">注册表. opendata.aws</p></div></div><div class="lf l"><div class="lg l lh li lj lf lk jz kw"/></div></div></a></div><p id="c879" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">OpenAQ平台测量以下污染物:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es ll"><img src="../Images/1e207f6c1e621ceb5698e2a6767565a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*JMj2rj2z6rE_CXaf2koeSg.png"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">来源:<a class="ae js" href="https://github.com/openaq/openaq-data-format" rel="noopener ugc nofollow" target="_blank">https://github.com/openaq/openaq-data-format</a></figcaption></figure><p id="7188" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这个项目中，我们将分析<strong class="iy hi"> PM2 </strong>。<strong class="iy hi"> 5 </strong>(直径小于2.5微米的颗粒)污染物，因为它是最危险的<a class="ae js" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4740125/#:~:text=raising%20worldwide%20concerns.-,PM2.,investigate%20the%20impact%20of%20PM2." rel="noopener ugc nofollow" target="_blank"> <strong class="iy hi"> * </strong> </a>。</p><p id="3d12" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iy hi">人生苦短RTFM:源代码</strong></p><p id="f6e2" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae js" href="https://github.com/ksree/world-air-quality" rel="noopener ugc nofollow" target="_blank">https://github.com/ksree/world-air-quality</a></p></div><div class="ab cl lm ln go lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ha hb hc hd he"><h1 id="4ff1" class="lt lu hh bd lv lw lx ly lz ma mb mc md in me io mf iq mg ir mh it mi iu mj mk bi translated"><strong class="ak">基础设施设置</strong></h1><p id="98d9" class="pw-post-body-paragraph iw ix hh iy b iz ml ii jb jc mm il je jf mn jh ji jj mo jl jm jn mp jp jq jr ha bi translated">我们将需要AWS凭证来读取公共S3桶，以及一个GCP帐户来分析谷歌云上的数据集。</p><ol class=""><li id="d57e" class="kf kg hh iy b iz ja jc jd jf kh jj ki jn kj jr mq kl km kn bi translated"><strong class="iy hi">创建AWS IAM用户凭证以读取亚马逊S3的NOAA数据</strong></li></ol><p id="a56f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果您没有AWS帐户，请注册<a class="ae js" href="https://aws.amazon.com/free/" rel="noopener ugc nofollow" target="_blank"> AWS免费层</a>，然后按照说明<a class="ae js" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users_create.html" rel="noopener ugc nofollow" target="_blank">创建IAM用户</a></p><p id="3f02" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">授予您的用户<a class="ae js" href="https://console.aws.amazon.com/iam/home?region=us-east-2#/policies/arn%3Aaws%3Aiam%3A%3Aaws%3Apolicy%2FAmazonS3ReadOnlyAccess" rel="noopener ugc nofollow" target="_blank"> AmazonS3ReadOnlyAccess </a></p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es mr"><img src="../Images/d15f6d079580de0bf562a366cdf726b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:46/0*dWEWhjOdoRPG6M1g"/></div></figure><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="er es ms"><img src="../Images/86c0375ea66e6106408aa2cacb6d4e55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tHpgeGdXJzQWv8R4.png"/></div></div></figure><p id="2035" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">为您的用户创建访问密钥。(记下您的<strong class="iy hi">访问密钥ID </strong>和<strong class="iy hi">秘密访问密钥。</strong>我们将向我们的spark工作提供这些凭据。)</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es mr"><img src="../Images/404dc064d932f406bf28458ddea634b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:46/0*O5ZRlrAqlhREGhKx"/></div></figure><p id="02f5" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iy hi"> 2。如果您没有GCP帐户，请创建一个帐户</strong></p><p id="fd8e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae js" href="https://cloud.google.com/free" rel="noopener ugc nofollow" target="_blank"> GCP免费等级——免费延长试用和永远免费|谷歌云</a></p><p id="5c74" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">一旦你注册并登录到GCP控制台。通过点击下面截图中突出显示的图标来激活云壳。Cloud Shell提供了对虚拟机实例的命令行访问，这是我们将要设置用例的地方。(或者，您也可以在笔记本电脑终端上完成此操作)</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es mr"><img src="../Images/05054fb293ca4fa1e96d1c8c174951b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:46/0*41NMLMZVRB_SvXNJ"/></div></figure><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es mx"><img src="../Images/f5136a656539d34048d8317c7af0e42e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/0*TQRwXYZWN0Hqd0-s.png"/></div></figure><p id="4f7a" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">GCP控制台</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es mr"><img src="../Images/ecf844aef3bb91f7b0adbe181389bf50.png" data-original-src="https://miro.medium.com/v2/resize:fit:46/0*cjjyKPXWfeU2EPkW"/></div></figure><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="er es my"><img src="../Images/ca796dc49bd3ed65a06b4bf4e6fca81c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9W5zzf3xxzpS3M5e.png"/></div></div></figure><p id="ee2a" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">谷歌云外壳</p><p id="1709" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在我们已经有了AWS和GCP证书，让我们开始吧。</p><p id="ed11" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iy hi"> 3。建立你的GCP数据湖</strong></p><p id="67f5" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">要设置我们的GCP环境，我们需要:</p><ul class=""><li id="6037" class="kf kg hh iy b iz ja jc jd jf kh jj ki jn kj jr kk kl km kn bi translated">创建项目</li><li id="87fb" class="kf kg hh iy b iz ko jc kp jf kq jj kr jn ks jr kk kl km kn bi translated">启用计费(仍在免费层)</li><li id="244d" class="kf kg hh iy b iz ko jc kp jf kq jj kr jn ks jr kk kl km kn bi translated">启用Dataproc和BigQuery服务</li><li id="bd8a" class="kf kg hh iy b iz ko jc kp jf kq jj kr jn ks jr kk kl km kn bi translated">创建一个谷歌云存储桶</li><li id="fc01" class="kf kg hh iy b iz ko jc kp jf kq jj kr jn ks jr kk kl km kn bi translated">创建大查询数据集</li><li id="6808" class="kf kg hh iy b iz ko jc kp jf kq jj kr jn ks jr kk kl km kn bi translated">创建一个Dataproc集群</li></ul><p id="6ed9" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">要建立您的GCP数据湖，请在您的google cloud shell上执行以下命令</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="mz na l"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">GCP服务设置命令</figcaption></figure></div><div class="ab cl lm ln go lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ha hb hc hd he"><h1 id="3c20" class="lt lu hh bd lv lw lx ly lz ma mb mc md in me io mf iq mg ir mh it mi iu mj mk bi translated"><strong class="ak">读取聚合并将OpenAQ数据加载到BigQuery </strong></h1><ol class=""><li id="193f" class="kf kg hh iy b iz ml jc mm jf nb jj nc jn nd jr mq kl km kn bi translated"><strong class="iy hi">构建并打包spark应用程序</strong></li></ol><p id="d47d" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在您的云shell中执行以下脚本</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="dd0c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">验证生成的应用程序配置文件，该文件应包含您的AWS密钥和密码:</p><pre class="ju jv jw jx fd ne nf ng nh aw ni bi"><span id="5ee0" class="nj lu hh nf b fi nk nl l nm nn">cat $HOME/application.conf</span></pre><p id="8659" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">检查您的AWS密钥和密码。开始日期和结束日期是我们将从openAQ中提取的数据集的范围。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es no"><img src="../Images/0f40fa24175be93d192b423a004585a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*iwA58i5TQfDd2WDPidwBJA.png"/></div></figure><p id="a14c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iy hi"> 2。提交Dataproc作业，将数据聚集并加载到BigQuery </strong></p><p id="426b" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">要在Dataproc上提交spark作业，请执行下面的命令</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="d292" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">完成4年的历史openaq空气质量数据的加载和聚合需要7分钟。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="er es np"><img src="../Images/fe3e142e271ff5edff19bb0102e2689c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1xUZoE31UNqzfgve7-4OpA.png"/></div></div></figure><p id="a7f4" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在我们已经将数据加载到BigQuery中，让我们看一看。</p></div><div class="ab cl lm ln go lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ha hb hc hd he"><h1 id="d58f" class="lt lu hh bd lv lw lx ly lz ma mb mc md in me io mf iq mg ir mh it mi iu mj mk bi translated"><strong class="ak"> OpenAQ </strong> <strong class="ak">数据集洞察</strong></h1><p id="37e0" class="pw-post-body-paragraph iw ix hh iy b iz ml ii jb jc mm il je jf mn jh ji jj mo jl jm jn mp jp jq jr ha bi translated">转到BigQuery控制台，查看新创建的表</p><p id="2e85" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">数据集的预览应该如下所示:</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="er es nq"><img src="../Images/88065df66a7fcb10e32bd8b89a88a474.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S05T3dAw78zRkxSCD1uARg.png"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">OpenAQ pm2.5数据集</figcaption></figure><p id="0365" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">【2020年全球污染最严重城市(pm2.5) </p><pre class="ju jv jw jx fd ne nf ng nh aw ni bi"><span id="2c6a" class="nj lu hh nf b fi nk nl l nm nn">SELECT city, country, yearly_avg, Jan, Feb, March, April, May, June, July, Aug, Sept, Oct, Nov, Dec<br/>FROM   `world-air-quality-openaq.openaq.pm25_global`<br/>WHERE  year = 2020<br/>ORDER  BY yearly_avg DESC</span></pre><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="mz na l"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">2020年100大污染城市(PM2.5)</figcaption></figure><p id="54d9" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iy hi">污染最严重的国家</strong></p><p id="1cae" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">2020年和2019年的年平均值</p><pre class="ju jv jw jx fd ne nf ng nh aw ni bi"><span id="a080" class="nj lu hh nf b fi nk nl l nm nn">SELECT <br/>      country,<br/>      TRUNC(AVG(IF(year = 2019, yearly_avg, NULL)), 2) AS `AVG_2019`,<br/>      TRUNC(AVG(IF(year = 2020, yearly_avg, NULL)), 2) AS `AVG_2020`<br/>FROM `kapilsreed12-1dataflow.OpenAirAQ.pm25_global`<br/>GROUP BY country<br/>HAVING AVG_2020 IS NOT NULL  AND  AVG_2019  IS NOT NULL  <br/>ORDER BY AVG_2020 DESC</span></pre><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="mz na l"/></div></figure><p id="a8ab" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iy hi">数据工作室可视化:</strong></p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="er es nr"><img src="../Images/5665769df155773532d370bef53faf2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XzQxBi9MBvin7a1BRtpGaQ.png"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">2020年PM2.5年平均值地理图</figcaption></figure><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="er es ns"><img src="../Images/d27e369c1a52ffb82d40762bbf25f473.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7lquQQlQSVcmB7ZOolc2NQ.png"/></div></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">2020年pm2.5年平均值的谷歌地图视图</figcaption></figure><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es jt"><img src="../Images/a4a7466d344cb97186981177214b1410.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*OLuETKxNFYOX0KUuYKGmSA.png"/></div><figcaption class="kb kc et er es kd ke bd b be z dx translated">2020年世界污染最严重国家的树状图</figcaption></figure></div><div class="ab cl lm ln go lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ha hb hc hd he"><h1 id="da97" class="lt lu hh bd lv lw lx ly lz ma mb mc md in me io mf iq mg ir mh it mi iu mj mk bi translated">概述</h1><p id="297a" class="pw-post-body-paragraph iw ix hh iy b iz ml ii jb jc mm il je jf mn jh ji jj mo jl jm jn mp jp jq jr ha bi translated">我们是这样做的:</p><ol class=""><li id="d1c2" class="kf kg hh iy b iz ja jc jd jf kh jj ki jn kj jr mq kl km kn bi translated">使用<strong class="iy hi"> Apache Spark </strong>，我们连接到AWS S3托管的OpenAQ数据集，应用聚合，并用地理信息增强数据集。最后，我们<strong class="iy hi">将这个数据集加载到BigQuery </strong>中</li><li id="b23c" class="kf kg hh iy b iz ko jc kp jf kq jj kr jn ks jr mq kl km kn bi translated"><strong class="iy hi">使用<strong class="iy hi"> BigQuery </strong>获得关于全球PM2.5污染物的洞察</strong></li><li id="7cde" class="kf kg hh iy b iz ko jc kp jf kq jj kr jn ks jr mq kl km kn bi translated"><strong class="iy hi">用<strong class="iy hi">数据工作室</strong>可视化</strong>几个数据点<strong class="iy hi"> </strong></li></ol><p id="ce9f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这个博客的目标是展示如何使用云和开源工具来探索这个大型数据集并从中获得洞察力。</p><p id="d1c0" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">创造和分享你自己的见解。</p></div></div>    
</body>
</html>