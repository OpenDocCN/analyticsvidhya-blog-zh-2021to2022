<html>
<head>
<title>What breed do you look like ?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你看起来像什么品种？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/what-dog-breed-do-you-look-like-a1ade21c70e6?source=collection_archive---------10-----------------------#2021-09-12">https://medium.com/analytics-vidhya/what-dog-breed-do-you-look-like-a1ade21c70e6?source=collection_archive---------10-----------------------#2021-09-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="99b4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你听过狗和主人长得很像的说法吗？让我们看看卷积神经网络是否能看出这一点。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/a5d1807d91b9886d81621b76ebebd878.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ID4xoeJYfLqsYGF5L28kvQ.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated"><a class="ae js" href="https://unsplash.com/photos/K4mSJ7kc0As" rel="noopener ugc nofollow" target="_blank"> <strong class="bd jt">等待？…什么？</strong>T3】</a></figcaption></figure><h1 id="b26b" class="ju jv hh bd jt jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">项目定义</h1><p id="5ef0" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">关于狗和它们主人的有趣事实:根据BBC<a class="ae js" href="https://www.bbc.com/future/article/20151111-why-do-dogs-look-like-their-owners" rel="noopener ugc nofollow" target="_blank">2015年发表的文章</a>，狗看起来像它们的主人是一个科学事实。如果你花足够的时间在公园散步，你最终会看到一只和它的主人很像的狗。现在，让我们看看深度学习算法是否可以正确识别品种，然后看看它的主人是否真的看起来像他们的狗品种。</p><p id="44ba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们在这个项目中涉及到两个主要问题。首先，是从传递给神经网络算法的图片中识别它是否是一只狗及其品种。第二，如果它不是一只狗而是一个人，那么预测最接近的狗的品种。</p><ul class=""><li id="db3b" class="kw kx hh ig b ih ii il im ip ky it kz ix la jb lb lc ld le bi translated">为了解决问题的第一部分，我们首先构建一个简单的卷积神经网络(CNN)架构，但这导致了较低的准确性。然后，我们求助于迁移学习方法，使用<a class="ae js" href="https://s3-us-west-1.amazonaws.com/udacity-aind/dog-project/DogResnet50Data.npz" rel="noopener ugc nofollow" target="_blank"> ResNet-50 </a>的瓶颈特性，这显著提高了准确性。迁移学习的主要思想是，人们可以很容易地重用预先训练的特征，并用自己的数据重新训练分类部分。</li><li id="ab60" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb lb lc ld le bi translated">对于问题的第二部分，我们使用OpenCV实现的<a class="ae js" href="http://docs.opencv.org/trunk/d7/d8b/tutorial_py_face_detection.html" rel="noopener ugc nofollow" target="_blank">基于Haar特征的级联分类器</a>来检测图像中的人脸。OpenCV提供了许多预先训练好的人脸检测器，作为XML文件存储在<a class="ae js" href="https://github.com/opencv/opencv/tree/master/data/haarcascades" rel="noopener ugc nofollow" target="_blank"> github </a>上。</li></ul><h2 id="9cf4" class="lk jv hh bd jt ll lm ln jz lo lp lq kd ip lr ls kh it lt lu kl ix lv lw kp lx bi translated">公制的</h2><p id="a621" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">下面定义了一些指标，这些指标可以由模型计算出来，在评估性能时会有所帮助。</p><ul class=""><li id="b0da" class="kw kx hh ig b ih ii il im ip ky it kz ix la jb lb lc ld le bi translated"><strong class="ig hi">准确度</strong>是正确分类的例子的百分比</li><li id="03c4" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb lb lc ld le bi translated"><strong class="ig hi">假</strong>阴性(FN)和<strong class="ig hi">假</strong>阳性(FP)是被<strong class="ig hi">错误</strong>分类的样本</li><li id="8bce" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb lb lc ld le bi translated"><strong class="ig hi">真</strong>阴性(TN)和<strong class="ig hi">真</strong>阳性(TP)是被<strong class="ig hi">正确</strong>分类的样本</li><li id="92af" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb lb lc ld le bi translated"><strong class="ig hi">精度</strong>是被正确分类的<strong class="ig hi">预测</strong>阳性的百分比:</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ly"><img src="../Images/edf365c92b8a62ac45fe8be6e151f013.png" data-original-src="https://miro.medium.com/v2/resize:fit:310/format:webp/1*oVYHTA6F_9J0zRkI_ZwY5g.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">精确</figcaption></figure><ul class=""><li id="9914" class="kw kx hh ig b ih ii il im ip ky it kz ix la jb lb lc ld le bi translated"><strong class="ig hi"> Recall </strong>是正确分类的<strong class="ig hi">实际</strong>阳性的百分比:</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lz"><img src="../Images/a5915b61db74ebce187f35188afc6fca.png" data-original-src="https://miro.medium.com/v2/resize:fit:318/format:webp/1*ln2szYpwWIrB-YjDTvW0Yg.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">回忆</figcaption></figure><ul class=""><li id="a687" class="kw kx hh ig b ih ii il im ip ky it kz ix la jb lb lc ld le bi translated"><strong class="ig hi"> F1 </strong>是精度和召回率的加权平均值</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ma"><img src="../Images/92b539015893af402bc61ce8a4e829af.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*SR04v-sZdmNRRxBIzJIvVQ.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">F1分数</figcaption></figure><p id="1b52" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">注意:</strong>由于犬只的等级略有不平衡，准确性对于这个问题并不是一个有用的衡量标准。你可以在这个项目上有99.8%以上的准确率，只要一直预测错误。因此，为了确保我们对我们的模型做出正确的决策，我们将查看上面提到的所有指标。</p><h1 id="66af" class="ju jv hh bd jt jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">分析</h1><p id="4567" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">本项目使用的数据由Udacity提供。</p><p id="4370" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">总共有133种狗。<br/>总共有8351张狗的图片。</p><p id="9b1c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">训练狗图像有6680个。<br/>有835个验证狗图像。<br/>有836张测试狗图片。</p><p id="a633" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">还有…</p><p id="84db" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">总共有13233个人像。</p><p id="9810" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下表显示了每类的一些样本。正如你所看到的，这些班级是不平衡的。其中最低数量的样本对应于挪威buhund和Xoloitzcuintli (33个样本)，最高数量的样本对应于阿拉斯加雪橇犬(96个样本)。</p><pre class="jd je jf jg fd mb mc md me aw mf bi"><span id="0ccf" class="lk jv hh mc b fi mg mh l mi mj">Index    Breed                                    Number     <br/>1        Affenpinscher                            80        <br/>2        Afghan_hound                             73        <br/>3        Airedale_terrier                         65        <br/>4        Akita                                    79        <br/>5        Alaskan_malamute                         96        <br/>6        American_eskimo_dog                      80        <br/>7        American_foxhound                        63        <br/>8        American_staffordshire_terrier           82        <br/>9        American_water_spaniel                   42        <br/>10       Anatolian_shepherd_dog                   62        <br/>11       Australian_cattle_dog                    83        <br/>12       Australian_shepherd                      83        <br/>13       Australian_terrier                       58        <br/>14       Basenji                                  86        <br/>15       Basset_hound                             92        <br/>16       Beagle                                   74        <br/>17       Bearded_collie                           77        <br/>18       Beauceron                                63        <br/>19       Bedlington_terrier                       60        <br/>20       Belgian_malinois                         78        <br/>21       Belgian_sheepdog                         80        <br/>22       Belgian_tervuren                         59        <br/>23       Bernese_mountain_dog                     81        <br/>24       Bichon_frise                             77        <br/>25       Black_and_tan_coonhound                  46        <br/>26       Black_russian_terrier                    51        <br/>27       Bloodhound                               80        <br/>28       Bluetick_coonhound                       44        <br/>29       Border_collie                            93        <br/>30       Border_terrier                           65        <br/>31       Borzoi                                   70        <br/>32       Boston_terrier                           81        <br/>33       Bouvier_des_flandres                     56        <br/>34       Boxer                                    80        <br/>35       Boykin_spaniel                           66        <br/>36       Briard                                   81        <br/>37       Brittany                                 62        <br/>38       Brussels_griffon                         71        <br/>39       Bull_terrier                             87        <br/>40       Bulldog                                  66        <br/>41       Bullmastiff                              86        <br/>42       Cairn_terrier                            79        <br/>43       Canaan_dog                               62        <br/>44       Cane_corso                               80        <br/>45       Cardigan_welsh_corgi                     66        <br/>46       Cavalier_king_charles_spaniel            84        <br/>47       Chesapeake_bay_retriever                 67        <br/>48       Chihuahua                                68        <br/>49       Chinese_crested                          63        <br/>50       Chinese_shar-pei                         62        <br/>51       Chow_chow                                78        <br/>52       Clumber_spaniel                          61        <br/>53       Cocker_spaniel                           59        <br/>54       Collie                                   71        <br/>55       Curly-coated_retriever                   63        <br/>56       Dachshund                                82        <br/>57       Dalmatian                                89        <br/>58       Dandie_dinmont_terrier                   63        <br/>59       Doberman_pinscher                        59        <br/>60       Dogue_de_bordeaux                        75        <br/>61       English_cocker_spaniel                   76        <br/>62       English_setter                           66        <br/>63       English_springer_spaniel                 66        <br/>64       English_toy_spaniel                      49        <br/>65       Entlebucher_mountain_dog                 53        <br/>66       Field_spaniel                            41        <br/>67       Finnish_spitz                            42        <br/>68       Flat-coated_retriever                    79        <br/>69       French_bulldog                           64        <br/>70       German_pinscher                          59        <br/>71       German_shepherd_dog                      78        <br/>72       German_shorthaired_pointer               60        <br/>73       German_wirehaired_pointer                52        <br/>74       Giant_schnauzer                          51        <br/>75       Glen_of_imaal_terrier                    55        <br/>76       Golden_retriever                         80        <br/>77       Gordon_setter                            54        <br/>78       Great_dane                               50        <br/>79       Great_pyrenees                           74        <br/>80       Greater_swiss_mountain_dog               57        <br/>81       Greyhound                                70        <br/>82       Havanese                                 76        <br/>83       Ibizan_hound                             58        <br/>84       Icelandic_sheepdog                       62        <br/>85       Irish_red_and_white_setter               46        <br/>86       Irish_setter                             66        <br/>87       Irish_terrier                            82        <br/>88       Irish_water_spaniel                      64        <br/>89       Irish_wolfhound                          66        <br/>90       Italian_greyhound                        73        <br/>91       Japanese_chin                            71        <br/>92       Keeshond                                 55        <br/>93       Kerry_blue_terrier                       44        <br/>94       Komondor                                 55        <br/>95       Kuvasz                                   61        <br/>96       Labrador_retriever                       54        <br/>97       Lakeland_terrier                         62        <br/>98       Leonberger                               57        <br/>99       Lhasa_apso                               53        <br/>100      Lowchen                                  42        <br/>101      Maltese                                  60        <br/>102      Manchester_terrier                       36        <br/>103      Mastiff                                  72        <br/>104      Miniature_schnauzer                      53        <br/>105      Neapolitan_mastiff                       39        <br/>106      Newfoundland                             62        <br/>107      Norfolk_terrier                          58        <br/>108      Norwegian_buhund                         33        <br/>109      Norwegian_elkhound                       56        <br/>110      Norwegian_lundehund                      41        <br/>111      Norwich_terrier                          55        <br/>112      Nova_scotia_duck_tolling_retriever       67        <br/>113      Old_english_sheepdog                     49        <br/>114      Otterhound                               44        <br/>115      Papillon                                 79        <br/>116      Parson_russell_terrier                   38        <br/>117      Pekingese                                60        <br/>118      Pembroke_welsh_corgi                     66        <br/>119      Petit_basset_griffon_vendeen             39        <br/>120      Pharaoh_hound                            49        <br/>121      Plott                                    35        <br/>122      Pointer                                  40        <br/>123      Pomeranian                               55        <br/>124      Poodle                                   62        <br/>125      Portuguese_water_dog                     42        <br/>126      Saint_bernard                            37        <br/>127      Silky_terrier                            51        <br/>128      Smooth_fox_terrier                       38        <br/>129      Tibetan_mastiff                          60        <br/>130      Welsh_springer_spaniel                   55        <br/>131      Wirehaired_pointing_griffon              37        <br/>132      Xoloitzcuintli                           33        <br/>133      Yorkshire_terrier                        38</span></pre><h1 id="d4a8" class="ju jv hh bd jt jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">方法学</h1><p id="564a" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">在这一节中，我们主要关注用于犬种分类的CNN架构。</p><p id="64d7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我们继续讨论CNN架构之前，为CNN输入准备数据有几个重要步骤。</p><ul class=""><li id="28cf" class="kw kx hh ig b ih ii il im ip ky it kz ix la jb lb lc ld le bi translated">当使用TensorFlow作为后端时，Keras CNN需要一个4D数组(又名4D张量)作为输入，带有shape (nb_samples，rows，columns，channels)，其中<code class="du mk ml mm mc b">nb_samples</code>是图像的总数，<code class="du mk ml mm mc b">rows</code>、<code class="du mk ml mm mc b">columns</code>、<code class="du mk ml mm mc b">channels</code>分别对应每张图像的行数、列数和通道数。</li><li id="b30c" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb lb lc ld le bi translated">为Keras中的任何预训练模型准备好4D张量，需要一些额外的处理。首先，通过对通道重新排序，将RGB图像转换为BGR图像。所有预训练模型都有额外的归一化步骤，即必须从每个图像的每个像素中减去平均像素(用RGB表示为[103.939，116.779，123.68]，并根据ImageNet中所有图像的所有像素计算得出)。这在导入的函数<code class="du mk ml mm mc b">preprocess_input</code>中实现。</li></ul><p id="a290" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们有了一种方法来格式化我们的图像，以提供给Keras中任何预先训练的模型，我们现在准备使用该模型来提取预测。这是通过<code class="du mk ml mm mc b">predict</code>方法完成的，该方法返回一个数组，该数组的𝑖-th条目是模型预测的图像属于𝑖-th ImageNet类别的概率。如果我们要使用ResNet-50作为预训练模型，这将在下面的<code class="du mk ml mm mc b">ResNet50_predict_labels</code>函数中实现。</p><p id="5bc7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通过获取预测概率向量的argmax，我们获得了与模型的预测对象类别相对应的整数，我们可以通过使用这个<a class="ae js" href="https://gist.github.com/yrevar/942d3a0ac09ec9e5eb3a" rel="noopener ugc nofollow" target="_blank">字典</a>来识别对象类别。</p><p id="000e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在查看<a class="ae js" href="https://gist.github.com/yrevar/942d3a0ac09ec9e5eb3a" rel="noopener ugc nofollow" target="_blank">字典</a>时，您会注意到对应于狗的类别以不间断的顺序出现，并对应于字典关键字151-268，包括从<code class="du mk ml mm mc b">'Chihuahua'</code>到<code class="du mk ml mm mc b">'Mexican hairless'</code>的所有类别。因此，为了检查预训练的ResNet-50模型是否预测图像包含狗，我们只需要检查上面的<code class="du mk ml mm mc b">ResNet50_predict_labels</code>函数是否返回151和268之间(包括151和268)的值。</p><h1 id="b217" class="ju jv hh bd jt jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结果</h1><p id="b1f4" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated"><strong class="ig hi">模型架构</strong></p><p id="84f6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们创建了两个模型。一个从零开始使用基本的朴素架构，另一个我们使用来自Keras的预训练的ResNet-50模型，并添加一些层来适应我们的问题。</p><h2 id="35a5" class="lk jv hh bd jt ll lm ln jz lo lp lq kd ip lr ls kh it lt lu kl ix lv lw kp lx bi translated"><strong class="ak">朴素的建筑</strong></h2><p id="4a02" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">有2D卷积层，一个辍学和最大池层。最后，在我们使用密集层来获得图像的输出标签之前，我们应用一个平坦层。</p><pre class="jd je jf jg fd mb mc md me aw mf bi"><span id="149e" class="lk jv hh mc b fi mg mh l mi mj">_________________________________________________________________<br/>Layer (type)                 Output Shape              Param #   <br/>=================================================================<br/>conv2d_1 (Conv2D)            (None, 223, 223, 16)      208       <br/>_________________________________________________________________<br/>max_pooling2d_2 (MaxPooling2 (None, 111, 111, 16)      0         <br/>_________________________________________________________________<br/>conv2d_2 (Conv2D)            (None, 110, 110, 32)      2080      <br/>_________________________________________________________________<br/>max_pooling2d_3 (MaxPooling2 (None, 55, 55, 32)        0         <br/>_________________________________________________________________<br/>conv2d_3 (Conv2D)            (None, 54, 54, 64)        8256      <br/>_________________________________________________________________<br/>max_pooling2d_4 (MaxPooling2 (None, 27, 27, 64)        0         <br/>_________________________________________________________________<br/>flatten_2 (Flatten)          (None, 46656)             0         <br/>_________________________________________________________________<br/>dense_1 (Dense)              (None, 200)               9331400   <br/>_________________________________________________________________<br/>dropout_1 (Dropout)          (None, 200)               0         <br/>_________________________________________________________________<br/>dense_2 (Dense)              (None, 133)               26733     <br/>=================================================================<br/>Total params: 9,368,677<br/>Trainable params: 9,368,677<br/>Non-trainable params: 0<br/>_________________________________________________________________</span></pre><p id="0629" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">朴素的建筑经过20个时代的训练。然后，我们在以前看不到的数据上测试这个简单的模型。这些指标的预测结果是:</p><pre class="jd je jf jg fd mb mc md me aw mf bi"><span id="12cf" class="lk jv hh mc b fi mg mh l mi mj">loss :  4.27126574516<br/>acc :  0.0777511974021<br/>precision :  0.0837320488606<br/>recall :  0.00478468906651<br/>f1 :  0.00901012775002</span></pre><p id="0cd9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个挺低的，不靠谱。朴素模型在大约2个时期后也开始显著过度拟合，并且不能对验证数据进行概括。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mn"><img src="../Images/1921f4d33279d89355ebbd05eaf73903.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xhb1D92Xq62gzUG6hgcocw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">交叉熵与历元数</figcaption></figure><p id="ee69" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是，我们可以使用Keras中的预训练模型来优化和提高测试预测精度。</p><p id="c3b4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> ResNet-50架构</strong></p><p id="89b9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了定制ResNet-50来解决我们的问题，我们添加了一个密集层来获得133类狗，对于优化器，这次我们使用Adam优化器，并将学习速率降低到10e-5。</p><pre class="jd je jf jg fd mb mc md me aw mf bi"><span id="25db" class="lk jv hh mc b fi mg mh l mi mj">_________________________________________________________________<br/>Layer (type)                 Output Shape              Param #   <br/>=================================================================<br/>global_average_pooling2d_2 ( (None, 2048)              0         <br/>_________________________________________________________________<br/>dense_4 (Dense)              (None, 133)               272517    <br/>=================================================================<br/>Total params: 272,517<br/>Trainable params: 272,517<br/>Non-trainable params: 0<br/>_________________________________________________________________</span></pre><p id="1fbf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们也为这个模型训练了20个时期。与朴素模型相比，这种迁移学习模型对测试数据的准确性要高得多。我们能够在以前看不到的数据上获得更高的指标分数。</p><pre class="jd je jf jg fd mb mc md me aw mf bi"><span id="708a" class="lk jv hh mc b fi mg mh l mi mj">loss :  0.62373913518<br/>acc :  0.821770344339<br/>precision :  0.856132680149<br/>recall :  0.788277515099<br/>f1 :  0.819878099923</span></pre><p id="4c86" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了比较naive模型和ResNet-50的性能，我们显示了损失函数与历元数的关系，其中我们用蓝色绘制naive模型，用绿色绘制ResNet-50模型。此外，我们还使用与ResNet-50相同的层测试了VGG-16的迁移学习，并在此以橙色绘制。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mn"><img src="../Images/896b228b7b193c86658b95ba179cd289.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DzhlUDit7ZZfaJhxEeCHOg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">所有模型的交叉熵与历元数</figcaption></figure><p id="a5f6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从上面的图中可以看出，ResNet-50模型表现非常好。我们还可以通过在训练模型时查看其他指标来确认这一点。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mo"><img src="../Images/8dd3bb88fdbe8dd29e4ed89f89d7310c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AHIqIG4CI92zpu6KbmPn3Q.png"/></div></div></figure><p id="89ff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，我们能够使用ResNet-50在指标上获得最佳结果。让我们实际看看一些狗图像的预测结果。在从网上下载了随机选择的狗的图片后，我们想检查我们的模型实际上预测狗的品种有多好。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mp"><img src="../Images/4ae62a2af863526eebeb2b0d4905dbbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*n-bMiXNhLFPM59AA6FSoDA.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">ResNet-50说它是约克夏梗</figcaption></figure><p id="044e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">根据维基百科的页面，它确实是一只约克夏梗或者简称为约克)</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mq"><img src="../Images/891d5f6fd51ad6ad0139deacde777d5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I3WnFIqmaJ6oOOnEqEKneQ.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">维基百科上的约克夏梗</figcaption></figure><p id="2835" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对狗的又一个品种预测。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mr"><img src="../Images/28efd279b5572b609736d96773d9f534.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*KQiSpbvHyQ8EfCwAFp7aBQ.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">ResNet-50说你是吉娃娃</figcaption></figure><p id="5e61" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是一张来自维基百科的吉娃娃的照片</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ms"><img src="../Images/3dd3c6981fbeb22caa45cad074d9cde4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5_P0sLrKtnveGuPdyX4LCQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">维基百科上的吉娃娃</figcaption></figure><p id="1105" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">总的来说，这个模型在大多数时候都能预测正确的品种。现在让我们看看一些狗和它们的主人，只是为了好玩。图片摘自这篇<a class="ae js" href="https://lzpetnanny.wordpress.com/2010/04/09/is-it-true-dogs-and-their-owners-look-alike/" rel="noopener ugc nofollow" target="_blank">文章</a>。左边是一只狗，右边是狗的主人。</p><div class="jd je jf jg fd ab cb"><figure class="mt jh mu mv mw mx my paragraph-image"><img src="../Images/5eec8b7009f247834a64ae7a80397f53.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/format:webp/1*Qkohzuzv7hRUA1b0VY4OPQ.png"/></figure><figure class="mt jh mz mv mw mx my paragraph-image"><img src="../Images/7ef715a2313d410a98550a67d6adfba9.png" data-original-src="https://miro.medium.com/v2/resize:fit:406/format:webp/1*tCnTTYoRH635paAt5bqiZQ.png"/><figcaption class="jo jp et er es jq jr bd b be z dx na di nb nc translated">一只狗和它的主人</figcaption></figure></div><p id="8d06" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">好的，所以我们的模型预测了狗的正确品种，是<a class="ae js" href="https://en.wikipedia.org/wiki/Italian_Greyhound" rel="noopener ugc nofollow" target="_blank">意大利灰狗</a>。然而，我们的模型认为意大利灰狗的主人看起来像切萨皮克湾寻回犬，这是从下图中你可以决定他实际上是否像我们的模型预测的品种。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es nd"><img src="../Images/ad5b226d2cbc29375654706b92c4a1ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKV91Q3V8LarJIDKRJ6QWg.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated"><a class="ae js" href="https://www.thesprucepets.com/chesapeake-bay-retriever-full-profile-history-and-care-4693502" rel="noopener ugc nofollow" target="_blank">切萨皮克湾寻回犬</a></figcaption></figure><p id="c1d8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">再来看一个。</p><div class="jd je jf jg fd ab cb"><figure class="mt jh ne mv mw mx my paragraph-image"><img src="../Images/7df5b7c92ed58e157518641985b2cd82.png" data-original-src="https://miro.medium.com/v2/resize:fit:418/format:webp/1*dJ3Syyac4L9BjB3zaMauWg.png"/></figure><figure class="mt jh nf mv mw mx my paragraph-image"><img src="../Images/f8313e5fb559af4c2195e1981392d3d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/1*SPNk8c8sdhLyYo6LC3fBmA.png"/><figcaption class="jo jp et er es jq jr bd b be z dx ng di nh nc translated">一只狗和它的主人</figcaption></figure></div><p id="1984" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，模型再次做出正确的预测，那就是<a class="ae js" href="https://en.wikipedia.org/wiki/English_Cocker_Spaniel" rel="noopener ugc nofollow" target="_blank">英国可卡犬</a>，我们的模型认为狗的主人长得像<a class="ae js" href="https://en.wikipedia.org/wiki/Cavalier_King_Charles_Spaniel" rel="noopener ugc nofollow" target="_blank">骑士查理王犬</a>。那离英国可卡犬不远。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ms"><img src="../Images/7cafd4c8ce0ca7314b0945b91615081c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1hHXkgVcWTd49NkLHGq7jA.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated"><a class="ae js" href="https://en.wikipedia.org/wiki/Cavalier_King_Charles_Spaniel" rel="noopener ugc nofollow" target="_blank">骑士查理王猎犬</a></figcaption></figure><h1 id="d608" class="ju jv hh bd jt jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq bi translated">结论</h1><p id="3f55" class="pw-post-body-paragraph ie if hh ig b ih kr ij ik il ks in io ip kt ir is it ku iv iw ix kv iz ja jb ha bi translated">使用来自ResNet-50的预先训练的瓶颈特征，我们能够节省时间来构建我们自己的图像识别模型。通过迁移学习，我们可以实现更好的准确性(朴素模型约6%的准确性和ResNet-50 ~ 83%的准确性),但它可以进一步提高，也许有了更好的准确性，模型将能够更好地预测长得像他们的狗的人的品种。虽然，我们可能会考虑对这类问题采取不同的方法；)</p><ol class=""><li id="9742" class="kw kx hh ig b ih ii il im ip ky it kz ix la jb ni lc ld le bi translated">数据扩充</li><li id="a2aa" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb ni lc ld le bi translated">狗的特殊特征</li><li id="3d5a" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb ni lc ld le bi translated">平衡数据集</li><li id="d9e5" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb ni lc ld le bi translated">用不同的时期数和批量大小进行训练。</li><li id="a075" class="kw kx hh ig b ih lf il lg ip lh it li ix lj jb ni lc ld le bi translated">调整超参数(学习率、优化器、密集层中的节点数)</li></ol><p id="bcf7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你想自己看看代码，或者添加一些细节，你可以在我的Github <a class="ae js" href="https://github.com/SabrinaAL/ML_Projects_Collection/tree/master/dog_app" rel="noopener ugc nofollow" target="_blank">个人资料</a>中找到这个笔记本。</p></div></div>    
</body>
</html>