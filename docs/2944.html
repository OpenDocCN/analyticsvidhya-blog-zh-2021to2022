<html>
<head>
<title>Customer Segmentation with K-Mean Clustering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于K均值聚类的客户细分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/customer-segmentation-with-k-mean-clustering-852203e18ab7?source=collection_archive---------4-----------------------#2021-05-27">https://medium.com/analytics-vidhya/customer-segmentation-with-k-mean-clustering-852203e18ab7?source=collection_archive---------4-----------------------#2021-05-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/dbee61a93fefa559ab3d9e1958139279.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qxHSR7XeQAYrCn6n.gif"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated"><a class="ae it" href="https://www.datacamp.com/community/tutorials/cluster-analysis-in-tableau" rel="noopener ugc nofollow" target="_blank">https://www . data camp . com/community/tutorials/cluster-analysis-in-tableau</a></figcaption></figure><p id="bd29" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">本文总结了BOTNOI关于客户细分主题的数据科学基础课程的内容。我们将研究来自michelecoscia.com的超市数据集，并使用无监督的机器学习技术:K均值聚类</p><blockquote class="js jt ju"><p id="6d23" class="iu iv jv iw b ix iy iz ja jb jc jd je jw jg jh ji jx jk jl jm jy jo jp jq jr ha bi translated"><strong class="iw hi">无监督学习</strong>是一种机器学习技术，其中用户不需要监督模型。相反，它允许模型自己发现以前未被发现的模式和信息。它主要处理未标记的数据。</p></blockquote><p id="7e8c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在开始之前，让我们回顾一下K-means算法。</p><p id="bf61" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">K-均值算法的工作原理。</p><p id="cb58" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">第1步</strong>—选择聚类数k</p><p id="e7ee" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">步骤2</strong>——从数据中选择K个随机点作为质心。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div class="er es jz"><img src="../Images/8507c91f75603010153d3a983811e922.png" data-original-src="https://miro.medium.com/v2/resize:fit:484/format:webp/1*Guh2YVC4QHxqjB0HxAg1DQ.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">在这种情况下，K = 3</figcaption></figure><p id="cbe6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">步骤3</strong>—接下来是集群分配步骤。将每个数据点分配给它们最接近的聚类质心。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div class="er es jz"><img src="../Images/5f602e7597987a5c1b58e1d9fcd21527.png" data-original-src="https://miro.medium.com/v2/resize:fit:484/format:webp/1*jj8l3g8Cn4cGGFU9tVqKOw.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">分配步骤</figcaption></figure><p id="622b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">步骤4</strong>—质心被移动到与其相关的数据的平均位置。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div class="er es ke"><img src="../Images/08ea847963e5232beedeb970b1eec0aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:488/format:webp/1*2EdRHW5quNZ5yIXY0U4v3Q.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">质心移动到新位置</figcaption></figure><p id="b6f1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">步骤5</strong>——重复步骤3和4，直到</p><ul class=""><li id="9c85" class="kf kg hh iw b ix iy jb jc jf kh jj ki jn kj jr kk kl km kn bi translated">新形成的簇的质心不会改变</li><li id="2a81" class="kf kg hh iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">点保持在同一个群集中</li><li id="432c" class="kf kg hh iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">达到最大迭代次数</li></ul><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kt"><img src="../Images/c9a4a1390cb2dddc1e5bce02b59461d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zMvpB5lXkmi6jj0PrYVLAw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">摘自吴恩达的机器学习教程</figcaption></figure><p id="e621" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，我们将进入数据集</p><p id="29e2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们的机器学习管道:</p><ol class=""><li id="b7c2" class="kf kg hh iw b ix iy jb jc jf kh jj ki jn kj jr ku kl km kn bi translated">检索数据</li><li id="254b" class="kf kg hh iw b ix ko jb kp jf kq jj kr jn ks jr ku kl km kn bi translated">数据预处理</li><li id="cf9b" class="kf kg hh iw b ix ko jb kp jf kq jj kr jn ks jr ku kl km kn bi translated">特征工程</li><li id="00e3" class="kf kg hh iw b ix ko jb kp jf kq jj kr jn ks jr ku kl km kn bi translated">建模</li><li id="b2f9" class="kf kg hh iw b ix ko jb kp jf kq jj kr jn ks jr ku kl km kn bi translated">形象化</li><li id="9ee4" class="kf kg hh iw b ix ko jb kp jf kq jj kr jn ks jr ku kl km kn bi translated">解释</li></ol><h1 id="9fe2" class="kv kw hh bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated"><strong class="ak"> 1。获取数据</strong></h1><p id="88b9" class="pw-post-body-paragraph iu iv hh iw b ix lt iz ja jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr ha bi translated">首先，我们需要从michelecoscia.com下载数据集。在这种情况下，我们可以使用命令！在google colab下载数据集。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ly"><img src="../Images/7bfd32a2cd98745eb84b802b81abe76c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ciYG3-T8hk7KDCIQ0Sr8ug.png"/></div></div></figure><h1 id="5a29" class="kv kw hh bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">2.数据预处理</h1><blockquote class="js jt ju"><p id="333c" class="iu iv jv iw b ix iy iz ja jb jc jd je jw jg jh ji jx jk jl jm jy jo jp jq jr ha bi translated"><strong class="iw hi">数据预处理</strong>是一种<strong class="iw hi">数据</strong>挖掘技术，包括将原始<strong class="iw hi">数据</strong>转换成可理解的格式。真实世界的<strong class="iw hi">数据</strong>通常是不完整的、不一致的和/或缺少某些行为或趋势，并且可能包含许多错误。<strong class="iw hi">数据预处理</strong>是解决此类问题的有效方法。</p></blockquote><p id="712c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">导入必要的库，然后读泡菜。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ly"><img src="../Images/f388dbc89a7985f6fdd4fbc5bd3db10a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6kcAX7ChjCb1zPMhwIDSqw.png"/></div></div></figure><p id="f39c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们来看看数据集！选择5个样品进行检验。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div class="er es lz"><img src="../Images/9d946f7a19727d93b59d959948bf8db6.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*QzcApKmb22gd8knH-ncaeg.png"/></div></figure><ul class=""><li id="d199" class="kf kg hh iw b ix iy jb jc jf kh jj ki jn kj jr kk kl km kn bi translated">df_purchases根据product_id(他们买了什么)、shop_id(哪个商店)和数量记录了每个客户的交易</li><li id="3067" class="kf kg hh iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">df_distances记录了购买者和商店id之间的距离</li><li id="99fa" class="kf kg hh iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">df_prices记录了每种产品的价格</li></ul><p id="d6c5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">然后我们检查他们每个人的信息。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div class="er es ma"><img src="../Images/2e6d1f478c50f1e13e00e77c4534aeaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*ROISBbO6Bd9YrV-pLfQZQg.png"/></div></figure><p id="e425" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">正如我们所看到的，这个数据集非常有组织，准备充分，并且没有空值，所以我们不需要应用太多的数据预处理步骤。</p><p id="5f0f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们也可以看到这个数据集是巨大的。df_purchases数据帧有24，638，724个条目。</p><p id="0bac" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，让我们将所有三个数据帧合并在一起，以进行后续步骤。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mb"><img src="../Images/201cd6dc1404f7c9b5af41d70d420ed6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ehMiGv4OCWymPTUz_MbqjQ.png"/></div></div></figure><p id="342c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们还为总价添加了新的列“amount”和“cnt_txn ”,以跟踪交易的数量。</p><p id="1ff9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们检查一下新的数据框。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mc"><img src="../Images/db15ed26ce6b5f572c7b3c2823759e13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GtFbUdpPC4yuo_EBPD0zOQ.png"/></div></div></figure><p id="1a52" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">并且，检查基本的统计数据。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es md"><img src="../Images/7a77fbeac11abad4fb7c40fea8d7f5e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vyn7irG6y3BkZVGwyTiikQ.png"/></div></div></figure><p id="b659" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，我们检查独特客户、产品和商店的数量。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div class="er es me"><img src="../Images/bed19f681d9bebf9641688e76bb8f5ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*VxIWfDHyxthnJiTQLWEIow.png"/></div></figure><h1 id="3043" class="kv kw hh bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">3.特征工程</h1><p id="0f73" class="pw-post-body-paragraph iu iv hh iw b ix lt iz ja jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr ha bi translated">在我们理解了数据集，将它们合并在一起，并创建了新的列之后，是时候进行特性工程了。</p><blockquote class="mf"><p id="9dac" class="mg mh hh bd mi mj mk ml mm mn mo jr dx translated">特征工程的目标仅仅是让你的数据更好地适应手头的问题。</p><p id="1f61" class="mg mh hh bd mi mj mk ml mm mn mo jr dx translated">考虑“表观温度”的措施，如热指数和风寒指数。这些量试图根据空气温度、湿度和风速来测量人类感知的温度，这些都是我们可以直接测量的。你可以认为表观温度是一种特征工程的结果，这种工程试图使观察到的数据与我们真正关心的事情更相关:外面的实际感觉如何！</p><p id="0ac7" class="mg mh hh bd mi mj mk ml mm mn mo jr dx translated">您可以执行特征工程来:</p><p id="fca9" class="mg mh hh bd mi mj mk ml mm mn mo jr dx translated">-提高模型的预测性能</p><p id="0d16" class="mg mh hh bd mi mj mk ml mm mn mo jr dx translated">-减少计算或数据需求</p><p id="f425" class="mg mh hh bd mi mj mk ml mm mn mo jr dx translated">-提高结果的可解释性</p></blockquote><blockquote class="js jt ju"><p id="a552" class="iu iv jv iw b ix mq iz ja jb mr jd je jw ms jh ji jx mt jl jm jy mu jp jq jr ha bi translated"><em class="hh">你使用的功能比其他任何东西都更能影响结果。没有哪种算法单独，据我所知，可以补充正确的</em> <strong class="iw hi"> <em class="hh">特征工程</em> </strong> <em class="hh">给出的信息增益。</em></p><p id="730f" class="iu iv jv iw b ix iy iz ja jb jc jd je jw jg jh ji jx jk jl jm jy jo jp jq jr ha bi translated"><em class="hh"> —卢卡·马萨隆</em></p></blockquote><p id="d33c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将使用数据透视表创建一个新功能，并查看每个顾客为每个商店支付的金额。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mv"><img src="../Images/e861c17314426ca9174d7bcdef34b6d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xActDbGL1z7kAZnOY_U3AQ.png"/></div></div></figure><p id="a371" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">而且，为了简单起见，我们将更改列的名称，以便更容易读取和合并到其他数据帧。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mw"><img src="../Images/50961d031e820f8f040857564d74e496.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m0T50nWsiBAWfXZKL3hcxw.png"/></div></div></figure><p id="0cad" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将把nan值替换为0，以便能够创建其他重要的特性。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div class="er es mx"><img src="../Images/966b06ff35fcd3be33d29118d62cfdee.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*e90xXZbOfMOpokHXV1h3aw.png"/></div></figure><p id="186e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">创建另一个功能来计算每个客户为所有商店支付的平均金额。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div class="er es my"><img src="../Images/7e74612ae44cbc311066ed880897c9da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*c1oOBSAePFh2v2w3oy4O5A.png"/></div></figure><p id="4ee4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，我们可以像这样继续添加一个新特性，但最好是为此创建一个函数。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div class="er es mz"><img src="../Images/1935dc7a18445b520240ed5af7d14b6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*cNWe-_ej_bVlZu746rZ6GQ.png"/></div></figure><p id="daa0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">创建新的相关要素。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es na"><img src="../Images/0466c25caccc231be270d91d611805ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SQYyZ1nJcRMmnRXzsK7Nvw.png"/></div></div></figure><p id="9427" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们现在可以调用函数并检查是否有空值。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div class="er es nb"><img src="../Images/5d922bc9ed2ee924ea404b63742a49a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*QuEXijWTLdTu3sPkUE0TvQ.png"/></div></figure><p id="2466" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们检查数据帧的一些列。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nc"><img src="../Images/a6ec577dec903a1fdf00d09b2e1317f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UUnHZj3S0vMTH-mS2l1Aeg.png"/></div></div></figure><p id="7f86" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最初，有6个功能。现在，总共有44个功能，足以提高机器学习模型的性能。下一步是标准化数据，因为数字的范围相当大。</p><p id="f3da" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="jv">标准化:缩放特征，使分布以0为中心，标准偏差为1 (-1，1) </em></p><p id="6264" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="jv">new _ data =(data—data . mean())/data . STD()</em></p><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nd"><img src="../Images/1e7884545115021d2b61412f6411118b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*InIIknAoyYmZskIoub9kRw.png"/></div></div></figure><h1 id="0dcd" class="kv kw hh bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">4.建模</h1><p id="e7b6" class="pw-post-body-paragraph iu iv hh iw b ix lt iz ja jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr ha bi translated">我们的数据集现在可以用于机器学习技术了。在这种情况下，我们将使用K-Means算法。问题是我们如何决定使用多少个集群？</p><p id="102e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在K均值聚类中，我们可以应用<a class="ae it" href="https://en.wikipedia.org/wiki/Elbow_method_(clustering)#:~:text=In%20cluster%20analysis%2C%20the%20elbow,number%20of%20clusters%20to%20use." rel="noopener ugc nofollow" target="_blank">肘法</a>来选择K个数的聚类。</p><p id="d028" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">以下代码运行从k=2到k=16的循环，并附加惯性得分或类内平方和(WCSS)。然后画出惯性对簇数的曲线图</p><blockquote class="js jt ju"><p id="e97d" class="iu iv jv iw b ix iy iz ja jb jc jd je jw jg jh ji jx jk jl jm jy jo jp jq jr ha bi translated">WCSS或惯性是所有聚类中的每个数据点到它们各自质心的距离的平方和。</p></blockquote><figure class="ka kb kc kd fd ii er es paragraph-image"><div class="er es ne"><img src="../Images/3bf76613320529f453e9f419be42e192.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*HjCKWI_LKdRfRPZyxkZA8w.png"/></div></figure><figure class="ka kb kc kd fd ii er es paragraph-image"><div class="er es nf"><img src="../Images/e9b6dc586c5a96717e1cf2f9c3794382.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*6SOppKM1LLiWMX8wR5QwGA.png"/></div></figure><p id="5b29" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们可以通过查看或使用下面的方法来估计图形的最大转折点，从而选择群集的数量。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div class="er es ng"><img src="../Images/b9d7a7704f60ef07101fafe71682bafd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/0*BZV4urLMEZWqczdo.png"/></div></figure><p id="e971" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这个公式可以计算到直线的最长距离的距离</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nh"><img src="../Images/f0b774a74990fb0ed3c0c7238bc4ebf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y6l_7Ocd-ZR9eLB8eyk-Yg.png"/></div></div></figure><p id="f4d1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">另一种方法是计算<a class="ae it" href="https://dzone.com/articles/kmeans-silhouette-score-explained-with-python-exam" rel="noopener ugc nofollow" target="_blank">的剪影分数</a></p><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/02ac68491054207128c7006458ba4b59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XBgtDCunXuDuVYew1gsWlw.png"/></div></div></figure><p id="dbe2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">绘制侧影得分图。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div class="er es ni"><img src="../Images/c0193dbb764a50ea118105ec8fe7a3b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*2GZVNhkazU3gB2_vx-OaVg.png"/></div></figure><p id="f20a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">关于剪影配乐的一些事实</p><ul class=""><li id="f886" class="kf kg hh iw b ix iy jb jc jf kh jj ki jn kj jr kk kl km kn bi translated">轮廓分数为1意味着簇非常密集并且很好地分离。分数为0意味着聚类是重叠的。分数小于0意味着属于聚类的数据可能是错误的/不正确的。</li></ul><p id="f29e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因此，6到9之间的集群数是我们的最佳选择！</p><p id="1855" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">是时候运行K均值算法了！</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nj"><img src="../Images/d254ee13b04c41dbee3c0ace03ea38ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P3PFpKnKLPEH5iR1Xez4Dw.png"/></div></div></figure><p id="51e9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">看看结果！</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nk"><img src="../Images/a40059e72c5a45b59b4ee29e62f1b14b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FRPJPbMd4vyHxvSkMffv7A.png"/></div></div></figure><p id="3333" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，我们的数据帧中每行又多了一列预测聚类</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div class="er es nl"><img src="../Images/c8a0f0a1363474ab43b21be9b85b861c.png" data-original-src="https://miro.medium.com/v2/resize:fit:176/format:webp/1*QbLYAdtvnfnaGKJQZFdjrw.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">示例分类预测列</figcaption></figure><p id="9b0b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">绘制条形图以找出每个分类中的客户数量。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div class="er es nm"><img src="../Images/af10ee3bd8e9b0057301d5fb62c68d3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*1TkoOI55YkRE-WHD9LRZUg.png"/></div></figure><p id="ae2b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">结果是大多数客户都在第一个集群中。接下来，我们将进行数据可视化流程。</p><h1 id="5890" class="kv kw hh bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">5.数据可视化</h1><p id="2064" class="pw-post-body-paragraph iu iv hh iw b ix lt iz ja jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr ha bi translated">由于我们的数据框架有44个特征，人类不可能看到44维的数据，所以我们需要应用<a class="ae it" href="https://en.wikipedia.org/wiki/Principal_component_analysis" rel="noopener ugc nofollow" target="_blank"> PCA </a>(主成分分析)，这是一种降低维数的技术。</p><blockquote class="js jt ju"><p id="85e0" class="iu iv jv iw b ix iy iz ja jb jc jd je jw jg jh ji jx jk jl jm jy jo jp jq jr ha bi translated">PCA用于<a class="ae it" href="https://en.wikipedia.org/wiki/Exploratory_data_analysis" rel="noopener ugc nofollow" target="_blank">探索性数据分析</a>和制作<a class="ae it" href="https://en.wikipedia.org/wiki/Predictive_modeling" rel="noopener ugc nofollow" target="_blank">预测模型</a>。它通常用于<a class="ae it" href="https://en.wikipedia.org/wiki/Dimensionality_reduction" rel="noopener ugc nofollow" target="_blank">维度缩减</a>，通过将每个数据点仅投影到前几个主成分上来获得低维数据，同时尽可能多地保留数据的变化。第一主分量可以等效地定义为使投影数据的方差最大化的方向。</p></blockquote><figure class="ka kb kc kd fd ii er es paragraph-image"><div class="er es nn"><img src="../Images/721bd51f75b603c7370bc3537495c457.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*albOqr5rTYp8CHfHfoCIPg.png"/></div></figure><p id="84b2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下一步，我们将计算所有分类中每个列的平均值，以查看每个分类中的差异。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es no"><img src="../Images/c627be53243c15a0e232ec703aa79b45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cVk2tpHtDS1tQ0E2z4ZL8Q.png"/></div></div></figure><p id="787e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">然后，如果我们能看到顾客在每个独特的商店和距离的货币使用的差异，我们也许能看到顾客行为的差异。</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es np"><img src="../Images/0aaa48c82a61d14d176ac59dfdbf4d5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KG0_q7bXG-ZarsA7ObdVEg.png"/></div></div></figure><p id="3792" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">堆叠集群、商店id和总金额以进行可视化</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es np"><img src="../Images/8ead9085803c49b994880a475e614d14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G8rTluc4o1WQkvSAXZ74Sw.png"/></div></div></figure><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nq"><img src="../Images/eaf6f4b1ce2e4039674d90422f1e9254.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B7OUsrCjzqn7JfJA2DhfOg.png"/></div></div></figure><p id="c09e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">从这个图表中我们知道了什么？</p><ul class=""><li id="fb69" class="kf kg hh iw b ix iy jb jc jf kh jj ki jn kj jr kk kl km kn bi translated">聚类0:大多数客户从shop _ id5 &gt; shop _ id1 &gt; shop _ id2 &gt; shop _ ID3 &gt; shop _ id4购买产品</li><li id="7661" class="kf kg hh iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">聚类1:该组客户中没有多少金钱交易</li><li id="950e" class="kf kg hh iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">聚类2:大多数顾客从shop _ id1 &gt; shop _ id2 &gt; shop _ ID3 &gt; shop _ id5 &gt; shop _ id4购买产品</li><li id="d9c8" class="kf kg hh iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">聚类3:大多数客户从shop_id1和shop_id2购买产品</li><li id="950a" class="kf kg hh iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">聚类4:大多数客户从shop_id2和shop_id1购买产品</li><li id="e350" class="kf kg hh iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">聚类5:大多数顾客从shop _ ID3 &gt; shop _ id1 &gt; shop _ id2 &gt; shop _ id5 &gt; shop _ id4购买产品</li><li id="8e35" class="kf kg hh iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">第6类:该类客户中没有多少金钱交易。</li><li id="ed8c" class="kf kg hh iw b ix ko jb kp jf kq jj kr jn ks jr kk kl km kn bi translated">聚类7:大多数顾客从shop_id4 &gt; shop_id1 &gt; shop_id2购买产品</li></ul><p id="5b32" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">绘制雷达图以获得更详细的可视化效果</p><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es nr"><img src="../Images/67493228bae21bf9bbe4bb6a20cde41c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TxJ0HwCPkaZstzMozkzMkQ.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">完整详细的代码将在谷歌colab链接:)</figcaption></figure><div class="ka kb kc kd fd ab cb"><figure class="ns ii nt nu nv nw nx paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/c1da1f9e11e23e19da50ea7fe95e31c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*R4W7xORUQMOoMvDV_eCM3A.png"/></div></figure><figure class="ns ii ny nu nv nw nx paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/d144cf2157e488cb17862c5f7b36a798.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*huCRvxXgY-eQ1uPcckfuTA.png"/></div></figure><figure class="ns ii nz nu nv nw nx paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/83f4026dc7511038ca57d433f11bba9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*WMHGLDvy6HNZ6Puks4_DvA.png"/></div></figure></div><div class="ab cb"><figure class="ns ii oa nu nv nw nx paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/4698e9a48b32262ef9ccf51d3a92f648.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*Y7L7o82dm6VCM45iTYPFQA.png"/></div></figure><figure class="ns ii ob nu nv nw nx paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/b19e69a52fcbb66ffed4fc0bc5596eaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*quahgJSMd1IPcX-g241y7w.png"/></div></figure><figure class="ns ii oc nu nv nw nx paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/93bfc25a086ae5072891d32682dd883b.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*V1G0Shw8Bd8J1P79Qs7-Ng.png"/></div></figure></div><div class="ab cb"><figure class="ns ii od nu nv nw nx paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/0ae2da582a8509f63942c3e5e8e77102.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*bTIjftmQiSJIGMvTp6CICw.png"/></div></figure><figure class="ns ii oe nu nv nw nx paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><img src="../Images/8b0057dfc87d53fb94e5268ec1dc8ed5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*JnRPVR_XbdPx2yyZ-9m7qQ.png"/></div></figure></div><figure class="ka kb kc kd fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es of"><img src="../Images/df314ece4f8091ce76f36a695c960b34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2gvGAeMG5FClmaCM8ru-fg.png"/></div></div></figure><h2 id="62ee" class="og kw hh bd kx oh oi oj lb ok ol om lf jf on oo lj jj op oq ln jn or os lr ot bi translated">结论</h2><p id="d926" class="pw-post-body-paragraph iu iv hh iw b ix lt iz ja jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr ha bi translated">K-Mean算法用于无标记数据的无监督学习。该算法适用于小数据集到大数据集的聚类。</p><p id="b1a1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们能够通过对不同的客户群进行聚类来深入了解数据，并看到每个聚类的消费行为。如果我们计划增加一家新商店或者将我们从数据集学到的东西应用于商业目的，这是非常有价值的。</p><h2 id="f9a9" class="og kw hh bd kx oh oi oj lb ok ol om lf jf on oo lj jj op oq ln jn or os lr ot bi translated">参考链接</h2><p id="29c9" class="pw-post-body-paragraph iu iv hh iw b ix lt iz ja jb lu jd je jf lv jh ji jj lw jl jm jn lx jp jq jr ha bi translated"><em class="jv"/><a class="ae it" href="https://www.guru99.com/unsupervised-machine-learning.html#:~:text=Summary,two%20types%20of%20Unsupervised%20learning" rel="noopener ugc nofollow" target="_blank"><em class="jv">https://www . guru 99 . com/unsupervised-machine-learning . html #:~:text = Summary，two % 20 types % 20 of % 20 unsupervised % 20 learning</em></a><em class="jv">。</em></p><p id="36b6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><em class="jv">【2】</em><a class="ae it" href="https://www.kaggle.com/ryanholbrook/what-is-feature-engineering" rel="noopener ugc nofollow" target="_blank"><em class="jv">https://www . ka ggle . com/ryanholbrook/what-is-feature-engineering</em></a></p><p id="e2b7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae it" href="https://dzone.com/articles/kmeans-silhouette-score-explained-with-python-exam" rel="noopener ugc nofollow" target="_blank"><em class="jv">https://dzone . com/articles/k means-silhouette-score-explained-with-python-exam</em></a></p><div class="ou ov ez fb ow ox"><a href="https://stanford.edu/class/engr108/visualizations/kmeans/kmeans.html" rel="noopener  ugc nofollow" target="_blank"><div class="oy ab dw"><div class="oz ab pa cl cj pb"><h2 class="bd hi fi z dy pc ea eb pd ed ef hg bi translated">可视化K-均值聚类</h2><div class="pe l"><h3 class="bd b fi z dy pc ea eb pd ed ef dx translated">均方点-质心距离:尚未计算$k$-means算法是一种用于聚类和分析的迭代方法</h3></div><div class="pf l"><p class="bd b fp z dy pc ea eb pd ed ef dx translated">stanford.edu</p></div></div></div></a></div><p id="e8c8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">谷歌Colab链接</strong></p><div class="ou ov ez fb ow ox"><a href="https://colab.research.google.com/drive/1gjt-lGijLWtYLSUCy49rlTQkNs7bkq6U?usp=sharing" rel="noopener  ugc nofollow" target="_blank"><div class="oy ab dw"><div class="oz ab pa cl cj pb"><h2 class="bd hi fi z dy pc ea eb pd ed ef hg bi translated">谷歌联合实验室</h2><div class="pe l"><h3 class="bd b fi z dy pc ea eb pd ed ef dx translated">编辑描述</h3></div><div class="pf l"><p class="bd b fp z dy pc ea eb pd ed ef dx translated">colab.research.google.com</p></div></div><div class="pg l"><div class="ph l pi pj pk pg pl in ox"/></div></div></a></div><p id="ddfc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在Github上关注我</p><p id="fe4a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae it" href="https://github.com/R1SE23/" rel="noopener ugc nofollow" target="_blank"><em class="jv">https://github.com/R1SE23</em></a></p></div></div>    
</body>
</html>