<html>
<head>
<title>Image Captioning: An Eye for Blind</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图像字幕:盲人的眼睛</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/image-captioning-an-eye-for-blind-6d402f180c08?source=collection_archive---------6-----------------------#2021-07-09">https://medium.com/analytics-vidhya/image-captioning-an-eye-for-blind-6d402f180c08?source=collection_archive---------6-----------------------#2021-07-09</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="ebba" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这项研究的目的是设计一个变分自动编码器来模拟图像以及相关的标签或字幕。</p><p id="d016" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">实现是<a class="ae jc" href="https://cainvas.ai-tech.systems/notebooks/details/?path=rakash4730/Image_Caption_Generator.ipynb" rel="noopener ugc nofollow" target="_blank">这里的</a>。</p><p id="d4e5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">关于数据集</strong></p><p id="61a3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个模型中，所使用的数据集是从Flickr8k数据集提取的，该数据集由8，000幅图像组成，每幅图像都配有五个不同的标题，并提供了对突出实体和事件的清晰描述。</p><p id="134b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，我们的数据集继承了相同的属性，但只包含1，000幅图像。数据集由<a class="ae jc" href="https://www.kaggle.com/keenwarrior/small-flicker-data-for-image-captioning" rel="noopener ugc nofollow" target="_blank">阿努杰·加尔格</a>准备，可以在Kaggle上找到。这帮助我们将数据集的大小从1GB减少到近133Mb。该数据集中的图片选自六个不同的Flickr群组，往往不包含任何知名的地点或人物。这些图像是人工选择的，用来描绘各种场景和情况。</p><p id="1800" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">数据预处理</strong></p><p id="ac83" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个项目中，数据预处理是最耗时的部分，此外，可以假设，这个项目中几乎90–95%的工作都是数据预处理。在这里，我使用PyTorch，我应该更好地将它称为图像预处理，而不是数据预处理，因为我们的数据是以图像的形式出现的，然而任何传达一些事实或信息的东西都被称为数据，所以讽刺的是我们又将它称为数据预处理。</p><p id="ed4b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果有人想提高数据预处理技能，这个数据集是这个世界上最好的尝试之一。此外，提高该数据集可用性的因素之一是其随规模扩展的能力。</p><p id="a622" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，按照这里预处理的第一步，我们定义了一个函数来读取这个数据集并检查它的实体。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/fe8e62fe9c87ef2cab2b4358ae41c0bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Almm7S94BKExS7fqvAqyRA.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">带标题的图像</figcaption></figure><p id="2e2a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第一，你可以对数据集有一个基本的概念，它实际上是什么样子的，就像上面的两张图片一样，这个数据集有不同的图片，每张图片有5个标题。</p><p id="75b5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此外，在该数据的预处理中，使用了不同的编码和解码技术，并且由于该数据集是基于基于句子的图像描述的，所以这里还使用了NLTK(自然语言工具包)。</p><p id="2508" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了保证更好的可读性，每个函数的定义都遵循了面向对象的编程方法。现在，让我们讨论一下数据集预处理中使用的函数。</p><p id="eba7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">构建数据集词汇</strong></p><p id="5bf9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">词汇被认为是存在于我们的文本语料库中的一组独特的词。每当为NLP处理原始文本时，几乎所有事情都是围绕词汇表进行的。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="ce31" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">编码器</strong></p><p id="a4aa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里，卷积神经网络(CNN)可以被认为是一个编码器，其中输入图像被提供给CNN以提取特征。然后，在编码器的情况下，通常，CNN的最后隐藏状态被连接到解码器。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="724c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">解码器</strong></p><p id="63a6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">解码器是一种递归神经网络(RNN ),在单词级别进行语言建模。对于解码器，第一步是从编码器接收编码输出。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="685b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">字幕生成器</strong></p><p id="1d3c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此外，我们定义了一个递归神经网络，以生成基于图像的句子。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="c011" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> VAE字幕</strong></p><p id="d28a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这一部分是项目的主干。在这里，我们简单地调用了上述5个函数，即vocab、编码器、解码器和字幕生成器，并将它们传递给一个名为“VAECaptioner”的新类。这个类是我们项目的基础模型，因为它包含了所有基于句子的图像字幕所需的函数。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="5e26" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">定义损失函数</strong></p><p id="8369" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">损失函数决定了特定算法模拟给定数据的能力。如果预测与实际结果相差太多，损失函数将会增加，反之亦然。逐渐地，通过使用一些优化函数，损失函数可以学习减少预测中的误差。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jt ju l"/></div></figure><p id="9364" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">绘制损失图</strong></p><ul class=""><li id="f27b" class="jv jw hh ig b ih ii il im ip jx it jy ix jz jb ka kb kc kd bi translated">失败</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ke"><img src="../Images/35a2d2f6d8e6b9134c4140b9331ac492.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z5hqVY8tOnJgTV2mip1kzQ.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">培训_损失</figcaption></figure><ul class=""><li id="be0c" class="jv jw hh ig b ih ii il im ip jx it jy ix jz jb ka kb kc kd bi translated">标题_损失</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kf"><img src="../Images/7f6ea511ca349c3683a9a3e881fc2294.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qjs7AOTmZdjj8Pfn2t1rUw.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">标题_损失</figcaption></figure><p id="54d9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">预测</strong></p><p id="9595" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是根据test_set图像进行的随机预测</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="jt ju l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kg"><img src="../Images/bd47352986eff4f6d52860648e9c7890.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*cJhuLGDg9qLujZeQP1M98A.jpeg"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">由模型完成的样本预测</figcaption></figure></div></div>    
</body>
</html>