<html>
<head>
<title>Excelython — Part 4: Read Excel Files in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Excel thon—第4部分:用Python读取Excel文件</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/excelython-part-4-read-excel-files-in-python-ca9f86986f5f?source=collection_archive---------16-----------------------#2021-05-18">https://medium.com/analytics-vidhya/excelython-part-4-read-excel-files-in-python-ca9f86986f5f?source=collection_archive---------16-----------------------#2021-05-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/1b90e5287fb32e318b5cd0d1c99a66da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PufyiFFQvqnMkfIWFKw3ig.png"/></div></div></figure><div class=""/><h1 id="b96d" class="ip iq hs bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">项目描述</h1><p id="a0e0" class="pw-post-body-paragraph jn jo hs jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">你在一个采购团队工作，你想检查你的销售和库存，你可能有未完成的订单，你需要下新订单的地方，以及哪些产品需要你注意，因为它们是滞销品。</p><p id="087c" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">在您完成所有下载、处理和评估后，您需要通过电子邮件向另一位同事发送一份文件，其中包含所有产品，按供应商和订购量分列在不同的表格中，您还需要一份单独的excel文件，其中包含库存超过4周的产品，按前20名的成本价值排序，以便创建一份推动销售或将其返还给供应商的计划。</p><h1 id="0469" class="ip iq hs bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">项目步骤1</h1><p id="3b44" class="pw-post-body-paragraph jn jo hs jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">首先，我假设您有几个文件，每个文件都包含不同的信息，您需要下载、打开、处理和保存这些文件。</p><p id="f836" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">对于我们的项目，我将使用下面的模拟数据文件:</p><ol class=""><li id="b6de" class="kq kr hs jp b jq kl ju km jy ks kc kt kg ku kk kv kw kx ky bi translated"><strong class="jp ht">销售文件</strong>,包含过去4周售出的单位</li></ol><figure class="la lb lc ld fd hj er es paragraph-image"><div class="er es kz"><img src="../Images/c7dd363bc1b918f747a40747e173577e.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*FOsnSBJA0FI7fqmHxyfXUg.jpeg"/></div></figure><p id="ca25" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">文件形状= 5列x 10.000行</p><p id="005a" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">2.每个SKU仓库中的当前库存</p><figure class="la lb lc ld fd hj er es paragraph-image"><div class="er es le"><img src="../Images/e00c3ce36fe9533c6de9aeb0b639f27b.png" data-original-src="https://miro.medium.com/v2/resize:fit:386/format:webp/1*7jftvxrcw1c3IHbIWGrG8Q.jpeg"/></div></figure><p id="2d1b" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">文件形状= 2列x 10.000行</p><p id="31d2" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">3.商店的当前库存和每个SKU的最低库存水平</p><figure class="la lb lc ld fd hj er es paragraph-image"><div class="er es lf"><img src="../Images/50fa6e0faba6aa3f6af3c9d57a2eb33a.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*gUyadj4Yzq6wkeuq2bSk6Q.jpeg"/></div></figure><p id="668d" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">文件形状= 4列x 100.000行</p><p id="c664" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">4.SKU的待定订单</p><figure class="la lb lc ld fd hj er es paragraph-image"><div class="er es lg"><img src="../Images/99034907264ec58c00359fb272bbdb38.png" data-original-src="https://miro.medium.com/v2/resize:fit:360/format:webp/1*3EklVmfbQAJNHO4rcVyHlA.jpeg"/></div></figure><p id="5289" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">文件形状= 2列x 10.000行</p><p id="78be" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">5.每SKU成本</p><figure class="la lb lc ld fd hj er es paragraph-image"><div class="er es lh"><img src="../Images/065417dc32f37240d93de95578608477.png" data-original-src="https://miro.medium.com/v2/resize:fit:330/format:webp/1*Z-68B-4vlokgLBrtT0KAJQ.jpeg"/></div></figure><p id="2a3f" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">文件形状= 2列x 10.000行</p><p id="cf54" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">6.SKU供应商</p><figure class="la lb lc ld fd hj er es paragraph-image"><div class="er es li"><img src="../Images/ed97a50a79e54537af732e1eb01e34d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:306/format:webp/1*ex9-B_zR5kItjjy1aIqp8A.jpeg"/></div></figure><p id="3da1" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">文件形状= 2列x 10000行</p><p id="a609" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">全部打开。</p><blockquote class="lj lk ll"><p id="cb69" class="jn jo lm jp b jq kl js jt ju km jw jx ln kn ka kb lo ko ke kf lp kp ki kj kk ha bi translated">您可以下载。xlsx文件中有所有的样本数据<a class="ae lq" href="https://drive.google.com/file/d/1p9lQh6LMkhh_zyr3dRdbfNKrM-murCxf/view?usp=sharing" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ht">这里有</strong> </a></p></blockquote></div><div class="ab cl lr ls go lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ha hb hc hd he"><h2 id="60df" class="ly iq hs bd ir lz ma mb iv mc md me iz jy mf mg jd kc mh mi jh kg mj mk jl ml bi translated">Excel步骤1</h2><p id="3abf" class="pw-post-body-paragraph jn jo hs jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">从您的BI系统下载并打开以上所有文件。</p></div><div class="ab cl lr ls go lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ha hb hc hd he"><h2 id="9fd3" class="ly iq hs bd ir lz ma mb iv mc md me iz jy mf mg jd kc mh mi jh kg mj mk jl ml bi translated">Python步骤1</h2><p id="da90" class="pw-post-body-paragraph jn jo hs jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">正如我们在<a class="ae lq" href="https://servos-yiannis.medium.com/excelython-part-2-install-python-libraries-ebc74acdc202" rel="noopener"><strong class="jp ht">excel thon-Part 2:Install Python Libraries</strong></a>中所说，我们需要在每个脚本的开头导入我们将要使用的库。</p><p id="188a" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">现在是时候导入您的第一个库了。我们要导入的库是<a class="ae lq" href="https://pandas.pydata.org/docs/getting_started/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ht">熊猫</strong> </a> <strong class="jp ht"> </strong>和<strong class="jp ht"/><a class="ae lq" href="https://numpy.org/learn/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ht">Numpy</strong></a><strong class="jp ht">。</strong></p><pre class="la lb lc ld fd mm mn mo mp aw mq bi"><span id="c3b6" class="ly iq hs mn b fi mr ms l mt mu">import pandas as pd<br/>import numpy as np</span></pre><p id="28fe" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">正如你在上面的代码中注意到的，我们导入了这个库，并且我们定义从现在开始我们将用更短的名字<strong class="jp ht"> pd </strong>和<strong class="jp ht"> np </strong>来调用它。这是为了节省打字时间。您可以随意称呼它们，但最好使用这些全局简称。</p><p id="b260" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">下一步是导入文件。我们在Python环境中导入的excel文件是作为数据帧导入的。什么是数据帧？excel中的电子表格是一个数据框架。它是一个包含列和行的数据表。</p><p id="1ce7" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">该代码的结构如下:</p><p id="4cd0" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">定义dataframe = <strong class="jp ht"> pd </strong>(熊猫简称)的<strong class="jp ht">名</strong>。<strong class="jp ht">read _ excel</strong>(r“file . xlsx的完整路径”)。</p><pre class="la lb lc ld fd mm mn mo mp aw mq bi"><span id="9a67" class="ly iq hs mn b fi mr ms l mt mu">File_1 = pd.read_excel(r"C:\path to folder of the file\file1_name.xlsx")</span><span id="4aff" class="ly iq hs mn b fi mv ms l mt mu">File_2 = pd.read_excel(r"C:\path to folder of the file\file2_name.xlsx")</span><span id="b422" class="ly iq hs mn b fi mv ms l mt mu">File_3 = pd.read_excel(r"C:\path to folder of the file\file3_name.xlsx")</span><span id="4320" class="ly iq hs mn b fi mv ms l mt mu">File_4 = pd.read_excel(r"C:\path to folder of the file\file4_name.xlsx")</span><span id="7a3f" class="ly iq hs mn b fi mv ms l mt mu">File_5 = pd.read_excel(r"C:\path to folder of the file\file5_name.xlsx")</span><span id="4922" class="ly iq hs mn b fi mv ms l mt mu">File_6 = pd.read_excel(r"C:\path to folder of the file\file6_name.xlsx")</span></pre><p id="c77b" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">此时你可能会问，我到底怎么才能找到文件路径呢？</p><p id="99e1" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">如果您导航到您的文件位置，右键单击您要打开的excel文件，单击属性，选择选项卡:安全性，选择对象名称旁边的路径，从开始到文件扩展名所在的结尾，全部复制并粘贴到您的编辑器。</p><figure class="la lb lc ld fd hj er es paragraph-image"><div class="er es mw"><img src="../Images/ff1628604da4a8849f880b4190bfa855.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*Zt1HSjTAMb62oTNa8IXbJA.jpeg"/></div></figure><figure class="la lb lc ld fd hj er es paragraph-image"><div class="er es mx"><img src="../Images/2d4dd7f5264ca446ea2edd2961fde1af.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*tTKkztE-vHLTCECHVN4oKA.jpeg"/></div></figure><p id="68f0" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">让我们用Spyder编写上面的代码，运行它，看看会发生什么。</p><figure class="la lb lc ld fd hj er es paragraph-image"><div class="er es my"><img src="../Images/b096736067ab33aae96dd89585d07260.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*trfjyU3zieKBnAtXNxTuzQ.jpeg"/></div></figure><p id="0717" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">通过高亮显示来选择所有线。</p><figure class="la lb lc ld fd hj er es paragraph-image"><div class="er es my"><img src="../Images/bcaf2ce42da695099b67fea2680d0b17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*u-Sq60sbr8udIOAjv27oAA.jpeg"/></div></figure><p id="4a05" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">单击导航面板中的“运行选择或当前行”按钮。</p><figure class="la lb lc ld fd hj er es paragraph-image"><div class="er es mz"><img src="../Images/6a0ee128f171fcfc07280f09fc19d110.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*Hpi9cKwk5yjphQQ_gHTurg.jpeg"/></div></figure><p id="f60c" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">瞧啊。！！！！！！</p><p id="65a1" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">在右侧面板中的变量资源管理器选项卡下，您将看到导入File_1产生的数据帧。</p><figure class="la lb lc ld fd hj er es paragraph-image"><div class="er es na"><img src="../Images/ac15249104d56f3fd5b4fcc79fa38ad2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*KfxGnoeFTbJs7WuMI8LKGA.jpeg"/></div></figure><p id="7cdc" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">如果双击DataFrame行，可以看到一个弹出窗口，显示python读取的实际数据。</p><figure class="la lb lc ld fd hj er es paragraph-image"><div class="er es nb"><img src="../Images/5039d549e0d298e8ab6eaa8d75db2853.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*FPRDz3axeU43jU10Jfdk3g.jpeg"/></div></figure><p id="09a6" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">如您所见，我们导入了一个包含索引、excel中的列名和数据值的表。</p><p id="51c3" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">不同的是，在我们的excel中，SKU是一个8位数的文本。Python将其转换为数字。</p><p id="9f4f" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">转换回8位数真的很容易，但是我们会在另一部分做。</p><p id="658d" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">一旦你把所有文件导入的完整代码放在上面的代码框中，你就成功地导入了我们需要的6个文件。</p></div><div class="ab cl lr ls go lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ha hb hc hd he"><p id="5fc6" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">pd.read_excel()是一个非常强大的函数。有些情况下，您有一个excel:</p><ol class=""><li id="93e0" class="kq kr hs jp b jq kl ju km jy ks kc kt kg ku kk kv kw kx ky bi translated">有多个工作表，您需要导入一个特定的工作表。有一个参数sheet_names = "NameofSheet "，可以处理这个请求。</li><li id="1fe9" class="kq kr hs jp b jq nc ju nd jy ne kc nf kg ng kk kv kw kx ky bi translated">您需要获取excel的特定列。参数usecols将帮助您。</li></ol><p id="080d" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">还有很多其他特殊情况需要你去解决，而且肯定有解决方案。到目前为止，在我想知道Python是否能帮助我的100件事情中，可能有1-2件是我找不到Python解决方案的。</p></div><div class="ab cl lr ls go lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ha hb hc hd he"><p id="aaeb" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">下一步，我们将看看我们能做什么，excel的圣杯。</p><p id="6717" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">Python中的VLOOKUP </p><p id="7ccc" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated">问候</p><p id="6b89" class="pw-post-body-paragraph jn jo hs jp b jq kl js jt ju km jw jx jy kn ka kb kc ko ke kf kg kp ki kj kk ha bi translated"><a class="ae lq" href="https://servos-yiannis.medium.com/excelython-part-5-vlookup-in-python-251952a8c114" rel="noopener"> <strong class="jp ht">转到第5部分</strong> </a></p></div></div>    
</body>
</html>