<html>
<head>
<title>PySpark To Oracle Connection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PySpark到Oracle的连接</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pyspark-to-oracle-connection-34631ca64ee0?source=collection_archive---------0-----------------------#2021-02-01">https://medium.com/analytics-vidhya/pyspark-to-oracle-connection-34631ca64ee0?source=collection_archive---------0-----------------------#2021-02-01</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="34bc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本文中，您将了解如何将Spark应用程序连接到Oracle数据库</p><p id="4dd0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">先决条件:</strong></p><ol class=""><li id="0e9a" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">运行应用程序的Spark设置。</li><li id="8612" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">Oracle数据库详细信息</li></ol><p id="5dd4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将从创建SparkSession开始</p><figure class="jr js jt ju fd jv er es paragraph-image"><div class="er es jq"><img src="../Images/35f62b4d38548a41eac3bb53ba3cf7b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*B0YAIJ4CD3MnBDJQRcR9Pw.png"/></div></figure><p id="f97e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们将定义数据库驱动程序和连接细节。我使用本地数据库，所以密码没有加密。请在使用时加密和解密您的密码。</p><figure class="jr js jt ju fd jv er es paragraph-image"><div class="er es jy"><img src="../Images/1273dfb3edcd83db2ba996bafb7858ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*dqAKys-CeDoQub2Vc-BltQ.png"/></div></figure></div><div class="ab cl jz ka go kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="ha hb hc hd he"><p id="52fd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">从Oracle数据库读取</strong></p><p id="aa46" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将连接到数据库，使用下面的代码从雇员表中获取数据，并将其存储在df数据帧中。</p><figure class="jr js jt ju fd jv er es paragraph-image"><div class="er es kg"><img src="../Images/7572f74294c9cb65bf92a1b6bcac1302.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*kIG4s3-x5UnJEsLPbM6uGA.png"/></div></figure><p id="5a18" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">正在检查表架构</p><figure class="jr js jt ju fd jv er es paragraph-image"><div class="er es kh"><img src="../Images/7d78c4204d2d648b3471ae178bc35068.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*ybrS9aQhyKG2I6ee6RLaPQ.png"/></div></figure><p id="603b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您很难从单个表中获取数据。因此，如果您想使用查询从多个表中获取数据，请遵循以下方法</p><figure class="jr js jt ju fd jv er es paragraph-image"><div class="er es ki"><img src="../Images/09c4b9cdb1569336459eb0fbca8e7cf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*l6qqMp75VUiLbuE-RfIixg.png"/></div></figure><p id="8caa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">验证数据</p><figure class="jr js jt ju fd jv er es paragraph-image"><div class="er es kj"><img src="../Images/1744da71771bee0968156648a2e11e64.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*i5RMreeWz8gQ_6vF-2syUA.png"/></div></figure></div><div class="ab cl jz ka go kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="ha hb hc hd he"><p id="00d9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">写入Oracle数据库</strong></p><p id="7665" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有多种方法可以将数据写入数据库。首先，我们将尝试编写我们的df1数据帧，并在运行时使用Pyspark创建该表</p><figure class="jr js jt ju fd jv er es paragraph-image"><div class="er es kk"><img src="../Images/141650fa846ea65f2d04e65c09f2f691.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*2ptiUXecNKMyEk-zi1NNlg.png"/></div></figure><p id="daee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现有表格中的数据可以使用以下方式追加</p><figure class="jr js jt ju fd jv er es paragraph-image"><div class="er es kl"><img src="../Images/264d06c872b8e3240e8cafad14bb8076.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*XUs2QidCU8yBp6MKXVGtPA.png"/></div></figure><p id="9855" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，我们将停止我们的火花会议</p><figure class="jr js jt ju fd jv er es paragraph-image"><div class="er es km"><img src="../Images/9336ccef711156bf5271966c0d647d26.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*iFmXry-XeyyXSnkZTjOUoA.png"/></div></figure></div><div class="ab cl jz ka go kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="ha hb hc hd he"><p id="9da0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">你可能面临的错误</strong></p><ol class=""><li id="8c10" class="jc jd hh ig b ih ii il im ip je it jf ix jg jb jh ji jj jk bi translated">无法连接到数据库。请首先检查SPARC _类路径中是否有ojdbc jar。</li><li id="310f" class="jc jd hh ig b ih jl il jm ip jn it jo ix jp jb jh ji jj jk bi translated">如果您没有收到匹配的认证协议异常<br/>错误，请检查oracle服务器的版本&amp;使用兼容的jar进行连接。另一种方法是根据客户端&amp;服务器修改sqlnet.ora</li></ol><figure class="jr js jt ju fd jv er es paragraph-image"><div class="er es kn"><img src="../Images/02cd32da0fa9e05da95178c0bffef7b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*gBDEiqjrlviAmjBvUCDr4g.png"/></div></figure></div><div class="ab cl jz ka go kb" role="separator"><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke kf"/><span class="kc bw bk kd ke"/></div><div class="ha hb hc hd he"><p id="2ad1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有更多的选项可以用来读取/写入数据到数据库。我分享了一个基本模板来开始使用它&amp;我收到的错误。您可以查看Pyspark文档以获得更多可用选项。</p><p id="cf1f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">不断学习，不断分享</p></div></div>    
</body>
</html>