<html>
<head>
<title>Python Packages for PDF Data Extraction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于PDF数据提取的Python包</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/python-packages-for-pdf-data-extraction-d14ec30f0ad0?source=collection_archive---------0-----------------------#2021-06-15">https://medium.com/analytics-vidhya/python-packages-for-pdf-data-extraction-d14ec30f0ad0?source=collection_archive---------0-----------------------#2021-06-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="2317" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我是全球系统集成和服务公司3K技术公司的数据科学家。作为最近一个项目的一部分，我们必须解析简历，从结构化格式的简历中提取和存储信息，因为简历经常以各种格式上传或通过电子邮件发送，如pdf、docx等。</p><p id="ad2d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通常，对于PDF格式，我们需要从PDF中提取文本以供进一步分析。PDF简历有多种创建方式。例如，一些求职者用word格式创建简历，然后保存为PDF格式，而一些人用LATEX创建，或者使用在线简历模板。总的来说，我们应该能够解析所有这些类型的简历，并提取每一个文本，而不会丢失任何信息。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/3c4502750d097a67ce84f577fb353594.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PmRORBoFv0VbPoTqOVgkCw.jpeg"/></div></div></figure><p id="5a89" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面展示的是两个简历示例，一个是docx格式，另一个是用LATEX创建并保存为PDF格式。</p><div class="jd je jf jg fd ab cb"><figure class="jo jh jp jq jr js jt paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/0b8b5997e9517a93d7982197859210ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*pPsoRIZJet8psVzRhi9XMQ.png"/></div></figure><figure class="jo jh ju jq jr js jt paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/57633b3cb9dd25cb50a6354c465b6759.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*tL6sRNaBucBW-oU1V3kWcA.png"/></div><figcaption class="jv jw et er es jx jy bd b be z dx jz di ka kb translated">docx和PDF格式的简历</figcaption></figure></div><p id="ad01" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，为了执行给定的任务，我尝试了各种python包。在这篇博客中，我总结了这些包的性能，每个包都有其优点和缺点。</p><p id="cfca" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是我用来从PDF文件中提取文本的包列表。</p><ol class=""><li id="5394" class="kc kd hh ig b ih ii il im ip ke it kf ix kg jb kh ki kj kk bi translated">PyPDF2</li><li id="65e4" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated">小红点；吉祥记</li><li id="0b47" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated">Textract</li><li id="589b" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated">PyMuPDF</li><li id="d8be" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated">PDFtotext</li><li id="a92d" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated">PDFminer</li><li id="9b67" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated">白板</li></ol><p id="e544" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将通过python代码详细讲解每个包。</p></div><div class="ab cl kq kr go ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ha hb hc hd he"><p id="fce2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> PyPDF2 </strong></p><p id="d3b9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">PyPDF2是一个纯Python包，可以用于许多不同类型的PDF操作。PyPDF2可用于执行以下任务。</p><p id="bd22" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用Python从PDF中提取文档信息</p><p id="2b67" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">旋转页面</p><p id="81e2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">合并pdf</p><p id="f4b7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">分割pdf</p><p id="47cc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">添加水印</p><p id="a80e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">加密PDF</p><p id="90c3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面显示的是使用PyPDF2提取全文和页数的代码，以及输入PDF和输出提取的文本。</p><pre class="jd je jf jg fd kx ky kz la aw lb bi"><span id="dcc2" class="lc ld hh ky b fi le lf l lg lh">path = r"\....Downloads\RuchaSawarkar.pdf"</span><span id="798c" class="lc ld hh ky b fi li lf l lg lh">#Using PyPDF2</span><span id="0e12" class="lc ld hh ky b fi li lf l lg lh">#importing required modules<br/>import PyPDF4</span><span id="ba61" class="lc ld hh ky b fi li lf l lg lh"># creating a pdf file object<br/>pdfFileObj = open(path, 'rb')</span><span id="ec3e" class="lc ld hh ky b fi li lf l lg lh">#creating a pdf reader object<br/>pdfReader = PyPDF4.PdfFileReader(pdfFileObj)</span><span id="de11" class="lc ld hh ky b fi li lf l lg lh">#printing number of pages in pdf file<br/>print(pdfReader.numPages)</span><span id="8384" class="lc ld hh ky b fi li lf l lg lh">#creating a page object<br/>pageObj = pdfReader.getPage(0)</span><span id="23e0" class="lc ld hh ky b fi li lf l lg lh"># extracting text from page<br/>for i in range(pdfReader.numPages):<br/>    pypdf2_text +=pdfReader.getPage(i).extractText()</span><span id="9bed" class="lc ld hh ky b fi li lf l lg lh">#closing the pdf file object<br/>pdfFileObj.close()</span></pre><div class="jd je jf jg fd ab cb"><figure class="jo jh lj jq jr js jt paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/870739876fe5f93fca54241fb083c169.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*IilnR1MoYm5HWNvih_QsdA.png"/></div></figure><figure class="jo jh lk jq jr js jt paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/339d7635c86ffc458467fca895e65fdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*eVCqTh0WGQQmlZrU3e6hyA.png"/></div></figure></div><p id="811b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用PyPDF2包的缺点:</p><ol class=""><li id="dfc3" class="kc kd hh ig b ih ii il im ip ke it kf ix kg jb kh ki kj kk bi translated">此软件包提取文本，但不保留原始PDF中的文本结构。</li><li id="fe5d" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated">提取的文本中包含不必要的空格和换行符。</li><li id="6b6f" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated">它不保留表结构。</li></ol><p id="801e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当我使用LATEX创建的PDF时，提取的文本没有空格，这意味着一些信息可能会丢失。</p></div><div class="ab cl kq kr go ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ha hb hc hd he"><p id="277b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">蒂卡</strong></p><p id="1e95" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Tika是一个基于Java的包。Tika-Python是绑定到Apache TikaTM REST服务的Python，它允许在Python语言中本地调用Tika。要在python中使用Tika包，我们需要在您的系统中安装java。当您第一次运行代码时，它将启动与Java服务器的连接。如果代码是第一次在系统中运行，这将导致使用Tika包从PDF中提取文本的延迟。</p><p id="30cd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下是从PDF中提取文本时执行的一些附加任务。</p><ol class=""><li id="cb2d" class="kc kd hh ig b ih ii il im ip ke it kf ix kg jb kh ki kj kk bi translated">提取PDF文件的内容</li><li id="7bc7" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated">提取PDF文件的元数据</li><li id="9b3f" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated">提取关键字(字典的元数据和内容)</li><li id="6b12" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated">要了解Tika服务器的状态</li></ol><p id="f151" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面显示了使用Tika包从PDF中提取全文的代码，以及输入PDF和输出提取的文本。</p><pre class="jd je jf jg fd kx ky kz la aw lb bi"><span id="bff6" class="lc ld hh ky b fi le lf l lg lh">path = r"\....Downloads\RuchaSawarkar.pdf"</span><span id="2f8a" class="lc ld hh ky b fi li lf l lg lh">#using Tika<br/>#pip install tika</span><span id="b5ad" class="lc ld hh ky b fi li lf l lg lh">from tika import parser<br/>raw = parser.from_file(path2)<br/>tika_text = raw['content']</span></pre><div class="jd je jf jg fd ab cb"><figure class="jo jh ll jq jr js jt paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/2159619cb53fb9c0ff7e676fa37c4f34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*hs0GGnIxwTtL_GaoEAFqvg.png"/></div></figure><figure class="jo jh lm jq jr js jt paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/5df8a8f302f763883bcf7def3b3924c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*WD4-tttMA_sqsDEeDHt2bA.png"/></div></figure></div><p id="bd12" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用Tika包的一些主要缺点是:</p><ol class=""><li id="2d4b" class="kc kd hh ig b ih ii il im ip ke it kf ix kg jb kh ki kj kk bi translated">需要安装java</li><li id="fbbd" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated">Java服务器连接非常耗时</li><li id="2147" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated">不保留表结构</li></ol><p id="d75a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，如果您愿意在您的系统中安装Java，那么您可以使用这个包。</p></div><div class="ab cl kq kr go ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ha hb hc hd he"><p id="0944" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">文本摘要</strong></p><p id="8360" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">虽然有几个包可以独立地从各种格式的文件中提取内容，但Textract包提供了一个单一的接口，可以从任何类型的文件中提取内容，没有任何不相关的标记。</p><p id="3dd2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Textract用于从PDF文件以及其他文件格式中提取文本。其他文件格式包括csv、doc、eml、epub、json、jpg、mp3、msg、xls等。</p><p id="8e7e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用Textract包最值得注意的一点是，它以字节格式从文件中提取信息。要将字节数据转换成字符串，我们需要使用其他python包进行解码，比如编解码器。</p><p id="26f2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面显示的是使用Textract从PDF中提取文本的代码，以及输入PDF和输出提取的文本。</p><pre class="jd je jf jg fd kx ky kz la aw lb bi"><span id="308b" class="lc ld hh ky b fi le lf l lg lh">path =   r"\....Downloads\RuchaSawarkar.pdf"</span><span id="6c9d" class="lc ld hh ky b fi li lf l lg lh">#for decoding<br/>import codecs</span><span id="3c94" class="lc ld hh ky b fi li lf l lg lh">#using Textract<br/>import textract</span><span id="0427" class="lc ld hh ky b fi li lf l lg lh">#extract text in byte format<br/>textract_text = textract.process(path)</span><span id="3764" class="lc ld hh ky b fi li lf l lg lh">#convert bytes to string<br/>textract_str_text = codecs.decode(textract_text)</span></pre><div class="jd je jf jg fd ab cb"><figure class="jo jh ln jq jr js jt paragraph-image"><img src="../Images/93f4bd1200a164c446f3ccff74dbcdff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*IilnR1MoYm5HWNvih_QsdA.png"/></figure><figure class="jo jh lo jq jr js jt paragraph-image"><img src="../Images/2ac59ce2164cdb042c19277414a0baa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*FnOdbpnv-6L65tO_O-_53Q.png"/></figure></div><p id="9669" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用这个包进行文本提取后，信息不会丢失。原始文档的结构保持不变。但是，不会保留表结构。</p><p id="4477" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">总的来说，这个包不仅为从PDF中提取文本提供了一个很好的选择，也为从其他类型的文件中提取文本提供了一个很好的选择。</p></div><div class="ab cl kq kr go ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ha hb hc hd he"><p id="3d1c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> PyMuPDF </strong></p><p id="f939" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">PyMuPDF是一个轻量级PDF查看器MuPDF的python绑定。PyMuPDF并不完全基于python。该软件包以其高性能和高渲染质量而闻名。</p><p id="30bd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用PyMuPDF，我们可以访问扩展名为*的文件。pdf，*。xps，*。oxps，*。epub，*。来自Python脚本的cbz或*.fb2。还支持几种流行的图像格式，包括多页TIFF图像。</p><p id="6c28" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">PyMuPDF还提取多页文档的信息。如果您输入页码，它将授予我们提取特定页面信息的权限。</p><p id="d6c9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是使用PyMuPDF从PDF中提取文本以及输入PDF和输出提取的文本的代码。</p><pre class="jd je jf jg fd kx ky kz la aw lb bi"><span id="f083" class="lc ld hh ky b fi le lf l lg lh">path = r"\....Downloads\RuchaSawarkar.pdf"</span><span id="1de0" class="lc ld hh ky b fi li lf l lg lh">#Usinf pymupdf<br/>import fitz  # this is pymupdf</span><span id="e3b6" class="lc ld hh ky b fi li lf l lg lh">#extract text page by page<br/>with fitz.open(path) as doc:<br/>pymupdf_text = ""<br/>for page in doc:<br/>    pymupdf_text += page.getText()</span></pre><div class="jd je jf jg fd ab cb"><figure class="jo jh lp jq jr js jt paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/9a6865e5bb5ee36ea81fb815c751f53d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*ccZktlFsAWAD_EIazRmHyQ.png"/></div></figure><figure class="jo jh lq jq jr js jt paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/b78f41192168025201b2cce2070acd98.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*rJNWR1RhHO1C-dDax3iKoA.png"/></div></figure></div><p id="2aa4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">通常，从PDF文件中提取文本时，PyMuPDF是您可以考虑的选择。它确实从文本中删除了不必要的空格，所以预处理的文本清理任务是由这个包自动完成的。</p><p id="a366" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">它保持了文档的原始结构。然而，与其他包类似，以原始格式提取表格的问题仍然存在。我们将不得不使用一些其他的包来保存表中的信息。</p></div><div class="ab cl kq kr go ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ha hb hc hd he"><p id="98a6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> PDFtotext </strong></p><p id="58d6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">PDFtotxt是一个纯粹基于python的包，可用于从PDF文件中提取文本。顾名思义，它只支持PDF文件，不支持其他文件格式。</p><p id="57ad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据以对象的形式提取。PDF的结构被保留。</p><p id="f010" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面是使用PDFtotext包从PDF中提取文本以及输入PDF和输出提取的文本的代码。</p><pre class="jd je jf jg fd kx ky kz la aw lb bi"><span id="e7a3" class="lc ld hh ky b fi le lf l lg lh">path = r"\....Downloads\RuchaSawarkar.pdf"</span><span id="5f9f" class="lc ld hh ky b fi li lf l lg lh">#Using PDFtotext<br/>import pdftotext</span><span id="4bbd" class="lc ld hh ky b fi li lf l lg lh"># Load your PDF<br/>with open(path2, "rb") as f:<br/>    pdf = pdftotext.PDF(f)</span><span id="b605" class="lc ld hh ky b fi li lf l lg lh"># Read all the text into one string<br/>pdftotext_text = "\n\n".join(pdf)</span></pre><div class="jd je jf jg fd ab cb"><figure class="jo jh lr jq jr js jt paragraph-image"><img src="../Images/2fc739e9d7079c2c6792b5baae124e46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*ccZktlFsAWAD_EIazRmHyQ.png"/></figure><figure class="jo jh ls jq jr js jt paragraph-image"><img src="../Images/6428fd39ec5b2ca1debf08269c334131.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*NXWDap2ALUuOv16TR-M_WQ.png"/></figure></div><p id="5577" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">换句话说，与之前讨论的所有包不同，该包的主要优点是它保留了PDF文本的结构以及表格结构格式。</p></div><div class="ab cl kq kr go ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ha hb hc hd he"><p id="2926" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> PDFminer </strong></p><p id="3d52" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是另一个纯粹基于python的包，仅用于提取PDF文件。它还可以将PDF文件转换成其他文件格式，如HTML/XML。PDFminer有多种版本，最新版本与python 3.6及更高版本兼容。</p><p id="46ec" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">PDFminer以API请求的形式提供服务。因此，从这个包获得的结果比其他纯粹基于python的包花费的时间稍多。</p><p id="d572" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">调用这个包时有几个参数要使用。参数的完整描述可在<a class="ae lt" href="https://pypi.org/project/pdfminer/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="a333" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用PDFminer包从PDF中提取文本所用的代码与其他包所用的简单代码相比冗长乏味，下面给出了输入PDF和输出提取的文本。</p><pre class="jd je jf jg fd kx ky kz la aw lb bi"><span id="a1e8" class="lc ld hh ky b fi le lf l lg lh">path = r"\....Downloads\RuchaSawarkar.pdf"</span><span id="77b7" class="lc ld hh ky b fi li lf l lg lh">#Using PDFminer<br/>from pdfminer.pdfinterp import PDFResourceManager, PDFPageInterpreter<br/>from pdfminer.converter import TextConverter<br/>from pdfminer.layout import LAParams<br/>from pdfminer.pdfpage import PDFPage<br/>from io import StringIO</span><span id="99ed" class="lc ld hh ky b fi li lf l lg lh">def convert_pdf_to_txt(path):<br/>    rsrcmgr = PDFResourceManager()<br/>    retstr = StringIO()<br/>    codec = 'utf-8'<br/>    laparams = LAParams()<br/>    device = TextConverter(rsrcmgr, retstr,      codec=codec,laparams=laparams)<br/>    fp = open(path, 'rb')<br/>    interpreter = PDFPageInterpreter(rsrcmgr, device)<br/>    password = ""<br/>    maxpages = 0<br/>    caching = True<br/>    pagenos=set()<br/>    for page in PDFPage.get_pages(fp, pagenos, maxpages=maxpages, password=password,caching=caching, check_extractable=True):<br/>        interpreter.process_page(page)<br/>    text = retstr.getvalue()<br/>    fp.close()<br/>    device.close()<br/>    retstr.close()<br/>    return text</span><span id="1d87" class="lc ld hh ky b fi li lf l lg lh">pdf_miner_text = convert_pdf_to_txt(path1)</span></pre><div class="jd je jf jg fd ab cb"><figure class="jo jh lu jq jr js jt paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/e0f084d7cc78008881a6215685aa7577.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*IilnR1MoYm5HWNvih_QsdA.png"/></div></figure><figure class="jo jh lv jq jr js jt paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/cf6c00fe31b1a6ea8d43835fa70b93e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*evRLQfm-j1pgNrxPp5MBVA.png"/></div></figure></div></div><div class="ab cl kq kr go ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ha hb hc hd he"><p id="8626" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">白板</strong></p><p id="7b8d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个基于java的包主要用于读取PDF中的表格。这是tabula-java的一个简单的python包装器。</p><p id="a0d1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">信息提取存储在python中的python数据帧中，随后可以转换为csv、tsv、excel或json文件格式。</p><p id="95a0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面显示的是使用Tabula包将表格从PDF文件中提取到DataFrame中的代码，以及输入PDF和输出提取的文本。</p><pre class="jd je jf jg fd kx ky kz la aw lb bi"><span id="ce53" class="lc ld hh ky b fi le lf l lg lh">path = r"\....Downloads\RuchaSawarkar.pdf"</span><span id="8d8d" class="lc ld hh ky b fi li lf l lg lh">#using Tabula<br/>import tabula</span><span id="36cb" class="lc ld hh ky b fi li lf l lg lh">df = tabula.read_pdf(path, pages='all')</span></pre><div class="jd je jf jg fd ab cb"><figure class="jo jh lw jq jr js jt paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/d98c05e604df7922b2985e7f8c7b1b9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*IilnR1MoYm5HWNvih_QsdA.png"/></div></figure><figure class="jo jh lx jq jr js jt paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><img src="../Images/cad2f3395feba74e9e217e9a092ae983.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*Dnn1gFRzC8yHf7vQIBlqlg.png"/></div></figure></div><p id="2ccf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个包对于提取表信息很有用。使用Tabula和上面提到的其他软件包可以从pdf中提取全文。</p></div><div class="ab cl kq kr go ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ha hb hc hd he"><p id="5130" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">结论</strong></p><p id="9bb9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这篇博客中，我比较了从PDF文件格式中提取文本的各种python包。此外，我在python编程语言中包含了每个包的代码片段。</p><p id="ca2a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">总而言之:</p><ol class=""><li id="5b51" class="kc kd hh ig b ih ii il im ip ke it kf ix kg jb kh ki kj kk bi translated">pypdf 2——与其他相比不太受欢迎</li><li id="56be" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated"><strong class="ig hi"> Tika </strong> —需要安装java—需要熟悉Java安装，不需要涉及Java连接，适合提取内容、密钥、元数据。</li><li id="3df7" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated"><strong class="ig hi"> textract </strong> —返回字节对象—需要将其转换成字符串</li><li id="f28d" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated"><strong class="ig hi"> PyMuPDF </strong> —从PDF文件中提取文本，删除文本中不必要的空格，保持文档的原始结构</li><li id="6f1f" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated"><strong class="ig hi"> PDFminer </strong> —保留PDF文件文本的结构，但不保留表格结构。</li><li id="bc76" class="kc kd hh ig b ih kl il km ip kn it ko ix kp jb kh ki kj kk bi translated"><strong class="ig hi"> PDFtoText </strong> —相对来说是最优选的，因为它保留了表格和原始结构</li></ol><p id="b4e7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我已经在我的GitHub个人资料<a class="ae lt" href="https://github.com/rucha80/PDF-Data-Extraction" rel="noopener ugc nofollow" target="_blank">链接</a>上传了代码和一些PDF文件来比较这些包，供你参考。</p><p id="5f99" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">谢谢你的阅读。我真诚地希望它对你有所帮助，一如既往，我乐于接受建设性的反馈。</p><p id="388c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">正如我已经提到的，我是3K技术公司的数据科学家。请关注我们的公司页面，了解更多此类博客和创新解决方案<a class="ae lt" href="https://www.linkedin.com/company/3k-technologies/mycompany/" rel="noopener ugc nofollow" target="_blank">此处</a>。</p><p id="72f2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在rsawarkar80@gmail.com/rucha.s@3ktechnologies.com给我寄封信。</p><p id="1ac0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可以在<a class="ae lt" href="https://www.linkedin.com/in/rucha-sawarkar-714644a0/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上找到我。</p></div><div class="ab cl kq kr go ks" role="separator"><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv kw"/><span class="kt bw bk ku kv"/></div><div class="ha hb hc hd he"><p id="0dec" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">参考文献</strong></p><p id="3bca" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae lt" href="https://pypi.org/project/PyPDF2/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/PyPDF2/</a></p><p id="16ee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae lt" href="https://realpython.com/pdf-python/" rel="noopener ugc nofollow" target="_blank">https://realpython.com/pdf-python/</a></p><p id="426a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae lt" href="https://www.geeksforgeeks.org/parsing-pdfs-in-python-with-tika/" rel="noopener ugc nofollow" target="_blank">https://www . geeks forgeeks . org/parsing-pdf-in-python-with-tika/</a></p><p id="da04" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae lt" href="https://cbrownley.wordpress.com/2016/06/26/parsing-pdfs-in-python-with-tika/" rel="noopener ugc nofollow" target="_blank">https://cbrownley . WordPress . com/2016/06/26/parsing-pdf-in-python-with-tika/</a></p><p id="e979" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae lt" href="https://pypi.org/project/tika/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/tika/</a></p><p id="22ff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae lt" href="https://textract.readthedocs.io/en/stable/python_package.html" rel="noopener ugc nofollow" target="_blank">https://text ract . readthedocs . io/en/stable/python _ package . html</a></p><p id="2197" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae lt" href="https://towardsdatascience.com/how-to-extract-text-from-pdf-245482a96de7" rel="noopener" target="_blank">https://towards data science . com/how-to-extract-text-from-pdf-245482 a96de 7</a></p><p id="cb1a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae lt" href="https://pymupdf.readthedocs.io/en/latest/intro.html" rel="noopener ugc nofollow" target="_blank">https://pymupdf.readthedocs.io/en/latest/intro.html</a></p><p id="6a50" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae lt" href="https://pypi.org/project/PyMuPDF/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/PyMuPDF/</a></p><p id="f084" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae lt" rel="noopener" href="/dida-machine-learning/how-to-extract-text-from-pdf-files-16df0830aa66">https://medium . com/dida-machine-learning/how-to-extract-text-from-pdf-files-16df 0830 aa 66</a></p><p id="cf7c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae lt" href="https://pypi.org/project/pdftotext/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/pdftotext/</a></p><p id="f5f2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae lt" href="https://pypi.org/project/pdfminer/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/pdfminer/</a></p><p id="1ed2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae lt" href="https://pypi.org/project/tabula-py/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/tabula-py/</a></p></div></div>    
</body>
</html>