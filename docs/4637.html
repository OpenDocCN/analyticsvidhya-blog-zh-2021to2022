<html>
<head>
<title>Text Processing and Classification Intro (Part 1 — Sentiment Analysis)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">文本处理和分类介绍(第1部分—情感分析)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/text-processing-and-classification-intro-part-1-sentiment-analysis-7e22a83e1c4?source=collection_archive---------1-----------------------#2021-12-07">https://medium.com/analytics-vidhya/text-processing-and-classification-intro-part-1-sentiment-analysis-7e22a83e1c4?source=collection_archive---------1-----------------------#2021-12-07</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/e25ac7aa8523d64f4bd78343a00e83be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*Suvg0T5KU1ow5R6y.png"/></div><figcaption class="il im et er es in io bd b be z dx translated"><a class="ae ip" href="https://vitalflux.com/sentiment-analysis-machine-learning-techniques/" rel="noopener ugc nofollow" target="_blank">https://vital flux . com/情操-分析-机器-学习-技巧/ </a></figcaption></figure><blockquote class="iq"><p id="d428" class="ir is hh bd it iu iv iw ix iy iz ja dx translated">如何操作文本数据以获得更多洞察力？如何通过点评了解目前的市场情绪？</p></blockquote><p id="dc89" class="pw-post-body-paragraph jb jc hh jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ja ha bi translated">对于像我这样没有技术背景的初级数据科学家来说，处理文本数据一直是一个障碍。早年，我们不知道如何将文本用作机器学习模型的输入。我们中的一些人可能已经有了将文本数据中的每个单词转换成数字的想法，但不太确定如何将每个文本转换成特定的数字。这是众多可用方法中的一种。</p><p id="1cf4" class="pw-post-body-paragraph jb jc hh jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja ha bi translated">借此机会，我想分享一下我学习文字处理3周左右的经验。我把我的作品分成两部分。这部分会讲我们如何分析文本数据来做情感分析。在我学习情感分析的整个过程中，我都会参考这个<a class="ae ip" href="https://towardsdatascience.com/a-beginners-guide-to-sentiment-analysis-in-python-95e354ea84f6" rel="noopener" target="_blank">链接</a>。</p><blockquote class="kd ke kf"><p id="a94a" class="jb jc kg jd b je jy jg jh ji jz jk jl kh ka jo jp ki kb js jt kj kc jw jx ja ha bi translated">如果你想直接看到文本分类过程，这里有一个链接我写作的第二部分:<br/><a class="ae ip" href="https://sea-remus.medium.com/text-processing-and-classification-intro-part-2-text-classification-9dc58782acb6" rel="noopener">https://sea-Remus . medium . com/text-processing-and-class ification-intro-part-2-text-class ification-9dc 58782 ACB 6</a></p></blockquote><p id="2d72" class="pw-post-body-paragraph jb jc hh jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja ha bi translated">在我们开始之前，我们应该导入所有必要的包</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="ea3c" class="kt ku hh kp b fi kv kw l kx ky">import pandas as pd<br/>import numpy as np<br/>import sqlite3<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns</span></pre><h1 id="9296" class="kz ku hh bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">要使用的文本数据</h1><p id="d47c" class="pw-post-body-paragraph jb jc hh jd b je lw jg jh ji lx jk jl jm ly jo jp jq lz js jt ju ma jw jx ja ha bi translated">我们将用来学习如何进行文本处理和分类的文本数据将是<a class="ae ip" href="https://www.kaggle.com/snap/amazon-fine-food-reviews?select=Reviews.csv" rel="noopener ugc nofollow" target="_blank">亚马逊美食评论</a>上的文本数据。首先，我们从。链接上提供的sqlite文件或阅读提供的csv文件。</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="f88d" class="kt ku hh kp b fi kv kw l kx ky">con = sqlite3.connect('database.sqlite')<br/>data = pd.read_sql_query('select * from Reviews', con)<br/>con.close()</span></pre><figure class="kk kl km kn fd ii er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es mb"><img src="../Images/4352158d67473fb3eaeac2eda4f1b3a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XRVtr7Gu5ByFDz4MhjTPiA.png"/></div></div><figcaption class="il im et er es in io bd b be z dx translated">对数据的一瞥</figcaption></figure><p id="9da6" class="pw-post-body-paragraph jb jc hh jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja ha bi translated">我们的数据包含以下10列:</p><figure class="kk kl km kn fd ii er es paragraph-image"><div class="ab fe cl mg"><img src="../Images/95e9b81e753f545e761650780c09cbd6.png" data-original-src="https://miro.medium.com/v2/format:webp/1*TRc8apBd4obifoMIJKoF2A.png"/></div></figure><p id="ea7b" class="pw-post-body-paragraph jb jc hh jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja ha bi translated">在开始之前，我们清理数据，以便我们可以评估以后使用哪些列。我们试图用。isnull()和一个自定义函数。</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="596f" class="kt ku hh kp b fi kv kw l kx ky">#check for missing values<br/>print(data.isnull().sum())<br/>print('\n\n\n')</span><span id="a60e" class="kt ku hh kp b fi mh kw l kx ky">def checkweirddataandnull(name):<br/>    print('='*30)<br/>    print('Column name: '+name)<br/>    if data[name].dtypes == 'O':<br/>        display(data[(data[name] == 'nan')|(data[name] == 'NaN')|<br/>                     (data[name] == 'N/A')|(data[name] == '0')|<br/>                     (data[name] == '')|(data[name] == '-1')|<br/>                     (data[name] == 'null')|(data[name] == 'Null')|<br/>                     (data[name] == 'NA')|(data[name] == 'na')|<br/>                     (data[name] == 'none')|(data[name] == 'unknown')])<br/>    else:<br/>        display(data[data[name] &lt; 0])</span><span id="a4bb" class="kt ku hh kp b fi mh kw l kx ky">for i in data.columns:<br/>    checkweirddataandnull(i)</span></pre><p id="fb5a" class="pw-post-body-paragraph jb jc hh jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja ha bi translated">通过上面的代码，我们可以看到我们的数据包含了多少缺失值。原来我们的数据在ProfileName和Summary列上有几个缺失值。我们通过将ProfileName中缺少的值假定为“匿名”并将Summary中缺少的值假定为“无摘要”来处理这个问题。</p><h1 id="0a3d" class="kz ku hh bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">解读数据</h1><p id="9709" class="pw-post-body-paragraph jb jc hh jd b je lw jg jh ji lx jk jl jm ly jo jp jq lz js jt ju ma jw jx ja ha bi translated">我们将评估“文本”栏，因为它包含了评论。我们将首先关注“分数”栏，因为它反映了我们客户的情绪。</p><figure class="kk kl km kn fd ii er es paragraph-image"><div class="er es mi"><img src="../Images/2f0b6019efd8ac387fb886e5251d7a1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*HtaKGitX_0cx7IG1GAPv1A.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">“分数”计数图</figcaption></figure><p id="1a63" class="pw-post-body-paragraph jb jc hh jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja ha bi translated">解读上面的图表，我们可以看到我们客户的情绪趋于积极。顾客留下的评论大多评分在4分以上。这表明市场是满意的。从这里，我们想生成一个词云，以更好地了解哪些词经常被用来描述我们的产品。为了生成一个好的词云，我们需要首先清理我们的文本数据，这样经常说的不相关的词就不会被包括在内(例如，连词等。).</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="727d" class="kt ku hh kp b fi kv kw l kx ky">#See what is the most used words from our data<br/>from wordcloud import WordCloud,STOPWORDS<br/>stpwrd = set(STOPWORDS)<br/>stpwrd.update(['br','href']) #this is to handle should there be any HTML tags<br/>text = ' '.join(i for i in data.Text) #this is to combine all text into one huge string.<br/>wordcloud = WordCloud(stopwords = stpwrd).generate(text)</span><span id="ffd1" class="kt ku hh kp b fi mh kw l kx ky">plt.imshow(wordcloud, interpolation = 'bilinear')<br/>plt.axis('off')<br/>plt.show()</span></pre><figure class="kk kl km kn fd ii er es paragraph-image"><div class="er es mj"><img src="../Images/1044dccaaaaf0d07a3c99a255d823e9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*0UkVWJFKkVLYS4-aFWWpqg.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">所有评论的文字云</figcaption></figure><p id="47d9" class="pw-post-body-paragraph jb jc hh jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja ha bi translated">我们可以看到，评论中使用的几个常用词是“爱”和“好”。这意味着单词cloud与之前显示的“分数”计数图具有相同的指示。假设我们的客户不是在讽刺我们，我们的大多数评论都是正面的。:)</p><p id="8a61" class="pw-post-body-paragraph jb jc hh jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja ha bi translated">让我们尝试绘制积极、中性和消极情绪的词云，但添加额外的停用词，如“亚马逊”、“产品”、“一个”和“找到”，因为它经常使用，但感觉对区分情绪没有影响。我们通过查看“分数”栏对评论进行分类，如下所示:</p><ul class=""><li id="342b" class="mk ml hh jd b je jy ji jz jm mm jq mn ju mo ja mp mq mr ms bi translated">积极情绪:5/5分</li><li id="fc97" class="mk ml hh jd b je mt ji mu jm mv jq mw ju mx ja mp mq mr ms bi translated">中性情绪:4/5分</li><li id="ff51" class="mk ml hh jd b je mt ji mu jm mv jq mw ju mx ja mp mq mr ms bi translated">负面情绪:&lt;4 Score</li></ul><blockquote class="kd ke kf"><p id="d402" class="jb jc kg jd b je jy jg jh ji jz jk jl kh ka jo jp ki kb js jt kj kc jw jx ja ha bi translated">Assumption:<br/>这种分类是在考虑数据集的情况下完成的。我们可以看到，大多数评论是5/5，一些是4/5，这意味着可能有客户发现该产品很普通，仅高于平均水平，但给出了4/5的评分。我们稍后将检验这一假设的正确性。</p></blockquote><h2 id="783a" class="kt ku hh bd la my mz na le nb nc nd li jm ne nf lm jq ng nh lq ju ni nj lu nk bi translated">每种情绪的文字云</h2><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="ca7f" class="kt ku hh kp b fi kv kw l kx ky">#we update the stopwords first<br/>stpwrd.update(['Amazon','product','one','find'])</span><span id="d3b6" class="kt ku hh kp b fi mh kw l kx ky">#then we draw the wordclouds for each sentiments<br/>postext = ' '.join(i for i in data[data.Sentiments == 1].Text) #this is to combine all text into one huge string.<br/>poswordcloud = WordCloud(width = 1600,height = 800, stopwords = stpwrd, background_color='white', random_state = 42).generate(postext)</span><span id="62c6" class="kt ku hh kp b fi mh kw l kx ky">fig, (ax1, ax2, ax3) = plt.subplots(1,3,figsize = (25,25))<br/>ax1.imshow(poswordcloud, interpolation = 'bilinear')<br/>ax1.axis('off')<br/>ax1.set_title('Positive Reviews Wordcloud')</span><span id="73be" class="kt ku hh kp b fi mh kw l kx ky">neutext = ' '.join(i for i in data[data.Sentiments == 0].Text) #this is to combine all text into one huge string.<br/>neuwordcloud = WordCloud(width = 1600,height = 800,stopwords = stpwrd, background_color='white', random_state = 42).generate(neutext)</span><span id="7abe" class="kt ku hh kp b fi mh kw l kx ky">ax2.imshow(neuwordcloud, interpolation = 'bilinear')<br/>ax2.axis('off')<br/>ax2.set_title('Neutral Reviews Wordcloud')</span><span id="70f3" class="kt ku hh kp b fi mh kw l kx ky">negtext = ' '.join(i for i in data[data.Sentiments == -1].Text) #this is to combine all text into one huge string.<br/>negwordcloud = WordCloud(width = 1600,height = 800,stopwords = stpwrd, background_color='white', random_state = 42).generate(negtext)</span><span id="8186" class="kt ku hh kp b fi mh kw l kx ky">ax3.imshow(negwordcloud, interpolation = 'bilinear')<br/>ax3.axis('off')<br/>ax3.set_title('Negative Reviews Wordcloud')</span><span id="9f9b" class="kt ku hh kp b fi mh kw l kx ky">plt.show()</span></pre><figure class="kk kl km kn fd ii er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es nl"><img src="../Images/406ce826cbee9b68f72905b0ec2e2d0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cx3SQTgolL1iVkw3_Pc4Mg.png"/></div></div><figcaption class="il im et er es in io bd b be z dx translated">每个情绪上的文字云</figcaption></figure><p id="657c" class="pw-post-body-paragraph jb jc hh jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja ha bi translated">我们很难区分每种情绪，因为“味道”、“风味”和“好”通常用于每种情绪。我们应该用这些词来更新停用词，因为这意味着这些词在区分评论情绪方面是非常多余的。</p><h2 id="7a74" class="kt ku hh bd la my mz na le nb nc nd li jm ne nf lm jq ng nh lq ju ni nj lu nk bi translated">每个观点的文字云(更新)</h2><figure class="kk kl km kn fd ii er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es nl"><img src="../Images/d92f229f24d0d69f441001c8416528ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cQtP6ZZpNbeTYFTKmgjGyA.png"/></div></div><figcaption class="il im et er es in io bd b be z dx translated">每个观点的文字云(更新)</figcaption></figure><p id="9279" class="pw-post-body-paragraph jb jc hh jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja ha bi translated">我们可以看到，我们可以区分积极情绪和消极情绪，因为在消极情绪上没有“爱”，但我们不能区分积极情绪和中性情绪。这意味着我们之前的假设是错误的。我们应该把我们的情绪重新分类为两种情绪，我们应该用“购买”、“制作”和“咖啡”来更新我们的停用词。</p><h2 id="e173" class="kt ku hh bd la my mz na le nb nc nd li jm ne nf lm jq ng nh lq ju ni nj lu nk bi translated">重新分类后的词云</h2><figure class="kk kl km kn fd ii er es paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="er es nl"><img src="../Images/9807f101bcfe074d852ec58b335b27a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cQNGQgqcd_y66PfeP8UOkQ.png"/></div></div><figcaption class="il im et er es in io bd b be z dx translated">关于积极和消极情绪的文字云(重新分类)</figcaption></figure><p id="c96f" class="pw-post-body-paragraph jb jc hh jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja ha bi translated">在将我们的情绪重新分为两类后，我们现在可以区分评论的正面和负面情绪。有额外的冗余单词，但我们不会再更新停用词，因为这意味着通过查看一堆单词云来手动分类积极和消极情绪。</p><h2 id="965e" class="kt ku hh bd la my mz na le nb nc nd li jm ne nf lm jq ng nh lq ju ni nj lu nk bi translated">对ProductId和ProfileName的附加分析</h2><p id="f6e6" class="pw-post-body-paragraph jb jc hh jd b je lw jg jh ji lx jk jl jm ly jo jp jq lz js jt ju ma jw jx ja ha bi translated">我们计划使用文本数据作为输入来创建分类模型，但也可以从我们的数据中添加其他输入来加强分类模型。在我看来，我们还可以尝试从ProductId和ProfileName设计新的变量。</p><pre class="kk kl km kn fd ko kp kq kr aw ks bi"><span id="3da3" class="kt ku hh kp b fi kv kw l kx ky">display(data.ProductId.value_counts())<br/>display(data.ProfileName.value_counts())</span><span id="8686" class="kt ku hh kp b fi mh kw l kx ky">checkprodcrossname = pd.DataFrame(data.groupby(['ProductId','ProfileName']).size()).reset_index()<br/>display(checkprodcrossname)</span><span id="39a1" class="kt ku hh kp b fi mh kw l kx ky">print('\n\n\n Check whether it has a count more than 1 or not')<br/>display(checkprodcrossname[checkprodcrossname[0] &gt; 1])</span></pre><figure class="kk kl km kn fd ii er es paragraph-image"><div class="er es nm"><img src="../Images/e4e8abc8b61932b1db871257f76aa2ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*s9fsrV9_-qGgsSInUL2XCA.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">代码输出的最后一行</figcaption></figure><p id="64d8" class="pw-post-body-paragraph jb jc hh jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja ha bi translated">我们在这里肯定能看到一些东西:</p><ul class=""><li id="4538" class="mk ml hh jd b je jy ji jz jm mm jq mn ju mo ja mp mq mr ms bi translated">一些产品比其他产品更经常得到评论。</li><li id="caf0" class="mk ml hh jd b je mt ji mu jm mv jq mw ju mx ja mp mq mr ms bi translated">一些用户比其他用户写评论的频率更高。</li><li id="ca19" class="mk ml hh jd b je mt ji mu jm mv jq mw ju mx ja mp mq mr ms bi translated">一些产品收到了来自同一用户的多条评论。</li></ul><p id="efc3" class="pw-post-body-paragraph jb jc hh jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja ha bi translated">这意味着我们可以设计一个变量来计算一个产品中的评论数量，用户写评论的频率，以及最终对同一产品写了几篇评论的用户数量。</p><h1 id="d701" class="kz ku hh bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">结论</h1><p id="204b" class="pw-post-body-paragraph jb jc hh jd b je lw jg jh ji lx jk jl jm ly jo jp jq lz js jt ju ma jw jx ja ha bi translated">文字云对于理解我们客户的评论/评论有很大的帮助。在这个机会中，我没有分析“摘要”栏，因为一些客户没有留下他们评论的摘要，我认为如果我们只分析“文本”评论会更直接。不过在其他场合，我们可以尝试使用“Summary”作为文本分类输入。</p><p id="c801" class="pw-post-body-paragraph jb jc hh jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja ha bi translated">我希望我的写作没有让你感到厌烦，因为我试图只写重要的部分。像往常一样，如果有任何批评和见解，我希望你在下面发表评论，因为这篇文章并不完美，事实上可能有很多我可能忽略的缺陷。</p><h1 id="51b8" class="kz ku hh bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">下一部分</h1><p id="29dc" class="pw-post-body-paragraph jb jc hh jd b je lw jg jh ji lx jk jl jm ly jo jp jq lz js jt ju ma jw jx ja ha bi translated">如前所述，我们继续通过文本分类来预测新评论的情感。我们将在我写作的下一部分涉及这一点，链接如下:<br/><a class="ae ip" href="https://sea-remus.medium.com/text-processing-and-classification-intro-part-2-text-classification-9dc58782acb6" rel="noopener">https://sea-Remus . medium . com/text-processing-and-class ification-intro-part-2-text-class ification-9dc 58782 ACB 6</a></p><p id="c380" class="pw-post-body-paragraph jb jc hh jd b je jy jg jh ji jz jk jl jm ka jo jp jq kb js jt ju kc jw jx ja ha bi translated">那里见！；)</p></div></div>    
</body>
</html>