<html>
<head>
<title>Dockerizing Angular Application and Python Backend (Bottle/Flask Framework)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Dockerizing Angular应用程序和Python后端(瓶子/烧瓶框架)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/dockerizing-angular-application-and-python-backend-bottle-flask-framework-21dcbf8715e5?source=collection_archive---------3-----------------------#2021-06-14">https://medium.com/analytics-vidhya/dockerizing-angular-application-and-python-backend-bottle-flask-framework-21dcbf8715e5?source=collection_archive---------3-----------------------#2021-06-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="cae5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">今天，我们将完成这一切。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/5ead7bcf0a1df876e52c78b8a7b792e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5FF8kKLFjuSgLVbaKXsk8w.png"/></div></div></figure><p id="216b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇博客中，我们将了解Docker，安装它并看看它的实现。</p></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h1 id="013a" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">什么是Docker</h1><p id="cd65" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">Docker是一个容器编排工具，旨在简化应用程序的开发、部署和执行。Docker容器基本上是虚拟机的替代品，它运行在主机操作系统上。然而，容器不需要任何预先分配的RAM。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es la"><img src="../Images/4c567b677cbf208ca34ad98b3d53994a.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*6Tbjlxi94G-tbZ9SR5ksZQ.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">基本Docker架构</figcaption></figure></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h1 id="cf31" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">Docker如何工作</h1><p id="7926" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated">通过这个简图可以理解Docker的基本工作原理，</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lf"><img src="../Images/cebc224548307163f5e89541302b508f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*FFPPjbVBDAt-O7UqERAEOw.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">码头工人的基本工作流程</figcaption></figure><p id="2881" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，开发人员将依赖关系和需求写在Docker文件中。Docker文件在执行时产生Docker映像，它包含了所有提到的需求。Docker容器是从这个Docker映像创建的，简单地说，Docker容器是Docker映像的运行时实例。Docker映像被放入Docker Hub，这是Docker映像的公共存储库。你可以在这里找到很多预先创建的Docker图像。您可以提取自己选择的图像并创建自己的容器。</p></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h1 id="b061" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">为什么使用Docker</h1><ol class=""><li id="ec4f" class="lg lh hi ih b ii kv im kw iq li iu lj iy lk jc ll lm ln lo bi translated">我们使用Docker，这样我们的开发、部署和测试环境可以是相同的</li><li id="6f51" class="lg lh hi ih b ii lp im lq iq lr iu ls iy lt jc ll lm ln lo bi translated">微服务架构意味着，如果一项服务停止运行，其他服务仍然可以运行</li><li id="5120" class="lg lh hi ih b ii lp im lq iq lr iu ls iy lt jc ll lm ln lo bi translated">我们不必事先为Docker容器分配RAM或存储空间</li><li id="afb2" class="lg lh hi ih b ii lp im lq iq lr iu ls iy lt jc ll lm ln lo bi translated">降低了每个微服务级别的依赖性</li></ol></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h1 id="8d89" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">在Windows 10上安装Docker</h1><p id="6eef" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated"><strong class="ih hj">第一步:</strong>进入<a class="ae lu" href="https://docs.docker.com/docker-for-windows/install/" rel="noopener ugc nofollow" target="_blank">这个链接</a>下载Docker桌面</p><p id="a740" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二步:</strong>你很可能会看到你的系统上没有安装WSL 2(Docker桌面会提示)，按照这里<a class="ae lu" href="https://docs.microsoft.com/en-us/windows/wsl/install-win10" rel="noopener ugc nofollow" target="_blank">的步骤</a>安装WSL 2。</p><p id="8db2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">(注意:我遵循了该链接下给出的手动步骤，对我来说效果非常好)</p><p id="b315" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤3: </strong>在您的终端中运行这个命令，以验证WSL-2是否已经安装</p><pre class="jf jg jh ji fd lv lw lx ly aw lz bi"><span id="5e6b" class="ma jy hi lw b fi mb mc l md me">&gt; wsl -l -v</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mf"><img src="../Images/f6400ba8794c0dbaf08977f734eb0dd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*-OrMSS4dF--CbX3NLJ-itg.png"/></div><figcaption class="lb lc et er es ld le bd b be z dx translated">命令的输出</figcaption></figure><p id="2e86" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你现在可以运行Docker桌面了。让我们把手弄脏吧。</p></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h1 id="6ab1" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">Dockerizing角度应用程序(仅限用户界面)</h1><p id="8263" class="pw-post-body-paragraph if ig hi ih b ii kv ik il im kw io ip iq kx is it iu ky iw ix iy kz ja jb jc hb bi translated"><strong class="ih hj">步骤1: </strong>转到UI应用程序文件夹(看起来像这样)</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mg"><img src="../Images/a7b93661feadffa42fbf0b6967be6a38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y5-P7qnzpE6pRPoQbTT6EQ.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">GUI文件夹</figcaption></figure><p id="0ec6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二步:</strong>打开cmd，在同一个位置路径运行以下命令，</p><pre class="jf jg jh ji fd lv lw lx ly aw lz bi"><span id="4e5a" class="ma jy hi lw b fi mb mc l md me">&gt; ng build --prod</span></pre><p id="3d85" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将为生产构建您的应用程序，并在上述位置创建一个名为<strong class="ih hj"> dist </strong>的文件夹。</p><p id="c0bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第三步:</strong>让我们在同一个位置路径下创建一个Dockerfile，记得把它命名为<strong class="ih hj"> Dockerfile，</strong>，并在其中写入以下命令</p><pre class="jf jg jh ji fd lv lw lx ly aw lz bi"><span id="3850" class="ma jy hi lw b fi mb mc l md me">FROM nginx:1.17.1-alpine<br/>COPY /dist/macroPlan /usr/share/nginx/html</span></pre><p id="1e24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们从Docker Hub中拉出一个名为<strong class="ih hj"> nginx:1.17.1-alpine </strong>的映像，然后将本地系统上的<strong class="ih hj"> dist/macroPlan </strong>的内容复制到容器中的位置<strong class="ih hj"> /usr/share/nginx/html </strong>。这就是我们如何创建一个简单的Dockerfile文件。</p><p id="3e32" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤4: </strong>要使用这个Docker文件构建Docker映像，运行以下命令，</p><pre class="jf jg jh ji fd lv lw lx ly aw lz bi"><span id="55dc" class="ma jy hi lw b fi mb mc l md me">&gt; docker build -t macroplan .</span></pre><p id="d116" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中，<strong class="ih hj"> macroPlan </strong>是Docker图像的名称，而(。)表示当前目录。您可以通过运行以下命令来检查您的映像是否已经构建，并且您将看到您的Docker映像</p><pre class="jf jg jh ji fd lv lw lx ly aw lz bi"><span id="3809" class="ma jy hi lw b fi mb mc l md me">&gt; docker images</span></pre><p id="19eb" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">步骤5: </strong>为了运行这个Docker映像并创建一个容器，运行命令，</p><pre class="jf jg jh ji fd lv lw lx ly aw lz bi"><span id="94d0" class="ma jy hi lw b fi mb mc l md me">&gt; docker run -p 80:80 macroplan</span></pre><p id="71a1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里80:80是源端口和目的端口。您可以在浏览器中键入localhost:80(如果没有出现，请复制默认Docker应用程序的IP ),然后看到您的应用程序变得栩栩如生。</p><p id="e4d7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">恭喜你，你已经把你的UI应用程序放到了Docker容器中。</p></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><h1 id="857b" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">具有瓶子后端框架的对接角度应用</h1><ul class=""><li id="8510" class="lg lh hi ih b ii kv im kw iq li iu lj iy lk jc mh lm ln lo bi translated"><strong class="ih hj">设置用户界面应用</strong></li></ul><p id="7f08" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过上一节的<strong class="ih hj">步骤1、步骤2 </strong>和<strong class="ih hj">步骤3 </strong>设置UI应用。暂时不要运行第4步和第5步。</p><ul class=""><li id="eb4e" class="lg lh hi ih b ii ij im in iq mi iu mj iy mk jc mh lm ln lo bi translated"><strong class="ih hj">设置后端应用程序</strong></li></ul><p id="62e3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">第一步:转到你的Python文件(API)所在的文件夹位置</p><p id="2190" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第二步:</strong>为你要安装的所有依赖项创建一个requirements.txt文件，用你要安装的库的名字创建一个文本文件就行了，我的看起来像，</p><pre class="jf jg jh ji fd lv lw lx ly aw lz bi"><span id="9c38" class="ma jy hi lw b fi mb mc l md me">pandas<br/>bottle<br/>datetime<br/>json</span></pre><p id="ca8c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">第三步:</strong>为后端API创建docker file as，</p><pre class="jf jg jh ji fd lv lw lx ly aw lz bi"><span id="173f" class="ma jy hi lw b fi mb mc l md me">FROM python:3.7-slim<br/>COPY /locationOfCodeInYourLocal<br/>WORKDIR /DestinationLocationOnContainer</span><span id="ac2c" class="ma jy hi lw b fi ml mc l md me">ENV PYTHONUNBUFFERED 1</span><span id="4271" class="ma jy hi lw b fi ml mc l md me">RUN pip3 install -r /code/requirements.txt</span><span id="88d9" class="ma jy hi lw b fi ml mc l md me">CMD ["python","app.py"]</span></pre><p id="5808" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里我们提取名为<strong class="ih hj"> python:3.7-slim </strong>的映像，并通过运行PIP命令在其上执行安装。我们还使用<strong class="ih hj"> COPY </strong>命令在容器上设置我们的代码，并使用<strong class="ih hj"> WORKDIR </strong>命令设置工作目录。<strong class="ih hj"> CMD </strong>用于运行命令行指令。这里app.py是我们需要运行的Python API文件的名称。</p><ul class=""><li id="1416" class="lg lh hi ih b ii ij im in iq mi iu mj iy mk jc mh lm ln lo bi translated"><strong class="ih hj">编写DOCKER-COMPOSE文件</strong></li></ul><p id="1e7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">Docker Compose是一个在Docker上运行多容器应用程序的工具，使用Compose文件格式定义。合成文件用于定义如何配置组成应用程序的一个或多个容器。将您的合成文件命名为<strong class="ih hj"> docker-compose </strong>，并添加以下详细信息:</p><pre class="jf jg jh ji fd lv lw lx ly aw lz bi"><span id="106a" class="ma jy hi lw b fi mb mc l md me">version: "3.3"<br/>services:<br/>    app-backend:<br/>        build: ./server/<br/>        image: app_backend<br/>        container_name: backend<br/>        restart: always<br/>        ports:<br/>            - 8082:8082</span><span id="953e" class="ma jy hi lw b fi ml mc l md me">app-frontend:<br/>        build: ./GUI/<br/>        image: macroplan<br/>        container_name: frontend<br/>        restart: always<br/>        ports:<br/>            - 4200:4200<br/>        expose:<br/>            - "4200"<br/></span></pre><p id="2559" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们定义源端口和目的端口、各自docker文件的位置(在构建选项下)、映像和容器的名称。我们还指定了公开的端口号。</p><p id="5710" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后我们打开cmd并运行命令，</p><pre class="jf jg jh ji fd lv lw lx ly aw lz bi"><span id="3877" class="ma jy hi lw b fi mb mc l md me">&gt; docker-compose up --build</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mm"><img src="../Images/96f7fed4bb9d539496c560a1f086aecf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GeGUyYLCTXKXX3_X0zkNbg.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">应用程序已经启动并正在运行</figcaption></figure><p id="7dd1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">应用程序现在正在运行。在浏览器中打开本地主机查看它。或者，您可以从Docker桌面上查看相同的内容，它看起来像这样，</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es mn"><img src="../Images/5f48dfea507c742c6b1567734323e123.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bDBRo1hmblu-WL3gGThIJg.png"/></div></div><figcaption class="lb lc et er es ld le bd b be z dx translated">Docker桌面窗口</figcaption></figure><p id="7399" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">点击<strong class="ih hj">在浏览器中打开</strong>设置，查看您的应用程序运行。</p></div><div class="ab cl jq jr gp js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="hb hc hd he hf"><p id="06fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">祝贺你成功来到这里。现在你已经了解了基本的Docker，在进一步尝试之前，一定要学习Docker命令。</p><p id="6dd5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你觉得这很有帮助，请鼓掌。</p></div></div>    
</body>
</html>