<html>
<head>
<title>“ValueError: Lengths must match to compare” when adding more than 2 options in dropdown [Dash-plotly]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在下拉列表中添加两个以上选项时出现“值错误:长度必须匹配才能比较”</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/valueerror-lengths-must-match-to-compare-when-adding-more-than-2-options-in-dropdown-3b4e0a5c77d4?source=collection_archive---------6-----------------------#2021-03-15">https://medium.com/analytics-vidhya/valueerror-lengths-must-match-to-compare-when-adding-more-than-2-options-in-dropdown-3b4e0a5c77d4?source=collection_archive---------6-----------------------#2021-03-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="1c5b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我收到一个请求，要求解决这个人面临了几周的一个错误。</p><p id="c241" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">他使用dash创建了一个仪表板，并有一个下拉菜单用于在图表上显示各种数据。但是，当他在下拉菜单中添加2个或更多选项时，它没有反映在仪表板上，而是显示一个错误消息:<br/> <strong class="ih hj">“值错误:长度必须匹配才能比较”</strong></p><p id="f856" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">网上没有一个单一的解决方案，所以我开始检查哪里出了问题。</p><p id="cf40" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">#不想看解释可以直接跳到代码。</p><p id="79be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">就在那时，我注意到从下拉菜单中传递的输入必须是一个字符串，以便与dataframe中的数据进行比较。现在这对于缺省值来说工作得很好，因为它是一个字符串。但是当你在下拉框中添加另一个选项时，python会自动将它转换成一个列表，这样它就会分崩离析。因为我们无法比较“列表”和“字符串”。因此出现了值误差。<br/>现在我知道了错误到底是什么，我只需要找到一种方法来规避这个问题。</p><p id="156a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">你要做的是:</p><ol class=""><li id="202d" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc ji jj jk jl bi translated"><strong class="ih hj">当multi = False: </strong> <br/>这个错误通常不会在multi为False时遇到，但是万一你面对它这就是你需要做的。为了确保从下拉列表中传递的值是一个字符串，您只需从python自动进行类型转换的列表中提取第一个值，然后用与该值匹配的数据创建一个新的dataframe。最后将这个数据帧(代码中的price_value)传递给图形。</li></ol><p id="78b5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">代码:</p><pre class="jm jn jo jp fd jq jr js jt aw ju bi"><span id="e2e1" class="jv jw hi jr b fi jx jy l jz ka">app.layout = html.Div([<br/>    <br/>    html.H1(children = 'Price',<br/>            style = {<br/>                'text-align': 'center',<br/>                'color':'black'<br/>            } <br/>    ),<br/>   <br/>    <br/>    dcc.Dropdown(id='dropdown', options=[  <br/>        {'label': i, 'value': i} for i in li_name],<br/>## list of unique names</span><span id="087b" class="jv jw hi jr b fi kb jy l jz ka">value=li_name[0],<br/>        multi=True),</span><span id="fde5" class="jv jw hi jr b fi kb jy l jz ka">dcc.Graph(id='price')<br/>])</span><span id="6dbd" class="jv jw hi jr b fi kb jy l jz ka"><a class="ae kc" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>    dash.dependencies.Output('price', 'figure'),<br/>    [dash.dependencies.Input('dropdown', 'value')])</span><span id="aa8e" class="jv jw hi jr b fi kb jy l jz ka">def update_output(value):<br/>    if type(value)!=str:</span><span id="a78e" class="jv jw hi jr b fi kb jy l jz ka">        val = value[0]<br/>        price_value = data[data['name']==val]</span><span id="fae8" class="jv jw hi jr b fi kb jy l jz ka">fig = px.line(price_value, x='date', y='percent',color='blue') <br/>    <br/>    return fig</span></pre><p id="4ebc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.<strong class="ih hj">当multi = True: </strong> <br/>在这种情况下，您必须显示下拉框中添加的所有选项。因此，如果我们想要multi=True，我们将与列表中的每个值匹配的数据存储在一个新的dataframe中，该列表是从dropdown单独传递的。然后将这个新创建的dataframe(代码中的price_value)传递给figure。</p><p id="6356" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">代码:</p><pre class="jm jn jo jp fd jq jr js jt aw ju bi"><span id="6768" class="jv jw hi jr b fi jx jy l jz ka">app.layout = html.Div([<br/>    <br/>    html.H1(children = 'Price',<br/>            style = {<br/>                'text-align': 'center',<br/>                'color':'black'<br/>            } <br/>    ),<br/>   <br/>    <br/>    dcc.Dropdown(id='dropdown', options=[  <br/>        {'label': i, 'value': i} for i in li_name],<br/>## list of unique names</span><span id="e172" class="jv jw hi jr b fi kb jy l jz ka">        value=li_name[0],<br/>        multi=True),</span><span id="1fe5" class="jv jw hi jr b fi kb jy l jz ka">dcc.Graph(id='price')<br/>])</span><span id="72cb" class="jv jw hi jr b fi kb jy l jz ka"><a class="ae kc" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.callback(<br/>    dash.dependencies.Output('price', 'figure'),<br/>    [dash.dependencies.Input('dropdown', 'value')])</span><span id="d1a2" class="jv jw hi jr b fi kb jy l jz ka">def update_output(value):<br/>    if type(value)!=str:<br/>        price_value = data[data['name'].isin(value) ]<br/>    else:<br/>        price_value = data[data['name']==value]</span><span id="72b0" class="jv jw hi jr b fi kb jy l jz ka">fig = px.line(price_value, x='date', y='percent',color='blue') <br/>    <br/>    return fig</span></pre><p id="5b25" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这就是你如何规避值错误，让你的Dash应用程序正常工作。</p><ul class=""><li id="7ff0" class="jd je hi ih b ii ij im in iq jf iu jg iy jh jc kd jj jk jl bi translated">还有一件事，如果你得到一个重复的调用错误，只要再次运行你的dash应用程序，它就会得到解决。即来自app = dash。破折号()</li></ul><p id="99b3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">希望这对你有帮助。谢谢大家！</p><p id="e772" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你对此有任何疑问，你可以在Linkedin上给我发消息:<br/><a class="ae kc" href="http://www.linkedin.com/in/shraddha-shekhar" rel="noopener ugc nofollow" target="_blank">www.linkedin.com/in/shraddha-shekhar</a></p><figure class="jm jn jo jp fd kf er es paragraph-image"><div role="button" tabindex="0" class="kg kh di ki bf kj"><div class="er es ke"><img src="../Images/641aa135ad37781d8de6a691c9f518ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TFyuPnhE9tGKJ7FmJkUnDA.png"/></div></div></figure></div></div>    
</body>
</html>