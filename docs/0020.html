<html>
<head>
<title>Author Identification using Naive Bayes Algorithm — Data Collection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用朴素贝叶斯算法的作者识别—数据收集</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/author-identification-using-naive-bayes-algorithm-1-abeeb88eb862?source=collection_archive---------19-----------------------#2021-01-01">https://medium.com/analytics-vidhya/author-identification-using-naive-bayes-algorithm-1-abeeb88eb862?source=collection_archive---------19-----------------------#2021-01-01</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="3118" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">托马斯·贝叶斯能区分史蒂夫·罗杰斯和托尼·斯塔克吗？</h2></div><p id="93c8" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这篇文章是三部分系列的第一部分，旨在使用dockers以端到端的方式实现机器学习算法。这个问题的潜在目标是使用朴素贝叶斯算法建立一个分类器，它可以判断一个句子更有可能是由史蒂夫·罗杰斯(又名美国队长)或托尼·斯塔克(又名钢铁侠)说出的。我将在这篇文章的剩余部分和后续文章中使用两个角色的名字来适应上下文。</p><p id="0f46" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iy hi"> <em class="js">注:</em> </strong> <em class="js">部分网站不允许抓取数据。在进行任何形式的数据收集之前，请确保您了解网站的条款和条件。以下仅出于教育目的。</em></p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es jt"><img src="../Images/4f3b85c9ee3039f1d7a9a2490d1c21a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v4p9DQcRbbl8J9KxQdWjEw.jpeg"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图片来自Pixabay，鸣谢:<a class="ae kj" href="https://pixabay.com/users/jr_jurassic-6470884/" rel="noopener ugc nofollow" target="_blank">Jr _侏罗纪</a></figcaption></figure><h1 id="82b5" class="kk kl hh bd km kn ko kp kq kr ks kt ku in kv io kw iq kx ir ky it kz iu la lb bi translated">动机</h1><p id="1536" class="pw-post-body-paragraph iw ix hh iy b iz lc ii jb jc ld il je jf le jh ji jj lf jl jm jn lg jp jq jr ha bi translated">朴素贝叶斯算法是为分类问题建立强基线的一种非常强大的算法。它确实值得比在现实世界中得到更多的关注。除了通常的垃圾邮件过滤和情感分析(大多数人认为朴素贝叶斯仅限于此)之外，它还可以用于多种问题，如作者识别、信息检索、单词歧义消除。</p><p id="3662" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这一系列的帖子中，我想详细介绍这个算法，并使用朴素贝叶斯建立一个端到端的机器学习解决方案。它将详细涵盖以下步骤:</p><ol class=""><li id="d755" class="lh li hh iy b iz ja jc jd jf lj jj lk jn ll jr lm ln lo lp bi translated">数据收集和预处理。</li><li id="f5a9" class="lh li hh iy b iz lq jc lr jf ls jj lt jn lu jr lm ln lo lp bi translated">建模和推理。</li><li id="1604" class="lh li hh iy b iz lq jc lr jf ls jj lt jn lu jr lm ln lo lp bi translated">使用Flask，Flasgger通过API端点部署模型。</li><li id="766b" class="lh li hh iy b iz lq jc lr jf ls jj lt jn lu jr lm ln lo lp bi translated">使用Docker封装web应用程序并将其部署到Heroku。</li></ol><p id="ddef" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这篇文章中，我们将讨论如何从网络中获取数据，并对其进行预处理，使其成为适合监督分类问题的形式。</p><h1 id="4f0e" class="kk kl hh bd km kn ko kp kq kr ks kt ku in kv io kw iq kx ir ky it kz iu la lb bi translated">数据收集和预处理</h1><p id="3dda" class="pw-post-body-paragraph iw ix hh iy b iz lc ii jb jc ld il je jf le jh ji jj lf jl jm jn lg jp jq jr ha bi translated">为了建立一个分类器来区分史蒂夫·罗杰斯和托尼·斯塔克的对话，我们需要大量他们都说过的对话。为了做到这一点，我们将不得不求助于网络搜集，从网上免费提供的抄本中提取这些对话。</p><p id="cd1b" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这是我们准备数据的方式:</p><ol class=""><li id="89b9" class="lh li hh iy b iz ja jc jd jf lj jj lk jn ll jr lm ln lo lp bi translated">为了获得美国队长对话的语料库，我们将在电影<strong class="iy hi">《美国队长:第一复仇者联盟》的抄本中刮出队长所说的句子。</strong></li><li id="6149" class="lh li hh iy b iz lq jc lr jf ls jj lt jn lu jr lm ln lo lp bi translated">为了建立一个钢铁侠对话的语料库，我们将从电影<strong class="iy hi">“钢铁侠”的脚本中提取托尼·斯塔克说过的句子。</strong></li><li id="e27b" class="lh li hh iy b iz lq jc lr jf ls jj lt jn lu jr lm ln lo lp bi translated">以上将作为我们的训练数据集；为了评估我们模型的性能，我们将从<strong class="iy hi">“复仇者联盟4：终局之战”中提取船长和托尼的对话。</strong></li></ol><p id="504f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将使用requests库从脚本和beautifulsoup的网页中提取html源代码，解析html以提取对话。让我们看看它是怎么做的。</p><p id="5fd3" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">首先，我们将从fandom的网站上摘录史蒂夫·罗杰斯在《美国队长:第一个复仇者》中的对话。</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="lv lw l"/></div></figure><p id="0f9e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">首先使用请求库中的get方法提取html源代码；接下来使用带有BeautifulSoup4库的html解析器解析整个页面。一旦我们完成了这一步，我们需要找出承载所有对话的兴趣标签。如果你正在使用Chrome，你可以打开网站并按Ctrl/Command + Shift + I来检查页面的html DOM树中的元素。然后点击inspect按钮，将鼠标移动到主页上的对话区域。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es lx"><img src="../Images/484a40f4397b7f66eb10fc52f36551fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZefIQUxehhJ2LDo3HTGKFw.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图片由Vinayak提供</figcaption></figure><p id="7ad3" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">从上面的片段中我们可以看到，对话都包含在<code class="du ly lz ma mb b">&lt;dd&gt;</code>标签中，叙述者总是以粗体突出显示。因此，我们将如下使用该信息。</p><figure class="ju jv jw jx fd jy"><div class="bz dy l di"><div class="lv lw l"/></div></figure><ul class=""><li id="93a5" class="lh li hh iy b iz ja jc jd jf lj jj lk jn ll jr mc ln lo lp bi translated">首先，我们将提取所有的<code class="du ly lz ma mb b">&lt;dd&gt;</code>标签，并将它们存储在一个列表中。为此，我们将使用find_all方法。</li><li id="3c66" class="lh li hh iy b iz lq jc lr jf ls jj lt jn lu jr mc ln lo lp bi translated">接下来，我们将从这些<code class="du ly lz ma mb b">&lt;dd&gt;</code>标签中单独提取<code class="du ly lz ma mb b">&lt;b&gt;</code>标签，并查看这些标签中的文本内容。请注意，冒号有时在粗体标签内，有时不在。所以我们要做的只是选择那些<code class="du ly lz ma mb b">&lt;dd&gt;</code>标签的内容，这些标签在它们各自的粗体标签中有<em class="js"> "Steve Rogers" </em>或<em class="js"> "Steve Rogers:" </em>。</li></ul><p id="7917" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">还要注意，我们只对真实的对话感兴趣，对动作/场景信息等不感兴趣。它被封装在方括号中。所以我们将使用一个正则表达式，用一个空字符串替换那些括号(包括括号)中的内容。</p><p id="a251" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">类似地，我们需要替换文本中的叙述者文本，即“Steve Rogers:”这可以简单地使用每个字符串变量固有的replace函数来完成。</p><p id="c07b" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们可以为<a class="ae kj" href="https://transcripts.fandom.com/wiki/Iron_Man" rel="noopener ugc nofollow" target="_blank">钢铁侠</a>和<a class="ae kj" href="https://transcripts.fandom.com/wiki/Avengers:_Endgame" rel="noopener ugc nofollow" target="_blank">复仇者联盟4：终局之战</a>重复同样的过程，以分别获得Cap和Tony的对话。请注意，您必须分别检查两个网页的元素，并查看其中的细微差别，例如，在钢铁侠脚本中，所有对话都绑定在<code class="du ly lz ma mb b">&lt;p&gt;</code>标签中。此外，在《复仇者联盟:残局》剧本中，叙述者的名字是大写的，这意味着我们将不得不在标记对话的粗体标签中寻找<em class="js">“史蒂夫·罗杰斯”</em>而不是<em class="js">“史蒂夫·罗杰斯”</em>。</p><p id="eca8" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">一旦我们得到了对话列表，我们就可以创建对话的数据框架和它们各自的讲述者/说话者，用于训练和推理。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div class="er es md"><img src="../Images/bd0e74247570c039920f7d8b45278faf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*-EXdWI-Oz9Kg7R4qSu5XnA.png"/></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图片由Vinayak提供</figcaption></figure><p id="6305" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在训练数据集中，我们有544个对话，在测试数据集中，我们有270个对话。这是预料之中的，因为测试数据集仅包含来自一部电影即《复仇者联盟4：终局之战》的对话，而训练数据集包含来自两部电影的对话。对话在两个数据集中的分布如下。</p><figure class="ju jv jw jx fd jy er es paragraph-image"><div role="button" tabindex="0" class="jz ka di kb bf kc"><div class="er es me"><img src="../Images/edcf25fd963b868722e983a672f2bca4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*goCKVMcCqMit9dAO7doeEQ.png"/></div></div><figcaption class="kf kg et er es kh ki bd b be z dx translated">图片由Vinayak提供</figcaption></figure><p id="300d" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">可以看出，训练和测试数据集具有两个类的几乎相似的分布；这总是一件好事。</p><p id="1100" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，我们已经收集了数据并对其进行了预处理，我们准备进入第二部分，即实际构建分类器。同样的，你可以参考这篇文章。</p></div><div class="ab cl mf mg go mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ha hb hc hd he"><h1 id="2dd5" class="kk kl hh bd km kn mm kp kq kr mn kt ku in mo io kw iq mp ir ky it mq iu la lb bi translated">参考</h1><ol class=""><li id="bbea" class="lh li hh iy b iz lc jc ld jf mr jj ms jn mt jr lm ln lo lp bi translated"><a class="ae kj" href="https://github.com/ElisonSherton/rogers-stark-classification" rel="noopener ugc nofollow" target="_blank"> Github repo与此帖子的代码。</a></li><li id="65a8" class="lh li hh iy b iz lq jc lr jf ls jj lt jn lu jr lm ln lo lp bi translated"><a class="ae kj" href="https://www.fandom.com/" rel="noopener ugc nofollow" target="_blank">三部电影抄本粉丝</a>。</li><li id="0c09" class="lh li hh iy b iz lq jc lr jf ls jj lt jn lu jr lm ln lo lp bi translated"><a class="ae kj" href="https://www.pluralsight.com/guides/web-scraping-with-beautiful-soup" rel="noopener ugc nofollow" target="_blank">用PluralSight的beautifulsoup进行网络抓取</a>。</li><li id="a6b8" class="lh li hh iy b iz lq jc lr jf ls jj lt jn lu jr lm ln lo lp bi translated"><a class="ae kj" rel="noopener" href="/swlh/author-identification-with-naive-bayes-algorithm-2-8b43854c1429">朴素贝叶斯模型构建——本系列的下一篇文章。</a></li></ol></div></div>    
</body>
</html>