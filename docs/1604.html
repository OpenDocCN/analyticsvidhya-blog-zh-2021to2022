<html>
<head>
<title>Predictive Modelling Using Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用逻辑回归的预测模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predictive-modelling-using-logistic-regression-2d3a16650b40?source=collection_archive---------8-----------------------#2021-03-09">https://medium.com/analytics-vidhya/predictive-modelling-using-logistic-regression-2d3a16650b40?source=collection_archive---------8-----------------------#2021-03-09</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/734007154ed5b6da55c945f26009011b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tLZ38GHgPyN9S1U1.jpg"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">图片来源:作者</figcaption></figure><div class=""/><h1 id="3d02" class="iu iv hx bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">逻辑回归</h1><p id="bb8c" class="pw-post-body-paragraph js jt hx ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">回归允许我们根据一些输入参数来预测输出。例如，我们可以根据父母的身高和年龄来预测某人的身高。这种类型的回归称为线性回归，因为结果变量是一个连续的实数。</p><p id="69f5" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">但是如果我们想预测一个不是连续数字的东西呢？</p><h1 id="c93d" class="iu iv hx bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">为什么不是线性回归？</h1><p id="1209" class="pw-post-body-paragraph js jt hx ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">假设我们想要预测某个候选人通过x级数学奥林匹克竞赛的可能性。在这种情况下，使用普通的线性回归不起作用，因为将我们的结果视为一个连续的数字是没有意义的，它要么通过，要么失败。在这种情况下，我们使用逻辑回归，因为结果变量是一个二元响应变量。</p><p id="2ab4" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">为什么对这种情况运行线性回归不起作用？</p><p id="91b2" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">二元变量不具有正态分布，这是线性回归分析所需的主要条件。</p><ul class=""><li id="4f8b" class="kv kw hx ju b jv kq jz kr kd kx kh ky kl kz kp la lb lc ld bi translated">目标变量的预测值可以超出0和1，这违反了概率的定义。</li></ul><p id="6fe4" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">概率通常是非线性的，由于x变量的极值效应，可能呈U形。</p><blockquote class="le lf lg"><p id="7850" class="js jt lh ju b jv kq jx jy jz kr kb kc li ks kf kg lj kt kj kk lk ku kn ko kp hb bi translated">逻辑回归用于描述数据，并解释一个因变量与一个或多个名义变量、序数变量、区间变量或比率水平自变量之间的关系。</p></blockquote><p id="6c8c" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">逻辑回归试图:</p><ul class=""><li id="a438" class="kv kw hx ju b jv kq jz kr kd kx kh ky kl kz kp la lb lc ld bi translated">根据一个或多个标称、序数、区间或比率水平独立变量的值，对事件发生的概率进行建模。</li><li id="a5db" class="kv kw hx ju b jv ll jz lm kd ln kh lo kl lp kp la lb lc ld bi translated">针对随机选择的一组观察值，估计事件发生的概率与事件不发生的概率。</li><li id="4784" class="kv kw hx ju b jv ll jz lm kd ln kh lo kl lp kp la lb lc ld bi translated">预测一系列变量对二元响应变量的影响。</li><li id="9283" class="kv kw hx ju b jv ll jz lm kd ln kh lo kl lp kp la lb lc ld bi translated">根据其属于特定类别的可能性的概率得分对观察结果进行分类(例如，通过或失败)。</li></ul><h1 id="f3ab" class="iu iv hx bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">对数赔率</h1><p id="189c" class="pw-post-body-paragraph js jt hx ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">在进入逻辑回归的细节之前，让我们定义一个事件的“几率”。假设p是事件发生的概率..事件可以是任何事情，比如客户没有支付贷款，客户在活动期间出现在零售店，或者客户投诉升级，或者其他任何事情。然后，事件的概率被定义为事件发生的可能性与事件不发生的可能性之比。因此，概率由p/(1-p)给出。注意，p是一个概率值，它位于0和1之间，因此几率可以是任何非负数。</p><p id="ceae" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">回想一下，在线性回归中，我们假设目标变量是预测值的线性函数。在逻辑回归中，我们假设事件的概率对数(即p/(1-p)的对数)是线性函数。注意，概率对数可以是任何实数。如果p大于0.5，则为正，否则为负。</p><h1 id="9421" class="iu iv hx bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">逻辑回归模型</h1><p id="bfb9" class="pw-post-body-paragraph js jt hx ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">在逻辑回归中，我们对比值比的对数进行建模，它是log (p/1-p ),其中p是事件发生的概率，1-p是事件不发生的概率。我们试图通过独立变量的线性组合来估计p。</p><p id="74ae" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">逻辑回归中一个变量的优势比表示在其他变量保持不变的情况下，该变量的优势如何随1个单位的变化而变化。</p><p id="1b71" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">换句话说，逻辑回归生成公式的系数(及其标准误差和显著性水平),以预测感兴趣特征出现概率的<em class="lh">逻辑转换</em>:</p><figure class="lr ls lt lu fd hk er es paragraph-image"><div class="er es lq"><img src="../Images/aca631daa4da4194a57469cbf992a78b.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*RU6btSzTyQVwSyan-KXhrA.png"/></div></figure><p id="70f9" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">其中，β0是Y轴截距，e是模型中的误差，β1是独立因子x1的系数(斜率)，β2是独立因子x2的系数(斜率)，依此类推。</p><p id="79ca" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">上面的等式给出了如下的概率:</p><figure class="lr ls lt lu fd hk er es paragraph-image"><div class="er es lv"><img src="../Images/2c3e2d57a99829e38b207f63e296d439.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*GJ8ge682ls_fOCPjWjUWkA.png"/></div></figure><p id="0579" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">其中b0、b1、b2等。是β0，β1，β2等的估计值。各自地</p><p id="29a1" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">由于我们在这里使用的是二项式分布(因变量)，我们需要选择一个最适合该分布的链接函数。这个链接函数是一个logit函数。在上面的等式中，选择参数以最大化观察样本值的可能性，而不是最小化误差平方和(像在普通回归中)。</p><p id="82b1" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">回想一下，在线性回归中，如果我们绘制预测变量与目标变量的关系图，我们应该得到一个更接近直线的图。在逻辑回归的情况下，如果我们绘制事件的概率对预测值，我们将得到一个S形曲线。</p><figure class="lr ls lt lu fd hk er es paragraph-image"><div class="er es lw"><img src="../Images/edfcf822e7a41a31140408ca14dbeaa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*xraWSt1AXFa7RbdLzkm0Vw.png"/></div></figure><h1 id="17db" class="iu iv hx bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">逻辑回归的例子</h1><p id="65e4" class="pw-post-body-paragraph js jt hx ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">让我们讨论逻辑回归在电信行业中的应用。一家电信公司的分析师想要预测客户流失的概率。目标变量是客户流失，其中零表示无流失，一表示流失。独立变量是收入、信用额度、年龄、未结算金额、当前账单、未账单金额、上月账单金额、每日呼叫、上次使用、当前使用、数据使用比例等。分析师现在要么为非事件(即没有流失)建模，要么为事件(即流失)建模。一旦建立了逻辑回归模型，输出解释如下:</p><ul class=""><li id="801a" class="kv kw hx ju b jv kq jz kr kd kx kh ky kl kz kp la lb lc ld bi translated">检查是否建立了正确的概率模型，即客户流失或无客户流失。</li><li id="48e7" class="kv kw hx ju b jv ll jz lm kd ln kh lo kl lp kp la lb lc ld bi translated">检查收敛性是否令人满意。如果不满足收敛性，则使用另一个独立变量组合重新运行模型。</li><li id="9ced" class="kv kw hx ju b jv ll jz lm kd ln kh lo kl lp kp la lb lc ld bi translated">通过分析似然比的p值、Wald检验和得分来检验全局零假设。所有这些应该都很重要。</li><li id="f470" class="kv kw hx ju b jv ll jz lm kd ln kh lo kl lp kp la lb lc ld bi translated">检查截距和所有变量的最大似然估计，因为这些应该是重要的。逻辑回归系数(估计值)显示了独立变量中一个单位变化的感兴趣特征的预测对数概率的变化(当bi&gt;0时增加，当bi&lt;0时减少)。</li></ul><blockquote class="le lf lg"><p id="702e" class="js jt lh ju b jv kq jx jy jz kr kb kc li ks kf kg lj kt kj kk lk ku kn ko kp hb bi translated">在每个阶段，删除无关紧要的变量，重新运行模型，直到只剩下重要的变量。也检查奇数比估计，但这些在模型拟合方面不是特别重要。</p></blockquote><ul class=""><li id="ae9e" class="kv kw hx ju b jv kq jz kr kd kx kh ky kl kz kp la lb lc ld bi translated">检查一致性(即一致性百分比、不一致性百分比和并列百分比)。一致性越高，模型越好。理想情况下，一致性值应该大于0.5。</li><li id="6fda" class="kv kw hx ju b jv ll jz lm kd ln kh lo kl lp kp la lb lc ld bi translated">检查Hosmer-Lemeshow检验统计数据，了解逻辑模型的拟合优度。</li><li id="60bb" class="kv kw hx ju b jv ll jz lm kd ln kh lo kl lp kp la lb lc ld bi translated">检查逻辑模型的KS统计。KS越高，模型越好</li><li id="c49d" class="kv kw hx ju b jv ll jz lm kd ln kh lo kl lp kp la lb lc ld bi translated">在十分位数水平检查响应变量的等级排序。因变量应在10个十分位数之间排序。</li></ul><p id="7cdb" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">该过程的结果将是与每个个体观察相关联的概率，其将指示客户流失或不流失的概率(根据建模的概率)。</p><h1 id="18e6" class="iu iv hx bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">模型验证</h1><p id="7983" class="pw-post-body-paragraph js jt hx ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">一旦开发出任何预测模型，就必须经常评估其对所需目标样本的预测能力和有效性。这个过程被称为“预测模型验证”。在一段时间内，任何预测模型的预测强度都可能与原始开发样本不同。</p><p id="9f16" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">发生这种情况的原因有:</p><ul class=""><li id="fd22" class="kv kw hx ju b jv kq jz kr kd kx kh ky kl kz kp la lb lc ld bi translated">目标人群的变化。</li><li id="a67e" class="kv kw hx ju b jv ll jz lm kd ln kh lo kl lp kp la lb lc ld bi translated">一个或多个自变量不可用。</li><li id="be33" class="kv kw hx ju b jv ll jz lm kd ln kh lo kl lp kp la lb lc ld bi translated">特定变量解释的变化(例如，由于通货膨胀，任何消费品的价格在一段时间内都可能发生显著变化，因此对绝对值的解释也会发生变化)。</li></ul><blockquote class="le lf lg"><p id="e99b" class="js jt lh ju b jv kq jx jy jz kr kb kc li ks kf kg lj kt kj kk lk ku kn ko kp hb bi translated">如果模型显著恶化，建议要么重新校准模型(使用相同的变量集)，要么开发全新的模型。</p></blockquote><h1 id="025a" class="iu iv hx bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">模型验证是如何完成的？</h1><p id="2cb0" class="pw-post-body-paragraph js jt hx ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">验证通常通过评估验证样本的某些关键指标统计数据，并将其与开发样本的数据进行比较来完成。在及时和不及时样本上验证它是至关重要的——“及时样本”是反映模型开发数据的数据样本，并且选自相同的年份(群组)。类似地，“过时样本”是反映模型开发数据的数据样本，但从不同时间点的年份(群组)中选择。</p><h1 id="7bc2" class="iu iv hx bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">检查K-S统计量:</h1><p id="ce7b" class="pw-post-body-paragraph js jt hx ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">这种统计中最相关的一种是“K-S统计”，它给出了基于特定模型的可重质和非可重质之间的差异程度的估计。如果指标统计“足够接近”开发样本，则认为模型是稳定和有效的。什么程度的差异是可以接受的，这是一个完全主观的标准，可能因情况而异。通常，如果验证样本的K-S统计量在开发样本的10%以内，则认为是可以接受的。</p><h1 id="36a6" class="iu iv hx bd iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr bi translated">人口稳定指数(PSI):</h1><p id="d00e" class="pw-post-body-paragraph js jt hx ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp hb bi translated">PSI给出了模型的目标群体相对于模型分数是否在一段时间内保持“稳定”的视图。例如，在理想情况下，开发样本中前10%人口的模型得分截止值应该产生10%的账户，即使在验证样本中也是如此。然而，在大多数现实生活场景中，情况并非如此，总体可能会相对于模型得分发生偏差。如果偏差超过可接受的阈值，建议重新校准/重新开发模型。PSI是对其进行量化的方法之一。</p><p id="d372" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">为了计算PSI，将开发样本分成相等的组，并计算每个组的模型得分临界值。张贴这些临界值应用于验证样本，并获得每组的实际百分比。</p><p id="ce46" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">PSI的计算方式如下(此处“n”是一个变量被分成的仓的数量):</p><figure class="lr ls lt lu fd hk er es paragraph-image"><div class="er es lx"><img src="../Images/cde9083c89aed1427561d3875072b44a.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*GIqBvXk8DzYw0bn4Gxry1Q.png"/></div></figure><p id="7765" class="pw-post-body-paragraph js jt hx ju b jv kq jx jy jz kr kb kc kd ks kf kg kh kt kj kk kl ku kn ko kp hb bi translated">根据经验法则，PSI &lt;0.1 would mean that there is “insignificant change” in the development and validation populations “moderate change” and the learner should look at other validation parameters before deciding the next steps. PSI &gt; 0.25将意味着群体中的“显著变化”，理想情况下，应该重新校准/重新开发模型分数。</p></div></div>    
</body>
</html>