<html>
<head>
<title>Dynamic Optimization in Python: Rocket Soft Landing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的动态优化:火箭软着陆</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/dynamic-optimization-in-python-rocket-soft-landing-a5a68eaf3b94?source=collection_archive---------1-----------------------#2021-07-24">https://medium.com/analytics-vidhya/dynamic-optimization-in-python-rocket-soft-landing-a5a68eaf3b94?source=collection_archive---------1-----------------------#2021-07-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="effd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在<a class="ae jc" rel="noopener" href="/analytics-vidhya/optimization-modelling-in-python-metaheuristics-with-constraints-c22b08c487e8">的<a class="ae jc" rel="noopener" href="/analytics-vidhya/optimization-modelling-in-python-multiple-objectives-760b9f1f26ee">系列</a>之前的</a> <a class="ae jc" rel="noopener" href="/analytics-vidhya/optimization-modelling-in-python-scipy-pulp-and-pyomo-d392376109f4">文章</a>中，我描述了几个优化问题以及解决它们的不同方法。所有这些问题都有一个共同点——它们是静态的。这意味着被研究的系统及其变量不随时间变化。然而，大多数有趣和相关的现实世界经济问题总是有时间维度。运筹学有解决这类问题的工具包吗？</p><p id="36c8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">动态优化</strong>——是一种处理“多阶段”问题的优化类型，这些问题的变量会随着状态或时间的变化而变化。这种问题通常由<strong class="ig hi">状态变量x(t) </strong>来表征，这些状态变量确定系统在时间<strong class="ig hi"> t </strong>的状态。通常这些状态满足马尔可夫性质，即<strong class="ig hi"> x(t+1) </strong>受<strong class="ig hi"> x(t) </strong>的值影响。</p><p id="1d88" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">动态优化问题也有所谓的<strong class="ig hi">控制或动作变量u(t) </strong>。这些变量决定系统在每一步<strong class="ig hi"> t </strong>的动态，从而影响<strong class="ig hi"> t+1 </strong>的状态值。</p><p id="1124" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这类系统的时间演化通常由<strong class="ig hi">状态方程</strong>来支配，而状态方程是<strong class="ig hi"> <em class="jd">预先知道的</em> </strong>(强化学习改为学习它们)。这些方程有时被称为运动方程或过渡方程，通常是描述系统物理性质的微分方程。</p><p id="85b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，我们有<strong class="ig hi">目标函数</strong>——在计划时间范围内某个成本函数的总和或积分。</p><p id="8613" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">解决这类问题有几种方法，例如<strong class="ig hi">最优控制理论</strong>或<strong class="ig hi">动态规划</strong>。然而，这里我们将简单地尝试使用现代优化包同时求解每个时间步的所有状态方程。</p></div><div class="ab cl je jf go jg" role="separator"><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj jk"/><span class="jh bw bk ji jj"/></div><div class="ha hb hc hd he"><p id="c1f0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们将动态优化应用于一些现实世界的问题，例如火箭软着陆。作为一个例子，让我们试着模拟最近成功的<strong class="ig hi">星际飞船SN15 </strong>着陆。也就是说，我将尝试优化重物从某个高度(比如说海拔5公里)下降并在所需点软着陆的2D轨迹，并服从相关的物理力(重力拉力、火箭发动机推力、风等)。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es jl"><img src="../Images/066394372a21deff498e6af9fe36a584.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pC-GDhkiqOJoWsDJX4uoyw.png"/></div></div><figcaption class="jx jy et er es jz ka bd b be z dx translated">作用在火箭上的主要力</figcaption></figure><h1 id="040c" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">模型参数</h1><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es kz"><img src="../Images/37e865a97a4daa0e7d546df582ba9217.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_lNAsbV521I-z5tjDBMYkA.png"/></div></div></figure><h1 id="7dfd" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">状态方程</h1><p id="1c71" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">现在让我们描述系统的动力学。在我们简化的2D案例中，动力学由以下牛顿方程描述(忽略风阻或侧风效应):</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lf"><img src="../Images/c5775ac4c07d854eafa9f263534d08eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7dqdDQU4MOhC8HQfojuq3A.png"/></div></div></figure><p id="c4e2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们现在任务是将这个动态系统公式化为最优化问题，产生'最优'或至少物理上合理下降轨迹。在深入实施细节之前，重要的是要理解控制火箭在空间中运动的两个主要建模组件— <strong class="ig hi">状态变量</strong>和<strong class="ig hi">控制参数</strong>。</p><p id="c449" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在每个时间步长，系统的状态由一组有限的变量描述:位置(x，y)，速度，与垂直位置的角度偏差，角速度。我们无法控制这些(除了从边界值)，优化模型应该给我们每个时间步的系统状态。</p><p id="5b28" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">控制参数是——推力值和推力偏转角。模型将使用控制参数、运动方程和边界值来寻找状态值。</p><h1 id="083f" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">履行</h1><p id="1dab" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">我们将使用python优化模块<strong class="ig hi"> Pyomo </strong>和非线性解算器<strong class="ig hi"> Ipopt </strong>。Pyomo是一个优秀的开源软件包，可用于制定非常多样化的优化问题集，或用于一般的数值微分/积分。</p><p id="282b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用pyomo离散化这样的动态系统非常简单，感觉非常自然。在声明变量之后，上面描述的所有运动微分方程都可以写成每个时间步长的独立约束。从而确保系统在每一步都服从运动动力学。</p><p id="3810" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">目标或成本函数可能是问题最重要的部分。理想情况下，我们需要同时优化几个属性:燃料消耗、发动机偏转角、火箭角速度等。然而，多目标优化是非常困难的，并且总是给你几个可能的解决方案。因此，我不确定这种方法是否用于实际的星际飞船着陆模拟。为了简单起见，我将这三个目标合并成一个任意权重的目标，可以手动调整。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lg"><img src="../Images/c171092fa3366ab538260c97ed012178.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*keS7dgLucxjPiUOnetjZhw.png"/></div></div></figure><p id="d1e2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">取决于系数k1、k2、k3的值，下降轨迹看起来可能非常不同:)。生成最优着陆轨迹和着陆动画的代码是<a class="ae jc" href="https://github.com/Igor-Shvab/Rocket_soft_landing/blob/main/pyomo_rocket_soft_landing.ipynb" rel="noopener ugc nofollow" target="_blank">这里是</a>。</p><h1 id="829f" class="kb kc hh bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">结果</h1><p id="7c18" class="pw-post-body-paragraph ie if hh ig b ih la ij ik il lb in io ip lc ir is it ld iv iw ix le iz ja jb ha bi translated">下面的图表显示了火箭高度的变化，垂直速度，推力的使用等，在一些特定的系统配置。从5公里高度开始，在着陆点左侧600米，零初始下降速度(v_x = 0)，非常强的左侧冲力(v_y = 500米/秒)。你可以改变这些初始坐标或目标函数，看看火箭如何表现。</p><figure class="jm jn jo jp fd jq er es paragraph-image"><div role="button" tabindex="0" class="jr js di jt bf ju"><div class="er es lh"><img src="../Images/8830bdccf49a1b7dd82c4a1c13229f4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SlXIuo2p2xNi59bmedi41Q.png"/></div></div></figure><p id="8151" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">显然这个解决方案是不实际的，因为下降速度太快了。真实的火箭着陆场景很可能有一套可行的预先计算的轨道，但最重要的是，真实的着陆是使用<strong class="ig hi">模型预测控制</strong>技术模拟的。在每一个时间步，系统接收关于其实际和预测空间位置的<strong class="ig hi">状态反馈</strong>，然后如果偏差过大，自动修正自身(使用推进器和驱动鳍)。</p><p id="f92e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，这里是视频。</p><figure class="jm jn jo jp fd jq"><div class="bz dy l di"><div class="li lj l"/></div></figure></div></div>    
</body>
</html>