<html>
<head>
<title>Build a new-age Cost-Effective Business Intelligence System using Azure Data Lakehouse and Synapse Serverless SQL Pool</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Azure Data Lakehouse和Synapse无服务器SQL池构建一个新时代的经济高效的商业智能系统</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/build-a-new-age-cost-effective-business-intelligence-system-using-azure-data-lakehouse-and-synapse-46d361ba33e6?source=collection_archive---------6-----------------------#2021-08-28">https://medium.com/analytics-vidhya/build-a-new-age-cost-effective-business-intelligence-system-using-azure-data-lakehouse-and-synapse-46d361ba33e6?source=collection_archive---------6-----------------------#2021-08-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="e596" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是我之前的<a class="ae jc" rel="noopener" href="/analytics-vidhya/data-lakehouse-architecture-azure-synapse-serverless-sql-pools-78a7a142ca37">文章</a>的延续，在这篇文章中，我们将看到如何使用Azure Data Lakehouse和Azure Synapse无服务器SQL Pool为您的企业构建一个新时代的BI系统。</p><p id="16c2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下图显示了从源仪表板到终端用户仪表板的数据流</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/47716f5c1883e7fc6cb204cbad3977ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*olX7n4GD1wxTucwnsGu3-Q.png"/></div></div></figure><p id="67a3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们看看如何在数据流中构建每个组件</p><p id="81f9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">步骤1:创建Azure Synapse工作区<br/>步骤2:创建Synapse管道<br/>步骤3:创建DataLakeHouse数据库<br/>步骤4:创建外部表和视图<br/>步骤5:创建表格模型<br/>步骤6:创建仪表板</p><h1 id="fa38" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">Azure Synapse工作区</h1><p id="4394" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">→打开Azure Portal并+创建一个资源Synapse Analytics) <br/> →单击创建Synapse Analytics并提供所需的所有详细信息<br/> →您可以创建一个新的data lake存储帐户或使用现有帐户<br/> →您可以创建一个新的文件系统或使用存储帐户中的现有文件系统<br/> →准备就绪后，单击查看创建(保持其余选项卡的默认设置，除非您想要更改它们)—对于此示例，我使用了其他选项卡的默认设置</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ks"><img src="../Images/5241cbc1a68bb9ed6c1c74acd2760e8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*wd3pKJ-C-WxKgTWQjsXIpw.png"/></div></figure><p id="8476" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦资源准备就绪，您将会看到在您的RG中创建了两个主要资源(+相关资源)</p><p id="a5ae" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→ Synapse分析工作区<br/> →数据湖存储账户</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kt"><img src="../Images/f13c16712a1c2b2882b9cfc7e126646d.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*q0cOJNhS03jIaClXNfvXoQ.png"/></div></figure><h1 id="522c" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">数据接收— Azure Synapse管道复制数据</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ku"><img src="../Images/77eedee8d1dad0f6570f8ed39bcfad79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xCtcGeBgbBlC9b6z3wIW_A.png"/></div></div></figure><p id="8ef4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→对于此示例，我使用本地计算机中的文件作为源→使用Azure Data Synapse管道—复制数据工具将文件从您的本地文件系统复制到Azure Data Lake存储</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kv"><img src="../Images/fb36ae5266d58306af2cb19eef5775b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*QCnW16cb9Yv_fJ0QeF-VqA.png"/></div></figure><p id="3c62" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→点击复制数据工具→点击内置复制任务</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kw"><img src="../Images/01d1dc85c35b2b7c31a74b6878484fbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GiqKkoQ0nWucQOFQr_HYmA.png"/></div></div></figure><p id="870c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→按照步骤操作并创建一个复制数据管道<br/> →如果您的数据位于内部网络中，您需要配置一个自托管集成运行时来连接它。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es kx"><img src="../Images/8ef8486ceea3b625d7a53ff55c06735c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*n2baIMfinLi0Jc-7YeOiRw.png"/></div></figure><p id="0f96" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→如果尚未安装自托管IR，则按照如下所示进行安装和配置(它已经安装在我的机器上)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ky"><img src="../Images/4bf090e91980af3a6a776a51bcbae421.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*4l_ox4RjLeOD_ud7HRdT8g.png"/></div><figcaption class="kz la et er es lb lc bd b be z dx translated">安装自托管IR</figcaption></figure><p id="31b3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→管道成功复制了数据</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ld"><img src="../Images/441a86dd2ba34f37536f5de6e42fa44d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*ab4d--tiaK2888LZjk1B9w.png"/></div></figure><p id="6f2c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→我能看到两者。CSV文件复制到我的存储容器</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es le"><img src="../Images/f9e53981809ea0267cc044b717410792.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*UkfC2R0WWIPpxquRonZO_g.png"/></div></figure><h1 id="490a" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">使用无服务器SQL池创建数据仓库</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lf"><img src="../Images/214e122d02c403be4852b63a56521413.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eUIVn0Jhvp-4LQZWQwMf-A.png"/></div></div></figure><p id="b23d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→打开Synapse工作区，点击左侧菜单中的脚本</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lg"><img src="../Images/dd5b1c18c82f2795bcd976906906dc39.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*zv_Zj_BcQOJySeWynCGKtg.png"/></div></figure><p id="c3f8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→在编辑器上输入下面的脚本并执行它，根据<strong class="ig hi">内置</strong>无服务器SQL池创建数据库</p><blockquote class="lh li lj"><p id="9205" class="ie if lk ig b ih ii ij ik il im in io ll iq ir is lm iu iv iw ln iy iz ja jb ha bi translated">创建数据库销售</p></blockquote><p id="568f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→ Builtin是Azure Synapse Workspace附带的默认无服务器SQL池<br/> →创建数据库后，下一步是创建数据库范围的凭据，以便能够访问受SAS保护的Azure存储帐户。</p><blockquote class="lh li lj"><p id="2534" class="ie if lk ig b ih ii ij ik il im in io ll iq ir is lm iu iv iw ln iy iz ja jb ha bi translated">C <!-- -->创建数据库范围的凭据[aaaa] <br/>，其中IDENTITY= '共享访问签名'，<br/>SECRET = ' SV = 2018–03–28&amp;ss = BF&amp;SRT = SCO&amp;sp = rl&amp;ST = 2019–10–14t 12% 3a 10% 3a 25 z&amp;se = 2061–12–31t 12% 3a 10% 3a 00 z【t</p></blockquote><p id="599d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→创建引用受SAS密钥保护的Azure存储帐户的外部数据源</p><blockquote class="lh li lj"><p id="a5b9" class="ie if lk ig b ih ii ij ik il im in io ll iq ir is lm iu iv iw ln iy iz ja jb ha bi translated">用(<br/>LOCATION = '<a class="ae jc" href="https://sqlondemandstorage.blob.core.windows.net'" rel="noopener ugc nofollow" target="_blank">https://sqlondemandstorage . blob . core . windows . net '</a>，<br/> CREDENTIAL = aaaa <br/>)创建外部数据源xxxx</p></blockquote><h1 id="0142" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">创建外部表和视图</h1><p id="06b8" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">属性在SalesBI数据库中创建一个外部表。存储帐户中的CSV文件</p><blockquote class="lh li lj"><p id="89a9" class="ie if lk ig b ih ii ij ik il im in io ll iq ir is lm iu iv iw ln iy iz ja jb ha bi translated">使用[sales bi]；<br/> GO <br/>创建外部表factSales <br/> ( <br/>【国家】VARCHAR(100)COLLATE Latin1 _ General _ bin 2，<br/>【项目类型】VARCHAR(100)COLLATE Latin1 _ General _ bin 2，<br/>【销售渠道】VARCHAR(100)COLLATE Latin1 _ General _ bin 2，<br/>【订单优先级】VARCHAR(100)COLLATE Latin1 _ General _ bin 2，<br/>【订单日期】DATETIME2，</p><p id="8590" class="ie if lk ig b ih ii ij ik il im in io ll iq ir is lm iu iv iw ln iy iz ja jb ha bi translated">创建外部表dim region<br/>(<br/>[name]VARCHAR(100)COLLATE Latin1 _ General _ bin 2，<br/>[alpha-2]VARCHAR(100)COLLATE Latin1 _ General _ bin 2，<br/>[alpha-3]VARCHAR(100)COLLATE Latin1 _ General _ bin 2，<br/>[country-code]VARCHAR(100)COLLATE Latin1 _ General _ bin 2，<br/>[iso _ 3166–2]VARCHAR(11</p></blockquote><p id="c9b6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→现在数据库和表都准备好了，是时候创建视图(如果需要)来添加一些自定义列和应用业务逻辑了</p><p id="ee8e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→创建数据库视图以添加新的计算列</p><blockquote class="lh li lj"><p id="68a2" class="ie if lk ig b ih ii ij ik il im in io ll iq ir is lm iu iv iw ln iy iz ja jb ha bi translated">创建视图vwFactSales <br/>作为<br/>选择<br/>【国家】<br/>【项目类型】<br/>【销售渠道】<br/>【订单优先级】<br/>【订单日期】<br/>【订单ID】<br/>【发货日期】<br/>【售出单位】<br/>【单价】<br/>【单位成本】<br/>【总收入】<br/>【总成本】<br/></p></blockquote><h1 id="c9c1" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">使用DataLakeHouse创建表格模型</h1><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lo"><img src="../Images/7d320529e8de36faa61398a43ad1a4ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*APZnXlI1-8ecUirS-wszbw.png"/></div></div></figure><p id="6f52" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→使用无服务器SQL池端点连接到LakeHouse并导入表数据<br/> →创建模型并将其部署到Power BI工作区</p><blockquote class="lh li lj"><p id="a040" class="ie if lk ig b ih ii ij ik il im in io ll iq ir is lm iu iv iw ln iy iz ja jb ha bi translated">在这篇文章中，我不会讨论如何创建和部署模型,我会为此写一个单独的博客</p></blockquote><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lp"><img src="../Images/531ce04c8471aab2cf868340eb713b2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*qQDmBxsMd_IM3bVliJ60NQ.png"/></div></figure><p id="f5f9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→模型成功部署后，刷新它以将数据放入模型</p><p id="a077" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→等待模型刷新，然后从Power BI Desktop连接以创建报告<br/> →我部署的模型已经刷新并准备好访问。</p><h1 id="9701" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">创建一个Power BI仪表板并发布</h1><p id="6bd9" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">→连接到新部署的模型并检查字段</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lq"><img src="../Images/75471470af55d752d0233be1bac2025c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*oVO1sBIe026wDVPyYxdFHA.png"/></div></figure><p id="1c0b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→让我们玩玩它，创造一些美丽的视觉效果</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lr"><img src="../Images/eeef74e668cced8327c79c33b229cee6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ZJ2eo_6vXHNhWRn50FEZg.png"/></div></div></figure><p id="7543" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→将仪表板发布到Power BI门户，并与您的团队分享</p><p id="3bb4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">→我们将在我的下一篇文章中讨论该解决方案的成本效益，直到保持安全和健康。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es lq"><img src="../Images/9a75c619b604dd119c0a58f401fb7152.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*4H-Oit_GoQIyi7v5CjGbaw.png"/></div><figcaption class="kz la et er es lb lc bd b be z dx translated"><a class="ae jc" href="https://quoteideas.com/respect-quotes/" rel="noopener ugc nofollow" target="_blank">参考号</a>:</figcaption></figure></div></div>    
</body>
</html>