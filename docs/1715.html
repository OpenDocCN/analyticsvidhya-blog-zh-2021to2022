<html>
<head>
<title>Understanding LVM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解LVM</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/understanding-lvm-436e629960ea?source=collection_archive---------18-----------------------#2021-03-14">https://medium.com/analytics-vidhya/understanding-lvm-436e629960ea?source=collection_archive---------18-----------------------#2021-03-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="6975" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将LVM与Hadoop集成在一起！</p><p id="288c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了更好地理解LVM的用途，我们将讨论Hadoop。所以，如果你是Hadoop新手，我推荐你阅读我之前关于Hadoop基础的文章<a class="ae jc" rel="noopener" href="/analytics-vidhya/the-basics-of-hadoop-85bd75a987f6"/>。</p><p id="fa8f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们知道，运行NameNode进程的Hadoop主节点负责HDFS的所有文件系统名称空间，而从节点提供实际的存储空间来存储文件和文件夹。</p><p id="6d3a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这篇博客的目的是了解<strong class="ig hi">逻辑卷</strong>的基本概念，以及我们如何使用它为HDFS提供存储。</p><p id="d641" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">假设你有两个硬盘插入你的机器。第一个硬盘的大小为20 GB，另一个为40 GB。在将这台机器配置为从系统时，您决定从第二个硬盘上的分区(40 GB)中捐赠空间。为了简单起见，假设我们在这个硬盘上只有一个分区，它几乎是硬盘的大小，尽管考虑到为存储元数据保留的空间，它会稍微小一点。此外，假设当前集群只包含一台机器，即单节点集群。</p><p id="98bb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">已经为集群设置了主服务器和从服务器，您的一个HDFS客户端想要上传一个大小为43G的文件。你一定猜对了，上传最终会因为空间不足而失败。</p><p id="148d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您意识到您的另一个20GB硬盘未使用，想知道您是否可以将该硬盘的空间捐赠给HDFS的客户。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jd"><img src="../Images/aea16538a9fa7982daf034c7140643a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*ZnGUl1zNw9IQOYKCYjMTCQ.png"/></div></figure><p id="c091" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">您将如何同时从两个磁盘共享存储？</strong></p><p id="70df" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">好了，在这里我向您介绍逻辑卷的概念，这样您就不必一直疑惑了。</p><p id="718a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">那么，我们开始吧。</p><p id="5054" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们有两个硬盘，我们想用这两个硬盘创建一个逻辑硬盘。第一步是从我们拥有的硬盘创建一个物理卷。</p><p id="6ba1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jl">注意:我使用的是Linux虚拟机，并且我的虚拟机已经连接了两个磁盘。</em></p><ol class=""><li id="64bb" class="jm jn hh ig b ih ii il im ip jo it jp ix jq jb jr js jt ju bi translated">创建物理卷。</li></ol><p id="205b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可以看到我这里有两个设备，/dev/sdb和/dev/sdc。</p><p id="9143" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了简单起见，两个磁盘各为4GB。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es jv"><img src="../Images/da39da659dce7ae24da8baba687c4ca7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*7k7teTRuDs3hJqDRfLKsfA.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">图一</figcaption></figure><p id="3a6b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我们想用它们创建物理卷。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es jv"><img src="../Images/cefa9454d5d2ebcc574d0b72b7946f15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*-XQhseSN5sUFUStAsINhQA.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">图2</figcaption></figure><p id="c7b7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.创建卷组。</p><p id="2278" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">创建卷组就是将我们创建的两个物理卷合并成一个存储。</p><p id="5d12" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"><em class="jl"># vgcreate&lt;VG名称&gt; /dev/sdb /dev/sdc </em> </strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es jv"><img src="../Images/fafe5ccd9f5e4a47f5adef61e9cbd922.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*J82xDphU0fY1IUp8p6R-AA.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">图3</figcaption></figure><p id="2ddd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用<strong class="ig hi"> <em class="jl">命令vgdisplay，</em> </strong>可以查看详细信息。</p><p id="cb82" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如您所见，它为我们提供的大小是用于创建VG的两个物理卷的总和。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es jv"><img src="../Images/507c5c4c669673ca8bc18db8ae1e0b36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*zlF_KMZ1p3Y-XvG6iiNNNw.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">图4</figcaption></figure><p id="b38f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，将这个卷组视为一个全新的硬盘。</p><p id="4504" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.接下来，就像我们在静态硬盘中创建分区一样。我们也将在这里创建一个逻辑卷/逻辑分区。</p><p id="0e3c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"><em class="jl"># lvcreate—size&lt;size-of-partition&gt;—name&lt;name-of-partition&gt;&lt;name-of-VG&gt;</em>T3】</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jv"><img src="../Images/20fe5c206ef9eb6fde441a02ff9cb7dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*V7kty9bhEcR_jvVM6p2RAA.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">图5</figcaption></figure><p id="6a09" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4.现在，格式化这个分区。在这里，我使用了<strong class="ig hi"> ext4 </strong>格式类型。因此，</p><p id="e79f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jl"> # mkfs.ext4 /dev/ &lt;分割名称&gt; / &lt;分割名称&gt; </em> </strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jv"><img src="../Images/8083abe19e06a63afc9a79c9b8008d25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*HRj8pqym32NenEYTTxX_Jg.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">图6</figcaption></figure><p id="de12" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">5.接下来，我们必须决定挂载点，以便我们可以开始使用它。创建一个目录并将该文件夹挂载(链接)到我们的分区。我们存储在分区中的所有内容都将在这个目录下可用。</p><p id="c485" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我已经创建了一个目录<em class="jl">/Hadoop/Hadoop data/HDFS/datanode</em>，然后挂载了这个分区。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jv"><img src="../Images/20f58a8f26e6518cb349c3eae7e524f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*7ZGLRfHBkTvVEho8qmkCeg.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">图7</figcaption></figure><p id="0b8a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，如您所见，我们已经准备好了一个逻辑分区。逻辑分区的大小为(6G)，类型为<strong class="ig hi"> <em class="jl"> lvm </em> </strong> <em class="jl">。</em></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jv"><img src="../Images/d0bc7b792b6f68bb51f85057f4573e65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*WqwdgMIV62TbWkIu6UGGzA.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">图8</figcaption></figure><p id="2f28" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">就是这样。五个简单的步骤，我们创建了一个逻辑卷。</p><p id="dc95" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">总结概念…</strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ke"><img src="../Images/88098cb322e49b2e6996ef06fc192431.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*sAA0zKJ_n3mX0jXHUXhEng.png"/></div></figure><p id="5563" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，您可以在LV的挂载点创建一个目录，然后使用该目录向HDFS集群提供存储。为此，您必须编辑<strong class="ig hi"> hdfs-site.xml </strong>文件。您必须在那里更改共享文件夹的名称。</p><p id="1be0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因为我们在<em class="jl">/Hadoop/Hadoop data/HDFS/datanode</em>目录中挂载了我们的分区，所以我们将相应地编辑该文件。这里，我在挂载的目录中创建了一个名为<em class="jl"> slave1 </em>的文件夹，并在hdfs-site.xml中给出了路径。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jv"><img src="../Images/680903e2b065eaf5052117e66d3de9d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*wimkCSbNjgUGWVg2hSkBqA.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">图9</figcaption></figure><p id="9441" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">格式化namenode目录并启动集群后，获取hdfs报告。</p><p id="438b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"><em class="jl"># HDFS DFS admin-report</em></strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jv"><img src="../Images/be2ff55d4fc30fabf293c18fa947e12f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*D_zHGYWSIbAp7H091c3weQ.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">图10</figcaption></figure><p id="1dec" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您可以看到<strong class="ig hi">配置的容量</strong>大约为6GB，它来自我们的逻辑分区。</p><p id="4220" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">好吧，我打赌你有一个问题，为什么是逻辑卷呢？</p><p id="b878" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最明显的原因是，它让您可以从多个物理硬盘上获取空间。但是，使用<strong class="ig hi">逻辑卷</strong>的另一个显著优势是它们可以创建动态分区。</p><p id="44fb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">这是什么意思？</strong></p><p id="0d54" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如，当前分区中6GB的全部空间都用完了。对于逻辑卷，我们可以增加分区大小。当我们扩展分区大小时，存储从<strong class="ig hi">卷组</strong>获得。此外，还可以减少逻辑卷，在这种情况下，额外的存储将返回到<strong class="ig hi">卷组</strong>。</p><p id="acbb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在让我们尝试扩展分区。假设我想将我的分区大小从6G增加到7G。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jv"><img src="../Images/d33ef180534ae93bc81768726d869187.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*vB6phN2SaOeuB9FgKxpiaA.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">图11</figcaption></figure><p id="f3ea" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你现在可以看到LV尺寸现在是7G。</p><p id="abf5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了使更改生效，我们必须重新格式化我们添加的额外空间。</p><p id="3e91" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jv"><img src="../Images/79946a2162d044ecc99e79a2ba79f03c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*HMrtbD2SycKz4VFrVmjp0Q.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">图12</figcaption></figure><p id="5eda" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们检查一下HDFS集群的<strong class="ig hi">配置容量</strong>是否增加了。还有……</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es jv"><img src="../Images/e4ea8bdc1fb76e8f923094d63af61043.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*s6yfs3gG7Av5hnwopYH_qg.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">图13</figcaption></figure><p id="4bab" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">还好，是的！</p><p id="6202" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，现在的HDFS从属共享逻辑卷实际上是自己的主人—它可以决定何时要捐出更多空间，或者何时从LV中删除未使用的空间。</p><p id="5022" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">另外，我想知道您是否注意到了我们案例中的根卷也是一个逻辑卷(图1)。如果我们使用了它，我们仍然能够扩展它。这会节省我们很多时间！</p><p id="07f4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">无论如何，我希望你喜欢阅读这篇博客！</p></div></div>    
</body>
</html>