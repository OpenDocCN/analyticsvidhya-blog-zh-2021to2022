<html>
<head>
<title>Evaluating our Machine Learning model Performance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">评估我们的机器学习模型性能</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/evaluating-our-machine-learning-model-performance-a33cade9d804?source=collection_archive---------14-----------------------#2021-04-04">https://medium.com/analytics-vidhya/evaluating-our-machine-learning-model-performance-a33cade9d804?source=collection_archive---------14-----------------------#2021-04-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/0006c8265c8c79040161a5941a452dbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*lJoT9KD0rm41oG9yLi4ZYA.png"/></div></figure><p id="8d18" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">模型评估是开发机器学习流水线中最重要的步骤之一。想象一下，设计一个模型，然后直接将其部署到生产中。假设你的模型被用于医疗领域，那么它可能会导致多人死亡(如果你的模型表现不佳)。但是不要担心，本文将为您提供评估和改进模型性能所需的所有工具。</p><p id="4a22" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">分类问题</strong></p><p id="af8f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">众所周知，分类问题是那些输出为离散值的问题。例如垃圾邮件检测、癌症检测等。</p><p id="097b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">就本文的范围而言，我们将主要关注二进制分类，其中输出为0或1。</p><p id="d1d4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><em class="jj">让我们采用一个机器学习模型来预测一个人是良性(阳性类别)还是恶性(阴性类别)肿瘤。我们将把我们所有的评估指标应用到这个模型中。</em></p><p id="06b1" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">评估指标</strong></p><p id="18cc" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我们将根据何时使用评估指标，将其分为两类。</p><ul class=""><li id="f57e" class="jk jl hh in b io ip is it iw jm ja jn je jo ji jp jq jr js bi translated">数据集平衡时的评估指标。</li><li id="c656" class="jk jl hh in b io jt is ju iw jv ja jw je jx ji jp jq jr js bi translated">数据集不平衡时的评估指标。</li></ul><p id="585c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">不平衡数据集</strong></p><blockquote class="jy jz ka"><p id="21fa" class="il im jj in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">任何具有不平等类别分布的<strong class="in hi">数据集</strong>在技术上是<strong class="in hi">不平衡的</strong>。然而，当问题的每个类别的示例数量之间存在显著的，或者在某些情况下极端的不均衡时，数据集<strong class="in hi">被称为</strong>不均衡<strong class="in hi">。</strong></p></blockquote><p id="b1c4" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">假设，我们有一个数据集，其中有900个良性肿瘤样本和100个恶性肿瘤样本。</p><p id="b347" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">精度:模型的精度</strong>通过以下公式计算:</p><figure class="kf kg kh ki fd ii er es paragraph-image"><div class="er es ke"><img src="../Images/4ad31b9bad78a0cd818984238ca826dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*LKgW3PlNFNwi1pjjr4kbFw.png"/></div><figcaption class="kj kk et er es kl km bd b be z dx translated">精确度公式</figcaption></figure><p id="0e9e" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在假设我们的模型预测所有的输出都是良性肿瘤，那么根据上面的公式，我们的准确率是90%(想想吧！).我们可以清楚地看到，我们的模型未能预测恶性肿瘤。现在想象一下，如果你在现实世界中使用这个模型，那会是多么大的灾难。</p><p id="8ef0" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">学习:</strong>只有当我们的数据集平衡时，才应该使用准确性作为评估指标。</p><p id="b86c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">不平衡数据集的评估指标</strong></p><ul class=""><li id="25cc" class="jk jl hh in b io ip is it iw jm ja jn je jo ji jp jq jr js bi translated"><strong class="in hi">混淆矩阵</strong>:顾名思义，混淆矩阵是一个矩阵，它告诉我们在不同的类之间，我们的模型对于什么值变得混淆。</li></ul><figure class="kf kg kh ki fd ii er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es kn"><img src="../Images/7086b67318e3e9d3e2e761d595d9d951.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vbfuOkRGdcNkUXp8uEi4BA.png"/></div></div><figcaption class="kj kk et er es kl km bd b be z dx translated">混淆矩阵</figcaption></figure><p id="5a70" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">与混淆矩阵相关的定义</strong></p><ul class=""><li id="9ee0" class="jk jl hh in b io ip is it iw jm ja jn je jo ji jp jq jr js bi translated"><strong class="in hi"> TP: </strong>真阳性是那些实际上是阳性并被预测为阳性的例子。实际输出是良性肿瘤(阳性肿瘤),并且该模型也预测了良性肿瘤。</li><li id="efa4" class="jk jl hh in b io jt is ju iw jv ja jw je jx ji jp jq jr js bi translated"><strong class="in hi"> FP: </strong>假阳性也称为<strong class="in hi">1型错误</strong>是那些实际上是阴性但我们的模型预测为阳性的例子。实际输出是恶性肿瘤(阴性类别)，但我们的模型预测是良性肿瘤。</li><li id="3350" class="jk jl hh in b io jt is ju iw jv ja jw je jx ji jp jq jr js bi translated"><strong class="in hi"> FN: </strong>假阴性也称为<strong class="in hi">2型错误</strong>是那些实际上是阳性的例子，但是我们的模型预测它们是阴性的。实际输出是良性肿瘤(阳性类别)，但我们的模型预测它是恶性肿瘤。</li><li id="8ab4" class="jk jl hh in b io jt is ju iw jv ja jw je jx ji jp jq jr js bi translated"><strong class="in hi"> TN: </strong>真阴性是那些实际上是阴性的例子，我们的模型预测它们是阴性的。实际输出是恶性肿瘤(阴性类别),我们的模型也将其预测为恶性肿瘤。</li></ul><p id="56c0" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">每当我们训练我们的模型时，我们应该努力减少假阳性和假阴性，这样我们的模型就能做出尽可能多的正确预测。</p><p id="794d" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">通过查看混淆矩阵，我们可以了解我们的模型在特定类上的表现。不像准确性，它给出了整个模型的估计。</p><p id="89cc" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">精度和召回</strong></p><p id="de2b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这是评估模型性能的两个非常重要的指标。没有谁比谁更好，这取决于用例以及业务需求。让我们先来看看它们的定义，然后我们将发展一种直觉，在什么时候使用它们</p><p id="5bc8" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">精度:模型的精度</strong>由以下公式给出:</p><figure class="kf kg kh ki fd ii er es paragraph-image"><div class="er es ks"><img src="../Images/f12d8c623180287e0c2f536a7db78a19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*Lg2_WPRZzXpKCPWfJgYNwQ.png"/></div></figure><p id="6a45" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">精度可以定义为“在所有正预测值中，有多少实际上是正的。”</p><p id="785f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">召回:</strong>通过使用以下公式给出模型的召回</p><figure class="kf kg kh ki fd ii er es paragraph-image"><div class="er es kt"><img src="../Images/fa80a19d7fd8af00e0df5077e3c8a860.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*ZF_0hxwka616hlUa8DS5aw.png"/></div></figure><p id="c055" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">回忆可以定义为“在所有实际正值中，有多少是实际预测的正值。”</p><p id="e1be" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">小迷糊？</strong></p><p id="682b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">我花了一些时间来理解这个定义。但是不用担心，我们会用一个例子来理解这一点。</p><ul class=""><li id="1964" class="jk jl hh in b io ip is it iw jm ja jn je jo ji jp jq jr js bi translated">假设您有一个垃圾邮件检测模型，将垃圾邮件作为肯定类别，而不是垃圾邮件作为否定类别。现在想一想，您将使用哪个指标(精确度或召回率)来评估您的模型。</li></ul><p id="6c9a" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">思考…………..</p><p id="f567" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">好吧，让我们明白，在这个问题中，我们不希望任何重要的邮件被遗漏，以防它被预测为垃圾邮件。因此，我们希望减少误报(被预测为垃圾邮件的非垃圾邮件)，从而提高我们的精确度。因此，在这种情况下，我们将更关注精度而不是召回。</p><ul class=""><li id="df4e" class="jk jl hh in b io ip is it iw jm ja jn je jo ji jp jq jr js bi translated">现在，让我们再举一个例子，我们想预测一个人是否患有癌症。在这种情况下，得了癌症就是正面例子，没得癌症就是负面例子。现在，休息一下，考虑一下您将用于评估该模型的评估指标。</li></ul><p id="a3a1" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">思考…………..</p><p id="59a1" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">让我们看看，在这个例子中，我们不能把一个得了癌症的人归类为没有得癌症(这关乎生死)。因此，我们将尝试减少假阴性(预测阴性类别为实际阳性类别)，这反过来将增加我们的回忆。在这种情况下，我们将更多地关注召回率而不是精确度。</p><p id="1742" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">给你的任务</strong></p><p id="dbfe" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">想出更多的例子，自己看看可以应用哪些指标。</p><p id="7f75" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi"> F1-得分</strong></p><p id="940f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">虽然精确度和召回率都很好，但是它们并没有给我们比较两个模型的能力。如果一个模型有很好的召回率，而另一个有很好的精确度，那么使用哪一个来完成我们的任务就变得非常混乱了(直到我们完全确定我们只需要关注一个指标)。</p><p id="0266" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">F1-得分营救</strong></p><p id="ca1b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">F1-score取精确率和召回率的调和平均值，并给出一个值来评估我们的模型。它由以下模型给出。</p><figure class="kf kg kh ki fd ii er es paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="er es ku"><img src="../Images/8026f6222794fc1cd67f4b28ecbeaf13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FQPsgMDhZC0lwlnOWZIA2A.png"/></div></div></figure><blockquote class="jy jz ka"><p id="fb2c" class="il im jj in b io ip iq ir is it iu iv kb ix iy iz kc jb jc jd kd jf jg jh ji ha bi translated">我们使用<strong class="in hi">调和平均值</strong>而不是简单平均值，因为它惩罚极端值。精度为1.0、召回率为0.0的分类器的简单平均值为0.5，但<strong class="in hi"> F1得分</strong>为0。</p></blockquote><p id="45ca" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，您可以使用F1分数来比较不同的车型，并选择最适合您的车型。</p><p id="f0bf" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">作业时间</strong></p><ul class=""><li id="fe9f" class="jk jl hh in b io ip is it iw jm ja jn je jo ji jp jq jr js bi translated">ROC和AUC评价指标的研究。</li><li id="605a" class="jk jl hh in b io jt is ju iw jv ja jw je jx ji jp jq jr js bi translated">我们可以使用混淆矩阵进行多类分类吗？如果可以，我们如何计算精度和召回率？</li><li id="1c57" class="jk jl hh in b io jt is ju iw jv ja jw je jx ji jp jq jr js bi translated">尝试不同的模型，如决策树、逻辑回归，并使用不同的指标评估您的模型。</li></ul><p id="c14f" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">快乐学习！！！</strong></p></div></div>    
</body>
</html>