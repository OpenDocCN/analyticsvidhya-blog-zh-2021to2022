<html>
<head>
<title>Digit Emoji Predictor: Build UI for Deep Learning model in Notebook</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">æ•°å­—è¡¨æƒ…ç¬¦å·é¢„æµ‹å™¨:ä¸ºç¬”è®°æœ¬ä¸­çš„æ·±åº¦å­¦ä¹ æ¨¡å‹æ„å»ºUI</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/digit-emoji-predictor-build-ui-for-deep-learning-model-in-notebook-cc8e08669174?source=collection_archive---------14-----------------------#2021-04-30">https://medium.com/analytics-vidhya/digit-emoji-predictor-build-ui-for-deep-learning-model-in-notebook-cc8e08669174?source=collection_archive---------14-----------------------#2021-04-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="ef0d" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">é€šè¿‡åœ¨JavaScriptå’ŒPythonä¹‹é—´ä¼ é€’æ•°æ®ï¼Œåœ¨Jupyter notebookä¸­å»ºç«‹ä¸€ä¸ªæ•°å­—è¡¨æƒ…é¢„æµ‹å™¨ã€‚é€šå¸¸ï¼ŒJavaScriptsç”¨äºç¬”è®°æœ¬ä¸­çš„æ•°æ®å¯è§†åŒ–ï¼Œä½†å®ƒä¹Ÿå¯ä»¥ç”¨äºæ·±åº¦å­¦ä¹ æ¨¡å‹çš„å‰ç«¯/UIåŸå‹åŒ–ã€‚</h2></div><h1 id="6bbd" class="iw ix hh bd iy iz ja jb jc jd je jf jg in jh io ji iq jj ir jk it jl iu jm jn bi translated">ä¸ºä»€ä¹ˆè¦åœ¨ç¬”è®°æœ¬ä¸­æ„å»ºUIï¼Ÿ</h1><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es jo"><img src="../Images/4ad00abb5ac56b5af1b1c76c581b979d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PhkVJnV3YUSNhSNSs-7PMg.png"/></div></div></figure><p id="6056" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated">ç®€çŸ­å›ç­”:</p><blockquote class="kw"><p id="1a15" class="kx ky hh bd kz la lb lc ld le lf kv dx translated">åœ¨çœŸæ­£çš„è½¯ä»¶å¼€å‘å¼€å§‹ä¹‹å‰ï¼Œä¸æ¥è‡ªä¸šåŠ¡ã€æ•°æ®ç§‘å­¦ã€å‰ç«¯å¼€å‘äººå‘˜ã€DevOpsç­‰ä¸åŒå›¢é˜Ÿçš„åŒäº‹åˆ†äº«æ·±åº¦å­¦ä¹ æ¨¡å‹ç¬”è®°æœ¬ï¼Œå¾æ±‚ä»–ä»¬çš„æ„è§ã€‚</p></blockquote><p id="25e1" class="pw-post-body-paragraph ka kb hh kc b kd lg ii kf kg lh il ki kj li kl km kn lj kp kq kr lk kt ku kv ha bi translated">Jupyter notebookæ˜¯ç”¨äºå¿«é€ŸåŸå‹åˆ¶ä½œçš„ï¼Œæ¯ä¸ªäººéƒ½çŸ¥é“è¿™ä¸€ç‚¹ï¼Œä½†æ˜¯å¾ˆå¤šäººå¿½ç•¥çš„æ˜¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¿«é€Ÿåˆ¶ä½œUIåŸå‹ã€‚è®¸å¤šæ•°æ®ç§‘å­¦å®¶<strong class="kc hi">å¾ˆå¿«å°±å¼€å§‹</strong>åˆ©ç”¨ä»–ä»¬æ‹¥æœ‰çš„ä»»ä½•å°‘é‡æ•°æ®æ„å»ºå¤§å‹æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œç”šè‡³æ²¡æœ‰è€ƒè™‘ä»–ä»¬æ­£åœ¨å¼€å‘ä»€ä¹ˆä»¥åŠä¸ºè°å¼€å‘ğŸ¤·â€â™‚ï¸.ç›¸ä¿¡æˆ‘ï¼Œæ‚¨æ»¡æ„çš„ç¬¬ä¸€ä¸ªæ¨¡å‹(åŸºäºå‡†ç¡®æ€§ç­‰æŒ‡æ ‡)ä¸ä¼šéƒ¨ç½²åˆ°ç”Ÿäº§ä¸­ï¼Œå› ä¸ºå„ç§åŸå› ï¼Œå¦‚æ¨ç†æ—¶é—´æ…¢ã€æ²¡æœ‰è®¾å¤‡æ”¯æŒã€å ç”¨å†…å­˜ç­‰ç­‰ã€‚<br/> <br/>å³ä½¿æ˜¯ç»éªŒä¸°å¯Œçš„é¡¹ç›®/äº§å“ç»ç†æœ‰æ—¶ä¹Ÿä¸ä¼šçŸ¥é“ä»–ä»¬çœŸæ­£æƒ³è¦çš„æ˜¯ä»€ä¹ˆï¼Œæ‰€ä»¥é¦–å…ˆå°è¯•ä»æ‰€æœ‰ç›¸å…³äººå‘˜é‚£é‡Œè·å¾—å·¥ä½œæµç¨‹æˆ–ç®¡é“åè®®ï¼Œå³ä½¿æœ‰äº†è¿™äº›ï¼Œä¸€äº›äº‹æƒ…ä¹Ÿä¼šä»ç¼éš™ä¸­æºœèµ°ã€‚â€œæˆ‘æ˜¯æ•°æ®ç§‘å­¦å®¶ï¼Œæˆ‘çš„å·¥ä½œåªæ˜¯å»ºç«‹MLæ¨¡å‹ï¼Œè¿™ä¸æ˜¯æ­£ç¡®çš„æ€ç»´æ¨¡å¼ï¼Œè‡³å°‘åœ¨æˆ‘çœ‹æ¥æ˜¯è¿™æ ·ã€‚â€DevOpsæœ‰ä¸€ç‚¹å•†ä¸šã€Webå¼€å‘æ–¹é¢çš„çŸ¥è¯†ï¼Œå¯ä»¥å¸®åŠ©ä½ èŠ‚çœå¤§é‡çš„è°ƒè¯•æ—¶é—´ï¼Œæˆ–è€…è§£é‡Šä¸ºä»€ä¹ˆä½ å»ºç«‹çš„æ¨¡å‹/å·¥ä½œæµæ˜¯æœ€é€‚åˆå•†ä¸šçš„ã€‚åœ¨è¿™é‡Œæœ€å¥½æ˜¯ä¸‡äº‹é€šã€‚é¡ºä¾¿è¯´ä¸€å¥ï¼Œè¿™å¹¶ä¸æ„å‘³ç€ä½ åº”è¯¥æ¥ç®¡ä½ åŒäº‹çš„è´£ä»»ã€‚è¯•ç€å»äº†è§£ä½ åœˆå­ä¹‹å¤–å‘ç”Ÿçš„äº‹æƒ…ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œè®©æˆ‘åˆ†äº«ä¸€ä¸ªä¾‹å­ï¼Œè¯´æ˜ä¸ºæ·±åº¦å­¦ä¹ æ¨¡å‹çš„è¾“å…¥&amp;è¾“å‡ºåˆ›å»ºä¸€ä¸ªç®€å•çš„UIå¦‚ä½•å¸®åŠ©æ‚¨çœ‹åˆ°å·¥ä½œæµç¨‹ä¸­çš„è£‚ç¼å¹¶æé«˜ç”Ÿäº§ç‡ã€‚</p><h1 id="8fb4" class="iw ix hh bd iy iz ja jb jc jd je jf jg in jh io ji iq jj ir jk it jl iu jm jn bi translated">åº”ç”¨</h1><p id="dbd1" class="pw-post-body-paragraph ka kb hh kc b kd ll ii kf kg lm il ki kj ln kl km kn lo kp kq kr lp kt ku kv ha bi translated">å¦‚æœä½ ä¸ç†Ÿæ‚‰<a class="ae lq" href="https://www.kaggle.com/c/digit-recognizer" rel="noopener ugc nofollow" target="_blank"> MNIST </a>æ•°æ®é›†ï¼Œé‚£ä¹ˆåªè¦çŸ¥é“ä½ å¯ä»¥å»ºç«‹ä¸€ä¸ª<strong class="kc hi">æ•°å­—è¡¨æƒ…é¢„æµ‹å™¨</strong>ï¼Œå› ä¸ºæ•°æ®é›†åŒ…å«æ‰‹ç»˜æ•°å­—çš„ç°åº¦å›¾åƒï¼Œä»0åˆ°9ã€‚æ‰€ä»¥æˆ‘ä»¬çš„UIä¼šè®©ç”¨æˆ·ç”»ä¸€ä¸ªæ•°å­—&amp;æ¥æ˜¾ç¤ºç›¸åº”çš„è¡¨æƒ…ç¬¦å·ã€‚</p><p id="2ab6" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬å°†å†³å®šæˆ‘ä»¬è¦å»ºé€ ä»€ä¹ˆï¼Ÿä¸å…¶ä»å¤´å¼€å§‹åˆ›å»ºï¼Œä¸å¦‚è®©æˆ‘ä»¬å°è¯•åœ¨ä¸ä½¿ç”¨Djangoçš„æƒ…å†µä¸‹ï¼Œåœ¨ç¬”è®°æœ¬ä¸­é‡æ–°åˆ›å»º<a class="ae lq" href="https://towardsdatascience.com/deploying-your-first-deep-learning-model-mnist-in-production-environment-510bfdc4808d" rel="noopener" target="_blank">æ•°å­—è¯†åˆ«å™¨</a>ã€‚æˆ‘ä»¬é€‰æ‹©çš„ç”¨ä¾‹å¾ˆæ£’ï¼Œå› ä¸ºæˆ‘ä»¬ä¸èƒ½ç®€å•åœ°ä½¿ç”¨<code class="du lr ls lt lu b">pywidgets</code>ï¼Œè¿™è¿«ä½¿æˆ‘ä»¬æ·±å…¥æŒ–æ˜HTML &amp; JavaScriptçš„ä¸–ç•Œã€‚ä»é•¿è¿œæ¥çœ‹ï¼Œè¿™æ¡è·¯çº¿æœ‰æ›´å¤šçš„å¥½å¤„ï¼Œå› ä¸ºæ— é™çš„èƒ½åŠ›ï¼Œå…è´¹çš„èµ„æºï¼Œæ›´é‡è¦çš„æ˜¯æ›´æ¥è¿‘å®é™…çš„å‰ç«¯ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æƒ³è¦çš„åªæ˜¯ä¸€ä¸ªæ»‘å—ï¼Œé‚£å°±ç”¨<code class="du lr ls lt lu b">pywidgets</code>æ»šåŠ¨ã€‚æˆ‘ä»¬å°†é¦–å…ˆè®¾ç½®åç«¯ï¼Œç„¶åè¿”å›åˆ°UIã€‚</p><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es lv"><img src="../Images/c0d70d70a0b26504d7b6228c66886298.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*yMwHBl_Z_-EVa1PB.gif"/></div></figure><h1 id="9837" class="iw ix hh bd iy iz ja jb jc jd je jf jg in jh io ji iq jj ir jk it jl iu jm jn bi translated">æ•°å­—è¡¨æƒ…è¯†åˆ«å™¨</h1><p id="b291" class="pw-post-body-paragraph ka kb hh kc b kd ll ii kf kg lm il ki kj ln kl km kn lo kp kq kr lp kt ku kv ha bi translated">æˆ‘å·²ç»ä½¿ç”¨<code class="du lr ls lt lu b">pytorch</code>è®­ç»ƒäº†CNNæ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œæˆ‘ä»¬å°†ä»<a class="ae lq" href="https://github.com/6aravind/tidbits/blob/main/assets/models/mnist_model.pth" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>ä¸‹è½½æ¨¡å‹&amp;æƒé‡ã€‚è¿™æ˜¯ä¸€ä¸ªç®€å•çš„æ¨¡å‹ï¼Œæœ‰3ä¸ª<em class="lw"> Convæ¨¡å—</em>å’Œ2ä¸ª<em class="lw">å…¨è¿æ¥å±‚</em>ã€‚è¿™ä¸ªæ¨¡å‹ä½¿ç”¨çš„å˜æ¢æœ‰<code class="du lr ls lt lu b">Resize</code> &amp; <code class="du lr ls lt lu b">ToTensor</code>ã€‚åœ¨å›¾åƒä¸Šè°ƒç”¨<code class="du lr ls lt lu b">predict</code>åŠŸèƒ½ï¼Œæˆ‘ä»¬å°†å¾—åˆ°é¢„æµ‹çš„æ•°å­—ã€‚</p><pre class="jp jq jr js fd lx lu ly lz aw ma bi"><span id="39ae" class="mb ix hh lu b fi mc md l me mf">import torch<br/>import torch.nn as nn<br/>import torch.nn.functional as F<br/>from torchvision import transforms<br/><br/># Digit Recognizer model definition<br/>class CNN(nn.Module):<br/>    def __init__(self):<br/>        super(CNN, self).__init__()<br/>        self.conv1 = nn.Conv2d(1, 32, kernel_size=5)<br/>        self.conv2 = nn.Conv2d(32, 32, kernel_size=5)<br/>        self.conv3 = nn.Conv2d(32,64, kernel_size=5)<br/>        self.fc1 = nn.Linear(3*3*64, 256)<br/>        self.fc2 = nn.Linear(256, 10)<br/><br/>    def forward(self, x):<br/>        x = F.relu(self.conv1(x))<br/>        x = F.dropout(x, p=0.5, training=self.training)<br/>        x = F.relu(F.max_pool2d(self.conv2(x), 2))<br/>        x = F.dropout(x, p=0.5, training=self.training)<br/>        x = F.relu(F.max_pool2d(self.conv3(x),2))<br/>        x = F.dropout(x, p=0.5, training=self.training)<br/>        x = x.view(-1,3*3*64 )<br/>        x = F.relu(self.fc1(x))<br/>        x = F.dropout(x, training=self.training)<br/>        x = self.fc2(x)<br/>        return x<br/><br/><br/><br/># Predict the digit given the tensor<br/>def predict(image, modelName = 'mnist_model.pth'):<br/><br/>    # Resize before converting the image to Tensor<br/>    Trfms = transforms.Compose([transforms.Resize(28), transforms.ToTensor()])<br/><br/>    # Apply transformations and increase dim for mini-batch dimension<br/>    imageTensor = Trfms(image).unsqueeze(0)<br/><br/>    # Download model from URL and load it<br/>    model = torch.load(modelName)<br/><br/>    # Activate Eval mode<br/>    model.eval()<br/><br/>    # Pass the image tensor by the model &amp; return max index of output<br/>    with torch.no_grad():<br/>        out = model(imageTensor)<br/>        return int(torch.max(out, 1)[1])</span></pre><p id="a272" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated">æˆ‘ä»¬éœ€è¦ä¸€ä¸ªåŠ©æ‰‹å‡½æ•°æ¥å°†<strong class="kc hi"> BASE64å›¾åƒ</strong>(ç”¨æˆ·å°†è¦åœ¨å…¶ä¸­ç»˜åˆ¶æ•°å­—çš„ç”»å¸ƒåŒºåŸŸ)è½¬æ¢ä¸º<strong class="kc hi"> PILå›¾åƒ</strong>ã€‚</p><pre class="jp jq jr js fd lx lu ly lz aw ma bi"><span id="659c" class="mb ix hh lu b fi mc md l me mf">import re, base64<br/>from PIL import Image<br/>from io import BytesIO<br/><br/># Decode the image drawn by the user<br/>def decodeImage(codec):<br/><br/>    # remove the front part of codec<br/>    base64_data = re.sub('^data:image/.+;base64,', '', codec)<br/><br/>    # base64 decode<br/>    byte_data = base64.b64decode(base64_data)<br/><br/>    # Convert to bytes<br/>    image_data = BytesIO(byte_data)<br/><br/>    # Convert to image &amp; convert to grayscale<br/>    img = Image.open(image_data).convert('L')<br/>    return img</span></pre><p id="7388" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated">ç°åœ¨è®©æˆ‘ä»¬å°†è¿™ä¸¤ä¸ªå‡½æ•°å³<code class="du lr ls lt lu b">decodeImage</code>å’Œ<code class="du lr ls lt lu b">predict</code>åˆå¹¶ä¸ºä¸€ä¸ªå•ç‹¬çš„å‡½æ•°ã€‚è¿™ç§æ–¹å¼æ›´å®¹æ˜“ï¼Œå› ä¸ºå‡½æ•°çš„è¾“å‡º(emoji htmlä»£ç )å¯ä»¥é€šè¿‡JavaScriptç›´æ¥ä¼ é€’ç»™htmlæ ‡ç­¾ã€‚å¦‚æœä½ æ„Ÿåˆ°å›°æƒ‘ï¼ŒåšæŒä¸€ä¼šå„¿ï¼Œåœ¨ä¸‹ä¸€èŠ‚ä¸­äº‹æƒ…ä¼šå˜å¾—å®¹æ˜“å¾—å¤šã€‚</p><pre class="jp jq jr js fd lx lu ly lz aw ma bi"><span id="e016" class="mb ix hh lu b fi mc md l me mf"># Decode the image and predict the value<br/>def decode_predict(imgStr):<br/><br/>    # Decode the image<br/>    image = decodeImage(imgStr)<br/><br/>    # Declare html codes for 0-9 emoji<br/>    emojis = [ <br/>            "&amp;#48;&amp;#65039;&amp;#8419;",<br/>             "&amp;#49;&amp;#65039;&amp;#8419;",<br/>             "&amp;#50;&amp;#65039;&amp;#8419;",<br/>             "&amp;#51;&amp;#65039;&amp;#8419;",<br/>             "&amp;#52;&amp;#65039;&amp;#8419;",<br/>             "&amp;#53;&amp;#65039;&amp;#8419;",<br/>             "&amp;#54;&amp;#65039;&amp;#8419;",<br/>             "&amp;#55;&amp;#65039;&amp;#8419;",<br/>             "&amp;#56;&amp;#65039;&amp;#8419;",<br/>             "&amp;#57;&amp;#65039;&amp;#8419;"<br/>    ]<br/><br/>    # Call the predict function<br/>    digit = predict(image)<br/><br/>    # get corresponding emoji<br/>    return emojis[digit]</span></pre><h1 id="b1d7" class="iw ix hh bd iy iz ja jb jc jd je jf jg in jh io ji iq jj ir jk it jl iu jm jn bi translated">ç”¨æˆ·ç•Œé¢</h1><p id="61cc" class="pw-post-body-paragraph ka kb hh kc b kd ll ii kf kg lm il ki kj ln kl km kn lo kp kq kr lp kt ku kv ha bi translated">HTMLå’ŒCSSéƒ¨åˆ†éå¸¸ç®€å•ï¼ŒJavaScriptå…è®¸ç”¨æˆ·åœ¨ç”»å¸ƒå†…éƒ¨ç»˜å›¾ï¼Œå¹¶é€šè¿‡æŒ‰é’®<code class="du lr ls lt lu b">Predict</code> &amp; <code class="du lr ls lt lu b">Clear</code>è°ƒç”¨å‡½æ•°ã€‚<code class="du lr ls lt lu b">Clear</code>æŒ‰é’®æ¸…ç†ç”»å¸ƒå¹¶å°†ç»“æœè®¾ç½®ä¸ºğŸ¤”è¡¨æƒ…ç¬¦å·ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­è®¾ç½®<code class="du lr ls lt lu b">Predict</code>æŒ‰é’®JSå‡½æ•°ã€‚</p><pre class="jp jq jr js fd lx lu ly lz aw ma bi"><span id="5888" class="mb ix hh lu b fi mc md l me mf">from IPython.display import HTML<br/><br/>html = """<br/>&lt;div class="outer"&gt;<br/>        &lt;! -- HEADER SECTION --&gt;<br/>    &lt;div&gt; <br/>        &lt;h3 style="margin-left: 30px;"&gt; Digit Emoji Predictor &amp;#128640; &lt;/h3&gt; <br/>        &lt;br&gt;<br/>        &lt;h7 style="margin-left: 40px;"&gt; Draw a digit from &amp;#48;&amp;#65039;&amp;#8419; - &amp;#57;&amp;#65039;&amp;#8419;&lt;/h7&gt;<br/>    &lt;/div&gt;<br/><br/>    &lt;div&gt;<br/>           &lt;! -- CANVAS TO DRAW THE DIGIT --&gt;<br/>        &lt;canvas id="canvas" width="250" height="250" style="border:2px solid; float: left; border-radius: 5px; cursor: crosshair;"&gt;<br/>        &lt;/canvas&gt;<br/><br/>            &lt;! -- SHOW PREDICTED DIGIT EMOJI--&gt;<br/>        &lt;div class="wrapper1"&gt; &lt;p id="result"&gt;&amp;#129300;&lt;/p&gt;&lt;/div&gt;<br/><br/>            &lt;! -- BUTTONS TO CALL DL MODEL &amp; CLEAR THE CANVAS --&gt;<br/>        &lt;div class="wrapper2"&gt;<br/>            &lt;button type="button" id="predictButton" style="color: #4CAF50;margin:10px;"&gt;  Predict &lt;/button&gt;  <br/>            &lt;button type="button" id="clearButton" style="color: #f44336;margin:10px;"&gt;  Clear &lt;/button&gt;  <br/>        &lt;/div&gt;<br/>    &lt;/div&gt;<br/>&lt;/div&gt;<br/>"""<br/><br/><br/>css = """<br/>&lt;style&gt;<br/>    .wrapper1 {<br/>      text-align: center;<br/>      display: inline-block;<br/>      position: absolute;<br/>      top: 82%;<br/>      left: 25%;<br/>      justify-content: center;<br/>      font-size: 30px;<br/>    }<br/>    .wrapper2 {<br/>      text-align: center;<br/>      display: inline-block;<br/>      position: absolute;<br/>      top: 90%;<br/>      left: 19%;<br/>      justify-content: center;<br/>    }<br/><br/>    .outer {<br/>        height: 400px; <br/>        width: 400px;<br/>        justify-content: center;<br/>    }<br/><br/>&lt;/style&gt;<br/>"""<br/><br/><br/>javascript = """<br/><br/>&lt;script type="text/javascript"&gt;<br/>(function() {<br/>    /* SETUP CANVAS &amp; ALLOW USER TO DRAW */<br/>    var canvas = document.querySelector("#canvas");<br/>    canvas.width = 250;<br/>    canvas.height = 250;<br/>    var context = canvas.getContext("2d");<br/>    var canvastop = canvas.offsetTop<br/>    var lastx;<br/>    var lasty;<br/>    context.strokeStyle = "#000000";<br/>    context.lineCap = 'round';<br/>    context.lineJoin = 'round';<br/>    context.lineWidth = 5;<br/><br/>    function dot(x, y) {<br/>        context.beginPath();<br/>        context.fillStyle = "#000000";<br/>        context.arc(x, y, 1, 0, Math.PI * 2, true);<br/>        context.fill();<br/>        context.stroke();<br/>        context.closePath();<br/>    }<br/><br/>    function line(fromx, fromy, tox, toy) {<br/>        context.beginPath();<br/>        context.moveTo(fromx, fromy);<br/>        context.lineTo(tox, toy);<br/>        context.stroke();<br/>        context.closePath();<br/>    }<br/>    canvas.ontouchstart = function(event) {<br/>        event.preventDefault();<br/>        lastx = event.touches[0].clientX;<br/>        lasty = event.touches[0].clientY - canvastop;<br/>        dot(lastx, lasty);<br/>    }<br/>    canvas.ontouchmove = function(event) {<br/>        event.preventDefault();<br/>        var newx = event.touches[0].clientX;<br/>        var newy = event.touches[0].clientY - canvastop;<br/>        line(lastx, lasty, newx, newy);<br/>        lastx = newx;<br/>        lasty = newy;<br/>    }<br/>    var Mouse = {<br/>        x: 0,<br/>        y: 0<br/>    };<br/>    var lastMouse = {<br/>        x: 0,<br/>        y: 0<br/>    };<br/>    context.fillStyle = "white";<br/>    context.fillRect(0, 0, canvas.width, canvas.height);<br/>    context.color = "black";<br/>    context.lineWidth = 10;<br/>    context.lineJoin = context.lineCap = 'round';<br/>    debug();<br/>    canvas.addEventListener("mousemove", function(e) {<br/>        lastMouse.x = Mouse.x;<br/>        lastMouse.y = Mouse.y;<br/>        Mouse.x = e.pageX - canvas.getBoundingClientRect().left;<br/>        Mouse.y = e.pageY - canvas.getBoundingClientRect().top;<br/>    }, false);<br/>    canvas.addEventListener("mousedown", function(e) {<br/>        canvas.addEventListener("mousemove", onPaint, false);<br/>    }, false);<br/>    canvas.addEventListener("mouseup", function() {<br/>        canvas.removeEventListener("mousemove", onPaint, false);<br/>    }, false);<br/>    var onPaint = function() {<br/>        context.lineWidth = context.lineWidth;<br/>        context.lineJoin = "round";<br/>        context.lineCap = "round";<br/>        context.strokeStyle = context.color;<br/>        context.beginPath();<br/>        context.moveTo(lastMouse.x, lastMouse.y);<br/>        context.lineTo(Mouse.x, Mouse.y);<br/>        context.closePath();<br/>        context.stroke();<br/>    };<br/><br/>    function debug() {<br/>        /* CLEAR BUTTON */<br/>        var clearButton = $("#clearButton");<br/>        clearButton.on("click", function() {<br/>            context.clearRect(0, 0, 250, 250);<br/>            context.fillStyle = "white";<br/>            context.fillRect(0, 0, canvas.width, canvas.height);<br/><br/>            /* Remove Result */<br/>            document.getElementById("result").innerHTML = "&amp;#129300;";<br/>        });<br/>        $("#colors").change(function() {<br/>            var color = $("#colors").val();<br/>            context.color = color;<br/>        });<br/>        $("#lineWidth").change(function() {<br/>            context.lineWidth = $(this).val();<br/>        });<br/>    }<br/>}());<br/><br/>&lt;/script&gt;<br/><br/>"""<br/><br/><br/>HTML(html + css + javascript)</span></pre><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es mg"><img src="../Images/dadfdf35e3264434a69962cafce76f12.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*bgVq7XSSIWan1ibCBS215g.png"/></div><figcaption class="mh mi et er es mj mk bd b be z dx translated">æ•°å­—è¡¨æƒ…ç¬¦å·é¢„æµ‹å™¨çš„ç”¨æˆ·ç•Œé¢</figcaption></figure><p id="4906" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated">å¤ªå¥½äº†ï¼æˆ‘ä»¬å¯ä»¥åœ¨ç”»å¸ƒå†…éƒ¨è¿›è¡Œç»˜åˆ¶ï¼Œå•å‡»<code class="du lr ls lt lu b">Clear</code>æŒ‰é’®ï¼Œç”»å¸ƒå°†è¢«æ¸…ç†ã€‚å½“ç”¨æˆ·ç‚¹å‡»<code class="du lr ls lt lu b">Predict</code>æŒ‰é’®æ—¶ï¼Œæ£˜æ‰‹çš„éƒ¨åˆ†å¼€å§‹äº†ï¼Œå› ä¸ºæˆ‘ä»¬å¿…é¡»åšä»¥ä¸‹äº‹æƒ…:</p><ul class=""><li id="d6cc" class="ml mm hh kc b kd ke kg kh kj mn kn mo kr mp kv mq mr ms mt bi translated"><a class="ae lq" href="https://jakevdp.github.io/blog/2013/06/01/ipython-notebook-javascript-python-communication/" rel="noopener ugc nofollow" target="_blank"> JSè½¬PythonğŸ‘‰</a>åœ¨ç”»å¸ƒä¸­æŠ“å–ç»˜å›¾ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™python</li></ul><pre class="jp jq jr js fd lx lu ly lz aw ma bi"><span id="ecac" class="mb ix hh lu b fi mc md l me mf">/* PASS CANVAS BASE64 IMAGE TO PYTHON VARIABLE imgStr*/<br/>    var imgData = canvasObj.toDataURL();<br/>    var imgVar = 'imgStr';<br/>    var passImgCode = imgVar + " = '" + imgData + "'";<br/>    var kernel = IPython.notebook.kernel;<br/>    kernel.execute(passImgCode);</span></pre><ul class=""><li id="906b" class="ml mm hh kc b kd ke kg kh kj mn kn mo kr mp kv mq mr ms mt bi translated"><a class="ae lq" href="https://towardsdatascience.com/javascript-charts-on-jupyter-notebooks-dd25f794cf6a" rel="noopener" target="_blank"> Pythonå¯¹JSğŸ‘‰</a>å°†é¢„æµ‹è¡¨æƒ…ç¬¦å·è®¾ç½®ä¸ºHTMLå…ƒç´ çš„å€¼(<code class="du lr ls lt lu b">#result</code>)</li></ul><pre class="jp jq jr js fd lx lu ly lz aw ma bi"><span id="3766" class="mb ix hh lu b fi mc md l me mf">/* CALL PYTHON FUNCTION "decode_predict" WITH "imgStr" AS ARGUMENT */<br/>    function handle_output(response) {<br/>        /* UPDATE THE HTML BASED ON THE OUTPUT */<br/>        var result = response.content.data["text/plain"].slice(1, -1);<br/>        document.getElementById("result").innerHTML = result;<br/>    }<br/>    var callbacks = {<br/>        'iopub': {<br/>            'output': handle_output,<br/>        }<br/>    };<br/>    var getPredictionCode = "decode_predict(imgStr)";<br/>    kernel.execute(getPredictionCode, callbacks, { silent: false });</span></pre><p id="1053" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated">æŠŠæ‰€æœ‰çš„è”ç³»åœ¨ä¸€èµ·ã€‚</p><pre class="jp jq jr js fd lx lu ly lz aw ma bi"><span id="0a48" class="mb ix hh lu b fi mc md l me mf">predictJS = """</span><span id="4f09" class="mb ix hh lu b fi mu md l me mf">&lt;script type="text/javascript"&gt;<br/><br/>/* PREDICTION BUTTON */<br/>$("#predictButton").click(function() {<br/>    var canvasObj = document.getElementById("canvas");<br/>    var context = canvas.getContext("2d");<br/><br/>    /* PASS CANVAS BASE64 IMAGE TO PYTHON VARIABLE imgStr*/<br/>    var imgData = canvasObj.toDataURL();<br/>    var imgVar = 'imgStr';<br/>    var passImgCode = imgVar + " = '" + imgData + "'";<br/>    var kernel = IPython.notebook.kernel;<br/>    kernel.execute(passImgCode);<br/><br/>    /* CALL PYTHON FUNCTION "decode_predict" WITH "imgStr" AS ARGUMENT */<br/>    function handle_output(response) {<br/>        /* UPDATE THE HTML BASED ON THE OUTPUT */<br/>        var result = response.content.data["text/plain"].slice(1, -1);<br/>        document.getElementById("result").innerHTML = result;<br/>    }<br/>    var callbacks = {<br/>        'iopub': {<br/>            'output': handle_output,<br/>        }<br/>    };<br/>    var getPredictionCode = "decode_predict(imgStr)";<br/>    kernel.execute(getPredictionCode, callbacks, { silent: false });<br/>});<br/>&lt;/script&gt;<br/><br/>"""<br/>HTML(predictJS)</span></pre><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es mv"><img src="../Images/73b0d3d5b8eae5e6bbcceb1e214504a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/1*EaY062wnD67D-2GdWPhlIA.gif"/></div><figcaption class="mh mi et er es mj mk bd b be z dx translated">é”™è¯¯çš„é¢„æµ‹</figcaption></figure><p id="a5cb" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated">æˆ‘ä»¬æœ‰å¥½æ¶ˆæ¯ä¹Ÿæœ‰åæ¶ˆæ¯ï¼Œå¥½æ¶ˆæ¯æ˜¯Pythonå’ŒJavaScriptä¹‹é—´çš„æ•°æ®è¿æ¥å·¥ä½œæ­£å¸¸ï¼Œä½†æ˜¯é¢„æµ‹å€¼éƒ½æ˜¯é”™è¯¯çš„(æ˜ å°„åˆ°ç›¸åŒçš„å€¼â€” 8)ã€‚è®©æˆ‘ä»¬æ¯”è¾ƒä¸€ä¸‹ä¼ é€’ç»™pythonçš„ç”»å¸ƒå›¾åƒå’ŒMNISTæ•°æ®é›†å›¾åƒã€‚</p><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es mw"><img src="../Images/5d51b5d45fdb293c174634e8b8cd06e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*95bvFdgObTZMaJ9zGagwMw.png"/></div><figcaption class="mh mi et er es mj mk bd b be z dx translated">æ¯”è¾ƒç”»å¸ƒå’ŒMNISTçš„å›¾åƒ</figcaption></figure><p id="51fd" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated">ç°åœ¨å¾ˆæ¸…æ¥šï¼Œæˆ‘ä»¬éœ€è¦å¯¹å›¾åƒè¿›è¡Œ<code class="du lr ls lt lu b">invert</code>å¤„ç†ï¼Œå› ä¸ºæ¨¡å‹æ˜¯åœ¨å…·æœ‰é»‘è‰²èƒŒæ™¯å’Œç™½è‰²ç¬”ç”»çš„æ•°æ®é›†ä¸Šè®­ç»ƒçš„ã€‚</p><pre class="jp jq jr js fd lx lu ly lz aw ma bi"><span id="6332" class="mb ix hh lu b fi mc md l me mf">import PIL.ImageOps<br/><br/># Decode the image and predict the value<br/>def decode_predict(imgStr):<br/><br/>    # Decode the image<br/>    image = decodeImage(imgStr)<br/><br/>    # Invert the image as model expects black background &amp; white strokes<br/>    image = PIL.ImageOps.invert(image)<br/><br/>    # Declare html codes for 0-9 emoji<br/>    emojis = [ <br/>            "&amp;#48;&amp;#65039;&amp;#8419;",<br/>             "&amp;#49;&amp;#65039;&amp;#8419;",<br/>             "&amp;#50;&amp;#65039;&amp;#8419;",<br/>             "&amp;#51;&amp;#65039;&amp;#8419;",<br/>             "&amp;#52;&amp;#65039;&amp;#8419;",<br/>             "&amp;#53;&amp;#65039;&amp;#8419;",<br/>             "&amp;#54;&amp;#65039;&amp;#8419;",<br/>             "&amp;#55;&amp;#65039;&amp;#8419;",<br/>             "&amp;#56;&amp;#65039;&amp;#8419;",<br/>             "&amp;#57;&amp;#65039;&amp;#8419;"<br/>    ]<br/><br/>    # Call the predict function<br/>    digit = predict(image)<br/><br/>    # get corresponding emoji<br/>    return emojis[digit]</span></pre><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es mv"><img src="../Images/8d8f946033a89dc4d9161188d3a186ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/0*V-ReLcZVaGcpBGz4.gif"/></div><figcaption class="mh mi et er es mj mk bd b be z dx translated">æ­£ç¡®çš„æ•°å­—è¡¨æƒ…é¢„æµ‹</figcaption></figure><p id="e837" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated">å‰å®³ï¼å®ƒå·¥ä½œäº†ã€‚</p><h1 id="0836" class="iw ix hh bd iy iz ja jb jc jd je jf jg in jh io ji iq jj ir jk it jl iu jm jn bi translated">ç»“è®º</h1><p id="32ec" class="pw-post-body-paragraph ka kb hh kc b kd ll ii kf kg lm il ki kj ln kl km kn lo kp kq kr lp kt ku kv ha bi translated">ç°åœ¨ï¼Œæ‚¨å¯ä»¥å¿«é€Ÿå°†æ­¤ç¬”è®°æœ¬åˆ†äº«ç»™æ¯ä¸ªäººï¼Œå¹¶å¾æ±‚ä»–ä»¬çš„æ„è§ã€‚ä¸è¦å¿˜è®°æåˆ°è­¦å‘Šï¼Œè¿™æ˜¯ä¸€ä¸ªæ—©æœŸçš„åŸå‹ã€‚æ²¡è´¹å¤šå¤§åŠ›æ°”ï¼Œæˆ‘ä»¬å°±å¤åˆ¶äº†ä¸€ä¸ªç½‘ç»œåº”ç”¨çš„åŠŸèƒ½ã€‚æœ€å¤§çš„å¥½å¤„æ˜¯ï¼Œæˆ‘ä»¬ä»æœªç¦»å¼€èˆ’é€‚çš„ç¬”è®°æœ¬ç”µè„‘ï¼Œå¹¶æœ‰å¯èƒ½å¼¥åˆåŸ¹è®­å’Œæµ‹è¯•æ•°æ®ä¹‹é—´çš„å·®è·ã€‚</p><p id="67f9" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated">å¸Œæœ›æˆ‘èƒ½è®©ä½ ç›¸ä¿¡ï¼ŒåŸºæœ¬çš„webå¼€å‘æŠ€èƒ½å¯¹äºæ•°æ®ç§‘å­¦å®¶æ¥è¯´éå¸¸æœ‰ç”¨ã€‚ç¬”è®°æœ¬å¯ä»¥ä»<a class="ae lq" href="https://github.com/6aravind/tidbits/blob/main/notebook/Digit%20Emoji%20Predictor_Build%20UI%20for%20Deep%20Learning%20model%20in%20Jupyter%20Notebook.ipynb" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>è¿›å…¥ã€‚æ¬¢è¿é€šè¿‡è¯„è®ºæˆ–<a class="ae lq" href="https://twitter.com/@6aravind" rel="noopener ugc nofollow" target="_blank"> Twitter </a>è”ç³»æˆ‘ä»¬ã€‚</p></div><div class="ab cl mx my go mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ha hb hc hd he"><p id="29cc" class="pw-post-body-paragraph ka kb hh kc b kd ke ii kf kg kh il ki kj kk kl km kn ko kp kq kr ks kt ku kv ha bi translated"><em class="lw">åŸè½½äº2021å¹´4æœˆ30æ—¥</em><a class="ae lq" href="https://dev.to/6aravind/digit-emoji-predictor-build-ui-for-deep-learning-model-in-notebook-2gf0" rel="noopener ugc nofollow" target="_blank"><em class="lw">https://dev . to</em></a><em class="lw">ã€‚</em></p></div></div>    
</body>
</html>