<html>
<head>
<title>SIMCLR — Contrastive Learning in Computer Vision</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">sim clr——计算机视觉中的对比学习</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/contrastive-learning-in-computer-vision-brief-concept-overview-and-sample-code-787c9038e809?source=collection_archive---------8-----------------------#2021-04-26">https://medium.com/analytics-vidhya/contrastive-learning-in-computer-vision-brief-concept-overview-and-sample-code-787c9038e809?source=collection_archive---------8-----------------------#2021-04-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/048259037cdeb6d8baa4aa3bdbb60c5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*stPv4NEGWkEjIwVe"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">照片由<a class="ae iu" href="https://unsplash.com/@gregjeanneau?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Greg Jeanneau </a>在<a class="ae iu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="254b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj"> <em class="jt">对比学习是一种学习分布中样本间相对相似性的框架。</em> </strong></p><p id="fcf9" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">对比学习框架可以是监督的(利用人工注释)和自我监督的(没有人工注释)。在这篇文章中，我们将探讨一个自我监督的变体，<a class="ae iu" href="http://cse.iitkgp.ac.in/~arastogi/papers/simclr.pdf" rel="noopener ugc nofollow" target="_blank">陈等人的SIMCLR“视觉表征对比学习的简单框架”</a></p><ul class=""><li id="a1ca" class="ju jv hi ix b iy iz jc jd jg jw jk jx jo jy js jz ka kb kc bi translated">首先，我将概述一下SIMCLR框架。</li><li id="e0a0" class="ju jv hi ix b iy kd jc ke jg kf jk kg jo kh js jz ka kb kc bi translated">然后我们将重复论文中的一个实验。</li></ul><p id="5074" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">如果你只是想运行代码，</strong> <a class="ae iu" href="https://github.com/larsh0103/simclr.git" rel="noopener ugc nofollow" target="_blank"> <strong class="ix hj">这里有github repo。</strong>T15】</a></p><p id="68dc" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">自我监督的优点是，它允许我们在几乎没有标记数据的情况下建立性能良好的模型，而<a class="ae iu" href="http://cse.iitkgp.ac.in/~arastogi/papers/simclr.pdf" rel="noopener ugc nofollow" target="_blank"> SIMCLR </a>在这方面比以前的方法做得更好。</p><p id="dde3" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果你想快速了解自我监督，你可以看看我的帖子</p><p id="9499" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">自监督方法如何规避对大量标记训练数据的需求？</p><p id="5dcd" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">通过让我们的模型解决一个玩具任务(前文本任务)，迫使它学习对解决我们真正关心的任务有用的特征。</p><p id="af8a" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在simclr中，这个玩具任务，或者在文献中称为文本前任务，是一个条件二进制分类任务。换句话说，给定一个锚图像和许多其他图像，预测它们中的哪一个与锚图像相似，是正对，哪一个不是负对。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ki"><img src="../Images/98821d1a1155cdd35c7215f36b6ad2bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lPmKJTBN4ef9jxrCGqwotQ.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">条件图像分类图像对</figcaption></figure><p id="0fce" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">但是我们怎么知道哪些是相似的，哪些不是呢？通过生成同一图像的两个增强版本，我们得到了我们的正对，而负对是通过将来自不同“源”图像的增强图像配对而得到的。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es kn"><img src="../Images/3a38c3083174ea5a1827fd6984f29f35.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*l30CPtYTxv9MEmMGAaIMbA.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">通过增强生成图像对</figcaption></figure><p id="8f5b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在4个源图像的小批量的情况下，我们得到8个增强图像，因此得到8个可能的锚。注意，对于锚的每个选择，只有一个正对和2N-1个负对，其中N是在小批量中使用的源图像的数量。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ko"><img src="../Images/4a8ef4cacb63fad40137e1d17a5ea14c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Z50jQAB9YV_BKIOleVUkfA.gif"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">SIMCLR小批量中图像对的可视化</figcaption></figure><p id="8a5b" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在我们已经对SIMCLR上下文中的数据管道和条件分类有了一个很好的概述，让我们引入一些新元素。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kp"><img src="../Images/7f49436866d158263da202ef681f3eb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dsko3LDsxzgeJEsEeQxvSQ.jpeg"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">SIMCLR框架</figcaption></figure><p id="b0a6" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">特征提取器是一个神经网络，它将图像作为输入，并将其投影到m维空间，基本上将图像转换为m维向量。这些向量然后被配对，并且为每个可能的对计算相似性得分(我们使用余弦相似性),这给出了我们的相似性矩阵。我们将对角线上的数值设为大的负数，因为我们不想让网络简单地学习识别同一幅图像的相同副本。由于增强的图像对按顺序输入到我们的网络中，给定源图像k的两个正对由下式给出。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es kq"><img src="../Images/c7bbd80ce62f38413527e90f833f00da.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*nsgQRxDa8RE_IhfsMEaJ0w.png"/></div></figure><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es kr"><img src="../Images/55c01468b7d9d413789cc62c05d22d09.png" data-original-src="https://miro.medium.com/v2/resize:fit:166/format:webp/1*1sjJ2pjnTc3ULfhw81nvFA.png"/></div></figure><p id="1df8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">这为我们提供了基础事实“标签”,我们将使用它来计算N-Xent损耗，即一种修正的交叉熵损耗。</p><p id="9daf" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">一个图像对的损失是:</p><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es ks"><img src="../Images/4f6f995f94fabaf0a1630a33267164d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:332/format:webp/1*NV9D0TFw7Fl9PDUF4-QokQ.png"/></div></figure><p id="a5af" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">其中T是一个称为温度的参数。</p><p id="1648" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">那么小批量的总损耗为:</p><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es kt"><img src="../Images/05a9c28ef9c7a84ed7d67c77ea845a34.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/1*QHuVT9qh9fpkaaC7GEN13A.png"/></div></figure><p id="4f4d" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">希望你现在对SIMCLR对比学习框架有了一个不错的理解，让我们继续实现。</p><p id="19e8" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将复制SIMCLR作者在他们的论文<a class="ae iu" href="http://cse.iitkgp.ac.in/~arastogi/papers/simclr.pdf" rel="noopener ugc nofollow" target="_blank">(你可以在论文的附录B.7中找到它)</a>中提出的一个实验。</p><p id="bc14" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">为了简单起见，我们使用cifar-10作为我们的数据集，使用resnet-18架构的修改版本作为我们的特征提取器。我们使用SIMCLR框架训练一个特征提取器，然后通过使用相同的数据集在其上训练一个线性分类器来评估它的有用性。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es ku"><img src="../Images/38b62d601ec8c217f8bca8dd153423bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*V2zdKFaMI4bSx9H0xQ5pkQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">SIMCLR实验配置</figcaption></figure><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es ku"><img src="../Images/df956085e249839a7fb3e154ae311cfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*XrbwbFu1Eq-xmP14Iqg5RQ.png"/></div><figcaption class="iq ir et er es is it bd b be z dx translated">线性评估配置</figcaption></figure><p id="2ade" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们使用验证集上的分类准确度作为学习表示的有用性的代理。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kv"><img src="../Images/0229f4ce59133c38cdd599571085be66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BQqzMyMK0d_SJLeWEfrw8Q.png"/></div></div><figcaption class="iq ir et er es is it bd b be z dx translated">验证分类准确度Cifar-10</figcaption></figure><p id="d89e" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">哇&gt; 90%的准确率。令人印象深刻。我们已经验证了特征提取器使用SIMCLR学习有用的表示。在我的下一篇文章中，我将探索当数据注释不足时，SIMCLR是否能帮助我们训练更好的对象检测器。</p><p id="eb9c" class="pw-post-body-paragraph iv iw hi ix b iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><strong class="ix hj">如果你想自己试试，</strong><a class="ae iu" href="https://github.com/larsh0103/simclr.git" rel="noopener ugc nofollow" target="_blank">T5】这里有github回购。 </a></p></div></div>    
</body>
</html>