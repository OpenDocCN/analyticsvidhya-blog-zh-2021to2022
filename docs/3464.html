<html>
<head>
<title>Customer Segmentation using k-prototypes algorithm in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于Python中k原型算法的客户细分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/customer-segmentation-using-k-prototypes-algorithm-in-python-aad4acbaaede?source=collection_archive---------0-----------------------#2021-07-02">https://medium.com/analytics-vidhya/customer-segmentation-using-k-prototypes-algorithm-in-python-aad4acbaaede?source=collection_archive---------0-----------------------#2021-07-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="8840" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">Python中智能手表调查数据的k-prototypes算法聚类分析。</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/c1cb69aea033ecd9d83f79b4be29c7b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AlcHGSuRzaulSXfh"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">照片由<a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae jm" href="https://unsplash.com/@onurbinay?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Onur Binay </a>拍摄</figcaption></figure><h1 id="eb1f" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">为什么我们需要细分市场？</h1><p id="9cf0" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">无论是真实的还是感知的，客户都有广泛的需求和偏好，这是一个基本假设。在购买任何产品之前，考虑一下你经历了多少研究、反复试验和同行评审。这是因为每个人都有独特的需求、欲望、欲望、偏好等。企业必须考虑和管理这种顾客异质性，以满足顾客的需求和偏好。因此，根据帕尔马提埃和斯里达尔的说法，2017年这为我们提供了第一个基本营销原则，即</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lb"><img src="../Images/9917f5b9b4308a3e66c18fdbec6e7517.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*21nYGXxf2sqMVqZd"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">照片由<a class="ae jm" href="https://unsplash.com/@chromatograph?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">色谱仪</a>在<a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><blockquote class="lc"><p id="027d" class="ld le hh bd lf lg lh li lj lk ll la dx translated">MP#1 -&gt;所有客户都不同</p></blockquote><p id="313d" class="pw-post-body-paragraph kf kg hh kh b ki lm ii kk kl ln il kn ko lo kq kr ks lp ku kv kw lq ky kz la ha bi translated">顾客异质性是所有公司在制定成功的营销计划时都必须考虑的一个基本“问题”,因为顾客对产品和服务的偏好自然会在许多方面有所不同。假设所有的消费者都是一样的，只能适用于垄断或公用事业这样的例外情况；否则，其他公司将不可避免地继续分一杯羹，也就是说，以更合适的报价瞄准利基市场。</p><p id="2c9c" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">为了管理客户异质性，我们有几种方法，<strong class="kh hi"> STP </strong>分析是其中之一。<strong class="kh hi"> STP </strong>代表<strong class="kh hi">分段</strong>、<strong class="kh hi">瞄准</strong>、<strong class="kh hi">定位</strong>。</p><p id="027e" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">这里我们只讨论如何对客户进行细分。细分是将整个市场分成不同群体的过程，每个群体都有相似的需求和偏好。同样，细分客户的方法有很多，但我们将重点关注数据驱动的方法，特别是<strong class="kh hi">聚类分析</strong>来细分客户。</p><p id="9ce5" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">我假设你已经熟悉这种无监督的机器学习技术- <strong class="kh hi">聚类分析</strong>。如果还没有，你可以继续，但是我强烈建议你浏览一遍这些概念。</p></div><div class="ab cl lw lx go ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ha hb hc hd he"><h1 id="6488" class="jn jo hh bd jp jq md js jt ju me jw jx in mf io jz iq mg ir kb it mh iu kd ke bi translated">数据</h1><p id="a74e" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">接下来，我们来谈谈数据。因为我认为这是分析中最有趣的部分。我从《营销策略:基于第一原则和帕尔马提埃和斯里达尔的数据分析》这本书的配套网站的资源部分挑选了这些数据。有一点我想提一下，这本书给了我很大的启发。如果你对数据驱动的营销策略感兴趣，我强烈推荐这本书。</p><p id="df72" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">你可以从下面买到这本书。</p><ul class=""><li id="b1fb" class="mi mj hh kh b ki lr kl ls ko mk ks ml kw mm la mn mo mp mq bi translated"><a class="ae jm" href="https://amzn.to/3ykgsQ2" rel="noopener ugc nofollow" target="_blank"> 2017版</a></li><li id="1d31" class="mi mj hh kh b ki mr kl ms ko mt ks mu kw mv la mn mo mp mq bi translated"><a class="ae jm" href="https://amzn.to/3hc8NO7" rel="noopener ugc nofollow" target="_blank"> 2021版</a></li></ul><p id="7a29" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">我们有一份对奥雷甘大学伦德奎斯特商学院1000名校友的调查数据，内容是他们对智能手表功能的偏好，以及一些人口统计信息。</p><p id="3842" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">好的，在继续之前，你必须详细阅读背景、问题陈述和数据信息<a class="ae jm" href="https://github.com/ShivamSoliya/Intel_Smartwatch_Market_Segmentation/blob/main/SmartwatchSegmentation_Case.pdf" rel="noopener ugc nofollow" target="_blank">这里</a>。而你可以在这里找到excel表格<a class="ae jm" href="https://github.com/ShivamSoliya/Intel_Smartwatch_Market_Segmentation/blob/main/Smartwatch_Market_Segmentation.xlsx" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="5fb1" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">为了让你更容易理解，这些是调查中问受试者的问题。所有这些问题和特点将构成我们的专题专栏。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mw mx l"/></div></figure></div><div class="ab cl lw lx go ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ha hb hc hd he"><h1 id="3272" class="jn jo hh bd jp jq md js jt ju me jw jx in mf io jz iq mg ir kb it mh iu kd ke bi translated">关于k原型算法</h1><p id="a17c" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">我们考虑了k原型算法，你可以说它是k均值和k模式的混合。使用<strong class="kh hi"> k-prototypes </strong>算法的原因是它可以同时处理数字和分类特征，并且数据的大部分列都是分类的。</p><p id="b32d" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">贾和宋在他们的文章[1。]声明k-prototypes算法结合了数字部分的"<strong class="kh hi">手段</strong>和分类部分的"<strong class="kh hi">模式</strong>"来构建新的混合聚类中心"<strong class="kh hi">原型</strong>"。在“原型”的基础上，建立了适用于混合型数据的相异系数公式和代价函数。</p><p id="92de" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">引入参数<strong class="kh hi"> γ <em class="my"> </em> </strong>来控制类别特征和数值特征对聚类过程的影响。假设混合型数据集具有<strong class="kh hi"> <em class="my"> p </em> </strong> <em class="my"> </em>数值特征和<strong class="kh hi"> <em class="my"> m-p </em> </strong>类别特征。对于任一<strong class="kh hi"> <em class="my">、</em> ∈ <em class="my"> D </em> </strong>，k原型的<strong class="kh hi">相异系数的定义如下式所示:</strong></p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mz"><img src="../Images/52956b1ab868b840ada9c4d4961f08c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*RgoEmtN02ytOwpH5QUGEMA.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">来源:贾与宋[1]</figcaption></figure><p id="5ba7" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">这只是理论上的，实际上你只需要:</p><ul class=""><li id="b4d1" class="mi mj hh kh b ki lr kl ls ko mk ks ml kw mm la mn mo mp mq bi translated">安装kmodes包。</li><li id="7a7d" class="mi mj hh kh b ki mr kl ms ko mt ks mu kw mv la mn mo mp mq bi translated">从kmodes.kprototypes包中导入KPrototype类。</li><li id="b498" class="mi mj hh kh b ki mr kl ms ko mt ks mu kw mv la mn mo mp mq bi translated">将数值列的数据类型转换为浮点型。</li><li id="3311" class="mi mj hh kh b ki mr kl ms ko mt ks mu kw mv la mn mo mp mq bi translated">给出数组作为输入数据，而不是数据帧。</li><li id="62f3" class="mi mj hh kh b ki mr kl ms ko mt ks mu kw mv la mn mo mp mq bi translated">在拟合数据时，明确给出分类列的列表。</li></ul></div><div class="ab cl lw lx go ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ha hb hc hd he"><h1 id="b208" class="jn jo hh bd jp jq md js jt ju me jw jx in mf io jz iq mg ir kb it mh iu kd ke bi translated">履行</h1><h2 id="24bd" class="na jo hh bd jp nb nc nd jt ne nf ng jx ko nh ni jz ks nj nk kb kw nl nm kd nn bi translated">导入库</h2><pre class="ix iy iz ja fd no np nq nr aw ns bi"><span id="3e56" class="na jo hh np b fi nt nu l nv nw">import os<br/>import numpy as np<br/>import pandas as pd</span><span id="f89f" class="na jo hh np b fi nx nu l nv nw">import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>%matplotlib inline</span><span id="c26a" class="na jo hh np b fi nx nu l nv nw">import warnings<br/>warnings.filterwarnings('ignore')</span></pre><h2 id="0af2" class="na jo hh bd jp nb nc nd jt ne nf ng jx ko nh ni jz ks nj nk kb kw nl nm kd nn bi translated">加载数据</h2><p id="772b" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">数据以2张excel表格的形式给出。所以我们把它分别加载为分割和区分。如果你想进行另一种叫做判别分析的市场分析，这种划分会很有帮助。但是对于聚类分析，我们最终将不得不连接数据，我们在执行一些EDA和预处理步骤后做了同样的事情。</p><pre class="ix iy iz ja fd no np nq nr aw ns bi"><span id="b10d" class="na jo hh np b fi nt nu l nv nw"># Setting base directory<br/>BASE_DIR = os.getcwd()</span><span id="ef07" class="na jo hh np b fi nx nu l nv nw"># Creating path to the segmentation dataset excel file<br/>SEG_PATH = os.path.join(BASE_DIR, 'Smartwatch_Market_Segmentation.xlsx')</span><span id="c276" class="na jo hh np b fi nx nu l nv nw"># Loading both the datasets<br/>segmentation = pd.read_excel(SEG_PATH, index_col=1, header=3, sheet_name='Segmentation Data')</span><span id="76a9" class="na jo hh np b fi nx nu l nv nw">discrimination = pd.read_excel(SEG_PATH, index_col=1, header=3, sheet_name='Discrimination Data')</span></pre><h2 id="65b7" class="na jo hh bd jp nb nc nd jt ne nf ng jx ko nh ni jz ks nj nk kb kw nl nm kd nn bi translated">EDA和数据预处理</h2><pre class="ix iy iz ja fd no np nq nr aw ns bi"><span id="7192" class="na jo hh np b fi nt nu l nv nw"># Creating copies of our datasets<br/>df_seg = segmentation.copy()<br/>df_dis = discrimination.copy()</span><span id="1e85" class="na jo hh np b fi nx nu l nv nw">#There was an entire column of null values on both of the Dataframes.  So we have to drop it.<br/>df_seg.dropna(axis=1, how='all', inplace=True)<br/>df_dis.dropna(axis=1, how='all', inplace=True)</span></pre><p id="7717" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">这是我们细分数据的标题。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ny"><img src="../Images/aeff693ebfbe2e9daba450852e48ab4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*No5ajPQYTGZKvm7__aJOlA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">分段数据的头文件</figcaption></figure><p id="ad67" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">这是我们歧视数据的标题。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nz"><img src="../Images/ae8b45a1354b8c4419b834612fafa048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TM5zcZMhcJFG8qQ1lj8oiQ.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">鉴别数据的头文件</figcaption></figure><p id="6223" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">让我们看看价格、年龄和收入分布。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es oa"><img src="../Images/4963df9fb8d92149be4de39737df5646.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*AjWYO5hNkOyS-S2ECBHqxg.png"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ob"><img src="../Images/6917f8497c7373e21a4588b9015aa022.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*XCZtfslX5CepOFVApoG2jA.png"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es oc"><img src="../Images/ee80183785774ff6388e885065609a9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*KuHZiz0L5x1_Pu4LYhvnIg.png"/></div></figure><ul class=""><li id="f893" class="mi mj hh kh b ki lr kl ls ko mk ks ml kw mm la mn mo mp mq bi translated">价格分布看起来有点偏右。</li><li id="c3eb" class="mi mj hh kh b ki mr kl ms ko mt ks mu kw mv la mn mo mp mq bi translated">年龄分布从24岁到47岁看起来呈双峰型。</li><li id="4056" class="mi mj hh kh b ki mr kl ms ko mt ks mu kw mv la mn mo mp mq bi translated">超过38%的受试者在71𝑘−100k之间有收入</li></ul><p id="4702" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">现在，让我们分析并想象一下智能手表最重要和最不重要的特征，这些特征由参与者决定。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mw mx l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es od"><img src="../Images/f93b90758a38ac7f594b1f48e57c683e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JVbITOYjYjm3WJzMYmSM2g.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">最重要和最不重要数据的圆环图</figcaption></figure><p id="d1e2" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">从这个总结中我们可以得出几个结论:</p><ul class=""><li id="1195" class="mi mj hh kh b ki lr kl ls ko mk ks ml kw mm la mn mo mp mq bi translated">受试者最不重视照片&amp; SaveM_L(分别有14.3%和12%的受试者将其评为1、2或3)。</li><li id="4bb1" class="mi mj hh kh b ki mr kl ms ko mt ks mu kw mv la mn mo mp mq bi translated">受试者认为ConstCom &amp; Wellness最为重要(分别有13.2%和11.5%的受试者将其评为5、6或7)。</li></ul><h2 id="232f" class="na jo hh bd jp nb nc nd jt ne nf ng jx ko nh ni jz ks nj nk kb kw nl nm kd nn bi translated">连接数据以提取更多细节的时间</h2><pre class="ix iy iz ja fd no np nq nr aw ns bi"><span id="6ffc" class="na jo hh np b fi nt nu l nv nw">#Concatinating segmentation and discrimination data to fit into the model.</span><span id="62c7" class="na jo hh np b fi nx nu l nv nw">df_new = pd.concat([df_seg, df_dis], axis=1, join='inner')</span></pre><p id="cd3b" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">稍微调整一下新的数据框架，我们就可以继续前进了。</p><p id="886f" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">寻找属性之间的相关性。</p><pre class="ix iy iz ja fd no np nq nr aw ns bi"><span id="9579" class="na jo hh np b fi nt nu l nv nw">corr = df_new.corr()<br/>corr_list=[]<br/>for i in range(0, len(corr.index)):<br/>    for j in range(0, len(corr.columns)):<br/>        if ((corr.iloc[i,j] &gt; 0.5 or corr.iloc[i,j] &lt; -0.5) and corr.iloc[i,j] != 1):<br/>            corr_list.append(str(corr.index[i] + ' and ' + corr.columns[j] + ' : ' + str(round(corr.iloc[i,j], 2))))</span><span id="e8eb" class="na jo hh np b fi nx nu l nv nw">corr_list = '\n'.join(corr_list)<br/>print(corr_list)</span><span id="b3de" class="na jo hh np b fi nx nu l nv nw"># Ouput</span><span id="8dbf" class="na jo hh np b fi nx nu l nv nw">CreatCom and SaveM_T : 0.6<br/>CreatCom and Athlete : 0.51<br/>SaveM_T and CreatCom : 0.6<br/>SaveM_L and DeviceSt : 0.54<br/>SaveM_L and Wellness : 0.54<br/>SaveM_L and Athlete : 0.65<br/>SaveM_L and Age : -0.53<br/>DeviceSt and SaveM_L : 0.54<br/>Wellness and SaveM_L : 0.54<br/>Wellness and Athlete : 0.66<br/>Wellness and Style : 0.63<br/>Wellness and Age : -0.52<br/>Athlete and CreatCom : 0.51<br/>Athlete and SaveM_L : 0.65<br/>Athlete and Wellness : 0.66<br/>Athlete and Age : -0.69<br/>Style and Wellness : 0.63<br/>TV and Age : 0.51<br/>Age and SaveM_L : -0.53<br/>Age and Wellness : -0.52<br/>Age and Athlete : -0.69<br/>Age and TV : 0.51</span></pre><p id="19ba" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">年龄与运动员呈负相关。(显然！)</p><p id="0f58" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">为实验目的复制我们的新数据。</p><pre class="ix iy iz ja fd no np nq nr aw ns bi"><span id="cabb" class="na jo hh np b fi nt nu l nv nw">X = df_new.copy()</span></pre><p id="bffa" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">缩放数字列。</p><pre class="ix iy iz ja fd no np nq nr aw ns bi"><span id="f725" class="na jo hh np b fi nt nu l nv nw">from sklearn.preprocessing import StandardScaler</span><span id="c917" class="na jo hh np b fi nx nu l nv nw">scaled_X = StandardScaler().fit_transform(X[['Price', 'Age']])<br/>X[['Price', 'Age']] = scaled_X</span></pre><h2 id="a06f" class="na jo hh bd jp nb nc nd jt ne nf ng jx ko nh ni jz ks nj nk kb kw nl nm kd nn bi translated">使数据符合模型</h2><p id="47db" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">导入KPrototypes类，将数字列数据类型转换为float，并创建分类列的索引列表(适合k prototypes的要求)。</p><pre class="ix iy iz ja fd no np nq nr aw ns bi"><span id="4e71" class="na jo hh np b fi nt nu l nv nw">from kmodes.kprototypes import KPrototypes</span><span id="1068" class="na jo hh np b fi nx nu l nv nw">#dataframe to an array<br/>smart_array = X.values</span><span id="c27e" class="na jo hh np b fi nx nu l nv nw">#converting numerical columns datatype as float</span><span id="d235" class="na jo hh np b fi nx nu l nv nw">smart_array[:, 12] = smart_array[:,12].astype(float)<br/>smart_array[:, 23] = smart_array[:,23].astype(float)</span><span id="da9c" class="na jo hh np b fi nx nu l nv nw">#index of categorical columns<br/>categorical_index = list(range(0,12)) + list(range(13,23)) + list(range(24, 38))</span></pre><p id="5e48" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">绘制肘形曲线以找到最佳聚类数。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="mw mx l"/></div></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es oe"><img src="../Images/c55cb16c8e12316f656758eb239cd926.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NOmtblo9ZSlzg2by3F2SMw.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">2到10个集群的肘形曲线</figcaption></figure><p id="9970" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">通过观察肘部，3个集群看起来更好。因此，我们再次用3、4和5作为聚类数来训练模型。最终用3个集群找到满意的结果。</p><pre class="ix iy iz ja fd no np nq nr aw ns bi"><span id="cf3d" class="na jo hh np b fi nt nu l nv nw">model_3 = KPrototypes(n_clusters=3, init='Huang', random_state=42, n_jobs=-1)<br/>model_3.fit_predict(smart_array, categorical=categorical_index)<br/>print(model_3.cost_)</span><span id="438b" class="na jo hh np b fi nx nu l nv nw">#new column for cluster labels associated with each subject<br/>X['labels3'] = model_3.labels_</span></pre><p id="ef4b" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">现在，没有更好的方法来可视化多维数据中的聚类。我们尝试了主成分分析和t-SNE，但我觉得这些是基于欧氏距离的方法，而数据中的大多数特征都是分类的。所以他们没有很好地展示集群。</p><p id="2b85" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">这就是我们如何借助<em class="my"> groupby </em> function <em class="my">从聚类中得出结论。</em></p><pre class="ix iy iz ja fd no np nq nr aw ns bi"><span id="1089" class="na jo hh np b fi nt nu l nv nw">pd.set_option('max_rows',None)<br/>df_new['labels3'] = model_3.labels_<br/>df_new.groupby('labels3').agg(['median' ,'mean']).T</span></pre><h2 id="c53f" class="na jo hh bd jp nb nc nd jt ne nf ng jx ko nh ni jz ks nj nk kb kw nl nm kd nn bi translated">结果</h2><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es of"><img src="../Images/abb4e98af2883fa344ded869ef551743.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gzABRd6IQncwX1OFRV_hSw.jpeg"/></div></div></figure><h2 id="7bed" class="na jo hh bd jp nb nc nd jt ne nf ng jx ko nh ni jz ks nj nk kb kw nl nm kd nn bi translated">结论</h2><p id="bab1" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">通过查看结果表，我们可以获得每个集群(现在称为细分市场)的偏好、行为和需求信息。</p><ul class=""><li id="ced2" class="mi mj hh kh b ki lr kl ls ko mk ks ml kw mm la mn mo mp mq bi translated">第0部分受试者希望智能手表的所有功能适中，愿意支付更低的价格，是最少的iPhone用户，收入中值最低，年龄较大，等等…</li><li id="a8c4" class="mi mj hh kh b ki mr kl ms ko mt ks mu kw mv la mn mo mp mq bi translated">第1部分受试者想要更多特定功能，愿意支付高价，是最多的iPhone用户，收入中值最高，年龄中等，等等…</li><li id="9dfa" class="mi mj hh kh b ki mr kl ms ko mt ks mu kw mv la mn mo mp mq bi translated">细分市场2的受试者想要更多特定功能，愿意支付中等价格，是中等iPhone用户，收入中值略低于细分市场1，年龄较低，等等…</li></ul></div><div class="ab cl lw lx go ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ha hb hc hd he"><p id="c69c" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">我想感谢我的朋友Harsh Panchal对这个项目的帮助和支持，也感谢你一直读到最后。作为礼物，这里有一个笔记本的链接。</p><div class="og oh ez fb oi oj"><a href="https://github.com/ShivamSoliya/Intel_Smartwatch_Market_Segmentation/blob/main/smartwatch%20_market_seg.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab dw"><div class="ol ab om cl cj on"><h2 class="bd hi fi z dy oo ea eb op ed ef hg bi translated">ShivamSoliya/英特尔_智能手表_市场_细分</h2><div class="oq l"><h3 class="bd b fi z dy oo ea eb op ed ef dx translated">在GitHub上创建一个帐户，为ShivamSoliya/Intel _ smart watch _ Market _ Segmentation的发展做出贡献。</h3></div><div class="or l"><p class="bd b fp z dy oo ea eb op ed ef dx translated">github.com</p></div></div><div class="os l"><div class="ot l ou ov ow os ox jg oj"/></div></div></a></div><p id="d26a" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">请看看，如果你认为我做错了什么，或者你认为这个项目可以改进，请随时联系我。</p></div><div class="ab cl lw lx go ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ha hb hc hd he"><h1 id="25a3" class="jn jo hh bd jp jq md js jt ju me jw jx in mf io jz iq mg ir kb it mh iu kd ke bi translated">参考</h1><ol class=""><li id="6637" class="mi mj hh kh b ki kj kl km ko oy ks oz kw pa la pb mo mp mq bi translated"><strong class="kh hi">贾</strong>和<strong class="kh hi">宋陵</strong>，“基于混合相异系数的加权k-Prototypes聚类算法”，印度工程中的数学问题，第2020卷，文章编号5143797</li><li id="2046" class="mi mj hh kh b ki mr kl ms ko mt ks mu kw mv la pb mo mp mq bi translated"><strong class="kh hi">罗伯特·w·帕尔马提耶</strong>和<strong class="kh hi">什里哈里·斯里达尔</strong>，《营销战略:基于基本原则和数据分析》，2017年，第35–44页</li><li id="ef00" class="mi mj hh kh b ki mr kl ms ko mt ks mu kw mv la pb mo mp mq bi translated"><strong class="kh hi">康纳·亨德森、什里哈里·斯里达尔</strong>和<strong class="kh hi">亚历杭德罗·勒扎·杜兰特</strong>，《营销战略:基于第一原则和数据分析，数据分析案例1》，2017年</li></ol></div><div class="ab cl lw lx go ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ha hb hc hd he"><p id="fcbe" class="pw-post-body-paragraph kf kg hh kh b ki lr ii kk kl ls il kn ko lt kq kr ks lu ku kv kw lv ky kz la ha bi translated">最初发布于<a class="ae jm" href="https://vocal.media/journal/customer-segmentation-using-k-prototypes-algorithm" rel="noopener ugc nofollow" target="_blank"> vocal.media </a></p></div></div>    
</body>
</html>