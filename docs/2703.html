<html>
<head>
<title>How to measure driving distance, time, and plot routes between geographical locations using Python.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Python测量行驶距离、时间并绘制地理位置之间的路线。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/measure-driving-distance-time-and-plot-routes-between-two-geographical-locations-using-python-39995dfea7e?source=collection_archive---------0-----------------------#2021-05-14">https://medium.com/analytics-vidhya/measure-driving-distance-time-and-plot-routes-between-two-geographical-locations-using-python-39995dfea7e?source=collection_archive---------0-----------------------#2021-05-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/5f8479d00995a37871e1e42448cce51c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mrsl2Vcl565ZSErKvKpjig@2x.jpeg"/></div></div></figure><p id="2618" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">曾经尝试为您的数据科学项目寻找开源工具或解决任何现实世界的路由问题吗？没有明确的想法就结束了？如果是这样，这篇快速阅读会引导你走向正确的道路。</p><h2 id="2bc5" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">我们正在使用的工具，</h2><ul class=""><li id="63b2" class="kj kk hi is b it kl ix km jb kn jf ko jj kp jn kq kr ks kt bi translated">如果你是一个数据即爱好者，你可能已经听说过叶。叶是流行的<a class="ae ku" href="https://leafletjs.com/" rel="noopener ugc nofollow" target="_blank">小叶. js </a>库的python包装器。这是一个易于使用和流畅的交互式地理数据可视化库。</li><li id="ea94" class="kj kk hi is b it kv ix kw jb kx jf ky jj kz jn kq kr ks kt bi translated"><a class="ae ku" href="https://openrouteservice.org/" rel="noopener ugc nofollow" target="_blank">openrouteservice</a>——基于开放标准和开放地理数据为汽车、行人和自行车提供路线服务。</li></ul><h2 id="a520" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">安装所需的库，</h2><p id="7187" class="pw-post-body-paragraph iq ir hi is b it kl iv iw ix km iz ja jb la jd je jf lb jh ji jj lc jl jm jn hb bi translated">当我们继续使用Python语言时，我们可以运行，</p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="6b38" class="jo jp hi li b fi lm ln l lo lp">pip install openrouteservice folium </span></pre><p id="4a27" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">用于安装所需的库。</p><h2 id="c1c6" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">导入和试运行、</h2><figure class="ld le lf lg fd ij"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="114b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果你仔细观察你的回答，你会看到下面的结构。</p><figure class="ld le lf lg fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/e5328ef38d3742d3f97cac24f96341bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*r_sg1Tkbjpt22Y5B0bkO5w.png"/></div><figcaption class="lt lu et er es lv lw bd b be z dx translated">response.json</figcaption></figure><p id="920b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在我们的例子中，我们只在之后使用routes属性。让我们看看routes属性。</p><figure class="ld le lf lg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/d8345cf8c1d04810244e1a043000716e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rkfRzU4yEj3MVbXSzUuGnA.png"/></div></div><figcaption class="lt lu et er es lv lw bd b be z dx translated">路线结构</figcaption></figure><p id="bec2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因为我们的目的是在给定点之间绘制路线，所以我们可以使用路线的几何属性。默认情况下，方向API返回<a class="ae ku" href="https://developers.google.com/maps/documentation/utilities/polylinealgorithm" rel="noopener ugc nofollow" target="_blank">编码的折线</a>。</p><p id="d5b5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">别担心，我们有一个内置的方法可以将其解码成Python字典。</p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="81ad" class="jo jp hi li b fi lm ln l lo lp">geometry = client.directions(coords)['routes'][0]['geometry']<br/>decoded = convert.decode_polyline(geometry)<br/>print(decoded)</span></pre><p id="476e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将打印出我们可以在可视化部分使用的GeoJSON几何对象。</p><h2 id="bea8" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">绘制路径，</h2><figure class="ld le lf lg fd ij"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="8725" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是输出。</p><figure class="ld le lf lg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/ae41d8b024639c53f9981f93200c27ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c8yh2OwJDf5y7W6UzR7lgQ.png"/></div></div><figcaption class="lt lu et er es lv lw bd b be z dx translated">绘制路径</figcaption></figure><p id="6a49" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">用这几行代码，我们就画出了两点之间的路线。没有源点和目的点，当前的视图是不完整的。我们也来补充一下。</p><figure class="ld le lf lg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/bbfd9b46b90110da400be4a565d07002.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tKJVG6fDhb9DXx7BGzDEIw.png"/></div></div></figure><p id="7c2c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在我们创建了两个地理位置的基本地图。然后，尝试添加更多的功能，比如节目时长，两点之间的行驶距离。</p><p id="94c0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要访问旅行时间和持续时间，我们可以使用summary属性。</p><figure class="ld le lf lg fd ij er es paragraph-image"><div class="er es ma"><img src="../Images/bf0422f27c3073f8a0e65bf845633baf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*TkYm9kQ8HqqaZ8Hl6Xzozw.png"/></div></figure><p id="f505" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它以米和分钟为单位返回给定点之间的距离和持续时间。</p><p id="5410" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先，我们需要为单击路线时的弹出窗口准备文本。</p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="c73a" class="jo jp hi li b fi lm ln l lo lp">distance_txt = "&lt;h4&gt; &lt;b&gt;Distance :&amp;nbsp" + "&lt;strong&gt;"+str(round(res['routes'][0]['summary']['distance']/1000,1))+" Km &lt;/strong&gt;" +"&lt;/h4&gt;&lt;/b&gt;"</span><span id="efc0" class="jo jp hi li b fi mb ln l lo lp">duration_txt = "&lt;h4&gt; &lt;b&gt;Duration :&amp;nbsp" + "&lt;strong&gt;"+str(round(res['routes'][0]['summary']['duration']/60,1))+" Mins. &lt;/strong&gt;" +"&lt;/h4&gt;&lt;/b&gt;"</span></pre><p id="e3ba" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，我们可以使用以下方式将其添加到地图中，</p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="314a" class="jo jp hi li b fi lm ln l lo lp">folium.GeoJson(decoded).add_child(folium.Popup(distance_txt+duration_txt,max_width=300)).add_to(m)</span></pre><p id="f069" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后，我们得到了这个输出。</p><figure class="ld le lf lg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/6da1726857e1dc0c684c147b072150a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Cza0H1yix7wqdOQAVRGZGA.gif"/></div></div></figure><p id="4fb7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">随意使用API和其他响应属性，例如</p><pre class="ld le lf lg fd lh li lj lk aw ll bi"><span id="d006" class="jo jp hi li b fi lm ln l lo lp">routes[0]['segments']</span></pre><figure class="ld le lf lg fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/9d1e9dd109c6d0c65319286300b6c6bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zdGC0fcbRphVym-ofjnK6g.png"/></div></div></figure><h2 id="7a70" class="jo jp hi bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki bi translated">完整代码，</h2><figure class="ld le lf lg fd ij"><div class="bz dy l di"><div class="lq lr l"/></div></figure><p id="94ea" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">此外，您可以根据您的用例使用一些替代方案，</p><ul class=""><li id="c660" class="kj kk hi is b it iu ix iy jb me jf mf jj mg jn kq kr ks kt bi translated"><a class="ae ku" href="http://project-osrm.org/" rel="noopener ugc nofollow" target="_blank">开源路由机器(OSRM)</a>-现代C++路由引擎，用于道路网络中的最短路径。</li></ul><p id="5bb6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">渴望知道你对这篇文章的反馈。谢谢！</p><p id="3725" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="mh">参考文献</em> </strong></p><ul class=""><li id="2db0" class="kj kk hi is b it iu ix iy jb me jf mf jj mg jn kq kr ks kt bi translated"><a class="ae ku" href="https://github.com/GIScience/openrouteservice-py" rel="noopener ugc nofollow" target="_blank">https://github.com/GIScience/openrouteservice-py</a></li><li id="202a" class="kj kk hi is b it kv ix kw jb kx jf ky jj kz jn kq kr ks kt bi translated"><a class="ae ku" href="https://autogis-site.readthedocs.io/en/latest/notebooks/L5/02_interactive-map-folium.html" rel="noopener ugc nofollow" target="_blank">https://auto GIS-site . readthedocs . io/en/latest/notebooks/L5/02 _ interactive-map-folio . html</a></li></ul></div></div>    
</body>
</html>