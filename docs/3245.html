<html>
<head>
<title>Malaria Detection using ResNet 50: Malar-AI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用ResNet 50检测疟疾:Malar-AI</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/malaria-detection-using-resnet-50-malar-ai-46345578b461?source=collection_archive---------18-----------------------#2021-06-20">https://medium.com/analytics-vidhya/malaria-detection-using-resnet-50-malar-ai-46345578b461?source=collection_archive---------18-----------------------#2021-06-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="5bd4" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">第二部分</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/02b69e0771f254a06a0a9c4abbe19e18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BJaSQGZZUE7mskZH"/></div></div></figure><p id="33be" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">现在我们知道了什么是Malar-AI，我们准备好开始自动检测疟疾并理解其背后的模型。如果你还没有看过<a class="ae ke" href="https://palakchaudhry.medium.com/malaria-detection-using-resnet-50-malar-ai-bc87845da65b" rel="noopener">第一部</a>，去看看吧！</p><h1 id="7017" class="kf kg hh bd kh ki kj kk kl km kn ko kp in kq io kr iq ks ir kt it ku iu kv kw bi translated">谢谢你的开源数据</h1><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es kx"><img src="../Images/cf1c7f1c7dbd19c052590f75623247a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DLEdcR3uFQvCyGyfI2HTHA.jpeg"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">图片由卡洛斯提供</figcaption></figure><p id="34b6" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">我发现了这个惊人的监督数据集，它包含27，558个单细胞图像，其中正常细胞和感染细胞的数量相等。关于这个数据集的另一个很酷的事实是，这些图像是从手机上拍摄的，而不是一些花哨的显微镜。更多信息，你可以点击这里访问<a class="ae ke" href="https://lhncbc.nlm.nih.gov/LHC-publications/pubs/MalariaDatasets.html" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="64a4" class="kf kg hh bd kh ki kj kk kl km kn ko kp in kq io kr iq ks ir kt it ku iu kv kw bi translated">ResNet-50架构</h1><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lc"><img src="../Images/8dcb491668d291318c6ea2afe4111e80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xHMUICvbGOaHN-HzpEAe8A.png"/></div></div><figcaption class="ky kz et er es la lb bd b be z dx translated">ResNet-50架构</figcaption></figure><p id="42f4" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">ResNet-50型号的详细信息如下:</p><ul class=""><li id="8f07" class="ld le hh jk b jl jm jo jp jr lf jv lg jz lh kd li lj lk ll bi translated">零填充用(3，3)填充输入</li></ul><h2 id="4824" class="lm kg hh bd kh ln lo lp kl lq lr ls kp jr lt lu kr jv lv lw kt jz lx ly kv lz bi translated">第一阶段:</h2><ul class=""><li id="d7e6" class="ld le hh jk b jl ma jo mb jr mc jv md jz me kd li lj lk ll bi translated">2D卷积有64个形状为(7，7)的滤波器，并使用(2，2)的步长。它的名字叫“conv1”。</li><li id="c126" class="ld le hh jk b jl mf jo mg jr mh jv mi jz mj kd li lj lk ll bi translated">BatchNorm应用于输入的通道轴。</li><li id="2f27" class="ld le hh jk b jl mf jo mg jr mh jv mi jz mj kd li lj lk ll bi translated">最大池使用(3，3)窗口和(2，2)步距。</li></ul><h2 id="ff2d" class="lm kg hh bd kh ln lo lp kl lq lr ls kp jr lt lu kr jv lv lw kt jz lx ly kv lz bi translated">第二阶段:</h2><ul class=""><li id="6c0c" class="ld le hh jk b jl ma jo mb jr mc jv md jz me kd li lj lk ll bi translated">卷积块使用三组大小为[64，64，256]的滤波器。</li><li id="0bbd" class="ld le hh jk b jl mf jo mg jr mh jv mi jz mj kd li lj lk ll bi translated">这两个单位块使用三组大小为[64，64，256]的滤波器。</li></ul><h2 id="88ae" class="lm kg hh bd kh ln lo lp kl lq lr ls kp jr lt lu kr jv lv lw kt jz lx ly kv lz bi translated">第三阶段:</h2><ul class=""><li id="ccd6" class="ld le hh jk b jl ma jo mb jr mc jv md jz me kd li lj lk ll bi translated">卷积块使用三组大小为[128，128，512]的滤波器。</li><li id="1849" class="ld le hh jk b jl mf jo mg jr mh jv mi jz mj kd li lj lk ll bi translated">这3个单位块使用三组大小为[128，128，512]的滤波器。</li></ul><h2 id="7162" class="lm kg hh bd kh ln lo lp kl lq lr ls kp jr lt lu kr jv lv lw kt jz lx ly kv lz bi translated">第四阶段:</h2><ul class=""><li id="880d" class="ld le hh jk b jl ma jo mb jr mc jv md jz me kd li lj lk ll bi translated">卷积块使用三组大小为[256，256，1024]的滤波器。</li><li id="d47f" class="ld le hh jk b jl mf jo mg jr mh jv mi jz mj kd li lj lk ll bi translated">这5个单位块使用三组大小为[256，256，1024]的滤波器。</li></ul><h2 id="6764" class="lm kg hh bd kh ln lo lp kl lq lr ls kp jr lt lu kr jv lv lw kt jz lx ly kv lz bi translated">第五阶段:</h2><ul class=""><li id="e4ba" class="ld le hh jk b jl ma jo mb jr mc jv md jz me kd li lj lk ll bi translated">卷积块使用三组大小为[512，512，2048]的滤波器。</li><li id="30fa" class="ld le hh jk b jl mf jo mg jr mh jv mi jz mj kd li lj lk ll bi translated">这两个单位块使用三组大小为[512，512，2048]的滤波器。</li></ul><h2 id="a9d1" class="lm kg hh bd kh ln lo lp kl lq lr ls kp jr lt lu kr jv lv lw kt jz lx ly kv lz bi translated">最后一块</h2><ul class=""><li id="feee" class="ld le hh jk b jl ma jo mb jr mc jv md jz me kd li lj lk ll bi translated">2D平均池使用形状为(2，2)的窗口，其名称为“avg_pool”。</li><li id="f9c1" class="ld le hh jk b jl mf jo mg jr mh jv mi jz mj kd li lj lk ll bi translated">展平没有任何超参数或名称。</li><li id="b59f" class="ld le hh jk b jl mf jo mg jr mh jv mi jz mj kd li lj lk ll bi translated">全连接(密集)图层使用softmax函数减少其输入的类数。在我的例子中，将只有两类——感染和正常。</li></ul><h1 id="e9c8" class="kf kg hh bd kh ki kj kk kl km kn ko kp in kq io kr iq ks ir kt it ku iu kv kw bi translated">Keras上的预训练ResNet模型</h1><p id="d74f" class="pw-post-body-paragraph ji jj hh jk b jl ma ii jn jo mb il jq jr mk jt ju jv ml jx jy jz mm kb kc kd ha bi translated">虽然编码和修改剩余网络很有趣，但Keras有一个预先训练好的库！这样使用起来更快更方便。下面是如何在一行中加载模型</p><pre class="ix iy iz ja fd mn mo mp mq aw mr bi"><span id="575c" class="lm kg hh mo b fi ms mt l mu mv">base_model = keras.applications.resnet50.ResNet50(weights= <strong class="mo hi">None</strong>, include_top=<strong class="mo hi">False</strong>, input_shape= (224,224,3))</span></pre><p id="3ed6" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">这里，权重=无，因为我想用随机权重初始化模型。我的图像单元格的输入形状是224*224*3。</p><pre class="ix iy iz ja fd mn mo mp mq aw mr bi"><span id="eb8e" class="lm kg hh mo b fi ms mt l mu mv">x = base_model.output<br/>x = GlobalAveragePooling2D()(x)<br/>x = Dropout(0.7)(x)<br/>predictions = Dense(2, activation= 'softmax')(x)<br/><br/><strong class="mo hi">from</strong> <strong class="mo hi">keras.models</strong> <strong class="mo hi">import</strong> Model<br/>model = Model(inputs = base_model.input, outputs = predictions</span></pre><p id="890c" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">我在ResNet-50模型中添加了全局平均池和密集输出层。</p><pre class="ix iy iz ja fd mn mo mp mq aw mr bi"><span id="6dc8" class="lm kg hh mo b fi ms mt l mu mv">model.compile(optimizer=Adam(lr=0.001),loss="binary_crossentropy",metrics=["F2 score"])</span></pre><p id="c481" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">我使用学习率为0.001的Adam优化器，并使用F2分数作为我的指标。</p></div><div class="ab cl mw mx go my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ha hb hc hd he"><h1 id="09ff" class="kf kg hh bd kh ki nd kk kl km ne ko kp in nf io kr iq ng ir kt it nh iu kv kw bi translated">密码</h1><p id="4253" class="pw-post-body-paragraph ji jj hh jk b jl ma ii jn jo mb il jq jr mk jt ju jv ml jx jy jz mm kb kc kd ha bi translated">该项目的代码可在<a class="ae ke" href="https://github.com/Palak-Chaudhry/Malaria-detection-using-ResNet-50" rel="noopener ugc nofollow" target="_blank">这里</a>获得。非常感谢<a class="ae ke" href="https://vishantbatta.com/" rel="noopener ugc nofollow" target="_blank">维尚·巴蒂</a>和<a class="ni nj ge" href="https://medium.com/u/99b584ada19?source=post_page-----46345578b461--------------------------------" rel="noopener" target="_blank">罗汉·恩</a>在整个过程中做出的贡献。我们还制作了一个应用程序的MVP，目前正在开发移动麦克风。</p><p id="ab57" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">我用这个作为我工作的参考文件。</p></div></div>    
</body>
</html>