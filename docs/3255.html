<html>
<head>
<title>EDA Using SQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用SQL的EDA</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/eda-using-sql-f771f9311876?source=collection_archive---------4-----------------------#2021-06-21">https://medium.com/analytics-vidhya/eda-using-sql-f771f9311876?source=collection_archive---------4-----------------------#2021-06-21</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="b145" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">使用SQL的数据分析过程的完整演练。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/0bceb989ae4c6966a0619f7daf59195c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rhUa3WLO69YyeRpI"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">卢克·切瑟在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="81f2" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">介绍</h1><p id="7fbc" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">SQL代表结构化查询语言。它是与数据库交互的标准语言。SQL是最重要的工具，数据分析师用它来操纵数据并从中获得洞察力。在本项目中，我们将尝试清理、处理和分析数据，为此我们将使用来自UCI机械学习资源库的<strong class="ih hj"/><a class="ae jt" href="https://archive.ics.uci.edu/ml/index.php" rel="noopener ugc nofollow" target="_blank"/>的<a class="ae jt" href="https://archive.ics.uci.edu/ml/datasets/automobile" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">汽车数据</strong>。</a></p><p id="d9fe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于这个项目，我将使用MySQL工作台。你可以从<a class="ae jt" href="https://dev.mysql.com/downloads/windows/installer/8.0.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">这里</strong>下载。</a> MySQL是一个开源的关系数据库管理系统。请随意使用任何其他RDBMS软件。现在我们有了软件设置，接下来让我们将数据集导入数据库。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kx"><img src="../Images/486a4e420593023769bf6c1b943873b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*h3uNVlYrdh1Be4au"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">马克·克林在<a class="ae jt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="79e3" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">导入数据</h1><p id="d17d" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">要在MySQL workbench中导入数据，请遵循给定的步骤，因为数据集是CSV格式，我们必须使用<em class="ky">表数据导入向导菜单导入数据。</em></p><ol class=""><li id="d25d" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc le lf lg lh bi translated">创建一个名为<em class="ky">汽车</em>的数据库。</li><li id="0047" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">右击模式栏中的汽车数据库，并从菜单中选择<em class="ky">表格数据导入向导选项。</em></li><li id="bf66" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">现在，在文件选择窗口中输入文件的路径，然后单击下一步。</li><li id="2b90" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">在选择目标窗口中点击<em class="ky">创建新表</em>并将表名设置为<em class="ky"> automobile_data，然后点击下一步</em>。</li><li id="1ec7" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">在设置窗口中，保持值不变，然后单击下一步。</li><li id="a6a9" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">最后点击Next按钮执行任务，数据集导入成功！！！</li></ol><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ln"><img src="../Images/8faa3ce8fd6f2962cd092e025c2664da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MHv84VcNPvlrk4Kd-rChFA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">导入数据集</figcaption></figure><p id="bef7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，在创建数据库之后，让我们开始研究数据并回答一些问题。好吧，在开始之前，让我们假设你已经开始了二手车经销企业。你想知道哪些车是顾客最想购买的，这样你就知道哪些车需要库存。现在我们的目标很明确，让我们来分析数据！！！</p><h1 id="85fa" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">数据清理</h1><p id="31f6" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">让我们来看看我们的数据集，要查看数据，我们将使用以下查询:</p><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="e6e0" class="lt jv hi lp b fi lu lv l lw lx">-- Let's load the data in the database and inspect the data.<br/>Use automobile;<br/>-- Let's have a look at the data. This query will retrieve all the data from the table.<br/>SELECT <br/>    *<br/>FROM<br/>    automobile_data;</span></pre><p id="4d55" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这将返回表中存在的所有行和列。现在让我们来看看数据的形状。</p><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="0dff" class="lt jv hi lp b fi lu lv l lw lx">-- So the below query gives us the number of columns in the dataset.<br/>SELECT <br/>    COUNT(*) AS NumberOfColumns<br/>FROM<br/>    information_schema.columns<br/>WHERE<br/>    table_name = 'automobile_data';</span><span id="59dc" class="lt jv hi lp b fi ly lv l lw lx">-- Now let's find out the number of rows.<br/>SELECT <br/>    COUNT(*) AS NumberOfRows<br/>FROM<br/>    automobile_data;</span></pre><p id="0158" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以数据中有20列和203行。</p><p id="eef5" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们检查每一列，检查数据中是否有缺失值、异常值或任何拼写错误，这些都会妨碍分析。</p><p id="9ef2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看我们有多少独特的品牌，</p><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="8c1f" class="lt jv hi lp b fi lu lv l lw lx">-- selecting distinct brands<br/>SELECT DISTINCT<br/>    make AS UniqueBrands<br/>FROM<br/>    automobile_data;</span><span id="8cf0" class="lt jv hi lp b fi ly lv l lw lx">-- checking missing values<br/>SELECT <br/>    *<br/>FROM<br/>    automobile_data<br/>WHERE<br/>    make IS NULL or make = '';</span></pre><p id="23f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有21种独特品牌的汽车可供选择。我们必须找出客户最常购买的前5款汽车。在处理分类数据时，最好的方法是找到唯一的值，这将有助于我们缩小拼写错误的范围。因此，这一列中不存在错误和缺失值。</p><p id="0c2a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们检查列<em class="ky">门数</em>，</p><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="aa2b" class="lt jv hi lp b fi lu lv l lw lx">-- check for distinct values<br/>SELECT DISTINCT<br/>    num_of_doors AS NumOfDoors<br/>FROM<br/>    automobile_data;<br/>    </span><span id="24e3" class="lt jv hi lp b fi ly lv l lw lx">-- check for missing values<br/>SELECT <br/>    *<br/>FROM<br/>    automobile_data<br/>WHERE<br/>    num_of_doors IS NULL OR num_of_doors = '';</span></pre><p id="05c7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所以这一列中有两个缺失值，品牌道奇和马自达各有一辆车在<em class="ky">门数</em>列<em class="ky">中有缺失值。</em></p><p id="c2d4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们将通过查看具有相同特征的汽车来尝试替代缺失的值。</p><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="4e69" class="lt jv hi lp b fi lu lv l lw lx">select * from automobile_data<br/>where make = 'dodge' and body_style = 'sedan' and drive_wheels = 'fwd' and engine_location = 'front';</span></pre><p id="4006" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了找出要替换的值，通过该查询，我们将找出车门、品牌道奇、车身样式(轿车、前轮和前置发动机位置)的常见数量。</p><p id="dc69" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">三辆道奇车满足这些条件，我们可以看到它们都有四个门，所以我们可以在缺失的位置替换相同的值。为了替换该值，我们将使用SQL的UPDATE语句。</p><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="ccb6" class="lt jv hi lp b fi lu lv l lw lx">update automobile_data<br/>set num_of_doors = 'four'<br/>where make = 'dodge' and body_style = 'sedan' and drive_wheels = 'fwd' and engine_location = 'front';</span></pre><p id="4865" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们已经成功地用“四”填充了缺少的值。同样，我们可以按照同样的程序来替代马自达汽车的价值。</p><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="09df" class="lt jv hi lp b fi lu lv l lw lx">-- similarly, for mazda<br/>select * from automobile_data<br/>where make = 'mazda' and fuel_type = 'diesel';</span><span id="5596" class="lt jv hi lp b fi ly lv l lw lx">-- So we will replace the missing value with 'four' as it is a sedan which usually has four doors.</span><span id="10f8" class="lt jv hi lp b fi ly lv l lw lx">-- substituting value <br/>update automobile_data<br/>set num_of_doors = 'four'<br/>where make = 'mazda' and body_style = 'sedan' and fuel_type = 'diesel';</span></pre><p id="7942" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，继续下一列，让我们检查<em class="ky"> drive_wheels </em>列，因为这也是一个分类列，让我们找出存在的不同值。</p><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="2328" class="lt jv hi lp b fi lu lv l lw lx">-- check for distinct values<br/>SELECT DISTINCT<br/>    drive_wheels AS DriveWheels<br/>FROM<br/>    automobile_data;<br/>    </span><span id="997c" class="lt jv hi lp b fi ly lv l lw lx">-- check for missing values<br/>SELECT <br/>    *<br/>FROM<br/>    automobile_data<br/>WHERE<br/>    drive_wheels IS NULL or drive_wheels = '';</span></pre><p id="421f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在结果集中，我们可以看到“4wd”出现了两次，但是没有拼写错误，那么为什么它会出现两次呢？？这是因为其中一个值中存在空白，让我们通过查看值的长度来确认这一点。我们使用length()函数。</p><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="93cc" class="lt jv hi lp b fi lu lv l lw lx">Select drive_wheels, length(drive_wheels) as length<br/>from automobile_data<br/>group by drive_wheels;</span></pre><p id="199d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，结果集显示一个值的长度为“4”。这是因为存在空白，为了删除空白，我们将使用<em class="ky"> trim() </em>函数。</p><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="c1bd" class="lt jv hi lp b fi lu lv l lw lx">Update automobile_data<br/>set drive_wheels = trim(drive_wheels)<br/>where length(drive_wheels) &gt; 3;</span></pre><p id="cfc1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们已经成功地更新了该表。让我们转到下一列，<em class="ky">气缸数量</em>。在该列中，“two”被拼错为“tow ”,因此我们需要纠正这个错误，并使用update语句用正确的值更新该表。</p><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="296f" class="lt jv hi lp b fi lu lv l lw lx">SELECT DISTINCT<br/>    num_of_cylinders AS NumOfCylinders<br/>FROM<br/>    automobile_data;</span><span id="c1e0" class="lt jv hi lp b fi ly lv l lw lx">-- Okay, so here 'two' is misspelled as 'tow', so we need to replace it.</span><span id="dbb5" class="lt jv hi lp b fi ly lv l lw lx">UPDATE automobile_data <br/>SET <br/>    num_of_cylinders = 'two'<br/>WHERE<br/>    num_of_cylinders = 'tow';</span></pre><p id="02a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，还有两列，我们需要检查— <em class="ky">压缩比</em>和<em class="ky">价格。</em>两列都有连续的值，所以让我们检查一下值的范围，看看是否有异常值。</p><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="81a8" class="lt jv hi lp b fi lu lv l lw lx">select min(compression_ratio) as MinCopressionRatio, max(compression_ratio) as MaxCompressionRatio<br/>from automobile_data;</span></pre><p id="56fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该查询将返回压缩率的最小值和最大值。我们可以看到，最大值超过了结果集中压缩比的上限。这可以从<a class="ae jt" href="https://archive.ics.uci.edu/ml/datasets/automobile" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">数据</strong> <strong class="ih hj">描述</strong> </a>中得到验证。根据描述，最大值为“23”，结果集中的最大值为“70”，这是一个异常值。因为只有一条记录，并且我们不知道具体要替换哪个值，所以我们将使用delete语句删除这条记录。</p><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="3275" class="lt jv hi lp b fi lu lv l lw lx">delete from automobile_data<br/>where compression_ratio = 70;</span></pre><p id="ba76" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们检查最后一列，即<em class="ky">价格</em>列。</p><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="9d38" class="lt jv hi lp b fi lu lv l lw lx">select min(price) as MinPrice, max(price) as MaxPrice<br/>from automobile_data;</span></pre><p id="623e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">好的，我们可以看到一些汽车的价格为“0”，这是不正确的，因为数据描述中的价格从“5118”开始。因此，为了解决这个问题，我们将用所有汽车的平均价格来代替这些值。</p><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="deb5" class="lt jv hi lp b fi lu lv l lw lx">update automobile_data<br/>set price = 12977<br/>where price = 0;</span></pre><p id="be6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们现在已经清理了数据，并准备进行分析！！！！</p><h1 id="d756" class="ju jv hi bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">分析数据</h1><p id="1918" class="pw-post-body-paragraph if ig hi ih b ii ks ik il im kt io ip iq ku is it iu kv iw ix iy kw ja jb jc hb bi translated">让我们确定我们的目标，</p><ol class=""><li id="55de" class="kz la hi ih b ii ij im in iq lb iu lc iy ld jc le lf lg lh bi translated">根据品牌查找客户购买的前5款汽车。</li><li id="2eac" class="kz la hi ih b ii li im lj iq lk iu ll iy lm jc le lf lg lh bi translated">根据body_style查找排名前5的汽车。</li></ol><p id="b6e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从第一个问题开始，为了找到基于品牌的前5辆汽车，我们将执行以下查询。</p><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="1306" class="lt jv hi lp b fi lu lv l lw lx">select make, count(make) as CarsBought<br/>from automobile_data<br/>group by make<br/>order by CarsBought DESC<br/>Limit 5;</span></pre><p id="be37" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该查询主要检索品牌的汽车数量，并按数量降序排列结果。正如我们在结果集中看到的，大多数客户更喜欢购买丰田品牌的汽车。</p><p id="3ede" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们根据车身风格找出排名前5的汽车。</p><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="8e0f" class="lt jv hi lp b fi lu lv l lw lx">select body_style, count(body_style) as CarsBought<br/>from automobile_data<br/>group by body_style<br/>order by CarsBought DESC<br/>Limit 5;</span></pre><p id="68de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这一结果表明，与其他车身款式相比，消费者更喜欢购买轿车。这里我们得到了一些具体的结果，消费者更喜欢丰田品牌的汽车和轿车车身风格的汽车。因此，让我们进一步深入调查结果，确定购买丰田汽车的客户更喜欢哪种车身风格？</p><pre class="je jf jg jh fd lo lp lq lr aw ls bi"><span id="281d" class="lt jv hi lp b fi lu lv l lw lx">select body_style, count(body_style) as CarsBought<br/>from automobile_data<br/>where make = 'toyota'<br/>group by body_style<br/>order by CarsBought DESC;</span></pre><p id="2f89" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，该查询的结果告诉我们，客户购买了丰田品牌的掀背车款，进一步挖掘数据，我们了解到客户更喜欢购买掀背车款和汽油型的丰田汽车。</p><p id="1aee" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过对数据的分析，我们现在知道了应该储备哪种类型的汽车，并可以进一步创建预测模型来预测汽车的销售，但为此，我们需要更多的数据。</p></div><div class="ab cl lz ma gp mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="hb hc hd he hf"><p id="d410" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读！如果你想与我取得联系，请随时通过<strong class="ih hj">varunbelgaonkar@gmail.com</strong>或我的<a class="ae jt" href="https://www.linkedin.com/in/varunbelgaonkar/" rel="noopener ugc nofollow" target="_blank">T3】LinkedInT5】个人资料联系我。可以查看我的</a><a class="ae jt" href="https://github.com/varunbelgaonkar" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> Github </strong> </a>个人资料，针对不同的数据分析项目。</p></div></div>    
</body>
</html>