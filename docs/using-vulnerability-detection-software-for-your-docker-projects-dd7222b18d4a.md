# ä¸ºæ‚¨çš„ Docker é¡¹ç›®ä½¿ç”¨æ¼æ´æ£€æµ‹è½¯ä»¶

> åŸæ–‡ï¼š<https://medium.com/analytics-vidhya/using-vulnerability-detection-software-for-your-docker-projects-dd7222b18d4a?source=collection_archive---------2----------------------->

![](img/a3f1877bc043465a58a6c79c4be5de65.png)

*ç…§ç‰‡ç”±*[](https://unsplash.com/@sigmund?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)**ä¸Š* [*ä¸‹*](https://unsplash.com/s/photos/code?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)*

# *å†…å®¹*

*   *Docker æ˜¯ä»€ä¹ˆï¼Ÿ*
*   *ä½¿ç”¨ Docker è¿è¡Œ Python Flask åº”ç”¨ç¨‹åº*
*   *ä»€ä¹ˆæ˜¯å¼€æºå®‰å…¨æ¼æ´ï¼Ÿ*

# *Docker æ˜¯ä»€ä¹ˆï¼Ÿ*

*Docker è®©å¼€å‘è€…ä½¿ç”¨ Docker å®¹å™¨[åˆ›å»ºã€éƒ¨ç½²å’Œè¿è¡Œåº”ç”¨ç¨‹åºå˜å¾—éå¸¸å®¹æ˜“ã€‚Docker å…è®¸å¼€å‘äººå‘˜å°†åº”ç”¨ç¨‹åºæ‰“åŒ…æˆä¸€ä¸ªåŒ…ï¼Œå…¶ä¸­åŒ…å«è¿è¡Œåº”ç”¨ç¨‹åºæ‰€éœ€çš„æ‰€æœ‰å†…å®¹ã€‚](https://www.docker.com/resources/what-container)*

*æ‚¨å¯ä»¥å°† Docker å®¹å™¨è§†ä¸ºä¸€ä¸ªå¯ä»¥è¿è¡Œæ‚¨çš„åº”ç”¨ç¨‹åºçš„å®Œæ•´ç¯å¢ƒã€‚å¯ä»¥ä½¿ç”¨ CLI(ä¾‹å¦‚, [CircleCI](https://circleci.com) æˆ– Docker API)æˆ–äº‘(ä¾‹å¦‚ Azure æˆ– On-Premises)æ¥ç®¡ç†å®¹å™¨ã€‚Docker å®¹å™¨å¯ä»¥åœ¨ Windows å’Œ Linux æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œã€‚*

*å®¹å™¨åŒ–çš„åº”ç”¨ç¨‹åºæ¯”è™šæ‹Ÿæœºä½¿ç”¨æ›´å°‘çš„èµ„æºï¼Œå› ä¸ºå®ƒä»¬å¯åŠ¨å’Œåœæ­¢æ›´å¿«ï¼Œè¿™ä½¿å¾— Docker æˆä¸ºä¸€ä¸ªé«˜æ•ˆçš„é€‰æ‹©ã€‚*

# *ä½¿ç”¨ Docker è¿è¡Œ Python Flask åº”ç”¨ç¨‹åº*

*åœ¨æ¥ä¸‹æ¥çš„ä¸€ç³»åˆ—æ­¥éª¤ä¸­ï¼Œæ‚¨å°†ä½¿ç”¨ Python åˆ›å»º flask åº”ç”¨ç¨‹åºï¼Œå¹¶ç¼–å†™ requirements.txt å’Œ DockerFileã€‚å¦‚æœæ‚¨æƒ³ç›´æ¥è·³åˆ°ä¸ Docker ä¸€èµ·è¿è¡Œéƒ¨åˆ†ï¼Œåœ¨å…‹éš†åç›´æ¥è·³åˆ°æ­¥éª¤ 4ã€‚*

*ä» GitHub å…‹éš†å­˜å‚¨åº“:*

```
*git clone [https://github.com/Soumi7/renovate-docker.git](https://github.com/Soumi7/renovate-docker.git)cd renovate-docker*
```

> *è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„ flask APIï¼Œå¹¶ç”¨ Docker è¿è¡Œå®ƒ*

1.  *åœ¨æ ¹æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ª **app.py** æ–‡ä»¶å¤¹:*

```
*from flask import Flask, request, jsonify, render_template, url_forapp = Flask(__name__)@app.route(â€˜/â€™)def home(): return â€˜Hello Worldâ€™@app.route(â€˜/predict_apiâ€™, methods=[â€œGETâ€,â€POSTâ€])def list_post(): json_body = request.get_json() predictions = 2 * json_body[0] predictions = list(predictions) return jsonify(results = predictions)if __name__ == â€˜__main__â€™: app.run(host=â€™0.0.0.0',port=5000)*
```

*2.åœ¨æ ¹æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ª **Dockerfile** :*

```
*FROM python:3.6-slimCOPY ./app.py /deploy/COPY ./requirements.txt /deploy/WORKDIR /deploy/RUN pip3 install â€” no-cache-dir -r requirements.txtEXPOSE 80ENTRYPOINT [â€œpythonâ€, â€œapp.pyâ€]*
```

*3.åˆ›å»ºä¸€ä¸ªåŒ…å«ä¾èµ–å…³ç³»çš„ **requirements.txt** æ–‡ä»¶ï¼Œåœ¨æˆ‘ä»¬ç®€å•çš„åº”ç”¨ç¨‹åºä¸­ï¼Œå®ƒåªæ˜¯ä¸€ä¸ª flask:*

```
*Flask==1.1.1*
```

*4.å®‰è£… Docker:*

*åˆ é™¤ç°æœ‰çš„ docker ç‰ˆæœ¬:*

```
*sudo apt-get remove docker docker-engine docker.io containerd runc*
```

*å®‰è£… Docker:*

```
*sudo apt-get updatesudo apt-get install docker-ce docker-ce-cli containerd.io*
```

*æ‚¨å¯ä»¥é€šè¿‡è¿è¡Œ hello-world æ˜ åƒæ¥éªŒè¯å®‰è£…æ˜¯å¦æˆåŠŸ:*

```
*sudo docker run hello-world*
```

*è¦è·å– docker å›¾åƒ:*

```
*sudo docker build -t app-test .*
```

*![](img/93886e414017368fd50831d2c5ecf8ba.png)*

*æ˜ åƒå·²ç»æ„å»ºå®Œæ¯•ï¼Œå¯ä»¥è¿è¡Œäº†ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥å®ç°è¿™ä¸€ç‚¹:*

```
*sudo docker run -p 5000:5000 app-test .*
```

*![](img/d1492aa8c32f85f3e6460ac63c22f952.png)*

> *åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€é“¾æ¥ã€‚åº”ç”¨ç¨‹åºè¿è¡Œå®Œç¾ï¼å°†æ‰€æœ‰è¿™äº›ä»£ç æ¨é€åˆ° GitHub ä¸Šçš„ä¸€ä¸ªå­˜å‚¨åº“ä¸­ã€‚*

*![](img/45dc4e22e99131f0822e21b262ca9af0.png)*

# *ä»€ä¹ˆæ˜¯å¼€æºå®‰å…¨æ¼æ´ï¼Ÿ*

*æ—¢ç„¶æ‚¨çš„åº”ç”¨ç¨‹åºå·²ç»ç”¨ Docker æ„å»ºå’Œå®¹å™¨åŒ–äº†ï¼Œæ‚¨å°±å¯ä»¥æ‰˜ç®¡å®ƒäº†ã€‚ä½†æ˜¯ï¼Œä½ å¿˜äº†ä¸€ä»¶äº‹ï¼åº”ç”¨ç¨‹åºä¸­çš„ä¾èµ–é¡¹ï¼éšç€æ–°ç‰ˆæœ¬å¼€æºåº“çš„å‘å¸ƒï¼Œæ—§ç‰ˆæœ¬è¢«å¼ƒç”¨ã€‚è¿™äº›ç‰ˆæœ¬å®¹æ˜“å—åˆ° DDoS æ”»å‡»ç­‰å®‰å…¨é—®é¢˜çš„æ”»å‡»ã€‚ä½œä¸ºç»´æŠ¤è€…ï¼Œæ‚¨å¿…é¡»ä¸æ–­åœ°ç»´æŠ¤ã€æ£€æŸ¥å’Œæ›´æ–°è¿™äº›ä¾èµ–å…³ç³»ã€‚é‚£å¾ˆè´¹æ—¶é—´ï¼Œå¯¹å—ï¼Ÿ*

*æœ‰å‡ ç§å¼€å‘äººå‘˜å·¥å…·å¯ä»¥è§£å†³å¼€æºæ¼æ´ã€‚è¿™æ ·å¯ä»¥èŠ‚çœæ—¶é—´ï¼Œé™ä½é£é™©ã€‚å…¶ä¸­åŒ…æ‹¬è¯†åˆ« node.js åº”ç”¨ç¨‹åºä¸­çš„å¨èƒçš„èŠ‚ç‚¹å®‰å…¨é¡¹ç›®(NSP)ã€æ¶µç›– NET/C#ã€Java å’Œ JavaScript çš„ OSSIndexã€pythonã€Javaã€Go çš„ Gemnasium ç­‰ç­‰ã€‚*

*å¯¹äºæœ¬æ–‡ï¼Œæˆ‘å°†ä½¿ç”¨ renewï¼Œå®ƒå¯ä»¥è¯†åˆ«åº”ç”¨ç¨‹åºä¸­çš„æ½œåœ¨å®‰å…¨æ¼æ´ã€‚å®ƒå®æ—¶è¿è¡Œä»¥è¯†åˆ«æœ€æ–°çš„å¯ç”¨ç‰ˆæœ¬ã€‚å®ƒå¯¹ NPM æ¥è¯´æ˜¯å…è´¹çš„ï¼Œä½œä¸ºä¸€ä¸ª Github åº”ç”¨ç¨‹åºå¯¹å…¬å…±å’Œç§äººçš„ä»“åº“éƒ½æ˜¯å¯ç”¨çš„ã€‚*

# *ç‰ˆæœ¬ç²¾åº¦çš„ä¿æŒ*

*é»˜è®¤æƒ…å†µä¸‹,â€œä¿®å¤â€ä¼šä¿ç•™ Docker å›¾åƒä¸­å¸ƒå±€çš„ç²¾åº¦çº§åˆ«ã€‚å¦‚æœç°æœ‰æ˜ åƒè¢«å›ºå®šåœ¨ img:1.1ï¼Œrenew ä¸ä¼šå»ºè®®å‡çº§åˆ° img:1.2.0 æˆ– img:1.3.0ã€‚renew åªä¼šæå‡ºå‡çº§åˆ° img:1.2 å’Œ img:1.3ã€‚*

> *ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç»§ç»­ä½¿ç”¨ Docker è¿›è¡Œè‡ªæˆ‘ä¸»æœºæ›´æ–°:*

*åˆ›å»ºä¸€ä¸ª`config.js`æ–‡ä»¶:*

```
*module.exports = {endpoint: â€˜https://api.github.com/',token: GITHUB_ACCESS_TOKEN,platform: â€˜githubâ€™,logLevel: â€˜debugâ€™,onboardingConfig: {extends: [â€˜config:baseâ€™],},repositories: [â€˜Soumi7/renovate-dockerâ€™],renovateFork: true,gitAuthor: â€œSoumi Bardhan <soumibardhan10@gmail.com>â€,username: â€œSoumi7â€,onboarding: false,printConfig: true,requireConfig: false,};*
```

*ç°åœ¨ï¼Œåœ¨æ·»åŠ è®¿é—®ä»¤ç‰Œä¹‹å‰ï¼Œæ‚¨éœ€è¦ç”Ÿæˆä¸€ä¸ª:*

*åœ¨æ‚¨çš„ **GitHub** ä¸ªäººèµ„æ–™ä¸­è¿›å…¥**è®¾ç½®**:*

*![](img/bd56c35f176ff88437ec100bfd62d8f0.png)*

*ä»**è®¾ç½®**ï¼Œè¿›å…¥**å¼€å‘è€…**å·¥å…·:*

*![](img/b869b27e8138ece35ab7d10229b8b38c.png)*

*è½¬åˆ°**ä¸ªäººè®¿é—®ä»¤ç‰Œ**:*

*![](img/25fe0aab4c59a612988a374e87d17eb9.png)*

*ç‚¹å‡»**ç”Ÿæˆæ–°ä»¤ç‰Œ**:*

*![](img/f91312acf03066dd55df3e9095282e98.png)*

*å¤åˆ¶å¹¶ä¿å­˜åˆ°æŸä¸ªåœ°æ–¹ï¼Œä»¥ä¾¿ä»¥åä½¿ç”¨ã€‚*

*åœ¨`config.js`æ–‡ä»¶ä¸­é€‚å½“æ·»åŠ æ‚¨çš„è¯¦ç»†ä¿¡æ¯:*

```
*module.exports = {endpoint: â€˜https://api.github.com/',token: GITHUB_ACCESS_TOKEN,platform: â€˜githubâ€™,logLevel: â€˜debugâ€™,onboardingConfig: {extends: [â€˜config:baseâ€™],},repositories: [â€˜YOUR_USERNAME/YOUR_REPO_NAME],renovateFork: true,gitAuthor: â€œYOUR_NAME <YOUR_EMAIL_ID>â€,username: â€œYOUR_GITHUB_USERNAMEâ€,onboarding: false,printConfig: true,requireConfig: false,};*
```

> *ç°åœ¨ä½ å·²ç»å‡†å¤‡å¥½äº†ï¼æ‚¨é¦–å…ˆéœ€è¦è¿ç§»æ‚¨çš„ config.jsã€‚åœ¨æ‚¨çš„ç»ˆç«¯ä¸­é”®å…¥ä»¥ä¸‹å†…å®¹:*

```
*docker run â€” rm -v â€œ/home/USER_NAME/REPO_NAME/.github/config.js:/usr/src/app/config.jsâ€ renovate/renovate*
```

*è¿™ä¹Ÿå°†**æ‹‰**æœ€æ–°ç‰ˆæœ¬çš„**ç¿»æ–°**ã€‚*

> *å½“æˆ‘ç”¨æˆ‘çš„å­˜å‚¨åº“è¿›è¡Œè¯•éªŒæ—¶ï¼Œæˆ‘æ˜¯è¿™æ ·åšçš„ã€‚å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨æˆ‘çš„å­˜å‚¨åº“ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ­¤å‘½ä»¤ã€‚åªéœ€æ›´æ”¹æœ¬åœ°ç³»ç»Ÿçš„é…ç½®è·¯å¾„ï¼*

```
*docker run â€” rm -v â€œ/home/soumi/renovate-docker/.github/config.js:/usr/src/app/config.jsâ€ renovate/renovate:25.18.4*
```

*å¦‚æœæ‚¨é”™è¯¯åœ°å°†é…ç½®æ¨é€åˆ° GitHubï¼ŒGitHub å°†è‡ªåŠ¨æ’¤é”€è¯¥ä»¤ç‰Œï¼Œæ‚¨å¿…é¡»ç”Ÿæˆå¦ä¸€ä¸ªä»¤ç‰Œã€‚*

*![](img/b3c12a9471a19eb2e2eea1f9d38d71f0.png)*

*ç§å•Šã€‚æˆåŠŸäº†ï¼å¦‚æœæ‚¨çš„ä»»ä½•ä¾èµ–é¡¹æ²¡æœ‰æ›´æ–°ï¼Œå°†ä¼šåœ¨æ‚¨çš„ GitHub å­˜å‚¨åº“ä¸­åˆ›å»ºä¸€ä¸ª PRï¼åœ¨è¿™é‡Œï¼Œå› ä¸º Renovate å°† docker æ–‡ä»¶æ ‡è¯†ä¸ºä¾èµ–é¡¹ç®¡ç†å™¨ï¼Œæ‰€ä»¥å®ƒå¯ä»¥è¯†åˆ« docker æ–‡ä»¶ä¸­çš„å¼€æºæ¼æ´ã€‚*

*![](img/e170ead3ab04fcd2bba9103e5eb144be.png)*

*å°±æ˜¯è¿™æ ·ï¼ç”¨ Docker è¿›è¡Œè‡ªæˆ‘æ”¹é€ æ˜¯å¤šä¹ˆå®¹æ˜“ï¼Œè¿™è®©æˆ‘éå¸¸å…´å¥‹ï¼*

*ç°åœ¨æˆ‘ä»¬å°†åˆ é™¤ Dockerfile æ–‡ä»¶ã€‚æˆ‘ä»¬ç°åœ¨åªæœ‰ä¸€ä¸ªç®¡ç†ä¾èµ–å…³ç³»çš„ requirements.txt æ–‡ä»¶ã€‚åˆ«å¿˜äº†æŠŠè¿™ä¸ªå˜åŒ–æ¨é€ç»™ GitHub å¦åˆ™ï¼Œä»¥ä¸‹æ­¥éª¤ä¸­çš„æ›´æ”¹å°†ä¸å¯è§ã€‚*

*requirements.txt ä¸­çš„ flask ç‰ˆæœ¬æ˜¯ 1.1.1ã€‚*

```
*docker run â€” rm -v â€œ/home/soumi/renovate-docker/.github/config.js:/usr/src/app/config.jsâ€ renovate/renovate:25.18.4*
```

*![](img/904c1012f2fc9ed02b29327699874e3e.png)*

*æ³¨æ„éœ€æ±‚æ–‡ä»¶ç°åœ¨æ˜¯å¦‚ä½•è¢«è¯†åˆ«ä¸ºä¾èµ–ç®¡ç†å™¨çš„ã€‚PRs ç°åœ¨å°†è¢«åˆ¶ä½œåˆ° requirements.txtã€‚ç°åœ¨æ‚¨å°†çœ‹åˆ°è¿™ä¸ª PR è¢«åˆ›å»ºåˆ°æ‚¨åœ¨ **GitHub** ä¸Šçš„å­˜å‚¨åº“ä¸­:*

*![](img/f4f5395bc06ce314f9df350e3a6e5c12.png)**![](img/ae5ad54993c2ebed5f5d221440cfe5a3.png)*

*è¿™æ¬¡ PR æ˜¯æŠŠ flask ç‰ˆæœ¬ä» 1.1.1 æ›´æ–°åˆ° 2.0.0ã€‚*

*å¦‚æœä½ è§‰å¾—æœ‰å¸®åŠ©ï¼Œè¯·åœ¨æˆ‘çš„ GitHub ä¸Šç•™ä¸‹ä¸€é¢—æ˜Ÿã€‚è°¢è°¢ï¼*

*[](https://github.com/Soumi7) [## Soumi7 -æ¦‚è¿°

### @ sympy @ DSC-IIIT-å¡åˆ©äºšå°¼ https://soumi7.github.io/ä½ å¥½ï¼ğŸ‘‹æˆ‘æ˜¯ Soumi Bardhanï¼Œæœ€åä¸€ä¸ªâ€¦

github.com](https://github.com/Soumi7)*