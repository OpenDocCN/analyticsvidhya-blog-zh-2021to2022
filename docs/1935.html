<html>
<head>
<title>How To Scrap YouTube Comments?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何报废YouTube评论？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-scrap-youtube-comments-cf6348ef9e09?source=collection_archive---------5-----------------------#2021-03-27">https://medium.com/analytics-vidhya/how-to-scrap-youtube-comments-cf6348ef9e09?source=collection_archive---------5-----------------------#2021-03-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/876655c8ad947f7ce7bc9700546e9361.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pk_MpmPD6eWGY23eD4TEHQ.jpeg"/></div></div></figure><p id="eb54" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">网页抓取</strong>是将信息从网站导入保存在您电脑上的本地文件的过程。稍后，您可以使用该信息进行分析。</p><p id="4868" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这里，我们将看到如何删除YouTube评论，并从抓取的数据生成csv文件。</p><p id="1da3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> 1。先决条件:</strong></p><ul class=""><li id="9f10" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">你会需要<strong class="ir hi"> Google API Key </strong>(可以参考这个<a class="ae jw" href="https://support.google.com/googleapi/answer/6158862?hl=en" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">链接</strong> </a>生成API Key <strong class="ir hi"> ) </strong></li><li id="56ec" class="jn jo hh ir b is jx iw jy ja jz je ka ji kb jm js jt ju jv bi translated">将钥匙放在<strong class="ir hi">内。环境</strong>文件</li></ul><p id="4a08" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> 2。导入所需的包:</strong></p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="41ab" class="kl km hh kh b fi kn ko l kp kq">from googleapiclient.discovery import build<br/>from urllib.parse import urlparse, parse_qs<br/>import pandas as pd<br/>import os<br/>import time<br/>from dotenv import load_dotenv<br/>load_dotenv()</span></pre><p id="a1f4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> 3。使用URL获取视频id的函数:</strong></p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="ebcb" class="kl km hh kh b fi kn ko l kp kq">def get_video_id(url):<br/>    u_pars = urlparse(url)<br/>    quer_v = parse_qs(u_pars.query).get('v')<br/>    if quer_v:<br/>        return quer_v[0]<br/>    pth = u_pars.path.split('/')<br/>    if pth:<br/>        return pth[-1]</span></pre><p id="e5ff" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> 4。功能报废备注:</strong></p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="03ee" class="kl km hh kh b fi kn ko l kp kq">def video_comments(video_id,api_key):</span><span id="f219" class="kl km hh kh b fi kr ko l kp kq">resource = build('youtube', 'v3', developerKey=api_key)</span><span id="dcb6" class="kl km hh kh b fi kr ko l kp kq">try:<br/>        request = resource.commentThreads().list(<br/>                            part="snippet,replies",<br/>                            videoId=video_id,<br/>                            maxResults= 5,<br/>                            order='time') <br/>                            <br/>    #execute the request<br/>        response =request.execute()<br/>        dfa=[]</span><span id="ba33" class="kl km hh kh b fi kr ko l kp kq">while response:<br/>            for item in response['items']:<br/>                item_info = item["snippet"]<br/>                topLevelComment = item_info["topLevelComment"]<br/>                comment_info = topLevelComment["snippet"]</span><span id="7a3f" class="kl km hh kh b fi kr ko l kp kq">dfa.append({<br/>                'comment_by': comment_info["authorDisplayName"],<br/>                'comment_text': comment_info["textDisplay"],<br/>                'comment_date': comment_info["publishedAt"],<br/>                'likes_count':  comment_info["likeCount"],<br/>                })</span><span id="64f9" class="kl km hh kh b fi kr ko l kp kq"># Again repeat<br/>            if 'nextPageToken' in response:<br/>                response = resource.commentThreads().list(<br/>                    part = 'snippet,replies',<br/>                    videoId = video_id,<br/>                    maxResults= 100,<br/>                    pageToken=response['nextPageToken']  #get 100 comments<br/>                ).execute()<br/>            else:<br/>                break<br/>    <br/>        pd.DataFrame(dfa, columns=('comment_by', 'comment_text', 'comment_date', 'likes_count'))</span><span id="19de" class="kl km hh kh b fi kr ko l kp kq">df = pd.DataFrame(dfa)</span><span id="e560" class="kl km hh kh b fi kr ko l kp kq">path = "Data/"+video_id+".csv"<br/>        full_path = os.path.abspath(path)  # get the FULL path</span><span id="a0bc" class="kl km hh kh b fi kr ko l kp kq">df.to_csv(path)<br/>        return full_path</span><span id="d92f" class="kl km hh kh b fi kr ko l kp kq">except:<br/>        return False</span></pre><p id="8cfb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> 5。函数调用:</strong></p><pre class="kc kd ke kf fd kg kh ki kj aw kk bi"><span id="2712" class="kl km hh kh b fi kn ko l kp kq">api_key = os.getenv('GOOGLE_API_KEY')<br/>url = "https://youtubeurl"</span><span id="0cdf" class="kl km hh kh b fi kr ko l kp kq">video_id = get_video_id(url)</span><span id="8aeb" class="kl km hh kh b fi kr ko l kp kq">video_comments(video_id,api_key)</span></pre><p id="bb96" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">6。检查输出:</p><ul class=""><li id="61ad" class="jn jo hh ir b is it iw ix ja jp je jq ji jr jm js jt ju jv bi translated">在<strong class="ir hi">数据</strong>目录中，您将能够看到<strong class="ir hi">。csv </strong>刮下的评论文件。</li></ul><figure class="kc kd ke kf fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ks"><img src="../Images/6720da960421b6de8ecae91bfae85b4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gopzEmsNRCrS2N4QMJs5bA.png"/></div></div></figure></div><div class="ab cl kt ku go kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ha hb hc hd he"><p id="8071" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你可以从我的GitHub账号<a class="ae jw" href="https://github.com/priyanka-ddit/Web-Scraping" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">这里</strong> </a>下载<strong class="ir hi">Python后端和React前端的源代码。</strong></p><p id="3e5f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你可以查看我的另一篇博客，了解如何使用这些数据来探索NLP技术。</p><h1 id="2811" class="la km hh bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">谢谢你。</h1></div></div>    
</body>
</html>