# ä»…ä½¿ç”¨ numpy ä»å¤´å¼€å§‹å¤šå…ƒçº¿æ€§å›å½’

> åŸæ–‡ï¼š<https://medium.com/analytics-vidhya/multiple-linear-regression-from-scratch-using-only-numpy-98fc010a1926?source=collection_archive---------2----------------------->

![](img/517f55ffb6c6df16866eaeae57d3f515.png)

å›¾ç‰‡æ¥æº:[https://morioh.com/p/0d9b2bedf683](https://morioh.com/p/0d9b2bedf683)

çº¿æ€§å›å½’æ˜¯æœºå™¨å­¦ä¹ çš„èµ·å§‹ç®—æ³•ã€‚åœ¨ scikit learn ç­‰åº“çš„å¸®åŠ©ä¸‹ï¼Œå®ç°å¤šå…ƒçº¿æ€§å›å½’å‡ ä¹ä¸éœ€è¦ä¸¤ä¸‰è¡Œä»£ç ã€‚æ•°æ®é›†ä¹Ÿå¯ä»¥åœ¨ç†ŠçŒ«çš„å¸®åŠ©ä¸‹è½»æ¾å¤„ç†ï¼Œä½†æˆ‘å°½é‡é¿å…è¿™ç§æ–¹æ³•ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘è§£é‡Šäº†å¦‚ä½•ç”¨ python å®ç°çŸ©é˜µçš„ç»å…¸æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•ç€é‡äºç›´æ¥ä»ä¹¦æœ¬åˆ°ä»£ç å®ç°ç®—æ³•ï¼æˆ‘ç”¨è¿‡çš„å”¯ä¸€ä¸€ä¸ªåŒ…æ˜¯ numpyï¼Œå› ä¸ºæˆ‘ä»¬çš„æ•°æ®é›†å¤„ç†çŸ©é˜µï¼Œè€Œ numpy æœ‰è®¸å¤šå‡½æ•°å¯ä»¥æœ‰æ•ˆåœ°å¤„ç†å®ƒä»¬ï¼Œå¦‚æœæ²¡æœ‰è¿™äº›å‡½æ•°ï¼Œæˆ‘ä»¬å°±å¿…é¡»ç¼–å†™å¤§é‡çš„å¾ªç¯ï¼Œè¿™å¯èƒ½ä»ç„¶æ²¡æœ‰ numpy æœ‰æ•ˆã€‚æ‰€ä»¥è®©æˆ‘ä»¬é©¬ä¸Šå¼€å§‹å§ï¼

æœ‰ä¸€ä¸ªä»¥ä¸Šè¾“å…¥çš„çº¿æ€§å›å½’ç§°ä¸ºå¤šå…ƒçº¿æ€§å›å½’æˆ–å¤šå…ƒå›å½’ã€‚åœ¨è¿™ä¸ªå®ç°ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†[æˆ¿åœ°äº§æ•°æ®é›†](https://www.kaggle.com/quantbruce/real-estate-price-prediction)ï¼Œå®ƒæœ‰å‡ ä¸ªç‰¹å¾ï¼Œç®—æ³•è¯•å›¾é¢„æµ‹ä»·æ ¼ï¼Œè¿™æ˜¯é¢„æµ‹å™¨ã€‚

æˆ‘ä»¬å¿…é¡»é¦–å…ˆè¿›è¡Œä¸€äº›å¯¼å…¥ï¼Œè¿™äº›å¯¼å…¥å°†åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­ä½¿ç”¨ã€‚

æ­£å¦‚æ‰¿è¯ºçš„é‚£æ ·ï¼Œæˆ‘ä¸ä¼šç”¨ç†ŠçŒ«ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»åŠªåŠ›ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥åŠ è½½æ•°æ®é›†ã€‚

```
HEADERS
['No', 'X1 transaction date', 'X2 house age', 'X3 distance to the nearest MRT station', 'X4 number of convenience stores', 'X5 latitude', 'X6 longitude', 'Y house price of unit area']
```

```
Dataset Size
414 X 8
```

è®©æˆ‘ä»¬ä»è¿™ä¸ªæ•°æ®é›†ä¸­é€‰æ‹©æˆ‘ä»¬çš„ç‰¹å¾å’Œç›®æ ‡å˜é‡ã€‚

```
Size of X
(414, 5)
Size of Y
(414,)
```

è®¾ç½®å¥½æˆ‘ä»¬çš„æ•°æ®åï¼Œè®©æˆ‘ä»¬å¯¹ç®—æ³•å¦‚ä½•å·¥ä½œä»¥åŠæˆ‘ä»¬åˆ°åº•è¦ç¼–ç ä»€ä¹ˆæœ‰ä¸€ä¸ªå¤§è‡´çš„äº†è§£ï¼Œè€Œä¸ç”¨æ·±å…¥æ‰€æœ‰æ•°å­¦èƒŒåçš„è¯æ˜ç»†èŠ‚ã€‚ä¸ºäº†æ›´å®¹æ˜“ç†è§£ï¼Œæˆ‘å°†å°½åŠ›æŠŠç®—æ³•ä¸æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨çš„æˆ¿åœ°äº§æ•°æ®é›†è”ç³»èµ·æ¥ã€‚

## **å…¥é—¨**

åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæˆ‘ä»¬æœ‰ N ä¸ªæ•°æ®æ ·æœ¬ï¼Œå¹¶ä¸”æˆ‘ä»¬å·²ç»æŠŠå®ƒåˆ†æˆæˆ‘ä»¬çš„ç‰¹å¾çŸ©é˜µå’Œç›®æ ‡çŸ©é˜µã€‚é™¤äº†ç¬¬ä¸€åˆ—(â€œå¦â€)å’Œç›®æ ‡åˆ—(â€œå•ä½é¢ç§¯çš„ Y æˆ¿ä»·â€)ä¹‹å¤–ï¼Œæˆ‘ä»¬çš„æ•°æ®é›†ä¸­æ€»å…±æœ‰å…­ä¸ªç‰¹å¾(â€œX1 äº¤æ˜“æ—¥æœŸâ€ã€â€œX2 æˆ¿å±‹å¹´é¾„â€ã€â€œX3 åˆ°æœ€è¿‘çš„ MRT ç«™çš„è·ç¦»â€ã€â€œX4 ä¾¿åˆ©åº—æ•°é‡â€ã€â€œX5 çº¬åº¦â€ã€â€œX6 ç»åº¦â€)ã€‚æˆ‘ä»¬å¿…é¡»æ‰¾åˆ°ä¸€ç§å…³ç³»æ¥ç”Ÿæˆç›®æ ‡ Yï¼Œå¹¶å°†å…¶å…¬å¼åŒ–ä¸ºä¸€ä¸ªæ–¹ç¨‹ï¼Œè¯¥æ–¹ç¨‹æ˜¯ä¸åŒç‰¹å¾çš„å‡½æ•°ã€‚ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘è¿˜æ’é™¤äº†ç¬¬ä¸€ä¸ªç‰¹æ€§(â€œX1 äº¤æ˜“æ—¥æœŸâ€)ï¼Œå› ä¸ºæ•°æ®åœ¨æ•°æ®é›†ä¸­çš„æ ¼å¼ä¸æ­£ç¡®ã€‚è¿™é‡Œæˆ‘ä»¬æœ‰ N = 414 ä¸ªæ ·æœ¬ï¼Œå½“æˆ‘ä»¬å°†æ•°æ®åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†æ—¶ï¼Œè¿™äº›æ ·æœ¬ä¹Ÿä¼šå‡å°‘ã€‚å› æ­¤ï¼Œæ­¤æ—¶ N = 414ï¼Œç‰¹å¾æ•°é‡(å‡è®¾ p)= 5

å¯¹äºå•ä¸ªç‰¹å¾ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹å½¢å¼çš„çº¿æ€§æ–¹ç¨‹

y = ğ›½0+ğ›½xï¼Œ

å…¶åœ¨æ‰©å±•åˆ°å•ä¸ªæ ·æœ¬çš„å¤šä¸ªç‰¹å¾æ—¶é‡‡å–ä»¥ä¸‹å½¢å¼

ğ‘¦=ğ›½0+ğ›½1ğ‘¥1+ğ›½2ğ‘¥2+â€¦ğ›½ğ‘ğ‘¥ğ‘

å¯¹äº N ä¸ªæ ·æœ¬ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶æ¦‚æ‹¬ä¸º

ğ‘¦1=ğ›½0+ğ›½1ğ‘¥11+ğ›½2ğ‘¥12+â€¦ğ›½ğ‘ğ‘¥1ğ‘

ğ‘¦2=ğ›½0+ğ›½1ğ‘¥21+ğ›½2ğ‘¥22+â€¦ğ›½ğ‘ğ‘¥2ğ‘

â‹®

ğ‘¦ğ‘–=ğ›½0+ğ›½1ğ‘¥ğ‘–1+ğ›½2ğ‘¥ğ‘–2+â€¦ğ›½ğ‘ğ‘¥ğ‘–ğ‘

â‹®

ğ‘¦ğ‘=ğ›½0+ğ›½1ğ‘¥ğ‘1+ğ›½2ğ‘¥ğ‘2+â€¦ğ›½ğ‘ğ‘¥ğ‘ğ‘

å¦‚æœæˆ‘ä»¬ä»¥çŸ©é˜µçš„å½¢å¼è¡¨ç¤ºä¸Šè¿°æ–¹ç¨‹ï¼Œæˆ‘ä»¬åˆ†åˆ«æœ‰(N *X* p)ï¼Œ(1 *X* (p+1))å’Œ(N *X* 1)é˜¶çš„ xã€ğ›½å’Œ y çŸ©é˜µã€‚

ç”¨çŸ©é˜µå½¢å¼è¡¨ç¤ºè¿™ä¸ªæ–¹ç¨‹ç»„ï¼Œæˆ‘ä»¬æœ‰

Y = X * transpose(ğ›½)

ä½†æ˜¯è¦è¿›è¡Œè¿™ä¸ªçŸ©é˜µä¹˜æ³•ï¼Œæˆ‘ä»¬å¾—è®© X ä¸º(N *X* (p+1))ã€‚æˆ‘ä»¬ä»ä¸Šé¢çš„ç­‰å¼ä¸­è§‚å¯Ÿåˆ°ï¼Œåœ¨æ¯ä¸ªç­‰å¼ä¸­, *x* 0 é¡¹éƒ½æ˜¯ 1ã€‚æˆ‘ä»¬ç°åœ¨æ­£åœ¨å¤„ç†çš„æ•°æ®é›†åˆ°ç›®å‰ä¸ºæ­¢æœ‰ N = 414 å’Œ p = 5ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬çš„ X ä¸º(414 *X* 5)çš„é˜¶ã€‚ä½†æ˜¯å¯¹äºçŸ©é˜µä¹˜æ³•ï¼Œæˆ‘ä»¬å¿…é¡»é€šè¿‡é¦–å…ˆæ·»åŠ ä¸€åˆ— 1(bias(*X*0)é¡¹)æ¥ä½¿å…¶ä¸º(414 *X* 6)é˜¶ã€‚åŒæ ·ï¼Œæˆ‘ä»¬çš„ Y åº”è¯¥æ˜¯ä¸€ä¸ªåˆ—å‘é‡(414 *X* 1 ),å®ƒç°åœ¨æ˜¯è¡Œå‘é‡çš„å½¢å¼ã€‚

```
Size of X
(414, 6)
Size of Y
(414, 1)
```

è®©æˆ‘ä»¬ä¹Ÿçœ‹çœ‹æˆ‘ä»¬çš„ X å’Œ Y çŸ©é˜µï¼Œæ£€æŸ¥æ˜¯å¦ä¸€åˆ‡æ­£å¸¸ã€‚

```
X headarray([[  1\. , 32\. , 84.87882, 10\. ,  24.98298, 121.54024],
       [  1\. , 19.5, 306.5947, 9\.  ,  24.98034, 121.53951],
       [  1\. , 13.3, 561.9845, 5\.  ,  24.98746, 121.54391],
       [  1\. , 13.3, 561.9845, 5\.  ,  24.98746, 121.54391],
       [  1\. , 5\.  , 390.5684, 5\.  ,  24.97937, 121.54245]])Y headarray([[37.9],
       [42.2],
       [47.3],
       [54.8],
       [43.1]])
```

åˆ°ç›®å‰ä¸ºæ­¢ä¸€åˆ‡é¡ºåˆ©ï¼

## éšæœºåˆ†å‰²æ•°æ®é›†

ç°åœ¨ï¼Œæˆ‘ä»¬éµå¾ªä¼ ç»Ÿçš„æ–¹æ³•ï¼Œå°†æ•°æ®é›†åˆ†ä¸ºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ï¼Œè®­ç»ƒé›†å æ•°æ®é›†çš„ 70%ã€‚

ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹çœ‹æˆ‘ä»¬çš„è®­ç»ƒå’Œæµ‹è¯•é›†çš„å½¢çŠ¶ã€‚

```
TRAINING SET
X_train.shape:  (290, 6)
Y_train.shape:  (290, 1)

TESTING SET
X_test.shape:  (124, 6)
Y_test.shape:  (124, 1)
```

æˆ‘ä»¬å°†ä»…å°†è¯¥ç®—æ³•åº”ç”¨äºæˆ‘ä»¬çš„è®­ç»ƒé›†ï¼Œå¹¶ä½¿ç”¨æµ‹è¯•é›†æ¥æ£€æŸ¥è¯¥ç®—æ³•çš„æ€§èƒ½ã€‚å› æ­¤ï¼Œæˆ‘ä»¬çš„ N ä» 414 å‡å°‘åˆ°ç°åœ¨çš„ 290(70%)ã€‚

ä»æˆ‘ä»¬çš„çŸ©é˜µæ–¹ç¨‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»å‡†å¤‡å¥½äº† x çŸ©é˜µå’Œ y çŸ©é˜µï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æ‰¾åˆ°ğ›½çŸ©é˜µ(æˆ–è€…æ›´å‡†ç¡®åœ°è¯´æ˜¯ç‰¹å¾ç³»æ•°ï¼Œä½†æ˜¯ä»ç°åœ¨å¼€å§‹è®©æˆ‘ä»¬æŠŠğ›½è½¬ç½®çŸ©é˜µç§°ä¸ºğ›½)ï¼Œä½¿å¾—ä»çŸ©é˜µä¹˜æ³•ä¸­è·å¾—çš„ y(y =xğ›½)æœ€æ¥è¿‘æˆ‘ä»¬å®é™…çš„ y çŸ©é˜µã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¿…é¡»æ‰¾åˆ°è´å¡”(ğ›½)çŸ©é˜µï¼Œä½¿è¯¯å·®æœ€å°ã€‚

ä¸ºæ­¤ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§æ–¹æ³•:

1.  æ¢¯åº¦ä¸‹é™æ³•
2.  æ­£è§„æ–¹ç¨‹æ³•

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†éµå¾ªæ­£å¸¸æ–¹ç¨‹çš„æ–¹æ³•ã€‚æ­£è§„æ–¹ç¨‹æ˜¯ä¸€ç§æ— éœ€è¿­ä»£å°±èƒ½æ‰¾åˆ°æœ€ä½³ beta(ğ›½çš„æ–¹æ³•ã€‚

![](img/c4bd900cf5c9b634908bca7d36e60a79.png)

è¿™ä¸ªå¯¹æ¯”æ‘˜è‡ªå´æ©è¾¾åœ¨ Coursera ä¸Šçš„æœºå™¨å­¦ä¹ è¯¾ç¨‹

åœ¨æ­£è§„æ–¹ç¨‹æ³•ä¸­ï¼Œæœ€ä½³Î²å€¼ç”±ä¸‹å¼ç»™å‡º:

![](img/3b25f9bd096357ade191147b959d8a8c.png)

æ­£è§„æ–¹ç¨‹çš„æ•°å­¦è¯æ˜éœ€è¦çº¿æ€§ä»£æ•°çŸ¥è¯†ï¼Œä½†æ„Ÿå…´è¶£çš„äººå¯ä»¥å°†[ç§»åˆ°è¿™é‡Œ](https://eli.thegreenplace.net/2014/derivation-of-the-normal-equation-for-linear-regression)ã€‚

## Î²å€¼å’Œé¢„æµ‹

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ªå‡½æ•°æ¥æŸ¥æ‰¾ğ›½çš„å€¼ï¼Œå¹¶å¼€å§‹ä½¿ç”¨è®¡ç®—å‡ºçš„ğ›½.è¿›è¡Œé¢„æµ‹

```
(124, 1)
```

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬çš„ä»£ç å·²ç»é¢„æµ‹äº†æ‰€æœ‰æµ‹è¯•æ ·æœ¬çš„ Y å€¼ã€‚æ˜¯æ—¶å€™æ£€éªŒæˆ‘ä»¬æ¨¡å‹çš„å‡†ç¡®æ€§äº†ã€‚

## æ£€æŸ¥å‡†ç¡®æ€§

```
Mean Absolute Error:  5.484897442452742
Root Mean Square Error:  7.038888303432659
R square:  0.6927055239131656
```

å› æ­¤ï¼Œè¿™ä¸ªæ¨¡å‹çœ‹èµ·æ¥è¿˜ä¸é”™ï¼Œä½†ä»æœ‰æ”¹è¿›çš„ä½™åœ°ã€‚è‡³äºæˆ‘ï¼Œå°±äº¤ç»™ä½ äº†ï¼:-)

å‚è€ƒæ–‡çŒ®å’Œè‡´è°¢:

1.  æ•°æ®é›†:[https://www . ka ggle . com/quant Bruce/real-estate-price-prediction](https://www.kaggle.com/quantbruce/real-estate-price-prediction)
2.  æ·±å…¥æ•°å­¦æ­£è§„æ–¹ç¨‹è¯æ˜:[https://Eli . the green place . net/2014/çº¿æ€§å›å½’çš„æ­£è§„æ–¹ç¨‹æ¨å¯¼](https://eli.thegreenplace.net/2014/derivation-of-the-normal-equation-for-linear-regression)
3.  å›¾ç‰‡æ¥è‡ª:ã€https://morioh.com/p/0d9b2bedf683 
4.  æ„Ÿè°¢æˆ‘çš„æœ‹å‹ Ashish sureka(LinkedIn:[https://www.linkedin.com/in/ashish-sureka/](https://www.linkedin.com/in/ashish-sureka/))åœ¨æ¦‚å¿µå’Œä»£ç æ–¹é¢å¸®åŠ©äº†æˆ‘ã€‚

> æœ‰ç–‘é—®å—ï¼Ÿåœ¨ LinkedIn ä¸Šæ‰¾åˆ°æˆ‘:[https://www.linkedin.com/in/dddash11/](https://www.linkedin.com/in/dddash11/)

åœ¨æ­¤è·å–å®Œæ•´ä»£ç :[https://github . com/dddash 11/ML/blob/main/notebooks/ML % 20 algorithm % 20 implementations/Linear % 20 regression/multiple _ Lin _ reg _ implementation . ipynb](https://github.com/dddash11/ML/blob/main/notebooks/ML%20Algorithm%20implementations/Linear%20Regression/multiple_lin_reg_implementation.ipynb)