<html>
<head>
<title>Dimensionality Reduction in Machine Learning (Feature Selection)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中的降维(特征选择)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/dimensionality-reduction-in-machine-learning-feature-selection-69341419872a?source=collection_archive---------4-----------------------#2022-02-25">https://medium.com/analytics-vidhya/dimensionality-reduction-in-machine-learning-feature-selection-69341419872a?source=collection_archive---------4-----------------------#2022-02-25</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="121e" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">我们如何减少数据集中的维度或特征来创建最佳的机器学习模型</h2></div><p id="7b1b" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">当我们处理大量自变量(特征)以预测因变量时，降维是很重要的，回归和分类模型都是如此</p><p id="78bd" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">问:为什么我们需要降维？</p><p id="9169" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">答:考虑一个场景，我们试图用房子的面积(平方英尺)来预测房子的价格。我们可以尝试在变量上建立一个模型，并使用matplotlib之类的库将其可视化，并了解模型是否是线性的。(参考图1.1)</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es js"><img src="../Images/ce765f2014af01abe1e688ff10204151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X8_rOsB0CRrVQ6xFLVrmrQ.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">1.1线性回归高级模型</figcaption></figure><p id="f9e1" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">可视化是平滑的，因为我们只有一个变量，如果我们有两个变量面积(平方英尺)和位置。然后，为了可视化模型图，我们将不得不使用三维图形或三维图形。特征计数越长，模型拟合就越难可视化。因此，有必要确定对建立模型很重要的特征。</p><p id="dc24" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">另一个因素是有时并非所有的变量对建立模型都很重要。例如，如果数据集中有要素房屋id以及其他要素，则房屋id可能不会在训练模型中发挥重要作用。可能还有其他不重要的特征，如房屋id。我们可以使用降维技术来识别这些变量。</p><p id="aae1" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">有两种降维技术:</p><ol class=""><li id="4b99" class="ki kj hh iy b iz ja jc jd jf kk jj kl jn km jr kn ko kp kq bi translated">特征选择</li><li id="c827" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">特征抽出</li></ol><p id="6dff" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在这篇文章中，我们将讨论关于特征选择。</p><p id="732f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">特征选择:特征选择是一种从数据集中选择所需或最佳数量的特征以建立最佳机器学习模型的方法。</p><p id="aa76" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">特征选择的常用方法:</p><ol class=""><li id="1719" class="ki kj hh iy b iz ja jc jd jf kk jj kl jn km jr kn ko kp kq bi translated">缺失值比率分析</li><li id="fc3b" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">低方差滤波器</li><li id="f771" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">高相关滤波器</li><li id="ecba" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">反向特征消除</li><li id="2d65" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">正向特征消除</li></ol><p id="99a2" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，让我们来看看每种方法:</p><h2 id="a20a" class="kw kx hh bd ky kz la lb lc ld le lf lg jf lh li lj jj lk ll lm jn ln lo lp lq bi translated">缺失值比率分析:</h2><p id="e6ea" class="pw-post-body-paragraph iw ix hh iy b iz lr ii jb jc ls il je jf lt jh ji jj lu jl jm jn lv jp jq jr ha bi translated">当数据集的要素缺少值时，此方法非常有用。以下是执行缺失值比率分析的步骤</p><ol class=""><li id="1401" class="ki kj hh iy b iz ja jc jd jf kk jj kl jn km jr kn ko kp kq bi translated">使用熊猫图书馆读取数据</li><li id="0552" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">检查数据是否被读取，检查前5行数据以识别特征(从属和独立)</li></ol><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lw"><img src="../Images/77109878c71d0911f5eb7cb9d173868d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KI6ANHQG7kNLlbdfa7IgrQ.png"/></div></div></figure><p id="fa29" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">3.检查数据集中的缺失值，并计算缺失值的比率</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lx"><img src="../Images/fc6488b2a11faff53415ba0151c7e36a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zw0dBwZzTXjw1bTDPHUqMg.png"/></div></div></figure><p id="f55c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">4.基于缺失值，设置阈值百分比，以便我们可以丢弃缺失值大于阈值的要素，确保缺失值包含合理的阈值，从而不会丢弃大量要素</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ly"><img src="../Images/31ec2b68decf6bc0359a1a18c82275ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rfmHTwAzIx_LfH4ce7C9Wg.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">在本例中，我们设置了40%的阈值</figcaption></figure><p id="3fa3" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">5.从数据帧中删除超过设置阈值的列，并验证这些列是否被删除。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es lz"><img src="../Images/f622582b0d46063a234e4c57cc9cc7f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CzD-P1rHP_qVE2fEspnzwA.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">如我们所见，holiday和windspeed特性被删除，因为它们缺少大于阈值的值</figcaption></figure><h1 id="30ce" class="ma kx hh bd ky mb mc md lc me mf mg lg in mh io lj iq mi ir lm it mj iu lp mk bi translated">低方差滤波器:</h1><p id="79ad" class="pw-post-body-paragraph iw ix hh iy b iz lr ii jb jc ls il je jf lt jh ji jj lu jl jm jn lv jp jq jr ha bi translated">假设没有空值且所有插补完成，我们可以执行另一个低方差过滤器，在该过滤器中，我们检查每个特征的方差，并根据我们观察到的阈值设置方差阈值，我们将只考虑方差大于阈值的特征。</p><p id="8880" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">例如，让我们说，我们正试图建立一个模型，试图预测鱼的价格在市场上，鱼将有不同的特点，影响其价格，如鱼的家庭，新鲜度，重量等。假设在我们的数据中，所有的鱼都是一样长的。特征鱼长度可能对模型的训练或预测没有帮助。</p><p id="99cb" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iy hi">注意:在执行低方差过滤器之前，所有特征都将被归一化，并且该过滤器只能应用于数字列</strong></p><p id="158e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">以下是执行低方差滤波的步骤:</p><ol class=""><li id="3b40" class="ki kj hh iy b iz ja jc jd jf kk jj kl jn km jr kn ko kp kq bi translated">使用pandas库阅读csv并显示前几行</li><li id="4295" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">检查是否有空值，并检查列的数据类型</li></ol><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ml"><img src="../Images/e211078a58f0ae68d8058a7321ca0d22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A03OHWZeKFKyYzGnK1xoFw.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">导入数据，检查列的数据类型，这里我们删除了“ID ”,因为它总是唯一的，但它不会为模型构建增加价值</figcaption></figure><p id="11e6" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">3.使用sklearn.preprocessing中的Normalize模块规范化数据</p><p id="bae4" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">4.使用计算方差。var()函数</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es mm"><img src="../Images/8134ebaf032c0b88b58ca5b7bea21079.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*7vzeqWnUcZ8GQmh8loo_VA.png"/></div></figure><p id="39c1" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">5.观察差异并设置差异阈值</p><p id="fcdf" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">6.选择方差大于阈值的要素</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es mn"><img src="../Images/41dea72123de776c10f8ca149aedb07e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CvELacQ1Fq0nNx0JyatdFQ.png"/></div></div></figure><h1 id="196b" class="ma kx hh bd ky mb mc md lc me mf mg lg in mh io lj iq mi ir lm it mj iu lp mk bi translated">高相关滤波器</h1><p id="ac70" class="pw-post-body-paragraph iw ix hh iy b iz lr ii jb jc ls il je jf lt jh ji jj lu jl jm jn lv jp jq jr ha bi translated">此过滤器可用于移除数据集中的多重共线性，当两个或多个独立变量高度相关时，就会出现多重共线性。</p><p id="cfbd" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">例如，让我们假设一个场景，我们试图建立一个模型，通过使用锻炼时间、消耗的卡路里、身高等来猜测一个人的体重。在这种情况下，锻炼时间和消耗的卡路里是可能彼此密切相关的变量，因为锻炼时间越长意味着消耗的卡路里越多，这可能导致数据集中的多重共线性。</p><p id="d8a7" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">以下是执行高相关性滤波的步骤:</p><ol class=""><li id="b8cd" class="ki kj hh iy b iz ja jc jd jf kk jj kl jn km jr kn ko kp kq bi translated">使用pandas库阅读csv并显示前几行</li><li id="ed34" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">检查是否有空值，并检查列的数据类型</li></ol><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es mo"><img src="../Images/4e547f68c8612f169df17df1af4681b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gFyae_qJsG_KvkL6EFxnZw.png"/></div></div></figure><p id="a56e" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">3.从stats models . stats . outliers _ impact模块导入variance_inflation_factor</p><p id="4c2d" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">VIF用于检查多重共线性，更多详细信息请查看此链接:<a class="ae mp" href="https://www.analyticsvidhya.com/blog/2020/03/what-is-multicollinearity/" rel="noopener ugc nofollow" target="_blank">https://www . analyticsvidhya . com/blog/2020/03/what-is-multiple共线性/ </a></p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es mq"><img src="../Images/d7cc7af48369e2d47fe30484f5fe8530.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T2C0pAm7dJowDpLHm2rA7A.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">这里我们创建了一个函数，它将计算VIF并返回一个数据帧</figcaption></figure><p id="7d6f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">4.删除对构建模型没有意义的因变量和列，如ID</p><p id="8110" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">5.计算VIF并观察VIF数据，检查变量之间的共线性</p><p id="549f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">6.如果我们发现变量之间有共线性，我们将删除其中一个变量</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div class="er es mr"><img src="../Images/7c2f1c84fd84b92c4913c0136719aa8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*0_gGtl9WP2HDxHfYNLe6KA.png"/></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">在此图中，我们看到temp和atemp之间的高度共线性，因此我们在更新的数据帧中删除了atemp</figcaption></figure><h1 id="5a2a" class="ma kx hh bd ky mb mc md lc me mf mg lg in mh io lj iq mi ir lm it mj iu lp mk bi translated">反向特征消除</h1><p id="78cf" class="pw-post-body-paragraph iw ix hh iy b iz lr ii jb jc ls il je jf lt jh ji jj lu jl jm jn lv jp jq jr ha bi translated">让我们假设我们的数据不包含缺失值，没有特征具有低方差，并且独立变量之间没有多重共线性。在这种情况下，后向特征消除是另一种方法，使用这种方法，我们可以尝试找到在建立模型时重要性最低的特征。</p><p id="a2a1" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">反向特征消除的工作方式如下:</p><p id="a23c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们说，我们试图用作业1、作业2和作业3来预测一个学生的最终分数。</p><ol class=""><li id="0971" class="ki kj hh iy b iz ja jc jd jf kk jj kl jn km jr kn ko kp kq bi translated">首先，使用所有特征(分配)构建模型，并评估模型性能</li><li id="e792" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">接下来，移除分配1，并基于分配2和分配3构建模型，评估模型性能</li><li id="2888" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">接下来，移除分配2，并基于分配1和分配3构建模型，评估模型性能</li><li id="e23d" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">接下来，移除分配3，并基于分配1和分配2构建模型，评估模型性能</li><li id="34f8" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">完成所有功能组合后，我们将检查与包含所有功能的初始模型相比，性能变化最小的模型的性能。</li><li id="de14" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">我们将识别模型中移除的特征，并且不会在我们的模型构建中使用该特征</li></ol><p id="f91b" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">以下是执行反向特征消除的步骤:</p><ol class=""><li id="2e0a" class="ki kj hh iy b iz ja jc jd jf kk jj kl jn km jr kn ko kp kq bi translated">使用pandas库阅读csv并显示前几行</li><li id="f5d4" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">检查是否有空值，并检查列的数据类型</li></ol><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ms"><img src="../Images/f92eb8281ec4d39fb488565347a6b267.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kst7HKGQyKoh4L3s1MrMIg.png"/></div></div></figure><p id="840b" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">3.选择用于构建模型的X和y变量，数据框X通常包含独立变量，y包含因变量(从独立变量中删除ID等列，因为它们对构建模型没有帮助)</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es mt"><img src="../Images/f95957ce366aa8e78a1a3177950cf37e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zLVLCp2W53jyXK_fycIE3A.png"/></div></div></figure><p id="2045" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">4.从mlxtend.feature_selection模块导入SequentialFeatureSelector</p><p id="6b2b" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">5.导入构建模型所需的库，在本例中，我们使用sklearn.linear_model中的LinearRegression，因为我们正在尝试构建一个回归模型</p><p id="f94b" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">6.为LinearRegression和SequentialFeatureSelector创建一个对象，SequentialFeatureSelector将以下参数作为输入:</p><p id="6b50" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">模型:在这种情况下，它是线性回归</p><p id="d867" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">k_features:我们希望在最终的模型构建中拥有的特性数量</p><p id="645d" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">向前:错误(因为我们正在执行向后特征消除)</p><p id="90b9" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">verbose: 1(显示执行消息)</p><p id="b17f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">评分:模型的评估指标(在这种情况下，我们使用“负均方误差”)</p><p id="65b3" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">7.对SequentialFeatureSelector对象执行调整。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es mu"><img src="../Images/84d9313ddbf1f30c302e2c88c69becc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*72mpuGIcOOrenF_TiQZxSQ.png"/></div></div></figure><p id="1828" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">8.使用sfs_initial对象的k_feature_names_ variable属性标识选定的特征</p><p id="0ebd" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">9.将SequentialFeatureSelector选择的特征用于最终模型构建</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es mv"><img src="../Images/6206928dfee9de69eae53cd1cb4ac716.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sJlpuLKR_TvtP3j8yGA5Hw.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">正如我们所看到的，我们已经成功地确定了4个最重要的特征，我们可以使用它们来构建模型，而不会损失模型的性能</figcaption></figure><h1 id="76f6" class="ma kx hh bd ky mb mc md lc me mf mg lg in mh io lj iq mi ir lm it mj iu lp mk bi translated">正向特征消除</h1><p id="8ead" class="pw-post-body-paragraph iw ix hh iy b iz lr ii jb jc ls il je jf lt jh ji jj lu jl jm jn lv jp jq jr ha bi translated">前向特征消除与我们使用后向特征消除的情况相同。</p><p id="08d8" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">正向特征消除的工作方式如下:</p><p id="cd8a" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">让我们说，我们试图用作业1、作业2和作业3来预测一个学生的最终分数。</p><ol class=""><li id="c568" class="ki kj hh iy b iz ja jc jd jf kk jj kl jn km jr kn ko kp kq bi translated">首先，我们将只考虑分配1并建立一个模型</li><li id="e564" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">接下来，我们将只考虑分配2并建立一个模型</li><li id="298c" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">接下来，我们将只考虑分配3并建立一个模型</li><li id="039b" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">我们将评估3个模型的模型性能，并采用具有最高模型性能的变量(例如，假设分配3为我们提供了最佳模型性能)</li><li id="6d2b" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">接下来，我们将剩余的变量与挑选的变量(例如，分配3+分配1，分配3+分配2)一起逐个包含，并执行模型评估</li><li id="c199" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">我们继续这个过程，直到我们看到模型性能没有改善，并采用具有最佳模型性能的特征</li></ol><p id="8d75" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">以下是执行反向特征消除的步骤:</p><ol class=""><li id="7e17" class="ki kj hh iy b iz ja jc jd jf kk jj kl jn km jr kn ko kp kq bi translated">使用pandas库阅读csv并显示前几行</li><li id="b4d0" class="ki kj hh iy b iz kr jc ks jf kt jj ku jn kv jr kn ko kp kq bi translated">检查是否有空值，并检查列的数据类型</li></ol><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es ms"><img src="../Images/f92eb8281ec4d39fb488565347a6b267.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kst7HKGQyKoh4L3s1MrMIg.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">向前d</figcaption></figure><p id="b85c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">3.选择用于构建模型的X和y变量，数据框X通常包含独立变量，y包含因变量(从独立变量中删除ID等列，因为它们对构建模型没有帮助)</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es mt"><img src="../Images/f95957ce366aa8e78a1a3177950cf37e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zLVLCp2W53jyXK_fycIE3A.png"/></div></div></figure><p id="9ec2" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">4.从mlxtend.feature_selection模块导入SequentialFeatureSelector</p><p id="870c" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">5.导入构建模型所需的库，在本例中，我们使用sklearn.linear_model中的LinearRegression，因为我们正在尝试构建一个回归模型</p><p id="eb12" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">6.为LinearRegression和SequentialFeatureSelector创建一个对象，SequentialFeatureSelector将以下参数作为输入:</p><p id="6084" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">模型:在这种情况下，它是线性回归</p><p id="e742" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">k_features:我们希望在最终的模型构建中拥有的特性数量</p><p id="d467" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">forward: True(因为我们正在执行正向特征消除)</p><p id="5eed" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">verbose: 1(显示执行消息)</p><p id="ecfc" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">评分:模型的评估指标(在这种情况下，我们使用“负均方误差”)</p><p id="a46d" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">7.对SequentialFeatureSelector对象执行调整。</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es mw"><img src="../Images/6c88751077c7537e5ae630fa711d880b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*58G2XLSNoPoKh48qKmr43A.png"/></div></div></figure><p id="4d8f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">8.使用sfs_initial对象的k_feature_names_ variable属性标识选定的特征</p><p id="983f" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">9.将SequentialFeatureSelector选择的特征用于最终模型构建</p><figure class="jt ju jv jw fd jx er es paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="er es mx"><img src="../Images/33e7ce54ba0d62326a294871286c05b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J8HooqYQRAoBauKGAz2m_A.png"/></div></div><figcaption class="ke kf et er es kg kh bd b be z dx translated">正如我们所看到的，我们已经成功地确定了4个最重要的特征，我们可以使用它们来构建模型，而不会损失模型的性能</figcaption></figure><p id="6b73" class="pw-post-body-paragraph iw ix hh iy b iz ja ii jb jc jd il je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这些是我们在构建机器学习模型时可以尝试识别最相关的特征的方法。这些方法可以帮助我们建立最佳模型。</p></div></div>    
</body>
</html>