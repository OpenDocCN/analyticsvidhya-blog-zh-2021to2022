<html>
<head>
<title>Interacting with Models via. flask API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过与模型互动。烧瓶API</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/interacting-with-models-via-flask-api-3fe9b681868a?source=collection_archive---------6-----------------------#2021-05-02">https://medium.com/analytics-vidhya/interacting-with-models-via-flask-api-3fe9b681868a?source=collection_archive---------6-----------------------#2021-05-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="9caf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">本博客将向您介绍构建ML模型后的过程，如何通过API与它们交互，如何在您的本地机器上托管它们并通过API访问它们。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/155a49c39867818b9abad59535e935e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YgOSfOm1PyiGuw2CUMqvXw.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">来源:谷歌图片</figcaption></figure><p id="5ef9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">假设您有一个经过训练的模型，并且您有一个指标显示您的模型的性能足够好，可以在现实世界中使用。</p><p id="325e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">那么现在，一个人如何为现实世界托管他们的应用程序，以便可以与之互动呢？</p><p id="9dd7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这篇博客不是向你展示如何生产化，因为这涉及到很多步骤，但是创建API肯定是其中之一。</p><p id="3b9b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您已经构建了一个API，那么您可以使用Web APIs从另一个应用程序中调用能够与您的模型交互的方法</p><p id="64d6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在继续学习本教程之前，需要满足某些先决条件:</p><ul class=""><li id="9f9e" class="jt ju hh ig b ih ii il im ip jv it jw ix jx jb jy jz ka kb bi translated">您的模型已经准备好并经过测试。</li></ul><p id="72bf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在就这些了，剩下的我将展示如何创建预测函数，并把它们转换成可以通过。API。</p><p id="d611" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了便于说明，我将使用一个类似iris_classification模型的简单模型来解释API的使用以及如何与模型进行交互。</p><p id="370e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我将把这篇博客分成几个步骤，你可以按照这些步骤来创建你自己的API和做更多的事情。</p><p id="5bf4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了方便起见，我不会生产模型，而是我们将利用一个免费的工具与API进行交互，名为Postman。但在此之前，我们仍然需要创建我们的预测函数和Flask应用程序，并将其托管在我们的本地系统中，以便通过访问它。邮递员。</p><p id="d97a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第一步:</p><p id="13f8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将您的模型保存到pickle文件中，以便在需要时可以加载它。</p><p id="eebe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第二步:</p><p id="b8f1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从flask获取库导入。</p><blockquote class="kc kd ke"><p id="8308" class="ie if jc ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">从烧瓶导入烧瓶，请求，jsonify</p></blockquote><p id="8b34" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Flask:它帮助我们创建flask应用程序</p><p id="88f8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请求:它帮助我们从客户端获取数据</p><p id="3a21" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">jsonify:它帮助我们将响应转换成JSON</p><p id="73d6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第三步:</p><blockquote class="kc kd ke"><p id="ac89" class="ie if jc ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">app = Flask("您的应用名称")</p></blockquote><p id="5335" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这一行帮助我们创建一个具有指定名称的flask应用程序。</p><p id="84c4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第四步:</p><p id="8552" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，当我们的URL被点击时，我们需要调用我们的函数，这些函数将依次向我们发送数据。</p><p id="0131" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">API中有不同类型的路由方法，它们是“GET”、“POST”、“PUT”、“DELETE”等等</p><p id="b152" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了简单起见，我们将只看到GET和POST方法，因为我们想学习如何创建我们的第一个API，而不是马上成为一个完全的专业人员。</p><p id="5d21" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">获取:</p><blockquote class="kc kd ke"><p id="3ced" class="ie if jc ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">@app.route('/predict '，methods=['GET'])</p></blockquote><p id="8ce7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">帖子:</p><blockquote class="kc kd ke"><p id="4a2d" class="ie if jc ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">@app.route('/predict '，methods=['GET'])</p></blockquote><p id="6f68" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，我们将使用这两个路由选项将我们的用户路由到已定义的函数，现在要明白，这些注释将直接写在函数之上，使我们能够调用已定义的方法。</p><p id="7355" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">仅此而已！是的，你没听错，现在你只需要知道这些。</p><p id="825b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当我们向API提供数据时，让我们创建一些函数来帮助我们预测。</p><blockquote class="kc kd ke"><p id="9120" class="ie if jc ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">定义预测():</p><p id="142c" class="ie if jc ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">data = request.get_json()</p><p id="aaa6" class="ie if jc ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">data _ point = NP . array([data[" sepal _ length "]，</p><p id="b4c1" class="ie if jc ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">数据["萼片宽度"]，</p><p id="85d9" class="ie if jc ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">数据["花瓣长度"]，</p><p id="b08a" class="ie if jc ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">数据["花瓣宽度"]])。整形(1，-1)</p><p id="feb2" class="ie if jc ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">y _ pred = mod _ dt . predict(data _ point)</p><p id="d891" class="ie if jc ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">return JSON ify({ " response ":target[y _ pred[0]]})</p></blockquote><p id="5307" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我为你定义每一行，</p><p id="18a5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">data=request.get_json()</p><p id="9e61" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这一行指定了我们将在请求对象中发送给我们的API的数据，这是我们之前导入的。这有助于我们读取从客户端传来的数据。</p><p id="c36a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">data_point = np.array(…。)</p><p id="e07c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这一行将来自JSON对象的数据转换成一个数组，并将其重新整形为模型可以理解的格式。</p><p id="4203" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">y _ pred = mod _ dt . predict(data _ point)</p><p id="0adb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是预测发生的地方。</p><p id="60da" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">return JSON ify({ " response ":target[y _ pred[0]]})</p><p id="0adc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，我们使用为表示数据而创建的字典格式将预测转换为json对象。</p><p id="8aa8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是python文件的样子:-</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ki"><img src="../Images/226fcf3f1842b984b72e6b93b6925847.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qstTnylWxo6AhV42"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">app.py</figcaption></figure><p id="266e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是PostMan app，通过它我们可以和API进行交互。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kj"><img src="../Images/e490b3b676e03a04e6640d4102b12238.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Z_jaL6qyajPSaHJW"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">邮递员UI</figcaption></figure><p id="bf89" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">响应看起来是这样的:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es kk"><img src="../Images/3ebd133dddd1a02fd9bd07f9163ad720.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xI7O0zVR-6Dr7twb"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">反应</figcaption></figure><p id="8673" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在你知道了，你知道基本的东西了。</p><p id="facf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在此之后，你的想象力是极限。</p><p id="b0a3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">去探索吧。</p><p id="52ec" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你在这个博客上有任何问题，我一定会回复任何需要的帮助。</p><blockquote class="kc kd ke"><p id="f2f1" class="ie if jc ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated"><strong class="ig hi">感谢阅读！</strong></p><p id="651a" class="ie if jc ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">如果你想了解更多类似的话题或者看看我还能提供什么，一定要访问我的网站:<a class="ae kl" href="https://digital.allaboutstuffs.com/" rel="noopener ugc nofollow" target="_blank">所有关于东西</a></p><p id="7475" class="ie if jc ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">准备好让你的学习更上一层楼了吗？查看我提供的课程:<a class="ae kl" href="https://digital.allaboutstuffs.com/courses/" rel="noopener ugc nofollow" target="_blank">课程</a></p><p id="9fbc" class="ie if jc ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">生活工作压力大？花一点时间来放松和放松我的舒缓和放松的视频！现在就去我的频道，用"<a class="ae kl" href="https://www.youtube.com/c/TheSoulTranquilizer" rel="noopener ugc nofollow" target="_blank">灵魂镇定剂</a>"开始你的内心平和与宁静之旅</p></blockquote></div></div>    
</body>
</html>