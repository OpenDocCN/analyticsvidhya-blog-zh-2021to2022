<html>
<head>
<title>The First Chapter of Data Analysis — Part II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据分析第一章—第二部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/the-first-chapter-of-data-analysis-part-ii-dedb3406cb9d?source=collection_archive---------8-----------------------#2021-05-03">https://medium.com/analytics-vidhya/the-first-chapter-of-data-analysis-part-ii-dedb3406cb9d?source=collection_archive---------8-----------------------#2021-05-03</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="a775" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">探究数据在整体上是如何分布的。</p><p id="ab1e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在<a class="ae jc" rel="noopener" href="/analytics-vidhya/the-first-chapter-of-data-analysis-part-i-2aafe332cf6b">的第一部分</a>中，我们找到了探索性数据分析(EDA)的基础，重点是统计汇总。在这一部分中，我们将专门研究数据分布，并研究表示数据的不同方法。</p><p id="53d0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用统计摘要，我们可以深入了解数据的抽象形式，如位置和可变性。这在单变量分析中尤其重要，因为只有一个变量是感兴趣的。在双变量和多变量分析中，多个变量之间的分布和关系有助于了解幕后发生的事情。</p><h1 id="e88e" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak">数据分发</strong></h1><p id="f135" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">查看数据的方式多种多样。每种方法都有独特的抽象和粒度级别。在下文中，我们将研究呈现数据的不同显示方法。为了演示该原理的有效性，我们将使用来自python <em class="kg">的<em class="kg"> scikit-learn库</em>的虹膜数据集。</em>可以通过以下python代码加载数据:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="6d0c" class="kq je hh km b fi kr ks l kt ku">import pandas as pd<br/>from sklearn import datasets</span><span id="dd13" class="kq je hh km b fi kv ks l kt ku">iris = datasets.load_iris()</span><span id="e370" class="kq je hh km b fi kv ks l kt ku">#data frame to accommodate the data<br/>df = pd.DataFrame(data=iris.data, columns=['sepal length (cm)', 'sepal width (cm)', 'petal length (cm)', 'petal width (cm)'])</span></pre><h2 id="f789" class="kq je hh bd jf kw kx ky jj kz la lb jn ip lc ld jr it le lf jv ix lg lh jz li bi translated">箱线图</h2><p id="84b1" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">这个图最早是由约翰·w·塔基(1915-2000)提出的，目的是快速了解样本的分布。它基于四分位数(25%、50%、75%百分位数)。在数据集中，第<em class="kg"> P- </em>百分位数是一个值，使得至少有<em class="kg"> P </em>个百分比的值等于或小于该值，至少有(100 — <em class="kg"> P </em>)个百分比的值等于或大于该值。</p><figure class="kh ki kj kk fd lk er es paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="er es lj"><img src="../Images/9f65ecec86d6764d88d9fbf48049fb2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XAMbR8tc95t8V9VMT6P1-A.png"/></div></div><figcaption class="lr ls et er es lt lu bd b be z dx translated"><a class="ae jc" href="https://www.leansigmacorporation.com/box-plot-with-minitab/" rel="noopener ugc nofollow" target="_blank">箱线图解剖学</a></figcaption></figure><p id="822f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上图显示了箱形图的结构。箱线图非常便于识别潜在的异常值。通过查看箱线图，您将快速了解样本的位置、可变性(<strong class="ig hi">(IQR)</strong>)和分布。例如，<strong class="ig hi"> 50%的数据驻留在盒子内部。</strong>作为一个例子，我们展示了针对萼片长度变量的虹膜数据集的箱线图。</p><figure class="kh ki kj kk fd lk er es paragraph-image"><div class="er es lv"><img src="../Images/b8d9a8b2fd8417d99b1c728645a86faa.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*uXls8sKVIDPdwassyGkcSA.png"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">萼片长度箱线图</figcaption></figure><p id="7a3c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上面方框图的python代码是</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="68d4" class="kq je hh km b fi kr ks l kt ku">ax = df.boxplot(column='sepal length (cm)')<br/>ax.set_ylabel('cm')</span></pre><p id="b89f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">注意，由于萼片长度的最大值是7.9厘米，上部须延伸到最大值，而不是1.5IQR+ 75%百分位数。</p><h2 id="927d" class="kq je hh bd jf kw kx ky jj kz la lb jn ip lc ld jr it le lf jv ix lg lh jz li bi translated">频率表和直方图</h2><p id="1506" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">频率表将变量分成大小相等的区间，并计算有多少样本落入给定的区间。所以，<strong class="ig hi">桶(区间)的大小决定了频率表绘图的整体性能。如果它们太大，分布的重要特征会变得模糊。如果它们太小，结果就太细了，就失去了看到更大画面的能力。</strong>这也适用于直方图显示。</p><h2 id="9e02" class="kq je hh bd jf kw kx ky jj kz la lb jn ip lc ld jr it le lf jv ix lg lh jz li bi translated">密度图</h2><p id="4ed0" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">密度图与直方图相关，并以连续线条显示图的分布。当间隔的宽度非常小时，可以认为是平滑的直方图。通常通过<em class="kg">核密度估计来计算。</em>萼片长度的直方图和密度估计如下图所示:</p><figure class="kh ki kj kk fd lk er es paragraph-image"><div class="er es lw"><img src="../Images/57c17a67286d7c5025af579d05100514.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*8b209IJWINBJJGQuwUeHkg.png"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">直方图和密度图</figcaption></figure><p id="fb83" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Pandas hist图可用于描绘直方图和密度图:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="7209" class="kq je hh km b fi kr ks l kt ku">ax = df['sepal length (cm)'].plot.hist(density=True, xlim=[0,12], bins=range(2,10))<br/>df['sepal length (cm)'].plot.density(ax=ax)<br/>ax.set_xlabel('sepal length (cm)')</span></pre><p id="a68e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">小提琴剧情</strong></p><p id="913e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">violin图是箱线图和密度图的组合，它被提议用密度图来扩充箱线图。</p><figure class="kh ki kj kk fd lk er es paragraph-image"><div class="er es lx"><img src="../Images/cd96e7eb7cf40326adb1aff0bc9003ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*nT1LwHSkDOB7CFEWUVetJA.png"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">小提琴情节</figcaption></figure><p id="51a1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">小提琴情节的代码如下:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="823c" class="kq je hh km b fi kr ks l kt ku">import seaborn as sns</span><span id="62ed" class="kq je hh km b fi kv ks l kt ku">ax = sns.violinplot(df['sepal length (cm)'], inner='quartile', color='white', palette="Set2")<br/>ax.set_ylabel('Sepal Length')</span></pre><h2 id="3bee" class="kq je hh bd jf kw kx ky jj kz la lb jn ip lc ld jr it le lf jv ix lg lh jz li bi translated">相互关系</h2><p id="8b1b" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">在双变量和多变量分析中，检验多个变量之间关系的第一步是相关性。如果X的高值与Y的高值相关，X的低值与Y的低值相关，则变量X和Y(每个变量都有测量数据)被称为正相关。如果X的高值与Y的低值相关，反之亦然，则变量负相关。相关系数给出了两个变量之间相关性的估计值，这两个变量总是位于同一尺度上。一种流行的相关类型是<em class="kg">皮尔逊相关</em>系数，如下所示:</p><figure class="kh ki kj kk fd lk er es paragraph-image"><div class="er es ly"><img src="../Images/c2c56847cc5f1ec3b4eb7d717fe9587e.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*NeNBIhMtd-B1glSFjKPWVg.png"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">皮尔逊相关系数</figcaption></figure><p id="47ff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在Iris数据集中，四个不同变量的相关系数如下图所示</p><figure class="kh ki kj kk fd lk er es paragraph-image"><div class="er es lz"><img src="../Images/e58295f500b03fdc1cf634f5619a052d.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*DEbQjGl6cFtHVUpUbIaYPg.png"/></div></figure><p id="35a5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可以看出，每个变量与自身的相关性最高，这在直觉上是正确的。此外，一些变量如萼片长度和花瓣长度高度正相关，而萼片宽度和花瓣长度高度负相关。python实现如下面的代码所示:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="68d7" class="kq je hh km b fi kr ks l kt ku">sns.heatmap(df.corr(), vmin=-1, vmax=1, cmap=sns.diverging_palette(20, 220, as_cmap=True))</span></pre><p id="a364" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">呈现相关表的另一种方法如下所示，该方法添加了椭圆形状，以明确显示两个变量相关的方向。下面的代码摘自《数据科学家实用统计学》一书。</p><figure class="kh ki kj kk fd lk er es paragraph-image"><div class="er es ma"><img src="../Images/4bc61e1dfccbbdf7380d678401d77e27.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*8ovusnAzZqhUYyTfHBa-Zg.png"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">具有明确方向的相关系数表</figcaption></figure><p id="aa5d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">形状越暗越窄，两个变量的相关性越高。零相关由正圆表示。下面的代码(摘自《数据科学家实用统计》<a class="ae jc" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/" rel="noopener ugc nofollow" target="_blank"/>)演示了相关系数表</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="a6a9" class="kq je hh km b fi kr ks l kt ku">from matplotlib.collections import EllipseCollection<br/>from matplotlib.colors import Normalize<br/>import numpy as np<br/>import seaborn as sns<br/>import matplotlib.pylab as plt</span><span id="cca5" class="kq je hh km b fi kv ks l kt ku">def plot_corr_ellipses(data, figsize=None, **kwargs):</span><span id="53c0" class="kq je hh km b fi kv ks l kt ku">''' https://stackoverflow.com/a/34558488 '''</span><span id="b628" class="kq je hh km b fi kv ks l kt ku">M = np.array(data)<br/>if not M.ndim == 2:<br/>raise ValueError('data must be a 2D array')</span><span id="dba3" class="kq je hh km b fi kv ks l kt ku">fig, ax = plt.subplots(1, 1, figsize=figsize, subplot_kw={'aspect':'equal'})<br/>ax.set_xlim(-0.5, M.shape[1] - 0.5)<br/>ax.set_ylim(-0.5, M.shape[0] - 0.5)<br/>ax.invert_yaxis()</span><span id="0e11" class="kq je hh km b fi kv ks l kt ku"># xy locations of each ellipse center<br/>xy = np.indices(M.shape)[::-1].reshape(2, -1).T</span><span id="e607" class="kq je hh km b fi kv ks l kt ku"># set the relative sizes of the major/minor axes according to the strength of</span><span id="abef" class="kq je hh km b fi kv ks l kt ku"># the positive/negative correlation<br/>w = np.ones_like(M).ravel() + 0.01<br/>h = 1 - np.abs(M).ravel() - 0.01<br/>a = 45 * np.sign(M).ravel()</span><span id="8eee" class="kq je hh km b fi kv ks l kt ku">ec = EllipseCollection(widths=w, heights=h, angles=a, units='x', offsets=xy, norm=Normalize(vmin=-1, vmax=1),<br/>transOffset=ax.transData, array=M.ravel(), **kwargs)<br/>ax.add_collection(ec)</span><span id="519e" class="kq je hh km b fi kv ks l kt ku"># if data is a DataFrame, use the row/column names as tick labels</span><span id="4d07" class="kq je hh km b fi kv ks l kt ku">if isinstance(data, pd.DataFrame):</span><span id="4ee0" class="kq je hh km b fi kv ks l kt ku">ax.set_xticks(np.arange(M.shape[1]))<br/>ax.set_xticklabels(data.columns, rotation=90)<br/>ax.set_yticks(np.arange(M.shape[0]))<br/>ax.set_yticklabels(data.index)</span><span id="0667" class="kq je hh km b fi kv ks l kt ku">return ec, fig</span><span id="8173" class="kq je hh km b fi kv ks l kt ku">m, fig = plot_corr_ellipses(df.corr(), figsize=(5, 4), cmap='bwr_r')</span><span id="abad" class="kq je hh km b fi kv ks l kt ku">cb = fig.colorbar(m)<br/>cb.set_label('Correlation coefficient')</span><span id="03a1" class="kq je hh km b fi kv ks l kt ku">plt.tight_layout()<br/>plt.show()</span></pre><p id="494a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">皮尔逊相关系数更容易受到异常值的影响。基于等级的相关系数，例如<em class="kg">斯皮尔曼的ρ</em>，对于异常值是稳健的。</strong></p><h2 id="65f3" class="kq je hh bd jf kw kx ky jj kz la lb jn ip lc ld jr it le lf jv ix lg lh jz li bi translated"><strong class="ak">散点图、六边形宁滨和等高线</strong></h2><p id="81f4" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">表示两个变量之间关系的标准方法之一是散点图。掌握两个变量之间关系的一般概念是表示数值的有效方法。</p><figure class="kh ki kj kk fd lk er es paragraph-image"><div class="er es mb"><img src="../Images/7524aa9fd818ee646ae27393600dee27.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*sGIRo42I9LWvlYYFYXjikA.png"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">散点图</figcaption></figure><p id="3f08" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面的代码实现了散点图</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="ad78" class="kq je hh km b fi kr ks l kt ku">ax = df.plot.scatter(x='sepal length (cm)', y='petal length (cm)', figsize=(4, 4), marker='$\u25EF$')<br/>ax.set_xlabel('sepal length (cm)')<br/>ax.set_ylabel('petal length (cm)')<br/>ax.set_title('Scatter plot')</span></pre><p id="7785" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从图中可以看出，萼片长度和花瓣长度也呈正相关，相关系数也是如此。</p><p id="c689" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于拥有数十万或数百万条记录的数据集，散点图会过于密集，因此我们需要一种不同的方式来可视化这种关系。六边形宁滨是展示散点图状的非常有效的方式，同时不会太嘈杂和密集而丢失数据的轨迹。对于与散点图相同的变量集，六边形宁滨将所有值对分成六边形，并根据给定条柱中值的计数调整每个条柱的强度。萼片和花瓣长度的六边形框如下图所示:</p><figure class="kh ki kj kk fd lk er es paragraph-image"><div class="er es mc"><img src="../Images/7df06910e500cbe9e58aebae9fef4305.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*GSg3zJn2h94POto3dOhAkg.png"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">六角仓</figcaption></figure><p id="3a06" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">六角形图的python代码如下所示:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="5fde" class="kq je hh km b fi kr ks l kt ku">ax = df.plot.hexbin(x='sepal length (cm)', y='petal length (cm)', gridsize=30, sharex=False, figsize=(5, 4))</span><span id="f0b2" class="kq je hh km b fi kv ks l kt ku">ax.set_xlabel('sepal length (cm)')<br/>ax.set_ylabel('petal length (cm)')</span></pre><p id="6ca4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有时，通过反绘图透镜观察联合分布是有益的。当数据量很大，需要在散点图中清楚显示时，计数器图是另一种方法。萼片和花瓣长度的计数图如下图所示:</p><figure class="kh ki kj kk fd lk er es paragraph-image"><div class="er es md"><img src="../Images/8e75ed51c7b0b9de937bac5f3aef0870.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*ES1VUzEHVPGaEzMmVQH9HQ.png"/></div><figcaption class="lr ls et er es lt lu bd b be z dx translated">等值线图表</figcaption></figure><p id="c249" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">等值线图的python代码如下图所示:</p><pre class="kh ki kj kk fd kl km kn ko aw kp bi"><span id="7170" class="kq je hh km b fi kr ks l kt ku">ax = sns.kdeplot(data=df, x=’sepal length (cm)’, y=’petal length (cm)’, fill=True)</span><span id="dbf4" class="kq je hh km b fi kv ks l kt ku">ax.set_xlabel(‘sepal length (cm)’)<br/>ax.set_ylabel(‘petal length (cm)’)</span></pre><h1 id="38e9" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">结论</h1><p id="7394" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">在这篇短文中，我们旨在涵盖数据分析中最基本但又最基本的原则。本文和第一部分<a class="ae jc" rel="noopener" href="/analytics-vidhya/the-first-chapter-of-data-analysis-part-i-2aafe332cf6b">一起展示了EDA的第一步，EDA是统计分析中的独立主题。</a></p></div></div>    
</body>
</html>