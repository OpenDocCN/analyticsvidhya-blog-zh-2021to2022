# ä½ çœ‹èµ·æ¥åƒä»€ä¹ˆå“ç§ï¼Ÿ

> åŸæ–‡ï¼š<https://medium.com/analytics-vidhya/what-dog-breed-do-you-look-like-a1ade21c70e6?source=collection_archive---------10----------------------->

ä½ å¬è¿‡ç‹—å’Œä¸»äººé•¿å¾—å¾ˆåƒçš„è¯´æ³•å—ï¼Ÿè®©æˆ‘ä»¬çœ‹çœ‹å·ç§¯ç¥ç»ç½‘ç»œæ˜¯å¦èƒ½çœ‹å‡ºè¿™ä¸€ç‚¹ã€‚

![](img/a5d1807d91b9886d81621b76ebebd878.png)

[**ç­‰å¾…ï¼Ÿâ€¦ä»€ä¹ˆï¼Ÿ**](https://unsplash.com/photos/K4mSJ7kc0As)

# é¡¹ç›®å®šä¹‰

å…³äºç‹—å’Œå®ƒä»¬ä¸»äººçš„æœ‰è¶£äº‹å®:æ ¹æ® BBC[2015 å¹´å‘è¡¨çš„æ–‡ç« ](https://www.bbc.com/future/article/20151111-why-do-dogs-look-like-their-owners)ï¼Œç‹—çœ‹èµ·æ¥åƒå®ƒä»¬çš„ä¸»äººæ˜¯ä¸€ä¸ªç§‘å­¦äº‹å®ã€‚å¦‚æœä½ èŠ±è¶³å¤Ÿçš„æ—¶é—´åœ¨å…¬å›­æ•£æ­¥ï¼Œä½ æœ€ç»ˆä¼šçœ‹åˆ°ä¸€åªå’Œå®ƒçš„ä¸»äººå¾ˆåƒçš„ç‹—ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æ·±åº¦å­¦ä¹ ç®—æ³•æ˜¯å¦å¯ä»¥æ­£ç¡®è¯†åˆ«å“ç§ï¼Œç„¶åçœ‹çœ‹å®ƒçš„ä¸»äººæ˜¯å¦çœŸçš„çœ‹èµ·æ¥åƒä»–ä»¬çš„ç‹—å“ç§ã€‚

æˆ‘ä»¬åœ¨è¿™ä¸ªé¡¹ç›®ä¸­æ¶‰åŠåˆ°ä¸¤ä¸ªä¸»è¦é—®é¢˜ã€‚é¦–å…ˆï¼Œæ˜¯ä»ä¼ é€’ç»™ç¥ç»ç½‘ç»œç®—æ³•çš„å›¾ç‰‡ä¸­è¯†åˆ«å®ƒæ˜¯å¦æ˜¯ä¸€åªç‹—åŠå…¶å“ç§ã€‚ç¬¬äºŒï¼Œå¦‚æœå®ƒä¸æ˜¯ä¸€åªç‹—è€Œæ˜¯ä¸€ä¸ªäººï¼Œé‚£ä¹ˆé¢„æµ‹æœ€æ¥è¿‘çš„ç‹—çš„å“ç§ã€‚

*   ä¸ºäº†è§£å†³é—®é¢˜çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬é¦–å…ˆæ„å»ºä¸€ä¸ªç®€å•çš„å·ç§¯ç¥ç»ç½‘ç»œ(CNN)æ¶æ„ï¼Œä½†è¿™å¯¼è‡´äº†è¾ƒä½çš„å‡†ç¡®æ€§ã€‚ç„¶åï¼Œæˆ‘ä»¬æ±‚åŠ©äºè¿ç§»å­¦ä¹ æ–¹æ³•ï¼Œä½¿ç”¨ [ResNet-50](https://s3-us-west-1.amazonaws.com/udacity-aind/dog-project/DogResnet50Data.npz) çš„ç“¶é¢ˆç‰¹æ€§ï¼Œè¿™æ˜¾è‘—æé«˜äº†å‡†ç¡®æ€§ã€‚è¿ç§»å­¦ä¹ çš„ä¸»è¦æ€æƒ³æ˜¯ï¼Œäººä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°é‡ç”¨é¢„å…ˆè®­ç»ƒçš„ç‰¹å¾ï¼Œå¹¶ç”¨è‡ªå·±çš„æ•°æ®é‡æ–°è®­ç»ƒåˆ†ç±»éƒ¨åˆ†ã€‚
*   å¯¹äºé—®é¢˜çš„ç¬¬äºŒéƒ¨åˆ†ï¼Œæˆ‘ä»¬ä½¿ç”¨ OpenCV å®ç°çš„[åŸºäº Haar ç‰¹å¾çš„çº§è”åˆ†ç±»å™¨](http://docs.opencv.org/trunk/d7/d8b/tutorial_py_face_detection.html)æ¥æ£€æµ‹å›¾åƒä¸­çš„äººè„¸ã€‚OpenCV æä¾›äº†è®¸å¤šé¢„å…ˆè®­ç»ƒå¥½çš„äººè„¸æ£€æµ‹å™¨ï¼Œä½œä¸º XML æ–‡ä»¶å­˜å‚¨åœ¨ [github](https://github.com/opencv/opencv/tree/master/data/haarcascades) ä¸Šã€‚

## å…¬åˆ¶çš„

ä¸‹é¢å®šä¹‰äº†ä¸€äº›æŒ‡æ ‡ï¼Œè¿™äº›æŒ‡æ ‡å¯ä»¥ç”±æ¨¡å‹è®¡ç®—å‡ºæ¥ï¼Œåœ¨è¯„ä¼°æ€§èƒ½æ—¶ä¼šæœ‰æ‰€å¸®åŠ©ã€‚

*   **å‡†ç¡®åº¦**æ˜¯æ­£ç¡®åˆ†ç±»çš„ä¾‹å­çš„ç™¾åˆ†æ¯”
*   **å‡**é˜´æ€§(FN)å’Œ**å‡**é˜³æ€§(FP)æ˜¯è¢«**é”™è¯¯**åˆ†ç±»çš„æ ·æœ¬
*   **çœŸ**é˜´æ€§(TN)å’Œ**çœŸ**é˜³æ€§(TP)æ˜¯è¢«**æ­£ç¡®**åˆ†ç±»çš„æ ·æœ¬
*   **ç²¾åº¦**æ˜¯è¢«æ­£ç¡®åˆ†ç±»çš„**é¢„æµ‹**é˜³æ€§çš„ç™¾åˆ†æ¯”:

![](img/edf365c92b8a62ac45fe8be6e151f013.png)

ç²¾ç¡®

*   **Recall** æ˜¯æ­£ç¡®åˆ†ç±»çš„**å®é™…**é˜³æ€§çš„ç™¾åˆ†æ¯”:

![](img/a5915b61db74ebce187f35188afc6fca.png)

å›å¿†

*   **F1** æ˜¯ç²¾åº¦å’Œå¬å›ç‡çš„åŠ æƒå¹³å‡å€¼

![](img/92b539015893af402bc61ce8a4e829af.png)

F1 åˆ†æ•°

**æ³¨æ„:**ç”±äºçŠ¬åªçš„ç­‰çº§ç•¥æœ‰ä¸å¹³è¡¡ï¼Œå‡†ç¡®æ€§å¯¹äºè¿™ä¸ªé—®é¢˜å¹¶ä¸æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„è¡¡é‡æ ‡å‡†ã€‚ä½ å¯ä»¥åœ¨è¿™ä¸ªé¡¹ç›®ä¸Šæœ‰ 99.8%ä»¥ä¸Šçš„å‡†ç¡®ç‡ï¼Œåªè¦ä¸€ç›´é¢„æµ‹é”™è¯¯ã€‚å› æ­¤ï¼Œä¸ºäº†ç¡®ä¿æˆ‘ä»¬å¯¹æˆ‘ä»¬çš„æ¨¡å‹åšå‡ºæ­£ç¡®çš„å†³ç­–ï¼Œæˆ‘ä»¬å°†æŸ¥çœ‹ä¸Šé¢æåˆ°çš„æ‰€æœ‰æŒ‡æ ‡ã€‚

# åˆ†æ

æœ¬é¡¹ç›®ä½¿ç”¨çš„æ•°æ®ç”± Udacity æä¾›ã€‚

æ€»å…±æœ‰ 133 ç§ç‹—ã€‚
æ€»å…±æœ‰ 8351 å¼ ç‹—çš„å›¾ç‰‡ã€‚

è®­ç»ƒç‹—å›¾åƒæœ‰ 6680 ä¸ªã€‚
æœ‰ 835 ä¸ªéªŒè¯ç‹—å›¾åƒã€‚
æœ‰ 836 å¼ æµ‹è¯•ç‹—å›¾ç‰‡ã€‚

è¿˜æœ‰â€¦

æ€»å…±æœ‰ 13233 ä¸ªäººåƒã€‚

ä¸‹è¡¨æ˜¾ç¤ºäº†æ¯ç±»çš„ä¸€äº›æ ·æœ¬ã€‚æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œè¿™äº›ç­çº§æ˜¯ä¸å¹³è¡¡çš„ã€‚å…¶ä¸­æœ€ä½æ•°é‡çš„æ ·æœ¬å¯¹åº”äºæŒªå¨ buhund å’Œ Xoloitzcuintli (33 ä¸ªæ ·æœ¬)ï¼Œæœ€é«˜æ•°é‡çš„æ ·æœ¬å¯¹åº”äºé˜¿æ‹‰æ–¯åŠ é›ªæ©‡çŠ¬(96 ä¸ªæ ·æœ¬)ã€‚

```
Index    Breed                                    Number     
1        Affenpinscher                            80        
2        Afghan_hound                             73        
3        Airedale_terrier                         65        
4        Akita                                    79        
5        Alaskan_malamute                         96        
6        American_eskimo_dog                      80        
7        American_foxhound                        63        
8        American_staffordshire_terrier           82        
9        American_water_spaniel                   42        
10       Anatolian_shepherd_dog                   62        
11       Australian_cattle_dog                    83        
12       Australian_shepherd                      83        
13       Australian_terrier                       58        
14       Basenji                                  86        
15       Basset_hound                             92        
16       Beagle                                   74        
17       Bearded_collie                           77        
18       Beauceron                                63        
19       Bedlington_terrier                       60        
20       Belgian_malinois                         78        
21       Belgian_sheepdog                         80        
22       Belgian_tervuren                         59        
23       Bernese_mountain_dog                     81        
24       Bichon_frise                             77        
25       Black_and_tan_coonhound                  46        
26       Black_russian_terrier                    51        
27       Bloodhound                               80        
28       Bluetick_coonhound                       44        
29       Border_collie                            93        
30       Border_terrier                           65        
31       Borzoi                                   70        
32       Boston_terrier                           81        
33       Bouvier_des_flandres                     56        
34       Boxer                                    80        
35       Boykin_spaniel                           66        
36       Briard                                   81        
37       Brittany                                 62        
38       Brussels_griffon                         71        
39       Bull_terrier                             87        
40       Bulldog                                  66        
41       Bullmastiff                              86        
42       Cairn_terrier                            79        
43       Canaan_dog                               62        
44       Cane_corso                               80        
45       Cardigan_welsh_corgi                     66        
46       Cavalier_king_charles_spaniel            84        
47       Chesapeake_bay_retriever                 67        
48       Chihuahua                                68        
49       Chinese_crested                          63        
50       Chinese_shar-pei                         62        
51       Chow_chow                                78        
52       Clumber_spaniel                          61        
53       Cocker_spaniel                           59        
54       Collie                                   71        
55       Curly-coated_retriever                   63        
56       Dachshund                                82        
57       Dalmatian                                89        
58       Dandie_dinmont_terrier                   63        
59       Doberman_pinscher                        59        
60       Dogue_de_bordeaux                        75        
61       English_cocker_spaniel                   76        
62       English_setter                           66        
63       English_springer_spaniel                 66        
64       English_toy_spaniel                      49        
65       Entlebucher_mountain_dog                 53        
66       Field_spaniel                            41        
67       Finnish_spitz                            42        
68       Flat-coated_retriever                    79        
69       French_bulldog                           64        
70       German_pinscher                          59        
71       German_shepherd_dog                      78        
72       German_shorthaired_pointer               60        
73       German_wirehaired_pointer                52        
74       Giant_schnauzer                          51        
75       Glen_of_imaal_terrier                    55        
76       Golden_retriever                         80        
77       Gordon_setter                            54        
78       Great_dane                               50        
79       Great_pyrenees                           74        
80       Greater_swiss_mountain_dog               57        
81       Greyhound                                70        
82       Havanese                                 76        
83       Ibizan_hound                             58        
84       Icelandic_sheepdog                       62        
85       Irish_red_and_white_setter               46        
86       Irish_setter                             66        
87       Irish_terrier                            82        
88       Irish_water_spaniel                      64        
89       Irish_wolfhound                          66        
90       Italian_greyhound                        73        
91       Japanese_chin                            71        
92       Keeshond                                 55        
93       Kerry_blue_terrier                       44        
94       Komondor                                 55        
95       Kuvasz                                   61        
96       Labrador_retriever                       54        
97       Lakeland_terrier                         62        
98       Leonberger                               57        
99       Lhasa_apso                               53        
100      Lowchen                                  42        
101      Maltese                                  60        
102      Manchester_terrier                       36        
103      Mastiff                                  72        
104      Miniature_schnauzer                      53        
105      Neapolitan_mastiff                       39        
106      Newfoundland                             62        
107      Norfolk_terrier                          58        
108      Norwegian_buhund                         33        
109      Norwegian_elkhound                       56        
110      Norwegian_lundehund                      41        
111      Norwich_terrier                          55        
112      Nova_scotia_duck_tolling_retriever       67        
113      Old_english_sheepdog                     49        
114      Otterhound                               44        
115      Papillon                                 79        
116      Parson_russell_terrier                   38        
117      Pekingese                                60        
118      Pembroke_welsh_corgi                     66        
119      Petit_basset_griffon_vendeen             39        
120      Pharaoh_hound                            49        
121      Plott                                    35        
122      Pointer                                  40        
123      Pomeranian                               55        
124      Poodle                                   62        
125      Portuguese_water_dog                     42        
126      Saint_bernard                            37        
127      Silky_terrier                            51        
128      Smooth_fox_terrier                       38        
129      Tibetan_mastiff                          60        
130      Welsh_springer_spaniel                   55        
131      Wirehaired_pointing_griffon              37        
132      Xoloitzcuintli                           33        
133      Yorkshire_terrier                        38
```

# æ–¹æ³•å­¦

åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨ç”¨äºçŠ¬ç§åˆ†ç±»çš„ CNN æ¶æ„ã€‚

åœ¨æˆ‘ä»¬ç»§ç»­è®¨è®º CNN æ¶æ„ä¹‹å‰ï¼Œä¸º CNN è¾“å…¥å‡†å¤‡æ•°æ®æœ‰å‡ ä¸ªé‡è¦æ­¥éª¤ã€‚

*   å½“ä½¿ç”¨ TensorFlow ä½œä¸ºåç«¯æ—¶ï¼ŒKeras CNN éœ€è¦ä¸€ä¸ª 4D æ•°ç»„(åˆå 4D å¼ é‡)ä½œä¸ºè¾“å…¥ï¼Œå¸¦æœ‰ shape (nb_samplesï¼Œrowsï¼Œcolumnsï¼Œchannels)ï¼Œå…¶ä¸­`nb_samples`æ˜¯å›¾åƒçš„æ€»æ•°ï¼Œ`rows`ã€`columns`ã€`channels`åˆ†åˆ«å¯¹åº”æ¯å¼ å›¾åƒçš„è¡Œæ•°ã€åˆ—æ•°å’Œé€šé“æ•°ã€‚
*   ä¸º Keras ä¸­çš„ä»»ä½•é¢„è®­ç»ƒæ¨¡å‹å‡†å¤‡å¥½ 4D å¼ é‡ï¼Œéœ€è¦ä¸€äº›é¢å¤–çš„å¤„ç†ã€‚é¦–å…ˆï¼Œé€šè¿‡å¯¹é€šé“é‡æ–°æ’åºï¼Œå°† RGB å›¾åƒè½¬æ¢ä¸º BGR å›¾åƒã€‚æ‰€æœ‰é¢„è®­ç»ƒæ¨¡å‹éƒ½æœ‰é¢å¤–çš„å½’ä¸€åŒ–æ­¥éª¤ï¼Œå³å¿…é¡»ä»æ¯ä¸ªå›¾åƒçš„æ¯ä¸ªåƒç´ ä¸­å‡å»å¹³å‡åƒç´ (ç”¨ RGB è¡¨ç¤ºä¸º[103.939ï¼Œ116.779ï¼Œ123.68]ï¼Œå¹¶æ ¹æ® ImageNet ä¸­æ‰€æœ‰å›¾åƒçš„æ‰€æœ‰åƒç´ è®¡ç®—å¾—å‡º)ã€‚è¿™åœ¨å¯¼å…¥çš„å‡½æ•°`preprocess_input`ä¸­å®ç°ã€‚

ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ç§æ–¹æ³•æ¥æ ¼å¼åŒ–æˆ‘ä»¬çš„å›¾åƒï¼Œä»¥æä¾›ç»™ Keras ä¸­ä»»ä½•é¢„å…ˆè®­ç»ƒçš„æ¨¡å‹ï¼Œæˆ‘ä»¬ç°åœ¨å‡†å¤‡ä½¿ç”¨è¯¥æ¨¡å‹æ¥æå–é¢„æµ‹ã€‚è¿™æ˜¯é€šè¿‡`predict`æ–¹æ³•å®Œæˆçš„ï¼Œè¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ•°ç»„çš„ğ‘–-th æ¡ç›®æ˜¯æ¨¡å‹é¢„æµ‹çš„å›¾åƒå±äºğ‘–-th ImageNet ç±»åˆ«çš„æ¦‚ç‡ã€‚å¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨ ResNet-50 ä½œä¸ºé¢„è®­ç»ƒæ¨¡å‹ï¼Œè¿™å°†åœ¨ä¸‹é¢çš„`ResNet50_predict_labels`å‡½æ•°ä¸­å®ç°ã€‚

é€šè¿‡è·å–é¢„æµ‹æ¦‚ç‡å‘é‡çš„ argmaxï¼Œæˆ‘ä»¬è·å¾—äº†ä¸æ¨¡å‹çš„é¢„æµ‹å¯¹è±¡ç±»åˆ«ç›¸å¯¹åº”çš„æ•´æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨è¿™ä¸ª[å­—å…¸](https://gist.github.com/yrevar/942d3a0ac09ec9e5eb3a)æ¥è¯†åˆ«å¯¹è±¡ç±»åˆ«ã€‚

åœ¨æŸ¥çœ‹[å­—å…¸](https://gist.github.com/yrevar/942d3a0ac09ec9e5eb3a)æ—¶ï¼Œæ‚¨ä¼šæ³¨æ„åˆ°å¯¹åº”äºç‹—çš„ç±»åˆ«ä»¥ä¸é—´æ–­çš„é¡ºåºå‡ºç°ï¼Œå¹¶å¯¹åº”äºå­—å…¸å…³é”®å­— 151-268ï¼ŒåŒ…æ‹¬ä»`'Chihuahua'`åˆ°`'Mexican hairless'`çš„æ‰€æœ‰ç±»åˆ«ã€‚å› æ­¤ï¼Œä¸ºäº†æ£€æŸ¥é¢„è®­ç»ƒçš„ ResNet-50 æ¨¡å‹æ˜¯å¦é¢„æµ‹å›¾åƒåŒ…å«ç‹—ï¼Œæˆ‘ä»¬åªéœ€è¦æ£€æŸ¥ä¸Šé¢çš„`ResNet50_predict_labels`å‡½æ•°æ˜¯å¦è¿”å› 151 å’Œ 268 ä¹‹é—´(åŒ…æ‹¬ 151 å’Œ 268)çš„å€¼ã€‚

# ç»“æœ

**æ¨¡å‹æ¶æ„**

æˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ªæ¨¡å‹ã€‚ä¸€ä¸ªä»é›¶å¼€å§‹ä½¿ç”¨åŸºæœ¬çš„æœ´ç´ æ¶æ„ï¼Œå¦ä¸€ä¸ªæˆ‘ä»¬ä½¿ç”¨æ¥è‡ª Keras çš„é¢„è®­ç»ƒçš„ ResNet-50 æ¨¡å‹ï¼Œå¹¶æ·»åŠ ä¸€äº›å±‚æ¥é€‚åº”æˆ‘ä»¬çš„é—®é¢˜ã€‚

## **æœ´ç´ çš„å»ºç­‘**

æœ‰ 2D å·ç§¯å±‚ï¼Œä¸€ä¸ªè¾å­¦å’Œæœ€å¤§æ± å±‚ã€‚æœ€åï¼Œåœ¨æˆ‘ä»¬ä½¿ç”¨å¯†é›†å±‚æ¥è·å¾—å›¾åƒçš„è¾“å‡ºæ ‡ç­¾ä¹‹å‰ï¼Œæˆ‘ä»¬åº”ç”¨ä¸€ä¸ªå¹³å¦å±‚ã€‚

```
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_1 (Conv2D)            (None, 223, 223, 16)      208       
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 111, 111, 16)      0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 110, 110, 32)      2080      
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 55, 55, 32)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 54, 54, 64)        8256      
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 27, 27, 64)        0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 46656)             0         
_________________________________________________________________
dense_1 (Dense)              (None, 200)               9331400   
_________________________________________________________________
dropout_1 (Dropout)          (None, 200)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 133)               26733     
=================================================================
Total params: 9,368,677
Trainable params: 9,368,677
Non-trainable params: 0
_________________________________________________________________
```

æœ´ç´ çš„å»ºç­‘ç»è¿‡ 20 ä¸ªæ—¶ä»£çš„è®­ç»ƒã€‚ç„¶åï¼Œæˆ‘ä»¬åœ¨ä»¥å‰çœ‹ä¸åˆ°çš„æ•°æ®ä¸Šæµ‹è¯•è¿™ä¸ªç®€å•çš„æ¨¡å‹ã€‚è¿™äº›æŒ‡æ ‡çš„é¢„æµ‹ç»“æœæ˜¯:

```
loss :  4.27126574516
acc :  0.0777511974021
precision :  0.0837320488606
recall :  0.00478468906651
f1 :  0.00901012775002
```

è¿™ä¸ªæŒºä½çš„ï¼Œä¸é è°±ã€‚æœ´ç´ æ¨¡å‹åœ¨å¤§çº¦ 2 ä¸ªæ—¶æœŸåä¹Ÿå¼€å§‹æ˜¾è‘—è¿‡åº¦æ‹Ÿåˆï¼Œå¹¶ä¸”ä¸èƒ½å¯¹éªŒè¯æ•°æ®è¿›è¡Œæ¦‚æ‹¬ã€‚

![](img/1921f4d33279d89355ebbd05eaf73903.png)

äº¤å‰ç†µä¸å†å…ƒæ•°

ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Keras ä¸­çš„é¢„è®­ç»ƒæ¨¡å‹æ¥ä¼˜åŒ–å’Œæé«˜æµ‹è¯•é¢„æµ‹ç²¾åº¦ã€‚

**ResNet-50 æ¶æ„**

ä¸ºäº†å®šåˆ¶ ResNet-50 æ¥è§£å†³æˆ‘ä»¬çš„é—®é¢˜ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªå¯†é›†å±‚æ¥è·å¾— 133 ç±»ç‹—ï¼Œå¯¹äºä¼˜åŒ–å™¨ï¼Œè¿™æ¬¡æˆ‘ä»¬ä½¿ç”¨ Adam ä¼˜åŒ–å™¨ï¼Œå¹¶å°†å­¦ä¹ é€Ÿç‡é™ä½åˆ° 10e-5ã€‚

```
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
global_average_pooling2d_2 ( (None, 2048)              0         
_________________________________________________________________
dense_4 (Dense)              (None, 133)               272517    
=================================================================
Total params: 272,517
Trainable params: 272,517
Non-trainable params: 0
_________________________________________________________________
```

æˆ‘ä»¬ä¹Ÿä¸ºè¿™ä¸ªæ¨¡å‹è®­ç»ƒäº† 20 ä¸ªæ—¶æœŸã€‚ä¸æœ´ç´ æ¨¡å‹ç›¸æ¯”ï¼Œè¿™ç§è¿ç§»å­¦ä¹ æ¨¡å‹å¯¹æµ‹è¯•æ•°æ®çš„å‡†ç¡®æ€§è¦é«˜å¾—å¤šã€‚æˆ‘ä»¬èƒ½å¤Ÿåœ¨ä»¥å‰çœ‹ä¸åˆ°çš„æ•°æ®ä¸Šè·å¾—æ›´é«˜çš„æŒ‡æ ‡åˆ†æ•°ã€‚

```
loss :  0.62373913518
acc :  0.821770344339
precision :  0.856132680149
recall :  0.788277515099
f1 :  0.819878099923
```

ä¸ºäº†æ¯”è¾ƒ naive æ¨¡å‹å’Œ ResNet-50 çš„æ€§èƒ½ï¼Œæˆ‘ä»¬æ˜¾ç¤ºäº†æŸå¤±å‡½æ•°ä¸å†å…ƒæ•°çš„å…³ç³»ï¼Œå…¶ä¸­æˆ‘ä»¬ç”¨è“è‰²ç»˜åˆ¶ naive æ¨¡å‹ï¼Œç”¨ç»¿è‰²ç»˜åˆ¶ ResNet-50 æ¨¡å‹ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜ä½¿ç”¨ä¸ ResNet-50 ç›¸åŒçš„å±‚æµ‹è¯•äº† VGG-16 çš„è¿ç§»å­¦ä¹ ï¼Œå¹¶åœ¨æ­¤ä»¥æ©™è‰²ç»˜åˆ¶ã€‚

![](img/896b228b7b193c86658b95ba179cd289.png)

æ‰€æœ‰æ¨¡å‹çš„äº¤å‰ç†µä¸å†å…ƒæ•°

ä»ä¸Šé¢çš„å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒResNet-50 æ¨¡å‹è¡¨ç°éå¸¸å¥½ã€‚æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡åœ¨è®­ç»ƒæ¨¡å‹æ—¶æŸ¥çœ‹å…¶ä»–æŒ‡æ ‡æ¥ç¡®è®¤è¿™ä¸€ç‚¹ã€‚

![](img/8dd3bb88fdbe8dd29e4ed89f89d7310c.png)

å› æ­¤ï¼Œæˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ ResNet-50 åœ¨æŒ‡æ ‡ä¸Šè·å¾—æœ€ä½³ç»“æœã€‚è®©æˆ‘ä»¬å®é™…çœ‹çœ‹ä¸€äº›ç‹—å›¾åƒçš„é¢„æµ‹ç»“æœã€‚åœ¨ä»ç½‘ä¸Šä¸‹è½½äº†éšæœºé€‰æ‹©çš„ç‹—çš„å›¾ç‰‡åï¼Œæˆ‘ä»¬æƒ³æ£€æŸ¥æˆ‘ä»¬çš„æ¨¡å‹å®é™…ä¸Šé¢„æµ‹ç‹—çš„å“ç§æœ‰å¤šå¥½ã€‚

![](img/4ae62a2af863526eebeb2b0d4905dbbd.png)

ResNet-50 è¯´å®ƒæ˜¯çº¦å…‹å¤æ¢—

æ ¹æ®ç»´åŸºç™¾ç§‘çš„é¡µé¢ï¼Œå®ƒç¡®å®æ˜¯ä¸€åªçº¦å…‹å¤æ¢—æˆ–è€…ç®€ç§°ä¸ºçº¦å…‹)

![](img/891d5f6fd51ad6ad0139deacde777d5f.png)

ç»´åŸºç™¾ç§‘ä¸Šçš„çº¦å…‹å¤æ¢—

å¯¹ç‹—çš„åˆä¸€ä¸ªå“ç§é¢„æµ‹ã€‚

![](img/28efd279b5572b609736d96773d9f534.png)

ResNet-50 è¯´ä½ æ˜¯å‰å¨ƒå¨ƒ

è¿™æ˜¯ä¸€å¼ æ¥è‡ªç»´åŸºç™¾ç§‘çš„å‰å¨ƒå¨ƒçš„ç…§ç‰‡

![](img/3dd3c6981fbeb22caa45cad074d9cde4.png)

ç»´åŸºç™¾ç§‘ä¸Šçš„å‰å¨ƒå¨ƒ

æ€»çš„æ¥è¯´ï¼Œè¿™ä¸ªæ¨¡å‹åœ¨å¤§å¤šæ•°æ—¶å€™éƒ½èƒ½é¢„æµ‹æ­£ç¡®çš„å“ç§ã€‚ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹ä¸€äº›ç‹—å’Œå®ƒä»¬çš„ä¸»äººï¼Œåªæ˜¯ä¸ºäº†å¥½ç©ã€‚å›¾ç‰‡æ‘˜è‡ªè¿™ç¯‡[æ–‡ç« ](https://lzpetnanny.wordpress.com/2010/04/09/is-it-true-dogs-and-their-owners-look-alike/)ã€‚å·¦è¾¹æ˜¯ä¸€åªç‹—ï¼Œå³è¾¹æ˜¯ç‹—çš„ä¸»äººã€‚

![](img/5eec8b7009f247834a64ae7a80397f53.png)![](img/7ef715a2313d410a98550a67d6adfba9.png)

ä¸€åªç‹—å’Œå®ƒçš„ä¸»äºº

å¥½çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„æ¨¡å‹é¢„æµ‹äº†ç‹—çš„æ­£ç¡®å“ç§ï¼Œæ˜¯[æ„å¤§åˆ©ç°ç‹—](https://en.wikipedia.org/wiki/Italian_Greyhound)ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬çš„æ¨¡å‹è®¤ä¸ºæ„å¤§åˆ©ç°ç‹—çš„ä¸»äººçœ‹èµ·æ¥åƒåˆ‡è¨çš®å…‹æ¹¾å¯»å›çŠ¬ï¼Œè¿™æ˜¯ä»ä¸‹å›¾ä¸­ä½ å¯ä»¥å†³å®šä»–å®é™…ä¸Šæ˜¯å¦åƒæˆ‘ä»¬çš„æ¨¡å‹é¢„æµ‹çš„å“ç§ã€‚

![](img/ad5b226d2cbc29375654706b92c4a1ff.png)

[åˆ‡è¨çš®å…‹æ¹¾å¯»å›çŠ¬](https://www.thesprucepets.com/chesapeake-bay-retriever-full-profile-history-and-care-4693502)

å†æ¥çœ‹ä¸€ä¸ªã€‚

![](img/7df5b7c92ed58e157518641985b2cd82.png)![](img/f8313e5fb559af4c2195e1981392d3d5.png)

ä¸€åªç‹—å’Œå®ƒçš„ä¸»äºº

åœ¨è¿™é‡Œï¼Œæ¨¡å‹å†æ¬¡åšå‡ºæ­£ç¡®çš„é¢„æµ‹ï¼Œé‚£å°±æ˜¯[è‹±å›½å¯å¡çŠ¬](https://en.wikipedia.org/wiki/English_Cocker_Spaniel)ï¼Œæˆ‘ä»¬çš„æ¨¡å‹è®¤ä¸ºç‹—çš„ä¸»äººé•¿å¾—åƒ[éª‘å£«æŸ¥ç†ç‹çŠ¬](https://en.wikipedia.org/wiki/Cavalier_King_Charles_Spaniel)ã€‚é‚£ç¦»è‹±å›½å¯å¡çŠ¬ä¸è¿œã€‚

![](img/7cafd4c8ce0ca7314b0945b91615081c.png)

[éª‘å£«æŸ¥ç†ç‹çŒçŠ¬](https://en.wikipedia.org/wiki/Cavalier_King_Charles_Spaniel)

# ç»“è®º

ä½¿ç”¨æ¥è‡ª ResNet-50 çš„é¢„å…ˆè®­ç»ƒçš„ç“¶é¢ˆç‰¹å¾ï¼Œæˆ‘ä»¬èƒ½å¤ŸèŠ‚çœæ—¶é—´æ¥æ„å»ºæˆ‘ä»¬è‡ªå·±çš„å›¾åƒè¯†åˆ«æ¨¡å‹ã€‚é€šè¿‡è¿ç§»å­¦ä¹ ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°æ›´å¥½çš„å‡†ç¡®æ€§(æœ´ç´ æ¨¡å‹çº¦ 6%çš„å‡†ç¡®æ€§å’Œ ResNet-50 ~ 83%çš„å‡†ç¡®æ€§),ä½†å®ƒå¯ä»¥è¿›ä¸€æ­¥æé«˜ï¼Œä¹Ÿè®¸æœ‰äº†æ›´å¥½çš„å‡†ç¡®æ€§ï¼Œæ¨¡å‹å°†èƒ½å¤Ÿæ›´å¥½åœ°é¢„æµ‹é•¿å¾—åƒä»–ä»¬çš„ç‹—çš„äººçš„å“ç§ã€‚è™½ç„¶ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šè€ƒè™‘å¯¹è¿™ç±»é—®é¢˜é‡‡å–ä¸åŒçš„æ–¹æ³•ï¼›)

1.  æ•°æ®æ‰©å……
2.  ç‹—çš„ç‰¹æ®Šç‰¹å¾
3.  å¹³è¡¡æ•°æ®é›†
4.  ç”¨ä¸åŒçš„æ—¶æœŸæ•°å’Œæ‰¹é‡å¤§å°è¿›è¡Œè®­ç»ƒã€‚
5.  è°ƒæ•´è¶…å‚æ•°(å­¦ä¹ ç‡ã€ä¼˜åŒ–å™¨ã€å¯†é›†å±‚ä¸­çš„èŠ‚ç‚¹æ•°)

å¦‚æœä½ æƒ³è‡ªå·±çœ‹çœ‹ä»£ç ï¼Œæˆ–è€…æ·»åŠ ä¸€äº›ç»†èŠ‚ï¼Œä½ å¯ä»¥åœ¨æˆ‘çš„ Github [ä¸ªäººèµ„æ–™](https://github.com/SabrinaAL/ML_Projects_Collection/tree/master/dog_app)ä¸­æ‰¾åˆ°è¿™ä¸ªç¬”è®°æœ¬ã€‚