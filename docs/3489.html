<html>
<head>
<title>The instability in logistic regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">逻辑回归中的不稳定性</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/the-instability-of-logistic-regression-1bb35f9054bf?source=collection_archive---------6-----------------------#2021-07-04">https://medium.com/analytics-vidhya/the-instability-of-logistic-regression-1bb35f9054bf?source=collection_archive---------6-----------------------#2021-07-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="c6a2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">问题越简单，解决方案越差</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/f90f315229f7dbf5e147c5a09b7f564c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h-lVjQeGa8gFdIm2pW2DAg.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">来源:谷歌图片</figcaption></figure><p id="83cd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于从同一人群中获得的训练集，逻辑回归的预测似乎很不稳定！！！为了介绍这个问题，让我先介绍一下我面临这个问题的背景。</p><h1 id="19c4" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">1.背景:</h1><p id="116a" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">我在数据集上执行逻辑回归—对于给定的信用余额(从0到20000不等)，响应是信用违约状态(是/否)。训练集是通过控制逻辑函数本身生成(模拟)的。注意到，对于相同的模拟函数，在不同尝试中生成的训练集的拟合分数在50%和87%之间变化。这就是问题的来源——‘T2的逻辑回归本质上是不稳定的吗’。</p><h1 id="db70" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">2.目标:</h1><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kv"><img src="../Images/d9fa265c006379753d95184aea352963.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*y1ffpUySuAl73_3klvVWiQ.jpeg"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">来源:谷歌图片</figcaption></figure><p id="cc4d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将尝试理解为什么从相同模拟函数生成的训练集的拟合分数不稳定。在<strong class="ig hi"><em class="kw">‘统计学习介绍——詹姆斯、威滕、哈斯蒂、提布拉尼’</em></strong>第138页第4.4节中可以找到这方面的提示</p><blockquote class="kx ky kz"><p id="fe97" class="ie if kw ig b ih ii ij ik il im in io la iq ir is lb iu iv iw lc iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="hh">当类被很好地分开时，逻辑回归模型的参数估计令人惊讶地不稳定。线性判别分析没有这个问题。</em>T11】</strong></p></blockquote><p id="f7fa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将试图通过实证研究来验证和理解这种不稳定性的本质，然后看看线性判别分析是否能解决这个问题。</p><h1 id="4143" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">3.模拟模型:</h1><p id="ca0c" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">下面是用于生成训练集的概率分布曲线，以及训练集本身-</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ld"><img src="../Images/31d1f07a5be8c1ee8ffc52ad179969fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*woXgGooNpXx74gfhUbcGwg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">图1:模拟模型和样本训练集</figcaption></figure><p id="bd1a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">两个响应类别(默认=是和默认=否)在特性(信用余额)方面的区别如下所示—</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es le"><img src="../Images/1e6ec87dfb68c42040dcf3c54c74bb47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*6pO-Jy6eONUXVpZpCPbqrw.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">图2:响应类的分离</figcaption></figure><h1 id="bc3a" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">4.不稳定性与阶级分离；</h1><p id="0599" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">我们准备了如上所述的三个训练集，以递减的类间隔。递减的类间距显示如下。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lf"><img src="../Images/95f405e45ab790514e8b0dc3fdf4f28f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RflPI90167BzlI93zRdCxg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">图3:减少类分离</figcaption></figure><p id="6bea" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于上述三个等级分离级别中的每一个级别-</p><ul class=""><li id="9364" class="lg lh hh ig b ih ii il im ip li it lj ix lk jb ll lm ln lo bi translated">我们生成20个训练集</li><li id="976d" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">对每一个应用逻辑回归，并找到合适的分数</li><li id="0c29" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">因此，对于每一级别的分类，我们有20个合适的分数。我们感兴趣的是随着类分离水平的变化，拟合分数的不稳定性。</li></ul><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lu"><img src="../Images/bb5d55ec7bfe43c6857bccb112080741.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lb-U2g6f9lEvQiVbJTKgDA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">图4:三个分离级别，拟合分数各不相同</figcaption></figure><p id="c658" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上面图中的分离值是这样获得的</p><ul class=""><li id="c5cd" class="lg lh hh ig b ih ii il im ip li it lj ix lk jb ll lm ln lo bi translated">根据控制概率分布函数，有一个信用余额x_high，其违约概率=yes是0.9(如图1所示)。</li><li id="c4ca" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">类似地，有一个x_low，它的违约概率=是0.1</li><li id="92e6" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">(x _ high x _ low)是分离值，这是表示类分离的一个很好的度量。</li></ul><p id="1040" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从上述三个图可以清楚地看出，拟合分数的不稳定性是如何随着类别分离的减少而降低的。然而，跨越3个分离值的测试不够稳健。我们需要在更多的分离水平上运行测试，以验证拟合分数的可变性是否确实随着分离值的降低而降低。为此，在给定分离值的情况下，我们需要一个度量来捕捉拟合分数的不稳定性。任何给定分离值的20个拟合分数的方差将作为不稳定性的度量。我们将对照分离值研究这种差异。</p><p id="294a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们由此产生的数据如下—</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lv"><img src="../Images/c5903d60b159a9e6874bda38966e09e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r-jPjxNoUTD4RAnWGzC8jg.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">表1:给定分离的拟合分数</figcaption></figure><p id="9025" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上面的列标题代表分离值，而列代表给定分离值的拟合分数。</p><p id="d7ff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当绘制不同分离水平的拟合分数的方差时，我们得到下图-</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lw"><img src="../Images/5d6d57ea6bd7035aefc8d41a4396a7e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B-IikwpfOXc7qBQb3KcW7g.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">图5:分离度与适合度差异</figcaption></figure><p id="cd6a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">上图显示，在分离值5000(蓝色垂直线)以下，方差完全消失(注意，x轴向右减少)。<strong class="ig hi">没错，fit分数最终非常低，只有50%(从表格的右栏可以明显看出)。但他们“一贯”贫穷(这很好！！)而这正是我们现在所关心的。</strong>注意，随着间隔的降低，x值的比例保持不变— <em class="kw"> O(10 ) </em>。因此，似乎不是特征值的比例，而是分离导致了拟合分数的不稳定性。</p><h1 id="41fa" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">5.补救措施—线性判别分析:</h1><p id="26b7" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">在这篇文章的“<strong class="ig hi">目标</strong>”部分，建议使用线性判别分析作为这个问题的解决方案。因此，我们现在将看看LDA是否遭受类似的不稳定性。</p><p id="ec29" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当针对线性判别分析生成相同的拟合分数方差对分离的数据时，获得以下图</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lx"><img src="../Images/a72b8643d465f38634578c3c80ef64f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_8Flv5-WqbfLaFRTI_DUrw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">图LDA的分离度与拟合度差异</figcaption></figure><p id="c663" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可以看出，线性判别分析没有可变性问题。需要提到的一点是LDA的拟合分数是<strong class="ig hi">一致且良好的</strong>。然而，我们在这里关注的是“一致性”。为什么逻辑回归在低分离值时满足于较差的拟合，而LDA具有较好的拟合——这是以后的问题。</p><h1 id="138b" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">6.结论:</h1><p id="8672" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">因此，如<strong class="ig hi"><em class="kw">【ISLR</em></strong>中所声称的，对于分离良好的阶层，逻辑回归确实变得不稳定。</p><blockquote class="kx ky kz"><p id="da56" class="ie if kw ig b ih ii ij ik il im in io la iq ir is lb iu iv iw lc iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="hh">划分界限分明的阶层很容易。然而，情况越简单，逻辑回归的表现就越不稳定。因此有了这篇文章的副标题。似乎逻辑回归在分类不同品种的狗方面做得很好，但在分类狗和猫时做得很差。</em>T3】</strong></p></blockquote><p id="629e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">LDA没有这个问题。因此，在这种情况下使用逻辑回归时，我们有两种方法可以选择</p><ul class=""><li id="0fba" class="lg lh hh ig b ih ii il im ip li it lj ix lk jb ll lm ln lo bi translated">缩放要素-这可能会减少分离。(一般来说，它是否会使合身性更好，还需要进一步研究。在这种情况下，人们可以验证它确实如此。看我的<a class="ae ly" href="https://stackoverflow.com/questions/68150694/do-features-need-to-be-scaled-in-logistic-regression" rel="noopener ugc nofollow" target="_blank"> stackoverflow问题</a>。)</li><li id="166a" class="lg lh hh ig b ih lp il lq ip lr it ls ix lt jb ll lm ln lo bi translated">或者用LDA。</li></ul><h1 id="fdb6" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">PS:</h1><p id="4c30" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">与这个演示相关的代码可以在<a class="ae ly" href="https://github.com/AnirbanChakraborty06/StatisticalLearning-ConfusionToClarity/blob/main/AnswersAndDemos/Instability%20of%20logistic%20regression%20for%20largely%20separated%20classes.ipynb" rel="noopener ugc nofollow" target="_blank">我的github库</a>中找到。该存储库包含统计学习方法领域中的其他类似问题和答案。</p></div></div>    
</body>
</html>