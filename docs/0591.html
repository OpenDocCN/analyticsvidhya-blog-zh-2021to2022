<html>
<head>
<title>Functional API model with Tensorflow 2.0 (Y-network)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Tensorflow 2.0的功能API模型(Y型网络)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/functional-api-model-with-tensorflow-2-0-y-network-ed59bfd810?source=collection_archive---------7-----------------------#2021-01-23">https://medium.com/analytics-vidhya/functional-api-model-with-tensorflow-2-0-y-network-ed59bfd810?source=collection_archive---------7-----------------------#2021-01-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/efb1f02c94f9abaeec9599ce4950a1ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z5bCwFcJwUxRFbVJH4-IwQ.jpeg"/></div></div></figure><p id="cca9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这个博客中，我们将在一个<strong class="ir hi">功能API </strong>的帮助下创建一个<strong class="ir hi"> CNN-Y-Network(2个输入，1个输出)</strong></p><h2 id="989b" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">顺序API与函数API</h2><figure class="kj kk kl km fd ii er es paragraph-image"><div class="er es ki"><img src="../Images/56b948a73c67292e9ce796ca9eb581de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*Xs31AY9jnmoAw3F0o6Jv1w.png"/></div></figure><p id="bda5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">一个<strong class="ir hi">顺序</strong> <strong class="ir hi"> API </strong>创建一个逐层格式的模型，它只有一个输入和输出，所以它不能创建一个可以共享层或者有多个输入或输出的模型。</p><p id="cc54" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">一个<strong class="ir hi">功能API </strong>创建了一个更加灵活的模型，因此您可以轻松定义模型，其中的层不仅仅连接到上一层和下一层。事实上，您可以将层连接到(字面上)任何其他层。结果，创造了复杂的网络。</p><p id="4bdf" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">既然已经定义了API，我将演示一个具有2个输入和1个输出的<strong class="ir hi">功能API</strong>( Y网络)</p><h2 id="5dcd" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">让我们开始进口</h2><p id="3210" class="pw-post-body-paragraph ip iq hh ir b is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji kr jk jl jm ha bi translated">我将使用Tensorflow API来创建这个模型。我将使用以下这些层:密集，Conv2D，Maxpooling2D，扁平化，辍学，我们也将使用连接层来结合两个输入和一个输入层。</p><p id="8743" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们还将使用<strong class="ir hi"> Mnist数据集</strong>测试模型，并使用<strong class="ir hi"> plot_model </strong>函数绘制模型</p><figure class="kj kk kl km fd ii"><div class="bz dy l di"><div class="ks kt l"/></div></figure><h2 id="8972" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">加载数据</h2><p id="3d26" class="pw-post-body-paragraph ip iq hh ir b is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji kr jk jl jm ha bi translated">加载数据并转换成一种热编码格式</p><figure class="kj kk kl km fd ii"><div class="bz dy l di"><div class="ks kt l"/></div></figure><h2 id="5b67" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">预处理数据</h2><p id="be48" class="pw-post-body-paragraph ip iq hh ir b is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji kr jk jl jm ha bi translated">现在，让我们对数据进行预处理，并将其除以255进行归一化</p><figure class="kj kk kl km fd ii"><div class="bz dy l di"><div class="ks kt l"/></div></figure><h2 id="89bc" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">因素</h2><p id="ee2e" class="pw-post-body-paragraph ip iq hh ir b is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji kr jk jl jm ha bi translated">现在，让我们定义参数，如辍学率、过滤器数量、CNN(卷积神经网络)的内核大小和批量大小</p><figure class="kj kk kl km fd ii"><div class="bz dy l di"><div class="ks kt l"/></div></figure><h2 id="25bc" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">Y网络的左支</h2><p id="d4ed" class="pw-post-body-paragraph ip iq hh ir b is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji kr jk jl jm ha bi translated">由于该功能模型基于2个输入，因此让我们从第一个输入(Y网络的左分支)开始，这里我们创建一个具有3层Conv2D、Maxpooling2D和Dropout的模型，其中滤波器数量随着每一层的增加而增加2倍</p><figure class="kj kk kl km fd ii"><div class="bz dy l di"><div class="ks kt l"/></div></figure><h2 id="3791" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">Y网络的右分支</h2><p id="55b9" class="pw-post-body-paragraph ip iq hh ir b is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji kr jk jl jm ha bi translated">它与左分支非常相似，只是Conv2D有一个额外的膨胀参数(这使得3X3内核的视野为5X5)</p><figure class="kj kk kl km fd ii"><div class="bz dy l di"><div class="ks kt l"/></div></figure><h2 id="1093" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">创建并打印模型</h2><p id="8dfd" class="pw-post-body-paragraph ip iq hh ir b is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji kr jk jl jm ha bi translated">现在，我们将使用串联层将两个分支连接起来，作为密集层的输入，密集层将作为输出。现在连接输入和输出，创建一个<strong class="ir hi">功能API模型</strong>，并使用plot_model函数绘制Y型网络</p><figure class="kj kk kl km fd ii"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="9dcd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">标绘模型</strong></p><p id="26cc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在让我们来看看绘制的Y型网络</p><figure class="kj kk kl km fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ku"><img src="../Images/680c82f44807c0c81ee85be445d8792e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5OoJj1cV-tltNOzc1DgRTg.png"/></div></div></figure><h2 id="feda" class="jn jo hh bd jp jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh bi translated">编译、运行和测试</h2><p id="39de" class="pw-post-body-paragraph ip iq hh ir b is kn iu iv iw ko iy iz ja kp jc jd je kq jg jh ji kr jk jl jm ha bi translated">我编译该模型，并将Adam算法定义为优化器，将稀疏分类交叉熵定义为损失函数。最后，我将模型与训练数据进行拟合。我们将把测试数据作为验证数据集并运行它</p><figure class="kj kk kl km fd ii"><div class="bz dy l di"><div class="ks kt l"/></div></figure><p id="4ea2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你可以从<a class="ae kv" href="https://github.com/Pavankunchala/Deep-Learning/blob/master/Tensorflow_Basics/Functional-Model/cnn_Y_Netwrok.py" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">这里</strong> </a>找到博客的代码</p><p id="1965" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi"> PS </strong>:如果你有任何疑问可以在这里给我发邮件<a class="ae kv" href="http://pavankunchalapk@gmail.com/" rel="noopener ugc nofollow" target="_blank">，你可以在我的linkedin上从</a><a class="ae kv" href="https://www.linkedin.com/in/pavan-kumar-reddy-kunchala/" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">这里</strong> </a> <strong class="ir hi"> </strong>联系我，你也可以在我的Github上从<a class="ae kv" href="https://github.com/Pavankunchala" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi">这里</strong> </a>查看我的其他代码(里面有很酷的东西)</p><p id="2e08" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我也在寻找深度学习和计算机视觉领域的自由职业机会，如果你愿意合作，请给我发邮件(<a class="ae kv" href="mailto:pavankunchalapk@gmail.com" rel="noopener ugc nofollow" target="_blank">pavankunchalapk@gmail.com</a>)</p><p id="84be" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">祝你有美好的一天！</p></div></div>    
</body>
</html>