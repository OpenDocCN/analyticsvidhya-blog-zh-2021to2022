<html>
<head>
<title>Stock Price Predictor Using FacebookProphet and Neural Network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于FacebookProphet和神经网络的股票价格预测器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/stock-price-predictor-using-fbprophet-and-neural-network-762307ec02f?source=collection_archive---------19-----------------------#2021-05-27">https://medium.com/analytics-vidhya/stock-price-predictor-using-fbprophet-and-neural-network-762307ec02f?source=collection_archive---------19-----------------------#2021-05-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="dac5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">准确预测股票走势可能是一项艰巨的任务。市场是高度随机的，我们(试图)用混乱的数据做出准确的预测。</p><p id="22d9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在现实世界中，股票价格取决于金融界内外的许多因素，如前几天的价格、政治因素、新闻报道、工厂相关问题，如事故或罢工、自然/环境因素等。例如，最近我们看到了埃隆·马斯克的推文对GameStop和比特币股价的影响。不幸的是，我们没有如此详细和信息丰富的数据集可供分析，所以我们的模型没有考虑这些因素。话虽如此，我们可以很容易地在线获得前几天股票价格的数据集。这就是我们将在算法中用到的。</p><p id="0a6d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在继续之前，我认为简单解释一下我们将要使用的技术是有用的，时间序列预测和FbProphet。</p><h2 id="7651" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">时间数列预测法</h2><p id="b2ef" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">这是一种利用过去的数据或经验来估计未来的方法。它只根据历史模式进行预测。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es kc"><img src="../Images/cb28981545237d0814237cc58b0ac22b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gp5pre3bwZP9FEFSRIYxaA.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">时间序列预测浅释</figcaption></figure><p id="121b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">简而言之，在时间序列分析中，假设我们想要预测某个日期t的“y”值。然后使用y(t-1)来预测y(t)，即前一天的“y”值，y(t-1)(“y”值前一天)等等，直到给定的时间范围n</p><h2 id="74ef" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">FaceBook先知</h2><p id="1dd2" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">另一方面，Fb Prophet是一个由脸书开发的用于单变量时间序列预测的开源库。它使时间序列预测的工作变得非常简单和完全自动化。更多详情，点击<a class="ae ks" href="https://machinelearningmastery.com/time-series-forecasting-with-prophet-in-python/#:~:text=Prophet%2C%20or%20%E2%80%9CFacebook%20Prophet%2C,trends%2C%20seasonality%2C%20and%20holidays.&amp;text=%E2%80%94%20Package%20'prophet'%2C%202019." rel="noopener ugc nofollow" target="_blank">此处</a>。</p><h1 id="701a" class="kt jd hh bd je ku kv kw ji kx ky kz jm la lb lc jp ld le lf js lg lh li jv lj bi translated">回到我们的代码</h1><p id="02b2" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">我们的数据集有6列，即:日期、开盘、收盘、盘高、盘低、调整收盘。</p><p id="2c7c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在我们的案例中，数据是从2016年3月9日到2021年3月8日(即5年)。它有1234行或实例和7列，即7个特征，其中一个是我们的y(输出)变量。</p><p id="15f6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后我们做一些基础的数据分析和探索。我们也清理我们的数据，以防它有不需要的值(NaN)。</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lk"><img src="../Images/f59df99a0b25e2e16b84fdfa3e6ceefa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8CwnKqCeC_3QpDB7mYeigw.png"/></div></div></figure><p id="385c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里我们简单地删除了所有可能妨碍代码正常运行的NaN值。</p><p id="3046" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">还执行了其他方法，可以在代码中看到，其链接在底部提供。</p><h1 id="331d" class="kt jd hh bd je ku kv kw ji kx ky kz jm la lb lc jp ld le lf js lg lh li jv lj bi translated">先知代码</h1><p id="9dc5" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">其中，对于FbProphet，我们只需要日期列和结束列。原因在于先知本身的工作。Prophet只需要两列来运行，即“ds”和“y”(名称不能更改！).ds表示日期，y表示我们要预测的变量。</p><p id="dbfe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">其核心是，Prophet程序是一个附加回归模型，有四个主要组成部分:</p><p id="b0a8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">‣呈分段线性或逻辑增长曲线趋势。Prophet通过从数据中选择变化点来自动检测趋势的变化。</p><p id="3917" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">‣是用傅立叶级数模拟的一个年度季节性分量。</p><p id="0702" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">‣是使用虚拟变量的每周季节性成分。</p><p id="62a3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">‣用户提供的重要节日列表</p><p id="0746" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">创建并拟合模型后，我们将看到如下结果</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es ll"><img src="../Images/9a5b1546a35d4bf013b445ff3a989d6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vQssO0QJ18jRE6hvrHe3mQ.png"/></div></div></figure><p id="741e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">即使用户只输入预测数据，prophet也会自动给我们提供预测值、实际值以及误差范围。</p><p id="3aa8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，黑色的虚线是实际的数据点，或者我们知道的实际股价。深蓝线是我们的模型预测的股票价格。浅蓝色阴影区域给出了误差范围。</p><p id="a20b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">prophet的另一个优点是它还提供了每周、每月、每年的趋势。内容如下:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lm"><img src="../Images/767a19415bbcdd6d6a7234d0c6bff169.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4Eeuq_oGQ6761CIBPmncuQ.png"/></div></div></figure><p id="f312" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">例如，根据该模型，在周二购买reliance的股票可能不是最好的主意，因为其价格往往在周二最高。此外，从月度趋势来看，我们观察到在4月份购买reliance股票可能是有益的，因为该月的价格往往是最低的。</p><h2 id="e94d" class="jc jd hh bd je jf jg jh ji jj jk jl jm ip jn jo jp it jq jr js ix jt ju jv jw bi translated">表演</h2><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es ln"><img src="../Images/1872316ecc0ccf9009dfa07740c29363.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qU7XBjXHhnQrhZQSSLLTpg.png"/></div></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lo"><img src="../Images/414cab34d766d7ca535e4ab7a50e24e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UUR_IJT0GyLmnItd_yrG8Q.png"/></div></div></figure><p id="6a1f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这里的点显示cv中每个预测的绝对百分比误差，而蓝线显示RMSE/MAPE(任一图表)，其中平均值取自点的10%(默认)的滚动窗口。</p><p id="8a9c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们看到，预测未来一个月的RMSE约为290，未来一年为450，在未来220天左右急剧增加到410–420。</p><p id="51c9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">类似地，对于未来一个月的预测，MAPE约为18%,对于一年后的预测，约为20%。</p><h1 id="7699" class="kt jd hh bd je ku kv kw ji kx ky kz jm la lb lc jp ld le lf js lg lh li jv lj bi translated">人工神经网络代码</h1><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lp"><img src="../Images/12ed0a954b51a10d2540fea6ff94811c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SFSfWXZKPcfkwzfoVnsLkQ.png"/></div></div><figcaption class="ko kp et er es kq kr bd b be z dx translated">神经网络工作的基本思想</figcaption></figure><p id="ff3f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">神经网络是一系列模拟人脑操作的算法，用来识别大量数据之间的关系。它们可以适应不断变化的输入，因此网络可以生成尽可能好的结果，而无需重新设计输出标准。神经网络在检测输入数据中的模式，然后产生无噪声的输出方面非常有效。其输出层收集隐藏层中所做的预测，并产生最终结果。</p><p id="1faa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于这个算法，我们将使用Keras，这是一个深度学习库，因为它在创建和部署模型时简单易用。</p><p id="2247" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据和数据探索过程保持不变，在模型拟合过程之前，我们必须<strong class="ig hi">标准化</strong>我们的数据。为什么？这是因为当我们遇到具有量值变化很大的特征的数据时，这是机器学习中的常见经验。因此，如果我们选择不对数据进行标准化或规范化，那么它们对我们模型的影响将与它们的大小成相同的比例分布。这是不可取的，因为它会导致有缺陷的模型。</p><p id="ea67" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">训练神经网络时，最重要的考虑因素之一是选择输入层和隐藏层中包含的神经元数量。由于输出层给出了结果，默认情况下它只包含1个神经元。根据研究，我知道输入层的神经元数量等于所考虑的特征数量+ 1，而隐藏层的神经元数量应该等于:</p><p id="3667" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">输入层的神经元数量:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lq"><img src="../Images/d26103f3b5e6429582097b9bd6c59745.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vmuC85xjjBLmWM06TtHq8g.png"/></div></div></figure><p id="5a17" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">隐藏层数:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lr"><img src="../Images/66dbd2c15d072dfcfca22f32c7b3ff2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_yrusLTRxHztvoyMVa5uQw.png"/></div></div></figure><p id="60f4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">根据拟合模型进行预测后，我们得到的结果如下:</p><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es ls"><img src="../Images/f081878539e52752cf52ff9403ca2af4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eR4ttL3T0oiPV6TvW3sdwg.png"/></div></div></figure><figure class="kd ke kf kg fd kh er es paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="er es lt"><img src="../Images/7456c081bcac05574f99f1dafc32ea56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7tSfnrurUUCYNAoEuh7vqA.png"/></div></div></figure><h1 id="fb83" class="kt jd hh bd je ku kv kw ji kx ky kz jm la lb lc jp ld le lf js lg lh li jv lj bi translated">结论</h1><p id="b6b1" class="pw-post-body-paragraph ie if hh ig b ih jx ij ik il jy in io ip jz ir is it ka iv iw ix kb iz ja jb ha bi translated">脸书先知和神经网络领域的庞大课题。在这个项目中，我只使用了NN和FbProphet的介绍性/基本概念。还有更先进的技术和模型可以部署。神经网络是非常计算密集型的，需要高效的计算机器和大型数据集。目前，围绕神经网络正在进行许多令人兴奋的研究。</p><p id="2fa4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">代码的链接是<a class="ae ks" href="https://github.com/OjasPandey99/Stock-Price-Predictor-.git" rel="noopener ugc nofollow" target="_blank">这里是</a>。</p><p id="2e63" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">谢谢你。</p></div></div>    
</body>
</html>