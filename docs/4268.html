<html>
<head>
<title>Implement a Face Recognition Attendance System with face-api.js — Part III</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用face-api.js实现人脸识别考勤系统—第三部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/implement-a-face-recognition-attendance-system-with-face-api-js-part-iii-4ed3ffc49479?source=collection_archive---------0-----------------------#2021-09-14">https://medium.com/analytics-vidhya/implement-a-face-recognition-attendance-system-with-face-api-js-part-iii-4ed3ffc49479?source=collection_archive---------0-----------------------#2021-09-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="6a82" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是关于代码实现的最后一集，上接<a class="ae jd" rel="noopener" href="/analytics-vidhya/implement-a-face-recognition-attendance-system-with-face-api-js-part-ii-4854639ee4c7">用face-api.js实现人脸识别考勤系统—第二部分</a>。对于这个应用程序，我将其命名为“Attendlytical ”,这是我从随机标题生成软件中选择的。由于代码复杂，我将主要关注人脸识别过程，而不是应用程序的整体功能。</p><p id="460a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们开始吧！</p><h1 id="aef7" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">数据库管理</h1><p id="4a11" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">首先，请到https://www.mongodb.com/<a class="ae jd" href="https://www.mongodb.com/" rel="noopener ugc nofollow" target="_blank">注册一个自由层账户，然后创建数据库集群。</a></p><p id="b48e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">MongoDB是一个非关系数据库，它以基于文档/类似JSON的结构管理数据。在数据库中，我们可以根据需要创建多个集合(在SQL中称为表)。</p><p id="f5d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我创建了一个名为“Attendlytical”的集群，如下所示。我们不需要在这里创建集合，因为数据库会自动为我们创建集合。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kh"><img src="../Images/0337858912d83361dc1757676ad6c960.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Y0xVOJrMnENirGmHPTqXw.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">MongoDB集群—attended lytical</figcaption></figure><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es kx"><img src="../Images/f217bc9767598e983a58442dad4239ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8adUcq62JCRT7UODL8JN6w.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">MongoDB集合示例</figcaption></figure><h1 id="50fe" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">代码实现</h1><p id="6b91" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">首先，我们需要一个依赖管理器，如NPM，纱等(我用NPM)。打开终端，然后使用命令“npx create-react-app client”创建ReactJS项目，然后使用“npm i face-api.js”安装api。</p><h2 id="eb25" class="ky jf hi bd jg kz la lb jk lc ld le jo iq lf lg js iu lh li jw iy lj lk ka ll bi translated"><strong class="ak">人脸识别实用功能准备</strong></h2><p id="9d99" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">所有选定的预训练模型都需要放在文件夹“public/models”中。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es lm"><img src="../Images/7002172bd27429841f388da40b9c3e6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*DUAzN_lt3U1ISGrOidZ-Vw.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">下载的预训练模型模型</figcaption></figure><p id="88cf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在“client/src/faceUtil/index.js”中，有一个函数<code class="du ln lo lp lq b">loadModels()</code>加载所有带参考路径的模型。模型文件或元数据文件<strong class="ih hj">的名称不能</strong> <strong class="ih hj">更改</strong>，因为API将匹配文件名并相应地加载模型。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es lr"><img src="../Images/a1d85c740804d895d61ad4c0c7e90168.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xQUvBHMwpu9j2AgBpLDL3Q.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">加载模型</figcaption></figure><p id="6464" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了确定模型是否已经被加载，我们可以从如下所示的API中检查参数变量是否被定义或为空值。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es ls"><img src="../Images/9af1b127169a13dddae595e09db93f5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iJwYY9vHuPdCamYKuBiGoQ.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">检查加载的模型参数</figcaption></figure><p id="c587" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于图像采集，使用<code class="du ln lo lp lq b">faceapi.fetchImage(blob)</code>函数将图像数据传入API。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es lt"><img src="../Images/622551dec31b11f8216f88021746dd96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*tEg9Zyohiq5O3ZWuTkAqew.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">图象采集</figcaption></figure><blockquote class="lu lv lw"><p id="9e0f" class="if ig lx ih b ii ij ik il im in io ip ly ir is it lz iv iw ix ma iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">设置SsdMobilenetv1选项进行人脸检测</em> </strong></p></blockquote><p id="c561" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于人脸检测任务，我们需要设置一个分数阈值来确定正负类之间的关系。人脸检测的得分阈值越高，检测越严格，结果越少，反之亦然。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es mb"><img src="../Images/cff17750f36b574e4377298778961410.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*IzhzG8haIR6zyVuLdoX2TA.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">人脸检测SSDMobileNetV1选项</figcaption></figure><blockquote class="lu lv lw"><p id="3a9a" class="if ig lx ih b ii ij ik il im in io ip ly ir is it lz iv iw ix ma iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">创建一个函数取图像源，并将其转换成128个特征向量</em> </strong></p></blockquote><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es mc"><img src="../Images/f504c6d5ba16b998006556d27c230d51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sc4KFWMpdgMizLZ2hhtvPw.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">获取完整描述函数</figcaption></figure><p id="c9c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">总体步骤</strong>:<code class="du ln lo lp lq b">faceapi.fetchImage(blob)</code>-&gt;-T1】</p><h2 id="e3cd" class="ky jf hi bd jg kz la lb jk lc ld le jo iq lf lg js iu lh li jw iy lj lk ka ll bi translated">人脸注册模块的实现</h2><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es md"><img src="../Images/3c6a9fbb71c518378a0a8b1c5a24a246.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_pG_JUst-w1_vdFG8t70Yw.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">人脸注册界面(学生版&gt;人脸数据部分)</figcaption></figure><p id="f9de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于面部注册模块，我为用户增加了2个选项(从网络摄像头/从磁盘上传)。为简单起见，我将只解释从网络摄像头上传选项，因为每个过程是相同的。</p><p id="d914" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们需要导入<code class="du ln lo lp lq b">react-webcam</code>来帮助我们从网络摄像头中获取视频帧。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es me"><img src="../Images/cd9e74040729413da141a54645f07783.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*j0qFBsuklOYcw3a5FmKGdw.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">导入React网络摄像头</figcaption></figure><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es mf"><img src="../Images/e8f719e71750c9a7cdb751d06a9ebebc.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*1W8_437mtNh8ICtfVeC1cQ.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">网络摄像头显示屏</figcaption></figure><p id="cbcd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><code class="du ln lo lp lq b">React.useEffect(callback, [dependencies])</code>是在检测到通过相关状态的一些变化后，在循环中运行的函数。</p><p id="3962" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用<code class="du ln lo lp lq b">React.useRef()</code>从所选的网络摄像头中进行了引用。<code class="du ln lo lp lq b">webcam.current.getScreenshot()</code>将返回当前帧的BLOB值。然后，我们使用创建的人脸识别效用函数<code class="du ln lo lp lq b">getFullDescriptions</code>来获得特征向量。如果第一手没有检测到面部，则不会生成任何特征向量。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es mg"><img src="../Images/a5bd44eb732411a203e2dc15968bace7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MqZ9UJ2yweTj8bKv_bB6ow.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">从网络摄像头获取视频帧的整体功能</figcaption></figure><p id="7808" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于这种情况，我们为每0.2秒更新一次视频帧的useEffect()设置了无限循环。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es mh"><img src="../Images/d2e536d39bfd289232cdce6ea55e3f91.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*9d-Unn2eLssaCQdFt4NQGg.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">每0.2秒更新检索到的视频帧</figcaption></figure><p id="0112" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">检索到视频帧后，用户可以将数据提交给服务器。为此，我们将使用来自Apollo React Hooks的<code class="du ln lo lp lq b">useMutation</code>。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es mi"><img src="../Images/b418e2b7ae6de0566801e4610e2a90e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*e_xE9wAq3l19D59jLoraeA.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">导入使用突变函数来运行GraphQL查询</figcaption></figure><p id="21fd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与REST API不同，GraphQL只有POST请求。因此，每个操作都需要发送查询供服务器处理。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es mj"><img src="../Images/1cd99917a97ded1b485fb3600d0cb758.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*eWiopLbxYaXB5MYt9t5o0Q.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">添加人脸照片突变查询</figcaption></figure><p id="5349" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，查询被传递给<code class="du ln lo lp lq b">useMutation()</code>函数。<code class="du ln lo lp lq b">addFacePhotoCallback()</code>是点击提交按钮时调用的函数。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es mk"><img src="../Images/e7e0565be41123488b5d894ccd155e3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*icSzRiyNZcUMEpcMNuMcUQ.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">GraphQL变异函数</figcaption></figure><p id="54b8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于特征向量是Float32Array数据类型，我们需要将它转换成字符串保存到数据库中，以便于读取。成功上传后，将显示“添加面部照片成功”的消息，并刷新数据集图库。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es ml"><img src="../Images/54bc22d4a5fd9c5cd504c31290654a95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*9sLJjvyMVhj5p5cXZOZfuw.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">触发添加照片突变的回调函数的函数</figcaption></figure><blockquote class="lu lv lw"><p id="2c02" class="if ig lx ih b ii ij ik il im in io ip ly ir is it lz iv iw ix ma iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">大图人脸注册处理</em> </strong></p></blockquote><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es mm"><img src="../Images/f7d2ec8b68106d4b3b981c80c7e564cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*PBj0SByEGeovw9pnmM5auw.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">人脸注册步骤</figcaption></figure><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es mn"><img src="../Images/db1e937e95f1257ac87771d40d3675dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K-4L4-DnfJ-s3zvKWUQSbQ.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">面部注册过程的大图</figcaption></figure><h2 id="f587" class="ky jf hi bd jg kz la lb jk lc ld le jo iq lf lg js iu lh li jw iy lj lk ka ll bi translated">人脸匹配模块的实现</h2><blockquote class="lu lv lw"><p id="1879" class="if ig lx ih b ii ij ik il im in io ip ly ir is it lz iv iw ix ma iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">人脸匹配选项</em> </strong></p></blockquote><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es mo"><img src="../Images/678f75ff4fe6817d285e27dc5fce2eaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*-OWjhhEAexEyv9RTCjCx3g.png"/></div></figure><p id="2d7a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请参考“client/src/faceUtil/index.js”第61行，有一个名为匹配阈值的变量。我将阈值设置为0.45，正如上一集所解释的那样，这是一个非常严格的阈值，您可以通过反复试验来找到适合您需求的阈值。</p><p id="1211" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">确定阈值的两种可能情况:</strong></p><p id="2e24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">a.阈值越高，获得的结果越多，但是如果阈值太松(&gt; 0.6)，对于未知数据集，可能容易出现<strong class="ih hj">假阳性情况。</strong></p><p id="973a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">b.阈值越低，获得的结果越少，但是如果阈值太严格(&lt; 0.3)，则对于已知数据集可能倾向于<strong class="ih hj">假阴性情况。</strong></p><p id="6fe8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当数据被提取到客户端时，我们需要将person的每个特征向量字符串转换为Float32Array数据类型。<code class="du ln lo lp lq b">faceapi.LabelFaceDescriptors (Face_ID, List_of_Feature_Vectors)</code>用于传递给<code class="du ln lo lp lq b">faceapi.FaceMatcher(labelledDescriptors, matching_threshold)</code>以使用欧几里德距离(L2)算法找到最佳匹配。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es mp"><img src="../Images/b8f4c252c9f4b600b342d5d12c58a113.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d_Ww4H1S9cFXDh04YYwtuQ.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">人脸匹配功能</figcaption></figure><blockquote class="lu lv lw"><p id="83b7" class="if ig lx ih b ii ij ik il im in io ip ly ir is it lz iv iw ix ma iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">人脸匹配流程</em> </strong></p></blockquote><p id="4bfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们需要使用查询从服务器获取课程中所有参与者的面部数据集。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es mq"><img src="../Images/5b771f4378a6f72c39114c37f8b03b89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*MztCgoFbdL_vwNXgWFQnnQ.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">获取数据集</figcaption></figure><p id="56b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">获取数据集的相应查询如下所示。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es mr"><img src="../Images/3210bb867317bb966adef6496bc76966.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*zOsQNHW8jtaUcHFAW7fr2w.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">正在提取数据集查询</figcaption></figure><p id="8acf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">然后，与人脸注册一样，我们需要使用网络摄像头从视频帧中检测人脸以生成128D特征向量。每个特征向量都被传递给<code class="du ln lo lp lq b">drawRectAndLabelFace(detected_feature_vectors_list, face_matcher, participant_list_full_information, context)</code>。神奇的事情发生在<code class="du ln lo lp lq b">faceapi.FaceMatcher(labelledDescriptor, threshold).<strong class="ih hj">findBestMatch(detector_feature_vectors)</strong></code>中，用L2距离最近的学生的名字和学号在脸上做标记。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ms"><img src="../Images/8ec1d0b975cdd8b2255b113f35d02bdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mcDCGOYVTg7zDdHwDHlZxg.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">每0.2秒检测和识别一次面部循环功能</figcaption></figure><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es mt"><img src="../Images/58a5e53b953e5a336215b271fd05adb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yKg0nRvQcbmHpehtn7A2cA.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated"><code class="du ln lo lp lq b">Trigger drawing function and saving the transaction of the recognized face into database</code></figcaption></figure><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es mu"><img src="../Images/53fd6ee06b9a30f7b8054722235cc8a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_zbK5anjFQW_t7pGEBc4RQ.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">绘制并标记已识别的人脸</figcaption></figure><blockquote class="lu lv lw"><p id="faa3" class="if ig lx ih b ii ij ik il im in io ip ly ir is it lz iv iw ix ma iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">将考勤交易(trx)存入数据库</em> </strong></p></blockquote><p id="f714" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们已经标记了被认可的学生，下一步我们需要将事务存储到数据库中。如果检测到的标签不是“未知”的情况，我们希望使用<code class="du ln lo lp lq b">createTrxCallback()</code>将相应的出勤ID和学生ID存储到数据库中，并使用2个变量将数据传递给服务器。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es mv"><img src="../Images/9f7ae5ba9f54a8649525c71dd92efef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PKWk8XjetOjyqwjzP9zvuA.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">创建事务处理回调</figcaption></figure><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es mw"><img src="../Images/f3b4f0c26d2fdc9cda4bfe172d75581d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z5sSF6FKR9kaawR9oIULVg.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">创建事务变异</figcaption></figure><p id="fcd2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">相应的创建trx突变查询如下所示。</p><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es mx"><img src="../Images/ef1903f18ac16b8500f10b37aedf0d03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*zpTb49IeX0yMgy40ib8dgg.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">创建事务处理变异查询</figcaption></figure><blockquote class="lu lv lw"><p id="d690" class="if ig lx ih b ii ij ik il im in io ip ly ir is it lz iv iw ix ma iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="hi">大图人脸匹配流程</em> </strong></p></blockquote><figure class="ki kj kk kl fd km er es paragraph-image"><div class="er es my"><img src="../Images/443b9f22da7b42def107e1cb174bac6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*kjsRa0X0l-7cBbrXDzwsnA.png"/></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">人脸匹配步骤</figcaption></figure><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es mz"><img src="../Images/170875a947c7221cd5379a3d1c1f1064.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2kF4nN7Nrh58wP_u8clzfw.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">人脸匹配模块大图</figcaption></figure><h1 id="4f6a" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">用户界面</h1><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es na"><img src="../Images/54e94260849d826e07f42ee90f2be76b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jo-Dx2hx-w8_d7wMm1wW2A.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">面部数据页面(面部注册)</figcaption></figure><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es nb"><img src="../Images/b7b9bf55f30473911085ee64eca31dce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F22Kv7YrlghRJEF8Gwk8KA.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">考勤室页面(人脸匹配)</figcaption></figure><figure class="ki kj kk kl fd km er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es nc"><img src="../Images/b18f55e03402aab1a5b022e792c1c738.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T5mhVDanntKYmIq-zKHA8w.png"/></div></div><figcaption class="kt ku et er es kv kw bd b be z dx translated">考勤记录</figcaption></figure><h1 id="cda1" class="je jf hi bd jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb bi translated">结论</h1><p id="3d4b" class="pw-post-body-paragraph if ig hi ih b ii kc ik il im kd io ip iq ke is it iu kf iw ix iy kg ja jb jc hb bi translated">我想我已经介绍了很多实现方法，代码相当混乱，因为系统中涉及了很多模块。因此，我将更多地关注人脸识别，并解释人脸注册和人脸匹配的简化流程。</p><p id="1c03" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">请看一下我的Github库:<a class="ae jd" href="https://github.com/CodeShareCW/Attendlytical" rel="noopener ugc nofollow" target="_blank">https://github.com/CodeShareCW/Attendlytical</a>代码参考。</p><p id="9cf0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">另外，如果你对整个系统感兴趣，请看看https://attendlytical.netlify.app/<a class="ae jd" href="https://attendlytical.netlify.app/" rel="noopener ugc nofollow" target="_blank">的应用程序。</a></p></div></div>    
</body>
</html>