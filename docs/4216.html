<html>
<head>
<title>Classifying COVID-19 X-ray images</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">新冠肺炎X射线图像的分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/classifying-covid-19-x-ray-images-b8757fa48dc?source=collection_archive---------2-----------------------#2021-09-09">https://medium.com/analytics-vidhya/classifying-covid-19-x-ray-images-b8757fa48dc?source=collection_archive---------2-----------------------#2021-09-09</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/629aeff4ab0944762d0b183a83908486.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*7kp3-5wHDRV7LDckR7zBlw.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">胸部x光图像</figcaption></figure><p id="f31e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">你能猜出上面这张x光照片是属于有还是没有新冠肺炎的人吗？老实说，我不知道。但是今天，让我们创建一个CNN模型，它能够对这些x光图像进行分类！</p><p id="2f27" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们开始吧！</p><p id="c2ae" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">这里是我得到数据集的地方。我已经向<a class="ae jn" href="https://github.com/priyavrat-misra/xrays-and-gradcam" rel="noopener ugc nofollow" target="_blank">推荐了这个项目的</a>。</p><p id="71f6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">数据集被分成训练集、测试集和验证集。对于测试和验证数据集，将使用来自每个类别的60幅图像。数据集中有4类:正常、病毒性肺炎、COVID和肺部阴影。</p><p id="9500" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">对创建的数据集进一步进行图像增强。根据预训练模型的要求，所有图像的大小都调整为224*224。另外，对随机图像进行水平翻转。最后，由于将使用在Imagenet上预先训练的模型，因此使用Imagenet的平均值和标准偏差对数据集进行标准化。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es jo"><img src="../Images/908b2f992ecc5f50a40a14012b9ba488.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*yiC0cJgfvw4CSTTCsfU0dg.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">图像增强</figcaption></figure><p id="42d3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用pytorch ImageFolder函数，将数据扩充应用于数据集。这里还定义了一个数据加载器，批量大小为20，2个加载器工作线程和图像混洗等于真。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es jt"><img src="../Images/f168784a20978b4788a46c5b9e5b033a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*qQ_e-9FZCTHpqfW4hY6hcw.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">图像加载器</figcaption></figure><p id="f387" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在我们继续之前，让我们进一步探索我们的数据集。</p><h2 id="ca43" class="ju jv hh bd jw jx jy jz ka kb kc kd ke ja kf kg kh je ki kj kk ji kl km kn ko bi translated">数据探索</h2><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es kp"><img src="../Images/fd4f1a2a0f0c4fe0e9bccaab15b53cf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*2Ib6W3qtTOdyC6vaMRUMnQ.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">数据集中的类的数量</figcaption></figure><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es kq"><img src="../Images/390d05356e08d0b904fbf7bd623d828e.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*o1NbqgFl9ic5i8qbhqxrbw.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">每个数据集中的图像数量</figcaption></figure><p id="bf75" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在上一节中，我们描述了如何对数据集应用增强。在这里，我们创建一个情节来形象化他们。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es kr"><img src="../Images/8a1c171a9270669ef6965e61df8199eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*V1QAZkrgNYv6SUuU459uVQ.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">绘制增强图像</figcaption></figure><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es ks"><img src="../Images/1616150e5663ddc3c97c9d3f993716da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*q5knNikxlKtokZ7wG7b4OA.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">增强图像</figcaption></figure><p id="3546" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了进一步研究数据集，我们创建了一个频率计数函数，该函数计算每个类的图像数量。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es kt"><img src="../Images/694dc9cd1c124c08ca9d6b63e86a2a55.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*e1miGUtsi-RCKUXF3bHgdg.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">计算每个类别中每个图像的频率</figcaption></figure><p id="1ac8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">如下面的结果所示，验证和测试数据集具有来自每个类的相同数量的图像。另一方面，对于训练数据集，可以观察到类别不平衡。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es ku"><img src="../Images/20f6ce84c5809f40b1b4ded977148e30.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*RZXtYFKOPtEI5gFJZV4f1g.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">频率计数结果</figcaption></figure><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es kv"><img src="../Images/c8dc28fef0884b30755f4ee717b668d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*g6PNgTvJLAwBZofHcO7C3A.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">胸部x光片数量与级别</figcaption></figure><p id="0ba4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们创建一些可以在下游过程中帮助我们的函数。</p><p id="b139" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">以下函数获取正确预测的标签总数。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es kw"><img src="../Images/4b001c884ecef60d8c5afd52531662b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*zvi-fMMY86EGkD6cN5Q6ug.png"/></div></figure><p id="898c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">以下函数检索所有样本的预测。该函数对来自数据加载器的批进行迭代，每个批的结果将连接到一个预测张量，该张量定义为all_preds，将返回给调用者。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es kx"><img src="../Images/702a0589011e6c1d338095f69de87398.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*W_wK2bZXbBzoFeQ6BQ--aQ.png"/></div></figure><p id="3ff6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">该函数基于标签和预测生成混淆矩阵。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es ky"><img src="../Images/a52bace951cf434f90ab9d885d01f238.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*OwGNsIiP7Cz9TCTpXzxFaQ.png"/></div></figure><p id="d582" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">以下函数使用混淆矩阵得出的结果计算真阳性、真阴性、假阳性和假阴性。从这里，可以导出诸如准确度、召回率、精确度和F1分数之类的评估指标。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/ce6883ae3bac3ff842f8ae8f25cdbfce.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*VNnfhaJ5YAG8d5EquuI6Nw.png"/></div></figure><p id="6c58" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">创建以下函数来训练我们的预训练模型。model.train()在训练阶段将模型设置为训练模式。在评估阶段使用model.eval()。由于批量归一化在训练和评估阶段表现不同，因此有必要设置模型的模式。在训练阶段，zero_grad()用于在反向传播之前将梯度归零。这样做是因为Pytorch在随后的反向传递中累积梯度，在下面表示为loss . backward()(Anon，2021)。Torch.no_grad()减少了内存使用，从而提高了计算效率。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es la"><img src="../Images/728cee84a45be8a32945c0b4a8444720.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*4VEQcE1yY2qyxUzvL13s6A.png"/></div></figure><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es lb"><img src="../Images/3a9d1e4f339f82bfeed589234861c5d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*NlaOkT9-S6bI4H_rTwdpuQ.png"/></div></figure><p id="48b9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">由于训练模型所需的时间可能很长，因此定义了一个检查点，每当验证损失降低时，该检查点都会保存模型。此外，训练期间的运行结果也将被保存，以备将来绘图。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es lc"><img src="../Images/46b1b0a2b936e0a3f77344679957573b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*mvdOUf2BY8wFzln3VfAJLQ.png"/></div></figure><p id="8fbc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">np.random倾向于为每个数据批次生成相同的随机数。为了确保每个数据批次的随机性，定义了一个worker init函数。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es ld"><img src="../Images/296e54d36acad6f2af17d0ac36438171.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*-HKi7gCE5HYu59dWd37t4A.png"/></div></figure><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es le"><img src="../Images/7502bbd3d34d7c577fa502289b6e7503.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*WueXDSd-EfebNGVwArEVYw.png"/></div></figure><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lf"><img src="../Images/e7a6455c18b96cab697471e2ef5e6342.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*eayNLu-fIH6EsFXmyreQ3A.png"/></div></div></figure><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es lk"><img src="../Images/a0c6e44b669c19e2c26fc48435be7742.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*6ryxeLLLX09-mb90d3uD-w.png"/></div></figure><p id="2f00" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">好吧！我们现在准备训练模型！</p><h2 id="2842" class="ju jv hh bd jw jx jy jz ka kb kc kd ke ja kf kg kh je ki kj kk ji kl km kn ko bi translated">训练模型。</h2><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es ll"><img src="../Images/d1401d34c69117f79cdb78b56bcab430.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*QYpI5k3HKGrRn4em3S4hUQ.png"/></div></figure><p id="6b46" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用WeightedRandomSampler()是因为存在类不平衡数据集。该函数为所有类别提供了相等的概率。首先定义类别权重，然后创建样本权重。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es lm"><img src="../Images/2463c5ea1285600346970aa8e927974f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*srTbe300X_a8LcoYkglRYQ.png"/></div></figure><p id="0cb3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">模型将被训练25个时期，并使用交叉熵作为我们的损失函数。交叉熵损失是多类分类的类别交叉熵损失。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es ln"><img src="../Images/cbc474bb47258c3f1da10c3a7ae35111.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*XSsSI67Hjk1TMc6-T9Wwhg.png"/></div></figure><p id="0d11" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">由于这些预训练的模型将被微调，因此必须更新全连接层，即特征提取层。以前，在ImageNet上训练这些模型时，定义了1，000个类。对于这个项目，out_features将被定义为4个类。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es lo"><img src="../Images/893707a2e348b8ceefafe75867bf51de.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*_8tQjlNZlr5wQMWaKDJ7YQ.png"/></div></figure><p id="4766" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">然后用Adam优化和0.0001的学习率来训练模型。所有4个型号都将重复类似的步骤。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es lp"><img src="../Images/04f10cb523d051f46966ee3afe66810a.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*hAexHu6FmZpgiLfFvzURxA.png"/></div></div></figure><p id="4e8e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我花了大约30分钟——每个模型1小时，在Colab的GPU上运行。Densenet121在4款中耗时最长。</p><p id="3cdc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为了进一步提高我们的结果，让我们进一步调整我们的学习速度。</p><h2 id="ef33" class="ju jv hh bd jw jx jy jz ka kb kc kd ke ja kf kg kh je ki kj kk ji kl km kn ko bi translated">调整和验证</h2><p id="b0a2" class="pw-post-body-paragraph ip iq hh ir b is lq iu iv iw lr iy iz ja ls jc jd je lt jg jh ji lu jk jl jm ha bi translated">根据上述模型的结果，Densenet121是性能最好的模型。这将在接下来的结果部分中显示。然而，为了进一步改进模型，创建了学习调度器，以每3个时期将每个参数的学习速率衰减0.1伽马(1029次迭代* 3 = 3147次迭代)。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es lv"><img src="../Images/2d1476f3954ec7b42543c02d81eb3ba4.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*sMZT__Bz7TAl_Kvwlv79sA.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">densenet121的学习率计划程序</figcaption></figure><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es lw"><img src="../Images/29d8cd27ef83dfd0c3b66dd7425e41cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*JpzjONtu0fyLRhCFXTcOag.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">resnet18的学习率计划程序</figcaption></figure><p id="3afb" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Plot_summary函数定义为绘制训练和验证数据集的准确度和损失。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es ks"><img src="../Images/e50e4ec95a0503ec15bba65f53223d47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*XkdmMfHiIkf_IuvIviodhg.png"/></div></figure><p id="492e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Plot_confmat函数定义为绘制训练和测试数据集中预测结果与实际结果的混淆矩阵。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es lx"><img src="../Images/57164bf23e4c6d9852cf6c167383bce1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*k6aY9m65_YIQTzsTL2Mhlw.png"/></div></figure><h2 id="60e9" class="ju jv hh bd jw jx jy jz ka kb kc kd ke ja kf kg kh je ki kj kk ji kl km kn ko bi translated">结果评估</h2><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es ks"><img src="../Images/3b87994d211b4286d5575166c3b4ad1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*yxAxzWDEa1TsSWo4jKYDnA.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">Densenet121</figcaption></figure><p id="4bc1" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">最低的验证损失0.064216是在第6时段。随着时代数量的增加，我们看到随着验证损失的增加，模型开始过度拟合。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es lx"><img src="../Images/cd46626306c30973e1a6a0904eed7e56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*iinTr3zcXnxsAeNgdtnFQg.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">Densenet121混淆矩阵</figcaption></figure><p id="c74d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Densenet121可以分别对60/60 COVID和病毒性肺炎图像进行分类。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es ks"><img src="../Images/62c291455d92223ad1ba44d794b75fa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*-cPKoWd27MfpSHju1QtzHw.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">带学习率调度器的Densenet121</figcaption></figure><p id="d41d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">具有学习率调度器的Densenet121模型的验证损失在时期13处最低。尽管最低的验证损失0.065519与没有学习率调度器的Densenet121模型相比略高，但是可以观察到，与没有学习率调度器的先前模型相比，该模型具有更好的推广性。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es ly"><img src="../Images/4bb2ba15d0d5926f2897db702424ca2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*tjvbBOkOh774U2FSzfALmA.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">带lr_scheduler混淆矩阵的Densenet121</figcaption></figure><p id="b8dc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">带lr_scheduler的Densenet121可以对60/60的病毒性肺炎图像进行分类。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es ks"><img src="../Images/518636566f2a1217dabeff1adbbb5939.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*awMKy-nbxPzpdrDfg1dlJw.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">Resnet18的运行损耗和精度</figcaption></figure><p id="b0a6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">验证损失在时期6最低，为0.064792。随着时期数的增加，可以观察到过度拟合。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es ly"><img src="../Images/a81db52519ced321972b026b1983daa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*6X8Hqx_9vVgaDOXp7pQ_Hg.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">Resnet18混淆矩阵</figcaption></figure><p id="aa40" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Resnet18在对病毒性肺炎图像进行分类时表现良好。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es ks"><img src="../Images/038cae7c99b562df74d7bae94e45adf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*xXjvYAOlM_UwLUV-LoUSeA.png"/></div></div><figcaption class="il im et er es in io bd b be z dx translated">带lr_scheduler的Resnet18的运行损耗和精度</figcaption></figure><p id="3b0a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">具有学习率调度器的Resnet18模型的验证损失在时期19处最低。尽管最低的验证损失0.069836与没有学习率调度器的Resnet18模型相比略高，但是可以观察到，与没有学习率调度器的先前模型相比，该模型具有更好的推广性。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es ks"><img src="../Images/2083a472d04ff3090b69730780bddf7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*NQ4mRO_2SuKg7-vKXotN3Q.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">带lr_scheduler的Resnet18的混淆矩阵</figcaption></figure><p id="11ef" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">带有lr_scheduler的Resnet18在对COVID和病毒性肺炎进行分类时表现出良好的性能。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es ks"><img src="../Images/d02fac2ed852776e4b543ec61a040ad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*QmUURMYJUHEtlLBDxFr1Gw.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">挤压网的运行损耗和精度</figcaption></figure><p id="6657" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Squeeznet的最低验证损失在第24时段为0.117238。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es ly"><img src="../Images/c343e77b3d43c3803bb7a64abc26b8ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*mh3kVD5ixpAGbwlY3ZIAEQ.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">Squeezenet混淆矩阵</figcaption></figure><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es ks"><img src="../Images/ddc9e2d33e6e966cbbdf664696d6b4c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*XXkughgx0cSd2yg9EH-VaQ.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">Resnet50的运行损耗和精度</figcaption></figure><p id="80cd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Resnet50的最低确认损失在第11时段为0.078578。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es lz"><img src="../Images/91224ddbcce91529591d1729e19325f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*MvbWOAB7P-iaaX3tR7E37Q.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">Resnet50混淆矩阵</figcaption></figure><p id="2d1f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Resnet50在对病毒性肺炎图像进行分类时表现良好。</p><h2 id="0844" class="ju jv hh bd jw jx jy jz ka kb kc kd ke ja kf kg kh je ki kj kk ji kl km kn ko bi translated">可视化和批判性分析</h2><p id="c920" class="pw-post-body-paragraph ip iq hh ir b is lq iu iv iw lr iy iz ja ls jc jd je lt jg jh ji lu jk jl jm ha bi translated">为了更好地理解图像中的哪个部分在分类期间影响模型的决策，将实施Grad-CAM。</p><p id="556b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">apply_mask是一个从遮罩创建热图并合成GradCAM图像的函数。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es lo"><img src="../Images/52ff49673856d7c1b3f64f88acd2e81b.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*SV9OJj4b6YV1MMS9nOZujw.png"/></div></figure><p id="c8ef" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">使用生成的GradCAM图像，plot_gradcam用于绘制每个类的gradcam图像。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es ma"><img src="../Images/acc02f717e8f8e2b0dc95999a3b31765.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*EFTZY_W6Lu5hFDprmmZU3Q.png"/></div></figure><p id="f480" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">注册向前和向后挂钩，以存储该层的向前过程(激活)和向后过程(渐变)。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es mb"><img src="../Images/ee3bf5f49ca266d41673559a72eb1194.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*4n_s3Wuz-L1w0NBuv2dvgw.png"/></div></figure><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es mc"><img src="../Images/304a86695a0a0bc4a57a6107d8fbc005.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*3Io-EQGQhttvNTXLYWgkHw.png"/></div></figure><p id="b238" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">下图显示了每个模型如何做出分类决策。</p><figure class="jp jq jr js fd ii er es paragraph-image"><div class="er es ks"><img src="../Images/098609777efbdf42608b7d8149f67036.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*ZAbKUD9fwPxY4LecaRsFNQ.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">使用GradCAM定位</figcaption></figure><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es md"><img src="../Images/39516de07e9481bf35a33fe21b366abe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W9QtofY0BtQxFbw_0GDF_g.png"/></div></div><figcaption class="il im et er es in io bd b be z dx translated">评估新冠肺炎图像的结果</figcaption></figure><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es me"><img src="../Images/e7f3ec7abf6ee0c1fa11f46f9e5e9fee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OGq-SwREUyYXCK_ScXisew.png"/></div></div><figcaption class="il im et er es in io bd b be z dx translated">评估肺部阴影图像的结果</figcaption></figure><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es mf"><img src="../Images/f05a075d3d1f02854dc00cb41d81e5e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_O8Yp5J06T0AnDkUDh3uVA.png"/></div></div><figcaption class="il im et er es in io bd b be z dx translated">评估正常图像的结果</figcaption></figure><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es mg"><img src="../Images/0aefaf09161d52b93f08af22c58f1eca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QlZqgujhFYYEbIlqLA7C2Q.png"/></div></div><figcaption class="il im et er es in io bd b be z dx translated">评估病毒性肺炎图像的结果</figcaption></figure><figure class="jp jq jr js fd ii er es paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="er es mh"><img src="../Images/dcdf633d8ff076ff95ca363e2aaa8293.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xp2dHMFVMflffzwbGv257A.png"/></div></div><figcaption class="il im et er es in io bd b be z dx translated">所有型号的性能总结</figcaption></figure><p id="1033" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在本节中，将进一步评估每个模型的性能。根据准确度、召回率、精确度和F1分数等评估指标，Densenet121和Resnet18以及lr_scheduler在新冠肺炎影像分类中表现出了出色的性能。对于肺部不透明和正常图像，带lr_scheduler的Densenet121优于其他模型。最后，多种模型在病毒性肺炎图像分类中表现出良好的性能。分别是，带lr_scheduler的Densenet121、Resnet18、带lr_scheduler的Resnet18和Resnet50。</p><p id="5cb7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">完整的项目可以在这里找到<a class="ae jn" href="https://github.com/gyiernahfufie/Classifying-COVID-X-Rays" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="1a55" class="mi jv hh bd jw mj mk ml ka mm mn mo ke mp mq mr kh ms mt mu kk mv mw mx kn my bi translated">参考</h1><p id="8158" class="pw-post-body-paragraph ip iq hh ir b is lq iu iv iw lr iy iz ja ls jc jd je lt jg jh ji lu jk jl jm ha bi translated">无名氏(2018)。<em class="mz"> np.random为每个数据批次#5059 </em>生成相同的随机数。【在线】。2018.github。可从:<a class="ae jn" href="https://github.com/pytorch/pytorch/issues/5059#issuecomment-817392562." rel="noopener ugc nofollow" target="_blank">https://github . com/py torch/py torch/issues/5059 # issue comment-817392562获取。</a>【访问时间:2021年8月26日】。</p><p id="96d4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">无名氏(2021)。<em class="mz">在Pytorch </em>中将渐变归零。【在线】。2021.Pytorch。可从以下网址获得:<a class="ae jn" href="https://pytorch.org/tutorials/recipes/recipes/zeroing_out_gradients.html." rel="noopener ugc nofollow" target="_blank">https://py torch . org/tutorials/recipes/recipes/zeroing _ out _ gradients . html</a>【访问日期:2021年8月26日】。</p><p id="8a36" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">因卡威奇，n .(未标明)。<em class="mz">微调火炬视觉模型</em>。【在线】。可从以下网址获取:<a class="ae jn" href="https://pytorch.org/tutorials/beginner/finetuning_torchvision_models_tutorial.html." rel="noopener ugc nofollow" target="_blank">https://py torch . org/tutorials/beginner/fine tuning _ torch vision _ models _ tutorial . html</a></p><p id="e36d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">Minaee，s .，Kafieh，r .，Sonka，m .，Yazdani，s .和Jamalipour Soufi，G. (2020年)。Deep-COVID:使用深度迁移学习从胸部X射线图像预测新冠肺炎。<em class="mz">医学图像分析</em>。65.</p><p id="4bc5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">普里亚弗拉特，M. (2021)。<em class="mz">胸片分类和基于梯度的定位</em>。【在线】。2021.Github。可从:<a class="ae jn" href="https://github.com/priyavrat-misra/xrays-and-gradcam." rel="noopener ugc nofollow" target="_blank">https://github.com/priyavrat-misra/xrays-and-gradcam</a></p><p id="abb9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">t .拉赫曼(2021年)。<em class="mz">新冠肺炎射线照相数据库</em>。【在线】。2021.可从:<a class="ae jn" href="https://www.kaggle.com/tawsifurrahman/covid19-radiography-database." rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/tawsifurrahman/covid 19-radiography-database获取。</a></p></div></div>    
</body>
</html>