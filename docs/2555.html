<html>
<head>
<title>Chest X-Rays Image Captioning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">胸部x光图像字幕</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/chest-x-rays-image-captioning-70abb55d41c4?source=collection_archive---------4-----------------------#2021-05-02">https://medium.com/analytics-vidhya/chest-x-rays-image-captioning-70abb55d41c4?source=collection_archive---------4-----------------------#2021-05-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="3073" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用胸部x光预测结果</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/4a847b3b7c0c73fd4d269b7fa05cff79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*B1N6KiAE3YgxUMOzLhU6Cg.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated"><a class="ae jo" href="https://evergreen.team/assets/images/articles/machine-learning/image_generator.png" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><h1 id="74c2" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">目录</h1><ol class=""><li id="ed6f" class="kn ko hh ig b ih kp il kq ip kr it ks ix kt jb ku kv kw kx bi translated">介绍</li><li id="7154" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ku kv kw kx bi translated">商业问题</li><li id="73cc" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ku kv kw kx bi translated">问题到ML问题的映射</li><li id="e247" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ku kv kw kx bi translated">性能指标和业务约束</li><li id="ed01" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ku kv kw kx bi translated">现有解决方案和方法</li><li id="31da" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ku kv kw kx bi translated">探索性数据分析</li><li id="43c1" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ku kv kw kx bi translated">特征工程</li><li id="8ff3" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ku kv kw kx bi translated">建模和评估</li><li id="6ac7" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ku kv kw kx bi translated">丰富</li><li id="c24f" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ku kv kw kx bi translated">链接</li><li id="42da" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ku kv kw kx bi translated">参考</li></ol><h1 id="b4a4" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">1.简介:</h1><p id="fb42" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip ld ir is it le iv iw ix lf iz ja jb ha bi lg translated"><span class="l lh li lj bm lk ll lm ln lo di"> I </span>图像字幕是基于图像生成文本(字幕)的过程。图像字幕使用自然语言处理(NLP)和计算机视觉(CV)来生成文本输出。x射线是一种电磁辐射，用于医学成像。x光可以用来发现骨折、骨伤或任何肿瘤。分析X射线报告是放射科医生和病理学家的一项非常重要的任务，以向患者推荐正确的诊断。</p><h1 id="eda3" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">2.业务问题:</h1><p id="7541" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated">该数据集可从以下网址获得。</p><p id="4052" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">PNG图像:</p><div class="lp lq ez fb lr ls"><a href="http://academictorrents.com/details/5a3a439df24931f410fac269b87b050203d9467d" rel="noopener  ugc nofollow" target="_blank"><div class="lt ab dw"><div class="lu ab lv cl cj lw"><h2 class="bd hi fi z dy lx ea eb ly ed ef hg bi translated">印第安纳大学-胸透(PNG图片)</h2><div class="lz l"><h3 class="bd b fi z dy lx ea eb ly ed ef dx translated">@article{，title = {印第安纳大学-胸透(PNG图片)}，关键词= {放射学，胸透}，作者=…</h3></div><div class="ma l"><p class="bd b fp z dy lx ea eb ly ed ef dx translated">academictorrents.com</p></div></div><div class="mb l"><div class="mc l md me mf mb mg ji ls"/></div></div></a></div><p id="1879" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">XML报告:</p><div class="lp lq ez fb lr ls"><a href="http://academictorrents.com/details/66450ba52ba3f83fbf82ef9c91f2bde0e845aba9" rel="noopener  ugc nofollow" target="_blank"><div class="lt ab dw"><div class="lu ab lv cl cj lw"><h2 class="bd hi fi z dy lx ea eb ly ed ef hg bi translated">印第安纳大学-胸部x光检查(XML报告)</h2><div class="lz l"><h3 class="bd b fi z dy lx ea eb ly ed ef dx translated">来自印第安纳大学医院网络的1000份胸部x光影像放射学报告。</h3></div><div class="ma l"><p class="bd b fp z dy lx ea eb ly ed ef dx translated">academictorrents.com</p></div></div><div class="mb l"><div class="mh l md me mf mb mg ji ls"/></div></div></a></div><p id="49a4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个特殊的案例研究中，我们得到了一组图像(胸部x光)和放射科医生从这些图像中推断出的印象。</p><p id="ab7a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们必须开发和训练一个模型，该模型基于以图像格式提供的胸部X射线和发现以及以XML格式提供的一些其他数据来生成印象。</p><p id="5a40" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这种类型的模型可以为放射科医生节省大量分析报告和给出印象的时间。此外，该模型可以用作验证某些决策的基础模型，因为与其他领域不同，医疗领域的错误成本非常高。</p><h1 id="e4cf" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">3.问题到ML问题的映射:</h1><p id="8d44" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated">在这个案例研究中，我们要解决的问题是医学图像字幕或报告生成。</p><p id="99e4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">基本上，我们必须从头开始使用卷积神经网络(CNN)或使用迁移学习(最好是因为我们的数据量较少)从图像中提取特征(瓶颈)特征。然后使用这些提取的特征来预测字幕。输出将是一个单词序列。</p><h1 id="c7d9" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">4.性能指标和业务限制:</h1><p id="ab60" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated">不同n-gram(1，2，3，4…)的BLEU分数在顺序输出模型的情况下是一个很好的度量。</p><ul class=""><li id="ea50" class="kn ko hh ig b ih ii il im ip mi it mj ix mk jb ml kv kw kx bi translated">可解释性相当重要。</li><li id="9307" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ml kv kw kx bi translated">没有延迟限制。</li><li id="6d47" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ml kv kw kx bi translated">由于医疗领域的错误成本非常高，该模型的预测应该非常好。即使尝试了不同的架构，数据越多，模型的性能越好。</li></ul><h1 id="1e98" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">5.现有解决方案和方法:</h1><p id="b96f" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated"><strong class="ig hi">美国有线电视新闻网关于x光的预培训:</strong></p><p id="1ec1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了从图像中提取特征，我们有多个预先训练好的网络(模型),如Vgg16、EfficientNet等。接受过各种图像的训练。CheXNet是一个121层的CNN，在ChestX-ray14上训练，包含超过1个lakh正面视图X射线图像。经过训练后，它在识别14种疾病方面比放射科医生表现得更好。由于我们正在解决的问题也包含类似类型的图像，预训练的CheXNet可以用于从X射线中提取特征。</p><p id="13aa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">贪婪搜索和波束搜索解码器:</strong></p><p id="a892" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于在解码器端生成字，可以实施不同的策略。</p><p id="fcf6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">贪婪搜索是生成输出的普通实现。从整个词汇中选择一个概率最大的单词。</p><p id="7011" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但是在解码器的每个时间步长的波束搜索中，我们选择出现可能性最大的顶部K个字(K =波束长度)并生成字。我们实例化模型的K个独立版本，并使用它们来生成单词。但是随着波束宽度的增加，推断时间增加，使得预测变得缓慢，并且存储器消耗增加。</p><h1 id="53cd" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">6.探索性数据分析:</h1><p id="d879" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated"><strong class="ig hi">数据集分析:</strong></p><p id="43b0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">提取后。使用tarfile的tgz文件的统计信息是</p><p id="5491" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">图像总数:7470</p><p id="c3bb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">报告总数:3955份</p><p id="6f5d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于每个患者都有一份独特的报告，因此少数患者会有一份以上的X射线报告。</p><p id="1a16" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">检查图像尺寸:</strong></p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="6e62" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">图像尺寸的独特宽度:1</p><p id="f75f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">图像尺寸的独特高度:304</p><p id="e705" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所有图像的宽度相同，但高度不同。必须根据预先训练的图像模型输入大小的i/p大小来重新调整图像的大小。</p><p id="843e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">从XML中提取信息&amp;创建数据帧:</strong></p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="4c7a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">每个病人的报告和发现都以XML格式给出。该XML报告还包含与每个患者相关的X射线图像名称。</p><p id="86da" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用上面的代码片段提取患者id、与患者相关的X射线图像以及放射科医师从X射线中推断出的结果。</p><p id="0f3c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">统计与每个患者相关的图像数量:</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mo"><img src="../Images/188d74979690de08338a0134ea52935d.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*I7yqIySr-bEQyGFjiFqIow.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">与每个患者相关的x光片数量</figcaption></figure><ul class=""><li id="c707" class="kn ko hh ig b ih ii il im ip mi it mj ix mk jb ml kv kw kx bi translated">超过3000名患者有两张与报告相关的x光图像</li><li id="4377" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ml kv kw kx bi translated">大约500名患者有一张与报告相关的x光片</li><li id="e0ac" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ml kv kw kx bi translated">极少数病人有两个以上的X射线与报告</li></ul><p id="7018" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，为了捕捉大部分信息，我们给模型输入两个图像，如下所示</p><ul class=""><li id="4096" class="kn ko hh ig b ih ii il im ip mi it mj ix mk jb ml kv kw kx bi translated">如果患者有一张与报告相关的x光片，我们复制相同的图像两次，作为图像1和图像2</li><li id="708a" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ml kv kw kx bi translated">如果患者有两张以上与报告相关的x光片，我们随机选择两张x光片作为图像1和图像2</li></ul><p id="d6e4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">文本特征的基本处理(发现):</strong></p><ul class=""><li id="e1f7" class="kn ko hh ig b ih ii il im ip mi it mj ix mk jb ml kv kw kx bi translated">将文本转换成小写</li><li id="a5d3" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ml kv kw kx bi translated">使用帖子https://stack overflow . com/questions/1979 01 88/expanding-English-language-contractions-in-python中的代码扩展收缩</li><li id="fbd0" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ml kv kw kx bi translated">其他基础处理如下所示</li></ul><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="3bff" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">调查结果栏统计的字数:</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mp"><img src="../Images/42ce5e16b740abe9b5d3b075784beca3.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/1*8A0JY0SAVhgxBy11w0JqXA.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">字数</figcaption></figure><p id="9cc2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">99%的调查结果的字数少于或等于76个单词。</p><p id="4714" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">而50%的调查结果的字数少于或等于29个单词。</p><p id="a309" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">一个样本X射线和相应的发现:</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="er es mq"><img src="../Images/2c78d50bb6751a1f59fbdbba45be11e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uG8Yr2tJBguaY95mUaVZxA.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">x光和相应的发现</figcaption></figure><h1 id="ad74" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">7.特征工程:</h1><p id="6fd5" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated"><strong class="ig hi">在x光片上加载预先训练好的CNN模型，提取瓶颈特征:</strong></p><p id="fc74" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">预训练的CheXnet模型可以在下面的链接中找到。</p><div class="lp lq ez fb lr ls"><a href="https://github.com/brucechou1983/CheXNet-Keras" rel="noopener  ugc nofollow" target="_blank"><div class="lt ab dw"><div class="lu ab lv cl cj lw"><h2 class="bd hi fi z dy lx ea eb ly ed ef hg bi translated">Bruce Hou 1983/chex net-Keras</h2><div class="lz l"><h3 class="bd b fi z dy lx ea eb ly ed ef dx translated">这个项目是一个构建CheXNet类模型的工具，用Keras编写。ChexNet是一种深度学习算法，可以…</h3></div><div class="ma l"><p class="bd b fp z dy lx ea eb ly ed ef dx translated">github.com</p></div></div><div class="mb l"><div class="mv l md me mf mb mg ji ls"/></div></div></a></div><p id="67c6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">创建了一个DenseNet121模型，并加载了预训练CheXnet模型的权重。放弃模型的最后两层，使用瓶颈特征作为图像的表示。</p><p id="fe14" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">由于每个患者对应两个X射线，因此根据DenseNet121模型的输入对每个图像进行预处理，并在最后连接两个图像的模型预测。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="2d03" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">添加开始和结束标记:</strong></p><p id="ca5b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">用于解决图像字幕问题的模型架构通常遵循编码器-解码器类型的架构。</p><p id="3f27" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">需要对文本进行符号化来训练模型，并在模型训练时计算损失。标记化是指将句子拆分成单词，并将每个单词分配给一个整数。在模型架构中需要输入文本的地方，我们创建一个<a class="ae jo" href="https://keras.io/api/layers/core_layers/embedding/" rel="noopener ugc nofollow" target="_blank">嵌入层</a>，并给出标记化的文本作为输入。该层具有参数Trainable = True，这意味着通过模型训练学习单词嵌入，或者如果设置为False，则可以使用预训练的单词嵌入。</p><p id="bc86" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">开始和结束标记是分别添加在句子开始和结尾的特殊标记，以让模式学习句子的开始和结束。</p><pre class="jd je jf jg fd mw mx my mz aw na bi"><span id="966a" class="nb jq hh mx b fi nc nd l ne nf">data['findings_total'] = '&lt;start&gt;' + ' ' + data.findings.astype(str) + ' ' +'&lt;end&gt;'</span><span id="1a7d" class="nb jq hh mx b fi ng nd l ne nf">data['dec_ip'] = '&lt;start&gt;' + ' ' + data.findings.astype(str)  #Decoder input</span><span id="0398" class="nb jq hh mx b fi ng nd l ne nf">data['dec_op'] = data.findings.astype(str) + ' ' +'&lt;end&gt;'     #Decoder output</span></pre><p id="9b49" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用pickle库将包含预处理文本和图像特征的数据框保存到Pickle文件中，以备后用。</p><h1 id="8739" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">8.建模和评估:</h1><p id="8a3b" class="pw-post-body-paragraph ie if hh ig b ih kp ij ik il kq in io ip ld ir is it le iv iw ix lf iz ja jb ha bi translated">使用的模型架构是编码器-解码器和注意力模型。</p><p id="efaa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">编码器-解码器架构</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="er es nh"><img src="../Images/2b897ef27edf976286aeddb021c7cced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s4-IBgzd9mJLZzHWzcEolg.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">编码器-解码器架构</figcaption></figure><p id="319d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">时间分布设计层在最后应用，因为输出是顺序输出，并且应该应用于输出的每个时间片。</p><p id="54b9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">注意力模型架构:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="er es ni"><img src="../Images/4e22fe3c80c785f644c819454596cdd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PcQF2i0rzZpv_upFY1kS1A.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">注意力模型架构</figcaption></figure><pre class="jd je jf jg fd mw mx my mz aw na bi"><span id="acc0" class="nb jq hh mx b fi nc nd l ne nf">#Bahdanau's additive style Attention code</span><span id="1547" class="nb jq hh mx b fi ng nd l ne nf">self.decoder_hidden_state = decoder_hidden_state</span><span id="5d0f" class="nb jq hh mx b fi ng nd l ne nf">self.encoder_output = encoder_output</span><span id="a487" class="nb jq hh mx b fi ng nd l ne nf">self.decoder_hidden_state = tf.expand_dims(self.decoder_hidden_state,axis = 1)</span><span id="6669" class="nb jq hh mx b fi ng nd l ne nf">score = self.v(tf.nn.tanh(</span><span id="7d1b" class="nb jq hh mx b fi ng nd l ne nf">self.w1(self.decoder_hidden_state) + self.w2(self.encoder_output)))</span><span id="5a7c" class="nb jq hh mx b fi ng nd l ne nf">attention_weights = tf.nn.softmax(score, axis=1)</span><span id="ff0d" class="nb jq hh mx b fi ng nd l ne nf">context_vector = attention_weights * self.encoder_output</span><span id="57ca" class="nb jq hh mx b fi ng nd l ne nf">context_vector = tf.reduce_sum(context_vector, axis=1)</span></pre><p id="e976" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用波束搜索来预测句子。</p><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="mm mn l"/></div></figure><p id="42fb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">注意模型+波束搜索对测试数据的一些预测</p><p id="685f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">预测一:</strong></p><p id="d663" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">原句为:<start>心脏大小正常。稳定的心脏纵隔轮廓。没有气胸，胸腔积液，或局灶性空气病变。骨骼结构排列整齐，没有断裂。</start></p><p id="1f81" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">预测的句子是:<start>心脏大小正常，纵隔轮廓在正常范围内。没有胸腔积液或气胸。没有局灶性空气间隙阴影提示肺炎。没有胸腔积液或气胸。<end/></start></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="er es nj"><img src="../Images/e6f4b993e5e26c1d429a3450f23baae7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CkW3oNT2ulhC3PuqJyPVgA.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">预测-1</figcaption></figure><p id="7a79" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">预测二:</strong></p><p id="4de0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">原句是:<start>纵隔轮廓正常。肺部没问题。没有气胸或大量胸腔积液。</start></p><p id="0e6e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">预测的句子是:<start>心脏大小正常。肺部清晰无浸润。没有积液或气胸。<end/></start></p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="er es nk"><img src="../Images/9561a7f9b5c6e5eeab9834445e45eb05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QP6YtElzQHmzvkR7QeZV6g.png"/></div></div></figure><p id="fe53" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">模型比较:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es nl"><img src="../Images/3066822c2f9c41f2e061604d53edffd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*r2iA7yai7L8wFwiJRJCZEA.png"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">模型比较</figcaption></figure><p id="51c2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">使用streamlit创建并部署了一个webapp。使用该应用程序实时做出的预测可以在下面的gif中查看。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="er es nm"><img src="../Images/296b7e5ba252959361bcdee32f7b4a03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*T-eEdxKBnMxJFYenwRMAAA.gif"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">可交换的图像格式</figcaption></figure><h1 id="9142" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">9.改进:</h1><ul class=""><li id="fdf8" class="kn ko hh ig b ih kp il kq ip kr it ks ix kt jb ml kv kw kx bi translated">不同的架构可以用<a class="ae jo" href="https://arxiv.org/pdf/1703.09137.pdf" rel="noopener ugc nofollow" target="_blank">论文</a>中提到的选项进行试验</li><li id="e075" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ml kv kw kx bi translated">通过增加波束宽度可以提高推理输出质量，但要以牺牲计算资源为代价</li><li id="8e9a" class="kn ko hh ig b ih ky il kz ip la it lb ix lc jb ml kv kw kx bi translated">显然，在这个案例研究中，数据集的大小非常有限，因此更多的数据可以提高模型预测</li></ul><h1 id="a34c" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">10.链接:</h1><div class="lp lq ez fb lr ls"><a href="https://www.linkedin.com/in/srinivasa-raja-yaramati-aba535113/" rel="noopener  ugc nofollow" target="_blank"><div class="lt ab dw"><div class="lu ab lv cl cj lw"><h2 class="bd hi fi z dy lx ea eb ly ed ef hg bi translated">Srinivasa Raja Yaramati -数据科学家- Infosys | LinkedIn</h2><div class="lz l"><h3 class="bd b fi z dy lx ea eb ly ed ef dx translated">查看Srinivasa Raja Yaramati在世界上最大的职业社区LinkedIn上的个人资料。斯里尼瓦萨拉贾有1…</h3></div><div class="ma l"><p class="bd b fp z dy lx ea eb ly ed ef dx translated">www.linkedin.com</p></div></div><div class="mb l"><div class="nn l md me mf mb mg ji ls"/></div></div></a></div><p id="e788" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">存储库的Github链接</p><div class="lp lq ez fb lr ls"><a href="https://github.com/Srinivasa-Raja/Chexnet_Image_Captioning" rel="noopener  ugc nofollow" target="_blank"><div class="lt ab dw"><div class="lu ab lv cl cj lw"><h2 class="bd hi fi z dy lx ea eb ly ed ef hg bi translated">srinivasa-Raja/chex net _ Image _字幕</h2><div class="lz l"><h3 class="bd b fi z dy lx ea eb ly ed ef dx translated">此存储库由以下笔记本组成cs2_preprocess_V2.ipynb:对图像数据和文本数据进行预处理…</h3></div><div class="ma l"><p class="bd b fp z dy lx ea eb ly ed ef dx translated">github.com</p></div></div><div class="mb l"><div class="no l md me mf mb mg ji ls"/></div></div></a></div><h1 id="4e8b" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">11.参考资料:</h1><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np mn l"/></div></figure><figure class="jd je jf jg fd jh"><div class="bz dy l di"><div class="np mn l"/></div></figure><p id="637d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jo" href="https://machinelearningmastery.com/beam-search-decoder-natural-language-processing/" rel="noopener ugc nofollow" target="_blank">https://machinelementmastery . com/beam-search-decoder-natural-language-processing/</a></p><p id="b94f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jo" href="https://nlp.seas.harvard.edu/slides/emnlp16_bso.pdf" rel="noopener ugc nofollow" target="_blank">https://nlp.seas.harvard.edu/slides/emnlp16_bso.pdf</a></p><div class="lp lq ez fb lr ls"><a href="https://towardsdatascience.com/image-captioning-using-deep-learning-fe0d929cf337" rel="noopener follow" target="_blank"><div class="lt ab dw"><div class="lu ab lv cl cj lw"><h2 class="bd hi fi z dy lx ea eb ly ed ef hg bi translated">使用深度学习的医疗报告生成</h2><div class="lz l"><h3 class="bd b fi z dy lx ea eb ly ed ef dx translated">利用编解码模型和注意机制生成胸部x光医学报告。</h3></div><div class="ma l"><p class="bd b fp z dy lx ea eb ly ed ef dx translated">towardsdatascience.com</p></div></div><div class="mb l"><div class="nq l md me mf mb mg ji ls"/></div></div></a></div><p id="ecb1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jo" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">https://www.appliedaicourse.com/</a></p></div></div>    
</body>
</html>