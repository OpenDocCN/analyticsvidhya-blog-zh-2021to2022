<html>
<head>
<title>Credit Card Fraud Detection (Python Codes included)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">信用卡欺诈检测(包括Python代码)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/credit-card-fraud-detection-python-codes-included-15501a3111bd?source=collection_archive---------6-----------------------#2022-02-25">https://medium.com/analytics-vidhya/credit-card-fraud-detection-python-codes-included-15501a3111bd?source=collection_archive---------6-----------------------#2022-02-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/36c2afd6408e589ab3fa2f926c06a868.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*73KwtRc8EJKDvmxR6cstxQ.png"/></div></div></figure><p id="28fc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果这种事从未发生在你身上，你可能知道有人的信用卡被克隆了。欺诈交易给银行和普通公民带来了数十亿美元的损失。应对网络欺诈绝非易事，而机器学习是一个合适的解决方案。这个项目的目标是训练两个模型来预测欺诈交易。来自Kaggle 的<a class="ae jo" href="https://www.kaggle.com/mlg-ulb/creditcardfraud" rel="noopener ugc nofollow" target="_blank">数据集被用于该分析。该数据集包含29万笔交易，其中492笔是欺诈性的。该数据集的另一个特征是，由于安全性和隐私性，所有特征(列)都是数字的。这些列被命名为V1、V2、V3等。在这个数据集中，唯一有实际名称的特征是“时间”、“数量”和“类别”。最后一个问题与交易是正常的还是欺诈性的有关。本项目分为5个部分:探索性数据分析、数据准备、机器学习模型、评估模型性能和用测试数据预测。好吧，让我们开始吧。</a></p><p id="c816" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该数据集的一些信息:</p><ol class=""><li id="0394" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated">它包含欧洲持卡人在2013年9月通过信用卡进行的交易。</li><li id="addc" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">它只包含作为PCA变换结果的数字输入变量。V1、V2……v 28是通过五氯苯甲醚获得的主要成分，唯一没有通过五氯苯甲醚转化的特征是“时间”和“数量”。</li><li id="4e87" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">特征“时间”包含数据集中每个事务和第一个事务之间经过的秒数。</li><li id="cd93" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">特征“金额”是交易金额，该特征可用于依赖于示例的成本敏感学习。</li><li id="1ffd" class="jp jq hi is b it jy ix jz jb ka jf kb jj kc jn ju jv jw jx bi translated">特征“类别”是响应变量，在欺诈的情况下取值1，否则取值0。</li></ol></div><div class="ab cl kd ke gp kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hb hc hd he hf"><h1 id="cebb" class="kk kl hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">1 -探索性数据分析</h1><p id="0db1" class="pw-post-body-paragraph iq ir hi is b it li iv iw ix lj iz ja jb lk jd je jf ll jh ji jj lm jl jm jn hb bi translated">在机器学习项目中要做的第一件事就是更好地理解数据集。诸如“有离群值吗？”，“有空值吗？”或者“数据集的平衡程度如何”需要在继续之前回答。</p><p id="6cd4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">首先要做的当然是导入必要的库。顺便说一下，这个项目只使用Python。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es ln"><img src="../Images/7ed753304a2f32de9504988ebb6a44a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*Hn5DFvEOm9WB7DYb2aEJHQ.png"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">图1 —要使用的库</figcaption></figure><p id="30fb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">那么数据集与变量<code class="du lw lx ly lz b">df</code>相关。然而在这一部分中，使用。示例()方法。该数据框将被用作训练模型的最终验证。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/b415ced9d18474bbdc11aa6dc8b73383.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r5a5G8MSUolWia9TyHSDtA.png"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">图2 —导入数据集并创建测试数据框。</figcaption></figure><p id="2719" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">很好……现在有了我们定义的数据框架<code class="du lw lx ly lz b">df</code>,就可以分析数据了。通过方法<strong class="is hj"> df.head() </strong>可以首先查看数据，而方法<strong class="is hj"> df.describe() </strong>可以给我们一些统计信息。例如，通过最后一项分析，可以检测出“数量”变量中的异常值。另一个重要的分析是计算每一列上null值的数量。这可以通过一个简单的命令<strong class="is hj"> df.isnull()来实现。sum()。</strong>没有丢失的值。</p><p id="d371" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是检查数据集的平衡程度。<code class="du lw lx ly lz b">Seaborn</code>是这种分析的一个很好的选择。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mb"><img src="../Images/2c08b0e493498369539f6c3e1ac03c60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*R73YNKEy8Mbhe1z5JEa8-A.png"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">图3 —检查数据集的平衡程度。</figcaption></figure><p id="f525" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一个很好的问题是“欺诈发生有特定的时间段吗？”我们通过一个班级和时间的柱状图来回答一下。没有...的关系</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mc"><img src="../Images/d6b74ebf517ce6059b216cea86d093d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wB4YkZwLKqte_YWbVHxHgA.png"/></div></div></figure><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/d271a2f117a004bf1643c82b70a72c37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hJ60oLP_nSQUvAKroaBKlQ.png"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">图4 —一段时间内常规交易和欺诈的条形图。</figcaption></figure><p id="6b49" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个项目的重点当然是欺诈。因此，让我们应用。<strong class="is hj">描述()</strong>了解更多欺诈行为的方法。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es me"><img src="../Images/e50e33f2d990dc27ea78c27cd7dca8d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*Fh47qdekn0noIgdC4Znuxg.png"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">图5 —欺诈统计。</figcaption></figure><h1 id="d004" class="kk kl hi bd km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld mj lf lg lh bi translated">2-数据准备</h1><p id="1ec1" class="pw-post-body-paragraph iq ir hi is b it li iv iw ix lj iz ja jb lk jd je jf ll jh ji jj lm jl jm jn hb bi translated">数据集的标准化是许多机器学习估计器的常见要求:如果单个特征或多或少看起来不像标准的正态分布数据(例如，均值和单位方差为0的高斯数据)，它们可能表现不佳。在这个数据集中，变量“时间”和“数量”是标准化的，如图6所示。对于这一步，使用库Scikit-Learn。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mk"><img src="../Images/bcb3750fa197de43e3c495f67c8798df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mGVjihq4IEv-NlmskobYJw.png"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">图6 —特性的标准化。</figcaption></figure><p id="0ff1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下一步是在训练和验证中分离数据集。再次使用Scikit-Learn。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/78e857aeae932d4d5a82d76df9e763b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O0LFNRU5GtEjhjUpiidR6w.png"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">图7——在训练和验证中分离数据集。</figcaption></figure><p id="a81e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以前可以看出，这个数据集是绝对不平衡的。为了解决这个问题，对数据集应用了欠采样方法，该方法从主类中随机提取子类。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mm"><img src="../Images/973ba4e0e4154a4491beab64dc99b0ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cu21n5EbmNbssHIMVrsgZQ.png"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">图8 —不平衡数据集中的欠采样方法。</figcaption></figure><p id="5d96" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在数据集平衡了。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mn"><img src="../Images/ad89580600490959bf97c67b1736f534.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*nBdUAoDW3jXMdaqXTpZq7w.png"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">图9 —欠采样方法后的新分布。</figcaption></figure><h1 id="61e2" class="kk kl hi bd km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld mj lf lg lh bi translated">3 -机器学习模型</h1><p id="33c6" class="pw-post-body-paragraph iq ir hi is b it li iv iw ix lj iz ja jb lk jd je jf ll jh ji jj lm jl jm jn hb bi translated">现在数据准备训练一个模型。这个项目的目标是训练一个模型来预测信用卡欺诈。这样，为此选择的模型是逻辑回归，用于预测分类变量(是或否，真或假，恶性或良性，猫或狗等)。这个模型使用了<strong class="is hj"> Sigmoid函数</strong>来预测类。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mo"><img src="../Images/e72290e812e7d6cd54c3ec171196c70e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*KSCSkl9-bdIfJ5_eyJX1zA.png"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">图10 — Sigmoid函数。</figcaption></figure><p id="a461" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">选择模型后，训练模型和预测的步骤如下:</p><ol class=""><li id="97ef" class="jp jq hi is b it iu ix iy jb jr jf js jj jt jn ju jv jw jx bi translated">实例化模型</li></ol><p id="af2d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.训练模型</p><p id="4108" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.使用模型进行预测</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/c24dfe2da919eb986e06e9b49e134e2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*lSSp6E8Y-i0WifgX0IEsWw.png"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">图11 —使用逻辑回归模型进行实例化和预测。</figcaption></figure><h1 id="21c3" class="kk kl hi bd km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld mj lf lg lh bi translated">4-评估机器模型性能。</h1><p id="131d" class="pw-post-body-paragraph iq ir hi is b it li iv iw ix lj iz ja jb lk jd je jf ll jh ji jj lm jl jm jn hb bi translated">太好了！我们现在有一个机器学习模型，可以根据一些银行信息告诉我们，一笔交易是否更有可能是欺诈。但是，模型预测得好吗？我们通过一个混淆矩阵，分类报告，准确率和曲线下面积得分来回答一下。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/b44cd0615e8e925982037a632f91da76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JWDpIhdqRctPVcXO70J5JQ.png"/></div></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">图12 —评估逻辑回归模型。</figcaption></figure><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mr"><img src="../Images/972a2821ef875ce42d5bcec232b0bf20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*B9BR3lpHakYV5Tr9OXzZAA.png"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">图13 —模型评估。</figcaption></figure><p id="0280" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">结果表明，训练后的模型性能良好。该模型具有高精度和曲线下面积数。</p><h1 id="4ccc" class="kk kl hi bd km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld mj lf lg lh bi translated">5-对测试数据集的预测</h1><p id="331d" class="pw-post-body-paragraph iq ir hi is b it li iv iw ix lj iz ja jb lk jd je jf ll jh ji jj lm jl jm jn hb bi translated">下一步是在测试数据集中使用这个模型。在本文的最开始，我们已经创建了这个数据集(称为test)。相同的训练模型用于预测“测试”数据集。预测评估如图14所示。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/a6f380661ac6de28bc127abe9d9b736d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*60A40VbGURXVR3Y5Tz0XFg.png"/></div><figcaption class="ls lt et er es lu lv bd b be z dx translated">图14——测试数据集中模型的评估。</figcaption></figure><h1 id="708f" class="kk kl hi bd km kn mf kp kq kr mg kt ku kv mh kx ky kz mi lb lc ld mj lf lg lh bi translated">6-结论</h1><p id="56f2" class="pw-post-body-paragraph iq ir hi is b it li iv iw ix lj iz ja jb lk jd je jf ll jh ji jj lm jl jm jn hb bi translated">这可以被认为是一个简单的数据科学项目，但是，正如可以看到的，获得结果并不容易。经过训练的模型在测试数据集上工作得相当好，但肯定还有改进的空间。测试其他模型或调整参数可能会导致更好的预测。</p></div><div class="ab cl kd ke gp kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hb hc hd he hf"><p id="878f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个项目包含更多的分析，可以在我的Github库中找到。查看更多项目。感谢阅读！</p></div></div>    
</body>
</html>