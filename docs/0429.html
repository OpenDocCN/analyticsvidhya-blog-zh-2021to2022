<html>
<head>
<title>The hidden secrets of the bitcoin price</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">比特币价格隐藏的秘密</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/the-hidden-secrets-of-the-bitcoin-price-201c52d0f11d?source=collection_archive---------10-----------------------#2021-01-16">https://medium.com/analytics-vidhya/the-hidden-secrets-of-the-bitcoin-price-201c52d0f11d?source=collection_archive---------10-----------------------#2021-01-16</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="3a24" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">从统计学角度探索比特币价格。</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/4662ca3f9b2aede026a952d2ec891c3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*18SwikPlsGsSTigDV3kEzw.jpeg"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">照片由<a class="ae jm" href="https://www.pexels.com/@pixabay?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <strong class="bd jn"> Pixabay </strong> </a>发自<a class="ae jm" href="https://www.pexels.com/photo/close-up-of-coins-315788/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <strong class="bd jn"> Pexels </strong> </a></figcaption></figure><p id="c91b" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">比特币是中本聪在2009年创造的一种数字货币，他将其描述为“电子现金的点对点版本”。比特币(和其他加密货币)的一大优势是所有数据都是开放和不可变的，位于区块链内部。数据的开放性和不变性使得区块链背后的研究非常活跃，主要是在价格预测方面。许多人理所当然地涌入区块链的数据(如地址、交易等..)，但我会在这篇文章中表明，比特币价格本身已经是非常有益的了。理解价格的行为将对预测价格的模型和参数的选择产生实质性的影响。</p><p id="0c06" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">价格的行为可以通过时间序列的两个主要属性来理解:平稳性和季节性。例如，平稳时间序列比非平稳时间序列更容易建模。</p><p id="510b" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">在接下来的内容中，我将与大家分享我在查看价格时的思维过程，使用统计工具和python编程。</p><blockquote class="kk kl km"><p id="d687" class="jo jp kn jq b jr js ii jt ju jv il jw ko jy jz ka kp kc kd ke kq kg kh ki kj ha bi translated"><strong class="jq hi">注<br/> </strong> <a class="ae jm" href="https://ltetrel.github.io/data-science/2021/01/13/bitcoin_price.html" rel="noopener ugc nofollow" target="_blank">本帖的原创和互动版本</a>(通过<a class="ae jm" href="https://mybinder.readthedocs.io/en/latest/introduction.html" rel="noopener ugc nofollow" target="_blank">活页夹</a>)在我的网站上有，如果你想了解更多信息，请查看。<br/>这篇文章是使用<a class="ae jm" rel="noopener" href="/dunder-data/jupyter-to-medium-initial-post-ecd140d339f0"> jupyter_to_medium </a>工具渲染的。</p></blockquote><h2 id="58f2" class="kr ks hh bd jn kt ku kv kw kx ky kz la jx lb lc ld kb le lf lg kf lh li lj lk bi translated">TL；博士；医生</h2><ol class=""><li id="9030" class="ll lm hh jq b jr ln ju lo jx lp kb lq kf lr kj ls lt lu lv bi translated">时间序列的两个重要特性:平稳性(分布不依赖于时间)和季节性(数据中的循环模式)。</li><li id="9b2c" class="ll lm hh jq b jr lw ju lx jx ly kb lz kf ma kj ls lt lu lv bi translated">自相关检查数据是否是不稳定的；导数或数据滤波/减法来去除非平稳分量。</li><li id="7270" class="ll lm hh jq b jr lw ju lx jx ly kb lz kf ma kj ls lt lu lv bi translated">FFT和短FFT分析季节性。</li></ol><h2 id="f9d5" class="kr ks hh bd jn kt ku kv kw kx ky kz la jx lb lc ld kb le lf lg kf lh li lj lk bi translated">1.时间序列快速入门</h2><p id="68ca" class="pw-post-body-paragraph jo jp hh jq b jr ln ii jt ju lo il jw jx mb jz ka kb mc kd ke kf md kh ki kj ha bi translated">正如我所说的，时间序列有两个重要的属性:季节性和平稳性。<br/>平稳过程意味着数据的分布(统计属性)不随时间而变化，这就是为什么建模要容易得多。季节性代表数据变化的频率(对于比特币价格，我们可以用每天的周期数来表示)，也代表数据开始变化的时间。</p><p id="83a5" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">我们将首先着重分析平稳性，然后是季节性。</p><h2 id="66fd" class="kr ks hh bd jn kt ku kv kw kx ky kz la jx lb lc ld kb le lf lg kf lh li lj lk bi translated">1.1.平稳性</h2><p id="5afa" class="pw-post-body-paragraph jo jp hh jq b jr ln ii jt ju lo il jw jx mb jz ka kb mc kd ke kf md kh ki kj ha bi translated">检测数据是否稳定的一种方法是计算数据的自相关，如果数据降级很快，它就是稳定的。<br/>文献中有许多不同类型的非平稳数据，所以如果你想了解更多，我建议你阅读下面的<a class="ae jm" href="https://towardsdatascience.com/stationarity-in-time-series-analysis-90c94f27322" rel="noopener" target="_blank">帖子</a>。同样检查<a class="ae jm" href="https://otexts.com/fpp2/stationarity.html" rel="noopener ugc nofollow" target="_blank">这个数字</a>，并尝试猜测哪个时间序列是稳定的！</p><h2 id="8672" class="kr ks hh bd jn kt ku kv kw kx ky kz la jx lb lc ld kb le lf lg kf lh li lj lk bi translated">1.2.季节性</h2><p id="8e4b" class="pw-post-body-paragraph jo jp hh jq b jr ln ii jt ju lo il jw jx mb jz ka kb mc kd ke kf md kh ki kj ha bi translated">为了分析比特币的季节性，我们可以进行<a class="ae jm" href="https://www.ritchievink.com/blog/2017/04/23/understanding-the-fourier-transform-by-example/" rel="noopener ugc nofollow" target="_blank">傅立叶分析</a>来提取最显著的频率。FFT的幅度告诉我们给定的频率分量如何影响价格。另一方面，当价格动态开始时，FFT的相位是很有趣的。如果幅度或相位具有随机白噪声趋势，则没有主分量的证据。</p><p id="9e14" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">如果你想了解更多关于季节性的知识，可以看看这篇不错的博文。</p><h2 id="774e" class="kr ks hh bd jn kt ku kv kw kx ky kz la jx lb lc ld kb le lf lg kf lh li lj lk bi translated">2.密码</h2><h2 id="7f79" class="kr ks hh bd jn kt ku kv kw kx ky kz la jx lb lc ld kb le lf lg kf lh li lj lk bi translated">2.1.加载数据</h2><p id="9c74" class="pw-post-body-paragraph jo jp hh jq b jr ln ii jt ju lo il jw jx mb jz ka kb mc kd ke kf md kh ki kj ha bi translated">比特币每小时的美元价格可以通过使用<a class="ae jm" href="https://studio.glassnode.com/pricing" rel="noopener ugc nofollow" target="_blank"> glassnode </a>和他们的高级订阅来收集。如果你不想付费，24小时的数据是免费的。这里我们将使用每小时的数据来获得更精确的分析。</p><pre class="ix iy iz ja fd me mf mg mh aw mi bi"><span id="9807" class="kr ks hh mf b fi mj mk l ml mm">### imports<br/>import os<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import tensorflow as tf<br/><br/>import warnings<br/>warnings.filterwarnings("ignore")</span></pre><p id="2a23" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">首先，我们想创建一个函数来加载数据。</p><pre class="ix iy iz ja fd me mf mg mh aw mi bi"><span id="5bec" class="kr ks hh mf b fi mj mk l ml mm"># function to read the data<br/>def read_data(filepath):<br/>    price = []<br/>    time = []<br/>    <br/>    with open(filepath) as f:<br/>        lines = f.readlines()[1:]<br/><br/>    for data in lines:<br/>        curr_time = float(data.split(",")[0])<br/>        curr_price = -1<br/>        if data.split(",")[1][:-1]:<br/>            curr_price = float(data.split(",")[1][:-1])<br/>        time += [curr_time]<br/>        price += [curr_price]<br/>        <br/>    return np.array(price, dtype=np.float32), np.array(time, dtype=int)</span></pre><p id="2ef0" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">现在我们将跳过第一年来加载数据。</p><pre class="ix iy iz ja fd me mf mg mh aw mi bi"><span id="ed29" class="kr ks hh mf b fi mj mk l ml mm"># define paths<br/>filepath = "../data/market/price_usd_close_BTC_1h"<br/>figure_dir = ""<br/><br/># loading the hourly data, to avoid unimformative data, we skip the first year (8760 h)<br/>price, time = read_data(filepath)<br/>time_shifted = time - time[0]<br/>price = price[8760:]<br/>time_shifted = time_shifted[8760:]</span></pre><p id="174f" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">让我们来看看一段时间内的比特币价格，</p><pre class="ix iy iz ja fd me mf mg mh aw mi bi"><span id="7056" class="kr ks hh mf b fi mj mk l ml mm">### plot<br/>plt.figure()<br/>plt.plot(time_shifted, price)<br/>plt.title("Bitcoin price over time (USD)")<br/>plt.ylabel("price (USD)")<br/>plt.xlabel("time (h)")<br/>if figure_dir:<br/>    plt.savefig(os.path.join(figure_dir, "price.png"))<br/>plt.show()<br/>plt.close()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="ab fe cl mn"><img src="../Images/a525c6ec1b041fc57cde82cf6fab577d.png" data-original-src="https://miro.medium.com/v2/format:webp/1*W1m_13MU6iW-EBsPUqRBKg.png"/></div></figure><p id="aaa3" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">当观察比特币价格时，数据的非平稳行为是显而易见的。我们也可以清楚地看到2017/2020年12月的大幅上涨。</p><h2 id="be55" class="kr ks hh bd jn kt ku kv kw kx ky kz la jx lb lc ld kb le lf lg kf lh li lj lk bi translated">2.2.平稳性</h2><p id="cfee" class="pw-post-body-paragraph jo jp hh jq b jr ln ii jt ju lo il jw jx mb jz ka kb mc kd ke kf md kh ki kj ha bi translated">消除数据中非平稳成分的一种方法是计算其导数。另一种方法是用高斯核过滤数据，并将其减去原始价格数据。</p><pre class="ix iy iz ja fd me mf mg mh aw mi bi"><span id="5573" class="kr ks hh mf b fi mj mk l ml mm"># derivative<br/>price_dt = price[1:] - price[:-1]<br/><br/># filter<br/>filter_width = 12<br/>def gaussian_kernel_1d(filter_width):<br/>    #99% of the values<br/>    sigma = (filter_width)/2.33<br/>    norm = 1.0 / (np.sqrt(2*np.pi) * sigma)<br/>    kernel = [norm * np.exp((-1)*(x**2)/(2 * sigma**2)) for x in range(-filter_width, filter_width + 1)]<br/>    return np.float32(kernel / np.sum(kernel))<br/>f = tf.reshape(gaussian_kernel_1d(filter_width), [-1, 1, 1])<br/>tf_price = tf.reshape(tf.constant(price, dtype=tf.float32), [1, -1, 1])<br/>tf_price = tf.reshape(tf.nn.conv1d(tf_price, filters=f, stride=1, padding='VALID'), [-1])<br/># padding is necessary to keep same dim<br/>tf_price = tf.concat([ tf.constant(tf_price[0].numpy(), shape=filter_width), tf_price ], axis=0)<br/>filt_price = tf.concat([ tf_price,tf.constant(tf_price[-1].numpy(), shape=filter_width) ], axis=0).numpy()<br/>price_centered = price - filt_price</span></pre><p id="4b11" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">通过比较这两种方法(导数和过滤)，我们看到结果价格现在以零为中心。在下图中，它们以橙色显示:</p><pre class="ix iy iz ja fd me mf mg mh aw mi bi"><span id="dc32" class="kr ks hh mf b fi mj mk l ml mm">### plot<br/>fig, axes = plt.subplots(2, figsize=(12, 8))<br/>axes[0].plot(time_shifted, price, label="non-stationnary bitcoin price")<br/>axes[0].plot(time_shifted[:-1], price_dt, label="stationnary bitcoin price")<br/>axes[0].set_title('Derivative method')<br/>axes[0].legend(loc="upper left")<br/>axes[1].plot(time_shifted, price, label="non-stationnary bitcoin price")<br/>axes[1].plot(time_shifted, price_centered, label="stationnary bitcoin price")<br/>axes[1].plot(time_shifted, filt_price, label="filtered bitcoin price")<br/>axes[1].set_title('Filtering and substraction method')<br/>axes[1].legend(loc="upper left")<br/>if figure_dir:<br/>    plt.savefig(os.path.join(figure_dir, "price_stationnarity.png"))<br/>plt.show()<br/>plt.close()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="ab fe cl mn"><img src="../Images/fd7c92c1af534951d979c48c26cf31ef.png" data-original-src="https://miro.medium.com/v2/format:webp/1*kslfrmX9GMWsnUU1vOvc9w.png"/></div></figure><p id="0fa6" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">为了验证过程的质量，可以使用过滤方法检查原始价格数据(蓝线)和静态价格数据(绿线)的自相关性。这将告诉我们数据在处理后有多稳定。</p><p id="ec35" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">我们将计算不同延迟的自相关性，延迟时间最长为每小时2天。</p><pre class="ix iy iz ja fd me mf mg mh aw mi bi"><span id="14d0" class="kr ks hh mf b fi mj mk l ml mm">### auto-correlation function<br/>def autocorr(input, delay):<br/>    input = tf.constant(input, dtype=tf.float32)<br/>    input_delayed = tf.roll(input, shift=delay, axis=0)<br/><br/>    x1 = tf.reshape(input, [1, -1, 1])<br/>    x2 = tf.reshape(input_delayed, [-1, 1, 1])<br/>    return tf.reshape(tf.nn.conv1d(x1, filters=x2, stride=1, padding='VALID'), [-1])</span><span id="87fb" class="kr ks hh mf b fi mo mk l ml mm"># autocorrelation of the price for different delays<br/>delays = np.arange(0, 48)<br/># raw price data<br/>autocorr_price = []<br/>for hour in delays:<br/>    autocorr_price += [autocorr(price, hour)]<br/># stationnary data<br/>autocorr_centered_price = []<br/>for hour in delays:<br/>    autocorr_centered_price += [autocorr(price_centered, hour)]</span></pre><p id="ac0a" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">从图中可以清楚地看出，平稳数据的自相关性比原始价格数据的自相关性下降得更快。这意味着我们成功地去除了价格中的非平稳成分！</p><pre class="ix iy iz ja fd me mf mg mh aw mi bi"><span id="3859" class="kr ks hh mf b fi mj mk l ml mm">### plot<br/>fig, axes = plt.subplots(2, figsize=(12, 8))<br/>axes[0].stem(delays, autocorr_centered_price, linefmt='b-', markerfmt='bo', basefmt='', use_line_collection=True)<br/>axes[0].set_title('stationnary bitcoin price auto-correlation')<br/>axes[1].stem(delays, autocorr_price, linefmt='b-', markerfmt='bo', basefmt='', use_line_collection=True)<br/>axes[1].set_title('raw bitcoin price auto-correlation')<br/>axes[1].set(xlabel='delay (h)', ylabel='amplitude')<br/>if figure_dir:<br/>    plt.savefig(os.path.join(figure_dir, "check_stationnarity.png"))<br/>plt.show()<br/>plt.close()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="ab fe cl mn"><img src="../Images/b8fcf45b66ea4ff5aeba99869d2c8b28.png" data-original-src="https://miro.medium.com/v2/format:webp/1*7Zpicb6_ymxabCt7stPelA.png"/></div></figure><p id="0db5" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">研究平稳性组件还允许我们确定最适合数据的预测窗口。例如，对于给定的时间戳，通过检查原始价格的分布与其相邻价格的差异有多快。</p><p id="fba1" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">通过比较每个时间戳与其相邻时间戳的直方图(即计算相关性)，可以了解预测的可接受范围。如果分布彼此接近，显然更容易预测(因为它们彼此接近)。</p><pre class="ix iy iz ja fd me mf mg mh aw mi bi"><span id="ac5a" class="kr ks hh mf b fi mj mk l ml mm">### histogram function<br/>def data_distribution(inp):<br/>    return np.histogram(inp, range=(0, 20000), bins=500, density=True)[0]</span><span id="ae94" class="kr ks hh mf b fi mo mk l ml mm">win_size = 2*24 #distribution of the data is calculated within 2 days (in hours)<br/>slide = 5*24 #we slide up to -/+ 5 days<br/>corr = []<br/><br/># loop through al timestamps<br/>timestamps_range = np.arange(slide + int(win_size/2), len(price) - slide - int(win_size/2), 72)<br/>sliding_range = np.arange(-slide, slide + 1)<br/>for i in timestamps_range:<br/>    idx = i-int(win_size/2)<br/>    # distribution of the price (over price from day -7.5 to day +7.5), the fixed distributioin<br/>    fixed_price = price[idx:int(idx + win_size)]<br/>    fixed_distrib = data_distribution(fixed_price)<br/>    curr_corr = []<br/>     # compare to each distribution at different timestamps (sliding from -30 to +30), the moving distribution <br/>    for offset in sliding_range:<br/>        idx = offset + i - int(win_size/2)<br/>        moving_price = price[idx:(idx + win_size)]<br/>        moving_distrib = data_distribution(moving_price)<br/>        curr_corr += [np.correlate(fixed_distrib, moving_distrib)]<br/>    curr_corr = curr_corr / np.max(curr_corr)    <br/>    corr += [curr_corr]    <br/>    if i%7992 == 0:<br/>        print("day {}/{}".format(i/24, len(price)/24))<br/><br/>output = np.array(corr)[:, :, 0]</span><span id="717f" class="kr ks hh mf b fi mo mk l ml mm">day 333.0/3439.5<br/>day 666.0/3439.5<br/>day 999.0/3439.5<br/>day 1332.0/3439.5<br/>day 1665.0/3439.5<br/>day 1998.0/3439.5<br/>day 2331.0/3439.5<br/>day 2664.0/3439.5<br/>day 2997.0/3439.5<br/>day 3330.0/3439.5</span></pre><p id="27aa" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">在下面的图中，y轴描述了在比特币价格的不同时间戳获取的一些样本。从上到下，它遵循时间顺序，但这并不重要，因为每个样本都可以独立采集。x轴描述了计算直方图的不同偏移量(从-120小时到+120小时)。颜色是这些分布和时间戳h0(样本的当前时间戳)的分布之间的相关结果。</p><pre class="ix iy iz ja fd me mf mg mh aw mi bi"><span id="75cf" class="kr ks hh mf b fi mj mk l ml mm">### plot<br/>plt.imshow(output, cmap="gray")<br/>plt.axis("tight")<br/>idx_sliding_range = np.arange(0, len(sliding_range), 30)<br/>plt.xticks([i for i in idx_sliding_range], ["h{}".format(sliding_range[i]) for i in idx_sliding_range])<br/>plt.xlabel("time offset (h)")<br/>plt.ylabel("samples")<br/>cbar = plt.colorbar()<br/>cbar.set_label('correlation value')<br/>if figure_dir:<br/>    plt.imsave(os.path.join(figure_dir, "range_accuracy.png"), output, cmap="gray")<br/>plt.show()<br/>plt.close()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="ab fe cl mn"><img src="../Images/1168cc9e3422d0e16400ce265828a787.png" data-original-src="https://miro.medium.com/v2/format:webp/1*dlpeBqMWfd65XDtkw6NePA.png"/></div></figure><p id="00f6" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">看着它，我们可以说预测的可接受范围是大约+/-15小时。</p><blockquote class="kk kl km"><p id="a831" class="jo jp kn jq b jr js ii jt ju jv il jw ko jy jz ka kp kc kd ke kq kg kh ki kj ha bi translated"><strong class="jq hi">注意</strong> <br/>颜色的范围是非常细微的，有时是恒定的。这是因为直方图中的仓数量(500)和价格值范围从0到20k美元，这意味着精度约为40美元。因此，如果价格在某段时间内在40美元范围内波动，直方图将完美匹配。</p></blockquote><h2 id="8f24" class="kr ks hh bd jn kt ku kv kw kx ky kz la jx lb lc ld kb le lf lg kf lh li lj lk bi translated">2.3.季节性</h2><p id="a3d1" class="pw-post-body-paragraph jo jp hh jq b jr ln ii jt ju lo il jw jx mb jz ka kb mc kd ke kf md kh ki kj ha bi translated">现在让我们通过计算FFT来切换季节性分析，并提取其幅度和相位分量。<br/>如前所述，FFT将用于理解数据中的冗余模式。因为FFT在LTI(线性和时不变)系统上工作得更好，所以它不能应用于原始比特币价格(它不是稳定的！).因此，我们将它应用于固定的比特币价格。</p><pre class="ix iy iz ja fd me mf mg mh aw mi bi"><span id="1b02" class="kr ks hh mf b fi mj mk l ml mm"># fft<br/>price_fouried = tf.signal.fft(price_centered)<br/>T = 1/24 # sampling interval in days<br/>N = price_fouried.shape[0]<br/>frequencies = np.linspace(0, 1 / T, N)</span></pre><p id="6040" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">在下图中，没有明显的证据表明存在这种模式，尽管我们看到了重要频率的证据，范围从每天1到1.9个周期，在1.52处有一个小峰值。这意味着比特币价格“一般”可以用周期为~15.8小时的正弦曲线来解释。</p><pre class="ix iy iz ja fd me mf mg mh aw mi bi"><span id="54be" class="kr ks hh mf b fi mj mk l ml mm">### plot<br/>fig, axes = plt.subplots(2, figsize=(12, 8))<br/>axes[0].plot(frequencies[:N // 2], tf.abs(price_fouried)[:N // 2] * 1 / N)<br/>axes[0].set_title('FFT magnitude')<br/>axes[1].plot(frequencies[:N // 2], tf.math.angle(price_fouried)[:N // 2])<br/>axes[1].set_title('FFT phase')<br/>axes[1].set(xlabel='cycles per day', ylabel='amplitude')<br/>if figure_dir:<br/>    plt.savefig(os.path.join(figure_dir, "fft.png"))<br/>plt.show()<br/>plt.close()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="ab fe cl mn"><img src="../Images/58f78952bef82854ab5415ce4502b523.png" data-original-src="https://miro.medium.com/v2/format:webp/1*ORbbmtTnzGRW8zXLAg6TtQ.png"/></div></figure><p id="3d32" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">对非平稳数据进行季节性分析的另一种方法是计算其频谱图(从时间-频率分析中得出)。频谱图是信号频谱在时间上的直观表示。它通常用于(例如由<a class="ae jm" href="https://github.com/deezer/spleeter" rel="noopener ugc nofollow" target="_blank"> spleeter </a>从音频信号中提取语音)。可以使用短傅立叶变换来计算频谱图，其基本上在短窗口上运行傅立叶变换，滑动通过所有数据。</p><p id="e484" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">这里，我们将使用48个样本(小时)的窗口大小，步长为1和62个频率分量。</p><pre class="ix iy iz ja fd me mf mg mh aw mi bi"><span id="0f38" class="kr ks hh mf b fi mj mk l ml mm"># tensorflow provides a fast implementation of the fast fourier transform.<br/>stft = tf.signal.stft(price, frame_length=48, frame_step=1, fft_length=125, pad_end=True)<br/>spectrogram = tf.abs(stft).numpy()</span><span id="7a0d" class="kr ks hh mf b fi mo mk l ml mm">### plot<br/># inspired from https://www.tensorflow.org/tutorials/audio/simple_audio<br/># convert to log scale and transpose so that the time is represented in the x-axis (columns).<br/>fig, axes = plt.subplots(2, figsize=(12, 8))<br/>max_time = np.max(time_shifted)<br/>axes[0].plot(time_shifted, price)<br/>axes[0].set_xlim([0, max_time])<br/>axes[0].set_title('non-stationnary bitcoin price')<br/>log_spec = np.log(spectrogram.T)<br/>axes[1].pcolormesh(time_shifted, np.arange(log_spec.shape[0]), log_spec)<br/>axes[1].set_xlim([0, max_time])<br/>axes[1].set_title('Spectrogram (short-fft)')<br/>axes[1].set(xlabel='time (h)', ylabel='frequencies')<br/>if figure_dir:<br/>    plt.savefig(os.path.join(figure_dir, "spectrogram.png"))<br/>plt.show()<br/>plt.close()</span></pre><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="ab fe cl mn"><img src="../Images/906d397679441a21e8c31ec980dca530.png" data-original-src="https://miro.medium.com/v2/format:webp/1*gvecQyAFnXR1IlPIShIk5w.png"/></div></figure><p id="9732" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">从图中可以看出，每当数据发生较大变化时(例如2017年12月)，响应的幅度都要高得多。一般来说，无论何时，FFT看起来都像一个白噪声。</p><h2 id="772f" class="kr ks hh bd jn kt ku kv kw kx ky kz la jx lb lc ld kb le lf lg kf lh li lj lk bi translated">结论</h2><p id="b63d" class="pw-post-body-paragraph jo jp hh jq b jr ln ii jt ju lo il jw jx mb jz ka kb mc kd ke kf md kh ki kj ha bi translated">根据我们上面看到的性质，有一件事可以肯定地说:由于比特币的时间依赖性，预测其价格绝非易事。</p><p id="2f6d" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">希望我们找到了一种简化过程的方法，通过去除数据中的非平稳成分(因此它不再依赖于时间)。这使我们能够分析数据中的冗余模式，我们发现这种模式是存在的。重复出现的模式很有趣，因为它们可以在以后作为一个新的特征用于预测模型(例如，考虑将一天中的时间添加到天气预测模型中)。</p><p id="1f3b" class="pw-post-body-paragraph jo jp hh jq b jr js ii jt ju jv il jw jx jy jz ka kb kc kd ke kf kg kh ki kj ha bi translated">这些发现向我们展示了获得比特币价格准确预测模型的新方法，但这是另一回事了…</p><h2 id="f1f5" class="kr ks hh bd jn kt ku kv kw kx ky kz la jx lb lc ld kb le lf lg kf lh li lj lk bi translated">走得更远</h2><p id="f5c8" class="pw-post-body-paragraph jo jp hh jq b jr ln ii jt ju lo il jw jx mb jz ka kb mc kd ke kf md kh ki kj ha bi translated">我真的建议您阅读Hyndman的书，它涵盖了时间序列预测的所有最佳实践以及编码示例。在线版本在这里<a class="ae jm" href="https://otexts.com/fpp2/index.html" rel="noopener ugc nofollow" target="_blank">有售。</a></p><h2 id="5be9" class="kr ks hh bd jn kt ku kv kw kx ky kz la jx lb lc ld kb le lf lg kf lh li lj lk bi translated">确认</h2><p id="12fa" class="pw-post-body-paragraph jo jp hh jq b jr ln ii jt ju lo il jw jx mb jz ka kb mc kd ke kf md kh ki kj ha bi translated">感谢<a class="ae jm" href="https://twitter.com/Vahidzarif1" rel="noopener ugc nofollow" target="_blank"> Vahid Zarifpayam </a>对这篇文章的评论。<br/>信用归于<a class="ae jm" href="https://bitprobe.io/" rel="noopener ugc nofollow" target="_blank"> Bitprobe </a>。</p></div></div>    
</body>
</html>