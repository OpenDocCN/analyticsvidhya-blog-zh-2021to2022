<html>
<head>
<title>How to Program a Reddit Bot Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Python编写Reddit机器人</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-program-a-reddit-bot-using-python-6d15ee57f964?source=collection_archive---------2-----------------------#2021-05-15">https://medium.com/analytics-vidhya/how-to-program-a-reddit-bot-using-python-6d15ee57f964?source=collection_archive---------2-----------------------#2021-05-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="3060" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个工作坊中，你可以学习如何制作一个自动化的Reddit机器人来做你想让它做的事情。我将向你展示如何使机器人回应提及以及关键字。然而，可能性是无限的。如果你了解你的Python，你可以让机器人做更大的事情。但是今天，我们将关注如何让一个简单的机器人运行起来。</p><p id="dd9d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这个工作坊的重点是如何让一个机器人只使用浏览器资源。这意味着你将需要使用你在repl.it上制作的repl.it程序，尽管它不是私有的。因为您需要在repl.it代码中输入允许访问您的bot的信息，所以您的bot将可以公开访问。如果你想把它变成私有的，你所要做的就是在本地文件夹和你的计算机外壳里做所有的事情。然而，因为我想让这个程序为没有计算机权限的人工作，我将向你展示如何在repl.it上做所有的事情</p><h1 id="180b" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">建立</h1><p id="439b" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">在你制作一个机器人之前，你需要做几件事。</p><p id="f6b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，你必须阅读机器人礼仪。如果你不遵守bottiquette，你会得到你的机器人被禁止，也许你的IP列入黑名单。</p><p id="7974" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae kf" href="https://www.reddit.com/wiki/bottiquette" rel="noopener ugc nofollow" target="_blank">机器人礼仪</a></p><p id="3592" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，你需要一个Reddit账户。你可以将你的机器人链接到你通常的Reddit帐户，或者你可以创建一个新的帐户。如果你正在使用免费的repl.it，你将需要一个新的，因为你将不得不输入你的帐户凭证，这些凭证将对公众可见。(注意:如果您不想注册，可以不通过电子邮件注册。)</p><p id="6171" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae kf" href="https://www.reddit.com/register/" rel="noopener ugc nofollow" target="_blank"> Reddit注册</a></p><p id="e035" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您还需要为您的机器人创建一个应用程序“注册”。使用下面的链接。</p><p id="f08d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae kf" href="https://www.reddit.com/prefs/apps/" rel="noopener ugc nofollow" target="_blank">创建app </a></p><p id="bccb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦你打开链接，点击“你是开发者吗”。它应该会引导您进入这样一个页面:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kg"><img src="../Images/5b260a0f1d24326dc5bcd4564cf083c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qvaOscVc92-1khLk7hD9wg.png"/></div></div></figure><p id="4a03" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">给你的机器人取个名字。选择脚本。在“重定向uri”中输入<a class="ae kf" href="http://127.0.0.1" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1 </a>。(这是Reddit让你做的事情。)点击“创建应用”，会弹出一个页面，告诉你你的“个人使用脚本”和“秘密”。把这两根弦记录下来。记住，如果你使用的是repl.it，那么这些将和你的整个文件一起公开。</p><p id="1c83" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，您需要访问repl.it来编程。有了repl.it，你不需要下载任何东西到你的实际设备上。没有账号也可以使用repl.it。</p><p id="9eb8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae kf" href="repl.it" rel="noopener ugc nofollow" target="_blank"> repl.it </a></p><p id="9761" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">点击链接后，点击“开始编码”，用Python创建一个repl.it。然后，您应该会打开一个类似如下的页面:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es ks"><img src="../Images/ae03c025cb595a1af691cf6cfb1887e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h1UY-zfDqEe51VYTQS-iIQ.png"/></div></div></figure><p id="b9e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，您必须单击control(Mac上的command)+shift+p，这应该会在右下角打开一个命令行shell。将下面一行代码复制到shell中，然后按enter键。</p><pre class="kh ki kj kk fd kt ku kv kw aw kx bi"><span id="9e94" class="ky jd hh ku b fi kz la l lb lc">pip install praw</span></pre><p id="d4ed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这应该会提示您的机器导入praw，这是bot所需的一个包。导入完成后，您就完成了所有的设置要求！接下来，我们将开始编码。</p><h1 id="81cf" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">编写机器人代码</h1><p id="d62a" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">现在我们可以开始编写代码了！在repl.it上打开main.py，键入或复制以下内容。</p><pre class="kh ki kj kk fd kt ku kv kw aw kx bi"><span id="7ec3" class="ky jd hh ku b fi kz la l lb lc">import praw<br/>r = praw.Reddit(username = "yourreddituser",<br/>                password = "yourredditpw",<br/>                client_id = "yourclientid",<br/>                client_secret = "yourclientsecret",<br/>                user_agent = "yourbotname by /u/yourredditaccount")</span></pre><p id="a50a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们想想我们刚刚做了什么。第一行导入了我们的包。第二个代码块启动了我们的praw实例。Reddit对象基本上充当了我们的机器人，稍后我们需要控制它来使我们的机器人工作。根据你自己的信息填写每一行。客户id和密码应该已经被记录下来。你的user_agent基本上是帮助Reddit在需要的时候识别你的程序。所以一定要有描述性！</p><p id="d700" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我将向你展示你可以让你的机器人做的两件事。第一个是回复提及，第二个是回复关键词。这些是互斥的，因为它们依赖于不同事物的自动流。这意味着你必须从两者中选择一个，你不能在一个机器人中做两件事。</p><h1 id="f650" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">提及</h1><p id="7fd6" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">许多Reddit机器人在被标记后会执行一个操作。这些种类的机器人更受欢迎，因为它们只在被<strong class="ig hi">调用</strong>时做事情。这不太可能让你被禁赛和列入黑名单。要获得基本代码，请在repl.it中，在启动Reddit对象的代码下面键入或复制以下内容。请阅读注释(a #后面的单词),这样您就可以了解一些命令的功能。</p><pre class="kh ki kj kk fd kt ku kv kw aw kx bi"><span id="ab9d" class="ky jd hh ku b fi kz la l lb lc">messages = r.inbox.stream() # creates an iterable for your inbox and streams it<br/>for message in messages: # iterates through your messages<br/>  try:<br/>    if message in r.inbox.mentions() and message in r.inbox.unread(): # if this messasge is a mention AND it is unread...<br/>        message.reply("hello") # reply with this message<br/>        message.mark_read() # mark message as read so your bot doesn't respond to it again...<br/>  except praw.exceptions.APIException: # Reddit may have rate limits, this prevents your bot from dying due to rate limits<br/>    print("probably a rate limit....")</span></pre><h1 id="adf4" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">关键词</h1><p id="cb5d" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">这个机器人可以检查某些评论，如果评论中有关键字，就会采取行动。让关键字成为人们常说的东西可能会让你被封禁。我建议加个“！”在你的关键字前面，这样机器人只有在被调用时才会响应。要获得基本代码，请将以下内容键入或复制到repl.it中，位于启动Reddit对象的代码下方。请记住，此代码不应与“提及”部分下的代码放在同一个位置。请阅读注释(a #后面的单词),这样您就可以了解一些命令的功能。</p><p id="1431" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">计算机编程语言</p><pre class="kh ki kj kk fd kt ku kv kw aw kx bi"><span id="ae3b" class="ky jd hh ku b fi kz la l lb lc">subr = r.subreddit('copypasta') # this chooses a subreddit you want to get comments from<br/>for comment in subr.stream.comments(skip_existing=True): # this iterates through the comments from that subreddit as new ones are coming in<br/>  try:<br/>    if "!bot" in comment.body: # "!bot" is the keyword in this case. replace "bot" with your keyword<br/>      comment.reply("hello world...") # this is what your bot replies to the comment that has the keyword<br/>  except praw.exceptions.APIException: # Reddit may have rate limits, this prevents your bot from dying due to rate limits<br/>    print("probably a rate limit...")</span></pre><p id="514b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在你的代码都是好的，你只需要运行它！因为你的程序将是流式的，除非你让它停止，否则它不会停止。</p><p id="1539" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您可能已经注意到，目前，您的bot仅在您的repl.it程序运行时运行，这仅在您的选项卡保持打开时运行。因此，许多人将他们的机器人托管在外部服务器上，这样机器人就真正实现了自动化。我将向你展示如何在云平台上运行你的机器人，Heroku。</p><p id="3ccf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您对没有托管您的机器人感到满意，那么恭喜您，您已经完成了研讨会！</p><p id="edb9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你想更进一步，继续前进！</p><h1 id="3fef" class="jc jd hh bd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz bi translated">主办；主持</h1><p id="fb51" class="pw-post-body-paragraph ie if hh ig b ih ka ij ik il kb in io ip kc ir is it kd iv iw ix ke iz ja jb ha bi translated">要托管，你需要一个GitHub账户，我假设你有，和一个Heroku账户，我们稍后会处理。</p><p id="4fdb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们回到我们在repl.it上的程序。记住前面的内容，你必须有一个repl.it帐户才能托管。首先，让我们创建一个新文件，将其命名为“Procfile ”,并在其中键入:</p><pre class="kh ki kj kk fd kt ku kv kw aw kx bi"><span id="0d6a" class="ky jd hh ku b fi kz la l lb lc">worker: python main.py</span></pre><p id="b62f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是它在您的repl.it页面上的外观:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es ld"><img src="../Images/c8e58c6be23c062a330365b451467bda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*danF9EhfkpHFVUd2ELjmRA.png"/></div></div></figure><p id="3a35" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Procfile基本上告诉Heroku你想让它运行什么。</p><p id="c012" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们需要创建一个requirements.txt来告诉Heroku我们的应用程序的依赖项是什么。创建requirements.txt是一个很好的实践。我们需要做的就是再次按control+shift+p键，然后在shell中键入:</p><p id="40ea" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><code class="du le lf lg ku b">pip freeze &gt; requirements.txt</code></p><p id="e047" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">应该会弹出一个名为requirements.txt的新文件，看起来有点像这样:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es lh"><img src="../Images/de2487a4c1831b9e53d9fddc8a7281cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G853tszEyG7QjPqgguA8-w.png"/></div></div></figure><p id="f99f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，你需要去侧边栏的版本控制，连接你的GitHub。它会提示您授予权限。您需要授予repl.it访问所有GitHub库的权限。完成后，您应该能够看到如下内容:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es li"><img src="../Images/a17dd145865d3f28874496bb40a8cb2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7uuHAdkro-qHM5o93sqw2Q.png"/></div></div></figure><p id="7b18" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">点击“创建Git Repo”。你可以给它起任何你想要的名字，但是记住这个名字。它可以是公共的，也可以是私有的，不过要记住，由于repl.it，你的机器人无论如何都不会是完全私有的。但是，如果您使用自己的隐私环境，请将存储库设为私有，这样人们就看不到您的凭证。现在，一切都应该与GitHub上的一个回购相关联。接下来，你需要注册一个Heroku账户。</p><p id="e94c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae kf" href="https://signup.heroku.com/" rel="noopener ugc nofollow" target="_blank">注册Heroku </a></p><p id="1a3c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">创建帐户后，您需要“创建应用程序”。你可以给它起任何你想要的名字，只要它是可用的。一旦你的应用被创建，进入“部署”部分，点击“GitHub”。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es lj"><img src="../Images/3919efe03c3a724ee152924f418b0b53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VkHotcbjYvFNRsaQiNFjPg.png"/></div></div></figure><p id="724a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">搜索您刚刚创建的存储库。如果您输入了正确的名称，它将显示您的存储库。点击“连接”。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es lk"><img src="../Images/ebe6c033994f10f45f811c1bdee360ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L5rsicke-c4azOIXrWqdfg.png"/></div></div></figure><p id="4970" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">转到最底部，并单击“部署分支”。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es ll"><img src="../Images/33b5835e0fba463bdc47f9ed58814810.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6I4dbUSDv5KKfPZWU85fLQ.png"/></div></div></figure><p id="f805" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将会出现一个显示日志的小窗口。等待一分钟左右后，您将看到消息“…部署到Heroku”。现在，您可以进入“参考资料”部分，在那里您将看到您的免费dynos。Dynos基本上是运行你的应用程序的容器。单击铅笔图标进行编辑，打开dyno，然后单击确认。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es ks"><img src="../Images/1b1aeb2310d388699302ff9ef2d05b75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y2ZYKsFK18UuVPCrRk5Zhw.png"/></div></div></figure><p id="d3f0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">还有…就是这样！恭喜你，你的机器人现在由Heroku自动运行，并且会按照你的程序去做！</p><p id="c746" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">需要注意的一点是，Heroku上的免费账户每月只能运行有限时间的应用程序。所以使用Heroku意味着你的机器人每个月都会死一段时间。</p></div></div>    
</body>
</html>