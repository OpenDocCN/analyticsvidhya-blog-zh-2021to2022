<html>
<head>
<title>Finding correlations between Reddit and the Stock Market using Statistics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用统计学发现Reddit和股票市场之间的相关性</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/finding-correlations-between-reddit-and-the-stock-market-using-statistics-4926a25a386e?source=collection_archive---------4-----------------------#2021-06-26">https://medium.com/analytics-vidhya/finding-correlations-between-reddit-and-the-stock-market-using-statistics-4926a25a386e?source=collection_archive---------4-----------------------#2021-06-26</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/525aae0a9b27942eeb8c33e1994685f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qk50ynXMJBe0HVGJecoUEQ.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">作者图片</figcaption></figure><div class=""/><div class=""><h2 id="66e0" class="pw-subtitle-paragraph iu hw hx bd b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl dx translated">使用VADER(化合价感知词典和情感推理机)、Pushshift API、Spacy的命名实体识别和Spearman等级-顺序相关性测试。</h2></div><h2 id="dc91" class="jm jn hx bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">介绍</h2><p id="d5a2" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">2021年初，Reddit r/wallstreetbets一直处于金融市场最大运动之一的中心，并展示了社交媒体的力量。虽然这似乎是一个不太可能的运动来源，但事后看来，这并不令人惊讶，因为罗宾汉让散户投资者可以轻松进入股票市场，而无需支付佣金。考虑到这一点，我开始思考是否可以确定以下两者之间的相关性:</p><ul class=""><li id="79ae" class="ld le hx km b kn lf kq lg jx lh kb li kf lj lc lk ll lm ln bi translated">股票交易量中特定股票的被提及次数</li><li id="a4de" class="ld le hx km b kn lo kq lp jx lq kb lr kf ls lc lk ll lm ln bi translated">发布特定股票的情绪和股价</li></ul><p id="48bb" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">在这篇文章中，我将使用Pushshift API从r/wallstreetbets中抓取数据，并使用这些数据来测试上面提到的假设。</p><h2 id="a7e0" class="jm jn hx bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">Pushshift API的工作原理</h2><p id="b9eb" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated"><a class="ae lw" href="https://github.com/pushshift/api" rel="noopener ugc nofollow" target="_blank"> Pushshift API </a>是抓取大量Reddit数据的绝佳资源。使用API的一种方式是通过https://api.pushshift.io/的<a class="ae lw" href="https://api.pushshift.io/" rel="noopener ugc nofollow" target="_blank">端点。访问Reddit的pushshift URL的基础是https://api.pushshift.io/reddit/search/的</a><a class="ae lw" href="https://api.pushshift.io/reddit/search/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="6b67" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">通过参数，我们将访问Unix时间戳格式的2个日期之间的r/wallstreetbets subreddit(2020年4月和2021年4月):<a class="ae lw" href="https://api.pushshift.io/reddit/search/submission/?subreddit=wallstreetbets&amp;after=1585670400&amp;before=1618110903&amp;size=100" rel="noopener ugc nofollow" target="_blank">https://api.pushshift.io/reddit/search/submission/?<strong class="km hy">subreddit =</strong>wallstreetbets&amp;<strong class="km hy">after =</strong>1585670400&amp;<strong class="km hy">before =</strong>1618110903&amp;<strong class="km hy">size =</strong>100</a></p><ul class=""><li id="61bb" class="ld le hx km b kn lf kq lg jx lh kb li kf lj lc lk ll lm ln bi translated">大小—将返回条目的限制增加到100</li><li id="6ae3" class="ld le hx km b kn lo kq lp jx lq kb lr kf ls lc lk ll lm ln bi translated">之后—开始搜索的日期</li><li id="3446" class="ld le hx km b kn lo kq lp jx lq kb lr kf ls lc lk ll lm ln bi translated">之前—结束搜索的日期</li><li id="6a5a" class="ld le hx km b kn lo kq lp jx lq kb lr kf ls lc lk ll lm ln bi translated">子编辑—将其缩小到特定的子编辑</li></ul><p id="8be2" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">上面的URL将返回结果的JSON响应。为了便于解释，我将大小减少到1，以便更好地可视化JSON响应。它看起来会像这样:</p><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="cf91" class="jm jn hx mc b fi mg mh l mi mj">{"data": [{"all_awardings": [],"allow_live_comments": false,"author": "br0kencircuit","author_flair_css_class": null,"author_flair_richtext": [],"author_flair_text": null,"author_flair_type": "text","author_fullname": "t2_20jrdmhz","author_patreon_flair": false,"author_premium": false,"awarders": [],"can_mod_post": false,"contest_mode": false,<strong class="mc hy">"created_utc": 1585670411,</strong>"domain":"self.wallstreetbets","full_link": "https://www.reddit.com/r/wallstreetbets/comments/fsfhli/the_four_most_expensive_words_in_the_english/","gildings": {},"id":"fsfhli","is_crosspostable": false,"is_meta": false,"is_original_content": false,"is_reddit_media_domain": false,"is_robot_indexable": false,"is_self": true,"is_video": false,"link_flair_background_color": "#7b2e00","link_flair_css_class": "shitpost","link_flair_richtext": [{"e": "text","t": "Shitpost"}<br/>],"link_flair_template_id": "50c5e166-b861-11e5-bc53-0e60c810ce03",<br/>"link_flair_text":"Shitpost","link_flair_text_color":"light","link_flair_type": "richtext","locked": false,"media_only": false,"no_follow": true,"num_comments": 0,"num_crossposts": 0,"over_18": false,"parent_whitelist_status": "no_ads","permalink": "/r/wallstreetbets/comments/fsfhli/the_four_most_expensive_words_in_the_english/","pinned": false,"pwls": 0,"removed_by_category": "moderator","retrieved_on": 1585675830,"score": 1,<strong class="mc hy">"selftext": "[removed]"</strong>,"send_replies": true,"spoiler": false,"stickied": false,"subreddit": "wallstreetbets","subreddit_id": "t5_2th52","subreddit_subscribers": 1065713,"subreddit_type": "public","suggested_sort": "confidence","thumbnail": "self",<br/><strong class="mc hy">"title": "The four most expensive words in the English language are \"this time it\u2019s different.\" - Sir John Templeton",</strong><br/>"total_awards_received":0,"url":"https://www.reddit.com/r/wallstreetbets/comments/fsfhli/the_four_most_expensive_words_in_the_english/",<br/>"whitelist_status": "no_ads","wls": 0}]}</span></pre><p id="f1be" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">在Python中，JSON对象可以被翻译成字典类型，在这种情况下，JSON对象将被保存在字典键“data”下，后面是一个嵌套字典列表，包含您在上面看到的内容。我需要的关键点是粗体的，访问它们应该是这样的:</p><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="1843" class="jm jn hx mc b fi mg mh l mi mj">Title: ["data"][0]["title"]<br/>Post text: ["data"][0]["selftext"]<br/>Post created: ["data"][0]["created_utc"]</span></pre><p id="1057" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">关于API如何工作的更详细的解释可以在<a class="ae lw" href="https://github.com/pushshift/api" rel="noopener ugc nofollow" target="_blank">https://github.com/pushshift/api</a>找到</p></div><div class="ab cl mk ml gp mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="hb hc hd he hf"><h1 id="a2e3" class="mr jn hx bd jo ms mt mu js mv mw mx jw jd my je ka jg mz jh ke jj na jk ki nb bi translated">构建抓取Reddit数据的函数</h1><p id="df34" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">我需要首先创建一个向Reddit的服务器发送HTTP请求的函数，并返回请求内容的JSON响应，允许5次失败的HTTP请求尝试。</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="nc nd l"/></div></figure><p id="369c" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">这样，我创建了另一个函数来提取HTTP请求并将关键数据点添加到一个列表中。与之一起的是另一个函数，它在while循环迭代中与前面提到的函数一起工作，从列表中取出最后一个created_utc，并将其带回到循环中，以连续添加提交，直到满足参数before_date。我还为last created_utc添加了tqdm模块和打印功能，以检查提取数据的进度。</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="nc nd l"/></div></figure><p id="ee45" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">我执行了带有所需参数的函数，并进行了简单的文本预处理，以消除任何被管理员删除或移除的帖子。</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="nc nd l"/></div></figure><h2 id="40be" class="jm jn hx bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">结果</h2><p id="4487" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">整个过程耗时13个小时，总共删除了1104216个<strong class="km hy"> </strong>帖子，经过预处理后有143510个帖子。我的笔记本电脑的英特尔酷睿i7–6700 HQ确实受到了打击。</p><figure class="lx ly lz ma fd hk er es paragraph-image"><div class="er es ne"><img src="../Images/a4d305c551907d360a13e998fa0b5e61.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*zPRN88e5GO2qlfzh7baRyg.jpeg"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">输出。作者图片</figcaption></figure><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nf"><img src="../Images/68eb96dd445cdf2bd80e350e28cdefe9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ROrZFyEU4zzHI0Wj5fN5A.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">对收集的数据集的一瞥。作者图片</figcaption></figure></div><div class="ab cl mk ml gp mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="hb hc hd he hf"><h1 id="f009" class="mr jn hx bd jo ms mt mu js mv mw mx jw jd my je ka jg mz jh ke jj na jk ki nb bi translated">探索性数据分析</h1><p id="17a8" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">在我开始根据市场数据分析帖子情绪之前，我对数据进行了探索性数据分析，以更好地理解我刚刚收集的数据。</p><blockquote class="ng nh ni"><p id="632a" class="kk kl nj km b kn lf iy kp kq lg jb ks nk lt ku kv nl lu kx ky nm lv la lb lc hb bi translated">探索性数据分析是一种分析数据集以总结其主要特征的方法，通常使用统计图形和其他数据可视化方法。它有助于确定如何最好地操纵数据源以获得您需要的答案，使数据科学家更容易发现模式、发现异常、测试假设或检查假设。</p></blockquote><h2 id="70b1" class="jm jn hx bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">1.各月的帖子数量</h2><p id="0862" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">我做的第一件事是描绘收集的帖子的分布。很快，我就能看到帖子数量和2021年1月帖子突然增加所表明的炒作激增之间的相关性。</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="nc nd l"/></div></figure><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/52c8f0a5ea37c97ddc316e092e6058e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dnOv5b3UcuwakBennbiYFg.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">描述各月帖子数量的图表。作者图片</figcaption></figure><h2 id="171b" class="jm jn hx bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">2.情感极性得分分布</h2><p id="0e0b" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">我做的下一件事是使用VADER( <a class="ae lw" href="https://github.com/cjhutto/vaderSentiment#:~:text=Notifications-,VADER%20Sentiment%20Analysis.,on%20texts%20from%20other%20domains." rel="noopener ugc nofollow" target="_blank"> Valence Aware字典情感推理器</a>)可视化帖子的情感。为了更准确地确定帖子的情绪，我更新了VADER的词典，增加了积极和消极情绪相关的词汇和子编辑中用户常用的术语，如<em class="nj">、【HODL】、</em>等</p><pre class="lx ly lz ma fd mb mc md me aw mf bi"><span id="02d3" class="jm jn hx mc b fi mg mh l mi mj">from vaderSentiment.vaderSentiment import SentimentIntensityAnalyzer<br/>analyser = SentimentIntensityAnalyzer()</span><span id="dfe5" class="jm jn hx mc b fi nn mh l mi mj">def sentiment_analyzer(text):<br/>    score = analyser.polarity_scores(text)<br/>    return score</span><span id="bd25" class="jm jn hx mc b fi nn mh l mi mj">sentence = "In the case of Apple, I am extremely bullish on its price. So far it has been an upward trend"<br/>print(sentiment_analyzer(sentence))<br/><strong class="mc hy">OUTPUT</strong>: <br/><strong class="mc hy">{'neg': 0.0, 'neu': 1.0, 'pos': 0.0, 'compound': 0.0} # Neutral</strong></span><span id="7ac7" class="jm jn hx mc b fi nn mh l mi mj"><em class="nj"># Update lexicon for better accuracy</em><br/>positive_words = 'buy bull long support undervalued underpriced cheap upward rising trend moon rocket hold hodl breakout call beat support buying holding high profit stonks yolo'</span><span id="0f90" class="jm jn hx mc b fi nn mh l mi mj">negative_words = 'sell bear bubble bearish short overvalued overbought overpriced expensive downward falling sold sell low put miss resistance squeeze cover seller loss '</span><span id="4299" class="jm jn hx mc b fi nn mh l mi mj">pos = {i: 5 for i in positive_words.split(" ")}<br/>neg = {i: -5 for i in negative_words.split(" ")}<br/>stock_lexicons = {**pos, **neg}<br/>analyser.lexicon.update(stock_lexicons)</span><span id="1419" class="jm jn hx mc b fi nn mh l mi mj">print(sentiment_analyzer(sentence))<br/><strong class="mc hy">OUTPUT</strong>:<br/><strong class="mc hy">{'neg': 0.0, 'neu': 0.6, 'pos': 0.4, 'compound': 0.9325} # Positive</strong></span></pre><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="nc nd l"/></div></figure><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/4cf796babe971420102f0413ccb32571.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XYV7OSPzlIEa7Hy5j8yUtg.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">描述帖子情感极性分布的图表。作者图片</figcaption></figure><h2 id="39c2" class="jm jn hx bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">3.帖子字数分布</h2><p id="f780" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">然后我用散点图来显示每篇文章的字数。大多数帖子都在1000字以下，少数超过5000字，反映了一些用户广泛的尽职调查，他们深入分析一支股票并分享他们的发现。</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="nc nd l"/></div></figure><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/7cff495e16e7a40c443ca7a7f8e82af9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JFujsBdFz4Od4hePXOMakg.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">描述文章字数分布的散点图。作者图片</figcaption></figure><h1 id="9e44" class="mr jn hx bd jo ms no mu js mv np mx jw jd nq je ka jg nr jh ke jj ns jk ki nb bi translated">寻找经常讨论的股票</h1><p id="181a" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">在进行下一步(根据股价和市场交易量分析帖子情绪)之前，我需要首先使用以下方法确定我要关注的股票:</p><h2 id="2a93" class="jm jn hx bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">4a。基于潜在狄利克雷分配的主题建模</h2><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="nc nd l"/></div></figure><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/528d3d0750037746ab0650ba25fb37d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cICJxrAVbAL24aE-HuuRCQ.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">描述由LDA确定的各种主题的图表。作者图片</figcaption></figure><h2 id="1401" class="jm jn hx bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">4b。Spacy的命名实体识别(NER)</h2><p id="541d" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">我缩小了搜索范围，将Spacy的NER集中在被归类为组织(ORG)的实体和黑名单上的普通股经纪公司和媒体公司，如美国消费者新闻与商业频道的Robinhood。</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="nc nd l"/></div></figure><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/46be712abf00b4d333144bfaab40cfb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tjsoBSX37TBZPw1sqgKcBw.png"/></div></div></figure><p id="ee47" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">使用潜在狄利克雷分配的主题建模产生了一些合适的主题，如Gamestop、Blackberry和AMC，但与Spacy的NER相比，它在确定通常提到的股票报价机方面没有那么有效。我决定选择排名前三的股票，对Gamestop、AMC和特斯拉进行分析。</p></div><div class="ab cl mk ml gp mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="hb hc hd he hf"><h1 id="e533" class="mr jn hx bd jo ms mt mu js mv mw mx jw jd my je ka jg mz jh ke jj na jk ki nb bi translated">了解相关系数</h1><p id="bfff" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">相关性衡量两个变量之间的单调关联程度。两个变量之间的单调关系是:</p><ol class=""><li id="1714" class="ld le hx km b kn lf kq lg jx lh kb li kf lj lc nt ll lm ln bi translated">一个变量的值增加，另一个变量的值也增加</li><li id="e08e" class="ld le hx km b kn lo kq lp jx lq kb lr kf ls lc nt ll lm ln bi translated">随着一个变量的值增加，另一个变量减少</li></ol><blockquote class="ng nh ni"><p id="0bf5" class="kk kl nj km b kn lf iy kp kq lg jb ks nk lt ku kv nl lu kx ky nm lv la lb lc hb bi translated">一、<strong class="km hy">重要提示:</strong>当一个变量的变化伴随着另一个变量的相应变化时，两个变量之间的单调关系才是<strong class="km hy">线性的</strong>。如下图A &amp; B所示。</p></blockquote><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es nu"><img src="../Images/d82c6f0a6b92f4ce072d38a3b6744f07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YaYAkHlbBQM3sv4oalDuaw.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">资料来源:<a class="ae lw" href="http://statkat.com/monotonic-relationships.php" rel="noopener ugc nofollow" target="_blank">统计局</a></figcaption></figure><p id="cb56" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">什么是相关系数？在最广泛的意义上，它们被用来衡量两个变量之间的关联程度。对系数值进行缩放，使其范围从-1到1，其中-1表示完全负相关，1表示完全正相关，0表示两个变量之间没有线性或单调关系。两个最流行的系数是P <em class="nj"> earson积矩相关</em>和<em class="nj"> Spearman秩序相关</em>。</p><p id="1e54" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">可以对数据进行假设检验，以确定结果的统计意义以及两个变量之间关系的强度和方向</p><h2 id="1e52" class="jm jn hx bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">皮尔逊积矩相关</h2><p id="f8e5" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">也称皮尔逊r，衡量两个变量之间<strong class="km hy"> <em class="nj">线性</em> </strong>相关性的强弱和方向。下面是确定皮尔逊r值的公式:</p><figure class="lx ly lz ma fd hk er es paragraph-image"><div class="er es nv"><img src="../Images/b65760f37375dbcf21c3fb3508135fee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*k66MKsg6VzTbzi98Hy1H0A.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">皮尔逊r公式，作者图片</figcaption></figure><figure class="lx ly lz ma fd hk er es paragraph-image"><div class="er es nw"><img src="../Images/b3323347236abef9f6ffcd480eb83c40.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*Dqmbh6JopdZBBKp9e_4_3g.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">作者图片</figcaption></figure><p id="2672" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">下图展示了从具有不同皮尔逊相关系数(r)的模拟二元正态分布中采样的数据散点图。</p><figure class="lx ly lz ma fd hk er es paragraph-image"><div class="er es nx"><img src="../Images/7320622dd4e783a7ff30b53b438910e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*fF-cRPB7OWdKEBR8aUQw_Q.png"/></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">来源:<a class="ae lw" href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient" rel="noopener ugc nofollow" target="_blank">维基百科</a></figcaption></figure><p id="14ec" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">以左上图为例，我们称之为f。它的r值为0.7，这表明当r值&gt; 0时，采样数据具有正相关性，并且它在两个变量之间具有强相关性。</p><blockquote class="ng nh ni"><p id="54b0" class="kk kl nj km b kn lf iy kp kq lg jb ks nk lt ku kv nl lu kx ky nm lv la lb lc hb bi translated">还需要注意的是，皮尔逊相关性检验还有另外两个输出:<strong class="km hy"> <em class="hx"> R </em> </strong>和<strong class="km hy"> p值</strong>。</p></blockquote><p id="3ae7" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated"><em class="nj"> R </em>为决定系数，为0-1之间的绝对值。对于图F的数据，它的<em class="nj"> R </em>为0.49，通过将该值乘以100等于49.0%。这表示两个变量共享的差异量。由此可以解释，X变量中49.0%的可变性是由Y变量中的可变性所解释的，反之亦然。这也解释了其他51.0%的方差是由相关性测试中未测量的未知因素造成的</p><p id="bc75" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">p值是指对显著性阈值为0.05的零假设和备择假设执行双尾分析时给出的输出。如果p值&gt; 0.05，将接受零假设，或者如果两个排序变量 之间的p值&lt; 0.05.</p><blockquote class="ng nh ni"><p id="b9ad" class="kk kl nj km b kn lf iy kp kq lg jb ks nk lt ku kv nl lu kx ky nm lv la lb lc hb bi translated">Important note: If hypotheses further state the direction of correlation, a one-tail analysis will be performed instead.</p></blockquote><p id="9de9" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">That being said, calculation of Pearson’s r value requires certain assumptions to be fulfilled for accurate inference on the strength of association between the two variables:</p><ul class=""><li id="ccf7" class="ld le hx km b kn lf kq lg jx lh kb li kf lj lc lk ll lm ln bi translated">The sample should be truly random and representative of one population of interest</li><li id="f198" class="ld le hx km b kn lo kq lp jx lq kb lr kf ls lc lk ll lm ln bi translated">Both variables should be measured on a continuous scale and not on an ordinal scale</li><li id="0753" class="ld le hx km b kn lo kq lp jx lq kb lr kf ls lc lk ll lm ln bi translated">Data must come with both an X and Y variable</li><li id="3c36" class="ld le hx km b kn lo kq lp jx lq kb lr kf ls lc lk ll lm ln bi translated">Variables should exhibit an approximate normal(Gaussian) distribution</li><li id="7499" class="ld le hx km b kn lo kq lp jx lq kb lr kf ls lc lk ll lm ln bi translated">Variables must exhibit linear correlation</li></ul><h2 id="6191" class="jm jn hx bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">Spearman’s rank-order correlation</h2><p id="95a5" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">Also known as Spearman’s ρ, it measures the strength and direction of <strong class="km hy"><em class="nj"/></strong>单调关联，将接受替代假设。注意定义上的不同。</p><p id="38a7" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">与Pearson的r相似，两个相关系数之间的根本区别在于，Pearson系数仅适用于具有线性关系的数据，而Spearman系数适用于单调关系。</p><p id="e9fc" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">还需要注意的是，Spearman相关性不仅适用于连续数据，也适用于顺序数据，因为它是基于排序数据而不是原始数据，如下所示:</p><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ny"><img src="../Images/718f2f3b588f147348bcea79d4aadd9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PLxKghbNtJdhAevV5LH5iQ.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">Spearman相关检验的排序数据示例。作者图片</figcaption></figure><p id="c22a" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">Spearman相关系数值的解释方式与Pearson相关系数的解释方式相同。</p><p id="e716" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">Spearman相关性的假设与Pearson相关性非常相似，但有几处不同:</p><ul class=""><li id="9f3c" class="ld le hx km b kn lf kq lg jx lh kb li kf lj lc lk ll lm ln bi translated">变量必须表现出单调的关联性</li><li id="0b32" class="ld le hx km b kn lo kq lp jx lq kb lr kf ls lc lk ll lm ln bi translated">这两个变量都应在连续尺度上测量<strong class="km hy">或在顺序尺度上测量</strong></li><li id="8562" class="ld le hx km b kn lo kq lp jx lq kb lr kf ls lc lk ll lm ln bi translated">数据不必从正态分布中取样</li></ul></div><div class="ab cl mk ml gp mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="hb hc hd he hf"><h1 id="aad0" class="mr jn hx bd jo ms mt mu js mv mw mx jw jd my je ka jg mz jh ke jj na jk ki nb bi translated">帖子数量与股票交易量</h1><p id="057f" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">我决定使用Spearman相关性检验，因为它不假设数据是正态分布的。我要测试的第一个假设是，与特定股票相关的帖子数量是否与其交易量有任何形式的相关性。</p><ul class=""><li id="d455" class="ld le hx km b kn lf kq lg jx lh kb li kf lj lc lk ll lm ln bi translated">零假设:帖子数量和股票交易量之间没有相关性</li><li id="7fe8" class="ld le hx km b kn lo kq lp jx lq kb lr kf ls lc lk ll lm ln bi translated">替代假设:帖子数量和股票交易量之间存在相关性</li></ul><p id="bb6b" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">我首先对数据进行预处理。</p><h2 id="b434" class="jm jn hx bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">预处理</h2><ul class=""><li id="a6a6" class="ld le hx km b kn ko kq kr jx nz kb oa kf ob lc lk ll lm ln bi translated">将整个语料库拆分成每个单独的股票数据帧，以便进一步预处理</li></ul><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="nc nd l"/></div></figure><ul class=""><li id="4561" class="ld le hx km b kn lf kq lg jx lh kb li kf lj lc lk ll lm ln bi translated">收集每天交易量和股价的股票数据</li></ul><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="nc nd l"/></div></figure><h2 id="7af4" class="jm jn hx bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">形象化</h2><p id="df30" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">我决定绘制帖子数量和股票交易量，以更好地形象化这两个变量之间的关系。我使用滚动运算符来获得10天窗口的平均值，以便更清楚地了解整体趋势。</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="nc nd l"/></div></figure><p id="4af0" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">结果如下:</p><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/a09c87b1b2ae57db99f207de25b45db9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B4FRMYiCuAC89Md9h7FOWQ.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">作者图片</figcaption></figure><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/7029c49d9eff22d8006fec516262679b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*STVuKP6QcLPQgcwXqHdg8A.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">作者图片</figcaption></figure><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/90cc5a4bca559955b50dee551dd77ce3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3js159_EA2UXnAkyL7w8yw.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">作者图片</figcaption></figure><h2 id="4eff" class="jm jn hx bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">估价</h2><p id="def1" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">所有3只股票的p值都远低于0.05的显著性阈值，证明无效假设并接受替代假设。基于它们的相关系数，它表明GME和AMC在提及次数与各自股票的交易量之间具有中等相关性，而Tesla具有低相关性。</p><h1 id="0db4" class="mr jn hx bd jo ms no mu js mv np mx jw jd nq je ka jg nr jh ke jj ns jk ki nb bi translated">帖子情绪与股票价格</h1><p id="9543" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">我要测试的下一个假设是，对某只股票的帖子的情绪是否会对该股票的价格产生影响。</p><ul class=""><li id="3fea" class="ld le hx km b kn lf kq lg jx lh kb li kf lj lc lk ll lm ln bi translated">零假设:帖子情绪与股票价格之间没有相关性</li><li id="df98" class="ld le hx km b kn lo kq lp jx lq kb lr kf ls lc lk ll lm ln bi translated">替代假设:帖子情绪与股票价格之间存在相关性</li></ul><h2 id="b959" class="jm jn hx bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">形象化</h2><p id="0437" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">我创建了一个函数，使用刚才处理的数据集，根据VADER提供的值计算正面和负面帖子的数量，并将所有内容绘制在2个不同的支线剧情上。</p><figure class="lx ly lz ma fd hk"><div class="bz dy l di"><div class="nc nd l"/></div></figure><p id="c14b" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">结果如下:</p><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/525aae0a9b27942eeb8c33e1994685f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qk50ynXMJBe0HVGJecoUEQ.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">作者图片</figcaption></figure><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/53db6a3e7396f607f0ce8c8b4989ee4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ObEiHRqqNoiwR73_Soaxw.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">作者图片</figcaption></figure><figure class="lx ly lz ma fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/1ded382c034d6ff7848856c8bb537065.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LxE6PjtQzAsYs0WYnsH6FA.png"/></div></div><figcaption class="hr hs et er es ht hu bd b be z dx translated">作者图片</figcaption></figure><h2 id="c79f" class="jm jn hx bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">估价</h2><p id="357d" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">TSLA和GME的p值都远低于0.05的显著性阈值，推翻了零假设并接受了替代假设，表明股票的帖子情绪与每只股票的价值之间的相关性很低。当AMC p值大于显著性阈值时，接受两个变量之间没有相关性的零假设。</p></div><div class="ab cl mk ml gp mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="hb hc hd he hf"><h2 id="6034" class="jm jn hx bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">结尾注释</h2><p id="fdfa" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">在结束之前，我想补充一条免责声明:</p><p id="b137" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">如果可能的话，从我的项目中获得的结果应该被轻视。我不是金融顾问，本文中使用的分析并不是用来推测市场的</p><p id="33d5" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">有很多事情可以做得更好</p><p id="fc81" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">虽然我使用了Spearman相关性检验，因为它不假设数据是正态分布的，但数据的特征并不满足Spearman相关性检验的所有假设。在检查数据的散点图时，它显示数据的某些部分没有表现出单调关系。我本可以探索更多不同的统计测试，如Wilcoxon Mann-Whitney测试和Kendall的tau。</p><p id="defc" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">虽然Spacy的命名实体识别(NER)确实捕获了大量的股票代码。一项更深入的分析表明，NER未能对大部分数据进行分类，导致数据集变小。我可以通过使用正则表达式操作符来精确地确定收集到的每个帖子的股票代码，从而在速度上做出妥协。</p><p id="769b" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">此外，我的分析仅基于3只精选股票，因为它们在r/wallstreetbets subreddit中很受欢迎。它不代表整个股票市场。我本可以专注于其他流行的与股票相关的子分类，以获得更多种类的股票。</p><p id="6b65" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">所有代码都可以在我的Github上找到:</p><div class="hh hi ez fb hj oc"><a href="https://github.com/S3annnyyy/wallstreetbetsstockanalysis" rel="noopener  ugc nofollow" target="_blank"><div class="od ab dw"><div class="oe ab of cl cj og"><h2 class="bd hy fi z dy oh ea eb oi ed ef hw bi translated">S3 annnyyy/wallstreetbetstockanalysis</h2><div class="oj l"><h3 class="bd b fi z dy oh ea eb oi ed ef dx translated">一个个人项目，我对subreddit r/wallstreetbets中讨论的热门股票进行统计分析…</h3></div><div class="ok l"><p class="bd b fp z dy oh ea eb oi ed ef dx translated">github.com</p></div></div><div class="ol l"><div class="om l on oo op ol oq hp oc"/></div></div></a></div><p id="647f" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">LinkedIn简介:<a class="ae lw" href="https://www.linkedin.com/in/seanyckang/" rel="noopener ugc nofollow" target="_blank">肖恩·雅普</a></p><p id="756d" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">干杯！</p><h2 id="5505" class="jm jn hx bd jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated">参考</h2><p id="d2be" class="pw-post-body-paragraph kk kl hx km b kn ko iy kp kq kr jb ks jx kt ku kv kb kw kx ky kf kz la lb lc hb bi translated">[1]绍贝尔，帕特里克医学博士，博士，MMedStat波尔，克里斯塔博士，理学硕士；施瓦特，洛萨a .医学博士，工商管理硕士，<a class="ae lw" href="https://journals.lww.com/anesthesia-analgesia/fulltext/2018/05000/correlation_coefficients__appropriate_use_and.50.aspx" rel="noopener ugc nofollow" target="_blank">相关系数:恰当使用与解释</a> (2018)，麻醉&amp;镇痛</p><p id="ef4b" class="pw-post-body-paragraph kk kl hx km b kn lf iy kp kq lg jb ks jx lt ku kv kb lu kx ky kf lv la lb lc hb bi translated">[2]史蒂文·布拉德伯恩博士，<a class="ae lw" href="https://www.youtube.com/watch?v=e4ApDqG6MGE&amp;ab_channel=TopTipBio" rel="noopener ugc nofollow" target="_blank">皮尔逊相关解释</a>，<a class="ae lw" href="https://www.youtube.com/watch?v=JwNwbu-g2m0&amp;ab_channel=TopTipBioTopTipBio" rel="noopener ugc nofollow" target="_blank">斯皮尔曼相关解释</a> (2020)，TipTopBio.com</p></div></div>    
</body>
</html>