<html>
<head>
<title>View Components in ASP.NET Core</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">查看ASP.NET核心中的组件</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/view-components-in-asp-net-core-a92180c233a4?source=collection_archive---------2-----------------------#2022-02-03">https://medium.com/analytics-vidhya/view-components-in-asp-net-core-a92180c233a4?source=collection_archive---------2-----------------------#2022-02-03</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="ee28" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">在ASP.NET核心应用程序中实施视图组件</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/db9ee24efd84d09a400b45c0cd7d4628.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xF1eXXS44MANd9on"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">由<a class="ae jn" href="https://unsplash.com/@max_duz?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马克斯·杜济</a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="d0b8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们都很熟悉局部视图:可以在web应用程序中重用的视图，并作为子视图呈现。使用ViewResult可以从控制器返回部分视图，就像常规视图一样。局部视图通常使用<code class="du kk kl km kn b">@Html.Partial()</code>方法在主视图中渲染。</p><p id="ed29" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">ASP.NET核心中引入了视图组件，它比局部视图更强大。视图组件有自己的类来编写逻辑，并且不依赖于控制器来实现。他们还可以利用依赖注入的力量。例如，你想在你的应用程序中实现社交图标，但是它们动态地带有不同的颜色和与之相关的URL。这里可以使用视图组件。</p></div><div class="ab cl ko kp gp kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="hb hc hd he hf"><p id="0124" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">实施:</strong></p><p id="6fc3" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">让我们实现一个视图组件:restaurantcountviewcomponent . cs，它将帮助我们从数据库中获得餐馆的总数。</p><p id="d20f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">您的项目-&gt;添加restaurantcountviewcomponent . cs</p><p id="fdb3" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">注意:</strong>不要忘记在你的类名中使用ViewComponent，这样框架就可以知道它是一个视图组件，并且可以对它进行相应的处理。</p><pre class="iy iz ja jb fd kv kn kw kx aw ky bi"><span id="b706" class="kz la hi kn b fi lb lc l ld le">public class RestaurantCountViewComponent : ViewComponent</span><span id="ee89" class="kz la hi kn b fi lf lc l ld le">{</span><span id="8ac9" class="kz la hi kn b fi lf lc l ld le">private IRestaurantData restaurantData { get; }</span><span id="338b" class="kz la hi kn b fi lf lc l ld le">public RestaurantCountViewComponent(IRestaurantData _restaurantData)</span><span id="c802" class="kz la hi kn b fi lf lc l ld le">{</span><span id="70c1" class="kz la hi kn b fi lf lc l ld le">this.restaurantData = _restaurantData;</span><span id="f0ac" class="kz la hi kn b fi lf lc l ld le">}</span><span id="954b" class="kz la hi kn b fi lf lc l ld le">public Task&lt;IViewComponentResult&gt; InvokeAsync()</span><span id="9ea7" class="kz la hi kn b fi lf lc l ld le">{</span><span id="fcf3" class="kz la hi kn b fi lf lc l ld le">var count = restaurantData.GetData("").Count();</span><span id="b0da" class="kz la hi kn b fi lf lc l ld le">return Task.FromResult&lt;IViewComponentResult&gt;(View(count));</span><span id="1dae" class="kz la hi kn b fi lf lc l ld le">}</span><span id="626d" class="kz la hi kn b fi lf lc l ld le">}</span></pre><p id="787b" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果我们仔细看看上面的代码，我们可以看到ViewComponent是一个从View Component基类派生的C#类。它还支持构造函数注入，我们为IRestaurantData实现了我们的数据库操作，因为我们需要GetData()方法从数据库中获取餐馆列表。</p><p id="aaad" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果我们看到InvokeAsync方法，我们可以加载我们的数据，它返回包装在视图中的数据，这基本上是以“Default”的名称呈现部分视图。</p><p id="4376" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">创建Default.cshtml局部视图文件夹结构应该如下所示:</p><p id="a699" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在我们的共享文件夹中，我们维护一个结构-&gt; Components-&gt; restaurant count-&gt; default . cs html</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es lg"><img src="../Images/7aa06aa7ecb1be24085d9430f9a1f0de.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*7FaSaTf9WBG7gS1dV8bktA.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">视图组件呈现的默认视图的文件夹结构</figcaption></figure><p id="269c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">内部默认。我写了一些代码来显示餐馆的数量:</p><pre class="iy iz ja jb fd kv kn kw kx aw ky bi"><span id="706f" class="kz la hi kn b fi lb lc l ld le">@model int</span><span id="5480" class="kz la hi kn b fi lf lc l ld le">There are @Model Restaurants</span><span id="9e95" class="kz la hi kn b fi lf lc l ld le">&lt;a asp-page="./List" class="btn btn-default" style="color: blue;"&gt;View All&lt;/a&gt;</span></pre><p id="38b0" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我在_Layout.cshtml的页脚中添加了一个我们可以从视图中的任何地方调用ViewComponents的帖子，这样就可以在整个应用程序中看到计数:</p><pre class="iy iz ja jb fd kv kn kw kx aw ky bi"><span id="1b3b" class="kz la hi kn b fi lb lc l ld le">&lt;vc:restaurant-count&gt;&lt;/vc:restaurant-count&gt;</span></pre><p id="e681" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">它看起来像什么:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es lh"><img src="../Images/17b6d5c45dd64a473cdb72de6ada9f0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-qEDwNvqX3T98jLftQwqDA.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">在页脚呈现视图组件的应用程序主页</figcaption></figure><p id="3ec5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果你喜欢读这篇文章，请为它鼓掌。如果你有任何问题或建议，可以在评论区联系我。</p></div></div>    
</body>
</html>