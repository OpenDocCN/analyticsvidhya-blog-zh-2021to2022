<html>
<head>
<title>Different types of Hyper-Parameter Tuning.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不同类型的超参数调整。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/different-types-of-hyper-parameter-tuning-3d99ca624baa?source=collection_archive---------1-----------------------#2021-07-17">https://medium.com/analytics-vidhya/different-types-of-hyper-parameter-tuning-3d99ca624baa?source=collection_archive---------1-----------------------#2021-07-17</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="1028" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">本文旨在使用RandomForest模型展示不同超参数调优技术的python实现。</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ix"><img src="../Images/8ce86fa8590040ce1466de669bae86f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*6Vux4NQIDBPzQiEvZQb9Uw.jpeg"/></div></figure><h1 id="4e07" class="jf jg hi bd jh ji jj jk jl jm jn jo jp io jq ip jr ir js is jt iu ju iv jv jw bi translated">内容:</h1><p id="5468" class="pw-post-body-paragraph jx jy hi jz b ka kb ij kc kd ke im kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><strong class="jz hj"> →超参数调谐的重要性！<br/> →超参数调谐/优化<br/> →定义功能<br/> →检查基本模型的性能<br/> →不同的超参数调谐方法</strong> <br/> <em class="kt"> 1。GridSearch <br/> 2。RandomSearch <br/> 3。连续减半<br/> 4。贝叶斯优化器。手动搜索</em> <br/> <strong class="jz hj"> →参数和超参数之间的差异<br/> →结论</strong></p><p id="a927" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi kz translated">超参数是当今ML世界中任何模型的灵魂。超参数的值需要手动传递，因为它们无法学习，然后控制整个学习过程。</p><p id="dbc8" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">需要在拟合数据之前设置超参数，以便获得更稳健和优化的模型。</p><h1 id="0b98" class="jf jg hi bd jh ji jj jk jl jm jn jo jp io jq ip jr ir js is jt iu ju iv jv jw bi translated">超参数调整的重要性！</h1><ol class=""><li id="e5c4" class="li lj hi jz b ka kb kd ke kg lk kk ll ko lm ks ln lo lp lq bi translated">任何模型的目标都是实现最小误差，超参数有助于实现这一目标，因为它们负责任何ML模型的结果。</li><li id="174f" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks ln lo lp lq bi translated">它在很大程度上影响任何ML算法的收敛性。</li></ol><h1 id="c225" class="jf jg hi bd jh ji jj jk jl jm jn jo jp io jq ip jr ir js is jt iu ju iv jv jw bi translated">超参数调整/优化</h1><p id="30b6" class="pw-post-body-paragraph jx jy hi jz b ka kb ij kc kd ke im kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">涉及为任何机器学习算法搜索超参数的最优值的过程被称为超参数调整/优化。</p><blockquote class="lw"><p id="005c" class="lx ly hi bd lz ma mb mc md me mf ks dx translated">我将使用脉冲星的恒星数据，你可以从<a class="ae mg" href="https://www.kaggle.com/colearninglounge/predicting-pulsar-starintermediate" rel="noopener ugc nofollow" target="_blank"> Kaggle链接</a>下载数据。</p><p id="63bd" class="lx ly hi bd lz ma mb mc md me mf ks dx translated">完整的代码可以在我的<a class="ae mg" href="https://github.com/AbhigyanSingh97/Different_Hyperparameter_Tuning_Techniques" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>中找到。</p></blockquote><h1 id="49f3" class="jf jg hi bd jh ji jj jk jl jm jn jo jp io mh ip jr ir mi is jt iu mj iv jv jw bi translated">定义函数</h1><p id="c685" class="pw-post-body-paragraph jx jy hi jz b ka kb ij kc kd ke im kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><strong class="jz hj">评估列车组的功能。</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="7096" class="mp jg hi ml b fi mq mr l ms mt">def eval_model_train(model): <br/>  #defining a function to calculate the metrics on train data<br/>  pred = model.predict(x_train)<br/>  Precision = precision_score(y_train,pred)<br/>  Recall = recall_score(y_train,pred)<br/>  F1_Score = f1_score(y_train,pred)<br/>  return pred, Precision, Recall, F1_Score</span></pre><p id="6ee9" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">评估测试集的功能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="b064" class="mp jg hi ml b fi mq mr l ms mt">def eval_model_test(model): <br/>  #defining a function to calculate the metrics on test data<br/>  pred = model.predict(x_test)<br/>  Precision = precision_score(y_test,pred)<br/>  Recall = recall_score(y_test,pred)<br/>  F1_Score = f1_score(y_test,pred)<br/>  return pred, Precision, Recall, F1_Score</span></pre><p id="b370" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">功能计算时间取</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="ce91" class="mp jg hi ml b fi mq mr l ms mt">def exec_time(start, end):<br/>   diff_time = end - start<br/>   m, s = divmod(diff_time, 60)<br/>   h, m = divmod(m, 60)<br/>   s,m,h = int(round(s, 0)), int(round(m, 0)), int(round(h, 0))<br/>   return f"{h}:{m}:{s}"</span></pre><h1 id="a1bd" class="jf jg hi bd jh ji jj jk jl jm jn jo jp io jq ip jr ir js is jt iu ju iv jv jw bi translated">检查基本模型的性能</h1><h2 id="a827" class="mp jg hi bd jh mu mv mw jl mx my mz jp kg na nb jr kk nc nd jt ko ne nf jv ng bi translated">→检查随机森林基本模型的默认参数</h2><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="5bf2" class="mp jg hi ml b fi mq mr l ms mt">Rf_model = RandomForestClassifier()<br/>pprint(Rf_model.get_params())</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nh"><img src="../Images/1a9abd354215f7c8ad548e9b06b90cc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*r3N4o3_ZJUSDCOahOJxvLg.png"/></div></figure><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="9d1c" class="mp jg hi ml b fi mq mr l ms mt">start_base = time.time()<br/>Rf_model.fit(x_train,y_train)<br/>end_base = time.time()</span><span id="2df5" class="mp jg hi ml b fi ni mr l ms mt">basemodel_time = exec_time(start_base,end_base)<br/>basemodel_time</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nj"><img src="../Images/4ae3f7e38661a7ea26e424f1fc71d36c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*7FVuM4xqCo-EXERiGSv2cw.png"/></div></figure><p id="1b4a" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">列车组性能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="eb0d" class="mp jg hi ml b fi mq mr l ms mt">_, precision_basetrain, recall_basetrain, f1_basetrain = <br/>                                             eval_model_train(Rf_model)</span><span id="e729" class="mp jg hi ml b fi ni mr l ms mt">print("Precision = {} \nRecall = {} \nf1 = {}".format(precision_basetrain, recall_basetrain, f1_basetrain))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nk"><img src="../Images/324bb07e984944ec4d5bb359fea3688f.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/format:webp/1*2znO8DT8491NNkNr4PnrZg.png"/></div></figure><p id="1489" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">测试集上的性能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="1b77" class="mp jg hi ml b fi mq mr l ms mt">_, precision_basetest, recall_basetest, f1_basetest = eval_model_test(Rf_model)<br/>print("Precision = {} \nRecall = {} \nf1 = {}".format(precision_basetest, recall_basetest, f1_basetest))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es nl"><img src="../Images/57577ac9092198c90269ff4ae060c42f.png" data-original-src="https://miro.medium.com/v2/resize:fit:866/format:webp/1*YC9D7wPttO5tRhta6zS-hA.png"/></div></figure><h1 id="1942" class="jf jg hi bd jh ji jj jk jl jm jn jo jp io jq ip jr ir js is jt iu ju iv jv jw bi translated">不同的超参数调谐方法:</h1><h1 id="592a" class="jf jg hi bd jh ji jj jk jl jm jn jo jp io jq ip jr ir js is jt iu ju iv jv jw bi translated">1.网格搜索:</h1><ul class=""><li id="7b6f" class="li lj hi jz b ka kb kd ke kg lk kk ll ko lm ks nm lo lp lq bi translated">网格搜索通过组合网格中传递的每个值来挑选超参数值，评估每个值，并返回最佳值。</li><li id="251d" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">这将导致在所选数据的整个网格中进行搜索。</li><li id="a222" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">GridSearch可能会遭遇<strong class="jz hj">维数灾难，</strong>我们传递的参数越多，参数执行搜索所占用的时间和空间就越多。</li></ul><blockquote class="nn no np"><p id="19c7" class="jx jy kt jz b ka ku ij kc kd kv im kf nq kw ki kj nr kx km kn ns ky kq kr ks hb bi translated"><strong class="jz hj">维数灾难</strong>是指在高维空间(特征数较高)分析和组织数据时出现的，在低维空间(特征数较低)不会出现的各种现象。<br/> <strong class="jz hj">这意味着我们添加的维度越多，搜索的时间复杂度就会增加得越多，最终使这种策略变得不方便。</strong></p></blockquote><blockquote class="lw"><p id="965a" class="lx ly hi bd lz ma nt nu nv nw nx ks dx translated">提供超参数字典</p></blockquote><pre class="ny nz oa ob oc mk ml mm mn aw mo bi"><span id="2bb2" class="mp jg hi ml b fi mq mr l ms mt"># Number of trees in random forest<br/>n_estimators = [int(x) for x in np.linspace(start = 200, stop = 1500, num = 3)]</span><span id="7649" class="mp jg hi ml b fi ni mr l ms mt"># Number of features to consider at every split<br/>max_features = ['auto', 'sqrt']</span><span id="a807" class="mp jg hi ml b fi ni mr l ms mt"># Maximum number of levels in tree<br/>max_depth = [int(x) for x in np.linspace(10, 80, num = 3)]</span><span id="7119" class="mp jg hi ml b fi ni mr l ms mt"># Minimum number of samples required to split a node<br/>min_samples_split = [2, 10, 15]</span><span id="96b7" class="mp jg hi ml b fi ni mr l ms mt"># Minimum number of samples required at each leaf node<br/>min_samples_leaf = [1, 4, 9]</span><span id="0fd6" class="mp jg hi ml b fi ni mr l ms mt"># Method of selecting samples for training each tree<br/>bootstrap = [True, False]</span><span id="5614" class="mp jg hi ml b fi ni mr l ms mt">para = {'n_estimators': n_estimators,<br/>               'max_features': max_features,<br/>               'max_depth': max_depth,<br/>               'min_samples_split': min_samples_split,<br/>               'min_samples_leaf': min_samples_leaf,<br/>               'bootstrap': bootstrap}</span><span id="2621" class="mp jg hi ml b fi ni mr l ms mt">pprint(para)#print our grid of hyperparameter values</span></pre><p id="a0ee" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj"> <em class="kt">输出:</em> </strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es od"><img src="../Images/bd8a91aebb6bda2e31369423bfc509d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*e0VZlNrLB17NA4RNp_uDaw.png"/></div></figure><blockquote class="lw"><p id="1f19" class="lx ly hi bd lz ma nt nu nv nw nx ks dx translated">现在，我们拟合GridSearch模型以找到一组最佳超参数值。</p><p id="544d" class="lx ly hi bd lz ma mb mc md me mf ks dx translated">该模型将尝试324种超参数组合。这让您了解了网格搜索是如何增加时间复杂度的。bootstrap的<br/>2 max _ depth的<br/>3<br/>2 max _ features的<br/>3min _ samples _ leaf的<br/>3min _ samples _ split的<br/>3n _ estimators的<br/>给出组合2*3*2*3*3*3 = 324</p></blockquote><pre class="ny nz oa ob oc mk ml mm mn aw mo bi"><span id="e623" class="mp jg hi ml b fi mq mr l ms mt">start_gridsearch = time.time()</span><span id="c48d" class="mp jg hi ml b fi ni mr l ms mt">grid_search = GridSearchCV(estimator = Rf_model, <br/>                          param_grid = para, <br/>                          scoring = "f1",<br/>                          cv = 5, n_jobs = -1, verbose = 1)</span><span id="858d" class="mp jg hi ml b fi ni mr l ms mt"># Fit the grid search model<br/>grid_search.fit(x_train,y_train)</span><span id="b788" class="mp jg hi ml b fi ni mr l ms mt">end_gridsearch = time.time()</span><span id="eec8" class="mp jg hi ml b fi ni mr l ms mt">gridsearchmodel_time = exec_time(start_gridsearch,end_gridsearch)<br/>gridsearchmodel_time</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es oe"><img src="../Images/ef5c7be28a0060d56fbafb0c475ada8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*JQKQrdBUfOhAOYsikdXf8w.png"/></div></figure><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="8177" class="mp jg hi ml b fi mq mr l ms mt">grid_search.best_params_ #outputs the set of best hyperparameter values.</span></pre><p id="49ab" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj"> <em class="kt">输出:</em> </strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es of"><img src="../Images/e95d35f2d89ba42b167a9effba8983b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*Pa2aXdagc48IWJV_BsAVcg.png"/></div></figure><p id="cf89" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">列车上的表演</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="ce09" class="mp jg hi ml b fi mq mr l ms mt">_, precision_gridtrain, recall_gridtrain, f1_gridtrain = <br/>                                 eval_model_train(grid_search)</span><span id="392d" class="mp jg hi ml b fi ni mr l ms mt">print("Precision = {} \n Recall = {} \n f1 = {}".format(precision_gridtrain, recall_gridtrain, f1_gridtrain))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es og"><img src="../Images/a854e6764a2588c1566fc5171cf67fa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*6_SEfiFbzUHPSIMt7HPIkw.png"/></div></figure><p id="5fd7" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">测试集上的性能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="966d" class="mp jg hi ml b fi mq mr l ms mt">_, precision_gridtest, recall_gridtest, f1_gridtest = <br/>                                          eval_model_test(grid_search)</span><span id="e300" class="mp jg hi ml b fi ni mr l ms mt">print("Precision = {} \n Recall = {} \n f1 = {}".format(precision_gridtest, recall_gridtest, f1_gridtest))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es oh"><img src="../Images/b724a720f3de08040b74b1f36bf17bd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*-zGHGfMZ9uL0xPl4pjZUIA.png"/></div></figure><h1 id="b23e" class="jf jg hi bd jh ji jj jk jl jm jn jo jp io jq ip jr ir js is jt iu ju iv jv jw bi translated">2.随机搜索:</h1><ul class=""><li id="6885" class="li lj hi jz b ka kb kd ke kg lk kk ll ko lm ks nm lo lp lq bi translated">随机搜索通过随机组合值来删除GridSearch完成的穷举搜索。</li><li id="a351" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">因为参数的选择是完全随机的；<strong class="jz hj"> <em class="kt">在计算</em>时产生高方差。</strong></li><li id="a565" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated"><strong class="jz hj">例如，<br/></strong>random search不是检查所有100个样本，而是检查50个随机参数。</li><li id="5a08" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">然而，降低时间复杂度是有代价的。它擅长测试大范围的值，通常它很快达到一个非常好的组合，但问题是它不能保证给出最佳的参数组合。</li></ul><blockquote class="lw"><p id="2bb0" class="lx ly hi bd lz ma nt nu nv nw nx ks dx translated">使用相同的超参数字典</p><p id="1938" class="lx ly hi bd lz ma mb mc md me mf ks dx translated">现在，我们符合随机搜索模型。这将需要一些时间来执行。这取决于数据的大小。</p><p id="8b21" class="lx ly hi bd lz ma mb mc md me mf ks dx translated">注意:<br/>→RandomizedSearchCV中最重要的参数是n_iter，它处理要尝试的不同数据组合的数量。<br/> → cv是用于交叉验证的折叠数。增加cv折叠会减少过度拟合的机会，但会增加运行时间。</p></blockquote><pre class="ny nz oa ob oc mk ml mm mn aw mo bi"><span id="78c3" class="mp jg hi ml b fi mq mr l ms mt">start_randomsearch = time.time()</span><span id="4110" class="mp jg hi ml b fi ni mr l ms mt">random_search = RandomizedSearchCV(estimator = Rf_model, param_distributions = para, cv = 5, verbose=1, random_state=42, scoring = "f1", n_jobs = -1)<br/># Fit the random search model<br/>random_search.fit(x_train,y_train)</span><span id="9716" class="mp jg hi ml b fi ni mr l ms mt">end_randomsearch = time.time()</span><span id="f2ea" class="mp jg hi ml b fi ni mr l ms mt">randomsearchmodel_time = exec_time(start_randomsearch,end_randomsearch)<br/>randomsearchmodel_time</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="oj ok di ol bf om"><div class="er es oi"><img src="../Images/ba3c090529c1c523cdc045e5c518e0ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RxBLOinhRu9BERSsp4_hXg.png"/></div></div></figure><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="7a07" class="mp jg hi ml b fi mq mr l ms mt">random_search.best_params_</span></pre><p id="442b" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">T34】输出:T36】</strong></p><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es on"><img src="../Images/b9e04f6298caf18796174ed8417ec6a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*LqXvPdN29NOFq69QwOorkg.png"/></div></figure><p id="fc69" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">列车组性能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="7355" class="mp jg hi ml b fi mq mr l ms mt">_, precision_randtrain, recall_randtrain, f1_randtrain = <br/>                                       eval_model_train(random_search)</span><span id="d924" class="mp jg hi ml b fi ni mr l ms mt">print("Precision = {} \n Recall = {} \n f1 = {}".format(precision_randtrain, recall_randtrain, f1_randtrain))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es oo"><img src="../Images/00ea977844794c93d16a3fa60f387589.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*apSFRt2RtNI0GrcO34Qe_Q.png"/></div></figure><p id="b75c" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">测试集上的性能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="d39b" class="mp jg hi ml b fi mq mr l ms mt">_, precision_randtest, recall_randtest, f1_randtest = <br/>                                          eval_model_test(random_search)</span><span id="bbab" class="mp jg hi ml b fi ni mr l ms mt">print("Precision = {} \n Recall = {} \n f1 = {}".format(precision_randtest, recall_randtest, f1_randtest))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es op"><img src="../Images/3c69d18f46e969082b036a1e24d21274.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*AHzQeCnzhsH8J5Rr3t62vQ.png"/></div></figure><h1 id="e52a" class="jf jg hi bd jh ji jj jk jl jm jn jo jp io jq ip jr ir js is jt iu ju iv jv jw bi translated">3.连续减半:</h1><p id="4f22" class="pw-post-body-paragraph jx jy hi jz b ka kb ij kc kd ke im kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">Scikit-learn还提供了<code class="du oq or os ml b"><a class="ae mg" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.HalvingGridSearchCV.html#sklearn.model_selection.HalvingGridSearchCV" rel="noopener ugc nofollow" target="_blank"><strong class="jz hj">HalvingGridSearchCV</strong></a></code>和<code class="du oq or os ml b"><a class="ae mg" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.HalvingRandomSearchCV.html#sklearn.model_selection.HalvingRandomSearchCV" rel="noopener ugc nofollow" target="_blank"><strong class="jz hj">HalvingRandomSearchCV</strong></a></code>估计器，可用于使用连续二等分搜索参数空间</p><ul class=""><li id="5dd1" class="li lj hi jz b ka ku kd kv kg ot kk ou ko ov ks nm lo lp lq bi translated">连续减半(SH)就像候选参数组合之间的比赛。</li><li id="ed26" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">SH是一个迭代选择过程，在第一次迭代中，用少量资源评估所有候选(参数组合)。</li><li id="48e7" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">只有这些候选中的一些被选择用于下一次迭代，这将被分配更多的资源。</li><li id="218c" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">对于参数调整，资源通常是训练样本的数量，但也可以是任意数字参数，如随机森林中的<code class="du oq or os ml b"><strong class="jz hj">n_estimators</strong></code>。</li></ul><h2 id="2b49" class="mp jg hi bd jh mu mv mw jl mx my mz jp kg na nb jr kk nc nd jt ko ne nf jv ng bi translated">3.1 —网格搜索减半</h2><blockquote class="lw"><p id="7123" class="lx ly hi bd lz ma mb mc md me mf ks dx translated">使用相同的超参数字典</p></blockquote><pre class="ny nz oa ob oc mk ml mm mn aw mo bi"><span id="99fb" class="mp jg hi ml b fi mq mr l ms mt">start_halvinggrid = time.time()</span><span id="f047" class="mp jg hi ml b fi ni mr l ms mt">Halving_grid_search = HalvingGridSearchCV(estimator = Rf_model, param_grid = para, cv = 5, verbose=1, random_state=42, n_jobs = -1)<br/># Fit the random search model<br/>Halving_grid_search.fit(x_train,y_train)</span><span id="db13" class="mp jg hi ml b fi ni mr l ms mt">end_halvinggrid = time.time()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ow"><img src="../Images/36799dfac8aa54088d067d85cba6c5eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*uxucNnj620IGKrtsOV84fA.png"/></div></figure><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="18e3" class="mp jg hi ml b fi mq mr l ms mt">halvinggridmodel_time = exec_time(start_halvinggrid,end_halvinggrid)<br/>halvinggridmodel_time</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="oj ok di ol bf om"><div class="er es ox"><img src="../Images/1e6c33a476379faf9f4d66199f74e459.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u4hAFmN6zqTcmIkfjyu7cA.png"/></div></div></figure><p id="7cd5" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">检查最佳参数</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="3f18" class="mp jg hi ml b fi mq mr l ms mt">Halving_grid_search.best_params_</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es oy"><img src="../Images/ebcefa81ce38ae1ea79be3e9b95fbbf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*4101f8MFpU_wwKkUqtHZ2Q.png"/></div></figure><p id="3691" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">列车组性能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="e1fc" class="mp jg hi ml b fi mq mr l ms mt">_, precision_halvinggridtrain, recall_halvinggridtrain, f1_halvinggridtrain = eval_model_train(Halving_grid_search)</span><span id="6b00" class="mp jg hi ml b fi ni mr l ms mt">print("Precision = {} \n Recall = {} \n f1 = {}".format(precision_halvinggridtrain, recall_halvinggridtrain, f1_halvinggridtrain))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es oz"><img src="../Images/ed68352721b450ff402af2607edbeead.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*vtXOtfqm0Gp4-UielHzZPQ.png"/></div></figure><p id="feae" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">测试集上的性能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="3c0e" class="mp jg hi ml b fi mq mr l ms mt">_, precision_halvinggridtest, recall_halvinggridtest, f1_halvinggridtest = eval_model_test(Halving_grid_search)</span><span id="2f8a" class="mp jg hi ml b fi ni mr l ms mt">print("Precision = {} \n Recall = {} \n f1 = {}".format(precision_halvinggridtest, recall_halvinggridtest, f1_halvinggridtest))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es pa"><img src="../Images/cf9f491617dec17e76dde4d48d717077.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*A5n67o1XKYwjNDu5xkbbFQ.png"/></div></figure><h2 id="b4dd" class="mp jg hi bd jh mu mv mw jl mx my mz jp kg na nb jr kk nc nd jt ko ne nf jv ng bi translated">3.2 —随机搜索减半</h2><blockquote class="lw"><p id="2ff5" class="lx ly hi bd lz ma mb mc md me mf ks dx translated">使用相同的超参数字典</p></blockquote><pre class="ny nz oa ob oc mk ml mm mn aw mo bi"><span id="97ec" class="mp jg hi ml b fi mq mr l ms mt">start_halvingrandom = time.time()</span><span id="9eca" class="mp jg hi ml b fi ni mr l ms mt">Halving_random_search = HalvingRandomSearchCV(estimator = Rf_model, param_distributions = para, cv = 5, n_jobs = -1, verbose = 1, )<br/># Fit the grid search model<br/>Halving_random_search.fit(x_train,y_train)</span><span id="ed00" class="mp jg hi ml b fi ni mr l ms mt">end_halvingrandom = time.time()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="oj ok di ol bf om"><div class="er es pb"><img src="../Images/2633190fdf0177a1a9bb0aabd5e92379.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aasnBMhN3F1et7H-M45zng.png"/></div></div></figure><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="f70f" class="mp jg hi ml b fi mq mr l ms mt">halvingrandommodel_time = exec_time(start_halvingrandom,end_halvingrandom)<br/>halvingrandommodel_time</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="oj ok di ol bf om"><div class="er es pc"><img src="../Images/8466988c42cd00df3596c61e407ba28f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZPS4kcJ5HmDZzirQ9LSAGA.png"/></div></div></figure><p id="92ab" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">检查最佳参数</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="a86a" class="mp jg hi ml b fi mq mr l ms mt">Halving_random_search.best_params_</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es pd"><img src="../Images/ed61d552470ff35ba9b826f37165a6c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*sirBNdDnm7WBfY8sAxkaOg.png"/></div></figure><p id="e7d7" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">列车组性能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="5422" class="mp jg hi ml b fi mq mr l ms mt">_, precision_halvingrandtrain, recall_halvingrandtrain, f1_halvingrandtrain = eval_model_train(Halving_random_search)</span><span id="121e" class="mp jg hi ml b fi ni mr l ms mt">print("Precision = {} \n Recall = {} \n f1 = {}".format(precision_halvingrandtrain, recall_halvingrandtrain, f1_halvingrandtrain))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="oj ok di ol bf om"><div class="er es pe"><img src="../Images/d04c75f262ad8ab948804e1afa7e6b48.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*iqWhdBeFZkNaVvAOReA5kA.png"/></div></div></figure><p id="aa85" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">测试集上的性能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="3301" class="mp jg hi ml b fi mq mr l ms mt">_, precision_halvingrandtest, recall_halvingrandtest, f1_halvingrandtest = eval_model_test(Halving_random_search)</span><span id="b710" class="mp jg hi ml b fi ni mr l ms mt">print("Precision = {} \n Recall = {} \n f1 = {}".format(precision_halvingrandtest, recall_halvingrandtest, f1_halvingrandtest))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es pf"><img src="../Images/eae17b4159169cc60c169c13198754b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*CE1U2pS6I3D2l5TTH2EfSQ.png"/></div></figure><blockquote class="lw"><p id="b161" class="lx ly hi bd lz ma nt nu nv nw nx ks dx translated">完整代码可以在我的<a class="ae mg" href="https://github.com/AbhigyanSingh97/Different_Hyperparameter_Tuning_Techniques" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>中找到。</p></blockquote><h1 id="4c90" class="jf jg hi bd jh ji jj jk jl jm jn jo jp io mh ip jr ir mi is jt iu mj iv jv jw bi translated">4.贝叶斯优化器:</h1><h2 id="5dcd" class="mp jg hi bd jh mu mv mw jl mx my mz jp kg na nb jr kk nc nd jt ko ne nf jv ng bi translated">4.1 —远视</h2><p id="eee9" class="pw-post-body-paragraph jx jy hi jz b ka kb ij kc kd ke im kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><a class="ae mg" href="https://github.com/hyperopt/hyperopt" rel="noopener ugc nofollow" target="_blank"> Hyperopt </a>是一个Python库，用于在笨拙的搜索空间上进行串行和并行优化，搜索空间可能包括实值、离散和条件维度。</p><p id="43e5" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">定义搜索空间</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="a267" class="mp jg hi ml b fi mq mr l ms mt">space = {<br/>    "n_estim ators": hp.choice("n_estimators",[200, 850 ,1500]),<br/>    "max_depth": hp.quniform("max_depth", 10, 80,5),<br/>    "max_features": hp.choice("max_features", ["auto", "sqrt"]),<br/>    "min_samples_split":hp.choice("min_samples_split",[2, 10, 15]),<br/>    "min_samples_leaf":hp.choice("min_samples_leaf",[1, 4, 9]),<br/>    "bootstrap": hp.choice("bootstrap",[True,False])<br/>}</span></pre><p id="ad09" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">定义函数最小化</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="d77d" class="mp jg hi ml b fi mq mr l ms mt">def tune_random(params):<br/>    rand = RandomForestClassifier(**params,n_jobs=-1)<br/>    score = cross_val_score(rand,<br/>                            x_train,y_train,scoring="f1",cv=5).mean()<br/>    return {"loss": score, "status": STATUS_OK}</span></pre><p id="30f7" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">最小化功能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="e2c4" class="mp jg hi ml b fi mq mr l ms mt">start_hpot = time.time()</span><span id="1a0f" class="mp jg hi ml b fi ni mr l ms mt">trials = Trials()</span><span id="20da" class="mp jg hi ml b fi ni mr l ms mt">best = fmin(<br/>    fn=tune_random,<br/>    space = space, <br/>    algo=tpe.suggest, <br/>    max_evals=100, <br/>    trials=trials<br/>)</span><span id="008c" class="mp jg hi ml b fi ni mr l ms mt">end_hpot = time.time()</span><span id="315c" class="mp jg hi ml b fi ni mr l ms mt">hpotmodel_time = exec_time(start_hpot,end_hpot)<br/>hpotmodel_time</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es pg"><img src="../Images/6402e7410b8266b1a2b93527e0a4bd3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*454n2SAktDQJ90U6HIiqaA.png"/></div></figure><p id="2b47" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">检查最佳参数</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="faed" class="mp jg hi ml b fi mq mr l ms mt">print("Best: {}".format(best))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="oj ok di ol bf om"><div class="er es ph"><img src="../Images/bd6d10f86cf6602ddffa956a1067053d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BnuIx0xeV1hVwo7IOpIOVA.png"/></div></div></figure><p id="3008" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">用一组最佳参数拟合基础模型</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="54cd" class="mp jg hi ml b fi mq mr l ms mt">rf_hyperopt = RandomForestClassifier(n_estimators=200,<br/>                                max_depth=35,<br/>                                max_features='auto',<br/>                                min_samples_split=10,<br/>                                min_samples_leaf=9,<br/>                                bootstrap = True).fit(x_train,y_train)</span></pre><p id="96ef" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">列车组性能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="0f5f" class="mp jg hi ml b fi mq mr l ms mt">_, precision_hptrain, recall_hptrain, f1_hptrain = eval_model_train(rf_hyperopt)</span><span id="dc37" class="mp jg hi ml b fi ni mr l ms mt">print("Precision = {} \n Recall = {} \n f1 = {}".format(precision_hptrain, recall_hptrain, f1_hptrain))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es pi"><img src="../Images/9cc8c039e42c20e1f7109cc8c22ee355.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*2MLksfd6YPJSUxeiotqmJw.png"/></div></figure><p id="ee93" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">测试集上的性能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="9593" class="mp jg hi ml b fi mq mr l ms mt">_, precision_hptest, recall_hptest, f1_hptest = eval_model_test(rf_hyperopt)</span><span id="5b0a" class="mp jg hi ml b fi ni mr l ms mt">print("Precision = {} \n Recall = {} \n f1 = {}".format(precision_hptest, recall_hptest, f1_hptest))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es pj"><img src="../Images/68a433037ba43141449f7557f00c11a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*GyDC6_cCtHmXNZO-4qgtRQ.png"/></div></figure><h2 id="3b5d" class="mp jg hi bd jh mu mv mw jl mx my mz jp kg na nb jr kk nc nd jt ko ne nf jv ng bi translated">4.2 — Optuna</h2><ul class=""><li id="da60" class="li lj hi jz b ka kb kd ke kg lk kk ll ko lm ks nm lo lp lq bi translated">热切的动态搜索空间</li><li id="8fd7" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">高效的采样和剪枝算法</li><li id="8947" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">易于集成</li><li id="9390" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">良好的可视化</li><li id="ebbc" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">分布式优化</li></ul><p id="d19a" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">定义功能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="ff65" class="mp jg hi ml b fi mq mr l ms mt">def objective(trial):<br/>  n_estimators = trial.suggest_int("n_estimators",200,1500)<br/>  max_features = trial.suggest_categorical("max_features",["auto","sqrt"])<br/>  max_depth = trial.suggest_int("max_depth",10,80,log = True)<br/>  min_samples_split = trial.suggest_int("min_samples_split",2,15)<br/>  min_samples_leaf = trial.suggest_int("min_samples_leaf",1,9)<br/>  bootstrap = trial.suggest_categorical("bootstrap",[True,False])<br/>  <br/>  rand = RandomForestClassifier(n_estimators=n_estimators,max_features=max_features,<br/>                                max_depth=max_depth,min_samples_leaf = min_samples_leaf,<br/>                                min_samples_split = min_samples_split,<br/>                                bootstrap = bootstrap)</span><span id="2ebd" class="mp jg hi ml b fi ni mr l ms mt">score_cr = cross_val_score(rand,<br/>                           x_train,<br/>                           y_train,<br/>                           n_jobs = -1,<br/>                           cv=5,<br/>                           scoring='f1')<br/>  score = score_cr.mean()</span><span id="757a" class="mp jg hi ml b fi ni mr l ms mt">return score</span></pre><p id="8ccf" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">创建研究</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="6fa0" class="mp jg hi ml b fi mq mr l ms mt">study = optuna.create_study(direction='minimize')</span></pre><p id="110a" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">最小化功能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="c341" class="mp jg hi ml b fi mq mr l ms mt">start_optuna = time.time()</span><span id="38c1" class="mp jg hi ml b fi ni mr l ms mt">optuna.logging.set_verbosity(optuna.logging.WARNING)<br/>study.optimize(objective, n_trials=100)</span><span id="6e3d" class="mp jg hi ml b fi ni mr l ms mt">end_optuna = time.time()</span><span id="d0a9" class="mp jg hi ml b fi ni mr l ms mt">optunamodel_time = exec_time(start_optuna,end_optuna)<br/>optunamodel_time</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es pk"><img src="../Images/831e3d2f81868b3ed41a5035162c7faa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*BD5nvznisHPg3YKdaOJeJA.png"/></div></figure><p id="3382" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">检查最佳参数</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="1573" class="mp jg hi ml b fi mq mr l ms mt">for key, value in study.best_trial.params.items():<br/>    print(f'{key}: {value}')</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es pl"><img src="../Images/859a5ea0cbcfdcb9220b13767585e4d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*bC7JvkkAVvoPxuJPQgwUYA.png"/></div></figure><p id="7773" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">用一组最佳参数拟合基础模型</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="7585" class="mp jg hi ml b fi mq mr l ms mt">rf_optuna = RandomForestClassifier(**study.best_trial.params).fit(x_train,y_train)</span></pre><p id="b622" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">列车上的表演</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="2e8f" class="mp jg hi ml b fi mq mr l ms mt">_, precision_opttrain, recall_opttrain, f1_opttrain = eval_model_train(rf_optuna)</span><span id="a434" class="mp jg hi ml b fi ni mr l ms mt">print("Precision = {} \n Recall = {} \n f1 = {}".format(precision_opttrain, recall_opttrain, f1_opttrain))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es pm"><img src="../Images/3b2e56e0b64a14012bbe49e1b09a2c34.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*CARzqRlP0pQYQV4zJyinkg.png"/></div></figure><p id="081e" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">测试集上的性能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="b876" class="mp jg hi ml b fi mq mr l ms mt">_, precision_opttest, recall_opttest, f1_opttest = eval_model_test(rf_optuna)</span><span id="a2d1" class="mp jg hi ml b fi ni mr l ms mt">print("Precision = {} \n Recall = {} \n f1 = {}".format(precision_opttest, recall_opttest, f1_opttest))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es pn"><img src="../Images/31382707fd21851fa674bc8f23ead6da.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*YdviWFtObAskzGCFS-4NSQ.png"/></div></figure><p id="b864" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">绘制优化历史</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="b9a9" class="mp jg hi ml b fi mq mr l ms mt">optuna.visualization.plot_optimization_history(study)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="oj ok di ol bf om"><div class="er es po"><img src="../Images/6e6923416310b47556d65cd1adbef1a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mTg2esC4dCpuDPH8Q-TbyQ.png"/></div></div></figure><h2 id="1943" class="mp jg hi bd jh mu mv mw jl mx my mz jp kg na nb jr kk nc nd jt ko ne nf jv ng bi translated">4.5—sci kit-优化</h2><ul class=""><li id="6a1f" class="li lj hi jz b ka kb kd ke kg lk kk ll ko lm ks nm lo lp lq bi translated">基于序列模型的优化</li><li id="609f" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">构建在NumPy、SciPy和Scikit-Learn之上</li><li id="0a45" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">开源，商业可用</li></ul><p id="0140" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">目的:<br/>定义搜索空间</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="9425" class="mp jg hi ml b fi mq mr l ms mt">space = [<br/>    Integer(200,1500,name = "n_estimators"),<br/>    Integer(10, 80, name = "max_depth"),<br/>    Categorical(["auto", "sqrt"], name = "max_features"),<br/>    Integer(2,15, name = "min_samples_split"),<br/>    Integer(1,9, name = "min_samples_leaf"),<br/>    Categorical([True,False], name = "bootstrap")<br/>]</span></pre><p id="e491" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">定义目标函数以最小化</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="73e4" class="mp jg hi ml b fi mq mr l ms mt"><a class="ae mg" href="http://twitter.com/use_named_args" rel="noopener ugc nofollow" target="_blank">@use_named_args</a>(space)# this wrapper/decorater uses the name we passed for the parameter</span><span id="c018" class="mp jg hi ml b fi ni mr l ms mt">def objective(**params):<br/>    Rf_model.set_params(**params)</span><span id="4d15" class="mp jg hi ml b fi ni mr l ms mt">return cross_val_score(Rf_model, <br/>                       x_train, <br/>                       y_train, <br/>                       cv=5, <br/>                       n_jobs=-1,<br/>                       scoring="f1").mean()</span></pre><p id="0808" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">最小化目标函数</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="51a7" class="mp jg hi ml b fi mq mr l ms mt">start_skopt = time.time()</span><span id="a427" class="mp jg hi ml b fi ni mr l ms mt">tune_rand_gp = gp_minimize(objective,space,random_state=1234)</span><span id="fcdf" class="mp jg hi ml b fi ni mr l ms mt">end_skopt = time.time()</span><span id="4ca6" class="mp jg hi ml b fi ni mr l ms mt">skoptmodel_time = exec_time(start_skopt,end_skopt)<br/>skoptmodel_time</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es pp"><img src="../Images/815e7fbf7135e6474a6ef34a5f265a27.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*3ySb7HVu9Yy6CaVpuUjd1Q.png"/></div></figure><p id="4f7f" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">检查最佳参数</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="5f87" class="mp jg hi ml b fi mq mr l ms mt">print(f"Best parameters: \n") <br/>print(f'n_estimators={tune_rand_gp.x[0]}')<br/>print(f'max_depth={tune_rand_gp.x[1]}')<br/>print(f'max_features={tune_rand_gp.x[2]}')<br/>print(f'min_samples_split={tune_rand_gp.x[3]}')<br/>print(f'min_samples_leaf={tune_rand_gp.x[4]}')<br/>print(f'bootstrap = {tune_rand_gp.x[5]}')</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es pq"><img src="../Images/97544591e2670ab21c26230c00446983.png" data-original-src="https://miro.medium.com/v2/resize:fit:482/format:webp/1*zroasZ5lZUZPDnQroYuHQQ.png"/></div></figure><p id="5ec1" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">用一组最佳参数拟合基础模型</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="1ede" class="mp jg hi ml b fi mq mr l ms mt">rf_skopt = RandomForestClassifier(n_estimators=200,<br/>                          max_depth=67,<br/>                          max_features='sqrt',<br/>                          min_samples_split=2,<br/>                          min_samples_leaf=9,<br/>                          bootstrap = True).fit(x_train,y_train)</span></pre><p id="b9fb" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">在列车上表演</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="8886" class="mp jg hi ml b fi mq mr l ms mt">_, precision_sktrain, recall_sktrain, f1_sktrain = eval_model_train(rf_skopt)</span><span id="9045" class="mp jg hi ml b fi ni mr l ms mt">print("Precision = {} \n Recall = {} \n f1 = {}".format(precision_sktrain, recall_sktrain, f1_sktrain))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es pr"><img src="../Images/22cb7834f7109434fac0bf9475fa86ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*WV6GA80e6XY4y-R-J2QBng.png"/></div></figure><p id="183d" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">测试集上的性能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="99aa" class="mp jg hi ml b fi mq mr l ms mt">_, precision_sktest, recall_sktest, f1_sktest = eval_model_test(rf_skopt)</span><span id="ce4f" class="mp jg hi ml b fi ni mr l ms mt">print("Precision = {} \n Recall = {} \n f1 = {}".format(precision_sktest, recall_sktest, f1_sktest))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es pn"><img src="../Images/a761e9ac2cc5754ed4354e499c683ef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*Yqo2LYGzmudwgFm126t4oA.png"/></div></figure><p id="c905" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">绘制收敛图</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="f875" class="mp jg hi ml b fi mq mr l ms mt">plot_convergence(tune_rand_gp)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es ps"><img src="../Images/b35b3187bf1d485b4f243f45fc70b546.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*sefjbqQGecdonbR9HzSGDw.png"/></div></figure><h2 id="1327" class="mp jg hi bd jh mu mv mw jl mx my mz jp kg na nb jr kk nc nd jt ko ne nf jv ng bi translated">4.4 — BayesSearchCV</h2><p id="b1f5" class="pw-post-body-paragraph jx jy hi jz b ka kb ij kc kd ke im kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">截至目前，BayesSearchCV与sklearn 0.24版本不兼容。使用BayesSearch将sklearn降级到0.23.2</p><p id="aa02" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">定义搜索空间</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="63d9" class="mp jg hi ml b fi mq mr l ms mt">param_bayes = {<br/>    "n_estimators": Integer(200,1500),<br/>    "max_depth": Integer(10, 80),<br/>    "max_features": Categorical(["auto", "sqrt"]),<br/>    "min_samples_split": Integer(2,15),<br/>    "min_samples_leaf": Integer(1,9),<br/>    "bootstrap": Categorical([True,False])<br/>}</span></pre><p id="8a2f" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">安装bayessearchCV </strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="b17e" class="mp jg hi ml b fi mq mr l ms mt">bayes_rf = BayesSearchCV(Rf_model, <br/>                         search_spaces = param_bayes, <br/>                         cv = 5, <br/>                         scoring="f1", <br/>                         refit=True)</span><span id="868f" class="mp jg hi ml b fi ni mr l ms mt">start_bayes = time.time()</span><span id="56a7" class="mp jg hi ml b fi ni mr l ms mt">bayes_rf.fit(x_train, y_train)</span><span id="b5b4" class="mp jg hi ml b fi ni mr l ms mt">end_bayes = time.time()</span><span id="0b70" class="mp jg hi ml b fi ni mr l ms mt">bayesmodel_time = exec_time(start_bayes,end_bayes)<br/>bayesmodel_time</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es pt"><img src="../Images/c66daf44c159297c0af1cb0e27875d90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*E1c9rfnOkV4273tWn0fjcg.png"/></div></figure><p id="aed8" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">检查最佳参数</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="32eb" class="mp jg hi ml b fi mq mr l ms mt">bayes_rf.best_params_</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es pu"><img src="../Images/f1656a39b9f7118ab021ded9bf977f82.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*vnzZGj2kxgmHWqj4RrRikg.png"/></div></figure><p id="9877" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">列车组性能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="0a4c" class="mp jg hi ml b fi mq mr l ms mt">_, precision_bayestrain, recall_bayestrain, f1_bayestrain = eval_model_train(bayes_rf)</span><span id="9ed0" class="mp jg hi ml b fi ni mr l ms mt">print("Precision = {} \n Recall = {} \n f1 = {}".format(precision_bayestrain, recall_bayestrain, f1_bayestrain))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es pv"><img src="../Images/8d5e21b20885073ee88809a20eb67288.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*aPW8iCOKqeS2cVZVmKtJoA.png"/></div></figure><p id="7204" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">测试集上的性能</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="d5b0" class="mp jg hi ml b fi mq mr l ms mt">_, precision_bayestest, recall_bayestest, f1_bayestest = eval_model_test(bayes_rf)</span><span id="c3f8" class="mp jg hi ml b fi ni mr l ms mt">print("Precision = {} \n Recall = {} \n f1 = {}".format(precision_bayestest, recall_bayestest, f1_bayestest))</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es pw"><img src="../Images/9dec29fe8763790c0e4d927fcc10cfd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*1bVDCi53P9lUtl845mtyeA.png"/></div></figure><p id="3fe9" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj">标绘目标</strong></p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="b08b" class="mp jg hi ml b fi mq mr l ms mt">bayes_rf_plot = plot_objective(bayes_rf.optimizer_results_[0],<br/>                   dimensions=["n_estimators", "max_depth", "max_features", "min_samples_split", "min_samples_leaf", "bootstrap"],<br/>                   n_minimum_search=int(1e8))<br/>plt.show()</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="oj ok di ol bf om"><div class="er es px"><img src="../Images/1ed9c6e513b2e56942938f4d4ba26915.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ckWKVrFK516LG_OqiqHTcw.png"/></div></div></figure><h1 id="276b" class="jf jg hi bd jh ji jj jk jl jm jn jo jp io jq ip jr ir js is jt iu ju iv jv jw bi translated">5.手动搜索:</h1><ul class=""><li id="a824" class="li lj hi jz b ka kb kd ke kg lk kk ll ko lm ks nm lo lp lq bi translated">可以根据我们的判断/经验进行手动搜索。</li><li id="d9c7" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">我们根据手动分配的随机值训练模型，评估其准确性并再次开始该过程。</li><li id="b95a" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">重复这一循环，直到达到令人满意的精确度。</li></ul></div><div class="ab cl py pz gp qa" role="separator"><span class="qb bw bk qc qd qe"/><span class="qb bw bk qc qd qe"/><span class="qb bw bk qc qd"/></div><div class="hb hc hd he hf"><h1 id="4d07" class="jf jg hi bd jh ji qf jk jl jm qg jo jp io qh ip jr ir qi is jt iu qj iv jv jw bi translated">参数和超参数之间的差异</h1><p id="12b1" class="pw-post-body-paragraph jx jy hi jz b ka kb ij kc kd ke im kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated"><strong class="jz hj"> →模型参数:</strong>这些是在模型运行和识别数据时学习的。<br/> <em class="kt">模型参数</em>因实验而异，完全取决于传递的数据类型和解决的任务。</p><p id="89f0" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">模型参数的一些示例包括:</p><ul class=""><li id="46c6" class="li lj hi jz b ka ku kd kv kg ot kk ou ko ov ks nm lo lp lq bi translated">人工神经网络(ANN)中的权重。</li><li id="9e50" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">支持向量机中的支持向量。</li><li id="ef48" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">线性回归或逻辑回归中的系数。</li><li id="413b" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">对于NLP任务:词频、句子长度、每个句子的名词或动词分布、每个单词的特定字符n元语法的数量、词汇多样性等。</li></ul><p id="f894" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated"><strong class="jz hj"> →超参数:</strong>这些是您的模型期望传递的值，以便在任何给定数据上为任何任务获得最佳性能。</p><p id="a919" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">模型超参数的一些例子包括:</p><ul class=""><li id="08a1" class="li lj hi jz b ka ku kd kv kg ot kk ou ko ov ks nm lo lp lq bi translated">训练神经网络的学习速率。</li><li id="aa7c" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">支持向量机的C和sigma超参数。</li><li id="92dd" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">k个最近邻中的k。</li><li id="ee4e" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated">决策树中树的深度</li></ul></div><div class="ab cl py pz gp qa" role="separator"><span class="qb bw bk qc qd qe"/><span class="qb bw bk qc qd qe"/><span class="qb bw bk qc qd"/></div><div class="hb hc hd he hf"><h1 id="8690" class="jf jg hi bd jh ji qf jk jl jm qg jo jp io qh ip jr ir qi is jt iu qj iv jv jw bi translated">参数和超参数之间的差异</h1><h1 id="9f08" class="jf jg hi bd jh ji jj jk jl jm jn jo jp io jq ip jr ir js is jt iu ju iv jv jw bi translated">结论</h1><p id="9ede" class="pw-post-body-paragraph jx jy hi jz b ka kb ij kc kd ke im kf kg kh ki kj kk kl km kn ko kp kq kr ks hb bi translated">在使用了所有不同的方法并根据结果创建了一个数据框架之后，我们可以比较每一种技术。</p><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="f688" class="mp jg hi ml b fi mq mr l ms mt">models = ['RandomForest', 'RandomForest_gridsearch', <br/>          'RandomForest_randomsearch', 'RandomForest_Halvinggrigd', <br/>          'RandomForest_Halvingrandom', 'RandomForest_hyperopt',       <br/>          'RandomForest_optuna', 'RandomForest_skopt', <br/>          'RandomForest_bayes']</span><span id="4dfa" class="mp jg hi ml b fi ni mr l ms mt">model_time = [basemodel_time, gridsearchmodel_time, <br/>              randomsearchmodel_time, halvinggridmodel_time,<br/>              halvingrandommodel_time, hpotmodel_time, <br/>              optunamodel_time, skoptmodel_time, bayesmodel_time]</span><span id="3566" class="mp jg hi ml b fi ni mr l ms mt">model_precision_train = [precision_basetrain, precision_gridtrain, <br/>                         precision_randtrain,               <br/>                         precision_halvinggridtrain, <br/>                         precision_halvingrandtrain, <br/>                         precision_hptrain, precision_opttrain, <br/>                         precision_sktrain, precision_bayestrain]</span><span id="2037" class="mp jg hi ml b fi ni mr l ms mt">model_recall_train = [recall_basetrain, recall_gridtrain, <br/>                      recall_randtrain, recall_halvinggridtrain, <br/>                      recall_halvingrandtrain, recall_hptrain, <br/>                      recall_opttrain, recall_sktrain, <br/>                      recall_bayestrain]</span><span id="f77b" class="mp jg hi ml b fi ni mr l ms mt">model_f1_train = [f1_basetrain, f1_gridtrain, f1_randtrain, <br/>                  f1_halvinggridtrain, <br/>                  f1_halvingrandtrain, f1_hptrain, f1_opttrain, <br/>                  f1_sktrain, f1_bayestrain]</span><span id="e5a0" class="mp jg hi ml b fi ni mr l ms mt">model_precision_test = [precision_basetest, precision_gridtest, <br/>                        precision_randtest, <br/>                        precision_halvinggridtest, <br/>                        precision_halvingrandtest, precision_hptest, <br/>                        precision_opttest, precision_sktest, <br/>                        precision_bayestest]</span><span id="2c92" class="mp jg hi ml b fi ni mr l ms mt">model_recall_test = [recall_basetest, recall_gridtest, <br/>                     recall_randtest, recall_halvinggridtest,<br/>                     recall_halvingrandtest, recall_hptest, <br/>                     recall_opttest, recall_sktest, <br/>                     recall_bayestest]</span><span id="e777" class="mp jg hi ml b fi ni mr l ms mt">model_f1_test = [f1_basetest, f1_gridtest, f1_randtest, <br/>                 f1_halvinggridtest, <br/>                 f1_halvingrandtest, f1_hptest, f1_opttest, <br/>                 f1_sktest, f1_bayestest]</span><span id="6238" class="mp jg hi ml b fi ni mr l ms mt">comp_dict = {"models":models, <br/>             "model_time":model_time, <br/>"model_precision_train":[round(i,3) for i in model_precision_train], <br/>"model_precision_test":[round(i,3) for i in model_precision_test],<br/>"model_recall_train":[round(i,3) for i in model_recall_train], <br/>"model_recall_test":[round(i,3) for i in model_recall_test],<br/>"model_f1_train":[round(i,3) for i in model_f1_train],<br/>"model_f1_test":[round(i,3) for i in model_f1_test]}</span><span id="3544" class="mp jg hi ml b fi ni mr l ms mt">comparison = pd.DataFrame(comp_dict)<br/>comparison</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="oj ok di ol bf om"><div class="er es qk"><img src="../Images/fc25d0d63174ad6e1278e4990a2726b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*li419U2ReJEFLnYlDAMmsw.png"/></div></div></figure><h2 id="c0a1" class="mp jg hi bd jh mu mv mw jl mx my mz jp kg na nb jr kk nc nd jt ko ne nf jv ng bi translated">→根据测试的f1分数进行分类</h2><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="c096" class="mp jg hi ml b fi mq mr l ms mt">comparison.set_index('models').sort_values('model_f1_test', ascending = False).head(3)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="oj ok di ol bf om"><div class="er es ql"><img src="../Images/0ae541eace44e8ca524e14323423c9c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b6pSBZ7LG2w9edLZaZuRHg.png"/></div></div></figure><h2 id="bec7" class="mp jg hi bd jh mu mv mw jl mx my mz jp kg na nb jr kk nc nd jt ko ne nf jv ng bi translated">→根据训练和测试f1分数之间的差异进行分类</h2><pre class="iy iz ja jb fd mk ml mm mn aw mo bi"><span id="0b73" class="mp jg hi ml b fi mq mr l ms mt">comparison['Diff_f1_train_test'] = np.abs(comparison['model_f1_train'] - comparison['model_f1_test'])<br/>comparison.set_index('models').sort_values('Diff_f1_train_test').head(3)</span></pre><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="oj ok di ol bf om"><div class="er es qm"><img src="../Images/0df3d36d635b06807e1ac67b4ec368af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gdRzML8UsQxT4KsozyHxow.png"/></div></div></figure><blockquote class="lw"><p id="863c" class="lx ly hi bd lz ma nt nu nv nw nx ks dx translated">之后，根据训练和设置测试的F1分数对值进行排序，结果表明贝叶斯技术效果最好。</p></blockquote><p id="9ccb" class="pw-post-body-paragraph jx jy hi jz b ka qn ij kc kd qo im kf kg qp ki kj kk qq km kn ko qr kq kr ks hb bi translated">然而，在生产环境中，我们不仅要得到最好的结果，而且要尽可能快地做到最好。</p><blockquote class="lw"><p id="fd28" class="lx ly hi bd lz ma mb mc md me mf ks dx translated">完整的代码可以在我的<a class="ae mg" href="https://github.com/AbhigyanSingh97/Different_Hyperparameter_Tuning_Techniques" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>中找到。</p></blockquote></div><div class="ab cl py pz gp qa" role="separator"><span class="qb bw bk qc qd qe"/><span class="qb bw bk qc qd qe"/><span class="qb bw bk qc qd"/></div><div class="hb hc hd he hf"><h1 id="e53d" class="jf jg hi bd jh ji qf jk jl jm qg jo jp io qh ip jr ir qi is jt iu qj iv jv jw bi translated">参考:</h1><ul class=""><li id="1670" class="li lj hi jz b ka kb kd ke kg lk kk ll ko lm ks nm lo lp lq bi translated">【https://arxiv.org/pdf/1710.04725.pdf T2】号</li><li id="7e30" class="li lj hi jz b ka lr kd ls kg lt kk lu ko lv ks nm lo lp lq bi translated"><a class="ae mg" href="https://machinelearningmastery.com/difference-between-a-parameter-and-a-hyperparameter/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/difference-a-parameter-and-a-hyperparameter/</a></li></ul></div><div class="ab cl py pz gp qa" role="separator"><span class="qb bw bk qc qd qe"/><span class="qb bw bk qc qd qe"/><span class="qb bw bk qc qd"/></div><div class="hb hc hd he hf"><p id="b39d" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">喜欢我的文章？请为我鼓掌并分享它，因为这将增强我的信心。此外，请查看我的另一篇文章，并与未来关于数据科学和机器学习基础系列的文章保持联系。</p><p id="e711" class="pw-post-body-paragraph jx jy hi jz b ka ku ij kc kd kv im kf kg kw ki kj kk kx km kn ko ky kq kr ks hb bi translated">还有，一定要在<a class="ae mg" href="http://www.linkedin.com/in/abhigyan-singh-b13651121" rel="noopener ugc nofollow" target="_blank"> <strong class="jz hj"> LinkedIn </strong> </a> <strong class="jz hj">上联系我。</strong></p><div class="qs qt ez fb qu qv"><a href="http://www.linkedin.com/in/abhigyan-singh-b13651121" rel="noopener  ugc nofollow" target="_blank"><div class="qw ab dw"><div class="qx ab qy cl cj qz"><h2 class="bd hj fi z dy ra ea eb rb ed ef hh bi translated">Abhigyan Singh -印度卡纳塔克邦班加罗尔市区|职业简介| LinkedIn</h2><div class="rc l"><h3 class="bd b fi z dy ra ea eb rb ed ef dx translated">数据科学和机器学习爱好者。我在medium上写关于数据科学和机器学习的文章…</h3></div><div class="rd l"><p class="bd b fp z dy ra ea eb rb ed ef dx translated">www.linkedin.com</p></div></div><div class="re l"><div class="rf l rg rh ri re rj jd qv"/></div></div></a></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="oj ok di ol bf om"><div class="er es rk"><img src="../Images/3516da5c95d96a8532a1faafdf1ff401.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bzHJvAqSXQ73V9qn"/></div></div><figcaption class="rl rm et er es rn ro bd b be z dx translated"><a class="ae mg" href="https://unsplash.com/@alx_andru?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Alex </a>在<a class="ae mg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure></div></div>    
</body>
</html>