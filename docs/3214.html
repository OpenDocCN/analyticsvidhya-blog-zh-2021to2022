<html>
<head>
<title>Kernel Support Vector Machines from Scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从零开始的核支持向量机</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/kernel-support-vector-machines-from-scratch-483ebd4175c?source=collection_archive---------4-----------------------#2021-06-19">https://medium.com/analytics-vidhya/kernel-support-vector-machines-from-scratch-483ebd4175c?source=collection_archive---------4-----------------------#2021-06-19</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9f26b092f2e38c107ab52edcdbdcc64f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xz4PICg9afQg2Ws3LTJvJA.jpeg"/></div></div></figure><p id="dc6d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> SVM </strong>(支持向量机)是一种<strong class="is hj">监督的</strong> <strong class="is hj">机器学习</strong>算法，通常用于<strong class="is hj">二分类问题</strong>。这就是为什么训练数据可用于训练模型。</p><p id="03c0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">SVM背后有三个主要想法:</p><ul class=""><li id="6e1f" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated"><strong class="is hj">最大边距分隔符</strong>:画一条线或超平面，使分隔符和训练数据之间的距离最大化，从而引入一个边距块</li><li id="e07c" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated"><strong class="is hj">软页边距分隔符</strong>:当不同标签的数据混淆时，考虑页边距内的样本，画出最佳分隔线</li><li id="8b87" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn jt ju jv jw bi translated"><strong class="is hj">内核技巧</strong>:对于数据分离边界不是线性的更复杂的模型，允许使用高阶多项式甚至非多项式函数</li></ul><p id="320e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在本文中，让我们以一种描述性的方式来讨论SVM和内核的使用。</p><p id="d711" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">SVM使用核函数在更高维度中绘制支持向量分类器。内核函数的类型有:</p><ol class=""><li id="71d7" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn kc ju jv jw bi translated">线性的</li><li id="ecc1" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn kc ju jv jw bi translated">多项式</li><li id="07eb" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn kc ju jv jw bi translated">径向基函数</li></ol><p id="2a8b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Kernel trick实际上是指使用高效且成本较低的方式将数据转换到更高维度。</p><p id="de25" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">核函数只计算每一对点之间的关系，就好像它们在更高维度中一样；他们实际上并没有进行转化。这种计算高维度关系而不实际将数据转换到更高维度的技巧被称为<strong class="is hj">内核技巧</strong>。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kd"><img src="../Images/f8b49031259616f37615e7f50e422434.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8pcHwrCmKbcQRWXflgv4gg.png"/></div></div></figure><p id="be63" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们深入编码吧！</p><p id="98ac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">将遵循以下步骤。</p><h1 id="05a9" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">1.按照数据挖掘过程中的指定对数据集进行预处理</h1><p id="f7e5" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">正在读取数据集。</p><p id="c38a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">该数据与一家葡萄牙银行机构的直接营销活动相关。营销活动以电话为基础。通常，同一个客户需要不止一个联系人，以了解产品(银行定期存款)是否认购(“是”)或不认购(“否”)。目标是预测客户是否会认购定期存款。可以通过使用给定的链接来访问数据集。<a class="ae ll" href="https://archive.ics.uci.edu/ml/datasets/bank+marketing#" rel="noopener ugc nofollow" target="_blank">https://archive.ics.uci.edu/ml/datasets/bank+marketing#</a></p><p id="a857" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">以下代码片段可用于将银行数据CSV文件加载到pandas数据框中，它将显示前10个数据点。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es lm"><img src="../Images/815703998b6513939dd77ad716f83cd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*lCC9qKMeh_lMgrcLcjHOVg.png"/></div></figure><p id="143c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">可以使用' df_original.info()'和' df_original.describe()'进一步分析数据集。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ln"><img src="../Images/294eab23b9bb6b4783f31970d1b46375.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Sc1TJAM_K6g31v5WLp5AQ.png"/></div></div></figure><p id="5f3d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">处理缺失值和异常值。</p><p id="0511" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要进行预测，首先需要进行数据清洗。第一步，如果数据集中有缺失值，则将其删除。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es lo"><img src="../Images/666f985c4617acf6178fc5caa3508a9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*prC8voCKa5P_72RmEsriEg.png"/></div></figure><p id="66e9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由于输出为false，因此该数据集中没有缺失值。为了检查是否有异常值，首先需要绘制箱线图。离群值是远离其余数据点的值。看不出任何异常值。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es lp"><img src="../Images/2f40836b9de085e55ecba326fbe4fa5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*QyLhUvvW8StG0fFBsDw5iA.png"/></div></figure><p id="4725" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Q-Q图和直方图。</p><p id="643b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过绘制Q-Q图和直方图，我们可以分析是否需要进行转换，以及需要哪些功能。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es lq"><img src="../Images/715b6160ca1bfc4ebad21ed32def053d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*PGG9yaofjMJtwYfCJv2oXg.png"/></div></figure><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es lr"><img src="../Images/e109809d2f145faa9ba7f76fbab6f293.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*L-5LzKUf8ukLMhjywYQEkg.png"/></div></figure><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es ls"><img src="../Images/c5f3bc3e1a2cccc7c7c12d80de980636.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*qg5F-LwgCKw13_AnwvI8QQ.png"/></div></figure><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es lt"><img src="../Images/d43c4c0431972a42a2f9aa7fb88d3c67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*jLj-3hTKpmpxMl9SwIjicg.png"/></div></figure><p id="1de0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如上所示，可以为每个特征绘制概率图来分析行为，通过直方图，我们可以看到‘年龄’、‘持续时间’、‘活动’、‘先前’是右偏的，而nr.employed是左偏的。因此，它需要做一个转变。</p><p id="8d5b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">转变。</p><p id="e14f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为了确定是否需要转换，可以使用Q-Q图和直方图。然后可以识别数据点是否处于正态分布。绘制直方图和Q-Q图后，我们可以看到一个特征是右偏还是左偏。如果一个特征是右偏的，我们使用平方根变换，如果是左偏的，我们使用平方变换将它们调整到正态分布。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lu"><img src="../Images/df6635adf4eb479c15ecaa37dcec9c7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U7HrRMxzvNCKiVUDne0tqQ.png"/></div></div></figure><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lv"><img src="../Images/4baea1dc8732c3e6761b2e0019d63d7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1w5PjUR0l67fTXmkHxRzlg.png"/></div></div></figure><p id="ebed" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">转换年龄特征后，Q-Q图和直方图如下所示。同样，根据需要对特征进行规范化。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lw"><img src="../Images/04dd2d678bac0b0d882f53bbdc4300df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKrf70FIjERNmwZUvZKT8Q.png"/></div></div></figure><p id="9032" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">特征编码。</p><p id="9f85" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">特征编码的目的是将分类文本数据转换成数值。这里我们有两种方法，</p><ol class=""><li id="0e07" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn kc ju jv jw bi translated">一键编码</li><li id="b760" class="jo jp hi is b it jx ix jy jb jz jf ka jj kb jn kc ju jv jw bi translated">标签编码</li></ol><p id="0942" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在一次性编码中，我们使用向量，在标签编码中，我们使用整数作为标签。当有一个或两个类别时，一个热编码是最好的。但是当新的特征被添加到数据集时，很难使用一次性编码。如果有许多类别，标签编码是有用的，它也是一种流行的特征编码方式。</p><p id="b811" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于特征编码，将为分类特征创建一个单独的数据框，并使用一键编码对裂缝“y”进行编码。那么y柱已经被选择作为要预测的目标。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lx"><img src="../Images/cd7469c12bf21372dc549fea80bea8fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8UaWnQbnt71mjz005OrQCA.png"/></div></div></figure><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/3f8a443e5a09c603a07ead1c9f105ff9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2L0cCxpOq42ZQiaQPvvyag.png"/></div></div></figure><p id="c5bf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">标准化的特征。</p><p id="a0f3" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对特征进行缩放和/或标准化，使平均值=0，标准偏差=1。我们不应该缩放分类变量。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es lz"><img src="../Images/4ad2fcf5765f8d43e19402dd8629e7d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*xOvACw24m3g_6pu0XxsV8A.png"/></div></figure><p id="58bf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">列车测试分离</p><p id="a99f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在继续其余部分之前，让我们将整个数据集分成训练数据集和测试数据集。</p><p id="e763" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们应该预测的特征也应该从数据集的其余部分中分离出来。在我们的例子中，这将是“y”。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ma"><img src="../Images/c845f3b10d62a5e9c5b05dd6d301b2df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tGYmjaXGhicRYbEkzApPyA.png"/></div></div></figure><p id="a8e7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">相关矩阵</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mb"><img src="../Images/c8ae6e5203a2e1a91233ddebeaf03260.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-eQo858hGVvtfSzq9VPUcQ.png"/></div></div></figure><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es mc"><img src="../Images/d637c4cba3f6a872374fa306f41d3cb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*ZdBmkYxlTeCx3MjWgT--2w.png"/></div></figure><p id="a173" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">由于nr.employed和euribor3m高度相关，因此可以删除一个功能。因此，euribor3m已被放弃。</p><h1 id="14d4" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">2.使用主成分分析的特征工程</h1><p id="6f54" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">对于降维，可以使用主成分分析(PCA)或奇异值分解(SVD)。这里我用了PCA。PCA将数据集中的维度投影到特征向量空间。然后，我们可以得到方差比来决定哪些特征将被丢弃。</p><p id="a718" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通过查看PCA对象解释的variance_ratio，我们可以决定在不影响实际数据的情况下可以减少多少个要素(组件)。我选择了4个组件来获得超过99%的高方差维度。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es md"><img src="../Images/37abcd05ab1e6e3a3064f216f410eb68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fQ4EZiCaFmHEPzUBG006cA.png"/></div></div></figure><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es me"><img src="../Images/fe4b8df156cbe3814d49f2cee14d75cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*DM_75EaYd2nQF7L5YTOpzg.png"/></div></figure><h1 id="83ab" class="ki kj hi bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">3.应用具有核的支持向量机(SVM)来预测该值</h1><p id="fd31" class="pw-post-body-paragraph iq ir hi is b it lg iv iw ix lh iz ja jb li jd je jf lj jh ji jj lk jl jm jn hb bi translated">我使用了“rbf”核，其中C=1.2，gamma=0.5，以获得高精度测量。</p><p id="2dcd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">gamma</strong>:RBF、poly、sigmoid的核系数。更高的伽马值将试图精确地拟合每个训练数据集，即泛化误差，并导致过拟合问题。</p><p id="d15a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> C: </strong>误差项的惩罚参数C。它还控制平滑决策边界和正确分类训练点之间的权衡。</p><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mf"><img src="../Images/94f77f1a78de3a90c6ed069617117063.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BtB8xVfdaK1dRZQsb5LrYQ.png"/></div></div></figure><figure class="ke kf kg kh fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mg"><img src="../Images/0a9b8ee42f98697518448d996617a202.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zPL8T7b2FE8X7Fj7KOgVbA.png"/></div></div></figure><figure class="ke kf kg kh fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/9fa135b2af013cc9273bdc5939dfcefd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*AkPncPAA9LeyY3dDbHmcKQ.png"/></div></figure></div></div>    
</body>
</html>