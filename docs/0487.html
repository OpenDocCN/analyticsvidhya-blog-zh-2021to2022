<html>
<head>
<title>Crime Data Pattern Analysis and Visualization using K-means Clustering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于K均值聚类的犯罪数据模式分析与可视化</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/crime-data-pattern-analysis-and-visualization-using-k-means-clustering-ceeb963a2b47?source=collection_archive---------9-----------------------#2021-01-18">https://medium.com/analytics-vidhya/crime-data-pattern-analysis-and-visualization-using-k-means-clustering-ceeb963a2b47?source=collection_archive---------9-----------------------#2021-01-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="e86c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jc">犯罪模式分析</em> </strong> <em class="jc">通过发现特定犯罪可能发生的地点、时间和原因，揭示犯罪事件之间潜在的交互过程。这些结果提高了我们对非法活动动态的理解，并可以增强预测性警务。</em></p><blockquote class="jd je jf"><p id="0ebb" class="ie if jc ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">关于K-均值聚类的更多信息:<a class="ae jj" rel="noopener" href="/analytics-vidhya/everything-you-need-to-know-about-k-means-clustering-88ad4058cce0"> <strong class="ig hi">关于K-均值聚类你需要知道的一切</strong> </a></p></blockquote><p id="c5fc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc"> Wget所需数据</em> <a class="ae jj" href="https://raw.githubusercontent.com/namanvashistha/doctor_strange/master/crime.csv" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi"> <em class="jc">此链接</em></strong></a><strong class="ig hi"><em class="jc">:</em></strong></p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="de36" class="jt ju hh jp b fi jv jw l jx jy">!wget https://raw.githubusercontent.com/namanvashistha/doctor_strange/master/crime.csv</span></pre><p id="50a5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">导入库:</em></p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="eebf" class="jt ju hh jp b fi jv jw l jx jy">import pandas as pd<br/>import numpy as np<br/>from matplotlib import pyplot as plt</span></pre><p id="b38d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">读取并显示数据:</em></p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="6bf0" class="jt ju hh jp b fi jv jw l jx jy">data = pd.read_csv("crime.csv")<br/>data</span></pre><figure class="jk jl jm jn fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es jz"><img src="../Images/1d803a7beaa9e7cbda2fc58ca8d894ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ur0JS_1fGuoie9scHAXHZg.png"/></div></div></figure><p id="8bc0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">K——从头开始的意思:</em></p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="fbea" class="jt ju hh jp b fi jv jw l jx jy">np.random.seed(42)<br/><br/>def euclidean_distance(x1, x2):<br/>    return np.sqrt(np.sum((x1 - x2)**2))<br/><br/>class KMeans():<br/><br/>    def __init__(self, K=5, max_iters=100, plot_steps=False):<br/>        self.K = K<br/>        self.max_iters = max_iters<br/>        self.plot_steps = plot_steps<br/><br/>        <em class="jc"># list of sample indices for each cluster</em><br/>        self.clusters = [[] for _ in range(self.K)]<br/>        <em class="jc"># the centers (mean feature vector) for each cluster</em><br/>        self.centroids = []<br/><br/>    def predict(self, X):<br/>        self.X = X<br/>        self.n_samples, self.n_features = X.shape<br/>        <br/>        <em class="jc"># initialize </em><br/>        random_sample_idxs = np.random.choice(self.n_samples, self.K, replace=False)<br/>        self.centroids = [self.X[idx] for idx in random_sample_idxs]<br/><br/>        <em class="jc"># Optimize clusters</em><br/>        for _ in range(self.max_iters):<br/>            <em class="jc"># Assign samples to closest centroids (create clusters)</em><br/>            self.clusters = self._create_clusters(self.centroids)<br/>            if self.plot_steps:<br/>                self.plot()<br/><br/>            <em class="jc"># Calculate new centroids from the clusters</em><br/>            centroids_old = self.centroids<br/>            self.centroids = self._get_centroids(self.clusters)<br/>            <br/>            <em class="jc"># check if clusters have changed</em><br/>            if self._is_converged(centroids_old, self.centroids):<br/>                break<br/><br/>            if self.plot_steps:<br/>                self.plot()<br/><br/>        <em class="jc"># Classify samples as the index of their clusters</em><br/>        return self._get_cluster_labels(self.clusters)<br/><br/><br/>    def _get_cluster_labels(self, clusters):<br/>        <em class="jc"># each sample will get the label of the cluster it was assigned to</em><br/>        labels = np.empty(self.n_samples)<br/><br/>        for cluster_idx, cluster in enumerate(clusters):<br/>            for sample_index in cluster:<br/>                labels[sample_index] = cluster_idx<br/>        return labels<br/><br/>    def _create_clusters(self, centroids):<br/>        <em class="jc"># Assign the samples to the closest centroids to create clusters</em><br/>        clusters = [[] for _ in range(self.K)]<br/>        for idx, sample in enumerate(self.X):<br/>            centroid_idx = self._closest_centroid(sample, centroids)<br/>            clusters[centroid_idx].append(idx)<br/>        return clusters<br/><br/>    def _closest_centroid(self, sample, centroids):<br/>        <em class="jc"># distance of the current sample to each centroid</em><br/>        distances = [euclidean_distance(sample, point) for point in centroids]<br/>        closest_index = np.argmin(distances)<br/>        return closest_index<br/><br/>    def _get_centroids(self, clusters):<br/>        <em class="jc"># assign mean value of clusters to centroids</em><br/>        centroids = np.zeros((self.K, self.n_features))<br/>        for cluster_idx, cluster in enumerate(clusters):<br/>            cluster_mean = np.mean(self.X[cluster], axis=0)<br/>            centroids[cluster_idx] = cluster_mean<br/>        return centroids<br/><br/>    def _is_converged(self, centroids_old, centroids):<br/>        <em class="jc"># distances between each old and new centroids, fol all centroids</em><br/>        distances = [euclidean_distance(centroids_old[i], centroids[i]) for i in range(self.K)]<br/>        return sum(distances) == 0<br/><br/>    def plot(self):<br/>        fig, ax = plt.subplots(figsize=(12, 8))<br/><br/>        for i, index in enumerate(self.clusters):<br/>            point = self.X[index].T<br/>            ax.scatter(*point)<br/><br/>        for point in self.centroids:<br/>            ax.scatter(*point, marker="x", color='black', linewidth=2)<br/><br/>        plt.show()<br/>    def cent(self):<br/>        return self.centroids</span></pre><p id="ce04" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">检查我们唯一的量值列:</em></p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="4ec7" class="jt ju hh jp b fi jv jw l jx jy">data.Magnitude.unique()</span><span id="3b90" class="jt ju hh jp b fi kh jw l jx jy"><strong class="jp hi">Out:<br/></strong>array(['4', '6', '16', '12', '8', '10', '2', 'ARSON', '14'], dtype=object)</span></pre><p id="d8bc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">我们有一个未知值叫做“纵火”</em></p><blockquote class="jd je jf"><p id="73a4" class="ie if jc ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated"><strong class="ig hi">放火罪</strong>是指故意、恶意放火或者焚烧财物的犯罪行为。来源:<a class="ae jj" href="https://en.wikipedia.org/wiki/Arson" rel="noopener ugc nofollow" target="_blank"> <strong class="ig hi">维基百科</strong> </a></p></blockquote><p id="3006" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将只考虑纬度和经度来绘图:</p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="6c4e" class="jt ju hh jp b fi jv jw l jx jy">plt.scatter(data.Latitude,data.Longitude)<br/>plt.xlabel('Latitude')<br/>plt.ylabel('Longitude')</span></pre><figure class="jk jl jm jn fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ki"><img src="../Images/f28dbbf580be5c456d1ed9cb28922895.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cX8SqNZmZjJAilwBQMSvlQ.png"/></div></div></figure><p id="ae01" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">检查Nan值:</em></p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="51da" class="jt ju hh jp b fi jv jw l jx jy">data.isna().sum()</span><span id="8dbf" class="jt ju hh jp b fi kh jw l jx jy"><strong class="jp hi">Out:</strong><br/>Date         0 <br/>Latitude     0 <br/>Longitude    0 <br/>Magnitude    0 <br/>dtype: int64</span></pre><p id="ab9a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">给出我们的X值:</em></p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="ff95" class="jt ju hh jp b fi jv jw l jx jy">X = data[['Latitude', 'Longitude']]<br/>X = np.array(X)</span></pre><p id="21f2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">导入内置的sklearn.cluster模块计算WSS: </em></p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="3365" class="jt ju hh jp b fi jv jw l jx jy">from sklearn.cluster import KMeans<br/>import plotly.graph_objects as go</span></pre><p id="b875" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">计算范围(1，50)内K值的WSS:</em></p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="ad7e" class="jt ju hh jp b fi jv jw l jx jy">wss = []<br/>K = []<br/>k_rng = range(1,50)<br/>for k in k_rng:<br/>    km = KMeans(n_clusters=k)<br/>    km.fit(X)<br/>    wss.append(km.inertia_)<br/>    K.append(k)<br/>plt.xlabel('K Values')<br/>plt.ylabel('WSS')<br/>axes= plt.axes()<br/>axes.set_xticks(K)<br/>plt.grid()<br/>plt.plot(k_rng,wss)</span></pre><figure class="jk jl jm jn fd ka er es paragraph-image"><div class="er es kj"><img src="../Images/8b16883c953622340133f20a76fada4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*TRogAI9UVB5wQrJsPjnasw.png"/></div></figure><p id="2ca9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">根据Elbow技术，K的最佳值是5，因此我们将为相同的K值实现K means:</em></p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="0a10" class="jt ju hh jp b fi jv jw l jx jy">k = KMeans(K=5, max_iters=150, plot_steps=True)<br/>y_pred = k.predict(X)<br/>k.plot()</span></pre><figure class="jk jl jm jn fd ka er es paragraph-image"><div class="er es kk"><img src="../Images/975cae11a7a83833188b08676108a9cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*ig6JdqZQVOrozm8GpozACA.png"/></div><figcaption class="kl km et er es kn ko bd b be z dx">……………..</figcaption></figure><figure class="jk jl jm jn fd ka er es paragraph-image"><div class="er es kp"><img src="../Images/071650b12a2378a369c6ee76df27a340.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*nvf7OmynFou0XwcYBqeAtQ.png"/></div></figure><p id="61ea" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="jc">现在，我们将未知值“纵火”替换为其他震级值的平均值:</em></p><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="2a0e" class="jt ju hh jp b fi jv jw l jx jy">arr = data.Magnitude.unique()<br/>arr = np.delete(arr, 7)<br/>arr = arr.astype(int)<br/>avg = np.average(arr)<br/>avg</span><span id="e57d" class="jt ju hh jp b fi kh jw l jx jy"><strong class="jp hi">Out:<br/></strong>9.0</span><span id="dfe9" class="jt ju hh jp b fi kh jw l jx jy">data.Magnitude = data.Magnitude.replace(to_replace ="ARSON",value ="9")<br/>data.Magnitude.unique()</span><span id="da65" class="jt ju hh jp b fi kh jw l jx jy"><strong class="jp hi">Out:<br/></strong>array(['4', '6', '16', '12', '8', '10', '2', '9', '14'], dtype=object)</span><span id="45f0" class="jt ju hh jp b fi kh jw l jx jy">data['Magnitude'] = data['Magnitude'].astype(int)<br/>data.Magnitude.unique()</span><span id="2dac" class="jt ju hh jp b fi kh jw l jx jy"><strong class="jp hi">Out:<br/></strong>array([ 4,  6, 16, 12,  8, 10,  2,  9, 14])</span><span id="a279" class="jt ju hh jp b fi kh jw l jx jy">X = data[['Latitude', 'Longitude', 'Magnitude']]<br/>X = np.array(X)<br/>X</span></pre><figure class="jk jl jm jn fd ka er es paragraph-image"><div class="er es kq"><img src="../Images/3eb4738d17ca7e5e6b205031898290ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*FBYn5Zr0_MlA9uJJnVvjBQ.png"/></div></figure><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="1d28" class="jt ju hh jp b fi jv jw l jx jy">wss = []<br/>K = []<br/>k_rng = range(1,50)<br/>for k in k_rng:<br/>    km = KMeans(n_clusters=k)<br/>    km.fit(X)<br/>    wss.append(km.inertia_)<br/>    K.append(k)<br/>plt.xlabel('K Values')<br/>plt.ylabel('WSS')<br/>axes= plt.axes()<br/>axes.set_xticks(K)<br/>plt.grid()<br/>plt.plot(k_rng,wss)</span></pre><figure class="jk jl jm jn fd ka er es paragraph-image"><div class="er es kr"><img src="../Images/c48c74899e6e959fef24ef20c4adcaf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*nW0DW0xlBKdXJ0iE3zvBmA.png"/></div></figure><blockquote class="jd je jf"><p id="6ca5" class="ie if jc ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">看起来K=5又是我们的最佳K值</p></blockquote><pre class="jk jl jm jn fd jo jp jq jr aw js bi"><span id="7b5a" class="jt ju hh jp b fi jv jw l jx jy">k = KMeans(K=5, max_iters=150, plot_steps=True)<br/>y_pred = k.predict(X)<br/>k.plot()</span></pre><figure class="jk jl jm jn fd ka er es paragraph-image"><div role="button" tabindex="0" class="kb kc di kd bf ke"><div class="er es ks"><img src="../Images/1620eff6f5e11572b44af8007af7c045.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*pcpxo9pMsA_Da3kNVIgD5A.png"/></div></div></figure><figure class="jk jl jm jn fd ka er es paragraph-image"><div class="er es ks"><img src="../Images/28b45948c2dab769c3586daf52e8210a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*Lml-hY2GsJ2vUX-_RIarJA.png"/></div></figure><figure class="jk jl jm jn fd ka er es paragraph-image"><div class="er es kt"><img src="../Images/614cdb2fa9ac300ae9908c678b3e274e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*i3qF0jdsoa8y_4kVmQ_zWQ.png"/></div></figure><blockquote class="jd je jf"><p id="7e87" class="ie if jc ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">我知道一下子很难接受。但是你坚持到了最后！恭喜你。不要忘记看看我即将发表的文章！</p></blockquote><h1 id="5c3c" class="ku ju hh bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">其他资源和参考</h1><div class="lr ls ez fb lt lu"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/everything-you-need-to-know-about-k-means-clustering-88ad4058cce0"><div class="lv ab dw"><div class="lw ab lx cl cj ly"><h2 class="bd hi fi z dy lz ea eb ma ed ef hg bi translated">关于K-均值聚类你需要知道的一切</h2><div class="mb l"><h3 class="bd b fi z dy lz ea eb ma ed ef dx translated">如果您想知道K-means聚类是怎么一回事，那么您就来对地方了！让我们快速开始，不要…</h3></div><div class="mc l"><p class="bd b fp z dy lz ea eb ma ed ef dx translated">medium.com</p></div></div><div class="md l"><div class="me l mf mg mh md mi kf lu"/></div></div></a></div><div class="lr ls ez fb lt lu"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/extracting-dominant-colours-in-an-image-using-k-means-clustering-from-scratch-2ce79a3eea5d"><div class="lv ab dw"><div class="lw ab lx cl cj ly"><h2 class="bd hi fi z dy lz ea eb ma ed ef hg bi translated">从零开始使用K-均值聚类提取图像中的主色</h2><div class="mb l"><h3 class="bd b fi z dy lz ea eb ma ed ef dx translated">从头开始，在不到5分钟的时间内从您选择的任何图像中提取主色！</h3></div><div class="mc l"><p class="bd b fp z dy lz ea eb ma ed ef dx translated">medium.com</p></div></div><div class="md l"><div class="mj l mf mg mh md mi kf lu"/></div></div></a></div><div class="lr ls ez fb lt lu"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/image-segmentation-using-k-means-clustering-from-scratch-1545c896e38e"><div class="lv ab dw"><div class="lw ab lx cl cj ly"><h2 class="bd hi fi z dy lz ea eb ma ed ef hg bi translated">从头开始使用K-均值聚类的图像分割</h2><div class="mb l"><h3 class="bd b fi z dy lz ea eb ma ed ef dx translated">在数字图像处理和计算机视觉中，图像分割是将一幅数字图像分割成几个部分的过程</h3></div><div class="mc l"><p class="bd b fp z dy lz ea eb ma ed ef dx translated">medium.com</p></div></div><div class="md l"><div class="mk l mf mg mh md mi kf lu"/></div></div></a></div><p id="f616" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> <em class="jc">完整代码实现:</em> </strong></p><div class="lr ls ez fb lt lu"><a href="https://github.com/tanvipenumudy/Winter-Internship-Internity/blob/main/Day%2011/Day-11%20Notebook-3%20%28Crime%20Data%20Analysis%29.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="lv ab dw"><div class="lw ab lx cl cj ly"><h2 class="bd hi fi z dy lz ea eb ma ed ef hg bi translated">tanvipenumudy/Winter-实习-实习</h2><div class="mb l"><h3 class="bd b fi z dy lz ea eb ma ed ef dx translated">存储库跟踪每天分配的工作-tanvipenumudy/Winter-实习-实习</h3></div><div class="mc l"><p class="bd b fp z dy lz ea eb ma ed ef dx translated">github.com</p></div></div><div class="md l"><div class="ml l mf mg mh md mi kf lu"/></div></div></a></div><blockquote class="jd je jf"><p id="2235" class="ie if jc ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated">希望你喜欢并充分利用这篇文章！敬请关注我即将发布的博客！如果你觉得我的内容有帮助/有帮助，请确保<strong class="ig hi">鼓掌</strong>和<strong class="ig hi">跟着</strong>！</p></blockquote></div></div>    
</body>
</html>