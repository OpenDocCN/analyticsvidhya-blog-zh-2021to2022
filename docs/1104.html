<html>
<head>
<title>COVID-19 Sentiment Analysis using Logistic Regression and LSTM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用逻辑回归和LSTM的新冠肺炎情感分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/covid-19-sentiment-analysis-using-logistic-regression-and-lstm-bab3ca6d33a1?source=collection_archive---------14-----------------------#2021-02-14">https://medium.com/analytics-vidhya/covid-19-sentiment-analysis-using-logistic-regression-and-lstm-bab3ca6d33a1?source=collection_archive---------14-----------------------#2021-02-14</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><h1 id="4457" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">背景:</h1><p id="4935" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">使用来自<a class="ae ka" href="https://www.kaggle.com/datatattle/covid-19-nlp-text-classification" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>的新冠肺炎数据集，使用逻辑回归和LSTM建立情感分析模型。</p><h1 id="2816" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">数据预处理:</h1><p id="bef6" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我导入了所需的库，使预处理成为可能。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kb"><img src="../Images/14b98f09d675fa0ba25553b6334e90c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WDFFHm9Ro19cspQM"/></div></div></figure><p id="c569" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">加载csv文件并使用latin1作为UTF-8编码，或者只是读取而不编码会返回错误。我用了。info函数来获取关于数据集的信息。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ks"><img src="../Images/3f246add1232d21ec1d17a51ad2c66e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*SfwxpSyJuIjFE51z"/></div></figure><p id="24a1" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">然后，我检查了训练数据集和测试数据集的前五列，以查看每列的行标题。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kt"><img src="../Images/67ec846138dee6056dd172b2ef75e68c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3XJ_AyIVs433HYTi"/></div></div></figure><p id="6280" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">从情绪上看，它有五个等级:积极、消极、非常积极、非常消极和中性。我不得不把五门课减少到三门。正面的、负面的和中性的，并将这些变化应用于训练集和测试集。使用matplotlib.pyplot，我可视化了更新后的数据集。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es ku"><img src="../Images/65112850bc14f181d0417d32aac09e59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HkGPzXpzoQ3ztiqQ"/></div></div></figure><p id="7e3f" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">我检查了训练集和测试集中的空值，发现location有空值。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kv"><img src="../Images/9695ca0768aee6dd867d0a1fa69549e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/0*Y6i2Hy0ErZ17G_5_"/></div></figure><p id="17ea" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">训练集和测试集分别具有(41157，6)和(3798，6)列和行。</p><h1 id="15e8" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">数据清理:</h1><p id="b19d" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">这个项目有文本数据集，它的清理必须彻底，以防止错误。导入清洗所需的库</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kw"><img src="../Images/7659ce3684fc3cc84094440908409498.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*358mBNktDL2Jdhi6"/></div></div></figure><p id="ecce" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">我删除了所有的停用词，包括标签，网址，提及，数字等。我将这些更改应用于训练集和测试集。分析的基础是被选中的Tweet栏和情感栏，其他的被删除。可视化更新的数据集</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es kx"><img src="../Images/b436211459d069dc888c0d8db737c3ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/0*9wgpleRhQctX9hVA"/></div></figure><p id="054b" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">我对训练集和测试集都进行了简化。</p><p id="9c10" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">分割和矢量化:</p><p id="e8f1" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">我导入了有助于数据集分割和矢量化的库，它们是scikit-learn框架。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es ky"><img src="../Images/34124dde18c0637f2343235907f4fd4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9fC8wUrQfkmEdV7I"/></div></div></figure><p id="4f94" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">我分割了数据集，并对其进行了矢量化处理。我使用的矢量器是TFID矢量器，因为我考虑了一个词的总权重，包括它的频率。我想象了特征、重量和发生的频率</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es kz"><img src="../Images/901a5e9947a543c26779596eb3175b0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SArSMocOwtN1_5om"/></div></div></figure><h1 id="9a98" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">建筑和培训:</h1><h1 id="66a2" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">逻辑回归模型:</h1><p id="0b07" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">我导入了完成这项工作所需的库</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es la"><img src="../Images/2acec5c087f29d903947db0ba74c20be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/0*bM53zv2QeXOoXw7H"/></div></figure><p id="b145" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">让分类器报告工作，我在训练数据集中得到了以下结果</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lb"><img src="../Images/bdb22ca6e7b5df64f7545beb10f243b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/0*vo5MVU0z4umbgJF_"/></div></figure><p id="8dbb" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">我还使用两个参数对验证数据集进行了测试。第一个参数为:penalty = 11 solver = lbfgs，精度较低。然后我改变了第二个参数:penalty = 12 solver = saga，得到了更高的精度，如下所示</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lc"><img src="../Images/106463d64883c63fef0811d830fc716f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/0*FtmaC3nbWkcsRR5-"/></div></figure><p id="49f5" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">用测试集检查报告，我还必须在测试前对测试集进行矢量化。在用模型进行预测时，我得到了以下报告</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ld"><img src="../Images/fd73d07b4c3495617654c1c0c1217555.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/0*SIaRUrG1RKRRa7Zj"/></div></figure><p id="5089" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">模型可视化:</p><p id="e9ab" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">我使用seaborn和混淆度量来可视化结果</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es le"><img src="../Images/66984c80496e1cd5635141cefc60d9a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/0*RF8Pc1NkTXgcOKbW"/></div></figure><h1 id="3ff0" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">LSTM模式:</h1><p id="bc32" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">这是第二个使用相同数据集的模型，我在这个模型中对数据集使用了标记器。下面是所需库的样子</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es lf"><img src="../Images/73ac8e378cbd863dd060d00138adefee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/0*warYJQhGatQytT7A"/></div></figure><p id="fc7a" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">我还填充了数据集以获得相等的长度</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es lg"><img src="../Images/e418af8411e22092f8059b367f07f04b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wQ6aa66I8UF3dJ0R"/></div></div></figure><p id="e4f7" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">构建LSTM模型:</p><p id="d07e" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">我使用序列模型来构建神经网络，其中丢失了稀疏分类交叉熵、Adam优化器和“准确性”指标来编译模型。模型概述:</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es lh"><img src="../Images/015a220996f1920c722cc3268d2d42ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9_OaoVCaS1f8JCBy"/></div></div></figure><p id="bbae" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">我分割数据集，并使用两个时期训练模型。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div role="button" tabindex="0" class="kh ki di kj bf kk"><div class="er es li"><img src="../Images/36b797dd9da35f6eed1c7823f2efa1f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-QvN4rBM-tSeqYPn"/></div></div></figure><p id="fe9b" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">预测:</p><p id="f11d" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">我使用填充后的测试数据集进行预测，获得了83.997451290152%的准确率。</p><p id="65ea" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">可视化:</p><p id="2a8a" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">使用混淆度量和seaborn，模型是可视化的。</p><figure class="kc kd ke kf fd kg er es paragraph-image"><div class="er es ks"><img src="../Images/38084735bf352f2bc04bbd647db9ec6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*RQ-eXHfbV0NOoAAn"/></div></figure><h1 id="fd82" class="ie if hh bd ig ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb bi translated">结论:</h1><p id="3615" class="pw-post-body-paragraph jc jd hh je b jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ha bi translated">这是本周早些时候一次面试的课后作业。这个笔记本可以在<a class="ae ka" href="https://github.com/Nwosu-Ihueze/iQube_lab/blob/main/Sentiment_analysis.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>和<a class="ae ka" href="https://www.kaggle.com/nwosurosemary/sentiment-analysis-with-logistic-regression-lstm" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>中找到。对于建议或更正，可以通过<a class="ae ka" href="https://www.linkedin.com/in/rosemary-nwosu-ihueze/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p><p id="f5c9" class="pw-post-body-paragraph jc jd hh je b jf kn jh ji jj ko jl jm jn kp jp jq jr kq jt ju jv kr jx jy jz ha bi translated">感谢您的阅读。</p></div></div>    
</body>
</html>