<html>
<head>
<title>Character-Based Language Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于字符的语言模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/character-based-language-model-759711370350?source=collection_archive---------8-----------------------#2021-01-14">https://medium.com/analytics-vidhya/character-based-language-model-759711370350?source=collection_archive---------8-----------------------#2021-01-14</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/9f036116617f49ae632e715bb3191f61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SO6N-DpysX3bnFEv"/></div></div></figure><blockquote class="iq ir is"><p id="b7d4" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">你有没有想过Gmail自动回复是如何工作的？或者你的WhatsApp在发短信时是如何建议下一个单词的？或者我们如何产生音符？生成文本序列的一般方法是训练一个模型，在给定所有先前单词/字符的情况下预测下一个单词/字符。这样的模型被称为<strong class="iw hj">统计语言模型</strong>。什么是统计语言模型？统计语言模型是经过训练的单词序列的概率分布。</p></blockquote><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es js"><img src="../Images/1b42d3a878af1ac03e1939ed5eda1dc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*ptbO9Bg8QIYvMvht"/></div></figure><p id="d935" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">它的主要任务是在给定一个数据序列中所有先前字符的情况下预测下一个字符，即逐字符生成文本。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es ka"><img src="../Images/ffeb6d7addf3d3d6f065c4263506ce1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/0*YR--PP_C0WU5NYGa"/></div></figure><blockquote class="iq ir is"><p id="8a38" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">马尔可夫链是基于一种<strong class="iw hj">【无记忆】</strong>的原理。换句话说，过程的下一阶段只取决于前一状态，而不是状态序列。这个简单的假设使得条件概率的计算变得容易，并且使得该算法能够应用于许多场景。</p></blockquote><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es kb"><img src="../Images/2f69e49abe895e88075b38d154d8a778.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*K3IoJrFtJ5GBBRFp"/></div></div></figure><p id="7a5f" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">在现实生活的问题中，我们通常使用隐马尔可夫模型，它是马尔可夫链的一个进化版本。</p><p id="225f" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated"><em class="iv">文本/自然语言生成的概率模型(生成新文本的简单有效方式)</em></p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es kc"><img src="../Images/0ad3a1fd73675bc8656c38f41bf30514.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/0*lL5lHQNXVSscQLgb"/></div></figure><p id="3e94" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">这是一个随机过程(<strong class="iw hj"> </strong>表示一个系统在特定时间有观测值，其结果，也就是每个时间的观测值是一个随机变量。)包含随机变量，根据某些假设和明确的概率规则从一种状态转换到另一种状态。</p><h2 id="a34c" class="kd ke hi bd kf kg kh ki kj kk kl km kn jx ko kp kq jy kr ks kt jz ku kv kw kx bi translated"><strong class="ak"> <em class="ky">我们从数学上推导一下:</em> </strong></h2><p id="d074" class="pw-post-body-paragraph it iu hi iw b ix kz iz ja jb la jd je jx lb jh ji jy lc jl jm jz ld jp jq jr hb bi translated">设随机过程为，{Xm，m=0,1,2,⋯}.</p><p id="19ba" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">只有当这个过程是马尔可夫链时，</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es le"><img src="../Images/4306fc1d34ef493bcedf6ee0a629e9d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/0*HLiGqNRjisurYm0K"/></div></figure><p id="59c5" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">对于所有的m，j，I，i0，i1，⋯im-1</p><p id="bb4a" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">对于有限数量的状态，S={0，1，2，⋯，r}，这叫做有限马尔可夫链。</p><p id="17a1" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">P(Xm+1 = j|Xm = i)这里表示从一个状态转移到另一个状态的转移概率。这里，我们假设转移概率与时间无关。</p><p id="6e60" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">这意味着P(Xm+1 = j|Xm = i)不依赖于‘m’的值。因此，我们可以总结如下:</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lf"><img src="../Images/7d2c968eae6519bb3cc40a5d0645b480.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*bmYAl3079CELmLzC"/></div></figure><p id="b693" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">这个方程代表了马尔可夫链。</p><p id="1051" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">现在让我们通过一个例子来理解马尔可夫链到底是什么</p><h1 id="a85d" class="lg ke hi bd kf lh li lj kj lk ll lm kn ln lo lp kq lq lr ls kt lt lu lv kw lw bi translated">一个简单的天气模型:</h1><p id="911e" class="pw-post-body-paragraph it iu hi iw b ix kz iz ja jb la jd je jx lb jh ji jy lc jl jm jz ld jp jq jr hb bi translated">给定前一天的天气，天气条件(模拟为下雨或晴天)的概率可由转换矩阵表示:</p><h1 id="bbcd" class="lg ke hi bd kf lh li lj kj lk ll lm kn ln lo lp kq lq lr ls kt lt lu lv kw lw bi translated">P=⬇️</h1><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es lx"><img src="../Images/eca245687ebcfe5d5d27ed277ce621d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/0*COsk0G983x0wpk3N"/></div></figure><p id="ae09" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">矩阵<em class="iv"> P </em>表示天气模型，其中晴天之后有90%的可能是另一个晴天，雨天之后有50%的可能是另一个雨天。列可以标记为“晴天”和“雨天”，行可以以相同的顺序标记。(<em class="iv"> P </em> ) <em class="iv"> i j </em>是这样的概率，如果给定的一天属于类型<em class="iv"> I </em>，那么它后面将是类型<em class="iv"> j </em>的一天。</p><h1 id="5dce" class="lg ke hi bd kf lh li lj kj lk ll lm kn ln lo lp kq lq lr ls kt lt lu lv kw lw bi translated">预测天气</h1><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ly"><img src="../Images/063dbef9b0d6cca04937dbeeefb4527a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8S35RrL4cgZNofI3"/></div></div></figure><figure class="jt ju jv jw fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lz"><img src="../Images/27f955c14a0b663dd000af765e274422.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yXuml-01X9D93yPx"/></div></div></figure><h1 id="b874" class="lg ke hi bd kf lh li lj kj lk ll lm kn ln lo lp kq lq lr ls kt lt lu lv kw lw bi translated">Python中的马尔可夫链</h1><p id="21fe" class="pw-post-body-paragraph it iu hi iw b ix kz iz ja jb la jd je jx lb jh ji jy lc jl jm jz ld jp jq jr hb bi translated">为了运行这个，我将使用Python。</p><p id="c8d5" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">现在让我们开始编码吧！</p><p id="d2b6" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated"><a class="ae ma" href="https://github.com/aryangulati/Character-Based-Language-Model" rel="noopener ugc nofollow" target="_blank">基于字符的语言模型</a>(见本笔记本)</p><p id="2e23" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">做<a class="ae ma" href="https://www.ics.uci.edu/~pattis/common/handouts/pythoneclipsejava/python.html" rel="noopener ugc nofollow" target="_blank"> python </a>的基本安装，从<a class="ae ma" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank">这里</a>下载</p><p id="eea1" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">通过在cmd上运行pip install jupyter在Jupyter笔记本上练习。基本<a class="ae ma" href="https://jupyter.readthedocs.io/en/latest/install.html" rel="noopener ugc nofollow" target="_blank">安装</a>见此</p><h1 id="41c9" class="lg ke hi bd kf lh li lj kj lk ll lm kn ln lo lp kq lq lr ls kt lt lu lv kw lw bi translated"><strong class="ak">关于马尔可夫链的预见</strong></h1><p id="6a30" class="pw-post-body-paragraph it iu hi iw b ix kz iz ja jb la jd je jx lb jh ji jy lc jl jm jz ld jp jq jr hb bi translated">让我们看看下面的文字:</p><p id="9d85" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">艺术艺术艺术艺术艺术艺术艺术艺术</p><p id="919e" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">我们可以这样说:</p><blockquote class="iq ir is"><p id="c065" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">当当前单词是“arty”时，下一个单词将100%是“arts”。</p><p id="2922" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">当当前单词是“arts”时，下一个单词75%的时间是“arty ”,其余时间(25%)是换行符。</p></blockquote><p id="fadb" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">就是这样！我们现在已经定义了一个马尔可夫链。</p><p id="1fed" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">根据概率的定义，我们现在可以帮助用户编写相似的文本，或者我们可以自主地生成全新的文本。</p><ul class=""><li id="26e2" class="mb mc hi iw b ix iy jb jc jx md jy me jz mf jr mg mh mi mj bi translated">先说“艺”。</li><li id="1ec1" class="mb mc hi iw b ix mk jb ml jx mm jy mn jz mo jr mg mh mi mj bi translated">生成器知道“arts”后面可能出现的下一个单词的概率:75%“arty”，25% newline。</li><li id="f057" class="mb mc hi iw b ix mk jb ml jx mm jy mn jz mo jr mg mh mi mj bi translated">如果我们正在编写一个自动提示键盘，我们现在可以把“arty”放在突出位置，而把类似“enter”的东西放在不那么突出的位置。</li><li id="cb91" class="mb mc hi iw b ix mk jb ml jx mm jy mn jz mo jr mg mh mi mj bi translated">如果我们正在构建一个文本生成器，我们会随机选择下一个单词。要么完全随机(50% arty，50%换行符)，要么按比例(arty的机会是换行符的3倍)。我们在这里使用第二种方法，因为它生成的文本更接近原始文本。</li><li id="3f18" class="mb mc hi iw b ix mk jb ml jx mm jy mn jz mo jr mg mh mi mj bi translated">假设我们以“附庸风雅”告终。生成的字符串现在是“arts arty”。</li><li id="dc20" class="mb mc hi iw b ix mk jb ml jx mm jy mn jz mo jr mg mh mi mj bi translated">接下来，我们把最后一个单词(“arty”)重复一遍。</li><li id="5553" class="mb mc hi iw b ix mk jb ml jx mm jy mn jz mo jr mg mh mi mj bi translated">“附庸风雅”的概率很简单(100%“艺术”)。如果我们正在编写一个自动建议键盘，我们甚至可以在不询问用户的情况下插入“arts”(如果这是我们所处的领域的话)。</li><li id="dc87" class="mb mc hi iw b ix mk jb ml jx mm jy mn jz mo jr mg mh mi mj bi translated">我们现在有“艺术艺术”。</li><li id="6e39" class="mb mc hi iw b ix mk jb ml jx mm jy mn jz mo jr mg mh mi mj bi translated">如此反复下去。</li></ul><p id="47b6" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated"><a class="ae ma" href="https://en.wikipedia.org/wiki/Markov_chain" rel="noopener ugc nofollow" target="_blank">您可以在此</a>进一步阅读</p><h2 id="03e8" class="kd ke hi bd kf kg kh ki kj kk kl km kn jx ko kp kq jy kr ks kt jz ku kv kw kx bi translated"><strong class="ak">马尔可夫链的现实应用</strong></h2><p id="e5aa" class="pw-post-body-paragraph it iu hi iw b ix kz iz ja jb la jd je jx lb jh ji jy lc jl jm jz ld jp jq jr hb bi translated"><em class="iv"> ⦿PageRank: </em>谷歌搜索使用的一种算法，用于在其搜索引擎结果中对网页进行排名。其中每个网页可以是一个状态，并且这些页面之间的链接或引用可以被认为是具有概率的转换。所以不管你怎么搜索，进入某个网页的机会是固定的。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/8e7441fdced1eda513b6470cb156db63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/0*M1_c6t2V58oM-73a"/></div></figure><p id="c76b" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated"><em class="iv"> ⦿Typing单词预测:</em>用于预测即将出现的单词。像Gmail和WhatsApp用在自动补全和建议上。</p><figure class="jt ju jv jw fd ij er es paragraph-image"><div class="er es mq"><img src="../Images/1eaa0664b1aa1323453ff9a652b06265.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/0*208-J4ln1oL6SHG9"/></div></figure><p id="b65c" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated"><em class="iv"> ⦿Text生成器:</em>它生成虚拟文本或生成大型文章并编辑演讲。也用于你在网上看到的名字生成。</p><p id="a3a5" class="pw-post-body-paragraph it iu hi iw b ix iy iz ja jb jc jd je jx jg jh ji jy jk jl jm jz jo jp jq jr hb bi translated">更多的...</p><blockquote class="iq ir is"><p id="ad3a" class="it iu iv iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr hb bi translated">你也可以看看这个:【http://ieee.msit.in/blogs/4/character-based-language-model<a class="ae ma" href="http://ieee.msit.in/blogs/4/character-based-language-model" rel="noopener ugc nofollow" target="_blank"/></p></blockquote></div></div>    
</body>
</html>