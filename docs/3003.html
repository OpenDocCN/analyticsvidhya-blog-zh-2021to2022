<html>
<head>
<title>A small bug introduced me to Immutability in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个小bug让我了解了Python中的不变性</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-small-bug-introduced-me-to-immutability-in-python-d53d91f250ed?source=collection_archive---------28-----------------------#2021-05-28">https://medium.com/analytics-vidhya/a-small-bug-introduced-me-to-immutability-in-python-d53d91f250ed?source=collection_archive---------28-----------------------#2021-05-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><blockquote class="if ig ih"><p id="6697" class="ii ij ik il b im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg hb bi translated">python中的一切都是对象。不变性与对象的内存位置密切相关。</p></blockquote><p id="0a10" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">在我们讨论不变性之前，让我们看一下这些例子。</p><h2 id="7cd8" class="jk jl hi bd jm jn jo jp jq jr js jt ju jh jv jw jx ji jy jz ka jj kb kc kd ke bi translated">实施例1)</h2><figure class="kf kg kh ki fd kj"><div class="bz dy l di"><div class="kk kl l"/></div></figure><h2 id="0b6d" class="jk jl hi bd jm jn jo jp jq jr js jt ju jh jv jw jx ji jy jz ka jj kb kc kd ke bi translated">输出:</h2><pre class="kf kg kh ki fd km kn ko kp aw kq bi"><span id="dfc4" class="jk jl hi kn b fi kr ks l kt ku">list1 before mutation:  ['1', '2', '3', '4']<br/>list2 before mutation:  ['1', '2', '3', '4']</span><span id="d645" class="jk jl hi kn b fi kv ks l kt ku">list1 after mutation:  ['1', '8', '3', '4']<br/>list2 after mutation:  ['1', '8', '3', '4']</span></pre><p id="b242" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> <em class="ik">这里，在函数中，我们更新了list1的索引1。列表2没有变化，但列表2的索引1已更新。</em>T3】</strong></p><p id="2e96" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">现在，让我们对一个整数做同样的尝试。</p><h2 id="1dd1" class="jk jl hi bd jm jn jo jp jq jr js jt ju jh jv jw jx ji jy jz ka jj kb kc kd ke bi translated">实施例2)</h2><figure class="kf kg kh ki fd kj"><div class="bz dy l di"><div class="kk kl l"/></div></figure><h2 id="3bf7" class="jk jl hi bd jm jn jo jp jq jr js jt ju jh jv jw jx ji jy jz ka jj kb kc kd ke bi translated">输出:</h2><pre class="kf kg kh ki fd km kn ko kp aw kq bi"><span id="f64f" class="jk jl hi kn b fi kr ks l kt ku">param1 before mutation:  7<br/>param2 before mutation:  7</span><span id="7ea3" class="jk jl hi kn b fi kv ks l kt ku">param1 after mutation:  9<br/>param2 after mutation:  7</span></pre><p id="75db" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> <em class="ik">在上面的例子中，我们正在更新函数中的param1。与前面的例子不同，param2没有变化。</em> </strong></p><blockquote class="kw"><p id="2157" class="kx ky hi bd kz la lb lc ld le lf jg dx translated">为什么不同于整数的行为？</p></blockquote><p id="e94c" class="pw-post-body-paragraph ii ij hi il b im lg io ip iq lh is it jh li iw ix ji lj ja jb jj lk je jf jg hb bi translated">整数被认为是不可变的对象。顾名思义，不可变对象是那些一旦创建就不能再更新的对象。</p><p id="bacf" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">但我们一直都是这么做的，不是吗？我们一直在改变整数值，就像例2一样。那它怎么会符合不可变对象的定义。</p><p id="cb82" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">要回答这个问题，我们必须遵循更多的例子。</p><h2 id="b552" class="jk jl hi bd jm jn jo jp jq jr js jt ju jh jv jw jx ji jy jz ka jj kb kc kd ke bi translated">实施例3)</h2><p id="849c" class="pw-post-body-paragraph ii ij hi il b im ll io ip iq lm is it jh ln iw ix ji lo ja jb jj lp je jf jg hb bi translated"><em class="ik">(这里，“id”指的是各自对象的存储位置)</em></p><pre class="kf kg kh ki fd km kn ko kp aw kq bi"><span id="0eeb" class="jk jl hi kn b fi kr ks l kt ku">#integers<br/>num1 = num2 = 4</span><span id="bd64" class="jk jl hi kn b fi kv ks l kt ku">print('num1: ',num1)<br/>print('num2: ',num2)<br/>print('id of num1: ',id(num1))<br/>print('id of num2: ',id(num2))</span><span id="2ea5" class="jk jl hi kn b fi kv ks l kt ku">#mutating</span><span id="1db0" class="jk jl hi kn b fi kv ks l kt ku">num1 += 1<br/>num2 += 2</span><span id="90b3" class="jk jl hi kn b fi kv ks l kt ku">print('num1: ',num1)<br/>print('num2: ',num2)<br/>print('id of num1: ',id(num1))<br/>print('id of num2: ',id(num2))</span></pre><h2 id="b801" class="jk jl hi bd jm jn jo jp jq jr js jt ju jh jv jw jx ji jy jz ka jj kb kc kd ke bi translated">输出:</h2><pre class="kf kg kh ki fd km kn ko kp aw kq bi"><span id="ebc6" class="jk jl hi kn b fi kr ks l kt ku">num1:  4<br/>num2:  4<br/>id of num1:  4534237584<br/>id of num2:  4534237584</span><span id="29c8" class="jk jl hi kn b fi kv ks l kt ku">num1:  5<br/>num2:  6<br/>id of num1:  4534237616<br/>id of num2:  4534237648</span></pre><h2 id="e438" class="jk jl hi bd jm jn jo jp jq jr js jt ju jh jv jw jx ji jy jz ka jj kb kc kd ke bi translated">观察结果:</h2><ul class=""><li id="bde8" class="lq lr hi il b im ll iq lm jh ls ji lt jj lu jg lv lw lx ly bi translated">最初，num1和num2具有相同的值和相同的id，这意味着num1和num2指向相同的内存位置。</li><li id="e943" class="lq lr hi il b im lz iq ma jh mb ji mc jj md jg lv lw lx ly bi translated">突变后(递增num1和num2的值)，num1和num2各自的id也发生了变化。这意味着num1和num2不再指向以前的内存位置。<strong class="il hj"> <em class="ik">原来变异用全新的内存位置创建了新的num1和num2对象。</em>T13】</strong></li></ul><p id="151f" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> <em class="ik">这就是为什么在示例2中，当我们更新param1时，param2没有变化。尽管param1和param2最初指的是同一个对象，但经过变异后，param1是一个全新的对象。</em> </strong></p><p id="9f02" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated"><strong class="il hj"> <em class="ik">对参数1的任何更改都不再与参数2相关。这就是param2保持不变的原因。</em> </strong></p></div><div class="ab cl me mf gp mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="hb hc hd he hf"><p id="47e9" class="pw-post-body-paragraph ii ij hi il b im in io ip iq ir is it jh iv iw ix ji iz ja jb jj jd je jf jg hb bi translated">感谢您阅读本文，希望您喜欢。</p></div></div>    
</body>
</html>