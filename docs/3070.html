<html>
<head>
<title>Does feature collinearity affect model fit?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">特征共线性影响模型拟合吗？</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/does-feature-collinearity-affect-model-fit-4618c5dc79ea?source=collection_archive---------4-----------------------#2021-06-02">https://medium.com/analytics-vidhya/does-feature-collinearity-affect-model-fit-4618c5dc79ea?source=collection_archive---------4-----------------------#2021-06-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="0407" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在线性回归的背景下——几何透视</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/94c996587924ab333ad52068a5291580.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hx4XAAoFaZm5c4EHz4lD7w.jpeg"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">来源:谷歌图片</figcaption></figure><h1 id="7ffd" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">摘要:</h1><p id="2393" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">我们的假设是，在线性回归的情况下，要素之间的共线性不会对拟合产生太大影响。然而，这使得拟合系数非常不确定，从而对模型的可解释性产生不利影响。我们将验证这一假设，然后提供一个理由来说明为什么会这样。理由将包含对背后现实的几何洞察。</p><h1 id="fd1f" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">背景:</h1><p id="483e" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">这个问题源于对数据集进行的线性回归。我观察到，当我从特征矩阵中删除了一个完美的共线关系后，模型拟合完全没有改变。这就是这个博客标题的问题的来源，也是<strong class="ig hi">摘要</strong>中提出的假设。</p><h1 id="3760" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">假设的验证:</h1><p id="0568" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">首先是对假设的验证。为此，我们对两个特征——身高(英尺)和体重(千克)进行了100次模拟观察。我们生成第三个特征——<em class="kv">强度</em> = 2ℎ𝑒𝑖𝑔ℎ𝑡+3𝑤𝑒𝑖𝑔ℎ𝑡.这是<em class="kv">力量</em>与<em class="kv">高度</em>和<em class="kv">重量</em>的完美共线关系。我们的反应是<em class="kv"> combatscore </em>(给定<em class="kv">身高</em>、<em class="kv">体重</em>和<em class="kv">力量</em>的个人在战斗中的得分)。<strong class="ig hi">𝑐𝑜𝑚𝑏𝑎𝑡𝑆𝑐𝑜𝑟𝑒=2ℎ𝑒𝑖𝑔ℎ𝑡+𝑤𝑒𝑖𝑔ℎ𝑡+𝜖</strong>其中<em class="kv"> ϵ </em>是随机误差。</p><p id="24a5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有了这些数据，我们将首先拟合一个线性回归模型，并记录系数和模型拟合得分——𝑅得分。然后，我们只需改变观察值，例如，第一个观察值变成第十个，依此类推。我们将再次拟合线性回归，记录系数并拟合该混洗数据集的分数。</p><p id="251a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">比较两者将证实我们的假设。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ca"><img src="../Images/7c2dec3a073f7aa0ded9bef7473ef775.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CsM5AV3UkaebhLuUp55y5A.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">要使用的数据集</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es et"><img src="../Images/09eb211569c01d1871a83ae2f6753b68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bokmXSaIC0EC3UZ18FCmrQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">当上述方法应用于数据集及其混洗版本时的结果</figcaption></figure><p id="0950" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">我们清楚地看到系数之间的巨大差异，尽管拟合分数几乎相同。这凸显了一个非常真实的问题。打乱观察结果甚至不是训练数据的变化。即使在这一点上，也注意到了系数值的这种奇怪的偏差。然而奇怪的是，模型拟合几乎不受此影响。</strong></p><blockquote class="kw kx ky"><p id="b383" class="ie if kv ig b ih ii ij ik il im in io kz iq ir is la iu iv iw lb iy iz ja jb ha bi translated"><strong class="ig hi">“模型拟合中涉及的计算”有什么特别之处，它可以毫发无损地通过共线性，而系数却不能？</strong></p></blockquote><h1 id="d55a" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">几何解释:</h1><p id="a92d" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">我们将试图通过矢量处理来了解系数是什么以及模型拟合分数表示什么。<em class="kv">身高</em>、<em class="kv">体重</em>、<em class="kv">力量</em>和<em class="kv">战斗分数</em>这几列是100维向量。我们本质上想要做的是尽可能好地将<em class="kv"> combatscore </em>表示为向量的线性组合。为了更好地证明这一点，我将使用一些矢量图。让我们首先创建那些情节。</p><p id="680c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">比如说𝑎=(3,0,0、𝑏=(0,3,0和𝑐=0.7𝑎+0.8𝑏.所以𝑐躺在被𝑎和𝑏.横扫的飞机上现在𝑢=𝑎+𝑏+𝜖，𝜖是一个随机误差。我们的目标是用𝑎、𝑏和𝑐.来尽可能好地表达𝑢</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lc"><img src="../Images/dbfa32429e90d0b9d81d90fc8b2c1842.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w18xaSjpCIEzpBChXOfM4A.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">沿着a、b和c所在平面的向量</figcaption></figure><p id="9bc4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，就𝑎、𝑏和𝑐而言，𝑢的最佳近似将是当𝑢在平面上的垂直投影，比如说𝑢<em class="kv">_ p</em>，被表达为𝑎、𝑏和。这种表达方式实际上可以有很多可能的方式，因为我们只需要两个这样的向量𝑎和𝑏，而在这种情况下，我们有三个向量——𝑎、𝑏和𝑐.这正是共线性产生的问题——表示𝑢_𝑝的系数变得不确定、不确定。</p><p id="2253" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这种情况下，模型拟合是如何表示的？𝑢离它的投影𝑢_𝑝越近，拟合越好。因此，𝑢与平面的垂直距离给出了拟合不足量的度量。</p><blockquote class="kw kx ky"><p id="6013" class="ie if kv ig b ih ii ij ik il im in io kz iq ir is la iu iv iw lb iy iz ja jb ha bi translated"><strong class="ig hi">向量元素混洗时，这个量会发生变化吗？</strong></p></blockquote><p id="8753" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们将𝑎的值从(3，0，0)改为(0，3，0)，将𝑏的值从(0，3，0)改为(0，0，3)，将𝜖的值从(0，0，1.5)改为(1.5，0，0)，再次绘制上述曲线。𝑐和𝑢的表述保持不变。在这次洗牌后，现实世界对𝑎、𝑏、𝑐和𝑢的解读依然如故。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ld"><img src="../Images/21fc858346fe5df2b5f324a58930c881.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*BQK-5M4x9L2l95RXl5sJRA.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">载体后洗牌</figcaption></figure><p id="11f7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">向量可能已经改变了排列，但是𝑢到平面的垂直距离和以前一样。我在这里并不试图做任何分析证明，但这个数字本身似乎太有说服力了。因此，拟合是相同的。然而，当线性回归运行时，向量的元素项会参与计算。改变它们的顺序可以彻底改变𝑢_𝑝在𝑎、𝑏和𝑐.方面的表达</p><p id="e729" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果只有两个向量𝑎和𝑏，这种任意性就不会出现。为了证明这一点，我们现在将从数据集中删除<em class="kv">强度</em>列，并重新运行正常和随机模式拟合。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es le"><img src="../Images/5f26ba06571c427b2cbc53f890ddff4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*KiE0iw0wuDsZKpHrKdi80w.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">完全共线的柱“强度”</figcaption></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lf"><img src="../Images/bc1bab2c1dab315733d204b8a2aef609.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*IJSlA0fwQKM-pEhVt_EPPA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">从特征空间中去除共线性</figcaption></figure><h1 id="6bb4" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">结论:</h1><p id="336b" class="pw-post-body-paragraph ie if hh ig b ih kq ij ik il kr in io ip ks ir is it kt iv iw ix ku iz ja jb ha bi translated">因此，在线性回归的情况下，拟合不受共线性的影响，但模型系数的不确定性以及可解释性会受到影响。</p><p id="e618" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，同样的情况不能保证适用于其他型号，因为我不太确定矢量疗法是否也适用于它们。</p></div></div>    
</body>
</html>