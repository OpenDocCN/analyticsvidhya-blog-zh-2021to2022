<html>
<head>
<title>Image Recognition / Classification Android App using TensorFlow model | Easy and fast implementation | Kotlin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用TensorFlow模型的图像识别/分类Android应用程序|简单快速的实施| Kotlin</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/image-recognition-classification-android-app-using-tensorflow-model-easy-and-fast-e3e00bc0b3ab?source=collection_archive---------2-----------------------#2021-07-28">https://medium.com/analytics-vidhya/image-recognition-classification-android-app-using-tensorflow-model-easy-and-fast-e3e00bc0b3ab?source=collection_archive---------2-----------------------#2021-07-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="4588" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">简介:</strong></p><p id="26a9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">图像识别是计算机视觉的一部分，并且识别和检测数字视频或图像中的对象或属性的过程有助于识别图像中的地点、标志、人、对象、建筑物和若干其他变量。用户通过应用程序、社交网络和网站分享大量数据。此外，配有摄像头的移动电话正在创造无限的数字图像和视频。大量的数字数据正被企业用来为访问这些数据的人们提供更好、更智能的服务。</p><p id="6074" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这里，你将学习如何创建一个基于kotlin语言的android应用程序。我们将在我们的android应用程序中实现TensorFlow预训练分类模型，然后对选定的图像进行分类。</p><p id="0886" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">基本要求:</p><blockquote class="jc jd je"><p id="688a" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated"><a class="ae jj" href="https://developer.android.com/studio?gclsrc=aw.ds&amp;gclid=Cj0KCQjw3f6HBhDHARIsAD_i3D-67jAQL0AtFojvK1e7vIKcSvFY05DImffCs5EoQ_jvhW1zBo7TAloaApzHEALw_wcB" rel="noopener ugc nofollow" target="_blank"> <em class="hh">安卓工作室。</em> </a></p><p id="cf9e" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated"><em class="hh">编程基础知识，android studio一知半解</em></p><p id="ffaa" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated"><em class="hh"> Tenser流动图像分类模型文件</em></p><p id="aea9" class="ie if jf ig b ih ii ij ik il im in io jg iq ir is jh iu iv iw ji iy iz ja jb ha bi translated"><em class="hh">仿真器或智能手机(运行应用程序)</em></p></blockquote><p id="f0bd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下载<a class="ae jj" href="https://www.tensorflow.org/lite/examples/image_classification/overview" rel="noopener ugc nofollow" target="_blank">图片分类| TensorFlow Lite </a>模型。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jk"><img src="../Images/183440f008e880f0f2617b2cd75d1443.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N2pkdYcMBsZvhywyUloBPw.png"/></div></div></figure><p id="afa6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">解压缩下载的文件，你会得到两个扩展名为。tflite和。txt文本文件包含数据的标签。</p><p id="e997" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">打开您的android studio并启动新项目选择空活动，现在给出您的项目的正确位置并声明项目的名称，确保选择语言为Kotlin，并根据您的选择设置最低SDK，这将显示您可以在多少百分比的设备上运行您的应用程序。然后单击完成。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jw"><img src="../Images/e24920686b24593df3e1baaad4429405.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*475MzqKJx5iWpm9iEDdtng.png"/></div></div></figure><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jx"><img src="../Images/7d87ccf67880c2cf4aa59fbd1bae748c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tdT6Tbx85QKISjCjudQPqA.png"/></div></div></figure><p id="007e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们首先设计前端。xml文件，您只需拖放您想要显示的项目。我们将有一个图像视图，文本视图和添加图像和预测图像按钮。给每个视图适当的约束。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es jy"><img src="../Images/67bc25b4fc2f40c25731a5ab5ea0962d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ENlVb4zSjkFwSh0LqTCuQ.png"/></div></div></figure><p id="ec62" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您可以在蓝图视图中看到所有约束。在我们的设计中，有一个文本视图将显示位于两个按钮正下方的预测图像的结果。</p><p id="0461" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">转到屏幕右上方的代码选项</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es jz"><img src="../Images/aa53c46828765a07fb1ef8f1c48b4421.png" data-original-src="https://miro.medium.com/v2/resize:fit:458/format:webp/1*gowEi51EEwU7YG-8w6KV9w.png"/></div></figure><p id="1d5f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对比我的。xml代码与您的代码</p><p id="31bc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">XML代码:</p><pre class="jl jm jn jo fd ka kb kc kd aw ke bi"><span id="6252" class="kf kg hh kb b fi kh ki l kj kk"><em class="jf">&lt;?</em>xml version="1.0" encoding="utf-8"<em class="jf">?&gt;<br/></em>&lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"<br/>    xmlns:app="http://schemas.android.com/apk/res-auto"<br/>    xmlns:tools="http://schemas.android.com/tools"<br/>    android:layout_width="match_parent"<br/>    android:layout_height="match_parent"<br/>    tools:context=".MainActivity"&gt;</span><span id="90fe" class="kf kg hh kb b fi kl ki l kj kk">    &lt;ImageView<br/>        android:id="@+id/imageView2"<br/>        android:layout_width="361dp"<br/>        android:layout_height="354dp"<br/>        android:layout_marginTop="24dp"<br/>        android:contentDescription="@string/select"<br/>        app:layout_constraintEnd_toEndOf="parent"<br/>        app:layout_constraintHorizontal_bias="0.498"<br/>        app:layout_constraintStart_toStartOf="parent"<br/>        app:layout_constraintTop_toTopOf="parent"<br/>        tools:srcCompat="@tools:sample/avatars" /&gt;</span><span id="9914" class="kf kg hh kb b fi kl ki l kj kk">    &lt;Button<br/>        android:id="@+id/select"<br/>        android:layout_width="wrap_content"<br/>        android:layout_height="wrap_content"<br/>        android:layout_marginStart="60dp"<br/>        android:layout_marginTop="24dp"<br/>        android:layout_marginBottom="16dp"<br/>        android:text="@string/add_image"<br/>        app:layout_constraintBottom_toBottomOf="parent"<br/>        app:layout_constraintStart_toStartOf="parent"<br/>        app:layout_constraintTop_toBottomOf="@+id/imageView2"<br/>        app:layout_constraintVertical_bias="0.0" /&gt;</span><span id="b0b5" class="kf kg hh kb b fi kl ki l kj kk">    &lt;Button<br/>        android:id="@+id/predict"<br/>        android:layout_width="wrap_content"<br/>        android:layout_height="wrap_content"<br/>        android:layout_marginStart="16dp"<br/>        android:layout_marginEnd="60dp"<br/>        android:text="@string/predict_image"<br/>        app:layout_constraintBaseline_toBaselineOf="@+id/select"<br/>        app:layout_constraintEnd_toEndOf="parent"<br/>        app:layout_constraintHorizontal_bias="1.0"<br/>        app:layout_constraintStart_toEndOf="@+id/select" /&gt;</span><span id="848b" class="kf kg hh kb b fi kl ki l kj kk">    &lt;TextView<br/>        android:id="@+id/textView"<br/>        android:layout_width="288dp"<br/>        android:layout_height="178dp"<br/>        android:layout_marginTop="16dp"<br/>        android:layout_marginBottom="16dp"<br/>        app:layout_constraintBottom_toBottomOf="parent"<br/>        app:layout_constraintEnd_toEndOf="parent"<br/>        app:layout_constraintStart_toStartOf="parent"<br/>        app:layout_constraintTop_toBottomOf="@+id/imageView2" /&gt;</span><span id="7859" class="kf kg hh kb b fi kl ki l kj kk">&lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</span></pre><p id="3a90" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们在项目中导入张量流模型</p><p id="047f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">文件&gt;新建&gt;其他&gt; TensorFlow Lite模型。然后这个窗口会出现在你的屏幕上</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es km"><img src="../Images/65a025e4d3f29b245f001975e0da0a6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ktoQOe1whHGO0UZYhuXgZQ.png"/></div></div></figure><p id="d2f0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">添加适当的模型位置，即提取的位置。tflite文件，然后单击完成。</p><p id="a245" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们必须为添加标签文件创建一个资产文件。txt在里面现在就去</p><p id="22f2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">文件&gt;新建&gt;文件夹&gt;资产文件夹。txt文件并粘贴到名为<strong class="ig hi">labels . txt</strong>的资产文件夹中</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kn"><img src="../Images/37a3c7c1f59455122cf5f6f389396b6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*g234ZVxgOwzUVg-s9MU6mw.png"/></div></figure><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es ko"><img src="../Images/abadf9e70af0520baab58b9f66925068.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*eam8u3G1pBhKB4qGgC1G1A.png"/></div></div></figure><p id="e830" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是您的项目部分的外观。</p><p id="17b8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在我们将编写Kotlin代码，编写下面的kotlin代码</p><pre class="jl jm jn jo fd ka kb kc kd aw ke bi"><span id="ef20" class="kf kg hh kb b fi kh ki l kj kk">package com.example.imagerecognition<br/><br/>import android.content.Intent<br/>import android.graphics.Bitmap<br/>import android.net.Uri<br/>import androidx.appcompat.app.AppCompatActivity<br/>import android.os.Bundle<br/>import android.provider.MediaStore<br/>import android.view.View<br/>import android.widget.Button<br/>import android.widget.ImageView<br/>import android.widget.TextView<br/>import com.example.imagerecognition.ml.MobilenetV110224Quant<br/>import org.tensorflow.lite.DataType<br/>import org.tensorflow.lite.support.image.TensorImage<br/>import org.tensorflow.lite.support.tensorbuffer.TensorBuffer<br/>class MainActivity : AppCompatActivity() {<br/>    lateinit var bitmap: Bitmap<br/>    lateinit var imageView: ImageView<br/>    override fun onCreate(savedInstanceState: Bundle?) {<br/>        super.onCreate(savedInstanceState)<br/>        setContentView(R.layout.<em class="jf">activity_main</em>)<br/><br/>        imageView = findViewById(R.id.<em class="jf">imageView2</em>)<br/><br/>        val fileName = "labels.txt"<br/>        val inputString = <em class="jf">application</em>.<em class="jf">assets</em>.open(fileName).<em class="jf">bufferedReader</em>().<em class="jf">use</em><strong class="kb hi">{it</strong>.<em class="jf">readText</em>()<strong class="kb hi">}<br/>        </strong>var townlist = inputString.<em class="jf">split</em>("\n")<br/><br/>        var textView: TextView = findViewById(R.id.<em class="jf">textView</em>)<br/><br/><br/>        var select: Button = findViewById(R.id.<em class="jf">select</em>)<br/>        select.setOnClickListener(View.OnClickListener <strong class="kb hi">{<br/>            </strong>var intent: Intent = Intent(Intent.<em class="jf">ACTION_GET_CONTENT</em>)<br/>            intent.<em class="jf">type </em>="image/*"<br/><br/>            startActivityForResult(intent, 100)<br/><br/>        <strong class="kb hi">}</strong>)<br/><br/>        var predict: Button = findViewById(R.id.<em class="jf">predict</em>)<br/>        predict.setOnClickListener(View.OnClickListener <strong class="kb hi">{<br/>            </strong>var resize: Bitmap = Bitmap.createScaledBitmap(bitmap, 224, 224, true)<br/>            val model = MobilenetV110224Quant.newInstance(this)<br/>            var theBuffer = TensorImage.fromBitmap(resize)<br/>            var byteBuffer = theBuffer.<em class="jf">buffer<br/>// Creates inputs for reference.<br/>            </em>val inputFeature0 = TensorBuffer.createFixedSize(<em class="jf">intArrayOf</em>(1, 224, 224, 3), DataType.<em class="jf">UINT8</em>)<br/>            inputFeature0.loadBuffer(byteBuffer)<br/><br/><em class="jf">// Runs model inference and gets result.<br/>            </em>val outputs = model.process(inputFeature0)<br/>            val outputFeature0 = outputs.<em class="jf">outputFeature0AsTensorBuffer<br/>            </em>var max = getMax(outputFeature0.<em class="jf">floatArray</em>)<br/>            textView.setText(townlist[max])<br/><em class="jf">// Releases model resources if no longer used.<br/>            </em>model.close()<br/>        <strong class="kb hi">}</strong>)<br/>    }<br/><br/>    override fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {<br/>        super.onActivityResult(requestCode, resultCode, data)<br/><br/>        imageView.setImageURI(data?.<em class="jf">data</em>)<br/><br/>        var uri: Uri? = data?.<em class="jf">data<br/>        </em>bitmap = MediaStore.Images.Media.getBitmap(this.<em class="jf">contentResolver</em>, uri)<br/>    }<br/>    fun getMax(arr:FloatArray) : Int{<br/>        var index = 0<br/>        var min = 0.0f<br/><br/>        for(i in 0..1000){<br/>            if(arr[i]&gt;min){<br/>                index = i<br/>                min = arr[i]<br/>            }<br/>        }<br/>        return index<br/><br/>    }<br/><br/>}</span></pre><p id="b2b0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在红色标志出现的地方，点击那个单词，按下<strong class="ig hi"> alt+enter </strong>，看看要做什么改变，如果它显示添加导入，点击它，之后android studio会做你的工作。</p><p id="55fa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在这一切都完成了，是时候构建apk在我们的手机上运行了。</p><p id="3cef" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要在您的智能手机中编译和运行此应用程序，首先从您的智能手机的开发人员选项中启用USB调试，并选择文件传输。</p><p id="3d77" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">您的智能手机将出现在这里选择它，并通过点击运行按钮继续运行。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="er es kp"><img src="../Images/88d49084e5ca93eca05a18d791373500.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qQgvWzqUjVfH48UcE7bxkQ.png"/></div></div></figure><p id="d54f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">允许应用程序安装在您的设备上，然后应用程序将启动。</p><figure class="jl jm jn jo fd jp er es paragraph-image"><div class="er es kq"><img src="../Images/c759732eb2f392095683a9b7857ce471.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*fQu5GgNEfE-qhBiBEp5TLg.jpeg"/></div></figure><p id="dd5b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是你的输出将如何通过点击添加按钮添加图像，并点击预测图像会给你在文本视图中的输出。</p><p id="8a43" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi">— — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><p id="01a5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">直接从我的<a class="ae jj" href="https://github.com/yashambekar1804" rel="noopener ugc nofollow" target="_blank"> GitHub库下载这个应用程序。</a></p><p id="9858" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">关注并连接。</p></div></div>    
</body>
</html>