<html>
<head>
<title>Basic Introduction to Scikit Learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Scikit学习的基本介绍</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/basic-introduction-to-scikit-learn-fa610f14e40d?source=collection_archive---------11-----------------------#2021-04-27">https://medium.com/analytics-vidhya/basic-introduction-to-scikit-learn-fa610f14e40d?source=collection_archive---------11-----------------------#2021-04-27</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/cf0fd2fb28f493c878f105942910e8fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PkzjfwHV9STjxi3p"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">马里乌斯·马萨拉尔在<a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="2ebc" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">Scikit-learn构建在NumPy、SciPy和Matplotlib之上，是用于机器学习的强大库。</p><h1 id="abee" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">为什么要学Scikit？</strong></h1><ul class=""><li id="8f8d" class="kq kr hh iw b ix ks jb kt jf ku jj kv jn kw jr kx ky kz la bi translated">为机器学习提供高效的工具。</li><li id="3f8a" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">提供统计模型，包括分类、回归、聚类。</li><li id="07aa" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr kx ky kz la bi translated">涵盖大多数机器学习任务，并扩展到大多数数据问题。</li></ul><h1 id="e992" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">装置</h1><h2 id="44eb" class="lg jt hh bd ju lh li lj jy lk ll lm kc jf ln lo kg jj lp lq kk jn lr ls ko lt bi translated">使用画中画</h2><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="ad8e" class="lg jt hh lz b fi md me l mf mg">pip install -U scikit-learn</span></pre><h2 id="c5de" class="lg jt hh bd ju lh li lj jy lk ll lm kc jf ln lo kg jj lp lq kk jn lr ls ko lt bi translated">使用conda</h2><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="5e84" class="lg jt hh lz b fi md me l mf mg">conda install scikit-learn</span></pre><h1 id="bab8" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak">特性</strong></h1><p id="fe25" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf mh jh ji jj mi jl jm jn mj jp jq jr ha bi translated">Scikit-learn library更侧重于数据建模，而不是加载、操作和汇总数据。Sklearn提供的一些受欢迎的模型组有:</p><ol class=""><li id="e39a" class="kq kr hh iw b ix iy jb jc jf mk jj ml jn mm jr mn ky kz la bi translated">监督学习算法:线性回归，支持向量机(SVM)，决策树等。</li><li id="0a0c" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr mn ky kz la bi translated">无监督学习算法:聚类、因子分析、主成分分析、无监督神经网络等。</li><li id="03fd" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr mn ky kz la bi translated">交叉验证:检查监督模型的准确性</li><li id="b8e0" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr mn ky kz la bi translated">降维:用于减少数据中的属性数量，以进行汇总、可视化和特征选择。</li><li id="6998" class="kq kr hh iw b ix lb jb lc jf ld jj le jn lf jr mn ky kz la bi translated">集合方法:用于组合多个监督模型的预测和许多更多的预测。</li></ol><h1 id="03c8" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">小抄</h1><figure class="lu lv lw lx fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mo"><img src="../Images/c514f827fd138a1faf56a16bed1624d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_7WN2DSAd6ZZOo3h"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">www.datacamp.com摄</figcaption></figure></div><div class="ab cl mp mq go mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ha hb hc hd he"><h1 id="42aa" class="js jt hh bd ju jv mw jx jy jz mx kb kc kd my kf kg kh mz kj kk kl na kn ko kp bi translated">数据集加载</h1><p id="c29e" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf mh jh ji jj mi jl jm jn mj jp jq jr ha bi translated">输入:</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="f670" class="lg jt hh lz b fi md me l mf mg">from sklearn.datasets import load_iris   <em class="nb">#imports the library </em><br/>iris = load_iris()   <em class="nb">#import the dataset 'iris' to the variable iris</em><br/>X = iris.data   <em class="nb">#store the features into the variable X</em><br/>y = iris.target   <em class="nb">#stores the label into the variable Y</em><br/>feature_names = iris.feature_names  <em class="nb">#stores the feature attributes </em><br/>target_names = iris.target_names  <em class="nb"> #stores the label attributes</em><br/>print("Feature names:", feature_names)   <em class="nb">#print feature name</em><br/>print("Target names:", target_names)   <em class="nb">#print label name</em><br/>print("\nFirst 10 rows of X:\n", X[:5])   <em class="nb">#print first 5 entry</em></span></pre><p id="0228" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">特征名称</strong>—它是所有特征名称的列表(输入)。</p><p id="1da3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">目标名称</strong>——是所有标签名称的列表(输出)。</p><p id="17cb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">输出:</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="f81d" class="lg jt hh lz b fi md me l mf mg">Feature names: ['sepal length (cm)', 'sepal width (cm)', 'petal length (cm)', 'petal width (cm)']<br/>Target names: ['setosa' 'versicolor' 'virginica']<br/>First 10 rows of X:<br/>[<br/>   [5.1 3.5 1.4 0.2]<br/>   [4.9 3. 1.4 0.2]<br/>   [4.7 3.2 1.3 0.2]<br/>   [4.6 3.1 1.5 0.2]<br/>   [5. 3.6 1.4 0.2]<br/>]</span></pre><h1 id="10e9" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">分割数据集</h1><p id="aff6" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf mh jh ji jj mi jl jm jn mj jp jq jr ha bi translated">输入:</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="4bc1" class="lg jt hh lz b fi md me l mf mg">from sklearn.model_selection import train_test_split  <em class="nb">#import the library<br/></em><br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.3, random_state = 1)   <em class="nb">#divide 70% data for training &amp; 30% data for testing purpose with same data given all the time by random state</em><br/><br/>print(X_train.shape)   <em class="nb">#print the shape of input train data</em><br/>print(X_test.shape)  <em class="nb"> #print the shape of input test data</em><br/>print(y_train.shape)  <em class="nb"> #print the shape of output train data</em><br/>print(y_test.shape)   <em class="nb">#print the shape of output test data</em></span></pre><p id="68d0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">random _ size</strong>—保证分割始终相同。</p><p id="7f76" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">输出:</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="d1d8" class="lg jt hh lz b fi md me l mf mg">(105, 4)  <em class="nb"> #row * column</em><br/>(45, 4)   <em class="nb">#row * column</em>   <br/>(105,)   <em class="nb">#row * column(0)</em><br/>(45,)   <em class="nb">#row * column(0)</em></span></pre><h1 id="ec34" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">训练模型</h1><p id="f8a0" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf mh jh ji jj mi jl jm jn mj jp jq jr ha bi translated">输入:</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="c67f" class="lg jt hh lz b fi md me l mf mg">from sklearn.neighbors import KNeighborsClassifier   <em class="nb">#import the function</em><br/>from sklearn import metrics  <em class="nb">#import the function</em><br/>classifier_knn = KNeighborsClassifier(n_neighbors = 3)<br/>classifier_knn.fit(X_train, y_train)<br/>y_pred = classifier_knn.predict(X_test)<br/><br/>print("Accuracy:", metrics.accuracy_score(y_test, y_pred))   <em class="nb"># Finds the accuracy by comparing actual response values(y_test)with predicted response value(y_pred)</em><br/><br/>sample = [[5, 5, 3, 2], [2, 4, 3, 5]]   <em class="nb"># Providing sample data and the model will make prediction out of that data</em><br/>preds = classifier_knn.predict(sample)<br/>pred_species = [iris.target_names[p] for p in preds] print("Predictions:", pred_species)</span></pre><p id="c431" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">输出:</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="5a2b" class="lg jt hh lz b fi md me l mf mg">Accuracy: 0.9833333333333333<br/>Predictions: ['versicolor', 'virginica']</span></pre><p id="86be" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> KNeighborsClassifier </strong>:该分类器基于k个最近邻实现学习，其中k为用户指定的整数值。k值的选择取决于数据</p><figure class="lu lv lw lx fd ii er es paragraph-image"><div class="er es nc"><img src="../Images/2fac0ee93fc5d4abc421706098184850.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/0*t1V83T2kGZSz-VsR.jpg"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">上述数据的粗略图表</figcaption></figure><p id="a321" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">上面的情节是由我的以下代码获得的:</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="45c0" class="lg jt hh lz b fi md me l mf mg">scores_list = []<br/>for k in range(1,15):<br/>   classifier = KNeighborsClassifier(n_neighbors=k)<br/>   classifier.fit(X_train, y_train)<br/>   y_pred = classifier.predict(X_test)<br/>   scores_list.append(metrics.accuracy_score(y_test,y_pred))</span></pre><p id="f22c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">度量</strong>:实现为特定目的评估预测误差的功能，如准确度分数(此处)。</p><h1 id="7ae4" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">模型持久性/保存模型</h1><p id="7ea8" class="pw-post-body-paragraph iu iv hh iw b ix ks iz ja jb kt jd je jf mh jh ji jj mi jl jm jn mj jp jq jr ha bi translated">一旦我们训练了这个模型，这个模型应该持续到将来使用，这样我们就不需要一次又一次地重新训练它。借助<strong class="iw hi"> <em class="nb"> joblib </em> </strong>包的<strong class="iw hi"> dump </strong>和<strong class="iw hi"> load </strong>特性完成。</p><p id="136c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">输入:</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="856d" class="lg jt hh lz b fi md me l mf mg">from sklearn.externals import joblib<br/>joblib.dump(classifier_knn, 'iris_classifier_knn.joblib')   #save the model into file named iris_classifier_knn.joblib</span></pre><p id="76a5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，在下面代码的帮助下，可以从文件中重新加载对象</p><pre class="lu lv lw lx fd ly lz ma mb aw mc bi"><span id="3335" class="lg jt hh lz b fi md me l mf mg">joblib.load('iris_classifier_knn.joblib')</span></pre></div><div class="ab cl mp mq go mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ha hb hc hd he"><p id="6894" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，你可以用sklearn做基础项目了。<br/>所有最好的❤️</p></div></div>    
</body>
</html>