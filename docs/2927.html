<html>
<head>
<title>Sentiment Analysis for Customer Experience With Python and Streamlit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python和Streamlit进行客户体验情感分析</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/sentiment-analysis-for-customer-experience-with-python-and-streamlit-42e8ea1db56?source=collection_archive---------10-----------------------#2021-05-25">https://medium.com/analytics-vidhya/sentiment-analysis-for-customer-experience-with-python-and-streamlit-42e8ea1db56?source=collection_archive---------10-----------------------#2021-05-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="cd8a" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">开始利用Vonage消息API改善客户服务，例如整理来自脸书等社交媒体平台的评论反馈。</h2></div><p id="7573" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">情感分析使用自然语言处理技术从客户反馈中挖掘见解，以确定反馈数据是积极的、消极的还是中性的。企业利用情感分析来监控产品和品牌情感，并了解客户的需求。</p><p id="e325" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">本教程涵盖以下内容:</p><ul class=""><li id="181b" class="jt ju hi iz b ja jb jd je jg jv jk jw jo jx js jy jz ka kb bi translated">初始化Vonage上的消息API沙箱</li><li id="7f7c" class="jt ju hi iz b ja kc jd kd jg ke jk kf jo kg js jy jz ka kb bi translated">通过脸书从客户那里收集数据</li><li id="b2c1" class="jt ju hi iz b ja kc jd kd jg ke jk kf jo kg js jy jz ka kb bi translated">通过以下方式创建一个机器人来处理脸书上的客户反馈:</li><li id="c0b9" class="jt ju hi iz b ja kc jd kd jg ke jk kf jo kg js jy jz ka kb bi translated">将这些数据存储到数据库或文本文件中</li><li id="477a" class="jt ju hi iz b ja kc jd kd jg ke jk kf jo kg js jy jz ka kb bi translated">向客户返回相关响应</li><li id="85ee" class="jt ju hi iz b ja kc jd kd jg ke jk kf jo kg js jy jz ka kb bi translated">通过Streamlit创建仪表板，实时了解客户的反馈意见</li><li id="3715" class="jt ju hi iz b ja kc jd kd jg ke jk kf jo kg js jy jz ka kb bi translated">用积极、消极和中立的尺度衡量顾客的情绪</li><li id="faab" class="jt ju hi iz b ja kc jd kd jg ke jk kf jo kg js jy jz ka kb bi translated">通过可视化分析客户的关键难点</li></ul><h1 id="e414" class="kh ki hi bd kj kk kl km kn ko kp kq kr io ks ip kt ir ku is kv iu kw iv kx ky bi translated">先决条件</h1><ul class=""><li id="9365" class="jt ju hi iz b ja kz jd la jg lb jk lc jo ld js jy jz ka kb bi translated"><a class="ae le" href="https://nodejs.org/en/download/" rel="noopener ugc nofollow" target="_blank"> Node.js </a></li><li id="7ae9" class="jt ju hi iz b ja kc jd kd jg ke jk kf jo kg js jy jz ka kb bi translated"><a class="ae le" href="https://www.python.org/download/releases/3.0/" rel="noopener ugc nofollow" target="_blank">蟒3 </a></li></ul><h1 id="f9ef" class="kh ki hi bd kj kk kl km kn ko kp kq kr io ks ip kt ir ku is kv iu kw iv kx ky bi translated">Vonage API帐户</h1><p id="e558" class="pw-post-body-paragraph ix iy hi iz b ja kz ij jc jd la im jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">要完成这个教程，你需要一个<a class="ae le" href="http://developer.nexmo.com/ed?c=blog_text&amp;ct=2021-05-04-sentiment-analysis-for-customer-experience-with-python-and-streamlit" rel="noopener ugc nofollow" target="_blank"> Vonage API账户</a>。如果你还没有，你可以今天<a class="ae le" href="http://developer.nexmo.com/ed?c=blog_text&amp;ct=2021-05-04-sentiment-analysis-for-customer-experience-with-python-and-streamlit" rel="noopener ugc nofollow" target="_blank">注册</a>并开始用免费信用点数进行构建。一旦你有了一个帐户，你可以在<a class="ae le" href="http://developer.nexmo.com/ed?c=blog_text&amp;ct=2021-05-04-sentiment-analysis-for-customer-experience-with-python-and-streamlit" rel="noopener ugc nofollow" target="_blank"> Vonage API仪表板</a>的顶部找到你的API密匙和API秘密。</p><figure class="lj lk ll lm fd ln er es paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="er es li"><img src="../Images/8b2ad68d40f7d4b615fc9511bda4d8f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HHgYf7h7WINxcO_O.png"/></div></div></figure><h1 id="ce0b" class="kh ki hi bd kj kk kl km kn ko kp kq kr io ks ip kt ir ku is kv iu kw iv kx ky bi translated">创造一个脸书机器人</h1><p id="26e7" class="pw-post-body-paragraph ix iy hi iz b ja kz ij jc jd la im jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">Messages API沙箱允许企业通过各种社交渠道发送和接收消息，如WhatsApp、脸书和Viber。它还允许企业通过这个API发送短信和彩信。为了通过任何外部社交渠道发送消息，您需要每个提供商的商业帐户，并将其连接到您的Vonage APIs帐户。</p><p id="037a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在本教程中，我们将使用脸书，所以请确保您有一个脸书帐户准备测试。</p><p id="721f" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">要开始创建我们的应用程序，在您的项目目录中运行以下命令来初始化节点项目，然后安装所需的第三方库:</p><pre class="lj lk ll lm fd lu lv lw lx aw ly bi"><span id="6d16" class="lz ki hi lv b fi ma mb l mc md">npm init -y<br/>npm install express body-parser nedb @vonage/server-sdk@beta dotenv</span></pre><p id="2f70" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">以上命令将创建<code class="du me mf mg lv b">package.json</code>、<code class="du me mf mg lv b">package.lock</code>文件以及一个<code class="du me mf mg lv b">node_modules</code>目录。在<code class="du me mf mg lv b">package.json</code>文件中，你会看到我们刚刚安装的库，比如<code class="du me mf mg lv b">express</code>和<code class="du me mf mg lv b">vonage/server-sdk</code>。您将看到的示例如下所示:</p><pre class="lj lk ll lm fd lu lv lw lx aw ly bi"><span id="24e1" class="lz ki hi lv b fi ma mb l mc md">{<br/>  "name": "facebook-bot",<br/>  "version": "1.0.0",<br/>  "description": "Sign up for a Vonage API account at https://dashboard.nexmo.com.",<br/>  "main": "index.js",<br/>  "scripts": {<br/>    "serve": "node index.js"<br/>  },<br/>  "keywords": [],<br/>  "author": "",<br/>  "license": "ISC",<br/>  "dependencies": {<br/>    "@vonage/server-sdk": "^2.10.7-beta",<br/>    "body-parser": "^1.19.0",<br/>    "dotenv": "^8.2.0",<br/>    "express": "^4.17.1",<br/>    "nedb": "^1.8.0"<br/>  },<br/>  "devDependencies": {}<br/>}</span></pre><p id="d910" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当来自脸书的消息进来时，Vonage将向预先配置的webhook URL发送一个HTTP请求。您的节点应用程序应该可以访问互联网来接收它，所以我们建议使用<a class="ae le" href="https://learn.vonage.com/blog/2017/07/04/local-development-nexmo-ngrok-tunnel-dr" rel="noopener ugc nofollow" target="_blank"> Ngrok </a>。</p><p id="0e86" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在您的终端中，运行以下命令在端口<code class="du me mf mg lv b">3000</code>上启动ngrok(请注意，每次ngrok重新启动时，转发URL都会改变，因此如果您要重新启动Ngrok，请记住这一点):</p><pre class="lj lk ll lm fd lu lv lw lx aw ly bi"><span id="5643" class="lz ki hi lv b fi ma mb l mc md">npx ngrok http 3000</span></pre><p id="973e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们现在需要在<a class="ae le" href="https://dashboard.nexmo.com/applications/new" rel="noopener ugc nofollow" target="_blank">仪表板</a>中创建一个应用程序。确保添加一个与应用程序目的相关的名称，然后打开<code class="du me mf mg lv b">Messages</code>，因为该应用程序将需要使用消息API。然后点击“生成公钥和私钥”按钮。这将迫使你的浏览器下载一个<code class="du me mf mg lv b">private.key</code>文件。将它放在项目的根目录下。最后，单击<code class="du me mf mg lv b">Generate new application</code>按钮，这将把您重定向到应用程序显示页面。制作页面上显示的<code class="du me mf mg lv b">Application ID</code>的副本，因为这在下面的代码中也会用到。</p><p id="8c04" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">当你在这个页面上时，我们需要定义webhooks URLs。webhook是API的扩展，但是Vonage将数据发送给你，而不是你的代码从API平台请求数据。数据以web请求的形式到达您的应用程序，这可能是早期API调用的结果(这种类型的webhook也称为“回调”)，例如对消息传递API的异步请求。Webhooks也用来通知你的应用程序一些事件，比如一个传入的消息被存储在一个文件中，或者向应用程序发送一个传出的消息。</p><p id="fffd" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">url需要在<a class="ae le" href="https://dashboard.nexmo.com/messages/sandbox" rel="noopener ugc nofollow" target="_blank">仪表板</a>中更新，如下所示(确保用您的ngrok url替换<code class="du me mf mg lv b">&lt;ngrok URL&gt;</code>):</p><ul class=""><li id="d216" class="jt ju hi iz b ja jb jd je jg jv jk jw jo jx js jy jz ka kb bi translated">入站网页挂钩:<code class="du me mf mg lv b">http://&lt;ngrok URL&gt;/webhooks/inbound</code></li><li id="4b1d" class="jt ju hi iz b ja kc jd kd jg ke jk kf jo kg js jy jz ka kb bi translated">状态网页挂钩:<code class="du me mf mg lv b">http://&lt;ngrok URL&gt;/webhooks/status</code></li></ul><p id="7386" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">导航回<a class="ae le" href="https://dashboard.nexmo.com/messages/sandbox" rel="noopener ugc nofollow" target="_blank">消息沙箱</a>将你的脸书账户加入Facebook Messenger沙箱的白名单。点击<code class="du me mf mg lv b">Add to sandbox</code>并按照页面上的说明进行操作。</p><p id="792a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">将您的凭证存储到一个可以通过<code class="du me mf mg lv b">index.js</code>访问的<code class="du me mf mg lv b">.env</code>文件中。</p><pre class="lj lk ll lm fd lu lv lw lx aw ly bi"><span id="abde" class="lz ki hi lv b fi ma mb l mc md">VONAGE_API_KEY=###<br/>VONAGE_API_SECRET=###<br/>VONAGE_APPLICATION_ID=e0c5d5d8-###</span></pre><p id="3ba1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，在<code class="du me mf mg lv b">index.js</code>文件中，包含之前已经安装的模块，如express、Vonage server-sdk，如下例所示:</p><pre class="lj lk ll lm fd lu lv lw lx aw ly bi"><span id="804c" class="lz ki hi lv b fi ma mb l mc md">const app = require('express')()<br/>const bodyParser = require('body-parser')<br/>const nedb = require('nedb')<br/>const Vonage = require('@vonage/server-sdk')</span></pre><p id="6254" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">然后，我们需要用文件名<code class="du me mf mg lv b">messages.db</code>创建一个数据库，将下面一行添加到您的<code class="du me mf mg lv b">index.js</code>文件中:</p><pre class="lj lk ll lm fd lu lv lw lx aw ly bi"><span id="cb58" class="lz ki hi lv b fi ma mb l mc md">const messages = new nedb({ filename: 'messages.db', autoload: true })</span></pre><p id="bb3a" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们现在需要用我们的凭证初始化一个新的Vonage对象，凭证由API密钥、API秘密、应用程序ID以及private.key的路径和文件名组成。在您的<code class="du me mf mg lv b">index.js</code>文件中添加以下代码:</p><pre class="lj lk ll lm fd lu lv lw lx aw ly bi"><span id="f744" class="lz ki hi lv b fi ma mb l mc md">const vonage = new Vonage({<br/>  apiKey: process.env.VONAGE_API_KEY,<br/>  apiSecret: process.env.VONAGE_API_SECRET,<br/>  applicationId: process.env.VONAGE_APPLICATION_ID,<br/>  privateKey: './private.key'<br/>}, {<br/>  apiHost: 'https://messages-sandbox.nexmo.com'<br/>})</span></pre><p id="47b1" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们将创建一个名为<code class="du me mf mg lv b">sendMessage</code>的函数，它将向脸书发送消息，以响应客户的查询、反馈或评论。在如下例所示的函数中，有一个<code class="du me mf mg lv b">to</code>和一个<code class="du me mf mg lv b">from</code>，它们是API的指令。<code class="du me mf mg lv b">to</code>(或收件人)需要是白名单中的脸书帐户。将下面的函数添加到您的<code class="du me mf mg lv b">index.js</code>文件中:</p><pre class="lj lk ll lm fd lu lv lw lx aw ly bi"><span id="33d9" class="lz ki hi lv b fi ma mb l mc md">function sendMessage(sender, recipient, text) {<br/>  const to = { type: 'messenger', id: recipient }<br/>  const from = { type: 'messenger', id: sender }<br/>  const message = { content: { type: 'text', text: text } }<br/> <br/>  vonage.channel.send(to, from, message, function(error, result) {<br/>    if(error) { return console.error(error) }<br/>    console.log(result)<br/>  })<br/>}</span></pre><p id="b768" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">在上面的例子中，您将看到<code class="du me mf mg lv b">vonage.channel.send</code>，它发送一条带有参数<code class="du me mf mg lv b">to</code>、<code class="du me mf mg lv b">from</code>和message的消息，如果出现错误，将返回该错误，并将记录错误消息。</p><p id="75e2" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们需要在应用程序中添加webhook来监听URL中的路径<code class="du me mf mg lv b">/webhooks/inbound</code>,每当收到脸书消息时，它就会从Messages API接收消息。它从正文中解析并获得发送者的messenger id以及发送的文本，连同时间戳，并插入到响应消息中，给出错误条件if-else将成功理解用户的反馈。</p><p id="37cf" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">如果出现错误，发送回发送者的消息将是“对不起！你能重复一下吗？”。另一方面，如果messenger检索并向应用程序发送客户的消息，该消息将存储在<code class="du me mf mg lv b">messages.db</code>中，同时回复“感谢您的反馈和评论！”将被返还给用户。因此，将以下内容添加到您的<code class="du me mf mg lv b">index.js</code>文件中:</p><pre class="lj lk ll lm fd lu lv lw lx aw ly bi"><span id="c272" class="lz ki hi lv b fi ma mb l mc md">app.post('/inbound', function(request, response) {<br/>  if (request.body.message.content.text.toLowerCase().trim() === 'recap') {<br/>    messages.find({'from.id': request.body.from.id }, function (error, records) {<br/>      if (error) { return console.error(error) }<br/>      const message = records.map(function(record) {<br/>        return record.message.content.text + ' (sent at ' + record.timestamp + ')'<br/>      }).join('\n\n')<br/>      sendMessage(request.body.to.id, request.body.from.id, message)<br/>    })<br/>  } else {<br/>    messages.insert(request.body, function (error, record) {<br/>      if (error) {<br/>        sendMessage(request.body.to.id, request.body.from.id, 'Sorry! Could you repeat?')<br/>        return console.error(error)<br/>      }<br/>      sendMessage(request.body.to.id, request.body.from.id, 'Thanks for your feedback and review!')<br/>    })<br/>  }<br/> <br/>  response.send('ok')<br/>})</span></pre><p id="826b" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">最后，我们需要为<code class="du me mf mg lv b">/webhooks/status</code>端点添加另一个监听器，它将返回消息“ok”。我们还需要添加listen功能，使应用程序作为web服务器在端口<code class="du me mf mg lv b">3000</code>上运行和监听。因此，在您的<code class="du me mf mg lv b">index.js</code>文件的底部添加以下内容:</p><pre class="lj lk ll lm fd lu lv lw lx aw ly bi"><span id="edba" class="lz ki hi lv b fi ma mb l mc md">app.post('/status', function(request, response) {<br/>  console.log(request.body)<br/>  response.send('ok')<br/>})<br/>app.listen(3000)</span></pre><p id="6974" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在是时候测试您的应用程序了！首先您需要运行您的web应用程序，在您的终端中，运行以下命令:</p><pre class="lj lk ll lm fd lu lv lw lx aw ly bi"><span id="387f" class="lz ki hi lv b fi ma mb l mc md">node index.js</span></pre><p id="2f68" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">现在，如果你去<a class="ae le" href="https://www.messenger.com/" rel="noopener ugc nofollow" target="_blank"> Facebook Messenger </a>，找到Vonage沙盒用户并给它发送消息。您将在Messenger中收到回复。</p><h1 id="c1e8" class="kh ki hi bd kj kk kl km kn ko kp kq kr io ks ip kt ir ku is kv iu kw iv kx ky bi translated">分析用户的反馈</h1><p id="f1c9" class="pw-post-body-paragraph ix iy hi iz b ja kz ij jc jd la im jf jg lf ji jj jk lg jm jn jo lh jq jr js hb bi translated">通过Vonage沙箱从客户脸书获得的数据存储在<code class="du me mf mg lv b">messages.db</code>文件中。在模拟演示中，一个用户评论了一家定制公司的产品和服务，数据样本记录在下面的示例脚本中。</p><pre class="lj lk ll lm fd lu lv lw lx aw ly bi"><span id="397f" class="lz ki hi lv b fi ma mb l mc md">{"message_uuid":"e6e659be-3cdb-464f-96ef-8597cb307586","from":{"type":"messenger","id":"3819505444810553"},"to":{"type":"messenger","id":"107083064136738"},"message":{"content":{"type":"text","text":"how terrible can this product be, does not solve my pain point"}},"timestamp":"2021-03-15T08:43:30.993Z","_id":"6TdDhlo8CVxEr7tq"}<br/>{"message_uuid":"7775fa83-f073-481c-8866-c60bca28ec97","from":{"type":"messenger","id":"3819505444810553"},"to":{"type":"messenger","id":"107083064136738"},"message":{"content":{"type":"text","text":"how can there be no response for so long on such bad service"}},"timestamp":"2021-03-15T08:44:37.924Z","_id":"GSVzREWsYllKHOlJ"}</span></pre><p id="2f60" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以看到，对于发送给脸书机器人的每条消息，每个<code class="du me mf mg lv b">message_uuid</code>都是唯一的。<code class="du me mf mg lv b">from</code>和<code class="du me mf mg lv b">to</code>分别指定了客户和机器人的身份。该消息包含文本形式的内容，只是客户提供的反馈。为了分析这种反馈，将通过python Streamlit框架和TextBlob、WordCloud、Matplotlib和Pandas等库来可视化它们。创建一个名为<code class="du me mf mg lv b">dashboard.py</code>的新文件，并将以下代码添加到这个新文件中:</p><pre class="lj lk ll lm fd lu lv lw lx aw ly bi"><span id="1cdf" class="lz ki hi lv b fi ma mb l mc md">import streamlit as st<br/>from textblob import TextBlob<br/>from wordcloud import WordCloud, STOPWORDS, ImageColorGenerator<br/>import matplotlib.pyplot as plt<br/>import pandas as pd<br/>st.set_option('deprecation.showPyplotGlobalUse', False)</span></pre><p id="2ee9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated"><a class="ae le" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>是一个面向机器学习和数据科学团队的开源应用框架。<a class="ae le" href="https://textblob.readthedocs.io/en/dev/" rel="noopener ugc nofollow" target="_blank"> TextBlob </a>是一个用于处理文本数据的Python库。它提供了一个简单的API来处理常见的自然语言处理(NLP)任务。WordCloud是一种显示给定文本中哪些单词出现频率最高的技术。Matplotlib 是一个全面的库，用于在Python中创建静态、动画和交互式可视化。Pandas 是一个快速、强大、灵活且易于使用的开源数据分析和操作工具，构建于Python编程语言之上。</p><p id="fb28" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">使用所有这些工具，首先，我们打开存储在messages.db中的数据，读取并处理从所有用户那里收集的每条反馈记录。我们查找消息/内容并删除时间戳，因为这对于反馈中的情感分析是不需要的。处理后的反馈将存储在列表中。</p><p id="5e93" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">下面的示例执行上面列出的指令。将此添加到您的<code class="du me mf mg lv b">dashboard.py</code>文件的底部:</p><pre class="lj lk ll lm fd lu lv lw lx aw ly bi"><span id="d235" class="lz ki hi lv b fi ma mb l mc md">file1 = open('messages.db', 'r')<br/>Lines = file1.readlines()<br/>feedback_list = list()<br/>for line in Lines:<br/>   feedback = line.split(":")[11]<br/>   feedback = feedback.replace('}},"timestamp"',"")<br/>   feedback_list.append(feedback)</span></pre><p id="4fa4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们生成一个词云来可视化用户反馈中提供的词的频率。我们可以看到，某些关键词更加突出，如“可怕”、“长”、“坏”等。Wordcloud只是统计每个单词在客户提供的反馈的所有句子中出现了多少次。更好的方法是分析客户的整体情绪。</p><p id="dba9" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">我们可以对句子使用TextBlob基本情感极性分析，根据他们的文本反馈给出相对可靠的客户情感体验估计，并存储在新的情感值列表中。现在在您的<code class="du me mf mg lv b">dashboard.py</code>中添加以下代码:</p><pre class="lj lk ll lm fd lu lv lw lx aw ly bi"><span id="3ade" class="lz ki hi lv b fi ma mb l mc md">sentiment_values = list()<br/>for feedback in feedback_list:<br/>    sentiment_feedback = TextBlob(feedback).sentiment.polarity<br/>    sentiment_values.append(sentiment_feedback)</span></pre><p id="123e" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">接下来，我们将展示-1到1范围内的整体情绪。对于高于0的情绪极性，输出将是绿色的，而对于那些意味着不快乐的负值，情绪将在网页上显示为红色。将以下内容复制到您的<code class="du me mf mg lv b">dashboard.py</code>文件中:</p><pre class="lj lk ll lm fd lu lv lw lx aw ly bi"><span id="258e" class="lz ki hi lv b fi ma mb l mc md">st.title("Overall Sentiment")<br/>if average_sentiment &gt; 0:<br/>   colors = 'green'<br/>else:<br/>   colors = 'red'</span></pre><p id="b152" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">目前，总体情绪为-0.417，这表明总体上许多反馈并不支持公司的产品和服务。我们可以在表格中看到反馈，其中显示了每个反馈意见。很少有0值的感悟。这意味着分析发现这种反馈是中性的，不能理解信息的负面含义。我们可以看到“该产品无法匹配…”和“只有免费赠送给我时，我才会使用该产品”会暗示负面情绪，但结果是中性或积极的。因此，可以为这个用例的情感分析开发一个更复杂的学习和训练模型。此外，整体情绪分析可能不想只是简单的平均，而是潜在的更复杂的计算或加权平均。</p><p id="8ef4" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">可以通过初始化以下命令来启动Streamlit web dashboard应用程序。要设置web仪表板，需要安装Streamli。flask或Django中的其他部署方法也同样有效，可以进行探索。</p><pre class="lj lk ll lm fd lu lv lw lx aw ly bi"><span id="879c" class="lz ki hi lv b fi ma mb l mc md">streamlit run dashboard.py</span></pre><p id="d425" class="pw-post-body-paragraph ix iy hi iz b ja jb ij jc jd je im jf jg jh ji jj jk jl jm jn jo jp jq jr js hb bi translated">总之，本教程展示了如何设置并连接一个Vonage Messages API到脸书，并收集来自客户的反馈，然后使用情绪分析对这些反馈进行分析，以对客户的情绪进行实时监控。</p></div></div>    
</body>
</html>