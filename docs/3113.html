<html>
<head>
<title>Excel tips and tricks Part II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Excel提示和技巧第二部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/excel-tips-and-tricks-part-ii-ab5929c6c0cf?source=collection_archive---------12-----------------------#2021-06-07">https://medium.com/analytics-vidhya/excel-tips-and-tricks-part-ii-ab5929c6c0cf?source=collection_archive---------12-----------------------#2021-06-07</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><blockquote class="ie if ig"><p id="8730" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated">这些是excel中的一些技巧和窍门，我想我应该分享一下。有些比较明显，有些不明显，可能有助于任何使用该工具的人在使用excel时减少时间。</p><p id="4f83" class="ih ii ij ik b il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf ha bi translated"><strong class="ik hi">第一部分:</strong> <a class="ae jg" rel="noopener" href="/analytics-vidhya/excel-tips-and-tricks-part-i-12dd13d564de"> <strong class="ik hi"> Excel小窍门第一部分:</strong> </a></p></blockquote></div><div class="ab cl jh ji go jj" role="separator"><span class="jk bw bk jl jm jn"/><span class="jk bw bk jl jm jn"/><span class="jk bw bk jl jm"/></div><div class="ha hb hc hd he"><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es jo"><img src="../Images/24323ea9891d1d4f43079b81ffe95a40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oC8XZ4hxsVuApMwl"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated"><a class="ae jg" href="https://unsplash.com/@campaign_creators?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">活动创建者</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h1 id="20c2" class="ke kf hh bd kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">1.excel中的行定界数据:</h1><p id="8ee0" class="pw-post-body-paragraph ih ii hh ik b il lc in io ip ld ir is le lf iv iw lg lh iz ja li lj jd je jf ha bi translated"><em class="ij">在处理基于产品属性的数据时非常有用。</em></p><p id="861e" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is le iu iv iw lg iy iz ja li jc jd je jf ha bi translated">我们都知道如何根据特殊字符对列进行定界，但当您的数据具有多个属性时，行定界非常有用，例如:您想购买iPhone 12，因此您将查看所有不同的可用型号——iPhone 12、iPhone 12 mini、iPhone 12 Pro、iPhone 12 Pro Max，每个变体都有自己独特的属性。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es lk"><img src="../Images/33c74897dd82728f002a2a3b7b6cb961.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JFwU__2u0sL9mMj7wA4Zgg.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">来自Amazon.com的照片</figcaption></figure><p id="ce09" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is le iu iv iw lg iy iz ja li jc jd je jf ha bi translated">在选择手机后的产品页面上，您可以看到每个变体都有一个内存属性——128 GB、256 GB、512 GB，以及一个颜色属性——金色、石墨色、太平洋蓝、银色。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es ll"><img src="../Images/c0cc48ddd82e6f9ff03e35a85592a5c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*RBIJDHkB3r0O_ArTyW0pmw.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">来自Amazon.com的照片</figcaption></figure><p id="1549" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is le iu iv iw lg iy iz ja li jc jd je jf ha bi translated">这个例子只是针对iPhone，一些手机也有内存和摄像头规格。</p><p id="7471" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is le iu iv iw lg iy iz ja li jc jd je jf ha bi translated">为了节省空间，内存和颜色属性可能会通过一个特殊字符简化为数据集中的一个单元格，就像下面iPhone 12 Pro的截图中那样:</p><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es lm"><img src="../Images/dfd1e0ab6135e42f66b240dbbb67b897.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iWl8ohCl1fHcYjEtDpg_6A.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">不同的内存和基于颜色的属性由“|”分隔，我们将使用它来划分和分解数据。</figcaption></figure><p id="6056" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is le iu iv iw lg iy iz ja li jc jd je jf ha bi translated">要对数据进行行定界，您需要使用CTRL+T将数据集转换为表格，一旦完成，它将显示如下:</p><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es ln"><img src="../Images/1e1b9f850a088273e1529be5d44ea4b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S1Jn2NpN2nKILxWIalsJIQ.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">数据集被转换为表。</figcaption></figure><p id="3164" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is le iu iv iw lg iy iz ja li jc jd je jf ha bi translated">然后打开<strong class="ik hi">功率查询编辑器(数据&gt;从其他来源获取数据&gt;&gt;来自表格/范围)</strong>。打开后，您可以使用光标选择该列(您想要通过来定界)，因此在我的情况下，我将使用<strong class="ik hi">内存来定界。</strong>然后选择<strong class="ik hi">通过分隔符分割列&gt;</strong>将会打开一个窗口，让您选择想要分隔的字符。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es lo"><img src="../Images/6dcf385bf78d3ce4f9c5b2e0e0676b14.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*DSQkTV0o_upkFc6TFBvs9Q.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">这通常是自动检测的。</figcaption></figure><p id="77d0" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is le iu iv iw lg iy iz ja li jc jd je jf ha bi translated">在同一个窗口中通过<strong class="ik hi">打开高级选项</strong>并选择<strong class="ik hi">行来划定整个表基础的一个属性。单击确定。</strong></p><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es lp"><img src="../Images/644fe7a323e80e847c6654a3e3b8fd3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*9m0Ouw3AiKoE5-FTIfB1Fw.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">默认设置为列，没有单独的行定界功能。</figcaption></figure><p id="478c" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is le iu iv iw lg iy iz ja li jc jd je jf ha bi translated">您会在<strong class="ik hi"> Power Query Editor </strong>中看到，该表已针对每个可用内存选项的每一行进行了分解。点击<strong class="ik hi">关闭&amp;加载。</strong></p><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es lq"><img src="../Images/22b4f7f1cf54f5a01f6bdf02c472c361.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LsmdLayHIlno9QwKXfKByg.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">你也可以对颜色做同样的事情，得到单独的内存和颜色行。</figcaption></figure></div><div class="ab cl jh ji go jj" role="separator"><span class="jk bw bk jl jm jn"/><span class="jk bw bk jl jm jn"/><span class="jk bw bk jl jm"/></div><div class="ha hb hc hd he"><h1 id="a120" class="ke kf hh bd kg kh lr kj kk kl ls kn ko kp lt kr ks kt lu kv kw kx lv kz la lb bi translated">2.使用SEQUENCE()自动生成序列号:</h1><p id="a8ba" class="pw-post-body-paragraph ih ii hh ik b il lc in io ip ld ir is le lf iv iw lg lh iz ja li lj jd je jf ha bi translated">我过去在excel中创建序列号的效率是多么低。</p><p id="ae98" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is le iu iv iw lg iy iz ja li jc jd je jf ha bi translated">这适用于您想要在空白表上创建序列号列的任何时候，或者适用于没有序列号列的数据集。<br/> <strong class="ik hi">低效的方法:</strong>通常的方法是将第一个单元格赋值为1，从第二个单元格开始，您可以使用=“第一个单元格引用”+1</p><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es lw"><img src="../Images/4b4c52386d068169d06196e4b1cc02fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:232/format:webp/1*ciVHdDFj2ZrlVuo1wZXbDw.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">然后把这个公式拖到最后。</figcaption></figure><p id="c400" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is le iu iv iw lg iy iz ja li jc jd je jf ha bi translated">但是这样效率不高，尤其是因为您必须手动拖动并选择公式。幸运的是，已经有一个函数可以做到这一点——“SEQUENCE([n个数])”。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div class="er es lx"><img src="../Images/c3867b6ad2b0f189a443638fc49e447c.png" data-original-src="https://miro.medium.com/v2/resize:fit:328/format:webp/1*d2Vb7H4hIxyLyYMu8M-yAA.png"/></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">如您所见，您可以输入想要序列号的行数，它会自动填充到您的列中。</figcaption></figure><p id="fb22" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is le iu iv iw lg iy iz ja li jc jd je jf ha bi translated"><strong class="ik hi">使用Sequence(): </strong>让我们通过一个例子来探索这个函数，假设我们想要为上面使用的iPhone 12数据集分配一个序列号列，这可能会派上用场。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es ly"><img src="../Images/509b96fb2c5c723f57d4783c4b82349f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BxfRXdWVMzEdXSdPEglR5g.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">有12行数据点，所以我们增加了12行作为参考数字。</figcaption></figure><p id="b9ee" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is le iu iv iw lg iy iz ja li jc jd je jf ha bi translated">但是像这样使用它有一个明显的问题，如果数据是行偏移的，那么我们需要在公式中计算输入的行数吗？不是，那我们可以用<strong class="ik hi"> COUNTA(【列范围】)</strong>和这个连用。</p><figure class="jp jq jr js fd jt er es paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="er es lz"><img src="../Images/0dd5d5426c9ab22adf91654fa374c976.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4wm1VVeDbKjEC8D8ZA_rcA.png"/></div></div><figcaption class="ka kb et er es kc kd bd b be z dx translated">“-1”是这里头的因子，否则我们将范围扩展到13。</figcaption></figure><p id="3331" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is le iu iv iw lg iy iz ja li jc jd je jf ha bi translated">你内心的悲观主义者可能会提出一个有效的观点:“如果区间中间有一个空白怎么办？”然后，或者使用一个没有空白的不同范围，或者您可以使用涉及使用<strong class="ik hi">间接+行</strong>设置动态范围选择的公式来计算给定范围内的空白:</p><p id="f94d" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is le iu iv iw lg iy iz ja li jc jd je jf ha bi translated">= SEQUENCE(COUNTA(E:E)-1<strong class="ik hi">+count blank(INDIRECT(" D :D "&amp;MAX(IF(is blank(E:E)，0，ROW(E:E))))) </strong>)</p><p id="a27a" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is le iu iv iw lg iy iz ja li jc jd je jf ha bi translated">或者最好只添加1000行，以防万一。</p></div><div class="ab cl jh ji go jj" role="separator"><span class="jk bw bk jl jm jn"/><span class="jk bw bk jl jm jn"/><span class="jk bw bk jl jm"/></div><div class="ha hb hc hd he"><p id="7cd5" class="pw-post-body-paragraph ih ii hh ik b il im in io ip iq ir is le iu iv iw lg iy iz ja li jc jd je jf ha bi translated">请继续关注更多Excel提示、技巧和案例。</p></div></div>    
</body>
</html>