<html>
<head>
<title>Amazon Electronics Reviews Classifier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">亚马逊电子评论分类器</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/amazon-electronics-reviews-classifier-aa69dcc3f829?source=collection_archive---------23-----------------------#2021-03-23">https://medium.com/analytics-vidhya/amazon-electronics-reviews-classifier-aa69dcc3f829?source=collection_archive---------23-----------------------#2021-03-23</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="43d6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你是一个像我一样在亚马逊购买产品时会想“我应该给多少颗星”的人，这篇中等文章就适合你。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/d7b0197a9b5b88aa9feefe40ce5f5c4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eCZcDrP20BGnDytL"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">约纳斯·勒普在<a class="ae js" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="80dd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在这个项目中，我在包含亚马逊评论的数据集中选择了<a class="ae js" href="https://nijianmo.github.io/amazon/index.html" rel="noopener ugc nofollow" target="_blank">电子数据集</a>。我通过在我训练的模型中选择最好的模型做了一个应用，发布在Heroku上。</p><h2 id="c6d9" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ip ke kf kg it kh ki kj ix kk kl km kn bi translated">现在让我们来看看这个项目的目的</h2><p id="755b" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">如今，产品和批评已经超越了私人页面，也发生在社交媒体空间。</p><p id="8e95" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">当我在亚马逊上查看电子产品的评论时，大多数产品评论者的评分都在3到5分之间，所以如果一个新客户在前面提到的任何一个评论网站上浏览在线评论，他们就会通过亚马逊进行购买。</p><p id="8504" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">观点不断在社交媒体平台上分享，并被其追随者阅读。通过阅读这些在线帖子，关于这些追随者对产品的看法的信息可以帮助我们更好地了解公众对产品的看法。</p><p id="8510" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果我们在亚马逊工作，如果一个评论被归类在3分以下，我们可以看看那个产品评论，找出他们为什么对产品有负面意见，并作为回报解决问题。</p><p id="5b9f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你可以在这里访问我的Heroku应用<a class="ae js" href="https://review-rating-predictor-byogi.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl kt ku go kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ha hb hc hd he"><h2 id="0cde" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ip ke kf kg it kh ki kj ix kk kl km kn bi translated">别跟我解释，出示代码</h2><p id="ad8f" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">你可以在这里访问GitHub repo。</p></div><div class="ab cl kt ku go kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ha hb hc hd he"><h1 id="0e44" class="la ju hh bd jv lb lc ld jz le lf lg kd lh li lj kg lk ll lm kj ln lo lp km lq bi translated">现在，让我们看看项目中的步骤</h1><h2 id="16e1" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ip ke kf kg it kh ki kj ix kk kl km kn bi translated">1.预处理</h2><p id="91bc" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">在这一步中，我们将从数据集中提取我们认为必要的部分，应用必要的预处理操作，并保存数据集。</p><p id="946a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我在数据集中为项目选择了必要的变量。</p><pre class="jd je jf jg fd lr ls lt lu aw lv bi"><span id="85bd" class="jt ju hh ls b fi lw lx l ly lz">df_= pd.read_csv("Data/df_sub.csv")<br/>df_.dropna(inplace=True)<br/>df["all_text"] = df_["summary"]+df_["reviewText"]<br/>df["overall"] =df_["overall"]</span></pre><p id="b7b0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">执行完第一步后，让我们从名为all_text的文本中执行我们认为不必要的每一步。分别将所有字符转换为小写，删除特殊格式，如电子邮件地址，删除重音字符和删除特殊字符。</p><pre class="jd je jf jg fd lr ls lt lu aw lv bi"><span id="e501" class="jt ju hh ls b fi lw lx l ly lz">df["all_text"] = df["all_text"].apply(lambda x: get_clean(x))<br/>#df.head()<br/><br/>df.to_csv('Amazon yorum/preprocessed.csv',index=False)</span></pre><h2 id="9967" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ip ke kf kg it kh ki kj ix kk kl km kn bi translated">2.TF-IDF</h2><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ma"><img src="../Images/8e53cc3a2e6fa7cf0a4fcc18974c34a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*P_qegdkNXk4ln4uW"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">照片由<a class="ae js" href="https://unsplash.com/@hishahadat?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">沙哈达特·拉赫曼</a>在<a class="ae js" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="8529" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因为我们将对文本进行预测，所以让我们用TF-IDF使它们在矩阵格式中可行。</p><pre class="jd je jf jg fd lr ls lt lu aw lv bi"><span id="a012" class="jt ju hh ls b fi lw lx l ly lz">tfidf = TfidfVectorizer(max_features=20000, ngram_range=(1,3),analyzer='char')<br/>X = tfidf.fit_transform(df["all_text"])<br/>pickle.dump(tfidf, open("Amazon yorum/tfidf.pickle", "wb"))<br/>pickle.dump(X, open("Amazon yorum/X.pickle", "wb"))<br/>y = df["overall"]</span></pre><h2 id="520f" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ip ke kf kg it kh ki kj ix kk kl km kn bi translated">3.构建模型并选择最佳模型</h2><p id="fbf1" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">其实我们的数据并不是平衡数据。特别是低星评论相当低，所以如果没有非常明确的负面评论，很难获得低分。但是，通过创建最佳模型，我们将选择能为低分提供平衡结果的模型。</p><pre class="jd je jf jg fd lr ls lt lu aw lv bi"><span id="0474" class="jt ju hh ls b fi lw lx l ly lz">def score_funct(model, X_train, X_test, y_train, y_test):<br/>    acc_train = model.score(X_train, y_train)<br/>    acc_test = model.score(X_test, y_test)<br/>    d = {'Train Accuracy': [acc_train],<br/>         'Validation Accuracy': [acc_test],<br/>         'Accuracy Difference': [acc_train -acc_test]}<br/>    scores_table = pd.DataFrame(data=d)<br/>    return scores_table</span><span id="6e99" class="jt ju hh ls b fi mb lx l ly lz">skf = StratifiedKFold(n_splits=5,random_state=42,shuffle=True)</span></pre><p id="e013" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我应用了某些分类模型，并试图调整它们。当然，可以产生更好的模型，甚至更多，使用神经网络可以产生成功的模型，但这里的目的是；访问最好的机器学习模型将会很容易。</p><pre class="jd je jf jg fd lr ls lt lu aw lv bi"><span id="8ddf" class="jt ju hh ls b fi lw lx l ly lz">### Decision Tree Classifier ###<br/>dec_tree = DecisionTreeClassifier()<br/>params = {'min_samples_leaf':[3,5,10,15,30,50,100],<br/>          'max_depth':[2,3,4,5,6,7,8,9]}<br/>opt_model = GridSearchCV(dec_tree,<br/>                                 params,<br/>                                 cv=skf,<br/>                                 scoring='accuracy',<br/>                                 return_train_score=True,<br/>                                 n_jobs=-1)<br/>opt_model.fit(X_train, y_train)<br/>opt_model.best_params_<br/>dec_tree_model = opt_model.best_estimator_<br/>dec_table = score_funct(dec_tree_model,X_train,X_test, y_train, y_test)</span><span id="7ef5" class="jt ju hh ls b fi mb lx l ly lz"><br/>#   Train Accuracy  Validation Accuracy  Accuracy Difference<br/>#0        0.817048             0.801628             0.015421</span><span id="e178" class="jt ju hh ls b fi mb lx l ly lz">### Random Forest  ###<br/>rf = RandomForestClassifier()<br/><br/>params = {'min_samples_leaf':[2,3,5,10,15,30,50,100],<br/>          'max_depth':[17,19,21,23,25,27,30]}<br/>opt_model = GridSearchCV(rf,<br/>                                 params,<br/>                                 cv=skf,<br/>                                 scoring='accuracy',<br/>                                 return_train_score=True,<br/>                                 n_jobs=-1)<br/><br/>opt_model.fit(X_train, y_train)<br/>opt_model.best_params_<br/>rf_model = opt_model.best_estimator_<br/>rf_table = score_funct(rf_model,X_train,X_test, y_train, y_test)<br/><br/>#   Train Accuracy  Validation Accuracy  Accuracy Difference<br/>#0        0.842494             0.791455             0.051039</span><span id="500a" class="jt ju hh ls b fi mb lx l ly lz">### KNN ###<br/>knn = KNeighborsClassifier()<br/>params = {'n_neighbors':[5,10,15,20,25,30,40]}<br/>opt_model = GridSearchCV(knn,<br/>                         params,<br/>                         cv=skf,<br/>                         scoring='accuracy',<br/>                         return_train_score=True,<br/>                         n_jobs=-1)<br/>opt_model.fit(X_train, y_train)<br/>opt_model.best_params_<br/>knn_model = opt_model.best_estimator_<br/>knn_table = score_funct(knn_model,X_train,X_test, y_train, y_test)<br/>#    Train Accuracy  Validation Accuracy  Accuracy Difference<br/># 0         0.81145             0.802645             0.008805<br/><br/>### Adaboost ###<br/>ada_boost = AdaBoostClassifier()<br/>params = {'learning_rate':[0.3,0.5, 0.7]}<br/>opt_model = GridSearchCV(ada_boost,<br/>                         params,<br/>                         cv=skf,<br/>                         scoring='accuracy',<br/>                         return_train_score=True,<br/>                         n_jobs=-1)<br/>opt_model.fit(X_train, y_train)<br/>opt_model.best_params_<br/>ada_model = opt_model.best_estimator_<br/>ada_table = score_funct(ada_model,X_train,X_test, y_train, y_test)<br/>#    Train Accuracy  Validation Accuracy  Accuracy Difference<br/># 0        0.814758             0.803662             0.011096</span></pre><p id="cc31" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我选择KNN是因为它在我安装的型号中出错率最低。我保存了这个模型，以便以后可以用它来预测。</p><pre class="jd je jf jg fd lr ls lt lu aw lv bi"><span id="edea" class="jt ju hh ls b fi lw lx l ly lz">pickle.dump(knn_model, open(f'Models/best_model.pkl', 'wb'))</span></pre><h2 id="ecec" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ip ke kf kg it kh ki kj ix kk kl km kn bi translated">4.通过模型创建预测</h2><p id="186f" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">我们正在导入我之前保存的模型，以及我为tf-idf创建的矩阵。</p><pre class="jd je jf jg fd lr ls lt lu aw lv bi"><span id="26cb" class="jt ju hh ls b fi lw lx l ly lz">model = pickle.load(open('Models/best_model.pkl','rb'))<br/>tfidf = pickle.load(open('tfidf.pickle', 'rb'))<br/>X = pickle.load(open('X.pickle','rb'))</span></pre><p id="4c77" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">之后，我们将评论文本和摘要结合起来，我们将通过Streamlit接口获得它们，并将其转换成一个变量。</p><pre class="jd je jf jg fd lr ls lt lu aw lv bi"><span id="9d75" class="jt ju hh ls b fi lw lx l ly lz">sl.title("Amazon Product Review Rating Application")<br/><br/>review_summary_text = sl.text_input('Enter Your Review Summary Here')<br/>review_text = sl.text_area('Enter Your Review Here')<br/><br/>if sl.button('Predict'):<br/>    result_review_sum = review_summary_text.title()<br/><br/>    result_review = review_text.title()<br/><br/>    all_review_text = result_review_sum + result_review</span></pre><p id="6c40" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在下一步中，在应用了我们之前用来训练模型的预处理步骤并进行tf-idf变换之后。</p><pre class="jd je jf jg fd lr ls lt lu aw lv bi"><span id="b48c" class="jt ju hh ls b fi lw lx l ly lz">    X = get_clean(all_review_text)<br/>    vec = tfidf.transform([X])<br/>    prediction = model.predict(vec)<br/><br/>    sl.success(prediction[0])</span></pre></div><div class="ab cl kt ku go kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ha hb hc hd he"><p id="23c7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">把这些python文件全部上传到GitHub后，我用Heroku把它们转换成应用。因此，在回顾回购协议后，你可以看到它是如何运作的。</p><h2 id="7668" class="jt ju hh bd jv jw jx jy jz ka kb kc kd ip ke kf kg it kh ki kj ix kk kl km kn bi translated">5.预言</h2><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mc"><img src="../Images/852cc1d157fc25b23b3c2fd2860e2d11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LKMUt5kAuigkaRew"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">迈克尔·泽兹奇在<a class="ae js" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="997f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我在我的Heroku应用程序上写了一条我在Amazon.com上找到的评论，以及它的摘要，并查看了分数。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es md"><img src="../Images/2786cf017e1b90333585c11fd1276a23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZL7LxOv-e3c4cuaq_DIgBQ.png"/></div></div></figure><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es me"><img src="../Images/3798dc93c5d7532ab011e7dc023a9fcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8gC00Y12kY9qRlKiXQNxzg.png"/></div></div></figure><p id="eff1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然后我通过找到一篇关于Amazon.com的负面评论来尝试预测。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mf"><img src="../Images/d687582079f8d89bfafced6b4f2645e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jWixAJfwGl31Wg-RqqyCRg.png"/></div></div></figure><p id="3406" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">然而，由于我的数据集很小，我不能说我训练的模型非常成功，特别是产生像1和2这样的低分数一直很有挑战性。如果我使用更大的数据集，我认为我可以获得更成功的结果。</p><p id="1e68" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><em class="mg">感谢阅读！</em></p><h1 id="5d12" class="la ju hh bd jv lb mh ld jz le mi lg kd lh mj lj kg lk mk lm kj ln ml lp km lq bi translated">参考</h1><p id="b7fd" class="pw-post-body-paragraph ie if hh ig b ih ko ij ik il kp in io ip kq ir is it kr iv iw ix ks iz ja jb ha bi translated">[1]安德烈·贝利教授—<a class="ae js" href="https://www.expert.ai/" rel="noopener ugc nofollow" target="_blank">https://www.expert.ai/</a></p><p id="4f04" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae js" href="https://www.veribilimiokulu.com/bootcamp-programlari/veri-bilimci-yetistirme-programi/" rel="noopener ugc nofollow" target="_blank">https://www.veribilimiokulu.com</a></p><p id="6842" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae js" href="https://nijianmo.github.io/amazon/index.html" rel="noopener ugc nofollow" target="_blank">https://nijianmo.github.io/amazon/index.html</a></p></div></div>    
</body>
</html>