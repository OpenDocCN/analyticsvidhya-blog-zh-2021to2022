<html>
<head>
<title>Deploying Django Apps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">部署Django应用程序</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/deploying-django-apps-e2f4d4f355a1?source=collection_archive---------1-----------------------#2021-01-08">https://medium.com/analytics-vidhya/deploying-django-apps-e2f4d4f355a1?source=collection_archive---------1-----------------------#2021-01-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="dd37" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">Django与Nginx和Gunicorn在AWS Cloud上。</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/7fdbf758b62c29d307393f2e0c322950.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2700wjw1aRnH7A9bBel_aw.jpeg"/></div></div></figure><p id="e29d" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hi">简介</strong></p><p id="67e4" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">一旦我们完成了web应用程序的开发部分，它应该被托管，以便公众可以从任何地方访问它。我们将看到如何使用Nginx作为web服务器，Gunicorn作为WSGI，在AWS EC2实例上部署和托管django应用程序。</p><p id="5a1d" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hi"> AWS EC2 </strong></p><p id="5942" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">亚马逊弹性计算云(Amazon EC2)是一种在云中提供可调整计算能力的web服务。在选择了AMI (OS)之后，我们在EC2实例上部署和托管我们的web应用程序。我们将在接下来的章节中看到更多相关内容。更多关于EC2 <a class="ae ke" href="https://aws.amazon.com/ec2/?ec2-whats-new.sort-by=item.additionalFields.postDateTime&amp;ec2-whats-new.sort-order=desc" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="474b" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hi"> NGINX </strong></p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es kf"><img src="../Images/191ca4a5e5a789257da44795d45a10bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rw5UtkN4fSKRnGll6pNqoA.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">Nginx</figcaption></figure><p id="ef87" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">Nginx是一个开源的web服务器，由于它作为web服务器的成功，现在也被用作反向代理、HTTP缓存和负载平衡器。我们将根据需要使用Nginx服务我们的网页。更多关于Nginx <a class="ae ke" href="https://www.nginx.com/" rel="noopener ugc nofollow" target="_blank">的信息，请点击</a></p><p id="fa42" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hi">古尼康</strong></p><p id="2eb6" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><a class="ae ke" href="https://gunicorn.org/" rel="noopener ugc nofollow" target="_blank"> Gunicorn </a>是一个Web服务器网关接口(WSGI)服务器实现，通常用于运行Python web应用程序。</p><p id="91f3" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">WSGI——用于将请求从web服务器转发到python后端。</p><blockquote class="kk kl km"><p id="822b" class="ji jj kn jk b jl jm ii jn jo jp il jq ko js jt ju kp jw jx jy kq ka kb kc kd ha bi translated">我们不会在生产中默认使用django自带的服务器。</p></blockquote><h1 id="da04" class="kr ks hh bd kt ku kv kw kx ky kz la lb in lc io ld iq le ir lf it lg iu lh li bi translated"><strong class="ak">部署应用程序</strong></h1><p id="4a1f" class="pw-post-body-paragraph ji jj hh jk b jl lj ii jn jo lk il jq jr ll jt ju jv lm jx jy jz ln kb kc kd ha bi translated">我们将在aws上启动一个EC2实例，用于登录AWS控制台</p><ul class=""><li id="db1c" class="lo lp hh jk b jl jm jo jp jr lq jv lr jz ls kd lt lu lv lw bi translated">从所有服务中选择EC2</li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lx"><img src="../Images/0eac79e40646fe823226a1cc8185f5c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i33dc48TDYQ7T8NShE8SdQ.png"/></div></div></figure><ul class=""><li id="30ed" class="lo lp hh jk b jl jm jo jp jr lq jv lr jz ls kd lt lu lv lw bi translated">选择启动新实例，我们将从列表中选择Ubuntu。</li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ly"><img src="../Images/b1eab4d89010fe3c2fb8714f509e72c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AzWtFJDjxTXHOsdKLgsXrQ.png"/></div></div></figure><ul class=""><li id="5acf" class="lo lp hh jk b jl jm jo jp jr lq jv lr jz ls kd lt lu lv lw bi translated">选择任意一个实例，每个实例都有不同的配置，我们将选择具有可用自由层的实例。</li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lz"><img src="../Images/b99d22cb9d2d29cec5ea8e51c0feb726.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JDR0BS_m6SZCEn9T8hBlDQ.png"/></div></div></figure><ul class=""><li id="0414" class="lo lp hh jk b jl jm jo jp jr lq jv lr jz ls kd lt lu lv lw bi translated">现在配置安全组并打开端口<em class="kn"> 8000 </em>和<em class="kn"> 9000 </em>，因为我们将使用这些端口。检查并启动实例，实例可能需要一些时间才能开始运行。</li></ul><p id="1dd3" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hi">连接到实例</strong></p><p id="3d3b" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">我们可以使用控制台中的“连接”选项(<em class="kn">或使用putty或任何其他类似工具)连接到一个实例。一旦连接，运行以下</em></p><pre class="ix iy iz ja fd ma mb mc md aw me bi"><span id="fcee" class="mf ks hh mb b fi mg mh l mi mj">sudo apt-get update</span></pre><p id="e4ac" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">安装python、pip和django</p><pre class="ix iy iz ja fd ma mb mc md aw me bi"><span id="0f23" class="mf ks hh mb b fi mg mh l mi mj">sudo apt install python</span><span id="d662" class="mf ks hh mb b fi mk mh l mi mj">sudo apt install python3-pip</span><span id="9d5b" class="mf ks hh mb b fi mk mh l mi mj">pip3 install django</span></pre><p id="c7b5" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">现在我们已经安装了我们的依赖项，我们可以创建一个文件夹来复制django应用程序</p><pre class="ix iy iz ja fd ma mb mc md aw me bi"><span id="6719" class="mf ks hh mb b fi mg mh l mi mj">cd  /home/ubuntu/  <br/>mkdir Project<br/>cd Project<br/>mkdir ProjectName<br/>cd ProjectName</span></pre><p id="fced" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">现在我们将把代码放在下面的路径中<em class="kn">/home/Ubuntu/Project/Project name</em></p><p id="6cee" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hi"> GitHub </strong></p><p id="0a9b" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">确保您的代码在存储库中，以便我们可以轻松地将代码放入ec2实例中。</p><ul class=""><li id="7930" class="lo lp hh jk b jl jm jo jp jr lq jv lr jz ls kd lt lu lv lw bi translated">转到新创建的文件夹(<em class="kn">/home/Ubuntu/Project/Project name/</em>)</li><li id="faf6" class="lo lp hh jk b jl ml jo mm jr mn jv mo jz mp kd lt lu lv lw bi translated">git克隆&lt;<em class="kn">存储库-url &gt; </em></li></ul><p id="2848" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">这将把存储库克隆到文件夹中，下一次我们可以使用<em class="kn"> git pull </em>来获取更改</p><p id="0302" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hi"> Settings.py文件</strong></p><p id="11f3" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">我们必须对项目中的settings.py进行一些更改</p><ul class=""><li id="3a2e" class="lo lp hh jk b jl jm jo jp jr lq jv lr jz ls kd lt lu lv lw bi translated">将您的密钥和密码放在环境变量中</li><li id="d9d5" class="lo lp hh jk b jl ml jo mm jr mn jv mo jz mp kd lt lu lv lw bi translated">设置Debug =False</li></ul><pre class="ix iy iz ja fd ma mb mc md aw me bi"><span id="f3d5" class="mf ks hh mb b fi mg mh l mi mj">DEBUG = False</span></pre><ul class=""><li id="4fff" class="lo lp hh jk b jl jm jo jp jr lq jv lr jz ls kd lt lu lv lw bi translated">设置允许的主机</li></ul><pre class="ix iy iz ja fd ma mb mc md aw me bi"><span id="b1ec" class="mf ks hh mb b fi mg mh l mi mj">ALLOWED_HOSTS = [‘your domain name’]</span></pre><ul class=""><li id="dd25" class="lo lp hh jk b jl jm jo jp jr lq jv lr jz ls kd lt lu lv lw bi translated">添加静态文件夹</li></ul><pre class="ix iy iz ja fd ma mb mc md aw me bi"><span id="74b1" class="mf ks hh mb b fi mg mh l mi mj">BASE_DIR=os.path.dirname(os.path.dirname(os.path.abspath(__file__)))<br/>STATIC_ROOT = os.path.join(BASE_DIR, “static”)</span></pre><blockquote class="kk kl km"><p id="1446" class="ji jj kn jk b jl jm ii jn jo jp il jq ko js jt ju kp jw jx jy kq ka kb kc kd ha bi translated">运行下面的命令，这样模型迁移就会发生，所有的静态文件都会被收集到一个公共文件夹中(STATIC_ROOT 中给出的<em class="hh">路径)</em></p></blockquote><pre class="ix iy iz ja fd ma mb mc md aw me bi"><span id="287b" class="mf ks hh mb b fi mg mh l mi mj">manage.py makemigrations</span><span id="6946" class="mf ks hh mb b fi mk mh l mi mj">manage.py migrate</span><span id="7e13" class="mf ks hh mb b fi mk mh l mi mj">manage.py collectstatic</span></pre><p id="59a3" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hi">安装Nginx </strong></p><p id="3328" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">要安装Nginx，请运行以下命令</p><pre class="ix iy iz ja fd ma mb mc md aw me bi"><span id="4089" class="mf ks hh mb b fi mg mh l mi mj"> <em class="kn">sudo apt install nginx</em></span></pre><p id="d23f" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">在<strong class="jk hi">/<em class="kn">etc/nginx/sites-enabled</em></strong>/中有一个名为<em class="kn"> defaul </em> t的配置文件，它是NGINX的基本设置，我们将编辑这个文件。</p><pre class="ix iy iz ja fd ma mb mc md aw me bi"><span id="969c" class="mf ks hh mb b fi mg mh l mi mj"><em class="kn">sudo vi default</em></span></pre><p id="2f77" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">添加必要的配置后，文件看起来会像这样，并保持文件的其余部分不变。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mq"><img src="../Images/190276f66c1bda982f4f7722d1965fa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wZJaypvAPH_BBLcTAR8k-Q.png"/></div></div><figcaption class="kg kh et er es ki kj bd b be z dx translated">nginx的默认文件</figcaption></figure><p id="9f64" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">我们将添加<strong class="jk hi"><em class="kn">proxy _ pass</em></strong><a class="ae ke" href="http://0.0.0.0:9000" rel="noopener ugc nofollow" target="_blank"><strong class="jk hi"><em class="kn">http://0 . 0 . 0 . 0:900</em></strong></a><strong class="jk hi"><em class="kn">0</em></strong>，并且我们将通过在<strong class="jk hi"><em class="kn">location/static/</em></strong>中添加路径来提供静态文件夹的路径，如上所述。通过运行以下命令，确保您已经将所有静态文件收集到一个公共文件夹中</p><pre class="ix iy iz ja fd ma mb mc md aw me bi"><span id="cb7c" class="mf ks hh mb b fi mg mh l mi mj">manage.py collectstatic</span></pre><p id="34e0" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">现在启动nginx服务器</p><pre class="ix iy iz ja fd ma mb mc md aw me bi"><span id="25d2" class="mf ks hh mb b fi mg mh l mi mj"><em class="kn">sudo service nginx start             #to start nginx<br/>sudo service nginx stop              #to stop nginx<br/>sudo service nginx restart           #to restart nginx</em></span></pre><p id="e347" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hi">安装Gunicorn </strong></p><pre class="ix iy iz ja fd ma mb mc md aw me bi"><span id="9e28" class="mf ks hh mb b fi mg mh l mi mj"><em class="kn">pip install gunicorn</em></span></pre><p id="ed96" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">确保您在项目文件夹<em class="kn">中，例如:/home/ubuntu </em> / <em class="kn">项目</em>，并运行以下命令来启动gunicorn</p><pre class="ix iy iz ja fd ma mb mc md aw me bi"><span id="1617" class="mf ks hh mb b fi mg mh l mi mj"><em class="kn">gunicorn ProjectName.wsgi:application- -bind 0.0.0.0:9000</em></span></pre><p id="821d" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">现在我们已经安装并配置了nginx和gunicorn，我们的应用程序可以被ec2实例的DNS访问。</p></div><div class="ab cl mr ms go mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ha hb hc hd he"><p id="f87c" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">GitHub:<a class="ae ke" href="https://github.com/SHARONZACHARIA" rel="noopener ugc nofollow" target="_blank">https://github.com/SHARONZACHARIA</a></p></div></div>    
</body>
</html>