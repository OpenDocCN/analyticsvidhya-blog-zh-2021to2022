<html>
<head>
<title>How to create a Google Play store like rating system!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建一个类似评级系统的Google Play商店！</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-create-a-google-play-store-like-rating-system-b9b39c959c07?source=collection_archive---------7-----------------------#2021-06-21">https://medium.com/analytics-vidhya/how-to-create-a-google-play-store-like-rating-system-b9b39c959c07?source=collection_archive---------7-----------------------#2021-06-21</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="997a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你好，我回来了，这次我在这里帮助你创建一个类似于我们在Play store上的评级系统。这样做的先决条件是HTML、CSS、Bootstrap(不是必需的)、Flask(或任何其他您熟悉的后端)和jQuery的知识。为了存储数据，我们需要JSON。就这样，我们走吧。</p><p id="df83" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">工作页面看起来特别像下面的页面。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/b27f5e8e7c1e8293eec98f895bc7f030.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ADnG8e-QRPbcWNtGUNUKmQ.png"/></div></div></figure><h1 id="b652" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">基本前端</strong></h1><p id="b0a7" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">首先创建一个名为starRating的文件夹，并创建一个简单的flask应用程序。我把我的命名为rating.py。</p><pre class="jd je jf jg fd kr ks kt ku aw kv bi"><span id="9262" class="kw jp hh ks b fi kx ky l kz la">from flask import Flask, url_for, render_template</span><span id="7987" class="kw jp hh ks b fi lb ky l kz la">app = Flask(__name__)</span><span id="d906" class="kw jp hh ks b fi lb ky l kz la">@app.route('/')</span><span id="e62d" class="kw jp hh ks b fi lb ky l kz la">def home():</span><span id="95dd" class="kw jp hh ks b fi lb ky l kz la">   return render_template('star_rating.html')</span><span id="1f51" class="kw jp hh ks b fi lb ky l kz la">if __name__ == "__main__":</span><span id="fe3b" class="kw jp hh ks b fi lb ky l kz la">app.run(debug=True)</span></pre><p id="e0e3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">star_rating.html文件包含一些基本的html和CSS。它可能基本上是这样的。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lc"><img src="../Images/3fc6c9444f9228144a09e8f63d2f45ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YZ9YlvRvdBTNRQqeH0ZoBQ.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">页面上的基本文本</figcaption></figure><p id="a4e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">接下来，在静态文件夹(已经有一个名为css的目录)中，我们再添加两个目录:js和images。我们将使用一组图片，GitHub将在最后提供该库的链接。为了避免命名混乱，下面提供了这些图像。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lh"><img src="../Images/72430933c0f0d46a2cecaa11b57f8ad7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OyEFqZg9GaOR9hT-OTmVzA.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">这些图片将用于这篇文章。</figcaption></figure><p id="ab3d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">假设你不想要这些图像。然后只需点击<a class="ae li" href="https://emojipedia.org/people/" rel="noopener ugc nofollow" target="_blank">这里的</a>，选择你喜欢的表情符号。</p><p id="0745" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，将以下代码添加到star_rating.html页面中。</p><pre class="jd je jf jg fd kr ks kt ku aw kv bi"><span id="5886" class="kw jp hh ks b fi kx ky l kz la">&lt;div class="text-center"&gt;</span><span id="024b" class="kw jp hh ks b fi lb ky l kz la">{% for i in range(5) %}</span><span id="f8bb" class="kw jp hh ks b fi lb ky l kz la">&lt;img src="{{ url_for('static',filename='images/rating.png') }}" width="50" height="50" id="star_{{i}}"&gt;</span><span id="e4c1" class="kw jp hh ks b fi lb ky l kz la">{% endfor %}</span><span id="fb8e" class="kw jp hh ks b fi lb ky l kz la">&amp;nbsp;&amp;nbsp;</span><span id="2e68" class="kw jp hh ks b fi lb ky l kz la">&lt;img class="mt-2" id="ratings" src="{{ url_for('static', filename='images/neutral.png') }}" width="60" height="50"&gt;</span><span id="cc97" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span></pre><p id="d630" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以上面的代码只是这样做:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lj"><img src="../Images/e00fbf44845705dd6057ef3bafd453ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dwTmVF-VcOKhmo6Fn8e8fQ.png"/></div></div></figure><p id="1f18" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以基本上我们用jinja2 for循环创建了五次空星的图像，每次都给它一个单独的id。然后，代码块添加两个不可断开的空格，然后添加中性人脸图像。</p><p id="c308" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在要创建这个功能，我们需要jQuery。因此，在js文件夹中创建一个名为rating.js的文件。为了给出一个宽泛的理解，每当用户单击任何一个星号时，jQuery代码将确定空星号到填充星号的变化。好了，不吹牛了，回到代码。为了让您编写的jQuery代码能够工作，您必须将它包含在HTML脚本部分中。有很多cdn提供这个。为了方便起见，只需复制以下代码并将其添加到HTML的脚本部分。</p><pre class="jd je jf jg fd kr ks kt ku aw kv bi"><span id="0269" class="kw jp hh ks b fi kx ky l kz la">&lt;script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"&gt;&lt;/script&gt;</span></pre><p id="1c68" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦上述任务完成，我们就可以继续添加功能性的jQuery代码了。点击功能和星形填充将由下面的代码控制。</p><pre class="jd je jf jg fd kr ks kt ku aw kv bi"><span id="a65a" class="kw jp hh ks b fi kx ky l kz la">$('#star_0').click(function(){</span><span id="e5ad" class="kw jp hh ks b fi lb ky l kz la">$('#star_0').attr("src", "../../static/images/rating_fill.png");</span><span id="8ed1" class="kw jp hh ks b fi lb ky l kz la">$('#star_1').attr("src", "../../static/images/rating.png");</span><span id="13be" class="kw jp hh ks b fi lb ky l kz la">$('#star_2').attr("src", "../../static/images/rating.png");</span><span id="5c36" class="kw jp hh ks b fi lb ky l kz la">$('#star_3').attr("src", "../../static/images/rating.png");</span><span id="3cec" class="kw jp hh ks b fi lb ky l kz la">$('#star_4').attr("src", "../../static/images/rating.png");</span><span id="3797" class="kw jp hh ks b fi lb ky l kz la">$('#ratings').attr("src","../../static/images/x_unhappy.png");</span><span id="62c4" class="kw jp hh ks b fi lb ky l kz la">});</span><span id="d21c" class="kw jp hh ks b fi lb ky l kz la">$('#star_1').click(function(){</span><span id="ebd5" class="kw jp hh ks b fi lb ky l kz la">$('#star_0').attr("src", "../../static/images/rating_fill.png");</span><span id="3189" class="kw jp hh ks b fi lb ky l kz la">$('#star_1').attr("src", "../../static/images/rating_fill.png");</span><span id="a33e" class="kw jp hh ks b fi lb ky l kz la">$('#star_2').attr("src", "../../static/images/rating.png");</span><span id="87d3" class="kw jp hh ks b fi lb ky l kz la">$('#star_3').attr("src", "../../static/images/rating.png");</span><span id="73b6" class="kw jp hh ks b fi lb ky l kz la">$('#star_4').attr("src", "../../static/images/rating.png");</span><span id="a1fb" class="kw jp hh ks b fi lb ky l kz la">$('#ratings').attr("src","../../static/images/unhappy.png");</span><span id="bed4" class="kw jp hh ks b fi lb ky l kz la">});</span><span id="7417" class="kw jp hh ks b fi lb ky l kz la">$('#star_2').click(function(){</span><span id="0095" class="kw jp hh ks b fi lb ky l kz la">$('#star_0').attr("src", "../../static/images/rating_fill.png");</span><span id="a197" class="kw jp hh ks b fi lb ky l kz la">$('#star_1').attr("src", "../../static/images/rating_fill.png");</span><span id="7bda" class="kw jp hh ks b fi lb ky l kz la">$('#star_2').attr("src", "../../static/images/rating_fill.png");</span><span id="7419" class="kw jp hh ks b fi lb ky l kz la">$('#star_3').attr("src", "../../static/images/rating.png");</span><span id="a66e" class="kw jp hh ks b fi lb ky l kz la">$('#star_4').attr("src", "../../static/images/rating.png");</span><span id="b6f1" class="kw jp hh ks b fi lb ky l kz la">$('#ratings').attr("src","../../static/images/ok.png");</span><span id="884f" class="kw jp hh ks b fi lb ky l kz la">});</span><span id="0dcc" class="kw jp hh ks b fi lb ky l kz la">$('#star_3').click(function(){</span><span id="5a8c" class="kw jp hh ks b fi lb ky l kz la">$('#star_0').attr("src", "../../static/images/rating_fill.png");</span><span id="56d7" class="kw jp hh ks b fi lb ky l kz la">$('#star_1').attr("src", "../../static/images/rating_fill.png");</span><span id="73ae" class="kw jp hh ks b fi lb ky l kz la">$('#star_2').attr("src", "../../static/images/rating_fill.png");</span><span id="4458" class="kw jp hh ks b fi lb ky l kz la">$('#star_3').attr("src", "../../static/images/rating_fill.png");</span><span id="92fc" class="kw jp hh ks b fi lb ky l kz la">$('#star_4').attr("src", "../../static/images/rating.png");</span><span id="0866" class="kw jp hh ks b fi lb ky l kz la">$('#ratings').attr("src","../../static/images/happy.png");</span><span id="3936" class="kw jp hh ks b fi lb ky l kz la">});</span><span id="d11a" class="kw jp hh ks b fi lb ky l kz la">$('#star_4').click(function(){</span><span id="59f5" class="kw jp hh ks b fi lb ky l kz la">$('#star_0').attr("src", "../../static/images/rating_fill.png");</span><span id="075c" class="kw jp hh ks b fi lb ky l kz la">$('#star_1').attr("src", "../../static/images/rating_fill.png");</span><span id="484e" class="kw jp hh ks b fi lb ky l kz la">$('#star_2').attr("src", "../../static/images/rating_fill.png");</span><span id="c074" class="kw jp hh ks b fi lb ky l kz la">$('#star_3').attr("src", "../../static/images/rating_fill.png");</span><span id="08ad" class="kw jp hh ks b fi lb ky l kz la">$('#star_4').attr("src", "../../static/images/rating_fill.png");</span><span id="da83" class="kw jp hh ks b fi lb ky l kz la">$('#ratings').attr("src","../../static/images/xtrahappy.png");</span><span id="06cd" class="kw jp hh ks b fi lb ky l kz la">});</span></pre><p id="b862" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这段代码决定了对于所有的五颗星星，点击一颗星星会发生什么。图像也会相应地动画化。为了让你理解，我想解释一下第三颗星(#star_2)的代码，因为它把所有的东西都混在了一起。因此，当我们单击第三颗星时，就会触发“#star_2”的单击事件。代码简单地添加一个黄色填充到它前面的所有星星，第三个星星本身，如果其他星星已经被填充了，则释放黄色填充。只有当你第一次点击获得五星评级，但随后改变主意将其降至三星(记住该应用是由你的敌人发布的)时，后半部分才有意义。).无论如何，上面的代码将执行以下操作:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es lk"><img src="../Images/c32136b4a85952c2c9341f82a180985d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*hzovjskATbgc8imiUtRS3w.gif"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">明星的工作。</figcaption></figure><p id="591b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">好了，既然已经完成了，我们现在可以使用提交按钮来提交这些评级。这些数据可以用来向用户显示投票的数量和质量水平。</p><p id="9a7a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我们添加一个submit按钮和一个input type=hidden字段。这样做的原因将在稍后解释。</p><pre class="jd je jf jg fd kr ks kt ku aw kv bi"><span id="ae08" class="kw jp hh ks b fi kx ky l kz la">&lt;div class="text-center"&gt;</span><span id="c56e" class="kw jp hh ks b fi lb ky l kz la">&lt;form method='POST' action=""&gt;</span><span id="2e08" class="kw jp hh ks b fi lb ky l kz la">&lt;input type="hidden" id="rating_content" name='rating' value='0'&gt;</span><span id="b5da" class="kw jp hh ks b fi lb ky l kz la">&lt;input type="submit" id="submitbtn" class="btn btn-primary mt-2" value="Submit my Rating"&gt;</span><span id="c3ca" class="kw jp hh ks b fi lb ky l kz la">&lt;/form&gt;</span><span id="75c1" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span></pre><p id="5a4c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">star_rating.html页面现在应该如下所示:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ll"><img src="../Images/c74353630b3935d6a6683c44ba61794c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UhV4AAordvS8s6mP1bSXrw.png"/></div></div></figure><p id="94b8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">好了，submit按钮将数据发送到后端。隐藏标签在这里将是最重要的，因为它将把星级映射到1到5之间的值。这就是它被添加到表单中的原因！</p><h1 id="7186" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">将星级与数字1-5对应起来</strong></h1><p id="135c" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">对哦！现在我们可以添加一个代码来将等级映射到1到5范围内的值。这可以添加到rating.js文件本身中。</p><p id="0ba8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了使这一点更清楚，例如，如果你决定给一个4星评级，你应该点击屏幕上的第四颗星。因此，当处理第四颗星的点击事件时，我们可以简单地将隐藏的输入元素的值改为“4”。类似地，当你点击第五颗星时，输入元素的值会变成‘5’等等！希望这能理清逻辑。</p><p id="90b3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，代码只是对上面的rating.js进行了如下更改:</p><pre class="jd je jf jg fd kr ks kt ku aw kv bi"><span id="d655" class="kw jp hh ks b fi kx ky l kz la">$('#star_0').click(function(){</span><span id="98b4" class="kw jp hh ks b fi lb ky l kz la">$('#star_0').attr("src", "../../static/images/rating_fill.png");</span><span id="55da" class="kw jp hh ks b fi lb ky l kz la">$('#star_1').attr("src", "../../static/images/rating.png");</span><span id="4077" class="kw jp hh ks b fi lb ky l kz la">$('#star_2').attr("src", "../../static/images/rating.png");</span><span id="f9ac" class="kw jp hh ks b fi lb ky l kz la">$('#star_3').attr("src", "../../static/images/rating.png");</span><span id="177c" class="kw jp hh ks b fi lb ky l kz la">$('#star_4').attr("src", "../../static/images/rating.png");</span><span id="3b7b" class="kw jp hh ks b fi lb ky l kz la">$('#ratings').attr("src","../../static/images/x_unhappy.png");</span><span id="0469" class="kw jp hh ks b fi lb ky l kz la">$('#rating_content').attr('value','1');</span><span id="c6de" class="kw jp hh ks b fi lb ky l kz la">});</span><span id="23da" class="kw jp hh ks b fi lb ky l kz la">$('#star_1').click(function(){</span><span id="80b0" class="kw jp hh ks b fi lb ky l kz la">$('#star_0').attr("src", "../../static/images/rating_fill.png");</span><span id="3bf1" class="kw jp hh ks b fi lb ky l kz la">$('#star_1').attr("src", "../../static/images/rating_fill.png");</span><span id="46a8" class="kw jp hh ks b fi lb ky l kz la">$('#star_2').attr("src", "../../static/images/rating.png");</span><span id="ac4c" class="kw jp hh ks b fi lb ky l kz la">$('#star_3').attr("src", "../../static/images/rating.png");</span><span id="5239" class="kw jp hh ks b fi lb ky l kz la">$('#star_4').attr("src", "../../static/images/rating.png");</span><span id="742f" class="kw jp hh ks b fi lb ky l kz la">$('#ratings').attr("src","../../static/images/unhappy.png");</span><span id="0845" class="kw jp hh ks b fi lb ky l kz la">$('#rating_content').attr('value','2');</span><span id="6043" class="kw jp hh ks b fi lb ky l kz la">});</span><span id="bd0d" class="kw jp hh ks b fi lb ky l kz la">$('#star_2').click(function(){</span><span id="7340" class="kw jp hh ks b fi lb ky l kz la">$('#star_0').attr("src", "../../static/images/rating_fill.png");</span><span id="8703" class="kw jp hh ks b fi lb ky l kz la">$('#star_1').attr("src", "../../static/images/rating_fill.png");</span><span id="b8c9" class="kw jp hh ks b fi lb ky l kz la">$('#star_2').attr("src", "../../static/images/rating_fill.png");</span><span id="8b4f" class="kw jp hh ks b fi lb ky l kz la">$('#star_3').attr("src", "../../static/images/rating.png");</span><span id="3241" class="kw jp hh ks b fi lb ky l kz la">$('#star_4').attr("src", "../../static/images/rating.png");</span><span id="f1ca" class="kw jp hh ks b fi lb ky l kz la">$('#ratings').attr("src","../../static/images/ok.png");</span><span id="66b3" class="kw jp hh ks b fi lb ky l kz la">$('#rating_content').attr('value','3');</span><span id="5500" class="kw jp hh ks b fi lb ky l kz la">});</span><span id="6895" class="kw jp hh ks b fi lb ky l kz la">$('#star_3').click(function(){</span><span id="3048" class="kw jp hh ks b fi lb ky l kz la">$('#star_0').attr("src", "../../static/images/rating_fill.png");</span><span id="292c" class="kw jp hh ks b fi lb ky l kz la">$('#star_1').attr("src", "../../static/images/rating_fill.png");</span><span id="03fb" class="kw jp hh ks b fi lb ky l kz la">$('#star_2').attr("src", "../../static/images/rating_fill.png");</span><span id="9535" class="kw jp hh ks b fi lb ky l kz la">$('#star_3').attr("src", "../../static/images/rating_fill.png");</span><span id="2ab9" class="kw jp hh ks b fi lb ky l kz la">$('#star_4').attr("src", "../../static/images/rating.png");</span><span id="29c7" class="kw jp hh ks b fi lb ky l kz la">$('#ratings').attr("src","../../static/images/happy.png");</span><span id="875f" class="kw jp hh ks b fi lb ky l kz la">$('#rating_content').attr('value','4');</span><span id="988a" class="kw jp hh ks b fi lb ky l kz la">});</span><span id="26ba" class="kw jp hh ks b fi lb ky l kz la">$('#star_4').click(function(){</span><span id="f6df" class="kw jp hh ks b fi lb ky l kz la">$('#star_0').attr("src", "../../static/images/rating_fill.png");</span><span id="10a6" class="kw jp hh ks b fi lb ky l kz la">$('#star_1').attr("src", "../../static/images/rating_fill.png");</span><span id="690c" class="kw jp hh ks b fi lb ky l kz la">$('#star_2').attr("src", "../../static/images/rating_fill.png");</span><span id="d7c4" class="kw jp hh ks b fi lb ky l kz la">$('#star_3').attr("src", "../../static/images/rating_fill.png");</span><span id="2558" class="kw jp hh ks b fi lb ky l kz la">$('#star_4').attr("src", "../../static/images/rating_fill.png");</span><span id="2a35" class="kw jp hh ks b fi lb ky l kz la">$('#ratings').attr("src","../../static/images/xtrahappy.png");</span><span id="07b0" class="kw jp hh ks b fi lb ky l kz la">$('#rating_content').attr('value','5');</span><span id="5815" class="kw jp hh ks b fi lb ky l kz la">});</span></pre><p id="aa15" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意每颗星星的点击事件的最后几行。</p><h1 id="9bb0" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">使用Flask将星级存储到JSON文件中</strong></h1><p id="5dfc" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">现在到了存储部分。这对于这篇文章来说非常简单，以JSON文件的形式。但是假设您想将它添加到数据库中，那么也可以使用SQLAlchemy轻松完成。</p><p id="3751" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">虽然下面的说明主要与Flask有关，但是如果您是Django用户，您会发现这很容易，因为Python代码对它们来说是一样的，都是处理JSON文件。如果你是用Laravel，NodeJS等的人。即使这样，您也应该能够通过对代码进行适当的修改来继续下去。</p><p id="7569" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，让我们在rating.py旁边创建一个JSON文件，并将其保存为ratings_so_far.json。代码如下:</p><pre class="jd je jf jg fd kr ks kt ku aw kv bi"><span id="0ec6" class="kw jp hh ks b fi kx ky l kz la">{</span><span id="5d8f" class="kw jp hh ks b fi lb ky l kz la">"five_stars":"0",</span><span id="eac9" class="kw jp hh ks b fi lb ky l kz la">"four_stars":"0",</span><span id="5d5d" class="kw jp hh ks b fi lb ky l kz la">"three_stars":"0",</span><span id="a5a1" class="kw jp hh ks b fi lb ky l kz la">"two_stars":"0",</span><span id="21f3" class="kw jp hh ks b fi lb ky l kz la">"one_star":"0",</span><span id="2206" class="kw jp hh ks b fi lb ky l kz la">"count":"0",</span><span id="078c" class="kw jp hh ks b fi lb ky l kz la">"total":"0",</span><span id="5eb3" class="kw jp hh ks b fi lb ky l kz la">"rating": "0.0"</span><span id="ad7e" class="kw jp hh ks b fi lb ky l kz la">}</span></pre><p id="b73a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因此，存储机制已准备就绪，它所指示的只是每个级别的评级数、投票数、所有评级相加的总值，以及作为浮点值的评级。现在，在rating.py文件中，我们需要导入一些东西:首先，来自flask的请求模块，然后是用于处理json文件的JSON模块。</p><pre class="jd je jf jg fd kr ks kt ku aw kv bi"><span id="3374" class="kw jp hh ks b fi kx ky l kz la">from flask import Flask, url_for, render_template,<strong class="ks hi">request</strong></span><span id="92e6" class="kw jp hh ks b fi lb ky l kz la"><strong class="ks hi">import json</strong></span></pre><p id="9802" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，每当我们单击5颗星中的任何一颗，我们都需要将相应的json值增加1。此外，为了处理JSON数据，我们首先需要将它转换成Python对象。json.load和json.dump方法在这里起着至关重要的作用(在处理json数据格式的字符串时，json.loads和json.dumps起着至关重要的作用)。让我们开始工作。</p><p id="65e7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们之前编写的视图函数现在将类似于:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es lm"><img src="../Images/2b91a5b5d22e9e5dd0e0d791d2348f19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*L4e0z0Gdqa_THicApw0pMA.png"/></div><figcaption class="ld le et er es lf lg bd b be z dx translated">不得不张贴代码的图像，因为它是在媒体格式不佳</figcaption></figure><p id="9501" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如你所见，已经生成了相当多的肌肉！别担心，让我们一行一行地过一遍。</p><ol class=""><li id="26ed" class="ln lo hh ig b ih ii il im ip lp it lq ix lr jb ls lt lu lv bi translated">首先，我们通过添加方法= ['GET '，' POST']，让视图函数也接受POST请求，这就是我们在第6行中所做的。</li><li id="f96d" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">第8行:现在使用上下文管理器(with statement ),打开我们创建的JSON文件。因为它就在我们的python文件旁边，所以我们只需将它的名称传递给open方法，并以读取模式打开它(默认)。指向文件的指针被命名为f。</li></ol><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mb"><img src="../Images/28257d0bb1e07982bc1b897ad6640c64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*UEois2hTNFNRLsWFghCx1Q.png"/></div><figcaption class="ld le et er es lf lg bd b be z dx translated">目录结构必须像这样才能直接传递json文件名</figcaption></figure><ol class=""><li id="2aa8" class="ln lo hh ig b ih ii il im ip lp it lq ix lr jb ls lt lu lv bi translated">在第9行，我们将JSON数据存储到一个名为ratingstore的Python对象中。默认情况下，创建的对象是一个Python字典。</li><li id="94ba" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">第10行:我们检查是否有post请求，即表单的提交按钮是否被点击。所以下面的代码只有在提交按钮被点击时才会运行。</li><li id="15e7" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">第11–18行表示将字典的值赋给变量。为避免混淆，变量的命名与键相同。</li><li id="b98a" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">第19行检查在刚刚提交的表单中是否有名为“rating”的输入元素。如果您还记得，这是我们给隐藏的输入元素起的名字！(给定的值为0)</li><li id="f386" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">第20行转换隐藏输入元素的值，并将其赋给一个名为content的变量。任何已知名称的表单元素的值都可以通过如下方式获得，也可以通过使用request . form . get(' input _ element _ name ')获得。</li><li id="a1bc" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">第21行检查内容是否为空。如果没有，我们继续前进。</li><li id="9d4e" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">第22–31行:根据我们选择的星星数，隐藏输入元素的值已经改变了。这几行检查值，并将相应的变量递增1。也就是说，每一张选票都会被记录到这些变量中！现在，如果你没有选择任何明星就想提交怎么办？好吧，做吧，告诉我你观察到了什么变化。</li><li id="fa55" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">第32行:我们将评级计数增加1。</li><li id="cc4c" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">第33行:用内容的值增加总值。这对于计算评分非常重要。</li><li id="054e" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">第34行:用总数除以目前的投票数，得到评分。此外，我们使用格式标签将评级限制为一个小数点。</li><li id="82df" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">第35–42行:通过添加新值来更改字典ratingstore的值。</li><li id="491b" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">第43行:以写模式打开JSON文件(是的，其中的现有数据将被删除)。</li><li id="fc94" class="ln lo hh ig b ih lw il lx ip ly it lz ix ma jb ls lt lu lv bi translated">第44行:json . dump Python字典ratingstore到我们的JSON文件中。indent=2参数将文件格式化为可读格式。</li></ol><p id="49d2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这就是在JSON文件中存储更改的方式。但是每次打开JSON文件查看数据可能会很繁琐。这是我们创建一个类似于Play store的新星级查看器的地方(相信我，用不了多久我就会闭嘴)。</p><h1 id="52a5" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated"><strong class="ak">以播放商店的方式显示星级！</strong></h1><p id="62a2" class="pw-post-body-paragraph ie if hh ig b ih km ij ik il kn in io ip ko ir is it kp iv iw ix kq iz ja jb ha bi translated">为了实时查看收视率，我们需要做一些工作。有HTML，CSS以及Javascript代码。让我们先从HTML和CSS开始。</p><p id="d2a8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下是您必须添加的HTML:</p><pre class="jd je jf jg fd kr ks kt ku aw kv bi"><span id="4445" class="kw jp hh ks b fi kx ky l kz la">&lt;div class="text-center"&gt;</span><span id="15e9" class="kw jp hh ks b fi lb ky l kz la">&lt;h1&gt;{{rating}}&lt;/h1&gt;</span><span id="dbd6" class="kw jp hh ks b fi lb ky l kz la">&lt;div id="display_rating"&gt;</span><span id="b00d" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="row align-items-center"&gt;</span><span id="c3d2" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="offset-1 col-1 mt-3"&gt;</span><span id="9071" class="kw jp hh ks b fi lb ky l kz la">&lt;p style="font-size: 14px;"&gt;5&lt;/p&gt;</span><span id="5064" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="9af2" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="col-8"&gt;</span><span id="ad76" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="content_5_star_outer"&gt;</span><span id="377f" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="content_5_star_inner"&gt;nn&lt;/div&gt;</span><span id="26c3" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="0af3" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="9843" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="8c7e" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="row align-items-center inner-ratings"&gt;</span><span id="dfd7" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="offset-1 col-1 mt-3"&gt;</span><span id="4b63" class="kw jp hh ks b fi lb ky l kz la">&lt;p style="font-size: 14px;"&gt;4&lt;/p&gt;</span><span id="2649" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="d8dd" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="col-8"&gt;</span><span id="f18b" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="content_4_star_outer"&gt;</span><span id="5cba" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="content_4_star_inner"&gt;nn&lt;/div&gt;</span><span id="ac53" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="6b55" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="179e" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="57aa" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="row align-items-center inner-ratings"&gt;</span><span id="bc59" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="offset-1 col-1 mt-3"&gt;</span><span id="3cc2" class="kw jp hh ks b fi lb ky l kz la">&lt;p style="font-size: 14px;"&gt;3&lt;/p&gt;</span><span id="3143" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="6150" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="col-8"&gt;</span><span id="e8ce" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="content_3_star_outer"&gt;</span><span id="70b1" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="content_3_star_inner"&gt;nn&lt;/div&gt;</span><span id="fa97" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="8ab3" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="1ea8" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="8729" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="row align-items-center inner-ratings"&gt;</span><span id="ce3f" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="offset-1 col-1 mt-3"&gt;</span><span id="c275" class="kw jp hh ks b fi lb ky l kz la">&lt;p style="font-size: 14px;"&gt;2&lt;/p&gt;</span><span id="66a9" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="dd2b" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="col-8"&gt;</span><span id="c437" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="content_2_star_outer"&gt;</span><span id="975e" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="content_2_star_inner"&gt;nn&lt;/div&gt;</span><span id="6b65" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="5f2f" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="62e7" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="e94c" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="row align-items-center inner-ratings"&gt;</span><span id="3bca" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="offset-1 col-1 mt-3"&gt;</span><span id="2da8" class="kw jp hh ks b fi lb ky l kz la">&lt;p style="font-size: 14px;"&gt;1&lt;/p&gt;</span><span id="0295" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="3bb1" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="col-8"&gt;</span><span id="029a" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="content_1_star_outer"&gt;</span><span id="102a" class="kw jp hh ks b fi lb ky l kz la">&lt;div class="content_1_star_inner"&gt;nn&lt;/div&gt;</span><span id="5032" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="6037" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="f91a" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="9e0c" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span><span id="fc22" class="kw jp hh ks b fi lb ky l kz la">&lt;/div&gt;</span></pre><p id="a788" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">你很快就会明白为什么我们增加了等级作为jinja2的一个变量。现在，继续。</p><p id="4f3d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">以下是CSS代码:</p><pre class="jd je jf jg fd kr ks kt ku aw kv bi"><span id="1b24" class="kw jp hh ks b fi kx ky l kz la">.content_5_star_inner{</span><span id="ab65" class="kw jp hh ks b fi lb ky l kz la">border: solid 1px green;</span><span id="9769" class="kw jp hh ks b fi lb ky l kz la">background-color: green;</span><span id="1ab7" class="kw jp hh ks b fi lb ky l kz la">color: transparent;</span><span id="13f2" class="kw jp hh ks b fi lb ky l kz la">font-size: 5px;</span><span id="d409" class="kw jp hh ks b fi lb ky l kz la">border-radius: 5px;</span><span id="fdba" class="kw jp hh ks b fi lb ky l kz la">width: 0%;</span><span id="ced8" class="kw jp hh ks b fi lb ky l kz la">}</span><span id="38d4" class="kw jp hh ks b fi lb ky l kz la">.content_5_star_outer{</span><span id="c899" class="kw jp hh ks b fi lb ky l kz la">/*border: solid 1px grey;*/</span><span id="e89e" class="kw jp hh ks b fi lb ky l kz la">background-color: lightgrey;</span><span id="ad0e" class="kw jp hh ks b fi lb ky l kz la">color: transparent;</span><span id="087e" class="kw jp hh ks b fi lb ky l kz la">font-size: 5px;</span><span id="e15b" class="kw jp hh ks b fi lb ky l kz la">border-radius: 5px;</span><span id="d5d0" class="kw jp hh ks b fi lb ky l kz la">}</span><span id="68df" class="kw jp hh ks b fi lb ky l kz la">.content_4_star_inner{</span><span id="b129" class="kw jp hh ks b fi lb ky l kz la">border: solid 1px green;</span><span id="25e1" class="kw jp hh ks b fi lb ky l kz la">background-color: green;</span><span id="5668" class="kw jp hh ks b fi lb ky l kz la">color: transparent;</span><span id="a0d9" class="kw jp hh ks b fi lb ky l kz la">font-size: 5px;</span><span id="27ff" class="kw jp hh ks b fi lb ky l kz la">border-radius: 5px;</span><span id="b13b" class="kw jp hh ks b fi lb ky l kz la">width: 0%;</span><span id="0d79" class="kw jp hh ks b fi lb ky l kz la">}</span><span id="74ad" class="kw jp hh ks b fi lb ky l kz la">.content_4_star_outer{</span><span id="880e" class="kw jp hh ks b fi lb ky l kz la">/*border: solid 1px grey;*/</span><span id="1051" class="kw jp hh ks b fi lb ky l kz la">background-color: lightgrey;</span><span id="3e16" class="kw jp hh ks b fi lb ky l kz la">color: transparent;</span><span id="919b" class="kw jp hh ks b fi lb ky l kz la">font-size: 5px;</span><span id="0c71" class="kw jp hh ks b fi lb ky l kz la">border-radius: 5px;</span><span id="1294" class="kw jp hh ks b fi lb ky l kz la">}</span><span id="6f5c" class="kw jp hh ks b fi lb ky l kz la">.content_3_star_inner{</span><span id="6a21" class="kw jp hh ks b fi lb ky l kz la">border: solid 1px green;</span><span id="c4c9" class="kw jp hh ks b fi lb ky l kz la">background-color: green;</span><span id="3c0b" class="kw jp hh ks b fi lb ky l kz la">color: transparent;</span><span id="b0bd" class="kw jp hh ks b fi lb ky l kz la">font-size: 5px;</span><span id="4331" class="kw jp hh ks b fi lb ky l kz la">border-radius: 5px;</span><span id="0b38" class="kw jp hh ks b fi lb ky l kz la">width: 0%;</span><span id="1839" class="kw jp hh ks b fi lb ky l kz la">}</span><span id="2397" class="kw jp hh ks b fi lb ky l kz la">.content_3_star_outer{</span><span id="cded" class="kw jp hh ks b fi lb ky l kz la">/*border: solid 1px grey;*/</span><span id="dd6b" class="kw jp hh ks b fi lb ky l kz la">background-color: lightgrey;</span><span id="9c97" class="kw jp hh ks b fi lb ky l kz la">color: transparent;</span><span id="b41a" class="kw jp hh ks b fi lb ky l kz la">font-size: 5px;</span><span id="89e6" class="kw jp hh ks b fi lb ky l kz la">border-radius: 5px;</span><span id="7d19" class="kw jp hh ks b fi lb ky l kz la">}</span><span id="22e2" class="kw jp hh ks b fi lb ky l kz la">.content_2_star_inner{</span><span id="1a2e" class="kw jp hh ks b fi lb ky l kz la">border: solid 1px green;</span><span id="ba85" class="kw jp hh ks b fi lb ky l kz la">background-color: green;</span><span id="1c2f" class="kw jp hh ks b fi lb ky l kz la">color: transparent;</span><span id="2eef" class="kw jp hh ks b fi lb ky l kz la">font-size: 5px;</span><span id="c984" class="kw jp hh ks b fi lb ky l kz la">border-radius: 5px;</span><span id="c47b" class="kw jp hh ks b fi lb ky l kz la">width: 0%;</span><span id="b589" class="kw jp hh ks b fi lb ky l kz la">}</span><span id="475a" class="kw jp hh ks b fi lb ky l kz la">.content_2_star_outer{</span><span id="025d" class="kw jp hh ks b fi lb ky l kz la">/*border: solid 1px grey;*/</span><span id="c777" class="kw jp hh ks b fi lb ky l kz la">background-color: lightgrey;</span><span id="a7ac" class="kw jp hh ks b fi lb ky l kz la">color: transparent;</span><span id="dfe1" class="kw jp hh ks b fi lb ky l kz la">font-size: 5px;</span><span id="d979" class="kw jp hh ks b fi lb ky l kz la">border-radius: 5px;</span><span id="d5cd" class="kw jp hh ks b fi lb ky l kz la">}</span><span id="5226" class="kw jp hh ks b fi lb ky l kz la">.content_1_star_inner{</span><span id="d307" class="kw jp hh ks b fi lb ky l kz la">border: solid 1px green;</span><span id="1d46" class="kw jp hh ks b fi lb ky l kz la">background-color: green;</span><span id="c2b8" class="kw jp hh ks b fi lb ky l kz la">color: transparent;</span><span id="6136" class="kw jp hh ks b fi lb ky l kz la">font-size: 5px;</span><span id="af34" class="kw jp hh ks b fi lb ky l kz la">border-radius: 5px;</span><span id="c8e5" class="kw jp hh ks b fi lb ky l kz la">width: 0%;</span><span id="ffea" class="kw jp hh ks b fi lb ky l kz la">}</span><span id="8fc9" class="kw jp hh ks b fi lb ky l kz la">.content_1_star_outer{</span><span id="3b7c" class="kw jp hh ks b fi lb ky l kz la">/*border: solid 1px grey;*/</span><span id="b0d7" class="kw jp hh ks b fi lb ky l kz la">background-color: lightgrey;</span><span id="04da" class="kw jp hh ks b fi lb ky l kz la">color: transparent;</span><span id="c1be" class="kw jp hh ks b fi lb ky l kz la">font-size: 5px;</span><span id="64ab" class="kw jp hh ks b fi lb ky l kz la">border-radius: 5px;</span><span id="9d22" class="kw jp hh ks b fi lb ky l kz la">}</span><span id="98c7" class="kw jp hh ks b fi lb ky l kz la">#display_rating{</span><span id="9981" class="kw jp hh ks b fi lb ky l kz la">margin-top: 25px;</span><span id="0be7" class="kw jp hh ks b fi lb ky l kz la">margin-left: auto;</span><span id="c271" class="kw jp hh ks b fi lb ky l kz la">margin-right: auto;</span><span id="e37f" class="kw jp hh ks b fi lb ky l kz la">width: 40%;</span><span id="61bc" class="kw jp hh ks b fi lb ky l kz la">border: solid 4px green;</span><span id="e2a3" class="kw jp hh ks b fi lb ky l kz la">border-radius: 100%;</span><span id="bcd5" class="kw jp hh ks b fi lb ky l kz la">color: black;</span><span id="94ce" class="kw jp hh ks b fi lb ky l kz la">background-color: white;</span><span id="9cf9" class="kw jp hh ks b fi lb ky l kz la">padding: 4em;</span><span id="7875" class="kw jp hh ks b fi lb ky l kz la">}</span></pre><p id="eb55" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">添加这两者后，页面看起来会像这样:</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es mc"><img src="../Images/89acb5f1d8efe33ebe94275246b689d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ABSqX6HG9uXslwO0YbLD5w.png"/></div></div><figcaption class="ld le et er es lf lg bd b be z dx translated">看起来不错，对吧？</figcaption></figure><p id="e50c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我将简要地解释我在这里所做的事情。基本上，有两个重叠的矩形:一个灰色的在下面，另一个绿色的在上面。内部(即绿色矩形)的宽度将根据每个星级获得的评级而变化。这就是我们基本的工作方式。</p><p id="ad54" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，为了添加最后的功能，我们需要创建另一个名为finale.js的javascript文件，并将其保存到js文件夹中。这将防止混乱和困惑，这也是必要的，因为我们必须传递我们在表单发布时创建的python变量。所以让我们再来一次！</p><p id="6c34" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">finale.js的javascript代码是:</p><pre class="jd je jf jg fd kr ks kt ku aw kv bi"><span id="64be" class="kw jp hh ks b fi kx ky l kz la">function starBars(five_stars, four_stars, three_stars, two_stars, one_star,total_votes){</span><span id="978c" class="kw jp hh ks b fi lb ky l kz la">var content_5_width = (five_stars/total_votes)*100+'%';</span><span id="8a43" class="kw jp hh ks b fi lb ky l kz la">var content_4_width = (four_stars/total_votes)*100+'%';</span><span id="d2f4" class="kw jp hh ks b fi lb ky l kz la">var content_3_width = (three_stars/total_votes)*100+'%';</span><span id="1b2b" class="kw jp hh ks b fi lb ky l kz la">var content_2_width = (two_stars/total_votes)*100+'%';</span><span id="588a" class="kw jp hh ks b fi lb ky l kz la">var content_1_width = (one_star/total_votes)*100+'%';</span><span id="c292" class="kw jp hh ks b fi lb ky l kz la">document.querySelector('.content_5_star_inner').style.width = content_5_width;</span><span id="0950" class="kw jp hh ks b fi lb ky l kz la">document.querySelector('.content_4_star_inner').style.width = content_4_width;</span><span id="fbea" class="kw jp hh ks b fi lb ky l kz la">document.querySelector('.content_3_star_inner').style.width = content_3_width;</span><span id="977a" class="kw jp hh ks b fi lb ky l kz la">document.querySelector('.content_2_star_inner').style.width = content_2_width;</span><span id="3bdf" class="kw jp hh ks b fi lb ky l kz la">document.querySelector('.content_1_star_inner').style.width = content_1_width;</span><span id="d6f8" class="kw jp hh ks b fi lb ky l kz la">}</span></pre><p id="efb6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该代码基于计算百分比的实际原理，即某物的百分比=(该某物的数量/总数)* 100。我们对每个级别都这样做，并同样应用于每个内部矩形的宽度，从而使它对我们的投票是动态的。</p><p id="afed" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">但现在问题来了:我们如何传递实际上只在Python中可用的参数？</p><p id="efa1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">那同样简单。我们所要做的就是每当我们的页面作为GET请求被调用时传递这些参数。在Flask中，每当我呈现模板star_rating.html(可以在代码图像的第45行看到)时，我可以简单地传递这些参数。</p><p id="8123" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以在添加参数后，它们将在我们的HTML代码中可用，我们可以在Jinja2模板中使用它们。</p><pre class="jd je jf jg fd kr ks kt ku aw kv bi"><span id="2126" class="kw jp hh ks b fi kx ky l kz la">return render_template(<br/>'star_rating.html', <br/>five_stars=ratingstore['five_stars'], four_stars=ratingstore['four_stars'], three_stars=ratingstore['three_stars'], two_stars=ratingstore['two_stars'], one_star=ratingstore['one_star'], <br/>count=ratingstore['count'], <br/>rating=ratingstore['rating']<br/>)</span></pre><p id="95da" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">即使作为参数传递，名称也不会改变。这减少了我的困惑，我想这同样适用于你！现在我也希望你明白我是如何在<h1>标签中包含{ {评级}}的。</h1></p><p id="51db" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">既然finale.js有一个名为starBars的函数，那么让我们首先调用它，然后在一个单独的脚本中调用这个函数。</p><p id="49fc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，star_rating.html的脚本部分应该如下所示:</p><pre class="jd je jf jg fd kr ks kt ku aw kv bi"><span id="8121" class="kw jp hh ks b fi kx ky l kz la">&lt;script src="{{ url_for('static',filename='js/rating.js') }}"&gt;&lt;/script&gt;</span><span id="9176" class="kw jp hh ks b fi lb ky l kz la">&lt;script src="{{ url_for('static',filename='js/finale.js') }}"&gt;&lt;/script&gt;</span><span id="8a18" class="kw jp hh ks b fi lb ky l kz la">&lt;script&gt;</span><span id="d930" class="kw jp hh ks b fi lb ky l kz la">starBars(</span><span id="5386" class="kw jp hh ks b fi lb ky l kz la">five_stars = '{{five_stars}}',</span><span id="4ef8" class="kw jp hh ks b fi lb ky l kz la">four_stars = '{{four_stars}}',</span><span id="7c6c" class="kw jp hh ks b fi lb ky l kz la">three_stars = '{{three_stars}}',</span><span id="55ed" class="kw jp hh ks b fi lb ky l kz la">two_stars = '{{two_stars}}',</span><span id="7c46" class="kw jp hh ks b fi lb ky l kz la">one_star = '{{one_star}}',</span><span id="a243" class="kw jp hh ks b fi lb ky l kz la">total_votes = '{{count}}'</span><span id="a3e8" class="kw jp hh ks b fi lb ky l kz la">)</span><span id="081b" class="kw jp hh ks b fi lb ky l kz la">&lt;/script&gt;</span></pre><p id="f9fc" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如你所见，函数starBars将使用Python变量(交叉检查render_template中的名称)作为它的参数来调用。因为它已经在finale.js中定义了，所以starBars将无任何错误地运行，javascript参数将被传递一个变量python参数。</p><p id="d142" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">瞧啊！我们完了。为了确保一切正常，我将向你们展示我们所做的现场演示。我打赌你会对自己的努力感到满意的！</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es md"><img src="../Images/77551636f64c10f085013a66143a0b40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*DRQ6FmZ-ablpiCg2dMYIUA.gif"/></div><figcaption class="ld le et er es lf lg bd b be z dx translated">还增加了最终投票显示。把那当成你的任务吧！</figcaption></figure><p id="7210" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">非常感谢亲爱的读者，如果你耐心地读到这里。希望你已经学到了一两件关于如何创建实时评级系统的事情。另外，请原谅GIF的质量。中仅允许25 MB的最大图像大小。所以我不得不去适应它！</p><p id="05e6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">是的，GitHub库，我怎么能忘记呢！完整的代码和资源可以在<a class="ae li" href="https://github.com/AkhilrajNambiar/Playstore-like-rating-system" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="a4ea" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">谢谢你，直到下一个帖子，再见！</p></div></div>    
</body>
</html>