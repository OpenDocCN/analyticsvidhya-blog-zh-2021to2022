<html>
<head>
<title>Data Cleaning for Textual Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">文本数据的数据清理</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/data-cleaning-for-textual-data-256b4bbffd?source=collection_archive---------3-----------------------#2022-03-30">https://medium.com/analytics-vidhya/data-cleaning-for-textual-data-256b4bbffd?source=collection_archive---------3-----------------------#2022-03-30</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="0d1f" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">疯狂之旅。。。</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/a423a65a86d30c7c125518824ca7dac4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IAfd0Dco0CiyISmZ"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated"><a class="ae jm" href="https://unsplash.com/@towfiqu999999?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">图为<a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的</a></figcaption></figure><p id="bd34" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">数据是执行的任何分析或创建的任何模型的基础。然而，数据可能会出错:格式、排列、额外的空格等。此外，随着数据每天呈指数级增长，处理和管理这些数据变得更具挑战性。每个行业——零售、银行、酒店、教育——都在巨大的数据海洋中航行。数据清理是一项极其重要的任务。</p><p id="7baa" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">文本数据是非结构化数据的一种形式。因此，人们更容易筛选原始文本。但是，对于机器来说就不一样了。机器不能使用原始文本来训练或创建它们的模型，而且分析它们也很复杂。</p><p id="d7f7" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">在这篇博客中，我将介绍一些对我有帮助的文本数据清理任务。为了节省时间，我在大多数项目中重用这些代码片段。此外，您也可以将它包含在您的项目中。</p><h1 id="ac70" class="kj kk hh bd kl km kn ko kp kq kr ks kt in ku io kv iq kw ir kx it ky iu kz la bi translated">规范化非Ascii字符</h1><p id="5390" class="pw-post-body-paragraph jn jo hh jp b jq lb ii js jt lc il jv jw ld jy jz ka le kc kd ke lf kg kh ki ha bi translated">ASCII代表<strong class="jp hi">美国信息交换标准码，</strong>它代表小写(a-z)、大写(A-Z)和数字(0-9)，这是大多数计算机使用的。ASCII不包括特殊字符，如英国英镑符号或德国乌尔马特，称为Unicode字符。Unicode代表阿拉伯语、希腊语等的字母。、数学符号、历史脚本以及比ASCII覆盖更广泛字符的表情符号。实质上，Unicode是ASCII字符集的超集。</p><p id="6bc0" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">因此，如果数据集中存在这些特殊字符，就会妨碍文本数据的读取和分析。有两种方法可以解决这个问题:用对应的Unicode字符规范化这些字符，或者将它们完全删除。</p><pre class="ix iy iz ja fd lg lh li lj aw lk bi"><span id="0529" class="ll kk hh lh b fi lm ln l lo lp">import unicodedata</span><span id="bd5f" class="ll kk hh lh b fi lq ln l lo lp"># function to normalize non ascii<br/>def normalize_non_ascii(text):<br/>    text = unicodedata.normalize("NFKD", text)<br/>    return text</span><span id="1715" class="ll kk hh lh b fi lq ln l lo lp">sample_text = "Australia©ª«Germany"</span><span id="d9ad" class="ll kk hh lh b fi lq ln l lo lp">clean_text = normalize_non_ascii(sample_text)<br/>print(clean_text)</span><span id="3269" class="ll kk hh lh b fi lq ln l lo lp"># ======== Expected Output =========<br/># <strong class="lh hi">Before: </strong>Australia©ª«Germany<br/># <strong class="lh hi">After:</strong> Australia©a«Germany</span></pre><p id="2ec9" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我们可以看到，<code class="du lr ls lt lh b">a</code>之前和之后的字符没有被规范化，因为它们不属于<code class="du lr ls lt lh b">unicode</code>集合。所以还是除掉他们比较好。</p><pre class="ix iy iz ja fd lg lh li lj aw lk bi"><span id="2cbc" class="ll kk hh lh b fi lm ln l lo lp">import re</span><span id="8eda" class="ll kk hh lh b fi lq ln l lo lp"># function to remove non ascii<br/>def remove_non_ascii(text):<br/>    text = re.sub(r'[^\x00-\x7F]+', '', text)<br/>    return text</span><span id="25f8" class="ll kk hh lh b fi lq ln l lo lp">sample_text = "Australia©ª«Germany"</span><span id="aedb" class="ll kk hh lh b fi lq ln l lo lp">clean_text = remove_non_ascii(sample_text)<br/>print(clean_text)</span><span id="d277" class="ll kk hh lh b fi lq ln l lo lp"># ======== Expected Output =========<br/># <strong class="lh hi">Before: </strong>Australia©ª«Germany<br/># <strong class="lh hi">After:</strong> AustraliaGermany</span></pre><h1 id="ded8" class="kj kk hh bd kl km kn ko kp kq kr ks kt in ku io kv iq kw ir kx it ky iu kz la bi translated">删除不可打印的字符</h1><p id="86ce" class="pw-post-body-paragraph jn jo hh jp b jq lb ii js jt lc il jv jw ld jy jz ka le kc kd ke lf kg kh ki ha bi translated">不可打印字符是指不占用任何空间并且在打印时不可见的字符。一些不可打印的字符是<code class="du lr ls lt lh b">\t, \r, \n, \x16, \xlf</code>。这些字符通常填充web抓取的数据集中，使信息变得杂乱，并以给分析师带来问题的方式使它们变得非结构化。所以移除它们通常是很重要的。</p><pre class="ix iy iz ja fd lg lh li lj aw lk bi"><span id="9271" class="ll kk hh lh b fi lm ln l lo lp">import sys, unicodedata</span><span id="6255" class="ll kk hh lh b fi lq ln l lo lp">def remove_non_printable(text):<br/>    # Get all unicode characters<br/>    all_chars = (chr(i) for i in range(sys.maxunicode))<br/>    # Get all non printable characters<br/>    control_chars = ''.join(c for c in all_chars if unicodedata.category(c) == 'Cc')<br/>    # Create regex of above characters<br/>    control_char_re = re.compile('[%s]' % re.escape(control_chars))<br/>    # remove non-printable characters<br/>    text = control_char_re.sub('', text)</span><span id="4cbf" class="ll kk hh lh b fi lq ln l lo lp">    return text</span><span id="4307" class="ll kk hh lh b fi lq ln l lo lp">sample_text = "<!-- -->\x00\x11Hello<!-- -->"</span><span id="8d84" class="ll kk hh lh b fi lq ln l lo lp">clean_text = remove_non_printable(sample_text)<br/>print(clean_text)</span><span id="03ee" class="ll kk hh lh b fi lq ln l lo lp"># ======== Expected Output =========<br/># <strong class="lh hi">Before: </strong>\x00\x11Hello<br/># <strong class="lh hi">After:</strong> Hello</span></pre><h1 id="a4aa" class="kj kk hh bd kl km kn ko kp kq kr ks kt in ku io kv iq kw ir kx it ky iu kz la bi translated">删除重音符号</h1><p id="2d5e" class="pw-post-body-paragraph jn jo hh jp b jq lb ii js jt lc il jv jw ld jy jz ka le kc kd ke lf kg kh ki ha bi translated">各种基于拉丁语的句子含有西班牙语、德语和许多其他语言的口音。所以我们也可以去掉那些使我们的数据集不一致的重音符号。</p><pre class="ix iy iz ja fd lg lh li lj aw lk bi"><span id="fc04" class="ll kk hh lh b fi lm ln l lo lp">import unicodedata</span><span id="6579" class="ll kk hh lh b fi lq ln l lo lp">def remove_accents(text):<br/>    text = unicodedata.normalize('NFD', text).encode('ascii', 'ignore').decode("utf-8")<br/>    return text</span><span id="c5d8" class="ll kk hh lh b fi lq ln l lo lp">sample_text = "JoÂÃÄÅhn i×Øψs a goωϖℵod b¡¢oy"</span><span id="6598" class="ll kk hh lh b fi lq ln l lo lp">clean_text = remove_accents(sample_text)<br/>print(clean_text)</span><span id="f992" class="ll kk hh lh b fi lq ln l lo lp"># ======== Expected Output =========<br/># <strong class="lh hi">Before: </strong>JoÂÃÄÅhn i×Øψs a goωϖℵod b¡¢oy<br/># <strong class="lh hi">After:</strong> JoAAAAhn is a good boy</span></pre><h1 id="c822" class="kj kk hh bd kl km kn ko kp kq kr ks kt in ku io kv iq kw ir kx it ky iu kz la bi translated">删除多余的空格、制表符和换行符</h1><p id="b59c" class="pw-post-body-paragraph jn jo hh jp b jq lb ii js jt lc il jv jw ld jy jz ka le kc kd ke lf kg kh ki ha bi translated">很有可能使用web抓取数据中的转义序列来读取空格、制表符和换行符。因此，在读取CSV文件时，这些转义序列打乱了数据集，并错放了数据，造成了许多麻烦。所以去掉这些字符是必不可少的。除此之外，中间可以有多个空格，所以可以删除。方法非常简单，只需用空白替换这些字符序列就可以实现。</p><pre class="ix iy iz ja fd lg lh li lj aw lk bi"><span id="ddeb" class="ll kk hh lh b fi lm ln l lo lp">import re</span><span id="2622" class="ll kk hh lh b fi lq ln l lo lp">def remove_spaces(text):<br/>    text = text.replace("\t", "").replace("\r", "").replace("\n", "")      # remove \t, \n, \r<br/>    text = re.sub('\s{2,}', '', text)    # remove 2 or more than 2 spaces<br/>    return text</span><span id="7676" class="ll kk hh lh b fi lq ln l lo lp">sample_text = "   \tUnnecessary \n\n\tspaces in the \rtext  "</span><span id="1ac8" class="ll kk hh lh b fi lq ln l lo lp">clean_text = remove_spaces(sample_text)<br/>print(clean_text)</span><span id="f179" class="ll kk hh lh b fi lq ln l lo lp"># ======== Expected Output =========<br/># <strong class="lh hi">Before:</strong>    \tUnnecessary \n\n\tspaces in the \rtext<br/># <strong class="lh hi">After:</strong> Unnecessary spaces in the text</span></pre><h1 id="f632" class="kj kk hh bd kl km kn ko kp kq kr ks kt in ku io kv iq kw ir kx it ky iu kz la bi translated">删除标点符号</h1><p id="eedb" class="pw-post-body-paragraph jn jo hh jp b jq lb ii js jt lc il jv jw ld jy jz ka le kc kd ke lf kg kh ki ha bi translated">对于数据分析，大多数时候不需要标点符号，它只会把分析搞得一团糟。所以通常要将它们移除。可以使用<code class="du lr ls lt lh b">string</code>和<code class="du lr ls lt lh b">re</code>库删除它。</p><pre class="ix iy iz ja fd lg lh li lj aw lk bi"><span id="7ac3" class="ll kk hh lh b fi lm ln l lo lp">import re<br/>from string import punctuation</span><span id="2960" class="ll kk hh lh b fi lq ln l lo lp">def remove_punctuation(text):<br/>    text = re.sub('[%s]' % re.escape(punctuation), '', text)<br/>    return text</span><span id="4087" class="ll kk hh lh b fi lq ln l lo lp">sample_text = "A' lot of, unnecessary punctuations!!!"</span><span id="2dac" class="ll kk hh lh b fi lq ln l lo lp">clean_text = remove_punctuation(sample_text)<br/>print(clean_text)</span><span id="7519" class="ll kk hh lh b fi lq ln l lo lp"># ======== Expected Output =========<br/># <strong class="lh hi">Before:</strong> A' lot of, unnecessary punctuations!!!<br/># <strong class="lh hi">After:</strong> A lot of unnecessary punctuations</span></pre><h1 id="aa60" class="kj kk hh bd kl km kn ko kp kq kr ks kt in ku io kv iq kw ir kx it ky iu kz la bi translated">删除超链接</h1><p id="5dca" class="pw-post-body-paragraph jn jo hh jp b jq lb ii js jt lc il jv jw ld jy jz ka le kc kd ke lf kg kh ki ha bi translated">如果你有网络抓取的数据，你会经常处理超链接。因此，您可能需要在分析中去掉超链接，使用正则表达式可以轻松实现这一点。</p><pre class="ix iy iz ja fd lg lh li lj aw lk bi"><span id="7382" class="ll kk hh lh b fi lm ln l lo lp">import re</span><span id="1348" class="ll kk hh lh b fi lq ln l lo lp">def remove_hyperlinks(text):<br/>    text = re.sub(r'https?://\S+', '', text)<br/>    return text</span><span id="9a91" class="ll kk hh lh b fi lq ln l lo lp">sample_text = "Some random URLs: <a class="ae jm" href="https://google.com" rel="noopener ugc nofollow" target="_blank">https://sample.com</a> <a class="ae jm" href="http://sample.edu/random" rel="noopener ugc nofollow" target="_blank">http://sample.edu/random</a>"</span><span id="539d" class="ll kk hh lh b fi lq ln l lo lp">clean_text = remove_hyperlinks(sample_text)<br/>print(clean_text)</span><span id="6b95" class="ll kk hh lh b fi lq ln l lo lp"># ======== Expected Output =========<br/># <strong class="lh hi">Before:</strong> Some random URLs: <a class="ae jm" href="https://google.com" rel="noopener ugc nofollow" target="_blank">https://sample.com</a> <a class="ae jm" href="http://sample.edu/random" rel="noopener ugc nofollow" target="_blank">http://sample.edu/random</a><br/># <strong class="lh hi">After:</strong> Some random URLs:</span></pre><h1 id="8342" class="kj kk hh bd kl km kn ko kp kq kr ks kt in ku io kv iq kw ir kx it ky iu kz la bi translated">删除HTML</h1><p id="5df0" class="pw-post-body-paragraph jn jo hh jp b jq lb ii js jt lc il jv jw ld jy jz ka le kc kd ke lf kg kh ki ha bi translated">与前面的情况类似，从web抓取的数据中，有时必须去掉HTML元素及其标签，并保留这些标签中的内容。对于这个任务，也可以使用正则表达式。</p><pre class="ix iy iz ja fd lg lh li lj aw lk bi"><span id="f6aa" class="ll kk hh lh b fi lm ln l lo lp">import re</span><span id="21bb" class="ll kk hh lh b fi lq ln l lo lp">def remove_html(text):<br/>    html_re = re.compile(r'&lt;.*?&gt;')      # create regex for html tag<br/>    text = re.sub(html_re, '', text)    # remove html tags<br/>    return text</span><span id="d556" class="ll kk hh lh b fi lq ln l lo lp">sample_text = """<br/>&lt;body&gt;<br/>&lt;h1&gt;This is a Heading&lt;/h1&gt;<br/>&lt;p&gt;This is a paragraph.&lt;/p&gt;<br/>&lt;/body&gt;<br/>"""</span><span id="28e2" class="ll kk hh lh b fi lq ln l lo lp">clean_text = remove_html(sample_text)<br/>print(clean_text)</span><span id="495b" class="ll kk hh lh b fi lq ln l lo lp"># ======== Expected Output =========<br/># <strong class="lh hi">Before:</strong> <br/># &lt;body&gt;<br/># &lt;h1&gt;This is a Heading&lt;/h1&gt;<br/># &lt;p&gt;This is a paragraph.&lt;/p&gt;<br/># &lt;/body&gt;</span><span id="a451" class="ll kk hh lh b fi lq ln l lo lp"># <strong class="lh hi">After:<br/></strong># This is a Heading<br/># This is a paragraph.</span></pre></div><div class="ab cl lu lv go lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ha hb hc hd he"><p id="8f6e" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">我希望这些对你有用。我处理过大量文本数据，这些是我在分析数据集或创建仪表板之前执行的常见数据清理任务。您可以遵循这些步骤，或者根据您的数据集要求对它们进行修改。</p><p id="eb30" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">请在评论区分享您的评论/观点；我很乐意回答所有问题。</p></div></div>    
</body>
</html>