<html>
<head>
<title>The art of Data Engineering and ETL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据工程和ETL的艺术</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/the-art-of-data-engineering-and-etl-3cf9e1c3f6a2?source=collection_archive---------10-----------------------#2021-07-05">https://medium.com/analytics-vidhya/the-art-of-data-engineering-and-etl-3cf9e1c3f6a2?source=collection_archive---------10-----------------------#2021-07-05</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/></div><div class="ab cl ie if go ig" role="separator"><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij"/></div><div class="ha hb hc hd he"><p id="04a2" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">数据工程是迈向数据科学最关键的第一步。它结合了数据收集和分析部分。你所有的假设和隐藏的趋势都被数据验证了。这很像<strong class="in hi">与数据对话并得到你的答案</strong>。例如，你问你的糖尿病数据集，“嘿，这种疾病更可能影响男性还是女性？”，而你的好哥们数据总会有答案给你。<strong class="in hi">总</strong>。</p></div><div class="ab cl ie if go ig" role="separator"><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij ik"/><span class="ih bw bk ii ij"/></div><div class="ha hb hc hd he"><p id="2070" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">但是，为了让数据成为你的分析伙伴，你需要培养你的数据集，让它成长。通常情况下，需要对数据集执行大量转换。数据插补、识别和纠正异常值、特征工程等等。所有这些收集、清理和转换数据集的过程被称为数据工程，<strong class="in hi"><em class="jj">2021年的一项需求技能</em> </strong>。基本上，在将数据集交给机器学习算法之前，你所做的一切都属于数据工程。</p><blockquote class="jk jl jm"><p id="d7f9" class="il im jj in b io ip iq ir is it iu iv jn ix iy iz jo jb jc jd jp jf jg jh ji ha bi translated">最近参加了2021年6月Analytics Vidhya主办的市场特征输入ETL大赛。</p></blockquote><p id="dd79" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">问题陈述非常简单，可以在电子商务应用程序上生成用户跟踪的输入数据集。提供了两个数据集，包括用户数据集和<em class="jj">用户访问日志数据集</em>。作为一名数据工程师，我们需要一个新的数据集，其中包含每个用户的一些预定义信息，如他最近的活动、查看的产品、使用的操作系统等。</p><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es jq"><img src="../Images/198d9c517c8c77162d3081110ad27ac7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SDiVPXcwsx5f1pR8xUVCPA.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx translated"><strong class="bd kg">用户</strong></figcaption></figure><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kh"><img src="../Images/beda8887dba1f408853d5df140ac9539.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p4bRZVuCNpRu4mQxcqAisA.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx translated"><strong class="bd kg">用户访问日志</strong></figcaption></figure><blockquote class="jk jl jm"><p id="4a71" class="il im jj in b io ip iq ir is it iu iv jn ix iy iz jo jb jc jd jp jf jg jh ji ha bi translated">预期输入要素数据集</p></blockquote><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es ki"><img src="../Images/2c3333424f5e7f01f0d714c17d2df2f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IM4dDBXf6ieXFrl-S4GKeg.png"/></div></div></figure><p id="7d6c" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><strong class="in hi">那么让我们开始… </strong></p><p id="dcc2" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">好的，从第一眼看，似乎在访问日志中有一行缺少userID。我的第一个猜测是验证webClientID，因为它是用户的会话，所以如果某个特定webClientID的某些记录中缺少UserID，UserID中的NaN可以替换为同一组中另一个记录的实际UserID。基本上，过滤掉缺少UserID的行，并研究这些webClientIDs，看其中是否有UserID。</p><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kj"><img src="../Images/de20dd45999185d7117737de2050cb4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EKEggUKpJI2_JUqp95RsSw.png"/></div></div></figure><p id="8672" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><em class="jj">显然，不存在缺少UserID的webClientID。所以我们可以安全地删除缺少UserID的行。</em></p><figure class="jr js jt ju fd jv er es paragraph-image"><div class="er es kk"><img src="../Images/f6baa4522bd23a47fc14d37161d3fe66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*ivImbhhbrBL0rAOs0P86Cw.png"/></div></figure><p id="6518" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">第二步，让我们检查各个列中的数据字符串，如activity、ProductID和OS。我注意到，这些栏目中的情况不一致。例如，OS包含两个值，<em class="jj"> chrome </em>和<em class="jj"> CHROME，</em>或Activity两者都有，<em class="jj"> click </em>和<em class="jj"> CLICK </em>。这些列中的数据遵循相同的大小写是至关重要的。</p><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kl"><img src="../Images/6692079990ec1e2e6d34cddfb40f6b51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iTdr4kp9C6mY6J8qcZw03Q.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx translated">保持各列中案例的一致性</figcaption></figure><p id="4dc5" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">第三步，<strong class="in hi">总是将数据集中的日期/时间列转换为python datetime实例。</strong>所以让我们将VisitDateTime转换为python日期。现在，该列中有两种日期格式，UNIX格式和UTC格式。这些需要保持一致。</p><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es km"><img src="../Images/87f02b16fc5bac05c0f2b76a08a42822.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_J7PbkuvBC2Y40E1DOhxNw.png"/></div></div></figure><blockquote class="jk jl jm"><p id="c7f9" class="il im jj in b io ip iq ir is it iu iv jn ix iy iz jo jb jc jd jp jf jg jh ji ha bi translated">根据问题陈述，“在当前情况下，您应该在2018年5月28日生成输入要素集。所以，访客表是从2018年5月7日到2018年5月27日。”</p></blockquote><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kn"><img src="../Images/0b08b38ee62793a21ccb6cbe05849117.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xezHnBfeaD12Cc-HD7nkJg.png"/></div></div><figcaption class="kc kd et er es ke kf bd b be z dx translated">过滤5月7日至5月28日之间的数据</figcaption></figure><p id="e826" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">让我们开始创建我们的最终数据集。</p><figure class="jr js jt ju fd jv er es paragraph-image"><div class="er es ko"><img src="../Images/62d91ef9d82b720a839e57c19855b947.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*6C37G8dG9FA_dHJ8FiIppA.png"/></div></figure><p id="dc50" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">最后一步，对于数据集中的每个用户，让我们计算所有这些必需的特征！！</p><figure class="jr js jt ju fd jv er es paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="er es kp"><img src="../Images/a27d645104f9239c9d28d330f7c6f691.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IZLzfD9dF1tHYgndp9QCzQ.png"/></div></div></figure><p id="c7bd" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><em class="jj">让我一步一步地向你介绍这个练习的核心。</em></p><ol class=""><li id="66d5" class="kq kr hh in b io ip is it iw ks ja kt je ku ji kv kw kx ky bi translated">根据用户标识过滤掉用户日志</li><li id="72a5" class="kq kr hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated">对于NaN活动，使用“页面加载”进行估算，或根据本栏的模式进行“点击”。出于演示目的，我硬编码为“页面加载”。</li><li id="00dd" class="kq kr hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated">要估算缺失ProductID中的值，请使用value_counts()来确定值的频率，并使用具有最多计数的ProductID。</li><li id="ea84" class="kq kr hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated">对于缺少的VisitDateTime，再次使用用户使用value_counts()访问最多的日期</li><li id="89cf" class="kq kr hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated">过滤掉7天的日志，获得唯一日期的长度(不是时间)</li><li id="284b" class="kq kr hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated">过滤掉15天的日志并获得唯一产品ID的长度</li><li id="d2b3" class="kq kr hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated">要确定用户年份，请计算注册日期和5月28日之间的差异。</li><li id="b6bc" class="kq kr hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated">要获得15天内查看次数最多的产品，请使用15天过滤日志中ProductID上的value_counts()并获得最高频率的ProductID</li><li id="881e" class="kq kr hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated">对于最活跃的操作系统，在日志中对操作系统使用value_counts()并获取频率最高的操作系统</li><li id="5caa" class="kq kr hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated">要获得最近查看的产品，请使用活动页面加载过滤日志，按VisitDateTime排序，并选择出现的第一个ProductID。</li><li id="42f1" class="kq kr hh in b io kz is la iw lb ja lc je ld ji kv kw kx ky bi translated">最后，要计算最近7天的页面加载和点击，请分别过滤最近7天的活动页面加载和点击日志。</li></ol><p id="7026" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">这段代码帮助我在比赛中达到了<strong class="in hi"> 93%的准确率</strong>！！！耶！！</p><p id="12a3" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">总之，您需要向您的合作伙伴(数据)提出正确的问题，以发掘其潜力。这种艺术是一名优秀数据工程师的突出特征。在这个数据集中仍有许多数据工程可以完成，例如用户查看的产品类型，他是在晚上还是白天更活跃，使用移动设备还是桌面设备，哪个国家的电子商务应用程序产生的业务最多，等等……你能在多大程度上利用你的数据取决于你。你对你的数据精心呵护，让它不断增长，它给你带来的故事就越多。<strong class="in hi">通过数据工程，努力成为一名数据说书人！</strong></p><p id="92ba" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">在这里查看我的完整实现</p><p id="c0de" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><a class="ae le" href="https://github.com/harnoor96/DS-and-ML/blob/master/Marketing%20Features%20ETL%20-Analytics%20Vidhya%20(June%202021)/Marketplace_Feature_Table.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/harnoor 96/DS-and-ML/blob/master/Marketing % 20 features % 20 ETL % 20-Analytics % 20 vid hya % 20(202021年6月)/market place _ Feature _ table . ipynb</a></p><p id="7e1b" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated">现在，为了将来的工作，可以使用类和方法以OOPS格式编写代码。此外，可以取消日期的硬编码。</p><p id="d742" class="pw-post-body-paragraph il im hh in b io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ha bi translated"><em class="jj">那都是乡亲们！</em></p></div></div>    
</body>
</html>