<html>
<head>
<title>Learn Data Mining by Applying it on Excel(Part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过在Excel上应用数据挖掘来学习数据挖掘(第2部分)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/learn-data-mining-by-applying-it-on-excel-part-2-6c3e380fde06?source=collection_archive---------10-----------------------#2021-02-01">https://medium.com/analytics-vidhya/learn-data-mining-by-applying-it-on-excel-part-2-6c3e380fde06?source=collection_archive---------10-----------------------#2021-02-01</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="516d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">欢迎来到本系列的第2部分，在我们应用了上一篇文章(<a class="ae jc" rel="noopener" href="/analytics-vidhya/learn-data-mining-by-applying-it-on-excel-6f046c8d1ff7">这里</a>)中的线性回归方法之后，现在是时候介绍一种叫做K-Means聚类的新方法了。</p><h1 id="db9d" class="jd je hh bd jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated"><strong class="ak">K-均值聚类:</strong></h1><p id="f9bb" class="pw-post-body-paragraph ie if hh ig b ih kb ij ik il kc in io ip kd ir is it ke iv iw ix kf iz ja jb ha bi translated">K-Means是一种分类或分组方法，假设您拥有一家拥有许多产品的零售或批发公司，该公司有许多客户(超过1000个)，您决定根据客户购买该公司4或5种主要产品的情况将他们分成4组，可能会给每组不同的折扣金额。这就是使用K-means聚类方法的地方，K是您想要对数据进行聚类的数字组，在我们的示例中是4。</p><p id="9f30" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">每一行包含客户的名字和每个产品的值，这一行被称为记录，因为它是由几个数值组成的，它也可以被称为数据点。</p><p id="4125" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在k均值聚类中，每个聚类(组)由该聚类的数据点的质心(或均值)来描述。例如，假设一个聚类有三个数据点，分别表示为三个向量(6，7，8，9，10)，(7，8，9，10，11)和(10，9，8，7，6)，这个聚类的质心是((6+7+10)/3)，(7+8+9+8)/3)，(9+10+7)/3)，(10+11+6)/3)，也就是(7.7，8，8.3请注意，该方法中的所有值都必须是数字。</p><p id="9fbe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们从下载excel表格(<a class="ae jc" href="https://github.com/AlbertAssaad/DataMiningApplyingitonExcel/blob/master/K-Mean%20Start.xlsx" rel="noopener ugc nofollow" target="_blank">这里</a>)开始我们的例子，它包含一个39个客户的列表，我们想把它们分成4个集群。我们可能需要尝试几个不同的k值，看看哪一个更适合我们的功能。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kg"><img src="../Images/f96c55d2e21315571dbd2250bd665d41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7Ac0I_DnnQOzM2dA.png"/></div></div><figcaption class="ks kt et er es ku kv bd b be z dx translated">来源:<a class="ae jc" href="https://aihub.cloud.google.com/u/0/p/products%2F0e0d2ed0-5563-4639-b348-53a83ac4ff4e" rel="noopener ugc nofollow" target="_blank">https://ai hub . cloud . Google . com/u/0/p/products % 2f 0 E0 D2 ed 0-5563-4639-b348-53 a83 C4 ff 4 e</a></figcaption></figure><p id="3dc6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">打开Excel表格后，您将看到:</p><p id="b4a9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">1-列A2将包含客户名称</p><p id="559f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2列B2:F2 5种不同产品的年销售额</p><p id="2178" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3列H我们5个产品的名称</p><p id="c305" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4列I2:L2我们在capital中插入了C1、C2、C3和C4，因为我们需要4个分类(k的值)。在每列下，我们在每种产品的销售范围内插入了一个随机数。</p><p id="73c4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">5列R2将具有最接近的集群的名称，这将决定它属于哪个组。</p><p id="1809" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">6-从I3到L7，我们插入了k个数据点作为初始质心。我们可以随机插入它们，或者根据我们在B3的数据选择它们:F41</p><p id="2187" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">7列N2:Q2我们将C1、C2、C3、C4的聚类名称插入首都，在每一列下，我们将计算数据点和质心之间的距离。为此，我们使用欧几里德函数，因此，如果我们有2个数据点(x1，x2，x3，x4)和(y1，y2，y3，y4)，它们的欧几里德距离计算如下:</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es kw"><img src="../Images/e09d2ef39a034dc13aefd7e11b8148bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*3wbTMhGLP0Yql5LmFJ5I4A.png"/></div></figure><p id="c252" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了应用上述内容，我们插入了以下函数，该函数将存储点Customer1(100000，30000，90000，8100000，4050000)和列I3中的质心之间的距离:I7 C1(5000，30000，8000，6000000，190000)，在N1编写以下函数:=SQRT(($B3-I$3) +($C3-I$4)</p><p id="8cc6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在继续拖动并自动填充从N3到Q3，然后选择单元格N3:Q3并自动填充到N41:Q41。现在我们有了客户数据集和所有质心之间的所有距离。</p><p id="62af" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">8-在R列中，我们需要插入数据集接近的聚类，我们可以通过在单元格R3中输入此函数来实现这一点:=INDEX($N$2:$Q$2，1，MATCH(MIN(N3:Q3)，N3:Q3，0))此函数将从行N2中获取文本:Q2取决于N3到Q3的最小值。</p><p id="83b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">9-从单元格R3到R41拖动并自动填充，现在我们将得到每个数据集最接近哪个点，因此它属于哪个聚类。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es kx"><img src="../Images/646b1e7001635522cb23590bc0521b24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vj_OkTs8BVXP9K-epg811g.png"/></div></div></figure><p id="6825" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">10-现在我们需要重新开始，为了继续聚类过程，我们需要复制当前工作表，并将其重命名为k2。我们这样做，我们右键单击底部的工作表名称“k1”“移动或复制”,然后勾选“创建副本”,将新复制的工作表重命名为“k2”</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ky"><img src="../Images/6f627be37f8e145e1bae85d0f9a13887.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*hO61ORZkY6e0Z27NL1VEaQ.png"/></div></figure><p id="d8d0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">11-在k2中，我们需要在单元格I3中使用一个公式来重新计算分类1中所有数据点的属性Product 1 Yearly sales的平均值，我们可以通过下面的公式=AVERAGEIFS('k1 '！$B$3:$B$41，' k1 '！$R$3:$R$41，I$2)，如果数据点属于(k1！R3:R41)但是因为我们将通过创建更多的工作表来重复这个过程几次，所以最好使用Indirect、ADDRESS函数和operator &amp;。因此，我们只需更改一个单元格的值，比编写函数并在每次创建工作表时选择值更好，我们可以通过以下方式实现:</p><ul class=""><li id="1b62" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb le lf lg lh bi translated">在k2工作表单元格G1中插入小写的“k1”</li><li id="e24d" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">在G3至G7中，分别填写2、3、4、5、6，这些数字将作为表k1中数值的列参考，因为B列是第2列，C列是第3列…这些数字将用作B、C、D、E、F列的参考</li><li id="70f2" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">在I3中，用下面的公式替换它:= average ifs(INDIRECT $ G $ 1 &amp; "！"&amp;ADDRESS(3，$G3，1)):INDIRECT($G$1 &amp; "！"&amp;ADDRESS(41美元，G3，1))、INDIRECT($G$1 &amp; "！$R$3 "):间接($G$1&amp; "！$R$41”)，I$2)，因为我们可以认识到，间接函数将获得它旁边的字符串，在我们的情况下，我们获取g1的值，即“k1”，并将其与！以及将返回K1的地址(3，g3，1 )!B3，现在当我们在k3表上工作时，我们只需要把G1的值改成k2，就这么简单。</li></ul><p id="a9e7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">12-自动填充从I3到L7的单元格。定义新的质心</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es ln"><img src="../Images/b068293191375eec58c4d8901f5b5f43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*lUnOIPnwmPr-xM7hq_mxNQ.png"/></div></figure><p id="9152" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">13-从单元格N3到Q41自动计算数据点和新计算的质心之间的差，并且最短的聚类被自动插入单元格R3:R41中</p><p id="a146" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">14-在单元格S1中输入数字1并自动填充到单元格S41，在T2中输入文本“旧聚类”，在U2中输入文本“差异”</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div class="er es lo"><img src="../Images/c934a0207a188d61c314ad8d683860af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*uQRtGL7h3f5c1ucFvJhDsQ.png"/></div></figure><p id="62f6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">15-在单元格T3中输入以下公式:=INDIRECT($G$1&amp; "！R"&amp;S3)将从表k1中获取值！R3单元格和自动填充直到单元格S41</p><p id="1c21" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">16-在单元格U3中输入此公式:=IF(T3=R3，0，1)这将检查数据点是否仍属于与之前相同的聚类(组),或者直到单元格U41才自动填充。</p><p id="1dd1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">17-我们需要重复第10点至第16点，直到单元格U3:U41中的所有值都为0，不要忘记在新复制的工作表中用前一个工作表的名称替换G1中的值。</p><p id="71a7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本例中，我按照得出结果的顺序创建了8个工作表，您可以找到最终的excel表(<a class="ae jc" href="https://github.com/AlbertAssaad/DataMiningApplyingitonExcel/blob/master/K-Mean%20End.xlsx" rel="noopener ugc nofollow" target="_blank">这里是</a>)，正如您在下面看到的，所有数据点的差值都是0，这意味着它没有更改其组，也没有移动到另一个组。现在，您可以筛选R列中的值，并查看哪些客户属于C1、C2、C3和C4。</p><figure class="kh ki kj kk fd kl er es paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="er es lp"><img src="../Images/976d84c2c877c527c124b24a94764289.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OB1NKpZnf34d6NhE6eTDsQ.png"/></div></div></figure><p id="0fc3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面的链接是K-means迭代的一个例子，我们可以看到数据点改变它们的聚类，直到它们粘在一起并达到最后一个。</p><div class="lq lr ez fb ls lt"><a href="https://media4.giphy.com/media/12vVAGkaqHUqCQ/giphy.gif?cid=ecf05e47qijo3wu04i7khee77fhxi8hf00dkn4xd56cdopo7&amp;rid=giphy.gif" rel="noopener  ugc nofollow" target="_blank"><div class="lu ab dw"><div class="lv ab lw cl cj lx"><h2 class="bd hi fi z dy ly ea eb lz ed ef hg bi translated">Spot Cluster GIF -在GIPHY上查找和共享</h2><div class="ma l"><h3 class="bd b fi z dy ly ea eb lz ed ef dx translated">发现并与你认识的每个人分享这个Spot GIF。GIPHY是你搜索、分享、发现和创建gif的方式。</h3></div><div class="mb l"><p class="bd b fp z dy ly ea eb lz ed ef dx translated">media4.giphy.com</p></div></div><div class="mc l"><div class="md l me mf mg mc mh kq lt"/></div></div></a></div><p id="44fe" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这就是K-Mean函数的全部内容，我尽量简化它，如果你有任何问题，请在评论中提出。</p><p id="ebf8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jc" rel="noopener" href="/analytics-vidhya/learn-data-mining-by-applying-it-on-excel-6f046c8d1ff7">&lt;= =在Excel上学习数据挖掘(上)</a></p></div></div>    
</body>
</html>