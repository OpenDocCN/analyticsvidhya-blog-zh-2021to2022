<html>
<head>
<title>5 Categorical Feature Encoding Techniques in SAS (Classic Encoder)— By Suraj Saini</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SAS(经典编码器)中的5种分类特征编码技术Suraj Saini</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/5-categorical-feature-encoding-techniques-in-sas-by-suraj-saini-bdccb067abd9?source=collection_archive---------9-----------------------#2021-02-18">https://medium.com/analytics-vidhya/5-categorical-feature-encoding-techniques-in-sas-by-suraj-saini-bdccb067abd9?source=collection_archive---------9-----------------------#2021-02-18</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/4ef8e85b6875523815d80247cf48d1f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*u6jJRXqLvQnVVR-D.jpg"/></div></div></figure><h2 id="4575" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">什么是分类特征编码？</h2><p id="d24f" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">分类变量通常表示为有限数量的字符串，而分类特征编码是将数据转换为机器学习模型可以理解的格式的过程。</p><p id="84b2" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">机器模型的性能取决于几个因素。决定模型性能的一个因素是用于处理数据并将其提供给模型的方法。因此，编码数据是一个至关重要的过程，因为它将数据转换为机器学习模型可以理解的分类变量。编码数据提高了模型质量，有助于特征工程。</p><p id="b9c2" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">在这篇博客中，我们将探索不同的经典编码方法，并简要介绍每种编码方法在SAS宏中的工作原理。</p><p id="47da" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">1.标签编码</p><p id="61c5" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">标签编码将1-N的值分配给一类分类特征。例如，如果有一个值为黑色、棕色和红色的可变“头发颜色”,标签编码将用1、2和3替换这些值。然而，标签编码的一个问题是，它不考虑类级别之间的顺序或任何关系。这不会阻止机器学习算法以这种不正确的顺序对待它们，这可能导致不准确的读数。</p><p id="4d82" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><em class="kn">用于标签编码的SAS宏</em></p><p id="3bf5" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">以下是在SAS中执行标签编码的宏示例:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="2857" class="ip iq hh kt b fi kx ky l kz la">%macro label_encode(dataset,var); <br/>proc sql noprint; select distinct(&amp;var) <br/>into:val1- <br/>from &amp;dataset; </span><span id="3b3e" class="ip iq hh kt b fi lb ky l kz la">select count(distinct(&amp;var)) <br/>into:mx <br/>from &amp;dataset; <br/>quit; </span><span id="2f14" class="ip iq hh kt b fi lb ky l kz la">data new; <br/>set &amp;dataset; <br/>%do i=1 %to &amp;mx; <br/>if &amp;var="&amp;&amp;&amp;val&amp;i" then new=&amp;i; <br/>%end; <br/>run; <br/>%mend;</span></pre><p id="d5b1" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">2.二进制编码</p><p id="4ee7" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">二进制编码像标签编码一样将类值转换为数值。然而，二进制编码更进一步，将数值转换为二进制数，其中每个数字都有自己单独的列。</p><p id="3b94" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">如果有n个唯一类别，则二进制编码将产生唯一的对数(以2为底)ⁿ特征。</p><p id="a54f" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">欲了解更多信息，请访问<a class="ae lc" href="https://towardsdatascience.com/all-about-categorical-variable-encoding-305f3361fd02" rel="noopener" target="_blank">这里</a>。</p><p id="f7b6" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><em class="kn">用于二进制编码的SAS宏</em></p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="8c46" class="ip iq hh kt b fi kx ky l kz la">%macro binary_encoding(dataset,var);<br/> proc sql noprint; <br/>select distinct(&amp;var) <br/>into:val1- <br/>from &amp;dataset; </span><span id="891c" class="ip iq hh kt b fi lb ky l kz la">select count(distinct(&amp;var)) <br/>into:mx <br/>from &amp;dataset; <br/>quit; </span><span id="001d" class="ip iq hh kt b fi lb ky l kz la">data new; <br/>set &amp;dataset; <br/>%do i=1 %to &amp;mx; <br/>if &amp;var="&amp;&amp;&amp;val&amp;i" then new=&amp;i; %end; format new binary.; <br/>run; <br/>%mend;</span></pre><p id="ebf3" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">该宏创建一个带有二进制格式值的变量。要将这些值拆分成多列，可以创建拆分列宏。</p><p id="451c" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><em class="kn">用于拆分列的SAS宏</em></p><p id="90a3" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">以下是在SAS中拆分列的宏示例:</p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="4fcf" class="ip iq hh kt b fi kx ky l kz la">%macro split_column(data,var); <br/>data try; <br/>set &amp;data; <br/>cha=put(&amp;var, binary.); <br/>run; </span><span id="7817" class="ip iq hh kt b fi lb ky l kz la">proc sql noprint; <br/>select max(length(cha)) <br/>into :ln from try ;<br/>quit; </span><span id="6ea8" class="ip iq hh kt b fi lb ky l kz la">data &amp;data; <br/>set try; <br/>%do i=1 %to &amp;ln; <br/>c_&amp;i=substr(cha,&amp;i,1); <br/>%end; <br/>run;<br/>%mend;</span></pre><p id="26da" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">3.一键编码</p><p id="5443" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">一键编码是将分类变量转换为1和0的过程。二进制数字被输入到机器学习、深度学习和统计算法中，以进行更好的预测或提高ML/DL/统计模型的效率。</p><p id="82c5" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><em class="kn">用于一键编码的SAS宏</em></p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="045d" class="ip iq hh kt b fi kx ky l kz la">%macro hot_encoding(data,var); <br/>proc sql noprint; <br/>select distinct &amp;var <br/>into:val1- <br/>from &amp;data; </span><span id="643b" class="ip iq hh kt b fi lb ky l kz la">select count(distinct(&amp;var)) <br/>into:len from &amp;data; quit; <br/>data encoded_data; <br/>set &amp;data; <br/>%do i=1 %to &amp;len; <br/>if &amp;var="&amp;&amp;&amp;val&amp;i" then %sysfunc(compress(&amp;&amp;&amp;val&amp;i,'$ - /'))=1 ; else %sysfunc(compress(&amp;&amp;&amp;val&amp;i,'$ - /'))=0; <br/>%end; <br/>run; <br/>%mend;</span></pre><p id="6201" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">4.计数/频率编码</p><p id="d7de" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">顾名思义，频率编码计算唯一的类值，然后除以值的总数。这种编码技术有助于模型理解并反向或直接分配权重。</p><p id="d54f" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><em class="kn">用于计数/频率编码的SAS宏</em></p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="07bd" class="ip iq hh kt b fi kx ky l kz la">%macro frequency_encoding(dataset, var); <br/>proc sql noprint; <br/>create table freq as select distinct(&amp;var) as values, count(&amp;var) as number <br/>from &amp;dataset <br/>group by Values ; </span><span id="d3e3" class="ip iq hh kt b fi lb ky l kz la">create table new as select *, round(freq.number/count(&amp;var),00.01) As freq_encode <br/>from &amp;dataset left join freq on &amp;var=freq.values;<br/>quit; </span><span id="2761" class="ip iq hh kt b fi lb ky l kz la">data new(drop=values number); <br/>set new; <br/>run; <br/>%mend;</span></pre><p id="d2e4" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">5.效果/总和/偏差编码</p><p id="365a" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">偏差编码技术有不同的名称，像效果编码，一些分析家称之为偏差编码，一些人说是和编码，但意义和定义是相同的。偏差编码与热编码相同，但唯一的区别是，如果所有列中都有0值，则这些值将变为-1。例如</p><figure class="ko kp kq kr fd ii er es paragraph-image"><div class="er es ld"><img src="../Images/1604fcd8afcfc103a8bae699d4ddaa51.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/0*fXbIVmP9WJqh8X-A"/></div></figure><p id="22e0" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">一个热编码</p><figure class="ko kp kq kr fd ii er es paragraph-image"><div class="er es le"><img src="../Images/4cb50a0eb15949facd65b47df472c419.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/0*AlL-RhxB7mfvck7-"/></div></figure><p id="1c72" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">效果/总和/偏差</p><figure class="ko kp kq kr fd ii er es paragraph-image"><div class="er es lf"><img src="../Images/b82316375747c6300ddc017487a8c839.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/0*5fwQ72GPqo4Evm0p"/></div></figure><p id="60cf" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><em class="kn">效果/总和/偏差编码的SAS宏</em></p><pre class="ko kp kq kr fd ks kt ku kv aw kw bi"><span id="ff02" class="ip iq hh kt b fi kx ky l kz la">%macro sum_encoding(data,var); <br/>proc sql noprint; <br/>select distinct &amp;var <br/>into:val1- <br/>from &amp;data; </span><span id="7a2d" class="ip iq hh kt b fi lb ky l kz la">select count(distinct(&amp;var)) <br/>into:len <br/>from &amp;data; <br/>quit; </span><span id="3013" class="ip iq hh kt b fi lb ky l kz la">data encoded_data; <br/>set &amp;data; <br/>%do i=1 %to &amp;len; <br/>if &amp;var="&amp;&amp;&amp;val&amp;i" then %sysfunc(compress(&amp;&amp;&amp;val&amp;i,'$ - /'))=1 ; else %sysfunc(compress(&amp;&amp;&amp;val&amp;i,'$ - /'))=0; <br/>%end; <br/>run; </span><span id="19a8" class="ip iq hh kt b fi lb ky l kz la">data sum_encode;<br/>set encoded_data; <br/>if %sysfunc(compress(&amp;&amp;&amp;val&amp;Len,'$ - /'))=1 then do; <br/>%do x=1 %to %eval(&amp;len-1); <br/>%sysfunc(compress(&amp;&amp;&amp;val&amp;x,'$ - /'))=-1; <br/>%end; <br/>end; <br/>drop %sysfunc(compress(&amp;&amp;&amp;val&amp;Len,'$ - /')); <br/>run; <br/>%mend;</span></pre><h2 id="108c" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">包扎</h2><p id="8bd2" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx ja jy jz ka je kb kc kd ji ke kf kg kh ha bi translated">数据科学家花费超过70–80%的时间清理和准备数据，这意味着编码或转换分类数据是他们工作的重要部分。然而，选择正确的编码技术以确保数据质量是很重要的，这就是为什么理解不同的编码方法是很重要的。</p><p id="1a6c" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated">如果你正在寻找更多的信息，更具体地说，关于SAS宏定义代码，你可以在我的Github页面上查看<a class="ae lc" href="https://github.com/Selerity/blog-categorical-feature-encoding-classical" rel="noopener ugc nofollow" target="_blank">这里</a>。</p></div><div class="ab cl lg lh go li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ha hb hc hd he"><p id="b3d7" class="pw-post-body-paragraph jn jo hh jp b jq ki js jt ju kj jw jx ja kk jz ka je kl kc kd ji km kf kg kh ha bi translated"><em class="kn">原载于2021年2月18日https://seleritysas.com</em><a class="ae lc" href="https://seleritysas.com/blog/2021/02/18/5-categorical-feature-encoding-techniques-in-sas/" rel="noopener ugc nofollow" target="_blank"><em class="kn"/></a><em class="kn">。</em></p></div></div>    
</body>
</html>