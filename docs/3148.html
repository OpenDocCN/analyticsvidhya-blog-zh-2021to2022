<html>
<head>
<title>Lesser Known Facts/Short cuts in Spark(PART1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">é²œä¸ºäººçŸ¥çš„äº‹å®/ç«èŠ±çš„æ·å¾„(ç¬¬ä¸€éƒ¨åˆ†)</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/lesser-known-facts-short-cuts-in-spark-part1-77596e367676?source=collection_archive---------0-----------------------#2021-06-12">https://medium.com/analytics-vidhya/lesser-known-facts-short-cuts-in-spark-part1-77596e367676?source=collection_archive---------0-----------------------#2021-06-12</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/e25f73d32b4ce87257089e9d35e7b598.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oAvOxnXRMCVQwQgV"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">é©¬å…‹Â·å¼—è±å½»Â·å¸ƒæœ—åœ¨<a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šçš„ç…§ç‰‡</figcaption></figure><p id="63ad" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä½œä¸ºä¸€åæ•°æ®å·¥ç¨‹å¸ˆï¼Œæˆ‘ä»¬æ¯å¤©éƒ½é¢ä¸´æŒ‘æˆ˜ï¼Œéœ€è¦è§£å†³ä¸€äº›ä¸å¸¸è§çš„æ¡ˆä¾‹ã€‚</p><p id="8328" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æˆ‘ä»¬ä¸èƒ½æŠŠåŒæ ·çš„æ€ç»´è¿‡ç¨‹åº”ç”¨åˆ°æ‰€æœ‰çš„åœ°æ–¹ã€‚æˆ‘ä»¬éœ€è¦è€ƒè™‘éœ€è¦ä»˜å‡ºçš„åŠªåŠ›ä»¥åŠå¦‚ä½•å‡å°‘æ—¶é—´ã€‚</p><p id="9210" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä½†ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨ä¸‹ç»“è®ºä¹‹å‰äº†è§£å†…éƒ¨æƒ…å†µã€‚</p><p id="9b13" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘å°†è®¨è®ºSparkä¸­çš„ä¸€äº›æŠ€å·§å’Œçªé—¨ä»¥åŠä¸€äº›é²œä¸ºäººçŸ¥çš„äº‹å®ï¼Œè¿™äº›å¯¹æˆ‘ä»¬å¤§å¤šæ•°æ•°æ®å·¥ç¨‹å¸ˆæ¥è¯´éƒ½å¾ˆæœ‰ç”¨ã€‚</p><h1 id="090c" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">1.count()æ€»æ˜¯è§¦å‘å¯¹æ¯ä¸€è¡Œçš„æ±‚å€¼ï¼Ÿ</h1><p id="f97a" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">æˆ‘ä»¬çŸ¥é“ã€‚ç¼“å­˜æˆ–æŒä¹…åŒ–æ˜¯ä¸€ç§è½¬æ¢ã€‚é™¤éæˆ‘ä»¬å¯¹ç¼“å­˜çš„æ•°æ®å¸§è°ƒç”¨ä»»ä½•æ“ä½œï¼Œå¦åˆ™å®ƒä¸ä¼šè¢«å…·ä½“åŒ–ã€‚</p><p id="432e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æˆ‘è·‘äº†åˆæ€ä¹ˆæ ·ã€‚æŒ‡æœ›æ•°æ®å¸§ï¼Ÿå®ƒåº”è¯¥ç¼“å­˜/ç‰©åŒ–æ•°æ®ï¼Œå¯¹å—ï¼Ÿ</p><p id="085e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä¸å°½ç„¶ï¼Œä¸rddç›¸æ¯”ï¼Œæ•°æ®å¸§å’Œæ•°æ®é›†ä¸Šçš„è®¡æ•°æ˜¯ä¸åŒçš„ã€‚</p><p id="9caf" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨RDDï¼Œæˆ‘ä»¬æ²¡æœ‰rddä¸Šçš„catalyst optimiserï¼Œå› æ­¤å®ƒå°†å§‹ç»ˆè¯„ä¼°ä¸€åˆ‡ã€‚</p><p id="e0a2" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä½†æ˜¯å¦ä¸€æ–¹é¢ï¼Œé€šè¿‡ä½¿ç”¨catalystï¼ŒDataFrame/Datasetå˜å¾—æ›´åŠ æ™ºèƒ½ï¼Œå®ƒå˜æˆäº†SQLä¸­çš„â€œselect count(*) from â€¦â€çš„ç­‰ä»·ç‰©ï¼Œè¿™å¯ä»¥åœ¨ä¸æ‰«ææŸäº›æ•°æ®æ ¼å¼çš„æ•°æ®çš„æƒ…å†µä¸‹å®Œæˆ(ä¾‹å¦‚ï¼ŒParquet)ã€‚</p><p id="6d33" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä½†æ˜¯è¯·æ³¨æ„ï¼Œå¦ä¸€æ–¹é¢ï¼Œç¼“å­˜æ•°æ®å¸§/æ•°æ®é›†ç¡®å®éœ€è¦ç¼“å­˜æ‰€æœ‰å†…å®¹ã€‚</p><p id="1ed4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">éœ€è¦äº†è§£æ›´å¤šï¼Ÿ</p><p id="6bec" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae it" href="https://databricks.com/blog/2017/02/16/processing-trillion-rows-per-second-single-machine-can-nested-loop-joins-fast.html" rel="noopener ugc nofollow" target="_blank">https://databricks . com/blog/2017/02/16/processing-ä¸‡äº¿è¡Œæ¯ç§’-å•æœº-can-nested-loop-joins-fast . html</a></p><h1 id="e22b" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">2.åœ¨æ•°æ®æ¡†ä¸­æŸ¥æ‰¾ç©ºåˆ—çš„å¿«æ·æ–¹å¼ï¼Ÿ</h1><p id="7138" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">åœ¨åŒ…å«100åˆ—çš„æ•°æ®å¸§çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦è·å¾—æ¯ä¸€åˆ—ä¸­çš„ç©ºè®°å½•çš„è®¡æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åº”ç”¨ã€‚å¯¹æ¯ä¸€åˆ—ä½¿ç”¨ç©ºå‡½æ•°ï¼Œæˆ–è€…åªä½¿ç”¨ä¸€ä¸ªç®€å•çš„å‘½ä»¤ï¼Œå¦‚:</p><p id="9c09" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">df . select(df . columns . map(c =&gt;sum(col(c). is null . cast(" int "))ã€‚åˆ«å(c)): _*)ã€‚show() </strong></p><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kv"><img src="../Images/dc15b41cfa5e05b3277aa310b70f571c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nzoaHxcTrtXuRUmXHEmSAQ.png"/></div></div></figure><h1 id="7f15" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">3.ä»€ä¹ˆæ˜¯metastoreè¶…æ—¶ï¼Ÿæˆ‘ä¸ºä»€ä¹ˆè¦åœ¨ä¹ï¼Ÿ</h1><p id="fbcb" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated"><strong class="iw hi"> <em class="la">æ— æ³•è·å–åˆ°jdbcçš„è¿æ¥:MySQL://&lt;&gt;/central _ metastoreï¼Ÿuse SSL = true&amp;requires sl = falseã€‚ä¼‘çœ 7000æ¯«ç§’ã€‚å‰©ä½™å°è¯•æ¬¡æ•°:2æ¬¡</em> </strong></p><p id="bb41" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬ä½¿ç”¨sparkå°†æ•°æ®è¾“å…¥ADLSGen2/S3ï¼Œä½¿ç”¨APIæˆ–HTTPSè°ƒç”¨ï¼Œä¾‹å¦‚ä½¿ç”¨sprimgmlåº“è°ƒç”¨SFDCã€‚</p><p id="2045" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae it" href="https://github.com/springml/spark-salesforce" rel="noopener ugc nofollow" target="_blank">https://github.com/springml/spark-salesforce</a></p><p id="cb07" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">Springml spark-salesforceåº“å°†å¸®åŠ©æ‚¨è¿æ¥åˆ°SFDCå¹¶è·å–æ•°æ®ã€‚</p><p id="fa2d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">è¿™ä½¿å¾—HTTPSæ°‘è°ƒä¸åŒäºå…¶ä»–JDBCæ°‘è°ƒã€‚</p><p id="78a9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ååé‡æ ¹æ®æˆ‘ä»¬åœ¨æ¯ä¸ªhttpsè°ƒç”¨ä¸­å°è¯•è®¿é—®çš„åˆ—æ•°è€Œå˜åŒ–ã€‚</p><p id="7d38" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å½“æˆ‘ä»¬è¯•å›¾è®¿é—®ä¸€ä¸ªæ‹¥æœ‰æ•°ç™¾ä¸‡æ¡è®°å½•çš„å·¨å¤§å¯¹è±¡æ—¶ï¼ŒSparkå°†èŠ±è´¹å¤§é‡æ—¶é—´æŸ¥è¯¢SFDCã€‚</p><p id="bae3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å½“sparkå®ŒæˆGETè¯·æ±‚æ—¶ï¼Œhive metastoresè¶…æ—¶ã€‚</p><p id="c99b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æ— æ³•è·å–åˆ°jdbcçš„è¿æ¥:mysql:// &lt;&gt; /central_metastoreï¼ŸuseSSL=true&amp;requireSSL=falseã€‚ä¼‘çœ 7000æ¯«ç§’ã€‚å‰©ä½™å°è¯•æ¬¡æ•°:2</p><p id="a3b1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦è°ƒæ•´ä»¥ä¸‹å‚æ•°ã€‚</p><pre class="kw kx ky kz fd lb lc ld le aw lf bi"><span id="855b" class="lg jt hh lc b fi lh li l lj lk"><strong class="lc hi">spark.hadoop.hive.server2.session.check.interval(default 60000ms)</strong></span><span id="0fdb" class="lg jt hh lc b fi ll li l lj lk"><strong class="lc hi">spark.hadoop.hive.server2.idle.operation.timeout(default 7200000ms)</strong></span><span id="24da" class="lg jt hh lc b fi ll li l lj lk"><strong class="lc hi">spark.hadoop.hive.server2.idle.session.timeout(default 900000ms)</strong></span><span id="635f" class="lg jt hh lc b fi ll li l lj lk"><strong class="lc hi"><em class="la">spark.hadoop.hive.server2.idle.operation.interval</em></strong></span></pre><p id="e49c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä¼šè¯/æ“ä½œè¶…æ—¶çš„æ£€æŸ¥é—´éš”ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ï¼Œå¯é€šè¿‡è®¾ç½®ä¸ºé›¶æˆ–è´Ÿå€¼æ¥ç¦ç”¨ã€‚<br/>ä¾‹å¦‚ï¼Œå€¼â€œ60000â€è¡¨ç¤º1åˆ†é’Ÿï¼Œè¡¨ç¤ºæ¯1åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡ä¼šè¯ã€‚</p><p id="5a5f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">T4 b . spark . Hadoop . hive . server 2 . idle . operation . time outT6ã€‘</strong></p><p id="6974" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨è¿™æ®µæ—¶é—´å†…æœªè¢«è®¿é—®æ—¶ï¼Œæ“ä½œå°†è¢«å…³é—­ï¼Œå•ä½ä¸ºæ¯«ç§’ã€‚é€šè¿‡è®¾ç½®ä¸ºé›¶æ¥ç¦ç”¨ã€‚</p><p id="5277" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å¯¹äºæ­£å€¼ï¼Œä»…æ£€æŸ¥ç»ˆç«¯çŠ¶æ€ä¸‹çš„æ“ä½œ(å·²å®Œæˆã€å·²å–æ¶ˆã€å·²å…³é—­ã€å‡ºé”™)ã€‚å¯¹äºè´Ÿå€¼ï¼Œæ£€æŸ¥æ‰€æœ‰æ“ä½œï¼Œè€Œä¸ç®¡çŠ¶æ€å¦‚ä½•ã€‚<br/>ä¾‹å¦‚ï¼Œå€¼â€œ7200000msâ€è¡¨ç¤ºå¦‚æœæŸ¥è¯¢/æ“ä½œä»åœ¨è¿è¡Œï¼Œå°†åœ¨2å°æ—¶åè¶…æ—¶ã€‚</p><p id="b6cf" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"><em class="la">c . spark . Hadoop . hive . server 2 . idle . session . time out</em></strong></p><p id="8380" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å¦‚æœä¼šè¯åœ¨ç»™å®šçš„æŒç»­æ—¶é—´(æ¯«ç§’)å†…æœªè¢«è®¿é—®ï¼Œä¼šè¯å°†è¢«å…³é—­ã€‚</p><p id="aae7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æˆ‘ä»¬å¯ä»¥ç¦ç”¨è®¾ç½®ä¸ºé›¶æˆ–è´Ÿå€¼ã€‚<br/>å€¼â€œ900000â€è¡¨ç¤ºä¼šè¯å°†åœ¨15åˆ†é’Ÿä¸æ´»åŠ¨åè¶…æ—¶ã€‚</p><h1 id="b743" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><strong class="ak"> 4ã€‚æˆ‘è¯¥ç”¨ä»€ä¹ˆï¼ŒSavemodeã€‚è¦†ç›–è¿˜æ˜¯æ¨¡å¼(â€œè¦†ç›–â€)ï¼Ÿï¼Ÿ</strong></h1><p id="5a15" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">å½“æˆ‘ä»¬åœ¨SparkSQLä¸Šå·¥ä½œæ—¶ï¼Œä¸€äº›å¼€å‘äººå‘˜ä½¿ç”¨â€œoverwriteâ€æ¨¡å¼ï¼Œä¸€äº›ä½¿ç”¨â€œSavemode.overwriteâ€æ¨¡å¼ã€‚</p><p id="3b02" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä¸¤è€…æœ‰åŒºåˆ«å—ï¼Ÿ</p><p id="39f9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä¸ï¼Œâ€œè¦†ç›–â€æ˜¯Savemode.overwriteçš„ç®€å†™å‘½ä»¤</p><p id="c924" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">çœ‹çœ‹ä¸‹é¢çš„æºä»£ç ã€‚</p><pre class="kw kx ky kz fd lb lc ld le aw lf bi"><span id="ea68" class="lg jt hh lc b fi lh li l lj lk"><strong class="lc hi">/**<br/> * Specifies the behavior when data or table already exists. Options include:<br/> * â€” `overwrite`: overwrite the existing data.<br/> * â€” `append`: append the data.<br/> * â€” `ignore`: ignore the operation (i.e. no-op).<br/> * â€” `error` or `errorifexists`: default option, throw an exception at runtime.<br/> *<br/> * @since 1.4.0<br/> */</strong></span><span id="38ae" class="lg jt hh lc b fi ll li l lj lk"><strong class="lc hi">def mode(saveMode: String): DataFrameWriter[T] = {<br/> this.<em class="la">mode </em>= saveMode.toLowerCase(Locale.<em class="la">ROOT</em>) match {<br/> case â€œoverwriteâ€ =&gt; SaveMode.<em class="la">Overwrite<br/> </em>case â€œappendâ€ =&gt; SaveMode.<em class="la">Append<br/> </em>case â€œignoreâ€ =&gt; SaveMode.<em class="la">Ignore<br/> </em>case â€œerrorâ€ | â€œerrorifexistsâ€ | â€œdefaultâ€ =&gt; SaveMode.<em class="la">ErrorIfExists<br/> </em>case _ =&gt; throw new IllegalArgumentException(sâ€Unknown save mode: $saveMode. â€ +<br/> â€œAccepted save modes are â€˜overwriteâ€™, â€˜appendâ€™, â€˜ignoreâ€™, â€˜errorâ€™, â€˜errorifexistsâ€™.â€)<br/> }<br/> this<br/>}</strong></span></pre><h1 id="225b" class="js jt hh bd ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated">5.ç«èŠ±ä¸åŒVSä¸¢å¼ƒé‡å¤</h1><p id="63ac" class="pw-post-body-paragraph iu iv hh iw b ix kq iz ja jb kr jd je jf ks jh ji jj kt jl jm jn ku jp jq jr ha bi translated">distinctå’ŒDropDuplicatesä¹‹é—´çš„ä¸»è¦åŒºåˆ«ä»…åœ¨äºåˆ—çš„å­é›†ã€‚</p><p id="4882" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">åœ¨Distinctå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è°ƒç”¨å‡½æ•°ä¹‹å‰ä¼ é€’selectå­å¥ä¸­çš„åˆ—ã€‚</p><p id="e3d3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å…¶ä¸­ï¼Œ<code class="du lm ln lo lc b">dropDuplicates(colNames)</code>å°†åœ¨åˆ é™¤ç»™å®šåˆ—çš„é‡å¤é¡¹åè¿”å›æ•°æ®å¸§ä¸­çš„æ‰€æœ‰åˆ—ã€‚</p><p id="deba" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä»<a class="ae it" href="https://spark.apache.org/docs/1.5.1/api/java/org/apache/spark/sql/DataFrame.html#dropDuplicates()" rel="noopener ugc nofollow" target="_blank"> javadoc </a>æ¥çœ‹ï¼Œdistinc()å’ŒdropDuplicates()æ²¡æœ‰åŒºåˆ«ã€‚</p><pre class="kw kx ky kz fd lb lc ld le aw lf bi"><span id="3717" class="lg jt hh lc b fi lh li l lj lk"><strong class="lc hi">dropDuplicates</strong></span><span id="c525" class="lg jt hh lc b fi ll li l lj lk"><strong class="lc hi">public DataFrame dropDuplicates()</strong></span><span id="e7ca" class="lg jt hh lc b fi ll li l lj lk"><strong class="lc hi">Returns a new DataFrame that contains only the unique rows from this DataFrame. This is an alias for distinct.</strong></span></pre><p id="46af" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">dropDuplicates()æ˜¯åœ¨1.4ä¸­ä½œä¸ºdistinct()çš„æ›¿ä»£è€Œå¼•å…¥çš„ï¼Œå› ä¸ºæ‚¨å¯ä»¥ä½¿ç”¨å®ƒçš„é‡è½½æ–¹æ³•æ¥è·å¾—åŸºäºåˆ—å­é›†çš„å”¯ä¸€è¡Œã€‚</p><p id="adb7" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">æœªå®Œå¾…ç»­..</p><p id="5fa1" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ç¬¬2éƒ¨åˆ†å·²ç»åœ¨è¿™é‡Œå‘è¡¨äº†ã€‚</p><div class="lp lq ez fb lr ls"><a href="https://link.medium.com/lExxlOuM9hb" rel="noopener follow" target="_blank"><div class="lt ab dw"><div class="lu ab lv cl cj lw"><h2 class="bd hi fi z dy lx ea eb ly ed ef hg bi translated">é²œä¸ºäººçŸ¥çš„äº‹å®/ç«èŠ±çš„æ·å¾„(ç¬¬äºŒéƒ¨åˆ†)</h2><div class="lz l"><h3 class="bd b fi z dy lx ea eb ly ed ef dx translated">è¿™æ˜¯é²œä¸ºäººçŸ¥çš„äº‹å®/ç«èŠ±æ·å¾„çš„ç¬¬äºŒéƒ¨åˆ†ï¼Œæˆ‘å°†åœ¨è¿™é‡Œè°ˆè®ºä¸€äº›æœªçŸ¥çš„å’Œâ€¦</h3></div><div class="ma l"><p class="bd b fp z dy lx ea eb ly ed ef dx translated">link.medium.com</p></div></div><div class="mb l"><div class="mc l md me mf mb mg in ls"/></div></div></a></div><figure class="kw kx ky kz fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mh"><img src="../Images/0564afa916f47d189c7aef68aa837e17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qiGLGnfnMfJCvTyhLgt5jg.png"/></div></div></figure><p id="97b6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ä½ å¯ä»¥åœ¨è¯„è®ºä¸­å‘è¡¨ä½ çš„åé¦ˆã€‚</p><p id="0591" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">é˜¿å‰ç‰¹Â·åº“ç›å°”Â·è°¢è’‚</p><p id="f228" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">å¤§æ•°æ®å·¥ç¨‹å¸ˆâ€”çƒ­çˆ±å¤§æ•°æ®ã€åˆ†æã€äº‘å’ŒåŸºç¡€è®¾æ–½ã€‚</p><p id="43ed" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><a class="ae it" href="https://ajithshetty28.medium.com/subscribe" rel="noopener">è®¢é˜…</a> âœ‰ï¸ || <a class="ae it" href="https://ajithshetty28.medium.com/" rel="noopener">æ›´å¤šåšå®¢</a>ğŸ“|| <a class="ae it" href="https://www.linkedin.com/in/ajshetty28" rel="noopener ugc nofollow" target="_blank">é“¾æ¥äº</a>ğŸ“Š|| <a class="ae it" href="https://ajithshetty.github.io/" rel="noopener ugc nofollow" target="_blank">ä¸ªäººèµ„æ–™é¡µé¢</a>ğŸ“š|| <a class="ae it" href="https://github.com/ajithshetty/" rel="noopener ugc nofollow" target="_blank"> Gitå›è´­</a>ğŸ‘“</p><p id="ec72" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">è®¢é˜…æˆ‘çš„:</strong> <a class="ae it" href="https://justenoughdata.substack.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="iw hi">æ¯å‘¨ç®€è®¯åˆšå¥½å¤Ÿæ•°æ®</strong> </a></p></div></div>    
</body>
</html>