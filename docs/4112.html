<html>
<head>
<title>Introduction to Object Detection with RCNN Family Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于RCNN家族模型的目标检测简介</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/introduction-to-object-detection-with-rcnn-family-models-310558ce2033?source=collection_archive---------2-----------------------#2021-08-28">https://medium.com/analytics-vidhya/introduction-to-object-detection-with-rcnn-family-models-310558ce2033?source=collection_archive---------2-----------------------#2021-08-28</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/5bd197e253ce8cd895cac267a018b800.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_mEn7ufLmhkk4atniJiGXA.jpeg"/></div></div></figure><p id="9a36" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这篇文章中，你将发现对物体检测问题的温和介绍，以及旨在解决该问题的最先进的深度学习模型。</p><p id="5177" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">看完这篇帖子，你会知道:</p><ul class=""><li id="f716" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">基于区域的卷积神经网络，或R-CNN，是一系列用于处理对象检测任务的技术，设计用于模型性能。</li></ul><p id="f55a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们开始吧。</p><h1 id="bb91" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">概观</h1><p id="59ac" class="pw-post-body-paragraph iq ir hi is b it kv iv iw ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn hb bi translated">本文分为两个部分；它们是:</p><ol class=""><li id="d716" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn la ju jv jw bi translated">目标检测中的基本术语和面临的挑战</li><li id="dc51" class="jo jp hi is b it lb ix lc jb ld jf le jj lf jn la ju jv jw bi translated">R-CNN模型族</li></ol><h1 id="b228" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">那么，让我们用一些术语来理解:</strong></h1><ol class=""><li id="14c4" class="jo jp hi is b it kv ix kw jb lg jf lh jj li jn la ju jv jw bi translated"><strong class="is hj">图像分类:</strong>预测图像中物体的类型或类别</li></ol><p id="6d7a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="lj">输入:</em> </strong>单个物体的图像，如照片。</p><p id="40fe" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="lj">输出:</em> </strong>一个类标签(例如映射到类标签的一个或多个整数)。</p><p id="c5f0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.<strong class="is hj">物体定位:</strong>定位图像中的物体，并用边界框输出它们的位置。</p><p id="f692" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="lj">输入:</em> </strong>带有一个或多个物体的图像，如照片。</p><p id="d312" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="lj">输出:</em> </strong>一个或多个边界框(如由点、宽度和高度定义)。</p><p id="dc1d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.<strong class="is hj">目标检测:</strong>在图像中用包围盒定位目标，并定位目标的类型或类别。</p><p id="f4a7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="lj">输入:</em> </strong>带有一个或多个物体的图像，如照片。</p><p id="fb2c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="lj">输出:</em> </strong>一个或多个边界框(例如，由点、宽度和高度定义)，以及每个边界框的类别标签。</p><p id="ba34" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">边界框用这些组件(x，y，w，h，置信度)来参数化</p><p id="58d2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">(x，y) =给出盒子的中心，w =盒子的宽度，h =盒子的高度</p><h1 id="b05e" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak">物体检测的挑战</strong></h1><ol class=""><li id="03eb" class="jo jp hi is b it kv ix kw jb lg jf lh jj li jn la ju jv jw bi translated"><strong class="is hj">多路输出:</strong></li></ol><p id="dbc0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在图像分类的情况下，我们对每个图像有单个输出，但是这里我们需要输出检测到的对象的整个集合，其中每个图像中可能有许多不同的对象。因此，我们需要建立模型，可以输出不同大小的检测数量。</p><p id="e993" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.<strong class="is hj">多种类型的输出:</strong></p><p id="ec7d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们有两种不同类型的输出:</p><p id="8bca" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">a.类别标签</p><p id="9496" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">b.包围盒</p><p id="eb11" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.<strong class="is hj">计算问题:</strong></p><p id="21fc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于对象检测，通常需要在高分辨率图像上工作。因为我们想要识别图像中的许多不同的对象，我们想要每个对象有足够的空间分辨率，所以图像的整体分辨率需要相当高。</p><blockquote class="lk ll lm"><p id="1e0f" class="iq ir lj is b it iu iv iw ix iy iz ja ln jc jd je lo jg jh ji lp jk jl jm jn hb bi translated"><strong class="is hj"> <em class="hi">在深入研究RCNN家族之前，我们必须了解区域建议的概念</em> </strong></p></blockquote><p id="1e4d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="lj">地区建议的想法:</em> </strong></p><p id="9274" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，我们的想法是，如果我们无法在图像中的每个可能区域上评估对象检测器，那么我们可以使用外部算法来为我们生成图像中的候选区域集，使得候选区域为每个图像提供一个小的区域集，但具有覆盖图像中对象的高概率。</p><p id="891a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">区域提议的一个著名方法是称为选择性搜索的方法。因此，选择性搜索算法将在CPU上几秒钟的处理时间内为每幅图像提供大约2，000个对象建议，并且该算法输出的这2，000个区域建议将非常有可能覆盖图像中我们关心的所有感兴趣的对象。</p><figure class="lr ls lt lu fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es lq"><img src="../Images/e4a1ec4733751d9f69c93bc605950e40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JqGE-Los4fOl5AHuJQigSQ.png"/></div></div></figure><p id="18d4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">一旦我们有了区域提议的想法，它给我们提供了用深度神经网络训练对象检测器的方法。这就把我们带到了非常著名的报纸R-CNN。</p><p id="5373" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，让我们看看RCNN的模型系列。</p><h2 id="254f" class="lv jy hi bd jz lw lx ly kd lz ma mb kh jb mc md kl jf me mf kp jj mg mh kt mi bi translated"><strong class="ak"> <em class="mj">基于区域的物体检测(R-CNN): </em> </strong></h2><p id="ad5b" class="pw-post-body-paragraph iq ir hi is b it kv iv iw ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn hb bi translated">这就像2014年发表的深度学习领域最有影响力的论文一样。(<a class="ae mk" href="https://arxiv.org/abs/1311.2524" rel="noopener ugc nofollow" target="_blank">丰富的特征层次进行精确的物体检测和语义分割</a>)作者:<a class="ae mk" href="https://arxiv.org/search/cs?searchtype=author&amp;query=Ren%2C+S" rel="noopener ugc nofollow" target="_blank">任</a>、<a class="ae mk" href="https://arxiv.org/search/cs?searchtype=author&amp;query=He%2C+K" rel="noopener ugc nofollow" target="_blank">、</a>、<a class="ae mk" href="https://arxiv.org/search/cs?searchtype=author&amp;query=Girshick%2C+R" rel="noopener ugc nofollow" target="_blank">罗斯·吉斯克</a>、<a class="ae mk" href="https://arxiv.org/search/cs?searchtype=author&amp;query=Sun%2C+J" rel="noopener ugc nofollow" target="_blank">、</a></p><p id="dc24" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">RCNN的架构和工作:</strong></p><figure class="lr ls lt lu fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ml"><img src="../Images/527a12d1c75f384a1358f19c68da4c60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WXy_312_NhX7kQu3AuGd7A.png"/></div></div><figcaption class="mm mn et er es mo mp bd b be z dx translated">RCNN的体系结构</figcaption></figure><p id="bbe9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"><em class="lj">RCNN工作:</em> </strong></p><p id="757a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤1: </strong>我们从输入图像开始，运行类似选择性搜索的区域提议方法，通过该方法，我们在图像中获得2000个需要评估的候选区域提议</p><p id="0ea4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤2: </strong>对于每个候选区域，由于区域提议可以具有不同的大小和不同的纵横比，所以我们将把该区域扭曲成固定的大小，比如说(224x224)</p><p id="4734" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤3: </strong>对于每个扭曲的图像区域，我们将通过卷积神经网络(CNN)独立地运行它们，CNN将输出每个区域的分类分数</p><p id="5419" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">但是，这里有一个小问题，</p><p id="a4d5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果我们从选择性搜索中得到的区域建议与我们想要在图像中检测的对象不完全匹配，会发生什么？</p><p id="666c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">所以，为了克服这个问题，</p><p id="dec8" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，CNN将输出额外的内容，这是将区域建议框转换为我们想要输出的感兴趣对象的最终框的转换</p><p id="16c1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">最后它看起来会像这样，</p><figure class="lr ls lt lu fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mq"><img src="../Images/bfbad5ddc85b24092de3dac6ec2c6efe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Somb4wiPVEFqy00JDCZZeg.png"/></div></div><figcaption class="mm mn et er es mo mp bd b be z dx translated">最后，RCNN的架构将如下所示</figcaption></figure><p id="752b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤1: </strong>运行区域建议方法，计算2000个候选区域建议</p><p id="160b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤2: </strong>将每个区域调整到特定大小(224x224)并通过CNN独立运行，以预测类得分和边界框变换</p><p id="1948" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第三步:</strong>使用分数选择要输出的区域提案子集</p><p id="e553" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第四步:</strong>与地面真相框进行比较</p><blockquote class="lk ll lm"><p id="7ce3" class="iq ir lj is b it iu iv iw ix iy iz ja ln jc jd je lo jg jh ji lp jk jl jm jn hb bi translated">现在，问题出现了<strong class="is hj">如何比较预测和地面真相框</strong>？</p></blockquote><p id="fce5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们可以将这些边界框与称为并集上的交集(IOU)的度量进行比较</p><figure class="lr ls lt lu fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mr"><img src="../Images/43d1b0d7820e04ecb0a96946b0343958.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8PzGCuR37gT1oknFQUeWuw.png"/></div></div></figure><p id="2125" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">IOU =(相交面积)/(并集面积)</p><p id="e7f7" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">更一般地，IOU是边界框之间重叠的度量</p><p id="1152" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果，IOU&lt;0.5 → we say it ‘Bad’ IOU&gt;0.5→‘下降’，IOU &gt; 0.7→‘良好’，IOU &gt; 0.9→‘几乎完美’</p><blockquote class="lk ll lm"><p id="5815" class="iq ir lj is b it iu iv iw ix iy iz ja ln jc jd je lo jg jh ji lp jk jl jm jn hb bi translated">还有另一个问题是，<strong class="is hj">对象检测器经常为同一对象输出多个包围盒。那么这个怎么解决呢？</strong></p></blockquote><p id="25ed" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，对此的解决方案是:使用<strong class="is hj">非最大值抑制(NMS) </strong>对原始检测进行后处理</p><p id="ea10" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">NMS是你确保你的算法只检测一次对象的方法。</p><p id="8b9b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，NMS所做的是，它清除其他不需要的检测，所以我们最终只检测到一个特定的对象。</p><p id="6ffc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个NMS是如何工作的？ </p><p id="1de9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.首先，它寻找与特定对象的每个检测相关联的概率(Pc)</p><p id="a0a5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.它采用最大的“Pc ”,这是对物体最有把握的检测</p><p id="7a2f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.完成后，NMS部分寻找所有剩余的边界框，并选择所有那些与最高“Pc”的边界框具有高交集(IOU)的边界框，并抑制它们。</p><p id="11dc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.然后，我们寻找剩余的边界框，并找到最高的“Pc ”, NMS再次寻找具有高IOU的剩余边界框，其中边界框具有高“Pc ”,然后它们将被抑制。</p><figure class="lr ls lt lu fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es ms"><img src="../Images/c0b441eb5b454becb6fe22ddc94673b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rnIxE9wXcny6prBbiHfaOA.png"/></div></div></figure><p id="1446" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于这个例子:</p><p id="ffae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">1.它需要最大的Pc，在这种情况下是0.9</p><p id="94a0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">2.它检查所有剩余边界框的IOU(即汽车1的0.6，0.7和汽车2的0.8，0.7)</p><p id="a475" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">3.现在，NMS将取消汽车1的0.6和0.7，因为它们相对于Pc=0.9的边界框具有较高的IOU，所以像这样，我们只获得汽车1的一个边界框，它在图像中高亮显示。</p><p id="323a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">4.接下来，对于剩余的边界框，car2的Pc最高=0.8，我们再次检查剩余框的IOU(即car1的0.9和car2的0.7)</p><p id="8dd2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">5.现在，NMS将抑制0.7，因为它相对于Pc=0.8的边界框具有高IOU。汽车2也只有一个包围盒。</p><p id="d914" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，在RCNN的情况下，它非常慢，不能实时使用。</p><h1 id="38ac" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">快速递归神经网络</h1><p id="9b61" class="pw-post-body-paragraph iq ir hi is b it kv iv iw ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn hb bi translated">研究人员快速实现这一点的方法是交换CNN和warping步骤。基本上，我们在运行CNN后扭曲图像。这样，我们得到了<a class="ae mk" href="https://arxiv.org/abs/1504.08083" rel="noopener ugc nofollow" target="_blank"> <strong class="is hj"> <em class="lj"> Fast-RCNN。</em></strong></a><strong class="is hj"><em class="lj"/></strong><a class="ae mk" href="https://arxiv.org/search/cs?searchtype=author&amp;query=Girshick%2C+R" rel="noopener ugc nofollow" target="_blank">罗斯·吉斯克</a>。</p><p id="fb11" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们看看工作和建筑，</p><figure class="lr ls lt lu fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mt"><img src="../Images/8762ed282e1305b00b834cd18dda0602.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1vUBU90QKwLkWmrY4898OQ.png"/></div></div><figcaption class="mm mn et er es mo mp bd b be z dx translated">快速递归神经网络体系结构</figcaption></figure><p id="a7cc" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤1: </strong>取输入图像，用单个CNN处理整幅图像(无全连接层)。因此，输出将是卷积特征图，为我们提供卷积特征。而我们运行的这个ConvNet通常被称为骨干网(可以是AlexNet、VGG、ResNet等。)</p><p id="238d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤2: </strong>运行区域建议方法并裁剪&amp;调整特征尺寸</p><p id="769b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第三步:</strong>按地区运行轻型CNN(意思是浅层网络)</p><p id="70b6" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这将是快速的，因为大部分计算将发生在主干网络中，我们在每个区域运行的网络将相对较小、重量较轻且运行速度较快。</p><p id="f9e4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">裁剪特征和调整特征大小是什么意思？如何裁剪特征？</strong></p><p id="f87a" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这可以通过<strong class="is hj">兴趣池区域(RoI Pooling) </strong>完成</p><p id="35db" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">其目的是对非均匀大小的输入进行最大池化，以获得固定大小的特征图(如7×7)。</strong></p><p id="d88c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">我们就通过例子来理解这个吧，</strong></p><p id="e102" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">让我们考虑一个小例子来看看它是如何工作的。我们将在单个8×8要素地图上执行感兴趣区域合并，一个感兴趣区域和2×2的输出大小。我们的输入要素地图如下所示:</p><figure class="lr ls lt lu fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/4d8175c53ed60386681a77dec525386a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ltq8PdHQb6LDSnEQBODU_w.jpeg"/></div></div></figure><p id="b3a2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">假设我们也有一个区域建议(左上，右下坐标):(0，3)，(7，8)。在图中，它看起来像这样:</p><figure class="lr ls lt lu fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/6c178be0d8949fd7d7f03e0fe5c18ee3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tsg4Qi-f33Jc1ZzesMn-JQ.jpeg"/></div></div></figure><p id="c978" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">通常情况下，会有多个特征地图和多个建议，但是我们保持例子的简单性。<br/>通过将其分成(2×2)个部分(因为输出大小是2×2 ),我们得到:</p><figure class="lr ls lt lu fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/04ef93b9760c04914fd8eefb89bcbe28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5lEeppPyid_1tdfXfIgi_A.jpeg"/></div></div></figure><p id="3272" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">请注意，感兴趣区域的大小不必被汇集部分的数量整除(在这种情况下，我们的RoI是7×5，我们有2×2个汇集部分)。<br/>每个区段的最大值为:</p><figure class="lr ls lt lu fd ij er es paragraph-image"><div class="er es mv"><img src="../Images/9656a396cd7ae2c02e06e28fbd3f7f53.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*aqkAGCsiZtnLENlr5KI3UQ.jpeg"/></div></figure><p id="4c21" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是兴趣区图层的输出。下面是我们以动画形式展示的例子:</p><figure class="lr ls lt lu fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mu"><img src="../Images/0be1813779dc199584d7a70d6d878564.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*5V5mycIRNu-mK-rPywL57w.gif"/></div></div></figure><p id="eeaa" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">结果是，从具有不同大小的矩形列表中，我们可以快速获得具有固定大小的对应特征图的列表。请注意，RoI汇集输出的维度实际上并不取决于输入特征地图的大小，也不取决于区域建议的大小。这完全取决于我们将提案分成多少部分。</p><p id="f0e4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">投资回报池的好处是什么</strong>？其中之一是处理速度。如果框架上有多个对象提议(通常会有很多)，我们仍然可以对它们使用相同的输入特征映射。由于在处理的早期计算卷积是非常昂贵的，这种方法可以节省我们很多时间。</p><p id="7b06" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，为了使这个快速RCNN更快，研究人员在主干网络后添加了<strong class="is hj">区域提议网络</strong>。这给了我们，</p><h1 id="8f9a" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated"><strong class="ak"> <em class="mj">更快——RCNN</em></strong></h1><p id="6a9f" class="pw-post-body-paragraph iq ir hi is b it kv iv iw ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn hb bi translated"><strong class="is hj"><em class="lj">(</em></strong><a class="ae mk" href="https://arxiv.org/abs/1506.01497" rel="noopener ugc nofollow" target="_blank"><strong class="is hj"><em class="lj">)面向实时目标检测的区域建议网络</em></strong></a><strong class="is hj"><em class="lj">)</em></strong></p><figure class="lr ls lt lu fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mw"><img src="../Images/ce6a55429150b2755998050b2515346c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B6aqfcsRjSSRYBzHd0IPtw.png"/></div></div><figcaption class="mm mn et er es mo mp bd b be z dx translated">快速RCNN的体系结构</figcaption></figure><p id="29d2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里，我们将消除称为选择性搜索的算法，而是训练卷积神经网络来预测我们的区域建议。我们将采用的方法与快速RCNN非常相似，只是在运行主干网络之后，我们将插入一个名为<strong class="is hj">区域建议网络(RPN) </strong>的微型网络，负责预测区域建议。</p><p id="5198" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">基本上，在我们得到区域建议后，Fast-RCNN和Fast-RCNN的工作是相同的。</p><p id="0aac" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤1: </strong>通过主干网络运行输入图像，获得图像级特征</p><p id="7cf4" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤2: </strong>将图像级特征传递给<strong class="is hj"> RPN </strong>以获得我们的区域建议</p><p id="67ae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤3: </strong>通过投资回报池裁剪区域提案</p><p id="6927" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">步骤4: </strong>将扭曲特征传递给光CNN，用于预测最终分类和边界框变换</p><p id="19e2" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这里的问题是我们如何使用CNN来输出地区建议？</p><figure class="lr ls lt lu fd ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es mx"><img src="../Images/c9cb42a8b0881c0ba934f49c5a2344e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YJO0FBB6Dhu39JUZAFkwuA.png"/></div></div><figcaption class="mm mn et er es mo mp bd b be z dx translated">区域提议网络的体系结构</figcaption></figure><p id="74c5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">来自主干网络的CNN图像特征都与输入中的位置对齐。因此，我们可以做的是，在CNN特征图中的每个点，我们可以想象锚框，它只是在图像周围滑动，我们将锚框放置在CNN特征图中来自主干网络的每个位置。</p><p id="5cd1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们的任务是训练小CNN将这些锚盒分类为包含或不包含对象。</p><blockquote class="lk ll lm"><p id="e1d4" class="iq ir lj is b it iu iv iw ix iy iz ja ln jc jd je lo jg jh ji lp jk jl jm jn hb bi translated"><em class="hi">这里我们有一个问题，所以问题是，如果锚定框可能有错误的形状或纵横比呢？</em></p></blockquote><p id="fe52" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，这个问题的解决方案是，我们使用“k”个不同的锚框，它们在图像的每个点上具有不同的形状和不同的纵横比。因此，尺度、大小、锚框数量是对象检测的超参数。</p><p id="3fb9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">基本上，更快的RCNN是两个阶段的过程:</p><p id="4bbb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第一阶段:物体探测器由</strong>组成</p><p id="7ff9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lj">骨干网</em></p><p id="7f8e" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lj">地区提案网</em></p><p id="3d8c" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">第二阶段:每个区域运行一次，我们，</strong></p><p id="0e26" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lj">作物特征→利益汇集区域</em></p><p id="d8cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lj">预测对象类</em></p><p id="cdb5" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><em class="lj">预测包围盒偏移量</em></p><p id="bfae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，问题来了，我们真的需要第二阶段吗？</p><p id="6a86" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">看起来，我们实际上可以只使用第一级，而让这个第一级做所有的事情。这将稍微简化系统，使它更快，因为我们不必在每个区域运行这些单独计算。</p><p id="5159" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">因此，有一种用于对象检测的方法，称为<strong class="is hj">单级对象检测器</strong>，在Fast-RCNN的情况下，它基本上看起来像区域提议网络(RPN ),而不是将锚盒分类为对象或非对象，而是它将对对象的类别做出完全的分类决定。</p><p id="b3e9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这为我们提供了两个单级检测器，</p><ol class=""><li id="e7d4" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn la ju jv jw bi translated">YOLO(你只看一眼)</li><li id="f0d8" class="jo jp hi is b it lb ix lc jb ld jf le jj lf jn la ju jv jw bi translated">单发多盒探测器</li></ol><p id="f596" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> <em class="lj">我们将在下一篇文章中看到</em> </strong> <a class="ae mk" rel="noopener" href="/analytics-vidhya/understanding-yolo-and-implementing-yolov3-for-object-detection-5f1f748cc63a"> <strong class="is hj"> <em class="lj"> YOLO及其实现</em> </strong> </a> <strong class="is hj"> <em class="lj">。</em>T25】</strong></p><div class="my mz ez fb na nb"><a rel="noopener follow" target="_blank" href="/analytics-vidhya/understanding-yolo-and-implementing-yolov3-for-object-detection-5f1f748cc63a"><div class="nc ab dw"><div class="nd ab ne cl cj nf"><h2 class="bd hj fi z dy ng ea eb nh ed ef hh bi translated">YOLO为对象检测，架构解释！</h2><div class="ni l"><h3 class="bd b fi z dy ng ea eb nh ed ef dx translated">在前一篇文章“使用RCNN家族模型的对象检测简介”中，我们看到了RCNN家族模型…</h3></div><div class="nj l"><p class="bd b fp z dy ng ea eb nh ed ef dx translated">medium.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np io nb"/></div></div></a></div><h1 id="c949" class="jx jy hi bd jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku bi translated">摘要</h1><p id="175d" class="pw-post-body-paragraph iq ir hi is b it kv iv iw ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn hb bi translated">在这篇文章中，您发现了对对象检测问题的温和介绍，以及旨在解决该问题的最先进的深度学习模型。</p><p id="50ae" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">具体来说，您学到了:</p><ul class=""><li id="1b7f" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated">你学习了图像分类、目标定位和目标检测之间的基本区别</li><li id="c813" class="jo jp hi is b it lb ix lc jb ld jf le jj lf jn jt ju jv jw bi translated">你学习了基于区域的卷积神经网络(R-CNNs ),这是一系列用于处理对象检测任务的技术，旨在提高模型性能。</li></ul><h2 id="5b7d" class="lv jy hi bd jz lw lx ly kd lz ma mb kh jb mc md kl jf me mf kp jj mg mh kt mi bi translated">参考资料:</h2><p id="0f70" class="pw-post-body-paragraph iq ir hi is b it kv iv iw ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn hb bi translated">R-CNN家庭报纸</p><ul class=""><li id="871e" class="jo jp hi is b it iu ix iy jb jq jf jr jj js jn jt ju jv jw bi translated"><a class="ae mk" href="https://arxiv.org/abs/1311.2524" rel="noopener ugc nofollow" target="_blank">用于精确对象检测和语义分割的丰富特征层次</a>，2013年。</li><li id="9eb5" class="jo jp hi is b it lb ix lc jb ld jf le jj lf jn jt ju jv jw bi translated"><a class="ae mk" href="https://arxiv.org/abs/1406.4729" rel="noopener ugc nofollow" target="_blank">视觉识别深度卷积网络中的空间金字塔池</a>，2014。</li><li id="fb96" class="jo jp hi is b it lb ix lc jb ld jf le jj lf jn jt ju jv jw bi translated"><a class="ae mk" href="https://arxiv.org/abs/1504.08083" rel="noopener ugc nofollow" target="_blank">快速R-CNN </a>，2015。</li><li id="d6eb" class="jo jp hi is b it lb ix lc jb ld jf le jj lf jn jt ju jv jw bi translated"><a class="ae mk" href="https://arxiv.org/abs/1506.01497" rel="noopener ugc nofollow" target="_blank">更快的R-CNN:利用区域提议网络实现实时对象检测</a>，2016。</li><li id="b422" class="jo jp hi is b it lb ix lc jb ld jf le jj lf jn jt ju jv jw bi translated"><a class="ae mk" href="https://deepsense.ai/region-of-interest-pooling-explained/" rel="noopener ugc nofollow" target="_blank">投资回报池</a></li><li id="62c7" class="jo jp hi is b it lb ix lc jb ld jf le jj lf jn jt ju jv jw bi translated">Andrew NG的YouTube视频</li></ul></div></div>    
</body>
</html>