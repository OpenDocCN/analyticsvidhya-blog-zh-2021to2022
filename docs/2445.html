<html>
<head>
<title>Solve Machine Learning Problems: Regression &amp; Model Selection(Part -7)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解决机器学习问题:回归和模型选择(第七部分)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/solve-machine-learning-problem-regression-model-selection-part-7-4b58bd65c6d8?source=collection_archive---------5-----------------------#2021-04-24">https://medium.com/analytics-vidhya/solve-machine-learning-problem-regression-model-selection-part-7-4b58bd65c6d8?source=collection_archive---------5-----------------------#2021-04-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/4194a48693d88123fcc658985e4f74ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7z1pjJWeStg0DH-GaGzGQw.png"/></div></div></figure><h1 id="c580" class="ip iq hh bd ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm bi translated">介绍</h1><p id="4aad" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">在前面的部分中，我们已经讨论了数据预处理、EDA、特征选择和清理。现在，我们将讨论模型选择，在此之前，我们需要了解一些更多的信息和指标。</p><h2 id="7dec" class="kl iq hh bd ir km kn ko iv kp kq kr iz jy ks kt jd kc ku kv jh kg kw kx jl ky bi translated">均方误差(mean square error)</h2><p id="c711" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">均方误差表示数据集中原始值和预测值之间的平方差的平均值。它测量残差的方差。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es kz"><img src="../Images/df7194ca093e82d671dc2230c415c3da.png" data-original-src="https://miro.medium.com/v2/resize:fit:574/format:webp/1*RDvhOeg8xoO5uLsQvNry-w.png"/></div></figure><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es le"><img src="../Images/1bed4f91c28f4eb92238438cf089c24b.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*dYLJxcA12RxKhVj0VCxErw.png"/></div></figure><h2 id="a7f9" class="kl iq hh bd ir km kn ko iv kp kq kr iz jy ks kt jd kc ku kv jh kg kw kx jl ky bi translated">均方根误差</h2><p id="6cc6" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">均方根误差是均方误差的平方根。它测量残差的标准偏差。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es lf"><img src="../Images/c29a050c137321d44886f0f33f199aa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*BNZ09d18A9RMszY9BQDpsQ.png"/></div></figure><h2 id="b096" class="kl iq hh bd ir km kn ko iv kp kq kr iz jy ks kt jd kc ku kv jh kg kw kx jl ky bi translated">R2</h2><p id="36ac" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">决定系数或R平方<strong class="jp hi"> </strong>表示线性回归模型所解释的因变量中方差的比例。这是一个无标度分数，即无论数值大小，R平方的值都小于1。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es lg"><img src="../Images/ae29c2b56dd2dfbdc6e30dd5979e5d2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*YTbsiTAzsq9W2UU7HxbL0A.png"/></div></figure><h2 id="b954" class="kl iq hh bd ir km kn ko iv kp kq kr iz jy ks kt jd kc ku kv jh kg kw kx jl ky bi translated">平均绝对误差</h2><p id="a561" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">平均绝对误差表示数据集中实际值和预测值之间绝对差值的平均值。它测量数据集中残差的平均值。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es lh"><img src="../Images/63398fdd418f0a6e7f170b5f60052948.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*pvRIz9K-UtPMatZsfx2Cvg.png"/></div></figure><h2 id="e248" class="kl iq hh bd ir km kn ko iv kp kq kr iz jy ks kt jd kc ku kv jh kg kw kx jl ky bi translated">k倍</h2><p id="bff3" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">提供训练索引以将数据分成训练测试集。将数据集分割成k个连续的折叠。然后，每个折叠被用作一次验证集，而k-1个剩余折叠来自训练集。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es li"><img src="../Images/e59c08b9d3f481d5bf5c5512ea79276e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*Do0pU805V7Fr_CSy_jnteQ.png"/></div></figure><p id="bcc7" class="pw-post-body-paragraph jn jo hh jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ha bi translated"><strong class="jp hi"> K </strong>表示细分数<em class="lo">(相等)</em>。<br/> <strong class="jp hi">折</strong>表示每个k的每个块。</p><p id="94d7" class="pw-post-body-paragraph jn jo hh jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ha bi translated">首先，我们需要导入所需的库，然后导入数据集，然后执行EDA来了解数据。接下来清理数据，然后进行数据预处理，然后对数据进行特征选择和降维技术，使数据准备好使用K-fold。<br/>以上信息和技巧在我之前的部分。现在我们将进行K折叠。</p><h2 id="fd72" class="kl iq hh bd ir km kn ko iv kp kq kr iz jy ks kt jd kc ku kv jh kg kw kx jl ky bi translated">线性回归</h2><p id="7963" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">线性回归可能是统计学和机器学习中最著名和最容易理解的算法之一。线性回归是线性模型，例如，假设输入变量(x)和单个输出变量(y)之间的线性关系的模型。更具体地说，y可以从输入变量(x)的线性组合中计算出来。</p><p id="5d83" class="pw-post-body-paragraph jn jo hh jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ha bi translated">当只有一个输入变量(x)时，该方法被称为简单线性回归。当有多个输入变量时，统计学文献通常将该方法称为多元线性回归。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es lp"><img src="../Images/8bc0514e98c561ee7e5cc32ffca05da0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*A5EZ1i_-b_vrN5BrRh8KBA.png"/></div></figure><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lq"><img src="../Images/d38f703a2f56b8421666267a55342365.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AO18X9QV3KqUsR6TvaOc9w.png"/></div></div></figure><h2 id="591b" class="kl iq hh bd ir km kn ko iv kp kq kr iz jy ks kt jd kc ku kv jh kg kw kx jl ky bi translated">里脊回归</h2><p id="586e" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">岭回归<em class="lo"> </em>是线性回归的正则化版本:正则化项<em class="lo"> </em>被添加到成本函数中。这迫使学习算法不仅要适应数据，还要保持模型权重尽可能小。请注意，正则化项应该仅在训练期间添加到成本函数中。模型定型后，您希望使用未规范化的性能度量来评估模型的性能。</p><p id="abe9" class="pw-post-body-paragraph jn jo hh jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ha bi translated">超参数<em class="lo"> α </em>控制你想要正则化模型的程度。如果<em class="lo"> α </em> = 0，那么岭回归就是线性回归。如果<em class="lo"> α </em>非常大，那么所有的权重都非常接近于零，结果是一条平坦的线。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es lr"><img src="../Images/fb85d7029cf91500fa3d46a682a10d5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*XyLFD1_oIFM3a2g4x9EwOw.png"/></div></figure><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es ls"><img src="../Images/4c561a30a00935f1acf9a55c9f28e3a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*7ooHonQzd93REfeT1Y2E6Q.png"/></div></figure><h2 id="298e" class="kl iq hh bd ir km kn ko iv kp kq kr iz jy ks kt jd kc ku kv jh kg kw kx jl ky bi translated"><strong class="ak">套索回归</strong></h2><p id="30e7" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">最小绝对收缩和选择算子回归(简称Lasso回归)是线性回归的另一个正则化版本:就像岭回归一样，它在成本函数中添加了一个正则化项，但它使用权重向量的l1范数，而不是l2范数的一半平方。</p><p id="8983" class="pw-post-body-paragraph jn jo hh jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ha bi translated">Lasso回归的一个重要特征是，它倾向于完全消除最不重要的要素的权重(将其设置为零)。Lasso回归自动执行特征选择并输出一个稀疏模型<em class="lo"> </em>(具有很少的非零特征权重)。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es lt"><img src="../Images/39c503079a000c2e1a1a3fcf0bf0719a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*YCOvoVS4_2Z5viPe6x5hHg.png"/></div></figure><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es lu"><img src="../Images/0f4d4b559cd440bf0baa17c93a863af9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*Ev97f3dh_0AqJ_7--fSxDQ.png"/></div></figure><h2 id="cd52" class="kl iq hh bd ir km kn ko iv kp kq kr iz jy ks kt jd kc ku kv jh kg kw kx jl ky bi translated">支持向量机回归</h2><p id="8825" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">SVM算法非常通用:它不仅支持线性和非线性分类，还支持线性和非线性回归。诀窍是颠倒目标:SVM回归不是试图在两个类之间拟合最大可能的街道，同时限制边界违规，而是试图在街道上T11拟合尽可能多的实例，同时限制边界违规。它由超参数<em class="lo"> ε </em>控制。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es lv"><img src="../Images/3ef8c378e26f6e4781710078c1e046ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*SI7Mxg0yegKuPatvotnHAQ.png"/></div></figure><h2 id="cdf8" class="kl iq hh bd ir km kn ko iv kp kq kr iz jy ks kt jd kc ku kv jh kg kw kx jl ky bi translated"><strong class="ak">决策树</strong></h2><p id="841a" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">在回归树中，使用每个独立变量将回归模型拟合到目标变量。在此之后，对于每个独立变量，数据被分割成几个点。在每个这样的点，预测值和实际值之间的误差被平方，以获得“误差平方和”(SSE)。SSE跨变量进行比较，具有最低SSE的变量或点被选为分割点。这个过程递归地继续。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es lw"><img src="../Images/d2242e0092c5a669d9e00557329aa7df.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*d8JYTRmU5JfDEGe3ehqpsQ.png"/></div></figure><p id="86c8" class="pw-post-body-paragraph jn jo hh jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ha bi translated">在剪枝中，策略是首先分裂成许多区域，以便我们获得一棵非常大的树，让我们说To (T not ),然后剪枝它以获得具有最小错误率的更小的子树。这种通过减少错误进行修剪的过程称为成本复杂性修剪。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es lx"><img src="../Images/155e73d76716f9698cad225b8207a870.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*bn8fhPgKETpiBsyB3r1ctQ.png"/></div></figure><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es ly"><img src="../Images/28f188bc31b2a5f52597eacd35894505.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*65hyfoH9n7pSi-5SVvToqg.png"/></div></figure><h2 id="663c" class="kl iq hh bd ir km kn ko iv kp kq kr iz jy ks kt jd kc ku kv jh kg kw kx jl ky bi translated">随机森林</h2><p id="9079" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">随机森林是一种集成技术，能够通过使用多个决策树和一种称为Bootstrap and Aggregation(通常称为bagging)的技术来执行回归和分类任务。这背后的基本思想是在确定最终输出时结合多个决策树，而不是依赖单个决策树。<br/>随机森林有多个决策树作为基础学习模型。我们从数据集随机执行行采样和特征采样，为每个模型形成样本数据集。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es lz"><img src="../Images/6865d8c9522f6d2ef1e4444dd8983d50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*O4cbDOZcGjNCyODHMtRrLw.png"/></div></figure><h2 id="5081" class="kl iq hh bd ir km kn ko iv kp kq kr iz jy ks kt jd kc ku kv jh kg kw kx jl ky bi translated">XGB极限梯度提升</h2><p id="010e" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">XGBoost是构建监督回归模型的强大方法。通过了解它的(XGBoost)目标函数和基础学习者，可以推断出这种说法的正确性。目标函数包含损失函数和正则项。它说明了实际值和预测值之间的差异，即模型结果与实际值的差距。XGBoost中回归问题最常见的损失函数是线性的。</p><p id="9650" class="pw-post-body-paragraph jn jo hh jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ha bi translated">集成学习涉及训练和组合单个模型(称为基础学习器)以获得单个预测，XGBoost是集成学习方法之一。XGBoost期望基础学习器在剩余部分都是差的，这样当所有的预测被组合时，差的预测被抵消，而更好的预测被累加以形成最终的好预测。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es ma"><img src="../Images/a11690465c0d5f5926f873b9b6630dc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*bwCnIuBiwpxzVwgpKWPCDQ.png"/></div></figure><h2 id="f58e" class="kl iq hh bd ir km kn ko iv kp kq kr iz jy ks kt jd kc ku kv jh kg kw kx jl ky bi translated">堆积回归</h2><p id="bd35" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">它基于一个简单的想法:与其使用琐碎的函数(如硬投票)来聚合集合中所有预测者的预测，为什么我们不训练一个模型来执行这种聚合，这样的集合在新的实例上执行回归任务。底部三个预测器中的每一个预测不同的值，然后最终的预测器(称为混合器，或元学习器)将这些预测作为输入，并进行最终预测。</p><p id="7c1f" class="pw-post-body-paragraph jn jo hh jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ha bi translated">为了训练搅拌机，一个常见的方法是使用一套坚持。让我们看看它是如何工作的。首先，将训练集分成两个子集。第一子集用于训练第一层中的预测器。接下来，第一层预测器用于对第二(保留)集进行预测。这确保了预测是“干净的”，因为预测者在训练期间从未见过这些情况。现在，对于拒绝集合中的每个实例，有三个预测值。我们可以使用这些预测值作为输入特征来创建新的训练集，并保持目标值。blender在这个新的训练集上被训练，因此它学习在给定第一层的预测的情况下预测目标值。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mb"><img src="../Images/d04614d6f4f5d538a0161bebabbe2da8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OO6hf8YYB8YGpJC70kE6nw.png"/></div></div></figure><h2 id="2fa5" class="kl iq hh bd ir km kn ko iv kp kq kr iz jy ks kt jd kc ku kv jh kg kw kx jl ky bi translated">KNN</h2><p id="77c3" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">k-最近邻(KNN)算法是一种监督最大似然算法，可用于分类以及回归预测问题。但在工业上主要用于分类预测问题。KNN是一种懒惰学习算法和非参数学习算法。</p><p id="5688" class="pw-post-body-paragraph jn jo hh jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ha bi translated">k-最近邻(KNN)算法使用“特征相似性”来预测新数据点的值，这进一步意味着新数据点将根据其与训练集中的点的匹配程度来分配值。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div class="er es mc"><img src="../Images/7c37e107bb904671a73c722e4198dbe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*CKo5la3qqdmbfPyg2jlNhQ.png"/></div></figure><p id="477e" class="pw-post-body-paragraph jn jo hh jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ha bi translated"><strong class="jp hi">比较所有算法的r2和RMSE值</strong></p><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es md"><img src="../Images/07f9e092b4b1643b87620586296e1fbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9m-boWq32aXTScyRaMIHVQ.png"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx translated">r2评分比较</figcaption></figure><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mi"><img src="../Images/75cbdeaaa3702cbd712f7b460c21d954.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nWPxgzpHvSCvfxUioJYBBA.png"/></div></div><figcaption class="me mf et er es mg mh bd b be z dx translated">RMSE评分比较</figcaption></figure><p id="199f" class="pw-post-body-paragraph jn jo hh jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ha bi translated">从上面的图中，我们可以看到所有具有insample和outsample的模型的r2得分和RMSE得分，其中决策树在insample上具有较高的r2得分，而在outsample上没有，因此我们不打算选择决策树模型，其中随机森林和XGBoost在in sample和out sample中都具有下降得分，但是随机森林的得分比XGBoost高。因此，我们将使用RF模型，对维持样本进行预测。</p><figure class="la lb lc ld fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mj"><img src="../Images/28c60b2522ebad6d1f334c9eb2879e29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JZ8QkwMCDghVddwkrQeD5A.png"/></div></div></figure><p id="3241" class="pw-post-body-paragraph jn jo hh jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ha bi translated">在对维持样本执行之后，随机森林的R2分数是0.95，接近于1。意味着它是一个很好的模型，表现非常好。</p><h2 id="025f" class="kl iq hh bd ir km kn ko iv kp kq kr iz jy ks kt jd kc ku kv jh kg kw kx jl ky bi translated">结论</h2><p id="f587" class="pw-post-body-paragraph jn jo hh jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ha bi translated">在本文中，随机森林回归模型是该数据集上的最佳模型。因此，如果比较不同回归模型之间的预测精度，那么RMSE是一个更好的选择，因为它计算简单且可微分。但是，如果您的数据集有异常值，则选择MAE而不是RMSE。此外，线性回归模型中预测变量的数量由R的平方决定。我希望这篇博客对你有所帮助。谢谢你的时间。</p></div></div>    
</body>
</html>