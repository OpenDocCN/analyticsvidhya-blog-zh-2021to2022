<html>
<head>
<title>Predict the Sales Volume of the Google Stock Price</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">é¢„æµ‹è°·æ­Œè‚¡ç¥¨ä»·æ ¼çš„é”€å”®é‡</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/analytics-vidhya/predict-the-sales-volume-of-the-google-stock-price-6d44da3ecb02?source=collection_archive---------20-----------------------#2021-06-20">https://medium.com/analytics-vidhya/predict-the-sales-volume-of-the-google-stock-price-6d44da3ecb02?source=collection_archive---------20-----------------------#2021-06-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/4eb99523a77fa780a0fe33d40bbdecdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6lGbruP6yrpkPmMhy9smww.jpeg"/></div></div></figure><p id="ed3f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æ•°æ®é›†:<a class="ae jn" href="https://drive.google.com/file/d/1oAQFQu9PSk0DRhEocefULy_qhzb9KHmO/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">ç‚¹å‡»</a></p><h1 id="98b6" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">å¯é‡ç°ç»“æœçš„è®¾ç½®</h1><p id="ccd3" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">è¦è·å¾—å¯é‡å¤çš„ç»“æœï¼Œæ‚¨å¿…é¡»æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼Œå¦åˆ™æ‚¨å°†è·å¾—ä¸åŒçš„ç»“æœ:</p><p id="3f54" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">1)å°†PYTHONHASHSEEDç¯å¢ƒå˜é‡è®¾ç½®ä¸ºå›ºå®šå€¼</p><p id="7ea8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">2)å°†pythonå†…ç½®çš„ä¼ªéšæœºç”Ÿæˆå™¨è®¾ç½®ä¸ºå›ºå®šå€¼</p><p id="bdaa" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">3)å°†numpyä¼ªéšæœºå‘ç”Ÿå™¨è®¾ç½®ä¸ºå›ºå®šå€¼</p><p id="c8cf" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">4)å°†å¼ é‡æµä¼ªéšæœºç”Ÿæˆå™¨è®¾ç½®ä¸ºå›ºå®šå€¼</p><p id="affc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">5)é…ç½®æ–°çš„å…¨å±€å¼ é‡æµä¼šè¯</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="2a15" class="la jp hh kw b fi lb lc l ld le"># Seed value<br/># Apparently you may use different seed values at each stage<br/>seed_value= 0</span><span id="699a" class="la jp hh kw b fi lf lc l ld le"># 1. Set the `PYTHONHASHSEED` environment variable at a fixed value<br/>import os<br/>os.environ['PYTHONHASHSEED']=str(seed_value)</span><span id="22d9" class="la jp hh kw b fi lf lc l ld le"># 2. Set the `python` built-in pseudo-random generator at a fixed value<br/>import random<br/>random.seed(seed_value)</span><span id="5fa4" class="la jp hh kw b fi lf lc l ld le"># 3. Set the `numpy` pseudo-random generator at a fixed value<br/>import numpy as np<br/>np.random.seed(seed_value)</span><span id="8f74" class="la jp hh kw b fi lf lc l ld le"># 4. Set the `tensorflow` pseudo-random generator at a fixed value<br/>import tensorflow as tf<br/>tf.random.set_seed(seed_value)</span><span id="2794" class="la jp hh kw b fi lf lc l ld le"># for latest versions:<br/># tf.compat.v1.set_random_seed(seed_value)<br/># 5. Configure a new global `tensorflow` session</span><span id="805b" class="la jp hh kw b fi lf lc l ld le">from keras import backend as K<br/>session_conf = tf.compat.v1.ConfigProto(intra_op_parallelism_threads=1, inter_op_parallelism_threads=1)<br/>sess = tf.compat.v1.Session(graph=tf.compat.v1.get_default_graph(), config=session_conf)</span><span id="99a1" class="la jp hh kw b fi lf lc l ld le">K.set_session(sess)</span></pre><p id="aa74" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é€šè¿‡éµå¾ªä¸Šè¿°ä»£ç ï¼Œæ‚¨å¯ä»¥è·å¾—å¯é‡å¤çš„ç»“æœ</p><p id="99c2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘ä»¬å¿…é¡»å¯¼å…¥ä¸€äº›åº“ã€‚å› ä¸ºå¤§å¤šæ•°pythonåº“éƒ½æœ‰ä¸€ç»„æœ‰ç”¨çš„å‡½æ•°ï¼Œå¯ä»¥ç®€å•åœ°æ¶ˆé™¤ä»å¤´ç¼–å†™ä»£ç çš„éœ€è¦ã€‚æ‰€ä»¥æˆ‘å¯¼å…¥äº†ä¸‹é¢çš„åº“</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="8c62" class="la jp hh kw b fi lb lc l ld le">import warnings<br/>warnings.filterwarnings('ignore')<br/>import os<br/>import numpy as np<br/>import pandas as pd<br/>import scipy.stats as stats<br/>from matplotlib import pyplot as plt<br/>%matplotlib inline</span><span id="dbff" class="la jp hh kw b fi lf lc l ld le">import sklearn<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.metrics import accuracy_score<br/>from sklearn import preprocessing</span></pre><p id="230c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">å®‰è£…Google Driveå¹¶åŠ è½½æ•°æ®é›†</p><p id="e871" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘å·²ç»æ·»åŠ äº†ä»¥ä¸‹ä»£ç ï¼Œç”¨äºå°†google driveå¸æˆ·å®‰è£…åˆ°google colaboratoryï¼Œä»¥è®¿é—®driveä¸Šå¯ç”¨çš„æ–‡ä»¶ã€‚å½“æˆ‘ä»¬æ‰§è¡Œä¸‹é¢çš„ä»£ç æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»è½¬åˆ°ç”Ÿæˆçš„URLï¼Œå¹¶è·å¾—æˆæƒä»£ç æ‰èƒ½è¿›å…¥è¿™é‡Œã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="4711" class="la jp hh kw b fi lb lc l ld le">from google.colab import drive<br/>drive.mount('/content/drive')</span></pre><p id="55fe" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">è¾“å…¥æˆæƒç åã€‚æ‚¨å°†æ”¶åˆ°ä¸€æ¡æ¶ˆæ¯ï¼Œæ˜¾ç¤ºâ€œå®‰è£…åœ¨<a class="ae jn" href="https://colab.research.google.com/drive/1LPOegMGgG8ubnJmQ9oSG1AmXIYhSzPJd?authuser=1#" rel="noopener ugc nofollow" target="_blank">/å†…å®¹/é©±åŠ¨å™¨</a>â€ã€‚æ­¤åï¼Œé€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œæ‚¨å¯ä»¥è®¿é—®æ‚¨è¿æ¥çš„google driveä¸Šçš„æ–‡ä»¶ã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="87ef" class="la jp hh kw b fi lb lc l ld le">import pandas as pd</span><span id="da6b" class="la jp hh kw b fi lf lc l ld le">df = pd.read_csv('/content/drive/My Drive/Colab Notebooks/data/Google_Stock_Price.csv')</span></pre><p id="bf66" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°è¯¥å˜é‡ä¸­å­˜å‚¨çš„å‰10ä¸ªæ•°æ®è¡Œã€‚Pandas libaryæä¾›äº†ä¸€ä¸ªåä¸ºhead()çš„æ–¹æ³•ï¼Œå¹¿æ³›ç”¨äºè¿”å›æ•°æ®å¸§æˆ–æ•°æ®ç³»åˆ—çš„å‰nè¡Œã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥æ–¹æ³•è¿”å›å­˜å‚¨æ•°æ®é›†çš„å‰5è¡Œã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="0be6" class="la jp hh kw b fi lb lc l ld le">df.head(10)</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div class="er es lg"><img src="../Images/4bfab18e225e54cd9cc5f931ddecc028.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*f3ZF2CL5jJCJt79qg4e_Dg.png"/></div></figure><p id="d334" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥æ•°æ®é›†ä¸Šå¯ç”¨çš„è®°å½•æ•°</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="6037" class="la jp hh kw b fi lb lc l ld le">len(df)</span></pre><p id="f085" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">1258æ˜¯ä¸Šè¿°ä»£ç çš„è¾“å‡ºã€‚æ•°æ®é›†ä¸Šæœ‰1258æ¡å¯ç”¨è®°å½•ã€‚</p><h1 id="523f" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">æ­¥éª¤01 â€”æ•°æ®é¢„å¤„ç†</h1><p id="3dfd" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">æ•°æ®é¢„å¤„ç†æ˜¯ä¸€ä¸ªä¸»è¦æ­¥éª¤ï¼Œå› ä¸ºä»æ•°æ®é›†ä¸­æå–çš„æœ‰ç”¨ä¿¡æ¯ç›´æ¥å½±å“åˆ°æ¨¡å‹çš„è´¨é‡ï¼Œæ‰€ä»¥åœ¨å°†æ•°æ®è¾“å…¥æ¨¡å‹ä¹‹å‰ï¼Œè‡³å°‘å¯¹æ•°æ®è¿›è¡Œå¿…è¦çš„é¢„å¤„ç†æ˜¯éå¸¸é‡è¦çš„ã€‚</p><h2 id="5093" class="la jp hh bd jq lh li lj ju lk ll lm jy ja ln lo kc je lp lq kg ji lr ls kk lt bi translated">æ­¥éª¤01 A-å¤„ç†ç¼ºå¤±å€¼å’Œå¼‚å¸¸å€¼</h2><blockquote class="lu lv lw"><p id="5e2d" class="ip iq lx ir b is it iu iv iw ix iy iz ly jb jc jd lz jf jg jh ma jj jk jl jm ha bi translated">æ­¥éª¤01 A â€”å¤„ç†ç¼ºå¤±å€¼</p></blockquote><p id="4cfc" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥æ•°æ®é›†ä¸­ç¼ºå¤±çš„å€¼ã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="6eb8" class="la jp hh kw b fi lb lc l ld le">df.isnull().any()</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div class="er es mb"><img src="../Images/14941cc29b901be2c7a03414f3718b27.png" data-original-src="https://miro.medium.com/v2/resize:fit:378/format:webp/1*1TulDTkoh2ZL0SPblFmB7g.png"/></div></figure><p id="9c43" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ä»ä¸Šé¢çš„è¾“å‡ºæˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼Œæˆ‘ä»¬åœ¨æ•°æ®é›†ä¸­æ²¡æœ‰ä»»ä½•ä¸¢å¤±çš„å€¼ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥ã€‚</p><blockquote class="lu lv lw"><p id="7ce1" class="ip iq lx ir b is it iu iv iw ix iy iz ly jb jc jd lz jf jg jh ma jj jk jl jm ha bi translated">æ­¥éª¤01 B â€”å¤„ç†é‡å¤å€¼</p></blockquote><p id="4e1c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥æ•°æ®é›†ä¸­çš„é‡å¤è¡Œã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="34b2" class="la jp hh kw b fi lb lc l ld le">print(df.duplicated().value_counts()) # To check duplicated values</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div class="er es mc"><img src="../Images/416abd9b182bc4ad8d80b8e643b106c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:376/format:webp/1*ClEH0ZYRtwIJNjmFdnqEGQ.png"/></div></figure><p id="be62" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ä»ä¸Šé¢çš„è¾“å‡ºæˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼Œæ•°æ®é›†ä¸­æ²¡æœ‰é‡å¤çš„è¡Œ</p><blockquote class="lu lv lw"><p id="964f" class="ip iq lx ir b is it iu iv iw ix iy iz ly jb jc jd lz jf jg jh ma jj jk jl jm ha bi translated">æ­¥éª¤01c-å¤„ç†å¼‚å¸¸å€¼</p></blockquote><p id="5030" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">a)æ£€æŸ¥åˆ—åâ€œOpenâ€ä¸Šçš„å¼‚å¸¸å€¼</p><p id="7c37" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">å¼€ç›˜ä»·æ˜¯äº¤æ˜“æ‰€å½“å¤©å¼€å¸‚æ—¶è¯åˆ¸é¦–æ¬¡äº¤æ˜“çš„ä»·æ ¼ã€‚å¼€ç›˜ä»·ä¸åŒäºå‰ä¸€å¤©çš„æ”¶ç›˜ä»·ã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="5695" class="la jp hh kw b fi lb lc l ld le">plt.rcParams["figure.figsize"] = (24, 3)<br/>temp_df = pd.DataFrame(df, columns=['Open'])temp_df.boxplot(vert=False)</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es md"><img src="../Images/148a6c76058a6fa36561ddd778afeaa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9tyXl5WjWCJl-8w0Ylpqcw.png"/></div></div></figure><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="cd2d" class="la jp hh kw b fi lb lc l ld le">from matplotlib import pyplot<br/>plt.rcParams["figure.figsize"] = (24, 8)<br/>plt.plot(df['Open'])<br/>plt.title("Google Stock Open Price Changes")<br/>plt.xlabel("Time")<br/>plt.ylabel("Open Price")<br/>plt.show()</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es me"><img src="../Images/5af5a560da9c1d33f4cde6dc293064f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tQBrOpRbn1XfAbEOyYiipA.png"/></div></div></figure><p id="48cf" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é€šè¿‡æŸ¥çœ‹ä¸Šé¢çš„è¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥è¯´åœ¨ç‰¹æ€§æ–¹é¢æ²¡æœ‰å¤ªå¤§çš„é—®é¢˜ï¼Œ</p><p id="5cbe" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">b)æ£€æŸ¥åˆ—åâ€œé«˜â€ä¸Šçš„å¼‚å¸¸å€¼</p><p id="93dd" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é«˜ç‚¹æ˜¯ä¸€æ®µæ—¶é—´å†…è‚¡ç¥¨äº¤æ˜“çš„æœ€é«˜ä»·æ ¼ã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="e94c" class="la jp hh kw b fi lb lc l ld le">plt.rcParams["figure.figsize"] = (24, 3)<br/>temp_df = pd.DataFrame(df, columns=['High'])<br/>temp_df.boxplot(vert=False)</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mf"><img src="../Images/2474aea6f92b73886174e5d941df622c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T7aeV9otMZBW84B_Sf7Tew.png"/></div></div></figure><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="e851" class="la jp hh kw b fi lb lc l ld le">plt.rcParams["figure.figsize"] = (24, 8)<br/>plt.plot(df['High'])<br/>plt.title("Google Stock High Price Changes")<br/>plt.xlabel("Time")<br/>plt.ylabel("High Price")<br/>plt.show()</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es me"><img src="../Images/b38d42bb17819c19c362d1cc552a830f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GLQ3bY3t6mGzGQIhcFnLNQ.png"/></div></div></figure><p id="4730" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é€šè¿‡æŸ¥çœ‹ä¸Šé¢çš„è¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥è¯´åœ¨ç‰¹æ€§æ–¹é¢æ²¡æœ‰å¤ªå¤§çš„é—®é¢˜ï¼Œ</p><p id="594b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">c)æ£€æŸ¥åˆ—åâ€œä½â€ä¸Šçš„å¼‚å¸¸å€¼</p><p id="4d1c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ä½ç‚¹æ˜¯è¿™ä¸€æ—¶æœŸçš„æœ€ä½ä»·ã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="0e5f" class="la jp hh kw b fi lb lc l ld le">plt.rcParams["figure.figsize"] = (24, 3)<br/>temp_df = pd.DataFrame(df, columns=['Low'])<br/>temp_df.boxplot(vert=False)</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mg"><img src="../Images/b86d4468e69ae3a85fb94b73989b2064.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PcPhHhq2A31_ypkOg1rFzg.png"/></div></div></figure><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="fa12" class="la jp hh kw b fi lb lc l ld le">plt.rcParams["figure.figsize"] = (24, 8)<br/>plt.plot(df['Low'])<br/>plt.title("Google Stock Low Price Changes")<br/>plt.xlabel("Time")<br/>plt.ylabel("Low Price")<br/>plt.show()</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es me"><img src="../Images/fec7a25d92e8843289c0d093991b5f55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xCKXhp212JDHelVjgdRXkw.png"/></div></div></figure><p id="eed9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é€šè¿‡æŸ¥çœ‹ä¸Šé¢çš„è¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥è¯´åœ¨ç‰¹æ€§æ–¹é¢æ²¡æœ‰å¤ªå¤§çš„é—®é¢˜ï¼Œ</p><p id="1125" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">d)æ£€æŸ¥åˆ—åâ€œCloseâ€ä¸Šçš„å¼‚å¸¸å€¼</p><p id="b6c7" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æ”¶ç›˜ä»·æ˜¯ä¸€ç§è¯åˆ¸åœ¨æ­£å¸¸äº¤æ˜“æ—¥çš„æœ€åäº¤æ˜“ä»·æ ¼ã€‚è¯åˆ¸çš„æ”¶ç›˜ä»·æ˜¯æŠ•èµ„è€…ç”¨æ¥è·Ÿè¸ªå…¶é•¿æœŸè¡¨ç°çš„æ ‡å‡†åŸºå‡†ã€‚æ”¶ç›˜ä»·ä¸ä¼šåæ˜ ç°é‡‘è‚¡åˆ©ã€è‚¡ç¥¨è‚¡åˆ©æˆ–è‚¡ç¥¨åˆ†å‰²çš„å½±å“ã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="8315" class="la jp hh kw b fi lb lc l ld le">df['Close'] = df['Close'].str.replace(',','')<br/>df['Close'] = df['Close'].astype('float')<br/>plt.rcParams["figure.figsize"] = (24, 3)<br/>temp_df = pd.DataFrame(df, columns=['Close'])<br/>temp_df.boxplot(vert=False)</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es md"><img src="../Images/d75745d3bfedb067b2e85917762ae35c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MpsijQxOkERMAB1EORGX3g.png"/></div></div></figure><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="3e30" class="la jp hh kw b fi lb lc l ld le">plt.rcParams["figure.figsize"] = (24, 8)<br/>plt.title("Google Stock Close Price Changes")<br/>plt.xlabel("Time")<br/>plt.ylabel("Close Price")<br/>plt.plot(df['Close'])<br/>plt.show()</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mh"><img src="../Images/e10534d895e05f4b8c86e2d1bf89c354.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wq9G65XnxjIQw2GlpZ-EKA.png"/></div></div></figure><p id="c768" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é€šè¿‡æŸ¥çœ‹ä¸Šé¢çš„è¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥è¯´åœ¨åŠŸèƒ½ä¸Šæœ‰ç›¸å½“å¤šçš„é—®é¢˜ï¼Œ</p><p id="660f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æ‰€ä»¥æˆ‘æ£€æŸ¥äº†ä»¥ä¸‹æƒ…å†µ:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="a95d" class="la jp hh kw b fi lb lc l ld le">df[ df['High']&lt; df['Close']]</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div class="er es mi"><img src="../Images/880b7bfaf79a914bf1ec7781e1c4efdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*UNyx5gFRv7jxtJD0l-J3GA.png"/></div></figure><p id="4a10" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘å·²ç»æ”¾å¼ƒäº†æ”¶ç›˜ä»·å€¼ï¼Œå› ä¸ºè¿™äº›ä»·å€¼ä¸­çš„å¤§å¤šæ•°éƒ½å¤§äºé«˜ä»·æ ¼ä»·å€¼ï¼Œæ‰€ä»¥å®é™…ä¸Šä¸å¯èƒ½åƒé‚£æ ·ã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="4c3a" class="la jp hh kw b fi lb lc l ld le">df = df.drop(â€˜Closeâ€™, axis = 1)</span></pre><p id="4165" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">e)æ£€æŸ¥åˆ—åâ€œVolumeâ€ä¸Šçš„å¼‚å¸¸å€¼</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="f2fd" class="la jp hh kw b fi lb lc l ld le">plt.rcParams["figure.figsize"] = (24, 3)<br/>df['Volume'] = df['Volume'].str.replace(',','')<br/>df['Volume'] = df['Volume'].astype('float')<br/>temp_df = pd.DataFrame(df, columns=['Volume'])<br/>temp_df.boxplot(vert=False)</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mj"><img src="../Images/ae9fc8281723beeb73c12c749befd96b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NxsYYQdvmMQp1wn1qPT1KQ.png"/></div></div></figure><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="da62" class="la jp hh kw b fi lb lc l ld le">plt.rcParams["figure.figsize"] = (24, 8)<br/>plt.title("Google Stock Volume Changes")<br/>plt.xlabel("Time")<br/>plt.ylabel("Volume")<br/>plt.plot(df['Volume'])<br/>plt.show()</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mk"><img src="../Images/c61f9489ef370b47f2ea4a4d28b0e0ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A1VRKDnJcu3WrxbTTo3xow.png"/></div></div></figure><p id="e5e0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é€šè¿‡æŸ¥çœ‹ä¸Šé¢çš„è¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥è¯´åœ¨åŠŸèƒ½ä¸Šæ²¡æœ‰å¤ªå¤§çš„é—®é¢˜</p><h1 id="da6d" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">æ­¥éª¤02 â€”ç‰¹å¾ç¼–ç </h1><p id="da2a" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">äººå·¥ç¥ç»ç½‘ç»œæ¨¡å‹è¦æ±‚æ‰€æœ‰çš„è¾“å…¥å’Œè¾“å‡ºå€¼éƒ½åº”è¯¥æ˜¯æ•°å€¼ã€‚å› æ­¤ï¼Œå¦‚æœæ•°æ®é›†åŒ…å«åˆ†ç±»æ•°æ®ï¼Œæ‚¨å¿…é¡»åœ¨æ‹Ÿåˆå’Œè¯„ä¼°æ¨¡å‹ä¹‹å‰å°†å…¶ç¼–ç ä¸ºæ•°å­—ã€‚æœ‰å‡ ç§æ–¹æ³•å¯ä»¥å®Œæˆè¿™é¡¹ä»»åŠ¡ï¼Œå¦‚ä¸€é”®ç¼–ç ã€æ•´æ•°(æ ‡ç­¾)ç¼–ç ã€‚è¿™é‡Œæˆ‘ä½¿ç”¨äº†ä¸€é”®ç¼–ç </p><h2 id="31f5" class="la jp hh bd jq lh li lj ju lk ll lm jy ja ln lo kc je lp lq kg ji lr ls kk lt bi translated">ä»€ä¹ˆæ˜¯å‘¨æœ«æ•ˆåº”ï¼Ÿ</h2><p id="c9ef" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">å‘¨æœ«æ•ˆåº”æ˜¯é‡‘èå¸‚åœºä¸­çš„ä¸€ç§ç°è±¡ï¼Œåœ¨è¿™ç§å¸‚åœºä¸­ï¼Œå‘¨ä¸€çš„è‚¡ç¥¨å›æŠ¥ç‡å¾€å¾€æ˜¾è‘—ä½äºå‰ä¸€ä¸ªå‘¨äº”çš„å›æŠ¥ç‡ã€‚å‘¨æœ«æ•ˆåº”ä¹Ÿè¢«ç§°ä¸ºå‘¨ä¸€æ•ˆåº”ã€‚</p><h2 id="7578" class="la jp hh bd jq lh li lj ju lk ll lm jy ja ln lo kc je lp lq kg ji lr ls kk lt bi translated">ä»€ä¹ˆæ˜¯æœˆæœ«æ•ˆåº”ï¼Ÿ</h2><p id="adf5" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">â€œæœˆæœ«æ•ˆåº”â€ä¸€ç›´æ˜¯è®¸å¤šç§‘å­¦ç ”ç©¶çš„ä¸»é¢˜ã€‚ç»Ÿè®¡æ•°æ®æ˜¾ç¤ºï¼Œè‚¡ç¥¨ä»·æ ¼ï¼Œå°¤å…¶æ˜¯ç¾å›½è‚¡ç¥¨ä»·æ ¼ï¼Œå¾€å¾€ä¼šåœ¨è¿™ä¸ªæœˆçš„æœ€åå‡ å¤©å’Œå¤´å‡ å¤©ä¸Šæ¶¨ã€‚</p><h2 id="4a3c" class="la jp hh bd jq lh li lj ju lk ll lm jy ja ln lo kc je lp lq kg ji lr ls kk lt bi translated">ä¹°è‚¡ç¥¨æœ€å¥½çš„æœˆä»½æ˜¯å“ªä¸ªæœˆï¼Ÿ</h2><p id="6082" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">åœ¨å²æœ«å¹´åˆä»¥åŠå¤å­£ï¼Œå¸‚åœºå¾€å¾€ä¼šæœ‰å¼ºåŠ²çš„å›æŠ¥ã€‚ä¹æœˆä¼ ç»Ÿä¸Šæ˜¯ä¸€ä¸ªæ·¡å­£ã€‚å°½ç®¡1929å¹´å’Œ1987å¹´åˆ†åˆ«ä¸‹è·Œäº†19.7%å’Œ21.5%ï¼Œä½†10æœˆä»½çš„å¹³å‡å›æŠ¥ç‡ä»å†å²ä¸Šçœ‹æ˜¯æ­£çš„ã€‚</p><p id="eff5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">è€ƒè™‘åˆ°ä¸Šé¢çš„å®è·µï¼Œæˆ‘å¢åŠ äº†ä¸€ä¸ªé¢å¤–çš„åˆ—â€œæ—¥-å‘¨â€æ¥æ˜¾ç¤ºä¸€å‘¨ä¸­çš„å“ªä¸€å¤©ã€‚ä½™å³å¾å¾—æœˆï¼Œæ—¥ä¹Ÿã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="8b34" class="la jp hh kw b fi lb lc l ld le">df['Date'] = pd.to_datetime(df['Date'])<br/>df['Day_week'] = df['Date'].dt.day_name()</span><span id="3abd" class="la jp hh kw b fi lf lc l ld le">#df['Year'] = pd.DatetimeIndex(df['Date']).year<br/>df['Month'] = pd.DatetimeIndex(df['Date']).month<br/>df['Day'] = pd.DatetimeIndex(df['Date']).day<br/>df = df.drop('Date', axis = 1)<br/>df.head(10)</span></pre><p id="665e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">åœ¨ä»æ•°æ®ä¸­è·å¾—ä¸€äº›é™„åŠ ç‰¹å¾ä¹‹åï¼Œ</p><figure class="kr ks kt ku fd ii er es paragraph-image"><div class="er es ml"><img src="../Images/b4beae75f6a96e35735a20b424e2d285.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*JTGGFP9EwL-WwF-c8NV-pw.png"/></div></figure><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="0a51" class="la jp hh kw b fi lb lc l ld le">month_dummies = pd.get_dummies(df[â€˜Monthâ€™],prefix=â€™Mâ€™)<br/>df=pd.concat([df, month_dummies], axis=1)</span><span id="552e" class="la jp hh kw b fi lf lc l ld le">day_dummies = pd.get_dummies(df['Day_week'],prefix='W')<br/>df=pd.concat([df, day_dummies], axis=1)</span><span id="e544" class="la jp hh kw b fi lf lc l ld le">dayNum_dummies = pd.get_dummies(df['Day'],prefix='D')<br/>df=pd.concat([df, dayNum_dummies], axis=1)</span><span id="2118" class="la jp hh kw b fi lf lc l ld le">df = df.drop('Month', axis = 1)<br/>df = df.drop('Day_week', axis = 1)<br/>df = df.drop('Day', axis = 1)</span><span id="895d" class="la jp hh kw b fi lf lc l ld le">df.head(10)</span></pre><p id="5a38" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ä¿®æ”¹æ•°æ®é›†ï¼Œ</p><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mm"><img src="../Images/420a4d60fd4c3972043c09336591e4f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dXWZZisF1QPHBaXWWon9MQ.png"/></div></div></figure><h1 id="7099" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">æ­¥éª¤03æ•°æ®è½¬æ¢</h1><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="eb57" class="la jp hh kw b fi lb lc l ld le">plt.rcParams["figure.figsize"] = (24, 12)<br/>X[['High','Low','Open']].hist()</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mn"><img src="../Images/b2380a1446abf3b7243a7f0daee8a8c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Do4eHtn32wgpbn4phLx0dQ.png"/></div></div></figure><p id="8008" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ç”±äºæœ€ç»ˆå€¼ï¼Œä¸éœ€è¦ä½“ç§¯åˆ—è½¬æ¢ã€‚</p><h1 id="172a" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">æ­¥éª¤04-ç¼©æ”¾å’Œ/æˆ–æ ‡å‡†åŒ–ç‰¹å¾</h1><p id="49ab" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">é€šè¿‡æ‰§è¡Œä»¥ä¸‹ä»£ç ï¼Œæˆ‘åˆ é™¤äº†æ•°æ®é›†ä¸­åˆ†ç±»åˆ—ï¼Œä»¥ä¾¿è¿›è¡Œç¼©æ”¾:</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="06f3" class="la jp hh kw b fi lb lc l ld le">dummies = day_dummies.columns.tolist() + month_dummies.columns.tolist()+dayNum_dummies.columns.tolist()</span><span id="b04f" class="la jp hh kw b fi lf lc l ld le">Remove_columns_values = dummies</span><span id="8e51" class="la jp hh kw b fi lf lc l ld le">X_without_Cat=X.drop(Remove_columns_values, axis = 1)<br/>X_without_Cat.head(5)</span></pre><p id="57b5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">åˆ é™¤åˆ†ç±»åˆ—åï¼Œ</p><figure class="kr ks kt ku fd ii er es paragraph-image"><div class="er es mo"><img src="../Images/1dd47de576049777c69f4d606264ddbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*mu0xLhgEkFZw545G6mCGVQ.png"/></div></figure><p id="e30f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä½¿ç”¨sklearnçš„minmax scalerç¼©æ”¾äº†è¡¨ä¸­çš„è¿ç»­å€¼</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="2bd7" class="la jp hh kw b fi lb lc l ld le">from sklearn.preprocessing import MinMaxScaler<br/>scaler = MinMaxScaler()</span><span id="e9e0" class="la jp hh kw b fi lf lc l ld le">data_training = scaler.fit_transform(X_without_Cat)<br/>data_training</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div class="er es mp"><img src="../Images/7ce5d066ea2077bf0b83ea0574e69d39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*DRBjL284NW_o9ncDvq6gFQ.png"/></div></figure><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="62f4" class="la jp hh kw b fi lb lc l ld le">columns_value_new=X_without_Cat.columns<br/>X_Scaled_Except = pd.DataFrame(data_training, columns=columns_value_new)</span><span id="e42a" class="la jp hh kw b fi lf lc l ld le">plt.rcParams[â€œfigure.figsizeâ€] = (24, 12)<br/>X_Scaled_Except.hist()</span></pre><p id="d6d8" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æ˜¾ç¤ºç¼©æ”¾/æ ‡å‡†åŒ–æ•ˆæœï¼Œ</p><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mn"><img src="../Images/09611f4d1d07f361479cbbfe1182c533.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UCUdzkV5K3JERi8dx3MpPg.png"/></div></div></figure><p id="a7a5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œæˆ‘å·²ç»åˆ†åˆ«ç¼©æ”¾äº†ä½“ç§¯åˆ—ï¼Œç”¨äºæ¨¡å‹è¾“å‡ºçš„é€†å˜æ¢ï¼Œ</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="93de" class="la jp hh kw b fi lb lc l ld le">scalerVol= MinMaxScaler()<br/>data_trainingVol= scalerVol.fit_transform(X_without_Cat.iloc[:,3:4])<br/>data_trainingVol</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mq"><img src="../Images/2161bf9e54525e5235389b6698d5d308.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*3nzSV4nqdTYbnLLIOs-7CA.png"/></div></div></figure><h1 id="f85c" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">æ­¥éª¤05ç›¸å…³çŸ©é˜µ</h1><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="5ba2" class="la jp hh kw b fi lb lc l ld le">import seaborn as sns<br/>plt.rcParams["figure.figsize"] = (24, 8)<br/>sns.heatmap(X_Scaled_Except.corr(),annot=True);</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mr"><img src="../Images/83126d6a831716d8ce8cd92f741fbb14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*txtOpVdPQFBYTosewrtqSA.png"/></div></div></figure><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="606d" class="la jp hh kw b fi lb lc l ld le">X_Scaled_Except.corr()</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div class="er es ms"><img src="../Images/49303d1deccc58b5b486e067282c1e28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*z57dz3zq7-vIiNfMydOFcA.png"/></div></figure><p id="94d6" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ä»ä¸Šè¡¨å’Œç›¸å…³çŸ©é˜µæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œä½å¼€é«˜èµ°ä¹‹é—´æœ‰å¾ˆé«˜çš„ç›¸å…³æ€§ã€‚æ‰€ä»¥æˆ‘ä»¬åªèƒ½é€‰æ‹©ä¸€ä¸ª1æ¥å¹³è¡¡å·¥ä½œã€‚ç”±äºä»·æ ¼ä¹‹é—´çš„å·®å¼‚å¾ˆå°ï¼Œæˆ‘é€‰æ‹©äº†å¹³è¡¡å·¥ä½œçš„æ‰€æœ‰åŠŸèƒ½</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="5952" class="la jp hh kw b fi lb lc l ld le">data_Final =X_Scaled_Except<br/>for f in dummies:<br/>    data_Final = data_Final.join(X[f])</span></pre><h1 id="a68c" class="jo jp hh bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl bi translated">æ­¥éª¤06é€’å½’ç¥ç»ç½‘ç»œ</h1><p id="90fc" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated"><strong class="ir hi">å°†å¤šå…ƒåºåˆ—åˆ†å‰²æˆæ ·æœ¬ï¼Œ</strong></p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="1742" class="la jp hh kw b fi lb lc l ld le">def split_series(series, n_past):<br/>     X, y = list(), list()<br/>     for window_start in range(len(series)):<br/>          past_end = window_start + n_past<br/>          if past_end &gt;= len(series):<br/>          break</span><span id="f5f6" class="la jp hh kw b fi lf lc l ld le"># slicing the past and future parts of the window<br/>           past, future = series[window_start:past_end, 0:4]<br/>                          ,series[past_end,3]<br/>           X.append(past)<br/>           y.append(future)<br/>      return np.array(X), np.array(y)</span></pre><p id="de22" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘å·²ç»ä½¿ç”¨äº†ä¸Šé¢çš„å‡½æ•°ï¼ŒæŒ‰ç…§ä¸‹é¢çš„ä»£ç åšäº†è¿™ä¸ªä¾‹å­ã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="34f9" class="la jp hh kw b fi lb lc l ld le">X, y = split_series(data_Final.to_numpy(), 6)</span></pre><p id="fd98" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘è€ƒè™‘äº†è¿‡å»6å¤©çš„è®°å½•æ¥é¢„æµ‹ç¬¬7å¤©çš„äº¤æ˜“é‡</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="8ee5" class="la jp hh kw b fi lb lc l ld le">import math<br/>n_test = math.floor(len(y)*0.2)<br/>X_train, X_test, y_train, y_test = X[:-n_test], X[-n_test:], y[:-n_test], y[-n_test:]<br/>print(X_train.shape, X_test.shape, y_train.shape, y_test.shape)</span></pre><p id="6ec2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">æˆ‘å°†æ•°æ®é›†åˆ†æˆ20 %ç”¨äºæµ‹è¯•ï¼Œ80 %ç”¨äºè®­ç»ƒã€‚æˆ‘ä»¥é€‚å½“çš„æ–¹å¼ä½¿ç”¨äº†ä¸Šè¿°ä»£ç ã€‚å› ä¸ºæˆ‘ä»¬å¿…é¡»åœ¨ä¸æ”¹å˜é¡ºåºçš„æƒ…å†µä¸‹æ‹†åˆ†æ•°æ®é›†ã€‚</p><p id="e435" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">é•¿çŸ­æœŸè®°å¿†(LSTM) </strong></p><p id="b83c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é•¿çŸ­æœŸè®°å¿†(LSTM)ç½‘ç»œæ˜¯ä¸€ç§èƒ½å¤Ÿåœ¨åºåˆ—é¢„æµ‹é—®é¢˜ä¸­å­¦ä¹ é¡ºåºä¾èµ–æ€§çš„é€’å½’ç¥ç»ç½‘ç»œã€‚</p><p id="9552" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œä½ å¯ä»¥å®šä¹‰ä¸€ä¸ªæ¨¡å‹ã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="aeb5" class="la jp hh kw b fi lb lc l ld le">from tensorflow.keras import Sequential<br/>from tensorflow.keras.layers import Dense, LSTM, Dropout<br/>from tensorflow.keras.layers import RNN</span><span id="6ff3" class="la jp hh kw b fi lf lc l ld le">regressor = Sequential()<br/>regressor.add(LSTM(units = 60, activation = 'relu', return_sequences = True, input_shape = (6, 4)))<br/>regressor.add(Dropout(0.2))<br/>regressor.add(LSTM(units = 60, activation = 'relu', return_sequences = True))<br/>regressor.add(Dropout(0.2))<br/>regressor.add(LSTM(units = 80, activation = 'relu', return_sequences = True))<br/>regressor.add(Dropout(0.2))<br/>regressor.add(LSTM(units = 120, activation = 'relu'))<br/>regressor.add(Dropout(0.2))<br/>regressor.add(Dense(units = 1))<br/>regressor.summary()</span></pre><h2 id="c3db" class="la jp hh bd jq lh li lj ju lk ll lm jy ja ln lo kc je lp lq kg ji lr ls kk lt bi translated"><strong class="ak">æ¨¡å‹çš„ç¼–åˆ¶</strong></h2><p id="f28d" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">é€šè¿‡ä¸‹é¢ç»™å®šçš„ä»£ç æ¥ç¼–è¯‘æ¨¡å‹ï¼Œæˆ‘ä½¿ç”¨äº†ä¸€ä¸ªä¼˜åŒ–å™¨ä½œä¸ºâ€œäºšå½“â€å’ŒæŸå¤±ä½œä¸ºâ€œå‡æ–¹è¯¯å·®â€ã€‚åœ¨ä¼˜åŒ–ç®—æ³•éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¿…é¡»è®¡ç®—æ¨¡å‹å½“å‰çŠ¶æ€çš„è¯¯å·®ï¼Œå¹¶ä¸”è¦åå¤ä¼°è®¡è¯¯å·®ã€‚å› æ­¤ï¼Œå®ƒå¯ä»¥ç”¨æ¥ä¼°è®¡è®­ç»ƒæ¨¡å‹çš„æŸå¤±ï¼Œä»è€Œå¯ä»¥æ›´æ–°è®­ç»ƒæ¨¡å‹çš„æƒé‡ï¼Œä»¥å‡å°‘ä¸ä¸‹ä¸€é˜¶æ®µä¸€æ ·å¤šçš„æŸå¤±ã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="79fd" class="la jp hh kw b fi lb lc l ld le">regressor.compile(optimizer=â€™adamâ€™, loss = â€˜mean_squared_errorâ€™)</span></pre><h2 id="f820" class="la jp hh bd jq lh li lj ju lk ll lm jy ja ln lo kc je lp lq kg ji lr ls kk lt bi translated"><strong class="ak">æ‹Ÿåˆæ¨¡å‹</strong></h2><p id="d628" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">æ‰¹é‡å¤§å°æ§åˆ¶åœ¨æ¨¡å‹çš„å†…éƒ¨å‚æ•°æ›´æ–°ä¹‹å‰è¦å¤„ç†çš„è®­ç»ƒæ ·æœ¬çš„æ•°é‡ã€‚å†å…ƒæ•°æ§åˆ¶è®­ç»ƒæ•°æ®é›†ä¸­çš„å®Œæ•´éæ•°ã€‚æˆ‘ç»™äº†150ä¸ªçºªå…ƒã€‚å› æ­¤ï¼Œå°†ä¼šå‘ç”Ÿ150æ¬¡å¯¹è®­ç»ƒæ•°æ®é›†çš„å®Œæ•´éå†ã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="d4b0" class="la jp hh kw b fi lb lc l ld le">history=regressor.fit(X_train, y_train, epochs=150, batch_size=32, verbose=2,validation_data=(X_test, y_test) )</span></pre><h2 id="e0f7" class="la jp hh bd jq lh li lj ju lk ll lm jy ja ln lo kc je lp lq kg ji lr ls kk lt bi translated">è¯„ä¼°æ¨¡å‹</h2><p id="d17e" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å‡æ–¹å·®(MSE ),å®ƒå‘Šè¯‰ä½ ä¸€æ¡å›å½’çº¿ç¦»ä¸€ç»„ç‚¹æœ‰å¤šè¿‘ã€‚è¿™æ˜¯é€šè¿‡ä»ç‚¹åˆ°å›å½’çº¿çš„è·ç¦»å¹¶å¹³æ–¹å®ƒä»¬æ¥å®ç°çš„ã€‚å‡æ–¹æ ¹è¯¯å·®(RMSE)æ˜¯ä»¥MSEçš„å¹³æ–¹æ ¹è¡¨ç¤ºçš„è¯¯å·®ç‡ã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="eb26" class="la jp hh kw b fi lb lc l ld le">from numpy import sqrt<br/>mse = regressor.evaluate(X_test, y_test, verbose=0)<br/>print('MSE: %.9f, RMSE: %.9f' % (mse, sqrt(mse)))</span></pre><p id="9a77" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">åœ¨è¿™é‡Œï¼Œæˆ‘å·²ç»æ”¶åˆ°äº†MSE: 0.000936066ï¼Œå’ŒRMSE:0.0399536567</p><h2 id="3760" class="la jp hh bd jq lh li lj ju lk ll lm jy ja ln lo kc je lp lq kg ji lr ls kk lt bi translated">ç»˜åˆ¶å­¦ä¹ æ›²çº¿</h2><p id="d3a7" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥ç»˜åˆ¶æ¨¡å‹çš„å­¦ä¹ æ›²çº¿ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å­¦ä¹ æ›²çº¿æ¥è¯Šæ–­å­¦ä¹ ä¸­çš„é—®é¢˜ï¼Œä¾‹å¦‚è®­ç»ƒæœŸé—´æ¨¡å‹çš„æ¬ æ‹Ÿåˆæˆ–è¿‡æ‹Ÿåˆã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="30b6" class="la jp hh kw b fi lb lc l ld le">plt.figure(figsize=(14,5))<br/>from matplotlib import pyplot<br/>pyplot.title('Learning Curves')<br/>pyplot.xlabel('Epoch')<br/>pyplot.ylabel('Root Mean Squared Error')<br/>pyplot.plot(history.history['loss'], label='train')<br/>pyplot.plot(history.history['val_loss'], label='val')<br/>pyplot.legend()<br/>pyplot.show()</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mt"><img src="../Images/aa5e7ce74ad7c771175ab9e64a79bdb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ndYaJQQ5uv3E2Yup9c3Cdg.png"/></div></div></figure><p id="c9c0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">é€šè¿‡ä½¿ç”¨å­¦ä¹ æ›²çº¿ï¼Œåœ¨è¿‡æ‹Ÿåˆå’Œæ¬ æ‹Ÿåˆæ¨¡å‹æ¡ä»¶ä¹‹é—´å­˜åœ¨è‰¯å¥½çš„æ‹Ÿåˆã€‚æˆ‘ä»¬å¯ä»¥è¯´è‰¯å¥½æ‹Ÿåˆæ˜¯æŒ‡è®­ç»ƒå’ŒéªŒè¯æŸå¤±éƒ½é™ä½åˆ°ä¸€ä¸ªç¨³å®šç‚¹ï¼Œä¸¤ä¸ªæœ€ç»ˆæŸå¤±å€¼ä¹‹é—´çš„å·®è·æœ€å°ã€‚</p><h2 id="eb3f" class="la jp hh bd jq lh li lj ju lk ll lm jy ja ln lo kc je lp lq kg ji lr ls kk lt bi translated">é¢„è¨€ï¼›é¢„æµ‹ï¼›é¢„å‘Š</h2><p id="accf" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥é¢„æµ‹ç»™å®šè¾“å…¥çš„éŸ³é‡ã€‚ç„¶è€Œæœ€ç»ˆå‡ºæ¥çš„ä¸æ˜¯é‡ã€‚å› ä¸ºæˆ‘ä»¬å·²ç»æŠŠå®ƒä½œä¸ºæ¨¡å‹çš„è¾“å…¥ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»é‡æ–°è°ƒæ•´è¾“å‡ºå€¼ï¼Œä»¥è·å¾—é¢„æµ‹çš„ä½“ç§¯ã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="8273" class="la jp hh kw b fi lb lc l ld le">y_pred = regressor.predict(X_test)</span></pre><h2 id="1021" class="la jp hh bd jq lh li lj ju lk ll lm jy ja ln lo kc je lp lq kg ji lr ls kk lt bi translated">é‡æ–°è°ƒæ•´è¾“å‡º</h2><p id="937d" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç é‡æ–°è°ƒæ•´æ¨¡å‹çš„è¾“å‡ºæ¥å¾—åˆ°ä½“ç§¯ã€‚æˆ‘å·²ç»ç”¨é€†å˜æ¢å‡½æ•°åšäº†ç›¸å…³çš„å·¥ä½œã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="ba0f" class="la jp hh kw b fi lb lc l ld le">y_predVol = scalerVol.inverse_transform(y_pred)<br/>y_test = y_test.reshape(y_test.shape[0], 1)<br/>y_testVol = scalerVol.inverse_transform(y_test)</span><span id="579f" class="la jp hh kw b fi lf lc l ld le">volume_pred= []<br/>for i in range(len(y_predVol)):<br/>     volume_pred.append(y_predVol[i,0])</span><span id="cd47" class="la jp hh kw b fi lf lc l ld le">volume_test= []<br/>for i in range(len(y_testVol)):<br/>     volume_test.append(y_testVol[i,0])</span></pre><h2 id="bb38" class="la jp hh bd jq lh li lj ju lk ll lm jy ja ln lo kc je lp lq kg ji lr ls kk lt bi translated">å¯è§†åŒ–ç»“æœ</h2><p id="05a7" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥ç»˜åˆ¶å‡ºæ˜¾ç¤ºå®é™…è°·æ­Œé‡ä¸é¢„æµ‹è°·æ­Œé‡çš„å›¾è¡¨ã€‚æˆ‘ç”¨çº¢è‰²çº¿æ˜¾ç¤ºäº†çœŸå®çš„è°·æ­Œé‡ï¼Œç”¨è“è‰²çº¿é¢„æµ‹äº†è°·æ­Œé‡ã€‚</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="2795" class="la jp hh kw b fi lb lc l ld le">plt.figure(figsize=(14,5))<br/>plt.plot(volume_test, color = 'red', label = 'Real Google Volume')<br/>plt.plot(volume_pred, color = 'blue', label = 'Predicted Google Volume')</span><span id="e167" class="la jp hh kw b fi lf lc l ld le">plt.title('Google Stock Volume Prediction')<br/>plt.xlabel('Time')<br/>plt.ylabel('Google Stock Volume')<br/>plt.legend()<br/>plt.show()</span></pre><figure class="kr ks kt ku fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mu"><img src="../Images/31419f991a3ec4e38feef015586b4974.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U2oHSp8Q-e9FqkXMP9zxrg.png"/></div></div></figure><h2 id="a6d6" class="la jp hh bd jq lh li lj ju lk ll lm jy ja ln lo kc je lp lq kg ji lr ls kk lt bi translated">ä½¿ç”¨ğ‘…^2ç»Ÿè®¡è®¡ç®—æ¨¡å‹çš„å‡†ç¡®æ€§</h2><p id="ead6" class="pw-post-body-paragraph ip iq hh ir b is km iu iv iw kn iy iz ja ko jc jd je kp jg jh ji kq jk jl jm ha bi translated">é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æ¨¡å‹çš„r2åˆ†æ•°ã€‚å¯¹rå¹³æ–¹æœ€å¸¸è§çš„è§£é‡Šæ˜¯å›å½’æ¨¡å‹ä¸è§‚æµ‹æ•°æ®çš„æ‹Ÿåˆç¨‹åº¦ã€‚é€šå¸¸ï¼Œè¾ƒé«˜çš„rå¹³æ–¹è¡¨ç¤ºæ¨¡å‹æ›´é€‚åˆ</p><pre class="kr ks kt ku fd kv kw kx ky aw kz bi"><span id="5a98" class="la jp hh kw b fi lb lc l ld le">from sklearn import metrics</span><span id="0fc2" class="la jp hh kw b fi lf lc l ld le">accuracy = metrics.r2_score(volume_test,volume_pred)<br/>print(" Accuracy:", accuracy)</span></pre><p id="dc3c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">ç²¾ç¡®åº¦:0.38386868686</p></div></div>    
</body>
</html>