<html>
<head>
<title>Power of Python Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">蟒蛇熊猫的力量</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/power-of-python-pandas-3f3601590095?source=collection_archive---------5-----------------------#2021-07-16">https://medium.com/analytics-vidhya/power-of-python-pandas-3f3601590095?source=collection_archive---------5-----------------------#2021-07-16</a></blockquote><div><div class="dt gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2c45" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">美国商店销售数据的高级分析</strong></p><figure class="je jf jg jh fe ji es et paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="es et jd"><img src="../Images/cd25f92b1e38042e9e19e6244c73c0c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rm1gBB3R7a1Mw72C.jpg"/></div></div></figure></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="9746" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated"><strong class="ak">数据集</strong></h1><p id="aeae" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated">本项目使用的数据可从<a class="ae kz" href="https://raw.githubusercontent.com/rohanraj-9654/Store-Sales-Analysis-with-Pandas/main/train.csv" rel="noopener ugc nofollow" target="_blank">此处</a>获取。该数据集包含一家全球超市4年的零售数据。</p><p id="108f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据中使用的不同属性很容易从它们各自的列标题中理解。</p><figure class="je jf jg jh fe ji es et paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="es et la"><img src="../Images/bfdc1300b3dbf7a261a21073d7475104.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GCxdJOvmpgoyasW7_BmEVQ.png"/></div></div></figure><p id="02fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在开始分析之前，必须对数据进行一些清理，以删除空条目并将属性转换为正确的数据类型。</p><figure class="je jf jg jh fe ji"><div class="bz dz l di"><div class="lb lc l"/></div><figcaption class="ld le eu es et lf lg bd b be z dy translated">数据清理</figcaption></figure><p id="542a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><figure class="je jf jg jh fe ji es et paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="es et lh"><img src="../Images/f246b4a23b1e87cd0523e5d0f32fb532.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v3Ndj8_N_Pq3JhvQVyAvtQ.png"/></div></div></figure><h1 id="df45" class="jw jx hi bd jy jz li kb kc kd lj kf kg kh lk kj kk kl ll kn ko kp lm kr ks kt bi translated">我们开始分析吧！！</h1><p id="aef3" class="pw-post-body-paragraph if ig hi ih b ii ku ik il im kv io ip iq kw is it iu kx iw ix iy ky ja jb jc hb bi translated"><strong class="ih hj"> <em class="ln"> 1。销售额最高的前5个州</em> </strong> <br/> <strong class="ih hj"> <em class="ln"> 2。每个类别销售额排名前三的子类别</em> </strong></p><pre class="je jf jg jh fe lo lp lq lr aw ls bi"><span id="002c" class="lt jx hi lp b fj lu lv l lw lx">##Top 5 States<br/>data.groupby('State').agg({'Sales' : sum}).sort_values(['Sales'], ascending = <strong class="lp hj">False</strong>).head(5)</span><span id="d89c" class="lt jx hi lp b fj ly lv l lw lx">##Top 3 Sub-Categories<br/>cat_sub = data.groupby(['Category', 'Sub-Category']).agg({'Sales':sum})<br/>cat_sub.sort_values(['Sales'], ascending = <strong class="lp hj">False</strong>).groupby('Category').head(3).sort_index()</span></pre><figure class="je jf jg jh fe ji es et paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="es et lz"><img src="../Images/a8fabb17b1860aaa406fb8cc78826f88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UBrxQmmyArSTiuwUGRH1bQ.png"/></div></div></figure><figure class="je jf jg jh fe ji es et paragraph-image"><div class="es et ma"><img src="../Images/28d55385e7004b8cc396e7f95077205a.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*-gVoqd27Qz6UR7sSA_jQgg.png"/></div><figcaption class="ld le eu es et lf lg bd b be z dy translated">每个类别的前3个子类别</figcaption></figure><p id="bd13" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些是为超市创造最大收入的每个产品类别的<strong class="ih hj">前3个</strong>子类别。</p><p id="f201" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ln"> 3。“当天”交付次数最多的月份和城市</em> </strong></p><figure class="je jf jg jh fe ji"><div class="bz dz l di"><div class="lb lc l"/></div></figure><p id="fa3e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:此处，(538–514)= 24次当天交货在订购日期后1天发货。因此，为了计算每月的当天交货，我们将使用0天(最小)发货的数据，这是真正的当天交货。</p><p id="0de8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">同一天交货的最高数量发生在九月的T21和纽约。</p><figure class="je jf jg jh fe ji es et paragraph-image"><div class="es et mb"><img src="../Images/98c07aaf6fc424538d40f725df053b56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*b3SpiC6bc64gafgBO6yEWw.png"/></div></figure><p id="73ba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ln"> 4。哪些产品最常一起出售？</em> </strong></p><p id="2977" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这里的想法是将同一订单ID上的所有产品分组，形成一个集群。然后计算这些产品集群被一起订购的实例数量，以获得最受欢迎的产品。</p><p id="011d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要了解整个数据集中这些唯一对的计数，来自堆栈溢出的这个<a class="ae kz" href="https://stackoverflow.com/questions/52195887/counting-unique-pairs-of-numbers-into-a-python-dictionary" rel="noopener ugc nofollow" target="_blank">链接</a>非常有帮助。</p><figure class="je jf jg jh fe ji"><div class="bz dz l di"><div class="lb lc l"/></div></figure><p id="b1de" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:这对于<strong class="ih hj">营销产品</strong>非常有用，产品可以分成两组出售，因为它们在观众中最受欢迎。</p><pre class="je jf jg jh fe lo lp lq lr aw ls bi"><span id="66db" class="lt jx hi lp b fj lu lv l lw lx">[(('Newell 344',<br/>   'Memorex Micro Travel Drive 16 GB',<br/>   'Wirebound Four 2-3/4 x 5 Forms per Page 400 Sets per Book',<br/>   'Elite 5" Scissors',<br/>   'Staple-based wall hangings'),<br/>  2),<br/> (('Newell 344',<br/>   'Memorex Micro Travel Drive 16 GB',<br/>   'Wirebound Four 2-3/4 x 5 Forms per Page 400 Sets per Book',<br/>   'Elite 5" Scissors',<br/>   'Eldon Image Series Desk Accessories Burgundy'),<br/>  2),<br/> (('Newell 344',<br/>   'Memorex Micro Travel Drive 16 GB',<br/>   'Wirebound Four 2-3/4 x 5 Forms per Page 400 Sets per Book',<br/>   'Elite 5" Scissors',<br/>   'DAX Two-Tone Silver Metal Document Frame'),<br/>  2)]</span></pre><p id="e359" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ln"> 5。成员产品对每个订单总销售额的贡献百分比</em> </strong></p><p id="94b1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这里，我们可以尝试按订单ID分组，然后执行一个转换求和。这类似于在SQL中使用窗口函数并执行聚合求和。</p><pre class="je jf jg jh fe lo lp lq lr aw ls bi"><span id="c532" class="lt jx hi lp b fj lu lv l lw lx">data['Total Order Sales'] = data.groupby(['Order ID'])['Sales'].transform(sum)</span><span id="c856" class="lt jx hi lp b fj ly lv l lw lx">#Calculating percent of contribution for each member product<br/>dataset = data[['Order ID', 'Product Name', 'Sales', 'Total Order Sales']]<br/>dataset['Percent of Total'] = (dataset['Sales']/dataset['Total Order Sales'])*100</span></pre><p id="9f16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:这对于确定订单中的任何产品在该订单的总销售额中所占的比例最大非常有用。</p><figure class="je jf jg jh fe ji es et paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="es et mc"><img src="../Images/d891ae26ec788ed85c5f3865ea126fc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9UykSbySCvIgP3mkzDwEbg.png"/></div></div><figcaption class="ld le eu es et lf lg bd b be z dy translated">成员产品的百分比贡献</figcaption></figure><p id="e8ed" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">6<em class="ln">。及时vs延迟订单分析</em> </strong></p><p id="88ae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">将发货时间超过5天的订单视为“延迟”订单，其余订单视为“及时”订单。</p><pre class="je jf jg jh fe lo lp lq lr aw ls bi"><span id="7647" class="lt jx hi lp b fj lu lv l lw lx">data['is_delayed'] = np.where(data['days_for_shipment'] &gt;= 5, 'True', 'False')</span><span id="cad2" class="lt jx hi lp b fj ly lv l lw lx">plt.figure(figsize=(10,5))<br/>data['is_delayed'].value_counts().plot(kind = 'bar',title = 'Timely vs Delayed',rot = 0)</span></pre><figure class="je jf jg jh fe ji es et paragraph-image"><div class="es et md"><img src="../Images/c0431c8c849b9bf8830affadedb877c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*HItRZmNuPuFqGgyjB0Zf9A.png"/></div></figure><p id="ed80" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建<strong class="ih hj">数据透视表</strong>以分析订单数量的数据</p><figure class="je jf jg jh fe ji"><div class="bz dz l di"><div class="lb lc l"/></div></figure><p id="3120" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:显示<strong class="ih hj">按区域&amp;按模式延迟交付的订单</strong>的比例</p><figure class="je jf jg jh fe ji es et paragraph-image"><div class="es et me"><img src="../Images/8412cab20f269f86243fa84f253d3d8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*ieD88DThY_tC92TsVmDUAQ.png"/></div><figcaption class="ld le eu es et lf lg bd b be z dy translated">区域性分布</figcaption></figure><p id="d986" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">最大百分比的“延迟”订单来自'<strong class="ih hj">中部</strong>地区，而最小百分比的延迟订单来自'<strong class="ih hj">东部</strong>地区</p><figure class="je jf jg jh fe ji es et paragraph-image"><div class="es et mf"><img src="../Images/c302603d76185e8233ea6e12238d6bd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*cFxha-l7Z5VFIF4puQq7BA.png"/></div><figcaption class="ld le eu es et lf lg bd b be z dy translated">运输模式配送</figcaption></figure><p id="e291" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于'<strong class="ih hj">第一类</strong>'和'<strong class="ih hj">当天</strong>'运输方式的交付，没有一个订单被延迟。这可能是这些类型的运输方式的成本通常比其他方式更高的原因之一，因为为了获得更快的服务，人们往往同意支付更多的费用。</p><p id="7dc0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ln"> 7。客户层面分析</em> </strong></p><p id="cfa3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，这里的意图是只获取每个客户的第一次购买和最后一次购买。</p><pre class="je jf jg jh fe lo lp lq lr aw ls bi"><span id="bbc6" class="lt jx hi lp b fj lu lv l lw lx">first_purchase = data.sort_values(by='Order Date').groupby('Customer ID').first()<br/>last_purchase = data.sort_values(by='Order Date').groupby('Customer ID').last()</span><span id="05f0" class="lt jx hi lp b fj ly lv l lw lx">##Merge the tables and fetch only important attributes:<br/>customer = pd.merge(first_purchase, last_purchase, on='Customer ID')[['State_x','Order Date_x','Order Date_y']]<br/>customer.rename({'State_x':'State', 'Order Date_x':'First_Purchase', 'Order Date_y':'Last_Purchase'}, axis=1, inplace=<strong class="lp hj">True</strong>)</span></pre><figure class="je jf jg jh fe ji es et paragraph-image"><div class="es et mg"><img src="../Images/fe838e90d2381ac0237623d17f0da365.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*Ka4tkV0-MHY8bp0q8zMKag.png"/></div></figure><p id="62fc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建新的属性，如<strong class="ih hj">保留天数</strong> (b/w第一次和最后一次购买)、<strong class="ih hj">订单计数</strong>、<strong class="ih hj">订单频率</strong>(以天为单位)和<strong class="ih hj">平均收入</strong>，这对于确定企业的<strong class="ih hj">重要客户</strong>非常有用。</p><figure class="je jf jg jh fe ji"><div class="bz dz l di"><div class="lb lc l"/></div></figure><p id="2d80" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:如果店主想用打折券奖励其<strong class="ih hj"> 3个最忠实的顾客</strong>，他可以通过这个方法找到他们。</p><p id="d7df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">根据给定的数据，这些是商店最忠诚的<strong class="ih hj"> 3名顾客</strong>，他们在过去的<strong class="ih hj">3年里(保持)</strong>一直在商店购买，每月的“平均订单频率”约为<strong class="ih hj">一次，并且<strong class="ih hj">为商店创造了可观的单笔收入</strong>。</strong></p><figure class="je jf jg jh fe ji es et paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="es et mh"><img src="../Images/35b58afca4e7dcad4cc74bb3e91dc2c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c1EhgI0BxjSGBfTsN51g5w.png"/></div></div><figcaption class="ld le eu es et lf lg bd b be z dy translated">忠诚的顾客</figcaption></figure><figure class="je jf jg jh fe ji"><div class="bz dz l di"><div class="lb lc l"/></div></figure><p id="68bf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">输出:</p><figure class="je jf jg jh fe ji es et paragraph-image"><div class="es et mi"><img src="../Images/d310241f700f6792f2c949f9d6501f53.png" data-original-src="https://miro.medium.com/v2/resize:fit:336/format:webp/1*aSq5K4l_Z8EtBhtojW8s7A.png"/></div><figcaption class="ld le eu es et lf lg bd b be z dy translated">忠诚客户的州级分布</figcaption></figure><p id="af7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果店主想在某些州将<strong class="ih hj">的<strong class="ih hj">超级连锁店</strong>进一步扩展</strong>，他如何找到那些重要的州？</p><p id="bf62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">考虑到忠诚顾客在商店至少停留1年(365天)，购物频率为每3个月(90天)，并且每份订单为商店带来至少100美元的收入，店主可以决定在这5个州扩大其商店的连锁店，其中“加利福尼亚”是最安全的赌注。</p><p id="35d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">注</strong>:上述分析中用于确定客户忠诚度的参数纯粹基于一些直觉。这些可以根据店主如何评定他们的顾客为“忠诚”而改变。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><p id="a828" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些只是整个项目的一部分。</p><p id="22ea" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">要详细了解项目的输出和可视化，请查看GitHub  库<a class="ae kz" href="https://github.com/rohanraj-9654/Store-Sales-Analysis-with-Pandas/blob/main/Sales_EDA.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj">。</strong></a></p><p id="a494" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如果你对这篇文章有反馈、建议或问题，欢迎在GitHub上发表评论或补充，或者通过<a class="ae kz" href="https://www.linkedin.com/in/rohan-raj-204848100/" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> LinkedIn </strong> </a>联系我。</p></div></div>    
</body>
</html>