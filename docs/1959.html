<html>
<head>
<title>Recommending Myself a movie on Netflix</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">给自己推荐一部关于网飞的电影</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/recommending-myself-a-movie-on-netflix-c6af3d0741e0?source=collection_archive---------19-----------------------#2021-03-28">https://medium.com/analytics-vidhya/recommending-myself-a-movie-on-netflix-c6af3d0741e0?source=collection_archive---------19-----------------------#2021-03-28</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/b43ad5769cd229b7b0e433d88893682f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*x6XbNihYcOUeVZtw"/></div></div></figure><p id="e965" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi jn translated">我们有一个星期天的早上，我不知道如何浪费我的一天，我可能应该去网飞放松一下。不确定看哪个，通常是看电影/连续剧的前5分钟再决定是否继续。我的<em class="jw">转化率</em>低于5%。所以我已经决定使用Kaggle网飞数据集，分析它并建立一个推荐系统来找到一部适合我的电影。<a class="ae jx" href="https://www.kaggle.com/shivamb/netflix-shows" rel="noopener ugc nofollow" target="_blank">点击这里</a>从Kaggle下载网飞数据集。</p><h2 id="62dd" class="jy jz hh bd ka kb kc kd ke kf kg kh ki ja kj kk kl je km kn ko ji kp kq kr ks bi translated">网飞数据分析</h2><p id="883b" class="pw-post-body-paragraph ip iq hh ir b is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji kx jk jl jm ha bi translated">我已经下载了数据集，我将开始分析数据集。在网飞查印度电影。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="d0ef" class="jy jz hh ld b fi lh li l lj lk">import pyforest<br/>data=pd.read_csv("netflix.csv")<br/></span></pre><p id="9c54" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们来看看网飞的电影和节目的数量</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="8a66" class="jy jz hh ld b fi lh li l lj lk">data.groupby('type').count()<br/>print(data.type.value_counts())<br/>sns.countplot(data.type,palette="pastel")</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div class="er es ll"><img src="../Images/e53b6ff6f9875341d75372c58a299b17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*DkUpReoqvU4WI_WhJalDkA.png"/></div></figure><p id="c35d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将检查各个国家的电影数量。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="61c8" class="jy jz hh ld b fi lh li l lj lk">print(data["country"].value_counts().head())<br/>plt.figure(figsize=(20,6))<br/>sns.countplot(x="country",data= data,hue= "type",order = data['country'].value_counts().index[0:15],palette="pastel")<br/>plt.xticks(rotation=45)<br/>plt.show()</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lm"><img src="../Images/1ce1c09b63e62fc49f1ae61d5150a1a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sdRvn6ONb2UVOsmE-Kkl7Q.png"/></div></div></figure><p id="82ce" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">让我们来看看排名前五的流派。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="bd4b" class="jy jz hh ld b fi lh li l lj lk">print(netflix["listed_in"].value_counts()[:5])</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div class="er es ln"><img src="../Images/b3c90567f052e928e951104d13a941ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*NubCWFT6HxRVqluwMZO1mA.png"/></div></figure><p id="3a2c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们分析并可视化了我们所拥有的网飞数据。虽然能够了解你的数据很有帮助，但我仍然需要一个推荐者来决定观看哪个节目。</p></div><div class="ab cl lo lp go lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ha hb hc hd he"><h2 id="d99e" class="jy jz hh bd ka kb kc kd ke kf kg kh ki ja kj kk kl je km kn ko ji kp kq kr ks bi translated">向量化电影特征</h2><p id="2e43" class="pw-post-body-paragraph ip iq hh ir b is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji kx jk jl jm ha bi translated">导入我们分析数据集和构建推荐系统所需的所有库，并删除我们分析数据集中的电影不需要的列。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="0edb" class="jy jz hh ld b fi lh li l lj lk">import numpy as np # linear algebra<br/>import pandas as pd # data processing, CSV file I/O (e.g. pd.read_csv)<br/>import re<br/>import nltk<br/>from nltk.corpus import stopwords<br/>nltk.download('stopwords')<br/>from nltk.tokenize import word_tokenize</span><span id="3353" class="jy jz hh ld b fi lv li l lj lk">data = data.dropna(subset=['cast','country','rating'])<br/>movies = data[data['type']=='Movie'].reset_index()<br/>movies = movies.drop(['index','show_id','type','date_added','release_year','duration','description'],axis=1)<br/>movies.head()</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lw"><img src="../Images/6b3cbe4f4b4f31f499706b2d8d3712eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7vfRqjk4OfTRXJoXGpAmbQ.png"/></div></div></figure><p id="094b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们也会为网飞的电视节目做同样的事情。删除多余的列。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="c7db" class="jy jz hh ld b fi lh li l lj lk">tv = data[data['type']=='TV Show'].reset_index()<br/>tv = tv.drop(['index','show_id','date_added','release_year','duration','description','type'],axis=1)<br/>tv.head()</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lx"><img src="../Images/04e95e76f345574e50bcbadbf1e9925d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EzjeBAAMOL_lkMfKJqAHcg.png"/></div></div></figure><p id="a73d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">将电影演员的名字符号化。我们先把同一部电影的演员拆分一下。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="ef65" class="jy jz hh ld b fi lh li l lj lk">actors =[]<br/>for i in movies['cast']:<br/>    actor=re.split(r',\s*',i)<br/>    actors.append(actor)</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ly"><img src="../Images/540c2e6b034ebc99f5c606a7676cf911.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0qYDFVTRhTHy3i3fFpiUlA.png"/></div></div><figcaption class="lz ma et er es mb mc bd b be z dx translated">同一部电影中演员的符号化</figcaption></figure><p id="1cd3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">进一步标记所有参与者，并按升序对它们进行排序。将<em class="jw">子列表</em>视为一个单一列表(从德梅恩·比希尔到卡门的演员都是一个单一列表)，条目是子列表中的每一个演员。所以我们在一个列表中添加了所有演员的名字。该列表被转换成一个所有演员按升序排序的集合<em class="jw">。<em class="jw"> Set </em>用于保存单个变量中的所有值。</em></p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="1432" class="jy jz hh ld b fi lh li l lj lk">flat_list=[]<br/>for sublist in actors:<br/>    for item in sublist:<br/>        flat_list.append(item)<br/>actor_list = sorted(set(flat_list))</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es md"><img src="../Images/6a647a08d6b49ef737830deeb15a2740.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L97HgHmysKC8U5JvyQElIA.png"/></div></div></figure><p id="bc25" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><em class="jw"> binary_actor </em>是具有actor_list维度的空集。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="8f57" class="jy jz hh ld b fi lh li l lj lk">binary_actor = [[0] * 0 for i in range(len(set(flat_list)))]</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div class="er es me"><img src="../Images/6273470a2aed05f54829bbba00613ae2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*W0OkQqERoTbTKdIxtcK3Yg.png"/></div></figure><p id="8895" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们创建一个名为binary_actor的数据帧，如果演员姓名不在cast列中(该列将包含所有演员姓名),则该数据帧的值为0，如果姓名存在，则值为1。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="4106" class="jy jz hh ld b fi lh li l lj lk">for i in movies['cast']:<br/>    k=0<br/>    for j in actor_list:<br/>        if j in i:<br/>            binary_actor[k].append(1.0)<br/>        else:<br/>            binary_actor[k].append(0.0)<br/>        k+=1<br/>binary_actor = pd.DataFrame(binary_actor).transpose()</span></pre><p id="758f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我们将对董事、国家和地区重复同样的过程，并对他们进行矢量化。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="d93f" class="jy jz hh ld b fi lh li l lj lk">directors=[]</span><span id="6ec6" class="jy jz hh ld b fi lv li l lj lk">for i in movies['director']:<br/>    if pd.notna(i):<br/>        director=re.split(r',\s*',i)<br/>        directors.append(director)</span><span id="50b5" class="jy jz hh ld b fi lv li l lj lk">flat_list2=[]<br/>for sublist in directors:<br/>    for item in sublist:<br/>        flat_list2.append(item)<br/>directors_list=sorted(set(flat_list2))<br/>binary_director = [[0]* 0 for i in range(len(set(flat_list2)))]<br/>for i in movies['director']:<br/>    k=0<br/>    for j in directors_list:<br/>        if pd.notna(j):<br/>            binary_director[k].append(0.0)<br/>        elif j in i:<br/>            binary_director[k].append(1.0)<br/>        else:<br/>            binary_director[k].append(0.0)<br/>        k+=1<br/>            <br/>binary_director = pd.DataFrame(binary_director).transpose()</span><span id="ca1d" class="jy jz hh ld b fi lv li l lj lk">countries=[]<br/>for i in movies['country']:<br/>    country=re.split(r',\s*',i)<br/>    countries.append(country)<br/>flat_list3=[]<br/>for sublist in countries:<br/>    for item in sublist:<br/>        flat_list3.append(item)<br/>country_list = sorted(set(flat_list3))<br/>binary_country=[[0]*0 for i in range(len(set(flat_list3)))]<br/>for i in movies['country']:<br/>    k=0<br/>    for j in country_list:<br/>        if j in i:<br/>            binary_country[k].append(1.0)<br/>        else:<br/>            binary_country[k].append(0.0)<br/>        k+=1<br/>binary_country = pd.DataFrame(binary_country).transpose()<br/></span></pre><p id="9283" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">将体裁矢量化。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="a17a" class="jy jz hh ld b fi lh li l lj lk">genres=[]<br/>for i in movies['listed_in']:<br/>    genre=re.split(r',\s*',i)<br/>    genres.append(genre)<br/>flat_list4=[]<br/>for sublist in genres:<br/>    for item in sublist:<br/>        flat_list4.append(item)<br/>genre_list=sorted(set(flat_list4))<br/>binary_genre=[[0] * 0 for i in range(len(set(flat_list4)))]<br/>for i in movies['listed_in']:<br/>    k = 0<br/>    for j in genre_list:<br/>        if j in i:<br/>            binary_genre[k].append(1.0)<br/>        else:<br/>            binary_genre[k].append(0.0)<br/>        k+=1<br/>binary_genre=pd.DataFrame(binary_genre).transpose()<br/></span></pre><p id="67a5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">将评级矢量化。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="42d7" class="jy jz hh ld b fi lh li l lj lk">ratings = []<br/>for i in movies['rating']:<br/>    ratings.append(i)<br/>rating_list = sorted(set(ratings))<br/>binary_rating = [[0]*0 for i in range(len(set(rating_list)))]</span></pre><p id="d520" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">好了，现在是时候通过<em class="jw">连接</em>所有的<strong class="ir hi">矢量化特征</strong>来创建数据框了。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="0951" class="jy jz hh ld b fi lh li l lj lk">binary = pd.concat([binary_actor,binary_director,binary_country,binary_genre],axis=1,ignore_index=True)<br/>binary</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mf"><img src="../Images/456aee45bf6b3419ea41c4b258450e76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LlqqYllyfffBweuG9AlTMw.png"/></div></div></figure><h2 id="b86d" class="jy jz hh bd ka kb kc kd ke kf kg kh ki ja kj kk kl je km kn ko ji kp kq kr ks bi translated">向量化电视节目特征</h2><p id="c5b7" class="pw-post-body-paragraph ip iq hh ir b is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji kx jk jl jm ha bi translated">我们对电影数据进行了矢量化。我们需要为网飞的电视节目做同样的事情。我们将使用不同变量名的相同代码。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="38ae" class="jy jz hh ld b fi lh li l lj lk">actors2=[]<br/>for i in tv['cast']:<br/>    actor=re.split(r',\s*',i)<br/>    actors2.append(actor)<br/>flat_list5 = []<br/>for sublist in actors2:<br/>    for item in sublist:<br/>        flat_list5.append(item) <br/>actors_list2 = sorted(set(flat_list5))<br/>binary_actor2 = [[0] * 0 for i in range(len(set(flat_list5)))]<br/>for i in tv['cast']:<br/>    k=0<br/>    for j in actors_list2:<br/>        if j in i:<br/>            binary_actor2[k].append(1.0)<br/>        else:<br/>            binary_actor2[k].append(0.0)<br/>        k+=1<br/>binary_actor2 = pd.DataFrame(binary_actor2).transpose()</span><span id="0ab4" class="jy jz hh ld b fi lv li l lj lk">country2 = []<br/>for i in tv['country']:<br/>    <br/>    countries2 = re.split(r',\s*',i)<br/>    country2.append(countries2)<br/>flat_list6 = []</span><span id="d51a" class="jy jz hh ld b fi lv li l lj lk">for sublist in country2:<br/>    for item in sublist:<br/>        flat_list6.append(item)<br/>country_list2 = sorted(set(flat_list6))</span><span id="7668" class="jy jz hh ld b fi lv li l lj lk">binary_country2 = [[0] * 0 for i in range(len(set(flat_list6)))]<br/>for i in tv['country']:<br/>    k=0<br/>    for j in country_list2:<br/>        if j in i:<br/>            binary_country2[k].append(1.0)<br/>        else:<br/>            binary_country2[k].append(0.0)<br/>            <br/>        k+=1<br/>binary_country2 = pd.DataFrame(binary_country2).transpose()</span><span id="9a79" class="jy jz hh ld b fi lv li l lj lk">genres2=[]</span><span id="01ae" class="jy jz hh ld b fi lv li l lj lk">for i in tv['listed_in']:<br/>    genre2=re.split(r',\s*',i)<br/>    genres2.append(genre2)</span><span id="0659" class="jy jz hh ld b fi lv li l lj lk">flat_list8=[]</span><span id="a78f" class="jy jz hh ld b fi lv li l lj lk">for sublist in genres2:<br/>    for item in sublist:<br/>        flat_list8.append(item)</span><span id="6063" class="jy jz hh ld b fi lv li l lj lk">genres_list2 = sorted(set(flat_list8))</span><span id="8498" class="jy jz hh ld b fi lv li l lj lk">binary_genre2 = [[0] * 0 for i in range(len(set(flat_list8)))]</span><span id="5a93" class="jy jz hh ld b fi lv li l lj lk">for i in tv['listed_in']:<br/>    k=0<br/>    for j in genres_list2:<br/>        if j in i:<br/>            binary_genre2[k].append(1.0)<br/>        else:<br/>            binary_genre2[k].append(0.0)<br/>        k+=1<br/>        <br/>        <br/>binary_genre2 = pd.DataFrame(binary_genre2).transpose()</span><span id="f8c5" class="jy jz hh ld b fi lv li l lj lk">ratings2 = []</span><span id="9ed5" class="jy jz hh ld b fi lv li l lj lk">for i in tv['rating']:<br/>    ratings2.append(i)<br/>    <br/>rating_list2 = sorted(set(ratings2))</span><span id="9858" class="jy jz hh ld b fi lv li l lj lk">binary_rating2 = [[0] * 0 for i in range(len(set(rating_list2)))]</span><span id="a8d7" class="jy jz hh ld b fi lv li l lj lk">for i in tv['rating']:<br/>    k=0<br/>    for j in rating_list2:<br/>        if j in i:<br/>            binary_rating2[k].append(1.0)<br/>        else:<br/>            binary_rating2[k].append(0.0)<br/>        k+=1<br/>        <br/>binary_rating2 = pd.DataFrame(binary_rating2).transpose()</span></pre><p id="1a3c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">现在，所有电视节目功能都将连接在一起。</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="8c3c" class="jy jz hh ld b fi lh li l lj lk">binary2 = pd.concat([binary_actor2,binary_country2,binary_genre2],axis=1,ignore_index=True)<br/>binary2</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mg"><img src="../Images/909dcdf37522ac52aad10eef54edb4b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6D327Rewgxu-LR1XXhvgmw.png"/></div></div></figure><h2 id="85e0" class="jy jz hh bd ka kb kc kd ke kf kg kh ki ja kj kk kl je km kn ko ji kp kq kr ks bi translated">使用余弦相似度的推荐系统</h2><p id="d16c" class="pw-post-body-paragraph ip iq hh ir b is kt iu iv iw ku iy iz ja kv jc jd je kw jg jh ji kx jk jl jm ha bi translated">现在我们已经将所有的特征矢量化并连接起来。我们需要写一个推荐算法。我们将使用余弦等式来找出电影之间的相似之处。</p><blockquote class="mh mi mj"><p id="0626" class="ip iq jw ir b is it iu iv iw ix iy iz mk jb jc jd ml jf jg jh mm jj jk jl jm ha bi translated"><strong class="ir hi">余弦相似度</strong>度量内积空间的两个向量之间的<strong class="ir hi">相似度</strong>。它通过两个向量之间的角度的<strong class="ir hi">余弦</strong>来测量，并确定两个向量是否大致指向同一方向。它用于测量分析文本和推荐系统之间的相似性。</p></blockquote><figure class="ky kz la lb fd ii er es paragraph-image"><div class="er es mn"><img src="../Images/b8d305beb1be8a6744b4c144f1f1cd93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EgujsdCh4EqyDuX_CJXf3A.png"/></div><figcaption class="lz ma et er es mb mc bd b be z dx translated">余弦相似公式</figcaption></figure><blockquote class="mh mi mj"><p id="990c" class="ip iq jw ir b is it iu iv iw ix iy iz mk jb jc jd ml jf jg jh mm jj jk jl jm ha bi translated">其中A将是搜索的电影/电视节目，B将是我们数据库中的所有电影/电视节目</p></blockquote><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="7aff" class="jy jz hh ld b fi lh li l lj lk">def recommender(search):<br/>    cs_list = []<br/>    binary_list = []<br/>    if search in movies['title'].values:<br/>        idx = movies[movies['title']==search].index.item()<br/>        for i in binary.iloc[idx]:<br/>            binary_list.append(i)<br/>        point1=np.array(binary_list).reshape(1,-1)<br/>        point1=[val for sublist in point1 for val in sublist]<br/>        for j in range(len(movies)):<br/>            binary_list2 = []<br/>            for k in binary.iloc[j]:<br/>                binary_list2.append(k)<br/>            point2 = np.array(binary_list2).reshape(1,-1)<br/>            point2 = [val for sublist in point2 for val in sublist]<br/>            <br/>            dot_product = np.dot(point1,point2)<br/>            <br/>            norm_1 = np.linalg.norm(point1)<br/>            norm_2 = np.linalg.norm(point2)<br/>            cos_sim = dot_product / (norm_1*norm_2)<br/>            cs_list.append(cos_sim)<br/>            <br/>        movies_copy = movies.copy()<br/>        movies_copy['cos_sim'] = cs_list<br/>        results = movies_copy.sort_values('cos_sim',ascending=False)<br/>        results = results[results['title']!=search]<br/>        top_results = results.head(5)<br/>        return(top_results)<br/>    <br/>    <br/>    elif search in tv['title'].values:<br/>        idx = tv[tv['title']==search].index.item()<br/>        for i in binary2.iloc[idx]:<br/>            binary_list.append(i)<br/>            <br/>        point1 = np.array(binary_list).reshape(1,-1)<br/>        point1 = [val for sublist in point1 for val in sublist]<br/>        for j in range(len(tv)):<br/>            binary_list2=[]<br/>            for k in binary2.iloc[j]:<br/>                binary_list2.append(k)<br/>            point2 = np.array(binary_list2).reshape(1,-1)<br/>            point2 = [val for sublist in point2 for val in sublist]<br/>            <br/>            dot_product = np.dot(point1,point2)<br/>            <br/>            norm_1 = np.linalg.norm(point1)<br/>            norm_2 = np.linalg.norm(point2)<br/>            cos_sim = dot_product / (norm_1*norm_2)<br/>            cs_list.append(cos_sim)<br/>        tv_copy = tv.copy()<br/>        tv_copy['cos_sim'] = cs_list<br/>        results = tv_copy.sort_values('cos_sim',ascending=False)<br/>        results = results[results['title']!=search]<br/>        top_results = results.head(5)<br/>        return(top_results)<br/>    else:<br/>        return("Title is not in dataset.Please check what's worng !!")</span></pre><p id="ffab" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">我已经写了推荐算法。让我查一下推荐信。我看的最后一个节目是“食尸鬼”</p><pre class="ky kz la lb fd lc ld le lf aw lg bi"><span id="c784" class="jy jz hh ld b fi lh li l lj lk">recommender('GHOUL')</span></pre><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mo"><img src="../Images/3ebc6fc1fc2f186e1cfab336eb36beb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rZALfEGY8pdIT8p01oSVnw.png"/></div></div></figure><p id="082a" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">好吧，伙计们，我会看"<em class="jw"> Darr sabko lagta hai </em>"</p><figure class="ky kz la lb fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mp"><img src="../Images/6b8c824b915d4bbb4032064919fbf320.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/0*kMh_722ijorTsQJr.gif"/></div></div></figure></div></div>    
</body>
</html>