<html>
<head>
<title>Discovering Customer Segments using Machine Learning — Part 1 (Data Exploration)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习发现客户群—第1部分(数据探索)</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/discovering-customer-segments-using-machine-learning-part-1-data-exploration-7c171c21206a?source=collection_archive---------9-----------------------#2021-10-11">https://medium.com/analytics-vidhya/discovering-customer-segments-using-machine-learning-part-1-data-exploration-7c171c21206a?source=collection_archive---------9-----------------------#2021-10-11</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/763f8107fc637ab5f928e4c65a70bdee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7g2_bkzsDDRQlYBtEhfG9g.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated"><a class="ae it" href="https://www.professionalacademy.com/blogs/segmentation-targeting-positioning-the-buyer-persona/" rel="noopener ugc nofollow" target="_blank">https://CPA website images . blob . core . windows . net/public images/Blogs/Segmenting-Consumer-Markets-transparent-BG . png</a></figcaption></figure><p id="d45a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">当我们即将推出新产品、服务或营销策略时，我们经常会想知道哪个客户市场将是我们的有效目标。借此机会，我想向您展示一个例子，说明统计和机器学习如何帮助您<strong class="iw hi">近似</strong>客户的人口统计和行为模式。</p><blockquote class="js jt ju"><p id="5078" class="iu iv jv iw b ix iy iz ja jb jc jd je jw jg jh ji jx jk jl jm jy jo jp jq jr ha bi translated">在处理这些数据时，我尝试了两种不同的方法。这两种方法都旨在<strong class="iw hi">再次接近</strong>客户的人口统计和行为模式。这两种方法得出了大致相同的结论。方法有:<br/>——数据降维(PCA)然后聚类。<br/>和<br/>——聚类然后通过分类建模检查变量重要性。我将演示第一种方法，因为它比第二种方法更理论化。</p></blockquote><p id="a391" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在我们进入主题之前，本文将讨论数据探索。我们作为例子使用的数据来自Kaggle.com(<a class="ae it" href="https://www.kaggle.com/imakash3011/customer-personality-analysis" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/imakash 3011/customer-personality-analysis</a>)。</p><p id="9b42" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> <em class="jv">如果你对这部分不感兴趣，而你们又想直接跳到机器学习部分，请关注我这个链接！</em></strong><br/><a class="ae it" href="https://sea-remus.medium.com/discovering-customer-segments-using-machine-learning-part-2-dimension-reduction-and-clustering-36c6108599f9" rel="noopener">https://sea-Remus . medium . com/discovery-customer-segments-using-machine-learning-part-2-dimension-reduction-and-clustering-36c 6108599 F9</a></p><h1 id="7bdf" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">数据描述</h1><p id="1b87" class="pw-post-body-paragraph iu iv hh iw b ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr ha bi translated">所以从Kaggle获得的原始数据包含28列，不包括ID。我排除了ID，因为它不包含任何重复的记录，这意味着每一行都是唯一客户的信息。<br/>我们有9个分类变量和19个数值变量。</p><figure class="ld le lf lg fd ii er es paragraph-image"><div class="er es lc"><img src="../Images/77894ecb17b6f18577dde7b96d2e62cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*XTLI75VkngNSdUproTiBYg.png"/></div></figure><p id="17bf" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">除了Z_CostContact和Z_Revenue，我们可以在Kaggle上看到每个变量的定义。我们应该看看这些变量，看看它到底意味着什么。</p><figure class="ld le lf lg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lh"><img src="../Images/5ee04ab80a2b66179f2750e97c749c6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_uckkyigbmfZ1BuDe9S1hQ.png"/></div></div></figure><p id="7a7b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这两个变量实际上都有一个常量值。这意味着即使我们保留那些变量，它们也不会对任何事情有所贡献。我们可以安全地扔掉它们。</p><h1 id="9b45" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">解读有趣的变量</h1><p id="7609" class="pw-post-body-paragraph iu iv hh iw b ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr ha bi translated">我们不会可视化所有的变量。相反，我们将只看几个变量，以了解我们当前面对的客户的总体情况。</p><h2 id="fda9" class="li ka hh bd kb lj lk ll kf lm ln lo kj jf lp lq kn jj lr ls kr jn lt lu kv lv bi translated">年份_出生和婚姻状况</h2><figure class="ld le lf lg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lw"><img src="../Images/ab9dcacb70efa1e2bc595daef5b3d4da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7llzIGpjdyYcPGWlew18uw.png"/></div></div></figure><p id="9113" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们可以看到，我们的数据实际上由1940年至2000年出生的客户组成。我们应该放弃年龄小于1935的客户，因为拥有一个年龄为100岁的客户是没有意义的(例如，出生于1900年，所以2000年是100岁)。我们还应该考虑将婚姻状况中的“孤独”、“荒谬”和“YOLO”编码为“单身”，因为这三个类别似乎都表示没有任何伴侣的生活。</p><h2 id="2674" class="li ka hh bd kb lj lk ll kf lm ln lo kj jf lp lq kn jj lr ls kr jn lt lu kv lv bi translated">教育</h2><figure class="ld le lf lg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lx"><img src="../Images/d5213287ce3687cf6f85e03efe79226b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1aBUiWSgi-xQpTCTPjOpIA.png"/></div></div></figure><p id="4df5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">教育似乎也是合乎逻辑的，但如果我们注意NumWebPurchases，我们已经看到20以上的购买两次是异常值(在Year_Birth图和此图中)。我们也可以考虑将其从数据中删除。</p><h2 id="9dd5" class="li ka hh bd kb lj lk ll kf lm ln lo kj jf lp lq kn jj lr ls kr jn lt lu kv lv bi translated">收入</h2><figure class="ld le lf lg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ly"><img src="../Images/d09f92ffc5eee44296e3111478c913de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*No_BKxfASWh7MT4nJdHUTw.png"/></div></div></figure><p id="5426" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">好的，我们需要剔除40万以上的收入，因为它似乎是一个异常值。它也需要被删除，因为它可能会影响我们将要进行的聚类。</p><h2 id="0868" class="li ka hh bd kb lj lk ll kf lm ln lo kj jf lp lq kn jj lr ls kr jn lt lu kv lv bi translated">崭新</h2><figure class="ld le lf lg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es lz"><img src="../Images/91ed3f7b15a7c69452983e78c74b359d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fnPQij8lfjQRa1v5R2J8cQ.png"/></div></div></figure><p id="63f5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们可以看到，最近似乎具有均匀分布，客户具有特定最近的可能性彼此完全相同。我们不会在这个变量中找到一个特定的分段截止值。我们可以去掉这个变量。</p><h2 id="1d8a" class="li ka hh bd kb lj lk ll kf lm ln lo kj jf lp lq kn jj lr ls kr jn lt lu kv lv bi translated">支出的相关性</h2><figure class="ld le lf lg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ma"><img src="../Images/33817501ffff288ca84e1fe10ccb3faa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hMBuxL_XpBNaYrWLClKHrg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">每个项目的采购金额之间的相关性</figcaption></figure><p id="2275" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们可以看到，每幅图实际上都显示了每个特定物品的购买量与其他每个特定物品的购买量相关。这证明我们可以在以后减少这个变量。</p><h2 id="72b4" class="li ka hh bd kb lj lk ll kf lm ln lo kj jf lp lq kn jj lr ls kr jn lt lu kv lv bi translated">购买地点的相关性</h2><figure class="ld le lf lg fd ii er es paragraph-image"><div class="er es mb"><img src="../Images/2b152c1dc179be4c35de04d4191c3509.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*EPGeZgXO0gH1w7GluNE-ag.png"/></div></figure><p id="5efa" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">上述各变量之间也存在相关性。网络购买和目录购买之间的相关性可能没有那么大。我们还应该在后面的降维过程中包含这些变量。</p><h2 id="6c40" class="li ka hh bd kb lj lk ll kf lm ln lo kj jf lp lq kn jj lr ls kr jn lt lu kv lv bi translated">Dt_Customer(加入日期和年龄)</h2><figure class="ld le lf lg fd ii er es paragraph-image"><div class="er es mc"><img src="../Images/8f1064d1d649e07d55e84485ee78db01.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*N7HvGROowKhIBbKa3mjlxQ.png"/></div></figure><p id="986a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们关于Dt_Customer的数据实际上是一个“对象”。我们应该将这个变量的类型改为日期。由于我们没有自加入以来最后一次观察到的当前日期的信息，我们可以使用Dt_Customer的最大值/日期作为我们最后一次观察到我们的客户加入的日期。根据Dt_Customer和的最大日期，如果我们假设数据观察的最后日期等于Dt_Customer的最大日期，我们还可以使用Year_Birth获得客户的年龄。</p><h1 id="879e" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">数据清理和(一点)特征工程</h1><p id="5f2d" class="pw-post-body-paragraph iu iv hh iw b ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr ha bi translated">关于上面我们看到的几个变量，我们可以开始清理数据，将几个变量变成更好的变量。</p><h2 id="11bc" class="li ka hh bd kb lj lk ll kf lm ln lo kj jf lp lq kn jj lr ls kr jn lt lu kv lv bi translated">极端值</h2><p id="0b87" class="pw-post-body-paragraph iu iv hh iw b ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr ha bi translated">我们看到的异常值位于收入、出生年份和网上购物之后。我们将根据这些变量删除行。</p><pre class="ld le lf lg fd md me mf mg aw mh bi"><span id="779c" class="li ka hh me b fi mi mj l mk ml">firstdrop = data[data.Income &lt; 400000][:]<br/>seconddrop = firstdrop[firstdrop.Year_Birth &gt; 1935][:]<br/>final = seconddrop[seconddrop.NumWebPurchases &lt; 20][:]</span></pre><h2 id="a71c" class="li ka hh bd kb lj lk ll kf lm ln lo kj jf lp lq kn jj lr ls kr jn lt lu kv lv bi translated">特征工程和缺失值</h2><p id="c1b4" class="pw-post-body-paragraph iu iv hh iw b ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr ha bi translated">在去除异常值后，我们开始讨论Dt_Customer、AcceptedCmp和marriage _ Status。</p><pre class="ld le lf lg fd md me mf mg aw mh bi"><span id="4369" class="li ka hh me b fi mi mj l mk ml">import datetime</span><span id="f08c" class="li ka hh me b fi mm mj l mk ml">#Dt_Customer for days since join and Age<br/>#we use maximum of Dt_Customer to assume it as our final date of observation</span><span id="1ba7" class="li ka hh me b fi mm mj l mk ml">final.Dt_Customer = pd.to_datetime(final.Dt_Customer)<br/>final['days_since_join'] = (max(final.Dt_Customer)-final.Dt_Customer).dt.days<br/>final['Age'] = (max(final.Dt_Customer.dt.year)-final.Year_Birth)</span><span id="1086" class="li ka hh me b fi mm mj l mk ml">#Handling marital status<br/>final['Marital_Status'] = final['Marital_Status'].replace({'Alone':'Single', 'Absurd':'Single','YOLO':'Single'})</span><span id="37d1" class="li ka hh me b fi mm mj l mk ml">#Handling Binary Variables<br/>#replace acceptedcampaign, complain and response<br/>final[['AcceptedCmp1','AcceptedCmp2','AcceptedCmp3','AcceptedCmp4','AcceptedCmp5','Complain','Response']] = final[['AcceptedCmp1','AcceptedCmp2','AcceptedCmp3','AcceptedCmp4','AcceptedCmp5','Complain','Response']].replace(0,'No')<br/>final[['AcceptedCmp1','AcceptedCmp2','AcceptedCmp3','AcceptedCmp4','AcceptedCmp5','Complain','Response']] = final[['AcceptedCmp1','AcceptedCmp2','AcceptedCmp3','AcceptedCmp4','AcceptedCmp5','Complain','Response']].replace(1,'Yes')</span></pre><p id="70ef" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们还会检查缺失值，如果可能的话，会对它们进行估算。</p><pre class="ld le lf lg fd md me mf mg aw mh bi"><span id="636b" class="li ka hh me b fi mi mj l mk ml">#Check for missing values<br/>print(final.isnull().sum())</span></pre><figure class="ld le lf lg fd ii er es paragraph-image"><div class="er es mn"><img src="../Images/92fee860fe24c9762fa4f05526e1f8c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:558/format:webp/1*rqkCMMeqzrLG3gZNDFNf5Q.png"/></div></figure><p id="09ce" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">然后，我们删除Year_Birth、Dt_Customer和Recency，然后将数据导出到我们的文件夹，以进行下一步。</p><pre class="ld le lf lg fd md me mf mg aw mh bi"><span id="529c" class="li ka hh me b fi mi mj l mk ml">datatoclust = final.drop(['Dt_Customer','Recency','Year_Birth'],axis = 1,inplace =False)<br/>datatoclust.to_csv('readytoclust.csv',index = False)</span></pre><p id="167a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们的数据适合进行聚类！<br/>接下来的步骤，也是我们将要讨论的主题(降维&amp;聚类)，可以在本文的第2部分看到。</p><blockquote class="js jt ju"><p id="9877" class="iu iv jv iw b ix iy iz ja jb jc jd je jw jg jh ji jx jk jl jm jy jo jp jq jr ha bi translated">第二部分:<br/><a class="ae it" href="https://sea-remus.medium.com/discovering-customer-segments-using-machine-learning-part-2-dimension-reduction-and-clustering-36c6108599f9" rel="noopener">https://sea-Remus . medium . com/discovery-customer-segments-using-machine-learning-PART-2-dimension-reduction-and-clustering-36c 6108599 F9</a></p></blockquote><p id="0a4d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">那里见！</p></div></div>    
</body>
</html>