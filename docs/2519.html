<html>
<head>
<title>Predicting House Price With Random Forest Regressor</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用随机森林回归方程预测房价</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predicting-house-price-with-random-forest-regressor-6e9a7c7f75dd?source=collection_archive---------2-----------------------#2021-04-29">https://medium.com/analytics-vidhya/predicting-house-price-with-random-forest-regressor-6e9a7c7f75dd?source=collection_archive---------2-----------------------#2021-04-29</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/b0cbc2ee710bb2a661dcb1833ccce71f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*FN5pcQ-OcLkxgHwMzqZABA.jpeg"/></div><figcaption class="il im et er es in io bd b be z dx translated">预测房价</figcaption></figure><p id="119e" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在机器学习中，有分类和回归模型。两者的区别在于分类预测输出(或y)为是或否，1或0，或其他一些类别。然而，在回归中，我们想要的输出是价值，比如房子的价格。</p><p id="12e5" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">在这次房价预测中，回归模型是一个很好的实践。因为在输出中我们需要预测一个连续的值。</p><h1 id="89c2" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">数据概述</h1><p id="75db" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">我们已经从<a class="ae kq" href="https://www.kaggle.com/dansbecker/melbourne-housing-snapshot" rel="noopener ugc nofollow" target="_blank"> kaggle </a>获取了数据。我们将在模型中使用这些数据。完整的数据集包含具有21个属性的423，857行数据。让我们来看看。</p><blockquote class="kr ks kt"><p id="e8d1" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">#导入所需的包。<br/>import numpy as NP<br/>import pandas as PD<br/>import matplotlib . py plot as PLT<br/>import seaborn as SNS<br/>from scipy . stats import spearman r</p><p id="922b" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">df = pd.read_csv("../input/dataset/melb_data.csv ")</p><p id="1c08" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">df.dtypes</p></blockquote><figure class="kz la lb lc fd ii er es paragraph-image"><div class="er es ky"><img src="../Images/09f5ec57ff4498d214984c0fd9315f15.png" data-original-src="https://miro.medium.com/v2/resize:fit:384/format:webp/1*cUE3C58r77i_NJOYtE2Kmw.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">要素的数据类型</figcaption></figure><h1 id="b3fd" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">数据准备</h1><p id="8220" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">数据清理</p><blockquote class="kr ks kt"><p id="dfd4" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">df.isna()。总和()</p></blockquote><figure class="kz la lb lc fd ii er es paragraph-image"><div class="er es ld"><img src="../Images/7941cd17b514a3ef23231026a0292cce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*EXMNNJrAy6j9ch91Q-yKgg.png"/></div><figcaption class="il im et er es in io bd b be z dx translated">数据中存在缺失值，因此我们需要填充它们</figcaption></figure><p id="03e9" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">首先，我们将看看具有缺失价值的特征与房价的关系。</p><p id="1ea3" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">看专题车</strong></p><blockquote class="kr ks kt"><p id="0133" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">sns.scatterplot(x = df["汽车"]，y = df["价格"])</p></blockquote><figure class="kz la lb lc fd ii er es paragraph-image"><div class="er es le"><img src="../Images/150f42f15b5b7a68fe3e50ae59c7570c.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*p7IryQIpndbIdagsJQhxaw.png"/></div></figure><blockquote class="kr ks kt"><p id="4acf" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">df[“车”]。值计数()</p></blockquote><figure class="kz la lb lc fd ii er es paragraph-image"><div class="er es lf"><img src="../Images/95038b74e882a480ae4d4b3c2bf81f99.png" data-original-src="https://miro.medium.com/v2/resize:fit:410/format:webp/1*NTMyF5aFi3YqMxbOer-laQ.png"/></div></figure><p id="3e9c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">查看特征构建区域</strong></p><blockquote class="kr ks kt"><p id="5655" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">sns.scatterplot(x = df["建筑面积"]，y = df["价格"])</p></blockquote><figure class="kz la lb lc fd ii er es paragraph-image"><div class="er es lg"><img src="../Images/d26090bc59f9adb22c12414b066d6d78.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*YsA4NBhr6yAyQX5-LK7HKg.png"/></div></figure><blockquote class="kr ks kt"><p id="b1b3" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">df["BuildingArea"]。值计数()</p></blockquote><figure class="kz la lb lc fd ii er es paragraph-image"><div class="er es lh"><img src="../Images/3d90252a13dedbdf7fbfffb15e5d8f86.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*FWAWGIw3wiMKY3ll6FiMAw.png"/></div></figure><p id="7b05" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">为一年建成</p><blockquote class="kr ks kt"><p id="bb8c" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">SNS . box plot(data = df[" year build "])</p></blockquote><figure class="kz la lb lc fd ii er es paragraph-image"><div class="er es li"><img src="../Images/61cd86457981719900607893ad1487d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*l6EZkCMod9qPGuz4XLdt-Q.png"/></div></figure><p id="391d" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">用于议员区</strong></p><blockquote class="kr ks kt"><p id="7567" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">df["议会区"]。值计数()</p></blockquote><figure class="kz la lb lc fd ii er es paragraph-image"><div class="er es lj"><img src="../Images/14fba910efd5d272e4df53989470aea8.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*mnIRVHcTA2S7sZiZdWBlvw.png"/></div></figure><p id="7b84" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">通过查看图表，我们可以用前向值或后向值填充缺失值，因为它们是连续递增或递减的。</strong></p><blockquote class="kr ks kt"><p id="6358" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">df = df.fillna(method='ffill ')。fillna(method='bfill ')</p></blockquote><p id="670c" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">功能选择:</strong></p><blockquote class="kr ks kt"><p id="ef6b" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">sns.regplot(x = df["纬度"]，y = df["价格"])</p></blockquote><figure class="kz la lb lc fd ii er es paragraph-image"><div class="er es lk"><img src="../Images/0081d0bef280b9c9bf89106821afb81e.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*iUkncsVMU2Xcsuh9AwMxQA.png"/></div></figure><p id="c660" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">corr，_ = spearmanr(df["Lattitude"]，df[" Price "])<br/>print(' spearman相关性:%.3f' % corr</p><pre class="kz la lb lc fd ll lm ln lo aw lp bi"><span id="7c44" class="lq jo hh lm b fi lr ls l lt lu">Spearmans correlation: -0.260</span></pre><p id="98d2" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">因为我们看到纬度特征与目标特征负相关，所以我们将其移除。</strong></p><blockquote class="kr ks kt"><p id="78ca" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">sns.regplot(x = df["Longtitude"]，y = df["Price"])</p></blockquote><figure class="kz la lb lc fd ii er es paragraph-image"><div class="er es lv"><img src="../Images/25a3b121c1f926b35efaf11551b08f31.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*QQMi4GV6I6_vgivgX_uM0g.png"/></div></figure><blockquote class="kr ks kt"><p id="4be5" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">corr，_ = spearmanr(df["Longtitude"]，df[" Price "])<br/>print(' spearman相关性:%.3f' % corr)</p></blockquote><pre class="kz la lb lc fd ll lm ln lo aw lp bi"><span id="be51" class="lq jo hh lm b fi lr ls l lt lu">Spearmans correlation: 0.262</span></pre><p id="4203" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">我们可以看到日期与房价无关，所以我们可以删除它。</strong></p><blockquote class="kr ks kt"><p id="8a22" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">del df["纬度"] <br/> del df["经度"] <br/> del df["日期"]</p></blockquote><p id="9223" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated">df[df.columns[:]]。corr()['价格'][:]</p><figure class="kz la lb lc fd ii er es paragraph-image"><div class="er es lw"><img src="../Images/d5f10cb7d9a7fcefa403c4129370ab93.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/1*3JSARpyjpm1scH9iJ4Dd6Q.png"/></div></figure><h1 id="3ae3" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">模型比较和评估</h1><p id="8bb2" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">大部分工作已经完成了。现在，我们可以对数据运行RandomForestRegression模型。</p><figure class="kz la lb lc fd ii er es paragraph-image"><div class="er es lx"><img src="../Images/68112a558f50c3ed1794399829c63f23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f7zfAnyFscAhQtOT5ahGVQ.png"/></div></figure><blockquote class="kr ks kt"><p id="bde6" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">从sklearn.linear_model导入LinearRegression <br/>从sklearn.model_selection导入train_test_split <br/>从sklearn.tree导入决策树Regressor <br/>从sklearn.ensemble导入RandomForestRegressor <br/>从sklearn.model_selection导入cross_val_score</p></blockquote><p id="b72f" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">选择目标变量</strong></p><blockquote class="kr ks kt"><p id="96db" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">y = df["价格"] <br/> del df["价格"]</p></blockquote><p id="f1f4" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">对分类特征进行一次热编码。</strong></p><blockquote class="kr ks kt"><p id="66f9" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">df[" suburban "]= PD . get _ dummies(df[" suburban "])<br/>df[" Address "]= PD . get _ dummies(df[" Address "])<br/>df[" Method "]= PD . get _ dummies(df[" Method "])<br/>df[" sell erg "]= PD . get _ dummies(df[" sell erg "])<br/>df[" region name "]= PD . get _ dummies(df[" region name "])【df[" region name】)</p></blockquote><p id="1e40" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">选择预测目标变量的特征</strong></p><blockquote class="kr ks kt"><p id="ff90" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">x = df</p></blockquote><p id="3bb0" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">将我们的数据分为训练和测试数据，这样我们可以用训练数据训练我们的模型，用测试数据测试我们的模型</strong></p><blockquote class="kr ks kt"><p id="885c" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">x_train，x_test，y_train，y_test = train_test_split(x，y，test_size = 0.2)</p></blockquote><p id="af2b" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">使用RandomForestRegressor，我们使用它是因为我们预测的是一个连续值，所以我们正在应用它。</strong></p><blockquote class="kr ks kt"><p id="ee69" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">model = RandomForestRegressor(max _ depth = 13，random _ state = 0)<br/>model . fit(x _ train，y_train)</p></blockquote><p id="8317" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">使用模型预测数据</strong></p><blockquote class="kr ks kt"><p id="2a9d" class="ip iq ku ir b is it iu iv iw ix iy iz kv jb jc jd kw jf jg jh kx jj jk jl jm ha bi translated">y_pred =模型.预测(x _测试)</p></blockquote><p id="c3fe" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">使用性能指标评估模型。</strong></p><pre class="kz la lb lc fd ll lm ln lo aw lp bi"><span id="27d9" class="lq jo hh lm b fi lr ls l lt lu">print(metrics.r2_score(y_test,y_pred))<br/>0.798251224006463</span></pre><h1 id="fd56" class="jn jo hh bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">结论</h1><p id="c8e6" class="pw-post-body-paragraph ip iq hh ir b is kl iu iv iw km iy iz ja kn jc jd je ko jg jh ji kp jk jl jm ha bi translated">有了这个，我们涵盖了很多东西，从可视化数据，清理数据，评估模型，并做预测。模型的精确度可能不是很高，但是我们可以看到实现回归预测的过程。为了改进预测或模型训练，我们可以只为我们的模型选择最相关的属性。</p><p id="0154" class="pw-post-body-paragraph ip iq hh ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ha bi translated"><strong class="ir hi">你可以在这里</strong> 找到我们的kaggle笔记本 <a class="ae kq" href="https://www.kaggle.com/geraabhishek/level4new" rel="noopener ugc nofollow" target="_blank"> <strong class="ir hi"/></a></p></div></div>    
</body>
</html>