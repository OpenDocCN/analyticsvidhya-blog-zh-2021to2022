<html>
<head>
<title>A Quick Method for Generating Long Code Scripts that Every Analyst Should Know</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一种快速生成每个分析师都应该知道的长代码脚本的方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/a-quick-method-for-generating-long-code-scripts-that-every-analyst-should-know-15ea38c65e2a?source=collection_archive---------8-----------------------#2021-05-04">https://medium.com/analytics-vidhya/a-quick-method-for-generating-long-code-scripts-that-every-analyst-should-know-15ea38c65e2a?source=collection_archive---------8-----------------------#2021-05-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/63371bcfb3e0fffd9b932f27d61f8485.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ntMlNJndOriQC7EO"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">马库斯·斯皮斯克在<a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="9488" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">作为一名分析师(或类似人员)，我们都经历过。您的经理要求您为他们稍后参加的会议生成一份最新销售数据的报告。您已经在SQL数据库中设置了一个漂亮的表格，显示了按型号细分的最新数字，因此您需要做的就是这样的事情:</p><figure class="js jt ju jv fd ii"><div class="bz dy l di"><div class="jw jx l"/></div></figure><p id="1d9a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">简单吧？</p><p id="46c5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">所以你给他们发邮件，告诉他们最后出现的号码，然后就什么都不想了。然后在会议开始前10分钟，你会收到一封感谢你的电子邮件，但实际上他们只想要“有限”型号的总销量，所需的型号在他们附上的Excel电子表格中。您在工作表中查找并找到一个500个模型的列表…将所有这些都放入一个SQL查询中需要很长时间的格式化！</p><p id="ae46" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">那你是做什么的？如果幸运的话，可能有一些方法可以轻松地提取这些模型，例如，如果它们属于某一特定类型，并且该类型包含在您的销售表中。但是让我们假设这些型号是随机的，这样对我们没有帮助。</p><p id="6a6c" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">一个解决方案是使用类似Notepad++的东西，你可以在里面创建一些小的宏来重复选择的动作。这可能很复杂，但是通过练习就足够简单了。或者在你的IDE中可能有允许你做这种事情的东西。然而，并不是每个人都可以访问这些，我确实在非常封闭的环境中工作过，在那里我不能下载任何种类的新软件。您也可以使用类似于<a class="ae it" href="https://www.sqlservertutorial.net/sql-server-stored-procedures/sql-server-dynamic-sql/" rel="noopener ugc nofollow" target="_blank">的动态SQL </a>来生成代码，但是您只有非常有限的时间，并且不是所有的SQL版本都可以这样做。</p><p id="a45e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">但是每个人都可以使用类似电子表格软件的Excel，那么为什么不使用它呢？假设这是我们收到的清单中的一小段:</p><figure class="js jt ju jv fd ii er es paragraph-image"><div class="er es jy"><img src="../Images/85bb7abf4858ee8e09f6510f79e8dbb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:386/format:webp/1*2mqZnbJHnz0DVnMuMuARew.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">所需型号列表的一个小样本</figcaption></figure><p id="3648" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">首先，我们需要手动创建第一个案例，因为它在WHERE子句中的语法略有不同:</p><figure class="js jt ju jv fd ii"><div class="bz dy l di"><div class="jw jx l"/></div></figure><p id="522d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">所以现在我们需要为每个期望的模型准备一堆OR语句(注意，使用‘in’语句是更好的SQL实践，但是这种格式对于这里的演示来说更清楚)。为此，我们可以在Excel的单元格B3中使用以下语句:</p><p id="fa41" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">=CONCAT("OR Model_Number = ' "，A3，"'")</p><p id="49b6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这将在单元格中生成以下内容:</p><p id="3834" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">或者Model_Number = 'A18901 '</p><p id="6417" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">它只是把几个字符串放在一起生成我们想要的代码，因为它是对有问题的单元格的动态引用，它会随着我们在列表中的下移而调整。</p><p id="ed65" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">然后，我们可以将该公式向下拖动(使用单元格B3的右下角)到型号列表的末尾，这样我们就有了一整套可以使用的SQL语句:</p><figure class="js jt ju jv fd ii er es paragraph-image"><div class="er es jz"><img src="../Images/93b1d29f842223b9ca3ea696a4a9d741.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*hX5BA80yf5u4zMUgmhEPGA.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">生成OR语句</figcaption></figure><p id="70fa" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们现在可以简单地将这些单元格复制并粘贴到我们的代码中，这样我们就有了完整的WHERE语句:</p><figure class="js jt ju jv fd ii"><div class="bz dy l di"><div class="jw jx l"/></div></figure><p id="cab0" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">显然，这只是一个很小的例子，一点剪切粘贴可能会更有效，但对于较大的情况，这是非常有用的。对于更常规的报告，我不建议使用这种方法，应该使用更复杂和可控的方法。但是对于那些你需要一个快速和肮脏的解决方案的时刻，这是每一个分析师或数据科学家都应该准备好的技巧，显然这可以适用于任何语言和许多情况。这当然比花几个小时手动记录要好！</p></div></div>    
</body>
</html>