<html>
<head>
<title>MultiLabel Classification of sexual harassment personal stories. #MeToo</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">性骚扰个人故事的多标签分类。#MeToo</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/multilabel-classification-of-sexual-harassment-personal-stories-metoo-19443ee0c763?source=collection_archive---------10-----------------------#2021-03-08">https://medium.com/analytics-vidhya/multilabel-classification-of-sexual-harassment-personal-stories-metoo-19443ee0c763?source=collection_archive---------10-----------------------#2021-03-08</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/ce48b023554b360d6e256d943c02ea9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cSt_tN8zbx_9i6I8BsaJ3g.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">来源:谷歌图片</figcaption></figure><h1 id="86a1" class="it iu hh bd iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq bi translated"><strong class="ak"> <em class="jr">目录:📋</em>T3】</strong></h1><ol class=""><li id="79a7" class="js jt hh ju b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj bi translated"><strong class="ju hi">问题概述。</strong></li><li id="e306" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated"><strong class="ju hi">机器学习如何帮助我们解决这个问题。</strong></li><li id="a412" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated"><strong class="ju hi">我们的数据来源及其概述。</strong></li><li id="78dd" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated"><strong class="ju hi">针对此类任务的现有解决方案。</strong></li><li id="439f" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated"><strong class="ju hi">选择正确的绩效指标。</strong></li><li id="f568" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated"><strong class="ju hi">先切进场。</strong></li><li id="da94" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated"><strong class="ju hi">探索性数据分析。</strong></li><li id="ef95" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated"><strong class="ju hi">数据预处理和特征工程。</strong></li><li id="d11f" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated">不同模型的实验。</li><li id="0d86" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated"><strong class="ju hi">创建一个端到端的管道，提供从原始输入获得预测的最佳模型。</strong></li><li id="fe0f" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated"><strong class="ju hi">未来的工作。</strong></li><li id="d0d0" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated"><strong class="ju hi">参考文献。</strong></li></ol></div><div class="ab cl kp kq go kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="ha hb hc hd he"><blockquote class="kw"><p id="91ce" class="kx ky hh bd kz la lb lc ld le lf kf dx translated">1.问题概述。🔍</p></blockquote><p id="ba12" class="pw-post-body-paragraph lg lh hh ju b jv li lj lk jx ll lm ln jz lo lp lq kb lr ls lt kd lu lv lw kf ha bi translated">首先，世界上有许多女性受到男性的性骚扰和攻击。由于缺乏勇气，妇女变得无助，无法保护自己。</p><p id="412e" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">为了揭示这个问题，来自纽约的美国活动家Tarana Burke于2006年在Myspace社交网络上发起了MeToo运动，以促进“通过移情赋予权力”。这有助于其他有类似经历的妇女大声反对这些活动并为自己辩护。</p><p id="1859" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">2017年10月晚些时候，美国女演员艾莉莎·米兰诺在推特上发布了她对性骚扰的看法，并附有一个MeToo标签(#MeToo)。这很快就用英语传遍了全世界。这一运动得到了广泛传播，数百万人开始在社交媒体上与MeToo标签分享他们的故事，获得了大公司和平民的关注。</p><p id="23a7" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">在米兰2017年10月15日发布推文的同一天，MeToo标签上的推文被发现超过200，000次，在接下来的24小时内，推文超过500，000次。</p><p id="b3a8" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">脸书报告称，美国45%的用户有一个朋友用这个词发帖。很多名人也用#MeToo stories回复了。</p><figure class="md me mf mg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mc"><img src="../Images/824357fcf5206b6f6bb78758ff1ee3b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*U9tVJqi8_6RfswvG.png"/></div></div></figure><p id="8dcb" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">这一统计证据显示了这场运动的影响有多大。</p><p id="8088" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">随着这些个人故事数量的增加，很难对在线论坛SafeCity上共享的这些故事进行手动分类，该论坛可以识别犯罪模式并采取必要的行动来创建一个更安全的地方。</p></div><div class="ab cl kp kq go kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="ha hb hc hd he"><blockquote class="kw"><p id="377d" class="kx ky hh bd kz la lb lc ld le lf kf dx translated"><em class="jr"> 2。机器学习如何帮助我们解决这个问题。📝</em></p></blockquote><p id="f22f" class="pw-post-body-paragraph lg lh hh ju b jv li lj lk jx ll lm ln jz lo lp lq kb lr ls lt kd lu lv lw kf ha bi translated">问题是将这些故事分类，它们可能属于一个或多个类别。这种类型的问题可以映射到多标签分类，其中一个故事可以有一个以上的类别与之相关联。</p><p id="68a1" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">由于故事是文本形式的，我们可以利用自然语言处理的能力来完成这项任务。</p></div><div class="ab cl kp kq go kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="ha hb hc hd he"><blockquote class="kw"><p id="a873" class="kx ky hh bd kz la lb lc ld le lf kf dx translated">3.数据来源及其概述📂</p></blockquote><p id="c06c" class="pw-post-body-paragraph lg lh hh ju b jv li lj lk jx ll lm ln jz lo lp lq kb lr ls lt kd lu lv lw kf ha bi translated">这个问题摘自一篇研究论文。</p><div class="mh mi ez fb mj mk"><a href="https://safecity.in/publications/research-papers/" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab dw"><div class="mm ab mn cl cj mo"><h2 class="bd hi fi z dy mp ea eb mq ed ef hg bi translated">安全城市</h2><div class="mr l"><h3 class="bd b fi z dy mp ea eb mq ed ef dx translated">安全城市是一个平台即服务产品，它为社区、警察和市政府提供动力，以防止暴力事件的发生。</h3></div><div class="ms l"><p class="bd b fp z dy mp ea eb mq ed ef dx translated">安全城市</p></div></div><div class="mt l"><div class="mu l mv mw mx mt my in mk"/></div></div></a></div><p id="c603" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">研究论文中使用的数据集来自在线平台Safecity，该平台收集和分析众包匿名暴力犯罪报告，确定模式和关键见解。</p><div class="mh mi ez fb mj mk"><a href="https://github.com/swkarlekar/safecity" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab dw"><div class="mm ab mn cl cj mo"><h2 class="bd hi fi z dy mp ea eb mq ed ef hg bi translated">安全卡/安全城市</h2><div class="mr l"><h3 class="bd b fi z dy mp ea eb mq ed ef dx translated">安全城市:理解不同形式的性骚扰个人故事，EMNLP 2018作者:Sweta Karlekar &amp; Mohit…</h3></div><div class="ms l"><p class="bd b fp z dy mp ea eb mq ed ef dx translated">github.com</p></div></div><div class="mt l"><div class="mz l mv mw mx mt my in mk"/></div></div></a></div><p id="05b8" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated"><strong class="ju hi">数据集介绍— </strong></p><p id="0ff2" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">我们有三个文件中的数据:培训、开发和测试</p><p id="e788" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">train.csv中的行数= 7201</p><p id="f9ba" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">dev.csv中的行数= 990</p><p id="bb69" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">test.csv中的行数= 1701</p><p id="fed7" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">所有数据文件包含4列:</p><p id="7334" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">描述(字符串对象):一个受害者的个人故事，在社交媒体上与MeToo标签分享。</p><p id="287e" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">注释(整数):说明是否属于注释类别的描述标签。</p><p id="26a4" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">抛媚眼/面部表情/凝视(整数):描述的标签，说明它是否属于抛媚眼、面部表情、凝视类别。</p><p id="5416" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">触摸/摸索(整数):说明是否属于触摸、摸索类别的描述标签。</p><h2 id="b8ba" class="na iu hh bd iv nb nc nd iz ne nf ng jd jz nh ni jh kb nj nk jl kd nl nm jp nn bi translated">示例数据点—</h2><p id="e0b0" class="pw-post-body-paragraph lg lh hh ju b jv jw lj lk jx jy lm ln jz no lp lq kb np ls lt kd nq lv lw kf ha bi translated">描述:当一个男孩来倒水时，我正在水龙头旁。他发现一个14岁的女孩在等着打水，就抓住她的手把她拖走了。</p><p id="7a0b" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">正在评论:0</p><p id="e1d7" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">色迷迷/面部表情/凝视:0</p><p id="c9fd" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">触摸/摸索:1</p><p id="e20c" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">这个描述属于触摸/摸索的范畴</p></div><div class="ab cl kp kq go kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="ha hb hc hd he"><blockquote class="kw"><p id="fffe" class="kx ky hh bd kz la lb lc ld le lf kf dx translated">4.针对此类任务的现有解决方案✏️</p></blockquote><p id="a3c4" class="pw-post-body-paragraph lg lh hh ju b jv li lj lk jx ll lm ln jz lo lp lq kb lr ls lt kd lu lv lw kf ha bi translated">在之前提到的研究论文中。它使用CNN、RNN和CNN-RNN类型架构的深度学习模型，在多标签分类上嵌入单词。</p><h2 id="2a10" class="na iu hh bd iv nb nc nd iz ne nf ng jd jz nh ni jh kb nj nk jl kd nl nm jp nn bi translated">改进—</h2><p id="a0d2" class="pw-post-body-paragraph lg lh hh ju b jv jw lj lk jx jy lm ln jz no lp lq kb np ls lt kd nq lv lw kf ha bi translated">现在，我们将在单词嵌入的基础上添加一些额外的功能，例如</p><ul class=""><li id="f272" class="js jt hh ju b jv lx jx ly jz nr kb ns kd nt kf nu kh ki kj bi translated">按单词级别和字符级别划分的文本长度。</li><li id="e5a5" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf nu kh ki kj bi translated">给定描述的情感分数。</li></ul><h2 id="b089" class="na iu hh bd iv nb nc nd iz ne nf ng jd jz nh ni jh kb nj nk jl kd nl nm jp nn bi translated">实验的—</h2><p id="f878" class="pw-post-body-paragraph lg lh hh ju b jv jw lj lk jx jy lm ln jz no lp lq kb np ls lt kd nq lv lw kf ha bi translated">我们将尝试不同的单词嵌入，例如:</p><ul class=""><li id="1aa0" class="js jt hh ju b jv lx jx ly jz nr kb ns kd nt kf nu kh ki kj bi translated">预训练手套嵌入</li><li id="2d4a" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf nu kh ki kj bi translated">以手套嵌入作为词向量的tfidf-W2V</li><li id="ee85" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf nu kh ki kj bi translated">预训练快速文本嵌入</li><li id="4789" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf nu kh ki kj bi translated">tfidf-W2V使用快速文本嵌入作为词向量</li></ul></div><div class="ab cl kp kq go kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="ha hb hc hd he"><blockquote class="kw"><p id="3ecf" class="kx ky hh bd kz la lb lc ld le lf kf dx translated">5.选择正确的绩效指标:📏</p></blockquote><p id="951d" class="pw-post-body-paragraph lg lh hh ju b jv li lj lk jx ll lm ln jz lo lp lq kb lr ls lt kd lu lv lw kf ha bi translated">f1-得分= 2 *(精确度*召回率)/(精确度+召回率)</p><p id="a739" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">在多标签分类的情况下，我们在计算F1分数时有两种类型</p><p id="7656" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated"><strong class="ju hi">宏观平均F1-分数</strong>:在这种情况下，我们简单地分别计算每个班级的F1-分数，并取F1_score的平均值以获得总体F1-分数。在我们的例子中，我们有3个类，因此，我们计算各个类的精确度和召回率，并取它们的平均值来计算宏观F1分数</p><p id="aaeb" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">宏精度=(精度1+精度2+精度3)/3</p><p id="9e8c" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">宏观召回=(召回1+召回2+召回3)/3</p><p id="5f95" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">宏F1= 2 *(宏精度*宏召回)/(宏精度+宏召回)</p><p id="6f40" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated"><strong class="ju hi">微平均F1分数</strong>:在这种情况下，我们通过对所有TP和类型错误求和来计算整个类的精度和召回率，而不是对单个类进行计算。然后，我们计算F1分数作为精确度和召回率的调和平均值。</p><p id="aa29" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">微精度=(TP 1+TP 2+TP 3)/(TP 1+FP 1+TP 2+FP 2+TP 3+FP 3)</p><p id="257d" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">微召回=(TP 1+TP 2+TP 3)/(TP 1+fn1+TP 2+fn2+TP 3+fn3)</p><p id="5a0f" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">微F1=2 *(微精度*微召回)/(微精度+微召回)</p><p id="a369" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated"><strong class="ju hi">海明损失</strong>:是标签分类不正确的部分。</p><p id="e272" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">例如:如果3个标签中有2个分类错误。汉明损耗= 2/3</p><p id="9030" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated"><strong class="ju hi">精确数学比</strong>:表示所有标签分类正确的样本的百分比。它只关心正确的分类，而忽略部分正确的分类。</p><p id="66cf" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">这里，每个描述类的分类非常重要，因此我们将使用宏观F1分数作为我们的性能指标。因为宏观F1-score以同等的重要性对待所有的类，而微观F1-score只关注所有的类。</p></div><div class="ab cl kp kq go kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="ha hb hc hd he"><blockquote class="kw"><p id="f6ad" class="kx ky hh bd kz la lb lc ld le lf kf dx translated"><strong class="ak"> 6。第一次切割方法。</strong></p></blockquote><ol class=""><li id="28a1" class="js jt hh ju b jv li jx ll jz nv kb nw kd nx kf kg kh ki kj bi translated">我们将对我们拥有的数据集进行一些分析，即我们拥有的数据点总数以及每个特征对应的内容，检查数据中是否存在任何重复项，并删除这些重复项。</li><li id="f58e" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated">稍后，我们将进行一些基本的探索性数据分析(EDA ),如从以下图中得出结论。</li><li id="6da9" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated">我们将进行数据预处理和数据清理，包括删除可以从nltk库中获得的停用词、删除特殊符号、解连接单词(如(不能-&gt;不能，它是-&gt;它是)，以及将整个文本转换为小写。</li><li id="190c" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated">作为基线模型，我们将使用sklearn的多输出分类器。为此，将文本句子转换为tfidf-w2v表示，w2v嵌入可以从预训练的手套模型中取出。现在，我们将使用这些训练数据来拟合多输出分类器，并将其作为基线模型结果。</li></ol></div><div class="ab cl kp kq go kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="ha hb hc hd he"><blockquote class="kw"><p id="f480" class="kx ky hh bd kz la lb lc ld le lf kf dx translated">7.探索性数据分析📊</p></blockquote><figure class="nz oa ob oc od ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ny"><img src="../Images/3a803fa376547235c97de74f94e85942.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qq7iA5NNaf2JM2gc12l4Gg.png"/></div></div></figure><p id="e66f" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">不存在缺失数据，因为我们有单一的文本特征，所以文本中不存在缺失数据。</p><p id="ef51" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">我们将检查故事的副本。</p><figure class="md me mf mg fd ii er es paragraph-image"><div class="er es oe"><img src="../Images/a09d05bd0b3cbc226c82f6944cbc9774.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*DrAjQHRDNlb0nJp30I26yw.png"/></div></figure><p id="e062" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">我们发现有542个重复，我们进一步分析这些重复的行。</p><figure class="md me mf mg fd ii er es paragraph-image"><div class="er es of"><img src="../Images/a52e484f7c432d1e6f57fd3dfd360771.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*X6kvkvsHXDS-Tk9pjqKpgQ.png"/></div></figure><figure class="md me mf mg fd ii er es paragraph-image"><div class="er es og"><img src="../Images/a5504ea9c49751c1eb48886787832119.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*Pe17772LoMCJ44YgBFHX-Q.png"/></div></figure><p id="e236" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">通过检查单个描述中的重复项，我们可以注意到许多行是重复的，这可能是在手工标记数据时发生的，其中单个单词在不同的情况下被解释为属于不同的类别。</p><p id="f489" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">为了避免这种歧义，我们用标签为1，1，1的单个点替换一个点的所有副本</p><figure class="md me mf mg fd ii"><div class="bz dy l di"><div class="oh oi l"/></div></figure><p id="fef3" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">我们绘制了不同类别之间的分数分布:</p><figure class="md me mf mg fd ii er es paragraph-image"><div class="er es oj"><img src="../Images/f74ca1e3c9940a421f9378a63484d30f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*D-ZUfKKxRy4fcBHF1d2W8w.png"/></div></figure><p id="1d25" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">在训练模型时，我们需要记住类之间的一些类不平衡。</p><p id="ae88" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">现在，我们绘制标签计数与具有该标签计数的故事数量的关系图:</p><figure class="md me mf mg fd ii"><div class="bz dy l di"><div class="oh oi l"/></div></figure><figure class="md me mf mg fd ii er es paragraph-image"><div class="er es ok"><img src="../Images/f3f0af58919b8186129e1bbe80cea4c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*b9OFSJE9RgqdbY5Rd1pB_w.png"/></div></figure><p id="45e0" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">从这个图中我们可以看出，大多数故事都与一个标签相关联，或者没有标签，很少有故事同时具有三个标签。</p></div><div class="ab cl kp kq go kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="ha hb hc hd he"><blockquote class="kw"><p id="c780" class="kx ky hh bd kz la lb lc ld le lf kf dx translated">8.<strong class="ak">数据预处理和</strong>特征工程🔧 🔩</p></blockquote><p id="252a" class="pw-post-body-paragraph lg lh hh ju b jv li lj lk jx ll lm ln jz lo lp lq kb lr ls lt kd lu lv lw kf ha bi translated">作为数据预处理的一部分，执行以下文本清理:</p><ul class=""><li id="78f6" class="js jt hh ju b jv lx jx ly jz nr kb ns kd nt kf nu kh ki kj bi translated">单词的分解</li><li id="ce16" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf nu kh ki kj bi translated">删除特殊字符</li><li id="3a47" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf nu kh ki kj bi translated">停用字词删除和</li><li id="522c" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf nu kh ki kj bi translated">堵塞物</li></ul><figure class="md me mf mg fd ii"><div class="bz dy l di"><div class="oh oi l"/></div></figure><p id="4944" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">作为特征工程的一部分，我们将从文本数据中提取这些特征:</p><ul class=""><li id="897c" class="js jt hh ju b jv lx jx ly jz nr kb ns kd nt kf nu kh ki kj bi translated">创建描述向量表示(300维)</li><li id="56e6" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf nu kh ki kj bi translated">按单词级别和字符级别划分的文本长度(二维)</li><li id="2501" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf nu kh ki kj bi translated">使用nltk (4-dim)的文本数据的情感分数</li></ul><p id="38ee" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">我们将获得总共306个特征。</p><p id="4dd3" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">我们将尝试以下4种描述向量表示，并将它们视为4组数据。</p><ul class=""><li id="6ff2" class="js jt hh ju b jv lx jx ly jz nr kb ns kd nt kf nu kh ki kj bi translated">预训练手套嵌入</li><li id="8a3d" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf nu kh ki kj bi translated">以手套嵌入作为词向量的tfidf-W2V</li><li id="d7df" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf nu kh ki kj bi translated">预训练快速文本嵌入</li><li id="5214" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf nu kh ki kj bi translated">tfidf-W2V使用快速文本嵌入作为词向量</li></ul><p id="099a" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated"><strong class="ju hi">通过使用下面的代码，我们可以从glove和FastText创建单词嵌入:</strong></p><figure class="md me mf mg fd ii"><div class="bz dy l di"><div class="oh oi l"/></div></figure><p id="0b1f" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated"><strong class="ju hi">通过使用以下功能，您可以提取所有需要的特征:</strong></p><figure class="md me mf mg fd ii"><div class="bz dy l di"><div class="oh oi l"/></div></figure></div><div class="ab cl kp kq go kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="ha hb hc hd he"><blockquote class="kw"><p id="73ab" class="kx ky hh bd kz la lb lc ld le lf kf dx translated">9.不同模型的实验🔧</p></blockquote><p id="6a4f" class="pw-post-body-paragraph lg lh hh ju b jv li lj lk jx ll lm ln jz lo lp lq kb lr ls lt kd lu lv lw kf ha bi translated">我们总共提取了306个特征:</p><p id="7395" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">我们将在4种不同类型的单词嵌入格式上训练每个模型</p><figure class="md me mf mg fd ii"><div class="bz dy l di"><div class="oh oi l"/></div></figure><p id="30da" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">训练手套嵌入格式的堆叠分类器:</p><p id="656c" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">我们使用class_weight='balanced ',因为我们在机器学习模型的数据中有一些不平衡</p><figure class="md me mf mg fd ii"><div class="bz dy l di"><div class="oh oi l"/></div></figure><figure class="md me mf mg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ol"><img src="../Images/79d275bebdf05ba702188bb492e1fc76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kA8Y82nQGZX__xXYuHTeWg.png"/></div></div></figure><p id="0bd5" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">对于深度学习模型，我们编写了一个定制的损失函数，该函数借助于在三个类别之间为正负标签赋予不同的权重来处理类别不平衡。</p><figure class="md me mf mg fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es om"><img src="../Images/6248a7873344ff526000ea2f763ac19e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lKaESCkW_hR2KL9crGsv9Q.png"/></div></div></figure><figure class="md me mf mg fd ii"><div class="bz dy l di"><div class="oh oi l"/></div></figure><figure class="md me mf mg fd ii er es paragraph-image"><div class="er es on"><img src="../Images/70478956c609d24e03fbc07bc9193450.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*f7b3WtLslsZ0zQWMJ7WnDA.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">机器学习模型</figcaption></figure><figure class="md me mf mg fd ii er es paragraph-image"><div class="er es oo"><img src="../Images/d050206b987041df4fa15d4dd30a9fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*ewGa2l_v-aQ6yB2QCGjlJA.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">深度学习模型</figcaption></figure><p id="2818" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">通过观察训练模型的所有结果，我们可以得出结论，与快速文本嵌入相比，手套嵌入做得更好。因此，我们可以在部署时使用手套嵌入。</p><p id="b676" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">最佳机器学习模型:LightGBM和堆叠分类器</p><p id="ddb0" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">最佳深度学习模型:LSTM</p></div><div class="ab cl kp kq go kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="ha hb hc hd he"><blockquote class="kw"><p id="74a8" class="kx ky hh bd kz la lb lc ld le lf kf dx translated">10.<strong class="ak">创建一个端到端的管道，提供从原始输入获得预测的最佳模型。</strong></p></blockquote><p id="9514" class="pw-post-body-paragraph lg lh hh ju b jv li lj lk jx ll lm ln jz lo lp lq kb lr ls lt kd lu lv lw kf ha bi translated">为了创建管道，我们需要将最佳模型保存为pickel文件，并在预测时使用它。我们不应该在创建管道时训练任何模型。</p><p id="7af7" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated">我们需要执行所有的预处理和特征提取步骤来获得模型的输入数据。</p><figure class="md me mf mg fd ii"><div class="bz dy l di"><div class="oh oi l"/></div></figure><figure class="md me mf mg fd ii"><div class="bz dy l di"><div class="oh oi l"/></div></figure><h2 id="d7b7" class="na iu hh bd iv nb nc nd iz ne nf ng jd jz nh ni jh kb nj nk jl kd nl nm jp nn bi translated">输出:</h2><figure class="md me mf mg fd ii er es paragraph-image"><div class="er es op"><img src="../Images/d2c7e6441fbef477413c3ee4cccca0c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*zqvKTO5F0Rkca6gszeDxAA.png"/></div></figure><p id="3476" class="pw-post-body-paragraph lg lh hh ju b jv lx lj lk jx ly lm ln jz lz lp lq kb ma ls lt kd mb lv lw kf ha bi translated"><strong class="ju hi">您可以在下面看到运行部署在AWS-EC2实例上的flask应用程序的录制视频:</strong></p><figure class="md me mf mg fd ii"><div class="bz dy l di"><div class="oq oi l"/></div></figure></div><div class="ab cl kp kq go kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="ha hb hc hd he"><blockquote class="kw"><p id="1da4" class="kx ky hh bd kz la lb lc ld le lf kf dx translated">11.未来的工作🕐</p></blockquote><ul class=""><li id="41e2" class="js jt hh ju b jv li jx ll jz nv kb nw kd nx kf nu kh ki kj bi translated">预训练的Bert模型(768-dim)可用于获得描述向量表示。这些768维的输出通过一个完全连接的神经网络，然后是一个sigmoid激活层。在我们的例子中，我们将有3个sigmoid激活单元，这给出了每个类别标签的概率。</li><li id="6c56" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf nu kh ki kj bi translated">通过适当的架构，可以使用字符级单词嵌入来代替单词级嵌入。</li><li id="fa33" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf nu kh ki kj bi translated">可以进行时间分析以获得模型的更多可解释性，这获得了对模型的单词级贡献。</li></ul></div><div class="ab cl kp kq go kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="ha hb hc hd he"><blockquote class="kw"><p id="fdaf" class="kx ky hh bd kz la lb lc ld le lf kf dx translated">12.参考📚</p></blockquote><ol class=""><li id="7dd4" class="js jt hh ju b jv li jx ll jz nv kb nw kd nx kf kg kh ki kj bi translated"><a class="ae or" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">https://www.appliedaicourse.com/</a></li><li id="cadd" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated">https://arxiv.org/abs/1809.04739<a class="ae or" href="https://arxiv.org/abs/1809.04739" rel="noopener ugc nofollow" target="_blank"/></li><li id="25c0" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated"><a class="ae or" href="https://www.kaggle.com/enforcer007/what-is-micro-averaged-f1-score" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/enforcer 007/what-is-micro-averaged-f1-score</a></li><li id="d724" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated"><a class="ae or" href="https://www.mathworks.com/help/deeplearning/ug/multilabel-text-classification-using-deep-learning.html" rel="noopener ugc nofollow" target="_blank">https://www . mathworks . com/help/deep learning/ug/multi label-text-class ification-using-deep-learning . html</a></li><li id="82ba" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated"><a class="ae or" href="https://www.cs.waikato.ac.nz/~ml/publications/2009/chains.pdf" rel="noopener ugc nofollow" target="_blank">https://www . cs . waikato . AC . NZ/~ ml/publications/2009/chains . pdf</a></li><li id="ecc1" class="js jt hh ju b jv kk jx kl jz km kb kn kd ko kf kg kh ki kj bi translated"><a class="ae or" rel="noopener" href="/the-owl/imbalanced-multilabel-image-classification-using-keras-fbd8c60d7a4b">https://medium . com/the-owl/unbalanced-multi label-image-class ification-using-keras-FBD 8 c 60 D7 a 4b</a></li></ol></div><div class="ab cl kp kq go kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="ha hb hc hd he"><blockquote class="os ot ou"><p id="40d7" class="lg lh ov ju b jv lx lj lk jx ly lm ln ow lz lp lq ox ma ls lt oy mb lv lw kf ha bi translated"><strong class="ju hi"> <em class="hh">如果您需要任何与代码相关的文件，请通过下面给出的链接进入我的GitHub库:</em> </strong></p></blockquote><div class="mh mi ez fb mj mk"><a href="https://github.com/sunilbelde/safecity-multilabel-classification" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab dw"><div class="mm ab mn cl cj mo"><h2 class="bd hi fi z dy mp ea eb mq ed ef hg bi translated">sunil belde/safe city-多标签-分类</h2><div class="mr l"><h3 class="bd b fi z dy mp ea eb mq ed ef dx translated">sexula骚扰个人故事的多标签分类-sunil belde/safe city-多标签分类</h3></div><div class="ms l"><p class="bd b fp z dy mp ea eb mq ed ef dx translated">github.com</p></div></div><div class="mt l"><div class="oz l mv mw mx mt my in mk"/></div></div></a></div><blockquote class="os ot ou"><p id="d504" class="lg lh ov ju b jv lx lj lk jx ly lm ln ow lz lp lq ox ma ls lt oy mb lv lw kf ha bi translated"><strong class="ju hi"> <em class="hh">万一你想在LinkedIn上和我联系，下面是链接。</em>T19】</strong></p></blockquote><div class="mh mi ez fb mj mk"><a href="https://www.linkedin.com/in/sunil-belde-1b4151129/" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab dw"><div class="mm ab mn cl cj mo"><h2 class="bd hi fi z dy mp ea eb mq ed ef hg bi translated">sunil belde -学生应用人工智能课程| LinkedIn</h2><div class="mr l"><h3 class="bd b fi z dy mp ea eb mq ed ef dx translated">查看世界上最大的职业社区LinkedIn上sunil belde的个人资料。sunil有4个工作列在他们的…</h3></div><div class="ms l"><p class="bd b fp z dy mp ea eb mq ed ef dx translated">www.linkedin.com</p></div></div><div class="mt l"><div class="pa l mv mw mx mt my in mk"/></div></div></a></div></div><div class="ab cl kp kq go kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="ha hb hc hd he"><blockquote class="kw"><p id="7746" class="kx ky hh bd kz la lb lc ld le lf kf dx translated">— — —感谢您的阅读— — —</p></blockquote></div></div>    
</body>
</html>