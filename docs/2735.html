<html>
<head>
<title>Medical Image Classification and Segmentation — A Case Study Approach</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">医学图像分类和分割——案例研究方法</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/medical-image-classification-and-segmentation-a-case-study-approach-6b5c7a73b9f5?source=collection_archive---------1-----------------------#2021-05-15">https://medium.com/analytics-vidhya/medical-image-classification-and-segmentation-a-case-study-approach-6b5c7a73b9f5?source=collection_archive---------1-----------------------#2021-05-15</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="2cfd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">用人工智能预测并最终阻止肺萎陷的灾难</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/be29fa99c2c40805ac6b54c987ce96bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*P89xWhl64yVidggu"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">信用:<a class="ae jt" href="https://www.medicalnewstoday.com/articles/318110" rel="noopener ugc nofollow" target="_blank">https://www.medicalnewstoday.com/articles/318110</a></figcaption></figure><p id="b417" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">人工智能正在影响几乎每一个行业。投入到这个领域的巨大投资以及进步的速度只证明了一件事:人工智能已经存在并且正在发展..！)来颠覆每个行业的工作方式。</p><p id="bac2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">医疗领域和这些影响没什么区别。不同类型的应用程序现在都在使用，其中包含一些人工智能的组件。首先，我们将RPA(机器人流程自动化)、聊天机器人和不同的医疗保健分析视为人工智能在该领域的用例。AI还有一个很重要的操作就是医学图像分类分割。</p><p id="f2f7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">人工智能在医学中的大多数应用都会读入某种类型的数据，要么是数字数据(如心率或血压)，要么是基于图像的数据(我们将很快讨论这种数据)。然后，算法从数据中学习并生成概率或分类，然后对受感染部分进行分割。例如，可采取行动的结果可以是给定心率和血压数据的动脉凝块的概率，或者将成像的组织样本标记为癌性或非癌性的概率。</p><p id="1db2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这篇博客中，我们将讨论一个名为“<strong class="ih hj"><em class="ju">”SIIM-ACR气胸分割</em> </strong>”的案例研究，其中包括从胸部x光片中检测疾病。</p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><h1 id="1281" class="kc kd hi bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">内容:</h1><ol class=""><li id="76e3" class="la lb hi ih b ii lc im ld iq le iu lf iy lg jc lh li lj lk bi translated"><em class="ju">商业问题</em></li><li id="ff49" class="la lb hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated"><em class="ju">将现实世界的问题映射为深度学习问题</em></li><li id="ea3e" class="la lb hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated"><em class="ju">数据集分析</em></li><li id="fdf8" class="la lb hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated"><em class="ju">现实世界的业务约束</em></li><li id="2882" class="la lb hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated"><em class="ju">绩效指标</em></li><li id="43a2" class="la lb hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated"><em class="ju">现有方法</em></li><li id="f4e0" class="la lb hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated"><em class="ju">我的第一次切入方式</em></li><li id="425c" class="la lb hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated">埃达</li><li id="c672" class="la lb hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated"><em class="ju">预处理</em></li><li id="89f0" class="la lb hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated"><em class="ju">建模</em></li><li id="09b4" class="la lb hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated"><em class="ju">最终管线</em></li><li id="b330" class="la lb hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated"><em class="ju">部署</em></li><li id="f815" class="la lb hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated"><em class="ju">未来工作</em></li><li id="0356" class="la lb hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated"><em class="ju">参考文献</em></li><li id="758c" class="la lb hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated"><em class="ju"> Github资源库链接</em></li><li id="6d1b" class="la lb hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated"><em class="ju"> Linkedin个人资料</em></li></ol></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><ol class=""><li id="4bb1" class="la lb hi ih b ii ij im in iq lq iu lr iy ls jc lh li lj lk bi translated"><strong class="ih hj">业务问题:</strong></li></ol><p id="6fa0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们开始着手解决方案之前，让我们先了解一下这种临床情况。在正常情况下，肺接触胸腔壁。但是有时，空气积聚在胸壁和肺之间的空间中，即胸膜空间中。这些空气开始给肺部加压，逐渐地一部分或(有时)整个肺部可能会塌陷。这种疾病被称为气胸。气胸基本上是两个词的组合:气胸(空气)和胸腔(胸部)。因此，它也被称为肺萎陷。</p><p id="8d71" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">一些不同的原因会导致气胸，症状也可能千差万别。气胸的原因分为<em class="ju">原发性自发性</em>、<em class="ju">继发性自发性</em>或<em class="ju">外伤性</em>。</p><p id="2670" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">原发性自发性气胸</em> </strong> (PSP)发生在该人没有已知肺部疾病史的情况下。PSP的直接原因不明。</p><p id="d7c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">继发性自发性气胸</em> </strong> (SSP)可由多种肺部疾病和紊乱引起。SSP比PSP携带更严重的症状，它更有可能导致死亡。</p><p id="b7ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">创伤性气胸</em> </strong>是由于撞击或损伤造成的。潜在的原因包括胸部钝伤或损伤胸壁和胸膜空间。</p><p id="6f47" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">气胸通常由放射科医生在胸部x光片上诊断，有时很难确诊。这是因为气胸的症状最初可能很难被注意到，并可能与其他疾病相混淆。一个精确的人工智能算法来检测气胸将在许多临床场景中有用。人工智能可以用于优先解释胸片，或者为非放射科医生提供更有信心的诊断。</p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><p id="1098" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 2 </strong>。<strong class="ih hj">将现实世界的问题映射为深度学习问题:</strong></p><p id="d06f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们在本案例研究中使用的方法将首先在输入的X射线中检测疾病的存在。如果条件存在，那么它将突出显示受感染的部分。所以，在第一阶段，我们在做一个<strong class="ih hj"><em class="ju"/></strong>(气胸有无)的二元分类。根据分类模型的结果，在第二阶段，我们突出显示图像中受感染的部分，即我们使用<strong class="ih hj"> <em class="ju">图像分割</em> </strong>技术。</p><p id="a615" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在继续之前，让我们更好地理解图像分割的主题。</p><p id="8e13" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">什么是图像分割？</strong></p><p id="84cd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">图像分割是将图像的不同元素分类或分割成不同类别的一种方式。虽然这听起来像物体检测，但实际上比这更详细。这是因为在对象检测中，我们在给定图像中的不同对象/类别周围绘制边界框。但是在图像分割中，我们把图像的每个像素归入不同的类。所以我们可以用图像分割来实现更深入的解释。</p><p id="7b5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">图像分割的类型:</em> </strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es lt"><img src="../Images/3da39f34ae65d601d1c2d5663532e23f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BD3YTRXto5RYpKGepwaNSA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">信用:<a class="ae jt" href="https://www.kaggle.com/c/severstal-steel-defect-detection/discussion/108126" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/severstal-steel-defect-detection/discussion/108126</a></figcaption></figure><p id="4a26" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.<strong class="ih hj"><em class="ju"/></strong>— —语义分割——用相同的颜色识别一个对象的所有实例。例如:在上面的图片中，它将所有的人分成相同的类，因此它对所有的人使用相同的颜色段。</p><p id="2307" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.<strong class="ih hj"> <em class="ju">实例分割</em> </strong> — —它识别图像中一个物体的每个实例。例如:在上面的图片中，它将每个人分成不同的类别。</p><p id="d449" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在我们的案例研究中，我们将使用<strong class="ih hj"> <em class="ju">语义分割</em> </strong>类型。</p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><p id="c2ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 3。数据集分析:</strong></p><p id="7f68" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据集取自Kaggle竞赛页面。</p><div class="lu lv ez fb lw lx"><a href="https://www.kaggle.com/c/siim-acr-pneumothorax-segmentation/overview" rel="noopener  ugc nofollow" target="_blank"><div class="ly ab dw"><div class="lz ab ma cl cj mb"><h2 class="bd hj fi z dy mc ea eb md ed ef hh bi translated">SIIM-阿克尔气胸分割法</h2><div class="me l"><h3 class="bd b fi z dy mc ea eb md ed ef dx translated">在胸片中识别气胸疾病</h3></div><div class="mf l"><p class="bd b fp z dy mc ea eb md ed ef dx translated">www.kaggle.com</p></div></div><div class="mg l"><div class="mh l mi mj mk mg ml jn lx"/></div></div></a></div><p id="e78d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">数据由DICOM格式的图像组成，包含<strong class="ih hj"> <em class="ju">游程编码(RLE) </em> </strong>掩码。气胸的实例由注释中的编码二进制掩码指示。一些训练图像具有描绘事件的多个位置的多个注释。没有气胸的图像的遮罩值为-1。任务是在给定的X射线图像中预测气胸的掩模。</p><p id="4f77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">a)给定的文件:</p><p id="f1a2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">train-rle.csv，stage_2_sample_submission.csv(测试数据)，train_images，test_images。</p><p id="7d77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">b)总文件大小:4GB</p><p id="07f1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">c)记录总数:12，954(训练数据)，3204(测试数据)</p><p id="7341" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">d)<strong class="ih hj"><em class="ju">train-rle . CSV</em></strong>包含图像id及其对应的RLE掩码，而<strong class="ih hj"> <em class="ju">测试CSV </em> </strong>文件仅包含图像id。</p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><p id="720e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 4。现实世界的商业约束:</strong></p><p id="9f1e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">a)低延迟非常重要。</p><p id="8353" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">b)错误分类/错误分割的成本相当高，因为我们正在处理医疗数据，因此对这种错误非常敏感。</p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><p id="06c3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 5。绩效指标:</strong></p><h2 id="c33f" class="mm kd hi bd ke mn mo mp ki mq mr ms km iq mt mu kq iu mv mw ku iy mx my ky mz bi translated"><strong class="ak"> A)分割部分:</strong></h2><ol class=""><li id="3b16" class="la lb hi ih b ii lc im ld iq le iu lf iy lg jc lh li lj lk bi translated"><strong class="ih hj"><em class="ju">【Dice系数(IntersectionOverUnion/IOU)</em></strong>:</li></ol><p id="7c53" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">骰子系数</em> </strong>可用于比较预测的分割与其对应的基本事实之间的逐像素一致性。该公式由下式给出:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es na"><img src="../Images/5f5ff507004f33f41d59afec6be96843.png" data-original-src="https://miro.medium.com/v2/resize:fit:308/format:webp/1*G4qlRLG8ok88qEvMSATISg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">信用:<a class="ae jt" href="https://en.wikipedia.org/wiki/S%C3%B8rensen%E2%80%93Dice_coefficient" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/S % C3 % b 8 rensen % E2 % 80% 93 ice _ coefficient</a></figcaption></figure><p id="ae77" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">其中X是预测的像素集合，Y是地面实况。当X和Y都为空时，Dice系数定义为1。</p><p id="c315" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.<strong class="ih hj"> <em class="ju">连击损失——(二元交叉熵+骰子损失/ F1损失):</em> </strong></p><p id="a490" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">对于分割模型的评估，研究人员发现<strong class="ih hj"> <em class="ju">二进制交叉熵</em> </strong>和<strong class="ih hj"> <em class="ju">骰子损失</em> </strong>是我们可以使用的最佳组合损失函数。这个<a class="ae jt" href="https://www.kaggle.com/bigironsphere/loss-function-library-keras-pytorch#BCE-Dice-Loss" rel="noopener ugc nofollow" target="_blank"> <strong class="ih hj"> <em class="ju">组合损失</em> </strong> </a>对于不平衡数据集的问题很有帮助。</p><h2 id="ffad" class="mm kd hi bd ke mn mo mp ki mq mr ms km iq mt mu kq iu mv mw ku iy mx my ky mz bi translated"><strong class="ak"> B)分类部分:</strong></h2><ol class=""><li id="e3a1" class="la lb hi ih b ii lc im ld iq le iu lf iy lg jc lh li lj lk bi translated"><strong class="ih hj"> <em class="ju">假阴性(FN): </em> </strong></li></ol><p id="daf1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">由于我们正在处理医疗数据，我们必须<strong class="ih hj"> <em class="ju">最大限度地减少假阴性</em> </strong>，因为如果患者<em class="ju">患有疾病</em>(即真实标签=阳性)，但模型预测他<em class="ju">是安全的</em>(即预测标签=阴性)可能会被证明是灾难性的。</p><p id="f16f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.<strong class="ih hj"> <em class="ju">精度或阳性预测值(PPV) : </em> </strong></p><p id="ccc8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">阳性预测值或精确度是预测结果为阳性的人确实患有该疾病的概率。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nb"><img src="../Images/c3a5dcc5ea5b8060e41d9f8231a9f914.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*ChGMvmBJ-FGrCOQ9Vs-rDw.png"/></div></figure><p id="0d97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，0.71的PPV意味着如果一个人被预测患有气胸，那么他实际患有该疾病的概率为71%。</p><p id="a866" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.<strong class="ih hj"> <em class="ju">真阳性率(TPR)或敏感度或回忆:</em> </strong></p><p id="6d99" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">灵敏度</em> </strong>或<strong class="ih hj">T</strong>rue<strong class="ih hj">P</strong>positive<strong class="ih hj">R</strong>ate是假设情况实际上是正的，模型输出正的概率。它显示了正类的哪一部分得到了正确的分类。</p><p id="7044" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为我们希望大多数的正类能被正确预测。因此，我们需要高灵敏度(TPR)。</p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><p id="c777" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 6。现有方法:</strong></p><p id="ce96" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">A) <strong class="ih hj"> <em class="ju"> U-Net预测气胸:</em> </strong></p><div class="lu lv ez fb lw lx"><a href="https://www.kaggle.com/reemrashwan/u-net-to-predict-pneumothorax" rel="noopener  ugc nofollow" target="_blank"><div class="ly ab dw"><div class="lz ab ma cl cj mb"><h2 class="bd hj fi z dy mc ea eb md ed ef hh bi translated">U-Net预测气胸</h2><div class="me l"><h3 class="bd b fi z dy mc ea eb md ed ef dx translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自多个数据源的数据</h3></div><div class="mf l"><p class="bd b fp z dy mc ea eb md ed ef dx translated">www.kaggle.com</p></div></div><div class="mg l"><div class="nc l mi mj mk mg ml jn lx"/></div></div></a></div><p id="3089" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这个内核使用普通的unet结构来解决分段问题。它使用具有64–128–256–256–256–256–256模式神经元的6个编码器层和具有512–512–256–128–64模式神经元的5个解码器层。它发现组合损失表现不佳，因此使用自定义指标，如自定义IOU(intersect overunion)以及tf的MeanIoU指标。Keras.metrics包。使用的检查点是模型检查点，用于保存最佳重量和减少LROnPlateau，最佳耐心为5，冷却时间为1。这个内核中没有使用任何增强功能。</p><p id="95f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">b)<strong class="ih hj"><em class="ju">Unet exception Keras进行气胸分割:</em> </strong></p><div class="lu lv ez fb lw lx"><a href="https://www.kaggle.com/meaninglesslives/nested-unet-with-efficientnet-encoder" rel="noopener  ugc nofollow" target="_blank"><div class="ly ab dw"><div class="lz ab ma cl cj mb"><h2 class="bd hj fi z dy mc ea eb md ed ef hh bi translated">带高效网络编码器的嵌套Unet</h2><div class="me l"><h3 class="bd b fi z dy mc ea eb md ed ef dx translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自多个数据源的数据</h3></div><div class="mf l"><p class="bd b fp z dy mc ea eb md ed ef dx translated">www.kaggle.com</p></div></div></div></a></div><p id="5658" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">该内核使用Unet++架构，预训练的EfficientNetB4模型作为编码器，残差块位于解码器部分。为了更好地收敛，他还对最后3层使用了随机加权平均。这个内核中使用的增强是弹性变形、网格变形、光学变形和简单的水平翻转。他分16批使用了尺寸为256x256的图像。他使用像ModelCheckpoint这样的回调来保存最佳模型，并使用余弦退火来定制LearningRateSchedular。</p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><p id="8072" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 7。我的第一次切入方式:</strong></p><p id="198a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">一只</strong>。由于给出的数据是图像，我们不能在这些图像上做太多的EDA。但是图片是在。dcm格式，这种格式存储了大量元数据。利用这些，我打算深入研究图像，以了解数据集的质量。</p><p id="bbdd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> b </strong>。一旦我们提取并分析了元数据，我们需要将格式从。dcm到。进一步的步骤。</p><p id="bfec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> c </strong>。此外，在数据中，我们提供了rle(游程长度编码)，将数据的游程存储为单个数据值和计数，而不是原始总和。我们需要将这个RLE转换成进一步分割过程所需的遮罩。</p><p id="898f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> d </strong>。一旦我们完成了上述步骤，我们的数据将准备好，不同的分类和分割算法可以应用于它。</p><p id="9cc2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> e </strong>。使用日志，我们需要了解哪个模型在性能速度和指标值方面表现更好。</p><p id="e6be" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> f </strong>。然后，我们需要部署最佳模型，以便围绕它构建端到端应用程序。</p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><p id="7078" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 8。探索性数据分析:</strong></p><p id="35f8" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们首先读取包含RLEs和ImageId的CSV文件。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nd ne l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nf"><img src="../Images/b98b854a7bb540dad1af1e71adbf82d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MlHwcZrh7e5SxeYc_JLtNQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">输出</figcaption></figure><p id="0cdd" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们看到，以单个<strong class="ih hj"> <em class="ju"> ImageId </em> </strong>及其对应的<strong class="ih hj"><em class="ju">encoded pixels</em></strong>的形式存在关于图像的信息，即RLE(掩码的游程编码)。</p><p id="2b91" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们检查一下记录的数量。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ng"><img src="../Images/d35bd45c5af25a0828047c40eb31567f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*HR0mVAIoYLO_9uYnS2bh4w.png"/></div></figure><p id="b94c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们一共有<strong class="ih hj"> <em class="ju"> 12954张火车图片</em> </strong>。除了这些，我们有一些明显的重复从上面。总共有<strong class="ih hj"> <em class="ju"> 907 </em> </strong>条记录是<strong class="ih hj"> <em class="ju">重复</em> </strong>。删除重复的图片后，我们总共会有<strong class="ih hj"> <em class="ju"> 12，047个独特的图片</em> </strong>。</p><p id="769a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">解压缩后我们得到的文件夹结构显示，每个图像都存在于一个单独的文件夹中。我们需要将这些图像从它们各自的文件夹移动到一个公共目录，该目录将保存所有的图像。之后，让我们将每个图像的文件路径保存在。csv作为单独的列。这将有助于我们在后期阶段轻松访问图像。</p><p id="6e1b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这些步骤后的CSV如下所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nh"><img src="../Images/8b4724553bf4eb0ab4f02271da2a1acf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zHKbSpiKoyN6WPup8SLZzQ.png"/></div></div></figure><p id="0fca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">所有列车Dicom图像都被移动到该公共路径“列车数据集/siim/列车_ dicom _图像”。</p><p id="7457" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">DICOM图像分析:</strong></p><p id="4b78" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有文件。dcm格式。这种格式通常用于医学成像领域，被称为DICOM(医学数字成像和通信)。如今，几乎所有形式的医学成像都已数字化，DICOM是用于存储此类图像(例如:X射线扫描和CT扫描)以及元数据的文件格式。</p><p id="de65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们绘制一些图像，看看它们看起来怎么样。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ni"><img src="../Images/75413385fcb2112395576a75f6654aed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wkfjiH4q2jB119mb8KbkkQ.png"/></div></div></figure><p id="49f2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们详细检查一个图像，看看它存储的元数据的类型。为此，我们在python中有一个库来处理DICOM图像，即“pydicom”。我们可以简单的用<strong class="ih hj">的<em class="ju"> pip3安装pydicom来安装。</em> </strong></p><p id="46b2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们了解到每个病人都有很多信息。我们将只检查一些特征，如'<strong class="ih hj"> <em class="ju">年龄</em> </strong>'、<strong class="ih hj"> <em class="ju">性别</em> </strong>'、<strong class="ih hj"> <em class="ju">形态</em> </strong>'、以及'<strong class="ih hj"> <em class="ju">视图位置</em> </strong>'。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nd ne l"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nj"><img src="../Images/fad6c3c7cdcd7613024eedeee3e0370a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sj2jkjnTFl_9tdzsNUSG3A.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">输出</figcaption></figure><p id="5b18" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">创建“气胸”列的逻辑是，如果特征“编码像素”的值为“-1”，则我们指定“否”，否则为“是”。</p><p id="b5e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">分析‘性别’字段:</em> </strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nk"><img src="../Images/38707820399bc66a904b67c5063ca344.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*SEMWmPSzLeu4-JWiOnNa6w.png"/></div></figure><p id="8015" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有55%的记录，男性占大多数。女性(<strong class="ih hj"> F </strong>)由剩余的45%的记录组成。在提供的数据中，我们只有这两种性别。</p><p id="ff22" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">分析目标(气胸)场:</em> </strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nl"><img src="../Images/fee6fae310b238c5320216b9b0736b20.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*ERLRM0C-tW6E7MdXKRW3hA.png"/></div></figure><p id="7131" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如预期的那样，大多数记录(77.85%)没有记录任何气胸发生。一小部分(22.15%)的记录有这种疾病。</p><p id="f9b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因为这是医学数据，所以很有可能会严重失衡，因为它反映了现实世界的情况，即大多数接受X射线检查的患者并没有患有上述疾病。</p><p id="9eae" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">一起分析气胸的发生与性别:</em> </strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nm"><img src="../Images/c747dca1a4463b67fb89b6383726394a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MVE3K1WxcgjZ2cTWwDlEsQ.png"/></div></div></figure><p id="c073" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在男性55%记录中，我们有<strong class="ih hj"> <em class="ju"> 77.5%为健康</em> </strong>和22.5%为气胸检测。在<em class="ju"> 45%的女性</em>记录中，我们有<strong class="ih hj"> <em class="ju"> 78.2%为健康</em> </strong>和21.8%为气胸检测。</p><p id="eec3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">分析视图位置字段:</em> </strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nn"><img src="../Images/8496a15d352b0a48ee11ad2d8920d8e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*otZbea-L2mlM_W800AW7pA.png"/></div></figure><p id="d571" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们通过改变患者身体的方向和x射线束的方向来获得胸部的不同视图。在数据集中，我们看到两个位置——<strong class="ih hj">PA</strong>(后前)和<strong class="ih hj"> AP </strong>(前后)。在<strong class="ih hj"> <em class="ju"> PA视图</em> </strong>中，x射线束通过胸部的后(背)面进入，并从前(前)面射出，在此处对射线束进行检测。在<strong class="ih hj"> <em class="ju"> AP视图</em> </strong>中，x射线源和探测器的位置颠倒。<strong class="ih hj"> AP </strong>胸部x光片<em class="ju">比<strong class="ih hj"> PA </strong> x光片</em>更难阅读，因此一般用于患者难以获得普通胸部x光片的情况，例如当患者卧床不起时。我们在上图中看到了类似的趋势，其中绝大多数记录(60.38%)有PA，只有39.62%的记录有AP。</p><p id="5d9b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">将视角和气胸的发生一起作为参数进行分析:</em> </strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es no"><img src="../Images/19d1407d030c4ecb9f0c828cc17161de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*3L7pvYHxlpX1A4V2x8HR0Q.png"/></div></figure><p id="abaf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">总结剧情:</em> </strong></p><p id="4367" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">以<strong class="ih hj"> <em class="ju"> PA </em> </strong>为viewPosition的记录占60.38%，以<strong class="ih hj"> <em class="ju"> AP </em> </strong>为view position的记录占39.62%。在所有PA记录中，<em class="ju"> 76.7% </em>健康，未检测到气胸。其余23.3%的记录中有该病。在所有AP记录中，<em class="ju"> 80% </em>健康，未检测到气胸。其余20.4%的记录中有这种疾病。</p><p id="acaa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">分析年龄字段:</em> </strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es np"><img src="../Images/8b1c37d10cf94a6fdc215a4849cc2084.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*I6QmKucwHnnAvtBkTSwxKA.png"/></div></figure><p id="1b75" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们看到“年龄”的分布在58岁达到峰值，因为它有最大的计数。更常见的年龄段是50-60岁。我们还看到1条年龄为413的记录，这可能是一个异常值。</p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><p id="2cf0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 9。预处理:</strong></p><p id="e621" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在数据预处理部分，我们将做两件事:</p><ol class=""><li id="dc9e" class="la lb hi ih b ii ij im in iq lq iu lr iy ls jc lh li lj lk bi translated">将DICOM图像转换为PNG</li><li id="76b1" class="la lb hi ih b ii ll im lm iq ln iu lo iy lp jc lh li lj lk bi translated">根据给定的规则创建遮罩</li></ol><p id="97e2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们从第一个任务开始，然后:</p><ol class=""><li id="f274" class="la lb hi ih b ii ij im in iq lq iu lr iy ls jc lh li lj lk bi translated"><strong class="ih hj"> <em class="ju">将DICOM图像转换为PNG: </em> </strong></li></ol><p id="a304" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">既然不能用<strong class="ih hj"> <em class="ju">。dcm </em> </strong>图像在建模过程中，所以我们需要将格式转换为<strong class="ih hj"> .png. </strong></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nd ne l"/></div></figure><p id="2a12" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在这种方法中，我们将图像大小从1024x1024更改为更小的(因此，在我们有限的计算资源中更易于管理)<strong class="ih hj"> <em class="ju"> 256x256 </em> </strong>大小。与此同时，我们正在替换<em class="ju">中的格式。dcm到。png </em>并将新的较小尺寸的png图像存储在不同的文件夹中。</p><p id="08f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.<strong class="ih hj"> <em class="ju">从给定的RLEs创建遮罩:</em> </strong></p><p id="7115" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有形式为<strong class="ih hj"> <em class="ju">行程长度编码像素</em> </strong>的掩码数据，我们需要将其转换为<strong class="ih hj"> <em class="ju">。png </em> </strong>格式，以便它们可以正确地成为每个给定的png图像的基础事实。<em class="ju">组织者提供了一个使用RLE为像素创建遮罩的功能。</em></p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nd ne l"/></div></figure><p id="eab9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，让我们设想一个带有地面真相遮罩的PNG图像:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nq"><img src="../Images/cb1355454703e01381ecc87299f07e64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GBFyBaWi2X1hrXk0lPTwUA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">带掩模的样品X射线</figcaption></figure><p id="1cba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="ju">我们的结果应该给出胸部x光的屏蔽图像(最右边的一个)。</em></p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><p id="aa57" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 10。造型:</strong></p><p id="b58a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="ju">注意:本研究的目标不是获得很高的准确性或超越任何模型，而是探索模型行为</em> <em class="ju">的方式和原因，并尝试不同的架构。</em></p><p id="6dfe" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如第2节所述，我们首先需要将图像分类为气胸或不气胸。根据结果，我们将继续进行分割。所以，首先，我们将建立一个<strong class="ih hj"><em class="ju"/></strong>二元分类模型作为<em class="ju">的第一步</em>。</p><p id="0278" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju"> A)第1部分——气胸分类:</em> </strong></p><p id="539f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">首先，我们将胸部x光分为没有气胸(标号:0)或有气胸(标号:1)。这部分是<em class="ju">图像分类</em>部分，我们使用预训练模型<strong class="ih hj"> CheXNet </strong> ( <em class="ju">一个在胸部x光图像</em>上微调的121层DenseNet模型)应用迁移学习技术对图像进行分类。</p><p id="b090" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了完成这个二进制分类任务，我们需要作为二进制标签的基本事实。目前，我们有地面真相作为RLEs(如给定的)或面具(如上面转换的)。因此，我们需要根据给定的格式创建二进制标签。我们观察到在没有任何气胸情况的图像中，“<em class="ju">编码像素</em>”列的值为-1。否则它有必要的规则。因此，使用这个知识，我们创建二进制标签，以便我们为具有<strong class="ih hj"> <em class="ju">非负RLEs </em> </strong> <em class="ju">否则</em> <strong class="ih hj"> <em class="ju">标签0 </em> </strong>的图像分配<strong class="ih hj"> <em class="ju">标签1 </em> </strong>。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nd ne l"/></div></figure><p id="3c6d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">有了这个，现在我们的数据就是分类模型的格式了。让我们将现在的数据拆分为Train和CV。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nd ne l"/></div></figure><p id="da2d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">imagePath包含单个图像的完整位置路径，格式为<strong class="ih hj"><em class="ju">Train Dataset/siim/Train _ png _ images/imageID</em></strong><em class="ju">。</em></p><p id="7eba" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">总训练数据集大小:10842 &amp;总有效数据集大小:1205。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nr"><img src="../Images/574ee6fed251bfb06bc835a0f4b9f3cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/format:webp/1*szvf6BdjCSt8DuSFtySJxA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">训练数据集中的类别分布</figcaption></figure><p id="83e1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">处理阶级不平衡:</em> </strong></p><p id="741e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们有不平衡的数据，因为正类的数量远远超过负类的数量。这在医疗领域是一个很常见的事件。我们需要处理这种数据不平衡的问题，以便模型不会变得过于偏向多数阶级。为了确保两个类别对损失的贡献相等，我们给每个类别赋予权重。<strong class="ih hj"> <em class="ju">这个权重与上课的频率成反比。</em> </strong>我们计算这个频率为<strong class="ih hj"><em class="ju">count _ of _ class/total _ records _ present。</em> </strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ns"><img src="../Images/157e211c13af9b1b4dc23b9fd6ba5a54.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*shWxOI7XumauFbbAVSP4OQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">类别频率</figcaption></figure><p id="558a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如预期的那样，正类的记录要少得多，因此频率也明显低于负类。这样，我们现在已经为每个类分配了权重。为了确认，让我们检查每一类对损失的贡献，以便模型对任何一类都保持无偏。我们计算每个类别  <em class="ju">的这个<strong class="ih hj"> <em class="ju">贡献，作为类别_权重和类别_频率</em> </strong>的</em> <strong class="ih hj"> <em class="ju">乘积。</em></strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nt"><img src="../Images/4080a65b94461c02e99fd9f907adf064.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*HpYfCTa5i_PsfvyrXyleKA.png"/></div></figure><p id="1dc1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在，我们的模型不会因为阶级不平衡而出现偏差。</p><p id="abd7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">处理增强:</em> </strong></p><p id="34d3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">数据</strong> <strong class="ih hj">增强</strong>用于通过添加已有图像的轻微修改副本来增加数据量。它作为一个正则化器，有助于在训练模型时减少过度拟合。我们这里使用的增强是来自<strong class="ih hj"> <em class="ju"> tf的<em class="ju"> random_flip_left_right </em>、<em class="ju"> random_contrast </em>、<em class="ju"> random_brightness </em>、<em class="ju"> random_saturation </em>、<em class="ju"> random_hue </em>和<em class="ju"> adjust_gamma </em>。图像</em> </strong> <em class="ju"> </em>管道。我们还使用随机增强，这样每张图像都可以随机选择增强。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nd ne l"/></div></figure><p id="800e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，我们的管道是为分类模型而构建的。</p><p id="0e24" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用<strong class="ih hj"> <em class="ju"> CheXNet </em> </strong>模型来构建我们的分类器。它是一个<em class="ju"> 121层DenseNet </em>在胸部x光图像上进行预训练(参考:<a class="ae jt" href="https://arxiv.org/abs/1711.05225" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/1711.05225</a>)。</p><p id="0b46" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在构建我们的架构之前，让我们多了解一下DenseNet。</p><p id="571a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju"> DenseNet </em> </strong>是用于图像分类&amp;物体识别的架构。它非常类似于ResNet架构，尽管它有一些基本的区别。ResNet使用加法(+)将以前的层(身份)与未来的层合并，而DenseNet按通道连接(。)前一层与后一层的输出。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nu"><img src="../Images/a87324eb81302821d102dc392c47e069.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*mu81sr76o2Arm_CkbJ5y_A.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">dense net:<a class="ae jt" href="https://arxiv.org/pdf/1608.06993.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1608.06993.pdf</a></figcaption></figure><p id="d013" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们看看我们在DenseNet上创建的模型结构。我们已经为我们的DenseNet-121架构直接加载了ChestXNet的权重。除此之外，我们还添加了一些额外的层，同时微调我们的模型。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nd ne l"/></div></figure><p id="d72f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，在定义DenseNet121时，我们给了<strong class="ih hj"> <em class="ju">权重= None </em> </strong>和<strong class="ih hj"><em class="ju">include _ top = False</em></strong>。</p><p id="c4c2" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">这是因为我们<em class="ju">没有使用imagenet权重</em> (DenseNet最初是在imagenet数据集上训练的)，而是使用稍后单独加载的CheXNet权重。</p><p id="1e0a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">通过指定<strong class="ih hj"> include_top=False </strong>参数，我们加载了一个顶部不包含分类图层的网络。这是因为ChexNet被训练来分类14类，其中一类是气胸。因为我们在这里只处理1个类，所以在加载架构时不需要包含顶层。</p><p id="7734" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在额外的层中，我们添加了一个GlobalAveragePooling2D和一系列BatchNormalization、Dense和Dropout层，以进一步微调模型。</p><p id="bef4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用了以下回调:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nd ne l"/></div></figure><p id="bd10" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们使用类似于<strong class="ih hj"><em class="ju">model check point</em></strong>的回调——用于保存具有最大验证AUC的最佳模型，<strong class="ih hj"> <em class="ju">提前停止</em></strong>——用于如果度量值(val_auc)在6个时期内没有变化则停止训练，以及<strong class="ih hj"> <em class="ju">减少lronplateau</em></strong>——用于如果度量值在3个时期内没有变化则降低学习速率。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nd ne l"/></div></figure><p id="abca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在我们已经训练了模型，让我们检查指标值，以确定模型的表现如何。</p><p id="b395" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">评估指标值:</em> </strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nv"><img src="../Images/6e84195d5ae194e92ab269956ee365ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XKzQNBUuMNepuTXpxcfbcg.png"/></div></div></figure><p id="bbad" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">AUC-ROC值:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nw"><img src="../Images/12862503272ae68b88ddbf65098a8540.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*c-82jJ_6Vn7Vtyd6OcPXag.png"/></div></figure><p id="446e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们在CV数据集上得到了0.908的AUC分数。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es nx"><img src="../Images/711f1dbe3c8644086f88e51fd4704972.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*mSWaOGTeqnf2-tXG3XiehQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">混淆矩阵</figcaption></figure><p id="58d9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们得到了86.1%的验证准确率。</p><p id="71e7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">灵敏度</em> </strong>(真阳性率)是假设案例实际为阳性，模型输出阳性的概率。它显示了正类的哪一部分得到了正确的分类。这也是召回。</p><p id="b413" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">阴性预测值(<strong class="ih hj"> <em class="ju"> NPV </em> </strong>)是预测阴性的人真正没有患病的概率。因此，NPV为0.914意味着，如果预测一个人没有气胸，那么他实际上没有患病的概率为91.4%。</p><p id="0021" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">敏感度</em> </strong>和<strong class="ih hj"> <em class="ju"> NPV </em> </strong>是最重要的度量值。由于我们正在处理医疗数据，我们必须<strong class="ih hj"> <em class="ju">将假阴性</em> </strong>降至最低，因为患者患有疾病(即真实标签=阳性)但模型预测他是安全的(即预测标签=阴性)的情况可能被证明是灾难性的。我们还需要<strong class="ih hj"> <em class="ju">最大化真正的阳性</em> </strong>因为<strong class="ih hj"> <em class="ju"> </em> </strong>我们希望大多数阳性类被正确预测。因此，我们需要一个<strong class="ih hj">高灵敏度</strong> (TPR)和一个<strong class="ih hj">高净现值</strong>。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ny"><img src="../Images/ca38712f47c076590e83ba4cce8ce1d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*RK4yDgqLANzE-9XU0z8-SA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">精确召回曲线</figcaption></figure><p id="8712" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们在CV数据集上获得了0.731的平均精度分数。<strong class="ih hj"> <em class="ju">精确-召回曲线</em> </strong> (PRC)显示了精确和召回之间的权衡。曲线下的高区域表示高召回率和高精度，其中高精度与低假阳性率相关，高召回率与低假阴性率相关。两者的高分表明分类器正在返回准确的结果(高精度)，以及返回所有肯定结果的大部分(高召回)。</p><p id="7d9a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">如指标值所示，该模型运行良好。</p><p id="bccf" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">至此，我们完成了我们的分类部分。</p><p id="4fb7" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju"> B)第二部分——气胸分割:</em> </strong></p><p id="b28d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">在第二部分，也是最重要的一部分，我们建立分段模型，其中我们应用不同的架构(<em class="ju">嵌套Unet </em>，以及<em class="ju">双Unet，预训练VGG19 </em>作为骨干编码器)来预测掩码。</p><ol class=""><li id="74d2" class="la lb hi ih b ii ij im in iq lq iu lr iy ls jc lh li lj lk bi translated"><strong class="ih hj"> <em class="ju"> UNet++:用于医学图像分割的嵌套式UNet架构:</em> </strong></li></ol><p id="21df" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">UNET++与UNET有许多相似之处，因为两者都有编码器-解码器架构。</p><p id="3b31" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们看看UNET和UNET++之间的区别:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es nz"><img src="../Images/5b321a1d95911fdf0efc0e6103b4182c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oJrTEb56c34745a-cXOqsw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">参考:生物医学图像分割:UNet++ by Jingles (Hong Jing)</figcaption></figure><p id="cbe9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">UNET++与UNET相比有以下<strong class="ih hj"><em class="ju"/></strong>:</p><p id="9d3d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju"> a) </em> </strong>它重新设计了跳过路径(显示为绿色)</p><p id="e0c4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju"> b) </em> </strong>它有密集的跳跃连接(显示为蓝色)</p><p id="2c36" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju"> c) </em> </strong>深度监督(显示为红色)</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es oa"><img src="../Images/e57bbae7694d322d067be8bf99cbb70f.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*MUYz594g6fMTznMtS5avAw.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">嵌套Unet</figcaption></figure><p id="ea7f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju"> a) </em> </strong> <strong class="ih hj"> <em class="ju">重新设计的跳过路径(显示为绿色):</em> </strong></p><p id="4816" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">重新设计的跳过路径中存在的卷积层(如绿色所示)用于桥接编码器和解码器部分的特征集之间的语义鸿沟。</p><p id="856b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">UNET中的跳过连接将特定层的编码器的特征映射与相应解码器层的上采样特征映射连接起来。这可能导致融合或连接不同的特征地图。这在UNET++中得到了弥补。同一密集块的前一卷积层的输出与较低卷积层的相应上采样输出融合。这使得所得的编码器特征映射更类似于相应解码器的特征映射。因此，当接收到语义相似的特征图时，优化更容易。</p><p id="c33b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju"> b) </em> </strong> <strong class="ih hj"> <em class="ju">密集跳过连接(显示为蓝色):</em> </strong></p><p id="ff8a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">密集跳跃连接(以蓝色显示)在编码器和解码器之间实现了跳跃路径。这些密集块的灵感来自DenseNet，目的是提高分割精度和改善梯度流。这些连接确保当前节点中存在所有先前的特征映射。这在多个语义级别生成全分辨率特征图。</p><p id="8d20" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">c) <strong class="ih hj"> <em class="ju">深度监督(显示为红色):</em> </strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ob"><img src="../Images/b76855c421eb0e3c96ea113e8b6188d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:370/format:webp/1*4SKLRHpWdnanFZn0DhCPeA.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">参考:<a class="ae jt" href="https://arxiv.org/pdf/1807.10165.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1807.10165.pdf</a></figcaption></figure><p id="de97" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">添加了深度监督(以红色显示),以便可以修剪模型来调整模型复杂性，即平衡预测时间和性能。</p><p id="948e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了更好地理解UNet++你可以访问这篇文章，<a class="ae jt" href="https://arxiv.org/pdf/1807.10165.pdf" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="8688" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是香草UNET++的代码，没有任何预先训练的骨干。</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nd ne l"/></div></figure><p id="c1e6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面，是连击损失:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nd ne l"/></div></figure><p id="174e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">编译模型:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nd ne l"/></div></figure><p id="4c6b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">训练模型:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nd ne l"/></div></figure><p id="4740" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们绘制指标图，看看我们的模型表现如何:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es oc"><img src="../Images/c91711c42d1deb9ad7d40cb92bb9ad91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uINvCs7q0f1ZxakbJbMlIA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">评估指标</figcaption></figure><p id="5ce1" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们可以看到的，每个时期的损失都在减少，但非常缓慢。骰子分数在0.21以上没有太大改善。解决方案是，我们应该为进一步的时代训练模型，更积极地改变学习率，并使用预训练的模型作为编码器主干。</p><p id="7e93" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">正如我们之前所说的，这篇博客的目的是实验不同的架构，看看哪一个性能更好，为什么？</p><p id="f40a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">因此，请记住，我们不会在以前的体系结构中添加任何预先训练好的主干。相反，我们将尝试以VGG19作为其编码器主干的双Unet结构。</p><p id="677b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.<strong class="ih hj"> <em class="ju">双UNET: </em> </strong></p><p id="5ecc" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">顾名思义，这是两种UNET模式的结合。你可以点击查看论文<a class="ae jt" href="https://arxiv.org/ftp/arxiv/papers/2006/2006.00414.pdf" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="b918" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">作者对建筑的简短解释:</p><p id="5828" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi od translated"><span class="l oe of og bm oh oi oj ok ol di"> D </span> <em class="ju"> oubleU-Net以VGG19作为编码器子网开始，其后是解码器子网。在网络中，输入图像被馈送到修改的UNet(UNet1)，该UNet生成预测的掩模(即，输出1)。然后，我们将输入图像与生成的掩码(即，输出1)相乘，该掩码作为第二个修改的U-Net(UNet2)的输入，该U-Net生成另一个生成的掩码(输出2)。最后，我们连接两个掩码(输出1和输出2)以获得最终的预测掩码(输出)。</em></p><p id="b700" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">下面是架构:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es om"><img src="../Images/4349a9f800bd18f95babda82d1eb2e33.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/0*uWBZykPqjMQ0mzE0.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">DC-UNET</figcaption></figure><p id="34b9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们可以看到，上述架构使用4个编码器模块和4个解码器模块。更多数量的这种块增加了总的可训练参数，因此需要更多的计算能力来正确训练。由于我们在访问这样的计算能力方面有限制，我们将在我们的架构中仅使用2个编码器和2个解码器模块。</p><p id="d29b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">模型建筑的TensorFlow代码相当大，并且在我的Github配置文件中有，因此我不在这里添加它。</p><p id="4e7d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们检查一下指标:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es on"><img src="../Images/af615018a9621b4f6eedf3fcaf431c02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-PYLSTA5oqNMsTfUCEY_Gg.png"/></div></div></figure><p id="d652" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">与UNET++相比，在30个周期结束时，损耗下降得非常好。骰子分数还是不太好。我们可以训练更多的纪元来获得更好的性能。但由于时间关系，我们将只讲到这里。</p><p id="798d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们来看看这个模型的预测:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es oo"><img src="../Images/ef6d41ea33b5eba9e7f147b083a89bd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rvLyyPTwideqFOJQDtl1NA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">红色:预测面具；绿色:原始遮罩</figcaption></figure><p id="4e7b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们看到，当没有遮罩时，模型可以正确预测。对于存在屏蔽的情况，预测或多或少与地面实况相似。显然，我们可以通过更好地处理数据不平衡、为更多时期训练模型或应用上述其他技术来提高性能。</p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><p id="6930" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 10。最终管线:</strong></p><p id="640a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">为了构建最终的推理管道，我们保存了上述两个模型权重。</p><p id="08a6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们建立管道:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nd ne l"/></div></figure><p id="4154" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们来看看一些预测:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="nd ne l"/></div></figure><p id="7803" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">正面预测:</em> </strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es op"><img src="../Images/2a994b41cdb18672dc77ed604edea690.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*hBFtxK_7SvpI7cdVwFv2Pg.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es oq"><img src="../Images/3cb84cee14a9fbec33d656aefd886cef.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*9VFApjihZG2ZdHKhkPVrmQ.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es or"><img src="../Images/42ff44534693e0c1313ce738c08560fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*NJoZmI_JWsHG_xPiz3lGug.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es os"><img src="../Images/447c901d5b3cbd4ae599faa4c9be4a70.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*LIe3eXyKo476pcMmWotWIQ.png"/></div></figure><p id="1aa9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">负面预测:</em> </strong></p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es or"><img src="../Images/470b690f6fb412ed7fb974ba4ea9cfe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*7uLnpUyFm-nptGw03qF35Q.png"/></div></figure><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ot"><img src="../Images/f55d9090651e3fa9ac39761478913e9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*tmPg6rzzXTSUFn2m0lTOOA.png"/></div></figure><p id="574e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju">失败案例:</em> </strong></p><p id="e0ff" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">展示一些失败案例是很重要的。分类器预测存在气胸，但分割模型未能突出任何部分的情况。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es ou"><img src="../Images/d97a5589984545a83f638534b3267492.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*VoxIWACGN1IAT7AHAlkPpg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">失败案例</figcaption></figure></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><p id="ff7c" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 12。部署:</strong></p><p id="8dca" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们围绕该模型构建一个端到端的应用程序，并使用Flask APIs部署它。下面是模型运行的部署版本的视频:</p><figure class="je jf jg jh fd ji"><div class="bz dy l di"><div class="ov ne l"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">部署的视频</figcaption></figure></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><p id="60ab" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">13。 <strong class="ih hj">未来工作:</strong></p><p id="7b0d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju"> a) </em> </strong>我们可以使用不同的方法来处理数据不平衡，更好的增强技术等。</p><p id="4908" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="ju"> b) </em> </strong>使用UNET++的预训练骨干，还使用深度监督=真选项来检查模型性能如何提高。</p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><p id="bc16" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 14。参考文献:</strong></p><p id="478a" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">1.双U网:【https://arxiv.org/pdf/2006.04868.pdf】T2</p><p id="b017" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">2.如何在Google Colab中运行Flask</p><p id="3c17" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">3.https://arxiv.org/abs/1807.10165 UNET ++:<a class="ae jt" href="https://arxiv.org/abs/1807.10165" rel="noopener ugc nofollow" target="_blank"/></p><p id="79b4" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">4.<a class="ae jt" href="https://www.kaggle.com/meaninglesslives/nested-unet-with-efficientnet-encoder/output#Defining-UEfficientNet-Model" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/meaninglesslives/nested-unet-with-efficient net-encoder/output # Defining-ueefficient net-Model</a></p><p id="f85d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">5.<a class="ae jt" href="https://www.kaggle.com/danofer/ranzcr-chexnet-starter" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/danofer/ranzcr-chexnet-starter</a></p><p id="c6ac" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">6.<a class="ae jt" href="https://www.appliedaicourse.com/" rel="noopener ugc nofollow" target="_blank">www.appliedaicourse.com</a></p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><p id="7f65" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 15。Github资源库链接:</strong></p><div class="lu lv ez fb lw lx"><a href="https://github.com/NamrataThakur/SIIM-PCR-Pneumothorax-Segmentation" rel="noopener  ugc nofollow" target="_blank"><div class="ly ab dw"><div class="lz ab ma cl cj mb"><h2 class="bd hj fi z dy mc ea eb md ed ef hh bi translated">NamrataThakur/SIIM-PCR-气胸-分割</h2><div class="me l"><h3 class="bd b fi z dy mc ea eb md ed ef dx translated">商业问题:气胸是一种医疗状况，当空气漏入肺部和肺部之间的空间时就会出现</h3></div><div class="mf l"><p class="bd b fp z dy mc ea eb md ed ef dx translated">github.com</p></div></div><div class="mg l"><div class="ow l mi mj mk mg ml jn lx"/></div></div></a></div></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><p id="3983" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> 16。LinkedIn个人资料链接:</strong></p><p id="f562" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">https://<a class="ae jt" href="http://www.linkedin.com/in/namrata-thakur893" rel="noopener ugc nofollow" target="_blank">www.linkedin.com/in/namrata-thakur893</a></p></div><div class="ab cl jv jw gp jx" role="separator"><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka kb"/><span class="jy bw bk jz ka"/></div><div class="hb hc hd he hf"><p id="6c5e" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">感谢阅读博客。我要感谢我的导师和整个应用课程团队。</p><p id="5685" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">本案例研究到此为止。如果你有任何改进的建议，请在评论中留下..！！</p></div></div>    
</body>
</html>