<html>
<head>
<title>Bengaluru House Price Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">孟加拉鲁鲁房价预测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/bengaluru-house-price-prediction-c0fe091b4d09?source=collection_archive---------2-----------------------#2021-04-13">https://medium.com/analytics-vidhya/bengaluru-house-price-prediction-c0fe091b4d09?source=collection_archive---------2-----------------------#2021-04-13</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="d43b" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">数据科学回归项目:预测孟加拉国的房价。</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/1b5c9352d69918c505a017a3659ceaf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5lksNVWUW8prwtwOAiq1pQ.jpeg"/></div></div></figure><p id="55d5" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hi">所有需要的库导入</strong></p><p id="e881" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">导入熊猫作为pd <br/>导入numpy作为np <br/>导入matplotlib.pyplot作为plt</p><h2 id="9134" class="ke kf hh bd kg kh ki kj kk kl km kn ko jr kp kq kr jv ks kt ku jz kv kw kx ky bi translated">数据加载:将孟加拉国房价加载到数据框中。</h2><p id="d17b" class="pw-post-body-paragraph ji jj hh jk b jl kz ii jn jo la il jq jr lb jt ju jv lc jx jy jz ld kb kc kd ha bi translated">df = PD . read _ CSV(" Bengal uru _ House _ data . CSV ")<br/>df . head()</p><p id="b8b0" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df.shape</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="6a25" class="ke kf hh lf b fi lj lk l ll lm">(13320, 9)</span></pre><p id="62e9" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df . group by(" area _ type ")[' area _ type ']。agg('计数')</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="efd7" class="ke kf hh lf b fi lj lk l ll lm">area_type<br/>Built-up  Area          2418<br/>Carpet  Area              87<br/>Plot  Area              2025<br/>Super built-up  Area    8790<br/>Name: area_type, dtype: int64</span></pre><p id="a3c8" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">删除不必要的列，以便更好地理解数据。</p><p id="690d" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df1=df.drop(['availability '，' society '，' area_type '，'阳台']，axis='columns') <br/> df1.head()</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ln"><img src="../Images/e1b9e66a8cea2da5f0fbb509a3eec4d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5csplzGHyoK1cuLEFud74Q.png"/></div></div></figure><p id="8617" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df1.isnull()。总和()</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="34ab" class="ke kf hh lf b fi lj lk l ll lm">location       1<br/>size          16<br/>total_sqft     0<br/>bath          73<br/>price          0<br/>dtype: int64</span></pre><p id="9abf" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df2=df1.dropna() <br/> df2.isnull()。总和()</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="4da3" class="ke kf hh lf b fi lj lk l ll lm">location      0<br/>size          0<br/>total_sqft    0<br/>bath          0<br/>price         0<br/>dtype: int64</span></pre><p id="ef37" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df2['大小']。唯一()</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="86d8" class="ke kf hh lf b fi lj lk l ll lm">array(['2 BHK', '4 Bedroom', '3 BHK', '4 BHK', '6 Bedroom', '3 Bedroom',<br/>       '1 BHK', '1 RK', '1 Bedroom', '8 Bedroom', '2 Bedroom',<br/>       '7 Bedroom', '5 BHK', '7 BHK', '6 BHK', '5 Bedroom', '11 BHK',<br/>       '9 BHK', '9 Bedroom', '27 BHK', '10 Bedroom', '11 Bedroom',<br/>       '10 BHK', '19 BHK', '16 BHK', '43 Bedroom', '14 BHK', '8 BHK',<br/>       '12 Bedroom', '13 BHK', '18 Bedroom'], dtype=object)</span></pre><p id="919a" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df2['BHK']=df2['大小']。apply(lambda x:int(x . split(')[0]))</p><p id="780e" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df2.head()</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lo"><img src="../Images/1b62b3da4a300917afc87fdab789a85c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k5KwTvlVrnVc3F9ONg-vOw.png"/></div></div></figure><p id="835b" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df2['BHK']。唯一()</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="4b6f" class="ke kf hh lf b fi lj lk l ll lm">array([ 2,  4,  3,  6,  1,  8,  7,  5, 11,  9, 27, 10, 19, 16, 43, 14, 12,<br/>       13, 18], dtype=int64)<br/></span></pre><p id="6f90" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df2[df2。BHK&gt;20]</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lp"><img src="../Images/0c16c40bea967262ed2a59cb4a0c3586.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NQpZbhQSY0Bw1nq4lBSJrQ.png"/></div></div></figure><h1 id="0f13" class="lq kf hh bd kg lr ls lt kk lu lv lw ko in lx io kr iq ly ir ku it lz iu kx ma bi translated">检查total_sqft中的唯一值</h1><p id="f9e0" class="pw-post-body-paragraph ji jj hh jk b jl kz ii jn jo la il jq jr lb jt ju jv lc jx jy jz ld kb kc kd ha bi translated">df2.total_sqft.unique()</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="a4b5" class="ke kf hh lf b fi lj lk l ll lm">array(['1056', '2600', '1440', ..., '1133 - 1384', '774', '4689'],<br/>      dtype=object)</span></pre><p id="6034" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">def is _ float(x):<br/>try:<br/>float(x)<br/><br/>除:<br/>返回False <br/>返回True</p><p id="02a4" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df2[~df2['total_sqft']。apply(is_float)]。头部()</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mb"><img src="../Images/88f68455f8746dd2b39498a0a14bd16c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*clmy5yqo6qdnW1JLqWQY0A.png"/></div></div></figure><p id="6f89" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hi">现在将total_sqft的所有值转换为浮点值</strong></p><p id="3d50" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">def convert _ sqft _ to _ num(x):<br/>tokens = x . split("—"<br/>if len(tokens)= = 2:<br/>return(float(tokens[0])+float(tokens[1]))/2<br/>try:<br/>return float(x)<br/>except:<br/>return None</p><p id="ca91" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">convert _ sqft _ to _ num(" 2100–2850 ")</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="bd3d" class="ke kf hh lf b fi lj lk l ll lm">2475.0</span></pre><p id="1e62" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df3 = df2 . copy()<br/>df3[' total _ sqft ']= df3[' total _ sqft ']。apply(convert _ sqft _ to _ num)<br/>df3 . head()</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mc"><img src="../Images/445971976ef558cde26c8cac6ec64380.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l-c_bnO0iT7-xc4F7wR8Ag.png"/></div></div></figure><p id="2691" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df3.loc[30]</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="9cd2" class="ke kf hh lf b fi lj lk l ll lm">location      Yelahanka<br/>size              4 BHK<br/>total_sqft         2475<br/>bath                  4<br/>price               186<br/>BHK                   4<br/>Name: 30, dtype: object</span></pre><h1 id="bc8a" class="lq kf hh bd kg lr ls lt kk lu lv lw ko in lx io kr iq ly ir ku it lz iu kx ma bi translated">用于异常检测降维的特征工程</h1><p id="7323" class="pw-post-body-paragraph ji jj hh jk b jl kz ii jn jo la il jq jr lb jt ju jv lc jx jy jz ld kb kc kd ha bi translated">df4 = df3 . copy()<br/>df4[' price _ per _ sqft ']= df4[' price ']* 100000/df4[' total _ sqft ']<br/>df4 . head()</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es md"><img src="../Images/60e0f27231fb767d7669f3fbbc25b091.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FDnoVWVpzjuwQFn5BjgDcw.png"/></div></div></figure><p id="4bae" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">len(df4['位置']。唯一())</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="ef05" class="ke kf hh lf b fi lj lk l ll lm">1304</span></pre><p id="3673" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df4 . location = df4 . location . apply(lambda x:x . strip())</p><p id="bb02" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">location _ stats = df4 . group by(' location ')[' location ']。agg('count ')。sort_values(升序=False) <br/> location_stats</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="7edd" class="ke kf hh lf b fi lj lk l ll lm">location<br/>Whitefield           535<br/>Sarjapur  Road       392<br/>Electronic City      304<br/>Kanakpura Road       266<br/>Thanisandra          236<br/>                    ... <br/>LIC Colony             1<br/>Kuvempu Layout         1<br/>Kumbhena Agrahara      1<br/>Kudlu Village,         1<br/>1 Annasandrapalya      1<br/>Name: location, Length: 1293, dtype: int64</span></pre><p id="2285" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">location _ stats _ less _ then _ 10 = location _ stats[location _ stats&lt;=10]<br/>location _ stats _ less _ then _ 10</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="1e12" class="ke kf hh lf b fi lj lk l ll lm">location<br/>BTM 1st Stage          10<br/>Basapura               10<br/>Sector 1 HSR Layout    10<br/>Naganathapura          10<br/>Kalkere                10<br/>                       ..<br/>LIC Colony              1<br/>Kuvempu Layout          1<br/>Kumbhena Agrahara       1<br/>Kudlu Village,          1<br/>1 Annasandrapalya       1<br/>Name: location, Length: 1052, dtype: int64</span></pre><p id="2d8d" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df4 . location = df4 . location . apply(lambda x:' other ' if x in location _ stats _ less _ then _ 10 else x)<br/>len(df4 . location . unique())</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="9579" class="ke kf hh lf b fi lj lk l ll lm">242</span></pre><p id="1423" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hi">异常值检测和去除</strong></p><p id="a5cc" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df4.head()</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es me"><img src="../Images/1f057e04cfc31845893c994264c7a9b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PW7FOSzXZX-t0bSMcn9KJg.png"/></div></div></figure><p id="5f29" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df4[df4.total_sqft/df4。BHK❤00].头部()</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mf"><img src="../Images/d258f2b119657c63548a09dbebfca801.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_GNRxaL5mis8om32Tz2Cyg.png"/></div></div></figure><p id="c484" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df5=df4[~(df4.total_sqft/df4。bhk❤00)】<br/>df5 . head()</p><p id="770b" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df5.price_per_sqft.describe()</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="471b" class="ke kf hh lf b fi lj lk l ll lm">count     12456.000000<br/>mean       6308.502826<br/>std        4168.127339<br/>min         267.829813<br/>25%        4210.526316<br/>50%        5294.117647<br/>75%        6916.666667<br/>max      176470.588235<br/>Name: price_per_sqft, dtype: float64</span></pre><p id="a7c5" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">def remove _ PPS _ outliers(df):<br/>df _ out = PD。DataFrame() <br/> for key，df . group by(' location '):<br/>m = NP . mean(subdf . price _ per _ sqft)<br/>ST = NP . STD(subdf . price _ per _ sqft)<br/>reduced _ df = subdf[(subdf . price _ per _ sqft&gt;(m-ST))&amp;(subdf . price _ per _ sqft&lt;=(m+ST))]<br/>df _ df</p><p id="f0e8" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df6 =移除_ pps _离群值(df5) <br/> df6.shape</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="7147" class="ke kf hh lf b fi lj lk l ll lm">(10241, 7)</span></pre><p id="19a5" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">从matplotlib导入py plot as PLT<br/>% matplotlib inline<br/>导入matplotlib<br/>matplotlib . RC params[' figure . figsize ']=(20，10)</p><p id="38ea" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">def plot_scatter_chart(df，location):<br/>bhk 2 = df[(df . location = = location)&amp;(df。BHK = = 2)]<br/>bhk 3 = df[(df . location = = location)&amp;(df。BHK = = 3)】<br/>matplotlib . rcparams[' figure . figsize ']=(15，10)<br/>PLT . scatter(bhk 2 . Total _ sqft，BHK2.price，color= '蓝色'，label='2 BHK '，s = 50)<br/>PLT . scatter(bhk 3 . Total _ sqft，BHK3.price，marker='+'，color= '绿色'，label='3 BHK '，s=50) <br/> plt.xlabel("总平方英尺面积")【关键词</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mg"><img src="../Images/c779d596237fc2dd335c3fa757b76652.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*huQjUybL6_O1iYjRwPlpDw.png"/></div></div></figure><p id="55f8" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">def plot_scatter_chart(df，location):<br/>bhk 2 = df[(df . location = = location)&amp;(df。BHK = = 2)]<br/>bhk 3 = df[(df . location = = location)&amp;(df。BHK = = 3)]<br/>matplotlib . RC params[' figure . figsize ']=(15，10)<br/>PLT . scatter(bhk 2 . Total _ sqft，BHK2.price，color= '蓝色'，label='2 BHK '，s = 50)<br/>PLT . scatter(bhk 3 . Total _ sqft，BHK3.price，marker='+'，color= '绿色'，label='3 BHK '，s=50) <br/> plt.xlabel("总平方</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mh"><img src="../Images/118b7ad16e654cdcab00a370fb16f724.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jBDzsM-_o4SAesb92lSRxw.png"/></div></div></figure><blockquote class="mi mj mk"><p id="ebf9" class="ji jj ml jk b jl jm ii jn jo jp il jq mm js jt ju mn jw jx jy mo ka kb kc kd ha bi translated">我们还应该删除相同位置的房产，例如，三居室公寓的价格低于两居室公寓(面积相同)。我们要做的是为一个给定的位置，我们将建立一个字典的统计每bhk，即。</p><p id="a6d5" class="ji jj ml jk b jl jm ii jn jo jp il jq mm js jt ju mn jw jx jy mo ka kb kc kd ha bi translated">{ '1' : { 'mean': 4000，' std: 2000，' count': 34 }，' 2' : { 'mean': 4300，' std: 2300，' count': 22 }，<br/> }</p></blockquote><h1 id="3d74" class="lq kf hh bd kg lr ls lt kk lu lv lw ko in lx io kr iq ly ir ku it lz iu kx ma bi translated">现在，我们可以移除每平方英尺价格低于1套BHK公寓平均每平方英尺价格的2套BHK公寓</h1><p id="b06f" class="pw-post-body-paragraph ji jj hh jk b jl kz ii jn jo la il jq jr lb jt ju jv lc jx jy jz ld kb kc kd ha bi translated">def remove _ BHK _离群值(df):<br/>exclude _ indexes = NP . array([])<br/>for location，location _ df in df . group by(' location '):<br/>BHK _ stats = { }<br/>for BHK，BHK _ df in location _ df . group by(' BHK '):<br/>BHK _ stats[BHK]= {<br/>' mean ':NP . mean(BHK _ df . price _ per _ sqft)，<br/>' STD ':NP . STD(BHK _ STD</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="2fc8" class="ke kf hh lf b fi lj lk l ll lm">(7329, 7)</span></pre><p id="463a" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">plot_scatter_chart(df7，“Rajaji Nagar”)</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es mp"><img src="../Images/050d04c7905fd285f0afe8b48e81a3c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*T5QOxkoxid9ioCgzibaZgg.png"/></div></figure><p id="5ed9" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">导入matplotlib<br/>matplotlib . RC params[" figure . figsize "]=(20，10)<br/>PLT . hist(df7 . Price _ Per _ sqft，rwidth=0.8) <br/> plt.xlabel("每平方英尺价格")<br/> plt.ylabel("计数")</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mq"><img src="../Images/435a9824580021a05455e700f3b3687a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n-uzAtMZ58kKpZMXcf6bXA.png"/></div></div></figure><p id="b05d" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hi">使用浴室功能去除异常值</strong></p><p id="9098" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df7.bath.unique()</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="1584" class="ke kf hh lf b fi lj lk l ll lm">array([ 4.,  3.,  2.,  5.,  8.,  1.,  6.,  7.,  9., 12., 16., 13.])</span></pre><p id="8e49" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">plt.hist(df7.bath，rwidth=0.8) <br/> plt.xlabel("浴室数量")<br/> plt.ylabel("计数")</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mr"><img src="../Images/c2ee242df171d9a92534c66915ff3d10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LUGMUcl27eSe75qyoIeHEg.png"/></div></div></figure><p id="2e42" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df7[df7.bath&gt;10]</p><p id="e361" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">在一个家庭里，浴室的数量比卧室的数量多是不寻常的</p><p id="d2c6" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">浴室。BHK+2]</p><p id="3793" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df8 = df7.drop(['size '，' price_per_sqft']，axis='columns') <br/> df8.head(3)</p><h1 id="9989" class="lq kf hh bd kg lr ls lt kk lu lv lw ko in lx io kr iq ly ir ku it lz iu kx ma bi translated">构建ML模型</h1><p id="4075" class="pw-post-body-paragraph ji jj hh jk b jl kz ii jn jo la il jq jr lb jt ju jv lc jx jy jz ld kb kc kd ha bi translated">对位置使用一个热编码</p><p id="642b" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">dummies = PD . get _ dummies(df8 . location)<br/>dummies . head(10)</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ms"><img src="../Images/5ca280252a74bff326034099621fea38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HprNbFXWQaRLcELTSLymHw.png"/></div></div></figure><p id="6309" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df9=pd.concat([df8，dummies.drop('other '，axis='columns')]，axis='columns') <br/> df9.head()</p><p id="2732" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df10 = df9.drop('location '，axis='columns') <br/> df10.head(2)</p><p id="5c6a" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">df10 .形状</p><p id="3639" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated"><strong class="jk hi">现在就建立一个模型…</strong></p><p id="b736" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">X = df10.drop('price '，axis='columns') <br/> X.head()</p><p id="9fda" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">y=df10.price <br/> y.head()</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="e2cf" class="ke kf hh lf b fi lj lk l ll lm">0    428.0<br/>1    194.0<br/>2    235.0<br/>3    130.0<br/>4    148.0<br/>Name: price, dtype: float64</span></pre><h1 id="8444" class="lq kf hh bd kg lr ls lt kk lu lv lw ko in lx io kr iq ly ir ku it lz iu kx ma bi translated">线性回归模型</h1><p id="e0c2" class="pw-post-body-paragraph ji jj hh jk b jl kz ii jn jo la il jq jr lb jt ju jv lc jx jy jz ld kb kc kd ha bi translated">从sklearn.model_selection导入train_test_split <br/> X_train，X_test，y_train，y_test=train_test_split(X，y，test_size=0.2，random_state=10)</p><p id="6195" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">从sklearn.linear_model导入linear regression<br/>lr _ clf = linear regression()<br/>lr _ clf . fit(X _ train，y _ train)<br/>lr _ clf . score(X _ test，y_test)</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="050e" class="ke kf hh lf b fi lj lk l ll lm">0.8909987705740237</span></pre><h1 id="9d6b" class="lq kf hh bd kg lr ls lt kk lu lv lw ko in lx io kr iq ly ir ku it lz iu kx ma bi translated">使用K倍交叉验证来衡量我们的线性回归模型的准确性</h1><p id="400c" class="pw-post-body-paragraph ji jj hh jk b jl kz ii jn jo la il jq jr lb jt ju jv lc jx jy jz ld kb kc kd ha bi translated">从sklearn.model_selection导入shuffles split<br/>从sklearn.model_selection导入cross_val_score</p><p id="c581" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">cv = shuffles split(n _ splits = 5，test_size=0.2，random_state=0)</p><p id="b224" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">cross _ val _ score(linear regression()，X，y，cv=cv)</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="3654" class="ke kf hh lf b fi lj lk l ll lm">array([0.81924325, 0.86698523, 0.86457433, 0.8857566 , 0.86309462])</span></pre><blockquote class="mi mj mk"><p id="39bd" class="ji jj ml jk b jl jm ii jn jo jp il jq mm js jt ju mn jw jx jy mo ka kb kc kd ha bi translated">我们可以看到，在5次迭代中，我们总是得到80%以上的分数。这很好，但是我们想测试一些其他的回归算法，看看我们是否能得到更好的分数。为此，我们将使用GridSearchCV</p></blockquote><h1 id="f787" class="lq kf hh bd kg lr ls lt kk lu lv lw ko in lx io kr iq ly ir ku it lz iu kx ma bi translated">使用GridSearchCV查找最佳模型</h1><p id="4d4c" class="pw-post-body-paragraph ji jj hh jk b jl kz ii jn jo la il jq jr lb jt ju jv lc jx jy jz ld kb kc kd ha bi translated">从sklearn.model_selection导入GridSearchCV</p><p id="d584" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">从sklearn.linear_model导入套索<br/>从sklearn.tree导入决策树回归器</p><p id="8bcf" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">def find _ best _ model _ using _ gridsearchcv(X，y):<br/>algos = {<br/>' linear _ regression ':{<br/>' model ':linear regression()，<br/>' params ':{<br/>' normalize ':[True，False] <br/> } <br/> }，<br/>' Lasso ':{<br/>' model ':Lasso()，<br/> 'params': { <br/> 'alpha': [1，2]，【T23 algos . items():<br/>GS = GridSearchCV(config[' model ']，config['params']，cv=cv，return _ train _ score = False)<br/>GS . fit(X，y)<br/>scores . append({<br/>' model ':algo _ name，<br/>' best _ score ':GS . best _ score _，<br/>' best _ params ':GS . best _ params _<br/>})</p><p id="220b" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">返回pd。DataFrame(scores，columns=['model '，' best_score '，' best_params'])</p><p id="a87d" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">find _ best _ model _ using _ gridsearchcv(X，y)</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mt"><img src="../Images/a35cf6c197c142d088a196798f296120.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8URP6udFvfLUU-MDeFm3yw.png"/></div></div></figure><blockquote class="mi mj mk"><p id="bd25" class="ji jj ml jk b jl jm ii jn jo jp il jq mm js jt ju mn jw jx jy mo ka kb kc kd ha bi translated">基于以上结果，我们可以说线性回归给出了最好的分数。因此我们将使用它。</p></blockquote><h1 id="f50b" class="lq kf hh bd kg lr ls lt kk lu lv lw ko in lx io kr iq ly ir ku it lz iu kx ma bi translated">测试模型的几个属性</h1><p id="d446" class="pw-post-body-paragraph ji jj hh jk b jl kz ii jn jo la il jq jr lb jt ju jv lc jx jy jz ld kb kc kd ha bi translated">def predict_price(location，sqft，bath，BHK):<br/>loc _ index = NP . where(x . columns = = location)[0][0]</p><p id="6e3a" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">x = NP . zeros(len(x . columns))<br/>x[0]= sqft<br/>x[1]= bath<br/>x[2]= BHK<br/>if loc _ index&gt;= 0:<br/>x[loc _ index]= 1</p><p id="fc9c" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">return lr_clf.predict([x])[0]</p><p id="319f" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">predict_price('第一阶段JP Nagar '，1000，3，2)</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="dab3" class="ke kf hh lf b fi lj lk l ll lm">87.84474705681308</span></pre><p id="af14" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">predict_price('第一阶段JP Nagar '，10000，3，3)</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="3a48" class="ke kf hh lf b fi lj lk l ll lm">845.3478190683652</span></pre><p id="651c" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">predict_price('Indira Nagar '，1000，3，2)</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="25a7" class="ke kf hh lf b fi lj lk l ll lm">157.35447180909193</span></pre><p id="b994" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">predict_price('Indira Nagar '，10000，3，3)</p><pre class="ix iy iz ja fd le lf lg lh aw li bi"><span id="2650" class="ke kf hh lf b fi lj lk l ll lm">914.8575438206441<br/></span></pre><h1 id="6eef" class="lq kf hh bd kg lr ls lt kk lu lv lw ko in lx io kr iq ly ir ku it lz iu kx ma bi translated">将测试过的模型导出到pickle文件中</h1><p id="9672" class="pw-post-body-paragraph ji jj hh jk b jl kz ii jn jo la il jq jr lb jt ju jv lc jx jy jz ld kb kc kd ha bi translated">用open(' banglare _ home _ prices _ model . pickle '，' wb ')作为f: <br/> pickle.dump(lr_clf，f)导入pickle <br/></p><h1 id="b36b" class="lq kf hh bd kg lr ls lt kk lu lv lw ko in lx io kr iq ly ir ku it lz iu kx ma bi translated">将位置和列信息导出到一个文件中，这将在我们的预测应用程序中有用</h1><p id="4c32" class="pw-post-body-paragraph ji jj hh jk b jl kz ii jn jo la il jq jr lb jt ju jv lc jx jy jz ld kb kc kd ha bi translated">导入JSON<br/>columns = {<br/>' data _ columns ':[col . lower()for col in x . columns]<br/>}<br/>with open(" columns . JSON "，" w ")as f:<br/>f . write(JSON . dumps(columns))</p><p id="85e2" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">整个程序可在<a class="ae mu" href="https://github.com/HarshalPatil20/DS_Project/blob/main/Bengaluru_Houses_rate.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>上获得。</p><p id="32b1" class="pw-post-body-paragraph ji jj hh jk b jl jm ii jn jo jp il jq jr js jt ju jv jw jx jy jz ka kb kc kd ha bi translated">谢了。</p></div></div>    
</body>
</html>