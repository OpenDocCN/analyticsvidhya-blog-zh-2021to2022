<html>
<head>
<title>Bimodal or trimodal data? Try a Gaussian Mixture Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">双峰还是三峰数据？尝试高斯混合模型</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/easily-cluster-and-display-data-using-a-gaussian-mixture-model-in-matlab-68bdbeb8cd3f?source=collection_archive---------1-----------------------#2022-02-06">https://medium.com/analytics-vidhya/easily-cluster-and-display-data-using-a-gaussian-mixture-model-in-matlab-68bdbeb8cd3f?source=collection_archive---------1-----------------------#2022-02-06</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="cd51" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果您正在使用MATLAB分析包含两个或多个正态分布总体的数据，本教程可以帮助您对它们进行分类</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/aa6324b194fb1657c337b444105561f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_6CS289E7f8tJpjETnwcaw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">让我们希望您的数据能够干净地进行聚类吧！</figcaption></figure><p id="e1e0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们首先创建一个包含来自三个随机分布的数据的假设数据集。</p><pre class="jd je jf jg fd js jt ju jv aw jw bi"><span id="fd9f" class="jx jy hh jt b fi jz ka l kb kc">rng(5) % Initialize the random number generator</span><span id="7cac" class="jx jy hh jt b fi kd ka l kb kc">mu = [5,10,15]; % Choose mean and standard deviation values<br/>sigma = [.5,2,3];<br/>Nsamples = [100,100,100]; % Note this %</span><span id="74c0" class="jx jy hh jt b fi kd ka l kb kc">data = cell2mat( arrayfun(@(i) ...<br/>random('Normal',mu(i),sigma(i),Nsamples(i),1), [1:3],...<br/>'UniformOutput', false )' );</span><span id="1074" class="jx jy hh jt b fi kd ka l kb kc">figure; hist(data)</span></pre><p id="c06a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">创建图形将得到如下所示的内容。使用MATLAB的自动宁滨，很难判断你在里面放了多少高斯函数。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ke"><img src="../Images/900048599707953f71438afe4b63da9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*9RnLAT7hpr0aWoYad_4mmQ.png"/></div></figure><p id="26fa" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们可以使用AIC估计量来检查数据中的最佳高斯数。当然，我们知道玩具数据集的答案是3，但在野外不会是这样。</p><pre class="jd je jf jg fd js jt ju jv aw jw bi"><span id="e0ff" class="jx jy hh jt b fi jz ka l kb kc">rng(5)</span><span id="b82f" class="jx jy hh jt b fi kd ka l kb kc">Nguess = 5; % Guess the data has at most 5 Gaussians</span><span id="f521" class="jx jy hh jt b fi kd ka l kb kc">options = statset(); options.MaxIter = 500;</span><span id="f62f" class="jx jy hh jt b fi kd ka l kb kc">% Fit Gaussian Mixture Models for each of the five models<br/>gmmodels = arrayfun( @(x) fitgmdist( data, x, 'Options', options ),[1:Nguess],...<br/>'UniformOutput', false );</span><span id="ac46" class="jx jy hh jt b fi kd ka l kb kc">% Extract the AIC values for each model<br/>AIC_values = cellfun( @(x) x.AIC, gmmodels );</span><span id="7921" class="jx jy hh jt b fi kd ka l kb kc">% Plot AIC values to see the number that gives you the smallest AIC<br/>figure; ax=axes('NextPlot','add'); plot( ax, [1:5], AIC_values );[a,b] = min(AIC_values);<br/>plot(b,a,'ro')</span></pre><p id="3e39" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这将向您显示一个最小值为3的浅平台，这很好，因为这是我们放入人工数据的数量。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ke"><img src="../Images/4a15ccab3335f2b3e3526c6248a4af10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*3-fTTO-3FoAXjUa9-f7jOw.png"/></div></figure><p id="9e99" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我们将尝试使用<strong class="ig hi"> arrayfun </strong>基于我们上面创建的高斯混合模型对数据进行聚类(如果您需要重温您的<strong class="ig hi">乐趣</strong>动作，请查看我在<a class="ae kf" rel="noopener" href="/analytics-vidhya/day-1-making-matlab-fun-ad850eaffbde">制作MATLAB“乐趣”</a>上的帖子)。</p><pre class="jd je jf jg fd js jt ju jv aw jw bi"><span id="e50b" class="jx jy hh jt b fi jz ka l kb kc">Idx = cluster(gmmodels{3},data);</span><span id="004b" class="jx jy hh jt b fi kd ka l kb kc">% We will create artificially spaced bins<br/>Nbins=100;<br/>bins = linspace(0,max(data),Nbins);</span><span id="6139" class="jx jy hh jt b fi kd ka l kb kc">% Create a Kernel Density Function for Each of the 3 Gaussians<br/>% Note the multiplication by the normalization factor<br/>% (sum(Idx==x))/numel(Idx) <br/>% Entries roughly should match up with Nsamples/sum(Nsamples)<br/>%<br/>f = arrayfun( @(x) (sum(Idx==x)/numel(Idx))*ksdensity( data(Idx==x), bins, 'BandWidth', 1 ), [1:3], 'UniformOutput', false );</span><span id="9bf0" class="jx jy hh jt b fi kd ka l kb kc">figure; ax=axes('nextplot','add');</span><span id="2d55" class="jx jy hh jt b fi kd ka l kb kc">arrayfun( @(f_) plot(bins,f_{1}), f );</span></pre><p id="f3d7" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在这里有两个地方你可能需要调整当使用它与你自己的自定义数据。</p><p id="9f99" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">①宁滨。</strong>你可能想尝试一种更有原则的方法，比如<a class="ae kf" href="https://en.wikipedia.org/wiki/Freedman%E2%80%93Diaconis_rule" rel="noopener ugc nofollow" target="_blank">弗里德曼-迪康尼斯法则</a>(非常简单)。</p><p id="5ff5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi"> (2)带宽。</strong>KS密度函数中的参数被任意设置为1。这是你可以玩的东西，或者检查这个<a class="ae kf" href="https://en.wikipedia.org/wiki/Kernel_density_estimation#A_rule-of-thumb_bandwidth_estimator" rel="noopener ugc nofollow" target="_blank">公式</a>。</p><p id="9254" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一旦你显示了结果，它应该看起来很清晰，从视觉上比我们开始的直方图有了很大的改进。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es ke"><img src="../Images/f8bc4e35fe8b465041b17aa917237f0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*qbbpnziamKBaCZBk-VdKMA.png"/></div></figure><p id="928b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后，你会想要通过使用传说中的<strong class="ig hi">补丁</strong>功能获得那种美丽的美感(在这篇文章中有更多<strong class="ig hi">补丁</strong>魔法<a class="ae kf" href="https://neuraljojo.medium.com/day-28-accentuate-your-data-using-best-fit-lines-and-shading-4d6994e72425" rel="noopener">)。</a></p><pre class="jd je jf jg fd js jt ju jv aw jw bi"><span id="ecc4" class="jx jy hh jt b fi jz ka l kb kc">% I use two anonymous functions to create the x and y input to patch<br/>% This way the Kernel Density Function is generated new for each<br/>% of the three Gaussians<br/>patchup_ksf_y = @(ksf) [ksf,zeros(1,numel(ksf)),ksf(1)]';<br/>patchup_ksf_x = @(ksf) [bins,fliplr(bins),bins(1)]';</span><span id="e726" class="jx jy hh jt b fi kd ka l kb kc">% Create a figure without lines or axes<br/>% You can edit here if you wish to preserve any of the plot pieces<br/>figure('color','w'); ax=axes('nextplot','add','xcolor','w','ycolor','w','box','off');</span><span id="d9ac" class="jx jy hh jt b fi kd ka l kb kc">% Create an array that contains three patches<br/>patches = cellfun( @(ksf) patch( patchup_ksf_x(ksf),patchup_ksf_y(ksf),...<br/>'k','EdgeAlpha',0,'facealpha',0.5,'parent',ax ), f )</span><span id="513e" class="jx jy hh jt b fi kd ka l kb kc">% A custom palette for the display<br/>palette=lines(3);</span><span id="62b8" class="jx jy hh jt b fi kd ka l kb kc">% Re-coloring the patches<br/>arrayfun( @(i) set(patches(i),'facecolor',palette(i,:)), [1:3] )</span></pre><p id="e50a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">请注意，这不同于对数据进行高斯拟合。下面是你应该怎么做。</p><pre class="jd je jf jg fd js jt ju jv aw jw bi"><span id="f423" class="jx jy hh jt b fi jz ka l kb kc">gm = arrayfun( @(x) gmdistribution( gmmodels{3}.mu(x), gmmodels{3}.Sigma(x) ), [1:3], 'UniformOutput', false )</span><span id="45f1" class="jx jy hh jt b fi kd ka l kb kc">figure('color','w');<br/>ax = axes('nextplot','add','xlim',[min(bins),max(bins)]);</span><span id="d75c" class="jx jy hh jt b fi kd ka l kb kc">arrayfun( @(x) plot( bins, (sum(Idx==x)/numel(Idx))*pdf( gm{x}, bins' ) ), [1:3] )</span></pre><p id="5766" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们一起来看看数据，核密度图和高斯拟合。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kg"><img src="../Images/4e0f19836e86d532a29cd5254c531a2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0szsEcMR_d006ToOF0q6fA.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">原始数据(左)使用<strong class="bd kh">聚类</strong>函数和高斯混合模型进行聚类——给我们三种颜色。然后可以使用<strong class="bd kh"> ksdensity </strong>或者三个高斯<strong class="bd kh"> pdf </strong> s <strong class="bd kh">平滑这些数据。</strong></figcaption></figure><p id="24ee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这就是生成显示数据集多样性的精美图形所需的全部内容。关于<strong class="ig hi"> ksdensity </strong>函数的另一种用法，请查看我关于<a class="ae kf" href="https://neuraljojo.medium.com/use-matlab-to-create-beautiful-custom-violin-plots-c972358fa97a" rel="noopener">在MATLAB </a>中创建半小提琴图的帖子。</p></div></div>    
</body>
</html>