<html>
<head>
<title>Pandas for Beginners — Reshaping Dataframes — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫初学者——重塑数据框架——第1部分</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/pandas-for-beginners-reshaping-dataframes-part-1-cfb43f6170bf?source=collection_archive---------17-----------------------#2021-02-12">https://medium.com/analytics-vidhya/pandas-for-beginners-reshaping-dataframes-part-1-cfb43f6170bf?source=collection_archive---------17-----------------------#2021-02-12</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><div class=""><h2 id="ac92" class="pw-subtitle-paragraph if hh hi bd b ig ih ii ij ik il im in io ip iq ir is it iu iv iw dx translated">将数据从宽格式转换为长格式</h2></div><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es ix"><img src="../Images/8b459e0f70b941c9b3ae2f2623a049b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pOTwtBqQYH1mMQtG"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">照片由<a class="ae jn" href="https://unsplash.com/@dallasreedy?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">达拉斯里德</a>在<a class="ae jn" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="97ea" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">在分析项目的预处理阶段，我们经常遇到的一个数据争论场景是重塑数据。我们的大多数同事在开始他们的数据科学之旅时都在努力将列转换成行，反之亦然。下图将有助于更好地理解我们试图解决的问题:</p><figure class="iy iz ja jb fd jc er es paragraph-image"><div role="button" tabindex="0" class="jd je di jf bf jg"><div class="er es kk"><img src="../Images/76dc741dacc33514acb53040ee96ce9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZtZR6h8W2SlXfhLzCgu-DQ.png"/></div></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">从宽到长的形式(图片由用户提供)</figcaption></figure><p id="fed5" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">上面介绍的场景称为宽格式到长格式的转换或取消数据帧的透视。在这里，我们将列标题作为类别放在一列中(在本例中为费用类别)，并在另一列中获取它们的相应值(在本例中为费用值)。为了应对这种情况，熊猫提供了一个现成的功能<strong class="jq hj"> <em class="kl">融化</em> </strong> <em class="kl">。</em>实施该功能的逐步方法详述如下:</p><h1 id="8f5c" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">假设和建议</h1><p id="b52e" class="pw-post-body-paragraph jo jp hi jq b jr le ij jt ju lf im jw jx lg jz ka kb lh kd ke kf li kh ki kj hb bi translated">动手是掌握编程的关键。我们建议您在完成教程的过程中继续实现这些代码。<strong class="jq hj">样本数据</strong>和<strong class="jq hj">关联的木星笔记本</strong>在<strong class="jq hj">场景_2文件夹</strong>的<a class="ae jn" href="https://github.com/dalmiaujjwal/Data_Wrangling_Tips_Tricks" rel="noopener ugc nofollow" target="_blank"> <strong class="jq hj"> <em class="kl"> this GitHub链接</em> </strong> </a>中。</p><p id="91e1" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果你是GitHub新手，想学习它，请通过<a class="ae jn" href="https://towardsdatascience.com/must-know-tools-for-data-scientists-114d0b52b0a9" rel="noopener" target="_blank"> <strong class="jq hj"> <em class="kl">这篇</em> </strong> </a>教程。要在您的系统上建立一个新的Python环境，请阅读本教程。</p><p id="1bbc" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">以下是本教程中使用的Python概念和pandas函数/方法的列表:</p><h2 id="5d86" class="lj kn hi bd ko lk ll lm ks ln lo lp kw jx lq lr ky kb ls lt la kf lu lv lc lw bi translated">熊猫功能</h2><ul class=""><li id="0522" class="lx ly hi jq b jr le ju lf jx lz kb ma kf mb kj mc md me mf bi translated">阅读_csv</li><li id="a9f9" class="lx ly hi jq b jr mg ju mh jx mi kb mj kf mk kj mc md me mf bi translated">熔化</li></ul><h1 id="fed3" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">我们开始吧</h1><h2 id="43ce" class="lj kn hi bd ko lk ll lm ks ln lo lp kw jx lq lr ky kb ls lt la kf lu lv lc lw bi translated">步骤1 —准备好数据</h2><p id="2f88" class="pw-post-body-paragraph jo jp hi jq b jr le ij jt ju lf im jw jx lg jz ka kb lh kd ke kf li kh ki kj hb bi translated">在本教程中，我们创建了一个虚拟数据集，其中包含不同费用类别的每月费用。这个数据集和样本数据快照的字典如下:</p><ul class=""><li id="d202" class="lx ly hi jq b jr js ju jv jx ml kb mm kf mn kj mc md me mf bi translated">年份—日历年</li><li id="e389" class="lx ly hi jq b jr mg ju mh jx mi kb mj kf mk kj mc md me mf bi translated">月份—一年中的月份</li><li id="6214" class="lx ly hi jq b jr mg ju mh jx mi kb mj kf mk kj mc md me mf bi translated">食品杂货——家庭购买食品杂货的费用</li><li id="0ea3" class="lx ly hi jq b jr mg ju mh jx mi kb mj kf mk kj mc md me mf bi translated">旅行——家庭旅行产生的费用</li><li id="3fba" class="lx ly hi jq b jr mg ju mh jx mi kb mj kf mk kj mc md me mf bi translated">娱乐——家庭娱乐支出</li></ul><figure class="iy iz ja jb fd jc er es paragraph-image"><div class="er es mo"><img src="../Images/bcf7fac09d3d09cd0308b05e982f8bb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/1*0nfnxo1mvbjDYgRFZ_R7fw.png"/></div><figcaption class="jj jk et er es jl jm bd b be z dx translated">样本数据(图片由作者提供)</figcaption></figure><h2 id="f1db" class="lj kn hi bd ko lk ll lm ks ln lo lp kw jx lq lr ky kb ls lt la kf lu lv lc lw bi translated">步骤2——用Python导入pandas包和数据集。</h2><p id="6d5c" class="pw-post-body-paragraph jo jp hi jq b jr le ij jt ju lf im jw jx lg jz ka kb lh kd ke kf li kh ki kj hb bi translated">一旦有了可用的数据，下一步就是将其导入到Python环境中。</p><pre class="iy iz ja jb fd mp mq mr ms aw mt bi"><span id="f1f9" class="lj kn hi mq b fi mu mv l mw mx"><strong class="mq hj">#### Sample Code<br/>#### Importing Pandas<br/></strong>import pandas as pd</span><span id="7aae" class="lj kn hi mq b fi my mv l mw mx"><strong class="mq hj">#### Importing Data File - Change the Windows Folder Location<br/></strong>imp_data = pd.read_csv("C:\\Ujjwal\\Analytics\\Git\\Scenario_2\\expenses.csv")</span></pre><p id="985c" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">我们使用了Pandas <strong class="jq hj"> <em class="kl"> read_csv </em> </strong>函数来读取Python中的数据。</p><h2 id="bf9e" class="lj kn hi bd ko lk ll lm ks ln lo lp kw jx lq lr ky kb ls lt la kf lu lv lc lw bi translated">第3步—创建长形式的费用表。</h2><p id="8b39" class="pw-post-body-paragraph jo jp hi jq b jr le ij jt ju lf im jw jx lg jz ka kb lh kd ke kf li kh ki kj hb bi translated">一旦我们读取了数据，应用Pandas <strong class="jq hj"> <em class="kl"> melt </em> </strong>函数来创建输入数据帧的long或unpivoted形式。</p><pre class="iy iz ja jb fd mp mq mr ms aw mt bi"><span id="92a3" class="lj kn hi mq b fi mu mv l mw mx"><strong class="mq hj">#### Create the long-form</strong><br/>Long_data = pd.melt(imp_data, id_vars=["Year", "Month"], <br/>                    value_vars=["Grocery", "Travel", "Entertainment"], <br/>                    var_name="Expense Category", <br/>                    value_name="Expense Value")</span></pre><p id="c720" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><strong class="jq hj">解释</strong></p><p id="497f" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated"><em class="kl">熔化</em>功能需要以下参数作为输入:</p><ul class=""><li id="5e45" class="lx ly hi jq b jr js ju jv jx ml kb mm kf mn kj mc md me mf bi translated"><strong class="jq hj">数据帧名称</strong>—melt函数的第一个参数是我们必须应用操作的数据帧。</li><li id="3687" class="lx ly hi jq b jr mg ju mh jx mi kb mj kf mk kj mc md me mf bi translated"><strong class="jq hj"> id_vars </strong> —传递我们<strong class="jq hj">不希望</strong>取消透视的dataframe列名列表。</li><li id="1a39" class="lx ly hi jq b jr mg ju mh jx mi kb mj kf mk kj mc md me mf bi translated"><strong class="jq hj">value _ vars</strong>—传递我们<strong class="jq hj">希望</strong>取消透视的数据帧列名列表。</li><li id="306d" class="lx ly hi jq b jr mg ju mh jx mi kb mj kf mk kj mc md me mf bi translated"><strong class="jq hj">变量名称</strong> —用于新变量列的名称。该列将包含不同的类别(在我们的例子中是费用类别)</li><li id="78c8" class="lx ly hi jq b jr mg ju mh jx mi kb mj kf mk kj mc md me mf bi translated"><strong class="jq hj">值名称</strong> —用于值列的名称。该列将包含与不同类别相关的值(在我们的例子中是费用值)</li></ul><p id="8750" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">请注意，<strong class="jq hj"> <em class="kl">熔化</em> </strong>函数返回一个新的非透视数据帧作为输出。将这个输出捕获到一个新变量中(在我们的例子中是Long_data ),以备将来使用。</p><h1 id="2a74" class="km kn hi bd ko kp kq kr ks kt ku kv kw io kx ip ky ir kz is la iu lb iv lc ld bi translated">结束语</h1><p id="b529" class="pw-post-body-paragraph jo jp hi jq b jr le ij jt ju lf im jw jx lg jz ka kb lh kd ke kf li kh ki kj hb bi translated">在本教程中，我们将数据从宽格式转换为长格式。你能把长表格改回宽表格吗，这样我们就能看到每年每个类别的月支出了。答案请查看<a class="ae jn" href="https://github.com/dalmiaujjwal/Data_Wrangling_Tips_Tricks" rel="noopener ugc nofollow" target="_blank"><strong class="jq hj"><em class="kl">GitHub</em></strong></a>库中提供的代码。有关详细的解释，请查看下一个教程。</p><p id="98a8" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">如果这个教程对你有用，别忘了鼓掌。</p><p id="98c6" class="pw-post-body-paragraph jo jp hi jq b jr js ij jt ju jv im jw jx jy jz ka kb kc kd ke kf kg kh ki kj hb bi translated">快乐学习！！！！</p></div></div>    
</body>
</html>