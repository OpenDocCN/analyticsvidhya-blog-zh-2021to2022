<html>
<head>
<title>Oracle Database Link to PostgreSQL Database</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Oracle数据库链接到PostgreSQL数据库</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/oracle-database-link-to-postgresql-database-b5ac1006f47a?source=collection_archive---------3-----------------------#2021-01-24">https://medium.com/analytics-vidhya/oracle-database-link-to-postgresql-database-b5ac1006f47a?source=collection_archive---------3-----------------------#2021-01-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="caa5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">今天的话题让我的一周变得有趣。我挣扎了一下，但在我的stackoverflow.com兄弟的帮助下，我做到了:)。我不会用所有的细节来烦你。我在工作中遇到的错误是关于数据库编码的。我从一开始就找错了地方。我会在最后分享问题链接。我希望你不要犯同样的错误(对于像我一样不知道编码的人:)。我们还有路要走:)。)</p><p id="c4ae" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我的Oracle数据库字符集是WE8ISO8859P9，换句话说就是LATIN5。因此，我的PostgreSQL数据库应该根据这个配置进行配置。否则，你会在你的客户端上看到“ahap”。</p><p id="618c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了创建具有正确编码的PostgreSQL数据库，我们必须事先做好准备。我们的PostgreSQL数据库运行在Ubuntu 18.04.5 LTS(仿生海狸)上。我们的系统应该知道正确的区域设置，所以我们可以用tr_TR.iso88599创建数据库。</p><p id="1f65" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">从/etc/locale.gen文件中删除包含“TR _ TR ISO-8859–9”(作为root)的行的注释。编辑完文件后，只需执行下面的命令(以root用户身份):</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="18da" class="jl jm hh jh b fi jn jo l jp jq">root@hostname:~# locale-gen<br/>Generating locales (this might take a while)…<br/> en_US.UTF-8… done<br/> tr_TR.ISO-8859–9… done<br/> tr_TR.UTF-8… done<br/>Generation complete.</span></pre><p id="eaa3" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">它将生成我们的语言环境。现在我们可以用正确的编码创建数据库了。</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="4eab" class="jl jm hh jh b fi jn jo l jp jq">CREATE DATABASE turkish_charset ENCODING=’LATIN5' LC_COLLATE=’tr_TR.iso88599' LC_CTYPE=’tr_TR.iso88599' TEMPLATE=template0;</span></pre><p id="4798" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在，我们可以转到Oracle方面了。我的Oracle数据库运行在Oracle Linux Server版上。</p><p id="cdbd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">安装所需的PostgreSQL ODBC驱动程序:</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="b1f1" class="jl jm hh jh b fi jn jo l jp jq">sudo apt-get install odbc-postgresql</span></pre><p id="aa7a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">此外，您需要一个ODBC驱动程序管理器。你可以从<a class="ae jr" href="http://www.unixodbc.org/" rel="noopener ugc nofollow" target="_blank">http://www.unixodbc.org/</a>安装，就像他们在下载页面上说的那样。</p><p id="22d5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们正在处理两个ODBC文件，以提供异构连接。第一个/etc/odbc.ini文件。该文件包含:</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="4ce8" class="jl jm hh jh b fi jn jo l jp jq">[postgres]<br/>Description = postgres<br/>Driver = /usr/lib64/psqlodbc.so<br/>Servername = $database_server<br/>Username = $database_user<br/>Password = $database_user_password<br/>Port = 5432<br/>Database = turkish_charset($postgresql_db_name)</span></pre><p id="fa28" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我运行Oracle数据库的操作系统是基于x64的。因此，我将driver视为“Driver = /usr/lib64/psqlodbc.so”。</p><p id="3e36" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">第二个文件/etc/odbcinst.ini包含:</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="14dc" class="jl jm hh jh b fi jn jo l jp jq"># Example driver definitions</span><span id="11f9" class="jl jm hh jh b fi js jo l jp jq"># Driver from the postgresql-odbc package<br/># Setup from the unixODBC package<br/>#[PostgreSQL]<br/>[postgres]<br/>Description = ODBC for PostgreSQL<br/>Driver = /usr/lib64/psqlodbc.so<br/>Driver64 = /usr/lib64/psqlodbc.so<br/>Setup = /usr/lib64/libodbcpsqlS.so<br/>Setup64 = /usr/lib64/libodbcpsqlS.so<br/>FileUsage = 1</span></pre><p id="e5b1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">像/etc/odbc.ini文件一样，我在这个文件中使用了基于x64的库。我们可以检查我们的ODBC配置:</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="3d95" class="jl jm hh jh b fi jn jo l jp jq">Last login: Mon Jan 25 01:10:50 +03 2021<br/>[oracle@hostname ~]$ isql -v postgres<br/>+ — — — — — — — — — — — — — — — — — — — -+<br/>| Connected! |<br/>| |<br/>| sql-statement |<br/>| help [tablename] |<br/>| quit |<br/>| |<br/>+ — — — — — — — — — — — — — — — — — — — -+<br/>SQL&gt;</span></pre><p id="aa01" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">将TNS条目添加到＄ORACLE _ HOME(database)/network/admin/tnsnames . ora</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="dd1a" class="jl jm hh jh b fi jn jo l jp jq">postgres =<br/> (DESCRIPTION =<br/> (ADDRESS = (PROTOCOL = TCP)(HOST = $database_server)(PORT = 1521))<br/> (CONNECT_DATA =<br/> (SERVER = DEDICATED)<br/> (SID = postgres)<br/> )<br/> (HS = OK)<br/> )</span></pre><p id="79f5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">正在创建初始化文件。该文件的名称至关重要。因为，当你通过db link调用另一个数据库时，它首先会转到TNS文件。我不知道你是否指出了括号中的名字(提示:[postgres])。它们是服务名。它们应该与TNS条目的SID值相同，我们的init文件也被称为init <strong class="ig hi"> postgres </strong>。奥拉。所以，init <strong class="ig hi"> postgres </strong>的内容。ora文件:</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="a17d" class="jl jm hh jh b fi jn jo l jp jq"># Linux<br/>HS_FDS_CONNECT_INFO = <strong class="jh hi">postgres</strong><br/>HS_FDS_TRACE_LEVEL = ON<br/>HS_FDS_SHAREABLE_NAME = /usr/lib64/libodbc.so<br/>set ODBCINI=/etc/odbc.ini<br/>set ODBCINSTINI=/etc/odbcinst.ini<br/>HS_NLS_LENGTH_SEMANTICS=BYTE<br/>NLS_LANGUAGE=AMERICAN<br/>NLS_TERRITORY=AMERICA<br/>NLS_CHARACTERSET=WE8ISO8859P9</span></pre><p id="e445" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">注意:我没有提到在哪里创建这个init文件。因为它是一个异构源，所以我们需要在$ORACLE_HOME/hs/admin目录中创建它。感谢<a class="ae jr" rel="noopener" href="/@herphan?source=user_profile-------------------------------------"> <strong class="ig hi"> Stephan </strong> </a>。</p><p id="2b44" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">HS _ FDS _连接_信息参数也获得与TNS条目的SID值相同的值。</p><p id="e3ad" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我们应该编辑的最后一个文件是$ORACLE_HOME(如果正在使用网格，则为数据库)/network/admin/listener.ora文件。在行下方添加:</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="0670" class="jl jm hh jh b fi jn jo l jp jq">#Added manually for dblink <br/>SID_LIST_LISTENER =<br/> (SID_LIST =<br/> (SID_DESC =<br/> (ORACLE_HOME=/u01/app/oracle/product/12.1/dbhome1)<br/> (ENV=”LD_LIBRARY_PATH=/u01/app/oracle/product/12.1/dbhome1/lib:/usr/local/unixodbc/lib:/usr/lib:/usr/lib64")<br/> (SID_NAME=postgres)<br/> (PROGRAM=dg4odbc)<br/> )<br/> )</span></pre><p id="4ea0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">SID_LIST_LISTENER的SID值也获得与TNS条目的SID值相同的值。</p><p id="50d0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后一步，创建数据库链接:</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="b3e4" class="jl jm hh jh b fi jn jo l jp jq">CREATE DATABASE LINK POSTGRELINK<br/> CONNECT TO “ $remote_postgresql_database_user”<br/> IDENTIFIED BY $remote_postgresql_database_user_password<br/> USING ‘postgres($TNS_ENTRY_NAME)’;</span></pre><p id="8d88" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">PostgreSQL端:</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="4277" class="jl jm hh jh b fi jn jo l jp jq">=# select * from test;<br/> username <br/> — — — — — — — -<br/> fıstıkçışahap<br/>(1 row)</span><span id="6a64" class="jl jm hh jh b fi js jo l jp jq">postgres=#</span></pre><p id="89a4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">Oracle端:</p><pre class="jc jd je jf fd jg jh ji jj aw jk bi"><span id="8ad6" class="jl jm hh jh b fi jn jo l jp jq">select * from “test”<a class="ae jr" href="http://twitter.com/postgrelink" rel="noopener ugc nofollow" target="_blank">@postgrelink</a>; — — due to case sensivity</span><span id="fb0f" class="jl jm hh jh b fi js jo l jp jq">fıstıkçışahap</span></pre><p id="37a0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">我的错误:<a class="ae jr" href="https://stackoverflow.com/questions/65861426/oracle-client-charset" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/65861426/Oracle-client-charset</a></p><p id="41f2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">谢谢:)！</p></div></div>    
</body>
</html>