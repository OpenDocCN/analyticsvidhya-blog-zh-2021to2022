<html>
<head>
<title>Emmy Awards — Building my own R Shiny Framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">艾美奖奖——建立我自己的闪亮框架</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/emmy-awards-building-my-own-r-shiny-framework-237538880cf7?source=collection_archive---------4-----------------------#2021-10-02">https://medium.com/analytics-vidhya/emmy-awards-building-my-own-r-shiny-framework-237538880cf7?source=collection_archive---------4-----------------------#2021-10-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="3b20" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">T4最近发布的最酷的数据集之一是艾美奖奖数据集。</p><p id="a24b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于那些不知道的人来说，TidyTuesday挑战是关于每周在R中进行一次数据探索，使用TidyTuesday提供的数据集或文章。</p><p id="c247" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这是提高你的R技能、获得反馈和认识社区中许多有趣的人的绝佳方式。</p><p id="3859" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对于这个特定的挑战，我利用了我作为一名<strong class="ig hi">开发人员</strong>(代码效率，如何生成可靠的文件结构，部署知识)和作为一名<strong class="ig hi">数据分析师</strong>的知识:如何争论和正确地呈现数据。因此，我创建了一个自定义的R Shiny框架，以便将来作为模板使用。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/5cf178804c0171f7a9819f6ec1e7ca8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QQBvl5loYaKaYnJZwEI-tg.jpeg"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">最终仪表板</figcaption></figure></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="5bdd" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">用户界面</h1><p id="17e7" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">在开始编码之前，我最初的想法是创建一个易于复制的仪表板，作为我未来项目的模板。因此，它应该包含:</p><ul class=""><li id="9646" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><strong class="ig hi"> Filters </strong>:多选，在这种情况下动态查看数据。</li><li id="d4a1" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><strong class="ig hi">侧边栏的切换功能</strong>。过滤器需要屏幕上的空间，这应该是可选的。</li><li id="fc2d" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><strong class="ig hi"> CSS </strong>定制应用:我自己的颜色和字体🎨</li><li id="47db" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">图表用空格分隔:为了保持整洁，通常我会尽量展示不超过4个图表。</li></ul><p id="8e62" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">所以我心目中的用户界面是这样的:</p><div class="je jf jg jh fd ab cb"><figure class="lr ji ls lt lu lv lw paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/0f6ea21f56e14dd9b61dd5f61b07d741.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*iFec7E7-WBdGs0IG_clKSA.jpeg"/></div></figure><figure class="lr ji ls lt lu lv lw paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><img src="../Images/555959d1621603021a06c2a8ab7ce2ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*P4Fa6FHdICnIcdiR5xVdYg.jpeg"/></div><figcaption class="jp jq et er es jr js bd b be z dx lx di ly lz translated">R闪亮模板的草稿</figcaption></figure></div><h1 id="a54b" class="ka kb hh bd kc kd ma kf kg kh mb kj kk kl mc kn ko kp md kr ks kt me kv kw kx bi translated">我的自定义R闪亮框架</h1><p id="77ca" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">设计好UI结构后，下一步是创建文件基础设施，避免我的文件杂乱无章。在用不同的代码语言(Django，Angular，Laravel…)使用了几个框架之后，我认为把我的文件分成几个部分的最好方法是:</p><p id="de7b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">前端文件</strong></p><ul class=""><li id="8906" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><code class="du mf mg mh mi b">ui.R</code>:包含了app的整体结构。</li><li id="59f7" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><strong class="ig hi">前端</strong>文件夹:包含与图表可视化相关的R文件。</li></ul><p id="8ac5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果你想添加很多元素，比如过滤器、图表等等，一个好的代码实践是将<code class="du mf mg mh mi b">ui.R</code>分成几个文件。为了让你的代码尽可能的干净。在这种情况下，没有必要。</p><p id="5df1" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">后端文件</strong></p><ul class=""><li id="7a4b" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><code class="du mf mg mh mi b">server.R</code>:它包含了应用程序的反应部分:提取数据，ETL，最后将数据返回给ui。</li></ul><p id="91fd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们在这里暂停一下。从ui中收集过滤器参数很重要，以便以后使用它们来过滤我们的数据。为了做到这一点，我们创建了一个<em class="mj">反应</em>元素，它将作为应用程序中的监听器。</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mk"><img src="../Images/fc1660e69160a41213705d8f84841bdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*ZKkF8mhLESsSKhi9nyf9sQ.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">过滤器参数的监听器。</figcaption></figure><p id="bcce" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">之后，我们创建一个<code class="du mf mg mh mi b">observeEvent</code>来使用监听器信息。</p><ul class=""><li id="d11e" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><strong class="ig hi">后端</strong>文件夹:它包含一个控制过滤器功能的<code class="du mf mg mh mi b">filters.R</code>文件和一个过滤和变异数据以便在可视化中使用的<code class="du mf mg mh mi b">dataCharts.R</code>文件。</li></ul><p id="f3ee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">笔记本。Rmd </strong> <strong class="ig hi">文件</strong>:它允许我创建和测试图表，而无需在每次需要时激活应用程序。是快速测试和做实验的好方法。</p><p id="f3a9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">www文件夹</strong>:包含app的CSS。此外，如果你想添加任何图片加载到闪亮的应用程序，这里是你把它。</p><p id="19ec" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后但同样重要的是，生成这个特定的应用程序还有其他必要的文件:</p><ul class=""><li id="efd1" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated"><em class="mj"> showsRace.gif. </em>这个gif被用作应用程序中的图表3，这是因为(据我所知)在R shiny中绘制动画图表时，需要先将其导出为gif。</li><li id="5176" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated"><em class="mj">华夫饼主</em>文件夹。这个文件夹是我用来在应用程序中生成<a class="ae jc" href="https://github.com/hrbrmstr/waffle" rel="noopener ugc nofollow" target="_blank">华夫饼</a>的库。我把它放在这里是因为，由于waffle库不是一个CRAN包，当你在R Shiny中部署它时，你会得到一个错误。这个错误的解决方案是从源代码下载这个包，并在代码中加载它。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es ml"><img src="../Images/a036287410225e6daecf364f6d41d408.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m-SFgg33JXnoSBIzDBaLyQ.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">我为文件基础设施定制的框架。</figcaption></figure></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="bfb3" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">将gif包含到仪表板中</h1><p id="a2e5" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">让我们看一个具体的例子来说明这一切是如何工作的:让我们生成动画的条形图并将其绘制到仪表板中。</p><p id="d4cf" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">首先，我们需要在<em class="mj"> ui </em>中为图表创建一个空间(在本例中，将是第三个图表):</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mm"><img src="../Images/dc27542587039f24afbbe704cc1271c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*8roeq3HBBGBuCTw4zT1dyg.png"/></div><figcaption class="jp jq et er es jr js bd b be z dx translated">我们使用imageOutput，因为我们需要在这里显示一个gif</figcaption></figure><p id="7964" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">之后，我们需要在R闪亮的外面生成gif，下面是代码</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mn"><img src="../Images/af55ad0bad93d13c284409b02dd51297.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PEjiE1CWmNpSdpb6DqRYFA.png"/></div></div><figcaption class="jp jq et er es jr js bd b be z dx translated">R中的Bar Race gif</figcaption></figure><p id="a83e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最后一步是使用<code class="du mf mg mh mi b">server.R</code>中的代码渲染图像，如下所示:</p><figure class="je jf jg jh fd ji er es paragraph-image"><div class="er es mo"><img src="../Images/1c6eb754e1f68679ad1f06e17e09884a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*vsW2Zmq5fndlwg-9Zb5y-g.png"/></div></figure><p id="474c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这将把我们的动画图表绘制到仪表板中👏</p><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es mp"><img src="../Images/8487978ba4931bc7766a9a22dbfef290.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*-OlDoNBp0th6C4d9ZuxY8g.gif"/></div></div></figure></div><div class="ab cl jt ju go jv" role="separator"><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy jz"/><span class="jw bw bk jx jy"/></div><div class="ha hb hc hd he"><h1 id="3aeb" class="ka kb hh bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx bi translated">结论</h1><p id="297c" class="pw-post-body-paragraph ie if hh ig b ih ky ij ik il kz in io ip la ir is it lb iv iw ix lc iz ja jb ha bi translated">经过几个小时的编码和拼接，这是最终的仪表板，其中:</p><ul class=""><li id="e4d7" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">左上图:它显示了根据提名和获奖情况排序的前5名节目。</li><li id="8c1c" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">右上角的图表:在这里你可以看到一个华夫饼可视化，前一个图表中绘制的前1名节目的提名数与获胜数(即:下一个图像代表<em class="mj">周六夜现场</em>的提名者与获胜者)</li><li id="fe4a" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">左下角图表:每年10大动态gif展示。</li><li id="7bd1" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">右下角的图表:随着时间的推移，我最喜欢的每个分销商有多少“胜利”。</li></ul><figure class="je jf jg jh fd ji er es paragraph-image"><div role="button" tabindex="0" class="jj jk di jl bf jm"><div class="er es jd"><img src="../Images/5cf178804c0171f7a9819f6ec1e7ca8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QQBvl5loYaKaYnJZwEI-tg.jpeg"/></div></div></figure><p id="a4d2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">该代码包含在:</p><ul class=""><li id="7481" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">r闪亮:<a class="ae jc" href="https://j0xkj8-juan0antonio.shinyapps.io/RTT_210921/" rel="noopener ugc nofollow" target="_blank">https://j0xkj8-juan0antonio.shinyapps.io/RTT_210921/</a></li><li id="944a" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">github:<a class="ae jc" href="https://github.com/juaancabsou/r-tidy-tuesday" rel="noopener ugc nofollow" target="_blank">https://github.com/juaancabsou/r-tidy-tuesday</a></li></ul><p id="016f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">这就是这个整洁的星期二的全部内容。感谢阅读！如果您有任何反馈，我们将非常欢迎和感谢。</p><p id="4108" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">联系信息</p><ul class=""><li id="5272" class="ld le hh ig b ih ii il im ip lf it lg ix lh jb li lj lk ll bi translated">📱领英:<a class="ae jc" href="https://www.linkedin.com/in/juan-antonio-cabeza-sousa-5b954968/" rel="noopener ugc nofollow" target="_blank">胡安·安东尼奥·卡贝萨·索萨</a></li><li id="d324" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">📬电子邮件:juaancabsou@gmail.com</li><li id="beed" class="ld le hh ig b ih lm il ln ip lo it lp ix lq jb li lj lk ll bi translated">🖥️推特:@Aceconhielo</li></ul></div></div>    
</body>
</html>