<html>
<head>
<title>Building a Rasa chat bot on Google Colab</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Google Colab上构建Rasa聊天机器人</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/building-a-rasa-chat-bot-on-google-colab-2ff6ac02dd26?source=collection_archive---------3-----------------------#2021-09-07">https://medium.com/analytics-vidhya/building-a-rasa-chat-bot-on-google-colab-2ff6ac02dd26?source=collection_archive---------3-----------------------#2021-09-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/945d795570b9e895d15b23f10ae22896.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*I9c5pd_3T0A68gnF"/></div><figcaption class="im in et er es io ip bd b be z dx translated">鸣谢:istockphoto.com/soberP</figcaption></figure><p id="c5cd" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Rasa是一个用于个性化对话的对话式人工智能平台，它是一个使用python和自然语言理解来构建人工智能聊天机器人的工具。它提供了一种训练个性化聊天机器人的平滑方法，这些聊天机器人可以在几个平台上在线托管。</p><p id="f63f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对话聊天机器人如今已经变得非常普遍，被公司广泛用于向需要帮助或信息的客户提供即时反馈。他们减少了恼人的等待时间，而这种等待时间曾经是查询得到答复的标准。</p><p id="c7a1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我要训练的聊天机器人的目标是回答刚到一个城市的旅行者在火车站会问的问题。Rasa聊天机器人由两个组件组成，Rasa nlu和rasa core。Rasa nlu是Rasa的一个组件，用于分类意图和提取实体(细节)，而Rasa core是一个组件，它从Rasa nlu获取结构化输入，并使用概率模型预测下一个最佳操作。更多信息可以从官方文档中获得。这个项目是在谷歌colab上运行的。</p></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="7fd1" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated"><strong class="ak">库和依赖关系</strong></h1><p id="71e3" class="pw-post-body-paragraph iq ir hi is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hb bi translated">安装rasa_nlu[spacy]，rasa_core，nest_asyncio和ipython</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="6084" class="li jx hi le b fi lj lk l ll lm">!pip install nest_asyncio==1.3.3</span><span id="68b1" class="li jx hi le b fi ln lk l ll lm">!pip install rasa_nlu[spacy]  #restart runtime after installation and rerun the cell.</span><span id="fff3" class="li jx hi le b fi ln lk l ll lm">!pip install rasa_core</span><span id="3ac9" class="li jx hi le b fi ln lk l ll lm">pip install -U ipython #restart runtime after installation and rerun the cell.</span></pre><p id="4627" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">导入rasa_core、rasa_nlu空间和系统</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="595b" class="li jx hi le b fi lj lk l ll lm">import rasa_core</span><span id="aafd" class="li jx hi le b fi ln lk l ll lm">import rasa_nlu</span><span id="298d" class="li jx hi le b fi ln lk l ll lm">import spacy</span><span id="dc44" class="li jx hi le b fi ln lk l ll lm">import sys</span><span id="ec03" class="li jx hi le b fi ln lk l ll lm">python = sys.executable</span></pre><p id="bc8f" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下载en_core_web_md，一个中等大小的英文模型，在书面网络文本上训练。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="a12b" class="li jx hi le b fi lj lk l ll lm">!python -m spacy download en_core_web_md</span></pre></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="d3e3" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">拉萨·NLU</h1><p id="5334" class="pw-post-body-paragraph iq ir hi is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hb bi translated">接下来是意图声明和每个意图的样本数据。之后，我训练一个模型，它能准确预测一个短语或句子的意图。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="9dce" class="li jx hi le b fi lj lk l ll lm"># Writing various intents with examples to nlu.md file</span><span id="b762" class="li jx hi le b fi ln lk l ll lm">nlu_md = """</span><span id="0983" class="li jx hi le b fi ln lk l ll lm">## intent:greet</span><span id="16a7" class="li jx hi le b fi ln lk l ll lm">- hey</span><span id="9680" class="li jx hi le b fi ln lk l ll lm">- hello there</span><span id="6db1" class="li jx hi le b fi ln lk l ll lm">- hi</span><span id="8bdd" class="li jx hi le b fi ln lk l ll lm">- hello there</span><span id="1a02" class="li jx hi le b fi ln lk l ll lm">- good morning</span><span id="92b1" class="li jx hi le b fi ln lk l ll lm">- good evening</span><span id="eaa1" class="li jx hi le b fi ln lk l ll lm">- how far</span><span id="8f88" class="li jx hi le b fi ln lk l ll lm">- hey there</span><span id="4487" class="li jx hi le b fi ln lk l ll lm">- whats up</span><span id="fe21" class="li jx hi le b fi ln lk l ll lm">- hey dude</span><span id="63f4" class="li jx hi le b fi ln lk l ll lm">- goodmorning</span><span id="4a15" class="li jx hi le b fi ln lk l ll lm">- goodevening</span><span id="14d1" class="li jx hi le b fi ln lk l ll lm">- good afternoon</span><span id="d0fc" class="li jx hi le b fi ln lk l ll lm">## intent:goodbye</span><span id="d756" class="li jx hi le b fi ln lk l ll lm">- good by</span><span id="b562" class="li jx hi le b fi ln lk l ll lm">- later</span><span id="df70" class="li jx hi le b fi ln lk l ll lm">- good night</span><span id="d409" class="li jx hi le b fi ln lk l ll lm">- good afternoon</span><span id="3956" class="li jx hi le b fi ln lk l ll lm">- bye</span><span id="e592" class="li jx hi le b fi ln lk l ll lm">- goodbye</span><span id="610e" class="li jx hi le b fi ln lk l ll lm">- have a nice day</span><span id="a498" class="li jx hi le b fi ln lk l ll lm">- see you around</span><span id="bfb1" class="li jx hi le b fi ln lk l ll lm">- bye bye</span><span id="fe20" class="li jx hi le b fi ln lk l ll lm">- see you later</span><span id="544f" class="li jx hi le b fi ln lk l ll lm">## intent:thanks</span><span id="0946" class="li jx hi le b fi ln lk l ll lm">- thanks</span><span id="a0ff" class="li jx hi le b fi ln lk l ll lm">- thank you</span><span id="99a2" class="li jx hi le b fi ln lk l ll lm">- appreciated</span><span id="736a" class="li jx hi le b fi ln lk l ll lm">- gracias</span><span id="b00a" class="li jx hi le b fi ln lk l ll lm">## intent:directions</span><span id="f734" class="li jx hi le b fi ln lk l ll lm">- how do i get to</span><span id="0b61" class="li jx hi le b fi ln lk l ll lm">- i need to get to</span><span id="6404" class="li jx hi le b fi ln lk l ll lm">- is there a bus to</span><span id="2106" class="li jx hi le b fi ln lk l ll lm">- how i go take reach</span><span id="f5e8" class="li jx hi le b fi ln lk l ll lm">- I need directions to</span><span id="26d0" class="li jx hi le b fi ln lk l ll lm">- how do i get a cab</span><span id="1bd1" class="li jx hi le b fi ln lk l ll lm">- where can i get a taxi</span><span id="bd32" class="li jx hi le b fi ln lk l ll lm">- where can i get a bus</span><span id="6c8e" class="li jx hi le b fi ln lk l ll lm">-i need to get somewhere</span><span id="b4a9" class="li jx hi le b fi ln lk l ll lm">-I am going somewhere</span><span id="d1da" class="li jx hi le b fi ln lk l ll lm">## intent:choosing_item</span><span id="7196" class="li jx hi le b fi ln lk l ll lm">- 1</span><span id="551a" class="li jx hi le b fi ln lk l ll lm">- 2</span><span id="5bb9" class="li jx hi le b fi ln lk l ll lm">- 3</span><span id="2a6f" class="li jx hi le b fi ln lk l ll lm">- 4</span><span id="f86b" class="li jx hi le b fi ln lk l ll lm">- 5</span><span id="5f38" class="li jx hi le b fi ln lk l ll lm">- 6</span><span id="ed13" class="li jx hi le b fi ln lk l ll lm">- 7</span><span id="eea4" class="li jx hi le b fi ln lk l ll lm">## intent:accomodation_enquiry</span><span id="c43e" class="li jx hi le b fi ln lk l ll lm">- Where is the nearest hotel ?</span><span id="e43e" class="li jx hi le b fi ln lk l ll lm">- is there a hotel near by ?</span><span id="dec3" class="li jx hi le b fi ln lk l ll lm">- shey hotel they this area ?</span><span id="af4d" class="li jx hi le b fi ln lk l ll lm">- Where i fit crash for here ?</span><span id="ac44" class="li jx hi le b fi ln lk l ll lm">- i want to get to a hotel</span><span id="9bdb" class="li jx hi le b fi ln lk l ll lm">- i need to get to a hotel</span><span id="00c8" class="li jx hi le b fi ln lk l ll lm">- where can i spend the night ?</span><span id="d763" class="li jx hi le b fi ln lk l ll lm">## intent: restaurant_enquiry</span><span id="fc35" class="li jx hi le b fi ln lk l ll lm">- i need to get food</span><span id="3ae0" class="li jx hi le b fi ln lk l ll lm">- i am hungry</span><span id="5711" class="li jx hi le b fi ln lk l ll lm">- where is the restaurant ?</span><span id="600e" class="li jx hi le b fi ln lk l ll lm">- is there a restaurant ?</span><span id="343d" class="li jx hi le b fi ln lk l ll lm">- where can i get water ?</span><span id="f131" class="li jx hi le b fi ln lk l ll lm">- where i fit buy food for here ?</span><span id="d1b2" class="li jx hi le b fi ln lk l ll lm">- is there a food court nearby ?</span><span id="5a5e" class="li jx hi le b fi ln lk l ll lm">- where them they sell food ?</span><span id="4c6f" class="li jx hi le b fi ln lk l ll lm">- I want chop</span><span id="57e4" class="li jx hi le b fi ln lk l ll lm">- where is the nearest shop?</span><span id="a888" class="li jx hi le b fi ln lk l ll lm">- where can i eat ?</span><span id="f42e" class="li jx hi le b fi ln lk l ll lm">- i need to eat</span><span id="5789" class="li jx hi le b fi ln lk l ll lm">- are there eatries around ?</span><span id="0bec" class="li jx hi le b fi ln lk l ll lm">- where can i buy snacks ?</span><span id="06ba" class="li jx hi le b fi ln lk l ll lm">- I want to buy food</span><span id="94cb" class="li jx hi le b fi ln lk l ll lm">## intent:toilet_enquiry</span><span id="e8bf" class="li jx hi le b fi ln lk l ll lm">- i neeed to pee</span><span id="e41a" class="li jx hi le b fi ln lk l ll lm">- where is the rest room?</span><span id="354b" class="li jx hi le b fi ln lk l ll lm">- where is the toilet</span><span id="d377" class="li jx hi le b fi ln lk l ll lm">- is there a nearby toilet?</span><span id="e7a8" class="li jx hi le b fi ln lk l ll lm">- i they find toilet</span><span id="ef66" class="li jx hi le b fi ln lk l ll lm">- where is the bathroom</span><span id="cd52" class="li jx hi le b fi ln lk l ll lm">- i need to use the bathroom</span><span id="5a47" class="li jx hi le b fi ln lk l ll lm">- where can i pee</span><span id="6b12" class="li jx hi le b fi ln lk l ll lm">- i want peace</span><span id="cffa" class="li jx hi le b fi ln lk l ll lm">- i am pressed</span><span id="843b" class="li jx hi le b fi ln lk l ll lm">"""</span><span id="9711" class="li jx hi le b fi ln lk l ll lm">%store nlu_md &gt;nlu.md</span></pre><p id="d6e0" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">为我们的管道和策略设置配置。回退阈值可以调整以适合个人使用。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="02aa" class="li jx hi le b fi lj lk l ll lm"># Adding the NLU components to the pipeline in config.yml file</span><span id="40a3" class="li jx hi le b fi ln lk l ll lm">config = """</span><span id="b46a" class="li jx hi le b fi ln lk l ll lm">language: "en_core_web_md"</span><span id="c07a" class="li jx hi le b fi ln lk l ll lm">pipeline:</span><span id="d187" class="li jx hi le b fi ln lk l ll lm">- name: "nlp_spacy"                   # loads the spacy language model</span><span id="c6b2" class="li jx hi le b fi ln lk l ll lm">- name: "tokenizer_spacy"             # splits the sentence into tokens</span><span id="0dc1" class="li jx hi le b fi ln lk l ll lm">- name: "ner_crf"                     # uses the pretrained spacy NER model</span><span id="21b7" class="li jx hi le b fi ln lk l ll lm">- name: "intent_featurizer_spacy"     # transform the sentence into a vector representation</span><span id="85fe" class="li jx hi le b fi ln lk l ll lm">- name: "intent_classifier_sklearn"   # uses the vector representation to classify using SVM</span><span id="7591" class="li jx hi le b fi ln lk l ll lm">- name: "ner_synonyms"                # trains the synonyms</span><span id="a0a1" class="li jx hi le b fi ln lk l ll lm">policies:</span><span id="376e" class="li jx hi le b fi ln lk l ll lm">- name: "RulePolicy"</span><span id="fc62" class="li jx hi le b fi ln lk l ll lm"># a confidence &gt;= core_fallback_threshold</span><span id="d018" class="li jx hi le b fi ln lk l ll lm">core_fallback_threshold: 0.68                            # Confidence threshold for the `core_fallback_action_name` to apply.</span><span id="16c9" class="li jx hi le b fi ln lk l ll lm">core_fallback_action_name: "action_default_fallback"     # The action will apply if no other action was predicted with</span><span id="2a0e" class="li jx hi le b fi ln lk l ll lm">enable_fallback_prediction: True                         # a confidence &gt;= core_fallback_threshold</span><span id="45ed" class="li jx hi le b fi ln lk l ll lm">"""</span><span id="d002" class="li jx hi le b fi ln lk l ll lm">%store config &gt;config.yml</span></pre><h1 id="c853" class="jw jx hi bd jy jz lo kb kc kd lp kf kg kh lq kj kk kl lr kn ko kp ls kr ks kt bi translated">训练模型</h1><p id="e1e1" class="pw-post-body-paragraph iq ir hi is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hb bi translated">导入“加载数据”和“配置”模块，加载训练数据文件和配置文件，并将其提供给训练器模块以训练模型。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="319a" class="li jx hi le b fi lj lk l ll lm"># Import modules for training</span><span id="f0aa" class="li jx hi le b fi ln lk l ll lm">from rasa_nlu.training_data import load_data</span><span id="71b5" class="li jx hi le b fi ln lk l ll lm">from rasa_nlu.config import RasaNLUModelConfig</span><span id="18c9" class="li jx hi le b fi ln lk l ll lm">from rasa_nlu.model import Trainer</span><span id="0fab" class="li jx hi le b fi ln lk l ll lm">from rasa_nlu import config</span><span id="a1b8" class="li jx hi le b fi ln lk l ll lm"># loading the nlu training samples</span><span id="61a2" class="li jx hi le b fi ln lk l ll lm">training_data = load_data("nlu.md")</span><span id="4691" class="li jx hi le b fi ln lk l ll lm">trainer = Trainer(config.load("config.yml"))</span><span id="3984" class="li jx hi le b fi ln lk l ll lm"># training the nlu</span><span id="6c14" class="li jx hi le b fi ln lk l ll lm">interpreter = trainer.train(training_data)</span><span id="a695" class="li jx hi le b fi ln lk l ll lm">model_directory = trainer.persist("./models/nlu", fixed_model_name="current")</span></pre><p id="8334" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">测试模型。<br/>目的是看它能多好地预测意图，并根据预测做出适当的反应。输出应该是意图及其置信度值。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="5587" class="li jx hi le b fi lj lk l ll lm"># Testing the NLU model with an input message</span><span id="d70d" class="li jx hi le b fi ln lk l ll lm">import json</span><span id="a158" class="li jx hi le b fi ln lk l ll lm">def pprint(o):</span><span id="b7ef" class="li jx hi le b fi ln lk l ll lm">    print(json.dumps(o, indent=2))</span><span id="c8db" class="li jx hi le b fi ln lk l ll lm">pprint(interpreter.parse("x"))</span></pre></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="b86b" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">Rasa核心</h1><p id="0437" class="pw-post-body-paragraph iq ir hi is b it ku iv iw ix kv iz ja jb kw jd je jf kx jh ji jj ky jl jm jn hb bi translated">这是项目的第二部分，我们将处理故事、动作和模板，以便我们的机器人可以适当地响应查询。一个故事是一条路径，包含意图和它们各自要采取的行动。动作是我们希望我们的机器人在识别意图后给出的响应。模板是我们存储所有动作的地方。插槽是我们的机器人的记忆，帮助它跟踪事件。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="642c" class="li jx hi le b fi lj lk l ll lm"># Writing stories and saving it in the stories.md file</span><span id="6c57" class="li jx hi le b fi ln lk l ll lm">stories_md = """</span><span id="e3d2" class="li jx hi le b fi ln lk l ll lm">##  Greeting path</span><span id="e6b9" class="li jx hi le b fi ln lk l ll lm">* greet</span><span id="3fb8" class="li jx hi le b fi ln lk l ll lm">- utter_greet</span><span id="6db9" class="li jx hi le b fi ln lk l ll lm">## directions path</span><span id="c5ad" class="li jx hi le b fi ln lk l ll lm">* directions</span><span id="4a96" class="li jx hi le b fi ln lk l ll lm">- utter_menu</span><span id="1a97" class="li jx hi le b fi ln lk l ll lm">* choosing_destination</span><span id="9461" class="li jx hi le b fi ln lk l ll lm">- utter_destination_received</span><span id="2d81" class="li jx hi le b fi ln lk l ll lm">## Enquires path</span><span id="14bb" class="li jx hi le b fi ln lk l ll lm">* accomodation_enquiry</span><span id="9990" class="li jx hi le b fi ln lk l ll lm">- utter_enquiry</span><span id="3647" class="li jx hi le b fi ln lk l ll lm">## thanks path</span><span id="b79b" class="li jx hi le b fi ln lk l ll lm">* thanks</span><span id="989e" class="li jx hi le b fi ln lk l ll lm">- utter_thanks</span><span id="5e1a" class="li jx hi le b fi ln lk l ll lm">## restaurant path</span><span id="445c" class="li jx hi le b fi ln lk l ll lm">* restaurant_enquiry</span><span id="f2f5" class="li jx hi le b fi ln lk l ll lm">- utter_restaurant_enquiry</span><span id="c3ba" class="li jx hi le b fi ln lk l ll lm">## toilet path</span><span id="5cca" class="li jx hi le b fi ln lk l ll lm">* toilet_enquiry</span><span id="94d9" class="li jx hi le b fi ln lk l ll lm">- utter_toilet_location</span><span id="f70a" class="li jx hi le b fi ln lk l ll lm">## say goodbye</span><span id="4b5f" class="li jx hi le b fi ln lk l ll lm">* goodbye</span><span id="be8a" class="li jx hi le b fi ln lk l ll lm">- utter_goodbye</span><span id="859b" class="li jx hi le b fi ln lk l ll lm">## thanks</span><span id="3460" class="li jx hi le b fi ln lk l ll lm">* thanks</span><span id="5c65" class="li jx hi le b fi ln lk l ll lm">- utter_thanks</span><span id="fe78" class="li jx hi le b fi ln lk l ll lm">## fallback rule</span><span id="80f5" class="li jx hi le b fi ln lk l ll lm">* bot_fallback</span><span id="6b5e" class="li jx hi le b fi ln lk l ll lm">- action_default_fallback</span><span id="7649" class="li jx hi le b fi ln lk l ll lm">"""</span><span id="b486" class="li jx hi le b fi ln lk l ll lm">%store stories_md &gt;stories.md</span></pre><p id="f31b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这个域是我们为聊天机器人链接所有文件的地方。uttar_default动作是当所有可能意图的置信度值低于在回退策略下的配置文件中设置的阈值时要采取的动作。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="f263" class="li jx hi le b fi lj lk l ll lm"># Writing all the intents,slots,entities,actions and templates to domain.yml</span><span id="09cd" class="li jx hi le b fi ln lk l ll lm">domain_yml = """</span><span id="56a2" class="li jx hi le b fi ln lk l ll lm">intents:</span><span id="9520" class="li jx hi le b fi ln lk l ll lm">- greet</span><span id="f92b" class="li jx hi le b fi ln lk l ll lm">- goodbye</span><span id="d2f9" class="li jx hi le b fi ln lk l ll lm">- directions</span><span id="5e61" class="li jx hi le b fi ln lk l ll lm">- choosing_item</span><span id="6442" class="li jx hi le b fi ln lk l ll lm">- accomodation_enquiry</span><span id="d5e8" class="li jx hi le b fi ln lk l ll lm">- restaurant_enquiry</span><span id="c6bb" class="li jx hi le b fi ln lk l ll lm">- toilet_enquiry</span><span id="cd33" class="li jx hi le b fi ln lk l ll lm">- thanks</span><span id="a42d" class="li jx hi le b fi ln lk l ll lm">slots:</span><span id="7c68" class="li jx hi le b fi ln lk l ll lm">group:</span><span id="cc24" class="li jx hi le b fi ln lk l ll lm">type: text</span><span id="f055" class="li jx hi le b fi ln lk l ll lm">entities:</span><span id="40de" class="li jx hi le b fi ln lk l ll lm">- group</span><span id="f802" class="li jx hi le b fi ln lk l ll lm">actions:</span><span id="bcd8" class="li jx hi le b fi ln lk l ll lm">- utter_greet</span><span id="4e5b" class="li jx hi le b fi ln lk l ll lm">- utter_menu</span><span id="0c22" class="li jx hi le b fi ln lk l ll lm">- utter_destination_received</span><span id="d289" class="li jx hi le b fi ln lk l ll lm">- utter_enquiry</span><span id="431f" class="li jx hi le b fi ln lk l ll lm">- utter_toilet_location</span><span id="538b" class="li jx hi le b fi ln lk l ll lm">- utter_restaurant_enquiry</span><span id="d228" class="li jx hi le b fi ln lk l ll lm">- utter_goodbye</span><span id="94c4" class="li jx hi le b fi ln lk l ll lm">- utter_thanks</span><span id="193c" class="li jx hi le b fi ln lk l ll lm">- utter_default</span><span id="ebae" class="li jx hi le b fi ln lk l ll lm">templates:</span><span id="139f" class="li jx hi le b fi ln lk l ll lm">utter_greet:- text: "\n\n NRC BOT: \n\n Hey! Welcome to NRC Kubwa terminal . How may I help you ? \n\n \n\n You:"</span><span id="de44" class="li jx hi le b fi ln lk l ll lm">utter_menu:</span><span id="ee70" class="li jx hi le b fi ln lk l ll lm">- text: "\n\n NRC BOT: \n\n There is a bus terminal outside the station, it's just accross the road.  You can board a bus to the following destinations: \n\n 1. Wuse  2. Airport 3. Nyanya  4. Zuba  5. Asokoro  6. Maitama  7. Area one  8. Central area  8. Secretariat. \n\n Enter  the appropraite number to know when the next bus leaves the terminal. \n\n \n\n  You:"</span><span id="b626" class="li jx hi le b fi ln lk l ll lm">utter_destination_received:</span><span id="fb25" class="li jx hi le b fi ln lk l ll lm">- text: "\n\n NRC BOT: \n\n The next bus leaves in 15 minutes, do have a safe trip. \n\n \n\n You:"</span><span id="d841" class="li jx hi le b fi ln lk l ll lm">utter_goodbye:</span><span id="7ca5" class="li jx hi le b fi ln lk l ll lm">- text: "\n\n NRC BOT: \n\n Thank you for choosing to transit with us. Waiting for your next visit. \n\n \n\n You:"</span><span id="c55f" class="li jx hi le b fi ln lk l ll lm">utter_enquiry:</span><span id="780a" class="li jx hi le b fi ln lk l ll lm">- text: "\n\n NRC BOT: \n\n Take a right turn from the exit, there are several hotels at your service. \n\n \n\n You:"</span><span id="6117" class="li jx hi le b fi ln lk l ll lm">utter_toilet_location:</span><span id="2a3b" class="li jx hi le b fi ln lk l ll lm">- text: "\n\n NRC BOT: \n\n There is a toilet symbol on the extreme right from where you stand. \n\n \n\n You:"</span><span id="9c19" class="li jx hi le b fi ln lk l ll lm">utter_restaurant_enquiry:</span><span id="3e3b" class="li jx hi le b fi ln lk l ll lm">- text: "\n\n NRC BOT: \n\n There is a food court filled with a variety of rastaurants at the extreme left after the entrance. \n\n \n\n You: "</span><span id="5c36" class="li jx hi le b fi ln lk l ll lm">utter_thanks:</span><span id="fc1c" class="li jx hi le b fi ln lk l ll lm">- text: "\n\n NRC BOT: \n\n my pleasure \n\n \n\n You:"</span><span id="fbf6" class="li jx hi le b fi ln lk l ll lm">utter_default:</span><span id="3660" class="li jx hi le b fi ln lk l ll lm">- text: "\n\n NRC BOT: \n\n I'm sorry, I didn't quite understand that. Could you rephrase? \n\n You:"</span><span id="80e9" class="li jx hi le b fi ln lk l ll lm">"""</span><span id="bff7" class="li jx hi le b fi ln lk l ll lm">%store domain_yml &gt;domain.yml</span></pre><p id="dc53" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在这里，我们导入我们的策略和代理模块。代理模块用于加载文件并传递给“代理”模型。用来自故事文件的数据训练“代理”模型。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="f647" class="li jx hi le b fi lj lk l ll lm"># Import the policies and agent</span><span id="2bf3" class="li jx hi le b fi ln lk l ll lm">from rasa_core.policies import FallbackPolicy, MemoizationPolicy,KerasPolicy</span><span id="9a43" class="li jx hi le b fi ln lk l ll lm">from rasa_core.agent import Agent</span><span id="92fa" class="li jx hi le b fi ln lk l ll lm"># Initialize the model with `domain.yml`</span><span id="b0d9" class="li jx hi le b fi ln lk l ll lm">agent = Agent('domain.yml', policies=[MemoizationPolicy(), KerasPolicy(), ])</span><span id="69ee" class="li jx hi le b fi ln lk l ll lm"># loading our  training dialogues from `stories.md`</span><span id="4cf3" class="li jx hi le b fi ln lk l ll lm">training_data = agent.load_data('stories.md')</span><span id="fdbe" class="li jx hi le b fi ln lk l ll lm"># Training the model</span><span id="f238" class="li jx hi le b fi ln lk l ll lm">agent.train(</span><span id="ec5a" class="li jx hi le b fi ln lk l ll lm">training_data)</span><span id="6071" class="li jx hi le b fi ln lk l ll lm">#validation_split=0.0,</span><span id="042a" class="li jx hi le b fi ln lk l ll lm">#epochs=200)</span><span id="1635" class="li jx hi le b fi ln lk l ll lm">agent.persist('models/dialogue')</span></pre><p id="f9cb" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">安装h5py包的2.10.0版，安装后重启运行时，重新运行所有以前的单元。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="fe88" class="li jx hi le b fi lj lk l ll lm">!pip uninstall h5py</span><span id="a13e" class="li jx hi le b fi ln lk l ll lm">!pip install h5py==2.10.0</span></pre><p id="9f13" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">加载训练好的模型</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="e961" class="li jx hi le b fi lj lk l ll lm">#Starting the Bot</span><span id="2363" class="li jx hi le b fi ln lk l ll lm">from rasa_core.agent import Agent</span><span id="ce14" class="li jx hi le b fi ln lk l ll lm">agent = Agent.load('models/dialogue', interpreter=model_directory)</span></pre><p id="006d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">写一个函数来跟踪聊天机器人的输入，并在输入“停止”时停止输出。键入stop结束会话。</p><pre class="kz la lb lc fd ld le lf lg aw lh bi"><span id="cce0" class="li jx hi le b fi lj lk l ll lm">print("Your bot is ready to talk! Type your messages here or send 'stop'" + "\n\n" + "You:")</span><span id="361e" class="li jx hi le b fi ln lk l ll lm">while True:</span><span id="ff7b" class="li jx hi le b fi ln lk l ll lm">    a = input()</span><span id="d0a9" class="li jx hi le b fi ln lk l ll lm">    if a == 'stop':</span><span id="7d35" class="li jx hi le b fi ln lk l ll lm">        break</span><span id="ca39" class="li jx hi le b fi ln lk l ll lm">    responses = agent.handle_message(a)</span><span id="8ede" class="li jx hi le b fi ln lk l ll lm">    for response in responses:</span><span id="15fc" class="li jx hi le b fi ln lk l ll lm">        print(response["text"])</span></pre></div><div class="ab cl jp jq gp jr" role="separator"><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju jv"/><span class="js bw bk jt ju"/></div><div class="hb hc hd he hf"><h1 id="f880" class="jw jx hi bd jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">视频演示</h1><figure class="kz la lb lc fd ij"><div class="bz dy l di"><div class="lt lu l"/></div></figure><p id="5c0d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">您可以在我的github repo上获得完整的笔记本:</p><div class="lv lw ez fb lx ly"><a href="https://github.com/usmanbiu/rasa-chat-bot.git" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab dw"><div class="ma ab mb cl cj mc"><h2 class="bd hj fi z dy md ea eb me ed ef hh bi translated">GitHub - usmanbiu/rasa-chat-bot:在google colab上开发rasa聊天机器人</h2><div class="mf l"><h3 class="bd b fi z dy md ea eb me ed ef dx translated">谷歌聊天机器人的开发。通过创建一个帐户，为usmanbiu/rasa聊天机器人的开发做出贡献…</h3></div><div class="mg l"><p class="bd b fp z dy md ea eb me ed ef dx translated">github.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ik ly"/></div></div></a></div><p id="bf3b" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">参考文献:</strong></p><p id="0b98" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj">用Rasa和spaCy构建聊天机器人:</strong><a class="ae jo" href="https://www.machinelearningplus.com/nlp/chatbot-with-rasa-and-spacy/" rel="noopener ugc nofollow" target="_blank">https://www . machine learning plus . com/NLP/chatbot-with-Rasa-and-spaCy/</a></p><p id="d093" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hj"> Rasa官方文档:</strong><a class="ae jo" href="https://rasa.com/docs/rasa/" rel="noopener ugc nofollow" target="_blank">https://rasa.com/docs/rasa/</a></p></div></div>    
</body>
</html>