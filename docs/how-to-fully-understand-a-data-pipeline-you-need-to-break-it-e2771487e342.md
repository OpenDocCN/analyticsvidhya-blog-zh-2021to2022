# 如何全面理解一个数据管道？你需要打破它。

> 原文：<https://medium.com/analytics-vidhya/how-to-fully-understand-a-data-pipeline-you-need-to-break-it-e2771487e342?source=collection_archive---------19----------------------->

那么，你刚刚被聘为数据科学家或 ML 工程师？这是写给所有对已建立的团队感到困惑的新人的。

如果你是一名数据科学家或 ML 工程师，像我一样在一家拥有杂乱企业数据的大公司工作，你对复杂的数据管道并不陌生，你并不完全理解。尤其是在一个已建立的项目中，数据专家在一个城市，而您的团队在另一个城市。没有人*真正*了解你的 ML 管道。反正不完全是。不同的数据库有不同的层次结构，文档不清楚，预测是在某个级别上进行的，并在不同的聚合级别上呈现，表之间的映射从来都不完整！一片混乱。

每个人的理解都来自于他们自己写的台词。当然，他们理解高层次，但是当你有客户问你为什么在交付期间没有他们的所有预测，你需要阅读预处理模块中的每一行代码，以找出你可以在哪里过滤掉他们的数据，然而，在几个小时的重新运行、评论和取消评论之后，你仍然会迷失，你会知道高层次不会削减它。你需要知道进出的管道，这样才能在关键时刻诊断火灾。*老实说，关键时刻你也需要这样的火力来控制管道。*

那么，在没有这种火的情况下，一个人如何开始智能地导航他们的管道来学习它的细微差别呢？我说，你从打破你的管道开始。你需要的是挑战。

显然，我不是说搞乱你的生产系统——那是你自己的风险——**我是说创建一个测试文件，它是运行你的完整管道和通过一系列测试所需的最小数据子样本**。在创建这样一个文件的过程中，你会折断、弯曲和敲打你的管道。在这种递归中，你需要所有的直觉。

**等等，我该怎么办？**

我所提议的是一个练习，在这个练习中，你综合生成一个样本测试文件，你将使用它来测试你的团队管道的功能。

*本练习的一个好处是，在练习结束时，您拥有了在 Travis(或任何其他 CI 工具)上运行端到端测试的数据！*

这就像运行一个实验，通过一组转换和函数输入一个输入(我们的小测试文件)，并监控输出(模型预测)。如果输出是您所期望的，那就太棒了！如果没有，你会知道为什么会这样，要么改变你的期望，要么改变文件！

好的，但是我该怎么做呢？

练习是你需要挑战自己，创建一个样本数据集，它可以成功地通过你的机器学习管道，并具有以下特征(你可以在这里发挥创造力，但这是你最起码应该期待的):

1.  在您的管道由于某些最小数据错误(train_test_split 错误、无法运行模型等)而无法运行之前，具有最少的所需观察值
2.  如果您的模式包含分类数据，则应该包含来自多个类别的观察结果，但不是所有类别。如果您有时间序列数据，也许您可以用更少的时间序列数据点进行测试，看看您的管道是否能够处理这些数据。这里的想法是测试当您的数据发生变化/不符合您的预期时，您的管道将如何执行。
3.  通过管道中已经实现的所有测试(通常以断言语句的形式，例如，每个类别的最小观察数，或 PyTests)
4.  ( *Advanced* )足够灵活，可以测试从从数据库获取到发布结果的管道的全部功能

重要的是要记住，你不关心这里的模型性能。显然，如果您在管道中断之前保留最少量的数据，您的模型将不会执行得那么好。

这里的想法是确保您有一个适当的基础设施，其中您的管道足够健壮，可以处理一些异常。如果没有，你有先见之明记录这样的情况或管道告诉你什么时候它打破了。你最不希望的就是你的模型由于数据质量错误而产生错误的预测，而你的客户会告诉你。

**如何使用这个测试文件？**

在将代码投入生产之前，将该文件用作测试环境中的测试。使用 GitHub，您可以配置一个 Travis 构建(或任何 CI 工具),在每次从您的分支创建 PR 时运行。Travis 构建可以使用我们的测试文件来完成和评估它的构建。

这是一个简单快捷的方法，让你开始为你的团队做出真正的贡献。

如果您的团队已经有了这样的测试文件，请询问您的项目经理如何使它更健壮(相信我，他们最近发现了一个他们没有测试过的 bug)。如果没有，那就开始吧。

总之，您创建了一个**最小**测试文件，其中有适量的观察数据，以便**通过**管道，**通过所有测试**，并且**测试功能**的预期。我们希望你能尽早开始你的新 ML 项目。如果这对你有帮助，那就去做吧！

我的测试文件有 41 个 obversations。你有多少？