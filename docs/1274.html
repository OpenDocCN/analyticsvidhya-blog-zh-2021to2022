<html>
<head>
<title>Artificial Intelligence Solves Sudoku: Convolutional Neural Networks (CNN).</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">人工智能解决数独:卷积神经网络(CNN)。</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-solve-sudoku-with-convolutional-neural-networks-cnn-c92be8830c52?source=collection_archive---------8-----------------------#2021-02-22">https://medium.com/analytics-vidhya/how-to-solve-sudoku-with-convolutional-neural-networks-cnn-c92be8830c52?source=collection_archive---------8-----------------------#2021-02-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><figure class="hg hh ez fb hi hj er es paragraph-image"><div role="button" tabindex="0" class="hk hl di hm bf hn"><div class="er es hf"><img src="../Images/9b43aa611ad0e5848b12133faf52e058.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MWOlk8ynBFFJTWRNeW-14Q.jpeg"/></div></div><figcaption class="hq hr et er es hs ht bd b be z dx translated"><a class="ae hu" href="https://unsplash.com/@marjan_blan" rel="noopener ugc nofollow" target="_blank">马尔扬·布兰</a>途经<a class="ae hu" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></figcaption></figure><div class=""/><div class=""><h2 id="9a05" class="pw-subtitle-paragraph iu hw hx bd b iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl dx translated">利用深度学习中的关系推理解决数独。达到93%的测试准确度。</h2></div><p id="80e7" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">数独是我们父母和我们曾经玩过的最常见的基于逻辑的游戏之一。让我们面对现实吧，它没有现在玩CNN有趣。然而，如果我们可以用CNN来玩数独呢？在本文中，我探索了卷积神经网络在这个古老而可爱的游戏中的应用。在我开始之前，我想承认这篇文章的灵感来自于<a class="ae hu" href="https://cs230.stanford.edu/files_winter_2018/projects/6939771.pdf" rel="noopener ugc nofollow" target="_blank">这个可爱的作品</a>，它是作为斯坦福深度学习课程的一个项目提出来的。最后但同样重要的是，我正在为分析Vidhya的第五次数据科学博客撰写这篇文章:)</p><h1 id="4ccb" class="ki kj hx bd kk kl km kn ko kp kq kr ks jd kt je ku jg kv jh kw jj kx jk ky kz bi translated">介绍</h1><figure class="lb lc ld le fd hj er es paragraph-image"><div class="er es la"><img src="../Images/3cf9e47b77d09948b6013f6e266161fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*UgI0vH8wy1mowjlOJMcFdA.png"/></div><figcaption class="hq hr et er es hs ht bd b be z dx translated">蒂姆·斯泰尔马赫通过<a class="ae hu" href="https://commons.wikimedia.org/wiki/File:Sudoku_Puzzle_by_L2G-20050714_standardized_layout.svg" rel="noopener ugc nofollow" target="_blank">维基媒体</a></figcaption></figure><p id="dbb2" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">基于逻辑的游戏，包括数独，被证明有助于延缓神经系统疾病，如阿尔茨海默氏症和痴呆症。数独是一个9×9的网格，人们需要用数字填充它，这样每一列、每一行以及组成棋盘的九个3×3子网格中的每一个都包含从1到9的所有数字。我介绍的工作使用两种不同类型的神经网络来解决这个问题，它们是CNN和RNN。然而，作者发现基于CNN的架构表现得更好，达到86%的测试准确率，而后者仅达到47%的测试准确率。因此，我想提出前一种解决方案，并展示如何有效地使用CNN来解决这个问题。</p><h1 id="b9a4" class="ki kj hx bd kk kl km kn ko kp kq kr ks jd kt je ku jg kv jh kw jj kx jk ky kz bi translated">资料组</h1><p id="84ad" class="pw-post-body-paragraph jm jn hx jo b jp lf iy jr js lg jb ju jv lh jx jy jz li kb kc kd lj kf kg kh ha bi translated">在开始讨论我的解决方案之前，我想指出我使用的数据集可能会有所不同。此外，我的评估指标是解决的数独的数量/数独的总数，而作者计算预测与解决方案匹配的空白的数量/空白的数量。因此，很难比较我的测试结果。名为“一百万个数独游戏”的数据集在Kaggle 上公开发布。该架构在800，000个数独游戏上进行训练，并在200，000个游戏上进行验证。</p><h1 id="3c0d" class="ki kj hx bd kk kl km kn ko kp kq kr ks jd kt je ku jg kv jh kw jj kx jk ky kz bi translated">数据处理</h1><p id="036a" class="pw-post-body-paragraph jm jn hx jo b jp lf iy jr js lg jb ju jv lh jx jy jz li kb kc kd lj kf kg kh ha bi translated">考虑到我们正在将未解决的数独输入CNN，我们将它的形状改为(1，9，9)。此外，我们通过将其除以9并减去0.5对其进行归一化，由此我们获得了零均值中心数据。神经网络通常使用以零为中心的标准化数据表现得更好。最后，我们希望我们的模型能够像在分类任务中一样预测最可能的数字。因此，想象一下，我们需要将标签0-8分配给相应的数字1-9。因此，我们从它的溶液样本中减去1。</p><h1 id="d0ea" class="ki kj hx bd kk kl km kn ko kp kq kr ks jd kt je ku jg kv jh kw jj kx jk ky kz bi translated">模型架构</h1><p id="9412" class="pw-post-body-paragraph jm jn hx jo b jp lf iy jr js lg jb ju jv lh jx jy jz li kb kc kd lj kf kg kh ha bi translated">我正在使用一个非常相似的架构，在<a class="ae hu" href="https://cs230.stanford.edu/files_winter_2018/projects/6939771.pdf" rel="noopener ugc nofollow" target="_blank">这个作品</a>中有介绍。因此，作者提出了16层CNN，其中前15层的每一层具有512个滤波器，最后一层是具有9个滤波器的1乘1卷积。因此，数独棋盘中的每个单元格都有一个长度为9的概率数组，其中每个元素都对应于它的标签。我附上Pytorch实现。请花时间去理解这个架构是如何工作的。</p><figure class="lb lc ld le fd hj"><div class="bz dy l di"><div class="lk ll l"/></div></figure><h1 id="dceb" class="ki kj hx bd kk kl km kn ko kp kq kr ks jd kt je ku jg kv jh kw jj kx jk ky kz bi translated">培养</h1><p id="1869" class="pw-post-body-paragraph jm jn hx jo b jp lf iy jr js lg jb ju jv lh jx jy jz li kb kc kd lj kf kg kh ha bi translated">我训练了5个纪元的网络，批次大小为64。学习率选择为1e-4。最后，我使用了作者提到的Adam optimizer和交叉熵损失。最终验证损失最终约为0.11。</p><h1 id="e72b" class="ki kj hx bd kk kl km kn ko kp kq kr ks jd kt je ku jg kv jh kw jj kx jk ky kz bi translated">解决数独:问题</h1><p id="4fd5" class="pw-post-body-paragraph jm jn hx jo b jp lf iy jr js lg jb ju jv lh jx jy jz li kb kc kd lj kf kg kh ha bi translated">在测试我的模型时，我注意到它很少能完美地解决数独，因此通常会有一些错误的预测。因此，我的准确性很糟糕，因为它不到10%。我想这就是为什么作者计算了预测与解决方案/空白数量相匹配的空白数量。所以，我尝试用不同的方法来解决这个问题。我决定试着一次填一个空格。因此，我只取9x9网格中概率最大的一个预测，因此我一直把它传递给模型，直到一块板完成。正因为如此，我的准确率大幅提高，达到了大约93%。这是我的日志文件的一部分。</p></div><div class="ab cl lm ln go lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ha hb hc hd he"><p id="8917" class="pw-post-body-paragraph jm jn hx jo b jp jq iy jr js jt jb ju jv jw jx jy jz ka kb kc kd ke kf kg kh ha bi translated">A <em class="lt">精度:1969/2112<br/>T4】精度:2026/2176 <br/>精度:2081/2240</em></p></div><div class="ab cl lm ln go lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ha hb hc hd he"><h1 id="f37e" class="ki kj hx bd kk kl lu kn ko kp lv kr ks jd lw je ku jg lx jh kw jj ly jk ky kz bi translated">一些遗言</h1><p id="93f6" class="pw-post-body-paragraph jm jn hx jo b jp lf iy jr js lg jb ju jv lh jx jy jz li kb kc kd lj kf kg kh ha bi translated">有很多方法可以解决这个问题。在这篇文章中，我想介绍其中的一个。因此，正如它所显示的，CNN可以有效地用于解决数独游戏，我的测试准确率约为93%。如果你有兴趣阅读更多，我强烈推荐阅读<a class="ae hu" href="https://cs230.stanford.edu/files_winter_2018/projects/6939771.pdf" rel="noopener ugc nofollow" target="_blank">这部激发我灵感的作品</a>。我认为这对任何学习CNN的人来说都是一个很好的练习。我的工作，是用Pytorch实现的，在<a class="ae hu" href="https://github.com/chingisooinar/sudoku-solver.pytorch" rel="noopener ugc nofollow" target="_blank"> GitHub </a>:)上很容易找到，最后，可以随意分享你的想法或观点。</p></div></div>    
</body>
</html>