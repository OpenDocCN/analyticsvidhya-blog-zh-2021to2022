<html>
<head>
<title>“Bulk Data Load In Databases”</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">"数据库中的大容量数据加载"</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/bulk-data-load-in-databases-c0b5bc53a63?source=collection_archive---------4-----------------------#2021-08-04">https://medium.com/analytics-vidhya/bulk-data-load-in-databases-c0b5bc53a63?source=collection_archive---------4-----------------------#2021-08-04</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="2942" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">一个<strong class="ig hi"> CSV(逗号分隔值)</strong>文件使用逗号分隔文件中的不同值。</p><p id="30f4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">CSV文件是将数据导入表格或将数据导出到系统时的标准格式。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es jc"><img src="../Images/d3a4b6d54ceebdf5fea5e540e96d4019.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DIutJHNt1meyBlV0"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">从CSV到数据库的数据</figcaption></figure><p id="ceab" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为了将CSV文件中的批量条目添加到Mysql、Postgresql、SQL Server、Oracle等数据库中，这需要两个步骤:</p><p id="7098" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">步骤1:从系统中读取CSV文件。</p><p id="a218" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">步骤2:将CSV数据加载到数据库表中。</p><p id="4489" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">在本文中，我们将看到Mysql、Postgresql、Cassandra和SQL Server中的批量数据插入。</strong></p><ol class=""><li id="1edb" class="js jt hh ig b ih ii il im ip ju it jv ix jw jb jx jy jz ka bi translated"><strong class="ig hi"> SQL Server数据库</strong></li></ol><p id="6df5" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们考虑一个名为contacts的表，它有以下几列</p><blockquote class="kb kc kd"><p id="2216" class="ie if ke ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">创建表联系人(<br/>域名NVARCHAR(50)、<br/>元标题文本、<br/>元描述文本、<br/> SOCIALLINKSFACEBOOK文本、<br/> SOCIALLINKSINSTAGRAM文本、<br/> SOCIALLINKSTWITTER文本、<br/> SOCIALLINKSLINKEDIN文本、<br/>电子邮件文本、<br/>EMAIL description NVARCHAR(50))；</p></blockquote><p id="f0e9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对contacts表运行“选择计数”查询，以检查表中最初的行数</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ki"><img src="../Images/d44fba1731a84e9b22744571540bf189.png" data-original-src="https://miro.medium.com/v2/resize:fit:372/format:webp/1*oNFVdpjtydIPT22bbxzAmQ.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">从联系人中选择COUNT(*)作为TOTAL _ COUNT</figcaption></figure><p id="d568" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最初，表中没有记录。现在，让我们将CSV文件中的数据添加到数据库中。要使用的查询:-</p><blockquote class="kb kc kd"><p id="e27e" class="ie if ke ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">从“文件路径\文件名”中批量插入联系人。CSV' <br/> WITH(格式= ' CSV ')；</p></blockquote><p id="44be" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在检查表格中的计数</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es kj"><img src="../Images/e360e7970026c95a1fdc61a7337e5f43.png" data-original-src="https://miro.medium.com/v2/resize:fit:356/format:webp/1*NnFRkLzVZkuGYvI0TJKDFw.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">从联系人中选择COUNT(*)作为TOTAL _ COUNT</figcaption></figure><p id="f767" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">2.<strong class="ig hi"> PostgreSQL </strong></p><p id="ac78" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们考虑一个名为contacts的表，它有以下几列</p><blockquote class="kb kc kd"><p id="e397" class="ie if ke ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">创建表联系人(<br/>域名VARCHAR(50)，元标题文本，<br/>元描述文本，SOCIALLINKSFACEBOOK文本，<br/> SOCIALLINKSINSTAGRAM文本，SOCIALLINKSTWITTER文本，<br/> SOCIALLINKSLINKEDIN文本，电子邮件文本，EMAIL description VARCHAR(50))；</p></blockquote><p id="a8f9" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对contacts表运行“选择计数”查询，检查表中最初的行数</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kk"><img src="../Images/9a1523f54a665b74b81ea6fea9afe056.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*z7H_HWwnPDcZBSKNwOorVQ.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">从联系人中选择COUNT(*)作为TOTAL _ COUNT</figcaption></figure><p id="4aeb" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最初，表中没有记录。现在，让我们将CSV文件中的数据添加到数据库中。要使用的查询:-</p><blockquote class="kb kc kd"><p id="3ae4" class="ie if ke ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">从“文件路径\文件名. csv”分隔符中复制联系人，“CSV</p></blockquote><p id="43a6" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">现在检查表格中的计数</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kl"><img src="../Images/bfb4671dec93b5b72ac214ea0d6c8601.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*AlbuGrueudmhercmTYrayQ.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">从联系人中选择COUNT(*)作为TOTAL _ COUNT</figcaption></figure><p id="a89d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">3.<strong class="ig hi"> MySQL </strong></p><p id="1ffd" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们考虑一个名为contacts的表，它有以下几列</p><blockquote class="kb kc kd"><p id="8e2a" class="ie if ke ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">创建表联系人<br/> ( <br/>域名VARCHAR(50)<br/>元标题文本、元描述文本、<br/> SOCIALLINKSFACEBOOK文本、<br/> SOCIALLINKSINSTAGRAM文本、<br/> SOCIALLINKSTWITTER文本、<br/> SOCIALLINKSLINKEDIN文本、<br/>电子邮件文本、EMAIL description VARCHAR(50))；</p></blockquote><p id="943c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对contacts表运行“选择计数”查询，以检查表中最初的行数</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es km"><img src="../Images/b590865efb614ca9a65cb30e07866b13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*IWyi88U7OQljjYBTuG3XIA.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">从联系人中选择COUNT(*)作为TOTAL _ COUNT</figcaption></figure><p id="32d0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最初，表中没有记录。现在，让我们将CSV文件中的数据添加到数据库中。要使用的查询:-</p><blockquote class="kb kc kd"><p id="0a77" class="ie if ke ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">将文件' file_path/file_name.csv' <br/>中的数据加载到表CONTACTS <br/>字段中，以'，'<br/>结尾，用' " '括起来；</p></blockquote><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kn"><img src="../Images/084b6f40e2ed79521c3600a1a84dba4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*oJZfzBwotvqduNwwWuKirw.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">从联系人中选择COUNT(*)作为TOTAL _ COUNT</figcaption></figure><blockquote class="kb kc kd"><p id="6594" class="ie if ke ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated"><strong class="ig hi">注意:-为了在MySQL中导入或导出文件，我们通常会面临安全文件权限的问题。</strong></p><p id="eaa3" class="ie if ke ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">错误:MySQL服务器正在使用-secure-file-priv选项运行，因此它无法执行此语句</p><p id="6cd6" class="ie if ke ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">解决方案:-</p><p id="3fe5" class="ie if ke ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">1)打开my.ini文件，添加secure-file-priv = ' '并重启mysql服务器。</p><p id="e86f" class="ie if ke ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">2)在查询中加载数据后添加本地。</p></blockquote><p id="9da8" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">4.<strong class="ig hi">卡珊德拉</strong></p><p id="2a36" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">让我们考虑一个名为contacts的表，它有以下几列</p><blockquote class="kb kc kd"><p id="ab3e" class="ie if ke ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">创建表脚本_CHECK。联系人(<br/> CONTACT_ID INT，<br/> CONTACT_NAME TEXT，<br/> CONTACT_DESCRIPTION TEXT，<br/> CREATED_AT BIGINT，<br/> PRIMARY KEY((CONTACT_ID)，CREATED_AT) <br/>)，聚类顺序为BY(CREATED _ AT desc)；</p></blockquote><p id="a5b0" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">对contacts表运行“选择计数”查询，以检查表中最初的行数</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="ji jj di jk bf jl"><div class="er es ko"><img src="../Images/84f8cc1f6db01621f5da8849916c0151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9AO-V79lyYuqsgIKOFn63g.png"/></div></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">从联系人中选择COUNT(*)作为TOTAL _ COUNT</figcaption></figure><p id="6549" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">最初，表中没有记录。现在，让我们将CSV文件中的数据添加到数据库中。要使用的查询:-</p><blockquote class="kb kc kd"><p id="a177" class="ie if ke ig b ih ii ij ik il im in io kf iq ir is kg iu iv iw kh iy iz ja jb ha bi translated">从' file_path\file_name.csv' <br/>中复制script _ check . contacts(contact _ id，created_at，contact_description，contact_name) <br/>，分隔符= '，'，头= TRUE</p></blockquote><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es kp"><img src="../Images/ff2d78eee83c2b1ec80b2535c8d0c140.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*YX_yBcUd86tOFgexUd7U_A.png"/></div><figcaption class="jo jp et er es jq jr bd b be z dx translated">从联系人中选择COUNT(*)作为TOTAL _ COUNT</figcaption></figure><p id="a386" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">有时候，这些将数据加载到数据库中的小技巧会非常有用。</p><p id="ddee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">如果发现有用，就鼓掌🙂。</p></div></div>    
</body>
</html>