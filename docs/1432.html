<html>
<head>
<title>How to solve data tasks quickly — An introduction to Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何快速解决数据任务——熊猫简介</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/how-to-solve-data-tasks-quickly-an-introduction-to-pandas-a5838c219484?source=collection_archive---------14-----------------------#2021-03-01">https://medium.com/analytics-vidhya/how-to-solve-data-tasks-quickly-an-introduction-to-pandas-a5838c219484?source=collection_archive---------14-----------------------#2021-03-01</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/9b04968ca5ea7cdb78c68df71c9e007e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oGMrAoXBGPEx7vhX"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">卢克·切瑟在<a class="ae it" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="8fb5" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">数据科学最重要的工具之一:熊猫——在短时间内学习最常用的函数，以及如何快速得到结果。你从一个大的数据集开始:你如何读取它，清理它，并适当地评估它？我将向您展示最重要的功能。</p><p id="1f63" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">但首先:什么是熊猫，它什么时候被使用？<br/> </strong> Pandas是一个基于Python的开源分析和操纵工具。它是为了在Python中实现实际的、真实的数据分析而构建的。优点是它的灵活性和易用性。在本文中，我将展示处理大数据集任务时的常见步骤、最重要的功能，并解释如何使用它们来开始您的第一个项目。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="d60d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">熊猫基本知识:<br/> </strong>主要是熊猫用的物件有两类:<br/> 1。<strong class="iw hi"> DataFrame </strong>:包含独立条目数组的表格。这些可以是整数或字符串。因此熊猫可以被广泛用于各种任务。为了创建一个DataFrame对象，我们使用函数:pd。DataFrame() <br/> 2。<strong class="iw hi">系列</strong>:另一方面，系列不是表格而是列表，可以直接从一个简单的列表中创建。</p><p id="c38f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">创建数据帧的例子:</strong></p><p id="8464" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">首先，我们要进口熊猫:</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="326e" class="ki kj hh ke b fi kk kl l km kn">import pandas as pd<br/>from pandas import DataFrame</span></pre><p id="c53a" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">用一些随机值创建数据帧:</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="c27a" class="ki kj hh ke b fi kk kl l km kn">df = DataFrame({'ImportantValues':[5,6,7],'EvenMoreImportantValues':[1,2,3]})</span></pre><p id="482d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">枚举(从0开始)会自动生成并显示在左侧。使用print(df ),我们可以看到数据帧的输出:</p><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es et"><img src="../Images/ffa701e971a3c12476662843502bfd92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*16zdxdGD-FH1Kmt0DaUEMg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">数据帧输出</figcaption></figure></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="5f77" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">知道基础是如何工作的很好，但是，对于未来的项目，我们将不会手动输入数据，而是从源中提取数据并导入。对于导入，我们使用读取CSV(逗号分隔值)文件的函数:pd.read_csv()。对于本文，我将使用一个随机数据集作为例子。这里我使用Kaggle的超市数据集<a class="ae it" href="https://www.kaggle.com/aungpyaeap/supermarket-sales" rel="noopener ugc nofollow" target="_blank">并将其重命名为一个更短的文件名“super”。</a></p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="bf07" class="ki kj hh ke b fi kk kl l km kn">supermarkt_data = pd.read_csv("../path_to_file/super.csv")</span></pre><p id="d01b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">处理:我们已经导入了表格，下一步是什么？<br/> 由于我们将要处理的数据集非常大，把它们作为一个整体输出会很混乱。为了尽可能高效地处理大型数据集，我们使用一些函数来获得数据的概览，并对某些领域进行更详细的描述。为了对数据有一个简短的了解，我们可以使用下面的函数，它给出了前5个条目:</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="3121" class="ki kj hh ke b fi kk kl l km kn">print(supermarkt_data.head())</span></pre><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ko"><img src="../Images/4a2c6a08ab0ef241ccfd570e15ed122d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*chhJooa2xShr7f9aLGQC5Q.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">Supermarkt.csv负责人</figcaption></figure><p id="81a3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">要从表中输出一个特定的值(在本例中，只有它的第一个值)，可以调用下面的函数:</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="d742" class="ki kj hh ke b fi kk kl l km kn">your_dataframe['TheColumnYouLikeToSee'][0]</span></pre><p id="e527" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">有用功能:</strong></p><p id="9bfa" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果我们想从几个表中创建一个表(例如，将不同CSV文件中每年的数字转换成一个总表)，我们可以用一个简单的循环来解决这个问题:</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="3b68" class="ki kj hh ke b fi kk kl l km kn">for file in files:<br/>       df = pd.read_csv('./PATH!'+file)<br/>       all_data = pd.concat([all])</span></pre><p id="7bb4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在，要将这个新表保存为新的CSV文件，我们只需运行以下代码行:</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="5754" class="ki kj hh ke b fi kk kl l km kn">all_data.to_csv("all_data.csv", index=false)</span></pre><p id="0233" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">最后一部分“index=false”禁用自动左列，它只包含一个枚举。</p><p id="4d7e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">数据</strong> <strong class="iw hi">清洗</strong> <br/>数据科学项目中最重要的任务之一就是数据清洗。这可能是项目的一个重要部分，也是取得好结果的关键。结果只能和你的投入一样好。在一个项目中，分析后多次重新清理数据集并不罕见，因为可以从这些结果中检测到数据集中的许多错误。例如，一个机器学习算法只能和输入给它的数据一样好。你检查数据清理的第一件事:是否有任何空白或NaN(not number)条目？为此，我们使用:“dataframe.isna()”。</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="4b58" class="ki kj hh ke b fi kk kl l km kn">NaN_df = your_data[your_data.isna().any(axis=1)]</span><span id="a81a" class="ki kj hh ke b fi kp kl l km kn">#check the results by running following line<br/>NaN_df.head()</span></pre><p id="a694" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因此，如果我们有NaN值——消除它们的最简单方法是执行以下操作:</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="9e75" class="ki kj hh ke b fi kk kl l km kn">our_data = our_data.dropna(how='all')</span></pre><p id="bb2e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">旁注:</p><p id="a48e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">axis = 0删除包含缺失值的行。</p><p id="2546" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">axis = 1删除包含缺失值的列</p><p id="8710" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">更多关于dataframe.isna()和dataframe(dropna)的信息可以在<a class="ae it" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.dropna.html" rel="noopener ugc nofollow" target="_blank">这里</a>和<a class="ae it" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.isna.html" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="991f" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">分析—从大型数据集提取信息</strong> <br/>由于读取和分析大型数据集很困难，我们使用函数为我们总结信息。最好的例子就是一个月销售数据的总收入。为了给出有关销售、损失、发展的信息，我们可以按一定的系列(如年份)对数据框架进行分类，并从中得出总数。</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="cc5d" class="ki kj hh ke b fi kk kl l km kn">supermarkt_data.groupby(‘gross income’).sum()</span></pre><p id="cf49" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">这给了我们一个所有年份总数的概览，我们可以识别和绘制初始趋势，发现异常值并进行解释。</p><p id="df66" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">过滤数据</strong></p><p id="ba10" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">您经常需要过滤信息:例如，在我们的例子中，它可能是超市位置(城市)、某种产品的销售数字或购买时间。作为一个例子，我展示了如何按城市过滤数据帧。为此，我选择了“仰光”。</p><p id="de02" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">要创建一个只包含与我们相关的信息的新数据框架，我们可以使用<a class="ae it" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.loc.html" rel="noopener ugc nofollow" target="_blank"> DataFrame.loc函数</a>。</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="75da" class="ki kj hh ke b fi kk kl l km kn">new_df = our_data.loc[(our_data['City'] == 'Yangon')]</span></pre><p id="0f57" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">当我们打印出新数据帧的结果时，我们可以确保过滤有效:</p><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kq"><img src="../Images/0eb5952ee13297b0bf02bc003d7c0c15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*07xrC28_pH_OSgE20fS58A.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">使用df.loc按城市过滤</figcaption></figure><p id="d538" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">锁定功能不限于一个特征。因此，可以使用几个“与”和“或”函数，也可以单独调整限制，如价格&gt; X。例如，这里有一个按仰光市过滤的函数，购物总收入高于10，产品评级高于9。</p><pre class="jz ka kb kc fd kd ke kf kg aw kh bi"><span id="20c8" class="ki kj hh ke b fi kk kl l km kn">new_df = our_data.loc[(our_data['City'] == 'Yangon') &amp; (our_data['gross income'] &gt; 10) &amp; (our_data['Rating'] &gt; 9)]</span></pre><figure class="jz ka kb kc fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es kr"><img src="../Images/6e304e8ff00d065f44ec3d59c1d14c5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FhzrCSvPwu3QYFzV6dMddw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">按城市、总收入和评级过滤</figcaption></figure></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="bd09" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">使用这里介绍的函数，您可以导入CSV文件、读取它们、输出特定值、合并多个表并导出新表、查找并移除未填充的条目以清理数据集、自动计算总数，以及使用特定的过滤标准创建新的数据框。使用这些工具，您可以读取、解释和定位大型数据集，以获得有意义的信息。</p><p id="c866" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">一如既往:感谢阅读！</p></div></div>    
</body>
</html>