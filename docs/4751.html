<html>
<head>
<title>Build a Twitter Bot with Mantium, Tweepy, and Heroku</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Mantium、Tweepy和Heroku创建一个Twitter机器人</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/build-a-twitter-bot-with-mantium-tweepy-and-heroku-34622705b54a?source=collection_archive---------0-----------------------#2022-02-02">https://medium.com/analytics-vidhya/build-a-twitter-bot-with-mantium-tweepy-and-heroku-34622705b54a?source=collection_archive---------0-----------------------#2022-02-02</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="63b8" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">了解如何使用Python创建利用大型语言模型的应用程序！</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/ce51afbf2c73f3d3ca6d6f8e3b71411c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kHSaMoDkUfUHyaEu"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">照片由<a class="ae jm" href="https://unsplash.com/@cdr6934?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯里德</a>在<a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="b9cf" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">在本教程中，我们将探索一种快速的方法来创建一个自动化的应用程序，将一段有趣的文本发布到Twitter上。我们将使用的示例文本是一个独特的冰淇淋口味列表——每天，机器人将通过使用示例文本作为基线模式来生成一种新的口味。如果你想关注一个不是冰淇淋口味的话题，请随意使用你自己的示例文本。</p><p id="1150" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">用这个<a class="ae jm" href="https://ddc1ef6b-9a77-4cd8-97fd-a6f7e2c2a427.share.mantiumai.com/" rel="noopener ugc nofollow" target="_blank">示例提示</a>来看看它是如何工作的！只需点击“执行”，看看你得到什么味道回来。</p><p id="0f07" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">这将是一个简单的Twitter机器人，其唯一的工作是定期发布由大型语言模型生成的文本，其唯一的任务是生成一段创意文本，连接到Twitter API，并在推文中发布文本。在后面的教程中，我们将探讨如何添加功能，如喜欢和回复推文！</p><p id="8740" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><em class="kj">注意:Twitter对于公开发布信息的来源非常严格。请务必公开您的应用程序是一个机器人。</em></p></div><div class="ab cl kk kl go km" role="separator"><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp kq"/><span class="kn bw bk ko kp"/></div><div class="ha hb hc hd he"><h1 id="efa6" class="kr ks hh bd kt ku kv kw kx ky kz la lb in lc io ld iq le ir lf it lg iu lh li bi translated">帐户设置</h1><p id="c673" class="pw-post-body-paragraph jn jo hh jp b jq lj ii js jt lk il jv jw ll jy jz ka lm kc kd ke ln kg kh ki ha bi translated">如果您已经在这些服务上设置了帐户，请随意跳过您已经完成的任何步骤。如果你不想用Heroku的，你也可以选择你自己的时间表。</p><p id="b8eb" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi"> Mantium账户</strong></p><ul class=""><li id="17d6" class="lo lp hh jp b jq jr jt ju jw lq ka lr ke ls ki lt lu lv lw bi translated">如果您还没有帐户，请<a class="ae jm" href="https://app.mantiumai.com/" rel="noopener ugc nofollow" target="_blank">在Mantium平台</a>上注册。</li><li id="250f" class="lo lp hh jp b jq lx jt ly jw lz ka ma ke mb ki lt lu lv lw bi translated">选择您的提供商。您可以使用Mantium的大型语言模型，或者，如果您想使用另一个提供者，导航到<code class="du mc md me mf b">Integrations &gt; AI Providers</code>，然后将您的API密匙粘贴到相应的提供者表单中。<a class="ae jm" href="https://developer.mantiumai.com/docs/provider-api-keys" rel="noopener ugc nofollow" target="_blank">点击此处了解关于由提供商获取API密钥的详细信息</a>。</li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mg"><img src="../Images/6baf04997baeb4847c1657f260e9bded.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U_qWK6eS1UfpHaZ-N-4rQw.png"/></div></div></figure><p id="8e21" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">拥有基本访问权限的Twitter开发者账户</strong></p><ul class=""><li id="6043" class="lo lp hh jp b jq jr jt ju jw lq ka lr ke ls ki lt lu lv lw bi translated">为了访问Twitter API，您必须拥有一个开发者访问的Twitter帐户。对于一个机器人，你可能想创建一个独立的账户，这样它就可以代表自己发微博了。在这里用Twitter账户<a class="ae jm" href="https://developer.twitter.com/en" rel="noopener ugc nofollow" target="_blank">登录，然后点击“注册”,按照说明进行基本访问。一旦您确认了您的帐户，<strong class="jp hi">将您的API密匙、API密匙和不记名令牌保存在一个安全的位置</strong>以备后用。</a></li><li id="8ef5" class="lo lp hh jp b jq lx jt ly jw lz ka ma ke mb ki lt lu lv lw bi translated">API访问分为三种类型:基本、高级和学术研究。要启用自动发布，您必须具有提升的访问权限。在您的仪表板中，您将看到一个项目1链接。点击该链接，然后选择“申请提升”。填写申请并尽可能详细地描述——你几乎可以立即获得提升的访问权限。</li><li id="6b7e" class="lo lp hh jp b jq lx jt ly jw lz ka ma ke mb ki lt lu lv lw bi translated">回到您的项目仪表板，单击您的项目，然后单击您的应用程序旁边的关键图标。这将允许您生成一个访问令牌和密码，并将它们保存在一个安全的位置。</li><li id="5d88" class="lo lp hh jp b jq lx jt ly jw lz ka ma ke mb ki lt lu lv lw bi translated">注意:Twitter偶尔会使用一个自动系统来删除可疑应用程序的API访问。如果这种情况发生在你身上，它可能是随机的。提交支持票，如果您的访问未被重新授权，请务必跟进。在创建面向用户的应用程序时，要注意你的意图。我们支持在开发时考虑完整性和安全性——有助于任何类型的钓鱼、垃圾邮件或骚扰的应用程序都不符合我们的社区标准。</li></ul><p id="441f" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi"> Heroku账号</strong></p><ul class=""><li id="aadb" class="lo lp hh jp b jq jr jt ju jw lq ka lr ke ls ki lt lu lv lw bi translated">如果你想把你的机器人设置成定期发送Tweet，Heroku有一个简单的选项，可以用调度程序自动运行你的脚本。</li><li id="b56c" class="lo lp hh jp b jq lx jt ly jw lz ka ma ke mb ki lt lu lv lw bi translated"><a class="ae jm" href="https://signup.heroku.com/" rel="noopener ugc nofollow" target="_blank">注册一个Heroku账号</a>。这是您将推动您的应用程序的地方。</li><li id="b993" class="lo lp hh jp b jq lx jt ly jw lz ka ma ke mb ki lt lu lv lw bi translated"><a class="ae jm" href="https://devcenter.heroku.com/articles/heroku-cli" rel="noopener ugc nofollow" target="_blank">安装Heroku CLI </a>以便更轻松地部署您的代码。</li></ul><h1 id="1e8e" class="kr ks hh bd kt ku mh kw kx ky mi la lb in mj io ld iq mk ir lf it ml iu lh li bi translated">快速工程</h1><p id="b66f" class="pw-post-body-paragraph jn jo hh jp b jq lj ii js jt lk il jv jw ll jy jz ka lm kc kd ke ln kg kh ki ha bi translated">原型化提示以创建您想要的输出的最简单的方法是通过Mantium UI。</p><p id="0b2b" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">提示创建</strong></p><ul class=""><li id="b546" class="lo lp hh jp b jq jr jt ju jw lq ka lr ke ls ki lt lu lv lw bi translated">导航至您的Mantium账户，点击<code class="du mc md me mf b">AI Manager</code> &gt; <code class="du mc md me mf b">Prompts</code> &gt; <code class="du mc md me mf b">Add new prompt</code>。</li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mm"><img src="../Images/2b735a77092f217e551a0c7416fdfe4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_QUSVmKIKdmdM8prbkHaIg.png"/></div></div></figure><ul class=""><li id="f9a5" class="lo lp hh jp b jq jr jt ju jw lq ka lr ke ls ki lt lu lv lw bi translated"><strong class="jp hi">添加安全策略</strong> <br/>在你的提示中添加安全策略可以控制输入和输出内容质量——你可以配置自己的或使用Mantium的默认策略，每个帐户都有。点击安全策略下的<code class="du mc md me mf b">Add Security Policies</code>，将<code class="du mc md me mf b">Default Policies</code>拖至所选策略。点击<code class="du mc md me mf b">Done</code>保存。当策略名称在安全策略下可见时，您将知道该策略已被应用。</li><li id="5814" class="lo lp hh jp b jq lx jt ly jw lz ka ma ke mb ki lt lu lv lw bi translated"><strong class="jp hi">选择一个提供者:Co:here </strong> <br/>在这里你可以选择任何一个你已经集成了API密匙的提供者。欢迎您选择不同的提供商。</li><li id="dccd" class="lo lp hh jp b jq lx jt ly jw lz ka ma ke mb ki lt lu lv lw bi translated"><strong class="jp hi">选择一个端点:Compose — Generate <br/> </strong>所有的提供者都有一个支持生成文本的端点。为您选择的提供者选择相应的端点。与生成文本相关的提供者端点如下:<br/><em class="kj">open ai:Completion<br/>Co:here:Compose—Generate<br/>manti um:Completion<br/>Ai21:Complete</em></li><li id="0ddd" class="lo lp hh jp b jq lx jt ly jw lz ka ma ke mb ki lt lu lv lw bi translated"><strong class="jp hi">型号:大型</strong> <br/>型号因供应商而异，并经过优化以更好地执行不同的任务。在此配置过程中，您可以测试不同的型号，因此可以随意尝试不同的选项。</li><li id="ce69" class="lo lp hh jp b jq lx jt ly jw lz ka ma ke mb ki lt lu lv lw bi translated"><strong class="jp hi">提示行<br/> </strong>添加模型生成输出时将遵循的文本。注意格式——语言模型对标点、符号、空白等很敏感。对于这个例子，我已经附上了一个文本文件，其中列出了一些有创意的(有时不太好吃的)冰激凌口味的想法。请随意使用此文本粘贴到提示行中，或者创建自己的提示行。<strong class="jp hi">确保在提示体</strong>的末尾包含一个空行——这对于模型正确完成下一个文本模式至关重要。</li></ul><p id="d701" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><a class="ae jm" href="https://gist.github.com/sglibova/1434202903202a1df7b01ca250dfffe5" rel="noopener ugc nofollow" target="_blank">冰淇淋_口味_ txt</a></p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mm"><img src="../Images/1d86062e91c362bec5f6d831c0f58ee1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VSuVbw5fVXgmy5TQSbNiXQ.png"/></div></div></figure><h1 id="7425" class="kr ks hh bd kt ku mh kw kx ky mi la lb in mj io ld iq mk ir lf it ml iu lh li bi translated">提示设置</h1><p id="a225" class="pw-post-body-paragraph jn jo hh jp b jq lj ii js jt lk il jv jw ll jy jz ka lm kc kd ke ln kg kh ki ha bi translated">对于这个简单的提示，大多数设置可以保留为默认值。要配置的最重要的设置是最大令牌数、温度和停止序列。</p><ul class=""><li id="1a40" class="lo lp hh jp b jq jr jt ju jw lq ka lr ke ls ki lt lu lv lw bi translated">最大令牌数:12个令牌大约是一个普通英语单词的0 . 75。因为我们生成的是短字符串，所以这个值可能相当低。</li><li id="f64e" class="lo lp hh jp b jq lx jt ly jw lz ka ma ke mb ki lt lu lv lw bi translated"><strong class="jp hi">温度:. 95 </strong> <br/>温度控制着“创造力”——更高的温度会产生更独特和创造性的产出，但也更有可能变得毫无意义。对于不一定需要事实反应的创造性和有趣的反应，更高的温度值完全没问题。</li><li id="36a7" class="lo lp hh jp b jq lx jt ly jw lz ka ma ke mb ki lt lu lv lw bi translated"><strong class="jp hi">停止序列:\n </strong> <br/>停止序列是一种控制模型输出的方法——它们允许您定义任何强制模型停止的文本序列。因为我们希望模型只生成一行文本，所以它应该在下次创建换行符时停止(" \n ")。</li><li id="d4e6" class="lo lp hh jp b jq lx jt ly jw lz ka ma ke mb ki lt lu lv lw bi translated">该提示不需要输入就能起作用。点击<code class="du mc md me mf b">Test Run</code>测试模型输出！多次点击<code class="du mc md me mf b">Test Run</code>可能每次都会产生不同的结果——您可以将此作为测试和调整提示设置的机会。一旦你对结果感到满意，点击<code class="du mc md me mf b">Save</code>。</li><li id="172b" class="lo lp hh jp b jq lx jt ly jw lz ka ma ke mb ki lt lu lv lw bi translated">回到Prompts菜单，单击您刚刚配置的提示符—这将打开提示符的抽屉视图。在Deploy App URL中，你会发现<em class="kj">“https://”</em>和<em class="kj">“share . manti um . com”</em>之间的提示ID。复制并保存该值，以便在项目的环境文件中进行设置。</li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es mm"><img src="../Images/965ad82a7b18ec8eb708375bef7112c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TyGpFJrl_vK_mpLddQFnFw.png"/></div></div></figure><h1 id="661d" class="kr ks hh bd kt ku mh kw kx ky mi la lb in mj io ld iq mk ir lf it ml iu lh li bi translated">目录设置</h1><p id="d1b0" class="pw-post-body-paragraph jn jo hh jp b jq lj ii js jt lk il jv jw ll jy jz ka lm kc kd ke ln kg kh ki ha bi translated">本教程假设您对初始化存储库和版本控制有些熟悉。以您最方便的方式设置项目的顶级目录，或者使用下面提供的示例。在开始安装软件包之前，请确保您的虚拟环境处于活动状态。</p><p id="72ab" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">项目和虚拟环境设置命令示例:</strong></p><pre class="ix iy iz ja fd mn mf mo mp aw mq bi"><span id="5b5a" class="mr ks hh mf b fi ms mt l mu mv">$ mkdir twitter_bot<br/>$ cd twitter_bot<br/>$ python -m venv twitter-bot-venv<br/>$ source twitter-bot-venv/bin/activate</span></pre><p id="9d0f" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">初始化这个项目需要的文件:</strong></p><pre class="ix iy iz ja fd mn mf mo mp aw mq bi"><span id="74a9" class="mr ks hh mf b fi ms mt l mu mv">$ touch .gitignore .env requirements.txt <br/>$ mkdir app<br/>$ cd app<br/>$ touch app.py load_env.py mantium_call.py</span></pre><p id="7bc3" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">您的目录结构现在应该是这样的:</strong></p><pre class="ix iy iz ja fd mn mf mo mp aw mq bi"><span id="dd74" class="mr ks hh mf b fi ms mt l mu mv">twitter_bot<br/>    <!-- -->├── <!-- -->.gitignore<br/>    <!-- -->├── <!-- -->.env<br/>    <!-- -->├── <!-- -->requirements.txt<br/>    <!-- -->└── <!-- -->app<br/>       <!-- -->├── <!-- -->app.py<br/>       <!-- -->├── <!-- -->load_env.py<br/>       <!-- -->└── <!-- -->mantium_call.py</span></pre><p id="bfe0" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">将以下库添加到您的活动虚拟环境:</strong></p><pre class="ix iy iz ja fd mn mf mo mp aw mq bi"><span id="641e" class="mr ks hh mf b fi ms mt l mu mv">pip install mantiumapi tweepy python-dotenv</span></pre><p id="e157" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><strong class="jp hi">然后，使用pip freeze将您的依赖项添加到需求文件:</strong></p><pre class="ix iy iz ja fd mn mf mo mp aw mq bi"><span id="1f70" class="mr ks hh mf b fi ms mt l mu mv">$ pip freeze &gt; requirements.txt</span></pre><p id="7a43" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">如果您最终使用<code class="du mc md me mf b">pip install</code>将更多的库添加到您的依赖项中，您总是可以重新运行这个命令来更新您的需求文件。</p><h1 id="83f3" class="kr ks hh bd kt ku mh kw kx ky mi la lb in mj io ld iq mk ir lf it ml iu lh li bi translated">文件内容</h1><ul class=""><li id="b8a6" class="lo lp hh jp b jq lj jt lk jw mw ka mx ke my ki lt lu lv lw bi translated"><strong class="jp hi">。gitignore </strong> <br/>我使用<a class="ae jm" href="https://github.com/github/gitignore/blob/main/Python.gitignore" rel="noopener ugc nofollow" target="_blank">这个模板</a>作为许多Python项目的总括。您可以对其进行删减，以排除您不需要的文件，但要始终确保您的。env文件在您的。gitignore文件。永远不要将个人凭证放在公开可见的存储库中。</li><li id="1d7f" class="lo lp hh jp b jq lx jt ly jw lz ka ma ke mb ki lt lu lv lw bi translated"><strong class="jp hi">。env </strong> <br/>在这里，您将初始化与Mantium和Twitter交互所需的所有凭证。您将在这里粘贴之前在指南中保存提示ID。</li></ul><pre class="ix iy iz ja fd mn mf mo mp aw mq bi"><span id="6cdb" class="mr ks hh mf b fi ms mt l mu mv"># Environment Variables</span><span id="6ae5" class="mr ks hh mf b fi mz mt l mu mv"># Mantium<br/>MANTIUM_USER=your_account_email_address<br/>MANTIUM_PASSWORD=your_mantium_password<br/>PROMPT_ID=prompt_id_from_mantium_logs</span><span id="119c" class="mr ks hh mf b fi mz mt l mu mv"># Twitter<br/>TWITTER_API_KEY=your_value_here<br/>TWITTER_API_SECRET=your_value_here<br/>TWITTER_ACCESS_TOKEN=your_value_here<br/>TWITTER_ACCESS_SECRET=your_value_here</span></pre><h1 id="6c95" class="kr ks hh bd kt ku mh kw kx ky mi la lb in mj io ld iq mk ir lf it ml iu lh li bi translated">我们来编码吧！</h1><h2 id="ec6e" class="mr ks hh bd kt na nb nc kx nd ne nf lb jw ng nh ld ka ni nj lf ke nk nl lh nm bi translated">app.py</h2><p id="526f" class="pw-post-body-paragraph jn jo hh jp b jq lj ii js jt lk il jv jw ll jy jz ka lm kc kd ke ln kg kh ki ha bi translated">在应用程序的主体中，我们完成了几件事情:</p><ul class=""><li id="735c" class="lo lp hh jp b jq jr jt ju jw lq ka lr ke ls ki lt lu lv lw bi translated">使用我们在<code class="du mc md me mf b">load_env.py</code>中定义的<code class="du mc md me mf b">load_twitter_env()</code>函数加载Twitter凭证</li><li id="2df8" class="lo lp hh jp b jq lx jt ly jw lz ka ma ke mb ki lt lu lv lw bi translated">通过从<code class="du mc md me mf b">mantium_call.py</code>模块调用<code class="du mc md me mf b">prompt_results()</code>将提示输出保存在<code class="du mc md me mf b">prompt_output</code>变量中。调用这个函数将执行我们在前面的教程中配置的提示。</li><li id="7b0e" class="lo lp hh jp b jq lx jt ly jw lz ka ma ke mb ki lt lu lv lw bi translated">验证、连接和验证Twitter API的登录。</li><li id="f3ff" class="lo lp hh jp b jq lx jt ly jw lz ka ma ke mb ki lt lu lv lw bi translated">使用Tweepy <code class="du mc md me mf b">api.update_status</code>方法，我们将<code class="du mc md me mf b">prompt_result</code>作为状态更新发布到机器人的Twitter时间轴上！</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="nn no l"/></div></figure><p id="ec91" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">现在让我们来看看助手模块:<code class="du mc md me mf b">load_env.py</code>和<code class="du mc md me mf b">mantium_call.py</code></p><h2 id="330c" class="mr ks hh bd kt na nb nc kx nd ne nf lb jw ng nh ld ka ni nj lf ke nk nl lh nm bi translated">负载_环境. py</h2><p id="6f67" class="pw-post-body-paragraph jn jo hh jp b jq lj ii js jt lk il jv jw ll jy jz ka lm kc kd ke ln kg kh ki ha bi translated">使用<strong class="jp hi"> python-dotenv </strong>库，我们调用<code class="du mc md me mf b">load_dotenv()</code>来加载我们在上面的<code class="du mc md me mf b">.env</code>文件中设置的凭证。我将这个过程分为两个功能:一个用于登录并使用Mantium，另一个用于登录并使用Twitter。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="nn no l"/></div></figure><h2 id="807a" class="mr ks hh bd kt na nb nc kx nd ne nf lb jw ng nh ld ka ni nj lf ke nk nl lh nm bi translated">mantium_call.py</h2><p id="a0fd" class="pw-post-body-paragraph jn jo hh jp b jq lj ii js jt lk il jv jw ll jy jz ka lm kc kd ke ln kg kh ki ha bi translated">这里，我们使用来自<code class="du mc md me mf b">load_env.py</code>的<code class="du mc md me mf b">load_mantium_env()</code>函数获取Mantium凭证，并通过检查我们是否能够通过调用<code class="du mc md me mf b">client.BearerAuth().get_token()</code>获得<code class="du mc md me mf b">mantium_token</code>来确认成功登录。</p><p id="04bd" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><code class="du mc md me mf b">prompt_id</code>值将用于检索您在本指南前面配置的特定提示。</p><p id="7647" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated"><code class="du mc md me mf b">prompt_results()</code>函数执行输入空字符串的提示，因为该提示不需要任何输入。然后，我们检查提示状态，并在状态不是“COMPLETED”时刷新提示，然后检查提示的结果，以确保它们不是空字符串。一旦确认提示状态为完成，并且输出值不是空字符串，该函数将以字符串形式返回提示输出。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="nn no l"/></div></figure><p id="2345" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">底部的代码允许测试单个脚本，以确保它成功地通过Mantium的认证，并可以检索提示结果。为了测试这个脚本本身(不用担心<code class="du mc md me mf b">app.py</code>发布到Twitter)，您可以在<code class="du mc md me mf b">twitter_bot</code>目录中运行下面的命令:</p><pre class="ix iy iz ja fd mn mf mo mp aw mq bi"><span id="dc0e" class="mr ks hh mf b fi ms mt l mu mv">$ python3 app/mantium_call.py</span></pre><h1 id="cba0" class="kr ks hh bd kt ku mh kw kx ky mi la lb in mj io ld iq mk ir lf it ml iu lh li bi translated">测试您的脚本！</h1><p id="acf8" class="pw-post-body-paragraph jn jo hh jp b jq lj ii js jt lk il jv jw ll jy jz ka lm kc kd ke ln kg kh ki ha bi translated">在您的终端中，您可以通过从<code class="du mc md me mf b">twitter_bot</code>目录运行以下命令来测试您的脚本:</p><pre class="ix iy iz ja fd mn mf mo mp aw mq bi"><span id="a71f" class="mr ks hh mf b fi ms mt l mu mv">$ python3 app/app.py</span></pre><p id="e95c" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">如果成功，你应该有一个新的推文在你的机器人的时间轴上！</p><h1 id="202f" class="kr ks hh bd kt ku mh kw kx ky mi la lb in mj io ld iq mk ir lf it ml iu lh li bi translated">在Heroku上部署和调度</h1><p id="ff31" class="pw-post-body-paragraph jn jo hh jp b jq lj ii js jt lk il jv jw ll jy jz ka lm kc kd ke ln kg kh ki ha bi translated"><em class="kj">注意:如果你使用Python诗歌，你需要一个</em> <a class="ae jm" href="https://elements.heroku.com/buildpacks/moneymeets/python-poetry-buildpack" rel="noopener ugc nofollow" target="_blank"> <em class="kj">诗歌构建包</em></a><em class="kj">——按照说明创建一个需求文件供Heroku使用。</em></p><h2 id="d405" class="mr ks hh bd kt na nb nc kx nd ne nf lb jw ng nh ld ka ni nj lf ke nk nl lh nm bi translated">部署</h2><p id="df08" class="pw-post-body-paragraph jn jo hh jp b jq lj ii js jt lk il jv jw ll jy jz ka lm kc kd ke ln kg kh ki ha bi translated">要使用Heroku CLI进行部署，首先从您的web浏览器登录您的Heroku帐户，单击主仪表板右上角的<code class="du mc md me mf b">New</code> &gt; <code class="du mc md me mf b">Create new app</code>，并命名您的应用程序。</p><p id="c69a" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">使用CLI，您可以登录您的heroku帐户，并按照提示设置SSH密钥。</p><pre class="ix iy iz ja fd mn mf mo mp aw mq bi"><span id="4ec9" class="mr ks hh mf b fi ms mt l mu mv">$ heroku login</span></pre><p id="9cb9" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">一旦你设置好了，在你的<code class="du mc md me mf b">twitter_bot</code>目录中使用下面的命令。如果您已经初始化了一个git存储库，那么跳过运行<code class="du mc md me mf b">git init</code>。</p><pre class="ix iy iz ja fd mn mf mo mp aw mq bi"><span id="0459" class="mr ks hh mf b fi ms mt l mu mv">$ cd twitter_bot<br/>$ git init<br/>$ heroku git:remote -a your-application-name<br/>$ git add -A<br/>$ git commit -m 'your commit message'<br/>$ git push heroku master</span></pre><p id="ceb7" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">要将主部署分支名称更改为现代实践并重新部署，请运行以下命令:</p><pre class="ix iy iz ja fd mn mf mo mp aw mq bi"><span id="cb4f" class="mr ks hh mf b fi ms mt l mu mv">$ git checkout -b main<br/>$ git branch -D master<br/>$ git push heroku main</span></pre><p id="62fd" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">你的主分支现在被命名为<code class="du mc md me mf b">main</code>，任何后续的推送都将使用<code class="du mc md me mf b">git push heroku main</code>来完成。</p><h2 id="c008" class="mr ks hh bd kt na nb nc kx nd ne nf lb jw ng nh ld ka ni nj lf ke nk nl lh nm bi translated">为Heroku设置配置变量</h2><p id="2d82" class="pw-post-body-paragraph jn jo hh jp b jq lj ii js jt lk il jv jw ll jy jz ka lm kc kd ke ln kg kh ki ha bi translated">因为我们没有推高。env文件添加到Heroku，我们可以在Heroku CLI中使用以下命令设置配置变量:</p><pre class="ix iy iz ja fd mn mf mo mp aw mq bi"><span id="2462" class="mr ks hh mf b fi ms mt l mu mv">$ cd twitter_bot<br/>$ heroku config:set MANTIUM_USER=your_account_email_address <br/>$ heroku config:set MANTIUM_PASSWORD=your_mantium_password <br/>$ heroku config:set PROMPT_ID=prompt_id_from_mantium_logs<br/>$ heroku config:set TWITTER_API_KEY=your_value_here <br/>$ heroku config:set TWITTER_API_SECRET=your_value_here <br/>$ heroku config:set TWITTER_ACCESS_TOKEN=your_value_here <br/>$ heroku config:set TWITTER_ACCESS_SECRET=your_value_here</span></pre><p id="6509" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">如果您愿意，也可以通过在一个命令中包含声明来同时设置多个变量，或者您可以在Heroku UI中配置它们。如果您想要删除任何配置变量，您可以运行如下所示的命令:</p><pre class="ix iy iz ja fd mn mf mo mp aw mq bi"><span id="f944" class="mr ks hh mf b fi ms mt l mu mv">$ heroku config:unset CONFIG_VARIABLE</span></pre><p id="4ebf" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">更多关于Heroku配置变量的信息请点击。</p><h2 id="abe3" class="mr ks hh bd kt na nb nc kx nd ne nf lb jw ng nh ld ka ni nj lf ke nk nl lh nm bi translated">日程安排</h2><p id="6f76" class="pw-post-body-paragraph jn jo hh jp b jq lj ii js jt lk il jv jw ll jy jz ka lm kc kd ke ln kg kh ki ha bi translated">要添加调度程序，请在主仪表板中单击您的应用程序，并在菜单的左半部分找到“配置附加组件”链接。点击这里，在“附件”搜索栏中搜索“Heroku Scheduler”。在那里，您将能够配置命令和命令运行的时间。点击右上角的"添加作业"，选择定时并粘贴以下命令:</p><pre class="ix iy iz ja fd mn mf mo mp aw mq bi"><span id="66bc" class="mr ks hh mf b fi ms mt l mu mv">python3 app/app.py</span></pre><p id="6f3d" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">点击“保存作业”,一切就绪！</p><h2 id="b3cd" class="mr ks hh bd kt na nb nc kx nd ne nf lb jw ng nh ld ka ni nj lf ke nk nl lh nm bi translated">检查你的日志</h2><p id="5c1c" class="pw-post-body-paragraph jn jo hh jp b jq lj ii js jt lk il jv jw ll jy jz ka lm kc kd ke ln kg kh ki ha bi translated">一旦Heroku调度程序运行了您的应用程序，您应该能够通过在命令行中键入以下命令来访问最新的日志:</p><pre class="ix iy iz ja fd mn mf mo mp aw mq bi"><span id="6ee9" class="mr ks hh mf b fi ms mt l mu mv">$ heroku logs</span></pre><p id="e073" class="pw-post-body-paragraph jn jo hh jp b jq jr ii js jt ju il jv jw jx jy jz ka kb kc kd ke kf kg kh ki ha bi translated">要在Mantium界面中仅查看您记录的提示输出，您可以登录您的Mantium帐户并点击<code class="du mc md me mf b">Monitoring</code> &gt; <code class="du mc md me mf b">Logs</code>。</p><h1 id="33d6" class="kr ks hh bd kt ku mh kw kx ky mi la lb in mj io ld iq mk ir lf it ml iu lh li bi translated">结论</h1><p id="ed98" class="pw-post-body-paragraph jn jo hh jp b jq lj ii js jt lk il jv jw ll jy jz ka lm kc kd ke ln kg kh ki ha bi translated">有了这段代码，您现在就有了一个创建其他有趣应用程序的模板，这些应用程序利用大型语言模型生成文本！设置相对简单，并有足够的空间进行额外的创作。如果你想继续这个项目，或者对这个教程有任何疑问，请不要犹豫，通过<a class="ae jm" href="https://s-glibova.medium.com/" rel="noopener">媒体</a>、<a class="ae jm" href="https://www.linkedin.com/in/svitlana-glibova/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>与我联系，或者加入我们的<a class="ae jm" href="https://discord.com/invite/h9NCwW6mXY" rel="noopener ugc nofollow" target="_blank"> Mantium Discord </a>！</p></div></div>    
</body>
</html>