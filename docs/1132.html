<html>
<head>
<title>Classification Model Tensorflow 2.4 with Azure Machine learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">具有Azure机器学习的分类模型Tensorflow 2.4</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/classification-model-tensorflow-2-4-with-azure-machine-learning-6ecb2f5f9fdf?source=collection_archive---------23-----------------------#2021-02-15">https://medium.com/analytics-vidhya/classification-model-tensorflow-2-4-with-azure-machine-learning-6ecb2f5f9fdf?source=collection_archive---------23-----------------------#2021-02-15</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div class="er es ie"><img src="../Images/18e63e5f4ffa6c61d63e31bbaeaf20ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/0*KdIgdczylHXEtEFU"/></div></figure><h1 id="518d" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">用例</h1><ul class=""><li id="4a8a" class="jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">检查tensorflow 2.4的版本并运行示例代码进行验证。</li><li id="5974" class="jj jk hh jl b jm kb jo kc jq kd js ke ju kf jw jx jy jz ka bi translated">创建二元分类模型</li><li id="95b3" class="jj jk hh jl b jm kb jo kc jq kd js ke ju kf jw jx jy jz ka bi translated">规则表格数据集上的深度学习分类</li></ul><h1 id="70b4" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">要求</h1><ul class=""><li id="1d52" class="jj jk hh jl b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka bi translated">Azure帐户</li><li id="e27e" class="jj jk hh jl b jm kb jo kc jq kd js ke ju kf jw jx jy jz ka bi translated">Azure机器学习帐户</li><li id="99d4" class="jj jk hh jl b jm kb jo kc jq kd js ke ju kf jw jx jy jz ka bi translated">创建计算实例</li><li id="3ff9" class="jj jk hh jl b jm kb jo kc jq kd js ke ju kf jw jx jy jz ka bi translated">minst数据集</li></ul><h1 id="a37c" class="il im hh bd in io ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji bi translated">密码</h1><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="4a16" class="kp im hh kl b fi kq kr l ks kt">import tensorflow as tf; <br/>print(tf.__version__)</span><span id="265a" class="kp im hh kl b fi ku kr l ks kt">import tensorflow as tf <br/>from tensorflow.keras.layers import Dense, Flatten, Conv2D <br/>from tensorflow.keras import Model <br/>from tensorflow.keras.layers import Input, Dense, Activation,Dropout from tensorflow.keras.models import Model</span></pre><ul class=""><li id="b8a7" class="jj jk hh jl b jm kv jo kw jq kx js ky ju kz jw jx jy jz ka bi translated">读取数据集</li><li id="15ff" class="jj jk hh jl b jm kb jo kc jq kd js ke ju kf jw jx jy jz ka bi translated">文件夹中有数据集</li></ul><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="bd1b" class="kp im hh kl b fi kq kr l ks kt">diabetes = pd.read_csv(r'diabetes.csv')<br/>diabetes.head()</span></pre><ul class=""><li id="ba6b" class="jj jk hh jl b jm kv jo kw jq kx js ky ju kz jw jx jy jz ka bi translated">分割数据集</li><li id="4767" class="jj jk hh jl b jm kb jo kc jq kd js ke ju kf jw jx jy jz ka bi translated">特征的x数据</li><li id="fa4e" class="jj jk hh jl b jm kb jo kc jq kd js ke ju kf jw jx jy jz ka bi translated">y代表标签</li></ul><pre class="kg kh ki kj fd kk kl km kn aw ko bi"><span id="7f89" class="kp im hh kl b fi kq kr l ks kt">y = diabetes.iloc[:,10] <br/>X = diabetes.iloc[:,:10]</span><span id="d475" class="kp im hh kl b fi ku kr l ks kt">from sklearn.model_selection import train_test_split X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state=42)</span><span id="b676" class="kp im hh kl b fi ku kr l ks kt">input_layer = Input(shape=(X.shape[1],))<br/>dense_layer_1 = Dense(15, activation='relu')(input_layer)<br/>dense_layer_2 = Dense(10, activation='relu')(dense_layer_1)<br/>output = Dense(1, activation='softmax')(dense_layer_2)<br/><br/>model = Model(inputs=input_layer, outputs=output)<br/>model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['acc'])</span><span id="fc8a" class="kp im hh kl b fi ku kr l ks kt">print(model.summary())</span><span id="395a" class="kp im hh kl b fi ku kr l ks kt">history = model.fit(X_train, y_train, batch_size=8, epochs=50, verbose=1, validation_split=0.2)</span><span id="9fc0" class="kp im hh kl b fi ku kr l ks kt">score = model.evaluate(X_test, y_test, verbose=1)<br/><br/>print("Test Score:", score[0])<br/>print("Test Accuracy:", score[1])</span></pre></div><div class="ab cl la lb go lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ha hb hc hd he"><p id="91c5" class="pw-post-body-paragraph lh li hh jl b jm kv lj lk jo kw ll lm jq ln lo lp js lq lr ls ju lt lu lv jw ha bi translated"><em class="lw">最初发表于</em><a class="ae lx" href="https://github.com/balakreshnan/mlops/blob/master/tensorflow/tf2classification.md" rel="noopener ugc nofollow" target="_blank"><em class="lw">【https://github.com】</em></a><em class="lw">。</em></p></div></div>    
</body>
</html>