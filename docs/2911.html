<html>
<head>
<title>Chest X-Rays Pneumonia Detection Using Convolutional Neural Network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于卷积神经网络的胸部X线肺炎检测</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/chest-x-rays-pneumonia-detection-using-convolutional-neural-network-b9316f527c15?source=collection_archive---------5-----------------------#2021-05-24">https://medium.com/analytics-vidhya/chest-x-rays-pneumonia-detection-using-convolutional-neural-network-b9316f527c15?source=collection_archive---------5-----------------------#2021-05-24</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="c428" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">使用深度学习CNN从X射线图像检测肺炎的完整指南</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/fa6c8209d89fdc38baeeb8d8787cea1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5H0iz2NDhDEyU6Vy"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated"><a class="ae jm" href="https://unsplash.com/@cdc?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">疾控中心</a>在<a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><h1 id="0efd" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">背景</h1><p id="72e8" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated"><strong class="kh hi">T5】什么是肺炎？ </strong></p><p id="d793" class="pw-post-body-paragraph kf kg hh kh b ki lc ii kk kl ld il kn ko le kq kr ks lf ku kv kw lg ky kz la ha bi translated">肺炎是一种感染，使一个或两个肺部的气囊发炎。气囊可能会充满液体或脓液(脓性物质)，导致咳嗽伴有痰或脓、发烧、发冷和呼吸困难[1]。肺炎患者可能需要住院或入住重症监护室(ICU) [2]。</p><p id="b292" class="pw-post-body-paragraph kf kg hh kh b ki lc ii kk kl ld il kn ko le kq kr ks lf ku kv kw lg ky kz la ha bi translated"><strong class="kh hi"> <em class="lb">关于肺炎的一些事实？</em>T11】</strong></p><ul class=""><li id="ca03" class="lh li hh kh b ki lc kl ld ko lj ks lk kw ll la lm ln lo lp bi translated">肺炎每年导致100多万人住院，50，000多人死亡[3]。</li><li id="e011" class="lh li hh kh b ki lq kl lr ko ls ks lt kw lu la lm ln lo lp bi translated">这是世界上五岁以下儿童死亡的主要原因。</li><li id="ad37" class="lh li hh kh b ki lq kl lr ko ls ks lt kw lu la lm ln lo lp bi translated">在美国，肺炎是儿童和成人住院的最常见原因[3]。</li></ul><p id="4f8f" class="pw-post-body-paragraph kf kg hh kh b ki lc ii kk kl ld il kn ko le kq kr ks lf ku kv kw lg ky kz la ha bi translated"><strong class="kh hi"> <em class="lb">挑战</em> </strong></p><ul class=""><li id="2936" class="lh li hh kh b ki lc kl ld ko lj ks lk kw ll la lm ln lo lp bi translated">胸部x光被认为是检测任何形式肺炎的最佳工具。研究表明，即使是经验丰富的放射科医生也很难正确识别X射线上的某种物质是否是渗透物(密度大于空气的物质，如脓或液体)[4]，从而导致诊断延迟，增加疾病的严重程度。</li><li id="71e1" class="lh li hh kh b ki lq kl lr ko ls ks lt kw lu la lm ln lo lp bi translated">对许多人来说，肺炎的风险是巨大的，尤其是在污染严重、医疗资源和人员不足的发展中国家。例如，在非洲的57个国家中，存在着230万医生和护士的缺口。医生和护士的缺乏使得肺炎的诊断和治疗更加困难。</li></ul><h1 id="bad9" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">目标</h1><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lv"><img src="../Images/60c64d0921a8d0af15fd5f5846e8e456.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1_TYNbdrdl1qujm6EbgAng.png"/></div></div></figure><p id="26e7" class="pw-post-body-paragraph kf kg hh kh b ki lc ii kk kl ld il kn ko le kq kr ks lf ku kv kw lg ky kz la ha bi translated">迫切需要对肺炎进行准确和快速的诊断，尤其是对贫困人群而言。我的目标是建立一个深度学习模型，通过检查x光图像来自动识别病人是否患有肺炎。</p><h1 id="8400" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">资料组</h1><p id="4b5e" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">本项目使用的数据集可在<a class="ae jm" href="https://www.kaggle.com/paultimothymooney/chest-xray-pneumonia" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/paultimothymooney/chest-x ray-pneumonia</a>找到。该数据集包含来自中国广州一家医疗中心的5岁以下儿科患者的5，856张检查X射线图像。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es lw"><img src="../Images/2180085d79cfa9afb3c45770d3e72066.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tBxmQoNT-5YLelQrj7PUCA.png"/></div></div></figure><h1 id="b200" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">数据探索</h1><p id="3337" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">数据集包括两类图像，正常图像和肺炎图像。我将整个数据集分成70%的训练、20%的验证和10 %的测试。数据集的每组具有相同的类别分布，即肺炎图像的73%和正常图像的27%。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es lx"><img src="../Images/f56baa378c32f68c771aeec9db349f1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*he18g7-pKnfCocuLtXysMw.png"/></div></figure><p id="f6f5" class="pw-post-body-paragraph kf kg hh kh b ki lc ii kk kl ld il kn ko le kq kr ks lf ku kv kw lg ky kz la ha bi translated"><strong class="kh hi"> <em class="lb">导入必要的库</em> </strong></p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="ly lz l"/></div></figure><p id="6e7d" class="pw-post-body-paragraph kf kg hh kh b ki lc ii kk kl ld il kn ko le kq kr ks lf ku kv kw lg ky kz la ha bi translated"><strong class="kh hi"> <em class="lb">拆分数据集</em> </strong></p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="ly lz l"/></div></figure><h1 id="106d" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">图像预处理</h1><p id="a16d" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">通过像素归一化和数据扩充对训练数据集中的图像进行预处理。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="ly lz l"/></div></figure><pre class="ix iy iz ja fd ma mb mc md aw me bi"><span id="7a5c" class="mf jo hh mb b fi mg mh l mi mj">Found 4099 images belonging to 2 classes.<br/>Found 1172 images belonging to 2 classes.<br/>Found 585 images belonging to 2 classes.</span></pre><h1 id="126e" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">建模</h1><p id="14b8" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">我训练了20多个模型，这些模型具有不同的模型架构，具有不同数量的卷积层、时期、密集层、特征图、漏失和批量归一化。我的最佳性能模型有3个卷积2D层，每个层后面都有一个最大池层。展平后，它被送入一个具有ReLU激活的全连接层。由于这是一个二元分类问题，我使用sigmoid激活来预测输出概率。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="ly lz l"/></div></figure><pre class="ix iy iz ja fd ma mb mc md aw me bi"><span id="b505" class="mf jo hh mb b fi mg mh l mi mj">Epoch 1/10<br/>33/33 [==============================] - 25s 745ms/step - loss: 0.6201 - acc: 0.6800 - val_loss: 0.5333 - val_acc: 0.7295<br/>Epoch 2/10<br/>33/33 [==============================] - 24s 747ms/step - loss: 0.4780 - acc: 0.7644 - val_loss: 0.2911 - val_acc: 0.8780<br/>Epoch 3/10<br/>33/33 [==============================] - 23s 706ms/step - loss: 0.3938 - acc: 0.8081 - val_loss: 0.2997 - val_acc: 0.8951<br/>Epoch 4/10<br/>33/33 [==============================] - 23s 699ms/step - loss: 0.3121 - acc: 0.8784 - val_loss: 0.3531 - val_acc: 0.8439<br/>Epoch 5/10<br/>33/33 [==============================] - 23s 715ms/step - loss: 0.2873 - acc: 0.8818 - val_loss: 0.2817 - val_acc: 0.8985<br/>Epoch 6/10<br/>33/33 [==============================] - 24s 721ms/step - loss: 0.3011 - acc: 0.8698 - val_loss: 0.2276 - val_acc: 0.9096<br/>Epoch 7/10<br/>33/33 [==============================] - 24s 722ms/step - loss: 0.2601 - acc: 0.8908 - val_loss: 0.1999 - val_acc: 0.9334<br/>Epoch 8/10<br/>33/33 [==============================] - 24s 727ms/step - loss: 0.2638 - acc: 0.8884 - val_loss: 0.1975 - val_acc: 0.9172<br/>Epoch 9/10<br/>33/33 [==============================] - 24s 720ms/step - loss: 0.2416 - acc: 0.8950 - val_loss: 0.3122 - val_acc: 0.8643<br/>Epoch 10/10<br/>33/33 [==============================] - 23s 725ms/step - loss: 0.2839 - acc: 0.8806 - val_loss: 0.2026 - val_acc: 0.9138</span></pre><h1 id="03e7" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">评估模型性能</h1><h2 id="0988" class="mf jo hh bd jp mk ml mm jt mn mo mp jx ko mq mr jz ks ms mt kb kw mu mv kd mw bi translated">训练和验证损失图</h2><p id="ca83" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated"><strong class="kh hi">训练和验证损失</strong>:损失值由损失函数计算得出。损失函数用于优化模型性能。损失是根据训练和验证计算的，其解释基于模型在这两个数据集中的表现。它是训练集或验证集中每个示例的误差总和。损失值意味着每次优化迭代后模型表现的好坏。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="ly lz l"/></div></figure><h2 id="a9bc" class="mf jo hh bd jp mk ml mm jt mn mo mp jx ko mq mr jz ks ms mt kb kw mu mv kd mw bi translated">训练和验证准确度图</h2><p id="2ae3" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated"><strong class="kh hi">训练和验证精度</strong>:模型的精度通常是在模型参数之后确定的，以百分比的形式计算。这是衡量模型预测与真实数据相比有多准确的标准。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="ly lz l"/></div></figure><h2 id="a296" class="mf jo hh bd jp mk ml mm jt mn mo mp jx ko mq mr jz ks ms mt kb kw mu mv kd mw bi translated">混淆矩阵</h2><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="ly lz l"/></div></figure><h2 id="79d1" class="mf jo hh bd jp mk ml mm jt mn mo mp jx ko mq mr jz ks ms mt kb kw mu mv kd mw bi translated">ROC曲线和AUC评分</h2><p id="1afe" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated"><strong class="kh hi"> ROC和AUC </strong> : AUC — ROC曲线是在各种阈值设置下对分类问题的性能度量。ROC是概率曲线，AUC代表可分性的程度或度量。它告诉我们这个模型在多大程度上能够区分不同的类。</p><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="ly lz l"/></div></figure><h2 id="c4de" class="mf jo hh bd jp mk ml mm jt mn mo mp jx ko mq mr jz ks ms mt kb kw mu mv kd mw bi translated">汇总统计数据</h2><ul class=""><li id="bbc6" class="lh li hh kh b ki kj kl km ko mx ks my kw mz la lm ln lo lp bi translated"><strong class="kh hi">准确度= (TP + TN) /(总观察值)</strong>:模型正确的预测总数</li><li id="bbad" class="lh li hh kh b ki lq kl lr ko ls ks lt kw lu la lm ln lo lp bi translated"><strong class="kh hi"> Precision = TP / (TP+FP) </strong>:预测阳性数中的真阳性数</li><li id="e171" class="lh li hh kh b ki lq kl lr ko ls ks lt kw lu la lm ln lo lp bi translated"><strong class="kh hi">真阳性率/召回率/灵敏度= TP / (TP+FN) </strong>:实际总阳性数中的真阳性数</li><li id="1da7" class="lh li hh kh b ki lq kl lr ko ls ks lt kw lu la lm ln lo lp bi translated"><strong class="kh hi">特异性= TN / (TN+FP) </strong>:实际总阴性数中的真阴性数</li><li id="5307" class="lh li hh kh b ki lq kl lr ko ls ks lt kw lu la lm ln lo lp bi translated"><strong class="kh hi">假阳性率= 1 —特异性= FP / (TN+FP) </strong>:实际总阴性数中的假阳性数</li><li id="150d" class="lh li hh kh b ki lq kl lr ko ls ks lt kw lu la lm ln lo lp bi translated"><strong class="kh hi"> F1得分</strong>:精度和召回率的调和平均值。当一个模特的F1分数很高时，你知道你的模特做得很好。</li></ul><figure class="ix iy iz ja fd jb"><div class="bz dy l di"><div class="ly lz l"/></div></figure><h1 id="10ac" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">结果</h1><ul class=""><li id="24b4" class="lh li hh kh b ki kj kl km ko mx ks my kw mz la lm ln lo lp bi translated">通过学习过程中的每个时期，验证损失和训练损失彼此接近，这意味着我们的模型没有太多的过拟合或欠拟合。此外，训练和验证准确度分数最终也收敛到它们几乎相等的一些点。</li></ul><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es na"><img src="../Images/45b4476c849fe63522715911f50e1239.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yrGHVbzEE-YfawysK5bLEw.png"/></div></div></figure><ul class=""><li id="4615" class="lh li hh kh b ki lc kl ld ko lj ks lk kw ll la lm ln lo lp bi translated">对于检测肺炎的情况，我们的目标是高召回率，因为任何延误的诊断都意味着有人可能真的生病，并可能失去生命。该模型的召回率为98.36%，令人印象深刻，这正是我们的目标。</li></ul><pre class="ix iy iz ja fd ma mb mc md aw me bi"><span id="0c29" class="mf jo hh mb b fi mg mh l mi mj">[Summary Statistics]<br/>Accuracy = 96.24% | Precision = 96.55% | Recall = 98.36% | Specificity = 90.51% | F1 Score = 97.45%</span></pre><h1 id="e1a0" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">结论</h1><ol class=""><li id="ce2e" class="lh li hh kh b ki kj kl km ko mx ks my kw mz la nb ln lo lp bi translated">我们的CNN模型可以以极高的准确性有效地检测肺炎疾病。</li><li id="1999" class="lh li hh kh b ki lq kl lr ko ls ks lt kw lu la nb ln lo lp bi translated">放射科医生可以结合这个模型和他们的专业知识，做出高度准确的肺炎诊断。</li></ol><h1 id="f825" class="jn jo hh bd jp jq jr js jt ju jv jw jx in jy io jz iq ka ir kb it kc iu kd ke bi translated">未来的工作</h1><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nc"><img src="../Images/0bc49c453341fd5be2283c3053230847.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hq3jt_Oj5pJb8OY4kTg1Nw.png"/></div></div></figure><ul class=""><li id="4f10" class="lh li hh kh b ki lc kl ld ko lj ks lk kw ll la lm ln lo lp bi translated">要使模型更加稳健，请增加数据集中的数量和多样性。例如，包括来自不同国家和不同年龄的患者的X射线图像。</li><li id="d566" class="lh li hh kh b ki lq kl lr ko ls ks lt kw lu la lm ln lo lp bi translated">我们目前的模型是二元分类模型，识别患者是否患有肺炎。事实上，患者可能患有不同类型的肺病。在未来，我想收集不同类型的肺部X射线图像，并建立一个模型来自动诊断肺部疾病的类型。</li></ul></div><div class="ab cl nd ne go nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ha hb hc hd he"><h1 id="d429" class="jn jo hh bd jp jq nk js jt ju nl jw jx in nm io jz iq nn ir kb it no iu kd ke bi translated">参考</h1><p id="40b6" class="pw-post-body-paragraph kf kg hh kh b ki kj ii kk kl km il kn ko kp kq kr ks kt ku kv kw kx ky kz la ha bi translated">[1]:肺炎<a class="ae jm" href="https://www.mayoclinic.org/diseases-conditions/pneumonia/symptoms-causes/syc-20354204" rel="noopener ugc nofollow" target="_blank">https://www . mayo clinic . org/diseases-conditions/Pneumonia/symptomics-causes/syc-20354204</a></p><p id="a9d4" class="pw-post-body-paragraph kf kg hh kh b ki lc ii kk kl ld il kn ko le kq kr ks lf ku kv kw lg ky kz la ha bi translated">[2]:美国肺脏协会。(2020年5月27日)。<em class="lb">了解肺炎</em>。<a class="ae jm" href="https://www.lung.org/lung-health-diseases/lung-disease-lookup/pneumonia/learn-about-pneumonia" rel="noopener ugc nofollow" target="_blank">https://www . lung . org/lung-health-diseases/lung-disease-lookup/pneumonia/learn-about-pneumonia</a></p><p id="f63f" class="pw-post-body-paragraph kf kg hh kh b ki lc ii kk kl ld il kn ko le kq kr ks lf ku kv kw lg ky kz la ha bi translated">[3]:美国胸科学会。2019年20大肺炎事实。<a class="ae jm" href="https://www.thoracic.org/patients/patient-resources/resources/top-pneumonia-facts.pdf" rel="noopener ugc nofollow" target="_blank">https://www . thoracic . org/patients/patient-resources/resources/top-pneumonia-facts . pdf</a></p><p id="7dde" class="pw-post-body-paragraph kf kg hh kh b ki lc ii kk kl ld il kn ko le kq kr ks lf ku kv kw lg ky kz la ha bi translated">[4]: GE医疗保健。(2019年2月25日)。人工智能可能是通过x光识别肺炎的关键。<a class="ae jm" href="https://www.gehealthcare.com/feature-article/ai-could-hold-the-key-to-identifying-pneumonia-via-x-ray#:~:text=Chest%20X%2Drays%20have%20long,via%20X%2Dray%20a%20challenge" rel="noopener ugc nofollow" target="_blank">https://www . gehealthcare . com/feature-article/ai-could-hold-the-key-to-identifying-pneumonia-via-x-ray #:~:text = Chest % 20X % 2 ray % 20 have % 20 long，via % 20X % 2 ray % 20a % 20 challenge</a>。</p></div></div>    
</body>
</html>