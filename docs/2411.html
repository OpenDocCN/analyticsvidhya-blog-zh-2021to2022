<html>
<head>
<title>Predicting Starbucks’ User Behaviour</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测星巴克的用户行为</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/predicting-starbucks-user-behaviours-e68b18c31615?source=collection_archive---------8-----------------------#2021-04-22">https://medium.com/analytics-vidhya/predicting-starbucks-user-behaviours-e68b18c31615?source=collection_archive---------8-----------------------#2021-04-22</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><div class=""><h2 id="91f0" class="pw-subtitle-paragraph ie hg hh bd b if ig ih ii ij ik il im in io ip iq ir is it iu iv dx translated">预测用户将如何回应他们收到的报价。</h2></div><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es iw"><img src="../Images/c4252609861a1b4cd149131ddf836333.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fsfZWogFtv7uJB1l"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated"><a class="ae jm" href="https://unsplash.com/@quanle2819?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">全乐</a>在<a class="ae jm" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</figcaption></figure><blockquote class="jn jo jp"><p id="efbb" class="jq jr js jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">本文是Udacity的数据科学家Nanodegree的顶点项目的一部分，数据是作为该项目的一部分提供的。我不拥有这些数据。本文面向技术受众，需要一些数据科学的背景知识。</p></blockquote><h1 id="b29f" class="kn ko hh bd kp kq kr ks kt ku kv kw kx in ky io kz iq la ir lb it lc iu ld le bi translated"><strong class="ak">商业案例</strong></h1><p id="000e" class="pw-post-body-paragraph jq jr hh jt b ju lf ii jw jx lg il jz lh li kc kd lj lk kg kh ll lm kk kl km ha bi translated">用户/买家如何与公司的行为互动是企业界研究最多的领域。像星巴克这样的跨国巨头需要能够评估和预测他们的用户行为，从而为他们的股东创造最大价值。</p><p id="9004" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">在本文中，我们将根据用户数据、优惠数据以及与用户与优惠互动相关的数据，尝试预测用户行为。更具体地说，我们将试图预测用户通过购买更多商品对星巴克提供的服务的反应，并潜在地识别高消费群体。</p><h1 id="2901" class="kn ko hh bd kp kq kr ks kt ku kv kw kx in ky io kz iq la ir lb it lc iu ld le bi translated"><strong class="ak">数据介绍</strong></h1><p id="9d5c" class="pw-post-body-paragraph jq jr hh jt b ju lf ii jw jx lg il jz lh li kc kd lj lk kg kh ll lm kk kl km ha bi translated">该数据集包含模拟星巴克奖励移动应用程序上的客户行为的模拟数据。每隔几天，星巴克就会向手机应用程序的用户发出一次报价。优惠可以仅仅是饮料的广告，也可以是实际的优惠，如折扣或BOGO(买一送一)。</p><p id="b99b" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">数据包含在3个不同的JSON文件中；</p><p id="3f97" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">portfolio.json —包含报价id和关于每个报价的元数据(持续时间、类型等)。)</p><p id="2384" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">profile.json —每个客户的人口统计数据</p><p id="c283" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">transcript.json记录交易、收到的报价、查看的报价和完成的报价</p><blockquote class="jn jo jp"><p id="8b72" class="jq jr js jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">关于形成本文基础的数据的完整图式和完整笔记本可以在这里查阅:<a class="ae jm" href="https://github.com/zainfarrukh/starbucks-data-capstone" rel="noopener ugc nofollow" target="_blank">https://github.com/zainfarrukh/starbucks-data-capstone</a></p></blockquote><h1 id="6e62" class="kn ko hh bd kp kq kr ks kt ku kv kw kx in ky io kz iq la ir lb it lc iu ld le bi translated">项目描述</h1><p id="cd6e" class="pw-post-body-paragraph jq jr hh jt b ju lf ii jw jx lg il jz lh li kc kd lj lk kg kh ll lm kk kl km ha bi translated">我们使用各种可视化技术研究数据，然后使用:</p><ol class=""><li id="2979" class="ln lo hh jt b ju jv jx jy lh lp lj lq ll lr km ls lt lu lv bi translated">受监督的机器学习可以预测顾客在星巴克的消费金额，以便决策者可以确定优惠活动对哪些用户有效，并可以将精力集中在这些用户身上。</li><li id="3b06" class="ln lo hh jt b ju lw jx lx lh ly lj lz ll ma km ls lt lu lv bi translated">受监督的机器学习，根据消费者的类型(“高”、“中”或“低”)对用户进行分类，并根据该分类提出报价</li></ol><h1 id="a0fb" class="kn ko hh bd kp kq kr ks kt ku kv kw kx in ky io kz iq la ir lb it lc iu ld le bi translated">ML模型的评估矩阵</h1><h2 id="e885" class="mb ko hh bd kp mc md me kt mf mg mh kx lh mi mj kz lj mk ml lb ll mm mn ld mo bi translated">用于回归</h2><p id="7ce4" class="pw-post-body-paragraph jq jr hh jt b ju lf ii jw jx lg il jz lh li kc kd lj lk kg kh ll lm kk kl km ha bi translated">由于数据很可能是非线性的，我将使用支持向量机，合适的评估矩阵将是拟合优度R“R平方”。</p><h2 id="ce2c" class="mb ko hh bd kp mc md me kt mf mg mh kx lh mi mj kz lj mk ml lb ll mm mn ld mo bi translated">用于分类</h2><p id="3a6f" class="pw-post-body-paragraph jq jr hh jt b ju lf ii jw jx lg il jz lh li kc kd lj lk kg kh ll lm kk kl km ha bi translated">我将使用随机福里斯特分类器或支持向量分类器，一个适当的评估矩阵将是准确性得分。我还会查看精确度、召回率和F2分数来检查过度拟合。</p><h1 id="ed30" class="kn ko hh bd kp kq kr ks kt ku kv kw kx in ky io kz iq la ir lb it lc iu ld le bi translated">内容摘要</h1><p id="87a1" class="pw-post-body-paragraph jq jr hh jt b ju lf ii jw jx lg il jz lh li kc kd lj lk kg kh ll lm kk kl km ha bi translated">以下是我们将在文章中讨论的内容摘要:</p><ol class=""><li id="4e0c" class="ln lo hh jt b ju jv jx jy lh lp lj lq ll lr km ls lt lu lv bi translated"><strong class="jt hi">清理数据— </strong> <em class="js">去除异常值和异常值</em></li><li id="fd25" class="ln lo hh jt b ju lw jx lx lh ly lj lz ll ma km ls lt lu lv bi translated"><strong class="jt hi">合并数据</strong> — <em class="js">合并3个独立的JSON文件</em></li><li id="4386" class="ln lo hh jt b ju lw jx lx lh ly lj lz ll ma km ls lt lu lv bi translated"><strong class="jt hi">数据可视化</strong> — <em class="js">更好地理解数据</em></li><li id="b38a" class="ln lo hh jt b ju lw jx lx lh ly lj lz ll ma km ls lt lu lv bi translated"><strong class="jt hi">提取和缩放特征</strong> — <em class="js">选择和创建特征并缩放它们</em></li><li id="e20e" class="ln lo hh jt b ju lw jx lx lh ly lj lz ll ma km ls lt lu lv bi translated"><strong class="jt hi">使用回归和分类技术进行预测</strong>—<em class="js"/></li><li id="1489" class="ln lo hh jt b ju lw jx lx lh ly lj lz ll ma km ls lt lu lv bi translated"><strong class="jt hi">使用拟合优度和精确度评估模型</strong>—<em class="js"/></li><li id="393c" class="ln lo hh jt b ju lw jx lx lh ly lj lz ll ma km ls lt lu lv bi translated"><strong class="jt hi">细化</strong> — <em class="js">超参数调谐</em></li><li id="0bac" class="ln lo hh jt b ju lw jx lx lh ly lj lz ll ma km ls lt lu lv bi translated"><strong class="jt hi">论证— </strong>解决的<em class="js"/></li><li id="14ea" class="ln lo hh jt b ju lw jx lx lh ly lj lz ll ma km ls lt lu lv bi translated"><strong class="jt hi">结论</strong> — <em class="js">从练习中得出结论</em></li><li id="460c" class="ln lo hh jt b ju lw jx lx lh ly lj lz ll ma km ls lt lu lv bi translated"><strong class="jt hi">下一步</strong></li></ol></div><div class="ab cl mp mq go mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ha hb hc hd he"><h1 id="52d6" class="kn ko hh bd kp kq mw ks kt ku mx kw kx in my io kz iq mz ir lb it na iu ld le bi translated"><strong class="ak">清理数据</strong></h1><p id="e6fb" class="pw-post-body-paragraph jq jr hh jt b ju lf ii jw jx lg il jz lh li kc kd lj lk kg kh ll lm kk kl km ha bi translated">加载JSON文件后，我们可以看到三个不同数据帧的头部:</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nb"><img src="../Images/634737052f980146fa65f9fdc3e5e0eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TTVpxmedePjWvGqTkYy53g.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">抄本标题</figcaption></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nc"><img src="../Images/e4966abc2b6ef954edd4cf02c2c418db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AFbvxr80bnJZh6o5_9dYsg.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">轮廓头</figcaption></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nd"><img src="../Images/6a7ae497e303ec65f219961b7860ff8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qz8PjuC1zC7fagKbU8m2Lg.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">投资组合主管</figcaption></figure><p id="480d" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">副本数据帧具有由用户执行的所有报价和交易的概要。优惠id和交易金额存储在value列中，我们需要以更结构化的格式存储数据。</p><p id="0417" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">简档数据帧具有用户的特征，如年龄、性别、会员资格和收入。一些收入值是NaN。我们假设这些用户没有任何收入，并将这些值替换为0。</p><p id="cefc" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">投资组合数据框架包含每个报价的特征。在这个数据框架中，我们感兴趣的是显示每个提议的金钱奖励的奖励栏，以及显示完成提议的难度等级的难度栏。</p><p id="ab17" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">用户收入中有14.6%的NaN值，我们将其替换为we 0。除此之外，我们注意到大约有750名用户的年龄超过110岁。我们认为这是数据采集中的一个错误，我们将删除这些用户。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ne"><img src="../Images/f64f5f1c8f1c0722356a0f26a5f5dd07.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*YmSiQgEs0AooX0Hd8gmW-w.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">用户年龄直方图</figcaption></figure><p id="979a" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">有趣的是，我们还发现没有收入低于25，000的用户，这有点奇怪，需要进一步调查。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es nf"><img src="../Images/8245eda79cfa4c90386da42efbb1e273.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*YxUBRdzO2IULSl5nGkqxrA.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">用户收入直方图</figcaption></figure><p id="14d0" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">“成为成员”列是一个字符串，我们将该列转换为日期-时间，以便可以提取相关的特征。</p><h1 id="51fb" class="kn ko hh bd kp kq kr ks kt ku kv kw kx in ky io kz iq la ir lb it lc iu ld le bi translated"><strong class="ak">结合数据</strong></h1><p id="c24f" class="pw-post-body-paragraph jq jr hh jt b ju lf ii jw jx lg il jz lh li kc kd lj lk kg kh ll lm kk kl km ha bi translated">然后，我们继续使用Pandas合并功能来合并三个独立的数据帧。</p><p id="bd41" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">除了组合数据之外，我们还必须为我们的分析创建以下额外的列:a)每个用户从迄今为止提供的优惠中获得的平均回报，b)每个用户的优惠完成百分比(完成的优惠/收到的优惠)，以及c)用户是高消费还是低消费(任何人在星巴克花费其收入的5%或更多将被归类为高消费)</p><p id="2d30" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">请参考Github repo以查看包含所有分析的完整笔记本。</p><h1 id="417b" class="kn ko hh bd kp kq kr ks kt ku kv kw kx in ky io kz iq la ir lb it lc iu ld le bi translated"><strong class="ak">数据可视化</strong></h1><p id="9d35" class="pw-post-body-paragraph jq jr hh jt b ju lf ii jw jx lg il jz lh li kc kd lj lk kg kh ll lm kk kl km ha bi translated">为了更好地了解我们用户的特征，我们需要直观地检查数据。首先，让我们来看看用户购买量相对于其收入的趋势模式。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ng"><img src="../Images/d295b3a32786678098ecf76e9de61c97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3_TzxjzvindGxZOcEsF1KA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">支出金额与收入</figcaption></figure><p id="fb4e" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">从图表中可以看出，没有性别差异的消费模式。然而，有一些用户比其他用户花费更多的收入。</p><blockquote class="jn jo jp"><p id="0955" class="jq jr js jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">那么哪些用户是高消费人群呢？</p></blockquote><p id="0947" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">为了确定这一点，我们需要查看花费百分比的直方图，以便我们可以确定高花费者的阈值。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es nh"><img src="../Images/59dbdd226cf90491aa829280ef9b726c.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*u86tWpZWMWO1rMAwVrnj8A.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">支出百分比直方图</figcaption></figure><p id="4396" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">正如你所看到的，大多数用户在星巴克上的花费是他们收入的2.5%或更少，很少一部分用户花费了5%或更多。这就是为什么我们试图给高消费人群贴上标签，就像上一节提到的，就是那些花费至少5%收入的人。花费2.5%或更低的用户被归类为低花费者，其余的是中等花费者。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es ng"><img src="../Images/58dddc5b96a2f6bcadeedde4d5e64287.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GCMerumfHl2JV3xqWP0-4A.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">高、中、低消费群体的消费模式</figcaption></figure><p id="074e" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">正如您稍后将看到的，我们将尝试使用监督ML模型根据用户的消费模式对用户进行分类，以便我们可以识别上图中的潜在绿点(即高消费群体)。</p><p id="0293" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">报价数据汇总如下:</p><div class="ix iy iz ja fd ab cb"><figure class="ni jb nj nk nl nm nn paragraph-image"><img src="../Images/16cc11f033cd66a202db40ff13a7c5dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*JIdwHqLXaXF1tBAPlzIh7w.png"/></figure><figure class="ni jb no nk nl nm nn paragraph-image"><img src="../Images/c68bd07cbf346b24194e5d509f9dc2cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*G53gvVTlqoEFAUxBB3hHUw.png"/></figure></div><p id="be8e" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">没有2018年7月以后成为会员的用户。我们认为数据不是在那个日期之后捕获的。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ne"><img src="../Images/f0e88428f7bad34b79f9148cce76e26a.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*ikErZGw3JyOPEqAvSNOQ8A.png"/></div></figure><h1 id="c5ab" class="kn ko hh bd kp kq kr ks kt ku kv kw kx in ky io kz iq la ir lb it lc iu ld le bi translated"><strong class="ak">提取和缩放特征</strong></h1><p id="3ec4" class="pw-post-body-paragraph jq jr hh jt b ju lf ii jw jx lg il jz lh li kc kd lj lk kg kh ll lm kk kl km ha bi translated">现在，我们将注意力转向提取可用数据的相关特征，以输入到我们的监督ML模型中。为了使用日期-时间数据，我们提取了用户成为成员的相关年份，我们将使用这一年作为分类变量。我们还需要处理分类数据，即用户的性别和会员年份。为此，我们将使用pandas的get_dummies函数创建虚拟变量。</p><p id="727a" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">首先，我们将相关矩阵，看看任何高度相关的特征</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es np"><img src="../Images/26a7c3f7bda75dfa012ac82d4f253559.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZjggH5PTWadSODOXJPYOfA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">相关矩阵</figcaption></figure><p id="af37" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">这里有一个有趣的观察结果是，用户在星巴克的支出金额(“spend_pctg”)与完成的优惠数量(“offers_done”)和优惠完成率(“perc_comp”)呈相对强烈的正相关。我们将为我们的模型使用以下特征:</p><ol class=""><li id="b891" class="ln lo hh jt b ju jv jx jy lh lp lj lq ll lr km ls lt lu lv bi translated">用户的年龄</li><li id="86dd" class="ln lo hh jt b ju lw jx lx lh ly lj lz ll ma km ls lt lu lv bi translated">他的收入</li><li id="d705" class="ln lo hh jt b ju lw jx lx lh ly lj lz ll ma km ls lt lu lv bi translated">到目前为止完成的出价详细信息(收到的出价、完成的出价和出价完成百分比)</li><li id="bac7" class="ln lo hh jt b ju lw jx lx lh ly lj lz ll ma km ls lt lu lv bi translated">性别— <em class="js">分类变量</em></li><li id="543b" class="ln lo hh jt b ju lw jx lx lh ly lj lz ll ma km ls lt lu lv bi translated">用户成为会员的年份— <em class="js">分类变量</em></li></ol><p id="077d" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">在相关特征被提取出来之后，我们将对它们进行缩放，使得没有一个单独的特征会被赋予不适当的权重。我们将使用sk-learn库中的StandardScaler()函数，该函数根据平均值和标准偏差来缩放数据。</p><p id="9f9b" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">我们还将把数据分为测试数据和训练数据。我们将以50:50的比例分割它，因为我们有足够数量的数据点，并且我们需要更多的训练数据集来避免过度拟合我们的模型。我们将使用sk-learn库的train_test_split函数来拆分数据。</p><h1 id="bb70" class="kn ko hh bd kp kq kr ks kt ku kv kw kx in ky io kz iq la ir lb it lc iu ld le bi translated"><strong class="ak">做预测</strong></h1><p id="4751" class="pw-post-body-paragraph jq jr hh jt b ju lf ii jw jx lg il jz lh li kc kd lj lk kg kh ll lm kk kl km ha bi translated">我们将使用以下有监督的ML模型，其参数如下所示:</p><ol class=""><li id="e56d" class="ln lo hh jt b ju jv jx jy lh lp lj lq ll lr km ls lt lu lv bi translated">监督机器学习(特别是支持向量回归机' SVR '，因为数据最有可能是线性的)试图预测顾客在星巴克的消费金额，以便决策者可以确定优惠活动对哪些用户有效，并可以将他们的努力集中在这些用户上。</li><li id="1de8" class="ln lo hh jt b ju lw jx lx lh ly lj lz ll ma km ls lt lu lv bi translated">监督机器学习模型，如Random Forrest和支持向量分类器，根据消费者的类型(“高”、“中”或“低”)对用户进行分类，并根据该分类提出报价</li></ol><blockquote class="jn jo jp"><p id="ee47" class="jq jr js jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">回归模型的参数有:Pipeline(memory=None，steps=[('standardscaler '，StandardScaler(copy=True，with_mean=True，with_std=True))，(' svr '，SVR(C=5.0，cache_size=200，coef0=0.0，degree=3，epsilon=0.1，gamma='scale '，kernel='rbf '，max_iter=-1，shrinking=True，<br/> tol=0.001，verbose=False))]，verbose=False)</p><p id="bbe4" class="jq jr js jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">RF分类器的参数有:Pipeline(memory=None，steps=[('standardscaler '，StandardScaler(copy=True，with_mean=True，with_std=True))，(' randomforestclassifier '，RandomForestClassifier(bootstrap = True，CCP _阿尔法=0.0，class_weight=None，criterion='gini '，max_depth=None，max_features='auto '，max_leaf_nodes=None，max_samples=None，min _ inxity _ decrease = 0.0，min_samples</p><p id="4315" class="jq jr js jt b ju jv ii jw jx jy il jz ka kb kc kd ke kf kg kh ki kj kk kl km ha bi translated">svc分类器的参数有:Pipeline(memory=None，steps=[('standardscaler '，StandardScaler(copy=True，with_mean=True，with_std=True))，(' SVC '，SVC(C=1.0，break_ties=False，cache_size=200，class_weight=None，coef0=0.0，decision_function_shape='ovr '，degree=3，gamma='scale '，kernel='rbf '，max_iter=-1，probability=False，random_state=None</p></blockquote><p id="4344" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">为了评估我们的模型，我们将使用:1)适合度(R)来衡量我们的回归模型的性能，以及2)准确度和F1分数来衡量我们的分类模型的性能。</p><h1 id="9d3a" class="kn ko hh bd kp kq kr ks kt ku kv kw kx in ky io kz iq la ir lb it lc iu ld le bi translated"><strong class="ak">训练模特</strong></h1><p id="b834" class="pw-post-body-paragraph jq jr hh jt b ju lf ii jw jx lg il jz lh li kc kd lj lk kg kh ll lm kk kl km ha bi translated">在训练数据之后，我们在回归和分类ML模型上计算我们的指定矩阵。测试数据的结果如下:</p><p id="7181" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">不幸的是，在我们的回归模型上，我们只获得了0.22 R的测试样本分数。这意味着，尽管我们的模型解释了用户总支出的22%的变化，但仍有78%的变化无法解释，这使得模型不可靠。这可能是因为可用特征不足以解释目标变量的总变化。</p><p id="82ee" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">对于随机福里斯特分类器，在调整任何超参数之前，我们能够在测试样本上获得73.4%的准确性。对于支持向量分类器，我们能够将准确率提高到75.4%。RF模型的重大改进。</p><h1 id="707d" class="kn ko hh bd kp kq kr ks kt ku kv kw kx in ky io kz iq la ir lb it lc iu ld le bi translated">精炼</h1><p id="566e" class="pw-post-body-paragraph jq jr hh jt b ju lf ii jw jx lg il jz lh li kc kd lj lk kg kh ll lm kk kl km ha bi translated">我们可以通过改变不同的参数来进一步改进我们的RF分类器。在这里，我们将尝试我们的RF分类器的不同树大小，看看我们是否可以提高精度。</p><p id="8ca8" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">调整模型中的树的数量，我们能够达到74%的最大精确度。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es nq"><img src="../Images/6af8749f82898b935326f57db895f53f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*vBsa7U3ZEJIA19rJZccPzw.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">基于不同树大小的模型精度</figcaption></figure><p id="3573" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">然而，查看这两种模式的分类报告，高消费群体的F1得分要么为0，要么几乎为0。这使得我们现有的模型不可靠。这可能是因为标签不平衡。高消费人群只占总数据的4%,因此我们的模型给出的概率非常低。</p><figure class="ix iy iz ja fd jb er es paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><div class="er es nr"><img src="../Images/bb455febde045738aebff5397a10cbca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fbYgCOw8VB-9rMeGHEPKaA.png"/></div></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">SVC的分类报告</figcaption></figure><figure class="ix iy iz ja fd jb er es paragraph-image"><div class="er es ne"><img src="../Images/bbf1b57ece2871480dc7601bd82990bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*PnsI8-r1IVVzvZr_DD99hA.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx translated">消费者分布</figcaption></figure><p id="75d0" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated"><strong class="jt hi">解决阶层失衡</strong></p><p id="c844" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">解决方法之一是对中低消费人群进行欠采样，使样本对所有三个阶层具有相同权重。我们将采用这种策略，并使用pandas样本函数，我们将选择低消费和中等消费的用户，以便每个类别在将输入模型的数据中具有相等的代表性。基于修正后的测试数据，Random Forrest和SVC的准确率都降低到了49%-51%。然而，高消费阶层的F1分数提高到了0.41–0.43，这对我们来说是一个巨大的进步。</p><h1 id="d1af" class="kn ko hh bd kp kq kr ks kt ku kv kw kx in ky io kz iq la ir lb it lc iu ld le bi translated">评估和验证模型</h1><p id="1b51" class="pw-post-body-paragraph jq jr hh jt b ju lf ii jw jx lg il jz lh li kc kd lj lk kg kh ll lm kk kl km ha bi translated">我们在原始数据集上检查了我们的两个模型，以了解模型的准确性以及高消费阶层的F1分数是否有任何提高。结果如下所示:</p><div class="ix iy iz ja fd ab cb"><figure class="ni jb ns nk nl nm nn paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><img src="../Images/febe8ee107b9733575d9ca08b4652f43.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*ZRzt7KiRStBNg2b68MMy8A.png"/></div></figure><figure class="ni jb nt nk nl nm nn paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><img src="../Images/59ee37fa925a205306debcb24cccfa2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*eM8B_CV3pZ1YMWU8Q89SpQ.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx nu di nv nw translated">随机森林分类器的最终结果</figcaption></figure></div><div class="ab cb"><figure class="ni jb nx nk nl nm nn paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><img src="../Images/91ef67f0dffbcc3ac35687f9bb7aa1c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*k5uEHRnTKCgfyq5QE7I1tw.png"/></div></figure><figure class="ni jb ny nk nl nm nn paragraph-image"><div role="button" tabindex="0" class="jc jd di je bf jf"><img src="../Images/7db2bfaf13f5c64eb5210330a9cf1ad2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*ycFlNQu2_drinKqSjF1C7g.png"/></div><figcaption class="ji jj et er es jk jl bd b be z dx nz di oa nw translated">支持向量分类器的最终结果</figcaption></figure></div><p id="eede" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">我们可以看到，在最后一轮测试中，两种高消费车型的F1得分都有很大提高。这表明我们能够克服阶层失衡，并获得对高消费人群的预测，这正是我们所需要的，即识别高消费人群，以便星巴克可以将精力集中在这些用户上。</p><p id="b0f2" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated"><strong class="jt hi">模型的稳健性</strong></p><p id="fa68" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">模型足够稳健，因为它们解释了当前的类别不平衡，并避免了普通ML模型的一些缺陷，普通ML模型在现有数据集上将偏向于具有更多数据点的类别(中低消费群体)。</p><h1 id="ecb9" class="kn ko hh bd kp kq kr ks kt ku kv kw kx in ky io kz iq la ir lb it lc iu ld le bi translated">理由和裁决</h1><p id="d5bf" class="pw-post-body-paragraph jq jr hh jt b ju lf ii jw jx lg il jz lh li kc kd lj lk kg kh ll lm kk kl km ha bi translated"><strong class="jt hi"> <em class="js">回归模型:</em> </strong>我们的ML模型未能得到足够的R分数，被认为是一个可靠的模型。原因是我们的特征彼此之间既没有线性关系，也没有足够数量的特征来解释目标数据中的充分差异。</p><p id="0aaf" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated"><strong class="jt hi"> <em class="js">分类模型:</em> </strong>这些模型被训练成基于用户的特征来识别高消费人群。因此，这些模型可以作为营销策略的基础，其主要重点应该是瞄准高消费群体，因为这些用户将对星巴克未来的优惠做出更多反应。</p><h1 id="22dc" class="kn ko hh bd kp kq kr ks kt ku kv kw kx in ky io kz iq la ir lb it lc iu ld le bi translated"><strong class="ak">结论</strong></h1><p id="b997" class="pw-post-body-paragraph jq jr hh jt b ju lf ii jw jx lg il jz lh li kc kd lj lk kg kh ll lm kk kl km ha bi translated">ML回归模型也为我们提供了关于用户可能购买行为的关键见解。然而，目前的功能不提供我们可以准确依赖的预测，我们需要试验其他功能来预测每个用户的实际支出金额。</p><p id="f954" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">当前数据可以潜在地用于基于用户的消费行为对每个用户进行分类，并且我们可以使用该分类来针对每个用户提供的优惠的数量和类型。</p><p id="53b3" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">使用SVC和随机森林分类器，我们能够获得大约75%的准确率来预测用户是高消费还是低消费。虽然模型有很好的准确度分数，但是模型对于高消费人群的结果很差(不确定的F1分数)。SVC模型甚至不能预测一个高消费人群。这是因为标签非常不平衡。</p><p id="ac19" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">我们可以应对这种类别不平衡的方法之一是从频率较高的类别中对数据进行欠采样。我们从中低消费人群中随机选择样本，这样每个阶层的样本总数都是相同的，然后根据这些数据训练我们的模型，并根据训练好的模型预测整个数据集。虽然我们的准确率降低到60.24%-61.26%，但我们在高消费阶层获得了更好的F1分数。</p><p id="0b5a" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">基于这些信息，我们可以决定向哪个用户提供优惠券。优惠券提供应该是每个用户的消费类型的函数，即，具有高消费行为的用户应该得到更多的优惠券提供，因为他们更有可能进行购买，以及每个优惠券的相对难度，即，应该以更大的难度给予高消费用户优惠券。</p><h1 id="4347" class="kn ko hh bd kp kq kr ks kt ku kv kw kx in ky io kz iq la ir lb it lc iu ld le bi translated">后续步骤</h1><p id="1829" class="pw-post-body-paragraph jq jr hh jt b ju lf ii jw jx lg il jz lh li kc kd lj lk kg kh ll lm kk kl km ha bi translated">要深入了解用户行为，还有很多工作要做。我们可以执行以下额外的活动来获得对数据的更多了解:</p><p id="f9a1" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">1)确定数据异常的原因，即为什么人们的年龄超过110岁</p><p id="960b" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">2)提高回归模型准确性的附加功能</p><p id="d342" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">3)获取更多样本，这样我们就有足够多的高消费群体</p><p id="8b66" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">4)测试每种类型的优惠与各类用户之间的关系。</p><p id="6cfe" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">5)识别合适的用户群</p><p id="de6d" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">6)使用网格搜索来检查是否有任何具有更好超参数的更好模型</p><p id="5b6f" class="pw-post-body-paragraph jq jr hh jt b ju jv ii jw jx jy il jz lh kb kc kd lj kf kg kh ll kj kk kl km ha bi translated">7)使用更精细的搜索来查找更符合我们数据的其他模型</p></div></div>    
</body>
</html>