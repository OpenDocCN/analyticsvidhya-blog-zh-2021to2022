<html>
<head>
<title>GraphQL Apollo Java client Integration with Spring Boot Micro services</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">GraphQL阿波罗Java客户端与Spring Boot微服务集成</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/graphql-apollo-java-client-integration-with-spring-boot-micro-services-dbcfd2a1b8b9?source=collection_archive---------0-----------------------#2021-11-06">https://medium.com/analytics-vidhya/graphql-apollo-java-client-integration-with-spring-boot-micro-services-dbcfd2a1b8b9?source=collection_archive---------0-----------------------#2021-11-06</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div role="button" tabindex="0" class="ik il di im bf in"><div class="er es if"><img src="../Images/c0411de9eb6b8151cc948620f395a53e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gGaGJGB2mLVISjRm.png"/></div></div></figure><p id="0b76" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">GraphQL现在是一个热门话题，它打破了前端-后端API通信的传统。在tech spaces上有众所周知的服务器/客户端包，在NodeJs、Python、Java(Android)、Go等语言中创建graphqL服务器也有大量的社区支持。</p><p id="5faf" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">几乎没有为java客户端找到很好解释的工作流。由于Apollo客户端是为Android设计的，大部分代码片段最好用Kotlin。这篇文章的目的绝对是为了帮助那些希望创建/集成带有子图的graphql客户端的用户。</p></div><div class="ab cl jo jp gp jq" role="separator"><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt ju"/><span class="jr bw bk js jt"/></div><div class="hb hc hd he hf"><h1 id="b1b6" class="jv jw hi bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">1.添加依赖关系</h1><ul class=""><li id="7237" class="kt ku hi is b it kv ix kw jb kx jf ky jj kz jn la lb lc ld bi translated">对于<em class="le">格拉德</em></li></ul><figure class="lf lg lh li fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><ul class=""><li id="2fe8" class="kt ku hi is b it iu ix iy jb ll jf lm jj ln jn la lb lc ld bi translated">给Maven的</li></ul><figure class="lf lg lh li fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><h1 id="29f0" class="jv jw hi bd jx jy lo ka kb kc lp ke kf kg lq ki kj kk lr km kn ko ls kq kr ks bi translated">2.生成模式和查询</h1><p id="fb02" class="pw-post-body-paragraph iq ir hi is b it kv iv iw ix kw iz ja jb lt jd je jf lu jh ji jj lv jl jm jn hb bi translated">对于gradle，使用以下步骤生成模式</p><pre class="lf lg lh li fd lw lx ly lz aw ma bi"><span id="ba63" class="mb jw hi lx b fi mc md l me mf"># Create a directory for your GraphQL files:</span><span id="9b9d" class="mb jw hi lx b fi mg md l me mf"><strong class="lx hj">mkdir -p src/main/graphql/com/schema/</strong><br/><br/># --schema is interpreted relative to the current working directory. </span><span id="5469" class="mb jw hi lx b fi mg md l me mf"><strong class="lx hj">./gradlew downloadApolloSchema \<br/>  --endpoint="https://your.domain/graphql/endpoint" \<br/>  --schema="src/main/graphql/com/schema/schema.graphqls"</strong></span></pre><p id="d7be" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">对于Maven，请按照<a class="ae mh" href="https://github.com/aoudiamoncef/apollo-client-maven-plugin" rel="noopener ugc nofollow" target="_blank">这里的</a>解释配置。</p><p id="5313" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">接下来，将graphql查询添加到graphql文件夹中。</p><pre class="lf lg lh li fd lw lx ly lz aw ma bi"><span id="1d66" class="mb jw hi lx b fi mc md l me mf"><strong class="lx hj">src/main/graphql/com/queries/getInfo.gql</strong></span><span id="044d" class="mb jw hi lx b fi mg md l me mf">query GetProductInfo($products: ProductQuery!) {<br/>    getProducts(products: $products) {<br/>        opcoId<br/>        productId</span><span id="bfe2" class="mb jw hi lx b fi mg md l me mf">    }<br/>}</span></pre><h1 id="63a6" class="jv jw hi bd jx jy lo ka kb kc lp ke kf kg lq ki kj kk lr km kn ko ls kq kr ks bi translated">3.构建查询类</h1><pre class="lf lg lh li fd lw lx ly lz aw ma bi"><span id="6bf8" class="mb jw hi lx b fi mc md l me mf">./gradlew build  </span><span id="88e9" class="mb jw hi lx b fi mg md l me mf">OR</span><span id="d48f" class="mb jw hi lx b fi mg md l me mf">mvn generate-sources</span></pre><p id="b24d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在生成的源文件夹中会为您的查询生成类。</p><h1 id="ff54" class="jv jw hi bd jx jy lo ka kb kc lp ke kf kg lq ki kj kk lr km kn ko ls kq kr ks bi translated">4.客户端类和查询方法</h1><ul class=""><li id="9692" class="kt ku hi is b it kv ix kw jb kx jf ky jj kz jn la lb lc ld bi translated">创建一个OkHttp客户端并添加你的头(包括认证头)</li><li id="d759" class="kt ku hi is b it mi ix mj jb mk jf ml jj mm jn la lb lc ld bi translated">使用graphql端点URL构建您的客户端</li></ul><figure class="lf lg lh li fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="59b9" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">使用生成的查询类，您可以查询数据。</p><figure class="lf lg lh li fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="ddd1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">如果调用应该是同步调用，那么应该应用下面的包装器。</p><p id="0bc1" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">例如:</p><pre class="lf lg lh li fd lw lx ly lz aw ma bi"><span id="3f59" class="mb jw hi lx b fi mc md l me mf">toComplelatableFuture(client.query(new GetProductInfoQuery()));</span></pre><figure class="lf lg lh li fd ij"><div class="bz dy l di"><div class="lj lk l"/></div></figure><p id="cc83" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">感谢花在阅读上的时间。如果你需要更多信息，滑入评论。</p><p id="dd0d" class="pw-post-body-paragraph iq ir hi is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">和平🙌</p></div></div>    
</body>
</html>