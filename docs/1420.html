<html>
<head>
<title>Slurm Cluster with Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有Docker的Slurm集群</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/slurm-cluster-with-docker-9f242deee601?source=collection_archive---------2-----------------------#2021-03-01">https://medium.com/analytics-vidhya/slurm-cluster-with-docker-9f242deee601?source=collection_archive---------2-----------------------#2021-03-01</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><figure class="hh hi ez fb hj hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es hg"><img src="../Images/10593a47b570d76bfd972bed6c2688f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AyI7PEpEwbafV0m8t5abiQ.jpeg"/></div></div></figure><div class=""/><p id="9ebd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">这是一个关于如何使用<a class="ae jo" href="https://docs.docker.com/engine/install/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu"> Docker </strong> </a>得到一个Slurm集群的简单指南。</p><p id="5404" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">目的是提供一个环境来测试、介绍和实践在一个Slurm集群上的使用和开发(这不是一个生产环境)。</p><p id="91cd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://github.com/rancavil/slurm-cluster" rel="noopener ugc nofollow" target="_blank"> Github资源库</a></p><h2 id="0103" class="jp jq ht bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">Slurm</h2><p id="967b" class="pw-post-body-paragraph iq ir ht is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">根据定义，<a class="ae jo" href="https://slurm.schedmd.com/overview.html" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu"> Slurm </strong> </a>是一个开源、容错、高度可扩展的集群管理和作业调度系统，适用于各种规模的Linux集群。</p><p id="5d75" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">Slurm代表<strong class="is hu">S</strong>simple<strong class="is hu">L</strong>inux<strong class="is hu">U</strong>utility，代表<strong class="is hu"> R </strong> esource <strong class="is hu"> M </strong>管理(SLURM)，它通常被世界上许多超级计算机和Linux集群使用。</p><p id="af28" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">简单地说，Slurm允许我们使用集群中的节点资源来执行任务。</p><h2 id="5b7b" class="jp jq ht bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">Slurm建筑</h2><p id="f862" class="pw-post-body-paragraph iq ir ht is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">我们将使用<a class="ae jo" href="https://docs.docker.com/compose/" rel="noopener ugc nofollow" target="_blank"><strong class="is hu">docker-compose</strong></a>创建一个Slurm集群，Docker compose允许我们从Docker图像(之前构建的)创建一个环境。Docker-compose将创建容器和网络，以便在隔离的环境中进行通信。每个容器都将是集群的一个组件。</p><p id="e530" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> slurmmaster </strong>将是带有<strong class="is hu">Slurm ctld</strong>(Slurm的中央管理守护进程)的容器。</p><p id="ee3e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">slurmnode[1–3]</strong>是带有<strong class="is hu">slurmd</strong>(Slurm的计算节点守护进程)的容器。</p><p id="ac71" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> slurmjupyter </strong>将成为装有<strong class="is hu"> jupyterlab </strong>的容器。这允许使用<a class="ae jo" href="https://jupyterlab.readthedocs.io/en/stable/getting_started/overview.html" rel="noopener ugc nofollow" target="_blank"> JupyterLab </a>作为集群客户端与集群进行交互。作为最终用户，我们将通过浏览器使用JupyterLab与Slurm交互。</p><p id="4356" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu"> cluster_default network </strong>，docker-compose将创建一个网络来加入并保存容器。网络中的容器可以互相看见。</p><p id="a4b9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">下面的方案显示了组件如何交互。</p><figure class="kq kr ks kt fd hk er es paragraph-image"><div class="er es kp"><img src="../Images/81b64830179f684187f252122d495c89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*Qdux0X-5uyeBLmNiYq0qLA.png"/></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">Slurm集群docker架构</figcaption></figure><h2 id="ccb2" class="jp jq ht bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">创建集群</h2><p id="a3cb" class="pw-post-body-paragraph iq ir ht is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">正如我之前提到的，我们将使用<a class="ae jo" href="https://docs.docker.com/compose/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu"> docker-compose </strong> </a>来创建我们的Slurm集群。所以我们将编写一个<strong class="is hu"> docker-compose.yml </strong>文件来声明和配置所有集群组件。</p><p id="6fba" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要安装<a class="ae jo" href="https://pypi.org/project/docker-compose/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu"> docker-compose </strong> </a>，您必须执行:</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="552d" class="jp jq ht kz b fi ld le l lf lg">$ pip3 install docker-compose</span></pre><p id="56f8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我创建了一个名为<strong class="is hu"> cluster </strong>的目录来编写我的<strong class="is hu"> docker-compose.yml </strong></p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="996a" class="jp jq ht kz b fi ld le l lf lg">$ mkdir cluster<br/>$ cd cluster<br/>$ vim docker-compose.yml</span></pre><p id="fd2d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">注意:</strong>你可以用你喜欢的编辑器代替vim。</p><p id="87eb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，在docker-compose.yml文件中编写或复制并粘贴以下行。</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="7c99" class="jp jq ht kz b fi ld le l lf lg">services:<br/>  slurmjupyter:<br/>        image: <strong class="kz hu">rancavil/slurm-jupyter:19.05.5-1</strong><br/>        hostname: slurmjupyter<br/>        user: admin<br/>        volumes:<br/>                - shared-vol:/home/admin<br/>        ports:<br/>                - 8888:8888<br/>  slurmmaster:<br/>        image: <strong class="kz hu">rancavil/slurm-master:19.05.5-1</strong><br/>        hostname: slurmmaster<br/>        user: admin<br/>        volumes:<br/>                - shared-vol:/home/admin<br/>        ports:<br/>                - 6817:6817<br/>                - 6818:6818<br/>                - 6819:6819<br/>  slurmnode1:<br/>        image: <strong class="kz hu">rancavil/slurm-node:19.05.5-1</strong><br/>        hostname: slurmnode1<br/>        user: admin<br/>        volumes:<br/>                - shared-vol:/home/admin<br/>        environment:<br/>                - SLURM_NODENAME=slurmnode1<br/>        links:<br/>                - slurmmaster<br/>  slurmnode2:<br/>        image: <strong class="kz hu">rancavil/slurm-node:19.05.5-1</strong><br/>        hostname: slurmnode2<br/>        user: admin<br/>        volumes:<br/>                - shared-vol:/home/admin<br/>        environment:<br/>                - SLURM_NODENAME=slurmnode2<br/>        links:<br/>                - slurmmaster<br/>  slurmnode3:<br/>        image: <strong class="kz hu">rancavil/slurm-node:19.05.5-1</strong><br/>        hostname: slurmnode3<br/>        user: admin<br/>        volumes:<br/>                - shared-vol:/home/admin<br/>        environment:<br/>                - SLURM_NODENAME=slurmnode3<br/>        links:<br/>                - slurmmaster<br/>volumes:<br/>        shared-vol:</span></pre><p id="6149" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">注意:</strong>我用的是一台有两个CPU的电脑</p><p id="997f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，您可以创建集群执行。</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="9ac7" class="jp jq ht kz b fi ld le l lf lg">$ docker-compose up -d</span></pre><p id="4cb2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><strong class="is hu">注意:</strong>-d选项意味着我们将运行一个贫民窟集群作为守护进程。</p><p id="a80d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你可以检查一下是否一切正常。</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="2310" class="jp jq ht kz b fi ld le l lf lg">$ docker-compose ps</span></pre><p id="b7ee" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，在您的浏览器中进入以下URL以访问JupyterLab。</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="872a" class="jp jq ht kz b fi ld le l lf lg">http://localhost:8888</span></pre><p id="03cd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">你会看到木星实验室的环境。</p><figure class="kq kr ks kt fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lh"><img src="../Images/64b07711f65eb3e3a48d116123a6fb31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ATi0woiQ3zqlvzc0SNJ1rA.png"/></div></div><figcaption class="ku kv et er es kw kx bd b be z dx translated">带有Slurm队列和客户端的JupyterLab</figcaption></figure><p id="4758" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">它安装了HPC工具/ Slurm队列扩展。</p><figure class="kq kr ks kt fd hk er es paragraph-image"><div class="er es li"><img src="../Images/082c15b94cca7a20c6e001ceb8cd1000.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*C5G4wQFW90yKwoeWbslK0w.png"/></div></figure><p id="b409" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">按下按钮，你将得到Slurm队列管理器。</p><figure class="kq kr ks kt fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lh"><img src="../Images/f9549e61852fbf10706e7e99be1c78b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I1LSCy4pV3Sr6QE5zmXUXg.png"/></div></div></figure><p id="0b3c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要查看集群，请转到启动器选项卡中的终端。</p><figure class="kq kr ks kt fd hk er es paragraph-image"><div class="er es lj"><img src="../Images/54381542b760b1311d4b773404211af3.png" data-original-src="https://miro.medium.com/v2/resize:fit:232/format:webp/1*bsf2c2r04z7PySyKzM9RPA.png"/></div></figure><p id="e505" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在终端中，执行命令控制show node。</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="5712" class="jp jq ht kz b fi ld le l lf lg">admin@slurmjupyter:~$ <strong class="kz hu">scontrol show node</strong><br/>NodeName=<strong class="kz hu">slurmnode1</strong> Arch=x86_64 CoresPerSocket=1 <br/>   CPUAlloc=0 CPUTot=2 CPULoad=0.88<br/>   AvailableFeatures=(null)<br/>   ActiveFeatures=(null)<br/>   Gres=(null)<br/>   NodeAddr=slurmnode1 NodeHostName=slurmnode1 Version=19.05.5<br/>   OS=Linux 4.15.0-135-generic #139-Ubuntu SMP Mon Jan 18 17:38:24 UTC 2021 <br/>   RealMemory=1 AllocMem=0 FreeMem=203 Sockets=2 Boards=1<br/>   State=IDLE ThreadsPerCore=1 TmpDisk=0 Weight=1 Owner=N/A MCS_label=N/A<br/>   Partitions=slurmpar <br/>   BootTime=2021-02-05T00:25:01 SlurmdStartTime=2021-02-28T21:25:18<br/>   CfgTRES=cpu=2,mem=1M,billing=2<br/>   AllocTRES=<br/>   CapWatts=n/a<br/>   CurrentWatts=0 AveWatts=0<br/>   ExtSensorsJoules=n/s ExtSensorsWatts=0 ExtSensorsTemp=n/s</span><span id="6a37" class="jp jq ht kz b fi lk le l lf lg">NodeName=<strong class="kz hu">slurmnode2</strong> Arch=x86_64 CoresPerSocket=1 <br/>   CPUAlloc=0 CPUTot=2 CPULoad=0.88<br/>   AvailableFeatures=(null)<br/>   ActiveFeatures=(null)<br/>   Gres=(null)<br/>   NodeAddr=slurmnode2 NodeHostName=slurmnode2 Version=19.05.5<br/>   OS=Linux 4.15.0-135-generic #139-Ubuntu SMP Mon Jan 18 17:38:24 UTC 2021 <br/>   RealMemory=1 AllocMem=0 FreeMem=203 Sockets=2 Boards=1<br/>   State=IDLE ThreadsPerCore=1 TmpDisk=0 Weight=1 Owner=N/A MCS_label=N/A<br/>   Partitions=slurmpar <br/>   BootTime=2021-02-05T00:25:01 SlurmdStartTime=2021-02-28T21:25:19<br/>   CfgTRES=cpu=2,mem=1M,billing=2<br/>   AllocTRES=<br/>   CapWatts=n/a<br/>   CurrentWatts=0 AveWatts=0<br/>   ExtSensorsJoules=n/s ExtSensorsWatts=0 ExtSensorsTemp=n/s</span><span id="f703" class="jp jq ht kz b fi lk le l lf lg">NodeName=<strong class="kz hu">slurmnode3</strong> Arch=x86_64 CoresPerSocket=1 <br/>   CPUAlloc=0 CPUTot=2 CPULoad=0.88<br/>   AvailableFeatures=(null)<br/>   ActiveFeatures=(null)<br/>   Gres=(null)<br/>   NodeAddr=slurmnode3 NodeHostName=slurmnode3 Version=19.05.5<br/>   OS=Linux 4.15.0-135-generic #139-Ubuntu SMP Mon Jan 18 17:38:24 UTC 2021 <br/>   RealMemory=1 AllocMem=0 FreeMem=203 Sockets=2 Boards=1<br/>   State=IDLE ThreadsPerCore=1 TmpDisk=0 Weight=1 Owner=N/A MCS_label=N/A<br/>   Partitions=slurmpar <br/>   BootTime=2021-02-05T00:25:01 SlurmdStartTime=2021-02-28T21:25:18<br/>   CfgTRES=cpu=2,mem=1M,billing=2<br/>   AllocTRES=<br/>   CapWatts=n/a<br/>   CurrentWatts=0 AveWatts=0<br/>   ExtSensorsJoules=n/s ExtSensorsWatts=0 ExtSensorsTemp=n/s</span></pre><p id="41df" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">集群创建了一个名为<strong class="is hu"> slurmpar </strong>的分区。Slurm中的分区是具有相关资源的节点集。</p><h2 id="1aa1" class="jp jq ht bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">第一个例子</h2><p id="964e" class="pw-post-body-paragraph iq ir ht is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">我们将使用python开发一个例子来测试如何运行我们的集群。</p><p id="635d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">转到JupyterLab，创建一个新文件，并将该文件重命名为<strong class="is hu"> test.py </strong></p><figure class="kq kr ks kt fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ll"><img src="../Images/a421c25024454723a9940e0ed9218328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_0FUy4Y0VsOkr1c4my31Ag.png"/></div></div></figure><p id="796c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">并编写以下代码:</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="8b23" class="jp jq ht kz b fi ld le l lf lg">#!/usr/bin/env python3<br/>  <br/>import time<br/>import os<br/>import socket<br/>from datetime import datetime as dt</span><span id="7568" class="jp jq ht kz b fi lk le l lf lg">if __name__ == '__main__':<br/>    print('Process started {}'.format(dt.now()))<br/>    print('NODE : {}'.format(socket.gethostname()))<br/>    print('PID  : {}'.format(os.getpid()))<br/>    print('Executing for 15 secs')<br/>    time.sleep(15)<br/>    print('Process finished {}\n'.format(dt.now()))</span></pre><p id="51d2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">现在，我们将编写一个job.sh脚本。再次转到新文件，将文件重命名为<strong class="is hu"> job.sh </strong>，编写以下内容:</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="ec28" class="jp jq ht kz b fi ld le l lf lg">#!/bin/bash<br/>#<br/>#SBATCH --job-name=test<br/>#SBATCH --output=result.out<br/>#<br/>#SBATCH --ntasks=6<br/>#</span><span id="57ff" class="jp jq ht kz b fi lk le l lf lg">sbcast -f test.py /tmp/test.py<br/>srun python3 /tmp/test.py</span></pre><p id="e73d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在脚本中，我定义了输出文件<strong class="is hu"> result.out </strong>和<strong class="is hu"> ntask=6 </strong>，因为我们有<strong class="is hu"> 3个节点</strong>，每个节点有<strong class="is hu"> 2个CPU</strong>。</p><p id="8ff9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://slurm.schedmd.com/sbcast.html" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu"> sbcast </strong> </a>将文件传输到分配给Slurm作业的节点。</p><p id="20c2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated"><a class="ae jo" href="https://slurm.schedmd.com/srun.html" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu"> srun </strong> </a>将运行并行作业。</p><p id="6684" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">我们的test.py将作为6个任务并行执行。</p><p id="bfe8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">在Slurm队列管理器中进入<strong class="is hu">提交作业</strong>，选择<strong class="is hu"> job.sh </strong>(路径/home/admin)。</p><figure class="kq kr ks kt fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es lm"><img src="../Images/d9c170f734129543f5af7687fd5e25c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F22pw1w2MnJFaWrcf52ytw.png"/></div></div></figure><p id="6a8e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">执行job.sh脚本后，按下Reload按钮，您将看到以下内容。</p><figure class="kq kr ks kt fd hk er es paragraph-image"><div role="button" tabindex="0" class="hl hm di hn bf ho"><div class="er es ln"><img src="../Images/62b812886dec3d8999efbd668291c447.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U-RVi8ThCw0iTQOJ1ZDh-A.png"/></div></div></figure><p id="fa70" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">15秒后，结果将被写入文件<strong class="is hu"> result.out </strong>。</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="d093" class="jp jq ht kz b fi ld le l lf lg">Process started <strong class="kz hu">2021-02-28 11:23:55.094187</strong><br/>NODE : <strong class="kz hu">slurmnode1</strong><br/>PID  : 249<br/>Executing for 15 secs<br/>Process finished <strong class="kz hu">2021-02-28 11:24:10.109268</strong></span><span id="419d" class="jp jq ht kz b fi lk le l lf lg">Process started <strong class="kz hu">2021-02-28 11:23:55.133633</strong><br/>NODE : <strong class="kz hu">slurmnode3</strong><br/>PID  : 145<br/>Executing for 15 secs<br/>Process finished <strong class="kz hu">2021-02-28 11:24:10.141112</strong></span><span id="286a" class="jp jq ht kz b fi lk le l lf lg">Process started <strong class="kz hu">2021-02-28 11:23:55.149958</strong><br/>NODE : <strong class="kz hu">slurmnode3</strong><br/>PID  : 144<br/>Executing for 15 secs<br/>Process finished <strong class="kz hu">2021-02-28 11:24:10.164342</strong></span><span id="4eb2" class="jp jq ht kz b fi lk le l lf lg">Process started <strong class="kz hu">2021-02-28 11:23:55.153752</strong><br/>NODE : <strong class="kz hu">slurmnode1</strong><br/>PID  : 248<br/>Executing for 15 secs<br/>Process finished <strong class="kz hu">2021-02-28 11:24:10.168402</strong></span><span id="8d3b" class="jp jq ht kz b fi lk le l lf lg">Process started <strong class="kz hu">2021-02-28 11:23:55.192345</strong><br/>NODE : <strong class="kz hu">slurmnode2</strong><br/>PID  : 145<br/>Executing for 15 secs<br/>Process finished <strong class="kz hu">2021-02-28 11:24:10.207377</strong></span><span id="e656" class="jp jq ht kz b fi lk le l lf lg">Process started <strong class="kz hu">2021-02-28 11:23:55.197817</strong><br/>NODE : <strong class="kz hu">slurmnode2</strong><br/>PID  : 146<br/>Executing for 15 secs<br/>Process finished <strong class="kz hu">2021-02-28 11:24:10.212361</strong></span></pre><p id="c7e3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">分析结果，我们可以看到<strong class="is hu"> test.py </strong>被并行执行了6次，同时开始和结束(所有任务都在15秒内执行)，每个节点两次。</p><p id="e16e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hb bi translated">要停止集群，请执行以下操作:</p><pre class="kq kr ks kt fd ky kz la lb aw lc bi"><span id="9dee" class="jp jq ht kz b fi ld le l lf lg">$ docker-compose stop</span></pre><h2 id="96eb" class="jp jq ht bd jr js jt ju jv jw jx jy jz jb ka kb kc jf kd ke kf jj kg kh ki kj bi translated">摘要</h2><p id="2cab" class="pw-post-body-paragraph iq ir ht is b it kk iv iw ix kl iz ja jb km jd je jf kn jh ji jj ko jl jm jn hb bi translated">这是一个关于如何获得一个Slurm集群来学习和练习并行编程的小教程。好好享受吧。</p><figure class="kq kr ks kt fd hk er es paragraph-image"><div class="er es lo"><img src="../Images/63a73c47e6efab557013964f0a041c85.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*GnsJvNF7C8JmVpE3EZEsJQ.jpeg"/></div></figure></div></div>    
</body>
</html>