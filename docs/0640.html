<html>
<head>
<title>Cracking reCAPTCHAs with CNNs and Transfer Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用CNN破解reCAPTCHAs和迁移学习</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/cracking-recaptchas-with-cnns-and-transfer-learning-edc26ab675ec?source=collection_archive---------11-----------------------#2021-01-25">https://medium.com/analytics-vidhya/cracking-recaptchas-with-cnns-and-transfer-learning-edc26ab675ec?source=collection_archive---------11-----------------------#2021-01-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/44474c7c56d9640bc31a624c6e8d166a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/0*dIMempYpxxa0rDsu"/></div><figcaption class="im in et er es io ip bd b be z dx translated">reCAPTCHA <a class="ae iq" href="https://www.quora.com/How-does-reCAPTCHA-stop-bots-from-clicking-the-checkbox" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="c7f1" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">目录</p><ul class=""><li id="9c47" class="jp jq hi it b iu iv iy iz jc jr jg js jk jt jo ju jv jw jx bi translated"><a class="ae iq" href="https://github.com/whipIash/reCAPTCHASolver" rel="noopener ugc nofollow" target="_blank">代号</a></li><li id="5a48" class="jp jq hi it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx bi translated"><a class="ae iq" href="#7487" rel="noopener ugc nofollow">简介</a></li><li id="499d" class="jp jq hi it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx bi translated"><a class="ae iq" href="#71cf" rel="noopener ugc nofollow">计算机如何看待</a></li><li id="5bd2" class="jp jq hi it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx bi translated"><a class="ae iq" href="#53df" rel="noopener ugc nofollow">卷积神经网络</a></li><li id="f789" class="jp jq hi it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx bi translated"><a class="ae iq" href="#123d" rel="noopener ugc nofollow">迁移学习</a></li><li id="e3c8" class="jp jq hi it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx bi translated"><a class="ae iq" href="#5ad8" rel="noopener ugc nofollow">结果</a></li><li id="7a56" class="jp jq hi it b iu jy iy jz jc ka jg kb jk kc jo ju jv jw jx bi translated"><a class="ae iq" href="#2704" rel="noopener ugc nofollow">结论</a></li></ul></div><div class="ab cl kd ke gp kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hb hc hd he hf"><h1 id="7487" class="kk kl hi bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh bi translated">介绍</h1><p id="1332" class="pw-post-body-paragraph ir is hi it b iu li iw ix iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo hb bi translated">1950年，艾伦·图灵提出了“机器能思考吗？”他设想了一个名为模仿游戏的测试(又名<strong class="it hj">图灵测试</strong>)，其中有三个玩家，两个人和一台电脑。一个人的任务是试图确定其他玩家中哪个是计算机，哪个是人。虽然在那时，计算机很容易与人类区分开来，但今天它已经成为一个真正的挑战。这已经成为人工智能哲学中一个极具影响力的重要概念。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es ln"><img src="../Images/9aecae36cb5dca22b60a6efb469090ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/0*e0T_lXrJT_stIhIl.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">图灵测试来源:<a class="ae iq" href="https://botsociety.io/blog/2018/03/the-turing-test/" rel="noopener ugc nofollow" target="_blank"> botsociety.io </a></figcaption></figure><p id="d3cb" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">验证码是图灵测试的一种形式。它们被称为<strong class="it hj">反向图灵测试</strong>，因为一个或多个角色的目标在机器和人类之间被颠倒了。验证码使用另一台电脑自动完成这个过程，而不是人工评估。这就是首字母缩略词CAPTCHA来源于“测试期间完全自动告诉<strong class="it hj"> C </strong>计算机和<strong class="it hj"> H </strong>人类<strong class="it hj"> A </strong>部分。”你可能见过基于文本的验证码测试，你必须正确输入扭曲图像的文本。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es ls"><img src="../Images/6cf1df53e47eb58739ab442215079c3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Esw1LWJIRA1T0D76"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">你丫知道，<a class="ae iq" href="https://www.imperva.com/learn/application-security/what-is-captcha/" rel="noopener ugc nofollow" target="_blank">这些</a>烦人的东西？</figcaption></figure><p id="09ff" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">ReCAPTCHA与常规验证码的作用相同。它最初是由卡耐基梅隆大学的学生开发的，后来被T42谷歌收购。ReCAPTCHA v1使用基于文本的图像，如上图所示。然而，自从许多过去的机器学习论文证明了它可以用AI轻易破解之后，它就停止了。ReCAPTCHA v2使用基于图像的验证码，如下图所示。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es lx"><img src="../Images/28107359ed3c8ff891c76b52d50672d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DPIJnC7XWdivFFK3.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">谷歌reCAPTCHA v2 <a class="ae iq" rel="noopener" href="/@sxie2004/use-google-recaptcha-v3-in-china-727007879afe">来源</a></figcaption></figure><p id="08ef" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在这篇文章中，我将回顾<strong class="it hj">我如何使用机器学习来解决基于图像的reCAPTCHAs </strong>，并解释像<strong class="it hj">卷积神经网络</strong>和<strong class="it hj">迁移学习</strong>这样的概念。如果人工智能对你来说是新的，你可以看看我的<a class="ae iq" href="https://ryansh3n.medium.com/a-quick-introduction-to-ai-e5ce18264092" rel="noopener">人工智能快速介绍文章</a>，如果神经网络看起来很可怕，我会推荐这个<a class="ae iq" href="https://www.youtube.com/playlist?list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi" rel="noopener ugc nofollow" target="_blank"> 3Blue1Brown播放列表</a>。</p><h1 id="71cf" class="kk kl hi bd km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld mc lf lg lh bi translated">一、计算机是怎么看的？</h1><p id="3035" class="pw-post-body-paragraph ir is hi it b iu li iw ix iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo hb bi translated">你可能知道计算机处理1和0的信息。那么计算机是如何把一张图片变成它能理解的数值的呢？它通过<strong class="it hj">将图像转换成一个数组值</strong>来实现这一点。每个像素根据其亮度或暗度分配一个值，范围为0-255(RGB颜色代码)。0表示黑色，255表示白色。如果接近0，这两者之间的一切都会变暗，如果接近255，则会变亮。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es md"><img src="../Images/380851a97d75f74b7752c54df76f41d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/0*u2s3EsOHvAVmJaiX.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">将亚伯拉罕·林肯的照片转换成像素值数组的例子。<a class="ae iq" href="https://openframeworks.cc/ofBook/chapters/image_processing_computer_vision.html" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="749f" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">那么，计算机如何对值进行分类以匹配一个对象呢？</p><h1 id="53df" class="kk kl hi bd km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld mc lf lg lh bi translated">卷积神经网络</h1><p id="3ab4" class="pw-post-body-paragraph ir is hi it b iu li iw ix iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo hb bi translated">CNN类似于常规的神经网络。它们都是由具有机器可学习的权重和偏好的神经元组成的。每个神经元接收一个输入，执行一个计算并返回一个输出。它仍然有一个损失函数，在常规神经网络中学到的大多数东西仍然适用。</p><p id="2705" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">CNN的特别之处在于<strong class="it hj">它们是专门设计来将图像作为输入的。</strong>这意味着我们可以将某些属性编码到架构中，使转发功能更加有效<strong class="it hj"/>和<strong class="it hj">减少网络中的参数数量。</strong></p><p id="8e96" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">CNN的第一个特性是<strong class="it hj">它们可以将矩阵作为输入</strong>。常规神经网络只能接受向量输入。在CNN中，矩阵通常以3维排列:高度、宽度和深度。高度和宽度是不言自明的，它们代表了图像的高度和宽度。深度因图像类型而异。如果它是RGB图像，那么深度将是3，因为它有3个不同的通道(红色、绿色和蓝色)。然而，如果图像是灰度图像，那么它的深度将为1，因为它只有一个通道(想想之前的林肯图片)。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es me"><img src="../Images/9689a4a1847d866960576faa23523ffd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JgjHdx141ferkpkm3lI6tA.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">神经网络(左)与CNN(右)架构</figcaption></figure><p id="f28e" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">CNN还可以通过查看图像来记住空间信息，每次分析一组像素。在常规神经网络中，它逐个像素地查看图片，很难看到连接的组件。保存空间信息的关键是通过<strong class="it hj">卷积层</strong>(因此得名卷积神经网络)。它还允许模型减少参数的数量。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es mf"><img src="../Images/587fd861f8ca1603d34f96da171e70b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6W_s9nmegtVnOioknyi6gg.jpeg"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">常规神经网络与CNN对比分析小块图像<a class="ae iq" href="https://classroom.udacity.com/courses/ud188/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="1cff" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">你可以在上图中看到CNN是如何记住空间信息的。通过观察紧密分组的斑块中的节点，CNN可以了解到距离较近的像素比距离较远的像素相关性更强。这很重要，因为它可以帮助定义图像的特征，如边缘。而常规的神经网络只接收向量的输入，并且不知道数字最初是在网格中空间排列的。</p><p id="7e2f" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">卷积层将一系列<strong class="it hj">卷积核(又名滤波器)</strong>应用于输入图像。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mg"><img src="../Images/940e461c715186d87279920e82566c92.png" data-original-src="https://miro.medium.com/v2/resize:fit:254/0*cK56UaNd5DR-myqK"/></div></figure><p id="650a" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">假设我们有一个原始的5x5图像，如像素值为0或1的绿色矩阵。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mh"><img src="../Images/307ea5d3cbcc15c400db4d8a64625d58.png" data-original-src="https://miro.medium.com/v2/resize:fit:148/0*etdyDaSY62e3QnCc"/></div></figure><p id="7a52" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">然后我们可以有一个像orange matrix这样的卷积滤波器。</p><p id="e141" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">原始图像的卷积计算如下:</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="ab fe cl mi"><img src="../Images/835d221c30a16eecc04a8062011ce7f8.png" data-original-src="https://miro.medium.com/v2/0*KUWL53FcGua-ruBI"/></div><figcaption class="im in et er es io ip bd b be z dx translated"><a class="ae iq" href="https://ujjwalkarn.me/2016/08/11/intuitive-explanation-convnets/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="1da9" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">那么发生了什么？我们每次在原始图像上滑动卷积滤波器1个像素，这被称为我们的<strong class="it hj">步距</strong>。想象一下用放大镜阅读文本，在页面上滑动放大镜。对于每个位置，我们计算两个矩阵的逐元素乘法，得到最终的和。然后，我们将总和添加到输出矩阵中。</p><p id="5d5c" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">注意到我们最终的矩阵变小了吗？此外，请注意，角落像素几乎不影响最终矩阵值，而中心像素影响新矩阵中的每个值。我们可以使用<strong class="it hj">零填充</strong>来解决这些问题。这就是，等等，我们用零填充矩阵的地方🤯。零填充保留了空间大小，并允许像素更平等地贡献给最终矩阵。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mj"><img src="../Images/5c65ff217b19fa3d06d860781581b9e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/0*8vXoaK8bfh-7lovQ.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated"><a class="ae iq" href="https://ayeshmanthaperera.medium.com/what-is-padding-in-cnns-71b21fb0dd7" rel="noopener">来源</a></figcaption></figure><p id="2c86" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">这些过滤器帮助<strong class="it hj">过滤掉无用的“噪音”</strong>和<strong class="it hj">提取重要的特征</strong>比如物体的边缘。CNN将通过训练学习这些过滤器的值。这些过滤器的输出可以输入到更多的过滤器中，以检测眼睛、鼻子和牙齿等身体部位。这些可以输入到更多的过滤器中，以检测更复杂的东西，如人脸！</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es mk"><img src="../Images/8db3ae3e79e2f93912183264d7fc0c9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*m1RM1H2r6Uq3YLjV.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">边缘过滤器→身体部位过滤器→面部过滤器<a class="ae iq" href="http://datahacker.rs/edge-detection/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><h1 id="3760" class="kk kl hi bd km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld mc lf lg lh bi translated">最大池化🏊‍♂️</h1><p id="deb5" class="pw-post-body-paragraph ir is hi it b iu li iw ix iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo hb bi translated">合用不是游泳池，实际上是空间合用。<strong class="it hj">空间池降低了卷积层的维度，但保留了最重要的信息。</strong></p><p id="38cb" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">在max pooling中，我们在输入图像的一部分上滑动一个窗口，然后<strong class="it hj">取窗口</strong>中的最大值 <strong class="it hj">并将其添加到我们的输出矩阵中。这类似于卷积层，我们也在输入上滑动一个滤波器来提取数据。</strong></p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es ml"><img src="../Images/ad0d8fe0128ea47a0b2c8a03e16fd8ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*523cFNOUxRaQ9A3w"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">最大池<a class="ae iq" href="https://ujjwalkarn.me/2016/08/11/intuitive-explanation-convnets/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="919f" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">请注意，还有其他类型的池，如平均池(取窗口中值的平均值)和总和池(取总和)。但是，在大多数情况下，max pooling通常会执行得更好，因为它会查看面片中最重要的特征(如边)，而不是查看平均存在情况。</p><h1 id="f4b6" class="kk kl hi bd km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld mc lf lg lh bi translated">ReLU激活功能</h1><p id="7d39" class="pw-post-body-paragraph ir is hi it b iu li iw ix iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo hb bi translated">激活功能的目的是让我们能够<strong class="it hj">更好地执行梯度下降</strong>。在每个卷积运算之后，使用一个额外的<strong class="it hj"> ReLU(整流线性单元)</strong>运算。这是一个函数，如果输入为正，它将再次输出输入，否则，它将输出零。ReLU是一个非线性函数。这意味着函数对于给定的变量不是线性的。线性方程的一个例子是y=mx+b，而非线性方程可以是y = ax +bx+c。我们的函数应该是非线性的，因为在现实生活中，没有多少关系是线性的，所以添加非线性函数可以帮助我们看到更复杂的关系。</p><p id="dd4f" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">像池，也有其他类型的激活功能，如sigmoid，tanh，你甚至可以创建自己的。然而，人们发现ReLU在大多数情况下表现更好。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es mm"><img src="../Images/82673ffbd8b66d2caec2996ea9c5c041.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/0*Q7UqElkkjZ206PSW"/></div><figcaption class="im in et er es io ip bd b be z dx translated">ReLU功能可视化。<a class="ae iq" href="https://medium.com/p/edc26ab675ec/edit" rel="noopener">来源</a></figcaption></figure><h1 id="9791" class="kk kl hi bd km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld mc lf lg lh bi translated">辍学者</h1><p id="c17a" class="pw-post-body-paragraph ir is hi it b iu li iw ix iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo hb bi translated"><strong class="it hj">丢弃层用于防止模型过度拟合数据。</strong>过度拟合是指模型与训练数据“拟合”得如此之好，以至于当它与其他数据一起呈现时，模型会失败，因为它非常精确，但仅与训练数据一起呈现。解决这个问题的一个简单方法是增加辍学。<strong class="it hj">添加dropout可以通过随机删除节点来减少训练时间，并有助于避免过度拟合。</strong>在退出的情况下，模型不能过于依赖少数几个选定的节点，而是必须训练所有的节点，使其表现良好。想想只锻炼你的手臂。你只会擅长某些需要手臂力量的运动，但是当涉及到其他肌肉群的运动时，你就不那么擅长了。总之，千万不要跳过day🦵.腿</p><p id="0b77" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">哦，也用辍学。</p><h1 id="4901" class="kk kl hi bd km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld mc lf lg lh bi translated">对图像进行分类</h1><p id="d71a" class="pw-post-body-paragraph ir is hi it b iu li iw ix iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo hb bi translated">在拍摄了一张图像并通过一个带有ReLU激活函数的卷积层，然后将该图像传递到一个最大池层<strong class="it hj">之后，我们仍然没有图像类</strong>。这是我们回到我们信任的神经网络的时候。他们可以从最终的max pooling图层中获取数据，并为其分配权重和偏差以对其进行分类。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es mn"><img src="../Images/ef51cde787097a9fa2bd5a0e647cbac0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_H4R1K6WAPyk23nT.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">卷积神经网络的完整架构<a class="ae iq" href="https://developers.google.com/machine-learning/practica/image-classification/images/cnn_architecture.svg" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="ea4f" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">太棒了，让我们破解一些验证码！！！</p><p id="afd0" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">但是等等，</p><p id="f759" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">如果你尝试使用上面的简单架构来分类图像，你会发现你的准确率很低。在现实中，高精度模型有许多卷积层和许多训练数据，即使这样，它们也能达到90多的精度。那么，我们应该如何自己制作一个成功的模型呢？</p><h1 id="123d" class="kk kl hi bd km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld mc lf lg lh bi translated">迁移学习</h1><p id="4ac9" class="pw-post-body-paragraph ir is hi it b iu li iw ix iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo hb bi translated">迁移学习是指我们利用从一项任务中获得的知识来解决相关的任务。作为人类，我们一直都在这样做。比如拿Java编程中获得的知识去学习如何用Python编码。这样我们就不必从头开始，我们可以利用以前的经验更快更准确地学习。我们可以对ML模型做同样的事情，通过成熟的架构获得更准确的结果。</p><p id="5e4a" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我选择使用VGG-16模型，因为它简单而准确。利用我们对卷积神经网络的了解，我们可以理解VGG-16模型中正在发生的事情，而不会感到困惑。该模型在ImageNet上进行训练，ImageNet是一个包含超过1400万个图像和1000个类别的数据集。它实现了92.7%的前5名测试准确率。</p><p id="103c" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我不会说太多关于VGG-16的细节，但是你可以在这里了解更多</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es mo"><img src="../Images/6a29e5c191d4a8a3c4b0c8ed45fbe073.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*F-iY-SnVBKLhyHS-.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">这是一张VGG16架构的图片——我们以前没见过</figcaption></figure><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es mp"><img src="../Images/bdf8260fb583c432458459e6844a5558.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XfFRhltanf-IkcD4.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated"><a class="ae iq" href="https://neurohive.io/en/popular-networks/vgg16/" rel="noopener ugc nofollow" target="_blank">这里的</a>是架构的一个更形象的例子</figcaption></figure><p id="e1ff" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">要在Pytorch上得到这个预先训练好的模型，我们要做的就是</p><pre class="lo lp lq lr fd mq mr ms mt aw mu bi"><span id="add3" class="mv kl hi mr b fi mw mx l my mz">model = models.vgg16(pretrained=True)</span></pre><p id="2205" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">不，真的。就这么简单。</p><h1 id="5ad8" class="kk kl hi bd km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld mc lf lg lh bi translated">结果呢</h1><p id="fdef" class="pw-post-body-paragraph ir is hi it b iu li iw ix iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo hb bi translated">你可以在这里找到代码<a class="ae iq" href="https://github.com/whipIash/reCAPTCHASolver" rel="noopener ugc nofollow" target="_blank">T5T7<strong class="it hj">82%的整体准确率</strong>。我还附上了一段我制作的视频，对代码进行了分解。</a></p><figure class="lo lp lq lr fd ij"><div class="bz dy l di"><div class="na nb l"/></div><figcaption class="im in et er es io ip bd b be z dx translated">这是我做的一个视频，展示了代码和我的思考过程。</figcaption></figure><ol class=""><li id="a927" class="jp jq hi it b iu iv iy iz jc jr jg js jk jt jo nc jv jw jx bi translated">获取数据</li></ol><p id="62ee" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">我在 <a class="ae iq" href="https://github.com/deathlyface/recaptcha-dataset" rel="noopener ugc nofollow" target="_blank"> <strong class="it hj"> GitHub </strong> </a>上找到了一个标签为reCAPTCHA <strong class="it hj">的数据集，我用它作为训练数据。我<strong class="it hj">移除了VGG16模型没有训练过的职业</strong>并且<strong class="it hj">平衡了每个职业的图片数量</strong>。我还用随机水平翻转和10度的随机旋转对数据</strong>进行了一点扩充，这样无论图像的旋转或方向如何，模型都会知道如何对图像进行分类。然后，我将剩余的数据集分成<strong class="it hj">训练、验证和测试。</strong></p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es nd"><img src="../Images/e2a338c3d698aed9c20245826b6a933f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w6e2BhztlpkEkMTfwfwMvA.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">作者图片</figcaption></figure><p id="d0a9" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">2.训练模型</p><p id="3cda" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">得到VGG16模型后，我创建了一个新的分类器来输出5个最终类，而不是VGG16模型中使用的1000个类。我只是简单地添加了一个最终的全连接层，从1000个输入特性到5个输出特性。我使用<strong class="it hj">交叉熵损失</strong>作为我的损失函数，并使用<strong class="it hj"> Adam优化器</strong>，其<strong class="it hj">学习率为0.0005 </strong>。最后，我训练了<strong class="it hj"> 15个时期</strong>，并在每次验证损失减少时保存模型状态。</p><p id="2ecf" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">3.测试模型</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div class="er es ne"><img src="../Images/947337caa7365affdef78ba68b0a23bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*0RVz-rYi0t58qtqsCEZyGA.png"/></div><figcaption class="im in et er es io ip bd b be z dx translated">作者图片</figcaption></figure><p id="c299" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">该模型能够非常好地对公共汽车、桥梁和自行车进行分类！赛车似乎有点难，交通灯也很普通。然而，我对这个模型达到82%的准确率感到非常自豪，因为我个人知道，我只有90%的准确率。我有太多关于小失误或不够注意导致我重做的记忆。此外，<a class="ae iq" href="http://theory.stanford.edu/people/jcm/papers/captcha-study-oakland10.pdf" rel="noopener ugc nofollow" target="_blank">斯坦福大学2010年的这项</a>研究发现，图片验证码的三人一致率仅为71.0%。</p><p id="3143" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">这是可视化结果的图片。正确答案在括号里。</p><figure class="lo lp lq lr fd ij er es paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="er es nd"><img src="../Images/70da7245ed1944bf38f6a3c9fb46c583.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8W4vIepZWlAaxXOXa-koTg.png"/></div></div><figcaption class="im in et er es io ip bd b be z dx translated">作者图片</figcaption></figure><h1 id="2704" class="kk kl hi bd km kn ly kp kq kr lz kt ku kv ma kx ky kz mb lb lc ld mc lf lg lh bi translated">结论</h1><p id="5b2f" class="pw-post-body-paragraph ir is hi it b iu li iw ix iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo hb bi translated">希望您通过这篇文章获得了一些价值，并了解了CNN和迁移学习的力量。此外，如果你在你的网站上使用验证码，我会推荐<strong class="it hj">升级到ReCAPTCHAv3 </strong>，它不使用基于图像或基于文本的验证码，而是根据用户如何与你的网站互动来返回分数。此外，我的模型不是基于图像的验证码的游戏规则改变者。许多网站提供这种邪恶的东西，但我只是想<strong class="it hj">展示人工智能如何应用于等式</strong>。</p><p id="3976" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">如果你还在读这篇文章，想想<strong class="it hj">人工智能如何应用在你的生活中</strong>和<strong class="it hj">建造它</strong>！那是最好的学习方法。</p><p id="13c7" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">这就是这一个，如果你喜欢它，你可以给它一个<strong class="it hj">掌声</strong>，如果你真的喜欢它，你可以<strong class="it hj">关注</strong>了解更多内容！</p></div><div class="ab cl kd ke gp kf" role="separator"><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki kj"/><span class="kg bw bk kh ki"/></div><div class="hb hc hd he hf"><p id="4008" class="pw-post-body-paragraph ir is hi it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hb bi translated">嘿，感谢你阅读我的文章。我今年16岁，对机器学习和网络安全感兴趣。如果你有兴趣看我的更多内容，可以考虑订阅我的 <a class="ae iq" href="https://www.subscribepage.com/ryanshen" rel="noopener ugc nofollow" target="_blank"> <em class="nf">简讯</em> </a> <em class="nf">！还有，看看我的</em><a class="ae iq" href="https://www.linkedin.com/in/ryanshen/" rel="noopener ugc nofollow" target="_blank"><em class="nf">LinkedIn</em></a><em class="nf">和</em><a class="ae iq" href="https://github.com/whipiash/" rel="noopener ugc nofollow" target="_blank"><em class="nf">Github</em></a><em class="nf">页面。</em></p></div></div>    
</body>
</html>