<html>
<head>
<title>Evaluation Metrics for Classification Problems with Implementation in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中实现的分类问题的评估指标</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/evaluation-metrics-for-classification-problems-with-implementation-in-python-a20193b4f2c3?source=collection_archive---------0-----------------------#2021-02-07">https://medium.com/analytics-vidhya/evaluation-metrics-for-classification-problems-with-implementation-in-python-a20193b4f2c3?source=collection_archive---------0-----------------------#2021-02-07</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><p id="0754" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><em class="jd">本文重点介绍了用于分类问题的所有最常用的评估指标，以及应根据数据使用的指标类型，并提供了一个乳腺癌数据集演示。</em></p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es je"><img src="../Images/4c2b9288fc485b726005e6050670e2e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*R3Znq8JXYAtJXBoE.jpg"/></div></div></figure><p id="386b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">分类是一种监督学习技术，涉及预测给定输入数据的类别标签。在分类问题中，我们理解问题，探索数据，处理数据，然后使用机器学习算法或深度学习技术建立分类模型。在机器学习或深度学习的情况下，测试模型总是最佳实践。通过评估模型，我们可以测量模型的质量，并且可以看到我们的模型在用例方面做得有多好。</p><ul class=""><li id="0abe" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc jv jw jx jy bi translated">准确(性)</li><li id="6dde" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">混淆矩阵</li><li id="431d" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">精确</li><li id="00b8" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">回忆</li><li id="694a" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">F1分数</li><li id="aa0d" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">AUC-ROC曲线</li></ul><p id="20ec" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们考虑乳腺癌数据集，并尝试理解基于为乳腺癌预测建立的分类器的度量。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="ke kf l"/></div></figure><h1 id="a850" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">准确(性)</h1><p id="effd" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">分类器的精度计算为正确预测的样本总数与样本总数之比。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lj"><img src="../Images/7769b698c4f8fd0a5f58a12e99516d5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/0*FRiaA5F0U4V7j-un.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">精确度公式</figcaption></figure><p id="82d6" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">当数据集是平衡数据集时，可以使用准确度度量来评估分类器。当数据集不平衡时，不应使用准确性指标。让我们考虑具有两个目标类别的数据集，包含100个样本，其中95个样本属于类别1，5个样本属于类别2。当我们尝试为上述数据集构建分类器时，该分类器将偏向于类别1，并将导致预测所有样本为类别1样本。这将导致95%的准确率，这是错误的。为了避免这种错误，准确性指标应该只用于平衡数据集。</p><p id="ae5f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们看看代码，以获得分类器的准确性:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="ke kf l"/></div></figure><pre class="jf jg jh ji fd lo lp lq lr aw ls bi"><span id="b0e5" class="lt kh hi lp b fi lu lv l lw lx">Output:<br/>Accuracy of the classifier is: 0.9473684210526315</span></pre><h1 id="2b36" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">混淆矩阵</h1><p id="838d" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">混淆矩阵是一个N维方阵，其中<em class="jd"> N </em>表示目标类别或分类的总数。当数据集不平衡时，混淆矩阵可用于评估分类器。让我们考虑一个二元分类问题，即目标类别的数量是2。具有两个目标类别(比如“是”和“否”)的典型混淆矩阵如下所示:</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es ly"><img src="../Images/be7455fcd835399bae7c0f924d5c4d93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/0*GVy0nOoXSmZ0VL_p.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated"><em class="lz">混乱矩阵</em></figcaption></figure><p id="196b" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj">混淆矩阵中有四个重要术语</strong></p><ol class=""><li id="8712" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc ma jw jx jy bi translated"><strong class="ih hj">真阳性(TP): </strong>这些是预测的“是”实际上属于类“是”的情况。</li><li id="d2d1" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc ma jw jx jy bi translated"><strong class="ih hj">真否定(TN): </strong>这些是预测的“不”实际上属于类别“不”的情况。</li><li id="4f87" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc ma jw jx jy bi translated"><strong class="ih hj">假阳性(FP): </strong>这些是预测的“是”实际上属于类别“否”的情况。</li><li id="9319" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc ma jw jx jy bi translated"><strong class="ih hj">假阴性(FN): </strong>这些是预测的“否”实际上属于类别“是”的情况。</li></ol><p id="97f3" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们看看代码，为我们的乳腺癌分类器生成和绘制混淆矩阵。</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="ke kf l"/></div></figure><pre class="jf jg jh ji fd lo lp lq lr aw ls bi"><span id="20cf" class="lt kh hi lp b fi lu lv l lw lx">Output:<br/>[[39  2]<br/> [ 4 69]]</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mb"><img src="../Images/878c97084d832ddf468a6c04e114e77c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*GHngXfWRHJFWvcQ3.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">乳腺癌分类器的混淆矩阵</figcaption></figure><p id="8d95" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">从上面的混淆矩阵中可以看出:</p><ul class=""><li id="5cf7" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc jv jw jx jy bi translated"><strong class="ih hj">真阳性(TP): </strong> 69</li><li id="f59b" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated"><strong class="ih hj">误报(FP): </strong> 2</li><li id="f85a" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated"><strong class="ih hj">真底片(TN): </strong> 39</li><li id="d394" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated"><strong class="ih hj">假阴性(FN): </strong> 4</li></ul><p id="2d62" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">可以使用下面的公式从混淆中计算分类器的准确度:</p><p id="63fa" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated"><strong class="ih hj"> <em class="jd">准确度=(TP+TN)/(TP+FP+TN+FN)</em></strong></p><p id="ec88" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">我们的分类器的准确率是:(69+39) / (69+39+2+4) = 0.947 = 94.7%</p><h1 id="ed13" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">精确度(或阳性预测值)</h1><p id="bde5" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">精度是真阳性(TP)与真阳性(TP)和假阳性(FP)之和的比率。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lj"><img src="../Images/1201c6cd5bc401155d5a7f00a1e55161.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/0*vN7ertC_kBKSNZsN.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">精确公式</figcaption></figure><p id="f24d" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们考虑一个具有两个目标类(比如正和负)的数据集，然后precision告诉我们，在所有预测的正值中，有多少实际上是正的。精度应该基于用例来使用。以垃圾邮件检测为例。如果我们的模型检测到一封邮件是垃圾邮件，而它实际上不是垃圾邮件，那么用户可能会错过一封重要的邮件，也就是说，这里应该减少误报。因此，在这个用例中，我们需要使用精度作为度量来衡量我们的分类器的质量。</p><p id="a5e0" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们来看看计算乳腺癌分类器的精度分数的代码:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="ke kf l"/></div></figure><pre class="jf jg jh ji fd lo lp lq lr aw ls bi"><span id="ab78" class="lt kh hi lp b fi lu lv l lw lx">Output:<br/>Precision Score of the classifier is: 0.971830985915493</span></pre><h1 id="62b3" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">回忆(或敏感度或真阳性率)</h1><p id="e589" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">召回率是真阳性(TP)与真阳性(TP)和假阴性(FN)之和的比率。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es lj"><img src="../Images/49ac89b613adc613196a52caa80dae75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/0*OBYOX0Zv8x8Mb24Z.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">回忆公式</figcaption></figure><p id="9e52" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">让我们考虑一个有两个目标类(比如正类和负类)的数据集，然后回忆告诉我们，在总的实际负值中，我们的分类器负面预测了多少。与precision类似，recall也应该基于用例来使用。举一个癌症预测的例子。考虑这样一个人，他实际上患有癌症，但我们的分类器预测他为非癌症患者，这可能导致对他的虐待，也就是说，在这里应该减少假阴性。因此，在这种情况下，我们需要使用召回作为度量来衡量我们的分类器的质量。</p><p id="9ec9" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们来看看计算乳腺癌分类器召回分数的代码:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="ke kf l"/></div></figure><pre class="jf jg jh ji fd lo lp lq lr aw ls bi"><span id="8401" class="lt kh hi lp b fi lu lv l lw lx">Output:<br/>Recall Score of the classifier is: 0.9452054794520548</span></pre><h1 id="17e4" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">F1分数</h1><p id="a80f" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">当精确度和召回率对用例都很重要时，应该使用F1分数。F1分数是精确度和召回率的调和平均值。它位于[0，1]之间。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mc"><img src="../Images/d32f86daf7c4dca665ca6e755f414b7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/0*l15zVjRsQ6pw-Pbj.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">F1分数</figcaption></figure><p id="8468" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">F1分数来源于Fβ分数。F Beta分数是精确度和召回率的加权调和平均值。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es md"><img src="../Images/a80a585d8445e011dc857d77712acea3.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*eu46EpAb12w9zwM2.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">Fᵦ分数</figcaption></figure><ul class=""><li id="6c45" class="jq jr hi ih b ii ij im in iq js iu jt iy ju jc jv jw jx jy bi translated">如果假阳性(FP)和假阴性(FN)都很重要，那么β = 1。</li><li id="53c8" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">如果假阳性(FP)很重要，那么β介于0和1之间。</li><li id="96bc" class="jq jr hi ih b ii jz im ka iq kb iu kc iy kd jc jv jw jx jy bi translated">如果假阴性(FN)很重要，那么β &gt; 1。</li></ul><p id="dede" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们来看看计算乳腺癌分类器f1分数的代码:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="ke kf l"/></div></figure><pre class="jf jg jh ji fd lo lp lq lr aw ls bi"><span id="9643" class="lt kh hi lp b fi lu lv l lw lx">Output:<br/>F1 Score of the classifier is: 0.9583333333333334</span></pre><h1 id="b65d" class="kg kh hi bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">AUC-ROC曲线</h1><p id="244d" class="pw-post-body-paragraph if ig hi ih b ii le ik il im lf io ip iq lg is it iu lh iw ix iy li ja jb jc hb bi translated">AUC-ROC曲线是用于测量分类模型在不同阈值下的性能的性能度量。ROC是受试者工作特征曲线，AUC是曲线下面积。AUC(曲线下面积)的值越高，我们的分类器在预测类别时就越好。AUC-ROC主要用于二元分类问题。</p><p id="5d6f" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">ROC曲线绘制在真阳性率(TPR)和假阳性率(FPR)之间，即TPR在y轴上，FPR在x轴上。AUC是ROC曲线下的面积。优秀的分类器的AUC值接近1，而表现不佳的分类器的AOC值接近0。AOC分数为0.5的分类器没有任何类别分离能力。</p><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es me"><img src="../Images/38f604c184de18a5e317fc36bf1fbf25.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/format:webp/0*LTnn45i-HbBzZTb0.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">真实阳性率</figcaption></figure><figure class="jf jg jh ji fd jj er es paragraph-image"><div role="button" tabindex="0" class="jk jl di jm bf jn"><div class="er es me"><img src="../Images/3c44836b0ddbb74a3c8bbb580abf0516.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/format:webp/0*bTbVhkIq72GuWolc.png"/></div></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">假阳性率</figcaption></figure><p id="1a19" class="pw-post-body-paragraph if ig hi ih b ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb jc hb bi translated">现在让我们来看看计算和绘制乳腺癌分类器ROC AUC的代码:</p><figure class="jf jg jh ji fd jj"><div class="bz dy l di"><div class="ke kf l"/></div></figure><pre class="jf jg jh ji fd lo lp lq lr aw ls bi"><span id="af63" class="lt kh hi lp b fi lu lv l lw lx">Output:<br/>AUC of the classifier is: 0.9769462078182426</span></pre><figure class="jf jg jh ji fd jj er es paragraph-image"><div class="er es mb"><img src="../Images/39d4415e4647f6b904528742b113e584.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*R6Laejd6ZHysZ0SL.png"/></div><figcaption class="lk ll et er es lm ln bd b be z dx translated">ROC AUC</figcaption></figure><blockquote class="mf mg mh"><p id="7b36" class="if ig jd ih b ii ij ik il im in io ip mi ir is it mj iv iw ix mk iz ja jb jc hb bi translated">如果你喜欢这篇文章，请跟我来。如果您发现公式、代码或内容中有任何错误，请告诉我。</p><p id="2cb0" class="if ig jd ih b ii ij ik il im in io ip mi ir is it mj iv iw ix mk iz ja jb jc hb bi translated">你可以在<a class="ae ml" href="https://www.linkedin.com/in/venugopalkadamba" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>，<a class="ae ml" href="https://github.com/venugopalkadamba" rel="noopener ugc nofollow" target="_blank"> GitHub </a>找到我</p></blockquote><div class="mm mn ez fb mo mp"><a href="https://www.linkedin.com/in/venugopalkadamba" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab dw"><div class="mr ab ms cl cj mt"><h2 class="bd hj fi z dy mu ea eb mv ed ef hh bi translated">Venu Gopal Kadamba | LinkedIn</h2><div class="mw l"><h3 class="bd b fi z dy mu ea eb mv ed ef dx translated">在世界上最大的职业社区LinkedIn上查看Venu Gopal Kadamba的个人资料。Venu Gopal列出了3项工作…</h3></div><div class="mx l"><p class="bd b fp z dy mu ea eb mv ed ef dx translated">www.linkedin.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd jo mp"/></div></div></a></div><div class="mm mn ez fb mo mp"><a href="https://github.com/venugopalkadamba" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab dw"><div class="mr ab ms cl cj mt"><h2 class="bd hj fi z dy mu ea eb mv ed ef hh bi translated">venugopalkadamba - Github</h2><div class="mw l"><h3 class="bd b fi z dy mu ea eb mv ed ef dx translated">学生👨‍🎓和Python程序员。venugopalkadamba有21个存储库。在GitHub上关注他们的代码。</h3></div><div class="mx l"><p class="bd b fp z dy mu ea eb mv ed ef dx translated">github.com</p></div></div><div class="my l"><div class="ne l na nb nc my nd jo mp"/></div></div></a></div></div></div>    
</body>
</html>