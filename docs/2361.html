<html>
<head>
<title>ARIMA for dummies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">假人的ARIMA</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/arima-for-dummies-ba761d59a051?source=collection_archive---------2-----------------------#2021-04-20">https://medium.com/analytics-vidhya/arima-for-dummies-ba761d59a051?source=collection_archive---------2-----------------------#2021-04-20</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><figure class="ev ex if ig ih ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es ie"><img src="../Images/d41e726d02f45c6a54dd1e1920deee63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xdz6gKWXrm1MkaKh_PX_Tw.jpeg"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">由<a class="ae it" href="https://unsplash.com/@agebarros?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">阿格巴洛斯</a>在<a class="ae it" href="https://unsplash.com/s/photos/time-series?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="d06e" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在工作中，开发强化学习模型时，我遇到了一个自动回归模型，用于更新RL代理中的策略。这激活了我大脑中非常深的未被访问的部分，也就是“已经学习”的部分。我记得我写过一篇关于使用ARIMA的博客，它是自回归模型和移动平均模型的结合。我想这将是一个好主意，来回顾我的理解，也让我的博客曝光。所以开始了。</p><p id="c400" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在进入ARIMA之前，我们必须回顾一下什么是“时间序列”。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="1679" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">时间序列</h1><p id="8662" class="pw-post-body-paragraph iu iv hh iw b ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr ha bi translated">在特定时间通常以相等间隔观察到的数据点被称为时间序列数据。时间序列在现实生活中非常重要，因为大多数数据是以时间连续的方式测量的。股票价格每秒钟都会被记录下来。</p><p id="7b11" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">时间序列分析用于预测未来。例如，使用过去12个月的销售数据来预测未来n个月的销售，因此我们可以采取相应的行动。</p><p id="bdeb" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">解释时间序列数据的四个组成部分:</p><ol class=""><li id="2c39" class="lc ld hh iw b ix iy jb jc jf le jj lf jn lg jr lh li lj lk bi translated"><strong class="iw hi">趋势</strong>:上升、下降或静止。如果你公司的销售额每年都在增长，那么它就呈现出上升的趋势。</li><li id="d03a" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lh li lj lk bi translated"><strong class="iw hi">季节性</strong>:一定周期内重复的模式。夏天和冬天的区别。还包括特殊节日</li><li id="d515" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lh li lj lk bi translated"><strong class="iw hi">不规则性</strong>:影响时间序列数据的外部因素如Covid、自然灾害等。</li><li id="61c7" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lh li lj lk bi translated"><strong class="iw hi">循环</strong>:上下重复时序数据。</li></ol></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="bf36" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">ARIMA</h1><p id="30e7" class="pw-post-body-paragraph iu iv hh iw b ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr ha bi translated"><strong class="iw hi"> A </strong>自动<strong class="iw hi"> R </strong>过度<strong class="iw hi"> I </strong>整合<strong class="iw hi"> M </strong>移动<strong class="iw hi"> A </strong>平均<br/>又名Box-Jenkins法。</p><ul class=""><li id="ad74" class="lc ld hh iw b ix iy jb jc jf le jj lf jn lg jr lq li lj lk bi translated">这是一类使用自己的过去值进行预测的模型:滞后值和滞后预测误差。</li><li id="b10a" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lq li lj lk bi translated">AR模型使用滞后值进行预测</li><li id="5a89" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lq li lj lk bi translated">MA模型使用滞后预测误差进行预测</li><li id="2710" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lq li lj lk bi translated">两种型号集成成为ARIMA(“I”代表集成)</li><li id="8233" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lq li lj lk bi translated">由三个参数组成:<strong class="iw hi"> p </strong>，<strong class="iw hi"> q </strong>，<strong class="iw hi"> d </strong></li></ul><p id="aaae" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">ARIMA是一个简单的模型，它假设我们正在处理的时间序列数据满足以下条件:</p><ol class=""><li id="9a55" class="lc ld hh iw b ix iy jb jc jf le jj lf jn lg jr lh li lj lk bi translated">“非季节性”意味着不同的季节并不影响它的价值。当存在季节性时，我们使用季节ARIMA模型的简称SARIMA</li><li id="f9e5" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lh li lj lk bi translated">没有异常。例:没有像Covid这样影响我们数据的不规则事件</li></ol><p id="c667" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">现在我们知道什么是ARIMA模型，它期望什么，让我们更详细地讨论它有什么参数</p><h2 id="2154" class="lr ka hh bd kb ls lt lu kf lv lw lx kj jf ly lz kn jj ma mb kr jn mc md kv me bi translated">因素</h2><p id="d575" class="pw-post-body-paragraph iu iv hh iw b ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr ha bi translated"><strong class="iw hi">p</strong>—AR项的顺序</p><ul class=""><li id="ed1f" class="lc ld hh iw b ix iy jb jc jf le jj lf jn lg jr lq li lj lk bi translated">用作预测值的Y的滞后数。换句话说，如果你试图预测6月份的销售额，你会使用几个月前(滞后)的数据？</li></ul><p id="39c3" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi">问</strong> —马术语的顺序</p><ul class=""><li id="48a3" class="lc ld hh iw b ix iy jb jc jf le jj lf jn lg jr lq li lj lk bi translated">滞后预测误差的数量-&gt;你将使用多少过去的预测误差？</li></ul><p id="efe9" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated"><strong class="iw hi"> d </strong> —最小差值周期</p><ul class=""><li id="a645" class="lc ld hh iw b ix iy jb jc jf le jj lf jn lg jr lq li lj lk bi translated">使时间序列数据<strong class="iw hi">稳定</strong>所需的最小差分次数。</li><li id="e0ac" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lq li lj lk bi translated">已经稳定的数据将有<strong class="iw hi"> d </strong> = 0。</li></ul></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="6681" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在阅读每个参数术语<strong class="iw hi">固定</strong>的解释时，我并不清楚，因此经过一些研究，我获得了回答我的问题的知识:</p><blockquote class="mf mg mh"><p id="55bd" class="iu iv mi iw b ix iy iz ja jb jc jd je mj jg jh ji mk jk jl jm ml jo jp jq jr ha bi translated">静止实际上是什么意思？</p></blockquote><p id="bc74" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">如果时间序列数据包含以下内容，则认为该数据是稳定的:</p><ol class=""><li id="dc42" class="lc ld hh iw b ix iy jb jc jf le jj lf jn lg jr lh li lj lk bi translated">常数平均值</li><li id="2312" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lh li lj lk bi translated">恒定方差</li><li id="06d5" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lh li lj lk bi translated">独立于时间的协方差</li></ol><p id="6487" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">在大多数情况下，时间序列数据随着时间的推移而增加，因此，如果你采取连续的部分，它将不会有恒定的平均值。下图是Nvidia股票价格，这是<strong class="iw hi">非平稳</strong>数据的一个例子。分割成n个周期，取均值，就不一样了。</p><figure class="mn mo mp mq fd ii er es paragraph-image"><div class="er es mm"><img src="../Images/1184db42a0a37de295cfdf7d213cc9c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*1615ZMwGOGnUkGFy4dosVQ.png"/></div></figure><p id="345d" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">检查我们的数据是否是平稳的是很重要的，因为时间序列数据需要在建模预测未来之前是平稳的。<br/>通常它是不稳定的，因此我们<strong class="iw hi">差分</strong>它，从当前值中减去先前值。</p><p id="6165" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">因为拥有稳定的时间序列数据很重要，所以我们需要一种方法来检验它。检验时间序列数据是否平稳的常用方法有:</p><ul class=""><li id="65e6" class="lc ld hh iw b ix iy jb jc jf le jj lf jn lg jr lq li lj lk bi translated">扩充迪基富勒(ADF)试验</li><li id="3a72" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lq li lj lk bi translated">菲利普斯-佩龙试验</li><li id="56be" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lq li lj lk bi translated">科维亚特科夫斯基-菲利普斯-施米特-申(KPSS)试验</li><li id="d72b" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lq li lj lk bi translated">绘制滚动统计数据，如平均值、标准偏差</li></ul></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="0835" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">python中的模型构建</h1><p id="62c3" class="pw-post-body-paragraph iu iv hh iw b ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr ha bi translated">我们将使用python 3.8构建ARIMA模型，并预测Nvidia的收盘价。</p><figure class="mn mo mp mq fd ii"><div class="bz dy l di"><div class="mr ms l"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">Nvidia股票从2010年1月1日到2020年10月10日的收盘价。</figcaption></figure><figure class="mn mo mp mq fd ii er es paragraph-image"><div class="er es mt"><img src="../Images/3c1b569180d655188758bcb279e22be8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*CHzpT0btA_hMq1H5Wovv7g.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">nvda_df</figcaption></figure><p id="e405" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们必须做的第一件事是，检查数据是否稳定。从我们之前看到的Nvidia股票收盘价格的线图来看，很明显它不是静止的，但是要确保测试它总是一个好的做法。</p><p id="cb75" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们将使用<strong class="iw hi">增强的Dickey Fuller测试来测试它。</strong>为了测试数据是否平稳，我们使用假设检验，其中我们的零假设是“时间序列数据是非平稳的”。当p值小于0.05(p值)时，我们将拒绝零假设，这使得我们采取另一个假设“时间序列数据是平稳的”。</p><figure class="mn mo mp mq fd ii"><div class="bz dy l di"><div class="mr ms l"/></div></figure><p id="9cb4" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">请注意，我们的零假设被拒绝，因为p值≥ 0.05。现在我们知道我们的数据不是静态的，但它并没有在这里结束，因为我们可以通过使用“差分”技术使它稳定。</p><figure class="mn mo mp mq fd ii"><div class="bz dy l di"><div class="mr ms l"/></div></figure><p id="3d09" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">通过使用一阶差分，我们可以看到我们的数据变得稳定。</p><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mu"><img src="../Images/2781b4b00b4027748f34ecca1d49f642.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*caucoY9XUrPEfkOrHC6Clg.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">一阶、二阶差分应用图</figcaption></figure><p id="ac67" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">下面是一阶差分的自相关图。您可以看到，即使有一个滞后，也会立即导致负自相关，这表示过度差分。当自相关下降太快时，它可能指示过度差分，而如果自相关下降太慢(在超过10个滞后时间内保持正)，它指示差分不足。</p><figure class="mn mo mp mq fd ii er es paragraph-image"><div class="er es mv"><img src="../Images/f65e7e0080b1d3c76ef4d4bcdd6093fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*R-I2tLVmY3aAr4xKOSrG1Q.png"/></div><figcaption class="ip iq et er es ir is bd b be z dx translated">自相关图</figcaption></figure><p id="71a8" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">同样，当时间序列<strong class="iw hi">稍微欠差</strong>时，再次差会导致稍微过差，反之亦然。在这种情况下，不是求差，而是在略微欠差时添加AR项，在略微过差时添加MA项。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="2c1a" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">用ARIMA预测</h1><p id="37ed" class="pw-post-body-paragraph iu iv hh iw b ix kx iz ja jb ky jd je jf kz jh ji jj la jl jm jn lb jp jq jr ha bi translated">最后是使用ARIMA模型进行预测的时候了。有手动选择q，d，p的方法，但是由于博客太长，我将在以后的博客中更深入地解释它，并向你展示选择参数的简单方法。</p><figure class="mn mo mp mq fd ii"><div class="bz dy l di"><div class="mr ms l"/></div></figure><figure class="mn mo mp mq fd ii er es paragraph-image"><div class="er es mw"><img src="../Images/7d394f3f2b96bbdde4e2b285c98ce9fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*6O7DtpVZLi4Eem3qRGJuqg.png"/></div></figure><p id="eb87" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">上面的代码尝试了p、d、q的所有组合，并输出最佳模型，即具有最低AIC的模型。现在创建最佳ARIMA模型并进行预测。注意，由于是时间序列数据<strong class="iw hi">顺序问题</strong>因此必须按顺序分割训练和测试数据。</p><figure class="mn mo mp mq fd ii"><div class="bz dy l di"><div class="mr ms l"/></div></figure><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es mx"><img src="../Images/f5f12234a1019591947f1c4dc9e04684.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FthJJTCRtMt4kXpOXQfKRw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">整个数据集上的预测图</figcaption></figure><p id="82ab" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">上面的图表证明我们的预测做得不好。这是因为ARIMA模型没有考虑不规则性，而且由于像CES和自动驾驶汽车的兴起这样的事件，Nvidia价格飙升，我们的ARIMA模型做得很差。</p><p id="6df6" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">截至2018年10月，似乎没有违规行为。当我们截断我们的数据以包括2018年10月之前的数据时，我们得到以下预测。</p><figure class="mn mo mp mq fd ii er es paragraph-image"><div role="button" tabindex="0" class="ij ik di il bf im"><div class="er es my"><img src="../Images/85e30787b877c3f010afb1e4b8aa788a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fbIlATJIoztDaI-f4F1GNw.png"/></div></div><figcaption class="ip iq et er es ir is bd b be z dx translated">截至2018年9月的预测图</figcaption></figure><p id="583b" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">我们可以看到，当没有不规则性(假设之一)时，我们的ARIMA模型实际上做得很好。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><p id="3c21" class="pw-post-body-paragraph iu iv hh iw b ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr ha bi translated">总之，当我们处理没有不规则性和季节性的数据时，ARIMA运行良好。还有更稳健的ARIMA版本，如SARIMAX(带有外生变量的季节性ARIMA模型)，它不使用ARIMA提出的假设。我通常以自下而上的方式工作，因此我总是试图让事情简单，因此从建立最简单的基础模型开始，在我们的情况下是ARIMA，然后向上移动到萨里玛和萨里马克斯。</p></div><div class="ab cl js jt go ju" role="separator"><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx jy"/><span class="jv bw bk jw jx"/></div><div class="ha hb hc hd he"><h1 id="0f98" class="jz ka hh bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">参考</h1><ul class=""><li id="9555" class="lc ld hh iw b ix kx jb ky jf mz jj na jn nb jr lq li lj lk bi translated"><a class="ae it" href="https://www.machinelearningplus.com/time-series/arima-model-time-series-forecasting-python/#:~:text=ARIMA%2C%20short%20for%20'Auto%20Regressive,used%20to%20forecast%20future%20values" rel="noopener ugc nofollow" target="_blank">https://www . machine learning plus . com/time-series/ARIMA-model-time-series-forecasting-python/#:~:text = ARIMA % 2C % 20 short % 20 for % 20 ' Auto % 20 regressive，used % 20 to % 20 forecast % 20 future % 20 values</a></li><li id="3632" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lq li lj lk bi translated"><a class="ae it" href="https://www.youtube.com/watch?v=e8Yw4alG16Q&amp;t=2047s" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=e8Yw4alG16Q&amp;t = 2047s</a></li><li id="c255" class="lc ld hh iw b ix ll jb lm jf ln jj lo jn lp jr lq li lj lk bi translated"><a class="ae it" href="https://machinelearningmastery.com/time-series-data-stationary-python/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/time-series-data-stationary-python/</a></li></ul></div></div>    
</body>
</html>