<html>
<head>
<title>Handwritten and Printed Document Classification using Image Processing &amp; Machine Learning for Banking, Finance &amp; Insurance Domains</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用图像处理和机器学习对银行、金融和保险领域的手写和打印文档进行分类</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/handwritten-and-printed-document-classification-using-image-processing-machine-learning-for-f3d85b61c9a?source=collection_archive---------1-----------------------#2021-02-25">https://medium.com/analytics-vidhya/handwritten-and-printed-document-classification-using-image-processing-machine-learning-for-f3d85b61c9a?source=collection_archive---------1-----------------------#2021-02-25</a></blockquote><div><div class="ds gw gx gy gz ha"/><div class="hb hc hd he hf"><div class=""/><figure class="ev ex ig ih ii ij er es paragraph-image"><div class="er es if"><img src="../Images/4cd8cb819e38bd8df9e41d2f8fa41e23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*_ScXyLIXbwO9rAilbb5QtA.png"/></div></figure><p id="d682" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">手写和部分手写文档是ocr从银行、金融和保险行业的各种扫描pdf格式的申请表格中提取实体的挑战领域之一。</p><p id="7800" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这种从扫描的pdf中检测不到文本的特殊情况，稍后会中止通过用于文档分类和实体提取(文本/签名/复选框/单选按钮等)的各种机器学习和深度学习算法对文档的正确预测。)而这又降低了生产环境中机器学习模型的整体准确性。</p><h1 id="6d4f" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak">基于深度学习的方法&amp;挑战</strong></h1><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es ki"><img src="../Images/462354970224a742109a3c654be533e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0MYv-Ue1NgJXOs60qHg86w.png"/></div></div></figure><p id="1960" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">简单的卷积神经网络(CNN)可以被设计用于检测手写和印刷文档，只需通过使用3×3核过滤器将它们标记为手写和非手写文档。</p><blockquote class="kr ks kt"><p id="89ef" class="im in ku io b ip iq ir is it iu iv iw kv iy iz ja kw jc jd je kx jg jh ji jj hb bi translated"><strong class="io hj">以下是基于CNN模式的挑战:</strong></p><p id="26e5" class="im in ku io b ip iq ir is it iu iv iw kv iy iz ja kw jc jd je kx jg jh ji jj hb bi translated">1.一张A4大小的纸通常由2500×2500个像素组成，它为要训练的模型生成6，25，000个数据点。现在，如果我们取最少10，000页，那么这些数据点将会增加，模型将需要几个小时或几天来运行。</p><p id="466d" class="im in ku io b ip iq ir is it iu iv iw kv iy iz ja kw jc jd je kx jg jh ji jj hb bi translated">2.内核过滤器大小必须尽可能小(3×3 ),以识别文档中最小的手写补丁，这再次增加了模型训练时间。</p><p id="0afb" class="im in ku io b ip iq ir is it iu iv iw kv iy iz ja kw jc jd je kx jg jh ji jj hb bi translated">3.在只有一个或两个实体是手写的情况下，部分手写文档检测是非常困难的。例如，日期、签名或复选框。</p><p id="1f98" class="im in ku io b ip iq ir is it iu iv iw kv iy iz ja kw jc jd je kx jg jh ji jj hb bi translated">4.需要复杂的硬件基础设施来处理具有可测量的召回和精度值的如此巨大的数据。在这种情况下，GPU将是最适合模型训练的基础设施，但在许多情况下，它不具有成本效益。</p></blockquote><h1 id="f4d4" class="jk jl hi bd jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh bi translated"><strong class="ak">基于机器学习的方法</strong></h1><p id="7112" class="pw-post-body-paragraph im in hi io b ip ky ir is it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj hb bi translated">该方法包括图像处理、特征提取和最大似然建模。与基于CNN的模型相比，所生成的模型在内存占用和时间复杂度方面将更加优化。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es ld"><img src="../Images/cf5c1cb1d8e37d2454fbc9048d0e3488.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*TkTZzpnzlIYnWGuqFtkrbg.png"/></div><figcaption class="le lf et er es lg lh bd b be z dx translated">架构和管道</figcaption></figure><h2 id="4863" class="li jl hi bd jm lj lk ll jq lm ln lo ju ix lp lq jy jb lr ls kc jf lt lu kg lv bi translated">图像处理</h2><p id="dc0d" class="pw-post-body-paragraph im in hi io b ip ky ir is it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj hb bi translated">图像处理是模型流水线中最重要的步骤之一。必须对数据进行处理，以提高分辨率、像素密度、大小、偏斜度、对齐度等。后来，图像分割将有更好的特征工程和提取质量补丁。</p><ol class=""><li id="2de1" class="lw lx hi io b ip iq it iu ix ly jb lz jf ma jj mb mc md me bi translated"><strong class="io hj">扫描的pdf转换</strong>为JPEG/PNG/PPM/TIFF图像。Poppler是一个基于Python的API，它将文档转换成图像格式。为了优化内存使用和计算，请尝试将文件转换为JPEG格式，尤其是避免TIFF格式。这是我在stackoverflow <a class="ae mf" href="https://stackoverflow.com/questions/18381713/how-to-install-poppler-on-windows/63774687#63774687" rel="noopener ugc nofollow" target="_blank">上给的Poppler<a class="ae mf" href="https://pypi.org/project/python-poppler/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/python-poppler/</a>的链接和安装方法https://stack overflow . com/questions/18381713/how-to-install-Poppler-on-windows/63774687 # 63774687</a></li><li id="167b" class="lw lx hi io b ip mg it mh ix mi jb mj jf mk jj mb mc md me bi translated"><strong class="io hj">灰度转换</strong>将图像转换为灰度。为此，我们需要调用cvtColor函数，它允许将图像从一个颜色空间转换到另一个颜色空间。</li></ol><p id="4550" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><code class="du ml mm mn mo b">gray <strong class="io hj">=</strong></code> <code class="du ml mm mn mo b">cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)</code></p><p id="d3dd" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">作为第一个输入，这个函数接收原始图像。作为第二个输入，它接收色彩空间转换代码。由于我们想要将原始图像从<strong class="io hj"> BGR </strong>色彩空间转换到<strong class="io hj">灰色</strong>，我们使用代码<strong class="io hj"> COLOR_BGR2GRAY </strong>。</p><p id="8a19" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 3。分辨率提升</strong>这是最常用的虚化方法。我们可以用这个过滤器来消除图像中的噪声。我们需要非常小心地选择核的<strong class="io hj">大小，并且应该小心地选择x和y方向上高斯分布的<strong class="io hj">标准偏差</strong>。</strong></p><p id="ab78" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 4。OTSU阈值处理</strong>在全局阈值处理中，我们使用任意选择的值作为阈值。相比之下，Otsu的方法避免了必须选择一个值，而是自动确定它。</p><p id="5a6e" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">考虑一个只有两个不同图像值的图像(<em class="ku">双峰图像</em>)，其中直方图只包括两个峰值。一个好的阈值应该在这两个值的中间。类似地，Otsu的方法从图像直方图中确定最佳全局阈值。</p><p id="ebf9" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">为了做到这一点，使用了<a class="ae mf" href="https://docs.opencv.org/master/d7/d1b/group__imgproc__misc.html#gae8a4a146d1ca78c626a53577199e9c57" rel="noopener ugc nofollow" target="_blank"><strong class="io hj">【cv . threshold()】</strong></a>函数，其中<a class="ae mf" href="https://docs.opencv.org/master/d7/d1b/group__imgproc__misc.html#ggaa9e58d2860d4afa658ef70a9b1115576a95251923e8e22f368ffa86ba8bce87ff" rel="noopener ugc nofollow" target="_blank"> <strong class="io hj"> cv。THRESH_OTSU </strong> </a>作为额外标志传递。阈值可以任意选择。然后，该算法找到作为第一个输出返回的最佳阈值。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/7806075dcbd19c0a9e7a2367365b2103.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*s2dQz1mpNeHKmGzzNNhDdw.png"/></div></figure><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es mq"><img src="../Images/085567ca73cecfcd265d0bdbf9796d43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*C0E3DUjOUNRQ8Ytv-dOeMw.png"/></div></figure><p id="f738" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 5。形态学操作</strong>是一组基于形状处理图像的操作。它们将结构化元素应用于输入图像并生成输出图像。<br/>最基本的形态学操作有两种:<strong class="io hj">腐蚀和膨胀</strong></p><p id="a642" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">侵蚀:</strong></p><ul class=""><li id="45b2" class="lw lx hi io b ip iq it iu ix ly jb lz jf ma jj mr mc md me bi translated">侵蚀前景对象的边界</li><li id="9a5a" class="lw lx hi io b ip mg it mh ix mi jb mj jf mk jj mr mc md me bi translated">用于缩小图像的特征。</li></ul><p id="10a0" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">我们使用的腐蚀用法案例:</strong></p><blockquote class="kr ks kt"><p id="7abd" class="im in ku io b ip iq ir is it iu iv iw kv iy iz ja kw jc jd je kx jg jh ji jj hb bi translated">核(奇数大小(3，5，7)的矩阵)与图像进行卷积。但是对于我们的具体情况，我将生成图像片段的内核大小设为(5，100)。</p><p id="c090" class="im in ku io b ip iq ir is it iu iv iw kv iy iz ja kw jc jd je kx jg jh ji jj hb bi translated">只有当内核下的所有像素都是1时，原始图像中的像素(1或0)才会被视为1，否则它会被侵蚀(变为零)。</p><p id="976e" class="im in ku io b ip iq ir is it iu iv iw kv iy iz ja kw jc jd je kx jg jh ji jj hb bi translated">因此，根据内核的大小，所有靠近边界的像素都将被丢弃。</p><p id="016a" class="im in ku io b ip iq ir is it iu iv iw kv iy iz ja kw jc jd je kx jg jh ji jj hb bi translated">因此前景物体的厚度或尺寸减小，或者图像中的简单白色区域减小。</p></blockquote><p id="2dbf" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">扩张:</strong></p><ul class=""><li id="4cc8" class="lw lx hi io b ip iq it iu ix ly jb lz jf ma jj mr mc md me bi translated">增加对象区域</li><li id="2eb6" class="lw lx hi io b ip mg it mh ix mi jb mj jf mk jj mr mc md me bi translated">用于强调特征</li></ul><p id="a8fb" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj">我们用例中膨胀的用法:</strong></p><blockquote class="kr ks kt"><p id="f3e0" class="im in ku io b ip iq ir is it iu iv iw kv iy iz ja kw jc jd je kx jg jh ji jj hb bi translated">核(奇数大小(3，5，7)的矩阵)与图像进行卷积</p><p id="46c1" class="im in ku io b ip iq ir is it iu iv iw kv iy iz ja kw jc jd je kx jg jh ji jj hb bi translated">如果内核下至少有一个像素为“1”，则原始图像中的像素元素为“1”。</p><p id="8132" class="im in ku io b ip iq ir is it iu iv iw kv iy iz ja kw jc jd je kx jg jh ji jj hb bi translated">它增加了图像中的白色区域或者增加了前景物体的尺寸</p></blockquote><p id="4323" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> 6。轮廓&amp;分割</strong>将根据定义为5x100的内核大小将文档图像分割成多个图像片段。这些图像补片稍后可用于数据的特征工程。</p><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es ms"><img src="../Images/85eb9909c13884407c4b5d9deae1d213.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*tVMrI_ntbw6AlUYPAuVn_w.png"/></div></figure><h2 id="7a76" class="li jl hi bd jm lj lk ll jq lm ln lo ju ix lp lq jy jb lr ls kc jf lt lu kg lv bi translated"><strong class="ak">特征工程&amp;特征提取</strong></h2><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es mp"><img src="../Images/3d7fd2e8a8b0af5a9235fc5c5a60e848.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*NeufBLcbVT56benb8vlrEQ.png"/></div></figure><p id="e98d" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">图像处理步骤将在分辨率、像素密度、黑电平改善、白电平改善等方面改善和优化图像质量。现在，分段修补后的图像可用于特征工程和特征提取。</p><ol class=""><li id="afd9" class="lw lx hi io b ip iq it iu ix ly jb lz jf ma jj mb mc md me bi translated"><strong class="io hj">高度</strong> <strong class="io hj"> : </strong>该特征生成每个图像片段或片的高度。</li><li id="afd8" class="lw lx hi io b ip mg it mh ix mi jb mj jf mk jj mb mc md me bi translated"><strong class="io hj">宽度</strong></li><li id="0bc3" class="lw lx hi io b ip mg it mh ix mi jb mj jf mk jj mb mc md me bi translated"><strong class="io hj">宽高比</strong> <strong class="io hj">比</strong> <strong class="io hj"> : </strong>它是一个数字，表示每个图像片段或图像块的宽高比。(AR =宽/高)</li><li id="8ab2" class="lw lx hi io b ip mg it mh ix mi jb mj jf mk jj mb mc md me bi translated"><strong class="io hj">黑色像素密度:</strong>这代表前景白色平面上一个补丁中可用的黑色像素的密度。</li><li id="342d" class="lw lx hi io b ip mg it mh ix mi jb mj jf mk jj mb mc md me bi translated"><strong class="io hj">白色像素密度:</strong>这表示前景黑色平面上的补丁中可用的白色像素的密度。</li></ol><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es mt"><img src="../Images/c34c9e7704fdb83c3bfd1fdd11bdde0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*zh8_18ztbSPLkA_WDmwObA.png"/></div><figcaption class="le lf et er es lg lh bd b be z dx translated">模型的可提取特征</figcaption></figure><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es mu"><img src="../Images/8972aa7b5ef451626a7a6c0151fb51e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cpK3hI6vd_CZ6l5q5M67pA.jpeg"/></div></div><figcaption class="le lf et er es lg lh bd b be z dx translated">特征提取片段</figcaption></figure><h2 id="82a5" class="li jl hi bd jm lj lk ll jq lm ln lo ju ix lp lq jy jb lr ls kc jf lt lu kg lv bi translated"><strong class="ak">机器学习模型</strong></h2><figure class="kj kk kl km fd ij er es paragraph-image"><div role="button" tabindex="0" class="kn ko di kp bf kq"><div class="er es mv"><img src="../Images/88cb2ab8c059904bb7db148781c7f4c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-edaPksNZr4Jr6qSiKkWdg.png"/></div></div></figure><p id="5132" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">从分割图像中提取的特征也称为碎片，现在可以用于模型训练目的。目标变量包含手写和数字两类。</p><p id="2f44" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">各种分类器的最终结果如下所示:</p><figure class="kj kk kl km fd ij er es paragraph-image"><div class="er es mw"><img src="../Images/070ec5b4fe8e2aa94093117d8a8964f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*9_6fv11P-VMM5PZ5C-A_uw.png"/></div></figure><p id="6558" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">使用随机森林模型可以获得最佳结果。这些结果是根据下述假设和数据得出的:</p><blockquote class="kr ks kt"><p id="a301" class="im in ku io b ip iq ir is it iu iv iw kv iy iz ja kw jc jd je kx jg jh ji jj hb bi translated">手写样本总数:1000</p><p id="fe40" class="im in ku io b ip iq ir is it iu iv iw kv iy iz ja kw jc jd je kx jg jh ji jj hb bi translated">数字样本总数:1500</p></blockquote><p id="4b28" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">通过将样本数量增加到10，000以及调整随机森林模型的超参数，可以改善上述结果。</p><h2 id="7a0e" class="li jl hi bd jm lj lk ll jq lm ln lo ju ix lp lq jy jb lr ls kc jf lt lu kg lv bi translated">结论</h2><p id="e114" class="pw-post-body-paragraph im in hi io b ip ky ir is it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj hb bi translated">这种基于特征工程和分类的分割的主要优点在于，在给定的页面或文档中，基于被分类为手写的小块的总数，可以用于判定文档是手写的、部分手写的还是数字的。</p><p id="6844" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">基于机器学习的方法相对来说不需要太多的内存和时间。与需要密集计算和GPU的深度学习模型相比，这在基础设施方面的计算支出最少。</p><p id="8ace" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated"><strong class="io hj"> <em class="ku">以上片段可进一步用于根据各种距离算法(如Levenshtien、Jarowinkler等)创建您自己的OCR。</em>T15】</strong></p><p id="0c62" class="pw-post-body-paragraph im in hi io b ip iq ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj hb bi translated">这些模型可以避免质量差的手写文档的ocr阶段，从而节省了资源，避免了ocr准确性差的人工分析。</p></div></div>    
</body>
</html>