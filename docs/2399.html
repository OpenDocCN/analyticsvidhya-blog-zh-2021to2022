<html>
<head>
<title>Deep learning for physical activity detection using sensor data in smart watches</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用智能手表中的传感器数据进行身体活动检测的深度学习</h1>
<blockquote>原文：<a href="https://medium.com/analytics-vidhya/deep-learning-for-physical-activity-detection-using-sensor-data-in-smart-watches-8bbfb33fc2d4?source=collection_archive---------11-----------------------#2021-04-21">https://medium.com/analytics-vidhya/deep-learning-for-physical-activity-detection-using-sensor-data-in-smart-watches-8bbfb33fc2d4?source=collection_archive---------11-----------------------#2021-04-21</a></blockquote><div><div class="ds gv gw gx gy gz"/><div class="ha hb hc hd he"><div class=""/><p id="ecee" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">可穿戴设备的流行主要是由健康和健身意识的增强所驱动的。智能手表已经成为最受欢迎的可穿戴设备之一，全球主要公司推出的产品加速了智能手表的使用。这些设备包含多个传感器，如加速度计、陀螺仪、心率监测器等。使用这些传感器数据的人类活动识别是有需求的，并且它促进了各种以人为中心的应用的发展，例如健康监测、跌倒检测等。,.活动识别是基于这样的假设，即从身体上或环境传感器获得的特定身体运动转化为特定的信号模式，可以使用机器学习或深度学习技术对其进行识别/分类。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es jc"><img src="../Images/819f34117a06a8592879e8ae69f06d1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*ILN38abb3CpJYQQWKKdJJg.jpeg"/></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">来源:<a class="ae jo" href="https://www.researchgate.net/publication/317150667_The_Usage_of_Statistical_Learning_Methods_on_Wearable_Devices_and_a_Case_Study_Activity_Recognition_on_Smartwatches" rel="noopener ugc nofollow" target="_blank">研究之门</a></figcaption></figure><p id="ca39" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">近年来，在移动/web应用程序中部署深度学习模型以实时进行推理越来越流行。用于监控身体活动的设备上推理的可能性减少了通信延迟，并使深度学习模型在身体活动识别中流行。</p><p id="518e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在当前的实验中，RNN、GRU和LSTM架构被用于通过智能手表上的加速度计数据来识别身体活动。</p><h1 id="6e02" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated"><strong class="ak">数据</strong></h1><p id="40cd" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">实验基于<a class="ae jo" href="https://archive.ics.uci.edu/ml/datasets/human+activity+recognition+using+smartphones" rel="noopener ugc nofollow" target="_blank">异构活动识别数据集</a>。该数据集由智能手机和智能手表传感器数据组成。在本文的过程中，只考虑智能手表加速度计数据，详情如下。</p></div><div class="ab cl ks kt go ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ha hb hc hd he"><p id="b5d4" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">数据采集设备:4块智能手表(2块LG手表，2块三星Galaxy Gears)。</p><p id="a64d" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">下面给出了数据集中的字段及其简短描述。</p><ul class=""><li id="7238" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb le lf lg lh bi translated">索引:行号。</li><li id="422d" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">Arrival_Time:测量到达感测应用程序的时间。</li><li id="2943" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">Creation_Time:操作系统附加到样本的时间戳。</li><li id="2b39" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">x，y，z:相应轴的加速度计值。</li><li id="21ae" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">用户:执行活动的用户，用户从<em class="ln"> a </em>到<em class="ln"> i </em>命名。</li><li id="781a" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">型号:手表型号。</li><li id="9a48" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">设备:型号名称和编号，例如nexus4_1或nexus4_2。</li><li id="0db6" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">Gt:活动标签-自行车、坐、站、走、楼梯、楼梯下降和无效。在数据准备步骤中，从数据集中移除空类。</li></ul></div><div class="ab cl ks kt go ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ha hb hc hd he"><h1 id="7e9b" class="jp jq hh bd jr js lo ju jv jw lp jy jz ka lq kc kd ke lr kg kh ki ls kk kl km bi translated">数据探索和模型创建</h1><p id="dbb4" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">数据中的活动分布如下，很明显，骑自行车和坐着是数据中最具代表性和最不具代表性的类别。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="er es lt"><img src="../Images/6a1f81b01fd9cc6345fc135e8e175864.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IK_yfVqgaaW1xbQY4lJypw.png"/></div></div><figcaption class="jk jl et er es jm jn bd b be z dx translated">每种活动类型的数据样本</figcaption></figure><p id="d81f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在本实验中，探索了用于活动检测问题的各种递归神经网络(RNN)架构。</p><p id="37b2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">RNN-基本RNN是组织成连续层的节点网络，其中给定层中的每个节点都连接到下一个连续层中的每个其他节点。尽管rnn广泛用于顺序数据，但它们有一定的局限性。由于消失梯度或爆炸梯度，rnn不能跟踪长期相关性。</p><p id="8641" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">GRU和LSTM:长短期记忆(LSTM)和门控循环单位(GRU)是作为RNNs的短期记忆的解决方案而创建的。它们有称为“门”的内部机制，可以调节信息的流动。</p><h2 id="85ab" class="ly jq hh bd jr lz ma mb jv mc md me jz ip mf mg kd it mh mi kh ix mj mk kl ml bi translated">序列模型的数据准备</h2><ul class=""><li id="a967" class="kz la hh ig b ih kn il ko ip mm it mn ix mo jb le lf lg lh bi translated"><strong class="ig hi">列车测试分割</strong></li></ul><p id="8c86" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在当前的实验中，应用了训练-测试分离策略，使得80%的数据进入训练集，20%进入测试集。</p><ul class=""><li id="dd70" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb le lf lg lh bi translated"><strong class="ig hi">规模特征</strong></li></ul><p id="7b79" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">要素集的标准化有利于模型，将不同比例的不同要素输入到模型中会导致网络在表示中错误地将某些要素的优先级设置为高于其他要素。scikitlearn的Robustscaler根据四分位数范围缩放数据，因此对异常值具有鲁棒性。然后，来自训练集的中位数和四分位间距用于转换测试集。</p><ul class=""><li id="1197" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb le lf lg lh bi translated"><strong class="ig hi">创建时间序列数据输入</strong></li></ul><p id="ae73" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">在Keras中，输入数据应以3D格式给出，根据文档<strong class="ig hi"> <em class="ln">，这些尺寸为[ <em class="ln"> batch_size，timesteps，input_dim </em> ]。</em> </strong>但是，不需要指定<em class="ln"> batch_size </em>。时间步长“t”的预测是基于指定数量的先前和当前时间步长特征计算的，这必须由<em class="ln">时间步长</em>指定。<em class="ln"> input_dim </em>是数据<em class="ln">中的特征数。</em> <strong class="ig hi"> <em class="ln"> </em> </strong>这样，上一步的数据就要被LSTM重塑为3D。同样，由于目标变量是分类的，在该步骤中，最频繁出现的标签被用作该时间窗口的标签。</p><p id="22f2" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">为模型选择的序列长度为300，对应于3秒，因为传感器数据是以100Hz的频率收集的。</p><ul class=""><li id="4c94" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb le lf lg lh bi translated"><strong class="ig hi">对目标进行热编码</strong></li></ul><p id="e29f" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">因为目标变量是分类的，所以应用一种热编码，该热编码涉及用二进制向量来表示每个分类变量，该二进制向量对于每个唯一标签具有一个元素，并且用1来标记类标签，所有其他元素为0。</p><h2 id="e701" class="ly jq hh bd jr lz ma mb jv mc md me jz ip mf mg kd it mh mi kh ix mj mk kl ml bi translated"><strong class="ak">型号规格</strong></h2><p id="4133" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">为了简单和比较，在不同的模型中保持相似的架构。</p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mp"><img src="../Images/233730bbb892ece7ab834098cc4035de.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*EDi1gqEQSuMKgBFshBryMg.png"/></div></figure><ul class=""><li id="0b50" class="kz la hh ig b ih ii il im ip lb it lc ix ld jb le lf lg lh bi translated">输入层是SimpleRNN/ LSTM/GRU</li><li id="267b" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">SpatialDropout1D在模型中执行变分丢弃。</li><li id="a49d" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">完全连接的层</li><li id="2aeb" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">输出层创建6个输出值，每个类一个。</li><li id="03dd" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">激活功能为“softmax”。</li><li id="f143" class="kz la hh ig b ih li il lj ip lk it ll ix lm jb le lf lg lh bi translated">“分类交叉熵”被用作损失函数。</li></ul><p id="a21c" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><strong class="ig hi">模型评估</strong></p><figure class="jd je jf jg fd jh er es paragraph-image"><div class="er es mq"><img src="../Images/ffb90c650e5b807eae65a269bb668622.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*Qlt957m-1R-_UxDqG6ycCg.png"/></div></figure><p id="7a72" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">来自RNN、LSTM和GRU的准确性在所探索的建筑中几乎相同。图中显示了GRU模型的训练历史。使用该模型的测试集的准确率约为74%。进一步的参数/网络优化可以提高模型的性能。</p><h1 id="a526" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">结论</h1><p id="2f59" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated">随着技术的进步，很容易将机器学习/深度学习模型部署到移动平台。人类活动识别解决方案也越来越多地集成到移动应用程序中。</p><p id="337b" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated">本文描述了使用智能手表传感器数据为人体活动识别创建序列模型的过程。这里探讨了RNN、LSTM和GRU的Keras实现。对于具有简单GRU网络架构的测试数据集，获得了74%的准确度。</p><p id="432a" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jo" href="https://github.com/reshkurian/Physical_activity_recognition/blob/main/activity_recognition.ipynb" rel="noopener ugc nofollow" target="_blank">Github中的完整脚本</a></p><h1 id="81ae" class="jp jq hh bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km bi translated">参考</h1><p id="ca4a" class="pw-post-body-paragraph ie if hh ig b ih kn ij ik il ko in io ip kp ir is it kq iv iw ix kr iz ja jb ha bi translated"><a class="ae jo" href="https://www.tensorflow.org/guide/keras/sequential_model" rel="noopener ugc nofollow" target="_blank">张量流</a></p><p id="035e" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jo" href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" rel="noopener ugc nofollow" target="_blank">时间序列——Python和Keras </a></p><p id="a898" class="pw-post-body-paragraph ie if hh ig b ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb ha bi translated"><a class="ae jo" href="https://towardsdatascience.com/time-series-classification-for-human-activity-recognition-with-lstms-using-tensorflow-2-and-keras-b816431afdff" rel="noopener" target="_blank"> HAR与LSTMs </a></p></div></div>    
</body>
</html>